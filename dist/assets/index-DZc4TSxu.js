var efe=Object.defineProperty;var tfe=(t,e,r)=>e in t?efe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Tr=(t,e,r)=>tfe(t,typeof e!="symbol"?e+"":e,r);function rfe(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var zit=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function TA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var pW={exports:{}},tI={},gW={exports:{}},ca={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Aw=Symbol.for("react.element"),nfe=Symbol.for("react.portal"),afe=Symbol.for("react.fragment"),sfe=Symbol.for("react.strict_mode"),ife=Symbol.for("react.profiler"),ofe=Symbol.for("react.provider"),lfe=Symbol.for("react.context"),cfe=Symbol.for("react.forward_ref"),ufe=Symbol.for("react.suspense"),dfe=Symbol.for("react.memo"),ffe=Symbol.for("react.lazy"),TL=Symbol.iterator;function hfe(t){return t===null||typeof t!="object"?null:(t=TL&&t[TL]||t["@@iterator"],typeof t=="function"?t:null)}var xW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vW=Object.assign,yW={};function r1(t,e,r){this.props=t,this.context=e,this.refs=yW,this.updater=r||xW}r1.prototype.isReactComponent={};r1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};r1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bW(){}bW.prototype=r1.prototype;function SO(t,e,r){this.props=t,this.context=e,this.refs=yW,this.updater=r||xW}var jO=SO.prototype=new bW;jO.constructor=SO;vW(jO,r1.prototype);jO.isPureReactComponent=!0;var BL=Array.isArray,wW=Object.prototype.hasOwnProperty,IO={current:null},NW={key:!0,ref:!0,__self:!0,__source:!0};function CW(t,e,r){var n,a={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)wW.call(e,n)&&!NW.hasOwnProperty(n)&&(a[n]=e[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:Aw,type:t,key:s,ref:o,props:a,_owner:IO.current}}function Afe(t,e){return{$$typeof:Aw,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function PO(t){return typeof t=="object"&&t!==null&&t.$$typeof===Aw}function mfe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var kL=/\/+/g;function K3(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mfe(""+t.key):e.toString(36)}function U_(t,e,r,n,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Aw:case nfe:o=!0}}if(o)return o=t,a=a(o),t=n===""?"."+K3(o,0):n,BL(a)?(r="",t!=null&&(r=t.replace(kL,"$&/")+"/"),U_(a,e,r,"",function(u){return u})):a!=null&&(PO(a)&&(a=Afe(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(kL,"$&/")+"/")+t)),e.push(a)),1;if(o=0,n=n===""?".":n+":",BL(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+K3(s,l);o+=U_(s,e,r,c,a)}else if(c=hfe(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+K3(s,l++),o+=U_(s,e,r,c,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function MN(t,e,r){if(t==null)return t;var n=[],a=0;return U_(t,n,"","",function(s){return e.call(r,s,a++)}),n}function pfe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Dc={current:null},Q_={transition:null},gfe={ReactCurrentDispatcher:Dc,ReactCurrentBatchConfig:Q_,ReactCurrentOwner:IO};function _W(){throw Error("act(...) is not supported in production builds of React.")}ca.Children={map:MN,forEach:function(t,e,r){MN(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return MN(t,function(){e++}),e},toArray:function(t){return MN(t,function(e){return e})||[]},only:function(t){if(!PO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ca.Component=r1;ca.Fragment=afe;ca.Profiler=ife;ca.PureComponent=SO;ca.StrictMode=sfe;ca.Suspense=ufe;ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gfe;ca.act=_W;ca.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=vW({},t.props),a=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=IO.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)wW.call(e,c)&&!NW.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Aw,type:t.type,key:a,ref:s,props:n,_owner:o}};ca.createContext=function(t){return t={$$typeof:lfe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ofe,_context:t},t.Consumer=t};ca.createElement=CW;ca.createFactory=function(t){var e=CW.bind(null,t);return e.type=t,e};ca.createRef=function(){return{current:null}};ca.forwardRef=function(t){return{$$typeof:cfe,render:t}};ca.isValidElement=PO;ca.lazy=function(t){return{$$typeof:ffe,_payload:{_status:-1,_result:t},_init:pfe}};ca.memo=function(t,e){return{$$typeof:dfe,type:t,compare:e===void 0?null:e}};ca.startTransition=function(t){var e=Q_.transition;Q_.transition={};try{t()}finally{Q_.transition=e}};ca.unstable_act=_W;ca.useCallback=function(t,e){return Dc.current.useCallback(t,e)};ca.useContext=function(t){return Dc.current.useContext(t)};ca.useDebugValue=function(){};ca.useDeferredValue=function(t){return Dc.current.useDeferredValue(t)};ca.useEffect=function(t,e){return Dc.current.useEffect(t,e)};ca.useId=function(){return Dc.current.useId()};ca.useImperativeHandle=function(t,e,r){return Dc.current.useImperativeHandle(t,e,r)};ca.useInsertionEffect=function(t,e){return Dc.current.useInsertionEffect(t,e)};ca.useLayoutEffect=function(t,e){return Dc.current.useLayoutEffect(t,e)};ca.useMemo=function(t,e){return Dc.current.useMemo(t,e)};ca.useReducer=function(t,e,r){return Dc.current.useReducer(t,e,r)};ca.useRef=function(t){return Dc.current.useRef(t)};ca.useState=function(t){return Dc.current.useState(t)};ca.useSyncExternalStore=function(t,e,r){return Dc.current.useSyncExternalStore(t,e,r)};ca.useTransition=function(){return Dc.current.useTransition()};ca.version="18.3.1";gW.exports=ca;var g=gW.exports;const oi=TA(g),xfe=rfe({__proto__:null,default:oi},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vfe=g,yfe=Symbol.for("react.element"),bfe=Symbol.for("react.fragment"),wfe=Object.prototype.hasOwnProperty,Nfe=vfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cfe={key:!0,ref:!0,__self:!0,__source:!0};function EW(t,e,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)wfe.call(e,n)&&!Cfe.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:yfe,type:t,key:s,ref:o,props:a,_owner:Nfe.current}}tI.Fragment=bfe;tI.jsx=EW;tI.jsxs=EW;pW.exports=tI;var i=pW.exports,QT={},SW={exports:{}},Ku={},jW={exports:{}},IW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ae,ae){var _e=Ae.length;Ae.push(ae);e:for(;0<_e;){var De=_e-1>>>1,O=Ae[De];if(0<a(O,ae))Ae[De]=ae,Ae[_e]=O,_e=De;else break e}}function r(Ae){return Ae.length===0?null:Ae[0]}function n(Ae){if(Ae.length===0)return null;var ae=Ae[0],_e=Ae.pop();if(_e!==ae){Ae[0]=_e;e:for(var De=0,O=Ae.length,H=O>>>1;De<H;){var K=2*(De+1)-1,R=Ae[K],X=K+1,Y=Ae[X];if(0>a(R,_e))X<O&&0>a(Y,R)?(Ae[De]=Y,Ae[X]=_e,De=X):(Ae[De]=R,Ae[K]=_e,De=K);else if(X<O&&0>a(Y,_e))Ae[De]=Y,Ae[X]=_e,De=X;else break e}}return ae}function a(Ae,ae){var _e=Ae.sortIndex-ae.sortIndex;return _e!==0?_e:Ae.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,A=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(Ae){for(var ae=r(u);ae!==null;){if(ae.callback===null)n(u);else if(ae.startTime<=Ae)n(u),ae.sortIndex=ae.expirationTime,e(c,ae);else break;ae=r(u)}}function w(Ae){if(p=!1,b(Ae),!m)if(r(c)!==null)m=!0,ue(I);else{var ae=r(u);ae!==null&&le(w,ae.startTime-Ae)}}function I(Ae,ae){m=!1,p&&(p=!1,v(S),S=-1),h=!0;var _e=A;try{for(b(ae),f=r(c);f!==null&&(!(f.expirationTime>ae)||Ae&&!k());){var De=f.callback;if(typeof De=="function"){f.callback=null,A=f.priorityLevel;var O=De(f.expirationTime<=ae);ae=t.unstable_now(),typeof O=="function"?f.callback=O:f===r(c)&&n(c),b(ae)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var K=r(u);K!==null&&le(w,K.startTime-ae),H=!1}return H}finally{f=null,A=_e,h=!1}}var j=!1,C=null,S=-1,E=5,B=-1;function k(){return!(t.unstable_now()-B<E)}function T(){if(C!==null){var Ae=t.unstable_now();B=Ae;var ae=!0;try{ae=C(!0,Ae)}finally{ae?P():(j=!1,C=null)}}else j=!1}var P;if(typeof y=="function")P=function(){y(T)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,ce=G.port2;G.port1.onmessage=T,P=function(){ce.postMessage(null)}}else P=function(){x(T,0)};function ue(Ae){C=Ae,j||(j=!0,P())}function le(Ae,ae){S=x(function(){Ae(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ae){Ae.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ue(I))},t.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<Ae?Math.floor(1e3/Ae):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(Ae){switch(A){case 1:case 2:case 3:var ae=3;break;default:ae=A}var _e=A;A=ae;try{return Ae()}finally{A=_e}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ae,ae){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var _e=A;A=Ae;try{return ae()}finally{A=_e}},t.unstable_scheduleCallback=function(Ae,ae,_e){var De=t.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?De+_e:De):_e=De,Ae){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=_e+O,Ae={id:d++,callback:ae,priorityLevel:Ae,startTime:_e,expirationTime:O,sortIndex:-1},_e>De?(Ae.sortIndex=_e,e(u,Ae),r(c)===null&&Ae===r(u)&&(p?(v(S),S=-1):p=!0,le(w,_e-De))):(Ae.sortIndex=O,e(c,Ae),m||h||(m=!0,ue(I))),Ae},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(Ae){var ae=A;return function(){var _e=A;A=ae;try{return Ae.apply(this,arguments)}finally{A=_e}}}})(IW);jW.exports=IW;var _fe=jW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Efe=g,Qu=_fe;function Dr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PW=new Set,qb={};function Bg(t,e){Nv(t,e),Nv(t+"Capture",e)}function Nv(t,e){for(qb[t]=e,t=0;t<e.length;t++)PW.add(e[t])}var hA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),VT=Object.prototype.hasOwnProperty,Sfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,FL={},OL={};function jfe(t){return VT.call(OL,t)?!0:VT.call(FL,t)?!1:Sfe.test(t)?OL[t]=!0:(FL[t]=!0,!1)}function Ife(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Pfe(t,e,r,n){if(e===null||typeof e>"u"||Ife(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rc(t,e,r,n,a,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Fl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Fl[t]=new Rc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Fl[e]=new Rc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Fl[t]=new Rc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Fl[t]=new Rc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Fl[t]=new Rc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Fl[t]=new Rc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Fl[t]=new Rc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Fl[t]=new Rc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Fl[t]=new Rc(t,5,!1,t.toLowerCase(),null,!1,!1)});var TO=/[\-:]([a-z])/g;function BO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(TO,BO);Fl[e]=new Rc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(TO,BO);Fl[e]=new Rc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(TO,BO);Fl[e]=new Rc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Fl[t]=new Rc(t,1,!1,t.toLowerCase(),null,!1,!1)});Fl.xlinkHref=new Rc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Fl[t]=new Rc(t,1,!1,t.toLowerCase(),null,!0,!0)});function kO(t,e,r,n){var a=Fl.hasOwnProperty(e)?Fl[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Pfe(e,r,a,n)&&(r=null),n||a===null?jfe(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var BA=Efe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,LN=Symbol.for("react.element"),Rx=Symbol.for("react.portal"),Mx=Symbol.for("react.fragment"),FO=Symbol.for("react.strict_mode"),HT=Symbol.for("react.profiler"),TW=Symbol.for("react.provider"),BW=Symbol.for("react.context"),OO=Symbol.for("react.forward_ref"),$T=Symbol.for("react.suspense"),GT=Symbol.for("react.suspense_list"),DO=Symbol.for("react.memo"),j0=Symbol.for("react.lazy"),kW=Symbol.for("react.offscreen"),DL=Symbol.iterator;function J1(t){return t===null||typeof t!="object"?null:(t=DL&&t[DL]||t["@@iterator"],typeof t=="function"?t:null)}var hi=Object.assign,q3;function Dy(t){if(q3===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);q3=e&&e[1]||""}return`
`+q3+t}var z3=!1;function W3(t,e){if(!t||z3)return"";z3=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{z3=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Dy(t):""}function Tfe(t){switch(t.tag){case 5:return Dy(t.type);case 16:return Dy("Lazy");case 13:return Dy("Suspense");case 19:return Dy("SuspenseList");case 0:case 2:case 15:return t=W3(t.type,!1),t;case 11:return t=W3(t.type.render,!1),t;case 1:return t=W3(t.type,!0),t;default:return""}}function KT(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Mx:return"Fragment";case Rx:return"Portal";case HT:return"Profiler";case FO:return"StrictMode";case $T:return"Suspense";case GT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case BW:return(t.displayName||"Context")+".Consumer";case TW:return(t._context.displayName||"Context")+".Provider";case OO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case DO:return e=t.displayName||null,e!==null?e:KT(t.type)||"Memo";case j0:e=t._payload,t=t._init;try{return KT(t(e))}catch{}}return null}function Bfe(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return KT(e);case 8:return e===FO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vm(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function FW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kfe(t){var e=FW(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function UN(t){t._valueTracker||(t._valueTracker=kfe(t))}function OW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=FW(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function PE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qT(t,e){var r=e.checked;return hi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function RL(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=vm(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function DW(t,e){e=e.checked,e!=null&&kO(t,"checked",e,!1)}function zT(t,e){DW(t,e);var r=vm(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?WT(t,e.type,r):e.hasOwnProperty("defaultValue")&&WT(t,e.type,vm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ML(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function WT(t,e,r){(e!=="number"||PE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ry=Array.isArray;function sv(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+vm(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function XT(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Dr(91));return hi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function LL(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Dr(92));if(Ry(r)){if(1<r.length)throw Error(Dr(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:vm(r)}}function RW(t,e){var r=vm(e.value),n=vm(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function UL(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function MW(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function YT(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?MW(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var QN,LW=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(QN=QN||document.createElement("div"),QN.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=QN.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zb(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var lb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ffe=["Webkit","ms","Moz","O"];Object.keys(lb).forEach(function(t){Ffe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lb[e]=lb[t]})});function UW(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||lb.hasOwnProperty(t)&&lb[t]?(""+e).trim():e+"px"}function QW(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=UW(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var Ofe=hi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function JT(t,e){if(e){if(Ofe[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Dr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Dr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Dr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Dr(62))}}function ZT(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eB=null;function RO(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var tB=null,iv=null,ov=null;function QL(t){if(t=gw(t)){if(typeof tB!="function")throw Error(Dr(280));var e=t.stateNode;e&&(e=iI(e),tB(t.stateNode,t.type,e))}}function VW(t){iv?ov?ov.push(t):ov=[t]:iv=t}function HW(){if(iv){var t=iv,e=ov;if(ov=iv=null,QL(t),e)for(t=0;t<e.length;t++)QL(e[t])}}function $W(t,e){return t(e)}function GW(){}var X3=!1;function KW(t,e,r){if(X3)return t(e,r);X3=!0;try{return $W(t,e,r)}finally{X3=!1,(iv!==null||ov!==null)&&(GW(),HW())}}function Wb(t,e){var r=t.stateNode;if(r===null)return null;var n=iI(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Dr(231,e,typeof r));return r}var rB=!1;if(hA)try{var Z1={};Object.defineProperty(Z1,"passive",{get:function(){rB=!0}}),window.addEventListener("test",Z1,Z1),window.removeEventListener("test",Z1,Z1)}catch{rB=!1}function Dfe(t,e,r,n,a,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var cb=!1,TE=null,BE=!1,nB=null,Rfe={onError:function(t){cb=!0,TE=t}};function Mfe(t,e,r,n,a,s,o,l,c){cb=!1,TE=null,Dfe.apply(Rfe,arguments)}function Lfe(t,e,r,n,a,s,o,l,c){if(Mfe.apply(this,arguments),cb){if(cb){var u=TE;cb=!1,TE=null}else throw Error(Dr(198));BE||(BE=!0,nB=u)}}function kg(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function qW(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function VL(t){if(kg(t)!==t)throw Error(Dr(188))}function Ufe(t){var e=t.alternate;if(!e){if(e=kg(t),e===null)throw Error(Dr(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return VL(a),t;if(s===n)return VL(a),e;s=s.sibling}throw Error(Dr(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(Dr(189))}}if(r.alternate!==n)throw Error(Dr(190))}if(r.tag!==3)throw Error(Dr(188));return r.stateNode.current===r?t:e}function zW(t){return t=Ufe(t),t!==null?WW(t):null}function WW(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=WW(t);if(e!==null)return e;t=t.sibling}return null}var XW=Qu.unstable_scheduleCallback,HL=Qu.unstable_cancelCallback,Qfe=Qu.unstable_shouldYield,Vfe=Qu.unstable_requestPaint,Hi=Qu.unstable_now,Hfe=Qu.unstable_getCurrentPriorityLevel,MO=Qu.unstable_ImmediatePriority,YW=Qu.unstable_UserBlockingPriority,kE=Qu.unstable_NormalPriority,$fe=Qu.unstable_LowPriority,JW=Qu.unstable_IdlePriority,rI=null,ah=null;function Gfe(t){if(ah&&typeof ah.onCommitFiberRoot=="function")try{ah.onCommitFiberRoot(rI,t,void 0,(t.current.flags&128)===128)}catch{}}var gf=Math.clz32?Math.clz32:zfe,Kfe=Math.log,qfe=Math.LN2;function zfe(t){return t>>>=0,t===0?32:31-(Kfe(t)/qfe|0)|0}var VN=64,HN=4194304;function My(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function FE(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=My(l):(s&=o,s!==0&&(n=My(s)))}else o=r&~a,o!==0?n=My(o):s!==0&&(n=My(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-gf(e),a=1<<r,n|=t[r],e&=~a;return n}function Wfe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xfe(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-gf(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=Wfe(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function aB(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ZW(){var t=VN;return VN<<=1,!(VN&4194240)&&(VN=64),t}function Y3(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function mw(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gf(e),t[e]=r}function Yfe(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-gf(r),s=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~s}}function LO(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-gf(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var as=0;function eX(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var tX,UO,rX,nX,aX,sB=!1,$N=[],tm=null,rm=null,nm=null,Xb=new Map,Yb=new Map,F0=[],Jfe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $L(t,e){switch(t){case"focusin":case"focusout":tm=null;break;case"dragenter":case"dragleave":rm=null;break;case"mouseover":case"mouseout":nm=null;break;case"pointerover":case"pointerout":Xb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yb.delete(e.pointerId)}}function ey(t,e,r,n,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},e!==null&&(e=gw(e),e!==null&&UO(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Zfe(t,e,r,n,a){switch(e){case"focusin":return tm=ey(tm,t,e,r,n,a),!0;case"dragenter":return rm=ey(rm,t,e,r,n,a),!0;case"mouseover":return nm=ey(nm,t,e,r,n,a),!0;case"pointerover":var s=a.pointerId;return Xb.set(s,ey(Xb.get(s)||null,t,e,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Yb.set(s,ey(Yb.get(s)||null,t,e,r,n,a)),!0}return!1}function sX(t){var e=_p(t.target);if(e!==null){var r=kg(e);if(r!==null){if(e=r.tag,e===13){if(e=qW(r),e!==null){t.blockedOn=e,aX(t.priority,function(){rX(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function V_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=iB(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);eB=n,r.target.dispatchEvent(n),eB=null}else return e=gw(r),e!==null&&UO(e),t.blockedOn=r,!1;e.shift()}return!0}function GL(t,e,r){V_(t)&&r.delete(e)}function ehe(){sB=!1,tm!==null&&V_(tm)&&(tm=null),rm!==null&&V_(rm)&&(rm=null),nm!==null&&V_(nm)&&(nm=null),Xb.forEach(GL),Yb.forEach(GL)}function ty(t,e){t.blockedOn===e&&(t.blockedOn=null,sB||(sB=!0,Qu.unstable_scheduleCallback(Qu.unstable_NormalPriority,ehe)))}function Jb(t){function e(a){return ty(a,t)}if(0<$N.length){ty($N[0],t);for(var r=1;r<$N.length;r++){var n=$N[r];n.blockedOn===t&&(n.blockedOn=null)}}for(tm!==null&&ty(tm,t),rm!==null&&ty(rm,t),nm!==null&&ty(nm,t),Xb.forEach(e),Yb.forEach(e),r=0;r<F0.length;r++)n=F0[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<F0.length&&(r=F0[0],r.blockedOn===null);)sX(r),r.blockedOn===null&&F0.shift()}var lv=BA.ReactCurrentBatchConfig,OE=!0;function the(t,e,r,n){var a=as,s=lv.transition;lv.transition=null;try{as=1,QO(t,e,r,n)}finally{as=a,lv.transition=s}}function rhe(t,e,r,n){var a=as,s=lv.transition;lv.transition=null;try{as=4,QO(t,e,r,n)}finally{as=a,lv.transition=s}}function QO(t,e,r,n){if(OE){var a=iB(t,e,r,n);if(a===null)o4(t,e,n,DE,r),$L(t,n);else if(Zfe(a,t,e,r,n))n.stopPropagation();else if($L(t,n),e&4&&-1<Jfe.indexOf(t)){for(;a!==null;){var s=gw(a);if(s!==null&&tX(s),s=iB(t,e,r,n),s===null&&o4(t,e,n,DE,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else o4(t,e,n,null,r)}}var DE=null;function iB(t,e,r,n){if(DE=null,t=RO(n),t=_p(t),t!==null)if(e=kg(t),e===null)t=null;else if(r=e.tag,r===13){if(t=qW(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return DE=t,null}function iX(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hfe()){case MO:return 1;case YW:return 4;case kE:case $fe:return 16;case JW:return 536870912;default:return 16}default:return 16}}var G0=null,VO=null,H_=null;function oX(){if(H_)return H_;var t,e=VO,r=e.length,n,a="value"in G0?G0.value:G0.textContent,s=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===a[s-n];n++);return H_=a.slice(t,1<n?1-n:void 0)}function $_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function GN(){return!0}function KL(){return!1}function qu(t){function e(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?GN:KL,this.isPropagationStopped=KL,this}return hi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=GN)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=GN)},persist:function(){},isPersistent:GN}),e}var n1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},HO=qu(n1),pw=hi({},n1,{view:0,detail:0}),nhe=qu(pw),J3,Z3,ry,nI=hi({},pw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$O,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ry&&(ry&&t.type==="mousemove"?(J3=t.screenX-ry.screenX,Z3=t.screenY-ry.screenY):Z3=J3=0,ry=t),J3)},movementY:function(t){return"movementY"in t?t.movementY:Z3}}),qL=qu(nI),ahe=hi({},nI,{dataTransfer:0}),she=qu(ahe),ihe=hi({},pw,{relatedTarget:0}),e4=qu(ihe),ohe=hi({},n1,{animationName:0,elapsedTime:0,pseudoElement:0}),lhe=qu(ohe),che=hi({},n1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uhe=qu(che),dhe=hi({},n1,{data:0}),zL=qu(dhe),fhe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hhe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ahe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mhe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ahe[t])?!!e[t]:!1}function $O(){return mhe}var phe=hi({},pw,{key:function(t){if(t.key){var e=fhe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hhe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$O,charCode:function(t){return t.type==="keypress"?$_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ghe=qu(phe),xhe=hi({},nI,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),WL=qu(xhe),vhe=hi({},pw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$O}),yhe=qu(vhe),bhe=hi({},n1,{propertyName:0,elapsedTime:0,pseudoElement:0}),whe=qu(bhe),Nhe=hi({},nI,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Che=qu(Nhe),_he=[9,13,27,32],GO=hA&&"CompositionEvent"in window,ub=null;hA&&"documentMode"in document&&(ub=document.documentMode);var Ehe=hA&&"TextEvent"in window&&!ub,lX=hA&&(!GO||ub&&8<ub&&11>=ub),XL=" ",YL=!1;function cX(t,e){switch(t){case"keyup":return _he.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uX(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lx=!1;function She(t,e){switch(t){case"compositionend":return uX(e);case"keypress":return e.which!==32?null:(YL=!0,XL);case"textInput":return t=e.data,t===XL&&YL?null:t;default:return null}}function jhe(t,e){if(Lx)return t==="compositionend"||!GO&&cX(t,e)?(t=oX(),H_=VO=G0=null,Lx=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lX&&e.locale!=="ko"?null:e.data;default:return null}}var Ihe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function JL(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ihe[t.type]:e==="textarea"}function dX(t,e,r,n){VW(n),e=RE(e,"onChange"),0<e.length&&(r=new HO("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var db=null,Zb=null;function Phe(t){wX(t,0)}function aI(t){var e=Vx(t);if(OW(e))return t}function The(t,e){if(t==="change")return e}var fX=!1;if(hA){var t4;if(hA){var r4="oninput"in document;if(!r4){var ZL=document.createElement("div");ZL.setAttribute("oninput","return;"),r4=typeof ZL.oninput=="function"}t4=r4}else t4=!1;fX=t4&&(!document.documentMode||9<document.documentMode)}function eU(){db&&(db.detachEvent("onpropertychange",hX),Zb=db=null)}function hX(t){if(t.propertyName==="value"&&aI(Zb)){var e=[];dX(e,Zb,t,RO(t)),KW(Phe,e)}}function Bhe(t,e,r){t==="focusin"?(eU(),db=e,Zb=r,db.attachEvent("onpropertychange",hX)):t==="focusout"&&eU()}function khe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return aI(Zb)}function Fhe(t,e){if(t==="click")return aI(e)}function Ohe(t,e){if(t==="input"||t==="change")return aI(e)}function Dhe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nf=typeof Object.is=="function"?Object.is:Dhe;function e2(t,e){if(Nf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!VT.call(e,a)||!Nf(t[a],e[a]))return!1}return!0}function tU(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rU(t,e){var r=tU(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=tU(r)}}function AX(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?AX(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mX(){for(var t=window,e=PE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=PE(t.document)}return e}function KO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Rhe(t){var e=mX(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&AX(r.ownerDocument.documentElement,r)){if(n!==null&&KO(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!t.extend&&s>n&&(a=n,n=s,s=a),a=rU(r,s);var o=rU(r,n);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Mhe=hA&&"documentMode"in document&&11>=document.documentMode,Ux=null,oB=null,fb=null,lB=!1;function nU(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lB||Ux==null||Ux!==PE(n)||(n=Ux,"selectionStart"in n&&KO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),fb&&e2(fb,n)||(fb=n,n=RE(oB,"onSelect"),0<n.length&&(e=new HO("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ux)))}function KN(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Qx={animationend:KN("Animation","AnimationEnd"),animationiteration:KN("Animation","AnimationIteration"),animationstart:KN("Animation","AnimationStart"),transitionend:KN("Transition","TransitionEnd")},n4={},pX={};hA&&(pX=document.createElement("div").style,"AnimationEvent"in window||(delete Qx.animationend.animation,delete Qx.animationiteration.animation,delete Qx.animationstart.animation),"TransitionEvent"in window||delete Qx.transitionend.transition);function sI(t){if(n4[t])return n4[t];if(!Qx[t])return t;var e=Qx[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in pX)return n4[t]=e[r];return t}var gX=sI("animationend"),xX=sI("animationiteration"),vX=sI("animationstart"),yX=sI("transitionend"),bX=new Map,aU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rm(t,e){bX.set(t,e),Bg(e,[t])}for(var a4=0;a4<aU.length;a4++){var s4=aU[a4],Lhe=s4.toLowerCase(),Uhe=s4[0].toUpperCase()+s4.slice(1);Rm(Lhe,"on"+Uhe)}Rm(gX,"onAnimationEnd");Rm(xX,"onAnimationIteration");Rm(vX,"onAnimationStart");Rm("dblclick","onDoubleClick");Rm("focusin","onFocus");Rm("focusout","onBlur");Rm(yX,"onTransitionEnd");Nv("onMouseEnter",["mouseout","mouseover"]);Nv("onMouseLeave",["mouseout","mouseover"]);Nv("onPointerEnter",["pointerout","pointerover"]);Nv("onPointerLeave",["pointerout","pointerover"]);Bg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ly="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qhe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ly));function sU(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Lfe(n,e,void 0,t),t.currentTarget=null}function wX(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;sU(a,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;sU(a,l,u),s=c}}}if(BE)throw t=nB,BE=!1,nB=null,t}function Is(t,e){var r=e[hB];r===void 0&&(r=e[hB]=new Set);var n=t+"__bubble";r.has(n)||(NX(e,t,2,!1),r.add(n))}function i4(t,e,r){var n=0;e&&(n|=4),NX(r,t,n,e)}var qN="_reactListening"+Math.random().toString(36).slice(2);function t2(t){if(!t[qN]){t[qN]=!0,PW.forEach(function(r){r!=="selectionchange"&&(Qhe.has(r)||i4(r,!1,t),i4(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[qN]||(e[qN]=!0,i4("selectionchange",!1,e))}}function NX(t,e,r,n){switch(iX(e)){case 1:var a=the;break;case 4:a=rhe;break;default:a=QO}r=a.bind(null,e,r,t),a=void 0,!rB||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function o4(t,e,r,n,a){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=_p(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}KW(function(){var u=s,d=RO(r),f=[];e:{var A=bX.get(t);if(A!==void 0){var h=HO,m=t;switch(t){case"keypress":if($_(r)===0)break e;case"keydown":case"keyup":h=ghe;break;case"focusin":m="focus",h=e4;break;case"focusout":m="blur",h=e4;break;case"beforeblur":case"afterblur":h=e4;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=qL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=she;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=yhe;break;case gX:case xX:case vX:h=lhe;break;case yX:h=whe;break;case"scroll":h=nhe;break;case"wheel":h=Che;break;case"copy":case"cut":case"paste":h=uhe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=WL}var p=(e&4)!==0,x=!p&&t==="scroll",v=p?A!==null?A+"Capture":null:A;p=[];for(var y=u,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Wb(y,v),w!=null&&p.push(r2(y,w,b)))),x)break;y=y.return}0<p.length&&(A=new h(A,m,null,r,d),f.push({event:A,listeners:p}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",A&&r!==eB&&(m=r.relatedTarget||r.fromElement)&&(_p(m)||m[AA]))break e;if((h||A)&&(A=d.window===d?d:(A=d.ownerDocument)?A.defaultView||A.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?_p(m):null,m!==null&&(x=kg(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(p=qL,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=WL,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=h==null?A:Vx(h),b=m==null?A:Vx(m),A=new p(w,y+"leave",h,r,d),A.target=x,A.relatedTarget=b,w=null,_p(d)===u&&(p=new p(v,y+"enter",m,r,d),p.target=b,p.relatedTarget=x,w=p),x=w,h&&m)t:{for(p=h,v=m,y=0,b=p;b;b=tx(b))y++;for(b=0,w=v;w;w=tx(w))b++;for(;0<y-b;)p=tx(p),y--;for(;0<b-y;)v=tx(v),b--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=tx(p),v=tx(v)}p=null}else p=null;h!==null&&iU(f,A,h,p,!1),m!==null&&x!==null&&iU(f,x,m,p,!0)}}e:{if(A=u?Vx(u):window,h=A.nodeName&&A.nodeName.toLowerCase(),h==="select"||h==="input"&&A.type==="file")var I=The;else if(JL(A))if(fX)I=Ohe;else{I=khe;var j=Bhe}else(h=A.nodeName)&&h.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(I=Fhe);if(I&&(I=I(t,u))){dX(f,I,r,d);break e}j&&j(t,A,u),t==="focusout"&&(j=A._wrapperState)&&j.controlled&&A.type==="number"&&WT(A,"number",A.value)}switch(j=u?Vx(u):window,t){case"focusin":(JL(j)||j.contentEditable==="true")&&(Ux=j,oB=u,fb=null);break;case"focusout":fb=oB=Ux=null;break;case"mousedown":lB=!0;break;case"contextmenu":case"mouseup":case"dragend":lB=!1,nU(f,r,d);break;case"selectionchange":if(Mhe)break;case"keydown":case"keyup":nU(f,r,d)}var C;if(GO)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Lx?cX(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(lX&&r.locale!=="ko"&&(Lx||S!=="onCompositionStart"?S==="onCompositionEnd"&&Lx&&(C=oX()):(G0=d,VO="value"in G0?G0.value:G0.textContent,Lx=!0)),j=RE(u,S),0<j.length&&(S=new zL(S,t,null,r,d),f.push({event:S,listeners:j}),C?S.data=C:(C=uX(r),C!==null&&(S.data=C)))),(C=Ehe?She(t,r):jhe(t,r))&&(u=RE(u,"onBeforeInput"),0<u.length&&(d=new zL("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=C))}wX(f,e)})}function r2(t,e,r){return{instance:t,listener:e,currentTarget:r}}function RE(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Wb(t,r),s!=null&&n.unshift(r2(t,s,a)),s=Wb(t,e),s!=null&&n.push(r2(t,s,a))),t=t.return}return n}function tx(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function iU(t,e,r,n,a){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Wb(r,s),c!=null&&o.unshift(r2(r,c,l))):a||(c=Wb(r,s),c!=null&&o.push(r2(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Vhe=/\r\n?/g,Hhe=/\u0000|\uFFFD/g;function oU(t){return(typeof t=="string"?t:""+t).replace(Vhe,`
`).replace(Hhe,"")}function zN(t,e,r){if(e=oU(e),oU(t)!==e&&r)throw Error(Dr(425))}function ME(){}var cB=null,uB=null;function dB(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fB=typeof setTimeout=="function"?setTimeout:void 0,$he=typeof clearTimeout=="function"?clearTimeout:void 0,lU=typeof Promise=="function"?Promise:void 0,Ghe=typeof queueMicrotask=="function"?queueMicrotask:typeof lU<"u"?function(t){return lU.resolve(null).then(t).catch(Khe)}:fB;function Khe(t){setTimeout(function(){throw t})}function l4(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),Jb(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Jb(e)}function am(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function cU(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var a1=Math.random().toString(36).slice(2),zf="__reactFiber$"+a1,n2="__reactProps$"+a1,AA="__reactContainer$"+a1,hB="__reactEvents$"+a1,qhe="__reactListeners$"+a1,zhe="__reactHandles$"+a1;function _p(t){var e=t[zf];if(e)return e;for(var r=t.parentNode;r;){if(e=r[AA]||r[zf]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=cU(t);t!==null;){if(r=t[zf])return r;t=cU(t)}return e}t=r,r=t.parentNode}return null}function gw(t){return t=t[zf]||t[AA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vx(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Dr(33))}function iI(t){return t[n2]||null}var AB=[],Hx=-1;function Mm(t){return{current:t}}function Os(t){0>Hx||(t.current=AB[Hx],AB[Hx]=null,Hx--)}function Ns(t,e){Hx++,AB[Hx]=t.current,t.current=e}var ym={},uc=Mm(ym),su=Mm(!1),eg=ym;function Cv(t,e){var r=t.type.contextTypes;if(!r)return ym;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function iu(t){return t=t.childContextTypes,t!=null}function LE(){Os(su),Os(uc)}function uU(t,e,r){if(uc.current!==ym)throw Error(Dr(168));Ns(uc,e),Ns(su,r)}function CX(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(Dr(108,Bfe(t)||"Unknown",a));return hi({},r,n)}function UE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ym,eg=uc.current,Ns(uc,t),Ns(su,su.current),!0}function dU(t,e,r){var n=t.stateNode;if(!n)throw Error(Dr(169));r?(t=CX(t,e,eg),n.__reactInternalMemoizedMergedChildContext=t,Os(su),Os(uc),Ns(uc,t)):Os(su),Ns(su,r)}var Qh=null,oI=!1,c4=!1;function _X(t){Qh===null?Qh=[t]:Qh.push(t)}function Whe(t){oI=!0,_X(t)}function Lm(){if(!c4&&Qh!==null){c4=!0;var t=0,e=as;try{var r=Qh;for(as=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Qh=null,oI=!1}catch(a){throw Qh!==null&&(Qh=Qh.slice(t+1)),XW(MO,Lm),a}finally{as=e,c4=!1}}return null}var $x=[],Gx=0,QE=null,VE=0,vd=[],yd=0,tg=null,Kh=1,qh="";function cp(t,e){$x[Gx++]=VE,$x[Gx++]=QE,QE=t,VE=e}function EX(t,e,r){vd[yd++]=Kh,vd[yd++]=qh,vd[yd++]=tg,tg=t;var n=Kh;t=qh;var a=32-gf(n)-1;n&=~(1<<a),r+=1;var s=32-gf(e)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Kh=1<<32-gf(e)+a|r<<a|n,qh=s+t}else Kh=1<<s|r<<a|n,qh=t}function qO(t){t.return!==null&&(cp(t,1),EX(t,1,0))}function zO(t){for(;t===QE;)QE=$x[--Gx],$x[Gx]=null,VE=$x[--Gx],$x[Gx]=null;for(;t===tg;)tg=vd[--yd],vd[yd]=null,qh=vd[--yd],vd[yd]=null,Kh=vd[--yd],vd[yd]=null}var Mu=null,Fu=null,$s=!1,cf=null;function SX(t,e){var r=wd(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function fU(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Mu=t,Fu=am(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Mu=t,Fu=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=tg!==null?{id:Kh,overflow:qh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=wd(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Mu=t,Fu=null,!0):!1;default:return!1}}function mB(t){return(t.mode&1)!==0&&(t.flags&128)===0}function pB(t){if($s){var e=Fu;if(e){var r=e;if(!fU(t,e)){if(mB(t))throw Error(Dr(418));e=am(r.nextSibling);var n=Mu;e&&fU(t,e)?SX(n,r):(t.flags=t.flags&-4097|2,$s=!1,Mu=t)}}else{if(mB(t))throw Error(Dr(418));t.flags=t.flags&-4097|2,$s=!1,Mu=t}}}function hU(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Mu=t}function WN(t){if(t!==Mu)return!1;if(!$s)return hU(t),$s=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!dB(t.type,t.memoizedProps)),e&&(e=Fu)){if(mB(t))throw jX(),Error(Dr(418));for(;e;)SX(t,e),e=am(e.nextSibling)}if(hU(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Dr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Fu=am(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Fu=null}}else Fu=Mu?am(t.stateNode.nextSibling):null;return!0}function jX(){for(var t=Fu;t;)t=am(t.nextSibling)}function _v(){Fu=Mu=null,$s=!1}function WO(t){cf===null?cf=[t]:cf.push(t)}var Xhe=BA.ReactCurrentBatchConfig;function ny(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Dr(309));var n=r.stateNode}if(!n)throw Error(Dr(147,t));var a=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Dr(284));if(!r._owner)throw Error(Dr(290,t))}return t}function XN(t,e){throw t=Object.prototype.toString.call(e),Error(Dr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function AU(t){var e=t._init;return e(t._payload)}function IX(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=lm(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=p4(b,v.mode,w),y.return=v,y):(y=a(y,b),y.return=v,y)}function c(v,y,b,w){var I=b.type;return I===Mx?d(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===j0&&AU(I)===y.type)?(w=a(y,b.props),w.ref=ny(v,y,b),w.return=v,w):(w=Y_(b.type,b.key,b.props,null,v.mode,w),w.ref=ny(v,y,b),w.return=v,w)}function u(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=g4(b,v.mode,w),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function d(v,y,b,w,I){return y===null||y.tag!==7?(y=Rp(b,v.mode,w,I),y.return=v,y):(y=a(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=p4(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case LN:return b=Y_(y.type,y.key,y.props,null,v.mode,b),b.ref=ny(v,null,y),b.return=v,b;case Rx:return y=g4(y,v.mode,b),y.return=v,y;case j0:var w=y._init;return f(v,w(y._payload),b)}if(Ry(y)||J1(y))return y=Rp(y,v.mode,b,null),y.return=v,y;XN(v,y)}return null}function A(v,y,b,w){var I=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return I!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case LN:return b.key===I?c(v,y,b,w):null;case Rx:return b.key===I?u(v,y,b,w):null;case j0:return I=b._init,A(v,y,I(b._payload),w)}if(Ry(b)||J1(b))return I!==null?null:d(v,y,b,w,null);XN(v,b)}return null}function h(v,y,b,w,I){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,I);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case LN:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,I);case Rx:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,I);case j0:var j=w._init;return h(v,y,b,j(w._payload),I)}if(Ry(w)||J1(w))return v=v.get(b)||null,d(y,v,w,I,null);XN(y,w)}return null}function m(v,y,b,w){for(var I=null,j=null,C=y,S=y=0,E=null;C!==null&&S<b.length;S++){C.index>S?(E=C,C=null):E=C.sibling;var B=A(v,C,b[S],w);if(B===null){C===null&&(C=E);break}t&&C&&B.alternate===null&&e(v,C),y=s(B,y,S),j===null?I=B:j.sibling=B,j=B,C=E}if(S===b.length)return r(v,C),$s&&cp(v,S),I;if(C===null){for(;S<b.length;S++)C=f(v,b[S],w),C!==null&&(y=s(C,y,S),j===null?I=C:j.sibling=C,j=C);return $s&&cp(v,S),I}for(C=n(v,C);S<b.length;S++)E=h(C,v,S,b[S],w),E!==null&&(t&&E.alternate!==null&&C.delete(E.key===null?S:E.key),y=s(E,y,S),j===null?I=E:j.sibling=E,j=E);return t&&C.forEach(function(k){return e(v,k)}),$s&&cp(v,S),I}function p(v,y,b,w){var I=J1(b);if(typeof I!="function")throw Error(Dr(150));if(b=I.call(b),b==null)throw Error(Dr(151));for(var j=I=null,C=y,S=y=0,E=null,B=b.next();C!==null&&!B.done;S++,B=b.next()){C.index>S?(E=C,C=null):E=C.sibling;var k=A(v,C,B.value,w);if(k===null){C===null&&(C=E);break}t&&C&&k.alternate===null&&e(v,C),y=s(k,y,S),j===null?I=k:j.sibling=k,j=k,C=E}if(B.done)return r(v,C),$s&&cp(v,S),I;if(C===null){for(;!B.done;S++,B=b.next())B=f(v,B.value,w),B!==null&&(y=s(B,y,S),j===null?I=B:j.sibling=B,j=B);return $s&&cp(v,S),I}for(C=n(v,C);!B.done;S++,B=b.next())B=h(C,v,S,B.value,w),B!==null&&(t&&B.alternate!==null&&C.delete(B.key===null?S:B.key),y=s(B,y,S),j===null?I=B:j.sibling=B,j=B);return t&&C.forEach(function(T){return e(v,T)}),$s&&cp(v,S),I}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Mx&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case LN:e:{for(var I=b.key,j=y;j!==null;){if(j.key===I){if(I=b.type,I===Mx){if(j.tag===7){r(v,j.sibling),y=a(j,b.props.children),y.return=v,v=y;break e}}else if(j.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===j0&&AU(I)===j.type){r(v,j.sibling),y=a(j,b.props),y.ref=ny(v,j,b),y.return=v,v=y;break e}r(v,j);break}else e(v,j);j=j.sibling}b.type===Mx?(y=Rp(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=Y_(b.type,b.key,b.props,null,v.mode,w),w.ref=ny(v,y,b),w.return=v,v=w)}return o(v);case Rx:e:{for(j=b.key;y!==null;){if(y.key===j)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=g4(b,v.mode,w),y.return=v,v=y}return o(v);case j0:return j=b._init,x(v,y,j(b._payload),w)}if(Ry(b))return m(v,y,b,w);if(J1(b))return p(v,y,b,w);XN(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=p4(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return x}var Ev=IX(!0),PX=IX(!1),HE=Mm(null),$E=null,Kx=null,XO=null;function YO(){XO=Kx=$E=null}function JO(t){var e=HE.current;Os(HE),t._currentValue=e}function gB(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function cv(t,e){$E=t,XO=Kx=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ru=!0),t.firstContext=null)}function kd(t){var e=t._currentValue;if(XO!==t)if(t={context:t,memoizedValue:e,next:null},Kx===null){if($E===null)throw Error(Dr(308));Kx=t,$E.dependencies={lanes:0,firstContext:t}}else Kx=Kx.next=t;return e}var Ep=null;function ZO(t){Ep===null?Ep=[t]:Ep.push(t)}function TX(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,ZO(e)):(r.next=a.next,a.next=r),e.interleaved=r,mA(t,n)}function mA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var I0=!1;function eD(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function BX(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function rA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function sm(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ea&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,mA(t,r)}return a=n.interleaved,a===null?(e.next=e,ZO(n)):(e.next=a.next,a.next=e),n.interleaved=e,mA(t,r)}function G_(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,LO(t,r)}}function mU(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=e:s=s.next=e}else a=s=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function GE(t,e,r,n){var a=t.updateQueue;I0=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;o=0,d=u=c=null,l=s;do{var A=l.lane,h=l.eventTime;if((n&A)===A){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(A=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(h,f,A);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,A=typeof m=="function"?m.call(h,f,A):m,A==null)break e;f=hi({},f,A);break e;case 2:I0=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=a.effects,A===null?a.effects=[l]:A.push(l))}else h={eventTime:h,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=A;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;A=l,l=A.next,A.next=null,a.lastBaseUpdate=A,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);ng|=o,t.lanes=o,t.memoizedState=f}}function pU(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Dr(191,a));a.call(n)}}}var xw={},sh=Mm(xw),a2=Mm(xw),s2=Mm(xw);function Sp(t){if(t===xw)throw Error(Dr(174));return t}function tD(t,e){switch(Ns(s2,e),Ns(a2,t),Ns(sh,xw),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:YT(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=YT(e,t)}Os(sh),Ns(sh,e)}function Sv(){Os(sh),Os(a2),Os(s2)}function kX(t){Sp(s2.current);var e=Sp(sh.current),r=YT(e,t.type);e!==r&&(Ns(a2,t),Ns(sh,r))}function rD(t){a2.current===t&&(Os(sh),Os(a2))}var li=Mm(0);function KE(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var u4=[];function nD(){for(var t=0;t<u4.length;t++)u4[t]._workInProgressVersionPrimary=null;u4.length=0}var K_=BA.ReactCurrentDispatcher,d4=BA.ReactCurrentBatchConfig,rg=0,fi=null,Co=null,Jo=null,qE=!1,hb=!1,i2=0,Yhe=0;function Ul(){throw Error(Dr(321))}function aD(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Nf(t[r],e[r]))return!1;return!0}function sD(t,e,r,n,a,s){if(rg=s,fi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,K_.current=t===null||t.memoizedState===null?tAe:rAe,t=r(n,a),hb){s=0;do{if(hb=!1,i2=0,25<=s)throw Error(Dr(301));s+=1,Jo=Co=null,e.updateQueue=null,K_.current=nAe,t=r(n,a)}while(hb)}if(K_.current=zE,e=Co!==null&&Co.next!==null,rg=0,Jo=Co=fi=null,qE=!1,e)throw Error(Dr(300));return t}function iD(){var t=i2!==0;return i2=0,t}function qf(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jo===null?fi.memoizedState=Jo=t:Jo=Jo.next=t,Jo}function Fd(){if(Co===null){var t=fi.alternate;t=t!==null?t.memoizedState:null}else t=Co.next;var e=Jo===null?fi.memoizedState:Jo.next;if(e!==null)Jo=e,Co=t;else{if(t===null)throw Error(Dr(310));Co=t,t={memoizedState:Co.memoizedState,baseState:Co.baseState,baseQueue:Co.baseQueue,queue:Co.queue,next:null},Jo===null?fi.memoizedState=Jo=t:Jo=Jo.next=t}return Jo}function o2(t,e){return typeof e=="function"?e(t):e}function f4(t){var e=Fd(),r=e.queue;if(r===null)throw Error(Dr(311));r.lastRenderedReducer=t;var n=Co,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((rg&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,fi.lanes|=d,ng|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,Nf(n,e.memoizedState)||(ru=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do s=a.lane,fi.lanes|=s,ng|=s,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function h4(t){var e=Fd(),r=e.queue;if(r===null)throw Error(Dr(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,s=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=t(s,o.action),o=o.next;while(o!==a);Nf(s,e.memoizedState)||(ru=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function FX(){}function OX(t,e){var r=fi,n=Fd(),a=e(),s=!Nf(n.memoizedState,a);if(s&&(n.memoizedState=a,ru=!0),n=n.queue,oD(MX.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Jo!==null&&Jo.memoizedState.tag&1){if(r.flags|=2048,l2(9,RX.bind(null,r,n,a,e),void 0,null),rl===null)throw Error(Dr(349));rg&30||DX(r,e,a)}return a}function DX(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function RX(t,e,r,n){e.value=r,e.getSnapshot=n,LX(e)&&UX(t)}function MX(t,e,r){return r(function(){LX(e)&&UX(t)})}function LX(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Nf(t,r)}catch{return!0}}function UX(t){var e=mA(t,1);e!==null&&xf(e,t,1,-1)}function gU(t){var e=qf();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o2,lastRenderedState:t},e.queue=t,t=t.dispatch=eAe.bind(null,fi,t),[e.memoizedState,t]}function l2(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function QX(){return Fd().memoizedState}function q_(t,e,r,n){var a=qf();fi.flags|=t,a.memoizedState=l2(1|e,r,void 0,n===void 0?null:n)}function lI(t,e,r,n){var a=Fd();n=n===void 0?null:n;var s=void 0;if(Co!==null){var o=Co.memoizedState;if(s=o.destroy,n!==null&&aD(n,o.deps)){a.memoizedState=l2(e,r,s,n);return}}fi.flags|=t,a.memoizedState=l2(1|e,r,s,n)}function xU(t,e){return q_(8390656,8,t,e)}function oD(t,e){return lI(2048,8,t,e)}function VX(t,e){return lI(4,2,t,e)}function HX(t,e){return lI(4,4,t,e)}function $X(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function GX(t,e,r){return r=r!=null?r.concat([t]):null,lI(4,4,$X.bind(null,e,t),r)}function lD(){}function KX(t,e){var r=Fd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&aD(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function qX(t,e){var r=Fd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&aD(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function zX(t,e,r){return rg&21?(Nf(r,e)||(r=ZW(),fi.lanes|=r,ng|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ru=!0),t.memoizedState=r)}function Jhe(t,e){var r=as;as=r!==0&&4>r?r:4,t(!0);var n=d4.transition;d4.transition={};try{t(!1),e()}finally{as=r,d4.transition=n}}function WX(){return Fd().memoizedState}function Zhe(t,e,r){var n=om(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},XX(t))YX(e,r);else if(r=TX(t,e,r,n),r!==null){var a=Tc();xf(r,t,n,a),JX(r,e,n)}}function eAe(t,e,r){var n=om(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(XX(t))YX(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,Nf(l,o)){var c=e.interleaved;c===null?(a.next=a,ZO(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=TX(t,e,a,n),r!==null&&(a=Tc(),xf(r,t,n,a),JX(r,e,n))}}function XX(t){var e=t.alternate;return t===fi||e!==null&&e===fi}function YX(t,e){hb=qE=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function JX(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,LO(t,r)}}var zE={readContext:kd,useCallback:Ul,useContext:Ul,useEffect:Ul,useImperativeHandle:Ul,useInsertionEffect:Ul,useLayoutEffect:Ul,useMemo:Ul,useReducer:Ul,useRef:Ul,useState:Ul,useDebugValue:Ul,useDeferredValue:Ul,useTransition:Ul,useMutableSource:Ul,useSyncExternalStore:Ul,useId:Ul,unstable_isNewReconciler:!1},tAe={readContext:kd,useCallback:function(t,e){return qf().memoizedState=[t,e===void 0?null:e],t},useContext:kd,useEffect:xU,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,q_(4194308,4,$X.bind(null,e,t),r)},useLayoutEffect:function(t,e){return q_(4194308,4,t,e)},useInsertionEffect:function(t,e){return q_(4,2,t,e)},useMemo:function(t,e){var r=qf();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=qf();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Zhe.bind(null,fi,t),[n.memoizedState,t]},useRef:function(t){var e=qf();return t={current:t},e.memoizedState=t},useState:gU,useDebugValue:lD,useDeferredValue:function(t){return qf().memoizedState=t},useTransition:function(){var t=gU(!1),e=t[0];return t=Jhe.bind(null,t[1]),qf().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=fi,a=qf();if($s){if(r===void 0)throw Error(Dr(407));r=r()}else{if(r=e(),rl===null)throw Error(Dr(349));rg&30||DX(n,e,r)}a.memoizedState=r;var s={value:r,getSnapshot:e};return a.queue=s,xU(MX.bind(null,n,s,t),[t]),n.flags|=2048,l2(9,RX.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=qf(),e=rl.identifierPrefix;if($s){var r=qh,n=Kh;r=(n&~(1<<32-gf(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=i2++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Yhe++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rAe={readContext:kd,useCallback:KX,useContext:kd,useEffect:oD,useImperativeHandle:GX,useInsertionEffect:VX,useLayoutEffect:HX,useMemo:qX,useReducer:f4,useRef:QX,useState:function(){return f4(o2)},useDebugValue:lD,useDeferredValue:function(t){var e=Fd();return zX(e,Co.memoizedState,t)},useTransition:function(){var t=f4(o2)[0],e=Fd().memoizedState;return[t,e]},useMutableSource:FX,useSyncExternalStore:OX,useId:WX,unstable_isNewReconciler:!1},nAe={readContext:kd,useCallback:KX,useContext:kd,useEffect:oD,useImperativeHandle:GX,useInsertionEffect:VX,useLayoutEffect:HX,useMemo:qX,useReducer:h4,useRef:QX,useState:function(){return h4(o2)},useDebugValue:lD,useDeferredValue:function(t){var e=Fd();return Co===null?e.memoizedState=t:zX(e,Co.memoizedState,t)},useTransition:function(){var t=h4(o2)[0],e=Fd().memoizedState;return[t,e]},useMutableSource:FX,useSyncExternalStore:OX,useId:WX,unstable_isNewReconciler:!1};function of(t,e){if(t&&t.defaultProps){e=hi({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function xB(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:hi({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var cI={isMounted:function(t){return(t=t._reactInternals)?kg(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Tc(),a=om(t),s=rA(n,a);s.payload=e,r!=null&&(s.callback=r),e=sm(t,s,a),e!==null&&(xf(e,t,a,n),G_(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Tc(),a=om(t),s=rA(n,a);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=sm(t,s,a),e!==null&&(xf(e,t,a,n),G_(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Tc(),n=om(t),a=rA(r,n);a.tag=2,e!=null&&(a.callback=e),e=sm(t,a,n),e!==null&&(xf(e,t,n,r),G_(e,t,n))}};function vU(t,e,r,n,a,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!e2(r,n)||!e2(a,s):!0}function ZX(t,e,r){var n=!1,a=ym,s=e.contextType;return typeof s=="object"&&s!==null?s=kd(s):(a=iu(e)?eg:uc.current,n=e.contextTypes,s=(n=n!=null)?Cv(t,a):ym),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cI,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function yU(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&cI.enqueueReplaceState(e,e.state,null)}function vB(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},eD(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=kd(s):(s=iu(e)?eg:uc.current,a.context=Cv(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(xB(t,e,s,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&cI.enqueueReplaceState(a,a.state,null),GE(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function jv(t,e){try{var r="",n=e;do r+=Tfe(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function A4(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function yB(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var aAe=typeof WeakMap=="function"?WeakMap:Map;function eY(t,e,r){r=rA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){XE||(XE=!0,PB=n),yB(t,e)},r}function tY(t,e,r){r=rA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){yB(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){yB(t,e),typeof n!="function"&&(im===null?im=new Set([this]):im.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function bU(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new aAe;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=xAe.bind(null,t,e,r),e.then(t,t))}function wU(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function NU(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=rA(-1,1),e.tag=2,sm(r,e,1))),r.lanes|=1),t)}var sAe=BA.ReactCurrentOwner,ru=!1;function Cc(t,e,r,n){e.child=t===null?PX(e,null,r,n):Ev(e,t.child,r,n)}function CU(t,e,r,n,a){r=r.render;var s=e.ref;return cv(e,a),n=sD(t,e,r,n,s,a),r=iD(),t!==null&&!ru?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,pA(t,e,a)):($s&&r&&qO(e),e.flags|=1,Cc(t,e,n,a),e.child)}function _U(t,e,r,n,a){if(t===null){var s=r.type;return typeof s=="function"&&!pD(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,rY(t,e,s,n,a)):(t=Y_(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:e2,r(o,n)&&t.ref===e.ref)return pA(t,e,a)}return e.flags|=1,t=lm(s,n),t.ref=e.ref,t.return=e,e.child=t}function rY(t,e,r,n,a){if(t!==null){var s=t.memoizedProps;if(e2(s,n)&&t.ref===e.ref)if(ru=!1,e.pendingProps=n=s,(t.lanes&a)!==0)t.flags&131072&&(ru=!0);else return e.lanes=t.lanes,pA(t,e,a)}return bB(t,e,r,n,a)}function nY(t,e,r){var n=e.pendingProps,a=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ns(zx,Su),Su|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ns(zx,Su),Su|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Ns(zx,Su),Su|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Ns(zx,Su),Su|=n;return Cc(t,e,a,r),e.child}function aY(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function bB(t,e,r,n,a){var s=iu(r)?eg:uc.current;return s=Cv(e,s),cv(e,a),r=sD(t,e,r,n,s,a),n=iD(),t!==null&&!ru?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,pA(t,e,a)):($s&&n&&qO(e),e.flags|=1,Cc(t,e,r,a),e.child)}function EU(t,e,r,n,a){if(iu(r)){var s=!0;UE(e)}else s=!1;if(cv(e,a),e.stateNode===null)z_(t,e),ZX(e,r,n),vB(e,r,n,a),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=kd(u):(u=iu(r)?eg:uc.current,u=Cv(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&yU(e,o,n,u),I0=!1;var A=e.memoizedState;o.state=A,GE(e,n,o,a),c=e.memoizedState,l!==n||A!==c||su.current||I0?(typeof d=="function"&&(xB(e,r,d,n),c=e.memoizedState),(l=I0||vU(e,r,l,n,A,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,BX(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:of(e.type,l),o.props=u,f=e.pendingProps,A=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=kd(c):(c=iu(r)?eg:uc.current,c=Cv(e,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||A!==c)&&yU(e,o,n,c),I0=!1,A=e.memoizedState,o.state=A,GE(e,n,o,a);var m=e.memoizedState;l!==f||A!==m||su.current||I0?(typeof h=="function"&&(xB(e,r,h,n),m=e.memoizedState),(u=I0||vU(e,r,u,n,A,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),n=!1)}return wB(t,e,r,n,s,a)}function wB(t,e,r,n,a,s){aY(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return a&&dU(e,r,!1),pA(t,e,s);n=e.stateNode,sAe.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Ev(e,t.child,null,s),e.child=Ev(e,null,l,s)):Cc(t,e,l,s),e.memoizedState=n.state,a&&dU(e,r,!0),e.child}function sY(t){var e=t.stateNode;e.pendingContext?uU(t,e.pendingContext,e.pendingContext!==e.context):e.context&&uU(t,e.context,!1),tD(t,e.containerInfo)}function SU(t,e,r,n,a){return _v(),WO(a),e.flags|=256,Cc(t,e,r,n),e.child}var NB={dehydrated:null,treeContext:null,retryLane:0};function CB(t){return{baseLanes:t,cachePool:null,transitions:null}}function iY(t,e,r){var n=e.pendingProps,a=li.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Ns(li,a&1),t===null)return pB(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=fI(o,n,0,null),t=Rp(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=CB(r),e.memoizedState=NB,t):cD(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return iAe(t,e,o,n,l,a,r);if(s){s=n.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=lm(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=lm(l,s):(s=Rp(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?CB(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=NB,n}return s=t.child,t=s.sibling,n=lm(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function cD(t,e){return e=fI({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function YN(t,e,r,n){return n!==null&&WO(n),Ev(e,t.child,null,r),t=cD(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function iAe(t,e,r,n,a,s,o){if(r)return e.flags&256?(e.flags&=-257,n=A4(Error(Dr(422))),YN(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,a=e.mode,n=fI({mode:"visible",children:n.children},a,0,null),s=Rp(s,a,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Ev(e,t.child,null,o),e.child.memoizedState=CB(o),e.memoizedState=NB,s);if(!(e.mode&1))return YN(t,e,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Dr(419)),n=A4(s,n,void 0),YN(t,e,o,n)}if(l=(o&t.childLanes)!==0,ru||l){if(n=rl,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,mA(t,a),xf(n,t,a,-1))}return mD(),n=A4(Error(Dr(421))),YN(t,e,o,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=vAe.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,Fu=am(a.nextSibling),Mu=e,$s=!0,cf=null,t!==null&&(vd[yd++]=Kh,vd[yd++]=qh,vd[yd++]=tg,Kh=t.id,qh=t.overflow,tg=e),e=cD(e,n.children),e.flags|=4096,e)}function jU(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),gB(t.return,e,r)}function m4(t,e,r,n,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function oY(t,e,r){var n=e.pendingProps,a=n.revealOrder,s=n.tail;if(Cc(t,e,n.children,r),n=li.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&jU(t,r,e);else if(t.tag===19)jU(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ns(li,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&KE(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),m4(e,!1,a,r,s);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&KE(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}m4(e,!0,r,null,s);break;case"together":m4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function z_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function pA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ng|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Dr(153));if(e.child!==null){for(t=e.child,r=lm(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=lm(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function oAe(t,e,r){switch(e.tag){case 3:sY(e),_v();break;case 5:kX(e);break;case 1:iu(e.type)&&UE(e);break;case 4:tD(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;Ns(HE,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ns(li,li.current&1),e.flags|=128,null):r&e.child.childLanes?iY(t,e,r):(Ns(li,li.current&1),t=pA(t,e,r),t!==null?t.sibling:null);Ns(li,li.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return oY(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ns(li,li.current),n)break;return null;case 22:case 23:return e.lanes=0,nY(t,e,r)}return pA(t,e,r)}var lY,_B,cY,uY;lY=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};_B=function(){};cY=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,Sp(sh.current);var s=null;switch(r){case"input":a=qT(t,a),n=qT(t,n),s=[];break;case"select":a=hi({},a,{value:void 0}),n=hi({},n,{value:void 0}),s=[];break;case"textarea":a=XT(t,a),n=XT(t,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=ME)}JT(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qb.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qb.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Is("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};uY=function(t,e,r,n){r!==n&&(e.flags|=4)};function ay(t,e){if(!$s)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ql(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function lAe(t,e,r){var n=e.pendingProps;switch(zO(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ql(e),null;case 1:return iu(e.type)&&LE(),Ql(e),null;case 3:return n=e.stateNode,Sv(),Os(su),Os(uc),nD(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(WN(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cf!==null&&(kB(cf),cf=null))),_B(t,e),Ql(e),null;case 5:rD(e);var a=Sp(s2.current);if(r=e.type,t!==null&&e.stateNode!=null)cY(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Dr(166));return Ql(e),null}if(t=Sp(sh.current),WN(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[zf]=e,n[n2]=s,t=(e.mode&1)!==0,r){case"dialog":Is("cancel",n),Is("close",n);break;case"iframe":case"object":case"embed":Is("load",n);break;case"video":case"audio":for(a=0;a<Ly.length;a++)Is(Ly[a],n);break;case"source":Is("error",n);break;case"img":case"image":case"link":Is("error",n),Is("load",n);break;case"details":Is("toggle",n);break;case"input":RL(n,s),Is("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Is("invalid",n);break;case"textarea":LL(n,s),Is("invalid",n)}JT(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&zN(n.textContent,l,t),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&zN(n.textContent,l,t),a=["children",""+l]):qb.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Is("scroll",n)}switch(r){case"input":UN(n),ML(n,s,!0);break;case"textarea":UN(n),UL(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ME)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=MW(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[zf]=e,t[n2]=n,lY(t,e,!1,!1),e.stateNode=t;e:{switch(o=ZT(r,n),r){case"dialog":Is("cancel",t),Is("close",t),a=n;break;case"iframe":case"object":case"embed":Is("load",t),a=n;break;case"video":case"audio":for(a=0;a<Ly.length;a++)Is(Ly[a],t);a=n;break;case"source":Is("error",t),a=n;break;case"img":case"image":case"link":Is("error",t),Is("load",t),a=n;break;case"details":Is("toggle",t),a=n;break;case"input":RL(t,n),a=qT(t,n),Is("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=hi({},n,{value:void 0}),Is("invalid",t);break;case"textarea":LL(t,n),a=XT(t,n),Is("invalid",t);break;default:a=n}JT(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?QW(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&LW(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&zb(t,c):typeof c=="number"&&zb(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(qb.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Is("scroll",t):c!=null&&kO(t,s,c,o))}switch(r){case"input":UN(t),ML(t,n,!1);break;case"textarea":UN(t),UL(t);break;case"option":n.value!=null&&t.setAttribute("value",""+vm(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?sv(t,!!n.multiple,s,!1):n.defaultValue!=null&&sv(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=ME)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ql(e),null;case 6:if(t&&e.stateNode!=null)uY(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Dr(166));if(r=Sp(s2.current),Sp(sh.current),WN(e)){if(n=e.stateNode,r=e.memoizedProps,n[zf]=e,(s=n.nodeValue!==r)&&(t=Mu,t!==null))switch(t.tag){case 3:zN(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zN(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[zf]=e,e.stateNode=n}return Ql(e),null;case 13:if(Os(li),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($s&&Fu!==null&&e.mode&1&&!(e.flags&128))jX(),_v(),e.flags|=98560,s=!1;else if(s=WN(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Dr(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Dr(317));s[zf]=e}else _v(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ql(e),s=!1}else cf!==null&&(kB(cf),cf=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||li.current&1?ko===0&&(ko=3):mD())),e.updateQueue!==null&&(e.flags|=4),Ql(e),null);case 4:return Sv(),_B(t,e),t===null&&t2(e.stateNode.containerInfo),Ql(e),null;case 10:return JO(e.type._context),Ql(e),null;case 17:return iu(e.type)&&LE(),Ql(e),null;case 19:if(Os(li),s=e.memoizedState,s===null)return Ql(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)ay(s,!1);else{if(ko!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=KE(t),o!==null){for(e.flags|=128,ay(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ns(li,li.current&1|2),e.child}t=t.sibling}s.tail!==null&&Hi()>Iv&&(e.flags|=128,n=!0,ay(s,!1),e.lanes=4194304)}else{if(!n)if(t=KE(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ay(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!$s)return Ql(e),null}else 2*Hi()-s.renderingStartTime>Iv&&r!==1073741824&&(e.flags|=128,n=!0,ay(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Hi(),e.sibling=null,r=li.current,Ns(li,n?r&1|2:r&1),e):(Ql(e),null);case 22:case 23:return AD(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Su&1073741824&&(Ql(e),e.subtreeFlags&6&&(e.flags|=8192)):Ql(e),null;case 24:return null;case 25:return null}throw Error(Dr(156,e.tag))}function cAe(t,e){switch(zO(e),e.tag){case 1:return iu(e.type)&&LE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Sv(),Os(su),Os(uc),nD(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return rD(e),null;case 13:if(Os(li),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Dr(340));_v()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Os(li),null;case 4:return Sv(),null;case 10:return JO(e.type._context),null;case 22:case 23:return AD(),null;case 24:return null;default:return null}}var JN=!1,nc=!1,uAe=typeof WeakSet=="function"?WeakSet:Set,sn=null;function qx(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ei(t,e,n)}else r.current=null}function EB(t,e,r){try{r()}catch(n){Ei(t,e,n)}}var IU=!1;function dAe(t,e){if(cB=OE,t=mX(),KO(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=t,A=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)A=f,f=h;for(;;){if(f===t)break t;if(A===r&&++u===a&&(l=o),A===s&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=A,A=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(uB={focusedElem:t,selectionRange:r},OE=!1,sn=e;sn!==null;)if(e=sn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,sn=t;else for(;sn!==null;){e=sn;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:of(e.type,p),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Dr(163))}}catch(w){Ei(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,sn=t;break}sn=e.return}return m=IU,IU=!1,m}function Ab(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&EB(e,r,s)}a=a.next}while(a!==n)}}function uI(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function SB(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function dY(t){var e=t.alternate;e!==null&&(t.alternate=null,dY(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zf],delete e[n2],delete e[hB],delete e[qhe],delete e[zhe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function fY(t){return t.tag===5||t.tag===3||t.tag===4}function PU(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||fY(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jB(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=ME));else if(n!==4&&(t=t.child,t!==null))for(jB(t,e,r),t=t.sibling;t!==null;)jB(t,e,r),t=t.sibling}function IB(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(IB(t,e,r),t=t.sibling;t!==null;)IB(t,e,r),t=t.sibling}var wl=null,lf=!1;function l0(t,e,r){for(r=r.child;r!==null;)hY(t,e,r),r=r.sibling}function hY(t,e,r){if(ah&&typeof ah.onCommitFiberUnmount=="function")try{ah.onCommitFiberUnmount(rI,r)}catch{}switch(r.tag){case 5:nc||qx(r,e);case 6:var n=wl,a=lf;wl=null,l0(t,e,r),wl=n,lf=a,wl!==null&&(lf?(t=wl,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):wl.removeChild(r.stateNode));break;case 18:wl!==null&&(lf?(t=wl,r=r.stateNode,t.nodeType===8?l4(t.parentNode,r):t.nodeType===1&&l4(t,r),Jb(t)):l4(wl,r.stateNode));break;case 4:n=wl,a=lf,wl=r.stateNode.containerInfo,lf=!0,l0(t,e,r),wl=n,lf=a;break;case 0:case 11:case 14:case 15:if(!nc&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&EB(r,e,o),a=a.next}while(a!==n)}l0(t,e,r);break;case 1:if(!nc&&(qx(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ei(r,e,l)}l0(t,e,r);break;case 21:l0(t,e,r);break;case 22:r.mode&1?(nc=(n=nc)||r.memoizedState!==null,l0(t,e,r),nc=n):l0(t,e,r);break;default:l0(t,e,r)}}function TU(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new uAe),e.forEach(function(n){var a=yAe.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Wd(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:wl=l.stateNode,lf=!1;break e;case 3:wl=l.stateNode.containerInfo,lf=!0;break e;case 4:wl=l.stateNode.containerInfo,lf=!0;break e}l=l.return}if(wl===null)throw Error(Dr(160));hY(s,o,a),wl=null,lf=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Ei(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)AY(e,t),e=e.sibling}function AY(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Wd(e,t),Mf(t),n&4){try{Ab(3,t,t.return),uI(3,t)}catch(p){Ei(t,t.return,p)}try{Ab(5,t,t.return)}catch(p){Ei(t,t.return,p)}}break;case 1:Wd(e,t),Mf(t),n&512&&r!==null&&qx(r,r.return);break;case 5:if(Wd(e,t),Mf(t),n&512&&r!==null&&qx(r,r.return),t.flags&32){var a=t.stateNode;try{zb(a,"")}catch(p){Ei(t,t.return,p)}}if(n&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&DW(a,s),ZT(l,o);var u=ZT(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?QW(a,f):d==="dangerouslySetInnerHTML"?LW(a,f):d==="children"?zb(a,f):kO(a,d,f,u)}switch(l){case"input":zT(a,s);break;case"textarea":RW(a,s);break;case"select":var A=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?sv(a,!!s.multiple,h,!1):A!==!!s.multiple&&(s.defaultValue!=null?sv(a,!!s.multiple,s.defaultValue,!0):sv(a,!!s.multiple,s.multiple?[]:"",!1))}a[n2]=s}catch(p){Ei(t,t.return,p)}}break;case 6:if(Wd(e,t),Mf(t),n&4){if(t.stateNode===null)throw Error(Dr(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(p){Ei(t,t.return,p)}}break;case 3:if(Wd(e,t),Mf(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Jb(e.containerInfo)}catch(p){Ei(t,t.return,p)}break;case 4:Wd(e,t),Mf(t);break;case 13:Wd(e,t),Mf(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(fD=Hi())),n&4&&TU(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(nc=(u=nc)||d,Wd(e,t),nc=u):Wd(e,t),Mf(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(sn=t,d=t.child;d!==null;){for(f=sn=d;sn!==null;){switch(A=sn,h=A.child,A.tag){case 0:case 11:case 14:case 15:Ab(4,A,A.return);break;case 1:qx(A,A.return);var m=A.stateNode;if(typeof m.componentWillUnmount=="function"){n=A,r=A.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Ei(n,r,p)}}break;case 5:qx(A,A.return);break;case 22:if(A.memoizedState!==null){kU(f);continue}}h!==null?(h.return=A,sn=h):kU(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=UW("display",o))}catch(p){Ei(t,t.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Ei(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Wd(e,t),Mf(t),n&4&&TU(t);break;case 21:break;default:Wd(e,t),Mf(t)}}function Mf(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(fY(r)){var n=r;break e}r=r.return}throw Error(Dr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(zb(a,""),n.flags&=-33);var s=PU(t);IB(t,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=PU(t);jB(t,l,o);break;default:throw Error(Dr(161))}}catch(c){Ei(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function fAe(t,e,r){sn=t,mY(t)}function mY(t,e,r){for(var n=(t.mode&1)!==0;sn!==null;){var a=sn,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||JN;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||nc;l=JN;var u=nc;if(JN=o,(nc=c)&&!u)for(sn=a;sn!==null;)o=sn,c=o.child,o.tag===22&&o.memoizedState!==null?FU(a):c!==null?(c.return=o,sn=c):FU(a);for(;s!==null;)sn=s,mY(s),s=s.sibling;sn=a,JN=l,nc=u}BU(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,sn=s):BU(t)}}function BU(t){for(;sn!==null;){var e=sn;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nc||uI(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!nc)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:of(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&pU(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}pU(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Jb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Dr(163))}nc||e.flags&512&&SB(e)}catch(A){Ei(e,e.return,A)}}if(e===t){sn=null;break}if(r=e.sibling,r!==null){r.return=e.return,sn=r;break}sn=e.return}}function kU(t){for(;sn!==null;){var e=sn;if(e===t){sn=null;break}var r=e.sibling;if(r!==null){r.return=e.return,sn=r;break}sn=e.return}}function FU(t){for(;sn!==null;){var e=sn;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{uI(4,e)}catch(c){Ei(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(c){Ei(e,a,c)}}var s=e.return;try{SB(e)}catch(c){Ei(e,s,c)}break;case 5:var o=e.return;try{SB(e)}catch(c){Ei(e,o,c)}}}catch(c){Ei(e,e.return,c)}if(e===t){sn=null;break}var l=e.sibling;if(l!==null){l.return=e.return,sn=l;break}sn=e.return}}var hAe=Math.ceil,WE=BA.ReactCurrentDispatcher,uD=BA.ReactCurrentOwner,jd=BA.ReactCurrentBatchConfig,Ea=0,rl=null,lo=null,kl=0,Su=0,zx=Mm(0),ko=0,c2=null,ng=0,dI=0,dD=0,mb=null,eu=null,fD=0,Iv=1/0,Uh=null,XE=!1,PB=null,im=null,ZN=!1,K0=null,YE=0,pb=0,TB=null,W_=-1,X_=0;function Tc(){return Ea&6?Hi():W_!==-1?W_:W_=Hi()}function om(t){return t.mode&1?Ea&2&&kl!==0?kl&-kl:Xhe.transition!==null?(X_===0&&(X_=ZW()),X_):(t=as,t!==0||(t=window.event,t=t===void 0?16:iX(t.type)),t):1}function xf(t,e,r,n){if(50<pb)throw pb=0,TB=null,Error(Dr(185));mw(t,r,n),(!(Ea&2)||t!==rl)&&(t===rl&&(!(Ea&2)&&(dI|=r),ko===4&&O0(t,kl)),ou(t,n),r===1&&Ea===0&&!(e.mode&1)&&(Iv=Hi()+500,oI&&Lm()))}function ou(t,e){var r=t.callbackNode;Xfe(t,e);var n=FE(t,t===rl?kl:0);if(n===0)r!==null&&HL(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&HL(r),e===1)t.tag===0?Whe(OU.bind(null,t)):_X(OU.bind(null,t)),Ghe(function(){!(Ea&6)&&Lm()}),r=null;else{switch(eX(n)){case 1:r=MO;break;case 4:r=YW;break;case 16:r=kE;break;case 536870912:r=JW;break;default:r=kE}r=NY(r,pY.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function pY(t,e){if(W_=-1,X_=0,Ea&6)throw Error(Dr(327));var r=t.callbackNode;if(uv()&&t.callbackNode!==r)return null;var n=FE(t,t===rl?kl:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=JE(t,n);else{e=n;var a=Ea;Ea|=2;var s=xY();(rl!==t||kl!==e)&&(Uh=null,Iv=Hi()+500,Dp(t,e));do try{pAe();break}catch(l){gY(t,l)}while(!0);YO(),WE.current=s,Ea=a,lo!==null?e=0:(rl=null,kl=0,e=ko)}if(e!==0){if(e===2&&(a=aB(t),a!==0&&(n=a,e=BB(t,a))),e===1)throw r=c2,Dp(t,0),O0(t,n),ou(t,Hi()),r;if(e===6)O0(t,n);else{if(a=t.current.alternate,!(n&30)&&!AAe(a)&&(e=JE(t,n),e===2&&(s=aB(t),s!==0&&(n=s,e=BB(t,s))),e===1))throw r=c2,Dp(t,0),O0(t,n),ou(t,Hi()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(Dr(345));case 2:up(t,eu,Uh);break;case 3:if(O0(t,n),(n&130023424)===n&&(e=fD+500-Hi(),10<e)){if(FE(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Tc(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=fB(up.bind(null,t,eu,Uh),e);break}up(t,eu,Uh);break;case 4:if(O0(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var o=31-gf(n);s=1<<o,o=e[o],o>a&&(a=o),n&=~s}if(n=a,n=Hi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hAe(n/1960))-n,10<n){t.timeoutHandle=fB(up.bind(null,t,eu,Uh),n);break}up(t,eu,Uh);break;case 5:up(t,eu,Uh);break;default:throw Error(Dr(329))}}}return ou(t,Hi()),t.callbackNode===r?pY.bind(null,t):null}function BB(t,e){var r=mb;return t.current.memoizedState.isDehydrated&&(Dp(t,e).flags|=256),t=JE(t,e),t!==2&&(e=eu,eu=r,e!==null&&kB(e)),t}function kB(t){eu===null?eu=t:eu.push.apply(eu,t)}function AAe(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Nf(s(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function O0(t,e){for(e&=~dD,e&=~dI,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-gf(e),n=1<<r;t[r]=-1,e&=~n}}function OU(t){if(Ea&6)throw Error(Dr(327));uv();var e=FE(t,0);if(!(e&1))return ou(t,Hi()),null;var r=JE(t,e);if(t.tag!==0&&r===2){var n=aB(t);n!==0&&(e=n,r=BB(t,n))}if(r===1)throw r=c2,Dp(t,0),O0(t,e),ou(t,Hi()),r;if(r===6)throw Error(Dr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,up(t,eu,Uh),ou(t,Hi()),null}function hD(t,e){var r=Ea;Ea|=1;try{return t(e)}finally{Ea=r,Ea===0&&(Iv=Hi()+500,oI&&Lm())}}function ag(t){K0!==null&&K0.tag===0&&!(Ea&6)&&uv();var e=Ea;Ea|=1;var r=jd.transition,n=as;try{if(jd.transition=null,as=1,t)return t()}finally{as=n,jd.transition=r,Ea=e,!(Ea&6)&&Lm()}}function AD(){Su=zx.current,Os(zx)}function Dp(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,$he(r)),lo!==null)for(r=lo.return;r!==null;){var n=r;switch(zO(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&LE();break;case 3:Sv(),Os(su),Os(uc),nD();break;case 5:rD(n);break;case 4:Sv();break;case 13:Os(li);break;case 19:Os(li);break;case 10:JO(n.type._context);break;case 22:case 23:AD()}r=r.return}if(rl=t,lo=t=lm(t.current,null),kl=Su=e,ko=0,c2=null,dD=dI=ng=0,eu=mb=null,Ep!==null){for(e=0;e<Ep.length;e++)if(r=Ep[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}Ep=null}return t}function gY(t,e){do{var r=lo;try{if(YO(),K_.current=zE,qE){for(var n=fi.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}qE=!1}if(rg=0,Jo=Co=fi=null,hb=!1,i2=0,uD.current=null,r===null||r.return===null){ko=1,c2=e,lo=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=kl,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var A=d.alternate;A?(d.updateQueue=A.updateQueue,d.memoizedState=A.memoizedState,d.lanes=A.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=wU(o);if(h!==null){h.flags&=-257,NU(h,o,l,s,e),h.mode&1&&bU(s,u,e),e=h,c=u;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){bU(s,u,e),mD();break e}c=Error(Dr(426))}}else if($s&&l.mode&1){var x=wU(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),NU(x,o,l,s,e),WO(jv(c,l));break e}}s=c=jv(c,l),ko!==4&&(ko=2),mb===null?mb=[s]:mb.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=eY(s,c,e);mU(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(im===null||!im.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=tY(s,l,e);mU(s,w);break e}}s=s.return}while(s!==null)}yY(r)}catch(I){e=I,lo===r&&r!==null&&(lo=r=r.return);continue}break}while(!0)}function xY(){var t=WE.current;return WE.current=zE,t===null?zE:t}function mD(){(ko===0||ko===3||ko===2)&&(ko=4),rl===null||!(ng&268435455)&&!(dI&268435455)||O0(rl,kl)}function JE(t,e){var r=Ea;Ea|=2;var n=xY();(rl!==t||kl!==e)&&(Uh=null,Dp(t,e));do try{mAe();break}catch(a){gY(t,a)}while(!0);if(YO(),Ea=r,WE.current=n,lo!==null)throw Error(Dr(261));return rl=null,kl=0,ko}function mAe(){for(;lo!==null;)vY(lo)}function pAe(){for(;lo!==null&&!Qfe();)vY(lo)}function vY(t){var e=wY(t.alternate,t,Su);t.memoizedProps=t.pendingProps,e===null?yY(t):lo=e,uD.current=null}function yY(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=cAe(r,e),r!==null){r.flags&=32767,lo=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ko=6,lo=null;return}}else if(r=lAe(r,e,Su),r!==null){lo=r;return}if(e=e.sibling,e!==null){lo=e;return}lo=e=t}while(e!==null);ko===0&&(ko=5)}function up(t,e,r){var n=as,a=jd.transition;try{jd.transition=null,as=1,gAe(t,e,r,n)}finally{jd.transition=a,as=n}return null}function gAe(t,e,r,n){do uv();while(K0!==null);if(Ea&6)throw Error(Dr(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Dr(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Yfe(t,s),t===rl&&(lo=rl=null,kl=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ZN||(ZN=!0,NY(kE,function(){return uv(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=jd.transition,jd.transition=null;var o=as;as=1;var l=Ea;Ea|=4,uD.current=null,dAe(t,r),AY(r,t),Rhe(uB),OE=!!cB,uB=cB=null,t.current=r,fAe(r),Vfe(),Ea=l,as=o,jd.transition=s}else t.current=r;if(ZN&&(ZN=!1,K0=t,YE=a),s=t.pendingLanes,s===0&&(im=null),Gfe(r.stateNode),ou(t,Hi()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(XE)throw XE=!1,t=PB,PB=null,t;return YE&1&&t.tag!==0&&uv(),s=t.pendingLanes,s&1?t===TB?pb++:(pb=0,TB=t):pb=0,Lm(),null}function uv(){if(K0!==null){var t=eX(YE),e=jd.transition,r=as;try{if(jd.transition=null,as=16>t?16:t,K0===null)var n=!1;else{if(t=K0,K0=null,YE=0,Ea&6)throw Error(Dr(331));var a=Ea;for(Ea|=4,sn=t.current;sn!==null;){var s=sn,o=s.child;if(sn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(sn=u;sn!==null;){var d=sn;switch(d.tag){case 0:case 11:case 15:Ab(8,d,s)}var f=d.child;if(f!==null)f.return=d,sn=f;else for(;sn!==null;){d=sn;var A=d.sibling,h=d.return;if(dY(d),d===u){sn=null;break}if(A!==null){A.return=h,sn=A;break}sn=h}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}sn=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,sn=o;else e:for(;sn!==null;){if(s=sn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ab(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,sn=v;break e}sn=s.return}}var y=t.current;for(sn=y;sn!==null;){o=sn;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,sn=b;else e:for(o=y;sn!==null;){if(l=sn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:uI(9,l)}}catch(I){Ei(l,l.return,I)}if(l===o){sn=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,sn=w;break e}sn=l.return}}if(Ea=a,Lm(),ah&&typeof ah.onPostCommitFiberRoot=="function")try{ah.onPostCommitFiberRoot(rI,t)}catch{}n=!0}return n}finally{as=r,jd.transition=e}}return!1}function DU(t,e,r){e=jv(r,e),e=eY(t,e,1),t=sm(t,e,1),e=Tc(),t!==null&&(mw(t,1,e),ou(t,e))}function Ei(t,e,r){if(t.tag===3)DU(t,t,r);else for(;e!==null;){if(e.tag===3){DU(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(im===null||!im.has(n))){t=jv(r,t),t=tY(e,t,1),e=sm(e,t,1),t=Tc(),e!==null&&(mw(e,1,t),ou(e,t));break}}e=e.return}}function xAe(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Tc(),t.pingedLanes|=t.suspendedLanes&r,rl===t&&(kl&r)===r&&(ko===4||ko===3&&(kl&130023424)===kl&&500>Hi()-fD?Dp(t,0):dD|=r),ou(t,e)}function bY(t,e){e===0&&(t.mode&1?(e=HN,HN<<=1,!(HN&130023424)&&(HN=4194304)):e=1);var r=Tc();t=mA(t,e),t!==null&&(mw(t,e,r),ou(t,r))}function vAe(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),bY(t,r)}function yAe(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Dr(314))}n!==null&&n.delete(e),bY(t,r)}var wY;wY=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||su.current)ru=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ru=!1,oAe(t,e,r);ru=!!(t.flags&131072)}else ru=!1,$s&&e.flags&1048576&&EX(e,VE,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;z_(t,e),t=e.pendingProps;var a=Cv(e,uc.current);cv(e,r),a=sD(null,e,n,t,a,r);var s=iD();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,iu(n)?(s=!0,UE(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,eD(e),a.updater=cI,e.stateNode=a,a._reactInternals=e,vB(e,n,t,r),e=wB(null,e,n,!0,s,r)):(e.tag=0,$s&&s&&qO(e),Cc(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(z_(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=wAe(n),t=of(n,t),a){case 0:e=bB(null,e,n,t,r);break e;case 1:e=EU(null,e,n,t,r);break e;case 11:e=CU(null,e,n,t,r);break e;case 14:e=_U(null,e,n,of(n.type,t),r);break e}throw Error(Dr(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:of(n,a),bB(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:of(n,a),EU(t,e,n,a,r);case 3:e:{if(sY(e),t===null)throw Error(Dr(387));n=e.pendingProps,s=e.memoizedState,a=s.element,BX(t,e),GE(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=jv(Error(Dr(423)),e),e=SU(t,e,n,r,a);break e}else if(n!==a){a=jv(Error(Dr(424)),e),e=SU(t,e,n,r,a);break e}else for(Fu=am(e.stateNode.containerInfo.firstChild),Mu=e,$s=!0,cf=null,r=PX(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_v(),n===a){e=pA(t,e,r);break e}Cc(t,e,n,r)}e=e.child}return e;case 5:return kX(e),t===null&&pB(e),n=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,o=a.children,dB(n,a)?o=null:s!==null&&dB(n,s)&&(e.flags|=32),aY(t,e),Cc(t,e,o,r),e.child;case 6:return t===null&&pB(e),null;case 13:return iY(t,e,r);case 4:return tD(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ev(e,null,n,r):Cc(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:of(n,a),CU(t,e,n,a,r);case 7:return Cc(t,e,e.pendingProps,r),e.child;case 8:return Cc(t,e,e.pendingProps.children,r),e.child;case 12:return Cc(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,s=e.memoizedProps,o=a.value,Ns(HE,n._currentValue),n._currentValue=o,s!==null)if(Nf(s.value,o)){if(s.children===a.children&&!su.current){e=pA(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=rA(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),gB(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Dr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),gB(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Cc(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,cv(e,r),a=kd(a),n=n(a),e.flags|=1,Cc(t,e,n,r),e.child;case 14:return n=e.type,a=of(n,e.pendingProps),a=of(n.type,a),_U(t,e,n,a,r);case 15:return rY(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:of(n,a),z_(t,e),e.tag=1,iu(n)?(t=!0,UE(e)):t=!1,cv(e,r),ZX(e,n,a),vB(e,n,a,r),wB(null,e,n,!0,t,r);case 19:return oY(t,e,r);case 22:return nY(t,e,r)}throw Error(Dr(156,e.tag))};function NY(t,e){return XW(t,e)}function bAe(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wd(t,e,r,n){return new bAe(t,e,r,n)}function pD(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wAe(t){if(typeof t=="function")return pD(t)?1:0;if(t!=null){if(t=t.$$typeof,t===OO)return 11;if(t===DO)return 14}return 2}function lm(t,e){var r=t.alternate;return r===null?(r=wd(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Y_(t,e,r,n,a,s){var o=2;if(n=t,typeof t=="function")pD(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Mx:return Rp(r.children,a,s,e);case FO:o=8,a|=8;break;case HT:return t=wd(12,r,e,a|2),t.elementType=HT,t.lanes=s,t;case $T:return t=wd(13,r,e,a),t.elementType=$T,t.lanes=s,t;case GT:return t=wd(19,r,e,a),t.elementType=GT,t.lanes=s,t;case kW:return fI(r,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case TW:o=10;break e;case BW:o=9;break e;case OO:o=11;break e;case DO:o=14;break e;case j0:o=16,n=null;break e}throw Error(Dr(130,t==null?t:typeof t,""))}return e=wd(o,r,e,a),e.elementType=t,e.type=n,e.lanes=s,e}function Rp(t,e,r,n){return t=wd(7,t,n,e),t.lanes=r,t}function fI(t,e,r,n){return t=wd(22,t,n,e),t.elementType=kW,t.lanes=r,t.stateNode={isHidden:!1},t}function p4(t,e,r){return t=wd(6,t,null,e),t.lanes=r,t}function g4(t,e,r){return e=wd(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function NAe(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Y3(0),this.expirationTimes=Y3(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Y3(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function gD(t,e,r,n,a,s,o,l,c){return t=new NAe(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=wd(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},eD(s),t}function CAe(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rx,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function CY(t){if(!t)return ym;t=t._reactInternals;e:{if(kg(t)!==t||t.tag!==1)throw Error(Dr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(iu(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Dr(171))}if(t.tag===1){var r=t.type;if(iu(r))return CX(t,r,e)}return e}function _Y(t,e,r,n,a,s,o,l,c){return t=gD(r,n,!0,t,a,s,o,l,c),t.context=CY(null),r=t.current,n=Tc(),a=om(r),s=rA(n,a),s.callback=e??null,sm(r,s,a),t.current.lanes=a,mw(t,a,n),ou(t,n),t}function hI(t,e,r,n){var a=e.current,s=Tc(),o=om(a);return r=CY(r),e.context===null?e.context=r:e.pendingContext=r,e=rA(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=sm(a,e,o),t!==null&&(xf(t,a,o,s),G_(t,a,o)),o}function ZE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function RU(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function xD(t,e){RU(t,e),(t=t.alternate)&&RU(t,e)}function _Ae(){return null}var EY=typeof reportError=="function"?reportError:function(t){console.error(t)};function vD(t){this._internalRoot=t}AI.prototype.render=vD.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Dr(409));hI(t,e,null,null)};AI.prototype.unmount=vD.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ag(function(){hI(null,t,null,null)}),e[AA]=null}};function AI(t){this._internalRoot=t}AI.prototype.unstable_scheduleHydration=function(t){if(t){var e=nX();t={blockedOn:null,target:t,priority:e};for(var r=0;r<F0.length&&e!==0&&e<F0[r].priority;r++);F0.splice(r,0,t),r===0&&sX(t)}};function yD(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function mI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function MU(){}function EAe(t,e,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=ZE(o);s.call(u)}}var o=_Y(e,n,t,0,null,!1,!1,"",MU);return t._reactRootContainer=o,t[AA]=o.current,t2(t.nodeType===8?t.parentNode:t),ag(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=ZE(c);l.call(u)}}var c=gD(t,0,!1,null,null,!1,!1,"",MU);return t._reactRootContainer=c,t[AA]=c.current,t2(t.nodeType===8?t.parentNode:t),ag(function(){hI(e,c,r,n)}),c}function pI(t,e,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=ZE(o);l.call(c)}}hI(e,o,t,a)}else o=EAe(r,e,t,a,n);return ZE(o)}tX=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=My(e.pendingLanes);r!==0&&(LO(e,r|1),ou(e,Hi()),!(Ea&6)&&(Iv=Hi()+500,Lm()))}break;case 13:ag(function(){var n=mA(t,1);if(n!==null){var a=Tc();xf(n,t,1,a)}}),xD(t,1)}};UO=function(t){if(t.tag===13){var e=mA(t,134217728);if(e!==null){var r=Tc();xf(e,t,134217728,r)}xD(t,134217728)}};rX=function(t){if(t.tag===13){var e=om(t),r=mA(t,e);if(r!==null){var n=Tc();xf(r,t,e,n)}xD(t,e)}};nX=function(){return as};aX=function(t,e){var r=as;try{return as=t,e()}finally{as=r}};tB=function(t,e,r){switch(e){case"input":if(zT(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=iI(n);if(!a)throw Error(Dr(90));OW(n),zT(n,a)}}}break;case"textarea":RW(t,r);break;case"select":e=r.value,e!=null&&sv(t,!!r.multiple,e,!1)}};$W=hD;GW=ag;var SAe={usingClientEntryPoint:!1,Events:[gw,Vx,iI,VW,HW,hD]},sy={findFiberByHostInstance:_p,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jAe={bundleType:sy.bundleType,version:sy.version,rendererPackageName:sy.rendererPackageName,rendererConfig:sy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:BA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=zW(t),t===null?null:t.stateNode},findFiberByHostInstance:sy.findFiberByHostInstance||_Ae,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var eC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!eC.isDisabled&&eC.supportsFiber)try{rI=eC.inject(jAe),ah=eC}catch{}}Ku.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SAe;Ku.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yD(e))throw Error(Dr(200));return CAe(t,e,null,r)};Ku.createRoot=function(t,e){if(!yD(t))throw Error(Dr(299));var r=!1,n="",a=EY;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=gD(t,1,!1,null,null,r,!1,n,a),t[AA]=e.current,t2(t.nodeType===8?t.parentNode:t),new vD(e)};Ku.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Dr(188)):(t=Object.keys(t).join(","),Error(Dr(268,t)));return t=zW(e),t=t===null?null:t.stateNode,t};Ku.flushSync=function(t){return ag(t)};Ku.hydrate=function(t,e,r){if(!mI(e))throw Error(Dr(200));return pI(null,t,e,!0,r)};Ku.hydrateRoot=function(t,e,r){if(!yD(t))throw Error(Dr(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=EY;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=_Y(e,null,t,1,r??null,a,!1,s,o),t[AA]=e.current,t2(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new AI(e)};Ku.render=function(t,e,r){if(!mI(e))throw Error(Dr(200));return pI(null,t,e,!1,r)};Ku.unmountComponentAtNode=function(t){if(!mI(t))throw Error(Dr(40));return t._reactRootContainer?(ag(function(){pI(null,null,t,!1,function(){t._reactRootContainer=null,t[AA]=null})}),!0):!1};Ku.unstable_batchedUpdates=hD;Ku.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!mI(r))throw Error(Dr(200));if(t==null||t._reactInternals===void 0)throw Error(Dr(38));return pI(t,e,r,!1,n)};Ku.version="18.3.1-next-f1338f8080-20240426";function SY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(SY)}catch(t){console.error(t)}}SY(),SW.exports=Ku;var Lu=SW.exports,LU=Lu;QT.createRoot=LU.createRoot,QT.hydrateRoot=LU.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var UU="popstate";function IAe(t={}){function e(n,a){let{pathname:s,search:o,hash:l}=n.location;return FB("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:u2(a)}return TAe(e,r,null,t)}function Xs(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Cf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function PAe(){return Math.random().toString(36).substring(2,10)}function QU(t,e){return{usr:t.state,key:t.key,idx:e}}function FB(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?s1(e):e,state:r,key:e&&e.key||n||PAe()}}function u2({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function s1(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function TAe(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let x=d(),v=x==null?null:x-u;u=x,c&&c({action:l,location:p.location,delta:v})}function A(x,v){l="PUSH";let y=FB(p.location,x,v);u=d()+1;let b=QU(y,u),w=p.createHref(y);try{o.pushState(b,"",w)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;a.location.assign(w)}s&&c&&c({action:l,location:p.location,delta:1})}function h(x,v){l="REPLACE";let y=FB(p.location,x,v);u=d();let b=QU(y,u),w=p.createHref(y);o.replaceState(b,"",w),s&&c&&c({action:l,location:p.location,delta:0})}function m(x){return BAe(x)}let p={get action(){return l},get location(){return t(a,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(UU,f),c=x,()=>{a.removeEventListener(UU,f),c=null}},createHref(x){return e(a,x)},createURL:m,encodeLocation(x){let v=m(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:A,replace:h,go(x){return o.go(x)}};return p}function BAe(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Xs(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:u2(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function jY(t,e,r="/"){return kAe(t,e,r,!1)}function kAe(t,e,r,n){let a=typeof e=="string"?s1(e):e,s=gA(a.pathname||"/",r);if(s==null)return null;let o=IY(t);FAe(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=GAe(s);l=HAe(o[c],u,n)}return l}function IY(t,e=[],r=[],n="",a=!1){let s=(o,l,c=a,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;Xs(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=nA([n,d.relativePath]),A=r.concat(d);o.children&&o.children.length>0&&(Xs(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),IY(o.children,e,A,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:QAe(f,o.index),routesMeta:A})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let u of PY(o.path))s(o,l,!0,u)}),e}function PY(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=PY(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function FAe(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:VAe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var OAe=/^:[\w-]+$/,DAe=3,RAe=2,MAe=1,LAe=10,UAe=-2,VU=t=>t==="*";function QAe(t,e){let r=t.split("/"),n=r.length;return r.some(VU)&&(n+=UAe),e&&(n+=RAe),r.filter(a=>!VU(a)).reduce((a,s)=>a+(OAe.test(s)?DAe:s===""?MAe:LAe),n)}function VAe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function HAe(t,e,r=!1){let{routesMeta:n}=t,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=eS({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),A=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=eS({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:nA([s,f.pathname]),pathnameBase:WAe(nA([s,f.pathnameBase])),route:A}),f.pathnameBase!=="/"&&(s=nA([s,f.pathnameBase]))}return o}function eS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=$Ae(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},A)=>{if(d==="*"){let m=l[A]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[A];return f&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function $Ae(t,e=!1,r=!0){Cf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function GAe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Cf(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function gA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function KAe(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?s1(t):t;return{pathname:r?r.startsWith("/")?r:qAe(r,e):e,search:XAe(n),hash:YAe(a)}}function qAe(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function x4(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function zAe(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function bD(t){let e=zAe(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function wD(t,e,r,n=!1){let a;typeof t=="string"?a=s1(t):(a={...t},Xs(!a.pathname||!a.pathname.includes("?"),x4("?","pathname","search",a)),Xs(!a.pathname||!a.pathname.includes("#"),x4("#","pathname","hash",a)),Xs(!a.search||!a.search.includes("#"),x4("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let A=o.split("/");for(;A[0]==="..";)A.shift(),f-=1;a.pathname=A.join("/")}l=f>=0?e[f]:"/"}let c=KAe(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var nA=t=>t.join("/").replace(/\/\/+/g,"/"),WAe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),XAe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,YAe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function JAe(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var TY=["POST","PUT","PATCH","DELETE"];new Set(TY);var ZAe=["GET",...TY];new Set(ZAe);var i1=g.createContext(null);i1.displayName="DataRouter";var gI=g.createContext(null);gI.displayName="DataRouterState";g.createContext(!1);var BY=g.createContext({isTransitioning:!1});BY.displayName="ViewTransition";var e0e=g.createContext(new Map);e0e.displayName="Fetchers";var t0e=g.createContext(null);t0e.displayName="Await";var jf=g.createContext(null);jf.displayName="Navigation";var vw=g.createContext(null);vw.displayName="Location";var If=g.createContext({outlet:null,matches:[],isDataRoute:!1});If.displayName="Route";var ND=g.createContext(null);ND.displayName="RouteError";function r0e(t,{relative:e}={}){Xs(o1(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=g.useContext(jf),{hash:a,pathname:s,search:o}=bw(t,{relative:e}),l=s;return r!=="/"&&(l=s==="/"?r:nA([r,s])),n.createHref({pathname:l,search:o,hash:a})}function o1(){return g.useContext(vw)!=null}function kA(){return Xs(o1(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(vw).location}var kY="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function FY(t){g.useContext(jf).static||g.useLayoutEffect(t)}function yw(){let{isDataRoute:t}=g.useContext(If);return t?g0e():n0e()}function n0e(){Xs(o1(),"useNavigate() may be used only in the context of a <Router> component.");let t=g.useContext(i1),{basename:e,navigator:r}=g.useContext(jf),{matches:n}=g.useContext(If),{pathname:a}=kA(),s=JSON.stringify(bD(n)),o=g.useRef(!1);return FY(()=>{o.current=!0}),g.useCallback((c,u={})=>{if(Cf(o.current,kY),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=wD(c,JSON.parse(s),a,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:nA([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,s,a,t])}var a0e=g.createContext(null);function s0e(t){let e=g.useContext(If).outlet;return e&&g.createElement(a0e.Provider,{value:t},e)}function bw(t,{relative:e}={}){let{matches:r}=g.useContext(If),{pathname:n}=kA(),a=JSON.stringify(bD(r));return g.useMemo(()=>wD(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function i0e(t,e){return OY(t,e)}function OY(t,e,r,n){var v;Xs(o1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(jf),{matches:s}=g.useContext(If),o=s[s.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let y=d&&d.path||"";DY(c,!d||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let f=kA(),A;if(e){let y=typeof e=="string"?s1(e):e;Xs(u==="/"||((v=y.pathname)==null?void 0:v.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${y.pathname}" was given in the \`location\` prop.`),A=y}else A=f;let h=A.pathname||"/",m=h;if(u!=="/"){let y=u.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=jY(t,{pathname:m});Cf(d||p!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),Cf(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=d0e(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:nA([u,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:nA([u,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&x?g.createElement(vw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},x):x}function o0e(){let t=p0e(),e=JAe(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=g.createElement(g.Fragment,null,g.createElement("p",null," Hey developer "),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:s},"ErrorBoundary")," or"," ",g.createElement("code",{style:s},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),r?g.createElement("pre",{style:a},r):null,o)}var l0e=g.createElement(o0e,null),c0e=class extends g.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?g.createElement(If.Provider,{value:this.props.routeContext},g.createElement(ND.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function u0e({routeContext:t,match:e,children:r}){let n=g.useContext(i1);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(If.Provider,{value:t},r)}function d0e(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,s=r==null?void 0:r.errors;if(s!=null){let c=a.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);Xs(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<a.length;c++){let u=a[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:f}=r,A=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||A){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,u,d)=>{let f,A=!1,h=null,m=null;r&&(f=s&&u.route.id?s[u.route.id]:void 0,h=u.route.errorElement||l0e,o&&(l<0&&d===0?(DY("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,m=null):l===d&&(A=!0,m=u.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,d+1)),x=()=>{let v;return f?v=h:A?v=m:u.route.Component?v=g.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=c,g.createElement(u0e,{match:u,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:v})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?g.createElement(c0e,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function CD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function f0e(t){let e=g.useContext(i1);return Xs(e,CD(t)),e}function h0e(t){let e=g.useContext(gI);return Xs(e,CD(t)),e}function A0e(t){let e=g.useContext(If);return Xs(e,CD(t)),e}function _D(t){let e=A0e(t),r=e.matches[e.matches.length-1];return Xs(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function m0e(){return _D("useRouteId")}function p0e(){var n;let t=g.useContext(ND),e=h0e("useRouteError"),r=_D("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function g0e(){let{router:t}=f0e("useNavigate"),e=_D("useNavigate"),r=g.useRef(!1);return FY(()=>{r.current=!0}),g.useCallback(async(a,s={})=>{Cf(r.current,kY),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var HU={};function DY(t,e,r){!e&&!HU[t]&&(HU[t]=!0,Cf(!1,r))}g.memo(x0e);function x0e({routes:t,future:e,state:r}){return OY(t,void 0,r,e)}function Mh({to:t,replace:e,state:r,relative:n}){Xs(o1(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(jf);Cf(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=g.useContext(If),{pathname:o}=kA(),l=yw(),c=wD(t,bD(s),o,n==="path"),u=JSON.stringify(c);return g.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function RY(t){return s0e(t.context)}function Mn(t){Xs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function v0e({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){Xs(!o1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=g.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof r=="string"&&(r=s1(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:A="default"}=r,h=g.useMemo(()=>{let m=gA(c,o);return m==null?null:{location:{pathname:m,search:u,hash:d,state:f,key:A},navigationType:n}},[o,c,u,d,f,A,n]);return Cf(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:g.createElement(jf.Provider,{value:l},g.createElement(vw.Provider,{children:e,value:h}))}function y0e({children:t,location:e}){return i0e(OB(t),e)}function OB(t,e=[]){let r=[];return g.Children.forEach(t,(n,a)=>{if(!g.isValidElement(n))return;let s=[...e,a];if(n.type===g.Fragment){r.push.apply(r,OB(n.props.children,s));return}Xs(n.type===Mn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=OB(n.props.children,s)),r.push(o)}),r}var J_="get",Z_="application/x-www-form-urlencoded";function xI(t){return t!=null&&typeof t.tagName=="string"}function b0e(t){return xI(t)&&t.tagName.toLowerCase()==="button"}function w0e(t){return xI(t)&&t.tagName.toLowerCase()==="form"}function N0e(t){return xI(t)&&t.tagName.toLowerCase()==="input"}function C0e(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function _0e(t,e){return t.button===0&&(!e||e==="_self")&&!C0e(t)}var tC=null;function E0e(){if(tC===null)try{new FormData(document.createElement("form"),0),tC=!1}catch{tC=!0}return tC}var S0e=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function v4(t){return t!=null&&!S0e.has(t)?(Cf(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Z_}"`),null):t}function j0e(t,e){let r,n,a,s,o;if(w0e(t)){let l=t.getAttribute("action");n=l?gA(l,e):null,r=t.getAttribute("method")||J_,a=v4(t.getAttribute("enctype"))||Z_,s=new FormData(t)}else if(b0e(t)||N0e(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?gA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||J_,a=v4(t.getAttribute("formenctype"))||v4(l.getAttribute("enctype"))||Z_,s=new FormData(l,t),!E0e()){let{name:u,type:d,value:f}=t;if(d==="image"){let A=u?`${u}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else u&&s.append(u,f)}}else{if(xI(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=J_,n=null,a=Z_,o=t}return s&&a==="text/plain"&&(o=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ED(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function I0e(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&gA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function P0e(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function T0e(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function B0e(t,e,r){let n=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await P0e(s,r);return o.links?o.links():[]}return[]}));return D0e(n.flat(1).filter(T0e).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function $U(t,e,r,n,a,s){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):s==="data"?e.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let A=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function k0e(t,e,{includeHydrateFallback:r}={}){return F0e(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function F0e(t){return[...new Set(t)]}function O0e(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function D0e(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let s=JSON.stringify(O0e(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function MY(){let t=g.useContext(i1);return ED(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function R0e(){let t=g.useContext(gI);return ED(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var SD=g.createContext(void 0);SD.displayName="FrameworkContext";function LY(){let t=g.useContext(SD);return ED(t,"You must render this element inside a <HydratedRouter> element"),t}function M0e(t,e){let r=g.useContext(SD),[n,a]=g.useState(!1),[s,o]=g.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=e,A=g.useRef(null);g.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=v=>{v.forEach(y=>{o(y.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return A.current&&x.observe(A.current),()=>{x.disconnect()}}},[t]),g.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{a(!0)},m=()=>{a(!1),o(!1)};return r?t!=="intent"?[s,A,{}]:[s,A,{onFocus:iy(l,h),onBlur:iy(c,m),onMouseEnter:iy(u,h),onMouseLeave:iy(d,m),onTouchStart:iy(f,h)}]:[!1,A,{}]}function iy(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function L0e({page:t,...e}){let{router:r}=MY(),n=g.useMemo(()=>jY(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?g.createElement(Q0e,{page:t,matches:n,...e}):null}function U0e(t){let{manifest:e,routeModules:r}=LY(),[n,a]=g.useState([]);return g.useEffect(()=>{let s=!1;return B0e(t,e,r).then(o=>{s||a(o)}),()=>{s=!0}},[t,e,r]),n}function Q0e({page:t,matches:e,...r}){let n=kA(),{manifest:a,routeModules:s}=LY(),{basename:o}=MY(),{loaderData:l,matches:c}=R0e(),u=g.useMemo(()=>$U(t,e,c,a,n,"data"),[t,e,c,a,n]),d=g.useMemo(()=>$U(t,e,c,a,n,"assets"),[t,e,c,a,n]),f=g.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(v=>{var b;let y=a.routes[v.route.id];!y||!y.hasLoader||(!u.some(w=>w.route.id===v.route.id)&&v.route.id in l&&((b=s[v.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(v.route.id))}),m.size===0)return[];let x=I0e(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[x.pathname+x.search]},[o,l,n,a,u,e,t,s]),A=g.useMemo(()=>k0e(d,a),[d,a]),h=U0e(d);return g.createElement(g.Fragment,null,f.map(m=>g.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),A.map(m=>g.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>g.createElement("link",{key:m,nonce:r.nonce,...p})))}function V0e(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var UY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{UY&&(window.__reactRouterVersion="7.8.1")}catch{}function H0e({basename:t,children:e,window:r}){let n=g.useRef();n.current==null&&(n.current=IAe({window:r,v5Compat:!0}));let a=n.current,[s,o]=g.useState({action:a.action,location:a.location}),l=g.useCallback(c=>{g.startTransition(()=>o(c))},[o]);return g.useLayoutEffect(()=>a.listen(l),[a,l]),g.createElement(v0e,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var QY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,VY=g.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...A},h){let{basename:m}=g.useContext(jf),p=typeof u=="string"&&QY.test(u),x,v=!1;if(typeof u=="string"&&p&&(x=u,UY))try{let E=new URL(window.location.href),B=u.startsWith("//")?new URL(E.protocol+u):new URL(u),k=gA(B.pathname,m);B.origin===E.origin&&k!=null?u=k+B.search+B.hash:v=!0}catch{Cf(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=r0e(u,{relative:a}),[b,w,I]=M0e(n,A),j=K0e(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:f});function C(E){e&&e(E),E.defaultPrevented||j(E)}let S=g.createElement("a",{...A,...I,href:x||y,onClick:v||s?e:C,ref:V0e(h,w),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?g.createElement(g.Fragment,null,S,g.createElement(L0e,{page:y})):S});VY.displayName="Link";var xn=g.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:o,viewTransition:l,children:c,...u},d){let f=bw(o,{relative:u.relative}),A=kA(),h=g.useContext(gI),{navigator:m,basename:p}=g.useContext(jf),x=h!=null&&Y0e(f)&&l===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=A.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=gA(b,p)||b);const w=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let I=y===v||!a&&y.startsWith(v)&&y.charAt(w)==="/",j=b!=null&&(b===v||!a&&b.startsWith(v)&&b.charAt(v.length)==="/"),C={isActive:I,isPending:j,isTransitioning:x},S=I?e:void 0,E;typeof n=="function"?E=n(C):E=[n,I?"active":null,j?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let B=typeof s=="function"?s(C):s;return g.createElement(VY,{...u,"aria-current":S,className:E,ref:d,style:B,to:o,viewTransition:l},typeof c=="function"?c(C):c)});xn.displayName="NavLink";var $0e=g.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:s,method:o=J_,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...A},h)=>{let m=W0e(),p=X0e(l,{relative:u}),x=o.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&QY.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let w=b.nativeEvent.submitter,I=(w==null?void 0:w.getAttribute("formmethod"))||o;m(w||b.currentTarget,{fetcherKey:e,method:I,navigate:r,replace:a,state:s,relative:u,preventScrollReset:d,viewTransition:f})};return g.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:y,...A,"data-discover":!v&&t==="render"?"true":void 0})});$0e.displayName="Form";function G0e(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HY(t){let e=g.useContext(i1);return Xs(e,G0e(t)),e}function K0e(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:o}={}){let l=yw(),c=kA(),u=bw(t,{relative:s});return g.useCallback(d=>{if(_0e(d,e)){d.preventDefault();let f=r!==void 0?r:u2(c)===u2(u);l(t,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,u,r,n,e,t,a,s,o])}var q0e=0,z0e=()=>`__${String(++q0e)}__`;function W0e(){let{router:t}=HY("useSubmit"),{basename:e}=g.useContext(jf),r=m0e();return g.useCallback(async(n,a={})=>{let{action:s,method:o,encType:l,formData:c,body:u}=j0e(n,e);if(a.navigate===!1){let d=a.fetcherKey||z0e();await t.fetch(d,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function X0e(t,{relative:e}={}){let{basename:r}=g.useContext(jf),n=g.useContext(If);Xs(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...bw(t||".",{relative:e})},o=kA();if(t==null){s.search=o.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();s.search=d?`?${d}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:nA([r,s.pathname])),u2(s)}function Y0e(t,{relative:e}={}){let r=g.useContext(BY);Xs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=HY("useViewTransitionState"),a=bw(t,{relative:e});if(!r.isTransitioning)return!1;let s=gA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=gA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return eS(a.pathname,o)!=null||eS(a.pathname,s)!=null}function En(t,e){if(!t)return!1;const r=String(e);if(Array.isArray(t))return t.map(String).includes(r);const n=String(t);return n===r||n==="vendedor"&&r==="vendedor_pollo"}var GU={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Y=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},J0e=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[r++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[r++],o=t[r++],l=t[r++],c=((a&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|o&63)}}return e.join("")},GY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const s=t[a],o=a+1<t.length,l=o?t[a+1]:0,c=a+2<t.length,u=c?t[a+2]:0,d=s>>2,f=(s&3)<<4|l>>4;let A=(l&15)<<2|u>>6,h=u&63;c||(h=64,o||(A=64)),n.push(r[d],r[f],r[A],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray($Y(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):J0e(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const s=r[t.charAt(a++)],l=a<t.length?r[t.charAt(a)]:0;++a;const u=a<t.length?r[t.charAt(a)]:64;++a;const f=a<t.length?r[t.charAt(a)]:64;if(++a,s==null||l==null||u==null||f==null)throw new Z0e;const A=s<<2|l>>4;if(n.push(A),u!==64){const h=l<<4&240|u>>2;if(n.push(h),f!==64){const m=u<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Z0e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eme=function(t){const e=$Y(t);return GY.encodeByteArray(e,!0)},tS=function(t){return eme(t).replace(/\./g,"")},KY=function(t){try{return GY.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tme(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rme=()=>tme().__FIREBASE_DEFAULTS__,nme=()=>{if(typeof process>"u"||typeof GU>"u")return;const t=GU.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ame=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&KY(t[1]);return e&&JSON.parse(e)},vI=()=>{try{return rme()||nme()||ame()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qY=t=>{var e,r;return(r=(e=vI())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},sme=t=>{const e=qY(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},zY=()=>{var t;return(t=vI())===null||t===void 0?void 0:t.config},WY=t=>{var e;return(e=vI())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ime{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ome(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[tS(JSON.stringify(r)),tS(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oo())}function cme(){var t;const e=(t=vI())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ume(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function fme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hme(){const t=Oo();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function XY(){return!cme()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function YY(){try{return typeof indexedDB=="object"}catch{return!1}}function Ame(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mme="FirebaseError";class FA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=mme,Object.setPrototypeOf(this,FA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ww.prototype.create)}}class ww{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],o=s?pme(s,n):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new FA(a,l,n)}}function pme(t,e){return t.replace(gme,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const gme=/\{\$([^}]+)}/g;function xme(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function d2(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const s=t[a],o=e[a];if(KU(s)&&KU(o)){if(!d2(s,o))return!1}else if(s!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function KU(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Uy(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,s]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(s)}}),e}function Qy(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function vme(t,e){const r=new yme(t,e);return r.subscribe.bind(r)}class yme{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");bme(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=y4),a.error===void 0&&(a.error=y4),a.complete===void 0&&(a.complete=y4);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bme(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function y4(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t){return t&&t._delegate?t._delegate:t}class sg{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wme=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new ime;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Cme(e))try{this.getOrInitializeService({instanceIdentifier:dp})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=dp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dp){return this.instances.has(e)}getOptions(e=dp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const o=this.instances.get(a);return o&&e(o,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Nme(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=dp){return this.component?this.component.multipleInstances?e:dp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Nme(t){return t===dp?void 0:t}function Cme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _me{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new wme(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Aa;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Aa||(Aa={}));const Eme={debug:Aa.DEBUG,verbose:Aa.VERBOSE,info:Aa.INFO,warn:Aa.WARN,error:Aa.ERROR,silent:Aa.SILENT},Sme=Aa.INFO,jme={[Aa.DEBUG]:"log",[Aa.VERBOSE]:"log",[Aa.INFO]:"info",[Aa.WARN]:"warn",[Aa.ERROR]:"error"},Ime=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=jme[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let jD=class{constructor(e){this.name=e,this._logLevel=Sme,this._logHandler=Ime,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Aa))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Eme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Aa.DEBUG,...e),this._logHandler(this,Aa.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Aa.VERBOSE,...e),this._logHandler(this,Aa.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Aa.INFO,...e),this._logHandler(this,Aa.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Aa.WARN,...e),this._logHandler(this,Aa.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Aa.ERROR,...e),this._logHandler(this,Aa.ERROR,...e)}};const Pme=(t,e)=>e.some(r=>t instanceof r);let qU,zU;function Tme(){return qU||(qU=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bme(){return zU||(zU=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JY=new WeakMap,DB=new WeakMap,ZY=new WeakMap,b4=new WeakMap,ID=new WeakMap;function kme(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{r(cm(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&JY.set(r,t)}).catch(()=>{}),ID.set(e,t),e}function Fme(t){if(DB.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});DB.set(t,e)}let RB={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return DB.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ZY.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return cm(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ome(t){RB=t(RB)}function Dme(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(w4(this),e,...r);return ZY.set(n,e.sort?e.sort():[e]),cm(n)}:Bme().includes(t)?function(...e){return t.apply(w4(this),e),cm(JY.get(this))}:function(...e){return cm(t.apply(w4(this),e))}}function Rme(t){return typeof t=="function"?Dme(t):(t instanceof IDBTransaction&&Fme(t),Pme(t,Tme())?new Proxy(t,RB):t)}function cm(t){if(t instanceof IDBRequest)return kme(t);if(b4.has(t))return b4.get(t);const e=Rme(t);return e!==t&&(b4.set(t,e),ID.set(e,t)),e}const w4=t=>ID.get(t);function Mme(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const o=indexedDB.open(t,e),l=cm(o);return n&&o.addEventListener("upgradeneeded",c=>{n(cm(o.result),c.oldVersion,c.newVersion,cm(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Lme=["get","getKey","getAll","getAllKeys","count"],Ume=["put","add","delete","clear"],N4=new Map;function WU(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(N4.get(e))return N4.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=Ume.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||Lme.includes(r)))return;const s=async function(o,...l){const c=this.transaction(o,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),a&&c.done]))[0]};return N4.set(e,s),s}Ome(t=>({...t,get:(e,r,n)=>WU(e,r)||t.get(e,r,n),has:(e,r)=>!!WU(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Vme(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Vme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const MB="@firebase/app",XU="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new jD("@firebase/app"),Hme="@firebase/app-compat",$me="@firebase/analytics-compat",Gme="@firebase/analytics",Kme="@firebase/app-check-compat",qme="@firebase/app-check",zme="@firebase/auth",Wme="@firebase/auth-compat",Xme="@firebase/database",Yme="@firebase/data-connect",Jme="@firebase/database-compat",Zme="@firebase/functions",epe="@firebase/functions-compat",tpe="@firebase/installations",rpe="@firebase/installations-compat",npe="@firebase/messaging",ape="@firebase/messaging-compat",spe="@firebase/performance",ipe="@firebase/performance-compat",ope="@firebase/remote-config",lpe="@firebase/remote-config-compat",cpe="@firebase/storage",upe="@firebase/storage-compat",dpe="@firebase/firestore",fpe="@firebase/vertexai-preview",hpe="@firebase/firestore-compat",Ape="firebase",mpe="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LB="[DEFAULT]",ppe={[MB]:"fire-core",[Hme]:"fire-core-compat",[Gme]:"fire-analytics",[$me]:"fire-analytics-compat",[qme]:"fire-app-check",[Kme]:"fire-app-check-compat",[zme]:"fire-auth",[Wme]:"fire-auth-compat",[Xme]:"fire-rtdb",[Yme]:"fire-data-connect",[Jme]:"fire-rtdb-compat",[Zme]:"fire-fn",[epe]:"fire-fn-compat",[tpe]:"fire-iid",[rpe]:"fire-iid-compat",[npe]:"fire-fcm",[ape]:"fire-fcm-compat",[spe]:"fire-perf",[ipe]:"fire-perf-compat",[ope]:"fire-rc",[lpe]:"fire-rc-compat",[cpe]:"fire-gcs",[upe]:"fire-gcs-compat",[dpe]:"fire-fst",[hpe]:"fire-fst-compat",[fpe]:"fire-vertex","fire-js":"fire-js",[Ape]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=new Map,UB=new Map,QB=new Map;function YU(t,e){try{t.container.addComponent(e)}catch(r){xA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Tv(t){const e=t.name;if(QB.has(e))return xA.debug(`There were multiple attempts to register component ${e}.`),!1;QB.set(e,t);for(const r of Pv.values())YU(r,t);for(const r of UB.values())YU(r,t);return!0}function PD(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Yf(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gpe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},um=new ww("app","Firebase",gpe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xpe{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new sg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw um.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=mpe;function TD(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:LB,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw um.create("bad-app-name",{appName:String(a)});if(r||(r=zY()),!r)throw um.create("no-options");const s=Pv.get(a);if(s){if(d2(r,s.options)&&d2(n,s.config))return s;throw um.create("duplicate-app",{appName:a})}const o=new _me(a);for(const c of QB.values())o.addComponent(c);const l=new xpe(r,n,o);return Pv.set(a,l),l}function BD(t=LB){const e=Pv.get(t);if(!e&&t===LB&&zY())return TD();if(!e)throw um.create("no-app",{appName:t});return e}async function vpe(t){let e=!1;const r=t.name;Pv.has(r)?(e=!0,Pv.delete(r)):UB.has(r)&&t.decRefCount()<=0&&(UB.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function dm(t,e,r){var n;let a=(n=ppe[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const s=a.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${a}" with version "${e}":`];s&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xA.warn(l.join(" "));return}Tv(new sg(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ype="firebase-heartbeat-database",bpe=1,f2="firebase-heartbeat-store";let C4=null;function eJ(){return C4||(C4=Mme(ype,bpe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(f2)}catch(r){console.warn(r)}}}}).catch(t=>{throw um.create("idb-open",{originalErrorMessage:t.message})})),C4}async function wpe(t){try{const r=(await eJ()).transaction(f2),n=await r.objectStore(f2).get(tJ(t));return await r.done,n}catch(e){if(e instanceof FA)xA.warn(e.message);else{const r=um.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});xA.warn(r.message)}}}async function JU(t,e){try{const n=(await eJ()).transaction(f2,"readwrite");await n.objectStore(f2).put(e,tJ(t)),await n.done}catch(r){if(r instanceof FA)xA.warn(r.message);else{const n=um.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});xA.warn(n.message)}}}function tJ(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Npe=1024,Cpe=30*24*60*60*1e3;class _pe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Spe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ZU();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Cpe}),this._storage.overwrite(this._heartbeatsCache))}catch(n){xA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=ZU(),{heartbeatsToSend:n,unsentEntries:a}=Epe(this._heartbeatsCache.heartbeats),s=tS(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return xA.warn(r),""}}}function ZU(){return new Date().toISOString().substring(0,10)}function Epe(t,e=Npe){const r=[];let n=t.slice();for(const a of t){const s=r.find(o=>o.agent===a.agent);if(s){if(s.dates.push(a.date),e7(r)>e){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),e7(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Spe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YY()?Ame().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await wpe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return JU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return JU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function e7(t){return tS(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jpe(t){Tv(new sg("platform-logger",e=>new Qme(e),"PRIVATE")),Tv(new sg("heartbeat",e=>new _pe(e),"PRIVATE")),dm(MB,XU,t),dm(MB,XU,"esm2017"),dm("fire-js","")}jpe("");function kD(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function rJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ipe=rJ,nJ=new ww("auth","Firebase",rJ());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=new jD("@firebase/auth");function Ppe(t,...e){rS.logLevel<=Aa.WARN&&rS.warn(`Auth (${l1}): ${t}`,...e)}function eE(t,...e){rS.logLevel<=Aa.ERROR&&rS.error(`Auth (${l1}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(t,...e){throw FD(t,...e)}function ih(t,...e){return FD(t,...e)}function aJ(t,e,r){const n=Object.assign(Object.assign({},Ipe()),{[e]:r});return new ww("auth","Firebase",n).create(e,{appName:t.name})}function aA(t){return aJ(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function FD(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return nJ.create(t,...e)}function Rn(t,e,...r){if(!t)throw FD(e,...r)}function zh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw eE(e),new Error(e)}function vA(t,e){t||zh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Tpe(){return t7()==="http:"||t7()==="https:"}function t7(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bpe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Tpe()||dme()||"connection"in navigator)?navigator.onLine:!0}function kpe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(e,r){this.shortDelay=e,this.longDelay=r,vA(r>e,"Short delay should be less than long delay!"),this.isMobile=lme()||fme()}get(){return Bpe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OD(t,e){vA(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sJ{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ope=new Cw(3e4,6e4);function OA(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function DA(t,e,r,n,a={}){return iJ(t,a,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=Nw(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return ume()||(u.referrerPolicy="no-referrer"),sJ.fetch()(oJ(t,t.config.apiHost,r,l),u)})}async function iJ(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Fpe),e);try{const a=new Rpe(t),s=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw rC(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw rC(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw rC(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw rC(t,"user-disabled",o);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw aJ(t,d,u);_f(t,d)}}catch(a){if(a instanceof FA)throw a;_f(t,"network-request-failed",{message:String(a)})}}async function _w(t,e,r,n,a={}){const s=await DA(t,e,r,n,a);return"mfaPendingCredential"in s&&_f(t,"multi-factor-auth-required",{_serverResponse:s}),s}function oJ(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?OD(t.config,a):`${t.config.apiScheme}://${a}`}function Dpe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Rpe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ih(this.auth,"network-request-failed")),Ope.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rC(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=ih(t,e,n);return a.customData._tokenResponse=r,a}function r7(t){return t!==void 0&&t.enterprise!==void 0}class Mpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Dpe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Lpe(t,e){return DA(t,"GET","/v2/recaptchaConfig",OA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Upe(t,e){return DA(t,"POST","/v1/accounts:delete",e)}async function lJ(t,e){return DA(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Qpe(t,e=!1){const r=Ai(t),n=await r.getIdToken(e),a=DD(n);Rn(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:gb(_4(a.auth_time)),issuedAtTime:gb(_4(a.iat)),expirationTime:gb(_4(a.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function _4(t){return Number(t)*1e3}function DD(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return eE("JWT malformed, contained fewer than 3 sections"),null;try{const a=KY(r);return a?JSON.parse(a):(eE("Failed to decode base64 JWT payload"),null)}catch(a){return eE("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function n7(t){const e=DD(t);return Rn(e,"internal-error"),Rn(typeof e.exp<"u","internal-error"),Rn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h2(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof FA&&Vpe(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Vpe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hpe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=gb(this.lastLoginAt),this.creationTime=gb(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nS(t){var e;const r=t.auth,n=await t.getIdToken(),a=await h2(t,lJ(r,{idToken:n}));Rn(a==null?void 0:a.users.length,r,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?cJ(s.providerUserInfo):[],l=Gpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new HB(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function $pe(t){const e=Ai(t);await nS(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Gpe(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function cJ(t){return t.map(e=>{var{providerId:r}=e,n=kD(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kpe(t,e){const r=await iJ(t,{},async()=>{const n=Nw({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,o=oJ(t,a,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",sJ.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function qpe(t,e){return DA(t,"POST","/v2/accounts:revokeToken",OA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rn(e.idToken,"internal-error"),Rn(typeof e.idToken<"u","internal-error"),Rn(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):n7(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Rn(e.length!==0,"internal-error");const r=n7(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Rn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:s}=await Kpe(e,r);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:s}=r,o=new dv;return n&&(Rn(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(Rn(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),s&&(Rn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dv,this.toJSON())}_performRefresh(){return zh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(t,e){Rn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wh{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,s=kD(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Hpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new HB(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await h2(this,this.stsTokenManager.getToken(this.auth,e));return Rn(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Qpe(this,e)}reload(){return $pe(this)}_assign(e){this!==e&&(Rn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Wh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Rn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await nS(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yf(this.auth.app))return Promise.reject(aA(this.auth));const e=await this.getIdToken();return await h2(this,Upe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,s,o,l,c,u,d;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,A=(a=r.email)!==null&&a!==void 0?a:void 0,h=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=r.createdAt)!==null&&u!==void 0?u:void 0,y=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:b,emailVerified:w,isAnonymous:I,providerData:j,stsTokenManager:C}=r;Rn(b&&C,e,"internal-error");const S=dv.fromJSON(this.name,C);Rn(typeof b=="string",e,"internal-error"),c0(f,e.name),c0(A,e.name),Rn(typeof w=="boolean",e,"internal-error"),Rn(typeof I=="boolean",e,"internal-error"),c0(h,e.name),c0(m,e.name),c0(p,e.name),c0(x,e.name),c0(v,e.name),c0(y,e.name);const E=new Wh({uid:b,auth:e,email:A,emailVerified:w,displayName:f,isAnonymous:I,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:v,lastLoginAt:y});return j&&Array.isArray(j)&&(E.providerData=j.map(B=>Object.assign({},B))),x&&(E._redirectEventId=x),E}static async _fromIdTokenResponse(e,r,n=!1){const a=new dv;a.updateFromServerResponse(r);const s=new Wh({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await nS(s),s}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];Rn(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?cJ(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),l=new dv;l.updateFromIdToken(n);const c=new Wh({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new HB(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a7=new Map;function Xh(t){vA(t instanceof Function,"Expected a class definition");let e=a7.get(t);return e?(vA(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,a7.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}uJ.type="NONE";const s7=uJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(t,e,r){return`firebase:${t}:${e}:${r}`}class fv{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=tE(this.userKey,a.apiKey,s),this.fullPersistenceKey=tE("persistence",a.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new fv(Xh(s7),e,n);const a=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=a[0]||Xh(s7);const o=tE(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(o);if(d){const f=Wh._fromJSON(e,d);u!==s&&(l=f),s=u;break}}catch{}const c=a.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new fv(s,e,n):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new fv(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i7(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pJ(e))return"Blackberry";if(gJ(e))return"Webos";if(fJ(e))return"Safari";if((e.includes("chrome/")||hJ(e))&&!e.includes("edge/"))return"Chrome";if(mJ(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function dJ(t=Oo()){return/firefox\//i.test(t)}function fJ(t=Oo()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hJ(t=Oo()){return/crios\//i.test(t)}function AJ(t=Oo()){return/iemobile/i.test(t)}function mJ(t=Oo()){return/android/i.test(t)}function pJ(t=Oo()){return/blackberry/i.test(t)}function gJ(t=Oo()){return/webos/i.test(t)}function RD(t=Oo()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function zpe(t=Oo()){var e;return RD(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Wpe(){return hme()&&document.documentMode===10}function xJ(t=Oo()){return RD(t)||mJ(t)||gJ(t)||pJ(t)||/windows phone/i.test(t)||AJ(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vJ(t,e=[]){let r;switch(t){case"Browser":r=i7(Oo());break;case"Worker":r=`${i7(Oo())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${l1}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xpe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ype(t,e={}){return DA(t,"GET","/v2/passwordPolicy",OA(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jpe=6;class Zpe{constructor(e){var r,n,a,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:Jpe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(a=c.containsLowercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ege{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new o7(this),this.idTokenSubscription=new o7(this),this.beforeStateQueue=new Xpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nJ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Xh(r)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await fv.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await lJ(this,{idToken:e}),n=await Wh._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Yf(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=a==null?void 0:a._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(a=c.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Rn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await nS(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kpe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yf(this.app))return Promise.reject(aA(this));const r=e?Ai(e):null;return r&&Rn(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Rn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yf(this.app)?Promise.reject(aA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yf(this.app)?Promise.reject(aA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Xh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ype(this),r=new Zpe(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ww("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await qpe(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Xh(e)||this._popupRedirectResolver;Rn(r,this,"argument-error"),this.redirectPersistenceManager=await fv.create(this,[Xh(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rn(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,a);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Ppe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Um(t){return Ai(t)}class o7{constructor(e){this.auth=e,this.observer=null,this.addObserver=vme(r=>this.observer=r)}get next(){return Rn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tge(t){yI=t}function yJ(t){return yI.loadJS(t)}function rge(){return yI.recaptchaEnterpriseScript}function nge(){return yI.gapiScript}function age(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const sge="recaptcha-enterprise",ige="NO_RECAPTCHA";class oge{constructor(e){this.type=sge,this.auth=Um(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Lpe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Mpe(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function a(s,o,l){const c=window.grecaptcha;r7(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(ige)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{n(this.auth).then(l=>{if(!r&&r7(window.grecaptcha))a(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=rge();c.length!==0&&(c+=l),yJ(c).then(()=>{a(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function l7(t,e,r,n=!1){const a=new oge(t);let s;try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function aS(t,e,r,n){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await l7(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await l7(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lge(t,e){const r=PD(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),s=r.getOptions();if(d2(s,e??{}))return a;_f(a,"already-initialized")}return r.initialize({options:e})}function cge(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Xh);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function uge(t,e,r){const n=Um(t);Rn(n._canInitEmulator,n,"emulator-config-failed"),Rn(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=bJ(e),{host:o,port:l}=dge(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${s}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),fge()}function bJ(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function dge(t){const e=bJ(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:c7(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:c7(o)}}}function c7(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function fge(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return zh("not implemented")}_getIdTokenResponse(e){return zh("not implemented")}_linkToIdToken(e,r){return zh("not implemented")}_getReauthenticationResolver(e){return zh("not implemented")}}async function hge(t,e){return DA(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Age(t,e){return _w(t,"POST","/v1/accounts:signInWithPassword",OA(t,e))}async function mge(t,e){return DA(t,"POST","/v1/accounts:sendOobCode",OA(t,e))}async function pge(t,e){return mge(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gge(t,e){return _w(t,"POST","/v1/accounts:signInWithEmailLink",OA(t,e))}async function xge(t,e){return _w(t,"POST","/v1/accounts:signInWithEmailLink",OA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2 extends MD{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new A2(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new A2(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aS(e,r,"signInWithPassword",Age);case"emailLink":return gge(e,{email:this._email,oobCode:this._password});default:_f(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aS(e,n,"signUpPassword",hge);case"emailLink":return xge(e,{idToken:r,email:this._email,oobCode:this._password});default:_f(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hv(t,e){return _w(t,"POST","/v1/accounts:signInWithIdp",OA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vge="http://localhost";class ig extends MD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ig(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):_f("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,s=kD(r,["providerId","signInMethod"]);if(!n||!a)return null;const o=new ig(n,a);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return hv(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,hv(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,hv(e,r)}buildRequest(){const e={requestUri:vge,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Nw(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function bge(t){const e=Uy(Qy(t)).link,r=e?Uy(Qy(e)).deep_link_id:null,n=Uy(Qy(t)).deep_link_id;return(n?Uy(Qy(n)).link:null)||n||r||e||t}class LD{constructor(e){var r,n,a,s,o,l;const c=Uy(Qy(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,f=yge((a=c.mode)!==null&&a!==void 0?a:null);Rn(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=bge(e);try{return new LD(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(){this.providerId=c1.PROVIDER_ID}static credential(e,r){return A2._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=LD.parseLink(r);return Rn(n,"argument-error"),A2._fromEmailAndCode(e,n.code,n.tenantId)}}c1.PROVIDER_ID="password";c1.EMAIL_PASSWORD_SIGN_IN_METHOD="password";c1.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew extends wJ{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0 extends Ew{constructor(){super("facebook.com")}static credential(e){return ig._fromParams({providerId:D0.PROVIDER_ID,signInMethod:D0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return D0.credentialFromTaggedObject(e)}static credentialFromError(e){return D0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return D0.credential(e.oauthAccessToken)}catch{return null}}}D0.FACEBOOK_SIGN_IN_METHOD="facebook.com";D0.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0 extends Ew{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ig._fromParams({providerId:R0.PROVIDER_ID,signInMethod:R0.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return R0.credentialFromTaggedObject(e)}static credentialFromError(e){return R0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return R0.credential(r,n)}catch{return null}}}R0.GOOGLE_SIGN_IN_METHOD="google.com";R0.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0 extends Ew{constructor(){super("github.com")}static credential(e){return ig._fromParams({providerId:M0.PROVIDER_ID,signInMethod:M0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return M0.credentialFromTaggedObject(e)}static credentialFromError(e){return M0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return M0.credential(e.oauthAccessToken)}catch{return null}}}M0.GITHUB_SIGN_IN_METHOD="github.com";M0.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0 extends Ew{constructor(){super("twitter.com")}static credential(e,r){return ig._fromParams({providerId:L0.PROVIDER_ID,signInMethod:L0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return L0.credentialFromTaggedObject(e)}static credentialFromError(e){return L0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return L0.credential(r,n)}catch{return null}}}L0.TWITTER_SIGN_IN_METHOD="twitter.com";L0.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wge(t,e){return _w(t,"POST","/v1/accounts:signUp",OA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const s=await Wh._fromIdTokenResponse(e,n,a),o=u7(n);return new og({user:s,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=u7(n);return new og({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function u7(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS extends FA{constructor(e,r,n,a){var s;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,sS.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new sS(e,r,n,a)}}function NJ(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?sS._fromErrorAndOperation(t,s,e,n):s})}async function Nge(t,e,r=!1){const n=await h2(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return og._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cge(t,e,r=!1){const{auth:n}=t;if(Yf(n.app))return Promise.reject(aA(n));const a="reauthenticate";try{const s=await h2(t,NJ(n,a,e,t),r);Rn(s.idToken,n,"internal-error");const o=DD(s.idToken);Rn(o,n,"internal-error");const{sub:l}=o;return Rn(t.uid===l,n,"user-mismatch"),og._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_f(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CJ(t,e,r=!1){if(Yf(t.app))return Promise.reject(aA(t));const n="signIn",a=await NJ(t,n,e),s=await og._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(s.user),s}async function _ge(t,e){return CJ(Um(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _J(t){const e=Um(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Ege(t,e,r){const n=Um(t);await aS(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",pge)}async function Sge(t,e,r){if(Yf(t.app))return Promise.reject(aA(t));const n=Um(t),o=await aS(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wge).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&_J(t),c}),l=await og._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function jge(t,e,r){return Yf(t.app)?Promise.reject(aA(t)):_ge(Ai(t),c1.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&_J(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t,e){return Ai(t).setPersistence(e)}function Ige(t,e,r,n){return Ai(t).onIdTokenChanged(e,r,n)}function Pge(t,e,r){return Ai(t).beforeAuthStateChanged(e,r)}function bI(t,e,r,n){return Ai(t).onAuthStateChanged(e,r,n)}function UD(t){return Ai(t).signOut()}const iS="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(iS,"1"),this.storage.removeItem(iS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tge=1e3,Bge=10;class SJ extends EJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);Wpe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Bge):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Tge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}SJ.type="LOCAL";const QD=SJ;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jJ extends EJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}jJ.type="SESSION";const VD=jJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new wI(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:s}=r.data,o=this.handlersMap[a];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const l=Array.from(o).map(async u=>u(r.origin,s)),c=await kge(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wI.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=HD("",20);a.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(f){const A=f;if(A.data.eventId===u)switch(A.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(A.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(){return window}function Oge(t){oh().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IJ(){return typeof oh().WorkerGlobalScope<"u"&&typeof oh().importScripts=="function"}async function Dge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Rge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Mge(){return IJ()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PJ="firebaseLocalStorageDb",Lge=1,oS="firebaseLocalStorage",TJ="fbase_key";class Sw{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function NI(t,e){return t.transaction([oS],e?"readwrite":"readonly").objectStore(oS)}function Uge(){const t=indexedDB.deleteDatabase(PJ);return new Sw(t).toPromise()}function $B(){const t=indexedDB.open(PJ,Lge);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(oS,{keyPath:TJ})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(oS)?e(n):(n.close(),await Uge(),e(await $B()))})})}async function d7(t,e,r){const n=NI(t,!0).put({[TJ]:e,value:r});return new Sw(n).toPromise()}async function Qge(t,e){const r=NI(t,!1).get(e),n=await new Sw(r).toPromise();return n===void 0?null:n.value}function f7(t,e){const r=NI(t,!0).delete(e);return new Sw(r).toPromise()}const Vge=800,Hge=3;class BJ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $B(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Hge)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return IJ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wI._getInstance(Mge()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await Dge(),!this.activeServiceWorker)return;this.sender=new Fge(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Rge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $B();return await d7(e,iS,"1"),await f7(e,iS),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>d7(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Qge(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>f7(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=NI(a,!1).getAll();return new Sw(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Vge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}BJ.type="LOCAL";const kJ=BJ;new Cw(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $ge(t,e){return e?Xh(e):(Rn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D extends MD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hv(e,this._buildIdpRequest())}_linkToIdToken(e,r){return hv(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return hv(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Gge(t){return CJ(t.auth,new $D(t),t.bypassAuthState)}function Kge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),Cge(r,new $D(t),t.bypassAuthState)}async function qge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),Nge(r,new $D(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FJ{constructor(e,r,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Gge;case"linkViaPopup":case"linkViaRedirect":return qge;case"reauthViaPopup":case"reauthViaRedirect":return Kge;default:_f(this.auth,"internal-error")}}resolve(e){vA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zge=new Cw(2e3,1e4);class Wx extends FJ{constructor(e,r,n,a,s){super(e,r,a,s),this.provider=n,this.authWindow=null,this.pollId=null,Wx.currentPopupAction&&Wx.currentPopupAction.cancel(),Wx.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rn(e,this.auth,"internal-error"),e}async onExecution(){vA(this.filter.length===1,"Popup operations only handle one event");const e=HD();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ih(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ih(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wx.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ih(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,zge.get())};e()}}Wx.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wge="pendingRedirect",nE=new Map;class Xge extends FJ{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=nE.get(this.auth._key());if(!e){try{const n=await Yge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}nE.set(this.auth._key(),e)}return this.bypassAuthState||nE.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Yge(t,e){const r=exe(e),n=Zge(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function Jge(t,e){nE.set(t._key(),e)}function Zge(t){return Xh(t._redirectPersistence)}function exe(t){return tE(Wge,t.config.apiKey,t.name)}async function txe(t,e,r=!1){if(Yf(t.app))return Promise.reject(aA(t));const n=Um(t),a=$ge(n,e),o=await new Xge(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rxe=10*60*1e3;class nxe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!axe(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!OJ(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ih(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rxe&&this.cachedEventUids.clear(),this.cachedEventUids.has(h7(e))}saveEventToCache(e){this.cachedEventUids.add(h7(e)),this.lastProcessedEventTime=Date.now()}}function h7(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function OJ({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function axe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return OJ(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sxe(t,e={}){return DA(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ixe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oxe=/^https?/;async function lxe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await sxe(t);for(const r of e)try{if(cxe(r))return}catch{}_f(t,"unauthorized-domain")}function cxe(t){const e=VB(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!oxe.test(r))return!1;if(ixe.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uxe=new Cw(3e4,6e4);function A7(){const t=oh().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function dxe(t){return new Promise((e,r)=>{var n,a,s;function o(){A7(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{A7(),r(ih(t,"network-request-failed"))},timeout:uxe.get()})}if(!((a=(n=oh().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=oh().gapi)===null||s===void 0)&&s.load)o();else{const l=age("iframefcb");return oh()[l]=()=>{gapi.load?o():r(ih(t,"network-request-failed"))},yJ(`${nge()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw aE=null,e})}let aE=null;function fxe(t){return aE=aE||dxe(t),aE}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hxe=new Cw(5e3,15e3),Axe="__/auth/iframe",mxe="emulator/auth/iframe",pxe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gxe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xxe(t){const e=t.config;Rn(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?OD(e,mxe):`https://${t.config.authDomain}/${Axe}`,n={apiKey:e.apiKey,appName:t.name,v:l1},a=gxe.get(t.config.apiHost);a&&(n.eid=a);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Nw(n).slice(1)}`}async function vxe(t){const e=await fxe(t),r=oh().gapi;return Rn(r,t,"internal-error"),e.open({where:document.body,url:xxe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pxe,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const o=ih(t,"network-request-failed"),l=oh().setTimeout(()=>{s(o)},hxe.get());function c(){oh().clearTimeout(l),a(n)}n.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yxe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bxe=500,wxe=600,Nxe="_blank",Cxe="http://localhost";class m7{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _xe(t,e,r,n=bxe,a=wxe){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},yxe),{width:n.toString(),height:a.toString(),top:s,left:o}),u=Oo().toLowerCase();r&&(l=hJ(u)?Nxe:r),dJ(u)&&(e=e||Cxe,c.scrollbars="yes");const d=Object.entries(c).reduce((A,[h,m])=>`${A}${h}=${m},`,"");if(zpe(u)&&l!=="_self")return Exe(e||"",l),new m7(null);const f=window.open(e||"",l,d);Rn(f,t,"popup-blocked");try{f.focus()}catch{}return new m7(f)}function Exe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sxe="__/auth/handler",jxe="emulator/auth/handler",Ixe=encodeURIComponent("fac");async function p7(t,e,r,n,a,s){Rn(t.config.authDomain,t,"auth-domain-config-required"),Rn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:l1,eventId:a};if(e instanceof wJ){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",xme(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof Ew){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${Ixe}=${encodeURIComponent(c)}`:"";return`${Pxe(t)}?${Nw(l).slice(1)}${u}`}function Pxe({config:t}){return t.emulator?OD(t,jxe):`https://${t.authDomain}/${Sxe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4="webStorageSupport";class Txe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=VD,this._completeRedirectFn=txe,this._overrideRedirectResult=Jge}async _openPopup(e,r,n,a){var s;vA((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await p7(e,r,n,VB(),a);return _xe(e,o,HD())}async _openRedirect(e,r,n,a){await this._originValidation(e);const s=await p7(e,r,n,VB(),a);return Oge(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:s}=this.eventManagers[r];return a?Promise.resolve(a):(vA(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await vxe(e),n=new nxe(e);return r.register("authEvent",a=>(Rn(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(E4,{type:E4},a=>{var s;const o=(s=a==null?void 0:a[0])===null||s===void 0?void 0:s[E4];o!==void 0&&r(!!o),_f(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=lxe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return xJ()||fJ()||RD()}}const Bxe=Txe;var g7="@firebase/auth",x7="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kxe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Rn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fxe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Oxe(t){Tv(new sg("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Rn(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vJ(t)},u=new ege(n,a,s,c);return cge(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Tv(new sg("auth-internal",e=>{const r=Um(e.getProvider("auth").getImmediate());return(n=>new kxe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),dm(g7,x7,Fxe(t)),dm(g7,x7,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dxe=5*60,Rxe=WY("authIdTokenMaxAge")||Dxe;let v7=null;const Mxe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Rxe)return;const a=r==null?void 0:r.token;v7!==a&&(v7=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function GB(t=BD()){const e=PD(t,"auth");if(e.isInitialized())return e.getImmediate();const r=lge(t,{popupRedirectResolver:Bxe,persistence:[kJ,QD,VD]}),n=WY("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=Mxe(s.toString());Pge(r,o,()=>o(r.currentUser)),Ige(r,l=>o(l))}}const a=qY("auth");return a&&uge(r,`http://${a}`),r}function Lxe(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}tge({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const s=ih("internal-error");s.customData=a,r(s)},n.type="text/javascript",n.charset="UTF-8",Lxe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Oxe("Browser");var Uxe="firebase",Qxe="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dm(Uxe,Qxe,"app");var y7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Mp,DJ;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,S){function E(){}E.prototype=S.prototype,C.D=S.prototype,C.prototype=new E,C.prototype.constructor=C,C.C=function(B,k,T){for(var P=Array(arguments.length-2),G=2;G<arguments.length;G++)P[G-2]=arguments[G];return S.prototype[k].apply(B,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,S,E){E||(E=0);var B=Array(16);if(typeof S=="string")for(var k=0;16>k;++k)B[k]=S.charCodeAt(E++)|S.charCodeAt(E++)<<8|S.charCodeAt(E++)<<16|S.charCodeAt(E++)<<24;else for(k=0;16>k;++k)B[k]=S[E++]|S[E++]<<8|S[E++]<<16|S[E++]<<24;S=C.g[0],E=C.g[1],k=C.g[2];var T=C.g[3],P=S+(T^E&(k^T))+B[0]+3614090360&4294967295;S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[1]+3905402710&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[2]+606105819&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[3]+3250441966&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[4]+4118548399&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[5]+1200080426&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[6]+2821735955&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[7]+4249261313&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[8]+1770035416&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[9]+2336552879&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[10]+4294925233&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[11]+2304563134&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[12]+1804603682&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[13]+4254626195&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[14]+2792965006&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[15]+1236535329&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(k^T&(E^k))+B[1]+4129170786&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[6]+3225465664&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[11]+643717713&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[0]+3921069994&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[5]+3593408605&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[10]+38016083&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[15]+3634488961&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[4]+3889429448&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[9]+568446438&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[14]+3275163606&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[3]+4107603335&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[8]+1163531501&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[13]+2850285829&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[2]+4243563512&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[7]+1735328473&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[12]+2368359562&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(E^k^T)+B[5]+4294588738&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[8]+2272392833&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[11]+1839030562&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[14]+4259657740&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[1]+2763975236&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[4]+1272893353&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[7]+4139469664&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[10]+3200236656&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[13]+681279174&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[0]+3936430074&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[3]+3572445317&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[6]+76029189&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[9]+3654602809&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[12]+3873151461&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[15]+530742520&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[2]+3299628645&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(k^(E|~T))+B[0]+4096336452&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[7]+1126891415&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[14]+2878612391&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[5]+4237533241&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[12]+1700485571&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[3]+2399980690&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[10]+4293915773&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[1]+2240044497&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[8]+1873313359&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[15]+4264355552&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[6]+2734768916&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[13]+1309151649&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[4]+4149444226&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[11]+3174756917&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[2]+718787259&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[9]+3951481745&4294967295,C.g[0]=C.g[0]+S&4294967295,C.g[1]=C.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,C.g[2]=C.g[2]+k&4294967295,C.g[3]=C.g[3]+T&4294967295}n.prototype.u=function(C,S){S===void 0&&(S=C.length);for(var E=S-this.blockSize,B=this.B,k=this.h,T=0;T<S;){if(k==0)for(;T<=E;)a(this,C,T),T+=this.blockSize;if(typeof C=="string"){for(;T<S;)if(B[k++]=C.charCodeAt(T++),k==this.blockSize){a(this,B),k=0;break}}else for(;T<S;)if(B[k++]=C[T++],k==this.blockSize){a(this,B),k=0;break}}this.h=k,this.o+=S},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var S=1;S<C.length-8;++S)C[S]=0;var E=8*this.o;for(S=C.length-8;S<C.length;++S)C[S]=E&255,E/=256;for(this.u(C),C=Array(16),S=E=0;4>S;++S)for(var B=0;32>B;B+=8)C[E++]=this.g[S]>>>B&255;return C};function s(C,S){var E=l;return Object.prototype.hasOwnProperty.call(E,C)?E[C]:E[C]=S(C)}function o(C,S){this.h=S;for(var E=[],B=!0,k=C.length-1;0<=k;k--){var T=C[k]|0;B&&T==S||(E[k]=T,B=!1)}this.g=E}var l={};function c(C){return-128<=C&&128>C?s(C,function(S){return new o([S|0],0>S?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return f;if(0>C)return x(u(-C));for(var S=[],E=1,B=0;C>=E;B++)S[B]=C/E|0,E*=4294967296;return new o(S,0)}function d(C,S){if(C.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(C.charAt(0)=="-")return x(d(C.substring(1),S));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(S,8)),B=f,k=0;k<C.length;k+=8){var T=Math.min(8,C.length-k),P=parseInt(C.substring(k,k+T),S);8>T?(T=u(Math.pow(S,T)),B=B.j(T).add(u(P))):(B=B.j(E),B=B.add(u(P)))}return B}var f=c(0),A=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var C=0,S=1,E=0;E<this.g.length;E++){var B=this.i(E);C+=(0<=B?B:4294967296+B)*S,S*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(m(this))return"0";if(p(this))return"-"+x(this).toString(C);for(var S=u(Math.pow(C,6)),E=this,B="";;){var k=w(E,S).g;E=v(E,k.j(S));var T=((0<E.g.length?E.g[0]:E.h)>>>0).toString(C);if(E=k,m(E))return T+B;for(;6>T.length;)T="0"+T;B=T+B}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function m(C){if(C.h!=0)return!1;for(var S=0;S<C.g.length;S++)if(C.g[S]!=0)return!1;return!0}function p(C){return C.h==-1}t.l=function(C){return C=v(this,C),p(C)?-1:m(C)?0:1};function x(C){for(var S=C.g.length,E=[],B=0;B<S;B++)E[B]=~C.g[B];return new o(E,~C.h).add(A)}t.abs=function(){return p(this)?x(this):this},t.add=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0,k=0;k<=S;k++){var T=B+(this.i(k)&65535)+(C.i(k)&65535),P=(T>>>16)+(this.i(k)>>>16)+(C.i(k)>>>16);B=P>>>16,T&=65535,P&=65535,E[k]=P<<16|T}return new o(E,E[E.length-1]&-2147483648?-1:0)};function v(C,S){return C.add(x(S))}t.j=function(C){if(m(this)||m(C))return f;if(p(this))return p(C)?x(this).j(x(C)):x(x(this).j(C));if(p(C))return x(this.j(x(C)));if(0>this.l(h)&&0>C.l(h))return u(this.m()*C.m());for(var S=this.g.length+C.g.length,E=[],B=0;B<2*S;B++)E[B]=0;for(B=0;B<this.g.length;B++)for(var k=0;k<C.g.length;k++){var T=this.i(B)>>>16,P=this.i(B)&65535,G=C.i(k)>>>16,ce=C.i(k)&65535;E[2*B+2*k]+=P*ce,y(E,2*B+2*k),E[2*B+2*k+1]+=T*ce,y(E,2*B+2*k+1),E[2*B+2*k+1]+=P*G,y(E,2*B+2*k+1),E[2*B+2*k+2]+=T*G,y(E,2*B+2*k+2)}for(B=0;B<S;B++)E[B]=E[2*B+1]<<16|E[2*B];for(B=S;B<2*S;B++)E[B]=0;return new o(E,0)};function y(C,S){for(;(C[S]&65535)!=C[S];)C[S+1]+=C[S]>>>16,C[S]&=65535,S++}function b(C,S){this.g=C,this.h=S}function w(C,S){if(m(S))throw Error("division by zero");if(m(C))return new b(f,f);if(p(C))return S=w(x(C),S),new b(x(S.g),x(S.h));if(p(S))return S=w(C,x(S)),new b(x(S.g),S.h);if(30<C.g.length){if(p(C)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var E=A,B=S;0>=B.l(C);)E=I(E),B=I(B);var k=j(E,1),T=j(B,1);for(B=j(B,2),E=j(E,2);!m(B);){var P=T.add(B);0>=P.l(C)&&(k=k.add(E),T=P),B=j(B,1),E=j(E,1)}return S=v(C,k.j(S)),new b(k,S)}for(k=f;0<=C.l(S);){for(E=Math.max(1,Math.floor(C.m()/S.m())),B=Math.ceil(Math.log(E)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),T=u(E),P=T.j(S);p(P)||0<P.l(C);)E-=B,T=u(E),P=T.j(S);m(T)&&(T=A),k=k.add(T),C=v(C,P)}return new b(k,C)}t.A=function(C){return w(this,C).h},t.and=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)&C.i(B);return new o(E,this.h&C.h)},t.or=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)|C.i(B);return new o(E,this.h|C.h)},t.xor=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)^C.i(B);return new o(E,this.h^C.h)};function I(C){for(var S=C.g.length+1,E=[],B=0;B<S;B++)E[B]=C.i(B)<<1|C.i(B-1)>>>31;return new o(E,C.h)}function j(C,S){var E=S>>5;S%=32;for(var B=C.g.length-E,k=[],T=0;T<B;T++)k[T]=0<S?C.i(T+E)>>>S|C.i(T+E+1)<<32-S:C.i(T+E);return new o(k,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,DJ=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Mp=o}).apply(typeof y7<"u"?y7:typeof self<"u"?self:typeof window<"u"?window:{});var nC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var RJ,Vy,MJ,sE,KB,LJ,UJ,QJ;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,J,ve){return _==Array.prototype||_==Object.prototype||(_[J]=ve.value),_};function r(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof nC=="object"&&nC];for(var J=0;J<_.length;++J){var ve=_[J];if(ve&&ve.Math==Math)return ve}throw Error("Cannot find global object")}var n=r(this);function a(_,J){if(J)e:{var ve=n;_=_.split(".");for(var et=0;et<_.length-1;et++){var Gt=_[et];if(!(Gt in ve))break e;ve=ve[Gt]}_=_[_.length-1],et=ve[_],J=J(et),J!=et&&J!=null&&e(ve,_,{configurable:!0,writable:!0,value:J})}}function s(_,J){_ instanceof String&&(_+="");var ve=0,et=!1,Gt={next:function(){if(!et&&ve<_.length){var rr=ve++;return{value:J(rr,_[rr]),done:!1}}return et=!0,{done:!0,value:void 0}}};return Gt[Symbol.iterator]=function(){return Gt},Gt}a("Array.prototype.values",function(_){return _||function(){return s(this,function(J,ve){return ve})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(_){var J=typeof _;return J=J!="object"?J:_?Array.isArray(_)?"array":J:"null",J=="array"||J=="object"&&typeof _.length=="number"}function u(_){var J=typeof _;return J=="object"&&_!=null||J=="function"}function d(_,J,ve){return _.call.apply(_.bind,arguments)}function f(_,J,ve){if(!_)throw Error();if(2<arguments.length){var et=Array.prototype.slice.call(arguments,2);return function(){var Gt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Gt,et),_.apply(J,Gt)}}return function(){return _.apply(J,arguments)}}function A(_,J,ve){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,A.apply(null,arguments)}function h(_,J){var ve=Array.prototype.slice.call(arguments,1);return function(){var et=ve.slice();return et.push.apply(et,arguments),_.apply(this,et)}}function m(_,J){function ve(){}ve.prototype=J.prototype,_.aa=J.prototype,_.prototype=new ve,_.prototype.constructor=_,_.Qb=function(et,Gt,rr){for(var Mr=Array(arguments.length-2),pa=2;pa<arguments.length;pa++)Mr[pa-2]=arguments[pa];return J.prototype[Gt].apply(et,Mr)}}function p(_){const J=_.length;if(0<J){const ve=Array(J);for(let et=0;et<J;et++)ve[et]=_[et];return ve}return[]}function x(_,J){for(let ve=1;ve<arguments.length;ve++){const et=arguments[ve];if(c(et)){const Gt=_.length||0,rr=et.length||0;_.length=Gt+rr;for(let Mr=0;Mr<rr;Mr++)_[Gt+Mr]=et[Mr]}else _.push(et)}}class v{constructor(J,ve){this.i=J,this.j=ve,this.h=0,this.g=null}get(){let J;return 0<this.h?(this.h--,J=this.g,this.g=J.next,J.next=null):J=this.i(),J}}function y(_){return/^[\s\xa0]*$/.test(_)}function b(){var _=l.navigator;return _&&(_=_.userAgent)?_:""}function w(_){return w[" "](_),_}w[" "]=function(){};var I=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function j(_,J,ve){for(const et in _)J.call(ve,_[et],et,_)}function C(_,J){for(const ve in _)J.call(void 0,_[ve],ve,_)}function S(_){const J={};for(const ve in _)J[ve]=_[ve];return J}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(_,J){let ve,et;for(let Gt=1;Gt<arguments.length;Gt++){et=arguments[Gt];for(ve in et)_[ve]=et[ve];for(let rr=0;rr<E.length;rr++)ve=E[rr],Object.prototype.hasOwnProperty.call(et,ve)&&(_[ve]=et[ve])}}function k(_){var J=1;_=_.split(":");const ve=[];for(;0<J&&_.length;)ve.push(_.shift()),J--;return _.length&&ve.push(_.join(":")),ve}function T(_){l.setTimeout(()=>{throw _},0)}function P(){var _=ae;let J=null;return _.g&&(J=_.g,_.g=_.g.next,_.g||(_.h=null),J.next=null),J}class G{constructor(){this.h=this.g=null}add(J,ve){const et=ce.get();et.set(J,ve),this.h?this.h.next=et:this.g=et,this.h=et}}var ce=new v(()=>new ue,_=>_.reset());class ue{constructor(){this.next=this.g=this.h=null}set(J,ve){this.h=J,this.g=ve,this.next=null}reset(){this.next=this.g=this.h=null}}let le,Ae=!1,ae=new G,_e=()=>{const _=l.Promise.resolve(void 0);le=()=>{_.then(De)}};var De=()=>{for(var _;_=P();){try{_.h.call(_.g)}catch(ve){T(ve)}var J=ce;J.j(_),100>J.h&&(J.h++,_.next=J.g,J.g=_)}Ae=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(_,J){this.type=_,this.g=this.target=J,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var _=!1,J=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const ve=()=>{};l.addEventListener("test",ve,J),l.removeEventListener("test",ve,J)}catch{}return _}();function R(_,J){if(H.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var ve=this.type=_.type,et=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=J,J=_.relatedTarget){if(I){e:{try{w(J.nodeName);var Gt=!0;break e}catch{}Gt=!1}Gt||(J=null)}}else ve=="mouseover"?J=_.fromElement:ve=="mouseout"&&(J=_.toElement);this.relatedTarget=J,et?(this.clientX=et.clientX!==void 0?et.clientX:et.pageX,this.clientY=et.clientY!==void 0?et.clientY:et.pageY,this.screenX=et.screenX||0,this.screenY=et.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:X[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&R.aa.h.call(this)}}m(R,H);var X={2:"touch",3:"pen",4:"mouse"};R.prototype.h=function(){R.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Y="closure_listenable_"+(1e6*Math.random()|0),D=0;function Q(_,J,ve,et,Gt){this.listener=_,this.proxy=null,this.src=J,this.type=ve,this.capture=!!et,this.ha=Gt,this.key=++D,this.da=this.fa=!1}function te(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function be(_){this.src=_,this.g={},this.h=0}be.prototype.add=function(_,J,ve,et,Gt){var rr=_.toString();_=this.g[rr],_||(_=this.g[rr]=[],this.h++);var Mr=Xe(_,J,et,Gt);return-1<Mr?(J=_[Mr],ve||(J.fa=!1)):(J=new Q(J,this.src,rr,!!et,Gt),J.fa=ve,_.push(J)),J};function U(_,J){var ve=J.type;if(ve in _.g){var et=_.g[ve],Gt=Array.prototype.indexOf.call(et,J,void 0),rr;(rr=0<=Gt)&&Array.prototype.splice.call(et,Gt,1),rr&&(te(J),_.g[ve].length==0&&(delete _.g[ve],_.h--))}}function Xe(_,J,ve,et){for(var Gt=0;Gt<_.length;++Gt){var rr=_[Gt];if(!rr.da&&rr.listener==J&&rr.capture==!!ve&&rr.ha==et)return Gt}return-1}var se="closure_lm_"+(1e6*Math.random()|0),ee={};function Fe(_,J,ve,et,Gt){if(Array.isArray(J)){for(var rr=0;rr<J.length;rr++)Fe(_,J[rr],ve,et,Gt);return null}return ve=Ut(ve),_&&_[Y]?_.K(J,ve,u(et)?!!et.capture:!1,Gt):je(_,J,ve,!1,et,Gt)}function je(_,J,ve,et,Gt,rr){if(!J)throw Error("Invalid event type");var Mr=u(Gt)?!!Gt.capture:!!Gt,pa=Ft(_);if(pa||(_[se]=pa=new be(_)),ve=pa.add(J,ve,et,Mr,rr),ve.proxy)return ve;if(et=Se(),ve.proxy=et,et.src=_,et.listener=ve,_.addEventListener)K||(Gt=Mr),Gt===void 0&&(Gt=!1),_.addEventListener(J.toString(),et,Gt);else if(_.attachEvent)_.attachEvent(Et(J.toString()),et);else if(_.addListener&&_.removeListener)_.addListener(et);else throw Error("addEventListener and attachEvent are unavailable.");return ve}function Se(){function _(ve){return J.call(_.src,_.listener,ve)}const J=St;return _}function Ze(_,J,ve,et,Gt){if(Array.isArray(J))for(var rr=0;rr<J.length;rr++)Ze(_,J[rr],ve,et,Gt);else et=u(et)?!!et.capture:!!et,ve=Ut(ve),_&&_[Y]?(_=_.i,J=String(J).toString(),J in _.g&&(rr=_.g[J],ve=Xe(rr,ve,et,Gt),-1<ve&&(te(rr[ve]),Array.prototype.splice.call(rr,ve,1),rr.length==0&&(delete _.g[J],_.h--)))):_&&(_=Ft(_))&&(J=_.g[J.toString()],_=-1,J&&(_=Xe(J,ve,et,Gt)),(ve=-1<_?J[_]:null)&&ut(ve))}function ut(_){if(typeof _!="number"&&_&&!_.da){var J=_.src;if(J&&J[Y])U(J.i,_);else{var ve=_.type,et=_.proxy;J.removeEventListener?J.removeEventListener(ve,et,_.capture):J.detachEvent?J.detachEvent(Et(ve),et):J.addListener&&J.removeListener&&J.removeListener(et),(ve=Ft(J))?(U(ve,_),ve.h==0&&(ve.src=null,J[se]=null)):te(_)}}}function Et(_){return _ in ee?ee[_]:ee[_]="on"+_}function St(_,J){if(_.da)_=!0;else{J=new R(J,this);var ve=_.listener,et=_.ha||_.src;_.fa&&ut(_),_=ve.call(et,J)}return _}function Ft(_){return _=_[se],_ instanceof be?_:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(_){return typeof _=="function"?_:(_[Qt]||(_[Qt]=function(J){return _.handleEvent(J)}),_[Qt])}function Tt(){O.call(this),this.i=new be(this),this.M=this,this.F=null}m(Tt,O),Tt.prototype[Y]=!0,Tt.prototype.removeEventListener=function(_,J,ve,et){Ze(this,_,J,ve,et)};function Re(_,J){var ve,et=_.F;if(et)for(ve=[];et;et=et.F)ve.push(et);if(_=_.M,et=J.type||J,typeof J=="string")J=new H(J,_);else if(J instanceof H)J.target=J.target||_;else{var Gt=J;J=new H(et,_),B(J,Gt)}if(Gt=!0,ve)for(var rr=ve.length-1;0<=rr;rr--){var Mr=J.g=ve[rr];Gt=Te(Mr,et,!0,J)&&Gt}if(Mr=J.g=_,Gt=Te(Mr,et,!0,J)&&Gt,Gt=Te(Mr,et,!1,J)&&Gt,ve)for(rr=0;rr<ve.length;rr++)Mr=J.g=ve[rr],Gt=Te(Mr,et,!1,J)&&Gt}Tt.prototype.N=function(){if(Tt.aa.N.call(this),this.i){var _=this.i,J;for(J in _.g){for(var ve=_.g[J],et=0;et<ve.length;et++)te(ve[et]);delete _.g[J],_.h--}}this.F=null},Tt.prototype.K=function(_,J,ve,et){return this.i.add(String(_),J,!1,ve,et)},Tt.prototype.L=function(_,J,ve,et){return this.i.add(String(_),J,!0,ve,et)};function Te(_,J,ve,et){if(J=_.i.g[String(J)],!J)return!0;J=J.concat();for(var Gt=!0,rr=0;rr<J.length;++rr){var Mr=J[rr];if(Mr&&!Mr.da&&Mr.capture==ve){var pa=Mr.listener,ri=Mr.ha||Mr.src;Mr.fa&&U(_.i,Mr),Gt=pa.call(ri,et)!==!1&&Gt}}return Gt&&!et.defaultPrevented}function Ye(_,J,ve){if(typeof _=="function")ve&&(_=A(_,ve));else if(_&&typeof _.handleEvent=="function")_=A(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(J)?-1:l.setTimeout(_,J||0)}function ht(_){_.g=Ye(()=>{_.g=null,_.i&&(_.i=!1,ht(_))},_.l);const J=_.h;_.h=null,_.m.apply(null,J)}class Oe extends O{constructor(J,ve){super(),this.m=J,this.l=ve,this.h=null,this.i=!1,this.g=null}j(J){this.h=arguments,this.g?this.i=!0:ht(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ie(_){O.call(this),this.h=_,this.g={}}m(Ie,O);var We=[];function Z(_){j(_.g,function(J,ve){this.g.hasOwnProperty(ve)&&ut(J)},_),_.g={}}Ie.prototype.N=function(){Ie.aa.N.call(this),Z(this)},Ie.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qe=l.JSON.stringify,at=l.JSON.parse,Ge=class{stringify(_){return l.JSON.stringify(_,void 0)}parse(_){return l.JSON.parse(_,void 0)}};function ie(){}ie.prototype.h=null;function xe(_){return _.h||(_.h=_.i())}function de(){}var Me={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function me(){H.call(this,"d")}m(me,H);function we(){H.call(this,"c")}m(we,H);var pt={},vt=null;function bt(){return vt=vt||new Tt}pt.La="serverreachability";function kt(_){H.call(this,pt.La,_)}m(kt,H);function Vt(_){const J=bt();Re(J,new kt(J))}pt.STAT_EVENT="statevent";function ke(_,J){H.call(this,pt.STAT_EVENT,_),this.stat=J}m(ke,H);function Ne(_){const J=bt();Re(J,new ke(J,_))}pt.Ma="timingevent";function pe(_,J){H.call(this,pt.Ma,_),this.size=J}m(pe,H);function Le(_,J){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){_()},J)}function ft(){this.g=!0}ft.prototype.xa=function(){this.g=!1};function At(_,J,ve,et,Gt,rr){_.info(function(){if(_.g)if(rr)for(var Mr="",pa=rr.split("&"),ri=0;ri<pa.length;ri++){var aa=pa[ri].split("=");if(1<aa.length){var Ia=aa[0];aa=aa[1];var vs=Ia.split("_");Mr=2<=vs.length&&vs[1]=="type"?Mr+(Ia+"="+aa+"&"):Mr+(Ia+"=redacted&")}}else Mr=null;else Mr=rr;return"XMLHTTP REQ ("+et+") [attempt "+Gt+"]: "+J+`
`+ve+`
`+Mr})}function ct(_,J,ve,et,Gt,rr,Mr){_.info(function(){return"XMLHTTP RESP ("+et+") [ attempt "+Gt+"]: "+J+`
`+ve+`
`+rr+" "+Mr})}function W(_,J,ve,et){_.info(function(){return"XMLHTTP TEXT ("+J+"): "+re(_,ve)+(et?" "+et:"")})}function z(_,J){_.info(function(){return"TIMEOUT: "+J})}ft.prototype.info=function(){};function re(_,J){if(!_.g)return J;if(!J)return null;try{var ve=JSON.parse(J);if(ve){for(_=0;_<ve.length;_++)if(Array.isArray(ve[_])){var et=ve[_];if(!(2>et.length)){var Gt=et[1];if(Array.isArray(Gt)&&!(1>Gt.length)){var rr=Gt[0];if(rr!="noop"&&rr!="stop"&&rr!="close")for(var Mr=1;Mr<Gt.length;Mr++)Gt[Mr]=""}}}}return Qe(ve)}catch{return J}}var V={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},L={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},fe;function Be(){}m(Be,ie),Be.prototype.g=function(){return new XMLHttpRequest},Be.prototype.i=function(){return{}},fe=new Be;function ye(_,J,ve,et){this.j=_,this.i=J,this.l=ve,this.R=et||1,this.U=new Ie(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $e}function $e(){this.i=null,this.g="",this.h=!1}var ze={},Ke={};function yt(_,J,ve){_.L=1,_.v=nt(vr(J)),_.m=ve,_.P=!0,ne(_,null)}function ne(_,J){_.F=Date.now(),st(_),_.A=vr(_.v);var ve=_.A,et=_.R;Array.isArray(et)||(et=[String(et)]),dr(ve.i,"t",et),_.C=0,ve=_.j.J,_.h=new $e,_.g=xi(_.j,ve?J:null,!_.m),0<_.O&&(_.M=new Oe(A(_.Y,_,_.g),_.O)),J=_.U,ve=_.g,et=_.ca;var Gt="readystatechange";Array.isArray(Gt)||(Gt&&(We[0]=Gt.toString()),Gt=We);for(var rr=0;rr<Gt.length;rr++){var Mr=Fe(ve,Gt[rr],et||J.handleEvent,!1,J.h||J);if(!Mr)break;J.g[Mr.key]=Mr}J=_.H?S(_.H):{},_.m?(_.u||(_.u="POST"),J["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,J)):(_.u="GET",_.g.ea(_.A,_.u,null,J)),Vt(),At(_.i,_.u,_.A,_.l,_.R,_.m)}ye.prototype.ca=function(_){_=_.target;const J=this.M;J&&ll(_)==3?J.j():this.Y(_)},ye.prototype.Y=function(_){try{if(_==this.g)e:{const vs=ll(this.g);var J=this.g.Ba();const mu=this.g.Z();if(!(3>vs)&&(vs!=3||this.g&&(this.h.h||this.g.oa()||Au(this.g)))){this.J||vs!=4||J==7||(J==8||0>=mu?Vt(3):Vt(2)),Ot(this);var ve=this.g.Z();this.X=ve;t:if(Ue(this)){var et=Au(this.g);_="";var Gt=et.length,rr=ll(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ir(this),nr(this);var Mr="";break t}this.h.i=new l.TextDecoder}for(J=0;J<Gt;J++)this.h.h=!0,_+=this.h.i.decode(et[J],{stream:!(rr&&J==Gt-1)});et.length=0,this.h.g+=_,this.C=0,Mr=this.h.g}else Mr=this.g.oa();if(this.o=ve==200,ct(this.i,this.u,this.A,this.l,this.R,vs,ve),this.o){if(this.T&&!this.K){t:{if(this.g){var pa,ri=this.g;if((pa=ri.g?ri.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(pa)){var aa=pa;break t}}aa=null}if(ve=aa)W(this.i,this.l,ve,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qr(this,ve);else{this.o=!1,this.s=3,Ne(12),Ir(this),nr(this);break e}}if(this.P){ve=!0;let Ml;for(;!this.J&&this.C<Mr.length;)if(Ml=rt(this,Mr),Ml==Ke){vs==4&&(this.s=4,Ne(14),ve=!1),W(this.i,this.l,null,"[Incomplete Response]");break}else if(Ml==ze){this.s=4,Ne(15),W(this.i,this.l,Mr,"[Invalid Chunk]"),ve=!1;break}else W(this.i,this.l,Ml,null),Qr(this,Ml);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vs!=4||Mr.length!=0||this.h.h||(this.s=1,Ne(16),ve=!1),this.o=this.o&&ve,!ve)W(this.i,this.l,Mr,"[Invalid Chunked Response]"),Ir(this),nr(this);else if(0<Mr.length&&!this.W){this.W=!0;var Ia=this.j;Ia.g==this&&Ia.ba&&!Ia.M&&(Ia.j.info("Great, no buffering proxy detected. Bytes received: "+Mr.length),an(Ia),Ia.M=!0,Ne(11))}}else W(this.i,this.l,Mr,null),Qr(this,Mr);vs==4&&Ir(this),this.o&&!this.J&&(vs==4?Vn(this.j,this):(this.o=!1,st(this)))}else zA(this.g),ve==400&&0<Mr.indexOf("Unknown SID")?(this.s=3,Ne(12)):(this.s=0,Ne(13)),Ir(this),nr(this)}}}catch{}finally{}};function Ue(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function rt(_,J){var ve=_.C,et=J.indexOf(`
`,ve);return et==-1?Ke:(ve=Number(J.substring(ve,et)),isNaN(ve)?ze:(et+=1,et+ve>J.length?Ke:(J=J.slice(et,et+ve),_.C=et+ve,J)))}ye.prototype.cancel=function(){this.J=!0,Ir(this)};function st(_){_.S=Date.now()+_.I,_t(_,_.I)}function _t(_,J){if(_.B!=null)throw Error("WatchDog timer not null");_.B=Le(A(_.ba,_),J)}function Ot(_){_.B&&(l.clearTimeout(_.B),_.B=null)}ye.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(z(this.i,this.A),this.L!=2&&(Vt(),Ne(17)),Ir(this),this.s=2,nr(this)):_t(this,this.S-_)};function nr(_){_.j.G==0||_.J||Vn(_.j,_)}function Ir(_){Ot(_);var J=_.M;J&&typeof J.ma=="function"&&J.ma(),_.M=null,Z(_.U),_.g&&(J=_.g,_.g=null,J.abort(),J.ma())}function Qr(_,J){try{var ve=_.j;if(ve.G!=0&&(ve.g==_||_r(ve.h,_))){if(!_.K&&_r(ve.h,_)&&ve.G==3){try{var et=ve.Da.g.parse(J)}catch{et=null}if(Array.isArray(et)&&et.length==3){var Gt=et;if(Gt[0]==0){e:if(!ve.u){if(ve.g)if(ve.g.F+3e3<_.F)Bn(ve),Ao(ve);else break e;Nr(ve),Ne(18)}}else ve.za=Gt[1],0<ve.za-ve.T&&37500>Gt[2]&&ve.F&&ve.v==0&&!ve.C&&(ve.C=Le(A(ve.Za,ve),6e3));if(1>=nn(ve.h)&&ve.ca){try{ve.ca()}catch{}ve.ca=void 0}}else Oa(ve,11)}else if((_.K||ve.g==_)&&Bn(ve),!y(J))for(Gt=ve.Da.g.parse(J),J=0;J<Gt.length;J++){let aa=Gt[J];if(ve.T=aa[0],aa=aa[1],ve.G==2)if(aa[0]=="c"){ve.K=aa[1],ve.ia=aa[2];const Ia=aa[3];Ia!=null&&(ve.la=Ia,ve.j.info("VER="+ve.la));const vs=aa[4];vs!=null&&(ve.Aa=vs,ve.j.info("SVER="+ve.Aa));const mu=aa[5];mu!=null&&typeof mu=="number"&&0<mu&&(et=1.5*mu,ve.L=et,ve.j.info("backChannelRequestTimeoutMs_="+et)),et=ve;const Ml=_.g;if(Ml){const ul=Ml.g?Ml.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ul){var rr=et.h;rr.g||ul.indexOf("spdy")==-1&&ul.indexOf("quic")==-1&&ul.indexOf("h2")==-1||(rr.j=rr.l,rr.g=new Set,rr.h&&(He(rr,rr.h),rr.h=null))}if(et.D){const Gd=Ml.g?Ml.g.getResponseHeader("X-HTTP-Session-Id"):null;Gd&&(et.ya=Gd,tt(et.I,et.D,Gd))}}ve.G=3,ve.l&&ve.l.ua(),ve.ba&&(ve.R=Date.now()-_.F,ve.j.info("Handshake RTT: "+ve.R+"ms")),et=ve;var Mr=_;if(et.qa=$a(et,et.J?et.ia:null,et.W),Mr.K){Bt(et.h,Mr);var pa=Mr,ri=et.L;ri&&(pa.I=ri),pa.B&&(Ot(pa),st(pa)),et.g=Mr}else Ar(et);0<ve.i.length&&M(ve)}else aa[0]!="stop"&&aa[0]!="close"||Oa(ve,7);else ve.G==3&&(aa[0]=="stop"||aa[0]=="close"?aa[0]=="stop"?Oa(ve,7):Ff(ve):aa[0]!="noop"&&ve.l&&ve.l.ta(aa),ve.v=0)}}Vt(4)}catch{}}var or=class{constructor(_,J){this.g=_,this.map=J}};function kr(_){this.l=_||10,l.PerformanceNavigationTiming?(_=l.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Zr(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function nn(_){return _.h?1:_.g?_.g.size:0}function _r(_,J){return _.h?_.h==J:_.g?_.g.has(J):!1}function He(_,J){_.g?_.g.add(J):_.h=J}function Bt(_,J){_.h&&_.h==J?_.h=null:_.g&&_.g.has(J)&&_.g.delete(J)}kr.prototype.cancel=function(){if(this.i=xr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function xr(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let J=_.i;for(const ve of _.g.values())J=J.concat(ve.D);return J}return p(_.i)}function dn(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(c(_)){for(var J=[],ve=_.length,et=0;et<ve;et++)J.push(_[et]);return J}J=[],ve=0;for(et in _)J[ve++]=_[et];return J}function Jr(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(c(_)||typeof _=="string"){var J=[];_=_.length;for(var ve=0;ve<_;ve++)J.push(ve);return J}J=[],ve=0;for(const et in _)J[ve++]=et;return J}}}function br(_,J){if(_.forEach&&typeof _.forEach=="function")_.forEach(J,void 0);else if(c(_)||typeof _=="string")Array.prototype.forEach.call(_,J,void 0);else for(var ve=Jr(_),et=dn(_),Gt=et.length,rr=0;rr<Gt;rr++)J.call(void 0,et[rr],ve&&ve[rr],_)}var er=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ir(_,J){if(_){_=_.split("&");for(var ve=0;ve<_.length;ve++){var et=_[ve].indexOf("="),Gt=null;if(0<=et){var rr=_[ve].substring(0,et);Gt=_[ve].substring(et+1)}else rr=_[ve];J(rr,Gt?decodeURIComponent(Gt.replace(/\+/g," ")):"")}}}function Sr(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof Sr){this.h=_.h,Fr(this,_.j),this.o=_.o,this.g=_.g,jn(this,_.s),this.l=_.l;var J=_.i,ve=new Mt;ve.i=J.i,J.g&&(ve.g=new Map(J.g),ve.h=J.h),he(this,ve),this.m=_.m}else _&&(J=String(_).match(er))?(this.h=!1,Fr(this,J[1]||"",!0),this.o=lt(J[2]||""),this.g=lt(J[3]||"",!0),jn(this,J[4]),this.l=lt(J[5]||"",!0),he(this,J[6]||"",!0),this.m=lt(J[7]||"")):(this.h=!1,this.i=new Mt(null,this.h))}Sr.prototype.toString=function(){var _=[],J=this.j;J&&_.push(ge(J,Pt,!0),":");var ve=this.g;return(ve||J=="file")&&(_.push("//"),(J=this.o)&&_.push(ge(J,Pt,!0),"@"),_.push(encodeURIComponent(String(ve)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ve=this.s,ve!=null&&_.push(":",String(ve))),(ve=this.l)&&(this.g&&ve.charAt(0)!="/"&&_.push("/"),_.push(ge(ve,ve.charAt(0)=="/"?Nt:wt,!0))),(ve=this.i.toString())&&_.push("?",ve),(ve=this.m)&&_.push("#",ge(ve,qt)),_.join("")};function vr(_){return new Sr(_)}function Fr(_,J,ve){_.j=ve?lt(J,!0):J,_.j&&(_.j=_.j.replace(/:$/,""))}function jn(_,J){if(J){if(J=Number(J),isNaN(J)||0>J)throw Error("Bad port number "+J);_.s=J}else _.s=null}function he(_,J,ve){J instanceof Mt?(_.i=J,Wr(_.i,_.h)):(ve||(J=ge(J,It)),_.i=new Mt(J,_.h))}function tt(_,J,ve){_.i.set(J,ve)}function nt(_){return tt(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function lt(_,J){return _?J?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function ge(_,J,ve){return typeof _=="string"?(_=encodeURI(_).replace(J,it),ve&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function it(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var Pt=/[#\/\?@]/g,wt=/[#\?:]/g,Nt=/[#\?]/g,It=/[#\?@]/g,qt=/#/g;function Mt(_,J){this.h=this.g=null,this.i=_||null,this.j=!!J}function zt(_){_.g||(_.g=new Map,_.h=0,_.i&&ir(_.i,function(J,ve){_.add(decodeURIComponent(J.replace(/\+/g," ")),ve)}))}t=Mt.prototype,t.add=function(_,J){zt(this),this.i=null,_=Rt(this,_);var ve=this.g.get(_);return ve||this.g.set(_,ve=[]),ve.push(J),this.h+=1,this};function ar(_,J){zt(_),J=Rt(_,J),_.g.has(J)&&(_.i=null,_.h-=_.g.get(J).length,_.g.delete(J))}function wr(_,J){return zt(_),J=Rt(_,J),_.g.has(J)}t.forEach=function(_,J){zt(this),this.g.forEach(function(ve,et){ve.forEach(function(Gt){_.call(J,Gt,et,this)},this)},this)},t.na=function(){zt(this);const _=Array.from(this.g.values()),J=Array.from(this.g.keys()),ve=[];for(let et=0;et<J.length;et++){const Gt=_[et];for(let rr=0;rr<Gt.length;rr++)ve.push(J[et])}return ve},t.V=function(_){zt(this);let J=[];if(typeof _=="string")wr(this,_)&&(J=J.concat(this.g.get(Rt(this,_))));else{_=Array.from(this.g.values());for(let ve=0;ve<_.length;ve++)J=J.concat(_[ve])}return J},t.set=function(_,J){return zt(this),this.i=null,_=Rt(this,_),wr(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[J]),this.h+=1,this},t.get=function(_,J){return _?(_=this.V(_),0<_.length?String(_[0]):J):J};function dr(_,J,ve){ar(_,J),0<ve.length&&(_.i=null,_.g.set(Rt(_,J),p(ve)),_.h+=ve.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],J=Array.from(this.g.keys());for(var ve=0;ve<J.length;ve++){var et=J[ve];const rr=encodeURIComponent(String(et)),Mr=this.V(et);for(et=0;et<Mr.length;et++){var Gt=rr;Mr[et]!==""&&(Gt+="="+encodeURIComponent(String(Mr[et]))),_.push(Gt)}}return this.i=_.join("&")};function Rt(_,J){return J=String(J),_.j&&(J=J.toLowerCase()),J}function Wr(_,J){J&&!_.j&&(zt(_),_.i=null,_.g.forEach(function(ve,et){var Gt=et.toLowerCase();et!=Gt&&(ar(this,et),dr(this,Gt,ve))},_)),_.j=J}function Vr(_,J){const ve=new ft;if(l.Image){const et=new Image;et.onload=h(pr,ve,"TestLoadImage: loaded",!0,J,et),et.onerror=h(pr,ve,"TestLoadImage: error",!1,J,et),et.onabort=h(pr,ve,"TestLoadImage: abort",!1,J,et),et.ontimeout=h(pr,ve,"TestLoadImage: timeout",!1,J,et),l.setTimeout(function(){et.ontimeout&&et.ontimeout()},1e4),et.src=_}else J(!1)}function jr(_,J){const ve=new ft,et=new AbortController,Gt=setTimeout(()=>{et.abort(),pr(ve,"TestPingServer: timeout",!1,J)},1e4);fetch(_,{signal:et.signal}).then(rr=>{clearTimeout(Gt),rr.ok?pr(ve,"TestPingServer: ok",!0,J):pr(ve,"TestPingServer: server error",!1,J)}).catch(()=>{clearTimeout(Gt),pr(ve,"TestPingServer: error",!1,J)})}function pr(_,J,ve,et,Gt){try{Gt&&(Gt.onload=null,Gt.onerror=null,Gt.onabort=null,Gt.ontimeout=null),et(ve)}catch{}}function Pr(){this.g=new Ge}function Tn(_,J,ve){const et=ve||"";try{br(_,function(Gt,rr){let Mr=Gt;u(Gt)&&(Mr=Qe(Gt)),J.push(et+rr+"="+encodeURIComponent(Mr))})}catch(Gt){throw J.push(et+"type="+encodeURIComponent("_badmap")),Gt}}function wn(_){this.l=_.Ub||null,this.j=_.eb||!1}m(wn,ie),wn.prototype.g=function(){return new gn(this.l,this.j)},wn.prototype.i=function(_){return function(){return _}}({});function gn(_,J){Tt.call(this),this.D=_,this.o=J,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(gn,Tt),t=gn.prototype,t.open=function(_,J){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=J,this.readyState=1,Ji(this)},t.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const J={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(J.body=_),(this.D||l).fetch(new Request(this.A,J)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xa(this)),this.readyState=0},t.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,Ji(this)),this.g&&(this.readyState=3,Ji(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ua(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function ua(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}t.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var J=_.value?_.value:new Uint8Array(0);(J=this.v.decode(J,{stream:!_.done}))&&(this.response=this.responseText+=J)}_.done?xa(this):Ji(this),this.readyState==3&&ua(this)}},t.Ra=function(_){this.g&&(this.response=this.responseText=_,xa(this))},t.Qa=function(_){this.g&&(this.response=_,xa(this))},t.ga=function(){this.g&&xa(this)};function xa(_){_.readyState=4,_.l=null,_.j=null,_.v=null,Ji(_)}t.setRequestHeader=function(_,J){this.u.append(_,J)},t.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],J=this.h.entries();for(var ve=J.next();!ve.done;)ve=ve.value,_.push(ve[0]+": "+ve[1]),ve=J.next();return _.join(`\r
`)};function Ji(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(gn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function Zi(_){let J="";return j(_,function(ve,et){J+=et,J+=":",J+=ve,J+=`\r
`}),J}function Dl(_,J,ve){e:{for(et in ve){var et=!1;break e}et=!0}et||(ve=Zi(ve),typeof _=="string"?ve!=null&&encodeURIComponent(String(ve)):tt(_,J,ve))}function va(_){Tt.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(va,Tt);var Qn=/^https?$/i,hu=["POST","PUT"];t=va.prototype,t.Ha=function(_){this.J=_},t.ea=function(_,J,ve,et){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);J=J?J.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():fe.g(),this.v=this.o?xe(this.o):xe(fe),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(J,String(_),!0),this.B=!1}catch(rr){Rl(this,rr);return}if(_=ve||"",ve=new Map(this.headers),et)if(Object.getPrototypeOf(et)===Object.prototype)for(var Gt in et)ve.set(Gt,et[Gt]);else if(typeof et.keys=="function"&&typeof et.get=="function")for(const rr of et.keys())ve.set(rr,et.get(rr));else throw Error("Unknown input type for opt_headers: "+String(et));et=Array.from(ve.keys()).find(rr=>rr.toLowerCase()=="content-type"),Gt=l.FormData&&_ instanceof l.FormData,!(0<=Array.prototype.indexOf.call(hu,J,void 0))||et||Gt||ve.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[rr,Mr]of ve)this.g.setRequestHeader(rr,Mr);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ac(this),this.u=!0,this.g.send(_),this.u=!1}catch(rr){Rl(this,rr)}};function Rl(_,J){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=J,_.m=5,eo(_),Qc(_)}function eo(_){_.A||(_.A=!0,Re(_,"complete"),Re(_,"error"))}t.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,Re(this,"complete"),Re(this,"abort"),Qc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qc(this,!0)),va.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Uc(this):this.bb())},t.bb=function(){Uc(this)};function Uc(_){if(_.h&&typeof o<"u"&&(!_.v[1]||ll(_)!=4||_.Z()!=2)){if(_.u&&ll(_)==4)Ye(_.Ea,0,_);else if(Re(_,"readystatechange"),ll(_)==4){_.h=!1;try{const Mr=_.Z();e:switch(Mr){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var J=!0;break e;default:J=!1}var ve;if(!(ve=J)){var et;if(et=Mr===0){var Gt=String(_.D).match(er)[1]||null;!Gt&&l.self&&l.self.location&&(Gt=l.self.location.protocol.slice(0,-1)),et=!Qn.test(Gt?Gt.toLowerCase():"")}ve=et}if(ve)Re(_,"complete"),Re(_,"success");else{_.m=6;try{var rr=2<ll(_)?_.g.statusText:""}catch{rr=""}_.l=rr+" ["+_.Z()+"]",eo(_)}}finally{Qc(_)}}}}function Qc(_,J){if(_.g){Ac(_);const ve=_.g,et=_.v[0]?()=>{}:null;_.g=null,_.v=null,J||Re(_,"ready");try{ve.onreadystatechange=et}catch{}}}function Ac(_){_.I&&(l.clearTimeout(_.I),_.I=null)}t.isActive=function(){return!!this.g};function ll(_){return _.g?_.g.readyState:0}t.Z=function(){try{return 2<ll(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(_){if(this.g){var J=this.g.responseText;return _&&J.indexOf(_)==0&&(J=J.substring(_.length)),at(J)}};function Au(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function zA(_){const J={};_=(_.g&&2<=ll(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let et=0;et<_.length;et++){if(y(_[et]))continue;var ve=k(_[et]);const Gt=ve[0];if(ve=ve[1],typeof ve!="string")continue;ve=ve.trim();const rr=J[Gt]||[];J[Gt]=rr,rr.push(ve)}C(J,function(et){return et.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function cl(_,J,ve){return ve&&ve.internalChannelParams&&ve.internalChannelParams[_]||J}function Vc(_){this.Aa=0,this.i=[],this.j=new ft,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=cl("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=cl("baseRetryDelayMs",5e3,_),this.cb=cl("retryDelaySeedMs",1e4,_),this.Wa=cl("forwardChannelMaxRetries",2,_),this.wa=cl("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new kr(_&&_.concurrentRequestLimit),this.Da=new Pr,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Vc.prototype,t.la=8,t.G=1,t.connect=function(_,J,ve,et){Ne(0),this.W=_,this.H=J||{},ve&&et!==void 0&&(this.H.OSID=ve,this.H.OAID=et),this.F=this.X,this.I=$a(this,null,this.W),M(this)};function Ff(_){if(Wu(_),_.G==3){var J=_.U++,ve=vr(_.I);if(tt(ve,"SID",_.K),tt(ve,"RID",J),tt(ve,"TYPE","terminate"),jt(_,ve),J=new ye(_,_.j,J),J.L=2,J.v=nt(vr(ve)),ve=!1,l.navigator&&l.navigator.sendBeacon)try{ve=l.navigator.sendBeacon(J.v.toString(),"")}catch{}!ve&&l.Image&&(new Image().src=J.v,ve=!0),ve||(J.g=xi(J.j,null),J.g.ea(J.v)),J.F=Date.now(),st(J)}Zs(_)}function Ao(_){_.g&&(an(_),_.g.cancel(),_.g=null)}function Wu(_){Ao(_),_.u&&(l.clearTimeout(_.u),_.u=null),Bn(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&l.clearTimeout(_.s),_.s=null)}function M(_){if(!Zr(_.h)&&!_.s){_.s=!0;var J=_.Ga;le||_e(),Ae||(le(),Ae=!0),ae.add(J,_),_.B=0}}function Ee(_,J){return nn(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=J.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=Le(A(_.Ga,_,J),da(_,_.B)),_.B++,!0)}t.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const Gt=new ye(this,this.j,_);let rr=this.o;if(this.S&&(rr?(rr=S(rr),B(rr,this.S)):rr=this.S),this.m!==null||this.O||(Gt.H=rr,rr=null),this.P)e:{for(var J=0,ve=0;ve<this.i.length;ve++){t:{var et=this.i[ve];if("__data__"in et.map&&(et=et.map.__data__,typeof et=="string")){et=et.length;break t}et=void 0}if(et===void 0)break;if(J+=et,4096<J){J=ve;break e}if(J===4096||ve===this.i.length-1){J=ve+1;break e}}J=1e3}else J=1e3;J=$t(this,Gt,J),ve=vr(this.I),tt(ve,"RID",_),tt(ve,"CVER",22),this.D&&tt(ve,"X-HTTP-Session-Id",this.D),jt(this,ve),rr&&(this.O?J="headers="+encodeURIComponent(String(Zi(rr)))+"&"+J:this.m&&Dl(ve,this.m,rr)),He(this.h,Gt),this.Ua&&tt(ve,"TYPE","init"),this.P?(tt(ve,"$req",J),tt(ve,"SID","null"),Gt.T=!0,yt(Gt,ve,null)):yt(Gt,ve,J),this.G=2}}else this.G==3&&(_?mt(this,_):this.i.length==0||Zr(this.h)||mt(this))};function mt(_,J){var ve;J?ve=J.l:ve=_.U++;const et=vr(_.I);tt(et,"SID",_.K),tt(et,"RID",ve),tt(et,"AID",_.T),jt(_,et),_.m&&_.o&&Dl(et,_.m,_.o),ve=new ye(_,_.j,ve,_.B+1),_.m===null&&(ve.H=_.o),J&&(_.i=J.D.concat(_.i)),J=$t(_,ve,1e3),ve.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),He(_.h,ve),yt(ve,et,J)}function jt(_,J){_.H&&j(_.H,function(ve,et){tt(J,et,ve)}),_.l&&br({},function(ve,et){tt(J,et,ve)})}function $t(_,J,ve){ve=Math.min(_.i.length,ve);var et=_.l?A(_.l.Na,_.l,_):null;e:{var Gt=_.i;let rr=-1;for(;;){const Mr=["count="+ve];rr==-1?0<ve?(rr=Gt[0].g,Mr.push("ofs="+rr)):rr=0:Mr.push("ofs="+rr);let pa=!0;for(let ri=0;ri<ve;ri++){let aa=Gt[ri].g;const Ia=Gt[ri].map;if(aa-=rr,0>aa)rr=Math.max(0,Gt[ri].g-100),pa=!1;else try{Tn(Ia,Mr,"req"+aa+"_")}catch{et&&et(Ia)}}if(pa){et=Mr.join("&");break e}}}return _=_.i.splice(0,ve),J.D=_,et}function Ar(_){if(!_.g&&!_.u){_.Y=1;var J=_.Fa;le||_e(),Ae||(le(),Ae=!0),ae.add(J,_),_.v=0}}function Nr(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=Le(A(_.Fa,_),da(_,_.v)),_.v++,!0)}t.Fa=function(){if(this.u=null,fn(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=Le(A(this.ab,this),_)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ne(10),Ao(this),fn(this))};function an(_){_.A!=null&&(l.clearTimeout(_.A),_.A=null)}function fn(_){_.g=new ye(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var J=vr(_.qa);tt(J,"RID","rpc"),tt(J,"SID",_.K),tt(J,"AID",_.T),tt(J,"CI",_.F?"0":"1"),!_.F&&_.ja&&tt(J,"TO",_.ja),tt(J,"TYPE","xmlhttp"),jt(_,J),_.m&&_.o&&Dl(J,_.m,_.o),_.L&&(_.g.I=_.L);var ve=_.g;_=_.ia,ve.L=1,ve.v=nt(vr(J)),ve.m=null,ve.P=!0,ne(ve,_)}t.Za=function(){this.C!=null&&(this.C=null,Ao(this),Nr(this),Ne(19))};function Bn(_){_.C!=null&&(l.clearTimeout(_.C),_.C=null)}function Vn(_,J){var ve=null;if(_.g==J){Bn(_),an(_),_.g=null;var et=2}else if(_r(_.h,J))ve=J.D,Bt(_.h,J),et=1;else return;if(_.G!=0){if(J.o)if(et==1){ve=J.m?J.m.length:0,J=Date.now()-J.F;var Gt=_.B;et=bt(),Re(et,new pe(et,ve)),M(_)}else Ar(_);else if(Gt=J.s,Gt==3||Gt==0&&0<J.X||!(et==1&&Ee(_,J)||et==2&&Nr(_)))switch(ve&&0<ve.length&&(J=_.h,J.i=J.i.concat(ve)),Gt){case 1:Oa(_,5);break;case 4:Oa(_,10);break;case 3:Oa(_,6);break;default:Oa(_,2)}}}function da(_,J){let ve=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(ve*=2),ve*J}function Oa(_,J){if(_.j.info("Error code "+J),J==2){var ve=A(_.fb,_),et=_.Xa;const Gt=!et;et=new Sr(et||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Fr(et,"https"),nt(et),Gt?Vr(et.toString(),ve):jr(et.toString(),ve)}else Ne(2);_.G=0,_.l&&_.l.sa(J),Zs(_),Wu(_)}t.fb=function(_){_?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))};function Zs(_){if(_.G=0,_.ka=[],_.l){const J=xr(_.h);(J.length!=0||_.i.length!=0)&&(x(_.ka,J),x(_.ka,_.i),_.h.i.length=0,p(_.i),_.i.length=0),_.l.ra()}}function $a(_,J,ve){var et=ve instanceof Sr?vr(ve):new Sr(ve);if(et.g!="")J&&(et.g=J+"."+et.g),jn(et,et.s);else{var Gt=l.location;et=Gt.protocol,J=J?J+"."+Gt.hostname:Gt.hostname,Gt=+Gt.port;var rr=new Sr(null);et&&Fr(rr,et),J&&(rr.g=J),Gt&&jn(rr,Gt),ve&&(rr.l=ve),et=rr}return ve=_.D,J=_.ya,ve&&J&&tt(et,ve,J),tt(et,"VER",_.la),jt(_,et),et}function xi(_,J,ve){if(J&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return J=_.Ca&&!_.pa?new va(new wn({eb:ve})):new va(_.pa),J.Ha(_.J),J}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ei(){}t=ei.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function vi(){}vi.prototype.g=function(_,J){return new ti(_,J)};function ti(_,J){Tt.call(this),this.g=new Vc(J),this.l=_,this.h=J&&J.messageUrlParams||null,_=J&&J.messageHeaders||null,J&&J.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=J&&J.initMessageHeaders||null,J&&J.messageContentType&&(_?_["X-WebChannel-Content-Type"]=J.messageContentType:_={"X-WebChannel-Content-Type":J.messageContentType}),J&&J.va&&(_?_["X-WebChannel-Client-Profile"]=J.va:_={"X-WebChannel-Client-Profile":J.va}),this.g.S=_,(_=J&&J.Sb)&&!y(_)&&(this.g.m=_),this.v=J&&J.supportsCrossDomainXhr||!1,this.u=J&&J.sendRawJson||!1,(J=J&&J.httpSessionIdParam)&&!y(J)&&(this.g.D=J,_=this.h,_!==null&&J in _&&(_=this.h,J in _&&delete _[J])),this.j=new Yu(this)}m(ti,Tt),ti.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ti.prototype.close=function(){Ff(this.g)},ti.prototype.o=function(_){var J=this.g;if(typeof _=="string"){var ve={};ve.__data__=_,_=ve}else this.u&&(ve={},ve.__data__=Qe(_),_=ve);J.i.push(new or(J.Ya++,_)),J.G==3&&M(J)},ti.prototype.N=function(){this.g.l=null,delete this.j,Ff(this.g),delete this.g,ti.aa.N.call(this)};function Hc(_){me.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var J=_.__sm__;if(J){e:{for(const ve in J){_=ve;break e}_=void 0}(this.i=_)&&(_=this.i,J=J!==null&&_ in J?J[_]:void 0),this.data=J}else this.data=_}m(Hc,me);function Xu(){we.call(this),this.status=1}m(Xu,we);function Yu(_){this.g=_}m(Yu,ei),Yu.prototype.ua=function(){Re(this.g,"a")},Yu.prototype.ta=function(_){Re(this.g,new Hc(_))},Yu.prototype.sa=function(_){Re(this.g,new Xu)},Yu.prototype.ra=function(){Re(this.g,"b")},vi.prototype.createWebChannel=vi.prototype.g,ti.prototype.send=ti.prototype.o,ti.prototype.open=ti.prototype.m,ti.prototype.close=ti.prototype.close,QJ=function(){return new vi},UJ=function(){return bt()},LJ=pt,KB={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},V.NO_ERROR=0,V.TIMEOUT=8,V.HTTP_ERROR=6,sE=V,L.COMPLETE="complete",MJ=L,de.EventType=Me,Me.OPEN="a",Me.CLOSE="b",Me.ERROR="c",Me.MESSAGE="d",Tt.prototype.listen=Tt.prototype.K,Vy=de,va.prototype.listenOnce=va.prototype.L,va.prototype.getLastError=va.prototype.Ka,va.prototype.getLastErrorCode=va.prototype.Ba,va.prototype.getStatus=va.prototype.Z,va.prototype.getResponseJson=va.prototype.Oa,va.prototype.getResponseText=va.prototype.oa,va.prototype.send=va.prototype.ea,va.prototype.setWithCredentials=va.prototype.Ha,RJ=va}).apply(typeof nC<"u"?nC:typeof self<"u"?self:typeof window<"u"?window:{});const b7="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_l.UNAUTHENTICATED=new _l(null),_l.GOOGLE_CREDENTIALS=new _l("google-credentials-uid"),_l.FIRST_PARTY=new _l("first-party-uid"),_l.MOCK_USER=new _l("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u1="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg=new jD("@firebase/firestore");function Ex(){return lg.logLevel}function Or(t,...e){if(lg.logLevel<=Aa.DEBUG){const r=e.map(GD);lg.debug(`Firestore (${u1}): ${t}`,...r)}}function jc(t,...e){if(lg.logLevel<=Aa.ERROR){const r=e.map(GD);lg.error(`Firestore (${u1}): ${t}`,...r)}}function bm(t,...e){if(lg.logLevel<=Aa.WARN){const r=e.map(GD);lg.warn(`Firestore (${u1}): ${t}`,...r)}}function GD(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(t="Unexpected state"){const e=`FIRESTORE (${u1}) INTERNAL ASSERTION FAILED: `+t;throw jc(e),new Error(e)}function pn(t,e){t||un()}function Un(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Hr extends FA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VJ{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(_l.UNAUTHENTICATED))}shutdown(){}}class Vxe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Hxe{constructor(e){this.t=e,this.currentUser=_l.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){pn(this.o===void 0);let n=this.i;const a=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new vf;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vf,e.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await a(this.currentUser)})},l=c=>{Or("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Or("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vf)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Or("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pn(typeof n.accessToken=="string"),new VJ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pn(e===null||typeof e=="string"),new _l(e)}}class $xe{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=_l.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Gxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new $xe(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(_l.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Kxe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qxe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){pn(this.o===void 0);const n=s=>{s.error!=null&&Or("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Or("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{Or("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?a(s):Or("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(pn(typeof r.token=="string"),this.R=r.token,new Kxe(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zxe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=zxe(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=e.charAt(a[s]%e.length))}return n}}function zn(t,e){return t<e?-1:t>e?1:0}function Bv(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}function $J(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Hr(hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Hr(hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Hr(hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Hr(hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return yr.fromMillis(Date.now())}static fromDate(e){return yr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new yr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?zn(this.nanoseconds,e.nanoseconds):zn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Nn(e)}static min(){return new Nn(new yr(0,0))}static max(){return new Nn(new yr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e,r,n){r===void 0?r=0:r>e.length&&un(),n===void 0?n=e.length-r:n>e.length-r&&un(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return m2.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof m2?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const s=e.get(a),o=r.get(a);if(s<o)return-1;if(s>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Ba extends m2{construct(e,r,n){return new Ba(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Hr(hr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new Ba(r)}static emptyPath(){return new Ba([])}}const Wxe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ks extends m2{construct(e,r,n){return new Ks(e,r,n)}static isValidIdentifier(e){return Wxe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ks.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ks(["__name__"])}static fromServerFormat(e){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Hr(hr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new Hr(hr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[a+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Hr(hr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(n+=l,a++):(s(),a++)}if(s(),o)throw new Hr(hr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ks(r)}static emptyPath(){return new Ks([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.path=e}static fromPath(e){return new Xr(Ba.fromString(e))}static fromName(e){return new Xr(Ba.fromString(e).popFirst(5))}static empty(){return new Xr(Ba.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ba.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ba.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xr(new Ba(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r,n,a){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=a}}function qB(t){return t.fields.find(e=>e.kind===2)}function fp(t){return t.fields.filter(e=>e.kind!==2)}lS.UNKNOWN_ID=-1;class iE{constructor(e,r){this.fieldPath=e,this.kind=r}}class p2{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new p2(0,Vu.min())}}function Xxe(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=Nn.fromTimestamp(n===1e9?new yr(r+1,0):new yr(r,n));return new Vu(a,Xr.empty(),e)}function GJ(t){return new Vu(t.readTime,t.key,-1)}class Vu{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Vu(Nn.min(),Xr.empty(),-1)}static max(){return new Vu(Nn.max(),Xr.empty(),-1)}}function qD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Xr.comparator(t.documentKey,e.documentKey),r!==0?r:zn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qJ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fg(t){if(t.code!==hr.FAILED_PRECONDITION||t.message!==KJ)throw t;Or("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&un(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Zt((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Zt?r:Zt.resolve(r)}catch(r){return Zt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Zt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Zt.reject(r)}static resolve(e){return new Zt((r,n)=>{r(e)})}static reject(e){return new Zt((r,n)=>{n(e)})}static waitFor(e){return new Zt((r,n)=>{let a=0,s=0,o=!1;e.forEach(l=>{++a,l.next(()=>{++s,o&&s===a&&r()},c=>n(c))}),o=!0,s===a&&r()})}static or(e){let r=Zt.resolve(!1);for(const n of e)r=r.next(a=>a?Zt.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(e,r){return new Zt((n,a)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;r(e[u]).next(d=>{o[u]=d,++l,l===s&&n(o)},d=>a(d))}})}static doWhile(e,r){return new Zt((n,a)=>{const s=()=>{e()===!0?r().next(()=>{s()},a):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new vf,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new xb(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const a=zD(n.target.error);this.V.reject(new xb(e,a))}}static open(e,r,n,a){try{return new CI(r,e.transaction(a,n))}catch(s){throw new xb(r,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Or("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new Jxe(r)}}class fm{constructor(e,r,n){this.name=e,this.version=r,this.p=n,fm.S(Oo())===12.2&&jc("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Or("SimpleDb","Removing database:",e),vp(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!YY())return!1;if(fm.v())return!0;const e=Oo(),r=fm.S(e),n=0<r&&r<10,a=zJ(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Or("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const o=s.target.result;r(o)},a.onblocked=()=>{n(new xb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Hr(hr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Hr(hr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new xb(e,o))},a.onupgradeneeded=s=>{Or("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,a.transaction,s.oldVersion,this.version).next(()=>{Or("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,a){const s=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=CI.open(this.db,e,s?"readonly":"readwrite",n),c=a(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Zt.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Or("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zJ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Yxe{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return vp(this.B.delete())}}class xb extends Hr{constructor(e,r){super(hr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Qm(t){return t.name==="IndexedDbTransactionError"}class Jxe{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Or("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Or("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),vp(n)}add(e){return Or("SimpleDb","ADD",this.store.name,e,e),vp(this.store.add(e))}get(e){return vp(this.store.get(e)).next(r=>(r===void 0&&(r=null),Or("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Or("SimpleDb","DELETE",this.store.name,e),vp(this.store.delete(e))}count(){return Or("SimpleDb","COUNT",this.store.name),vp(this.store.count())}U(e,r){const n=this.options(e,r),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new Zt((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(n),o=[];return this.W(s,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Zt((a,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{a(o.target.result)}})}j(e,r){Or("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const a=this.cursor(n);return this.W(a,(s,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const a=this.cursor(n);return this.W(a,r)}Y(e){const r=this.cursor({});return new Zt((n,a)=>{r.onerror=s=>{const o=zD(s.target.error);a(o)},r.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new Zt((a,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void a();const c=new Yxe(l),u=r(l.primaryKey,l.value,c);if(u instanceof Zt){const d=u.catch(f=>(c.done(),Zt.reject(f)));n.push(d)}c.isDone?a():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Zt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function vp(t){return new Zt((e,r)=>{t.onsuccess=n=>{const a=n.target.result;e(a)},t.onerror=n=>{const a=zD(n.target.error);r(a)}})}let w7=!1;function zD(t){const e=fm.S(Oo());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Hr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return w7||(w7=!0,setTimeout(()=>{throw n},0)),n}}return t}class Zxe{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Or("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Or("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){Qm(r)?Or("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Fg(r)}await this.X(6e4)})}}class eve{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let a=r,s=!0;return Zt.doWhile(()=>s===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Or("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,a).next(l=>{a-=l,n.add(o)});s=!1})).next(()=>r-a)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(a=>this.localStore.localDocuments.getNextDocuments(e,r,a,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(a,s)).next(l=>(Or("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((a,s)=>{const o=GJ(s);qD(o,n)>0&&(n=o)}),new Vu(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Nd.oe=-1;function jw(t){return t==null}function g2(t){return t===0&&1/t==-1/0}function tve(t){return typeof t=="number"&&Number.isInteger(t)&&!g2(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=N7(e)),e=rve(t.get(r),e);return N7(e)}function rve(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const s=t.charAt(a);switch(s){case"\0":r+="";break;case"":r+="";break;default:r+=s}}return r}function N7(t){return t+""}function Jf(t){const e=t.length;if(pn(e>=2),e===2)return pn(t.charAt(0)===""&&t.charAt(1)===""),Ba.emptyPath();const r=e-2,n=[];let a="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>r)&&un(),t.charAt(o+1)){case"":const l=t.substring(s,o);let c;a.length===0?c=l:(a+=l,c=a,a=""),n.push(c);break;case"":a+=t.substring(s,o),a+="\0";break;case"":a+=t.substring(s,o+1);break;default:un()}s=o+2}return new Ba(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C7=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t,e){return[t,Bc(e)]}function WJ(t,e,r){return[t,Bc(e),r]}const nve={},ave=["prefixPath","collectionGroup","readTime","documentId"],sve=["prefixPath","collectionGroup","documentId"],ive=["collectionGroup","readTime","prefixPath","documentId"],ove=["canonicalId","targetId"],lve=["targetId","path"],cve=["path","targetId"],uve=["collectionId","parent"],dve=["indexId","uid"],fve=["uid","sequenceNumber"],hve=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ave=["indexId","uid","orderedDocumentKey"],mve=["userId","collectionPath","documentId"],pve=["userId","collectionPath","largestBatchId"],gve=["userId","collectionGroup","largestBatchId"],XJ=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],xve=[...XJ,"documentOverlays"],YJ=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],JJ=YJ,WD=[...JJ,"indexConfiguration","indexState","indexEntries"],vve=WD,yve=[...WD,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB extends qJ{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function Ro(t,e){const r=Un(t);return fm.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _7(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Og(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function ZJ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,r){this.comparator=e,this.root=r||El.EMPTY}insert(e,r){return new Ys(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,El.BLACK,null,null))}remove(e){return new Ys(this.comparator,this.root.remove(e,this.comparator).copy(null,null,El.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new aC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new aC(this.root,e,this.comparator,!1)}getReverseIterator(){return new aC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new aC(this.root,e,this.comparator,!0)}}class aC{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class El{constructor(e,r,n,a,s){this.key=e,this.value=r,this.color=n??El.RED,this.left=a??El.EMPTY,this.right=s??El.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,s){return new El(e??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return El.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return El.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,El.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,El.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw un();const e=this.left.check();if(e!==this.right.check())throw un();return e+(this.isRed()?0:1)}}El.EMPTY=null,El.RED=!0,El.BLACK=!1;El.EMPTY=new class{constructor(){this.size=0}get key(){throw un()}get value(){throw un()}get color(){throw un()}get left(){throw un()}get right(){throw un()}copy(e,r,n,a,s){return this}insert(e,r,n){return new El(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this.comparator=e,this.data=new Ys(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new E7(this.data.getIterator())}getIteratorFrom(e){return new E7(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ds)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ds(this.comparator);return r.data=e,r}}class E7{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function rx(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e){this.fields=e,e.sort(Ks.comparator)}static empty(){return new nu([])}unionWith(e){let r=new ds(Ks.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new nu(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Bv(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new eZ("Invalid base64 string: "+s):s}}(e);return new Xi(r)}static fromUint8Array(e){const r=function(a){let s="";for(let o=0;o<a.length;++o)s+=String.fromCharCode(a[o]);return s}(e);return new Xi(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return zn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xi.EMPTY_BYTE_STRING=new Xi("");const bve=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yA(t){if(pn(!!t),typeof t=="string"){let e=0;const r=bve.exec(t);if(pn(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Hs(t.seconds),nanos:Hs(t.nanos)}}function Hs(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function wm(t){return typeof t=="string"?Xi.fromBase64String(t):Xi.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function YD(t){const e=t.mapValue.fields.__previous_value__;return XD(e)?YD(e):e}function x2(t){const e=yA(t.mapValue.fields.__local_write_time__.timestampValue);return new yr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wve{constructor(e,r,n,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Nm{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Nm("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Nm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},lE={nullValue:"NULL_VALUE"};function cg(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?XD(t)?4:tZ(t)?9007199254740991:_I(t)?10:11:un()}function ch(t,e){if(t===e)return!0;const r=cg(t);if(r!==cg(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return x2(t).isEqual(x2(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const o=yA(a.timestampValue),l=yA(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,s){return wm(a.bytesValue).isEqual(wm(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,s){return Hs(a.geoPointValue.latitude)===Hs(s.geoPointValue.latitude)&&Hs(a.geoPointValue.longitude)===Hs(s.geoPointValue.longitude)}(t,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return Hs(a.integerValue)===Hs(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const o=Hs(a.doubleValue),l=Hs(s.doubleValue);return o===l?g2(o)===g2(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Bv(t.arrayValue.values||[],e.arrayValue.values||[],ch);case 10:case 11:return function(a,s){const o=a.mapValue.fields||{},l=s.mapValue.fields||{};if(_7(o)!==_7(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ch(o[c],l[c])))return!1;return!0}(t,e);default:return un()}}function v2(t,e){return(t.values||[]).find(r=>ch(r,e))!==void 0}function Cm(t,e){if(t===e)return 0;const r=cg(t),n=cg(e);if(r!==n)return zn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return zn(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Hs(s.integerValue||s.doubleValue),c=Hs(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return S7(t.timestampValue,e.timestampValue);case 4:return S7(x2(t),x2(e));case 5:return zn(t.stringValue,e.stringValue);case 6:return function(s,o){const l=wm(s),c=wm(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=zn(l[u],c[u]);if(d!==0)return d}return zn(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=zn(Hs(s.latitude),Hs(o.latitude));return l!==0?l:zn(Hs(s.longitude),Hs(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return j7(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,d;const f=s.fields||{},A=o.fields||{},h=(l=f.value)===null||l===void 0?void 0:l.arrayValue,m=(c=A.value)===null||c===void 0?void 0:c.arrayValue,p=zn(((u=h==null?void 0:h.values)===null||u===void 0?void 0:u.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:j7(h,m)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===q0.mapValue&&o===q0.mapValue)return 0;if(s===q0.mapValue)return 1;if(o===q0.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const A=zn(c[f],d[f]);if(A!==0)return A;const h=Cm(l[c[f]],u[d[f]]);if(h!==0)return h}return zn(c.length,d.length)}(t.mapValue,e.mapValue);default:throw un()}}function S7(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return zn(t,e);const r=yA(t),n=yA(e),a=zn(r.seconds,n.seconds);return a!==0?a:zn(r.nanos,n.nanos)}function j7(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=Cm(r[a],n[a]);if(s)return s}return zn(r.length,n.length)}function kv(t){return WB(t)}function WB(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=yA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return wm(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Xr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const s of r.values||[])a?a=!1:n+=",",n+=WB(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",s=!0;for(const o of n)s?s=!1:a+=",",a+=`${o}:${WB(r.fields[o])}`;return a+"}"}(t.mapValue):un()}function y2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function XB(t){return!!t&&"integerValue"in t}function b2(t){return!!t&&"arrayValue"in t}function I7(t){return!!t&&"nullValue"in t}function P7(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function cE(t){return!!t&&"mapValue"in t}function _I(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function vb(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Og(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=vb(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=vb(t.arrayValue.values[r]);return e}return Object.assign({},t)}function tZ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const rZ={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Nve(t){return"nullValue"in t?lE:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?y2(Nm.empty(),Xr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?_I(t)?rZ:{mapValue:{}}:un()}function Cve(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?y2(Nm.empty(),Xr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?rZ:"mapValue"in t?_I(t)?{mapValue:{}}:q0:un()}function T7(t,e){const r=Cm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function B7(t,e){const r=Cm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e){this.value=e}static empty(){return new jl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!cE(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=vb(r)}setAll(e){let r=Ks.emptyPath(),n={},a=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,a),n={},a=[],r=l.popLast()}o?n[l.lastSegment()]=vb(o):a.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(e){const r=this.field(e.popLast());cE(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ch(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];cE(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Og(r,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new jl(vb(this.value))}}function nZ(t){const e=[];return Og(t.fields,(r,n)=>{const a=new Ks([r]);if(cE(n)){const s=nZ(n.mapValue).fields;if(s.length===0)e.push(a);else for(const o of s)e.push(a.child(o))}else e.push(a)}),new nu(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,r,n,a,s,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Gs(e,0,Nn.min(),Nn.min(),Nn.min(),jl.empty(),0)}static newFoundDocument(e,r,n,a){return new Gs(e,1,r,Nn.min(),n,a,0)}static newNoDocument(e,r){return new Gs(e,2,r,Nn.min(),Nn.min(),jl.empty(),0)}static newUnknownDocument(e,r){return new Gs(e,3,r,Nn.min(),Nn.min(),jl.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Nn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Nn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,r){this.position=e,this.inclusive=r}}function k7(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const s=e[a],o=t.position[a];if(s.field.isKeyField()?n=Xr.comparator(Xr.fromName(o.referenceValue),r.key):n=Cm(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function F7(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ch(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,r="asc"){this.field=e,this.dir=r}}function _ve(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aZ{}class ma extends aZ{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Eve(e,r,n):r==="array-contains"?new Ive(e,n):r==="in"?new uZ(e,n):r==="not-in"?new Pve(e,n):r==="array-contains-any"?new Tve(e,n):new ma(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Sve(e,n):new jve(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Cm(r,this.value)):r!==null&&cg(this.value)===cg(r)&&this.matchesComparison(Cm(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return un()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rs extends aZ{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new rs(e,r)}matches(e){return Ov(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ov(t){return t.op==="and"}function YB(t){return t.op==="or"}function JD(t){return sZ(t)&&Ov(t)}function sZ(t){for(const e of t.filters)if(e instanceof rs)return!1;return!0}function JB(t){if(t instanceof ma)return t.field.canonicalString()+t.op.toString()+kv(t.value);if(JD(t))return t.filters.map(e=>JB(e)).join(",");{const e=t.filters.map(r=>JB(r)).join(",");return`${t.op}(${e})`}}function iZ(t,e){return t instanceof ma?function(n,a){return a instanceof ma&&n.op===a.op&&n.field.isEqual(a.field)&&ch(n.value,a.value)}(t,e):t instanceof rs?function(n,a){return a instanceof rs&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,o,l)=>s&&iZ(o,a.filters[l]),!0):!1}(t,e):void un()}function oZ(t,e){const r=t.filters.concat(e);return rs.create(r,t.op)}function lZ(t){return t instanceof ma?function(r){return`${r.field.canonicalString()} ${r.op} ${kv(r.value)}`}(t):t instanceof rs?function(r){return r.op.toString()+" {"+r.getFilters().map(lZ).join(" ,")+"}"}(t):"Filter"}class Eve extends ma{constructor(e,r,n){super(e,r,n),this.key=Xr.fromName(n.referenceValue)}matches(e){const r=Xr.comparator(e.key,this.key);return this.matchesComparison(r)}}class Sve extends ma{constructor(e,r){super(e,"in",r),this.keys=cZ("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class jve extends ma{constructor(e,r){super(e,"not-in",r),this.keys=cZ("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function cZ(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Xr.fromName(n.referenceValue))}class Ive extends ma{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return b2(r)&&v2(r.arrayValue,this.value)}}class uZ extends ma{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&v2(this.value.arrayValue,r)}}class Pve extends ma{constructor(e,r){super(e,"not-in",r)}matches(e){if(v2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!v2(this.value.arrayValue,r)}}class Tve extends ma{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!b2(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>v2(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bve{constructor(e,r=null,n=[],a=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function ZB(t,e=null,r=[],n=[],a=null,s=null,o=null){return new Bve(t,e,r,n,a,s,o)}function ug(t){const e=Un(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>JB(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),jw(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>kv(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>kv(n)).join(",")),e.ue=r}return e.ue}function Iw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!_ve(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!iZ(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!F7(t.startAt,e.startAt)&&F7(t.endAt,e.endAt)}function cS(t){return Xr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function uS(t,e){return t.filters.filter(r=>r instanceof ma&&r.field.isEqual(e))}function O7(t,e,r){let n=lE,a=!0;for(const s of uS(t,e)){let o=lE,l=!0;switch(s.op){case"<":case"<=":o=Nve(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=lE}T7({value:n,inclusive:a},{value:o,inclusive:l})<0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];T7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})<0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}function D7(t,e,r){let n=q0,a=!0;for(const s of uS(t,e)){let o=q0,l=!0;switch(s.op){case">=":case">":o=Cve(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=q0}B7({value:n,inclusive:a},{value:o,inclusive:l})>0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];B7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})>0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,r=null,n=[],a=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function kve(t,e,r,n,a,s,o,l){return new d1(t,e,r,n,a,s,o,l)}function Pw(t){return new d1(t)}function R7(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function dZ(t){return t.collectionGroup!==null}function yb(t){const e=Un(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new ds(Ks.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new w2(s,n))}),r.has(Ks.keyField().canonicalString())||e.ce.push(new w2(Ks.keyField(),n))}return e.ce}function Id(t){const e=Un(t);return e.le||(e.le=Fve(e,yb(t))),e.le}function Fve(t,e){if(t.limitType==="F")return ZB(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new w2(a.field,s)});const r=t.endAt?new Fv(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Fv(t.startAt.position,t.startAt.inclusive):null;return ZB(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function ek(t,e){const r=t.filters.concat([e]);return new d1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function dS(t,e,r){return new d1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function EI(t,e){return Iw(Id(t),Id(e))&&t.limitType===e.limitType}function fZ(t){return`${ug(Id(t))}|lt:${t.limitType}`}function Sx(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>lZ(a)).join(", ")}]`),jw(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>kv(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>kv(a)).join(",")),`Target(${n})`}(Id(t))}; limitType=${t.limitType})`}function Tw(t,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Xr.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,a){for(const s of yb(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(o,l,c){const u=k7(o,l,c);return o.inclusive?u<=0:u<0}(n.startAt,yb(n),a)||n.endAt&&!function(o,l,c){const u=k7(o,l,c);return o.inclusive?u>=0:u>0}(n.endAt,yb(n),a))}(t,e)}function Ove(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hZ(t){return(e,r)=>{let n=!1;for(const a of yb(t)){const s=Dve(a,e,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function Dve(t,e,r){const n=t.field.isKeyField()?Xr.comparator(e.key,r.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?Cm(c,u):un()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return un()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Og(this.inner,(r,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return ZJ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rve=new Ys(Xr.comparator);function Ou(){return Rve}const AZ=new Ys(Xr.comparator);function Hy(...t){let e=AZ;for(const r of t)e=e.insert(r.key,r);return e}function mZ(t){let e=AZ;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Zf(){return bb()}function pZ(){return bb()}function bb(){return new Vm(t=>t.toString(),(t,e)=>t.isEqual(e))}const Mve=new Ys(Xr.comparator),Lve=new ds(Xr.comparator);function na(...t){let e=Lve;for(const r of t)e=e.add(r);return e}const Uve=new ds(zn);function Qve(){return Uve}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:g2(e)?"-0":e}}function gZ(t){return{integerValue:""+t}}function Vve(t,e){return tve(e)?gZ(e):ZD(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this._=void 0}}function Hve(t,e,r){return t instanceof Dv?function(a,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&XD(s)&&(s=YD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,e):t instanceof dg?vZ(t,e):t instanceof Rv?yZ(t,e):function(a,s){const o=xZ(a,s),l=M7(o)+M7(a.Pe);return XB(o)&&XB(a.Pe)?gZ(l):ZD(a.serializer,l)}(t,e)}function $ve(t,e,r){return t instanceof dg?vZ(t,e):t instanceof Rv?yZ(t,e):r}function xZ(t,e){return t instanceof N2?function(n){return XB(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Dv extends SI{}class dg extends SI{constructor(e){super(),this.elements=e}}function vZ(t,e){const r=bZ(e);for(const n of t.elements)r.some(a=>ch(a,n))||r.push(n);return{arrayValue:{values:r}}}class Rv extends SI{constructor(e){super(),this.elements=e}}function yZ(t,e){let r=bZ(e);for(const n of t.elements)r=r.filter(a=>!ch(a,n));return{arrayValue:{values:r}}}class N2 extends SI{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function M7(t){return Hs(t.integerValue||t.doubleValue)}function bZ(t){return b2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e,r){this.field=e,this.transform=r}}function Gve(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof dg&&a instanceof dg||n instanceof Rv&&a instanceof Rv?Bv(n.elements,a.elements,ch):n instanceof N2&&a instanceof N2?ch(n.Pe,a.Pe):n instanceof Dv&&a instanceof Dv}(t.transform,e.transform)}class Kve{constructor(e,r){this.version=e,this.transformResults=r}}class qs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new qs}static exists(e){return new qs(void 0,e)}static updateTime(e){return new qs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uE(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class jI{}function wZ(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new h1(t.key,qs.none()):new f1(t.key,t.data,qs.none());{const r=t.data,n=jl.empty();let a=new ds(Ks.comparator);for(let s of e.fields)if(!a.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),a=a.add(s)}return new RA(t.key,n,new nu(a.toArray()),qs.none())}}function qve(t,e,r){t instanceof f1?function(a,s,o){const l=a.value.clone(),c=U7(a.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof RA?function(a,s,o){if(!uE(a.precondition,s))return void s.convertToUnknownDocument(o.version);const l=U7(a.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(NZ(a)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(a,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function wb(t,e,r,n){return t instanceof f1?function(s,o,l,c){if(!uE(s.precondition,o))return l;const u=s.value.clone(),d=Q7(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof RA?function(s,o,l,c){if(!uE(s.precondition,o))return l;const u=Q7(s.fieldTransforms,c,o),d=o.data;return d.setAll(NZ(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,o,l){return uE(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function zve(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),s=xZ(n.transform,a||null);s!=null&&(r===null&&(r=jl.empty()),r.set(n.field,s))}return r||null}function L7(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Bv(n,a,(s,o)=>Gve(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class f1 extends jI{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class RA extends jI{constructor(e,r,n,a,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function NZ(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function U7(t,e,r){const n=new Map;pn(t.length===r.length);for(let a=0;a<r.length;a++){const s=t[a],o=s.transform,l=e.data.field(s.field);n.set(s.field,$ve(o,l,r[a]))}return n}function Q7(t,e,r){const n=new Map;for(const a of t){const s=a.transform,o=r.data.field(a.field);n.set(a.field,Hve(s,o,e))}return n}class h1 extends jI{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class t6 extends jI{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&qve(s,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=wb(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=wb(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=pZ();return this.mutations.forEach(a=>{const s=e.get(a.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(a.key)?null:l;const c=wZ(o,l);c!==null&&n.set(a.key,c),o.isValidDocument()||o.convertToNoDocument(Nn.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),na())}isEqual(e){return this.batchId===e.batchId&&Bv(this.mutations,e.mutations,(r,n)=>L7(r,n))&&Bv(this.baseMutations,e.baseMutations,(r,n)=>L7(r,n))}}class n6{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){pn(e.mutations.length===n.length);let a=function(){return Mve}();const s=e.mutations;for(let o=0;o<s.length;o++)a=a.insert(s[o].key,n[o].version);return new n6(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wve{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var no,ba;function CZ(t){switch(t){default:return un();case hr.CANCELLED:case hr.UNKNOWN:case hr.DEADLINE_EXCEEDED:case hr.RESOURCE_EXHAUSTED:case hr.INTERNAL:case hr.UNAVAILABLE:case hr.UNAUTHENTICATED:return!1;case hr.INVALID_ARGUMENT:case hr.NOT_FOUND:case hr.ALREADY_EXISTS:case hr.PERMISSION_DENIED:case hr.FAILED_PRECONDITION:case hr.ABORTED:case hr.OUT_OF_RANGE:case hr.UNIMPLEMENTED:case hr.DATA_LOSS:return!0}}function _Z(t){if(t===void 0)return jc("GRPC error has no .code"),hr.UNKNOWN;switch(t){case no.OK:return hr.OK;case no.CANCELLED:return hr.CANCELLED;case no.UNKNOWN:return hr.UNKNOWN;case no.DEADLINE_EXCEEDED:return hr.DEADLINE_EXCEEDED;case no.RESOURCE_EXHAUSTED:return hr.RESOURCE_EXHAUSTED;case no.INTERNAL:return hr.INTERNAL;case no.UNAVAILABLE:return hr.UNAVAILABLE;case no.UNAUTHENTICATED:return hr.UNAUTHENTICATED;case no.INVALID_ARGUMENT:return hr.INVALID_ARGUMENT;case no.NOT_FOUND:return hr.NOT_FOUND;case no.ALREADY_EXISTS:return hr.ALREADY_EXISTS;case no.PERMISSION_DENIED:return hr.PERMISSION_DENIED;case no.FAILED_PRECONDITION:return hr.FAILED_PRECONDITION;case no.ABORTED:return hr.ABORTED;case no.OUT_OF_RANGE:return hr.OUT_OF_RANGE;case no.UNIMPLEMENTED:return hr.UNIMPLEMENTED;case no.DATA_LOSS:return hr.DATA_LOSS;default:return un()}}(ba=no||(no={}))[ba.OK=0]="OK",ba[ba.CANCELLED=1]="CANCELLED",ba[ba.UNKNOWN=2]="UNKNOWN",ba[ba.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ba[ba.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ba[ba.NOT_FOUND=5]="NOT_FOUND",ba[ba.ALREADY_EXISTS=6]="ALREADY_EXISTS",ba[ba.PERMISSION_DENIED=7]="PERMISSION_DENIED",ba[ba.UNAUTHENTICATED=16]="UNAUTHENTICATED",ba[ba.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ba[ba.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ba[ba.ABORTED=10]="ABORTED",ba[ba.OUT_OF_RANGE=11]="OUT_OF_RANGE",ba[ba.UNIMPLEMENTED=12]="UNIMPLEMENTED",ba[ba.INTERNAL=13]="INTERNAL",ba[ba.UNAVAILABLE=14]="UNAVAILABLE",ba[ba.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xve(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yve=new Mp([4294967295,4294967295],0);function V7(t){const e=Xve().encode(t),r=new DJ;return r.update(e),new Uint8Array(r.digest())}function H7(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Mp([r,n],0),new Mp([a,s],0)]}class s6{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new $y(`Invalid padding: ${r}`);if(n<0)throw new $y(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new $y(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new $y(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Mp.fromNumber(this.Ie)}Ee(e,r,n){let a=e.add(r.multiply(Mp.fromNumber(n)));return a.compare(Yve)===1&&(a=new Mp([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=V7(e),[n,a]=H7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);if(!this.de(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new s6(s,a,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=V7(e),[n,a]=H7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class $y extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,r,n,a,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,Bw.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new II(Nn.min(),a,new Ys(zn),Ou(),na())}}class Bw{constructor(e,r,n,a,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Bw(n,r,na(),na(),na())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,r,n,a){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=a}}class EZ{constructor(e,r){this.targetId=e,this.me=r}}class SZ{constructor(e,r,n=Xi.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class $7{constructor(){this.fe=0,this.ge=K7(),this.pe=Xi.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=na(),r=na(),n=na();return this.ge.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:un()}}),new Bw(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=K7()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,pn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Jve{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ou(),this.qe=G7(),this.Qe=new Ys(zn)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:un()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,a)=>{this.ze(a)&&r(a)})}He(e){const r=e.targetId,n=e.me.count,a=this.Je(r);if(a){const s=a.target;if(cS(s))if(n===0){const o=new Xr(s.path);this.Ue(r,o,Gs.newNoDocument(o,Nn.min()))}else pn(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let o,l;try{o=wm(n).toUint8Array()}catch(c){if(c instanceof eZ)return bm("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new s6(o,a,s)}catch(c){return bm(c instanceof $y?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,s,null),a++)}),a}rt(e){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&cS(l.target)){const c=new Xr(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Gs.newNoDocument(c,e))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=na();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const a=new II(e,r,this.Qe,this.ke,n);return this.ke=Ou(),this.qe=G7(),this.Qe=new Ys(zn),a}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,r)?a.Fe(r,1):a.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new $7,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new ds(zn),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Or("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new $7),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function G7(){return new Ys(Xr.comparator)}function K7(){return new Ys(Xr.comparator)}const Zve={asc:"ASCENDING",desc:"DESCENDING"},e1e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},t1e={and:"AND",or:"OR"};class r1e{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function tk(t,e){return t.useProto3Json||jw(e)?e:{value:e}}function Mv(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jZ(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function n1e(t,e){return Mv(t,e.toTimestamp())}function nl(t){return pn(!!t),Nn.fromTimestamp(function(r){const n=yA(r);return new yr(n.seconds,n.nanos)}(t))}function i6(t,e){return rk(t,e).canonicalString()}function rk(t,e){const r=function(a){return new Ba(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function IZ(t){const e=Ba.fromString(t);return pn(MZ(e)),e}function C2(t,e){return i6(t.databaseId,e.path)}function sA(t,e){const r=IZ(e);if(r.get(1)!==t.databaseId.projectId)throw new Hr(hr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Hr(hr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Xr(BZ(r))}function PZ(t,e){return i6(t.databaseId,e)}function TZ(t){const e=IZ(t);return e.length===4?Ba.emptyPath():BZ(e)}function nk(t){return new Ba(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function BZ(t){return pn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function q7(t,e,r){return{name:C2(t,e),fields:r.value.mapValue.fields}}function a1e(t,e,r){const n=sA(t,e.name),a=nl(e.updateTime),s=e.createTime?nl(e.createTime):Nn.min(),o=new jl({mapValue:{fields:e.fields}}),l=Gs.newFoundDocument(n,a,s,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function s1e(t,e){return"found"in e?function(n,a){pn(!!a.found),a.found.name,a.found.updateTime;const s=sA(n,a.found.name),o=nl(a.found.updateTime),l=a.found.createTime?nl(a.found.createTime):Nn.min(),c=new jl({mapValue:{fields:a.found.fields}});return Gs.newFoundDocument(s,o,l,c)}(t,e):"missing"in e?function(n,a){pn(!!a.missing),pn(!!a.readTime);const s=sA(n,a.missing),o=nl(a.readTime);return Gs.newNoDocument(s,o)}(t,e):un()}function i1e(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:un()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(pn(d===void 0||typeof d=="string"),Xi.fromBase64String(d||"")):(pn(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Xi.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?hr.UNKNOWN:_Z(u.code);return new Hr(d,u.message||"")}(o);r=new SZ(n,a,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=sA(t,n.document.name),s=nl(n.document.updateTime),o=n.document.createTime?nl(n.document.createTime):Nn.min(),l=new jl({mapValue:{fields:n.document.fields}}),c=Gs.newFoundDocument(a,s,o,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new dE(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=sA(t,n.document),s=n.readTime?nl(n.readTime):Nn.min(),o=Gs.newNoDocument(a,s),l=n.removedTargetIds||[];r=new dE([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=sA(t,n.document),s=n.removedTargetIds||[];r=new dE([],s,a,null)}else{if(!("filter"in e))return un();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,o=new Wve(a,s),l=n.targetId;r=new EZ(l,o)}}return r}function _2(t,e){let r;if(e instanceof f1)r={update:q7(t,e.key,e.value)};else if(e instanceof h1)r={delete:C2(t,e.key)};else if(e instanceof RA)r={update:q7(t,e.key,e.data),updateMask:f1e(e.fieldMask)};else{if(!(e instanceof t6))return un();r={verify:C2(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof Dv)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof dg)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Rv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof N2)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw un()}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:n1e(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:un()}(t,e.precondition)),r}function ak(t,e){const r=e.currentDocument?function(s){return s.updateTime!==void 0?qs.updateTime(nl(s.updateTime)):s.exists!==void 0?qs.exists(s.exists):qs.none()}(e.currentDocument):qs.none(),n=e.updateTransforms?e.updateTransforms.map(a=>function(o,l){let c=null;if("setToServerValue"in l)pn(l.setToServerValue==="REQUEST_TIME"),c=new Dv;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new dg(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new Rv(d)}else"increment"in l?c=new N2(o,l.increment):un();const u=Ks.fromServerFormat(l.fieldPath);return new e6(u,c)}(t,a)):[];if(e.update){e.update.name;const a=sA(t,e.update.name),s=new jl({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new nu(u.map(d=>Ks.fromServerFormat(d)))}(e.updateMask);return new RA(a,s,o,r,n)}return new f1(a,s,r,n)}if(e.delete){const a=sA(t,e.delete);return new h1(a,r)}if(e.verify){const a=sA(t,e.verify);return new t6(a,r)}return un()}function o1e(t,e){return t&&t.length>0?(pn(e!==void 0),t.map(r=>function(a,s){let o=a.updateTime?nl(a.updateTime):nl(s);return o.isEqual(Nn.min())&&(o=nl(s)),new Kve(o,a.transformResults||[])}(r,e))):[]}function kZ(t,e){return{documents:[PZ(t,e.path)]}}function FZ(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=PZ(t,a);const s=function(u){if(u.length!==0)return RZ(rs.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(A){return{field:jx(A.field),direction:c1e(A.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=tk(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:a}}function OZ(t){let e=TZ(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){pn(n===1);const d=r.from[0];d.allDescendants?a=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(f){const A=DZ(f);return A instanceof rs&&JD(A)?A.getFilters():[A]}(r.where));let o=[];r.orderBy&&(o=function(f){return f.map(A=>function(m){return new w2(Ix(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(A))}(r.orderBy));let l=null;r.limit&&(l=function(f){let A;return A=typeof f=="object"?f.value:f,jw(A)?null:A}(r.limit));let c=null;r.startAt&&(c=function(f){const A=!!f.before,h=f.values||[];return new Fv(h,A)}(r.startAt));let u=null;return r.endAt&&(u=function(f){const A=!f.before,h=f.values||[];return new Fv(h,A)}(r.endAt)),kve(e,a,o,s,l,"F",c,u)}function l1e(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return un()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function DZ(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Ix(r.unaryFilter.field);return ma.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Ix(r.unaryFilter.field);return ma.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ix(r.unaryFilter.field);return ma.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ix(r.unaryFilter.field);return ma.create(o,"!=",{nullValue:"NULL_VALUE"});default:return un()}}(t):t.fieldFilter!==void 0?function(r){return ma.create(Ix(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return un()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return rs.create(r.compositeFilter.filters.map(n=>DZ(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return un()}}(r.compositeFilter.op))}(t):un()}function c1e(t){return Zve[t]}function u1e(t){return e1e[t]}function d1e(t){return t1e[t]}function jx(t){return{fieldPath:t.canonicalString()}}function Ix(t){return Ks.fromServerFormat(t.fieldPath)}function RZ(t){return t instanceof ma?function(r){if(r.op==="=="){if(P7(r.value))return{unaryFilter:{field:jx(r.field),op:"IS_NAN"}};if(I7(r.value))return{unaryFilter:{field:jx(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(P7(r.value))return{unaryFilter:{field:jx(r.field),op:"IS_NOT_NAN"}};if(I7(r.value))return{unaryFilter:{field:jx(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jx(r.field),op:u1e(r.op),value:r.value}}}(t):t instanceof rs?function(r){const n=r.getFilters().map(a=>RZ(a));return n.length===1?n[0]:{compositeFilter:{op:d1e(r.op),filters:n}}}(t):un()}function f1e(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function MZ(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,r,n,a,s=Nn.min(),o=Nn.min(),l=Xi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Yh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Yh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LZ{constructor(e){this.ct=e}}function h1e(t,e){let r;if(e.document)r=a1e(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Xr.fromSegments(e.noDocument.path),a=hg(e.noDocument.readTime);r=Gs.newNoDocument(n,a),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return un();{const n=Xr.fromSegments(e.unknownDocument.path),a=hg(e.unknownDocument.version);r=Gs.newUnknownDocument(n,a)}}return e.readTime&&r.setReadTime(function(a){const s=new yr(a[0],a[1]);return Nn.fromTimestamp(s)}(e.readTime)),r}function z7(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:fS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:C2(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Mv(s,o.version.toTimestamp()),createTime:Mv(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:fg(e.version)};else{if(!e.isUnknownDocument())return un();n.unknownDocument={path:r.path.toArray(),version:fg(e.version)}}return n}function fS(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function fg(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function hg(t){const e=new yr(t.seconds,t.nanoseconds);return Nn.fromTimestamp(e)}function yp(t,e){const r=(e.baseMutations||[]).map(s=>ak(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>ak(t.ct,s)),a=yr.fromMillis(e.localWriteTimeMs);return new r6(e.batchId,a,r,n)}function Gy(t){const e=hg(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?hg(t.lastLimboFreeSnapshotVersion):Nn.min();let n;return n=function(s){return s.documents!==void 0}(t.query)?function(s){return pn(s.documents.length===1),Id(Pw(TZ(s.documents[0])))}(t.query):function(s){return Id(OZ(s))}(t.query),new Yh(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Xi.fromBase64String(t.resumeToken))}function UZ(t,e){const r=fg(e.snapshotVersion),n=fg(e.lastLimboFreeSnapshotVersion);let a;a=cS(e.target)?kZ(t.ct,e.target):FZ(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ug(e.target),readTime:r,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function QZ(t){const e=OZ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dS(e,e.limit,"L"):e}function S4(t,e){return new a6(e.largestBatchId,ak(t.ct,e.overlayMutation))}function W7(t,e){const r=e.path.lastSegment();return[t,Bc(e.path.popLast()),r]}function X7(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:fg(n.readTime),documentKey:Bc(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1e{getBundleMetadata(e,r){return Y7(e).get(r).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:hg(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,r){return Y7(e).put(function(a){return{bundleId:a.id,createTime:fg(nl(a.createTime)),version:a.version}}(r))}getNamedQuery(e,r){return J7(e).get(r).next(n=>{if(n)return function(s){return{name:s.name,query:QZ(s.bundledQuery),readTime:hg(s.readTime)}}(n)})}saveNamedQuery(e,r){return J7(e).put(function(a){return{name:a.name,readTime:fg(nl(a.readTime)),bundledQuery:a.bundledQuery}}(r))}}function Y7(t){return Ro(t,"bundles")}function J7(t){return Ro(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new PI(e,n)}getOverlay(e,r){return oy(e).get(W7(this.userId,r)).next(n=>n?S4(this.serializer,n):null)}getOverlays(e,r){const n=Zf();return Zt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){const a=[];return n.forEach((s,o)=>{const l=new a6(r,o);a.push(this.ht(e,l))}),Zt.waitFor(a)}removeOverlaysForBatchId(e,r,n){const a=new Set;r.forEach(o=>a.add(Bc(o.getCollectionPath())));const s=[];return a.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(oy(e).j("collectionPathOverlayIndex",l))}),Zt.waitFor(s)}getOverlaysForCollection(e,r,n){const a=Zf(),s=Bc(r),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return oy(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=S4(this.serializer,c);a.set(u.getKey(),u)}return a})}getOverlaysForCollectionGroup(e,r,n,a){const s=Zf();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return oy(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const f=S4(this.serializer,u);s.size()<a||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,r){return oy(e).put(function(a,s,o){const[l,c,u]=W7(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:_2(a.ct,o.mutation)}}(this.serializer,this.userId,r))}}function oy(t){return Ro(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1e{Pt(e){return Ro(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Xi.fromUint8Array(n):Xi.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(Hs(e.integerValue));else if("doubleValue"in e){const n=Hs(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),g2(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=yA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(wm(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?tZ(e)?this.dt(r,Number.MAX_SAFE_INTEGER):_I(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):un()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const a of Object.keys(n))this.Vt(a,r),this.Tt(n[a],r)}wt(e,r){var n,a;const s=e.fields||{};this.dt(r,53);const o="value",l=((a=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.length)||0;this.dt(r,15),r.At(Hs(l)),this.Vt(o,r),this.Tt(s[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const a of n)this.Tt(a,r)}yt(e,r){this.dt(r,37),Xr.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}bp.vt=new bp;function p1e(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function Z7(t){const e=64-function(n){let a=0;for(let s=0;s<8;++s){const o=p1e(255&n[s]);if(a+=o,o!==8)break}return a}(t);return Math.ceil(e/8)}class g1e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const a=r.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const a=r.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const r=this.qt(e),n=Z7(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=255&r[a]}Kt(e){const r=this.qt(e),n=Z7(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=~(255&r[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let a=1;a<r.length;++a)r[a]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class x1e{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class v1e{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ly{constructor(){this.jt=new g1e,this.Ht=new x1e(this.jt),this.Jt=new v1e(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,r,n,a){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=a}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new wp(this.indexId,this.documentKey,this.arrayValue,n)}}function u0(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=e9(t.arrayValue,e.arrayValue),r!==0?r:(r=e9(t.directionalValue,e.directionalValue),r!==0?r:Xr.comparator(t.documentKey,e.documentKey)))}function e9(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{constructor(e){this.Xt=new ds((r,n)=>Ks.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(pn(e.collectionGroup===this.collectionId),this.nn)return!1;const r=qB(e);if(r!==void 0&&!this.sn(r))return!1;const n=fp(e);let a=new Set,s=0,o=0;for(;s<n.length&&this.sn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!a.has(l.field.canonicalString())){const c=n[s];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new ds(Ks.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new iE(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new iE(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new iE(n.field,n.dir==="asc"?0:1)));return new lS(lS.UNKNOWN_ID,this.collectionId,r,p2.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VZ(t){var e,r;if(pn(t instanceof ma||t instanceof rs),t instanceof ma){if(t instanceof uZ){const a=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(s=>ma.create(t.field,"==",s)))||[];return rs.create(a,"or")}return t}const n=t.filters.map(a=>VZ(a));return rs.create(n,t.op)}function y1e(t){if(t.getFilters().length===0)return[];const e=ok(VZ(t));return pn(HZ(e)),sk(e)||ik(e)?[e]:e.getFilters()}function sk(t){return t instanceof ma}function ik(t){return t instanceof rs&&JD(t)}function HZ(t){return sk(t)||ik(t)||function(r){if(r instanceof rs&&YB(r)){for(const n of r.getFilters())if(!sk(n)&&!ik(n))return!1;return!0}return!1}(t)}function ok(t){if(pn(t instanceof ma||t instanceof rs),t instanceof ma)return t;if(t.filters.length===1)return ok(t.filters[0]);const e=t.filters.map(n=>ok(n));let r=rs.create(e,t.op);return r=hS(r),HZ(r)?r:(pn(r instanceof rs),pn(Ov(r)),pn(r.filters.length>1),r.filters.reduce((n,a)=>o6(n,a)))}function o6(t,e){let r;return pn(t instanceof ma||t instanceof rs),pn(e instanceof ma||e instanceof rs),r=t instanceof ma?e instanceof ma?function(a,s){return rs.create([a,s],"and")}(t,e):r9(t,e):e instanceof ma?r9(e,t):function(a,s){if(pn(a.filters.length>0&&s.filters.length>0),Ov(a)&&Ov(s))return oZ(a,s.getFilters());const o=YB(a)?a:s,l=YB(a)?s:a,c=o.filters.map(u=>o6(u,l));return rs.create(c,"or")}(t,e),hS(r)}function r9(t,e){if(Ov(e))return oZ(e,t.getFilters());{const r=e.filters.map(n=>o6(t,n));return rs.create(r,"or")}}function hS(t){if(pn(t instanceof ma||t instanceof rs),t instanceof ma)return t;const e=t.getFilters();if(e.length===1)return hS(e[0]);if(sZ(t))return t;const r=e.map(a=>hS(a)),n=[];return r.forEach(a=>{a instanceof ma?n.push(a):a instanceof rs&&(a.op===t.op?n.push(...a.filters):n.push(a))}),n.length===1?n[0]:rs.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1e{constructor(){this.un=new l6}addToCollectionParentIndex(e,r){return this.un.add(r),Zt.resolve()}getCollectionParents(e,r){return Zt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Zt.resolve()}deleteFieldIndex(e,r){return Zt.resolve()}deleteAllFieldIndexes(e){return Zt.resolve()}createTargetIndexes(e,r){return Zt.resolve()}getDocumentsMatchingTarget(e,r){return Zt.resolve(null)}getIndexType(e,r){return Zt.resolve(0)}getFieldIndexes(e,r){return Zt.resolve([])}getNextCollectionGroupToUpdate(e){return Zt.resolve(null)}getMinOffset(e,r){return Zt.resolve(Vu.min())}getMinOffsetFromCollectionGroup(e,r){return Zt.resolve(Vu.min())}updateCollectionGroup(e,r,n){return Zt.resolve()}updateIndexEntries(e,r){return Zt.resolve()}}class l6{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new ds(Ba.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new ds(Ba.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC=new Uint8Array(0);class w1e{constructor(e,r){this.databaseId=r,this.cn=new l6,this.ln=new Vm(n=>ug(n),(n,a)=>Iw(n,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),a=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const s={collectionId:n,parent:Bc(a)};return n9(e).put(s)}return Zt.resolve()}getCollectionParents(e,r){const n=[],a=IDBKeyRange.bound([r,""],[$J(r),""],!1,!0);return n9(e).U(a).next(s=>{for(const o of s){if(o.collectionId!==r)break;n.push(Jf(o.parent))}return n})}addFieldIndex(e,r){const n=cy(e),a=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete a.indexId;const s=n.add(a);if(r.indexState){const o=ax(e);return s.next(l=>{o.put(X7(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return s.next()}deleteFieldIndex(e,r){const n=cy(e),a=ax(e),s=nx(e);return n.delete(r.indexId).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=cy(e),n=nx(e),a=ax(e);return r.j().next(()=>n.j()).next(()=>a.j())}createTargetIndexes(e,r){return Zt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(a=>{if(a===0||a===1){const s=new t9(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,r){const n=nx(e);let a=!0;const s=new Map;return Zt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{a&&(a=!!l),s.set(o,l)})).next(()=>{if(a){let o=na();const l=[];return Zt.forEach(s,(c,u)=>{Or("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(w=>`${w.fieldPath}:${w.kind}`).join(",")}`}(c)} to execute ${ug(r)}`);const d=function(b,w){const I=qB(w);if(I===void 0)return null;for(const j of uS(b,I.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(u,c),f=function(b,w){const I=new Map;for(const j of fp(w))for(const C of uS(b,j.fieldPath))switch(C.op){case"==":case"in":I.set(j.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return I.set(j.fieldPath.canonicalString(),C.value),Array.from(I.values())}return null}(u,c),A=function(b,w){const I=[];let j=!0;for(const C of fp(w)){const S=C.kind===0?O7(b,C.fieldPath,b.startAt):D7(b,C.fieldPath,b.startAt);I.push(S.value),j&&(j=S.inclusive)}return new Fv(I,j)}(u,c),h=function(b,w){const I=[];let j=!0;for(const C of fp(w)){const S=C.kind===0?D7(b,C.fieldPath,b.endAt):O7(b,C.fieldPath,b.endAt);I.push(S.value),j&&(j=S.inclusive)}return new Fv(I,j)}(u,c),m=this.In(c,u,A),p=this.In(c,u,h),x=this.Tn(c,u,f),v=this.En(c.indexId,d,m,A.inclusive,p,h.inclusive,x);return Zt.forEach(v,y=>n.G(y,r.limit).next(b=>{b.forEach(w=>{const I=Xr.fromSegments(w.documentKey);o.has(I)||(o=o.add(I),l.push(I))})}))}).next(()=>l)}return Zt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=y1e(rs.create(e.filters,"and")).map(n=>ZB(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,a,s,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,s.length),u=c/(r!=null?r.length:1),d=[];for(let f=0;f<c;++f){const A=r?this.dn(r[f/u]):sC,h=this.An(e,A,n[f%u],a),m=this.Rn(e,A,s[f%u],o),p=l.map(x=>this.An(e,A,x,!0));d.push(...this.createRange(h,m,p))}return d}An(e,r,n,a){const s=new wp(e,Xr.empty(),r,n);return a?s:s.Zt()}Rn(e,r,n,a){const s=new wp(e,Xr.empty(),r,n);return a?s.Zt():s}Pn(e,r){const n=new t9(r),a=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,a).next(s=>{let o=null;for(const l of s)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const a=this.hn(r);return Zt.forEach(a,s=>this.Pn(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let u=new ds(Ks.comparator),d=!1;for(const f of c.filters)for(const A of f.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?d=!0:u=u.add(A.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&a.length>1&&n===2?1:n)}Vn(e,r){const n=new ly;for(const a of fp(e)){const s=r.data.field(a.fieldPath);if(s==null)return null;const o=n.Yt(a.kind);bp.vt.It(s,o)}return n.zt()}dn(e){const r=new ly;return bp.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new ly;return bp.vt.It(y2(this.databaseId,r),n.Yt(function(s){const o=fp(s);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let a=[];a.push(new ly);let s=0;for(const o of fp(e)){const l=n[s++];for(const c of a)if(this.fn(r,o.fieldPath)&&b2(l))a=this.gn(a,o,l);else{const u=c.Yt(o.kind);bp.vt.It(l,u)}}return this.pn(a)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const a=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of a){const c=new ly;c.seed(l.zt()),bp.vt.It(o,c.Yt(r.kind)),s.push(c)}return s}fn(e,r){return!!e.filters.find(n=>n instanceof ma&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=cy(e),a=ax(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(s=>{const o=[];return Zt.forEach(s,l=>a.get([l.indexId,this.uid]).next(c=>{o.push(function(d,f){const A=f?new p2(f.sequenceNumber,new Vu(hg(f.readTime),new Xr(Jf(f.documentKey)),f.largestBatchId)):p2.empty(),h=d.fields.map(([m,p])=>new iE(Ks.fromServerFormat(m),p));return new lS(d.indexId,d.collectionGroup,h,A)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:zn(n.collectionGroup,a.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const a=cy(e),s=ax(e);return this.yn(e).next(o=>a.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>Zt.forEach(l,c=>s.put(X7(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return Zt.forEach(r,(a,s)=>{const o=n.get(a.collectionGroup);return(o?Zt.resolve(o):this.getFieldIndexes(e,a.collectionGroup)).next(l=>(n.set(a.collectionGroup,l),Zt.forEach(l,c=>this.wn(e,a,c).next(u=>{const d=this.Sn(s,c);return u.isEqual(d)?Zt.resolve():this.bn(e,s,c,u,d)}))))})}Dn(e,r,n,a){return nx(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,a){return nx(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const a=nx(e);let s=new ds(u0);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{s=s.add(new wp(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,r){let n=new ds(u0);const a=this.Vn(r,e);if(a==null)return n;const s=qB(r);if(s!=null){const o=e.data.field(s.fieldPath);if(b2(o))for(const l of o.arrayValue.values||[])n=n.add(new wp(r.indexId,e.key,this.dn(l),a))}else n=n.add(new wp(r.indexId,e.key,sC,a));return n}bn(e,r,n,a,s){Or("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,u,d,f,A){const h=c.getIterator(),m=u.getIterator();let p=rx(h),x=rx(m);for(;p||x;){let v=!1,y=!1;if(p&&x){const b=d(p,x);b<0?y=!0:b>0&&(v=!0)}else p!=null?y=!0:v=!0;v?(f(x),x=rx(m)):y?(A(p),p=rx(h)):(p=rx(h),x=rx(m))}}(a,s,u0,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),Zt.waitFor(o)}yn(e){let r=1;return ax(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,a,s)=>{s.done(),r=a.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>u0(o,l)).filter((o,l,c)=>!l||u0(o,c[l-1])!==0);const a=[];a.push(e);for(const o of n){const l=u0(o,e),c=u0(o,r);if(l===0)a[0]=e.Zt();else if(l>0&&c<0)a.push(o),a.push(o.Zt());else if(c>0)break}a.push(r);const s=[];for(let o=0;o<a.length;o+=2){if(this.Cn(a[o],a[o+1]))return[];const l=[a[o].indexId,this.uid,a[o].arrayValue,a[o].directionalValue,sC,[]],c=[a[o+1].indexId,this.uid,a[o+1].arrayValue,a[o+1].directionalValue,sC,[]];s.push(IDBKeyRange.bound(l,c))}return s}Cn(e,r){return u0(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(a9)}getMinOffset(e,r){return Zt.mapArray(this.hn(r),n=>this.Pn(e,n).next(a=>a||un())).next(a9)}}function n9(t){return Ro(t,"collectionParents")}function nx(t){return Ro(t,"indexEntries")}function cy(t){return Ro(t,"indexConfiguration")}function ax(t){return Ro(t,"indexState")}function a9(t){pn(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const a=t[n].indexState.offset;qD(a,e)<0&&(e=a),r<a.largestBatchId&&(r=a.largestBatchId)}return new Vu(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s9={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Jc{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Jc(e,Jc.DEFAULT_COLLECTION_PERCENTILE,Jc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $Z(t,e,r){const n=t.store("mutations"),a=t.store("documentMutations"),s=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(d,f,A)=>(l++,A.delete()));s.push(c.next(()=>{pn(l===1)}));const u=[];for(const d of r.mutations){const f=WJ(e,d.key.path,r.batchId);s.push(a.delete(f)),u.push(d.key)}return Zt.waitFor(s).next(()=>u)}function AS(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw un();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jc.DEFAULT_COLLECTION_PERCENTILE=10,Jc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jc.DEFAULT=new Jc(41943040,Jc.DEFAULT_COLLECTION_PERCENTILE,Jc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jc.DISABLED=new Jc(-1,0,0);class TI{constructor(e,r,n,a){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=a,this.Fn={}}static lt(e,r,n,a){pn(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new TI(s,r,n,a)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return d0(e).J({index:"userMutationsIndex",range:n},(a,s,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,a){const s=Px(e),o=d0(e);return o.add({}).next(l=>{pn(typeof l=="number");const c=new r6(l,r,n,a),u=function(h,m,p){const x=p.baseMutations.map(y=>_2(h.ct,y)),v=p.mutations.map(y=>_2(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:v}}(this.serializer,this.userId,c),d=[];let f=new ds((A,h)=>zn(A.canonicalString(),h.canonicalString()));for(const A of a){const h=WJ(this.userId,A.key.path,l);f=f.add(A.key.path.popLast()),d.push(o.put(u)),d.push(s.put(h,nve))}return f.forEach(A=>{d.push(this.indexManager.addToCollectionParentIndex(e,A))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Zt.waitFor(d).next(()=>c)})}lookupMutationBatch(e,r){return d0(e).get(r).next(n=>n?(pn(n.userId===this.userId),yp(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?Zt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const a=n.keys();return this.Fn[r]=a,a}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return d0(e).J({index:"userMutationsIndex",range:a},(o,l,c)=>{l.userId===this.userId&&(pn(l.batchId>=n),s=yp(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return d0(e).J({index:"userMutationsIndex",range:r,reverse:!0},(a,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return d0(e).U("userMutationsIndex",r).next(n=>n.map(a=>yp(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=oE(this.userId,r.path),a=IDBKeyRange.lowerBound(n),s=[];return Px(e).J({range:a},(o,l,c)=>{const[u,d,f]=o,A=Jf(d);if(u===this.userId&&r.path.isEqual(A))return d0(e).get(f).next(h=>{if(!h)throw un();pn(h.userId===this.userId),s.push(yp(this.serializer,h))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ds(zn);const a=[];return r.forEach(s=>{const o=oE(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=Px(e).J({range:l},(u,d,f)=>{const[A,h,m]=u,p=Jf(h);A===this.userId&&s.path.isEqual(p)?n=n.add(m):f.done()});a.push(c)}),Zt.waitFor(a).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1,s=oE(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new ds(zn);return Px(e).J({range:o},(c,u,d)=>{const[f,A,h]=c,m=Jf(A);f===this.userId&&n.isPrefixOf(m)?m.length===a&&(l=l.add(h)):d.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],a=[];return r.forEach(s=>{a.push(d0(e).get(s).next(o=>{if(o===null)throw un();pn(o.userId===this.userId),n.push(yp(this.serializer,o))}))}),Zt.waitFor(a).next(()=>n)}removeMutationBatch(e,r){return $Z(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),Zt.forEach(n,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Zt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),a=[];return Px(e).J({range:n},(s,o,l)=>{if(s[0]===this.userId){const c=Jf(s[1]);a.push(c)}else l.done()}).next(()=>{pn(a.length===0)})})}containsKey(e,r){return GZ(e,this.userId,r)}Nn(e){return KZ(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function GZ(t,e,r){const n=oE(e,r.path),a=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return Px(t).J({range:s,H:!0},(l,c,u)=>{const[d,f,A]=l;d===e&&f===a&&(o=!0),u.done()}).next(()=>o)}function d0(t){return Ro(t,"mutations")}function Px(t){return Ro(t,"documentMutations")}function KZ(t){return Ro(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ag(0)}static kn(){return new Ag(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1e{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new Ag(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>Nn.fromTimestamp(new yr(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(a=>(a.highestListenSequenceNumber=r,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),r>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=r),this.Qn(e,a)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>sx(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(pn(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let a=0;const s=[];return sx(e).J((o,l)=>{const c=Gy(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(a++,s.push(this.removeTargetData(e,c)))}).next(()=>Zt.waitFor(s)).next(()=>a)}forEachTarget(e,r){return sx(e).J((n,a)=>{const s=Gy(a);r(s)})}qn(e){return i9(e).get("targetGlobalKey").next(r=>(pn(r!==null),r))}Qn(e,r){return i9(e).put("targetGlobalKey",r)}Kn(e,r){return sx(e).put(UZ(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=ug(r),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return sx(e).J({range:a,index:"queryTargetsIndex"},(o,l,c)=>{const u=Gy(l);Iw(r,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,r,n){const a=[],s=U0(e);return r.forEach(o=>{const l=Bc(o.path);a.push(s.put({targetId:n,path:l})),a.push(this.referenceDelegate.addReference(e,n,o))}),Zt.waitFor(a)}removeMatchingKeys(e,r,n){const a=U0(e);return Zt.forEach(r,s=>{const o=Bc(s.path);return Zt.waitFor([a.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,r){const n=U0(e),a=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),a=U0(e);let s=na();return a.J({range:n,H:!0},(o,l,c)=>{const u=Jf(o[1]),d=new Xr(u);s=s.add(d)}).next(()=>s)}containsKey(e,r){const n=Bc(r.path),a=IDBKeyRange.bound([n],[$J(n)],!1,!0);let s=0;return U0(e).J({index:"documentTargetsIndex",H:!0,range:a},([o,l],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,r){return sx(e).get(r).next(n=>n?Gy(n):null)}}function sx(t){return Ro(t,"targets")}function i9(t){return Ro(t,"targetGlobal")}function U0(t){return Ro(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o9([t,e],[r,n]){const a=zn(t,r);return a===0?zn(e,n):a}class C1e{constructor(e){this.Un=e,this.buffer=new ds(o9),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();o9(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class _1e{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Or("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Qm(r)?Or("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Fg(r)}await this.Hn(3e5)})}}class E1e{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Zt.resolve(Nd.oe);const n=new C1e(r);return this.Jn.forEachTarget(e,a=>n.zn(a.sequenceNumber)).next(()=>this.Jn.Zn(e,a=>n.zn(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Or("LruGarbageCollector","Garbage collection skipped; disabled"),Zt.resolve(s9)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Or("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),s9):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,a,s,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Or("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),a=this.params.maximumSequenceNumbersToCollect):a=f,o=Date.now(),this.nthSequenceNumber(e,a))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,r))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(u=Date.now(),Ex()<=Aa.DEBUG&&Or("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${a} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Zt.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:f})))}}function S1e(t,e){return new E1e(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1e{constructor(e,r){this.db=e,this.garbageCollector=S1e(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,a)=>r(a))}addReference(e,r,n){return iC(e,n)}removeReference(e,r,n){return iC(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return iC(e,r)}nr(e,r){return function(a,s){let o=!1;return KZ(a).Y(l=>GZ(a,l,s).next(c=>(c&&(o=!0),Zt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(u=>{if(!u)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,Nn.min()),U0(e).delete(function(f){return[0,Bc(f.path)]}(o))))});a.push(c)}}).next(()=>Zt.waitFor(a)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return iC(e,r)}tr(e,r){const n=U0(e);let a,s=Nd.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{o===0?(s!==Nd.oe&&r(new Xr(Jf(a)),s),s=u,a=c):s=Nd.oe}).next(()=>{s!==Nd.oe&&r(new Xr(Jf(a)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function iC(t,e){return U0(t).put(function(n,a){return{targetId:0,path:Bc(n.path),sequenceNumber:a}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qZ{constructor(){this.changes=new Vm(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Gs.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Zt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Zm(e).put(n)}removeEntry(e,r,n){return Zm(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],fS(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=Gs.newInvalidDocument(r);return Zm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(uy(r))},(a,s)=>{n=this.ir(r,s)}).next(()=>n)}sr(e,r){let n={size:0,document:Gs.newInvalidDocument(r)};return Zm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(uy(r))},(a,s)=>{n={document:this.ir(r,s),size:AS(s)}}).next(()=>n)}getEntries(e,r){let n=Ou();return this._r(e,r,(a,s)=>{const o=this.ir(a,s);n=n.insert(a,o)}).next(()=>n)}ar(e,r){let n=Ou(),a=new Ys(Xr.comparator);return this._r(e,r,(s,o)=>{const l=this.ir(s,o);n=n.insert(s,l),a=a.insert(s,AS(o))}).next(()=>({documents:n,ur:a}))}_r(e,r,n){if(r.isEmpty())return Zt.resolve();let a=new ds(u9);r.forEach(c=>a=a.add(c));const s=IDBKeyRange.bound(uy(a.first()),uy(a.last())),o=a.getIterator();let l=o.getNext();return Zm(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{const f=Xr.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&u9(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,u),l=o.hasNext()?o.getNext():null),l?d.$(uy(l)):d.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,a,s){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),fS(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Zm(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=Ou();for(const f of u){const A=this.ir(Xr.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);A.isFoundDocument()&&(Tw(r,A)||a.has(A.key))&&(d=d.insert(A.key,A))}return d})}getAllFromCollectionGroup(e,r,n,a){let s=Ou();const o=c9(r,n),l=c9(r,Vu.max());return Zm(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const f=this.ir(Xr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===a&&d.done()}).next(()=>s)}newChangeBuffer(e){return new P1e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return l9(e).get("remoteDocumentGlobalKey").next(r=>(pn(!!r),r))}rr(e,r){return l9(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=h1e(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(Nn.min())))return n}return Gs.newInvalidDocument(e)}}function zZ(t){return new I1e(t)}class P1e extends qZ{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new Vm(n=>n.toString(),(n,a)=>n.isEqual(a))}applyChanges(e){const r=[];let n=0,a=new ds((s,o)=>zn(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(r.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=z7(this.cr.serializer,o);a=a.add(s.path.popLast());const u=AS(c);n+=u-l.size,r.push(this.cr.addEntry(e,s,c))}else if(n-=l.size,this.trackRemovals){const c=z7(this.cr.serializer,o.convertToNoDocument(Nn.min()));r.push(this.cr.addEntry(e,s,c))}}),a.forEach(s=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),r.push(this.cr.updateMetadata(e,n)),Zt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:a})=>(a.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function l9(t){return Ro(t,"remoteDocumentGlobal")}function Zm(t){return Ro(t,"remoteDocumentsV14")}function uy(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function c9(t,e){const r=e.documentKey.path.toArray();return[t,fS(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function u9(t,e){const r=t.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<r.length-2&&s<n.length-2;++s)if(a=zn(r[s],n[s]),a)return a;return a=zn(r.length,n.length),a||(a=zn(r[r.length-2],n[n.length-2]),a||zn(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WZ{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&wb(n.mutation,a,nu.empty(),yr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,na()).next(()=>n))}getLocalViewOfDocuments(e,r,n=na()){const a=Zf();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(s=>{let o=Hy();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Zf();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,na()))}populateOverlays(e,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,a){let s=Ou();const o=bb(),l=function(){return bb()}();return r.forEach((c,u)=>{const d=n.get(u.key);a.has(u.key)&&(d===void 0||d.mutation instanceof RA)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),wb(d.mutation,u,d.mutation.getFieldMask(),yr.now())):o.set(u.key,nu.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),r.forEach((u,d)=>{var f;return l.set(u,new T1e(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=bb();let a=new Ys((o,l)=>o-l),s=na();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||nu.empty();d=l.applyToLocalView(u,d),n.set(c,d);const f=(a.get(l.batchId)||na()).add(c);a=a.insert(l.batchId,f)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=pZ();d.forEach(A=>{if(!s.has(A)){const h=wZ(r.get(A),n.get(A));h!==null&&f.set(A,h),s=s.add(A)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Zt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(o){return Xr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):dZ(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(s=>{const o=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-s.size):Zt.resolve(Zf());let l=-1,c=s;return o.next(u=>Zt.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(d)?Zt.resolve():this.remoteDocumentCache.getEntry(e,d).next(A=>{c=c.insert(d,A)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,na())).next(d=>({batchId:l,changes:mZ(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Xr(r)).next(n=>{let a=Hy();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const s=r.collectionGroup;let o=Hy();return this.indexManager.getCollectionParents(e,s).next(l=>Zt.forEach(l,c=>{const u=function(f,A){return new d1(A,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,a).next(d=>{d.forEach((f,A)=>{o=o.insert(f,A)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,a))).next(o=>{s.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Gs.newInvalidDocument(d)))});let l=Hy();return o.forEach((c,u)=>{const d=s.get(c);d!==void 0&&wb(d.mutation,u,nu.empty(),yr.now()),Tw(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1e{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Zt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:nl(a.createTime)}}(r)),Zt.resolve()}getNamedQuery(e,r){return Zt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(a){return{name:a.name,query:QZ(a.bundledQuery),readTime:nl(a.readTime)}}(r)),Zt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1e{constructor(){this.overlays=new Ys(Xr.comparator),this.Ir=new Map}getOverlay(e,r){return Zt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Zf();return Zt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,s)=>{this.ht(e,r,s)}),Zt.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Zt.resolve()}getOverlaysForCollection(e,r,n){const a=Zf(),s=r.length+1,o=new Xr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>n&&a.set(c.getKey(),c)}return Zt.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let s=new Ys((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=s.get(u.largestBatchId);d===null&&(d=Zf(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Zf(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=a)););return Zt.resolve(l)}ht(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new a6(r,n));let s=this.Ir.get(r);s===void 0&&(s=na(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1e{constructor(){this.sessionToken=Xi.EMPTY_BYTE_STRING}getSessionToken(e){return Zt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Zt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(){this.Tr=new ds(Wo.Er),this.dr=new ds(Wo.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Wo(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Wo(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Xr(new Ba([])),n=new Wo(r,e),a=new Wo(r,e+1),s=[];return this.dr.forEachInRange([n,a],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Xr(new Ba([])),n=new Wo(r,e),a=new Wo(r,e+1);let s=na();return this.dr.forEachInRange([n,a],o=>{s=s.add(o.key)}),s}containsKey(e){const r=new Wo(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Wo{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Xr.comparator(e.key,r.key)||zn(e.wr,r.wr)}static Ar(e,r){return zn(e.wr,r.wr)||Xr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new ds(Wo.Er)}checkEmpty(e){return Zt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new r6(s,r,n,a);this.mutationQueue.push(o);for(const l of a)this.br=this.br.add(new Wo(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Zt.resolve(o)}lookupMutationBatch(e,r){return Zt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.vr(n),s=a<0?0:a;return Zt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Zt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Zt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Wo(r,0),a=new Wo(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,a],o=>{const l=this.Dr(o.wr);s.push(l)}),Zt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ds(zn);return r.forEach(a=>{const s=new Wo(a,0),o=new Wo(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),Zt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let s=n;Xr.isDocumentKey(s)||(s=s.child(""));const o=new Wo(new Xr(s),0);let l=new ds(zn);return this.br.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===a&&(l=l.add(c.wr)),!0)},o),Zt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const a=this.Dr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){pn(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Zt.forEach(r.mutations,a=>{const s=new Wo(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Wo(r,0),a=this.br.firstAfterOrEqual(n);return Zt.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Zt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1e{constructor(e){this.Mr=e,this.docs=function(){return new Ys(Xr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Zt.resolve(n?n.document.mutableCopy():Gs.newInvalidDocument(r))}getEntries(e,r){let n=Ou();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():Gs.newInvalidDocument(a))}),Zt.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let s=Ou();const o=r.path,l=new Xr(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||qD(GJ(d),n)<=0||(a.has(d.key)||Tw(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Zt.resolve(s)}getAllFromCollectionGroup(e,r,n,a){un()}Or(e,r){return Zt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new R1e(this)}getSize(e){return Zt.resolve(this.size)}}class R1e extends qZ{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)}),Zt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1e{constructor(e){this.persistence=e,this.Nr=new Vm(r=>ug(r),Iw),this.lastRemoteSnapshotVersion=Nn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new c6,this.targetCount=0,this.kr=Ag.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,a)=>r(a)),Zt.resolve()}getLastRemoteSnapshotVersion(e){return Zt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Zt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Zt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Zt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ag(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Zt.resolve()}updateTargetData(e,r){return this.Kn(r),Zt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Zt.resolve()}removeTargets(e,r,n){let a=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)}),Zt.waitFor(s).next(()=>a)}getTargetCount(e){return Zt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Zt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Zt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(o=>{s.push(a.markPotentiallyOrphaned(e,o))}),Zt.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Zt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Zt.resolve(n)}containsKey(e,r){return Zt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XZ{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Nd(0),this.Kr=!1,this.Kr=!0,this.$r=new F1e,this.referenceDelegate=e(this),this.Ur=new M1e(this),this.indexManager=new b1e,this.remoteDocumentCache=function(a){return new D1e(a)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new LZ(r),this.Gr=new B1e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new k1e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new O1e(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Or("MemoryPersistence","Starting transaction:",e);const a=new L1e(this.Qr.next());return this.referenceDelegate.zr(),n(a).next(s=>this.referenceDelegate.jr(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Hr(e,r){return Zt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class L1e extends qJ{constructor(e){super(),this.currentSequenceNumber=e}}class BI{constructor(e){this.persistence=e,this.Jr=new c6,this.Yr=null}static Zr(e){return new BI(e)}get Xr(){if(this.Yr)return this.Yr;throw un()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Zt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Zt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Zt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(a=>this.Xr.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Zt.forEach(this.Xr,n=>{const a=Xr.fromPath(n);return this.ei(e,a).next(s=>{s||r.removeEntry(a,Nn.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Zt.or([()=>Zt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1e{constructor(e){this.serializer=e}O(e,r,n,a){const s=new CI("createOrUpgrade",r);n<1&&a>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",C7,{unique:!0}),c.createObjectStore("documentMutations")}(e),d9(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=Zt.resolve();return n<3&&a>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),d9(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Nn.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),n<4&&a>=4&&(n!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",C7,{unique:!0});const f=u.store("mutations"),A=d.map(h=>f.put(h));return Zt.waitFor(A)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&a>=5&&(o=o.next(()=>this.ni(s))),n<6&&a>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&a>=7&&(o=o.next(()=>this.ii(s))),n<8&&a>=8&&(o=o.next(()=>this.si(e,s))),n<9&&a>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&a>=10&&(o=o.next(()=>this.oi(s))),n<11&&a>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&a>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:mve});u.createIndex("collectionPathOverlayIndex",pve,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",gve,{unique:!1})})(e)})),n<13&&a>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:ave});u.createIndex("documentKeyIndex",sve),u.createIndex("collectionGroupIndex",ive)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&a>=14&&(o=o.next(()=>this.ai(e,s))),n<15&&a>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:dve}).createIndex("sequenceNumberIndex",fve,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:hve}).createIndex("documentKeyIndex",Ave,{unique:!1})}(e))),n<16&&a>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&a>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,a)=>{r+=AS(a)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(a=>Zt.forEach(a,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>Zt.forEach(l,c=>{pn(c.userId===s.userId);const u=yp(this.serializer,c);return $Z(e,s.userId,u).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const s=[];return n.J((o,l)=>{const c=new Ba(o),u=function(f){return[0,Bc(f)]}(c);s.push(r.get(u).next(d=>d?Zt.resolve():(f=>r.put({targetId:0,path:Bc(f),sequenceNumber:a.highestListenSequenceNumber}))(c)))}).next(()=>Zt.waitFor(s))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:uve});const n=r.store("collectionParents"),a=new l6,s=o=>{if(a.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:Bc(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new Ba(o);return s(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],u)=>{const d=Jf(l);return s(d.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,a)=>{const s=Gy(a),o=UZ(this.serializer,s);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),a=[];return n.J((s,o)=>{const l=r.store("remoteDocumentsV14"),c=function(f){return f.document?new Xr(Ba.fromString(f.document.name).popFirst(5)):f.noDocument?Xr.fromSegments(f.noDocument.path):f.unknownDocument?Xr.fromSegments(f.unknownDocument.path):un()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};a.push(l.put(u))}).next(()=>Zt.waitFor(a))}ai(e,r){const n=r.store("mutations"),a=zZ(this.serializer),s=new XZ(BI.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:na();yp(this.serializer,c).keys().forEach(f=>d=d.add(f)),l.set(c.userId,d)}),Zt.forEach(l,(c,u)=>{const d=new _l(u),f=PI.lt(this.serializer,d),A=s.getIndexManager(d),h=TI.lt(d,this.serializer,A,s.referenceDelegate);return new WZ(a,h,f,A).recalculateAndSaveOverlaysForDocumentKeys(new zB(r,Nd.oe),c).next()})})}}function d9(t){t.createObjectStore("targetDocuments",{keyPath:lve}).createIndex("documentTargetsIndex",cve,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ove,{unique:!0}),t.createObjectStore("targetGlobal")}const j4="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class u6{constructor(e,r,n,a,s,o,l,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=s,this.window=o,this.document=l,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=A=>Promise.resolve(),!u6.D())throw new Hr(hr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new j1e(this,a),this.Ai=r+"main",this.serializer=new LZ(c),this.Ri=new fm(this.Ai,this.hi,new U1e(this.serializer)),this.$r=new m1e,this.Ur=new N1e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=zZ(this.serializer),this.Gr=new A1e,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&jc("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Hr(hr.FAILED_PRECONDITION,j4);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Nd(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>oC(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(Qm(e))return Or("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Or("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return dy(e).get("owner").next(r=>Zt.resolve(this.vi(r)))}Ci(e){return oC(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=Ro(r,"clientMetadata");return n.U().next(a=>{const s=this.xi(a,18e5),o=a.filter(l=>s.indexOf(l)===-1);return Zt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Zt.resolve(!0):dy(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Hr(hr.FAILED_PRECONDITION,j4);return!1}}return!(!this.networkEnabled||!this.inForeground)||oC(e).U().next(n=>this.xi(n,5e3).find(a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,o=!this.inForeground&&a.inForeground,l=this.networkEnabled===a.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Or("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new zB(e,Nd.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>oC(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return TI.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new w1e(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return PI.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Or("IndexedDbPersistence","Starting transaction:",e);const a=r==="readonly"?"readonly":"readwrite",s=function(c){return c===17?yve:c===16?vve:c===15?WD:c===14?JJ:c===13?YJ:c===12?xve:c===11?XJ:void un()}(this.hi);let o;return this.Ri.runTransaction(e,a,s,l=>(o=new zB(l,this.Qr?this.Qr.next():Nd.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw jc(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Hr(hr.FAILED_PRECONDITION,KJ);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return dy(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Hr(hr.FAILED_PRECONDITION,j4)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return dy(e).put("owner",r)}static D(){return fm.D()}bi(e){const r=dy(e);return r.get("owner").next(n=>this.vi(n)?(Or("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):Zt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(jc(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;XY()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Or("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return jc("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){jc("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function dy(t){return Ro(t,"owner")}function oC(t){return Ro(t,"clientMetadata")}function Q1e(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=a}static Wi(e,r){let n=na(),a=na();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new d6(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YZ{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return XY()?8:zJ(Oo())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,a){const s={result:null};return this.Yi(e,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,r,a,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new V1e;return this.Xi(e,r,o).next(l=>{if(s.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>s.result)}es(e,r,n,a){return n.documentReadCount<this.ji?(Ex()<=Aa.DEBUG&&Or("QueryEngine","SDK will not create cache indexes for query:",Sx(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Zt.resolve()):(Ex()<=Aa.DEBUG&&Or("QueryEngine","Query:",Sx(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(Ex()<=Aa.DEBUG&&Or("QueryEngine","The SDK decides to create cache indexes for query:",Sx(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Id(r))):Zt.resolve())}Yi(e,r){if(R7(r))return Zt.resolve(null);let n=Id(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=dS(r,null,"F"),n=Id(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=na(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.ts(r,l);return this.ns(r,u,o,c.readTime)?this.Yi(e,dS(r,null,"F")):this.rs(e,u,r,c)}))})))}Zi(e,r,n,a){return R7(r)||a.isEqual(Nn.min())?Zt.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,a)?Zt.resolve(null):(Ex()<=Aa.DEBUG&&Or("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Sx(r)),this.rs(e,o,r,Xxe(a,-1)).next(l=>l))})}ts(e,r){let n=new ds(hZ(e));return r.forEach((a,s)=>{Tw(e,s)&&(n=n.add(s))}),n}ns(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Xi(e,r,n){return Ex()<=Aa.DEBUG&&Or("QueryEngine","Using full collection scan to execute query:",Sx(r)),this.Ji.getDocumentsMatchingQuery(e,r,Vu.min(),n)}rs(e,r,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1e{constructor(e,r,n,a){this.persistence=e,this.ss=r,this.serializer=a,this.os=new Ys(zn),this._s=new Vm(s=>ug(s),Iw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WZ(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function JZ(t,e,r,n){return new H1e(t,e,r,n)}async function ZZ(t,e){const r=Un(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let c=na();for(const u of a){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of s){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function $1e(t,e){const r=Un(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,A=f.keys();let h=Zt.resolve();return A.forEach(m=>{h=h.next(()=>d.getEntry(c,m)).next(p=>{const x=u.docVersions.get(m);pn(x!==null),p.version.compareTo(x)<0&&(f.applyToRemoteDocument(p,u),p.isValidDocument()&&(p.setReadTime(u.commitVersion),d.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=na();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function eee(t){const e=Un(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function G1e(t,e){const r=Un(t),n=e.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const l=[];e.targetChanges.forEach((d,f)=>{const A=a.get(f);if(!A)return;l.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,f)));let h=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?h=h.withResumeToken(Xi.EMPTY_BYTE_STRING,Nn.min()).withLastLimboFreeSnapshotVersion(Nn.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,n)),a=a.insert(f,h),function(p,x,v){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(A,h,d)&&l.push(r.Ur.updateTargetData(s,h))});let c=Ou(),u=na();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),l.push(K1e(s,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!n.isEqual(Nn.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(f=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(d)}return Zt.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(r.os=a,s))}function K1e(t,e,r){let n=na(),a=na();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let o=Ou();return r.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(a=a.add(l)),c.isNoDocument()&&c.version.isEqual(Nn.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Or("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:a}})}function q1e(t,e){const r=Un(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function z1e(t,e){const r=Un(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Ur.getTargetData(n,e).next(s=>s?(a=s,Zt.resolve(a)):r.Ur.allocateTargetId(n).next(o=>(a=new Yh(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function lk(t,e,r){const n=Un(t),a=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!Qm(o))throw o;Or("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function f9(t,e,r){const n=Un(t);let a=Nn.min(),s=na();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=Un(c),A=f._s.get(d);return A!==void 0?Zt.resolve(f.os.get(A)):f.Ur.getTargetData(u,d)}(n,o,Id(e)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?a:Nn.min(),r?s:na())).next(l=>(W1e(n,Ove(e),l),{documents:l,Ts:s})))}function W1e(t,e,r){let n=t.us.get(e)||Nn.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class h9{constructor(){this.activeTargetIds=Qve()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tee{constructor(){this.so=new h9,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new h9,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1e{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lC=null;function I4(){return lC===null?lC=function(){return 268435456+Math.round(2147483648*Math.random())}():lC++,"0x"+lC.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1e{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vl="WebChannelConnection";class Z1e extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${a}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${s}`}get Fo(){return!1}Mo(r,n,a,s,o){const l=I4(),c=this.xo(r,n.toUriEncodedString());Or("RestConnection",`Sending RPC '${r}' ${l}:`,c,a);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(r,c,u,a).then(d=>(Or("RestConnection",`Received RPC '${r}' ${l}: `,d),d),d=>{throw bm("RestConnection",`RPC '${r}' ${l} failed with error: `,d,"url: ",c,"request:",a),d})}Lo(r,n,a,s,o,l){return this.Mo(r,n,a,s,o)}Oo(r,n,a){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+u1}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),a&&a.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const a=Y1e[r];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,a){const s=I4();return new Promise((o,l)=>{const c=new RJ;c.setWithCredentials(!0),c.listenOnce(MJ.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case sE.NO_ERROR:const d=c.getResponseJson();Or(Vl,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case sE.TIMEOUT:Or(Vl,`RPC '${e}' ${s} timed out`),l(new Hr(hr.DEADLINE_EXCEEDED,"Request time out"));break;case sE.HTTP_ERROR:const f=c.getStatus();if(Or(Vl,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let A=c.getResponseJson();Array.isArray(A)&&(A=A[0]);const h=A==null?void 0:A.error;if(h&&h.status&&h.message){const m=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(hr).indexOf(v)>=0?v:hr.UNKNOWN}(h.status);l(new Hr(m,h.message))}else l(new Hr(hr.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Hr(hr.UNAVAILABLE,"Connection failed."));break;default:un()}}finally{Or(Vl,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(a);Or(Vl,`RPC '${e}' ${s} sending request:`,a),c.send(r,"POST",u,n,15)})}Bo(e,r,n){const a=I4(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=QJ(),l=UJ(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=s.join("");Or(Vl,`Creating RPC '${e}' stream ${a}: ${d}`,c);const f=o.createWebChannel(d,c);let A=!1,h=!1;const m=new J1e({Io:x=>{h?Or(Vl,`Not sending because RPC '${e}' stream ${a} is closed:`,x):(A||(Or(Vl,`Opening RPC '${e}' stream ${a} transport.`),f.open(),A=!0),Or(Vl,`RPC '${e}' stream ${a} sending:`,x),f.send(x))},To:()=>f.close()}),p=(x,v,y)=>{x.listen(v,b=>{try{y(b)}catch(w){setTimeout(()=>{throw w},0)}})};return p(f,Vy.EventType.OPEN,()=>{h||(Or(Vl,`RPC '${e}' stream ${a} transport opened.`),m.yo())}),p(f,Vy.EventType.CLOSE,()=>{h||(h=!0,Or(Vl,`RPC '${e}' stream ${a} transport closed`),m.So())}),p(f,Vy.EventType.ERROR,x=>{h||(h=!0,bm(Vl,`RPC '${e}' stream ${a} transport errored:`,x),m.So(new Hr(hr.UNAVAILABLE,"The operation could not be completed")))}),p(f,Vy.EventType.MESSAGE,x=>{var v;if(!h){const y=x.data[0];pn(!!y);const b=y,w=b.error||((v=b[0])===null||v===void 0?void 0:v.error);if(w){Or(Vl,`RPC '${e}' stream ${a} received error:`,w);const I=w.status;let j=function(E){const B=no[E];if(B!==void 0)return _Z(B)}(I),C=w.message;j===void 0&&(j=hr.INTERNAL,C="Unknown error status: "+I+" with message "+w.message),h=!0,m.So(new Hr(j,C)),f.close()}else Or(Vl,`RPC '${e}' stream ${a} received:`,y),m.bo(y)}}),p(l,LJ.STAT_EVENT,x=>{x.stat===KB.PROXY?Or(Vl,`RPC '${e}' stream ${a} detected buffering proxy`):x.stat===KB.NOPROXY&&Or(Vl,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eye(){return typeof window<"u"?window:null}function fE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(t){return new r1e(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e,r,n=1e3,a=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=a,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,r-n);a>0&&Or("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ree{constructor(e,r,n,a,s,o,l,c){this.ui=e,this.Ho=n,this.Jo=a,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new f6(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===hr.RESOURCE_EXHAUSTED?(jc(r.toString()),jc("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===hr.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.Yo===r&&this.P_(n,a)},n=>{e(()=>{const a=new Hr(hr.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{n(()=>this.I_(a))}),this.stream.onMessage(a=>{n(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Or("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tye extends ree{constructor(e,r,n,a,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=i1e(this.serializer,e),n=function(s){if(!("targetChange"in s))return Nn.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Nn.min():o.readTime?nl(o.readTime):Nn.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=nk(this.serializer),r.addTarget=function(s,o){let l;const c=o.target;if(l=cS(c)?{documents:kZ(s,c)}:{query:FZ(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=jZ(s,o.resumeToken);const u=tk(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Nn.min())>0){l.readTime=Mv(s,o.snapshotVersion.toTimestamp());const u=tk(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=l1e(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=nk(this.serializer),r.removeTarget=e,this.a_(r)}}class rye extends ree{constructor(e,r,n,a,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return pn(!!e.streamToken),this.lastStreamToken=e.streamToken,pn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){pn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=o1e(e.writeResults,e.commitTime),n=nl(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=nk(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>_2(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nye extends class{}{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new Hr(hr.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,rk(r,n),a,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===hr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Hr(hr.UNKNOWN,s.toString())})}Lo(e,r,n,a,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,rk(r,n),a,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===hr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Hr(hr.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class aye{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(jc(r),this.D_=!1):Or("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sye{constructor(e,r,n,a,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{Dg(this)&&(Or("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Un(c);u.L_.add(4),await kw(u),u.q_.set("Unknown"),u.L_.delete(4),await FI(u)}(this))})}),this.q_=new aye(n,a)}}async function FI(t){if(Dg(t))for(const e of t.B_)await e(!0)}async function kw(t){for(const e of t.B_)await e(!1)}function nee(t,e){const r=Un(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),p6(r)?m6(r):A1(r).r_()&&A6(r,e))}function h6(t,e){const r=Un(t),n=A1(r);r.N_.delete(e),n.r_()&&aee(r,e),r.N_.size===0&&(n.r_()?n.o_():Dg(r)&&r.q_.set("Unknown"))}function A6(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Nn.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}A1(t).A_(e)}function aee(t,e){t.Q_.xe(e),A1(t).R_(e)}function m6(t){t.Q_=new Jve({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),A1(t).start(),t.q_.v_()}function p6(t){return Dg(t)&&!A1(t).n_()&&t.N_.size>0}function Dg(t){return Un(t).L_.size===0}function see(t){t.Q_=void 0}async function iye(t){t.q_.set("Online")}async function oye(t){t.N_.forEach((e,r)=>{A6(t,e)})}async function lye(t,e){see(t),p6(t)?(t.q_.M_(e),m6(t)):t.q_.set("Unknown")}async function cye(t,e,r){if(t.q_.set("Online"),e instanceof SZ&&e.state===2&&e.cause)try{await async function(a,s){const o=s.cause;for(const l of s.targetIds)a.N_.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.N_.delete(l),a.Q_.removeTarget(l))}(t,e)}catch(n){Or("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await mS(t,n)}else if(e instanceof dE?t.Q_.Ke(e):e instanceof EZ?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Nn.min()))try{const n=await eee(t.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Xi.EMPTY_BYTE_STRING,d.snapshotVersion)),aee(s,c);const f=new Yh(d.target,c,u,d.sequenceNumber);A6(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Or("RemoteStore","Failed to raise snapshot:",n),await mS(t,n)}}async function mS(t,e,r){if(!Qm(e))throw e;t.L_.add(1),await kw(t),t.q_.set("Offline"),r||(r=()=>eee(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Or("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await FI(t)})}function iee(t,e){return e().catch(r=>mS(t,r,e))}async function Fw(t){const e=Un(t),r=_m(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;uye(e);)try{const a=await q1e(e.localStore,n);if(a===null){e.O_.length===0&&r.o_();break}n=a.batchId,dye(e,a)}catch(a){await mS(e,a)}oee(e)&&lee(e)}function uye(t){return Dg(t)&&t.O_.length<10}function dye(t,e){t.O_.push(e);const r=_m(t);r.r_()&&r.V_&&r.m_(e.mutations)}function oee(t){return Dg(t)&&!_m(t).n_()&&t.O_.length>0}function lee(t){_m(t).start()}async function fye(t){_m(t).p_()}async function hye(t){const e=_m(t);for(const r of t.O_)e.m_(r.mutations)}async function Aye(t,e,r){const n=t.O_.shift(),a=n6.from(n,e,r);await iee(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await Fw(t)}async function mye(t,e){e&&_m(t).V_&&await async function(n,a){if(function(o){return CZ(o)&&o!==hr.ABORTED}(a.code)){const s=n.O_.shift();_m(n).s_(),await iee(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await Fw(n)}}(t,e),oee(t)&&lee(t)}async function m9(t,e){const r=Un(t);r.asyncQueue.verifyOperationInProgress(),Or("RemoteStore","RemoteStore received new credentials");const n=Dg(r);r.L_.add(3),await kw(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await FI(r)}async function pye(t,e){const r=Un(t);e?(r.L_.delete(2),await FI(r)):e||(r.L_.add(2),await kw(r),r.q_.set("Unknown"))}function A1(t){return t.K_||(t.K_=function(r,n,a){const s=Un(r);return s.w_(),new tye(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:iye.bind(null,t),Ro:oye.bind(null,t),mo:lye.bind(null,t),d_:cye.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),p6(t)?m6(t):t.q_.set("Unknown")):(await t.K_.stop(),see(t))})),t.K_}function _m(t){return t.U_||(t.U_=function(r,n,a){const s=Un(r);return s.w_(),new rye(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:fye.bind(null,t),mo:mye.bind(null,t),f_:hye.bind(null,t),g_:Aye.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Fw(t)):(await t.U_.stop(),t.O_.length>0&&(Or("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,r,n,a,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new vf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,s){const o=Date.now()+n,l=new g6(e,r,o,a,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Hr(hr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function x6(t,e){if(jc("AsyncQueue",`${e}: ${t}`),Qm(t))return new Hr(hr.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Xr.comparator(r.key,n.key):(r,n)=>Xr.comparator(r.key,n.key),this.keyedMap=Hy(),this.sortedSet=new Ys(this.comparator)}static emptySet(e){return new Av(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Av)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Av;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(){this.W_=new Ys(Xr.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):un():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Lv{constructor(e,r,n,a,s,o,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,a,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new Lv(e,r,Av.emptySet(r),o,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&EI(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gye{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class xye{constructor(){this.queries=g9(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const a=Un(r),s=a.queries;a.queries=g9(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Hr(hr.ABORTED,"Firestore shutting down"))}}function g9(){return new Vm(t=>fZ(t),EI)}async function v6(t,e){const r=Un(t);let n=3;const a=e.query;let s=r.queries.get(a);s?!s.H_()&&e.J_()&&(n=2):(s=new gye,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(a,!0);break;case 1:s.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const l=x6(o,`Initialization of query '${Sx(e.query)}' failed`);return void e.onError(l)}r.queries.set(a,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&b6(r)}async function y6(t,e){const r=Un(t),n=e.query;let a=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?a=e.J_()?0:1:!s.H_()&&e.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function vye(t,e){const r=Un(t);let n=!1;for(const a of e){const s=a.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(a)&&(n=!0);o.z_=a}}n&&b6(r)}function yye(t,e,r){const n=Un(t),a=n.queries.get(e);if(a)for(const s of a.j_)s.onError(r);n.queries.delete(e)}function b6(t){t.Y_.forEach(e=>{e.next()})}var ck,x9;(x9=ck||(ck={})).ea="default",x9.Cache="cache";class w6{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Lv(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Lv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ck.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cee{constructor(e){this.key=e}}class uee{constructor(e){this.key=e}}class bye{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=na(),this.mutatedKeys=na(),this.Aa=hZ(e),this.Ra=new Av(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new p9,a=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=a,l=!1;const c=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,u=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((d,f)=>{const A=a.get(d),h=Tw(this.query,f)?f:null,m=!!A&&this.mutatedKeys.has(A.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;A&&h?A.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(A,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||u&&this.Aa(h,u)<0)&&(l=!0)):!A&&h?(n.track({type:0,doc:h}),x=!0):A&&!h&&(n.track({type:1,doc:A}),x=!0,(c||u)&&(l=!0)),x&&(h?(o=o.add(h),s=p?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return un()}};return p(h)-p(m)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(n),a=a!=null&&a;const l=r&&!a?this.ya():[],c=this.da.size===0&&this.current&&!a?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Lv(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new p9,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=na(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new uee(n))}),this.da.forEach(n=>{e.has(n)||r.push(new cee(n))}),r}ba(e){this.Ta=e.Ts,this.da=na();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Lv.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class wye{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Nye{constructor(e){this.key=e,this.va=!1}}class Cye{constructor(e,r,n,a,s,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Vm(l=>fZ(l),EI),this.Ma=new Map,this.xa=new Set,this.Oa=new Ys(Xr.comparator),this.Na=new Map,this.La=new c6,this.Ba={},this.ka=new Map,this.qa=Ag.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function _ye(t,e,r=!0){const n=pee(t);let a;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await dee(n,e,r,!0),a}async function Eye(t,e){const r=pee(t);await dee(r,e,!0,!1)}async function dee(t,e,r,n){const a=await z1e(t.localStore,Id(e)),s=a.targetId,o=t.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await Sye(t,e,s,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&nee(t.remoteStore,a),l}async function Sye(t,e,r,n,a){t.Ka=(f,A,h)=>async function(p,x,v,y){let b=x.view.ma(v);b.ns&&(b=await f9(p.localStore,x.query,!1).then(({documents:C})=>x.view.ma(C,b)));const w=y&&y.targetChanges.get(x.targetId),I=y&&y.targetMismatches.get(x.targetId)!=null,j=x.view.applyChanges(b,p.isPrimaryClient,w,I);return y9(p,x.targetId,j.wa),j.snapshot}(t,f,A,h);const s=await f9(t.localStore,e,!0),o=new bye(e,s.Ts),l=o.ma(s.documents),c=Bw.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),u=o.applyChanges(l,t.isPrimaryClient,c);y9(t,r,u.wa);const d=new wye(e,r,o);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function jye(t,e,r){const n=Un(t),a=n.Fa.get(e),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(o=>!EI(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await lk(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&h6(n.remoteStore,a.targetId),uk(n,a.targetId)}).catch(Fg)):(uk(n,a.targetId),await lk(n.localStore,a.targetId,!0))}async function Iye(t,e){const r=Un(t),n=r.Fa.get(e),a=r.Ma.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),h6(r.remoteStore,n.targetId))}async function Pye(t,e,r){const n=gee(t);try{const a=await function(o,l){const c=Un(o),u=yr.now(),d=l.reduce((h,m)=>h.add(m.key),na());let f,A;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Ou(),p=na();return c.cs.getEntries(h,d).next(x=>{m=x,m.forEach((v,y)=>{y.isValidDocument()||(p=p.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{f=x;const v=[];for(const y of l){const b=zve(y,f.get(y.key).overlayedDocument);b!=null&&v.push(new RA(y.key,b,nZ(b.value.mapValue),qs.exists(!0)))}return c.mutationQueue.addMutationBatch(h,u,v,l)}).next(x=>{A=x;const v=x.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,v)})}).then(()=>({batchId:A.batchId,changes:mZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Ys(zn)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(n,a.batchId,r),await Ow(n,a.changes),await Fw(n.remoteStore)}catch(a){const s=x6(a,"Failed to persist write");r.reject(s)}}async function fee(t,e){const r=Un(t);try{const n=await G1e(r.localStore,e);e.targetChanges.forEach((a,s)=>{const o=r.Na.get(s);o&&(pn(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?pn(o.va):a.removedDocuments.size>0&&(pn(o.va),o.va=!1))}),await Ow(r,n,e)}catch(n){await Fg(n)}}function v9(t,e,r){const n=Un(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&a.push(l.snapshot)}),function(o,l){const c=Un(o);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const A of f.j_)A.Z_(l)&&(u=!0)}),u&&b6(c)}(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Tye(t,e,r){const n=Un(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Na.get(e),s=a&&a.key;if(s){let o=new Ys(Xr.comparator);o=o.insert(s,Gs.newNoDocument(s,Nn.min()));const l=na().add(s),c=new II(Nn.min(),new Map,new Ys(zn),o,l);await fee(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),N6(n)}else await lk(n.localStore,e,!1).then(()=>uk(n,e,r)).catch(Fg)}async function Bye(t,e){const r=Un(t),n=e.batch.batchId;try{const a=await $1e(r.localStore,e);Aee(r,n,null),hee(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ow(r,a)}catch(a){await Fg(a)}}async function kye(t,e,r){const n=Un(t);try{const a=await function(o,l){const c=Un(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(pn(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);Aee(n,e,r),hee(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Ow(n,a)}catch(a){await Fg(a)}}function hee(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function Aee(t,e,r){const n=Un(t);let a=n.Ba[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(r?s.reject(r):s.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function uk(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||mee(t,n)})}function mee(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(h6(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),N6(t))}function y9(t,e,r){for(const n of r)n instanceof cee?(t.La.addReference(n.key,e),Fye(t,n)):n instanceof uee?(Or("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||mee(t,n.key)):un()}function Fye(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Or("SyncEngine","New document in limbo: "+r),t.xa.add(n),N6(t))}function N6(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Xr(Ba.fromString(e)),n=t.qa.next();t.Na.set(n,new Nye(r)),t.Oa=t.Oa.insert(r,n),nee(t.remoteStore,new Yh(Id(Pw(r.path)),n,"TargetPurposeLimboResolution",Nd.oe))}}async function Ow(t,e,r){const n=Un(t),a=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const f=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){a.push(u);const f=d6.Wi(c.targetId,u);s.push(f)}}))}),await Promise.all(o),n.Ca.d_(a),await async function(c,u){const d=Un(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Zt.forEach(u,A=>Zt.forEach(A.$i,h=>d.persistence.referenceDelegate.addReference(f,A.targetId,h)).next(()=>Zt.forEach(A.Ui,h=>d.persistence.referenceDelegate.removeReference(f,A.targetId,h)))))}catch(f){if(!Qm(f))throw f;Or("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const A=f.targetId;if(!f.fromCache){const h=d.os.get(A),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.os=d.os.insert(A,p)}}}(n.localStore,s))}async function Oye(t,e){const r=Un(t);if(!r.currentUser.isEqual(e)){Or("SyncEngine","User change. New user:",e.toKey());const n=await ZZ(r.localStore,e);r.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new Hr(hr.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ow(r,n.hs)}}function Dye(t,e){const r=Un(t),n=r.Na.get(e);if(n&&n.va)return na().add(n.key);{let a=na();const s=r.Ma.get(e);if(!s)return a;for(const o of s){const l=r.Fa.get(o);a=a.unionWith(l.view.Va)}return a}}function pee(t){const e=Un(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=fee.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Tye.bind(null,e),e.Ca.d_=vye.bind(null,e.eventManager),e.Ca.$a=yye.bind(null,e.eventManager),e}function gee(t){const e=Un(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Bye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kye.bind(null,e),e}class E2{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kI(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return JZ(this.persistence,new YZ,e.initialUser,this.serializer)}Ga(e){return new XZ(BI.Zr,this.serializer)}Wa(e){return new tee}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}E2.provider={build:()=>new E2};class Rye extends E2{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await gee(this.Ja.syncEngine),await Fw(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return JZ(this.persistence,new YZ,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new _1e(n,e.asyncQueue,r)}Ha(e,r){const n=new eve(r,this.persistence);return new Zxe(e.asyncQueue,n)}Ga(e){const r=Q1e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Jc.withCacheSize(this.cacheSizeBytes):Jc.DEFAULT;return new u6(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,eye(),fE(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new tee}}class pS{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>v9(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Oye.bind(null,this.syncEngine),await pye(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new xye}()}createDatastore(e){const r=kI(e.databaseInfo.databaseId),n=function(s){return new Z1e(s)}(e.databaseInfo);return function(s,o,l,c){return new nye(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,s,o,l){return new sye(n,a,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>v9(this.syncEngine,r,0),function(){return A9.D()?new A9:new X1e}())}createSyncEngine(e,r){return function(a,s,o,l,c,u,d){const f=new Cye(a,s,o,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const s=Un(a);Or("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await kw(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}pS.provider={build:()=>new pS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):jc("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mye{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Hr(hr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(a,s){const o=Un(a),l={documents:s.map(f=>C2(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,Ba.emptyPath(),l,s.length),u=new Map;c.forEach(f=>{const A=s1e(o.serializer,f);u.set(A.key.toString(),A)});const d=[];return s.forEach(f=>{const A=u.get(f.toString());pn(!!A),d.push(A)}),d}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new h1(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const a=Xr.fromPath(n);this.mutations.push(new t6(a,this.precondition(a)))}),await async function(n,a){const s=Un(n),o={writes:a.map(l=>_2(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,Ba.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw un();r=Nn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Hr(hr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(Nn.min())?qs.exists(!1):qs.updateTime(r):qs.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(Nn.min()))throw new Hr(hr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qs.updateTime(r)}return qs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lye{constructor(e,r,n,a,s){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=a,this.deferred=s,this._u=n.maxAttempts,this.t_=new f6(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new Mye(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(a=>{this.lu(a)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!jw(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!CZ(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uye{constructor(e,r,n,a,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=_l.UNAUTHENTICATED,this.clientId=KD.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Or("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Or("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=x6(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function P4(t,e){t.asyncQueue.verifyOperationInProgress(),Or("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await ZZ(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function b9(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Qye(t);Or("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>m9(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>m9(e.remoteStore,a)),t._onlineComponents=e}async function Qye(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Or("FirestoreClient","Using user provided OfflineComponentProvider");try{await P4(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===hr.FAILED_PRECONDITION||a.code===hr.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;bm("Error using user provided cache. Falling back to memory cache: "+r),await P4(t,new E2)}}else Or("FirestoreClient","Using default OfflineComponentProvider"),await P4(t,new E2);return t._offlineComponents}async function _6(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Or("FirestoreClient","Using user provided OnlineComponentProvider"),await b9(t,t._uninitializedComponentsProvider._online)):(Or("FirestoreClient","Using default OnlineComponentProvider"),await b9(t,new pS))),t._onlineComponents}function Vye(t){return _6(t).then(e=>e.syncEngine)}function Hye(t){return _6(t).then(e=>e.datastore)}async function gS(t){const e=await _6(t),r=e.eventManager;return r.onListen=_ye.bind(null,e.syncEngine),r.onUnlisten=jye.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Eye.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=Iye.bind(null,e.syncEngine),r}function $ye(t,e,r={}){const n=new vf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new C6({next:A=>{d.Za(),o.enqueueAndForget(()=>y6(s,f));const h=A.docs.has(l);!h&&A.fromCache?u.reject(new Hr(hr.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&A.fromCache&&c&&c.source==="server"?u.reject(new Hr(hr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new w6(Pw(l.path),d,{includeMetadataChanges:!0,_a:!0});return v6(s,f)}(await gS(t),t.asyncQueue,e,r,n)),n.promise}function Gye(t,e,r={}){const n=new vf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new C6({next:A=>{d.Za(),o.enqueueAndForget(()=>y6(s,f)),A.fromCache&&c.source==="server"?u.reject(new Hr(hr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new w6(l,d,{includeMetadataChanges:!0,_a:!0});return v6(s,f)}(await gS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xee(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w9=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vee(t,e,r){if(!r)throw new Hr(hr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function yee(t,e,r,n){if(e===!0&&n===!0)throw new Hr(hr.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function N9(t){if(!Xr.isDocumentKey(t))throw new Hr(hr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function C9(t){if(Xr.isDocumentKey(t))throw new Hr(hr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function OI(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":un()}function al(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Hr(hr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=OI(t);throw new Hr(hr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Hr(hr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Hr(hr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yee("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xee((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Hr(hr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Hr(hr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Hr(hr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class DI{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _9({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Hr(hr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Hr(hr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _9(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new HJ;switch(n.type){case"firstParty":return new Gxe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Hr(hr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=w9.get(r);n&&(Or("ComponentProvider","Removing Datastore"),w9.delete(r),n.terminate())}(this),Promise.resolve()}}function bee(t,e,r,n={}){var a;const s=(t=al(t,DI))._getSettings(),o=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&bm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=_l.MOCK_USER;else{l=ome(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Hr(hr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new _l(u)}t._authCredentials=new Vxe(new VJ(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new mh(this.firestore,e,this._query)}}class sl{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new iA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sl(this.firestore,e,this._key)}}class iA extends mh{constructor(e,r,n){super(e,r,Pw(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sl(this.firestore,null,new Xr(e))}withConverter(e){return new iA(this.firestore,e,this._path)}}function Ct(t,e,...r){if(t=Ai(t),vee("collection","path",e),t instanceof DI){const n=Ba.fromString(e,...r);return C9(n),new iA(t,null,n)}{if(!(t instanceof sl||t instanceof iA))throw new Hr(hr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ba.fromString(e,...r));return C9(n),new iA(t.firestore,null,n)}}function Yt(t,e,...r){if(t=Ai(t),arguments.length===1&&(e=KD.newId()),vee("doc","path",e),t instanceof DI){const n=Ba.fromString(e,...r);return N9(n),new sl(t,null,new Xr(n))}{if(!(t instanceof sl||t instanceof iA))throw new Hr(hr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ba.fromString(e,...r));return N9(n),new sl(t.firestore,t instanceof iA?t.converter:null,new Xr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new f6(this,"async_queue_retry"),this.Vu=()=>{const n=fE();n&&Or("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=fE();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=fE();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new vf;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Qm(e))throw e;Or("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const a=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw jc("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const a=g6.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(a),a}fu(){this.Eu&&un()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function S9(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const s of n)if(s in a&&typeof a[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Hu extends DI{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new E9,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new E9(e),this._firestoreClient=void 0,await e}}}function wee(t,e){const r=typeof t=="object"?t:BD(),n=typeof t=="string"?t:"(default)",a=PD(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=sme("firestore");s&&bee(a,...s)}return a}function Rg(t){if(t._terminated)throw new Hr(hr.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Nee(t),t._firestoreClient}function Nee(t){var e,r,n;const a=t._freezeSettings(),s=function(l,c,u,d){return new wve(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,xee(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new Uye(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function Cee(t,e){bm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return Kye(t,pS.provider,{build:n=>new Rye(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function Kye(t,e,r){if((t=al(t,Hu))._firestoreClient||t._terminated)throw new Hr(hr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Hr(hr.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},Nee(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Em(Xi.fromBase64String(e))}catch(r){throw new Hr(hr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Em(Xi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Hr(hr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ks(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Hr(hr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Hr(hr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return zn(this._lat,e._lat)||zn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qye=/^__.*__$/;class zye{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new RA(e,this.data,this.fieldMask,r,this.fieldTransforms):new f1(e,this.data,r,this.fieldTransforms)}}class _ee{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new RA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Eee(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw un()}}class LI{constructor(e,r,n,a,s,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new LI(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return xS(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Eee(this.Cu)&&qye.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Wye{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||kI(e)}Qu(e,r,n,a=!1){return new LI({Cu:e,methodName:r,qu:n,path:Ks.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function p1(t){const e=t._freezeSettings(),r=kI(t._databaseId);return new Wye(t._databaseId,!!e.ignoreUndefinedProperties,r)}function UI(t,e,r,n,a,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,r,a);P6("Data must be an object, but it was:",o,n);const l=See(n,o);let c,u;if(s.merge)c=new nu(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const A=dk(e,f,r);if(!o.contains(A))throw new Hr(hr.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);Iee(d,A)||d.push(A)}c=new nu(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new zye(new jl(l),c,u)}class QI extends m1{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof QI}}function Xye(t,e,r){return new LI({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class E6 extends m1{_toFieldTransform(e){return new e6(e.path,new Dv)}isEqual(e){return e instanceof E6}}class S6 extends m1{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=Xye(this,e,!0),n=this.Ku.map(s=>g1(s,r)),a=new dg(n);return new e6(e.path,a)}isEqual(e){return e instanceof S6&&d2(this.Ku,e.Ku)}}function j6(t,e,r,n){const a=t.Qu(1,e,r);P6("Data must be an object, but it was:",a,n);const s=[],o=jl.empty();Og(n,(c,u)=>{const d=T6(e,c,r);u=Ai(u);const f=a.Nu(d);if(u instanceof QI)s.push(d);else{const A=g1(u,f);A!=null&&(s.push(d),o.set(d,A))}});const l=new nu(s);return new _ee(o,l,a.fieldTransforms)}function I6(t,e,r,n,a,s){const o=t.Qu(1,e,r),l=[dk(e,n,r)],c=[a];if(s.length%2!=0)throw new Hr(hr.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)l.push(dk(e,s[A])),c.push(s[A+1]);const u=[],d=jl.empty();for(let A=l.length-1;A>=0;--A)if(!Iee(u,l[A])){const h=l[A];let m=c[A];m=Ai(m);const p=o.Nu(h);if(m instanceof QI)u.push(h);else{const x=g1(m,p);x!=null&&(u.push(h),d.set(h,x))}}const f=new nu(u);return new _ee(d,f,o.fieldTransforms)}function Yye(t,e,r,n=!1){return g1(r,t.Qu(n?4:3,e))}function g1(t,e){if(jee(t=Ai(t)))return P6("Unsupported field value:",e,t),See(t,e);if(t instanceof m1)return function(n,a){if(!Eee(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,a){const s=[];let o=0;for(const l of n){let c=g1(l,a.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(n,a){if((n=Ai(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Vve(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=yr.fromDate(n);return{timestampValue:Mv(a.serializer,s)}}if(n instanceof yr){const s=new yr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Mv(a.serializer,s)}}if(n instanceof RI)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Em)return{bytesValue:jZ(a.serializer,n._byteString)};if(n instanceof sl){const s=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:i6(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof MI)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return ZD(l.serializer,c)})}}}}}}(n,a);throw a.Bu(`Unsupported field value: ${OI(n)}`)}(t,e)}function See(t,e){const r={};return ZJ(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Og(t,(n,a)=>{const s=g1(a,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function jee(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof yr||t instanceof RI||t instanceof Em||t instanceof sl||t instanceof m1||t instanceof MI)}function P6(t,e,r){if(!jee(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=OI(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function dk(t,e,r){if((e=Ai(e))instanceof Mg)return e._internalPath;if(typeof e=="string")return T6(t,e);throw xS("Field path arguments must be of type string or ",t,!1,void 0,r)}const Jye=new RegExp("[~\\*/\\[\\]]");function T6(t,e,r){if(e.search(Jye)>=0)throw xS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Mg(...e.split("."))._internalPath}catch{throw xS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function xS(t,e,r,n,a){const s=n&&!n.isEmpty(),o=a!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${a}`),c+=")"),new Hr(hr.INVALID_ARGUMENT,l+t+c)}function Iee(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(e,r,n,a,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new sl(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Zye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(VI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Zye extends vS{data(){return super.data()}}function VI(t,e){return typeof e=="string"?T6(t,e):e instanceof Mg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pee(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Hr(hr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class B6{}class HI extends B6{}function sr(t,e,...r){let n=[];e instanceof B6&&n.push(e),n=n.concat(r),function(s){const o=s.filter(c=>c instanceof $I).length,l=s.filter(c=>c instanceof Dw).length;if(o>1||o>0&&l>0)throw new Hr(hr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class Dw extends HI{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Dw(e,r,n)}_apply(e){const r=this._parse(e);return Tee(e._query,r),new mh(e.firestore,e.converter,ek(e._query,r))}_parse(e){const r=p1(e.firestore);return function(s,o,l,c,u,d,f){let A;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Hr(hr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){I9(f,d);const h=[];for(const m of f)h.push(j9(c,s,m));A={arrayValue:{values:h}}}else A=j9(c,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||I9(f,d),A=Yye(l,o,f,d==="in"||d==="not-in");return ma.create(u,d,A)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function cr(t,e,r){const n=e,a=VI("where",t);return Dw._create(a,n,r)}class $I extends B6{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new $I(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:rs.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,s){let o=a;const l=s.getFlattenedFilters();for(const c of l)Tee(o,c),o=ek(o,c)}(e._query,r),new mh(e.firestore,e.converter,ek(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class GI extends HI{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new GI(e,r)}_apply(e){const r=function(a,s,o){if(a.startAt!==null)throw new Hr(hr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Hr(hr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new w2(s,o)}(e._query,this._field,this._direction);return new mh(e.firestore,e.converter,function(a,s){const o=a.explicitOrderBy.concat([s]);return new d1(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,r))}}function Sn(t,e="asc"){const r=e,n=VI("orderBy",t);return GI._create(n,r)}class KI extends HI{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new KI(e,r,n)}_apply(e){return new mh(e.firestore,e.converter,dS(e._query,this._limit,this._limitType))}}function yS(t){return KI._create("limit",t,"F")}function j9(t,e,r){if(typeof(r=Ai(r))=="string"){if(r==="")throw new Hr(hr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dZ(e)&&r.indexOf("/")!==-1)throw new Hr(hr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Ba.fromString(r));if(!Xr.isDocumentKey(n))throw new Hr(hr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return y2(t,new Xr(n))}if(r instanceof sl)return y2(t,r._key);throw new Hr(hr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${OI(r)}.`)}function I9(t,e){if(!Array.isArray(t)||t.length===0)throw new Hr(hr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Tee(t,e){const r=function(a,s){for(const o of a)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Hr(hr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Hr(hr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class k6{convertValue(e,r="none"){switch(cg(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(wm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw un()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Og(e,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,a;const s=(a=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(o=>Hs(o.doubleValue));return new MI(s)}convertGeoPoint(e){return new RI(Hs(e.latitude),Hs(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=YD(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(x2(e));default:return null}}convertTimestamp(e){const r=yA(e);return new yr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ba.fromString(e);pn(MZ(n));const a=new Nm(n.get(1),n.get(3)),s=new Xr(n.popFirst(5));return a.isEqual(r)||jc(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class ebe extends k6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Em(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new sl(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zI extends vS{constructor(e,r,n,a,s,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Nb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(VI("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Nb extends zI{data(e={}){return super.data(e)}}class F6{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new jp(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Nb(this._firestore,this._userDataWriter,n.key,n,new jp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Hr(hr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const c=new Nb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new jp(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new Nb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new jp(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:tbe(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function tbe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return un()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(t){t=al(t,sl);const e=al(t.firestore,Hu);return $ye(Rg(e),t._key).then(r=>kee(e,t,r))}class WI extends k6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Em(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new sl(this.firestore,null,r)}}function Ht(t){t=al(t,mh);const e=al(t.firestore,Hu),r=Rg(e),n=new WI(e);return Pee(t._query),Gye(r,t._query).then(a=>new F6(e,n,t,a))}function Bee(t,e,r){t=al(t,sl);const n=al(t.firestore,Hu),a=qI(t.converter,e,r);return x1(n,[UI(p1(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,qs.none())])}function kn(t,e,r,...n){t=al(t,sl);const a=al(t.firestore,Hu),s=p1(a);let o;return o=typeof(e=Ai(e))=="string"||e instanceof Mg?I6(s,"updateDoc",t._key,e,r,n):j6(s,"updateDoc",t._key,e),x1(a,[o.toMutation(t._key,qs.exists(!0))])}function Wn(t){return x1(al(t.firestore,Hu),[new h1(t._key,qs.none())])}function Gn(t,e){const r=al(t.firestore,Hu),n=Yt(t),a=qI(t.converter,e);return x1(r,[UI(p1(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,qs.exists(!1))]).then(()=>n)}function Pd(t,...e){var r,n,a;t=Ai(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||S9(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(S9(e[o])){const f=e[o];e[o]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(a=f.complete)===null||a===void 0?void 0:a.bind(f)}let c,u,d;if(t instanceof sl)u=al(t.firestore,Hu),d=Pw(t._key.path),c={next:f=>{e[o]&&e[o](kee(u,t,f))},error:e[o+1],complete:e[o+2]};else{const f=al(t,mh);u=al(f.firestore,Hu),d=f._query;const A=new WI(u);c={next:h=>{e[o]&&e[o](new F6(u,A,f,h))},error:e[o+1],complete:e[o+2]},Pee(t._query)}return function(A,h,m,p){const x=new C6(p),v=new w6(h,x,m);return A.asyncQueue.enqueueAndForget(async()=>v6(await gS(A),v)),()=>{x.Za(),A.asyncQueue.enqueueAndForget(async()=>y6(await gS(A),v))}}(Rg(u),d,l,c)}function x1(t,e){return function(n,a){const s=new vf;return n.asyncQueue.enqueueAndForget(async()=>Pye(await Vye(n),a,s)),s.promise}(Rg(t),e)}function kee(t,e,r){const n=r.docs.get(e._key),a=new WI(t);return new zI(t,a,e._key,n,new jp(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rbe={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fee{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=p1(e)}set(e,r,n){this._verifyNotCommitted();const a=Q0(e,this._firestore),s=qI(a.converter,r,n),o=UI(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,qs.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const s=Q0(e,this._firestore);let o;return o=typeof(r=Ai(r))=="string"||r instanceof Mg?I6(this._dataReader,"WriteBatch.update",s._key,r,n,a):j6(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,qs.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Q0(e,this._firestore);return this._mutations=this._mutations.concat(new h1(r._key,qs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Hr(hr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Q0(t,e){if((t=Ai(t)).firestore!==e)throw new Hr(hr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oee extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=p1(r)}get(r){const n=Q0(r,this._firestore),a=new ebe(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return un();const o=s[0];if(o.isFoundDocument())return new vS(this._firestore,a,o.key,o,n.converter);if(o.isNoDocument())return new vS(this._firestore,a,n._key,null,n.converter);throw un()})}set(r,n,a){const s=Q0(r,this._firestore),o=qI(s.converter,n,a),l=UI(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,a);return this._transaction.set(s._key,l),this}update(r,n,a,...s){const o=Q0(r,this._firestore);let l;return l=typeof(n=Ai(n))=="string"||n instanceof Mg?I6(this._dataReader,"Transaction.update",o._key,n,a,s):j6(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=Q0(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=Q0(e,this._firestore),n=new WI(this._firestore);return super.get(e).then(a=>new zI(this._firestore,n,r._key,a._document,new jp(!1,!1),r.converter))}}function zs(t,e,r){t=al(t,Hu);const n=Object.assign(Object.assign({},rbe),r);return function(s){if(s.maxAttempts<1)throw new Hr(hr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){const c=new vf;return s.asyncQueue.enqueueAndForget(async()=>{const u=await Hye(s);new Lye(s.asyncQueue,u,l,o,c).au()}),c.promise}(Rg(t),a=>e(new Oee(t,a)),n)}function Dee(){return new E6("serverTimestamp")}function Ree(...t){return new S6("arrayUnion",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t){return Rg(t=al(t,Hu)),new Fee(t,e=>x1(t,e))}(function(e,r=!0){(function(a){u1=a})(l1),Tv(new sg("firestore",(n,{instanceIdentifier:a,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new Hu(new Hxe(n.getProvider("auth-internal")),new qxe(n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Hr(hr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nm(u.options.projectId,d)}(o,a),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),dm(b7,"4.7.3",e),dm(b7,"4.7.3","esm2017")})();const nbe=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:k6,Bytes:Em,CollectionReference:iA,DocumentReference:sl,DocumentSnapshot:zI,FieldPath:Mg,FieldValue:m1,Firestore:Hu,FirestoreError:Hr,GeoPoint:RI,Query:mh,QueryCompositeFilterConstraint:$I,QueryConstraint:HI,QueryDocumentSnapshot:Nb,QueryFieldFilterConstraint:Dw,QueryLimitConstraint:KI,QueryOrderByConstraint:GI,QuerySnapshot:F6,SnapshotMetadata:jp,Timestamp:yr,Transaction:Oee,VectorValue:MI,WriteBatch:Fee,_AutoId:KD,_ByteString:Xi,_DatabaseId:Nm,_DocumentKey:Xr,_EmptyAuthCredentialsProvider:HJ,_FieldPath:Ks,_cast:al,_logWarn:bm,_validateIsNotUsedTogether:yee,addDoc:Gn,arrayUnion:Ree,collection:Ct,connectFirestoreEmulator:bee,deleteDoc:Wn,doc:Yt,enableIndexedDbPersistence:Cee,ensureFirestoreConfigured:Rg,executeWrite:x1,getDoc:gs,getDocs:Ht,getFirestore:wee,limit:yS,onSnapshot:Pd,orderBy:Sn,query:sr,runTransaction:zs,serverTimestamp:Dee,setDoc:Bee,updateDoc:kn,where:cr,writeBatch:Ic},Symbol.toStringTag,{value:"Module"})),abe={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},Mee=TD(abe),Ce=wee(Mee),ic=GB(Mee),sbe=(async()=>{try{return await rE(ic,QD),console.info(" Auth persistence: browserLocalPersistence enabled"),"local"}catch(t){console.warn(" browserLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await rE(ic,kJ),console.info(" Auth persistence: indexedDBLocalPersistence enabled"),"indexeddb"}catch(t){console.warn(" indexedDBLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await rE(ic,VD),console.info(" Auth persistence: browserSessionPersistence enabled (session only)"),"session"}catch(t){console.warn(" browserSessionPersistence failed:",(t==null?void 0:t.code)||t)}return console.warn(" No se pudo establecer ninguna persistencia para Auth."),"none"})();Cee(Ce).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function ibe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState(!1),d=yw();g.useEffect(()=>{let h=!0;const m=bI(ic,async p=>{if(!(!p||!h))try{const x=await gs(Yt(Ce,"users",p.uid));if(!x.exists())return;const v=x.data(),y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"";localStorage.setItem("user_email",p.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin",{replace:!0})}catch{}});return()=>{h=!1,m()}},[d]);const f=h=>{if(Array.isArray(h)){if(h.length!==1)return localStorage.setItem("role",h[0]||""),d("/admin");h=h[0]||""}const m=String(h||"");if(localStorage.setItem("role",m),En(m,"admin"))return d("/admin");if(En(m,"vendedor_pollo"))return d("/admin/salesV2");if(En(m,"vendedor_ropa"))return d("/admin/salesClothes");if(En(m,"vendedor_dulces"))return d("/admin/salesCandies");if(En(m,"supervisor_pollo")||En(m,"contador"))return d("/admin/batches")},A=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{u(!0),console.info&&console.info("[Login] attempting signIn",{email:t}),await rE(ic,QD);const m=await jge(ic,t,r);console.info&&console.info("[Login] signInWithEmailAndPassword success",{uid:m.user.uid,email:m.user.email});const p=m.user.uid;localStorage.setItem("POSYS_LOGIN_AT",String(Date.now()));const x=await gs(Yt(Ce,"users",p));if(console.info&&console.info("[Login] firestore users doc snap: exists=",x.exists()),!x.exists()){console.warn&&console.warn("[Login] user doc missing for uid",p),l("Tu usuario no tiene perfil en la base de datos.");return}const v=x.data();console.info&&console.info("[Login] user profile:",v);const y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"",I=["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"];if(!y.some(j=>I.includes(j))){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin")}catch(m){console.error&&console.error("[Login] sign-in error:",m);const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas. ("+p+")":p==="auth/user-not-found"?"Usuario no encontrado. ("+p+")":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde. ("+p+")":((m==null?void 0:m.message)||"Error al iniciar sesin.")+(p?` (${p})`:""))}finally{u(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:A,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:a?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>s(h=>!h),children:a?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function qn({children:t,allowedRoles:e}){const[r,n]=g.useState(!0),[a,s]=g.useState(!1);return g.useEffect(()=>{const o=bI(ic,async l=>{if(l){const c=Yt(Ce,"users",l.uid),u=await gs(c);if(u.exists()){const d=u.data(),f=Array.isArray(d.roles)?d.roles:d.role?[d.role]:[];try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e):console.debug&&console.debug("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e)}catch{}let A=!1;for(const h of e)if(En(f,h)){A=!0;break}s(A)}else try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] no user doc for uid:",l.uid):console.debug&&console.debug("[PrivateRoute] no user doc for uid:",l.uid)}catch{}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):a?t:i.jsx(Mh,{to:"/"})}const obe={admin:{billing:{view:!0,edit:!0}},supervisor_pollo:{bills:{view:!0,edit:!1},expenses:{view:!0,edit:!1},customersPollo:{view:!0,edit:!1},transactionsPollo:{view:!0,edit:!1},batches:{view:!0,edit:!1}},contador:{billing:{view:!0,edit:!0},salesV2:{view:!0,edit:!0},customersPollo:{view:!0,edit:!0},batches:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},expenses:{view:!0,edit:!0},financialDashboard:{view:!0,edit:!1},polloCashAudits:{view:!0,edit:!0}},vendedor_pollo:{salesV2:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},customersPollo:{view:!0,edit:!0}},vendedor_dulces:{salesCandies:{view:!0,edit:!0},productsVendorsCandies:{view:!0,edit:!1},productsPricesCandies:{view:!0,edit:!1},transactionCandies:{view:!0,edit:!1},cierreVentasCandies:{view:!0,edit:!1},customersCandies:{view:!0,edit:!0}},vendedor_ropa:{}};function Lee(t){return t?Array.isArray(t)?t.filter(Boolean):[t].filter(Boolean):[]}function ea(t,e,r="view"){const n=Lee(t);return n.some(a=>a==="admin")?!0:n.some(a=>{var s,o;return!!((o=(s=obe[a])==null?void 0:s[e])!=null&&o[r])})}const lbe={admin:{},supervisor_pollo:{bills:{cerrarVentas:!1},batches:{create:!1,update:!1,delete:!1,export:!1}},contador:{batches:{create:!0,update:!1,delete:!1,export:!0},bills:{cerrarVentas:!1}},vendedor_pollo:{salesV2:{create:!0,update:!0},customersPollo:{update:!0},bills:{cerrarVentas:!0}},vendedor_dulces:{salesCandies:{create:!0,update:!0},productsVendorsCandies:{create:!0,update:!1,delete:!1},customersCandies:{update:!0},productsPricesCandies:{price_edit:!1}},vendedor_ropa:{}};function cbe(t,e,r){const n=Lee(t);return n.some(a=>a==="admin")?!0:ea(t,e,"view")?n.some(a=>{var o;const s=(o=lbe[a])==null?void 0:o[e];return!!(s!=null&&s[r])}):!1}function ube({role:t,roles:e}){const r="/admin",n=({isActive:se})=>`block rounded px-3 py-2 text-sm ${se?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,a=yw(),[s,o]=g.useState(!1),[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(!1),[h,m]=g.useState(!1),[p,x]=g.useState(!1),[v,y]=g.useState(!1),[b,w]=g.useState(!1),[I,j]=g.useState(!1),[C,S]=g.useState(!1),[E,B]=g.useState(!1),[k,T]=g.useState(!1),[P,G]=g.useState(!1),[ce,ue]=g.useState(!1),[le,Ae]=g.useState(!1),[ae,_e]=g.useState(!1),[De,O]=g.useState(!1),[H,K]=g.useState(!1),R=async()=>{K(!0)},X=async()=>{try{await UD(ic)}catch(se){console.error("signOut error:",se)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}K(!1),a("/")}},Y=({open:se,onClick:ee,children:Fe})=>i.jsxs("button",{type:"button",onClick:ee,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:Fe}),i.jsx("span",{className:"text-xs",children:se?"":""})]}),D=({open:se,onClick:ee,title:Fe})=>i.jsxs("button",{type:"button",onClick:ee,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:Fe}),i.jsx("span",{className:"text-xs",children:se?"":""})]}),Q=e&&e.length?e:t,te=En(Q,"admin");En(Q,"vendedor_pollo");const be=En(Q,"vendedor_ropa");En(Q,"vendedor_dulces"),En(Q,"supervisor_pollo")||En(Q,"contador"),En(Q,"contador");const U=ea(Q,"salesV2","view")||ea(Q,"customersPollo","view")||ea(Q,"transactionsPollo","view")||ea(Q,"bills","view")||ea(Q,"expenses","view")||ea(Q,"batches","view"),Xe=ea(Q,"salesCandies","view")||ea(Q,"productsVendorsCandies","view")||ea(Q,"customersCandies","view")||ea(Q,"productsPricesCandies","view")||ea(Q,"transactionCandies","view")||ea(Q,"cierreVentasCandies","view");return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>o(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[te&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:l,onClick:()=>c(se=>!se),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:p,onClick:()=>x(se=>!se),title:"Operaciones"}),p&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(xn,{to:`${r}/salesV2`,className:n,children:"Vender"}),i.jsx(xn,{to:`${r}/customersPollo`,className:n,children:"Saldo Pendientes"}),i.jsx(xn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),i.jsx(xn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"})]}),i.jsx(D,{open:u,onClick:()=>d(se=>!se),title:"Inventarios"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(xn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),i.jsx(xn,{to:`${r}/paidBatches`,className:n,children:"Inventarios Pagados"}),i.jsx(xn,{to:`${r}/billing`,className:n,children:"Facturacion"})]}),i.jsx(D,{open:f,onClick:()=>A(se=>!se),title:"Finanzas"}),f&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(xn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),i.jsx(xn,{to:`${r}/billing`,className:n,children:"Facturacion"}),i.jsx(xn,{to:`${r}/expenses`,className:n,children:"Gastos"}),i.jsx(xn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),i.jsx(xn,{to:`${r}/salesV2`,className:n,children:"Venta"}),i.jsx(xn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),i.jsx(xn,{to:`${r}/billhistoric`,className:n,children:"Historial de Cierres"})]}),i.jsx(D,{open:h,onClick:()=>m(se=>!se),title:"Productos"}),h&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/products`,className:n,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:v,onClick:()=>y(se=>!se),children:"Gonper"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:b,onClick:()=>w(se=>!se),title:"Inventarios"}),b&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/notebooksInventory`,className:n,children:"Productos y Precios"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:P,onClick:()=>G(se=>!se),children:"CandyShop"}),P&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:le,onClick:()=>Ae(se=>!se),title:"Vendedores"}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/productsVendorsCandies`,className:n,children:"Sub ordenes"})}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})}),i.jsx(D,{open:ce,onClick:()=>ue(se=>!se),title:"Inventario"}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/mainordersCandies`,className:n,children:"Ordenes Maestras"})}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/inventoryMainOrderCandies`,className:n,children:"Lista de Ordenes"})}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/inventoryCandies`,className:n,children:"Lista Productos"})}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/productsCandies`,className:n,children:"Productos"})}),i.jsx(D,{open:ae,onClick:()=>_e(se=>!se),title:"Finanzas"}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/datacenter`,className:n,children:"Data Center"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/cashDeliveries`,className:n,children:"Entregas Cash"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/transactionCandies`,className:n,children:"Transacciones"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/reporteCierresCandies`,className:n,children:"Reporte Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/billingsCandies`,className:n,children:"Facturas"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/consolidatedVendors`,className:n,children:"Consolidado Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/dashboardCandies`,className:n,children:"Dashboard"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/vendorsCandies`,className:n,children:"Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/expensesCandies`,className:n,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:De,onClick:()=>O(se=>!se),children:"Operaciones Otras"}),De&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(xn,{to:`${r}/users`,className:n,children:"Usuarios"}),i.jsx(xn,{to:`${r}/fix`,className:n,children:"Fix de lotes"}),i.jsx(xn,{to:`${r}/transactionclose`,className:n,children:"Liquidaciones"})]})]})]}),!te&&U&&i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:l,onClick:()=>c(se=>!se),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[ea(Q,"salesV2")&&i.jsx(xn,{to:`${r}/salesV2`,className:n,children:"Vender"}),ea(Q,"financialDashboard")&&i.jsx(xn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),ea(Q,"batches")&&i.jsx(xn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),ea(Q,"bills")&&i.jsx(xn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),ea(Q,"transactionsPollo")&&i.jsx(xn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),ea(Q,"billing")&&i.jsx(xn,{to:`${r}/billing`,className:n,children:"Facturacion"}),ea(Q,"expenses")&&i.jsx(xn,{to:`${r}/expenses`,className:n,children:"Gastos"}),En(Q,"contador")&&i.jsx(xn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),ea(Q,"customersPollo")&&i.jsx(xn,{to:`${r}/customersPollo`,className:n,children:"Saldos Pendientes"})]})]}),!te&&Xe&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ea(Q,"salesCandies")&&i.jsx(xn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ea(Q,"transactionCandies")&&i.jsx(xn,{to:`${r}/transactionCandies`,className:n,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ea(Q,"cierreVentasCandies")&&i.jsx(xn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ea(Q,"productsVendorsCandies")&&i.jsx(xn,{to:`${r}/productsVendorsCandies`,className:n,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ea(Q,"customersCandies")&&i.jsx(xn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ea(Q,"productsPricesCandies")&&i.jsx(xn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})})]}),be&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Y,{open:v,onClick:()=>y(se=>!se),children:"Operaciones Ropa"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:E,onClick:()=>B(se=>!se),title:"Ventas"}),E&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(xn,{to:`${r}/salesClothes`,className:n,children:"Venta Ropa"}),i.jsx(xn,{to:`${r}/TransactionsReportClothes`,className:n,children:"Transacciones"})]}),i.jsx(D,{open:I,onClick:()=>j(se=>!se),title:"Productos"}),I&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/productsClothes`,className:n,children:"Agregar Productos"})}),i.jsx(D,{open:C,onClick:()=>S(se=>!se),title:"Clientes"}),C&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(xn,{to:`${r}/CustomersClothes`,className:n,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:R,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-700",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))}),H&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>K(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>K(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:X,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(RY,{})})]})}function fy(...t){return t.filter(Boolean).join(" ")}function dbe({role:t,roles:e}){const r=yw(),n=kA(),a="/admin",s=e&&e.length?e:t,o=En(s,"admin"),l=En(s,"vendedor_pollo"),c=En(s,"vendedor_dulces"),u=En(s,"supervisor_pollo")||En(s,"contador"),d=En(s,"contador"),f=ea(s,"salesV2","view")||ea(s,"batches","view")||ea(s,"bills","view")||ea(s,"transactionsPollo","view")||ea(s,"customersPollo","view");ea(s,"billing","view");const A=ea(s,"salesCandies","view")||ea(s,"productsVendorsCandies","view")||ea(s,"customersCandies","view")||ea(s,"productsPricesCandies","view")||ea(s,"transactionCandies","view")||ea(s,"cierreVentasCandies","view"),h=f&&A,[m,p]=g.useState(()=>{try{const B=typeof window<"u"?localStorage.getItem("rubro"):null;if(B==="POLLO"||B==="DULCES")return B}catch{}return f?"POLLO":A?"DULCES":"POLLO"}),[x,v]=g.useState(!1),[y,b]=g.useState(!1),w=g.useMemo(()=>{let B=[];if(o||h){if(m==="POLLO")if(o)B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"invPag",label:"Factura",to:`${a}/paidBatches`},{key:"gastos",label:"Gastos",to:`${a}/expenses`},{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}];else if(u){const P=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"facturacion",label:"Facturacin",to:`${a}/billing`}];En(s,"contador")&&(B=P)}else l?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:d?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"bills",label:"Facturacin",to:`${a}/billing`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];m==="DULCES"&&(o?B=[{key:"dc",label:"Data Center Reporte",to:`${a}/datacenter`},{key:"maes",label:"Inventario Maestro",to:`${a}/mainordersCandies`},{key:"ord",label:"Inventario Vendedor",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas del dia",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre de ventas",to:`${a}/cierreVentasCandies`},{key:"cash",label:"Entregas Efectivo ",to:`${a}/cashDeliveries`},{key:"items",label:"Productos",to:`${a}/productsCandies`},{key:"precios",label:"Precio Ventas",to:`${a}/productsPricesCandies`},{key:"gonper",label:"Productos Gonper",to:`${a}/notebooksInventory`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}])}else if(u){const P=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"facturacion",label:"Facturacin",to:`${a}/billing`}];En(s,"contador")?B=[...P,{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}]:B=P}else l?B=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];const k=new Set(["bills","customersPollo","transactionsPollo","batches","salesV2","financialDashboard","polloCashAudits","billing","salesCandies","productsVendorsCandies","productsPricesCandies","transactionCandies","cierreVentasCandies","customersCandies"]);return B.filter(P=>{const ce=P.to.replace(`${a}/`,"");return k.has(ce)?ea(s,ce,"view"):!0})},[a,m,o,h,u,l,c,d,s]);g.useEffect(()=>{if((o||h)&&w.length){try{localStorage.setItem("rubro",m)}catch{}r(w[0].to,{replace:!0})}},[m]),g.useEffect(()=>{x&&v(!1)},[n.pathname]),g.useEffect(()=>{const B=k=>{k.key==="Escape"&&v(!1)};return x&&window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[x]);const I=async()=>{b(!0)},j=async()=>{try{await UD(ic)}catch(B){console.error("signOut error:",B)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}b(!1),v(!1),r("/")}},C=({isActive:B})=>fy("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",B?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),S=w.length<=2,E=({isActive:B})=>fy("w-full flex items-center justify-between px-4 py-3 rounded-xl border",B?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[o||h?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>p("POLLO"),className:fy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Carniceria"}),i.jsx("button",{type:"button",onClick:()=>p("DULCES"),className:fy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Mr. Candy"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:l?"Pollos Bea":c?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto flex items-center gap-2",children:i.jsx("button",{type:"button",onClick:()=>v(!0),className:"px-3 py-2 rounded-2xl bg-gray-100 text-gray-800 text-sm font-bold shadow hover:bg-gray-200","aria-label":"Abrir men",title:"Men",children:""})})]})}),x&&i.jsxs("div",{className:"fixed inset-0 z-[80]",children:[i.jsx("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:()=>v(!1),"aria-label":"Cerrar men"}),i.jsxs("aside",{className:"absolute right-0 top-0 h-full w-[86%] max-w-sm bg-white shadow-2xl border-l flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-bold text-gray-900",children:"Men"}),i.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200",children:""})]}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-600",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))})]}),i.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-2",children:w.map(B=>i.jsxs(xn,{to:B.to,className:E,children:[i.jsx("span",{className:"font-semibold",children:B.label}),i.jsx("span",{className:"text-sm opacity-80",children:""})]},B.key))}),i.jsxs("div",{className:"p-3 border-t space-y-2 pb-[calc(12px+env(safe-area-inset-bottom))]",children:[i.jsx("button",{onClick:I,className:"w-full px-4 py-3 rounded-xl bg-red-500 text-white font-semibold shadow hover:bg-red-600",children:"Cerrar sesin"}),y&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>b(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>b(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:j,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]})]}),i.jsx("main",{className:fy("flex-1 overflow-y-auto px-3 pt-3",S?"pb-[calc(92px+env(safe-area-inset-bottom))]":"pb-[calc(16px+env(safe-area-inset-bottom))]"),children:i.jsx(RY,{})}),S&&i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md pb-[env(safe-area-inset-bottom)]",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:w.map(B=>i.jsx(xn,{to:B.to,className:C,children:B.label},B.key))})})]})}const Uee=6048e5,fbe=864e5,hbe=6e4,Abe=36e5,mbe=1e3,P9=Symbol.for("constructDateFrom");function ho(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&P9 in t?t[P9](e):t instanceof Date?new t.constructor(e):new Date(e)}function mi(t,e){return ho(e||t,t)}function O6(t,e,r){const n=mi(t,r==null?void 0:r.in);return isNaN(e)?ho((r==null?void 0:r.in)||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function pbe(t,e,r){const n=mi(t,r==null?void 0:r.in);if(isNaN(e))return ho(t,NaN);const a=n.getDate(),s=ho(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}let gbe={};function v1(){return gbe}function Sm(t,e){var l,c,u,d;const r=v1(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=mi(t,e==null?void 0:e.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Uv(t,e){return Sm(t,{...e,weekStartsOn:1})}function Qee(t,e){const r=mi(t,e==null?void 0:e.in),n=r.getFullYear(),a=ho(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Uv(a),o=ho(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Uv(o);return r.getTime()>=s.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function bS(t){const e=mi(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function xbe(t,...e){const r=ho.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function T9(t,e){const r=mi(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function vbe(t,e,r){const[n,a]=xbe(r==null?void 0:r.in,t,e),s=T9(n),o=T9(a),l=+s-bS(s),c=+o-bS(o);return Math.round((l-c)/fbe)}function ybe(t,e){const r=Qee(t,e),n=ho(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Uv(n)}function bbe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function D6(t){return!(!bbe(t)&&typeof t!="number"||isNaN(+mi(t)))}function Ud(t,e){const r=mi(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Qd(t,e){const r=mi(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function wbe(t,e){const r=mi(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Nbe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Cbe=(t,e,r)=>{let n;const a=Nbe[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function T4(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const _be={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ebe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Sbe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jbe={date:T4({formats:_be,defaultWidth:"full"}),time:T4({formats:Ebe,defaultWidth:"full"}),dateTime:T4({formats:Sbe,defaultWidth:"full"})},Ibe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Pbe=(t,e,r,n)=>Ibe[t];function hy(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return a[s]}}const Tbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Bbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kbe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Fbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Obe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Dbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Rbe=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Mbe={ordinalNumber:Rbe,era:hy({values:Tbe,defaultWidth:"wide"}),quarter:hy({values:Bbe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:hy({values:kbe,defaultWidth:"wide"}),day:hy({values:Fbe,defaultWidth:"wide"}),dayPeriod:hy({values:Obe,defaultWidth:"wide",formattingValues:Dbe,defaultFormattingWidth:"wide"})};function Ay(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(a);if(!s)return null;const o=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Ube(l,f=>f.test(o)):Lbe(l,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function Lbe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function Ube(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Qbe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const Vbe=/^(\d+)(th|st|nd|rd)?/i,Hbe=/\d+/i,$be={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Gbe={any:[/^b/i,/^(a|c)/i]},Kbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qbe={any:[/1/i,/2/i,/3/i,/4/i]},zbe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Wbe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Xbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ybe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Jbe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Zbe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},e2e={ordinalNumber:Qbe({matchPattern:Vbe,parsePattern:Hbe,valueCallback:t=>parseInt(t,10)}),era:Ay({matchPatterns:$be,defaultMatchWidth:"wide",parsePatterns:Gbe,defaultParseWidth:"any"}),quarter:Ay({matchPatterns:Kbe,defaultMatchWidth:"wide",parsePatterns:qbe,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ay({matchPatterns:zbe,defaultMatchWidth:"wide",parsePatterns:Wbe,defaultParseWidth:"any"}),day:Ay({matchPatterns:Xbe,defaultMatchWidth:"wide",parsePatterns:Ybe,defaultParseWidth:"any"}),dayPeriod:Ay({matchPatterns:Jbe,defaultMatchWidth:"any",parsePatterns:Zbe,defaultParseWidth:"any"})},Vee={code:"en-US",formatDistance:Cbe,formatLong:jbe,formatRelative:Pbe,localize:Mbe,match:e2e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function t2e(t,e){const r=mi(t,e==null?void 0:e.in);return vbe(r,wbe(r))+1}function Hee(t,e){const r=mi(t,e==null?void 0:e.in),n=+Uv(r)-+ybe(r);return Math.round(n/Uee)+1}function R6(t,e){var d,f,A,h;const r=mi(t,e==null?void 0:e.in),n=r.getFullYear(),a=v1(),s=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(A=a.locale)==null?void 0:A.options)==null?void 0:h.firstWeekContainsDate)??1,o=ho((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const l=Sm(o,e),c=ho((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const u=Sm(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function r2e(t,e){var l,c,u,d;const r=v1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=R6(t,e),s=ho((e==null?void 0:e.in)||t,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),Sm(s,e)}function $ee(t,e){const r=mi(t,e==null?void 0:e.in),n=+Sm(r,e)-+r2e(r,e);return Math.round(n/Uee)+1}function Ja(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const f0={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Ja(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Ja(r+1,2)},d(t,e){return Ja(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Ja(t.getHours()%12||12,e.length)},H(t,e){return Ja(t.getHours(),e.length)},m(t,e){return Ja(t.getMinutes(),e.length)},s(t,e){return Ja(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ja(a,e.length)}},ix={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},B9={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return f0.y(t,e)},Y:function(t,e,r,n){const a=R6(t,n),s=a>0?a:1-a;if(e==="YY"){const o=s%100;return Ja(o,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ja(s,e.length)},R:function(t,e){const r=Qee(t);return Ja(r,e.length)},u:function(t,e){const r=t.getFullYear();return Ja(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Ja(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Ja(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return f0.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Ja(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=$ee(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):Ja(a,e.length)},I:function(t,e,r){const n=Hee(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Ja(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):f0.d(t,e)},D:function(t,e,r){const n=t2e(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ja(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Ja(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Ja(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return Ja(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=ix.noon:n===0?a=ix.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=ix.evening:n>=12?a=ix.afternoon:n>=4?a=ix.morning:a=ix.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return f0.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):f0.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ja(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ja(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):f0.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):f0.s(t,e)},S:function(t,e){return f0.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return F9(n);case"XXXX":case"XX":return hp(n);case"XXXXX":case"XXX":default:return hp(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return F9(n);case"xxxx":case"xx":return hp(n);case"xxxxx":case"xxx":default:return hp(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+k9(n,":");case"OOOO":default:return"GMT"+hp(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+k9(n,":");case"zzzz":default:return"GMT"+hp(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return Ja(n,e.length)},T:function(t,e,r){return Ja(+t,e.length)}};function k9(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+e+Ja(s,2)}function F9(t,e){return t%60===0?(t>0?"-":"+")+Ja(Math.abs(t)/60,2):hp(t,e)}function hp(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Ja(Math.trunc(n/60),2),s=Ja(n%60,2);return r+a+e+s}const O9=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Gee=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},n2e=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return O9(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",O9(n,e)).replace("{{time}}",Gee(a,e))},fk={p:Gee,P:n2e},a2e=/^D+$/,s2e=/^Y+$/,i2e=["D","DD","YY","YYYY"];function Kee(t){return a2e.test(t)}function qee(t){return s2e.test(t)}function hk(t,e,r){const n=o2e(t,e,r);if(console.warn(n),i2e.includes(t))throw new RangeError(n)}function o2e(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const l2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,c2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,u2e=/^'([^]*?)'?$/,d2e=/''/g,f2e=/[a-zA-Z]/;function Lr(t,e,r){var d,f,A,h;const n=v1(),a=n.locale??Vee,s=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(A=n.locale)==null?void 0:A.options)==null?void 0:h.weekStartsOn)??0,l=mi(t,r==null?void 0:r.in);if(!D6(l))throw new RangeError("Invalid time value");let c=e.match(c2e).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=fk[p];return x(m,a.formatLong)}return m}).join("").match(l2e).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:h2e(m)};if(B9[p])return{isToken:!0,value:m};if(p.match(f2e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const u={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(qee(p)||Kee(p))&&hk(p,e,String(t));const x=B9[p[0]];return x(l,p,a.localize,u)}).join("")}function h2e(t){const e=t.match(u2e);return e?e[1].replace(d2e,"'"):t}function A2e(){return Object.assign({},v1())}function m2e(t,e){const r=mi(t,e==null?void 0:e.in).getDay();return r===0?7:r}function p2e(t,e){const r=g2e(e)?new e(0):ho(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function g2e(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const x2e=10;class zee{constructor(){Tr(this,"subPriority",0)}validate(e,r){return!0}}class v2e extends zee{constructor(e,r,n,a,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class y2e extends zee{constructor(r,n){super();Tr(this,"priority",x2e);Tr(this,"subPriority",-1);this.context=r||(a=>ho(n,a))}set(r,n){return n.timestampIsSet?r:ho(r,p2e(r,this.context))}}let Ua=class{run(e,r,n,a){const s=this.parse(e,r,n,a);return s?{setter:new v2e(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}};class b2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",140);Tr(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,n,a){return n.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}const qi={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Wf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function zi(t,e){return t&&{value:e(t.value),rest:t.rest}}function ci(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function Xf(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,a=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(a*Abe+s*hbe+o*mbe),rest:e.slice(r[0].length)}}function Wee(t){return ci(qi.anyDigitsSigned,t)}function Pi(t,e){switch(t){case 1:return ci(qi.singleDigit,e);case 2:return ci(qi.twoDigits,e);case 3:return ci(qi.threeDigits,e);case 4:return ci(qi.fourDigits,e);default:return ci(new RegExp("^\\d{1,"+t+"}"),e)}}function wS(t,e){switch(t){case 1:return ci(qi.singleDigitSigned,e);case 2:return ci(qi.twoDigitsSigned,e);case 3:return ci(qi.threeDigitsSigned,e);case 4:return ci(qi.fourDigitsSigned,e);default:return ci(new RegExp("^-?\\d{1,"+t+"}"),e)}}function M6(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Xee(t,e){const r=e>0,n=r?e:1-e;let a;if(n<=50)a=t||100;else{const s=n+50,o=Math.trunc(s/100)*100,l=t>=s%100;a=t+o-(l?100:0)}return r?a:1-a}function Yee(t){return t%400===0||t%4===0&&t%100!==0}class w2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return zi(Pi(4,r),s);case"yo":return zi(a.ordinalNumber(r,{unit:"year"}),s);default:return zi(Pi(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a){const s=r.getFullYear();if(a.isTwoDigitYear){const l=Xee(a.year,s);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class N2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return zi(Pi(4,r),s);case"Yo":return zi(a.ordinalNumber(r,{unit:"year"}),s);default:return zi(Pi(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a,s){const o=R6(r,s);if(a.isTwoDigitYear){const c=Xee(a.year,o);return r.setFullYear(c,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Sm(r,s)}const l=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Sm(r,s)}}class C2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return wS(n==="R"?4:n.length,r)}set(r,n,a){const s=ho(r,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Uv(s)}}class _2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return wS(n==="u"?4:n.length,r)}set(r,n,a){return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class E2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",120);Tr(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"Q":case"QQ":return Pi(n.length,r);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})||a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class S2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",120);Tr(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"q":case"qq":return Pi(n.length,r);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})||a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class j2e extends Ua{constructor(){super(...arguments);Tr(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Tr(this,"priority",110)}parse(r,n,a){const s=o=>o-1;switch(n){case"M":return zi(ci(qi.month,r),s);case"MM":return zi(Pi(2,r),s);case"Mo":return zi(a.ordinalNumber(r,{unit:"month"}),s);case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})||a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}class I2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",110);Tr(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,a){const s=o=>o-1;switch(n){case"L":return zi(ci(qi.month,r),s);case"LL":return zi(Pi(2,r),s);case"Lo":return zi(a.ordinalNumber(r,{unit:"month"}),s);case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})||a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}function P2e(t,e,r){const n=mi(t,r==null?void 0:r.in),a=$ee(n,r)-e;return n.setDate(n.getDate()-a*7),mi(n,r==null?void 0:r.in)}class T2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",100);Tr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,a){switch(n){case"w":return ci(qi.week,r);case"wo":return a.ordinalNumber(r,{unit:"week"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a,s){return Sm(P2e(r,a,s),s)}}function B2e(t,e,r){const n=mi(t,r==null?void 0:r.in),a=Hee(n,r)-e;return n.setDate(n.getDate()-a*7),n}class k2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",100);Tr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,a){switch(n){case"I":return ci(qi.week,r);case"Io":return a.ordinalNumber(r,{unit:"week"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a){return Uv(B2e(r,a))}}const F2e=[31,28,31,30,31,30,31,31,30,31,30,31],O2e=[31,29,31,30,31,30,31,31,30,31,30,31];class D2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"subPriority",1);Tr(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"d":return ci(qi.date,r);case"do":return a.ordinalNumber(r,{unit:"date"});default:return Pi(n.length,r)}}validate(r,n){const a=r.getFullYear(),s=Yee(a),o=r.getMonth();return s?n>=1&&n<=O2e[o]:n>=1&&n<=F2e[o]}set(r,n,a){return r.setDate(a),r.setHours(0,0,0,0),r}}class R2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"subpriority",1);Tr(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,a){switch(n){case"D":case"DD":return ci(qi.dayOfYear,r);case"Do":return a.ordinalNumber(r,{unit:"date"});default:return Pi(n.length,r)}}validate(r,n){const a=r.getFullYear();return Yee(a)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,a){return r.setMonth(0,a),r.setHours(0,0,0,0),r}}function L6(t,e,r){var f,A,h,m;const n=v1(),a=(r==null?void 0:r.weekStartsOn)??((A=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:A.weekStartsOn)??n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,s=mi(t,r==null?void 0:r.in),o=s.getDay(),c=(e%7+7)%7,u=7-a,d=e<0||e>6?e-(o+u)%7:(c+u)%7-(o+u)%7;return O6(s,d,r)}class M2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=L6(r,a,s),r.setHours(0,0,0,0),r}}class L2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return zi(Pi(n.length,r),o);case"eo":return zi(a.ordinalNumber(r,{unit:"day"}),o);case"eee":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=L6(r,a,s),r.setHours(0,0,0,0),r}}class U2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return zi(Pi(n.length,r),o);case"co":return zi(a.ordinalNumber(r,{unit:"day"}),o);case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})||a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=L6(r,a,s),r.setHours(0,0,0,0),r}}function Q2e(t,e,r){const n=mi(t,r==null?void 0:r.in),a=m2e(n,r),s=e-a;return O6(n,s,r)}class V2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return Pi(n.length,r);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return zi(a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return zi(a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return zi(a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return zi(a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,a){return r=Q2e(r,a),r.setHours(0,0,0,0),r}}class H2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",80);Tr(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(M6(a),0,0,0),r}}class $2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",80);Tr(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(M6(a),0,0,0),r}}class G2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",80);Tr(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(M6(a),0,0,0),r}}class K2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,a){switch(n){case"h":return ci(qi.hour12h,r);case"ho":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,a){const s=r.getHours()>=12;return s&&a<12?r.setHours(a+12,0,0,0):!s&&a===12?r.setHours(0,0,0,0):r.setHours(a,0,0,0),r}}class q2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,a){switch(n){case"H":return ci(qi.hour23h,r);case"Ho":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,a){return r.setHours(a,0,0,0),r}}class z2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,a){switch(n){case"K":return ci(qi.hour11h,r);case"Ko":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.getHours()>=12&&a<12?r.setHours(a+12,0,0,0):r.setHours(a,0,0,0),r}}class W2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,a){switch(n){case"k":return ci(qi.hour24h,r);case"ko":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,a){const s=a<=24?a%24:a;return r.setHours(s,0,0,0),r}}class X2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",60);Tr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"m":return ci(qi.minute,r);case"mo":return a.ordinalNumber(r,{unit:"minute"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setMinutes(a,0,0),r}}class Y2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",50);Tr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"s":return ci(qi.second,r);case"so":return a.ordinalNumber(r,{unit:"second"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setSeconds(a,0),r}}class J2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",30);Tr(this,"incompatibleTokens",["t","T"])}parse(r,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return zi(Pi(n.length,r),a)}set(r,n,a){return r.setMilliseconds(a),r}}class Z2e extends Ua{constructor(){super(...arguments);Tr(this,"priority",10);Tr(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return Xf(Wf.basicOptionalMinutes,r);case"XX":return Xf(Wf.basic,r);case"XXXX":return Xf(Wf.basicOptionalSeconds,r);case"XXXXX":return Xf(Wf.extendedOptionalSeconds,r);case"XXX":default:return Xf(Wf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:ho(r,r.getTime()-bS(r)-a)}}class ewe extends Ua{constructor(){super(...arguments);Tr(this,"priority",10);Tr(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return Xf(Wf.basicOptionalMinutes,r);case"xx":return Xf(Wf.basic,r);case"xxxx":return Xf(Wf.basicOptionalSeconds,r);case"xxxxx":return Xf(Wf.extendedOptionalSeconds,r);case"xxx":default:return Xf(Wf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:ho(r,r.getTime()-bS(r)-a)}}class twe extends Ua{constructor(){super(...arguments);Tr(this,"priority",40);Tr(this,"incompatibleTokens","*")}parse(r){return Wee(r)}set(r,n,a){return[ho(r,a*1e3),{timestampIsSet:!0}]}}class rwe extends Ua{constructor(){super(...arguments);Tr(this,"priority",20);Tr(this,"incompatibleTokens","*")}parse(r){return Wee(r)}set(r,n,a){return[ho(r,a),{timestampIsSet:!0}]}}const nwe={G:new b2e,y:new w2e,Y:new N2e,R:new C2e,u:new _2e,Q:new E2e,q:new S2e,M:new j2e,L:new I2e,w:new T2e,I:new k2e,d:new D2e,D:new R2e,E:new M2e,e:new L2e,c:new U2e,i:new V2e,a:new H2e,b:new $2e,B:new G2e,h:new K2e,H:new q2e,K:new z2e,k:new W2e,m:new X2e,s:new Y2e,S:new J2e,X:new Z2e,x:new ewe,t:new twe,T:new rwe},awe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,swe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,iwe=/^'([^]*?)'?$/,owe=/''/g,lwe=/\S/,cwe=/[a-zA-Z]/;function NS(t,e,r,n){var x,v,y,b;const a=()=>ho(r,NaN),s=A2e(),o=s.locale??Vee,l=s.firstWeekContainsDate??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.firstWeekContainsDate)??1,c=s.weekStartsOn??((b=(y=s.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??0;if(!e)return t?a():mi(r,n==null?void 0:n.in);const u={firstWeekContainsDate:l,weekStartsOn:c,locale:o},d=[new y2e(n==null?void 0:n.in,r)],f=e.match(swe).map(w=>{const I=w[0];if(I in fk){const j=fk[I];return j(w,o.formatLong)}return w}).join("").match(awe),A=[];for(let w of f){qee(w)&&hk(w,e,t),Kee(w)&&hk(w,e,t);const I=w[0],j=nwe[I];if(j){const{incompatibleTokens:C}=j;if(Array.isArray(C)){const E=A.find(B=>C.includes(B.token)||B.token===I);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${w}\` at the same time`)}else if(j.incompatibleTokens==="*"&&A.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);A.push({token:I,fullToken:w});const S=j.run(t,w,o.match,u);if(!S)return a();d.push(S.setter),t=S.rest}else{if(I.match(cwe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+I+"`");if(w==="''"?w="'":I==="'"&&(w=uwe(w)),t.indexOf(w)===0)t=t.slice(w.length);else return a()}}if(t.length>0&&lwe.test(t))return a();const h=d.map(w=>w.priority).sort((w,I)=>I-w).filter((w,I,j)=>j.indexOf(w)===I).map(w=>d.filter(I=>I.priority===w).sort((I,j)=>j.subPriority-I.subPriority)).map(w=>w[0]);let m=mi(r,n==null?void 0:n.in);if(isNaN(+m))return a();const p={};for(const w of h){if(!w.validate(m,u))return a();const I=w.set(m,p,u);Array.isArray(I)?(m=I[0],Object.assign(p,I[1])):m=I}return m}function uwe(t){return t.match(iwe)[1].replace(owe,"'")}function Jee(t,e,r){return O6(t,-14,r)}function dwe(t,e,r){return pbe(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ak=function(t,e){return Ak=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Ak(t,e)};function Pf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ak(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var mk=function(){return mk=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mk.apply(this,arguments)};function wc(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,[])).next())})}function Jl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function cC(t,e,r){if(arguments.length===2)for(var n=0,a=e.length,s;n<a;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||e)}var bA=function(){function t(e,r,n,a){this.left=e,this.top=r,this.width=n,this.height=a}return t.prototype.add=function(e,r,n,a){return new t(this.left+e,this.top+r,this.width+n,this.height+a)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),XI=function(t,e){return bA.fromClientRect(t,e.getBoundingClientRect())},fwe=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),a=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new bA(0,0,n,a)},YI=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},Qi=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},D9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hwe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var uC=0;uC<D9.length;uC++)hwe[D9.charCodeAt(uC)]=uC;var R9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ky=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var dC=0;dC<R9.length;dC++)Ky[R9.charCodeAt(dC)]=dC;var Awe=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Ky[t.charCodeAt(n)],o=Ky[t.charCodeAt(n+1)],l=Ky[t.charCodeAt(n+2)],c=Ky[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},mwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},pwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Lp=5,U6=11,B4=2,gwe=U6-Lp,Zee=65536>>Lp,xwe=1<<Lp,k4=xwe-1,vwe=1024>>Lp,ywe=Zee+vwe,bwe=ywe,wwe=32,Nwe=bwe+wwe,Cwe=65536>>U6,_we=1<<gwe,Ewe=_we-1,M9=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Swe=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},jwe=function(t,e){var r=Awe(t),n=Array.isArray(r)?pwe(r):new Uint32Array(r),a=Array.isArray(r)?mwe(r):new Uint16Array(r),s=24,o=M9(a,s/2,n[4]/2),l=n[5]===2?M9(a,(s+n[4])/2):Swe(n,Math.ceil((s+n[4])/4));return new Iwe(n[0],n[1],n[2],n[3],o,l)},Iwe=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Lp],r=(r<<B4)+(e&k4),this.data[r];if(e<=65535)return r=this.index[Zee+(e-55296>>Lp)],r=(r<<B4)+(e&k4),this.data[r];if(e<this.highStart)return r=Nwe-Cwe+(e>>U6),r=this.index[r],r+=e>>Lp&Ewe,r=this.index[r],r=(r<<B4)+(e&k4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),L9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pwe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var fC=0;fC<L9.length;fC++)Pwe[L9.charCodeAt(fC)]=fC;var Twe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",U9=50,Bwe=1,ete=2,tte=3,kwe=4,Fwe=5,Q9=7,rte=8,V9=9,z0=10,pk=11,H9=12,gk=13,Owe=14,qy=15,xk=16,hC=17,my=18,Dwe=19,$9=20,vk=21,py=22,F4=23,ox=24,Eu=25,zy=26,Wy=27,lx=28,Rwe=29,Np=30,Mwe=31,AC=32,mC=33,yk=34,bk=35,wk=36,S2=37,Nk=38,hE=39,AE=40,O4=41,nte=42,Lwe=43,Uwe=[9001,65288],ate="!",fa="",pC="",Ck=jwe(Twe),Sh=[Np,wk],_k=[Bwe,ete,tte,Fwe],ste=[z0,rte],G9=[Wy,zy],Qwe=_k.concat(ste),K9=[Nk,hE,AE,yk,bk],Vwe=[qy,gk],Hwe=function(t,e){e===void 0&&(e="strict");var r=[],n=[],a=[];return t.forEach(function(s,o){var l=Ck.get(s);if(l>U9?(a.push(!0),l-=U9):a.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(o),r.push(xk);if(l===kwe||l===pk){if(o===0)return n.push(o),r.push(Np);var c=r[o-1];return Qwe.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(Np))}if(n.push(o),l===Mwe)return r.push(e==="strict"?vk:S2);if(l===nte||l===Rwe)return r.push(Np);if(l===Lwe)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(S2):r.push(Np);r.push(l)}),[n,r,a]},D4=function(t,e,r,n){var a=n[r];if(Array.isArray(t)?t.indexOf(a)!==-1:t===a)for(var s=r;s<=n.length;){s++;var o=n[s];if(o===e)return!0;if(o!==z0)break}if(a===z0)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==z0)break}if(l!==z0)break}return!1},q9=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===z0)r--;else return n}return 0},$we=function(t,e,r,n,a){if(r[n]===0)return fa;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return fa;var o=s-1,l=s+1,c=e[s],u=o>=0?e[o]:0,d=e[l];if(c===ete&&d===tte)return fa;if(_k.indexOf(c)!==-1)return ate;if(_k.indexOf(d)!==-1||ste.indexOf(d)!==-1)return fa;if(q9(s,e)===rte)return pC;if(Ck.get(t[s])===pk||(c===AC||c===mC)&&Ck.get(t[l])===pk||c===Q9||d===Q9||c===V9||[z0,gk,qy].indexOf(c)===-1&&d===V9||[hC,my,Dwe,ox,lx].indexOf(d)!==-1||q9(s,e)===py||D4(F4,py,s,e)||D4([hC,my],vk,s,e)||D4(H9,H9,s,e))return fa;if(c===z0)return pC;if(c===F4||d===F4)return fa;if(d===xk||c===xk)return pC;if([gk,qy,vk].indexOf(d)!==-1||c===Owe||u===wk&&Vwe.indexOf(c)!==-1||c===lx&&d===wk||d===$9||Sh.indexOf(d)!==-1&&c===Eu||Sh.indexOf(c)!==-1&&d===Eu||c===Wy&&[S2,AC,mC].indexOf(d)!==-1||[S2,AC,mC].indexOf(c)!==-1&&d===zy||Sh.indexOf(c)!==-1&&G9.indexOf(d)!==-1||G9.indexOf(c)!==-1&&Sh.indexOf(d)!==-1||[Wy,zy].indexOf(c)!==-1&&(d===Eu||[py,qy].indexOf(d)!==-1&&e[l+1]===Eu)||[py,qy].indexOf(c)!==-1&&d===Eu||c===Eu&&[Eu,lx,ox].indexOf(d)!==-1)return fa;if([Eu,lx,ox,hC,my].indexOf(d)!==-1)for(var f=s;f>=0;){var A=e[f];if(A===Eu)return fa;if([lx,ox].indexOf(A)!==-1)f--;else break}if([Wy,zy].indexOf(d)!==-1)for(var f=[hC,my].indexOf(c)!==-1?o:s;f>=0;){var A=e[f];if(A===Eu)return fa;if([lx,ox].indexOf(A)!==-1)f--;else break}if(Nk===c&&[Nk,hE,yk,bk].indexOf(d)!==-1||[hE,yk].indexOf(c)!==-1&&[hE,AE].indexOf(d)!==-1||[AE,bk].indexOf(c)!==-1&&d===AE||K9.indexOf(c)!==-1&&[$9,zy].indexOf(d)!==-1||K9.indexOf(d)!==-1&&c===Wy||Sh.indexOf(c)!==-1&&Sh.indexOf(d)!==-1||c===ox&&Sh.indexOf(d)!==-1||Sh.concat(Eu).indexOf(c)!==-1&&d===py&&Uwe.indexOf(t[l])===-1||Sh.concat(Eu).indexOf(d)!==-1&&c===my)return fa;if(c===O4&&d===O4){for(var h=r[s],m=1;h>0&&(h--,e[h]===O4);)m++;if(m%2!==0)return fa}return c===AC&&d===mC?fa:pC},Gwe=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=Hwe(t,e.lineBreak),n=r[0],a=r[1],s=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(a=a.map(function(l){return[Eu,Np,nte].indexOf(l)!==-1?S2:l}));var o=e.wordBreak==="keep-all"?s.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,a,o]},Kwe=function(){function t(e,r,n,a){this.codePoints=e,this.required=r===ate,this.start=n,this.end=a}return t.prototype.slice=function(){return Qi.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),qwe=function(t,e){var r=YI(t),n=Gwe(r,e),a=n[0],s=n[1],o=n[2],l=r.length,c=0,u=0;return{next:function(){if(u>=l)return{done:!0,value:null};for(var d=fa;u<l&&(d=$we(r,s,a,++u,o))===fa;);if(d!==fa||u===l){var f=new Kwe(r,d,c,u);return c=u,{value:f,done:!1}}return{done:!0,value:null}}}},zwe=1,Wwe=2,Rw=4,z9=8,CS=10,W9=47,Cb=92,Xwe=9,Ywe=32,gC=34,gy=61,Jwe=35,Zwe=36,eNe=37,xC=39,vC=40,xy=41,tNe=95,Zc=45,rNe=33,nNe=60,aNe=62,sNe=64,iNe=91,oNe=93,lNe=61,cNe=123,yC=63,uNe=125,X9=124,dNe=126,fNe=128,Y9=65533,R4=42,Ip=43,hNe=44,ANe=58,mNe=59,j2=46,pNe=0,gNe=8,xNe=11,vNe=14,yNe=31,bNe=127,Lf=-1,ite=48,ote=97,lte=101,wNe=102,NNe=117,CNe=122,cte=65,ute=69,dte=70,_Ne=85,ENe=90,tc=function(t){return t>=ite&&t<=57},SNe=function(t){return t>=55296&&t<=57343},cx=function(t){return tc(t)||t>=cte&&t<=dte||t>=ote&&t<=wNe},jNe=function(t){return t>=ote&&t<=CNe},INe=function(t){return t>=cte&&t<=ENe},PNe=function(t){return jNe(t)||INe(t)},TNe=function(t){return t>=fNe},bC=function(t){return t===CS||t===Xwe||t===Ywe},_S=function(t){return PNe(t)||TNe(t)||t===tNe},J9=function(t){return _S(t)||tc(t)||t===Zc},BNe=function(t){return t>=pNe&&t<=gNe||t===xNe||t>=vNe&&t<=yNe||t===bNe},P0=function(t,e){return t!==Cb?!1:e!==CS},wC=function(t,e,r){return t===Zc?_S(e)||P0(e,r):_S(t)?!0:!!(t===Cb&&P0(t,e))},M4=function(t,e,r){return t===Ip||t===Zc?tc(e)?!0:e===j2&&tc(r):tc(t===j2?e:t)},kNe=function(t){var e=0,r=1;(t[e]===Ip||t[e]===Zc)&&(t[e]===Zc&&(r=-1),e++);for(var n=[];tc(t[e]);)n.push(t[e++]);var a=n.length?parseInt(Qi.apply(void 0,n),10):0;t[e]===j2&&e++;for(var s=[];tc(t[e]);)s.push(t[e++]);var o=s.length,l=o?parseInt(Qi.apply(void 0,s),10):0;(t[e]===ute||t[e]===lte)&&e++;var c=1;(t[e]===Ip||t[e]===Zc)&&(t[e]===Zc&&(c=-1),e++);for(var u=[];tc(t[e]);)u.push(t[e++]);var d=u.length?parseInt(Qi.apply(void 0,u),10):0;return r*(a+l*Math.pow(10,-o))*Math.pow(10,c*d)},FNe={type:2},ONe={type:3},DNe={type:4},RNe={type:13},MNe={type:8},LNe={type:21},UNe={type:9},QNe={type:10},VNe={type:11},HNe={type:12},$Ne={type:14},NC={type:23},GNe={type:1},KNe={type:25},qNe={type:24},zNe={type:26},WNe={type:27},XNe={type:28},YNe={type:29},JNe={type:31},Ek={type:32},fte=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(YI(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==Ek;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case gC:return this.consumeStringToken(gC);case Jwe:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(J9(r)||P0(n,a)){var s=wC(r,n,a)?Wwe:zwe,o=this.consumeName();return{type:5,value:o,flags:s}}break;case Zwe:if(this.peekCodePoint(0)===gy)return this.consumeCodePoint(),RNe;break;case xC:return this.consumeStringToken(xC);case vC:return FNe;case xy:return ONe;case R4:if(this.peekCodePoint(0)===gy)return this.consumeCodePoint(),$Ne;break;case Ip:if(M4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case hNe:return DNe;case Zc:var l=e,c=this.peekCodePoint(0),u=this.peekCodePoint(1);if(M4(l,c,u))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(wC(l,c,u))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===Zc&&u===aNe)return this.consumeCodePoint(),this.consumeCodePoint(),qNe;break;case j2:if(M4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case W9:if(this.peekCodePoint(0)===R4)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===R4&&(d=this.consumeCodePoint(),d===W9))return this.consumeToken();if(d===Lf)return this.consumeToken()}break;case ANe:return zNe;case mNe:return WNe;case nNe:if(this.peekCodePoint(0)===rNe&&this.peekCodePoint(1)===Zc&&this.peekCodePoint(2)===Zc)return this.consumeCodePoint(),this.consumeCodePoint(),KNe;break;case sNe:var f=this.peekCodePoint(0),A=this.peekCodePoint(1),h=this.peekCodePoint(2);if(wC(f,A,h)){var o=this.consumeName();return{type:7,value:o}}break;case iNe:return XNe;case Cb:if(P0(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case oNe:return YNe;case lNe:if(this.peekCodePoint(0)===gy)return this.consumeCodePoint(),MNe;break;case cNe:return VNe;case uNe:return HNe;case NNe:case _Ne:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===Ip&&(cx(p)||p===yC)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case X9:if(this.peekCodePoint(0)===gy)return this.consumeCodePoint(),UNe;if(this.peekCodePoint(0)===X9)return this.consumeCodePoint(),LNe;break;case dNe:if(this.peekCodePoint(0)===gy)return this.consumeCodePoint(),QNe;break;case Lf:return Ek}return bC(e)?(this.consumeWhiteSpace(),JNe):tc(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):_S(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Qi(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();cx(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===yC&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(Qi.apply(void 0,e.map(function(c){return c===yC?ite:c})),16),s=parseInt(Qi.apply(void 0,e.map(function(c){return c===yC?dte:c})),16);return{type:30,start:a,end:s}}var o=parseInt(Qi.apply(void 0,e),16);if(this.peekCodePoint(0)===Zc&&cx(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];cx(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt(Qi.apply(void 0,l),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===vC?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===vC?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Lf)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===xC||r===gC){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Lf||this.peekCodePoint(0)===xy)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),NC)}for(;;){var a=this.consumeCodePoint();if(a===Lf||a===xy)return{type:22,value:Qi.apply(void 0,e)};if(bC(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Lf||this.peekCodePoint(0)===xy?(this.consumeCodePoint(),{type:22,value:Qi.apply(void 0,e)}):(this.consumeBadUrlRemnants(),NC);if(a===gC||a===xC||a===vC||BNe(a))return this.consumeBadUrlRemnants(),NC;if(a===Cb)if(P0(a,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),NC;else e.push(a)}},t.prototype.consumeWhiteSpace=function(){for(;bC(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===xy||e===Lf)return;P0(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var a=Math.min(r,e);n+=Qi.apply(void 0,this._value.splice(0,a)),e-=a}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var a=this._value[n];if(a===Lf||a===void 0||a===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===CS)return this._value.splice(0,n),GNe;if(a===Cb){var s=this._value[n+1];s!==Lf&&s!==void 0&&(s===CS?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):P0(a,s)&&(r+=this.consumeStringSlice(n),r+=Qi(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Rw,n=this.peekCodePoint(0);for((n===Ip||n===Zc)&&e.push(this.consumeCodePoint());tc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===j2&&tc(a))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=z9;tc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===ute||n===lte)&&((a===Ip||a===Zc)&&tc(s)||tc(a)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=z9;tc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[kNe(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(wC(a,s,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===eNe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(cx(e)){for(var r=Qi(e);cx(this.peekCodePoint(0))&&r.length<6;)r+=Qi(this.consumeCodePoint());bC(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||SNe(n)||n>1114111?Y9:n}return e===Lf?Y9:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(J9(r))e+=Qi(r);else if(P0(r,this.peekCodePoint(0)))e+=Qi(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),hte=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new fte;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||eCe(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?Ek:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Mw=function(t){return t.type===15},y1=function(t){return t.type===17},cs=function(t){return t.type===20},ZNe=function(t){return t.type===0},Sk=function(t,e){return cs(t)&&t.value===e},Ate=function(t){return t.type!==31},Qv=function(t){return t.type!==31&&t.type!==4},ph=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},eCe=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},jm=function(t){return t.type===17||t.type===15},oo=function(t){return t.type===16||jm(t)},mte=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Pl={type:17,number:0,flags:Rw},Q6={type:16,number:50,flags:Rw},W0={type:16,number:100,flags:Rw},Xy=function(t,e,r){var n=t[0],a=t[1];return[ws(n,e),ws(typeof a<"u"?a:n,r)]},ws=function(t,e){if(t.type===16)return t.number/100*e;if(Mw(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},pte="deg",gte="grad",xte="rad",vte="turn",JI={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case pte:return Math.PI*e.number/180;case gte:return Math.PI/200*e.number;case xte:return e.number;case vte:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},yte=function(t){return t.type===15&&(t.unit===pte||t.unit===gte||t.unit===xte||t.unit===vte)},bte=function(t){var e=t.filter(cs).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Pl,Pl];case"to top":case"bottom":return Cd(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Pl,W0];case"to right":case"left":return Cd(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[W0,W0];case"to bottom":case"top":return Cd(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[W0,Pl];case"to left":case"right":return Cd(270)}return 0},Cd=function(t){return Math.PI*t/180},hm={name:"color",parse:function(t,e){if(e.type===18){var r=tCe[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3);return X0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return X0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6);return X0(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return X0(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var l=oA[e.value.toUpperCase()];if(typeof l<"u")return l}return oA.TRANSPARENT}},Am=function(t){return(255&t)===0},$o=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,a=255&t>>24;return e<255?"rgba("+a+","+n+","+r+","+e/255+")":"rgb("+a+","+n+","+r+")"},X0=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},Z9=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},eQ=function(t,e){var r=e.filter(Qv);if(r.length===3){var n=r.map(Z9),a=n[0],s=n[1],o=n[2];return X0(a,s,o,1)}if(r.length===4){var l=r.map(Z9),a=l[0],s=l[1],o=l[2],c=l[3];return X0(a,s,o,c)}return 0};function L4(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var tQ=function(t,e){var r=e.filter(Qv),n=r[0],a=r[1],s=r[2],o=r[3],l=(n.type===17?Cd(n.number):JI.parse(t,n))/(Math.PI*2),c=oo(a)?a.number/100:0,u=oo(s)?s.number/100:0,d=typeof o<"u"&&oo(o)?ws(o,1):1;if(c===0)return X0(u*255,u*255,u*255,1);var f=u<=.5?u*(c+1):u+c-u*c,A=u*2-f,h=L4(A,f,l+1/3),m=L4(A,f,l),p=L4(A,f,l-1/3);return X0(h*255,m*255,p*255,d)},tCe={hsl:tQ,hsla:tQ,rgb:eQ,rgba:eQ},_b=function(t,e){return hm.parse(t,hte.create(e).parseComponentValue())},oA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},rCe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(cs(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},nCe={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ZI=function(t,e){var r=hm.parse(t,e[0]),n=e[1];return n&&oo(n)?{color:r,stop:n}:{color:r,stop:null}},rQ=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=Pl),n.stop===null&&(n.stop=W0);for(var a=[],s=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=ws(l,e);c>s?a.push(c):a.push(s),s=c}else a.push(null)}for(var u=null,o=0;o<a.length;o++){var d=a[o];if(d===null)u===null&&(u=o);else if(u!==null){for(var f=o-u,A=a[u-1],h=(d-A)/(f+1),m=1;m<=f;m++)a[u+m-1]=h*m;u=null}}return t.map(function(p,x){var v=p.color;return{color:v,stop:Math.max(Math.min(1,a[x]/e),0)}})},aCe=function(t,e,r){var n=e/2,a=r/2,s=ws(t[0],e)-n,o=a-ws(t[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},sCe=function(t,e,r){var n=typeof t=="number"?t:aCe(t,e,r),a=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),s=e/2,o=r/2,l=a/2,c=Math.sin(n-Math.PI/2)*l,u=Math.cos(n-Math.PI/2)*l;return[a,s-u,s+u,o-c,o+c]},af=function(t,e){return Math.sqrt(t*t+e*e)},nQ=function(t,e,r,n,a){var s=[[0,0],[0,e],[t,0],[t,e]];return s.reduce(function(o,l){var c=l[0],u=l[1],d=af(r-c,n-u);return(a?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},iCe=function(t,e,r,n,a){var s=0,o=0;switch(t.size){case 0:t.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(t.shape===0)s=o=Math.min(af(e,r),af(e,r-a),af(e-n,r),af(e-n,r-a));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(e),Math.abs(e-n)),c=nQ(n,a,e,r,!0),u=c[0],d=c[1];s=af(u-e,(d-r)/l),o=l*s}break;case 1:t.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(t.shape===0)s=o=Math.max(af(e,r),af(e,r-a),af(e-n,r),af(e-n,r-a));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(e),Math.abs(e-n)),f=nQ(n,a,e,r,!1),u=f[0],d=f[1];s=af(u-e,(d-r)/l),o=l*s}break}return Array.isArray(t.size)&&(s=ws(t.size[0],n),o=t.size.length===2?ws(t.size[1],a):s),[s,o]},oCe=function(t,e){var r=Cd(180),n=[];return ph(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&o.value==="to"){r=bte(a);return}else if(yte(o)){r=JI.parse(t,o);return}}var l=ZI(t,a);n.push(l)}),{angle:r,stops:n,type:1}},CC=function(t,e){var r=Cd(180),n=[];return ph(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=bte(a);return}else if(yte(o)){r=(JI.parse(t,o)+Cd(270))%Cd(360);return}}var l=ZI(t,a);n.push(l)}),{angle:r,stops:n,type:1}},lCe=function(t,e){var r=Cd(180),n=[],a=1,s=0,o=3,l=[];return ph(e).forEach(function(c,u){var d=c[0];if(u===0){if(cs(d)&&d.value==="linear"){a=1;return}else if(cs(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var f=hm.parse(t,d.values[0]);n.push({stop:Pl,color:f})}else if(d.name==="to"){var f=hm.parse(t,d.values[0]);n.push({stop:W0,color:f})}else if(d.name==="color-stop"){var A=d.values.filter(Qv);if(A.length===2){var f=hm.parse(t,A[1]),h=A[0];y1(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:f})}}}}),a===1?{angle:(r+Cd(180))%Cd(360),stops:n,type:a}:{size:o,shape:s,stops:n,position:l,type:a}},wte="closest-side",Nte="farthest-side",Cte="closest-corner",_te="farthest-corner",Ete="circle",Ste="ellipse",jte="cover",Ite="contain",cCe=function(t,e){var r=0,n=3,a=[],s=[];return ph(e).forEach(function(o,l){var c=!0;if(l===0){var u=!1;c=o.reduce(function(f,A){if(u)if(cs(A))switch(A.value){case"center":return s.push(Q6),f;case"top":case"left":return s.push(Pl),f;case"right":case"bottom":return s.push(W0),f}else(oo(A)||jm(A))&&s.push(A);else if(cs(A))switch(A.value){case Ete:return r=0,!1;case Ste:return r=1,!1;case"at":return u=!0,!1;case wte:return n=0,!1;case jte:case Nte:return n=1,!1;case Ite:case Cte:return n=2,!1;case _te:return n=3,!1}else if(jm(A)||oo(A))return Array.isArray(n)||(n=[]),n.push(A),!1;return f},c)}if(c){var d=ZI(t,o);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},_C=function(t,e){var r=0,n=3,a=[],s=[];return ph(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,f){if(cs(f))switch(f.value){case"center":return s.push(Q6),!1;case"top":case"left":return s.push(Pl),!1;case"right":case"bottom":return s.push(W0),!1}else if(oo(f)||jm(f))return s.push(f),!1;return d},c):l===1&&(c=o.reduce(function(d,f){if(cs(f))switch(f.value){case Ete:return r=0,!1;case Ste:return r=1,!1;case Ite:case wte:return n=0,!1;case Nte:return n=1,!1;case Cte:return n=2,!1;case jte:case _te:return n=3,!1}else if(jm(f)||oo(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)),c){var u=ZI(t,o);a.push(u)}}),{size:n,shape:r,stops:a,position:s,type:2}},uCe=function(t){return t.type===1},dCe=function(t){return t.type===2},V6={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=Pte[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function fCe(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!Pte[t.name])}var Pte={"linear-gradient":oCe,"-moz-linear-gradient":CC,"-ms-linear-gradient":CC,"-o-linear-gradient":CC,"-webkit-linear-gradient":CC,"radial-gradient":cCe,"-moz-radial-gradient":_C,"-ms-radial-gradient":_C,"-o-radial-gradient":_C,"-webkit-radial-gradient":_C,"-webkit-gradient":lCe},hCe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Qv(n)&&fCe(n)}).map(function(n){return V6.parse(t,n)})}},ACe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(cs(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},mCe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return ph(e).map(function(r){return r.filter(oo)}).map(mte)}},pCe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return ph(e).map(function(r){return r.filter(cs).map(function(n){return n.value}).join(" ")}).map(gCe)}},gCe=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},mv;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(mv||(mv={}));var xCe={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return ph(e).map(function(r){return r.filter(vCe)})}},vCe=function(t){return cs(t)||oo(t)},eP=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},yCe=eP("top"),bCe=eP("right"),wCe=eP("bottom"),NCe=eP("left"),tP=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return mte(r.filter(oo))}}},CCe=tP("top-left"),_Ce=tP("top-right"),ECe=tP("bottom-right"),SCe=tP("bottom-left"),rP=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},jCe=rP("top"),ICe=rP("right"),PCe=rP("bottom"),TCe=rP("left"),nP=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Mw(r)?r.number:0}}},BCe=nP("top"),kCe=nP("right"),FCe=nP("bottom"),OCe=nP("left"),DCe={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},RCe={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},MCe={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(cs).reduce(function(r,n){return r|LCe(n.value)},0)}},LCe=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},UCe={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},QCe={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},ES;(function(t){t.NORMAL="normal",t.STRICT="strict"})(ES||(ES={}));var VCe={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return ES.STRICT;case"normal":default:return ES.NORMAL}}},HCe={name:"line-height",initialValue:"normal",prefix:!1,type:4},aQ=function(t,e){return cs(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:oo(t)?ws(t,e):e},$Ce={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:V6.parse(t,e)}},GCe={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},jk={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},aP=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},KCe=aP("top"),qCe=aP("right"),zCe=aP("bottom"),WCe=aP("left"),XCe={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(cs).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},YCe={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},sP=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},JCe=sP("top"),ZCe=sP("right"),e_e=sP("bottom"),t_e=sP("left"),r_e={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},n_e={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},a_e={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Sk(e[0],"none")?[]:ph(e).map(function(r){for(var n={color:oA.TRANSPARENT,offsetX:Pl,offsetY:Pl,blur:Pl},a=0,s=0;s<r.length;s++){var o=r[s];jm(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:n.blur=o,a++):n.color=hm.parse(t,o)}return n})}},s_e={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},i_e={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=c_e[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},o_e=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},l_e=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var a=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,a,s,o,l]:null},c_e={matrix:o_e,matrix3d:l_e},sQ={type:16,number:50,flags:Rw},u_e=[sQ,sQ],d_e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(oo);return r.length!==2?u_e:[r[0],r[1]]}},f_e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Eb;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Eb||(Eb={}));var h_e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Eb.BREAK_ALL;case"keep-all":return Eb.KEEP_ALL;case"normal":default:return Eb.NORMAL}}},A_e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(y1(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Tte={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},m_e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return y1(e)?e.number:1}},p_e={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},g_e={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(cs).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},x_e={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},v_e={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},y_e={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(y1(e))return e.number;if(cs(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},b_e={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(cs).map(function(r){return r.value})}},w_e={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Io=function(t,e){return(t&e)!==0},N_e={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},C_e={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=e.filter(Ate),s=0;s<a.length;s++){var o=a[s],l=a[s+1];if(o.type===20){var c=l&&y1(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},__e={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(Ate),a=0;a<n.length;a++){var s=n[a],o=n[a+1];if(cs(s)&&s.value!=="none"){var l=o&&y1(o)?o.number:0;r.push({counter:s.value,reset:l})}}return r}},E_e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Mw).map(function(r){return Tte.parse(t,r)})}},S_e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],a=e.filter(ZNe);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var o=a[s].value,l=a[s+1].value;n.push({open:o,close:l})}return n}},iQ=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},j_e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Sk(e[0],"none")?[]:ph(e).map(function(r){for(var n={color:255,offsetX:Pl,offsetY:Pl,blur:Pl,spread:Pl,inset:!1},a=0,s=0;s<r.length;s++){var o=r[s];Sk(o,"inset")?n.inset=!0:jm(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:a===2?n.blur=o:n.spread=o,a++):n.color=hm.parse(t,o)}return n})}},I_e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(cs).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},P_e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},T_e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Mw(e)?e.number:0}},B_e=function(){function t(e,r){var n,a;this.animationDuration=tn(e,E_e,r.animationDuration),this.backgroundClip=tn(e,rCe,r.backgroundClip),this.backgroundColor=tn(e,nCe,r.backgroundColor),this.backgroundImage=tn(e,hCe,r.backgroundImage),this.backgroundOrigin=tn(e,ACe,r.backgroundOrigin),this.backgroundPosition=tn(e,mCe,r.backgroundPosition),this.backgroundRepeat=tn(e,pCe,r.backgroundRepeat),this.backgroundSize=tn(e,xCe,r.backgroundSize),this.borderTopColor=tn(e,yCe,r.borderTopColor),this.borderRightColor=tn(e,bCe,r.borderRightColor),this.borderBottomColor=tn(e,wCe,r.borderBottomColor),this.borderLeftColor=tn(e,NCe,r.borderLeftColor),this.borderTopLeftRadius=tn(e,CCe,r.borderTopLeftRadius),this.borderTopRightRadius=tn(e,_Ce,r.borderTopRightRadius),this.borderBottomRightRadius=tn(e,ECe,r.borderBottomRightRadius),this.borderBottomLeftRadius=tn(e,SCe,r.borderBottomLeftRadius),this.borderTopStyle=tn(e,jCe,r.borderTopStyle),this.borderRightStyle=tn(e,ICe,r.borderRightStyle),this.borderBottomStyle=tn(e,PCe,r.borderBottomStyle),this.borderLeftStyle=tn(e,TCe,r.borderLeftStyle),this.borderTopWidth=tn(e,BCe,r.borderTopWidth),this.borderRightWidth=tn(e,kCe,r.borderRightWidth),this.borderBottomWidth=tn(e,FCe,r.borderBottomWidth),this.borderLeftWidth=tn(e,OCe,r.borderLeftWidth),this.boxShadow=tn(e,j_e,r.boxShadow),this.color=tn(e,DCe,r.color),this.direction=tn(e,RCe,r.direction),this.display=tn(e,MCe,r.display),this.float=tn(e,UCe,r.cssFloat),this.fontFamily=tn(e,x_e,r.fontFamily),this.fontSize=tn(e,v_e,r.fontSize),this.fontStyle=tn(e,w_e,r.fontStyle),this.fontVariant=tn(e,b_e,r.fontVariant),this.fontWeight=tn(e,y_e,r.fontWeight),this.letterSpacing=tn(e,QCe,r.letterSpacing),this.lineBreak=tn(e,VCe,r.lineBreak),this.lineHeight=tn(e,HCe,r.lineHeight),this.listStyleImage=tn(e,$Ce,r.listStyleImage),this.listStylePosition=tn(e,GCe,r.listStylePosition),this.listStyleType=tn(e,jk,r.listStyleType),this.marginTop=tn(e,KCe,r.marginTop),this.marginRight=tn(e,qCe,r.marginRight),this.marginBottom=tn(e,zCe,r.marginBottom),this.marginLeft=tn(e,WCe,r.marginLeft),this.opacity=tn(e,m_e,r.opacity);var s=tn(e,XCe,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=tn(e,YCe,r.overflowWrap),this.paddingTop=tn(e,JCe,r.paddingTop),this.paddingRight=tn(e,ZCe,r.paddingRight),this.paddingBottom=tn(e,e_e,r.paddingBottom),this.paddingLeft=tn(e,t_e,r.paddingLeft),this.paintOrder=tn(e,I_e,r.paintOrder),this.position=tn(e,n_e,r.position),this.textAlign=tn(e,r_e,r.textAlign),this.textDecorationColor=tn(e,p_e,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=tn(e,g_e,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=tn(e,a_e,r.textShadow),this.textTransform=tn(e,s_e,r.textTransform),this.transform=tn(e,i_e,r.transform),this.transformOrigin=tn(e,d_e,r.transformOrigin),this.visibility=tn(e,f_e,r.visibility),this.webkitTextStrokeColor=tn(e,P_e,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=tn(e,T_e,r.webkitTextStrokeWidth),this.wordBreak=tn(e,h_e,r.wordBreak),this.zIndex=tn(e,A_e,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return Am(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return Io(this.display,4)||Io(this.display,33554432)||Io(this.display,268435456)||Io(this.display,536870912)||Io(this.display,67108864)||Io(this.display,134217728)},t}(),k_e=function(){function t(e,r){this.content=tn(e,N_e,r.content),this.quotes=tn(e,S_e,r.quotes)}return t}(),oQ=function(){function t(e,r){this.counterIncrement=tn(e,C_e,r.counterIncrement),this.counterReset=tn(e,__e,r.counterReset)}return t}(),tn=function(t,e,r){var n=new fte,a=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(a);var s=new hte(n.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(t,cs(o)?o.value:e.initialValue);case 0:return e.parse(t,s.parseComponentValue());case 1:return e.parse(t,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return JI.parse(t,s.parseComponentValue());case"color":return hm.parse(t,s.parseComponentValue());case"image":return V6.parse(t,s.parseComponentValue());case"length":var l=s.parseComponentValue();return jm(l)?l:Pl;case"length-percentage":var c=s.parseComponentValue();return oo(c)?c:Pl;case"time":return Tte.parse(t,s.parseComponentValue())}break}},F_e="data-html2canvas-debug",O_e=function(t){var e=t.getAttribute(F_e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Ik=function(t,e){var r=O_e(t);return r===1||e===r},gh=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,Ik(r,3))debugger;this.styles=new B_e(e,window.getComputedStyle(r,null)),Bk(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=XI(this.context,r),Ik(r,4)&&(this.flags|=16)}return t}(),D_e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",lQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var EC=0;EC<lQ.length;EC++)Yy[lQ.charCodeAt(EC)]=EC;var R_e=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Yy[t.charCodeAt(n)],o=Yy[t.charCodeAt(n+1)],l=Yy[t.charCodeAt(n+2)],c=Yy[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},M_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},L_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Up=5,H6=11,U4=2,U_e=H6-Up,Bte=65536>>Up,Q_e=1<<Up,Q4=Q_e-1,V_e=1024>>Up,H_e=Bte+V_e,$_e=H_e,G_e=32,K_e=$_e+G_e,q_e=65536>>H6,z_e=1<<U_e,W_e=z_e-1,cQ=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},X_e=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},Y_e=function(t,e){var r=R_e(t),n=Array.isArray(r)?L_e(r):new Uint32Array(r),a=Array.isArray(r)?M_e(r):new Uint16Array(r),s=24,o=cQ(a,s/2,n[4]/2),l=n[5]===2?cQ(a,(s+n[4])/2):X_e(n,Math.ceil((s+n[4])/4));return new J_e(n[0],n[1],n[2],n[3],o,l)},J_e=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Up],r=(r<<U4)+(e&Q4),this.data[r];if(e<=65535)return r=this.index[Bte+(e-55296>>Up)],r=(r<<U4)+(e&Q4),this.data[r];if(e<this.highStart)return r=K_e-q_e+(e>>H6),r=this.index[r],r+=e>>Up&W_e,r=this.index[r],r=(r<<U4)+(e&Q4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),uQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z_e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var SC=0;SC<uQ.length;SC++)Z_e[uQ.charCodeAt(SC)]=SC;var eEe=1,V4=2,H4=3,dQ=4,fQ=5,tEe=7,hQ=8,$4=9,G4=10,AQ=11,mQ=12,pQ=13,gQ=14,K4=15,rEe=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},nEe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},aEe=Y_e(D_e),pd="",q4="",sEe=function(t){return aEe.get(t)},iEe=function(t,e,r){var n=r-2,a=e[n],s=e[r-1],o=e[r];if(s===V4&&o===H4)return pd;if(s===V4||s===H4||s===dQ||o===V4||o===H4||o===dQ)return q4;if(s===hQ&&[hQ,$4,AQ,mQ].indexOf(o)!==-1||(s===AQ||s===$4)&&(o===$4||o===G4)||(s===mQ||s===G4)&&o===G4||o===pQ||o===fQ||o===tEe||s===eEe)return pd;if(s===pQ&&o===gQ){for(;a===fQ;)a=e[--n];if(a===gQ)return pd}if(s===K4&&o===K4){for(var l=0;a===K4;)l++,a=e[--n];if(l%2===0)return pd}return q4},oEe=function(t){var e=rEe(t),r=e.length,n=0,a=0,s=e.map(sEe);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=pd;n<r&&(o=iEe(e,s,++n))===pd;);if(o!==pd||n===r){var l=nEe.apply(null,e.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},lEe=function(t){for(var e=oEe(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},cEe=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(t.body.removeChild(n),s===e)return!0}}return!1},uEe=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,a=YI(n.data).map(function(c){return Qi(c)}),s=0,o={},l=a.every(function(c,u){r.setStart(n,s),r.setEnd(n,s+c.length);var d=r.getBoundingClientRect();s+=c.length;var f=d.x>o.x||d.y>o.y;return o=d,u===0?!0:f});return t.body.removeChild(e),l},dEe=function(){return typeof new Image().crossOrigin<"u"},fEe=function(){return typeof new XMLHttpRequest().responseType=="string"},hEe=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},xQ=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},AEe=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=e.toDataURL();a.src=s;var o=Pk(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),vQ(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var u=t.createElement("div");return u.style.backgroundImage="url("+s+")",u.style.height=r+"px",xQ(c)?vQ(Pk(r,r,0,0,u)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),xQ(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Pk=function(t,e,r,n,a){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(a),o},vQ=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Cl={get SUPPORT_RANGE_BOUNDS(){var t=cEe(document);return Object.defineProperty(Cl,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Cl.SUPPORT_RANGE_BOUNDS&&uEe(document);return Object.defineProperty(Cl,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=hEe(document);return Object.defineProperty(Cl,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?AEe(document):Promise.resolve(!1);return Object.defineProperty(Cl,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=dEe();return Object.defineProperty(Cl,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=fEe();return Object.defineProperty(Cl,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Cl,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Cl,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Sb=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),mEe=function(t,e,r,n){var a=xEe(e,r),s=[],o=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Cl.SUPPORT_RANGE_BOUNDS){var c=yQ(n,o,l.length).getClientRects();if(c.length>1){var u=$6(l),d=0;u.forEach(function(A){s.push(new Sb(A,bA.fromDOMRectList(t,yQ(n,d+o,A.length).getClientRects()))),d+=A.length})}else s.push(new Sb(l,bA.fromDOMRectList(t,c)))}else{var f=n.splitText(l.length);s.push(new Sb(l,pEe(t,n))),n=f}else Cl.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),s},pEe=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(n,e);var s=XI(t,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return bA.EMPTY},yQ=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(t,e),a.setEnd(t,e+r),a},$6=function(t){if(Cl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return lEe(t)},gEe=function(t,e){if(Cl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return yEe(t,e)},xEe=function(t,e){return e.letterSpacing!==0?$6(t):gEe(t,e)},vEe=[32,160,4961,65792,65793,4153,4241],yEe=function(t,e){for(var r=qwe(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],a,s=function(){if(a.value){var o=a.value.slice(),l=YI(o),c="";l.forEach(function(u){vEe.indexOf(u)===-1?c+=Qi(u):(c.length&&n.push(c),n.push(Qi(u)),c="")}),c.length&&n.push(c)}};!(a=r.next()).done;)s();return n},bEe=function(){function t(e,r,n){this.text=wEe(r.data,n.textTransform),this.textBounds=mEe(e,this.text,n,r)}return t}(),wEe=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(NEe,CEe);case 2:return t.toUpperCase();default:return t}},NEe=/(^|\s|:|-|\(|\))([a-z])/g,CEe=function(t,e,r){return t.length>0?e+r.toUpperCase():t},kte=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return e}(gh),Fte=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return e}(gh),Ote=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=new XMLSerializer,o=XI(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return e}(gh),Dte=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(gh),Tk=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return e}(gh),_Ee=[{type:15,flags:0,unit:"px",number:3}],EEe=[{type:16,flags:0,number:50}],SEe=function(t){return t.width>t.height?new bA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new bA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},jEe=function(t){var e=t.type===IEe?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},SS="checkbox",jS="radio",IEe="password",bQ=707406591,G6=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=jEe(n),(a.type===SS||a.type===jS)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=SEe(a.bounds)),a.type){case SS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=_Ee;break;case jS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=EEe;break}return a}return e}(gh),Rte=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return e}(gh),Mte=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(gh),Lte=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=Qte(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?_b(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):oA.TRANSPARENT,o=n.contentWindow.document.body?_b(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):oA.TRANSPARENT;a.backgroundColor=Am(s)?Am(o)?a.styles.backgroundColor:o:s}}catch{}return a}return e}(gh),PEe=["OL","UL","MENU"],mE=function(t,e,r,n){for(var a=e.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,Vte(a)&&a.data.trim().length>0)r.textNodes.push(new bEe(t,a,r.styles));else if(Xx(a))if(Kte(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return mE(t,l,r,n)});else{var o=Ute(t,a);o.styles.isVisible()&&(TEe(a,o,n)?o.flags|=4:BEe(o.styles)&&(o.flags|=2),PEe.indexOf(a.tagName)!==-1&&(o.flags|=8),r.elements.push(o),a.slot,a.shadowRoot?mE(t,a.shadowRoot,o,n):!IS(a)&&!Hte(a)&&!PS(a)&&mE(t,a,o,n))}},Ute=function(t,e){return kk(e)?new kte(t,e):$te(e)?new Fte(t,e):Hte(e)?new Ote(t,e):kEe(e)?new Dte(t,e):FEe(e)?new Tk(t,e):OEe(e)?new G6(t,e):PS(e)?new Rte(t,e):IS(e)?new Mte(t,e):Gte(e)?new Lte(t,e):new gh(t,e)},Qte=function(t,e){var r=Ute(t,e);return r.flags|=4,mE(t,e,r,r),r},TEe=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||K6(t)&&r.styles.isTransparent()},BEe=function(t){return t.isPositioned()||t.isFloating()},Vte=function(t){return t.nodeType===Node.TEXT_NODE},Xx=function(t){return t.nodeType===Node.ELEMENT_NODE},Bk=function(t){return Xx(t)&&typeof t.style<"u"&&!pE(t)},pE=function(t){return typeof t.className=="object"},kEe=function(t){return t.tagName==="LI"},FEe=function(t){return t.tagName==="OL"},OEe=function(t){return t.tagName==="INPUT"},DEe=function(t){return t.tagName==="HTML"},Hte=function(t){return t.tagName==="svg"},K6=function(t){return t.tagName==="BODY"},$te=function(t){return t.tagName==="CANVAS"},wQ=function(t){return t.tagName==="VIDEO"},kk=function(t){return t.tagName==="IMG"},Gte=function(t){return t.tagName==="IFRAME"},NQ=function(t){return t.tagName==="STYLE"},REe=function(t){return t.tagName==="SCRIPT"},IS=function(t){return t.tagName==="TEXTAREA"},PS=function(t){return t.tagName==="SELECT"},Kte=function(t){return t.tagName==="SLOT"},CQ=function(t){return t.tagName.indexOf("-")>0},MEe=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,a=e.counterReset,s=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return s&&a.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),_Q={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},EQ={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},LEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},UEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},ux=function(t,e,r,n,a,s){return t<e||t>r?I2(t,a,s.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+s},qte=function(t,e,r,n){var a="";do r||t--,a=n(t)+a,t/=e;while(t*e>=e);return a},Di=function(t,e,r,n,a){var s=r-e+1;return(t<0?"-":"")+(qte(Math.abs(t),s,n,function(o){return Qi(Math.floor(o%s)+e)})+a)},ep=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return qte(Math.abs(t),n,!1,function(a){return e[Math.floor(a%n)]})+r},Tx=1,E0=2,S0=4,Jy=8,jh=function(t,e,r,n,a,s){if(t<-9999||t>9999)return I2(t,4,a.length>0);var o=Math.abs(t),l=a;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var u=o%10;u===0&&Io(s,Tx)&&l!==""?l=e[u]+l:u>1||u===1&&c===0||u===1&&c===1&&Io(s,E0)||u===1&&c===1&&Io(s,S0)&&t>100||u===1&&c>1&&Io(s,Jy)?l=e[u]+(c>0?r[c-1]:"")+l:u===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},SQ="",jQ="",IQ="",z4="",I2=function(t,e,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Di(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return ep(t,"",a);case 6:return ux(t,1,3999,_Q,3,n).toLowerCase();case 7:return ux(t,1,3999,_Q,3,n);case 8:return Di(t,945,969,!1,n);case 9:return Di(t,97,122,!1,n);case 10:return Di(t,65,90,!1,n);case 11:return Di(t,1632,1641,!0,n);case 12:case 49:return ux(t,1,9999,EQ,3,n);case 35:return ux(t,1,9999,EQ,3,n).toLowerCase();case 13:return Di(t,2534,2543,!0,n);case 14:case 30:return Di(t,6112,6121,!0,n);case 15:return ep(t,"",a);case 16:return ep(t,"",a);case 17:case 48:return jh(t,"",SQ,"",a,E0|S0|Jy);case 47:return jh(t,"",jQ,"",a,Tx|E0|S0|Jy);case 42:return jh(t,"",SQ,"",a,E0|S0|Jy);case 41:return jh(t,"",jQ,"",a,Tx|E0|S0|Jy);case 26:return jh(t,"","",IQ,a,0);case 25:return jh(t,"","",IQ,a,Tx|E0|S0);case 31:return jh(t,"","",z4,s,Tx|E0|S0);case 33:return jh(t,"","",z4,s,0);case 32:return jh(t,"","",z4,s,Tx|E0|S0);case 18:return Di(t,2406,2415,!0,n);case 20:return ux(t,1,19999,UEe,3,n);case 21:return Di(t,2790,2799,!0,n);case 22:return Di(t,2662,2671,!0,n);case 22:return ux(t,1,10999,LEe,3,n);case 23:return ep(t,"");case 24:return ep(t,"");case 27:return Di(t,3302,3311,!0,n);case 28:return ep(t,"",a);case 29:return ep(t,"",a);case 34:return Di(t,3792,3801,!0,n);case 37:return Di(t,6160,6169,!0,n);case 38:return Di(t,4160,4169,!0,n);case 39:return Di(t,2918,2927,!0,n);case 40:return Di(t,1776,1785,!0,n);case 43:return Di(t,3046,3055,!0,n);case 44:return Di(t,3174,3183,!0,n);case 45:return Di(t,3664,3673,!0,n);case 46:return Di(t,3872,3881,!0,n);case 3:default:return Di(t,48,57,!0,n)}},zte="data-html2canvas-ignore",PQ=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new MEe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,a=QEe(e,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=a.contentWindow,c=l.document,u=$Ee(a).then(function(){return wc(n,void 0,void 0,function(){var d,f;return Jl(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(zEe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,HEe(c)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,f)}).then(function(){return a})]:[2,a]}})})});return c.open(),c.write(KEe(document.doctype)+"<html></html>"),qEe(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),u},t.prototype.createElementClone=function(e){if(Ik(e,2))debugger;if($te(e))return this.createCanvasClone(e);if(wQ(e))return this.createVideoClone(e);if(NQ(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return kk(r)&&(kk(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),CQ(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return W4(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),a=e.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var a=e.cloneNode(!1);try{a.width=e.width,a.height=e.height;var s=e.getContext("2d"),o=a.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return a},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var a=e.ownerDocument.createElement("canvas");return a.width=e.offsetWidth,a.height=e.offsetHeight,a},t.prototype.appendChildNode=function(e,r,n){(!Xx(r)||!REe(r)&&!r.hasAttribute(zte)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Xx(r)||!NQ(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var a=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(Xx(s)&&Kte(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},t.prototype.cloneNode=function(e,r){if(Vte(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&Xx(e)&&(Bk(e)||pE(e))){var a=this.createElementClone(e);a.style.transitionProperty="none";var s=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&Bk(a)&&(this.clonedReferenceElement=a),K6(a)&&YEe(a);var c=this.counters.parse(new oQ(this.context,s)),u=this.resolvePseudoContent(e,a,o,jb.BEFORE);CQ(e)&&(r=!0),wQ(e)||this.cloneChildNodes(e,a,r),u&&a.insertBefore(u,a.firstChild);var d=this.resolvePseudoContent(e,a,l,jb.AFTER);return d&&a.appendChild(d),this.counters.pop(c),(s&&(this.options.copyStyles||pE(e))&&!Gte(e)||r)&&W4(s,a),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([a,e.scrollLeft,e.scrollTop]),(IS(e)||PS(e))&&(IS(a)||PS(a))&&(a.value=e.value),a}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,a){var s=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new oQ(this.context,n));var c=new k_e(this.context,n),u=l.createElement("html2canvaspseudoelement");W4(n,u),c.content.forEach(function(f){if(f.type===0)u.appendChild(l.createTextNode(f.value));else if(f.type===22){var A=l.createElement("img");A.src=f.value,A.style.opacity="1",u.appendChild(A)}else if(f.type===18){if(f.name==="attr"){var h=f.values.filter(cs);h.length&&u.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(f.name==="counter"){var m=f.values.filter(Qv),p=m[0],x=m[1];if(p&&cs(p)){var v=s.counters.getCounterValue(p.value),y=x&&cs(x)?jk.parse(s.context,x.value):3;u.appendChild(l.createTextNode(I2(v,y,!1)))}}else if(f.name==="counters"){var b=f.values.filter(Qv),p=b[0],w=b[1],x=b[2];if(p&&cs(p)){var I=s.counters.getCounterValues(p.value),j=x&&cs(x)?jk.parse(s.context,x.value):3,C=w&&w.type===0?w.value:"",S=I.map(function(k){return I2(k,j,!1)}).join(C);u.appendChild(l.createTextNode(S))}}}else if(f.type===20)switch(f.value){case"open-quote":u.appendChild(l.createTextNode(iQ(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":u.appendChild(l.createTextNode(iQ(c.quotes,--s.quoteDepth,!1)));break;default:u.appendChild(l.createTextNode(f.value))}}),u.className=Fk+" "+Ok;var d=a===jb.BEFORE?" "+Fk:" "+Ok;return pE(r)?r.className.baseValue+=d:r.className+=d,u}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),jb;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(jb||(jb={}));var QEe=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(zte,"true"),t.body.appendChild(r),r},VEe=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},HEe=function(t){return Promise.all([].slice.call(t.images,0).map(VEe))},$Ee=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),e(t))},50)}})},GEe=["all","d","content"],W4=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);GEe.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},KEe=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},qEe=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},zEe=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},WEe=":before",XEe=":after",Fk="___html2canvas___pseudoelement_before",Ok="___html2canvas___pseudoelement_after",TQ=`{
    content: "" !important;
    display: none !important;
}`,YEe=function(t){JEe(t,"."+Fk+WEe+TQ+`
         .`+Ok+XEe+TQ)},JEe=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},Wte=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),ZEe=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(Y4(e)||nSe(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return wc(this,void 0,void 0,function(){var r,n,a,s,o=this;return Jl(this,function(l){switch(l.label){case 0:return r=Wte.isSameOrigin(e),n=!X4(e)&&this._options.useCORS===!0&&Cl.SUPPORT_CORS_IMAGES&&!r,a=!X4(e)&&!r&&!Y4(e)&&typeof this._options.proxy=="string"&&Cl.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!X4(e)&&!Y4(e)&&!a&&!n?[2]:(s=e,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,u){var d=new Image;d.onload=function(){return c(d)},d.onerror=u,(aSe(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return u("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=e.substring(0,256);return new Promise(function(s,o){var l=Cl.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")s(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return s(f.result)},!1),f.addEventListener("error",function(A){return o(A)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+a+" with status code "+c.status)},c.onerror=o;var u=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+u+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+a)}}c.send()})},t}(),eSe=/^data:image\/svg\+xml/i,tSe=/^data:image\/.*;base64,/i,rSe=/^data:image\/.*/i,nSe=function(t){return Cl.SUPPORT_SVG_DRAWING||!sSe(t)},X4=function(t){return rSe.test(t)},aSe=function(t){return tSe.test(t)},Y4=function(t){return t.substr(0,4)==="blob"},sSe=function(t){return t.substr(-3).toLowerCase()==="svg"||eSe.test(t)},en=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),dx=function(t,e,r){return new en(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},jC=function(){function t(e,r,n,a){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=a}return t.prototype.subdivide=function(e,r){var n=dx(this.start,this.startControl,e),a=dx(this.startControl,this.endControl,e),s=dx(this.endControl,this.end,e),o=dx(n,a,e),l=dx(a,s,e),c=dx(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,s,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),bd=function(t){return t.type===1},iSe=function(){function t(e){var r=e.styles,n=e.bounds,a=Xy(r.borderTopLeftRadius,n.width,n.height),s=a[0],o=a[1],l=Xy(r.borderTopRightRadius,n.width,n.height),c=l[0],u=l[1],d=Xy(r.borderBottomRightRadius,n.width,n.height),f=d[0],A=d[1],h=Xy(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((s+c)/n.width),x.push((m+f)/n.width),x.push((o+p)/n.height),x.push((u+A)/n.height);var v=Math.max.apply(Math,x);v>1&&(s/=v,o/=v,c/=v,u/=v,f/=v,A/=v,m/=v,p/=v);var y=n.width-c,b=n.height-A,w=n.width-f,I=n.height-p,j=r.borderTopWidth,C=r.borderRightWidth,S=r.borderBottomWidth,E=r.borderLeftWidth,B=ws(r.paddingTop,e.bounds.width),k=ws(r.paddingRight,e.bounds.width),T=ws(r.paddingBottom,e.bounds.width),P=ws(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?Ls(n.left+E/3,n.top+j/3,s-E/3,o-j/3,Ha.TOP_LEFT):new en(n.left+E/3,n.top+j/3),this.topRightBorderDoubleOuterBox=s>0||o>0?Ls(n.left+y,n.top+j/3,c-C/3,u-j/3,Ha.TOP_RIGHT):new en(n.left+n.width-C/3,n.top+j/3),this.bottomRightBorderDoubleOuterBox=f>0||A>0?Ls(n.left+w,n.top+b,f-C/3,A-S/3,Ha.BOTTOM_RIGHT):new en(n.left+n.width-C/3,n.top+n.height-S/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?Ls(n.left+E/3,n.top+I,m-E/3,p-S/3,Ha.BOTTOM_LEFT):new en(n.left+E/3,n.top+n.height-S/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?Ls(n.left+E*2/3,n.top+j*2/3,s-E*2/3,o-j*2/3,Ha.TOP_LEFT):new en(n.left+E*2/3,n.top+j*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?Ls(n.left+y,n.top+j*2/3,c-C*2/3,u-j*2/3,Ha.TOP_RIGHT):new en(n.left+n.width-C*2/3,n.top+j*2/3),this.bottomRightBorderDoubleInnerBox=f>0||A>0?Ls(n.left+w,n.top+b,f-C*2/3,A-S*2/3,Ha.BOTTOM_RIGHT):new en(n.left+n.width-C*2/3,n.top+n.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?Ls(n.left+E*2/3,n.top+I,m-E*2/3,p-S*2/3,Ha.BOTTOM_LEFT):new en(n.left+E*2/3,n.top+n.height-S*2/3),this.topLeftBorderStroke=s>0||o>0?Ls(n.left+E/2,n.top+j/2,s-E/2,o-j/2,Ha.TOP_LEFT):new en(n.left+E/2,n.top+j/2),this.topRightBorderStroke=s>0||o>0?Ls(n.left+y,n.top+j/2,c-C/2,u-j/2,Ha.TOP_RIGHT):new en(n.left+n.width-C/2,n.top+j/2),this.bottomRightBorderStroke=f>0||A>0?Ls(n.left+w,n.top+b,f-C/2,A-S/2,Ha.BOTTOM_RIGHT):new en(n.left+n.width-C/2,n.top+n.height-S/2),this.bottomLeftBorderStroke=m>0||p>0?Ls(n.left+E/2,n.top+I,m-E/2,p-S/2,Ha.BOTTOM_LEFT):new en(n.left+E/2,n.top+n.height-S/2),this.topLeftBorderBox=s>0||o>0?Ls(n.left,n.top,s,o,Ha.TOP_LEFT):new en(n.left,n.top),this.topRightBorderBox=c>0||u>0?Ls(n.left+y,n.top,c,u,Ha.TOP_RIGHT):new en(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||A>0?Ls(n.left+w,n.top+b,f,A,Ha.BOTTOM_RIGHT):new en(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?Ls(n.left,n.top+I,m,p,Ha.BOTTOM_LEFT):new en(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||o>0?Ls(n.left+E,n.top+j,Math.max(0,s-E),Math.max(0,o-j),Ha.TOP_LEFT):new en(n.left+E,n.top+j),this.topRightPaddingBox=c>0||u>0?Ls(n.left+Math.min(y,n.width-C),n.top+j,y>n.width+C?0:Math.max(0,c-C),Math.max(0,u-j),Ha.TOP_RIGHT):new en(n.left+n.width-C,n.top+j),this.bottomRightPaddingBox=f>0||A>0?Ls(n.left+Math.min(w,n.width-E),n.top+Math.min(b,n.height-S),Math.max(0,f-C),Math.max(0,A-S),Ha.BOTTOM_RIGHT):new en(n.left+n.width-C,n.top+n.height-S),this.bottomLeftPaddingBox=m>0||p>0?Ls(n.left+E,n.top+Math.min(I,n.height-S),Math.max(0,m-E),Math.max(0,p-S),Ha.BOTTOM_LEFT):new en(n.left+E,n.top+n.height-S),this.topLeftContentBox=s>0||o>0?Ls(n.left+E+P,n.top+j+B,Math.max(0,s-(E+P)),Math.max(0,o-(j+B)),Ha.TOP_LEFT):new en(n.left+E+P,n.top+j+B),this.topRightContentBox=c>0||u>0?Ls(n.left+Math.min(y,n.width+E+P),n.top+j+B,y>n.width+E+P?0:c-E+P,u-(j+B),Ha.TOP_RIGHT):new en(n.left+n.width-(C+k),n.top+j+B),this.bottomRightContentBox=f>0||A>0?Ls(n.left+Math.min(w,n.width-(E+P)),n.top+Math.min(b,n.height+j+B),Math.max(0,f-(C+k)),A-(S+T),Ha.BOTTOM_RIGHT):new en(n.left+n.width-(C+k),n.top+n.height-(S+T)),this.bottomLeftContentBox=m>0||p>0?Ls(n.left+E+P,n.top+I,Math.max(0,m-(E+P)),p-(S+T),Ha.BOTTOM_LEFT):new en(n.left+E+P,n.top+n.height-(S+T))}return t}(),Ha;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ha||(Ha={}));var Ls=function(t,e,r,n,a){var s=4*((Math.sqrt(2)-1)/3),o=r*s,l=n*s,c=t+r,u=e+n;switch(a){case Ha.TOP_LEFT:return new jC(new en(t,u),new en(t,u-l),new en(c-o,e),new en(c,e));case Ha.TOP_RIGHT:return new jC(new en(t,e),new en(t+o,e),new en(c,u-l),new en(c,u));case Ha.BOTTOM_RIGHT:return new jC(new en(c,e),new en(c,e+l),new en(t+o,u),new en(t,u));case Ha.BOTTOM_LEFT:default:return new jC(new en(c,u),new en(c-o,u),new en(t,e+l),new en(t,e))}},TS=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},oSe=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},BS=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},lSe=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),IC=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),cSe=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),uSe=function(t){return t.type===0},Xte=function(t){return t.type===1},dSe=function(t){return t.type===2},BQ=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},fSe=function(t,e,r,n,a){return t.map(function(s,o){switch(o){case 0:return s.add(e,r);case 1:return s.add(e+n,r);case 2:return s.add(e+n,r+a);case 3:return s.add(e,r+a)}return s})},Yte=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),Jte=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new iSe(this.container),this.container.styles.opacity<1&&this.effects.push(new cSe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new lSe(n,a,s))}if(this.container.styles.overflowX!==0){var o=TS(this.curves),l=BS(this.curves);BQ(o,l)?this.effects.push(new IC(o,6)):(this.effects.push(new IC(o,2)),this.effects.push(new IC(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(c){return!Xte(c)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=TS(n.curves),l=BS(n.curves);BQ(o,l)||a.unshift(new IC(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(c){return Io(c.target,e)})},t}(),Dk=function(t,e,r,n){t.container.elements.forEach(function(a){var s=Io(a.flags,4),o=Io(a.flags,2),l=new Jte(a,t);Io(a.styles.display,2048)&&n.push(l);var c=Io(a.flags,8)?[]:n;if(s||o){var u=s||a.styles.isPositioned()?r:e,d=new Yte(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var f=a.styles.zIndex.order;if(f<0){var A=0;u.negativeZIndex.some(function(m,p){return f>m.element.container.styles.zIndex.order?(A=p,!1):A>0}),u.negativeZIndex.splice(A,0,d)}else if(f>0){var h=0;u.positiveZIndex.some(function(m,p){return f>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),u.positiveZIndex.splice(h,0,d)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?u.nonPositionedFloats.push(d):u.nonPositionedInlineLevel.push(d);Dk(l,d,s?d:r,c)}else a.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),Dk(l,e,r,c);Io(a.flags,8)&&Zte(a,c)})},Zte=function(t,e){for(var r=t instanceof Tk?t.start:1,n=t instanceof Tk?t.reversed:!1,a=0;a<e.length;a++){var s=e[a];s.container instanceof Dte&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=I2(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},hSe=function(t){var e=new Jte(t,null),r=new Yte(e),n=[];return Dk(e,r,r,n),Zte(e.container,n),r},kQ=function(t,e){switch(e){case 0:return _d(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return _d(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return _d(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return _d(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},ASe=function(t,e){switch(e){case 0:return _d(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return _d(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return _d(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return _d(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},mSe=function(t,e){switch(e){case 0:return _d(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return _d(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return _d(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return _d(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},pSe=function(t,e){switch(e){case 0:return PC(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return PC(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return PC(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return PC(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},PC=function(t,e){var r=[];return bd(t)?r.push(t.subdivide(.5,!1)):r.push(t),bd(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},_d=function(t,e,r,n){var a=[];return bd(t)?a.push(t.subdivide(.5,!1)):a.push(t),bd(r)?a.push(r.subdivide(.5,!0)):a.push(r),bd(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),bd(e)?a.push(e.subdivide(.5,!1).reverse()):a.push(e),a},ere=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},kS=function(t){var e=t.styles,r=t.bounds,n=ws(e.paddingLeft,r.width),a=ws(e.paddingRight,r.width),s=ws(e.paddingTop,r.width),o=ws(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+a),-(e.borderTopWidth+e.borderBottomWidth+s+o))},gSe=function(t,e){return t===0?e.bounds:t===2?kS(e):ere(e)},xSe=function(t,e){return t===0?e.bounds:t===2?kS(e):ere(e)},J4=function(t,e,r){var n=gSe(Bx(t.styles.backgroundOrigin,e),t),a=xSe(Bx(t.styles.backgroundClip,e),t),s=vSe(Bx(t.styles.backgroundSize,e),r,n),o=s[0],l=s[1],c=Xy(Bx(t.styles.backgroundPosition,e),n.width-o,n.height-l),u=ySe(Bx(t.styles.backgroundRepeat,e),c,s,n,a),d=Math.round(n.left+c[0]),f=Math.round(n.top+c[1]);return[u,d,f,o,l]},fx=function(t){return cs(t)&&t.value===mv.AUTO},TC=function(t){return typeof t=="number"},vSe=function(t,e,r){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(oo(o)&&l&&oo(l))return[ws(o,r.width),ws(l,r.height)];var c=TC(s);if(cs(o)&&(o.value===mv.CONTAIN||o.value===mv.COVER)){if(TC(s)){var u=r.width/r.height;return u<s!=(o.value===mv.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=TC(n),f=TC(a),A=d||f;if(fx(o)&&(!l||fx(l))){if(d&&f)return[n,a];if(!c&&!A)return[r.width,r.height];if(A&&c){var h=d?n:a*s,m=f?a:n/s;return[h,m]}var p=d?n:r.width,x=f?a:r.height;return[p,x]}if(c){var v=0,y=0;return oo(o)?v=ws(o,r.width):oo(l)&&(y=ws(l,r.height)),fx(o)?v=y*s:(!l||fx(l))&&(y=v/s),[v,y]}var b=null,w=null;if(oo(o)?b=ws(o,r.width):l&&oo(l)&&(w=ws(l,r.height)),b!==null&&(!l||fx(l))&&(w=d&&f?b/n*a:r.height),w!==null&&fx(o)&&(b=d&&f?w/a*n:r.width),b!==null&&w!==null)return[b,w];throw new Error("Unable to calculate background-size for element")},Bx=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},ySe=function(t,e,r,n,a){var s=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new en(Math.round(n.left),Math.round(n.top+o)),new en(Math.round(n.left+n.width),Math.round(n.top+o)),new en(Math.round(n.left+n.width),Math.round(c+n.top+o)),new en(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new en(Math.round(n.left+s),Math.round(n.top)),new en(Math.round(n.left+s+l),Math.round(n.top)),new en(Math.round(n.left+s+l),Math.round(n.height+n.top)),new en(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new en(Math.round(n.left+s),Math.round(n.top+o)),new en(Math.round(n.left+s+l),Math.round(n.top+o)),new en(Math.round(n.left+s+l),Math.round(n.top+o+c)),new en(Math.round(n.left+s),Math.round(n.top+o+c))];default:return[new en(Math.round(a.left),Math.round(a.top)),new en(Math.round(a.left+a.width),Math.round(a.top)),new en(Math.round(a.left+a.width),Math.round(a.height+a.top)),new en(Math.round(a.left),Math.round(a.height+a.top))]}},bSe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",FQ="Hidden Text",wSe=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),a.src=bSe,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(FQ)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(FQ)),n.style.lineHeight="normal",a.style.verticalAlign="super";var c=a.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),tre=function(){function t(e,r){this.context=e,this.options=r}return t}(),NSe=1e4,CSe=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new wSe(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},e.prototype.applyEffect=function(r){this.ctx.save(),dSe(r)&&(this.ctx.globalAlpha=r.opacity),uSe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),Xte(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return wc(this,void 0,void 0,function(){var n;return Jl(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return wc(this,void 0,void 0,function(){return Jl(this,function(n){switch(n.label){case 0:if(Io(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var o=$6(r.text);o.reduce(function(l,c){return s.ctx.fillText(c,l,r.bounds.top+a),l+s.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),a=ISe(r.fontFamily).join(", "),s=Mw(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},e.prototype.renderTextNode=function(r,n){return wc(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A=this;return Jl(this,function(h){return a=this.createFontStyle(n),s=a[0],o=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),u=c.baseline,d=c.middle,f=n.paintOrder,r.textBounds.forEach(function(m){f.forEach(function(p){switch(p){case 0:A.ctx.fillStyle=$o(n.color),A.renderTextWithLetterSpacing(m,n.letterSpacing,u);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(v){A.ctx.shadowColor=$o(v.color),A.ctx.shadowOffsetX=v.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=v.offsetY.number*A.options.scale,A.ctx.shadowBlur=v.blur.number,A.renderTextWithLetterSpacing(m,n.letterSpacing,u)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),n.textDecorationLine.length&&(A.ctx.fillStyle=$o(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(v){switch(v){case 1:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+u),m.bounds.width,1);break;case 2:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:A.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+d),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(A.ctx.strokeStyle=$o(n.webkitTextStrokeColor),A.ctx.lineWidth=n.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+u)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=kS(r),o=BS(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return wc(this,void 0,void 0,function(){var n,a,s,o,l,c,y,y,u,d,f,A,w,h,m,I,p,x,v,y,b,w,I;return Jl(this,function(j){switch(j.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,o=0,l=n.textNodes,j.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:j.sent(),j.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof kte))return[3,8];j.label=5;case 5:return j.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=j.sent(),this.renderReplacedElement(n,a,y),[3,8];case 7:return j.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof Fte&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof Ote))return[3,12];j.label=9;case 9:return j.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=j.sent(),this.renderReplacedElement(n,a,y),[3,12];case 11:return j.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof Lte&&n.tree?(u=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,u.render(n.tree)]):[3,14];case 13:d=j.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),j.label=14;case 14:if(n instanceof G6&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===SS?n.checked&&(this.ctx.save(),this.path([new en(n.bounds.left+f*.39363,n.bounds.top+f*.79),new en(n.bounds.left+f*.16,n.bounds.top+f*.5549),new en(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new en(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new en(n.bounds.left+f*.72983,n.bounds.top+f*.23),new en(n.bounds.left+f*.84,n.bounds.top+f*.34085),new en(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=$o(bQ),this.ctx.fill(),this.ctx.restore()):n.type===jS&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=$o(bQ),this.ctx.fill(),this.ctx.restore())),_Se(n)&&n.value.length){switch(A=this.createFontStyle(s),w=A[0],h=A[1],m=this.fontMetrics.getMetrics(w,h).baseline,this.ctx.font=w,this.ctx.fillStyle=$o(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=SSe(n.styles.textAlign),I=kS(n),p=0,n.styles.textAlign){case 1:p+=I.width/2;break;case 2:p+=I.width;break}x=I.add(p,0,0,-I.height/2+1),this.ctx.save(),this.path([new en(I.left,I.top),new en(I.left+I.width,I.top),new en(I.left+I.width,I.top+I.height),new en(I.left,I.top+I.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Sb(n.value,x),s.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Io(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(v=n.styles.listStyleImage,v.type!==0)return[3,18];y=void 0,b=v.url,j.label=15;case 15:return j.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=j.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return j.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(w=this.createFontStyle(s)[0],this.ctx.font=w,this.ctx.fillStyle=$o(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",I=new bA(n.bounds.left,n.bounds.top+ws(n.styles.paddingTop,n.bounds.width),n.bounds.width,aQ(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Sb(r.listValue,I),s.letterSpacing,aQ(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),j.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return wc(this,void 0,void 0,function(){var n,a,v,s,o,v,l,c,v,u,d,v,f,A,v,h,m,v,p,x,v;return Jl(this,function(y){switch(y.label){case 0:if(Io(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,a=r.negativeZIndex,y.label=2;case 2:return n<a.length?(v=a[n],[4,this.renderStack(v)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),s=0,o=r.nonInlineLevel,y.label=7;case 7:return s<o.length?(v=o[s],[4,this.renderNode(v)]):[3,10];case 8:y.sent(),y.label=9;case 9:return s++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(v=c[l],[4,this.renderStack(v)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:u=0,d=r.nonPositionedInlineLevel,y.label=15;case 15:return u<d.length?(v=d[u],[4,this.renderStack(v)]):[3,18];case 16:y.sent(),y.label=17;case 17:return u++,[3,15];case 18:f=0,A=r.inlineLevel,y.label=19;case 19:return f<A.length?(v=A[f],[4,this.renderNode(v)]):[3,22];case 20:y.sent(),y.label=21;case 21:return f++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(v=m[h],[4,this.renderStack(v)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,y.label=27;case 27:return p<x.length?(v=x[p],[4,this.renderStack(v)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var o=bd(a)?a.start:a;s===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),bd(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},e.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},e.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},e.prototype.renderBackgroundImage=function(r){return wc(this,void 0,void 0,function(){var n,a,s,o,l,c;return Jl(this,function(u){switch(u.label){case 0:n=r.styles.backgroundImage.length-1,a=function(d){var f,A,h,B,ue,le,P,G,S,m,B,ue,le,P,G,p,x,v,y,b,w,I,j,C,S,E,B,k,T,P,G,ce,ue,le,Ae,ae,_e,De,O,H,K,R;return Jl(this,function(X){switch(X.label){case 0:if(d.type!==0)return[3,5];f=void 0,A=d.url,X.label=1;case 1:return X.trys.push([1,3,,4]),[4,s.context.cache.match(A)];case 2:return f=X.sent(),[3,4];case 3:return X.sent(),s.context.logger.error("Error loading background-image "+A),[3,4];case 4:return f&&(h=J4(r,n,[f.width,f.height,f.width/f.height]),B=h[0],ue=h[1],le=h[2],P=h[3],G=h[4],S=s.ctx.createPattern(s.resizeImage(f,P,G),"repeat"),s.renderRepeat(B,S,ue,le)),[3,6];case 5:uCe(d)?(m=J4(r,n,[null,null,null]),B=m[0],ue=m[1],le=m[2],P=m[3],G=m[4],p=sCe(d.angle,P,G),x=p[0],v=p[1],y=p[2],b=p[3],w=p[4],I=document.createElement("canvas"),I.width=P,I.height=G,j=I.getContext("2d"),C=j.createLinearGradient(v,b,y,w),rQ(d.stops,x).forEach(function(Y){return C.addColorStop(Y.stop,$o(Y.color))}),j.fillStyle=C,j.fillRect(0,0,P,G),P>0&&G>0&&(S=s.ctx.createPattern(I,"repeat"),s.renderRepeat(B,S,ue,le))):dCe(d)&&(E=J4(r,n,[null,null,null]),B=E[0],k=E[1],T=E[2],P=E[3],G=E[4],ce=d.position.length===0?[Q6]:d.position,ue=ws(ce[0],P),le=ws(ce[ce.length-1],G),Ae=iCe(d,ue,le,P,G),ae=Ae[0],_e=Ae[1],ae>0&&_e>0&&(De=s.ctx.createRadialGradient(k+ue,T+le,0,k+ue,T+le,ae),rQ(d.stops,ae*2).forEach(function(Y){return De.addColorStop(Y.stop,$o(Y.color))}),s.path(B),s.ctx.fillStyle=De,ae!==_e?(O=r.bounds.left+.5*r.bounds.width,H=r.bounds.top+.5*r.bounds.height,K=_e/ae,R=1/K,s.ctx.save(),s.ctx.translate(O,H),s.ctx.transform(1,0,0,K,0,0),s.ctx.translate(-O,-H),s.ctx.fillRect(k,R*(T-H)+H,P,G*R),s.ctx.restore()):s.ctx.fill())),X.label=6;case 6:return n--,[2]}})},s=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),u.label=1;case 1:return o<l.length?(c=l[o],[5,a(c)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,a){return wc(this,void 0,void 0,function(){return Jl(this,function(s){return this.path(kQ(a,n)),this.ctx.fillStyle=$o(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,a,s){return wc(this,void 0,void 0,function(){var o,l;return Jl(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=ASe(s,a),this.path(o),this.ctx.fillStyle=$o(r),this.ctx.fill(),l=mSe(s,a),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return wc(this,void 0,void 0,function(){var n,a,s,o,l,c,u,d,f=this;return Jl(this,function(A){switch(A.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!Am(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=ESe(Bx(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Am(n.backgroundColor)||(this.ctx.fillStyle=$o(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){f.ctx.save();var m=TS(r.curves),p=h.inset?0:NSe,x=fSe(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(f.path(m),f.ctx.clip(),f.mask(x)):(f.mask(m),f.ctx.clip(),f.path(x)),f.ctx.shadowOffsetX=h.offsetX.number+p,f.ctx.shadowOffsetY=h.offsetY.number,f.ctx.shadowColor=$o(h.color),f.ctx.shadowBlur=h.blur.number,f.ctx.fillStyle=h.inset?$o(h.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),A.label=2;case 2:l=0,c=0,u=s,A.label=3;case 3:return c<u.length?(d=u[c],d.style!==0&&!Am(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return A.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:A.sent(),A.label=11;case 11:l++,A.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,a,s,o){return wc(this,void 0,void 0,function(){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,I,j,I,j;return Jl(this,function(C){return this.ctx.save(),l=pSe(s,a),c=kQ(s,a),o===2&&(this.path(c),this.ctx.clip()),bd(c[0])?(u=c[0].start.x,d=c[0].start.y):(u=c[0].x,d=c[0].y),bd(c[1])?(f=c[1].end.x,A=c[1].end.y):(f=c[1].x,A=c[1].y),a===0||a===2?h=Math.abs(u-f):h=Math.abs(d-A),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(v=h/(2*m+p),m*=v,p*=v):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),w=(h-(y+1)*m)/y,p=w<=0||Math.abs(p-b)<Math.abs(p-w)?b:w),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=$o(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(bd(c[0])&&(I=c[3],j=c[0],this.ctx.beginPath(),this.formatPath([new en(I.end.x,I.end.y),new en(j.start.x,j.start.y)]),this.ctx.stroke()),bd(c[1])&&(I=c[1],j=c[2],this.ctx.beginPath(),this.formatPath([new en(I.end.x,I.end.y),new en(j.start.x,j.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return wc(this,void 0,void 0,function(){var n;return Jl(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=$o(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=hSe(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(tre),_Se=function(t){return t instanceof Mte||t instanceof Rte?!0:t instanceof G6&&t.type!==jS&&t.type!==SS},ESe=function(t,e){switch(t){case 0:return TS(e);case 2:return oSe(e);case 1:default:return BS(e)}},SSe=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},jSe=["-apple-system","system-ui"],ISe=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return jSe.indexOf(e)===-1}):t},PSe=function(t){Pf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return e.prototype.render=function(r){return wc(this,void 0,void 0,function(){var n,a;return Jl(this,function(s){switch(s.label){case 0:return n=Pk(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,TSe(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=$o(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(tre),TSe=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},BSe=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,cC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,cC([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,cC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,cC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),kSe=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new BSe({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new ZEe(this,e)}return t.instanceCount=1,t}(),Hm=function(t,e){return e===void 0&&(e={}),FSe(t,e)};typeof window<"u"&&Wte.setContext(window);var FSe=function(t,e){return wc(void 0,void 0,void 0,function(){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,I,C,j,C,S,E,B,k,T,P,G,ce,ue,le,Ae,ae,_e,De,O,H,K;return Jl(this,function(R){switch(R.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(S=e.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(E=e.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:e.proxy,useCORS:(B=e.useCORS)!==null&&B!==void 0?B:!1},s=mk({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},a),o={windowWidth:(T=e.windowWidth)!==null&&T!==void 0?T:n.innerWidth,windowHeight:(P=e.windowHeight)!==null&&P!==void 0?P:n.innerHeight,scrollX:(G=e.scrollX)!==null&&G!==void 0?G:n.pageXOffset,scrollY:(ce=e.scrollY)!==null&&ce!==void 0?ce:n.pageYOffset},l=new bA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new kSe(s,l),u=(ue=e.foreignObjectRendering)!==null&&ue!==void 0?ue:!1,d={allowTaint:(le=e.allowTaint)!==null&&le!==void 0?le:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:u,copyStyles:u},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new PQ(c,t,d),A=f.clonedReferenceElement,A?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=R.sent(),m=K6(A)||DEe(A)?fwe(A.ownerDocument):XI(c,A),p=m.width,x=m.height,v=m.left,y=m.top,b=OSe(c,A,e.backgroundColor),w={canvas:e.canvas,backgroundColor:b,scale:(ae=(Ae=e.scale)!==null&&Ae!==void 0?Ae:n.devicePixelRatio)!==null&&ae!==void 0?ae:1,x:((_e=e.x)!==null&&_e!==void 0?_e:0)+v,y:((De=e.y)!==null&&De!==void 0?De:0)+y,width:(O=e.width)!==null&&O!==void 0?O:Math.ceil(p),height:(H=e.height)!==null&&H!==void 0?H:Math.ceil(x)},u?(c.logger.debug("Document cloned, using foreign object rendering"),C=new PSe(c,w),[4,C.render(A)]):[3,3];case 2:return I=R.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+v+","+y+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),j=Qte(c,A),b===j.styles.backgroundColor&&(j.styles.backgroundColor=oA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+w.x+","+w.y+" with size "+w.width+"x"+w.height),C=new CSe(c,w),[4,C.render(j)];case 4:I=R.sent(),R.label=5;case 5:return(!((K=e.removeContainer)!==null&&K!==void 0)||K)&&(PQ.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,I]}})})},OSe=function(t,e,r){var n=e.ownerDocument,a=n.documentElement?_b(t,getComputedStyle(n.documentElement).backgroundColor):oA.TRANSPARENT,s=n.body?_b(t,getComputedStyle(n.body).backgroundColor):oA.TRANSPARENT,o=typeof r=="string"?_b(t,r):r===null?oA.TRANSPARENT:4294967295;return e===n.documentElement?Am(a)?Am(s)?o:s:a:o};const q6=Object.freeze(Object.defineProperty({__proto__:null,default:Hm},Symbol.toStringTag,{value:"Module"})),DSe="modulepreload",RSe=function(t){return"/"+t},OQ={},lA=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=RSe(c),c in OQ)return;OQ[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":DSe,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((A,h)=>{f.addEventListener("load",A),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function ts(t){"@babel/helpers - typeof";return ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ts(t)}var Ef=Uint8Array,Du=Uint16Array,z6=Int32Array,W6=new Ef([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),X6=new Ef([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),DQ=new Ef([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rre=function(t,e){for(var r=new Du(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new z6(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},nre=rre(W6,2),MSe=nre.b,Rk=nre.r;MSe[28]=258,Rk[258]=28;var LSe=rre(X6,0),RQ=LSe.r,Mk=new Du(32768);for(var Fs=0;Fs<32768;++Fs){var h0=(Fs&43690)>>1|(Fs&21845)<<1;h0=(h0&52428)>>2|(h0&13107)<<2,h0=(h0&61680)>>4|(h0&3855)<<4,Mk[Fs]=((h0&65280)>>8|(h0&255)<<8)>>1}var Ib=function(t,e,r){for(var n=t.length,a=0,s=new Du(e);a<n;++a)t[a]&&++s[t[a]-1];var o=new Du(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new Du(1<<e);var c=15-e;for(a=0;a<n;++a)if(t[a])for(var u=a<<4|t[a],d=e-t[a],f=o[t[a]-1]++<<d,A=f|(1<<d)-1;f<=A;++f)l[Mk[f]>>c]=u}else for(l=new Du(n),a=0;a<n;++a)t[a]&&(l[a]=Mk[o[t[a]-1]++]>>15-t[a]);return l},mg=new Ef(288);for(var Fs=0;Fs<144;++Fs)mg[Fs]=8;for(var Fs=144;Fs<256;++Fs)mg[Fs]=9;for(var Fs=256;Fs<280;++Fs)mg[Fs]=7;for(var Fs=280;Fs<288;++Fs)mg[Fs]=8;var FS=new Ef(32);for(var Fs=0;Fs<32;++Fs)FS[Fs]=5;var USe=Ib(mg,9,0),QSe=Ib(FS,5,0),are=function(t){return(t+7)/8|0},VSe=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ef(t.subarray(e,r))},Ih=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},vy=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Z4=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,s=r.slice();if(!a)return{t:ire,l:0};if(a==1){var o=new Ef(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(I,j){return I.f-j.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=a-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var A=s[0].s,n=1;n<a;++n)s[n].s>A&&(A=s[n].s);var h=new Du(A+1),m=Lk(r[d-1],h,0);if(m>e){var n=0,p=0,x=m-e,v=1<<x;for(s.sort(function(j,C){return h[C.s]-h[j.s]||j.f-C.f});n<a;++n){var y=s[n].s;if(h[y]>e)p+=v-(1<<m-h[y]),h[y]=e;else break}for(p>>=x;p>0;){var b=s[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var w=s[n].s;h[w]==e&&(--h[w],++p)}m=e}return{t:new Ef(h),l:m}},Lk=function(t,e,r){return t.s==-1?Math.max(Lk(t.l,e,r+1),Lk(t.r,e,r+1)):e[t.s]=r},MQ=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Du(++e),n=0,a=t[0],s=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==a&&l!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[l]}return{c:r.subarray(0,n),n:e}},yy=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},sre=function(t,e,r){var n=r.length,a=are(e+2);t[a]=n&255,t[a+1]=n>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var s=0;s<n;++s)t[a+s+4]=r[s];return(a+4+n)*8},LQ=function(t,e,r,n,a,s,o,l,c,u,d){Ih(e,d++,r),++a[256];for(var f=Z4(a,15),A=f.t,h=f.l,m=Z4(s,15),p=m.t,x=m.l,v=MQ(A),y=v.c,b=v.n,w=MQ(p),I=w.c,j=w.n,C=new Du(19),S=0;S<y.length;++S)++C[y[S]&31];for(var S=0;S<I.length;++S)++C[I[S]&31];for(var E=Z4(C,7),B=E.t,k=E.l,T=19;T>4&&!B[DQ[T-1]];--T);var P=u+5<<3,G=yy(a,mg)+yy(s,FS)+o,ce=yy(a,A)+yy(s,p)+o+14+3*T+yy(C,B)+2*C[16]+3*C[17]+7*C[18];if(c>=0&&P<=G&&P<=ce)return sre(e,d,t.subarray(c,c+u));var ue,le,Ae,ae;if(Ih(e,d,1+(ce<G)),d+=2,ce<G){ue=Ib(A,h,0),le=A,Ae=Ib(p,x,0),ae=p;var _e=Ib(B,k,0);Ih(e,d,b-257),Ih(e,d+5,j-1),Ih(e,d+10,T-4),d+=14;for(var S=0;S<T;++S)Ih(e,d+3*S,B[DQ[S]]);d+=3*T;for(var De=[y,I],O=0;O<2;++O)for(var H=De[O],S=0;S<H.length;++S){var K=H[S]&31;Ih(e,d,_e[K]),d+=B[K],K>15&&(Ih(e,d,H[S]>>5&127),d+=H[S]>>12)}}else ue=USe,le=mg,Ae=QSe,ae=FS;for(var S=0;S<l;++S){var R=n[S];if(R>255){var K=R>>18&31;vy(e,d,ue[K+257]),d+=le[K+257],K>7&&(Ih(e,d,R>>23&31),d+=W6[K]);var X=R&31;vy(e,d,Ae[X]),d+=ae[X],X>3&&(vy(e,d,R>>5&8191),d+=X6[X])}else vy(e,d,ue[R]),d+=le[R]}return vy(e,d,ue[256]),d+le[256]},HSe=new z6([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ire=new Ef(0),$Se=function(t,e,r,n,a,s){var o=s.z||t.length,l=new Ef(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,d=(s.r||0)&7;if(e){d&&(c[0]=s.r>>3);for(var f=HSe[e-1],A=f>>13,h=f&8191,m=(1<<r)-1,p=s.p||new Du(32768),x=s.h||new Du(m+1),v=Math.ceil(r/3),y=2*v,b=function(se){return(t[se]^t[se+1]<<v^t[se+2]<<y)&m},w=new z6(25e3),I=new Du(288),j=new Du(32),C=0,S=0,E=s.i||0,B=0,k=s.w||0,T=0;E+2<o;++E){var P=b(E),G=E&32767,ce=x[P];if(p[G]=ce,x[P]=G,k<=E){var ue=o-E;if((C>7e3||B>24576)&&(ue>423||!u)){d=LQ(t,c,0,w,I,j,S,B,T,E-T,d),B=C=S=0,T=E;for(var le=0;le<286;++le)I[le]=0;for(var le=0;le<30;++le)j[le]=0}var Ae=2,ae=0,_e=h,De=G-ce&32767;if(ue>2&&P==b(E-De))for(var O=Math.min(A,ue)-1,H=Math.min(32767,E),K=Math.min(258,ue);De<=H&&--_e&&G!=ce;){if(t[E+Ae]==t[E+Ae-De]){for(var R=0;R<K&&t[E+R]==t[E+R-De];++R);if(R>Ae){if(Ae=R,ae=De,R>O)break;for(var X=Math.min(De,R-2),Y=0,le=0;le<X;++le){var D=E-De+le&32767,Q=p[D],te=D-Q&32767;te>Y&&(Y=te,ce=D)}}}G=ce,ce=p[G],De+=G-ce&32767}if(ae){w[B++]=268435456|Rk[Ae]<<18|RQ[ae];var be=Rk[Ae]&31,U=RQ[ae]&31;S+=W6[be]+X6[U],++I[257+be],++j[U],k=E+Ae,++C}else w[B++]=t[E],++I[t[E]]}}for(E=Math.max(E,k);E<o;++E)w[B++]=t[E],++I[t[E]];d=LQ(t,c,u,w,I,j,S,B,T,E-T,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=x,s.p=p,s.i=E,s.w=k)}else{for(var E=s.w||0;E<o+u;E+=65535){var Xe=E+65535;Xe>=o&&(c[d/8|0]=u,Xe=o),d=sre(c,d+1,t.subarray(E,Xe))}s.i=o}return VSe(l,0,n+are(d)+a)},ore=function(){var t=1,e=0;return{p:function(r){for(var n=t,a=e,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}t=n,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},GSe=function(t,e,r,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Ef(s.length+t.length);o.set(s),o.set(t,s.length),t=o,a.w=s.length}return $Se(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,a)},lre=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},KSe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=ore();a.p(e.dictionary),lre(t,2,a.d())}};function Uk(t,e){e||(e={});var r=ore();r.p(t);var n=GSe(t,e,e.dictionary?6:2,4);return KSe(n,e),lre(n,n.length-4,r.d()),n}var qSe=typeof TextDecoder<"u"&&new TextDecoder,zSe=0;try{qSe.decode(ire,{stream:!0}),zSe=1}catch{}function WSe(t){if(Array.isArray(t))return t}function XSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function UQ(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function YSe(t,e){if(t){if(typeof t=="string")return UQ(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?UQ(t,e):void 0}}function JSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QQ(t,e){return WSe(t)||XSe(t,e)||YSe(t,e)||JSe()}function VQ(t,e="utf8"){return new TextDecoder(e).decode(t)}const ZSe=new TextEncoder;function eje(t){return ZSe.encode(t)}const tje=1024*8,rje=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),e5={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Y6{constructor(e=tje,r={}){Tr(this,"buffer");Tr(this,"byteLength");Tr(this,"byteOffset");Tr(this,"length");Tr(this,"offset");Tr(this,"lastWrittenByte");Tr(this,"littleEndian");Tr(this,"_data");Tr(this,"_mark");Tr(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const a=r.offset?r.offset>>>0:0,s=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof Y6)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=e5[r].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===rje&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new e5[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new e5[r](s);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return VQ(this.readBytes(e))}decodeText(e=1,r="utf8"){return VQ(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(eje(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function b1(t){let e=t.length;for(;--e>=0;)t[e]=0}const nje=3,aje=258,cre=29,sje=256,ije=sje+1+cre,ure=30,oje=512,lje=new Array((ije+2)*2);b1(lje);const cje=new Array(ure*2);b1(cje);const uje=new Array(oje);b1(uje);const dje=new Array(aje-nje+1);b1(dje);const fje=new Array(cre);b1(fje);const hje=new Array(ure);b1(hje);const Aje=(t,e,r,n)=>{let a=t&65535|0,s=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+e[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var Qk=Aje;const mje=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},pje=new Uint32Array(mje()),gje=(t,e,r,n)=>{const a=pje,s=n+r;t^=-1;for(let o=n;o<s;o++)t=t>>>8^a[(t^e[o])&255];return t^-1};var Uf=gje,Vk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},dre={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const xje=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var vje=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)xje(r,n)&&(t[n]=r[n])}}return t},yje=t=>{let e=0;for(let n=0,a=t.length;n<a;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,a=0,s=t.length;n<s;n++){let o=t[n];r.set(o,a),a+=o.length}return r},fre={assign:vje,flattenChunks:yje};let hre=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{hre=!1}const P2=new Uint8Array(256);for(let t=0;t<256;t++)P2[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;P2[254]=P2[254]=1;var bje=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,a,s,o=t.length,l=0;for(a=0;a<o;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),s=0,a=0;s<l;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const wje=(t,e)=>{if(e<65534&&t.subarray&&hre)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var Nje=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=t[n++];if(o<128){s[a++]=o;continue}let l=P2[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return wje(s,a)},Cje=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+P2[t[r]]>e?r:e},Hk={string2buf:bje,buf2string:Nje,utf8border:Cje};function _je(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Eje=_je;const BC=16209,Sje=16191;var jje=function(e,r){let n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,I,j,C,S,E,B;const k=e.state;n=e.next_in,E=e.input,a=n+(e.avail_in-5),s=e.next_out,B=e.output,o=s-(r-e.avail_out),l=s+(e.avail_out-257),c=k.dmax,u=k.wsize,d=k.whave,f=k.wnext,A=k.window,h=k.hold,m=k.bits,p=k.lencode,x=k.distcode,v=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=p[h&v];t:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w===0)B[s++]=b&65535;else if(w&16){I=b&65535,w&=15,w&&(m<w&&(h+=E[n++]<<m,m+=8),I+=h&(1<<w)-1,h>>>=w,m-=w),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=x[h&y];r:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w&16){if(j=b&65535,w&=15,m<w&&(h+=E[n++]<<m,m+=8,m<w&&(h+=E[n++]<<m,m+=8)),j+=h&(1<<w)-1,j>c){e.msg="invalid distance too far back",k.mode=BC;break e}if(h>>>=w,m-=w,w=s-o,j>w){if(w=j-w,w>d&&k.sane){e.msg="invalid distance too far back",k.mode=BC;break e}if(C=0,S=A,f===0){if(C+=u-w,w<I){I-=w;do B[s++]=A[C++];while(--w);C=s-j,S=B}}else if(f<w){if(C+=u+f-w,w-=f,w<I){I-=w;do B[s++]=A[C++];while(--w);if(C=0,f<I){w=f,I-=w;do B[s++]=A[C++];while(--w);C=s-j,S=B}}}else if(C+=f-w,w<I){I-=w;do B[s++]=A[C++];while(--w);C=s-j,S=B}for(;I>2;)B[s++]=S[C++],B[s++]=S[C++],B[s++]=S[C++],I-=3;I&&(B[s++]=S[C++],I>1&&(B[s++]=S[C++]))}else{C=s-j;do B[s++]=B[C++],B[s++]=B[C++],B[s++]=B[C++],I-=3;while(I>2);I&&(B[s++]=B[C++],I>1&&(B[s++]=B[C++]))}}else if(w&64){e.msg="invalid distance code",k.mode=BC;break e}else{b=x[(b&65535)+(h&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){k.mode=Sje;break e}else{e.msg="invalid literal/length code",k.mode=BC;break e}else{b=p[(b&65535)+(h&(1<<w)-1)];continue t}break}}while(n<a&&s<l);I=m>>3,n-=I,m-=I<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?5+(a-n):5-(n-a),e.avail_out=s<l?257+(l-s):257-(s-l),k.hold=h,k.bits=m};const hx=15,HQ=852,$Q=592,GQ=0,t5=1,KQ=2,Ije=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Pje=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Tje=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Bje=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),kje=(t,e,r,n,a,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=0,b,w,I,j,C,S=null,E;const B=new Uint16Array(hx+1),k=new Uint16Array(hx+1);let T=null,P,G,ce;for(u=0;u<=hx;u++)B[u]=0;for(d=0;d<n;d++)B[e[r+d]]++;for(h=c,A=hx;A>=1&&B[A]===0;A--);if(h>A&&(h=A),A===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<A&&B[f]===0;f++);for(h<f&&(h=f),x=1,u=1;u<=hx;u++)if(x<<=1,x-=B[u],x<0)return-1;if(x>0&&(t===GQ||A!==1))return-1;for(k[1]=0,u=1;u<hx;u++)k[u+1]=k[u]+B[u];for(d=0;d<n;d++)e[r+d]!==0&&(o[k[e[r+d]]++]=d);if(t===GQ?(S=T=o,E=20):t===t5?(S=Ije,T=Pje,E=257):(S=Tje,T=Bje,E=0),y=0,d=0,u=f,C=s,m=h,p=0,I=-1,v=1<<h,j=v-1,t===t5&&v>HQ||t===KQ&&v>$Q)return 1;for(;;){P=u-p,o[d]+1<E?(G=0,ce=o[d]):o[d]>=E?(G=T[o[d]-E],ce=S[o[d]-E]):(G=96,ce=0),b=1<<u-p,w=1<<m,f=w;do w-=b,a[C+(y>>p)+w]=P<<24|G<<16|ce|0;while(w!==0);for(b=1<<u-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,d++,--B[u]===0){if(u===A)break;u=e[r+o[d]]}if(u>h&&(y&j)!==I){for(p===0&&(p=h),C+=f,m=u-p,x=1<<m;m+p<A&&(x-=B[m+p],!(x<=0));)m++,x<<=1;if(v+=1<<m,t===t5&&v>HQ||t===KQ&&v>$Q)return 1;I=y&j,a[I]=h<<24|m<<16|C-s|0}}return y!==0&&(a[C+y]=u-p<<24|64<<16|0),l.bits=h,0};var Pb=kje;const Fje=0,Are=1,mre=2,{Z_FINISH:qQ,Z_BLOCK:Oje,Z_TREES:kC,Z_OK:pg,Z_STREAM_END:Dje,Z_NEED_DICT:Rje,Z_STREAM_ERROR:Od,Z_DATA_ERROR:pre,Z_MEM_ERROR:gre,Z_BUF_ERROR:Mje,Z_DEFLATED:zQ}=dre,iP=16180,WQ=16181,XQ=16182,YQ=16183,JQ=16184,ZQ=16185,eV=16186,tV=16187,rV=16188,nV=16189,OS=16190,Ph=16191,r5=16192,aV=16193,n5=16194,sV=16195,iV=16196,oV=16197,lV=16198,FC=16199,OC=16200,cV=16201,uV=16202,dV=16203,fV=16204,hV=16205,a5=16206,AV=16207,mV=16208,Us=16209,xre=16210,vre=16211,Lje=852,Uje=592,Qje=15,Vje=Qje,pV=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Hje(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Lg=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<iP||e.mode>vre?1:0},yre=t=>{if(Lg(t))return Od;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=iP,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Lje),e.distcode=e.distdyn=new Int32Array(Uje),e.sane=1,e.back=-1,pg},bre=t=>{if(Lg(t))return Od;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,yre(t)},wre=(t,e)=>{let r;if(Lg(t))return Od;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Od:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,bre(t))},Nre=(t,e)=>{if(!t)return Od;const r=new Hje;t.state=r,r.strm=t,r.window=null,r.mode=iP;const n=wre(t,e);return n!==pg&&(t.state=null),n},$je=t=>Nre(t,Vje);let gV=!0,s5,i5;const Gje=t=>{if(gV){s5=new Int32Array(512),i5=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Pb(Are,t.lens,0,288,s5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Pb(mre,t.lens,0,32,i5,0,t.work,{bits:5}),gV=!1}t.lencode=s5,t.lenbits=9,t.distcode=i5,t.distbits=5},Cre=(t,e,r,n)=>{let a;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(e.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},Kje=(t,e)=>{let r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=0,v,y,b,w,I,j,C,S;const E=new Uint8Array(4);let B,k;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Lg(t)||!t.output||!t.input&&t.avail_in!==0)return Od;r=t.state,r.mode===Ph&&(r.mode=r5),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,f=l,A=c,S=pg;e:for(;;)switch(r.mode){case iP:if(r.wrap===0){r.mode=r5;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=Uf(r.check,E,2,0),u=0,d=0,r.mode=WQ;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=Us;break}if((u&15)!==zQ){t.msg="unknown compression method",r.mode=Us;break}if(u>>>=4,d-=4,C=(u&15)+8,r.wbits===0&&(r.wbits=C),C>15||C>r.wbits){t.msg="invalid window size",r.mode=Us;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?nV:Ph,u=0,d=0;break;case WQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==zQ){t.msg="unknown compression method",r.mode=Us;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Us;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Uf(r.check,E,2,0)),u=0,d=0,r.mode=XQ;case XQ:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=Uf(r.check,E,4,0)),u=0,d=0,r.mode=YQ;case YQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Uf(r.check,E,2,0)),u=0,d=0,r.mode=JQ;case JQ:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Uf(r.check,E,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=ZQ;case ZQ:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),C)),r.flags&512&&r.wrap&4&&(r.check=Uf(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=eV;case eV:if(r.flags&2048){if(l===0)break e;h=0;do C=n[s+h++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C));while(C&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Uf(r.check,n,h,s)),l-=h,s+=h,C)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=tV;case tV:if(r.flags&4096){if(l===0)break e;h=0;do C=n[s+h++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C));while(C&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Uf(r.check,n,h,s)),l-=h,s+=h,C)break e}else r.head&&(r.head.comment=null);r.mode=rV;case rV:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Us;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ph;break;case nV:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.adler=r.check=pV(u),u=0,d=0,r.mode=OS;case OS:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,Rje;t.adler=r.check=1,r.mode=Ph;case Ph:if(e===Oje||e===kC)break e;case r5:if(r.last){u>>>=d&7,d-=d&7,r.mode=a5;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=aV;break;case 1:if(Gje(r),r.mode=FC,e===kC){u>>>=2,d-=2;break e}break;case 2:r.mode=iV;break;case 3:t.msg="invalid block type",r.mode=Us}u>>>=2,d-=2;break;case aV:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Us;break}if(r.length=u&65535,u=0,d=0,r.mode=n5,e===kC)break e;case n5:r.mode=sV;case sV:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=Ph;break;case iV:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Us;break}r.have=0,r.mode=oV;case oV:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[T[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},S=Pb(Fje,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid code lengths set",r.mode=Us;break}r.have=0,r.mode=lV;case lV:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(b<16)u>>>=v,d-=v,r.lens[r.have++]=b;else{if(b===16){for(k=v+2;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=v,d-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=Us;break}C=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(b===17){for(k=v+3;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,C=0,h=3+(u&7),u>>>=3,d-=3}else{for(k=v+7;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,C=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Us;break}for(;h--;)r.lens[r.have++]=C}}if(r.mode===Us)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Us;break}if(r.lenbits=9,B={bits:r.lenbits},S=Pb(Are,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid literal/lengths set",r.mode=Us;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},S=Pb(mre,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,S){t.msg="invalid distances set",r.mode=Us;break}if(r.mode=FC,e===kC)break e;case FC:r.mode=OC;case OC:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,jje(t,A),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,r.mode===Ph&&(r.back=-1);break}for(r.back=0;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(y&&!(y&240)){for(w=v,I=y,j=b;x=r.lencode[j+((u&(1<<w+I)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,r.length=b,y===0){r.mode=hV;break}if(y&32){r.back=-1,r.mode=Ph;break}if(y&64){t.msg="invalid literal/length code",r.mode=Us;break}r.extra=y&15,r.mode=cV;case cV:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=uV;case uV:for(;x=r.distcode[u&(1<<r.distbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(y&240)){for(w=v,I=y,j=b;x=r.distcode[j+((u&(1<<w+I)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,y&64){t.msg="invalid distance code",r.mode=Us;break}r.offset=b,r.extra=y&15,r.mode=dV;case dV:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Us;break}r.mode=fV;case fV:if(c===0)break e;if(h=A-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Us;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=a,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[o++]=p[m++];while(--h);r.length===0&&(r.mode=OC);break;case hV:if(c===0)break e;a[o++]=r.length,c--,r.mode=OC;break;case a5:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(A-=c,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Uf(r.check,a,A,o-A):Qk(r.check,a,A,o-A)),A=c,r.wrap&4&&(r.flags?u:pV(u))!==r.check){t.msg="incorrect data check",r.mode=Us;break}u=0,d=0}r.mode=AV;case AV:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Us;break}u=0,d=0}r.mode=mV;case mV:S=Dje;break e;case Us:S=pre;break e;case xre:return gre;case vre:default:return Od}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,(r.wsize||A!==t.avail_out&&r.mode<Us&&(r.mode<a5||e!==qQ))&&Cre(t,t.output,t.next_out,A-t.avail_out),f-=t.avail_in,A-=t.avail_out,t.total_in+=f,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Uf(r.check,a,A,t.next_out-A):Qk(r.check,a,A,t.next_out-A)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ph?128:0)+(r.mode===FC||r.mode===n5?256:0),(f===0&&A===0||e===qQ)&&S===pg&&(S=Mje),S},qje=t=>{if(Lg(t))return Od;let e=t.state;return e.window&&(e.window=null),t.state=null,pg},zje=(t,e)=>{if(Lg(t))return Od;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,pg):Od},Wje=(t,e)=>{const r=e.length;let n,a,s;return Lg(t)||(n=t.state,n.wrap!==0&&n.mode!==OS)?Od:n.mode===OS&&(a=1,a=Qk(a,e,r,0),a!==n.check)?pre:(s=Cre(t,e,r,r),s?(n.mode=xre,gre):(n.havedict=1,pg))};var Xje=bre,Yje=wre,Jje=yre,Zje=$je,eIe=Nre,tIe=Kje,rIe=qje,nIe=zje,aIe=Wje,sIe="pako inflate (from Nodeca project)",Vh={inflateReset:Xje,inflateReset2:Yje,inflateResetKeep:Jje,inflateInit:Zje,inflateInit2:eIe,inflate:tIe,inflateEnd:rIe,inflateGetHeader:nIe,inflateSetDictionary:aIe,inflateInfo:sIe};function iIe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var oIe=iIe;const _re=Object.prototype.toString,{Z_NO_FLUSH:lIe,Z_FINISH:cIe,Z_OK:T2,Z_STREAM_END:o5,Z_NEED_DICT:l5,Z_STREAM_ERROR:uIe,Z_DATA_ERROR:xV,Z_MEM_ERROR:dIe}=dre;function Lw(t){this.options=fre.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Eje,this.strm.avail_out=0;let r=Vh.inflateInit2(this.strm,e.windowBits);if(r!==T2)throw new Error(Vk[r]);if(this.header=new oIe,Vh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Hk.string2buf(e.dictionary):_re.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Vh.inflateSetDictionary(this.strm,e.dictionary),r!==T2)))throw new Error(Vk[r])}Lw.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?cIe:lIe,_re.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Vh.inflate(r,o),s===l5&&a&&(s=Vh.inflateSetDictionary(r,a),s===T2?s=Vh.inflate(r,o):s===xV&&(s=l5));r.avail_in>0&&s===o5&&r.state.wrap>0&&t[r.next_in]!==0;)Vh.inflateReset(r),s=Vh.inflate(r,o);switch(s){case uIe:case xV:case l5:case dIe:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===o5))if(this.options.to==="string"){let c=Hk.utf8border(r.output,r.next_out),u=r.next_out-c,d=Hk.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===T2&&l===0)){if(s===o5)return s=Vh.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Lw.prototype.onData=function(t){this.chunks.push(t)};Lw.prototype.onEnd=function(t){t===T2&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fre.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function fIe(t,e){const r=new Lw(e);if(r.push(t),r.err)throw r.msg||Vk[r.err];return r.result}var hIe=Lw,AIe=fIe,mIe={Inflate:hIe,inflate:AIe};const{Inflate:pIe,inflate:gIe}=mIe;var vV=pIe,xIe=gIe;const Ere=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;Ere[t]=e}const yV=4294967295;function vIe(t,e,r){let n=t;for(let a=0;a<r;a++)n=Ere[(n^e[a])&255]^n>>>8;return n}function yIe(t,e){return(vIe(yV,t,e)^yV)>>>0}function bV(t,e,r){const n=t.readUint32(),a=yIe(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function Sre(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function jre(t,e,r,n){let a=0;for(;a<n;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-n]&255}function Ire(t,e,r,n){let a=0;if(r.length===0)for(;a<n;a++)e[a]=t[a];else for(;a<n;a++)e[a]=t[a]+r[a]&255}function Pre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-a]>>1)&255}else{for(;s<a;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-a]+r[s]>>1)&255}}function Tre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-a]&255}else{for(;s<a;s++)e[s]=t[s]+r[s]&255;for(;s<n;s++)e[s]=t[s]+bIe(e[s-a],r[s],r[s-a])&255}}function bIe(t,e,r){const n=t+e-r,a=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-r);return a<=s&&a<=o?t:s<=o?e:r}function wIe(t,e,r,n,a,s){switch(t){case 0:Sre(e,r,a);break;case 1:jre(e,r,a,s);break;case 2:Ire(e,r,n,a);break;case 3:Pre(e,r,n,a,s);break;case 4:Tre(e,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const NIe=new Uint16Array([255]),CIe=new Uint8Array(NIe.buffer),_Ie=CIe[0]===255;function EIe(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],A=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(A<=0||h<=0)continue;const m=A*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const v=e[u++],y=e.subarray(u,u+m);u+=m;const b=new Uint8Array(m);wIe(v,y,b,p,m,l),p.set(b);for(let w=0;w<A;w++){const I=f.x+w*f.xStep,j=f.y+x*f.yStep;if(!(I>=r||j>=n))for(let C=0;C<l;C++)c[(j*r+I)*l+C]=b[w*l+C]}}}if(s===16){const d=new Uint16Array(c.buffer);if(_Ie)for(let f=0;f<d.length;f++)d[f]=SIe(d[f]);return d}else return c}function SIe(t){return(t&255)<<8|t>>8&255}const jIe=new Uint16Array([255]),IIe=new Uint8Array(jIe.buffer),PIe=IIe[0]===255,TIe=new Uint8Array(0);function wV(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let u=TIe,d=0,f,A;for(let h=0;h<n;h++){switch(f=e.subarray(d+1,d+1+l),A=c.subarray(h*l,(h+1)*l),e[d]){case 0:Sre(f,A,l);break;case 1:jre(f,A,l,o);break;case 2:Ire(f,A,u,l);break;case 3:Pre(f,A,u,l,o);break;case 4:Tre(f,A,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}u=A,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(PIe)for(let m=0;m<h.length;m++)h[m]=BIe(h[m]);return h}else return c}function BIe(t){return(t&255)<<8|t>>8&255}const gE=Uint8Array.of(137,80,78,71,13,10,26,10);function NV(t){if(!kIe(t.readBytes(gE.length)))throw new Error("wrong PNG signature")}function kIe(t){if(t.length<gE.length)return!1;for(let e=0;e<gE.length;e++)if(t[e]!==gE[e])return!1;return!0}const FIe="tEXt",OIe=0,Bre=new TextDecoder("latin1");function DIe(t){if(MIe(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const RIe=/^[\u0000-\u00FF]*$/;function MIe(t){if(!RIe.test(t))throw new Error("invalid latin1 text")}function LIe(t,e,r){const n=kre(e);t[n]=UIe(e,r-n.length-1)}function kre(t){for(t.mark();t.readByte()!==OIe;);const e=t.offset;t.reset();const r=Bre.decode(t.readBytes(e-t.offset-1));return t.skip(1),DIe(r),r}function UIe(t,e){return Bre.decode(t.readBytes(e))}const Cu={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},c5={UNKNOWN:-1,DEFLATE:0},CV={UNKNOWN:-1,ADAPTIVE:0},u5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},DC={NONE:0,BACKGROUND:1,PREVIOUS:2},d5={SOURCE:0,OVER:1};class QIe extends Y6{constructor(r,n={}){super(r);Tr(this,"_checkCrc");Tr(this,"_inflator");Tr(this,"_png");Tr(this,"_apng");Tr(this,"_end");Tr(this,"_hasPalette");Tr(this,"_palette");Tr(this,"_hasTransparency");Tr(this,"_transparency");Tr(this,"_compressionMethod");Tr(this,"_filterMethod");Tr(this,"_interlaceMethod");Tr(this,"_colorType");Tr(this,"_isAnimated");Tr(this,"_numberOfFrames");Tr(this,"_numberOfPlays");Tr(this,"_frames");Tr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new vV,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=c5.UNKNOWN,this._filterMethod=CV.UNKNOWN,this._interlaceMethod=u5.UNKNOWN,this._colorType=Cu.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(NV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(NV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case FIe:LIe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?bV(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?bV(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=VIe(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Cu.GREYSCALE:a=1;break;case Cu.TRUECOLOUR:a=3;break;case Cu.INDEXED_COLOUR:a=1;break;case Cu.GREYSCALE_ALPHA:a=2;break;case Cu.TRUECOLOUR_ALPHA:a=4;break;case Cu.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==c5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Cu.GREYSCALE:case Cu.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Cu.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Cu.UNKNOWN:case Cu.GREYSCALE_ALPHA:case Cu.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=kre(this),a=this.readUint8();if(a!==c5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:xIe(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=wV({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case DC.NONE:break;case DC.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case DC.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case d5.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case d5.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/a,A=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*A+(1-f)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==CV.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===u5.NO_INTERLACE)this._png.data=wV({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===u5.ADAM7)this._png.data=EIe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:DC.NONE,blendOp:d5.SOURCE,data:r}),this._inflator=new vV,this._writingDataChunks=!1}}function VIe(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var _V;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(_V||(_V={}));function HIe(t,e){return new QIe(t,e).decode()}var Ln=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function f5(){Ln.console&&typeof Ln.console.log=="function"&&Ln.console.log.apply(Ln.console,arguments)}var As={log:f5,warn:function(t){Ln.console&&(typeof Ln.console.warn=="function"?Ln.console.warn.apply(Ln.console,arguments):f5.call(null,arguments))},error:function(t){Ln.console&&(typeof Ln.console.error=="function"?Ln.console.error.apply(Ln.console,arguments):f5(t))}};function h5(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Ap(n.response,e,r)},n.onerror=function(){As.error("could not download file")},n.send()}function EV(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function RC(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Ap=Ln.saveAs||((typeof window>"u"?"undefined":ts(window))!=="object"||window!==Ln?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Ln.URL||Ln.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?EV(a.href)?h5(t,e,r):RC(a,a.target="_blank"):RC(a)):(a.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){RC(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(EV(t))h5(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){RC(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:ts(s)!=="object"&&(As.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return h5(t,e,r);var a=t.type==="application/octet-stream",s=/constructor/i.test(Ln.HTMLElement)||Ln.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":ts(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=Ln.URL||Ln.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Fre(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var xE=Ln.atob.bind(Ln),SV=Ln.btoa.bind(Ln);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function A5(t,e){var r=t[0],n=t[1],a=t[2],s=t[3];r=Hl(r,n,a,s,e[0],7,-680876936),s=Hl(s,r,n,a,e[1],12,-389564586),a=Hl(a,s,r,n,e[2],17,606105819),n=Hl(n,a,s,r,e[3],22,-1044525330),r=Hl(r,n,a,s,e[4],7,-176418897),s=Hl(s,r,n,a,e[5],12,1200080426),a=Hl(a,s,r,n,e[6],17,-1473231341),n=Hl(n,a,s,r,e[7],22,-45705983),r=Hl(r,n,a,s,e[8],7,1770035416),s=Hl(s,r,n,a,e[9],12,-1958414417),a=Hl(a,s,r,n,e[10],17,-42063),n=Hl(n,a,s,r,e[11],22,-1990404162),r=Hl(r,n,a,s,e[12],7,1804603682),s=Hl(s,r,n,a,e[13],12,-40341101),a=Hl(a,s,r,n,e[14],17,-1502002290),r=$l(r,n=Hl(n,a,s,r,e[15],22,1236535329),a,s,e[1],5,-165796510),s=$l(s,r,n,a,e[6],9,-1069501632),a=$l(a,s,r,n,e[11],14,643717713),n=$l(n,a,s,r,e[0],20,-373897302),r=$l(r,n,a,s,e[5],5,-701558691),s=$l(s,r,n,a,e[10],9,38016083),a=$l(a,s,r,n,e[15],14,-660478335),n=$l(n,a,s,r,e[4],20,-405537848),r=$l(r,n,a,s,e[9],5,568446438),s=$l(s,r,n,a,e[14],9,-1019803690),a=$l(a,s,r,n,e[3],14,-187363961),n=$l(n,a,s,r,e[8],20,1163531501),r=$l(r,n,a,s,e[13],5,-1444681467),s=$l(s,r,n,a,e[2],9,-51403784),a=$l(a,s,r,n,e[7],14,1735328473),r=Gl(r,n=$l(n,a,s,r,e[12],20,-1926607734),a,s,e[5],4,-378558),s=Gl(s,r,n,a,e[8],11,-2022574463),a=Gl(a,s,r,n,e[11],16,1839030562),n=Gl(n,a,s,r,e[14],23,-35309556),r=Gl(r,n,a,s,e[1],4,-1530992060),s=Gl(s,r,n,a,e[4],11,1272893353),a=Gl(a,s,r,n,e[7],16,-155497632),n=Gl(n,a,s,r,e[10],23,-1094730640),r=Gl(r,n,a,s,e[13],4,681279174),s=Gl(s,r,n,a,e[0],11,-358537222),a=Gl(a,s,r,n,e[3],16,-722521979),n=Gl(n,a,s,r,e[6],23,76029189),r=Gl(r,n,a,s,e[9],4,-640364487),s=Gl(s,r,n,a,e[12],11,-421815835),a=Gl(a,s,r,n,e[15],16,530742520),r=Kl(r,n=Gl(n,a,s,r,e[2],23,-995338651),a,s,e[0],6,-198630844),s=Kl(s,r,n,a,e[7],10,1126891415),a=Kl(a,s,r,n,e[14],15,-1416354905),n=Kl(n,a,s,r,e[5],21,-57434055),r=Kl(r,n,a,s,e[12],6,1700485571),s=Kl(s,r,n,a,e[3],10,-1894986606),a=Kl(a,s,r,n,e[10],15,-1051523),n=Kl(n,a,s,r,e[1],21,-2054922799),r=Kl(r,n,a,s,e[8],6,1873313359),s=Kl(s,r,n,a,e[15],10,-30611744),a=Kl(a,s,r,n,e[6],15,-1560198380),n=Kl(n,a,s,r,e[13],21,1309151649),r=Kl(r,n,a,s,e[4],6,-145523070),s=Kl(s,r,n,a,e[11],10,-1120210379),a=Kl(a,s,r,n,e[2],15,718787259),n=Kl(n,a,s,r,e[9],21,-343485551),t[0]=Y0(r,t[0]),t[1]=Y0(n,t[1]),t[2]=Y0(a,t[2]),t[3]=Y0(s,t[3])}function oP(t,e,r,n,a,s){return e=Y0(Y0(e,t),Y0(n,s)),Y0(e<<a|e>>>32-a,r)}function Hl(t,e,r,n,a,s,o){return oP(e&r|~e&n,t,e,a,s,o)}function $l(t,e,r,n,a,s,o){return oP(e&n|r&~n,t,e,a,s,o)}function Gl(t,e,r,n,a,s,o){return oP(e^r^n,t,e,a,s,o)}function Kl(t,e,r,n,a,s,o){return oP(r^(e|~n),t,e,a,s,o)}function Ore(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)A5(n,$Ie(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(A5(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*r,A5(n,a),n}function $Ie(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var jV="0123456789abcdef".split("");function GIe(t){for(var e="",r=0;r<4;r++)e+=jV[t>>8*r+4&15]+jV[t>>8*r&15];return e}function KIe(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function $k(t){return Ore(t).map(KIe).join("")}var qIe=function(t){for(var e=0;e<t.length;e++)t[e]=GIe(t[e]);return t.join("")}(Ore("hello"))!="5d41402abc4b2a76b9719d911017c592";function Y0(t,e){if(qIe){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gk(t,e){var r,n,a,s;if(t!==r){for(var o=(a=t,s=1+(256/t.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var f=e.length,A=0,h=0,m="";for(c=0;c<f;c++)h=(h+(d=l[A=(A+1)%256]))%256,l[A]=l[h],l[h]=d,o=l[(l[A]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var IV={print:4,modify:8,copy:16,"annot-forms":32};function kx(t,e,r,n){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(IV.perm!==void 0)throw new Error("Invalid permission: "+l);a+=IV[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=$k(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Gk(this.encryptionKey,this.padding)}function Fx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var a=t.charCodeAt(n);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[n]}return e}function PV(t){if(ts(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[r]){var o=e[r][s];try{o[0].apply(t,n)}catch(l){Ln.console&&As.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function B2(t){if(!(this instanceof B2))return new B2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Dre(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function V0(t,e,r,n,a){if(!(this instanceof V0))return new V0(t,e,r,n,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Dre.call(this,n,a)}function Pp(t,e,r,n,a){if(!(this instanceof Pp))return new Pp(t,e,r,n,a);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Dre.call(this,n,a)}function rn(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;ts(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,a=t.format||a,s=t.compress||t.compressPdf||s,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,A={},h={internal:{},__private__:{}};h.__private__.PubSub=PV;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(M){m=M};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var v=h.__private__.getPageFormat=function(M){return x[M]};a=a||"a4";var y="compat",b="advanced",w=y;function I(){this.saveGraphicsState(),ee(new ke(ht,0,0,-ht,0,Ao()*ht).toString()+" cm"),this.setFontSize(this.getFontSize()/ht),u="n",w=b}function j(){this.restoreGraphicsState(),u="S",w=y}var C=h.__private__.combineFontStyleAndFontWeight=function(M,Ee){if(M=="bold"&&Ee=="normal"||M=="bold"&&Ee==400||M=="normal"&&Ee=="italic"||M=="bold"&&Ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ee&&(M=Ee==400||Ee==="normal"?M==="italic"?"italic":"normal":Ee!=700&&Ee!=="bold"||M!=="normal"?(Ee==700?"bold":Ee)+""+M:"bold"),M};h.advancedAPI=function(M){var Ee=w===y;return Ee&&I.call(this),typeof M!="function"||(M(this),Ee&&j.call(this)),this},h.compatAPI=function(M){var Ee=w===b;return Ee&&j.call(this),typeof M!="function"||(M(this),Ee&&I.call(this)),this},h.isAdvancedAPI=function(){return w===b};var S,E=function(M){if(w!==b)throw new Error(M+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=h.roundToPrecision=h.__private__.roundToPrecision=function(M,Ee){var mt=e||Ee;if(isNaN(M)||isNaN(mt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return M.toFixed(mt).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf=typeof c=="number"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,c)}:c==="smart"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,M>-1&&M<1?16:5)}:function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,16)};var k=h.f2=h.__private__.f2=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f2");return B(M,2)},T=h.__private__.f3=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f3");return B(M,3)},P=h.scale=h.__private__.scale=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.scale");return w===y?M*ht:w===b?M:void 0},G=function(M){return P(function(Ee){return w===y?Ao()-Ee:w===b?Ee:void 0}(M))};h.__private__.setPrecision=h.setPrecision=function(M){typeof parseInt(M,10)=="number"&&(e=parseInt(M,10))};var ce,ue="00000000000000000000000000000000",le=h.__private__.getFileId=function(){return ue},Ae=h.__private__.setFileId=function(M){return ue=M!==void 0&&/^[a-fA-F0-9]{32}$/.test(M)?M.toUpperCase():ue.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Sr=new kx(d.userPermissions,d.userPassword,d.ownerPassword,ue)),ue};h.setFileId=function(M){return Ae(M),this},h.getFileId=function(){return le()};var ae=h.__private__.convertDateToPDFDate=function(M){var Ee=M.getTimezoneOffset(),mt=Ee<0?"+":"-",jt=Math.floor(Math.abs(Ee/60)),$t=Math.abs(Ee%60),Ar=[mt,K(jt),"'",K($t),"'"].join("");return["D:",M.getFullYear(),K(M.getMonth()+1),K(M.getDate()),K(M.getHours()),K(M.getMinutes()),K(M.getSeconds()),Ar].join("")},_e=h.__private__.convertPDFDateToDate=function(M){var Ee=parseInt(M.substr(2,4),10),mt=parseInt(M.substr(6,2),10)-1,jt=parseInt(M.substr(8,2),10),$t=parseInt(M.substr(10,2),10),Ar=parseInt(M.substr(12,2),10),Nr=parseInt(M.substr(14,2),10);return new Date(Ee,mt,jt,$t,Ar,Nr,0)},De=h.__private__.setCreationDate=function(M){var Ee;if(M===void 0&&(M=new Date),M instanceof Date)Ee=ae(M);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(M))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ee=M}return ce=Ee},O=h.__private__.getCreationDate=function(M){var Ee=ce;return M==="jsDate"&&(Ee=_e(ce)),Ee};h.setCreationDate=function(M){return De(M),this},h.getCreationDate=function(M){return O(M)};var H,K=h.__private__.padd2=function(M){return("0"+parseInt(M)).slice(-2)},R=h.__private__.padd2Hex=function(M){return("00"+(M=M.toString())).substr(M.length)},X=0,Y=[],D=[],Q=0,te=[],be=[],U=!1,Xe=D;h.__private__.setCustomOutputDestination=function(M){U=!0,Xe=M};var se=function(M){U||(Xe=M)};h.__private__.resetCustomOutputDestination=function(){U=!1,Xe=D};var ee=h.__private__.out=function(M){return M=M.toString(),Q+=M.length+1,Xe.push(M),Xe},Fe=h.__private__.write=function(M){return ee(arguments.length===1?M.toString():Array.prototype.join.call(arguments," "))},je=h.__private__.getArrayBuffer=function(M){for(var Ee=M.length,mt=new ArrayBuffer(Ee),jt=new Uint8Array(mt);Ee--;)jt[Ee]=M.charCodeAt(Ee);return mt},Se=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Se};var Ze=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(M){return Ze=w===b?M/ht:M,this};var ut,Et=h.__private__.getFontSize=h.getFontSize=function(){return w===y?Ze:Ze*ht},St=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(M){return St=M,this},h.__private__.getR2L=h.getR2L=function(){return St};var Ft,Qt=h.__private__.setZoomMode=function(M){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(M))ut=M;else if(isNaN(M)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(M)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+M+'" is not recognized.');ut=M}else ut=parseInt(M,10)};h.__private__.getZoomMode=function(){return ut};var Ut,Tt=h.__private__.setPageMode=function(M){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(M)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+M+'" is not recognized.');Ft=M};h.__private__.getPageMode=function(){return Ft};var Re=h.__private__.setLayoutMode=function(M){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(M)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+M+'" is not recognized.');Ut=M};h.__private__.getLayoutMode=function(){return Ut},h.__private__.setDisplayMode=h.setDisplayMode=function(M,Ee,mt){return Qt(M),Re(Ee),Tt(mt),this};var Te={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(M){if(Object.keys(Te).indexOf(M)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Te[M]},h.__private__.getDocumentProperties=function(){return Te},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(M){for(var Ee in Te)Te.hasOwnProperty(Ee)&&M[Ee]&&(Te[Ee]=M[Ee]);return this},h.__private__.setDocumentProperty=function(M,Ee){if(Object.keys(Te).indexOf(M)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Te[M]=Ee};var Ye,ht,Oe,Ie,We,Z={},Qe={},at=[],Ge={},ie={},xe={},de={},Me=null,me=0,we=[],pt=new PV(h),vt=t.hotfixes||[],bt={},kt={},Vt=[],ke=function M(Ee,mt,jt,$t,Ar,Nr){if(!(this instanceof M))return new M(Ee,mt,jt,$t,Ar,Nr);isNaN(Ee)&&(Ee=1),isNaN(mt)&&(mt=0),isNaN(jt)&&(jt=0),isNaN($t)&&($t=1),isNaN(Ar)&&(Ar=0),isNaN(Nr)&&(Nr=0),this._matrix=[Ee,mt,jt,$t,Ar,Nr]};Object.defineProperty(ke.prototype,"sx",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(ke.prototype,"shy",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(ke.prototype,"shx",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(ke.prototype,"sy",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(ke.prototype,"tx",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(ke.prototype,"ty",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(ke.prototype,"a",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(ke.prototype,"b",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(ke.prototype,"c",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(ke.prototype,"d",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(ke.prototype,"e",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(ke.prototype,"f",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(ke.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ke.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ke.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ke.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ke.prototype.join=function(M){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(M)},ke.prototype.multiply=function(M){var Ee=M.sx*this.sx+M.shy*this.shx,mt=M.sx*this.shy+M.shy*this.sy,jt=M.shx*this.sx+M.sy*this.shx,$t=M.shx*this.shy+M.sy*this.sy,Ar=M.tx*this.sx+M.ty*this.shx+this.tx,Nr=M.tx*this.shy+M.ty*this.sy+this.ty;return new ke(Ee,mt,jt,$t,Ar,Nr)},ke.prototype.decompose=function(){var M=this.sx,Ee=this.shy,mt=this.shx,jt=this.sy,$t=this.tx,Ar=this.ty,Nr=Math.sqrt(M*M+Ee*Ee),an=(M/=Nr)*mt+(Ee/=Nr)*jt;mt-=M*an,jt-=Ee*an;var fn=Math.sqrt(mt*mt+jt*jt);return an/=fn,M*(jt/=fn)<Ee*(mt/=fn)&&(M=-M,Ee=-Ee,an=-an,Nr=-Nr),{scale:new ke(Nr,0,0,fn,0,0),translate:new ke(1,0,0,1,$t,Ar),rotate:new ke(M,Ee,-Ee,M,0,0),skew:new ke(1,0,an,1,0,0)}},ke.prototype.toString=function(M){return this.join(" ")},ke.prototype.inversed=function(){var M=this.sx,Ee=this.shy,mt=this.shx,jt=this.sy,$t=this.tx,Ar=this.ty,Nr=1/(M*jt-Ee*mt),an=jt*Nr,fn=-Ee*Nr,Bn=-mt*Nr,Vn=M*Nr;return new ke(an,fn,Bn,Vn,-an*$t-Bn*Ar,-fn*$t-Vn*Ar)},ke.prototype.applyToPoint=function(M){var Ee=M.x*this.sx+M.y*this.shx+this.tx,mt=M.x*this.shy+M.y*this.sy+this.ty;return new Rl(Ee,mt)},ke.prototype.applyToRectangle=function(M){var Ee=this.applyToPoint(M),mt=this.applyToPoint(new Rl(M.x+M.w,M.y+M.h));return new eo(Ee.x,Ee.y,mt.x-Ee.x,mt.y-Ee.y)},ke.prototype.clone=function(){var M=this.sx,Ee=this.shy,mt=this.shx,jt=this.sy,$t=this.tx,Ar=this.ty;return new ke(M,Ee,mt,jt,$t,Ar)},h.Matrix=ke;var Ne=h.matrixMult=function(M,Ee){return Ee.multiply(M)},pe=new ke(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=pe;var Le=function(M,Ee){if(!ie[M]){var mt=(Ee instanceof V0?"Sh":"P")+(Object.keys(Ge).length+1).toString(10);Ee.id=mt,ie[M]=mt,Ge[mt]=Ee,pt.publish("addPattern",Ee)}};h.ShadingPattern=V0,h.TilingPattern=Pp,h.addShadingPattern=function(M,Ee){return E("addShadingPattern()"),Le(M,Ee),this},h.beginTilingPattern=function(M){E("beginTilingPattern()"),Qc(M.boundingBox[0],M.boundingBox[1],M.boundingBox[2]-M.boundingBox[0],M.boundingBox[3]-M.boundingBox[1],M.matrix)},h.endTilingPattern=function(M,Ee){E("endTilingPattern()"),Ee.stream=be[H].join(`
`),Le(M,Ee),pt.publish("endTilingPattern",Ee),Vt.pop().restore()};var ft,At=h.__private__.newObject=function(){var M=ct();return W(M,!0),M},ct=h.__private__.newObjectDeferred=function(){return X++,Y[X]=function(){return Q},X},W=function(M,Ee){return Ee=typeof Ee=="boolean"&&Ee,Y[M]=Q,Ee&&ee(M+" 0 obj"),M},z=h.__private__.newAdditionalObject=function(){var M={objId:ct(),content:""};return te.push(M),M},re=ct(),V=ct(),L=h.__private__.decodeColorString=function(M){var Ee=M.split(" ");if(Ee.length!==2||Ee[1]!=="g"&&Ee[1]!=="G")Ee.length!==5||Ee[4]!=="k"&&Ee[4]!=="K"||(Ee=[(1-Ee[0])*(1-Ee[3]),(1-Ee[1])*(1-Ee[3]),(1-Ee[2])*(1-Ee[3]),"r"]);else{var mt=parseFloat(Ee[0]);Ee=[mt,mt,mt,"r"]}for(var jt="#",$t=0;$t<3;$t++)jt+=("0"+Math.floor(255*parseFloat(Ee[$t])).toString(16)).slice(-2);return jt},fe=h.__private__.encodeColorString=function(M){var Ee;typeof M=="string"&&(M={ch1:M});var mt=M.ch1,jt=M.ch2,$t=M.ch3,Ar=M.ch4,Nr=M.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof mt=="string"&&mt.charAt(0)!=="#"){var an=new Fre(mt);if(an.ok)mt=an.toHex();else if(!/^\d*\.?\d*$/.test(mt))throw new Error('Invalid color "'+mt+'" passed to jsPDF.encodeColorString.')}if(typeof mt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(mt)&&(mt="#"+mt[1]+mt[1]+mt[2]+mt[2]+mt[3]+mt[3]),typeof mt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(mt)){var fn=parseInt(mt.substr(1),16);mt=fn>>16&255,jt=fn>>8&255,$t=255&fn}if(jt===void 0||Ar===void 0&&mt===jt&&jt===$t)Ee=typeof mt=="string"?mt+" "+Nr[0]:M.precision===2?k(mt/255)+" "+Nr[0]:T(mt/255)+" "+Nr[0];else if(Ar===void 0||ts(Ar)==="object"){if(Ar&&!isNaN(Ar.a)&&Ar.a===0)return["1.","1.","1.",Nr[1]].join(" ");Ee=typeof mt=="string"?[mt,jt,$t,Nr[1]].join(" "):M.precision===2?[k(mt/255),k(jt/255),k($t/255),Nr[1]].join(" "):[T(mt/255),T(jt/255),T($t/255),Nr[1]].join(" ")}else Ee=typeof mt=="string"?[mt,jt,$t,Ar,Nr[2]].join(" "):M.precision===2?[k(mt),k(jt),k($t),k(Ar),Nr[2]].join(" "):[T(mt),T(jt),T($t),T(Ar),Nr[2]].join(" ");return Ee},Be=h.__private__.getFilters=function(){return o},ye=h.__private__.putStream=function(M){var Ee=(M=M||{}).data||"",mt=M.filters||Be(),jt=M.alreadyAppliedFilters||[],$t=M.addLength1||!1,Ar=Ee.length,Nr=M.objectId,an=function(xi){return xi};if(d!==null&&Nr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(an=Sr.encryptor(Nr,0));var fn={};mt===!0&&(mt=["FlateEncode"]);var Bn=M.additionalKeyValues||[],Vn=(fn=rn.API.processDataByFilters!==void 0?rn.API.processDataByFilters(Ee,mt):{data:Ee,reverseChain:[]}).reverseChain+(Array.isArray(jt)?jt.join(" "):jt.toString());if(fn.data.length!==0&&(Bn.push({key:"Length",value:fn.data.length}),$t===!0&&Bn.push({key:"Length1",value:Ar})),Vn.length!=0)if(Vn.split("/").length-1==1)Bn.push({key:"Filter",value:Vn});else{Bn.push({key:"Filter",value:"["+Vn+"]"});for(var da=0;da<Bn.length;da+=1)if(Bn[da].key==="DecodeParms"){for(var Oa=[],Zs=0;Zs<fn.reverseChain.split("/").length-1;Zs+=1)Oa.push("null");Oa.push(Bn[da].value),Bn[da].value="["+Oa.join(" ")+"]"}}ee("<<");for(var $a=0;$a<Bn.length;$a++)ee("/"+Bn[$a].key+" "+Bn[$a].value);ee(">>"),fn.data.length!==0&&(ee("stream"),ee(an(fn.data)),ee("endstream"))},$e=h.__private__.putPage=function(M){var Ee=M.number,mt=M.data,jt=M.objId,$t=M.contentsObjId;W(jt,!0),ee("<</Type /Page"),ee("/Parent "+M.rootDictionaryObjId+" 0 R"),ee("/Resources "+M.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(S(M.mediaBox.bottomLeftX))+" "+parseFloat(S(M.mediaBox.bottomLeftY))+" "+S(M.mediaBox.topRightX)+" "+S(M.mediaBox.topRightY)+"]"),M.cropBox!==null&&ee("/CropBox ["+S(M.cropBox.bottomLeftX)+" "+S(M.cropBox.bottomLeftY)+" "+S(M.cropBox.topRightX)+" "+S(M.cropBox.topRightY)+"]"),M.bleedBox!==null&&ee("/BleedBox ["+S(M.bleedBox.bottomLeftX)+" "+S(M.bleedBox.bottomLeftY)+" "+S(M.bleedBox.topRightX)+" "+S(M.bleedBox.topRightY)+"]"),M.trimBox!==null&&ee("/TrimBox ["+S(M.trimBox.bottomLeftX)+" "+S(M.trimBox.bottomLeftY)+" "+S(M.trimBox.topRightX)+" "+S(M.trimBox.topRightY)+"]"),M.artBox!==null&&ee("/ArtBox ["+S(M.artBox.bottomLeftX)+" "+S(M.artBox.bottomLeftY)+" "+S(M.artBox.topRightX)+" "+S(M.artBox.topRightY)+"]"),typeof M.userUnit=="number"&&M.userUnit!==1&&ee("/UserUnit "+M.userUnit),pt.publish("putPage",{objId:jt,pageContext:we[Ee],pageNumber:Ee,page:mt}),ee("/Contents "+$t+" 0 R"),ee(">>"),ee("endobj");var Ar=mt.join(`
`);return w===b&&(Ar+=`
Q`),W($t,!0),ye({data:Ar,filters:Be(),objectId:$t}),ee("endobj"),jt},ze=h.__private__.putPages=function(){var M,Ee,mt=[];for(M=1;M<=me;M++)we[M].objId=ct(),we[M].contentsObjId=ct();for(M=1;M<=me;M++)mt.push($e({number:M,data:be[M],objId:we[M].objId,contentsObjId:we[M].contentsObjId,mediaBox:we[M].mediaBox,cropBox:we[M].cropBox,bleedBox:we[M].bleedBox,trimBox:we[M].trimBox,artBox:we[M].artBox,userUnit:we[M].userUnit,rootDictionaryObjId:re,resourceDictionaryObjId:V}));W(re,!0),ee("<</Type /Pages");var jt="/Kids [";for(Ee=0;Ee<me;Ee++)jt+=mt[Ee]+" 0 R ";ee(jt+"]"),ee("/Count "+me),ee(">>"),ee("endobj"),pt.publish("postPutPages")},Ke=function(M){pt.publish("putFont",{font:M,out:ee,newObject:At,putStream:ye}),M.isAlreadyPutted!==!0&&(M.objectNumber=At(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+Fx(M.postScriptName)),ee("/Subtype /Type1"),typeof M.encoding=="string"&&ee("/Encoding /"+M.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},yt=function(M){M.objectNumber=At();var Ee=[];Ee.push({key:"Type",value:"/XObject"}),Ee.push({key:"Subtype",value:"/Form"}),Ee.push({key:"BBox",value:"["+[S(M.x),S(M.y),S(M.x+M.width),S(M.y+M.height)].join(" ")+"]"}),Ee.push({key:"Matrix",value:"["+M.matrix.toString()+"]"});var mt=M.pages[1].join(`
`);ye({data:mt,additionalKeyValues:Ee,objectId:M.objectNumber}),ee("endobj")},ne=function(M,Ee){Ee||(Ee=21);var mt=At(),jt=function(Nr,an){var fn,Bn=[],Vn=1/(an-1);for(fn=0;fn<1;fn+=Vn)Bn.push(fn);if(Bn.push(1),Nr[0].offset!=0){var da={offset:0,color:Nr[0].color};Nr.unshift(da)}if(Nr[Nr.length-1].offset!=1){var Oa={offset:1,color:Nr[Nr.length-1].color};Nr.push(Oa)}for(var Zs="",$a=0,xi=0;xi<Bn.length;xi++){for(fn=Bn[xi];fn>Nr[$a+1].offset;)$a++;var ei=Nr[$a].offset,vi=(fn-ei)/(Nr[$a+1].offset-ei),ti=Nr[$a].color,Hc=Nr[$a+1].color;Zs+=R(Math.round((1-vi)*ti[0]+vi*Hc[0]).toString(16))+R(Math.round((1-vi)*ti[1]+vi*Hc[1]).toString(16))+R(Math.round((1-vi)*ti[2]+vi*Hc[2]).toString(16))}return Zs.trim()}(M.colors,Ee),$t=[];$t.push({key:"FunctionType",value:"0"}),$t.push({key:"Domain",value:"[0.0 1.0]"}),$t.push({key:"Size",value:"["+Ee+"]"}),$t.push({key:"BitsPerSample",value:"8"}),$t.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),$t.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ye({data:jt,additionalKeyValues:$t,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:mt}),ee("endobj"),M.objectNumber=At(),ee("<< /ShadingType "+M.type),ee("/ColorSpace /DeviceRGB");var Ar="/Coords ["+S(parseFloat(M.coords[0]))+" "+S(parseFloat(M.coords[1]))+" ";M.type===2?Ar+=S(parseFloat(M.coords[2]))+" "+S(parseFloat(M.coords[3])):Ar+=S(parseFloat(M.coords[2]))+" "+S(parseFloat(M.coords[3]))+" "+S(parseFloat(M.coords[4]))+" "+S(parseFloat(M.coords[5])),ee(Ar+="]"),M.matrix&&ee("/Matrix ["+M.matrix.toString()+"]"),ee("/Function "+mt+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},Ue=function(M,Ee){var mt=ct(),jt=At();Ee.push({resourcesOid:mt,objectOid:jt}),M.objectNumber=jt;var $t=[];$t.push({key:"Type",value:"/Pattern"}),$t.push({key:"PatternType",value:"1"}),$t.push({key:"PaintType",value:"1"}),$t.push({key:"TilingType",value:"1"}),$t.push({key:"BBox",value:"["+M.boundingBox.map(S).join(" ")+"]"}),$t.push({key:"XStep",value:S(M.xStep)}),$t.push({key:"YStep",value:S(M.yStep)}),$t.push({key:"Resources",value:mt+" 0 R"}),M.matrix&&$t.push({key:"Matrix",value:"["+M.matrix.toString()+"]"}),ye({data:M.stream,additionalKeyValues:$t,objectId:M.objectNumber}),ee("endobj")},rt=function(M){for(var Ee in M.objectNumber=At(),ee("<<"),M)switch(Ee){case"opacity":ee("/ca "+k(M[Ee]));break;case"stroke-opacity":ee("/CA "+k(M[Ee]))}ee(">>"),ee("endobj")},st=function(M){W(M.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var Ee in ee("/Font <<"),Z)Z.hasOwnProperty(Ee)&&(f===!1||f===!0&&A.hasOwnProperty(Ee))&&ee("/"+Ee+" "+Z[Ee].objectNumber+" 0 R");ee(">>")}(),function(){if(Object.keys(Ge).length>0){for(var Ee in ee("/Shading <<"),Ge)Ge.hasOwnProperty(Ee)&&Ge[Ee]instanceof V0&&Ge[Ee].objectNumber>=0&&ee("/"+Ee+" "+Ge[Ee].objectNumber+" 0 R");pt.publish("putShadingPatternDict"),ee(">>")}}(),function(Ee){if(Object.keys(Ge).length>0){for(var mt in ee("/Pattern <<"),Ge)Ge.hasOwnProperty(mt)&&Ge[mt]instanceof h.TilingPattern&&Ge[mt].objectNumber>=0&&Ge[mt].objectNumber<Ee&&ee("/"+mt+" "+Ge[mt].objectNumber+" 0 R");pt.publish("putTilingPatternDict"),ee(">>")}}(M.objectOid),function(){if(Object.keys(xe).length>0){var Ee;for(Ee in ee("/ExtGState <<"),xe)xe.hasOwnProperty(Ee)&&xe[Ee].objectNumber>=0&&ee("/"+Ee+" "+xe[Ee].objectNumber+" 0 R");pt.publish("putGStateDict"),ee(">>")}}(),function(){for(var Ee in ee("/XObject <<"),bt)bt.hasOwnProperty(Ee)&&bt[Ee].objectNumber>=0&&ee("/"+Ee+" "+bt[Ee].objectNumber+" 0 R");pt.publish("putXobjectDict"),ee(">>")}(),ee(">>"),ee("endobj")},_t=function(M){Qe[M.fontName]=Qe[M.fontName]||{},Qe[M.fontName][M.fontStyle]=M.id},Ot=function(M,Ee,mt,jt,$t){var Ar={id:"F"+(Object.keys(Z).length+1).toString(10),postScriptName:M,fontName:Ee,fontStyle:mt,encoding:jt,isStandardFont:$t||!1,metadata:{}};return pt.publish("addFont",{font:Ar,instance:this}),Z[Ar.id]=Ar,_t(Ar),Ar.id},nr=h.__private__.pdfEscape=h.pdfEscape=function(M,Ee){return function(mt,jt){var $t,Ar,Nr,an,fn,Bn,Vn,da,Oa;if(Nr=(jt=jt||{}).sourceEncoding||"Unicode",fn=jt.outputEncoding,(jt.autoencode||fn)&&Z[Ye].metadata&&Z[Ye].metadata[Nr]&&Z[Ye].metadata[Nr].encoding&&(an=Z[Ye].metadata[Nr].encoding,!fn&&Z[Ye].encoding&&(fn=Z[Ye].encoding),!fn&&an.codePages&&(fn=an.codePages[0]),typeof fn=="string"&&(fn=an[fn]),fn)){for(Vn=!1,Bn=[],$t=0,Ar=mt.length;$t<Ar;$t++)(da=fn[mt.charCodeAt($t)])?Bn.push(String.fromCharCode(da)):Bn.push(mt[$t]),Bn[$t].charCodeAt(0)>>8&&(Vn=!0);mt=Bn.join("")}for($t=mt.length;Vn===void 0&&$t!==0;)mt.charCodeAt($t-1)>>8&&(Vn=!0),$t--;if(!Vn)return mt;for(Bn=jt.noBOM?[]:[254,255],$t=0,Ar=mt.length;$t<Ar;$t++){if((Oa=(da=mt.charCodeAt($t))>>8)>>8)throw new Error("Character at position "+$t+" of string '"+mt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Bn.push(Oa),Bn.push(da-(Oa<<8))}return String.fromCharCode.apply(void 0,Bn)}(M,Ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ir=h.__private__.beginPage=function(M){be[++me]=[],we[me]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(M[0]),topRightY:Number(M[1])}},kr(me),se(be[H])},Qr=function(M,Ee){var mt,jt,$t;switch(r=Ee||r,typeof M=="string"&&(mt=v(M.toLowerCase()),Array.isArray(mt)&&(jt=mt[0],$t=mt[1])),Array.isArray(M)&&(jt=M[0]*ht,$t=M[1]*ht),isNaN(jt)&&(jt=a[0],$t=a[1]),(jt>14400||$t>14400)&&(As.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),jt=Math.min(14400,jt),$t=Math.min(14400,$t)),a=[jt,$t],r.substr(0,1)){case"l":$t>jt&&(a=[$t,jt]);break;case"p":jt>$t&&(a=[$t,jt])}Ir(a),Rt(wr),ee(gn),va!==0&&ee(va+" J"),Qn!==0&&ee(Qn+" j"),pt.publish("addPage",{pageNumber:me})},or=function(M){M>0&&M<=me&&(be.splice(M,1),we.splice(M,1),me--,H>me&&(H=me),this.setPage(H))},kr=function(M){M>0&&M<=me&&(H=M)},Zr=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return be.length-1},nn=function(M,Ee,mt){var jt,$t=void 0;return mt=mt||{},M=M!==void 0?M:Z[Ye].fontName,Ee=Ee!==void 0?Ee:Z[Ye].fontStyle,jt=M.toLowerCase(),Qe[jt]!==void 0&&Qe[jt][Ee]!==void 0?$t=Qe[jt][Ee]:Qe[M]!==void 0&&Qe[M][Ee]!==void 0?$t=Qe[M][Ee]:mt.disableWarning===!1&&As.warn("Unable to look up font label for font '"+M+"', '"+Ee+"'. Refer to getFontList() for available fonts."),$t||mt.noFallback||($t=Qe.times[Ee])==null&&($t=Qe.times.normal),$t},_r=h.__private__.putInfo=function(){var M=At(),Ee=function(jt){return jt};for(var mt in d!==null&&(Ee=Sr.encryptor(M,0)),ee("<<"),ee("/Producer ("+nr(Ee("jsPDF "+rn.version))+")"),Te)Te.hasOwnProperty(mt)&&Te[mt]&&ee("/"+mt.substr(0,1).toUpperCase()+mt.substr(1)+" ("+nr(Ee(Te[mt]))+")");ee("/CreationDate ("+nr(Ee(ce))+")"),ee(">>"),ee("endobj")},He=h.__private__.putCatalog=function(M){var Ee=(M=M||{}).rootDictionaryObjId||re;switch(At(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+Ee+" 0 R"),ut||(ut="fullwidth"),ut){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var mt=""+ut;mt.substr(mt.length-1)==="%"&&(ut=parseInt(ut)/100),typeof ut=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+k(ut)+"]")}switch(Ut||(Ut="continuous"),Ut){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}Ft&&ee("/PageMode /"+Ft),pt.publish("putCatalog"),ee(">>"),ee("endobj")},Bt=h.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(X+1)),ee("/Root "+X+" 0 R"),ee("/Info "+(X-1)+" 0 R"),d!==null&&ee("/Encrypt "+Sr.oid+" 0 R"),ee("/ID [ <"+ue+"> <"+ue+"> ]"),ee(">>")},xr=h.__private__.putHeader=function(){ee("%PDF-"+m),ee("%")},dn=h.__private__.putXRef=function(){var M="0000000000";ee("xref"),ee("0 "+(X+1)),ee("0000000000 65535 f ");for(var Ee=1;Ee<=X;Ee++)typeof Y[Ee]=="function"?ee((M+Y[Ee]()).slice(-10)+" 00000 n "):Y[Ee]!==void 0?ee((M+Y[Ee]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},Jr=h.__private__.buildDocument=function(){var M;X=0,Q=0,D=[],Y=[],te=[],re=ct(),V=ct(),se(D),pt.publish("buildDocument"),xr(),ze(),function(){pt.publish("putAdditionalObjects");for(var mt=0;mt<te.length;mt++){var jt=te[mt];W(jt.objId,!0),ee(jt.content),ee("endobj")}pt.publish("postPutAdditionalObjects")}(),M=[],function(){for(var mt in Z)Z.hasOwnProperty(mt)&&(f===!1||f===!0&&A.hasOwnProperty(mt))&&Ke(Z[mt])}(),function(){var mt;for(mt in xe)xe.hasOwnProperty(mt)&&rt(xe[mt])}(),function(){for(var mt in bt)bt.hasOwnProperty(mt)&&yt(bt[mt])}(),function(mt){var jt;for(jt in Ge)Ge.hasOwnProperty(jt)&&(Ge[jt]instanceof V0?ne(Ge[jt]):Ge[jt]instanceof Pp&&Ue(Ge[jt],mt))}(M),pt.publish("putResources"),M.forEach(st),st({resourcesOid:V,objectOid:Number.MAX_SAFE_INTEGER}),pt.publish("postPutResources"),d!==null&&(Sr.oid=At(),ee("<<"),ee("/Filter /Standard"),ee("/V "+Sr.v),ee("/R "+Sr.r),ee("/U <"+Sr.toHexString(Sr.U)+">"),ee("/O <"+Sr.toHexString(Sr.O)+">"),ee("/P "+Sr.P),ee(">>"),ee("endobj")),_r(),He();var Ee=Q;return dn(),Bt(),ee("startxref"),ee(""+Ee),ee("%%EOF"),se(be[H]),D.join(`
`)},br=h.__private__.getBlob=function(M){return new Blob([je(M)],{type:"application/pdf"})},er=h.output=h.__private__.output=(ft=function(M,Ee){switch(typeof(Ee=Ee||{})=="string"?Ee={filename:Ee}:Ee.filename=Ee.filename||"generated.pdf",M){case void 0:return Jr();case"save":h.save(Ee.filename);break;case"arraybuffer":return je(Jr());case"blob":return br(Jr());case"bloburi":case"bloburl":if(Ln.URL!==void 0&&typeof Ln.URL.createObjectURL=="function")return Ln.URL&&Ln.URL.createObjectURL(br(Jr()))||void 0;As.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var mt="",jt=Jr();try{mt=SV(jt)}catch{mt=SV(unescape(encodeURIComponent(jt)))}return"data:application/pdf;filename="+Ee.filename+";base64,"+mt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ln)==="[object Window]"){var $t="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ar=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ee.pdfObjectUrl&&($t=Ee.pdfObjectUrl,Ar="");var Nr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+$t+'"'+Ar+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ee)+");<\/script></body></html>",an=Ln.open();return an!==null&&an.document.write(Nr),an}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ln)==="[object Window]"){var fn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ee.filename+'" width="500px" height="400px" /></body></html>',Bn=Ln.open();if(Bn!==null){Bn.document.write(fn);var Vn=this;Bn.document.documentElement.querySelector("#pdfViewer").onload=function(){Bn.document.title=Ee.filename,Bn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Vn.output("bloburl"))}}return Bn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ln)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var da='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ee)+'"></iframe></body></html>',Oa=Ln.open();if(Oa!==null&&(Oa.document.write(da),Oa.document.title=Ee.filename),Oa||typeof safari>"u")return Oa;break;case"datauri":case"dataurl":return Ln.document.location.href=this.output("datauristring",Ee);default:return null}},ft.foo=function(){try{return ft.apply(this,arguments)}catch(mt){var M=mt.stack||"";~M.indexOf(" at ")&&(M=M.split(" at ")[1]);var Ee="Error in function "+M.split(`
`)[0].split("<")[0]+": "+mt.message;if(!Ln.console)throw new Error(Ee);Ln.console.error(Ee,mt),Ln.alert&&alert(Ee)}},ft.foo.bar=ft,ft.foo),ir=function(M){return Array.isArray(vt)===!0&&vt.indexOf(M)>-1};switch(n){case"pt":ht=1;break;case"mm":ht=72/25.4;break;case"cm":ht=72/2.54;break;case"in":ht=72;break;case"px":ht=ir("px_scaling")==1?.75:96/72;break;case"pc":case"em":ht=12;break;case"ex":ht=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ht=n}var Sr=null;De(),Ae();var vr=h.__private__.getPageInfo=h.getPageInfo=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:we[M].objId,pageNumber:M,pageContext:we[M]}},Fr=h.__private__.getPageInfoByObjId=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ee in we)if(we[Ee].objId===M)break;return vr(Ee)},jn=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:we[H].objId,pageNumber:H,pageContext:we[H]}};h.addPage=function(){return Qr.apply(this,arguments),this},h.setPage=function(){return kr.apply(this,arguments),se.call(this,be[H]),this},h.insertPage=function(M){return this.addPage(),this.movePage(H,M),this},h.movePage=function(M,Ee){var mt,jt;if(M>Ee){mt=be[M],jt=we[M];for(var $t=M;$t>Ee;$t--)be[$t]=be[$t-1],we[$t]=we[$t-1];be[Ee]=mt,we[Ee]=jt,this.setPage(Ee)}else if(M<Ee){mt=be[M],jt=we[M];for(var Ar=M;Ar<Ee;Ar++)be[Ar]=be[Ar+1],we[Ar]=we[Ar+1];be[Ee]=mt,we[Ee]=jt,this.setPage(Ee)}return this},h.deletePage=function(){return or.apply(this,arguments),this},h.__private__.text=h.text=function(M,Ee,mt,jt,$t){var Ar,Nr,an,fn,Bn,Vn,da,Oa,Zs,$a=(jt=jt||{}).scope||this;if(typeof M=="number"&&typeof Ee=="number"&&(typeof mt=="string"||Array.isArray(mt))){var xi=mt;mt=Ee,Ee=M,M=xi}if(arguments[3]instanceof ke==0?(an=arguments[4],fn=arguments[5],ts(da=arguments[3])==="object"&&da!==null||(typeof an=="string"&&(fn=an,an=null),typeof da=="string"&&(fn=da,da=null),typeof da=="number"&&(an=da,da=null),jt={flags:da,angle:an,align:fn})):(E("The transform parameter of text() with a Matrix value"),Zs=$t),isNaN(Ee)||isNaN(mt)||M==null)throw new Error("Invalid arguments passed to jsPDF.text");if(M.length===0)return $a;var ei,vi="",ti=typeof jt.lineHeightFactor=="number"?jt.lineHeightFactor:ar,Hc=$a.internal.scaleFactor;function Xu(Qa){return Qa=Qa.split("	").join(Array(jt.TabLen||9).join(" ")),nr(Qa,da)}function Yu(Qa){for(var fs,ki=Qa.concat(),mo=[],Nh=ki.length;Nh--;)typeof(fs=ki.shift())=="string"?mo.push(fs):Array.isArray(Qa)&&(fs.length===1||fs[1]===void 0&&fs[2]===void 0)?mo.push(fs[0]):mo.push([fs[0],fs[1],fs[2]]);return mo}function _(Qa,fs){var ki;if(typeof Qa=="string")ki=fs(Qa)[0];else if(Array.isArray(Qa)){for(var mo,Nh,G1=Qa.concat(),Zg=[],bN=G1.length;bN--;)typeof(mo=G1.shift())=="string"?Zg.push(fs(mo)[0]):Array.isArray(mo)&&typeof mo[0]=="string"&&(Nh=fs(mo[0],mo[1],mo[2]),Zg.push([Nh[0],Nh[1],Nh[2]]));ki=Zg}return ki}var J=!1,ve=!0;if(typeof M=="string")J=!0;else if(Array.isArray(M)){var et=M.concat();Nr=[];for(var Gt,rr=et.length;rr--;)(typeof(Gt=et.shift())!="string"||Array.isArray(Gt)&&typeof Gt[0]!="string")&&(ve=!1);J=ve}if(J===!1)throw new Error('Type of text must be string or Array. "'+M+'" is not recognized.');typeof M=="string"&&(M=M.match(/[\r?\n]/)?M.split(/\r\n|\r|\n/g):[M]);var Mr=Ze/$a.internal.scaleFactor,pa=Mr*(ti-1);switch(jt.baseline){case"bottom":mt-=pa;break;case"top":mt+=Mr-pa;break;case"hanging":mt+=Mr-2*pa;break;case"middle":mt+=Mr/2-pa}if((Vn=jt.maxWidth||0)>0&&(typeof M=="string"?M=$a.splitTextToSize(M,Vn):Object.prototype.toString.call(M)==="[object Array]"&&(M=M.reduce(function(Qa,fs){return Qa.concat($a.splitTextToSize(fs,Vn))},[]))),Ar={text:M,x:Ee,y:mt,options:jt,mutex:{pdfEscape:nr,activeFontKey:Ye,fonts:Z,activeFontSize:Ze}},pt.publish("preProcessText",Ar),M=Ar.text,an=(jt=Ar.options).angle,Zs instanceof ke==0&&an&&typeof an=="number"){an*=Math.PI/180,jt.rotationDirection===0&&(an=-an),w===b&&(an=-an);var ri=Math.cos(an),aa=Math.sin(an);Zs=new ke(ri,aa,-aa,ri,0,0)}else an&&an instanceof ke&&(Zs=an);w!==b||Zs||(Zs=pe),(Bn=jt.charSpace||Zi)!==void 0&&(vi+=S(P(Bn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Oa=jt.horizontalScale)!==void 0&&(vi+=S(100*Oa)+` Tz
`),jt.lang;var Ia=-1,vs=jt.renderingMode!==void 0?jt.renderingMode:jt.stroke,mu=$a.internal.getCurrentPageInfo().pageContext;switch(vs){case 0:case!1:case"fill":Ia=0;break;case 1:case!0:case"stroke":Ia=1;break;case 2:case"fillThenStroke":Ia=2;break;case 3:case"invisible":Ia=3;break;case 4:case"fillAndAddForClipping":Ia=4;break;case 5:case"strokeAndAddPathForClipping":Ia=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ia=6;break;case 7:case"addToPathForClipping":Ia=7}var Ml=mu.usedRenderingMode!==void 0?mu.usedRenderingMode:-1;Ia!==-1?vi+=Ia+` Tr
`:Ml!==-1&&(vi+=`0 Tr
`),Ia!==-1&&(mu.usedRenderingMode=Ia),fn=jt.align||"left";var ul,Gd=Ze*ti,M1=$a.internal.pageSize.getWidth(),L1=Z[Ye];Bn=jt.charSpace||Zi,Vn=jt.maxWidth||0,da=Object.assign({autoencode:!0,noBOM:!0},jt.flags);var WA=[],Wm=function(Qa){return $a.getStringUnitWidth(Qa,{font:L1,charSpace:Bn,fontSize:Ze,doKerning:!1})*Ze/Hc};if(Object.prototype.toString.call(M)==="[object Array]"){var pu;Nr=Yu(M),fn!=="left"&&(ul=Nr.map(Wm));var gu,XA=0;if(fn==="right"){Ee-=ul[0],M=[],rr=Nr.length;for(var wh=0;wh<rr;wh++)wh===0?(gu=pr(Ee),pu=Pr(mt)):(gu=P(XA-ul[wh]),pu=-Gd),M.push([Nr[wh],gu,pu]),XA=ul[wh]}else if(fn==="center"){Ee-=ul[0]/2,M=[],rr=Nr.length;for(var YA=0;YA<rr;YA++)YA===0?(gu=pr(Ee),pu=Pr(mt)):(gu=P((XA-ul[YA])/2),pu=-Gd),M.push([Nr[YA],gu,pu]),XA=ul[YA]}else if(fn==="left"){M=[],rr=Nr.length;for(var U1=0;U1<rr;U1++)M.push(Nr[U1])}else if(fn==="justify"&&L1.encoding==="Identity-H"){M=[],rr=Nr.length,Vn=Vn!==0?Vn:M1;for(var Jg=0,Bi=0;Bi<rr;Bi++)if(pu=Bi===0?Pr(mt):-Gd,gu=Bi===0?pr(Ee):Jg,Bi<rr-1){var yN=P((Vn-ul[Bi])/(Nr[Bi].split(" ").length-1)),Of=Nr[Bi].split(" ");M.push([Of[0]+" ",gu,pu]),Jg=0;for(var Df=1;Df<Of.length;Df++){var Q1=(Wm(Of[Df-1]+" "+Of[Df])-Wm(Of[Df]))*Hc+yN;Df==Of.length-1?M.push([Of[Df],Q1,0]):M.push([Of[Df]+" ",Q1,0]),Jg-=Q1}}else M.push([Nr[Bi],gu,pu]);M.push(["",Jg,0])}else{if(fn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(M=[],rr=Nr.length,Vn=Vn!==0?Vn:M1,Bi=0;Bi<rr;Bi++){pu=Bi===0?Pr(mt):-Gd,gu=Bi===0?pr(Ee):0;var V1=Nr[Bi].split(" ").length-1,H1=V1>0?(Vn-ul[Bi])/V1:0;Bi<rr-1?WA.push(S(P(H1))):WA.push(0),M.push([Nr[Bi],gu,pu])}}}(typeof jt.R2L=="boolean"?jt.R2L:St)===!0&&(M=_(M,function(Qa,fs,ki){return[Qa.split("").reverse().join(""),fs,ki]})),Ar={text:M,x:Ee,y:mt,options:jt,mutex:{pdfEscape:nr,activeFontKey:Ye,fonts:Z,activeFontSize:Ze}},pt.publish("postProcessText",Ar),M=Ar.text,ei=Ar.mutex.isHex||!1;var $1=Z[Ye].encoding;$1!=="WinAnsiEncoding"&&$1!=="StandardEncoding"||(M=_(M,function(Qa,fs,ki){return[Xu(Qa),fs,ki]})),Nr=Yu(M),M=[];for(var JA,ZA,e0,Xm=Array.isArray(Nr[0])?1:0,t0="",Ym=function(Qa,fs,ki){var mo="";return ki instanceof ke?(ki=typeof jt.angle=="number"?Ne(ki,new ke(1,0,0,1,Qa,fs)):Ne(new ke(1,0,0,1,Qa,fs),ki),w===b&&(ki=Ne(new ke(1,0,0,-1,0,0),ki)),mo=ki.join(" ")+` Tm
`):mo=S(Qa)+" "+S(fs)+` Td
`,mo},Ju=0;Ju<Nr.length;Ju++){switch(t0="",Xm){case 1:e0=(ei?"<":"(")+Nr[Ju][0]+(ei?">":")"),JA=parseFloat(Nr[Ju][1]),ZA=parseFloat(Nr[Ju][2]);break;case 0:e0=(ei?"<":"(")+Nr[Ju]+(ei?">":")"),JA=pr(Ee),ZA=Pr(mt)}WA!==void 0&&WA[Ju]!==void 0&&(t0=WA[Ju]+` Tw
`),Ju===0?M.push(t0+Ym(JA,ZA,Zs)+e0):Xm===0?M.push(t0+e0):Xm===1&&M.push(t0+Ym(JA,ZA,Zs)+e0)}M=Xm===0?M.join(` Tj
T* `):M.join(` Tj
`),M+=` Tj
`;var Rf=`BT
/`;return Rf+=Ye+" "+Ze+` Tf
`,Rf+=S(Ze*ti)+` TL
`,Rf+=xa+`
`,Rf+=vi,Rf+=M,ee(Rf+="ET"),A[Ye]=!0,$a};var he=h.__private__.clip=h.clip=function(M){return ee(M==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return he("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ee("n"),this};var tt=h.__private__.isValidStyle=function(M){var Ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(M)!==-1&&(Ee=!0),Ee};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(M){return tt(M)&&(u=M),this};var nt=h.__private__.getStyle=h.getStyle=function(M){var Ee=u;switch(M){case"D":case"S":Ee="S";break;case"F":Ee="f";break;case"FD":case"DF":Ee="B";break;case"f":case"f*":case"B":case"B*":Ee=M}return Ee},lt=h.close=function(){return ee("h"),this};h.stroke=function(){return ee("S"),this},h.fill=function(M){return ge("f",M),this},h.fillEvenOdd=function(M){return ge("f*",M),this},h.fillStroke=function(M){return ge("B",M),this},h.fillStrokeEvenOdd=function(M){return ge("B*",M),this};var ge=function(M,Ee){ts(Ee)==="object"?wt(Ee,M):ee(M)},it=function(M){M===null||w===b&&M===void 0||(M=nt(M),ee(M))};function Pt(M,Ee,mt,jt,$t){var Ar=new Pp(Ee||this.boundingBox,mt||this.xStep,jt||this.yStep,this.gState,$t||this.matrix);Ar.stream=this.stream;var Nr=M+"$$"+this.cloneIndex+++"$$";return Le(Nr,Ar),Ar}var wt=function(M,Ee){var mt=ie[M.key],jt=Ge[mt];if(jt instanceof V0)ee("q"),ee(Nt(Ee)),jt.gState&&h.setGState(jt.gState),ee(M.matrix.toString()+" cm"),ee("/"+mt+" sh"),ee("Q");else if(jt instanceof Pp){var $t=new ke(1,0,0,-1,0,Ao());M.matrix&&($t=$t.multiply(M.matrix||pe),mt=Pt.call(jt,M.key,M.boundingBox,M.xStep,M.yStep,$t).id),ee("q"),ee("/Pattern cs"),ee("/"+mt+" scn"),jt.gState&&h.setGState(jt.gState),ee(Ee),ee("Q")}},Nt=function(M){switch(M){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},It=h.moveTo=function(M,Ee){return ee(S(P(M))+" "+S(G(Ee))+" m"),this},qt=h.lineTo=function(M,Ee){return ee(S(P(M))+" "+S(G(Ee))+" l"),this},Mt=h.curveTo=function(M,Ee,mt,jt,$t,Ar){return ee([S(P(M)),S(G(Ee)),S(P(mt)),S(G(jt)),S(P($t)),S(G(Ar)),"c"].join(" ")),this};h.__private__.line=h.line=function(M,Ee,mt,jt,$t){if(isNaN(M)||isNaN(Ee)||isNaN(mt)||isNaN(jt)||!tt($t))throw new Error("Invalid arguments passed to jsPDF.line");return w===y?this.lines([[mt-M,jt-Ee]],M,Ee,[1,1],$t||"S"):this.lines([[mt-M,jt-Ee]],M,Ee,[1,1]).stroke()},h.__private__.lines=h.lines=function(M,Ee,mt,jt,$t,Ar){var Nr,an,fn,Bn,Vn,da,Oa,Zs,$a,xi,ei,vi;if(typeof M=="number"&&(vi=mt,mt=Ee,Ee=M,M=vi),jt=jt||[1,1],Ar=Ar||!1,isNaN(Ee)||isNaN(mt)||!Array.isArray(M)||!Array.isArray(jt)||!tt($t)||typeof Ar!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(It(Ee,mt),Nr=jt[0],an=jt[1],Bn=M.length,xi=Ee,ei=mt,fn=0;fn<Bn;fn++)(Vn=M[fn]).length===2?(xi=Vn[0]*Nr+xi,ei=Vn[1]*an+ei,qt(xi,ei)):(da=Vn[0]*Nr+xi,Oa=Vn[1]*an+ei,Zs=Vn[2]*Nr+xi,$a=Vn[3]*an+ei,xi=Vn[4]*Nr+xi,ei=Vn[5]*an+ei,Mt(da,Oa,Zs,$a,xi,ei));return Ar&&lt(),it($t),this},h.path=function(M){for(var Ee=0;Ee<M.length;Ee++){var mt=M[Ee],jt=mt.c;switch(mt.op){case"m":It(jt[0],jt[1]);break;case"l":qt(jt[0],jt[1]);break;case"c":Mt.apply(this,jt);break;case"h":lt()}}return this},h.__private__.rect=h.rect=function(M,Ee,mt,jt,$t){if(isNaN(M)||isNaN(Ee)||isNaN(mt)||isNaN(jt)||!tt($t))throw new Error("Invalid arguments passed to jsPDF.rect");return w===y&&(jt=-jt),ee([S(P(M)),S(G(Ee)),S(P(mt)),S(P(jt)),"re"].join(" ")),it($t),this},h.__private__.triangle=h.triangle=function(M,Ee,mt,jt,$t,Ar,Nr){if(isNaN(M)||isNaN(Ee)||isNaN(mt)||isNaN(jt)||isNaN($t)||isNaN(Ar)||!tt(Nr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[mt-M,jt-Ee],[$t-mt,Ar-jt],[M-$t,Ee-Ar]],M,Ee,[1,1],Nr,!0),this},h.__private__.roundedRect=h.roundedRect=function(M,Ee,mt,jt,$t,Ar,Nr){if(isNaN(M)||isNaN(Ee)||isNaN(mt)||isNaN(jt)||isNaN($t)||isNaN(Ar)||!tt(Nr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var an=4/3*(Math.SQRT2-1);return $t=Math.min($t,.5*mt),Ar=Math.min(Ar,.5*jt),this.lines([[mt-2*$t,0],[$t*an,0,$t,Ar-Ar*an,$t,Ar],[0,jt-2*Ar],[0,Ar*an,-$t*an,Ar,-$t,Ar],[2*$t-mt,0],[-$t*an,0,-$t,-Ar*an,-$t,-Ar],[0,2*Ar-jt],[0,-Ar*an,$t*an,-Ar,$t,-Ar]],M+$t,Ee,[1,1],Nr,!0),this},h.__private__.ellipse=h.ellipse=function(M,Ee,mt,jt,$t){if(isNaN(M)||isNaN(Ee)||isNaN(mt)||isNaN(jt)||!tt($t))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ar=4/3*(Math.SQRT2-1)*mt,Nr=4/3*(Math.SQRT2-1)*jt;return It(M+mt,Ee),Mt(M+mt,Ee-Nr,M+Ar,Ee-jt,M,Ee-jt),Mt(M-Ar,Ee-jt,M-mt,Ee-Nr,M-mt,Ee),Mt(M-mt,Ee+Nr,M-Ar,Ee+jt,M,Ee+jt),Mt(M+Ar,Ee+jt,M+mt,Ee+Nr,M+mt,Ee),it($t),this},h.__private__.circle=h.circle=function(M,Ee,mt,jt){if(isNaN(M)||isNaN(Ee)||isNaN(mt)||!tt(jt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(M,Ee,mt,mt,jt)},h.setFont=function(M,Ee,mt){return mt&&(Ee=C(Ee,mt)),Ye=nn(M,Ee,{disableWarning:!1}),this};var zt=h.__private__.getFont=h.getFont=function(){return Z[nn.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var M,Ee,mt={};for(M in Qe)if(Qe.hasOwnProperty(M))for(Ee in mt[M]=[],Qe[M])Qe[M].hasOwnProperty(Ee)&&mt[M].push(Ee);return mt},h.addFont=function(M,Ee,mt,jt,$t){var Ar=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ar.indexOf(arguments[3])!==-1?$t=arguments[3]:arguments[3]&&Ar.indexOf(arguments[3])==-1&&(mt=C(mt,jt)),Ot.call(this,M,Ee,mt,$t=$t||"Identity-H")};var ar,wr=t.lineWidth||.200025,dr=h.__private__.getLineWidth=h.getLineWidth=function(){return wr},Rt=h.__private__.setLineWidth=h.setLineWidth=function(M){return wr=M,ee(S(P(M))+" w"),this};h.__private__.setLineDash=rn.API.setLineDash=rn.API.setLineDashPattern=function(M,Ee){if(M=M||[],Ee=Ee||0,isNaN(Ee)||!Array.isArray(M))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return M=M.map(function(mt){return S(P(mt))}).join(" "),Ee=S(P(Ee)),ee("["+M+"] "+Ee+" d"),this};var Wr=h.__private__.getLineHeight=h.getLineHeight=function(){return Ze*ar};h.__private__.getLineHeight=h.getLineHeight=function(){return Ze*ar};var Vr=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(M){return typeof(M=M||1.15)=="number"&&(ar=M),this},jr=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return ar};Vr(t.lineHeight);var pr=h.__private__.getHorizontalCoordinate=function(M){return P(M)},Pr=h.__private__.getVerticalCoordinate=function(M){return w===b?M:we[H].mediaBox.topRightY-we[H].mediaBox.bottomLeftY-P(M)},Tn=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(M){return S(pr(M))},wn=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(M){return S(Pr(M))},gn=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return L(gn)},h.__private__.setStrokeColor=h.setDrawColor=function(M,Ee,mt,jt){return gn=fe({ch1:M,ch2:Ee,ch3:mt,ch4:jt,pdfColorType:"draw",precision:2}),ee(gn),this};var ua=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return L(ua)},h.__private__.setFillColor=h.setFillColor=function(M,Ee,mt,jt){return ua=fe({ch1:M,ch2:Ee,ch3:mt,ch4:jt,pdfColorType:"fill",precision:2}),ee(ua),this};var xa=t.textColor||"0 g",Ji=h.__private__.getTextColor=h.getTextColor=function(){return L(xa)};h.__private__.setTextColor=h.setTextColor=function(M,Ee,mt,jt){return xa=fe({ch1:M,ch2:Ee,ch3:mt,ch4:jt,pdfColorType:"text",precision:3}),this};var Zi=t.charSpace,Dl=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Zi||0)};h.__private__.setCharSpace=h.setCharSpace=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Zi=M,this};var va=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(M){var Ee=h.CapJoinStyles[M];if(Ee===void 0)throw new Error("Line cap style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return va=Ee,ee(Ee+" J"),this};var Qn=0;h.__private__.setLineJoin=h.setLineJoin=function(M){var Ee=h.CapJoinStyles[M];if(Ee===void 0)throw new Error("Line join style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qn=Ee,ee(Ee+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(M){if(M=M||0,isNaN(M))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(S(P(M))+" M"),this},h.GState=B2,h.setGState=function(M){(M=typeof M=="string"?xe[de[M]]:hu(null,M)).equals(Me)||(ee("/"+M.id+" gs"),Me=M)};var hu=function(M,Ee){if(!M||!de[M]){var mt=!1;for(var jt in xe)if(xe.hasOwnProperty(jt)&&xe[jt].equals(Ee)){mt=!0;break}if(mt)Ee=xe[jt];else{var $t="GS"+(Object.keys(xe).length+1).toString(10);xe[$t]=Ee,Ee.id=$t}return M&&(de[M]=Ee.id),pt.publish("addGState",Ee),Ee}};h.addGState=function(M,Ee){return hu(M,Ee),this},h.saveGraphicsState=function(){return ee("q"),at.push({key:Ye,size:Ze,color:xa}),this},h.restoreGraphicsState=function(){ee("Q");var M=at.pop();return Ye=M.key,Ze=M.size,xa=M.color,Me=null,this},h.setCurrentTransformationMatrix=function(M){return ee(M.toString()+" cm"),this},h.comment=function(M){return ee("#"+M),this};var Rl=function(M,Ee){var mt=M||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return mt},set:function(Ar){isNaN(Ar)||(mt=parseFloat(Ar))}});var jt=Ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return jt},set:function(Ar){isNaN(Ar)||(jt=parseFloat(Ar))}});var $t="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return $t},set:function(Ar){$t=Ar.toString()}}),this},eo=function(M,Ee,mt,jt){Rl.call(this,M,Ee),this.type="rect";var $t=mt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return $t},set:function(Nr){isNaN(Nr)||($t=parseFloat(Nr))}});var Ar=jt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ar},set:function(Nr){isNaN(Nr)||(Ar=parseFloat(Nr))}}),this},Uc=function(){this.page=me,this.currentPage=H,this.pages=be.slice(0),this.pagesContext=we.slice(0),this.x=Oe,this.y=Ie,this.matrix=We,this.width=ll(H),this.height=zA(H),this.outputDestination=Xe,this.id="",this.objectNumber=-1};Uc.prototype.restore=function(){me=this.page,H=this.currentPage,we=this.pagesContext,be=this.pages,Oe=this.x,Ie=this.y,We=this.matrix,Au(H,this.width),cl(H,this.height),Xe=this.outputDestination};var Qc=function(M,Ee,mt,jt,$t){Vt.push(new Uc),me=H=0,be=[],Oe=M,Ie=Ee,We=$t,Ir([mt,jt])};for(var Ac in h.beginFormObject=function(M,Ee,mt,jt,$t){return Qc(M,Ee,mt,jt,$t),this},h.endFormObject=function(M){return function(Ee){if(kt[Ee])Vt.pop().restore();else{var mt=new Uc,jt="Xo"+(Object.keys(bt).length+1).toString(10);mt.id=jt,kt[Ee]=jt,bt[jt]=mt,pt.publish("addFormObject",mt),Vt.pop().restore()}}(M),this},h.doFormObject=function(M,Ee){var mt=bt[kt[M]];return ee("q"),ee(Ee.toString()+" cm"),ee("/"+mt.id+" Do"),ee("Q"),this},h.getFormObject=function(M){var Ee=bt[kt[M]];return{x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height,matrix:Ee.matrix}},h.save=function(M,Ee){return M=M||"generated.pdf",(Ee=Ee||{}).returnPromise=Ee.returnPromise||!1,Ee.returnPromise===!1?(Ap(br(Jr()),M),typeof Ap.unload=="function"&&Ln.setTimeout&&setTimeout(Ap.unload,911),this):new Promise(function(mt,jt){try{var $t=Ap(br(Jr()),M);typeof Ap.unload=="function"&&Ln.setTimeout&&setTimeout(Ap.unload,911),mt($t)}catch(Ar){jt(Ar.message)}})},rn.API)rn.API.hasOwnProperty(Ac)&&(Ac==="events"&&rn.API.events.length?function(M,Ee){var mt,jt,$t;for($t=Ee.length-1;$t!==-1;$t--)mt=Ee[$t][0],jt=Ee[$t][1],M.subscribe.apply(M,[mt].concat(typeof jt=="function"?[jt]:jt))}(pt,rn.API.events):h[Ac]=rn.API[Ac]);function ll(M){return we[M].mediaBox.topRightX-we[M].mediaBox.bottomLeftX}function Au(M,Ee){we[M].mediaBox.topRightX=Ee+we[M].mediaBox.bottomLeftX}function zA(M){return we[M].mediaBox.topRightY-we[M].mediaBox.bottomLeftY}function cl(M,Ee){we[M].mediaBox.topRightY=Ee+we[M].mediaBox.bottomLeftY}var Vc=h.getPageWidth=function(M){return ll(M=M||H)/ht},Ff=h.setPageWidth=function(M,Ee){Au(M,Ee*ht)},Ao=h.getPageHeight=function(M){return zA(M=M||H)/ht},Wu=h.setPageHeight=function(M,Ee){cl(M,Ee*ht)};return h.internal={pdfEscape:nr,getStyle:nt,getFont:zt,getFontSize:Et,getCharSpace:Dl,getTextColor:Ji,getLineHeight:Wr,getLineHeightFactor:jr,getLineWidth:dr,write:Fe,getHorizontalCoordinate:pr,getVerticalCoordinate:Pr,getCoordinateString:Tn,getVerticalCoordinateString:wn,collections:{},newObject:At,newAdditionalObject:z,newObjectDeferred:ct,newObjectDeferredBegin:W,getFilters:Be,putStream:ye,events:pt,scaleFactor:ht,pageSize:{getWidth:function(){return Vc(H)},setWidth:function(M){Ff(H,M)},getHeight:function(){return Ao(H)},setHeight:function(M){Wu(H,M)}},encryptionOptions:d,encryption:Sr,getEncryptor:function(M){return d!==null?Sr.encryptor(M,0):function(Ee){return Ee}},output:er,getNumberOfPages:Zr,get pages(){return be},out:ee,f2:k,f3:T,getPageInfo:vr,getPageInfoByObjId:Fr,getCurrentPageInfo:jn,getPDFVersion:p,Point:Rl,Rectangle:eo,Matrix:ke,hasHotfix:ir},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Vc(H)},set:function(M){Ff(H,M)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Ao(H)},set:function(M){Wu(H,M)},enumerable:!0,configurable:!0}),(function(M){for(var Ee=0,mt=Se.length;Ee<mt;Ee++){var jt=Ot.call(this,M[Ee][0],M[Ee][1],M[Ee][2],Se[Ee][3],!0);f===!1&&(A[jt]=!0);var $t=M[Ee][0].split("-");_t({id:jt,fontName:$t[0],fontStyle:$t[1]||""})}pt.publish("addFonts",{fonts:Z,dictionary:Qe})}).call(h,Se),Ye="F1",Qr(a,r),pt.publish("initialized"),h}kx.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},kx.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},kx.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},kx.prototype.processOwnerPassword=function(t,e){return Gk($k(e).substr(0,5),t)},kx.prototype.encryptor=function(t,e){var r=$k(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Gk(r,n)}},B2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ts(t)!==ts(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},rn.API={events:[]},rn.version="3.0.4";var Ci=rn.API,J6=1,Ug=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ax=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},$n=function(t){return t.toFixed(2)},A0=function(t){return t.toFixed(5)};Ci.__acroform__={};var uu=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},TV=function(t){return t*J6},$f=function(t){var e=new Mre,r=cn.internal.getHeight(t)||0,n=cn.internal.getWidth(t)||0;return e.BBox=[0,0,Number($n(n)),Number($n(r))],e},zIe=Ci.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},WIe=Ci.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},XIe=Ci.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},$i=Ci.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return XIe(t,e-1)},Gi=Ci.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return zIe(t,e-1)},Ki=Ci.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return WIe(t,e-1)},YIe=Ci.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number($n(c.lowerLeft_X)),Number($n(c.lowerLeft_Y)),Number($n(c.upperRight_X)),Number($n(c.upperRight_Y))]},JIe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Kk(t,r),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+$n(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=$f(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Kk=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(k){return k.split(`
`)}):a.map(function(k){return[k]});var s=r,o=cn.internal.getHeight(t)||0;o=o<0?-o:o;var l=cn.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,T,P){if(k+1<a.length){var G=T+" "+a[k+1][0];return MC(G,t,P).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,d,f=MC("3",t,s).height,A=t.multiline?o-s:(o-f)/2,h=A+=2,m=0,p=0,x=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+MC(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var v="",y=0,b=0;b<a.length;b++)if(a.hasOwnProperty(b)){var w=!1;if(a[b].length!==1&&x!==a[b].length-1){if((f+2)*(y+2)+2>o)continue e;v+=a[b][x],w=!0,p=b,b--}else{v=(v+=a[b][x]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var I=parseInt(b),j=c(I,v,s),C=b>=a.length-1;if(j&&!C){v+=" ",x=0;continue}if(j||C){if(C)p=I;else if(t.multiline&&(f+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(y+2)+2>o)continue e;p=I}}for(var S="",E=m;E<=p;E++){var B=a[E];if(t.multiline){if(E===p){S+=B[x]+" ",x=(x+1)%B.length;continue}if(E===m){S+=B[B.length-1]+" ";continue}}S+=B[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,d=MC(S,t,s).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}e+=$n(u)+" "+$n(h)+` Td
`,e+="("+Ug(S)+`) Tj
`,e+=-$n(u)+` 0 Td
`,h=-(s+2),d=0,m=w?p:p+1,y++,v=""}break}return n.text=e,n.fontSize=s,n},MC=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},ZIe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ePe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},tPe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Tf.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(ZIe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");J6=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Lre,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&ePe(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=YIe(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=cn.createDefaultAppearanceStream(l),ts(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=JIe(l);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var A in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(A)){var h=l.appearanceStreamContent[A];if(f+="/"+A+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(p,x){for(var v in p)if(p.hasOwnProperty(v)){var y=v,b=p[v];x.internal.newObjectDeferredBegin(b.objId,!0),ts(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(a.internal.acroformPlugin.xForms,a)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Rre=Ci.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var a="[",s=0;s<t.length;s++)switch(s!==0&&(a+=" "),ts(t[s])){case"boolean":case"number":case"object":a+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),a+="("+Ug(n(t[s].toString()))+")"):a+=t[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},m5=function(t,e,r){var n=function(a){return a};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Ug(n(t))+")"},eh=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};eh.prototype.toString=function(){return this.objId+" 0 R"},eh.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},eh.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],a=this[n];a&&(Array.isArray(a)?t.push({key:n,value:Rre(a,this.objId,this.scope)}):a instanceof eh?(a.scope=this.scope,t.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:n,value:a}))}return t};var Mre=function(){eh.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};uu(Mre,eh);var Lre=function(){eh.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Ug(r(t))+")"}},set:function(r){t=r}})};uu(Lre,eh);var Tf=function t(){eh.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!$i(e,3)},set:function(v){v?this.F=Gi(e,3):this.F=Ki(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof DS)return;s="FieldObject"+t.FieldNum++}var v=function(y){return y};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Ug(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/J6:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof DS||this instanceof mm))return m5(f,this.objId,this.scope)},set:function(v){v=v.toString(),f=v}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof _o==0?m5(A,this.objId,this.scope):A},set:function(v){v=v.toString(),A=this instanceof _o==0?v.substr(0,1)==="("?Ax(v.substr(1,v.length-2)):Ax(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof _o==1?Ax(A.substr(1,A.length-1)):A},set:function(v){v=v.toString(),A=this instanceof _o==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof _o==0?m5(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof _o==0?v.substr(0,1)==="("?Ax(v.substr(1,v.length-2)):Ax(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof _o==1?Ax(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof _o==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(v){v=!!v,p=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(v){m=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,1)},set:function(v){v?this.Ff=Gi(this.Ff,1):this.Ff=Ki(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,2)},set:function(v){v?this.Ff=Gi(this.Ff,2):this.Ff=Ki(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,3)},set:function(v){v?this.Ff=Gi(this.Ff,3):this.Ff=Ki(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');x=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(x){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};uu(Tf,eh);var Qp=function(){Tf.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Rre(e,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,18)},set:function(r){r?this.Ff=Gi(this.Ff,18):this.Ff=Ki(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Gi(this.Ff,19):this.Ff=Ki(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,20)},set:function(r){r?(this.Ff=Gi(this.Ff,20),e.sort()):this.Ff=Ki(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,22)},set:function(r){r?this.Ff=Gi(this.Ff,22):this.Ff=Ki(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,23)},set:function(r){r?this.Ff=Gi(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,27)},set:function(r){r?this.Ff=Gi(this.Ff,27):this.Ff=Ki(this.Ff,27)}}),this.hasAppearanceStream=!1};uu(Qp,Tf);var Vp=function(){Qp.call(this),this.fontName="helvetica",this.combo=!1};uu(Vp,Qp);var Hp=function(){Vp.call(this),this.combo=!0};uu(Hp,Vp);var Tb=function(){Hp.call(this),this.edit=!0};uu(Tb,Hp);var _o=function(){Tf.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,15)},set:function(r){r?this.Ff=Gi(this.Ff,15):this.Ff=Ki(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,16)},set:function(r){r?this.Ff=Gi(this.Ff,16):this.Ff=Ki(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,17)},set:function(r){r?this.Ff=Gi(this.Ff,17):this.Ff=Ki(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,26)},set:function(r){r?this.Ff=Gi(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+Ug(r(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){ts(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};uu(_o,Tf);var Bb=function(){_o.call(this),this.pushButton=!0};uu(Bb,_o);var $p=function(){_o.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};uu($p,_o);var DS=function(){var t,e;Tf.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+Ug(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){ts(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=cn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};uu(DS,Tf),$p.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},$p.prototype.createOption=function(t){var e=new DS;return e.Parent=this,e.optionName=t,this.Kids.push(e),rPe.call(this.scope,e),e};var kb=function(){_o.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=cn.CheckBox.createAppearanceStream()};uu(kb,_o);var mm=function(){Tf.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,13)},set:function(e){e?this.Ff=Gi(this.Ff,13):this.Ff=Ki(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,21)},set:function(e){e?this.Ff=Gi(this.Ff,21):this.Ff=Ki(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,23)},set:function(e){e?this.Ff=Gi(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,24)},set:function(e){e?this.Ff=Gi(this.Ff,24):this.Ff=Ki(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,25)},set:function(e){e?this.Ff=Gi(this.Ff,25):this.Ff=Ki(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,26)},set:function(e){e?this.Ff=Gi(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};uu(mm,Tf);var Fb=function(){mm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,14)},set:function(t){t?this.Ff=Gi(this.Ff,14):this.Ff=Ki(this.Ff,14)}}),this.password=!0};uu(Fb,mm);var cn={CheckBox:{createAppearanceStream:function(){return{N:{On:cn.CheckBox.YesNormal},D:{On:cn.CheckBox.YesPushDown,Off:cn.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=$f(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=Kk(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+$n(cn.internal.getWidth(t))+" "+$n(cn.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+$n(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=$f(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),a=[],s=cn.internal.getHeight(t),o=cn.internal.getWidth(t),l=Kk(t,t.caption);return a.push("1 g"),a.push("0 0 "+$n(o)+" "+$n(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+$n(o-1)+" "+$n(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+$n(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=$f(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$n(cn.internal.getWidth(t))+" "+$n(cn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:cn.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=cn.RadioButton.Circle.YesNormal,e.D[t]=cn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=$f(t);e.scope=t.scope;var r=[],n=cn.internal.getWidth(t)<=cn.internal.getHeight(t)?cn.internal.getWidth(t)/4:cn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=cn.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+A0(cn.internal.getWidth(t)/2)+" "+A0(cn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=$f(t);e.scope=t.scope;var r=[],n=cn.internal.getWidth(t)<=cn.internal.getHeight(t)?cn.internal.getWidth(t)/4:cn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*cn.internal.Bezier_C).toFixed(5)),o=Number((n*cn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+A0(cn.internal.getWidth(t)/2)+" "+A0(cn.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+A0(cn.internal.getWidth(t)/2)+" "+A0(cn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=$f(t);e.scope=t.scope;var r=[],n=cn.internal.getWidth(t)<=cn.internal.getHeight(t)?cn.internal.getWidth(t)/4:cn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*cn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+A0(cn.internal.getWidth(t)/2)+" "+A0(cn.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:cn.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=cn.RadioButton.Cross.YesNormal,e.D[t]=cn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=$f(t);e.scope=t.scope;var r=[],n=cn.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+$n(cn.internal.getWidth(t)-2)+" "+$n(cn.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push($n(n.x1.x)+" "+$n(n.x1.y)+" m"),r.push($n(n.x2.x)+" "+$n(n.x2.y)+" l"),r.push($n(n.x4.x)+" "+$n(n.x4.y)+" m"),r.push($n(n.x3.x)+" "+$n(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=$f(t);e.scope=t.scope;var r=cn.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+$n(cn.internal.getWidth(t))+" "+$n(cn.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+$n(cn.internal.getWidth(t)-2)+" "+$n(cn.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push($n(r.x1.x)+" "+$n(r.x1.y)+" m"),n.push($n(r.x2.x)+" "+$n(r.x2.y)+" l"),n.push($n(r.x4.x)+" "+$n(r.x4.y)+" m"),n.push($n(r.x3.x)+" "+$n(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=$f(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$n(cn.internal.getWidth(t))+" "+$n(cn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};cn.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=cn.internal.getWidth(t),r=cn.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},cn.internal.getWidth=function(t){var e=0;return ts(t)==="object"&&(e=TV(t.Rect[2])),e},cn.internal.getHeight=function(t){var e=0;return ts(t)==="object"&&(e=TV(t.Rect[3])),e};var rPe=Ci.addField=function(t){if(tPe(this,t),!(t instanceof Tf))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ci.AcroFormChoiceField=Qp,Ci.AcroFormListBox=Vp,Ci.AcroFormComboBox=Hp,Ci.AcroFormEditBox=Tb,Ci.AcroFormButton=_o,Ci.AcroFormPushButton=Bb,Ci.AcroFormRadioButton=$p,Ci.AcroFormCheckBox=kb,Ci.AcroFormTextField=mm,Ci.AcroFormPasswordField=Fb,Ci.AcroFormAppearance=cn,Ci.AcroForm={ChoiceField:Qp,ListBox:Vp,ComboBox:Hp,EditBox:Tb,Button:_o,PushButton:Bb,RadioButton:$p,CheckBox:kb,TextField:mm,PasswordField:Fb,Appearance:cn},rn.AcroForm={ChoiceField:Qp,ListBox:Vp,ComboBox:Hp,EditBox:Tb,Button:_o,PushButton:Bb,RadioButton:$p,CheckBox:kb,TextField:mm,PasswordField:Fb,Appearance:cn};var nPe=rn.AcroForm;function Ure(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(k,T){var P,G,ce,ue,le,Ae=r;if((T=T||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(j(k))for(le in n)for(ce=n[le],P=0;P<ce.length;P+=1){for(ue=!0,G=0;G<ce[P].length;G+=1)if(ce[P][G]!==void 0&&ce[P][G]!==k[G]){ue=!1;break}if(ue===!0){Ae=le;break}}else for(le in n)for(ce=n[le],P=0;P<ce.length;P+=1){for(ue=!0,G=0;G<ce[P].length;G+=1)if(ce[P][G]!==void 0&&ce[P][G]!==k.charCodeAt(G)){ue=!1;break}if(ue===!0){Ae=le;break}}return Ae===r&&T!==r&&(Ae=T),Ae},s=function k(T){for(var P=this.internal.write,G=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var ue=[];if(ue.push({key:"Type",value:"/XObject"}),ue.push({key:"Subtype",value:"/Image"}),ue.push({key:"Width",value:T.width}),ue.push({key:"Height",value:T.height}),T.colorSpace===v.INDEXED?ue.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(ue.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===v.DEVICE_CMYK&&ue.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ue.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&ue.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var le="",Ae=0,ae=T.transparency.length;Ae<ae;Ae++)le+=T.transparency[Ae]+" "+T.transparency[Ae]+" ";ue.push({key:"Mask",value:"["+le+"]"})}T.sMask!==void 0&&ue.push({key:"SMask",value:T.objectId+1+" 0 R"});var _e=T.filter!==void 0?["/"+T.filter]:void 0;if(G({data:T.data,additionalKeyValues:ue,alreadyAppliedFilters:_e,objectId:T.objectId}),P("endobj"),"sMask"in T&&T.sMask!==void 0){var De,O=(De=T.sMaskBitsPerComponent)!==null&&De!==void 0?De:T.bitsPerComponent,H={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:T.sMask};"filter"in T&&(H.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(T.width),H.filter=T.filter),k.call(this,H)}if(T.colorSpace===v.INDEXED){var K=this.internal.newObject();G({data:S(new Uint8Array(T.palette)),objectId:K}),P("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var T in k)s.call(this,k[T])},l=function(){var k,T=this.internal.collections[e+"images"],P=this.internal.write;for(var G in T)P("/I"+(k=T[G]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(k){return typeof t["process"+k.toUpperCase()]=="function"},A=function(k){return ts(k)==="object"&&k.nodeType===1},h=function(k,T){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var P=""+k.getAttribute("src");if(P.indexOf("data:image/")===0)return xE(unescape(P).split("base64,").pop());var G=t.loadFile(P,!0);if(G!==void 0)return G}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var ce;switch(T){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return xE(k.toDataURL(ce,1).split("base64,").pop())}},m=function(k){var T=this.internal.collections[e+"images"];if(T){for(var P in T)if(k===T[P].alias)return T[P]}},p=function(k,T,P){return k||T||(k=-96,T=-96),k<0&&(k=-1*P.width*72/k/this.internal.scaleFactor),T<0&&(T=-1*P.height*72/T/this.internal.scaleFactor),k===0&&(k=T*P.width/P.height),T===0&&(T=k*P.height/P.width),[k,T]},x=function(k,T,P,G,ce,ue){var le=p.call(this,P,G,ce),Ae=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,_e=u.call(this);if(P=le[0],G=le[1],_e[ce.index]=ce,ue){ue*=Math.PI/180;var De=Math.cos(ue),O=Math.sin(ue),H=function(R){return R.toFixed(4)},K=[H(De),H(O),H(-1*O),H(De),0,0,"cm"]}this.internal.write("q"),ue?(this.internal.write([1,"0","0",1,Ae(k),ae(T+G),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([Ae(P),"0","0",Ae(G),"0","0","cm"].join(" "))):this.internal.write([Ae(P),"0","0",Ae(G),Ae(k),ae(T+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(k){var T,P,G=0;if(typeof k=="string")for(P=k.length,T=0;T<P;T++)G=(G<<5)-G+k.charCodeAt(T),G|=0;else if(j(k))for(P=k.byteLength/2,T=0;T<P;T++)G=(G<<5)-G+k[T],G|=0;return G},w=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var T=!0;return k.length===0&&(T=!1),k.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(T=!1),T},I=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var T=k.indexOf(",");return T<0?null:k.substring(0,T).trim().endsWith("base64")?k.substring(T+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var j=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},C=t.__addimage__.binaryStringToUint8Array=function(k){for(var T=k.length,P=new Uint8Array(T),G=0;G<T;G++)P[G]=k.charCodeAt(G);return P},S=t.__addimage__.arrayBufferToBinaryString=function(k){for(var T="",P=j(k)?k:new Uint8Array(k),G=0;G<P.length;G+=8192)T+=String.fromCharCode.apply(null,P.subarray(G,G+8192));return T};t.addImage=function(){var k,T,P,G,ce,ue,le,Ae,ae;if(typeof arguments[1]=="number"?(T=r,P=arguments[1],G=arguments[2],ce=arguments[3],ue=arguments[4],le=arguments[5],Ae=arguments[6],ae=arguments[7]):(T=arguments[1],P=arguments[2],G=arguments[3],ce=arguments[4],ue=arguments[5],le=arguments[6],Ae=arguments[7],ae=arguments[8]),ts(k=arguments[0])==="object"&&!A(k)&&"imageData"in k){var _e=k;k=_e.imageData,T=_e.format||T||r,P=_e.x||P||0,G=_e.y||G||0,ce=_e.w||_e.width||ce,ue=_e.h||_e.height||ue,le=_e.alias||le,Ae=_e.compression||Ae,ae=_e.rotation||_e.angle||ae}var De=this.internal.getFilters();if(Ae===void 0&&De.indexOf("FlateEncode")!==-1&&(Ae="SLOW"),isNaN(P)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var O=E.call(this,k,T,le,Ae);return x.call(this,P,G,ce,ue,O,ae),this};var E=function(k,T,P,G){var ce,ue,le;if(typeof k=="string"&&a(k)===r){k=unescape(k);var Ae=B(k,!1);(Ae!==""||(Ae=t.loadFile(k,!0))!==void 0)&&(k=Ae)}if(A(k)&&(k=h(k,T)),T=a(k,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((le=P)==null||le.length===0)&&(P=function(ae){return typeof ae=="string"||j(ae)?b(ae):j(ae.data)?b(ae.data):null}(k)),(ce=m.call(this,P))||(k instanceof Uint8Array||T==="RGBA"||(ue=k,k=C(k)),ce=this["process"+T.toUpperCase()](k,d.call(this),P,function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in t.image_compression?ae:y.NONE}(G),ue)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},B=t.__addimage__.convertBase64ToBinaryString=function(k,T){T=typeof T!="boolean"||T;var P,G="";if(typeof k=="string"){var ce;P=(ce=I(k))!==null&&ce!==void 0?ce:k;try{G=xE(P)}catch(ue){if(T)throw w(P)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ue.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};t.getImageProperties=function(k){var T,P,G="";if(A(k)&&(k=h(k)),typeof k=="string"&&a(k)===r&&((G=B(k,!1))===""&&(G=t.loadFile(k)||""),k=G),P=a(k),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(k instanceof Uint8Array||(k=C(k)),!(T=this["process"+P.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=P,T}})(rn.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};rn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var A=0;A<u.length;A++){n=u[A];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(p.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",s+=" /Popup "+x.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(v(y))+") >>",p.content=s;var b=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(s+=" /Open true"),s+=" >>",x.content=s,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var I=this.annotations._nameMap[n.options.name];n.options.pageNumber=I.page,n.options.top=I.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var j=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:o,type:"link"})},t.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(rn.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&a.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(p){var x=0,v=r,y="",b=0;for(x=0;x<p.length;x+=1)v[p.charCodeAt(x)]!==void 0?(b++,typeof(v=v[p.charCodeAt(x)])=="number"&&(y+=String.fromCharCode(v),v=r,b=0),x===p.length-1&&(v=r,y+=p.charAt(x-(b-1)),x-=b-1,b=0)):(v=r,y+=p.charAt(x-b),x-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(p,x,v){return o(p)?s(p)===!1?-1:!u(p)||!o(x)&&!o(v)||!o(v)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:d(p)&&o(x)&&!l(x)&&o(v)&&u(v)?3:l(p)||!o(v)?1:2:-1},h=function(p){var x=0,v=0,y=0,b="",w="",I="",j=(p=p||"").split("\\s+"),C=[];for(x=0;x<j.length;x+=1){for(C.push(""),v=0;v<j[x].length;v+=1)b=j[x][v],w=j[x][v-1],I=j[x][v+1],o(b)?(y=A(b,w,I),C[x]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):C[x]+=b;C[x]=f(C[x])}return C.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(x)){var y=0;for(v=[],y=0;y<x.length;y+=1)Array.isArray(x[y])?v.push([h(x[y][0]),x[y][1],x[y][2]]):v.push([h(x[y])]);p=v}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(rn.API),rn.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(rn.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),A=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,w){return b.concat(x.splitTextToSize(w,v))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:f})*d)&&(h=p);return h!==0&&(m=c.length),{w:h/=A,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&A&&(this.printHeaderRow(c.lineNumber,!0),c.y+=A[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,f,A){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,p,x,v=[],y=[],b=[],w={},I={},j=[],C=[],S=(A=A||{}).autoSize||!1,E=A.printHeaders!==!1,B=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,k=A.margins||Object.assign({width:this.getPageWidth()},e),T=typeof A.padding=="number"?A.padding:3,P=A.headerBackgroundColor||"#c8c8c8",G=A.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=P,this.internal.__cell__.headerTextColor=G,this.setFontSize(B),f==null)y=v=Object.keys(d[0]),b=v.map(function(){return"left"});else if(Array.isArray(f)&&ts(f[0])==="object")for(v=f.map(function(_e){return _e.name}),y=f.map(function(_e){return _e.prompt||_e.name||""}),b=f.map(function(_e){return _e.align||"left"}),h=0;h<f.length;h+=1)I[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(y=v=f,b=v.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<v.length;h+=1){for(w[x=v[h]]=d.map(function(_e){return _e[x]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=w[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)j.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);I[x]=Math.max.apply(null,j)+T+T,j=[]}if(E){var ce={};for(h=0;h<v.length;h+=1)ce[v[h]]={},ce[v[h]].text=y[h],ce[v[h]].align=b[h];var ue=l.call(this,ce,I);C=v.map(function(_e){return new s(c,u,I[_e],ue,ce[_e].text,void 0,ce[_e].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var le=f.reduce(function(_e,De){return _e[De.name]=De.align,_e},{});for(h=0;h<d.length;h+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:h,data:d[h]},this);var Ae=l.call(this,d[h],I);for(p=0;p<v.length;p+=1){var ae=d[h][v[p]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:h,col:p,data:ae},this),o.call(this,new s(c,u,I[v[p]],Ae,ae,h+2,le[v[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/A+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,A.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}}(rn.API);var Qre={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Vre=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qk=Ure(Vre),Hre=[100,200,300,400,500,600,700,800,900],aPe=Ure(Hre);function p5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Qre[s=s||"normal"]?s:"normal"}(t.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),a=function(s){return typeof qk[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,r,n].join(" ")}}}function BV(t,e,r,n){var a;for(a=r;a>=0&&a<e.length;a+=n)if(t[e[a]])return t[e[a]];for(a=r;a>=0&&a<e.length;a-=n)if(t[e[a]])return t[e[a]]}var sPe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},kV={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function FV(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function OV(t){return t.trimLeft()}function iPe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function oPe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var LC,DV,RV,mx,UC,MV,LV,UV,g5=["times"];function QV(t,e,r,n,a){var s=4,o=HV;switch(a){case rn.API.image_compression.FAST:s=1,o=VV;break;case rn.API.image_compression.MEDIUM:s=6,o=$V;break;case rn.API.image_compression.SLOW:s=9,o=GV}t=function(c,u,d,f){for(var A,h=c.length/u,m=new Uint8Array(c.length+h),p=[lPe,VV,HV,$V,GV],x=0;x<h;x+=1){var v=x*u,y=c.subarray(v,v+u);if(f)m.set(f(y,d,A),v+x);else{for(var b=p.length,w=[],I=0;I<b;I+=1)w[I]=p[I](y,d,A);var j=uPe(w.concat());m.set(w[j],v+x)}A=y}return m}(t,e,Math.ceil(r*n/8),o);var l=Uk(t,{level:s});return rn.API.__addimage__.arrayBufferToBinaryString(l)}function lPe(t){var e=Array.apply([],t);return e.unshift(0),e}function VV(t,e){var r=t.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=t[a-e]||0;n[a+1]=t[a]-s+256&255}return n}function HV(t,e,r){var n=t.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=t[s]-o+256&255}return a}function $V(t,e,r){var n=t.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=t[s-e]||0,l=r&&r[s]||0;a[s+1]=t[s]+256-(o+l>>>1)&255}return a}function GV(t,e,r){var n=t.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=cPe(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);a[s+1]=t[s]-o+256&255}return a}function cPe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),a=Math.abs(t-r),s=Math.abs(t+e-r-r);return n<=a&&n<=s?t:a<=s?e:r}function uPe(t){var e=t.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function x5(t,e,r){var n=e*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return $re(t,a)>>s&o}function KV(t,e,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var A=f>>8&255;u.setUint8(d,A)}})(t,s,$re(t,s)&~(l<<o)&65535|c)}function $re(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function dPe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,a=t[e++],s=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,d=[],f=0,A=null,h=0,m=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];f=t[e++]|t[e++]<<8,A=t[e++],1&p||(A=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++],I=w>>6&1,j=1<<1+(7&w),C=l,S=c,E=!1;w>>7&&(E=!0,C=e,S=j,e+=3*j);var B=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}d.push({x,y:v,width:y,height:b,has_local_palette:E,palette_offset:C,palette_size:S,data_offset:B,data_length:e-B,transparent_index:A,interlaced:!!I,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,P){var G=this.frameInfo(T),ce=G.width*G.height,ue=new Uint8Array(ce);qV(t,G.data_offset,ue,ce);var le=G.palette_offset,Ae=G.transparent_index;Ae===null&&(Ae=256);var ae=G.width,_e=r-ae,De=ae,O=4*(G.y*r+G.x),H=4*((G.y+G.height)*r+G.x),K=O,R=4*_e;G.interlaced===!0&&(R+=4*r*7);for(var X=8,Y=0,D=ue.length;Y<D;++Y){var Q=ue[Y];if(De===0&&(De=ae,(K+=R)>=H&&(R=4*_e+4*r*(X-1),K=O+(ae+_e)*(X<<1),X>>=1)),Q===Ae)K+=4;else{var te=t[le+3*Q],be=t[le+3*Q+1],U=t[le+3*Q+2];P[K++]=U,P[K++]=be,P[K++]=te,P[K++]=255}--De}},this.decodeAndBlitFrameRGBA=function(T,P){var G=this.frameInfo(T),ce=G.width*G.height,ue=new Uint8Array(ce);qV(t,G.data_offset,ue,ce);var le=G.palette_offset,Ae=G.transparent_index;Ae===null&&(Ae=256);var ae=G.width,_e=r-ae,De=ae,O=4*(G.y*r+G.x),H=4*((G.y+G.height)*r+G.x),K=O,R=4*_e;G.interlaced===!0&&(R+=4*r*7);for(var X=8,Y=0,D=ue.length;Y<D;++Y){var Q=ue[Y];if(De===0&&(De=ae,(K+=R)>=H&&(R=4*_e+4*r*(X-1),K=O+(ae+_e)*(X<<1),X>>=1)),Q===Ae)K+=4;else{var te=t[le+3*Q],be=t[le+3*Q+1],U=t[le+3*Q+2];P[K++]=te,P[K++]=be,P[K++]=U,P[K++]=255}--De}}}function qV(t,e,r,n){for(var a=t[e++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,d=0,f=0,A=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;d<16&&h!==0;)f|=t[e++]<<d,d+=8,h===1?h=t[e++]:--h;if(d<c)break;var x=f&u;if(f>>=c,d-=c,x!==s){if(x===o)break;for(var v=x<l?x:p,y=0,b=v;b>s;)b=m[b]>>8,++y;var w=b;if(A+y+(v!==x?1:0)>n)return void As.log("Warning, gif stream longer than expected.");r[A++]=w;var I=A+=y;for(v!==x&&(r[A++]=w),b=v;y--;)b=m[b],r[--I]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|w,l>=u+1&&c<12&&(++c,u=u<<1|1)),p=x}else l=o+1,u=(1<<(c=a+1))-1,p=null}return A!==n&&As.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function v5(t){var e,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),A=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,v=7,y=new Array(64),b=new Array(64),w=new Array(64),I=new Array(256),j=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ue(O,H){for(var K=0,R=0,X=new Array,Y=1;Y<=16;Y++){for(var D=1;D<=O[Y];D++)X[H[R]]=[],X[H[R]][0]=K,X[H[R]][1]=Y,R++,K++;K*=2}return X}function le(O){for(var H=O[0],K=O[1]-1;K>=0;)H&1<<K&&(x|=1<<v),K--,--v<0&&(x==255?(Ae(255),Ae(0)):Ae(x),v=7,x=0)}function Ae(O){p.push(O)}function ae(O){Ae(O>>8&255),Ae(255&O)}function _e(O,H,K,R,X){for(var Y,D=X[0],Q=X[240],te=function(Ze,ut){var Et,St,Ft,Qt,Ut,Tt,Re,Te,Ye,ht,Oe=0;for(Ye=0;Ye<8;++Ye){Et=Ze[Oe],St=Ze[Oe+1],Ft=Ze[Oe+2],Qt=Ze[Oe+3],Ut=Ze[Oe+4],Tt=Ze[Oe+5],Re=Ze[Oe+6];var Ie=Et+(Te=Ze[Oe+7]),We=Et-Te,Z=St+Re,Qe=St-Re,at=Ft+Tt,Ge=Ft-Tt,ie=Qt+Ut,xe=Qt-Ut,de=Ie+ie,Me=Ie-ie,me=Z+at,we=Z-at;Ze[Oe]=de+me,Ze[Oe+4]=de-me;var pt=.707106781*(we+Me);Ze[Oe+2]=Me+pt,Ze[Oe+6]=Me-pt;var vt=.382683433*((de=xe+Ge)-(we=Qe+We)),bt=.5411961*de+vt,kt=1.306562965*we+vt,Vt=.707106781*(me=Ge+Qe),ke=We+Vt,Ne=We-Vt;Ze[Oe+5]=Ne+bt,Ze[Oe+3]=Ne-bt,Ze[Oe+1]=ke+kt,Ze[Oe+7]=ke-kt,Oe+=8}for(Oe=0,Ye=0;Ye<8;++Ye){Et=Ze[Oe],St=Ze[Oe+8],Ft=Ze[Oe+16],Qt=Ze[Oe+24],Ut=Ze[Oe+32],Tt=Ze[Oe+40],Re=Ze[Oe+48];var pe=Et+(Te=Ze[Oe+56]),Le=Et-Te,ft=St+Re,At=St-Re,ct=Ft+Tt,W=Ft-Tt,z=Qt+Ut,re=Qt-Ut,V=pe+z,L=pe-z,fe=ft+ct,Be=ft-ct;Ze[Oe]=V+fe,Ze[Oe+32]=V-fe;var ye=.707106781*(Be+L);Ze[Oe+16]=L+ye,Ze[Oe+48]=L-ye;var $e=.382683433*((V=re+W)-(Be=At+Le)),ze=.5411961*V+$e,Ke=1.306562965*Be+$e,yt=.707106781*(fe=W+At),ne=Le+yt,Ue=Le-yt;Ze[Oe+40]=Ue+ze,Ze[Oe+24]=Ue-ze,Ze[Oe+8]=ne+Ke,Ze[Oe+56]=ne-Ke,Oe++}for(Ye=0;Ye<64;++Ye)ht=Ze[Ye]*ut[Ye],h[Ye]=ht>0?ht+.5|0:ht-.5|0;return h}(O,H),be=0;be<64;++be)m[C[be]]=te[be];var U=m[0]-K;K=m[0],U==0?le(R[0]):(le(R[A[Y=32767+U]]),le(f[Y]));for(var Xe=63;Xe>0&&m[Xe]==0;)Xe--;if(Xe==0)return le(D),K;for(var se,ee=1;ee<=Xe;){for(var Fe=ee;m[ee]==0&&ee<=Xe;)++ee;var je=ee-Fe;if(je>=16){se=je>>4;for(var Se=1;Se<=se;++Se)le(Q);je&=15}Y=32767+m[ee],le(X[(je<<4)+A[Y]]),le(f[Y]),ee++}return Xe!=63&&le(D),K}function De(O){O=Math.min(Math.max(O,1),100),s!=O&&(function(H){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],R=0;R<64;R++){var X=o((K[R]*H+50)/100);X=Math.min(Math.max(X,1),255),l[C[R]]=X}for(var Y=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],D=0;D<64;D++){var Q=o((Y[D]*H+50)/100);Q=Math.min(Math.max(Q,1),255),c[C[D]]=Q}for(var te=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],be=0,U=0;U<8;U++)for(var Xe=0;Xe<8;Xe++)u[be]=1/(l[C[be]]*te[U]*te[Xe]*8),d[be]=1/(c[C[be]]*te[U]*te[Xe]*8),be++}(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),s=O)}this.encode=function(O,H){H&&De(H),p=new Array,x=0,v=7,ae(65496),ae(65504),ae(16),Ae(74),Ae(70),Ae(73),Ae(70),Ae(0),Ae(1),Ae(1),Ae(0),ae(1),ae(1),Ae(0),Ae(0),function(){ae(65499),ae(132),Ae(0);for(var St=0;St<64;St++)Ae(l[St]);Ae(1);for(var Ft=0;Ft<64;Ft++)Ae(c[Ft])}(),function(St,Ft){ae(65472),ae(17),Ae(8),ae(Ft),ae(St),Ae(3),Ae(1),Ae(17),Ae(0),Ae(2),Ae(17),Ae(1),Ae(3),Ae(17),Ae(1)}(O.width,O.height),function(){ae(65476),ae(418),Ae(0);for(var St=0;St<16;St++)Ae(S[St+1]);for(var Ft=0;Ft<=11;Ft++)Ae(E[Ft]);Ae(16);for(var Qt=0;Qt<16;Qt++)Ae(B[Qt+1]);for(var Ut=0;Ut<=161;Ut++)Ae(k[Ut]);Ae(1);for(var Tt=0;Tt<16;Tt++)Ae(T[Tt+1]);for(var Re=0;Re<=11;Re++)Ae(P[Re]);Ae(17);for(var Te=0;Te<16;Te++)Ae(G[Te+1]);for(var Ye=0;Ye<=161;Ye++)Ae(ce[Ye])}(),ae(65498),ae(12),Ae(3),Ae(1),Ae(0),Ae(2),Ae(17),Ae(3),Ae(17),Ae(0),Ae(63),Ae(0);var K=0,R=0,X=0;x=0,v=7,this.encode.displayName="_encode_";for(var Y,D,Q,te,be,U,Xe,se,ee,Fe=O.data,je=O.width,Se=O.height,Ze=4*je,ut=0;ut<Se;){for(Y=0;Y<Ze;){for(be=Ze*ut+Y,Xe=-1,se=0,ee=0;ee<64;ee++)U=be+(se=ee>>3)*Ze+(Xe=4*(7&ee)),ut+se>=Se&&(U-=Ze*(ut+1+se-Se)),Y+Xe>=Ze&&(U-=Y+Xe-Ze+4),D=Fe[U++],Q=Fe[U++],te=Fe[U++],y[ee]=(j[D]+j[Q+256|0]+j[te+512|0]>>16)-128,b[ee]=(j[D+768|0]+j[Q+1024|0]+j[te+1280|0]>>16)-128,w[ee]=(j[D+1280|0]+j[Q+1536|0]+j[te+1792|0]>>16)-128;K=_e(y,u,K,e,n),R=_e(b,d,R,r,a),X=_e(w,d,X,r,a),Y+=32}ut+=8}if(v>=0){var Et=[];Et[1]=v+1,Et[0]=(1<<v+1)-1,le(Et)}return ae(65497),new Uint8Array(p)},t=t||50,function(){for(var O=String.fromCharCode,H=0;H<256;H++)I[H]=O(H)}(),e=ue(S,E),r=ue(T,P),n=ue(B,k),a=ue(G,ce),function(){for(var O=1,H=2,K=1;K<=15;K++){for(var R=O;R<H;R++)A[32767+R]=K,f[32767+R]=[],f[32767+R][1]=K,f[32767+R][0]=R;for(var X=-(H-1);X<=-O;X++)A[32767+X]=K,f[32767+X]=[],f[32767+X][1]=K,f[32767+X][0]=H-1+X;O<<=1,H<<=1}}(),function(){for(var O=0;O<256;O++)j[O]=19595*O,j[O+256|0]=38470*O,j[O+512|0]=7471*O+32768,j[O+768|0]=-11059*O,j[O+1024|0]=-21709*O,j[O+1280|0]=32768*O+8421375,j[O+1536|0]=-27439*O,j[O+1792|0]=-5329*O}(),De(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Xd(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function zV(t){function e(E){if(!E)throw Error("assert :P")}function r(E,B,k){for(var T=0;4>T;T++)if(E[B+T]!=k.charCodeAt(T))return!0;return!1}function n(E,B,k,T,P){for(var G=0;G<P;G++)E[B+G]=k[T+G]}function a(E,B,k,T){for(var P=0;P<T;P++)E[B+P]=k}function s(E){return new Int32Array(E)}function o(E,B){for(var k=[],T=0;T<E;T++)k.push(new B);return k}function l(E,B){var k=[];return function T(P,G,ce){for(var ue=ce[G],le=0;le<ue&&(P.push(ce.length>G+1?[]:new B),!(ce.length<G+1));le++)T(P[le],G+1,ce)}(k,0,E),k}var c=function(){var E=this;function B(N,F){for(var q=1<<F-1>>>0;N&q;)q>>>=1;return q?(N&q-1)+q:N}function k(N,F,q,oe,Pe){e(!(oe%q));do N[F+(oe-=q)]=Pe;while(0<oe)}function T(N,F,q,oe,Pe){if(e(2328>=Pe),512>=Pe)var Ve=s(512);else if((Ve=s(Pe))==null)return 0;return function(qe,Je,ot,gt,Dt,Jt){var xt,Lt,Kt=Je,fr=1<<ot,Xt=s(16),mr=s(16);for(e(Dt!=0),e(gt!=null),e(qe!=null),e(0<ot),Lt=0;Lt<Dt;++Lt){if(15<gt[Lt])return 0;++Xt[gt[Lt]]}if(Xt[0]==Dt)return 0;for(mr[1]=0,xt=1;15>xt;++xt){if(Xt[xt]>1<<xt)return 0;mr[xt+1]=mr[xt]+Xt[xt]}for(Lt=0;Lt<Dt;++Lt)xt=gt[Lt],0<gt[Lt]&&(Jt[mr[xt]++]=Lt);if(mr[15]==1)return(gt=new P).g=0,gt.value=Jt[0],k(qe,Kt,1,fr,gt),fr;var gr,Br=-1,Er=fr-1,yn=0,ln=1,Yn=1,An=1<<ot;for(Lt=0,xt=1,Dt=2;xt<=ot;++xt,Dt<<=1){if(ln+=Yn<<=1,0>(Yn-=Xt[xt]))return 0;for(;0<Xt[xt];--Xt[xt])(gt=new P).g=xt,gt.value=Jt[Lt++],k(qe,Kt+yn,Dt,An,gt),yn=B(yn,xt)}for(xt=ot+1,Dt=2;15>=xt;++xt,Dt<<=1){if(ln+=Yn<<=1,0>(Yn-=Xt[xt]))return 0;for(;0<Xt[xt];--Xt[xt]){if(gt=new P,(yn&Er)!=Br){for(Kt+=An,gr=1<<(Br=xt)-ot;15>Br&&!(0>=(gr-=Xt[Br]));)++Br,gr<<=1;fr+=An=1<<(gr=Br-ot),qe[Je+(Br=yn&Er)].g=gr+ot,qe[Je+Br].value=Kt-Je-Br}gt.g=xt-ot,gt.value=Jt[Lt++],k(qe,Kt+(yn>>ot),Dt,An,gt),yn=B(yn,xt)}}return ln!=2*mr[15]-1?0:fr}(N,F,q,oe,Pe,Ve)}function P(){this.value=this.g=0}function G(){this.value=this.g=0}function ce(){this.G=o(5,P),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Wm,G)}function ue(N,F,q,oe){e(N!=null),e(F!=null),e(2147483648>oe),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=F,N.pa=q,N.Jd=F,N.Yc=q+oe,N.Zc=4<=oe?q+oe-4+1:q,D(N)}function le(N,F){for(var q=0;0<F--;)q|=te(N,128)<<F;return q}function Ae(N,F){var q=le(N,F);return Q(N)?-q:q}function ae(N,F,q,oe){var Pe,Ve=0;for(e(N!=null),e(F!=null),e(4294967288>oe),N.Sb=oe,N.Ra=0,N.u=0,N.h=0,4<oe&&(oe=4),Pe=0;Pe<oe;++Pe)Ve+=F[q+Pe]<<8*Pe;N.Ra=Ve,N.bb=oe,N.oa=F,N.pa=q}function _e(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<XA-8>>>0,++N.bb,N.u-=8;R(N)&&(N.h=1,N.u=0)}function De(N,F){if(e(0<=F),!N.h&&F<=gu){var q=K(N)&pu[F];return N.u+=F,_e(N),q}return N.h=1,N.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function K(N){return N.Ra>>>(N.u&XA-1)>>>0}function R(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>XA}function X(N,F){N.u=F,N.h=R(N)}function Y(N){N.u>=wh&&(e(N.u>=wh),_e(N))}function D(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function Q(N){return le(N,1)}function te(N,F){var q=N.Ca;0>N.b&&D(N);var oe=N.b,Pe=q*F>>>8,Ve=(N.I>>>oe>Pe)+0;for(Ve?(q-=Pe,N.I-=Pe+1<<oe>>>0):q=Pe+1,oe=q,Pe=0;256<=oe;)Pe+=8,oe>>=8;return oe=7^Pe+YA[oe],N.b-=oe,N.Ca=(q<<oe)-1,Ve}function be(N,F,q){N[F+0]=q>>24&255,N[F+1]=q>>16&255,N[F+2]=q>>8&255,N[F+3]=255&q}function U(N,F){return N[F+0]|N[F+1]<<8}function Xe(N,F){return U(N,F)|N[F+2]<<16}function se(N,F){return U(N,F)|U(N,F+2)<<16}function ee(N,F){var q=1<<F;return e(N!=null),e(0<F),N.X=s(q),N.X==null?0:(N.Mb=32-F,N.Xa=F,1)}function Fe(N,F){e(N!=null),e(F!=null),e(N.Xa==F.Xa),n(F.X,0,N.X,0,1<<F.Xa)}function je(){this.X=[],this.Xa=this.Mb=0}function Se(N,F,q,oe){e(q!=null),e(oe!=null);var Pe=q[0],Ve=oe[0];return Pe==0&&(Pe=(N*Ve+F/2)/F),Ve==0&&(Ve=(F*Pe+N/2)/N),0>=Pe||0>=Ve?0:(q[0]=Pe,oe[0]=Ve,1)}function Ze(N,F){return N+(1<<F)-1>>>F}function ut(N,F){return((4278255360&N)+(4278255360&F)>>>0&4278255360)+((16711935&N)+(16711935&F)>>>0&16711935)>>>0}function Et(N,F){E[F]=function(q,oe,Pe,Ve,qe,Je,ot){var gt;for(gt=0;gt<qe;++gt){var Dt=E[N](Je[ot+gt-1],Pe,Ve+gt);Je[ot+gt]=ut(q[oe+gt],Dt)}}}function St(){this.ud=this.hd=this.jd=0}function Ft(N,F){return((4278124286&(N^F))>>>1)+(N&F)>>>0}function Qt(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function Ut(N,F){return Qt(N+(N-F+.5>>1))}function Tt(N,F,q){return Math.abs(F-q)-Math.abs(N-q)}function Re(N,F,q,oe,Pe,Ve,qe){for(oe=Ve[qe-1],q=0;q<Pe;++q)Ve[qe+q]=oe=ut(N[F+q],oe)}function Te(N,F,q,oe,Pe){var Ve;for(Ve=0;Ve<q;++Ve){var qe=N[F+Ve],Je=qe>>8&255,ot=16711935&(ot=(ot=16711935&qe)+((Je<<16)+Je));oe[Pe+Ve]=(4278255360&qe)+ot>>>0}}function Ye(N,F){F.jd=255&N,F.hd=N>>8&255,F.ud=N>>16&255}function ht(N,F,q,oe,Pe,Ve){var qe;for(qe=0;qe<oe;++qe){var Je=F[q+qe],ot=Je>>>8,gt=Je,Dt=255&(Dt=(Dt=Je>>>16)+((N.jd<<24>>24)*(ot<<24>>24)>>>5));gt=255&(gt=(gt+=(N.hd<<24>>24)*(ot<<24>>24)>>>5)+((N.ud<<24>>24)*(Dt<<24>>24)>>>5)),Pe[Ve+qe]=(4278255360&Je)+(Dt<<16)+gt}}function Oe(N,F,q,oe,Pe){E[F]=function(Ve,qe,Je,ot,gt,Dt,Jt,xt,Lt){for(ot=Jt;ot<xt;++ot)for(Jt=0;Jt<Lt;++Jt)gt[Dt++]=Pe(Je[oe(Ve[qe++])])},E[N]=function(Ve,qe,Je,ot,gt,Dt,Jt){var xt=8>>Ve.b,Lt=Ve.Ea,Kt=Ve.K[0],fr=Ve.w;if(8>xt)for(Ve=(1<<Ve.b)-1,fr=(1<<xt)-1;qe<Je;++qe){var Xt,mr=0;for(Xt=0;Xt<Lt;++Xt)Xt&Ve||(mr=oe(ot[gt++])),Dt[Jt++]=Pe(Kt[mr&fr]),mr>>=xt}else E["VP8LMapColor"+q](ot,gt,Kt,fr,Dt,Jt,qe,Je,Lt)}}function Ie(N,F,q,oe,Pe){for(q=F+q;F<q;){var Ve=N[F++];oe[Pe++]=Ve>>16&255,oe[Pe++]=Ve>>8&255,oe[Pe++]=255&Ve}}function We(N,F,q,oe,Pe){for(q=F+q;F<q;){var Ve=N[F++];oe[Pe++]=Ve>>16&255,oe[Pe++]=Ve>>8&255,oe[Pe++]=255&Ve,oe[Pe++]=Ve>>24&255}}function Z(N,F,q,oe,Pe){for(q=F+q;F<q;){var Ve=(qe=N[F++])>>16&240|qe>>12&15,qe=240&qe|qe>>28&15;oe[Pe++]=Ve,oe[Pe++]=qe}}function Qe(N,F,q,oe,Pe){for(q=F+q;F<q;){var Ve=(qe=N[F++])>>16&248|qe>>13&7,qe=qe>>5&224|qe>>3&31;oe[Pe++]=Ve,oe[Pe++]=qe}}function at(N,F,q,oe,Pe){for(q=F+q;F<q;){var Ve=N[F++];oe[Pe++]=255&Ve,oe[Pe++]=Ve>>8&255,oe[Pe++]=Ve>>16&255}}function Ge(N,F,q,oe,Pe,Ve){if(Ve==0)for(q=F+q;F<q;)be(oe,((Ve=N[F++])[0]>>24|Ve[1]>>8&65280|Ve[2]<<8&16711680|Ve[3]<<24)>>>0),Pe+=32;else n(oe,Pe,N,F,q)}function ie(N,F){E[F][0]=E[N+"0"],E[F][1]=E[N+"1"],E[F][2]=E[N+"2"],E[F][3]=E[N+"3"],E[F][4]=E[N+"4"],E[F][5]=E[N+"5"],E[F][6]=E[N+"6"],E[F][7]=E[N+"7"],E[F][8]=E[N+"8"],E[F][9]=E[N+"9"],E[F][10]=E[N+"10"],E[F][11]=E[N+"11"],E[F][12]=E[N+"12"],E[F][13]=E[N+"13"],E[F][14]=E[N+"0"],E[F][15]=E[N+"0"]}function xe(N){return N==B3||N==k3||N==SN||N==F3}function de(){this.eb=[],this.size=this.A=this.fb=0}function Me(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function me(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new de,this.f.kb=new Me,this.sd=null}function we(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function pt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function vt(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function bt(N,F){var q=N.T,oe=F.ba.f.RGBA,Pe=oe.eb,Ve=oe.fb+N.ka*oe.A,qe=ed[F.ba.S],Je=N.y,ot=N.O,gt=N.f,Dt=N.N,Jt=N.ea,xt=N.W,Lt=F.cc,Kt=F.dc,fr=F.Mc,Xt=F.Nc,mr=N.ka,gr=N.ka+N.T,Br=N.U,Er=Br+1>>1;for(mr==0?qe(Je,ot,null,null,gt,Dt,Jt,xt,gt,Dt,Jt,xt,Pe,Ve,null,null,Br):(qe(F.ec,F.fc,Je,ot,Lt,Kt,fr,Xt,gt,Dt,Jt,xt,Pe,Ve-oe.A,Pe,Ve,Br),++q);mr+2<gr;mr+=2)Lt=gt,Kt=Dt,fr=Jt,Xt=xt,Dt+=N.Rc,xt+=N.Rc,Ve+=2*oe.A,qe(Je,(ot+=2*N.fa)-N.fa,Je,ot,Lt,Kt,fr,Xt,gt,Dt,Jt,xt,Pe,Ve-oe.A,Pe,Ve,Br);return ot+=N.fa,N.j+gr<N.o?(n(F.ec,F.fc,Je,ot,Br),n(F.cc,F.dc,gt,Dt,Er),n(F.Mc,F.Nc,Jt,xt,Er),q--):1&gr||qe(Je,ot,null,null,gt,Dt,Jt,xt,gt,Dt,Jt,xt,Pe,Ve+oe.A,null,null,Br),q}function kt(N,F,q){var oe=N.F,Pe=[N.J];if(oe!=null){var Ve=N.U,qe=F.ba.S,Je=qe==EN||qe==SN;F=F.ba.f.RGBA;var ot=[0],gt=N.ka;ot[0]=N.T,N.Kb&&(gt==0?--ot[0]:(--gt,Pe[0]-=N.width),N.j+N.ka+N.T==N.o&&(ot[0]=N.o-N.j-gt));var Dt=F.eb;gt=F.fb+gt*F.A,N=tL(oe,Pe[0],N.width,Ve,ot,Dt,gt+(Je?0:3),F.A),e(q==ot),N&&xe(qe)&&K1(Dt,gt,Je,Ve,ot,F.A)}return 0}function Vt(N){var F=N.ma,q=F.ba.S,oe=11>q,Pe=q==CN||q==_N||q==EN||q==T3||q==12||xe(q);if(F.memory=null,F.Ib=null,F.Jb=null,F.Nd=null,!M1(F.Oa,N,Pe?11:12))return 0;if(Pe&&xe(q)&&Yu(),N.da)alert("todo:use_scaling");else{if(oe){if(F.Ib=vt,N.Kb){if(q=N.U+1>>1,F.memory=s(N.U+2*q),F.memory==null)return 0;F.ec=F.memory,F.fc=0,F.cc=F.ec,F.dc=F.fc+N.U,F.Mc=F.cc,F.Nc=F.dc+q,F.Ib=bt,Yu()}}else alert("todo:EmitYUV");Pe&&(F.Jb=kt,oe&&Hc())}if(oe&&!gL){for(N=0;256>N;++N)Ode[N]=89858*(N-128)+IN>>jN,Mde[N]=-22014*(N-128)+IN,Rde[N]=-45773*(N-128),Dde[N]=113618*(N-128)+IN>>jN;for(N=z1;N<R3;++N)F=76283*(N-16)+IN>>jN,Lde[N-z1]=_r(F,255),Ude[N-z1]=_r(F+8>>4,15);gL=1}return 1}function ke(N){var F=N.ma,q=N.U,oe=N.T;return e(!(1&N.ka)),0>=q||0>=oe?0:(q=F.Ib(N,F),F.Jb!=null&&F.Jb(N,F,q),F.Dc+=q,1)}function Ne(N){N.ma.memory=null}function pe(N,F,q,oe){return De(N,8)!=47?0:(F[0]=De(N,14)+1,q[0]=De(N,14)+1,oe[0]=De(N,1),De(N,3)!=0?0:!N.h)}function Le(N,F){if(4>N)return N+1;var q=N-2>>1;return(2+(1&N)<<q)+De(F,q)+1}function ft(N,F){return 120<F?F-120:1<=(q=((q=bde[F-1])>>4)*N+(8-(15&q)))?q:1;var q}function At(N,F,q){var oe=K(q),Pe=N[F+=255&oe].g-8;return 0<Pe&&(X(q,q.u+8),oe=K(q),F+=N[F].value,F+=oe&(1<<Pe)-1),X(q,q.u+N[F].g),N[F].value}function ct(N,F,q){return q.g+=N.g,q.value+=N.value<<F>>>0,e(8>=q.g),N.g}function W(N,F,q){var oe=N.xc;return e((F=oe==0?0:N.vc[N.md*(q>>oe)+(F>>oe)])<N.Wb),N.Ya[F]}function z(N,F,q,oe){var Pe=N.ab,Ve=N.c*F,qe=N.C;F=qe+F;var Je=q,ot=oe;for(oe=N.Ta,q=N.Ua;0<Pe--;){var gt=N.gc[Pe],Dt=qe,Jt=F,xt=Je,Lt=ot,Kt=(ot=oe,Je=q,gt.Ea);switch(e(Dt<Jt),e(Jt<=gt.nc),gt.hc){case 2:Bi(xt,Lt,(Jt-Dt)*Kt,ot,Je);break;case 0:var fr=Dt,Xt=Jt,mr=ot,gr=Je,Br=(An=gt).Ea;fr==0&&(U1(xt,Lt,null,null,1,mr,gr),Re(xt,Lt+1,0,0,Br-1,mr,gr+1),Lt+=Br,gr+=Br,++fr);for(var Er=1<<An.b,yn=Er-1,ln=Ze(Br,An.b),Yn=An.K,An=An.w+(fr>>An.b)*ln;fr<Xt;){var ga=Yn,po=An,Jn=1;for(Jg(xt,Lt,mr,gr-Br,1,mr,gr);Jn<Br;){var mn=(Jn&~yn)+Er;mn>Br&&(mn=Br),(0,V1[ga[po++]>>8&15])(xt,Lt+ +Jn,mr,gr+Jn-Br,mn-Jn,mr,gr+Jn),Jn=mn}Lt+=Br,gr+=Br,++fr&yn||(An+=ln)}Jt!=gt.nc&&n(ot,Je-Kt,ot,Je+(Jt-Dt-1)*Kt,Kt);break;case 1:for(Kt=xt,Xt=Lt,Br=(xt=gt.Ea)-(gr=xt&~(mr=(Lt=1<<gt.b)-1)),fr=Ze(xt,gt.b),Er=gt.K,gt=gt.w+(Dt>>gt.b)*fr;Dt<Jt;){for(yn=Er,ln=gt,Yn=new St,An=Xt+gr,ga=Xt+xt;Xt<An;)Ye(yn[ln++],Yn),H1(Yn,Kt,Xt,Lt,ot,Je),Xt+=Lt,Je+=Lt;Xt<ga&&(Ye(yn[ln++],Yn),H1(Yn,Kt,Xt,Br,ot,Je),Xt+=Br,Je+=Br),++Dt&mr||(gt+=fr)}break;case 3:if(xt==ot&&Lt==Je&&0<gt.b){for(Xt=ot,xt=Kt=Je+(Jt-Dt)*Kt-(gr=(Jt-Dt)*Ze(gt.Ea,gt.b)),Lt=ot,mr=Je,fr=[],gr=(Br=gr)-1;0<=gr;--gr)fr[gr]=Lt[mr+gr];for(gr=Br-1;0<=gr;--gr)Xt[xt+gr]=fr[gr];yN(gt,Dt,Jt,ot,Kt,ot,Je)}else yN(gt,Dt,Jt,xt,Lt,ot,Je)}Je=oe,ot=q}ot!=q&&n(oe,q,Je,ot,Ve)}function re(N,F){var q=N.V,oe=N.Ba+N.c*N.C,Pe=F-N.C;if(e(F<=N.l.o),e(16>=Pe),0<Pe){var Ve=N.l,qe=N.Ta,Je=N.Ua,ot=Ve.width;if(z(N,Pe,q,oe),Pe=Je=[Je],e((q=N.C)<(oe=F)),e(Ve.v<Ve.va),oe>Ve.o&&(oe=Ve.o),q<Ve.j){var gt=Ve.j-q;q=Ve.j,Pe[0]+=gt*ot}if(q>=oe?q=0:(Pe[0]+=4*Ve.v,Ve.ka=q-Ve.j,Ve.U=Ve.va-Ve.v,Ve.T=oe-q,q=1),q){if(Je=Je[0],11>(q=N.ca).S){var Dt=q.f.RGBA,Jt=(oe=q.S,Pe=Ve.U,Ve=Ve.T,gt=Dt.eb,Dt.A),xt=Ve;for(Dt=Dt.fb+N.Ma*Dt.A;0<xt--;){var Lt=qe,Kt=Je,fr=Pe,Xt=gt,mr=Dt;switch(oe){case NN:$1(Lt,Kt,fr,Xt,mr);break;case CN:JA(Lt,Kt,fr,Xt,mr);break;case B3:JA(Lt,Kt,fr,Xt,mr),K1(Xt,mr,0,fr,1,0);break;case lL:Xm(Lt,Kt,fr,Xt,mr);break;case _N:Ge(Lt,Kt,fr,Xt,mr,1);break;case k3:Ge(Lt,Kt,fr,Xt,mr,1),K1(Xt,mr,0,fr,1,0);break;case EN:Ge(Lt,Kt,fr,Xt,mr,0);break;case SN:Ge(Lt,Kt,fr,Xt,mr,0),K1(Xt,mr,1,fr,1,0);break;case T3:ZA(Lt,Kt,fr,Xt,mr);break;case F3:ZA(Lt,Kt,fr,Xt,mr),eL(Xt,mr,fr,1,0);break;case cL:e0(Lt,Kt,fr,Xt,mr);break;default:e(0)}Je+=ot,Dt+=Jt}N.Ma+=Ve}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=q.height)}}N.C=F,e(N.C<=N.i)}function V(N){var F;if(0<N.ua)return 0;for(F=0;F<N.Wb;++F){var q=N.Ya[F].G,oe=N.Ya[F].H;if(0<q[1][oe[1]+0].g||0<q[2][oe[2]+0].g||0<q[3][oe[3]+0].g)return 0}return 1}function L(N,F,q,oe,Pe,Ve){if(N.Z!=0){var qe=N.qd,Je=N.rd;for(e(n0[N.Z]!=null);F<q;++F)n0[N.Z](qe,Je,oe,Pe,oe,Pe,Ve),qe=oe,Je=Pe,Pe+=Ve;N.qd=qe,N.rd=Je}}function fe(N,F){var q=N.l.ma,oe=q.Z==0||q.Z==1?N.l.j:N.C;if(oe=N.C<oe?oe:N.C,e(F<=N.l.o),F>oe){var Pe=N.l.width,Ve=q.ca,qe=q.tb+Pe*oe,Je=N.V,ot=N.Ba+N.c*oe,gt=N.gc;e(N.ab==1),e(gt[0].hc==3),Df(gt[0],oe,F,Je,ot,Ve,qe),L(q,oe,F,Ve,qe,Pe)}N.C=N.Ma=F}function Be(N,F,q,oe,Pe,Ve,qe){var Je=N.$/oe,ot=N.$%oe,gt=N.m,Dt=N.s,Jt=q+N.$,xt=Jt;Pe=q+oe*Pe;var Lt=q+oe*Ve,Kt=280+Dt.ua,fr=N.Pb?Je:16777216,Xt=0<Dt.ua?Dt.Wa:null,mr=Dt.wc,gr=Jt<Lt?W(Dt,ot,Je):null;e(N.C<Ve),e(Lt<=Pe);var Br=!1;e:for(;;){for(;Br||Jt<Lt;){var Er=0;if(Je>=fr){var yn=Jt-q;e((fr=N).Pb),fr.wd=fr.m,fr.xd=yn,0<fr.s.ua&&Fe(fr.s.Wa,fr.s.vb),fr=Je+Nde}if(ot&mr||(gr=W(Dt,ot,Je)),e(gr!=null),gr.Qb&&(F[Jt]=gr.qb,Br=!0),!Br)if(Y(gt),gr.jc){Er=gt,yn=F;var ln=Jt,Yn=gr.pd[K(Er)&Wm-1];e(gr.jc),256>Yn.g?(X(Er,Er.u+Yn.g),yn[ln]=Yn.value,Er=0):(X(Er,Er.u+Yn.g-256),e(256<=Yn.value),Er=Yn.value),Er==0&&(Br=!0)}else Er=At(gr.G[0],gr.H[0],gt);if(gt.h)break;if(Br||256>Er){if(!Br)if(gr.nd)F[Jt]=(gr.qb|Er<<8)>>>0;else{if(Y(gt),Br=At(gr.G[1],gr.H[1],gt),Y(gt),yn=At(gr.G[2],gr.H[2],gt),ln=At(gr.G[3],gr.H[3],gt),gt.h)break;F[Jt]=(ln<<24|Br<<16|Er<<8|yn)>>>0}if(Br=!1,++Jt,++ot>=oe&&(ot=0,++Je,qe!=null&&Je<=Ve&&!(Je%16)&&qe(N,Je),Xt!=null))for(;xt<Jt;)Er=F[xt++],Xt.X[(506832829*Er&4294967295)>>>Xt.Mb]=Er}else if(280>Er){if(Er=Le(Er-256,gt),yn=At(gr.G[4],gr.H[4],gt),Y(gt),yn=ft(oe,yn=Le(yn,gt)),gt.h)break;if(Jt-q<yn||Pe-Jt<Er)break e;for(ln=0;ln<Er;++ln)F[Jt+ln]=F[Jt+ln-yn];for(Jt+=Er,ot+=Er;ot>=oe;)ot-=oe,++Je,qe!=null&&Je<=Ve&&!(Je%16)&&qe(N,Je);if(e(Jt<=Pe),ot&mr&&(gr=W(Dt,ot,Je)),Xt!=null)for(;xt<Jt;)Er=F[xt++],Xt.X[(506832829*Er&4294967295)>>>Xt.Mb]=Er}else{if(!(Er<Kt))break e;for(Br=Er-280,e(Xt!=null);xt<Jt;)Er=F[xt++],Xt.X[(506832829*Er&4294967295)>>>Xt.Mb]=Er;Er=Jt,e(!(Br>>>(yn=Xt).Xa)),F[Er]=yn.X[Br],Br=!0}Br||e(gt.h==R(gt))}if(N.Pb&&gt.h&&Jt<Pe)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&Fe(N.s.vb,N.s.Wa);else{if(gt.h)break e;qe!=null&&qe(N,Je>Ve?Ve:Je),N.a=0,N.$=Jt-q}return 1}return N.a=3,0}function ye(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var F=N.Wa;F!=null&&(F.X=null),N.vb=null,e(N!=null)}function $e(){var N=new Bn;return N==null?null:(N.a=0,N.xb=fL,ie("Predictor","VP8LPredictors"),ie("Predictor","VP8LPredictors_C"),ie("PredictorAdd","VP8LPredictorsAdd"),ie("PredictorAdd","VP8LPredictorsAdd_C"),Bi=Te,H1=ht,$1=Ie,JA=We,ZA=Z,e0=Qe,Xm=at,E.VP8LMapColor32b=Of,E.VP8LMapColor8b=Q1,N)}function ze(N,F,q,oe,Pe){var Ve=1,qe=[N],Je=[F],ot=oe.m,gt=oe.s,Dt=null,Jt=0;e:for(;;){if(q)for(;Ve&&De(ot,1);){var xt=qe,Lt=Je,Kt=oe,fr=1,Xt=Kt.m,mr=Kt.gc[Kt.ab],gr=De(Xt,2);if(Kt.Oc&1<<gr)Ve=0;else{switch(Kt.Oc|=1<<gr,mr.hc=gr,mr.Ea=xt[0],mr.nc=Lt[0],mr.K=[null],++Kt.ab,e(4>=Kt.ab),gr){case 0:case 1:mr.b=De(Xt,3)+2,fr=ze(Ze(mr.Ea,mr.b),Ze(mr.nc,mr.b),0,Kt,mr.K),mr.K=mr.K[0];break;case 3:var Br,Er=De(Xt,8)+1,yn=16<Er?0:4<Er?1:2<Er?2:3;if(xt[0]=Ze(mr.Ea,yn),mr.b=yn,Br=fr=ze(Er,1,0,Kt,mr.K)){var ln,Yn=Er,An=mr,ga=1<<(8>>An.b),po=s(ga);if(po==null)Br=0;else{var Jn=An.K[0],mn=An.w;for(po[0]=An.K[0][0],ln=1;ln<1*Yn;++ln)po[ln]=ut(Jn[mn+ln],po[ln-1]);for(;ln<4*ga;++ln)po[ln]=0;An.K[0]=null,An.K[0]=po,Br=1}}fr=Br;break;case 2:break;default:e(0)}Ve=fr}}if(qe=qe[0],Je=Je[0],Ve&&De(ot,1)&&!(Ve=1<=(Jt=De(ot,4))&&11>=Jt)){oe.a=3;break e}var zr;if(zr=Ve)t:{var Fi,Kn,ya,Ss=oe,dl=qe,mc=Je,yi=Jt,Ll=q,pc=Ss.m,go=Ss.s,Ca=[null],Ga=1,bi=0,Ka=wde[yi];r:for(;;){if(Ll&&De(pc,1)){var fl=De(pc,3)+2,qd=Ze(dl,fl),Oi=Ze(mc,fl),$c=qd*Oi;if(!ze(qd,Oi,0,Ss,Ca))break r;for(Ca=Ca[0],go.xc=fl,Fi=0;Fi<$c;++Fi){var hs=Ca[Fi]>>8&65535;Ca[Fi]=hs,hs>=Ga&&(Ga=hs+1)}}if(pc.h)break r;for(Kn=0;5>Kn;++Kn){var xo=uL[Kn];!Kn&&0<yi&&(xo+=1<<yi),bi<xo&&(bi=xo)}var vu=o(Ga*Ka,P),gc=Ga,yu=o(gc,ce);if(yu==null)var bu=null;else e(65536>=gc),bu=yu;var Gc=s(bi);if(bu==null||Gc==null||vu==null){Ss.a=1;break r}var wu=vu;for(Fi=ya=0;Fi<Ga;++Fi){var ys=bu[Fi],Nu=ys.G,zd=ys.H,Jm=0,_h=1,hl=0;for(Kn=0;5>Kn;++Kn){xo=uL[Kn],Nu[Kn]=wu,zd[Kn]=ya,!Kn&&0<yi&&(xo+=1<<yi);a:{var TN,M3=xo,BN=Ss,W1=Gc,Hde=wu,$de=ya,L3=0,a0=BN.m,Gde=De(a0,1);if(a(W1,0,0,M3),Gde){var Kde=De(a0,1)+1,qde=De(a0,1),yL=De(a0,qde==0?1:8);W1[yL]=1,Kde==2&&(W1[yL=De(a0,8)]=1);var kN=1}else{var bL=s(19),wL=De(a0,4)+4;if(19<wL){BN.a=3;var FN=0;break a}for(TN=0;TN<wL;++TN)bL[yde[TN]]=De(a0,3);var U3=void 0,X1=void 0,NL=BN,zde=bL,ON=M3,CL=W1,Q3=0,s0=NL.m,_L=8,EL=o(128,P);n:for(;T(EL,0,7,zde,19);){if(De(s0,1)){var Wde=2+2*De(s0,3);if((U3=2+De(s0,Wde))>ON)break n}else U3=ON;for(X1=0;X1<ON&&U3--;){Y(s0);var SL=EL[0+(127&K(s0))];X(s0,s0.u+SL.g);var ex=SL.value;if(16>ex)CL[X1++]=ex,ex!=0&&(_L=ex);else{var Xde=ex==16,jL=ex-16,Yde=xde[jL],IL=De(s0,gde[jL])+Yde;if(X1+IL>ON)break n;for(var Jde=Xde?_L:0;0<IL--;)CL[X1++]=Jde}}Q3=1;break n}Q3||(NL.a=3),kN=Q3}(kN=kN&&!a0.h)&&(L3=T(Hde,$de,8,W1,M3)),kN&&L3!=0?FN=L3:(BN.a=3,FN=0)}if(FN==0)break r;if(_h&&vde[Kn]==1&&(_h=wu[ya].g==0),Jm+=wu[ya].g,ya+=FN,3>=Kn){var Y1,V3=Gc[0];for(Y1=1;Y1<xo;++Y1)Gc[Y1]>V3&&(V3=Gc[Y1]);hl+=V3}}if(ys.nd=_h,ys.Qb=0,_h&&(ys.qb=(Nu[3][zd[3]+0].value<<24|Nu[1][zd[1]+0].value<<16|Nu[2][zd[2]+0].value)>>>0,Jm==0&&256>Nu[0][zd[0]+0].value&&(ys.Qb=1,ys.qb+=Nu[0][zd[0]+0].value<<8)),ys.jc=!ys.Qb&&6>hl,ys.jc){var DN,Eh=ys;for(DN=0;DN<Wm;++DN){var i0=DN,o0=Eh.pd[i0],RN=Eh.G[0][Eh.H[0]+i0];256<=RN.value?(o0.g=RN.g+256,o0.value=RN.value):(o0.g=0,o0.value=0,i0>>=ct(RN,8,o0),i0>>=ct(Eh.G[1][Eh.H[1]+i0],16,o0),i0>>=ct(Eh.G[2][Eh.H[2]+i0],0,o0),ct(Eh.G[3][Eh.H[3]+i0],24,o0))}}}go.vc=Ca,go.Wb=Ga,go.Ya=bu,go.yc=vu,zr=1;break t}zr=0}if(!(Ve=zr)){oe.a=3;break e}if(0<Jt){if(gt.ua=1<<Jt,!ee(gt.Wa,Jt)){oe.a=1,Ve=0;break e}}else gt.ua=0;var H3=oe,PL=qe,Zde=Je,$3=H3.s,G3=$3.xc;if(H3.c=PL,H3.i=Zde,$3.md=Ze(PL,G3),$3.wc=G3==0?-1:(1<<G3)-1,q){oe.xb=Pde;break e}if((Dt=s(qe*Je))==null){oe.a=1,Ve=0;break e}Ve=(Ve=Be(oe,Dt,0,qe,Je,Je,null))&&!ot.h;break e}return Ve?(Pe!=null?Pe[0]=Dt:(e(Dt==null),e(q)),oe.$=0,q||ye(gt)):ye(gt),Ve}function Ke(N,F){var q=N.c*N.i,oe=q+F+16*F;return e(N.c<=F),N.V=s(oe),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+q+F,1)}function yt(N,F){var q=N.C,oe=F-q,Pe=N.V,Ve=N.Ba+N.c*q;for(e(F<=N.l.o);0<oe;){var qe=16<oe?16:oe,Je=N.l.ma,ot=N.l.width,gt=ot*qe,Dt=Je.ca,Jt=Je.tb+ot*q,xt=N.Ta,Lt=N.Ua;z(N,qe,Pe,Ve),rL(xt,Lt,Dt,Jt,gt),L(Je,q,q+qe,Dt,Jt,ot),oe-=qe,Pe+=qe*N.c,q+=qe}e(q==F),N.C=N.Ma=F}function ne(){this.ub=this.yd=this.td=this.Rb=0}function Ue(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function rt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function st(){this.Yb=function(){var N=[];return function F(q,oe,Pe){for(var Ve=Pe[oe],qe=0;qe<Ve&&(q.push(Pe.length>oe+1?[]:0),!(Pe.length<oe+1));qe++)F(q[qe],oe+1,Pe)}(N,0,[3,11]),N}()}function _t(){this.jb=s(3),this.Wc=l([4,8],st),this.Xc=l([4,17],st)}function Ot(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function nr(){this.ld=this.La=this.dd=this.tc=0}function Ir(){this.Na=this.la=0}function Qr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function or(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function kr(){this.uc=this.M=this.Nb=0,this.wa=Array(new nr),this.Y=0,this.ya=Array(new or),this.aa=0,this.l=new He}function Zr(){this.y=s(16),this.f=s(8),this.ea=s(8)}function nn(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new ne,this.Kc=new Ue,this.ed=new Ot,this.Qa=new rt,this.Ic=this.$c=this.Aa=0,this.D=new kr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,O),this.ia=0,this.pb=o(4,Qr),this.Pa=new _t,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Zr),this.Hd=0,this.rb=Array(new Ir),this.sb=0,this.wa=Array(new nr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new or),this.L=this.aa=0,this.gd=l([4,2],nr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function _r(N,F){return 0>N?0:N>F?F:N}function He(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Bt(){var N=new nn;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,q1||(q1=br)),N}function xr(N,F,q){return N.a==0&&(N.a=F,N.sc=q,N.cb=0),0}function dn(N,F,q){return 3<=q&&N[F+0]==157&&N[F+1]==1&&N[F+2]==42}function Jr(N,F){if(N==null)return 0;if(N.a=0,N.sc="OK",F==null)return xr(N,2,"null VP8Io passed to VP8GetHeaders()");var q=F.data,oe=F.w,Pe=F.ha;if(4>Pe)return xr(N,7,"Truncated header.");var Ve=q[oe+0]|q[oe+1]<<8|q[oe+2]<<16,qe=N.Od;if(qe.Rb=!(1&Ve),qe.td=Ve>>1&7,qe.yd=Ve>>4&1,qe.ub=Ve>>5,3<qe.td)return xr(N,3,"Incorrect keyframe parameters.");if(!qe.yd)return xr(N,4,"Frame not displayable.");oe+=3,Pe-=3;var Je=N.Kc;if(qe.Rb){if(7>Pe)return xr(N,7,"cannot parse picture header");if(!dn(q,oe,Pe))return xr(N,3,"Bad code word");Je.c=16383&(q[oe+4]<<8|q[oe+3]),Je.Td=q[oe+4]>>6,Je.i=16383&(q[oe+6]<<8|q[oe+5]),Je.Ud=q[oe+6]>>6,oe+=7,Pe-=7,N.za=Je.c+15>>4,N.Ub=Je.i+15>>4,F.width=Je.c,F.height=Je.i,F.Da=0,F.j=0,F.v=0,F.va=F.width,F.o=F.height,F.da=0,F.ib=F.width,F.hb=F.height,F.U=F.width,F.T=F.height,a((Ve=N.Pa).jb,0,255,Ve.jb.length),e((Ve=N.Qa)!=null),Ve.Cb=0,Ve.Bb=0,Ve.Fb=1,a(Ve.Zb,0,0,Ve.Zb.length),a(Ve.Lb,0,0,Ve.Lb)}if(qe.ub>Pe)return xr(N,7,"bad partition length");ue(Ve=N.m,q,oe,qe.ub),oe+=qe.ub,Pe-=qe.ub,qe.Rb&&(Je.Ld=Q(Ve),Je.Kd=Q(Ve)),Je=N.Qa;var ot,gt=N.Pa;if(e(Ve!=null),e(Je!=null),Je.Cb=Q(Ve),Je.Cb){if(Je.Bb=Q(Ve),Q(Ve)){for(Je.Fb=Q(Ve),ot=0;4>ot;++ot)Je.Zb[ot]=Q(Ve)?Ae(Ve,7):0;for(ot=0;4>ot;++ot)Je.Lb[ot]=Q(Ve)?Ae(Ve,6):0}if(Je.Bb)for(ot=0;3>ot;++ot)gt.jb[ot]=Q(Ve)?le(Ve,8):255}else Je.Bb=0;if(Ve.Ka)return xr(N,3,"cannot parse segment header");if((Je=N.ed).zd=Q(Ve),Je.Tb=le(Ve,6),Je.wb=le(Ve,3),Je.Pc=Q(Ve),Je.Pc&&Q(Ve)){for(gt=0;4>gt;++gt)Q(Ve)&&(Je.vd[gt]=Ae(Ve,6));for(gt=0;4>gt;++gt)Q(Ve)&&(Je.od[gt]=Ae(Ve,6))}if(N.L=Je.Tb==0?0:Je.zd?1:2,Ve.Ka)return xr(N,3,"cannot parse filter header");var Dt=Pe;if(Pe=ot=oe,oe=ot+Dt,Je=Dt,N.Xb=(1<<le(N.m,2))-1,Dt<3*(gt=N.Xb))q=7;else{for(ot+=3*gt,Je-=3*gt,Dt=0;Dt<gt;++Dt){var Jt=q[Pe+0]|q[Pe+1]<<8|q[Pe+2]<<16;Jt>Je&&(Jt=Je),ue(N.Jc[+Dt],q,ot,Jt),ot+=Jt,Je-=Jt,Pe+=3}ue(N.Jc[+gt],q,ot,Je),q=ot<oe?0:5}if(q!=0)return xr(N,q,"cannot parse partitions");for(q=le(ot=N.m,7),Pe=Q(ot)?Ae(ot,4):0,oe=Q(ot)?Ae(ot,4):0,Je=Q(ot)?Ae(ot,4):0,gt=Q(ot)?Ae(ot,4):0,ot=Q(ot)?Ae(ot,4):0,Dt=N.Qa,Jt=0;4>Jt;++Jt){if(Dt.Cb){var xt=Dt.Zb[Jt];Dt.Fb||(xt+=q)}else{if(0<Jt){N.pb[Jt]=N.pb[0];continue}xt=q}var Lt=N.pb[Jt];Lt.Sc[0]=O3[_r(xt+Pe,127)],Lt.Sc[1]=D3[_r(xt+0,127)],Lt.Eb[0]=2*O3[_r(xt+oe,127)],Lt.Eb[1]=101581*D3[_r(xt+Je,127)]>>16,8>Lt.Eb[1]&&(Lt.Eb[1]=8),Lt.Qc[0]=O3[_r(xt+gt,117)],Lt.Qc[1]=D3[_r(xt+ot,127)],Lt.lc=xt+ot}if(!qe.Rb)return xr(N,4,"Not a key frame.");for(Q(Ve),qe=N.Pa,q=0;4>q;++q){for(Pe=0;8>Pe;++Pe)for(oe=0;3>oe;++oe)for(Je=0;11>Je;++Je)gt=te(Ve,jde[q][Pe][oe][Je])?le(Ve,8):Ede[q][Pe][oe][Je],qe.Wc[q][Pe].Yb[oe][Je]=gt;for(Pe=0;17>Pe;++Pe)qe.Xc[q][Pe]=qe.Wc[q][Ide[Pe]]}return N.kc=Q(Ve),N.kc&&(N.Bd=le(Ve,8)),N.cb=1}function br(N,F,q,oe,Pe,Ve,qe){var Je=F[Pe].Yb[q];for(q=0;16>Pe;++Pe){if(!te(N,Je[q+0]))return Pe;for(;!te(N,Je[q+1]);)if(Je=F[++Pe].Yb[0],q=0,Pe==16)return 16;var ot=F[Pe+1].Yb;if(te(N,Je[q+2])){var gt=N,Dt=0;if(te(gt,(xt=Je)[(Jt=q)+3]))if(te(gt,xt[Jt+6])){for(Je=0,Jt=2*(Dt=te(gt,xt[Jt+8]))+(xt=te(gt,xt[Jt+9+Dt])),Dt=0,xt=Cde[Jt];xt[Je];++Je)Dt+=Dt+te(gt,xt[Je]);Dt+=3+(8<<Jt)}else te(gt,xt[Jt+7])?(Dt=7+2*te(gt,165),Dt+=te(gt,145)):Dt=5+te(gt,159);else Dt=te(gt,xt[Jt+4])?3+te(gt,xt[Jt+5]):2;Je=ot[2]}else Dt=1,Je=ot[1];ot=qe+_de[Pe],0>(gt=N).b&&D(gt);var Jt,xt=gt.b,Lt=(Jt=gt.Ca>>1)-(gt.I>>xt)>>31;--gt.b,gt.Ca+=Lt,gt.Ca|=1,gt.I-=(Jt+1&Lt)<<xt,Ve[ot]=((Dt^Lt)-Lt)*oe[(0<Pe)+0]}return 16}function er(N){var F=N.rb[N.sb-1];F.la=0,F.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function ir(N,F,q,oe,Pe){Pe=N[F+q+32*oe]+(Pe>>3),N[F+q+32*oe]=-256&Pe?0>Pe?0:255:Pe}function Sr(N,F,q,oe,Pe,Ve){ir(N,F,0,q,oe+Pe),ir(N,F,1,q,oe+Ve),ir(N,F,2,q,oe-Ve),ir(N,F,3,q,oe-Pe)}function vr(N){return(20091*N>>16)+N}function Fr(N,F,q,oe){var Pe,Ve=0,qe=s(16);for(Pe=0;4>Pe;++Pe){var Je=N[F+0]+N[F+8],ot=N[F+0]-N[F+8],gt=(35468*N[F+4]>>16)-vr(N[F+12]),Dt=vr(N[F+4])+(35468*N[F+12]>>16);qe[Ve+0]=Je+Dt,qe[Ve+1]=ot+gt,qe[Ve+2]=ot-gt,qe[Ve+3]=Je-Dt,Ve+=4,F++}for(Pe=Ve=0;4>Pe;++Pe)Je=(N=qe[Ve+0]+4)+qe[Ve+8],ot=N-qe[Ve+8],gt=(35468*qe[Ve+4]>>16)-vr(qe[Ve+12]),ir(q,oe,0,0,Je+(Dt=vr(qe[Ve+4])+(35468*qe[Ve+12]>>16))),ir(q,oe,1,0,ot+gt),ir(q,oe,2,0,ot-gt),ir(q,oe,3,0,Je-Dt),Ve++,oe+=32}function jn(N,F,q,oe){var Pe=N[F+0]+4,Ve=35468*N[F+4]>>16,qe=vr(N[F+4]),Je=35468*N[F+1]>>16;Sr(q,oe,0,Pe+qe,N=vr(N[F+1]),Je),Sr(q,oe,1,Pe+Ve,N,Je),Sr(q,oe,2,Pe-Ve,N,Je),Sr(q,oe,3,Pe-qe,N,Je)}function he(N,F,q,oe,Pe){Fr(N,F,q,oe),Pe&&Fr(N,F+16,q,oe+4)}function tt(N,F,q,oe){Ym(N,F+0,q,oe,1),Ym(N,F+32,q,oe+128,1)}function nt(N,F,q,oe){var Pe;for(N=N[F+0]+4,Pe=0;4>Pe;++Pe)for(F=0;4>F;++F)ir(q,oe,F,Pe,N)}function lt(N,F,q,oe){N[F+0]&&Qa(N,F+0,q,oe),N[F+16]&&Qa(N,F+16,q,oe+4),N[F+32]&&Qa(N,F+32,q,oe+128),N[F+48]&&Qa(N,F+48,q,oe+128+4)}function ge(N,F,q,oe){var Pe,Ve=s(16);for(Pe=0;4>Pe;++Pe){var qe=N[F+0+Pe]+N[F+12+Pe],Je=N[F+4+Pe]+N[F+8+Pe],ot=N[F+4+Pe]-N[F+8+Pe],gt=N[F+0+Pe]-N[F+12+Pe];Ve[0+Pe]=qe+Je,Ve[8+Pe]=qe-Je,Ve[4+Pe]=gt+ot,Ve[12+Pe]=gt-ot}for(Pe=0;4>Pe;++Pe)qe=(N=Ve[0+4*Pe]+3)+Ve[3+4*Pe],Je=Ve[1+4*Pe]+Ve[2+4*Pe],ot=Ve[1+4*Pe]-Ve[2+4*Pe],gt=N-Ve[3+4*Pe],q[oe+0]=qe+Je>>3,q[oe+16]=gt+ot>>3,q[oe+32]=qe-Je>>3,q[oe+48]=gt-ot>>3,oe+=64}function it(N,F,q){var oe,Pe=F-32,Ve=xu,qe=255-N[Pe-1];for(oe=0;oe<q;++oe){var Je,ot=Ve,gt=qe+N[F-1];for(Je=0;Je<q;++Je)N[F+Je]=ot[gt+N[Pe+Je]];F+=32}}function Pt(N,F){it(N,F,4)}function wt(N,F){it(N,F,8)}function Nt(N,F){it(N,F,16)}function It(N,F){var q;for(q=0;16>q;++q)n(N,F+32*q,N,F-32,16)}function qt(N,F){var q;for(q=16;0<q;--q)a(N,F,N[F-1],16),F+=32}function Mt(N,F,q){var oe;for(oe=0;16>oe;++oe)a(F,q+32*oe,N,16)}function zt(N,F){var q,oe=16;for(q=0;16>q;++q)oe+=N[F-1+32*q]+N[F+q-32];Mt(oe>>5,N,F)}function ar(N,F){var q,oe=8;for(q=0;16>q;++q)oe+=N[F-1+32*q];Mt(oe>>4,N,F)}function wr(N,F){var q,oe=8;for(q=0;16>q;++q)oe+=N[F+q-32];Mt(oe>>4,N,F)}function dr(N,F){Mt(128,N,F)}function Rt(N,F,q){return N+2*F+q+2>>2}function Wr(N,F){var q,oe=F-32;for(oe=new Uint8Array([Rt(N[oe-1],N[oe+0],N[oe+1]),Rt(N[oe+0],N[oe+1],N[oe+2]),Rt(N[oe+1],N[oe+2],N[oe+3]),Rt(N[oe+2],N[oe+3],N[oe+4])]),q=0;4>q;++q)n(N,F+32*q,oe,0,oe.length)}function Vr(N,F){var q=N[F-1],oe=N[F-1+32],Pe=N[F-1+64],Ve=N[F-1+96];be(N,F+0,16843009*Rt(N[F-1-32],q,oe)),be(N,F+32,16843009*Rt(q,oe,Pe)),be(N,F+64,16843009*Rt(oe,Pe,Ve)),be(N,F+96,16843009*Rt(Pe,Ve,Ve))}function jr(N,F){var q,oe=4;for(q=0;4>q;++q)oe+=N[F+q-32]+N[F-1+32*q];for(oe>>=3,q=0;4>q;++q)a(N,F+32*q,oe,4)}function pr(N,F){var q=N[F-1+0],oe=N[F-1+32],Pe=N[F-1+64],Ve=N[F-1-32],qe=N[F+0-32],Je=N[F+1-32],ot=N[F+2-32],gt=N[F+3-32];N[F+0+96]=Rt(oe,Pe,N[F-1+96]),N[F+1+96]=N[F+0+64]=Rt(q,oe,Pe),N[F+2+96]=N[F+1+64]=N[F+0+32]=Rt(Ve,q,oe),N[F+3+96]=N[F+2+64]=N[F+1+32]=N[F+0+0]=Rt(qe,Ve,q),N[F+3+64]=N[F+2+32]=N[F+1+0]=Rt(Je,qe,Ve),N[F+3+32]=N[F+2+0]=Rt(ot,Je,qe),N[F+3+0]=Rt(gt,ot,Je)}function Pr(N,F){var q=N[F+1-32],oe=N[F+2-32],Pe=N[F+3-32],Ve=N[F+4-32],qe=N[F+5-32],Je=N[F+6-32],ot=N[F+7-32];N[F+0+0]=Rt(N[F+0-32],q,oe),N[F+1+0]=N[F+0+32]=Rt(q,oe,Pe),N[F+2+0]=N[F+1+32]=N[F+0+64]=Rt(oe,Pe,Ve),N[F+3+0]=N[F+2+32]=N[F+1+64]=N[F+0+96]=Rt(Pe,Ve,qe),N[F+3+32]=N[F+2+64]=N[F+1+96]=Rt(Ve,qe,Je),N[F+3+64]=N[F+2+96]=Rt(qe,Je,ot),N[F+3+96]=Rt(Je,ot,ot)}function Tn(N,F){var q=N[F-1+0],oe=N[F-1+32],Pe=N[F-1+64],Ve=N[F-1-32],qe=N[F+0-32],Je=N[F+1-32],ot=N[F+2-32],gt=N[F+3-32];N[F+0+0]=N[F+1+64]=Ve+qe+1>>1,N[F+1+0]=N[F+2+64]=qe+Je+1>>1,N[F+2+0]=N[F+3+64]=Je+ot+1>>1,N[F+3+0]=ot+gt+1>>1,N[F+0+96]=Rt(Pe,oe,q),N[F+0+64]=Rt(oe,q,Ve),N[F+0+32]=N[F+1+96]=Rt(q,Ve,qe),N[F+1+32]=N[F+2+96]=Rt(Ve,qe,Je),N[F+2+32]=N[F+3+96]=Rt(qe,Je,ot),N[F+3+32]=Rt(Je,ot,gt)}function wn(N,F){var q=N[F+0-32],oe=N[F+1-32],Pe=N[F+2-32],Ve=N[F+3-32],qe=N[F+4-32],Je=N[F+5-32],ot=N[F+6-32],gt=N[F+7-32];N[F+0+0]=q+oe+1>>1,N[F+1+0]=N[F+0+64]=oe+Pe+1>>1,N[F+2+0]=N[F+1+64]=Pe+Ve+1>>1,N[F+3+0]=N[F+2+64]=Ve+qe+1>>1,N[F+0+32]=Rt(q,oe,Pe),N[F+1+32]=N[F+0+96]=Rt(oe,Pe,Ve),N[F+2+32]=N[F+1+96]=Rt(Pe,Ve,qe),N[F+3+32]=N[F+2+96]=Rt(Ve,qe,Je),N[F+3+64]=Rt(qe,Je,ot),N[F+3+96]=Rt(Je,ot,gt)}function gn(N,F){var q=N[F-1+0],oe=N[F-1+32],Pe=N[F-1+64],Ve=N[F-1+96];N[F+0+0]=q+oe+1>>1,N[F+2+0]=N[F+0+32]=oe+Pe+1>>1,N[F+2+32]=N[F+0+64]=Pe+Ve+1>>1,N[F+1+0]=Rt(q,oe,Pe),N[F+3+0]=N[F+1+32]=Rt(oe,Pe,Ve),N[F+3+32]=N[F+1+64]=Rt(Pe,Ve,Ve),N[F+3+64]=N[F+2+64]=N[F+0+96]=N[F+1+96]=N[F+2+96]=N[F+3+96]=Ve}function ua(N,F){var q=N[F-1+0],oe=N[F-1+32],Pe=N[F-1+64],Ve=N[F-1+96],qe=N[F-1-32],Je=N[F+0-32],ot=N[F+1-32],gt=N[F+2-32];N[F+0+0]=N[F+2+32]=q+qe+1>>1,N[F+0+32]=N[F+2+64]=oe+q+1>>1,N[F+0+64]=N[F+2+96]=Pe+oe+1>>1,N[F+0+96]=Ve+Pe+1>>1,N[F+3+0]=Rt(Je,ot,gt),N[F+2+0]=Rt(qe,Je,ot),N[F+1+0]=N[F+3+32]=Rt(q,qe,Je),N[F+1+32]=N[F+3+64]=Rt(oe,q,qe),N[F+1+64]=N[F+3+96]=Rt(Pe,oe,q),N[F+1+96]=Rt(Ve,Pe,oe)}function xa(N,F){var q;for(q=0;8>q;++q)n(N,F+32*q,N,F-32,8)}function Ji(N,F){var q;for(q=0;8>q;++q)a(N,F,N[F-1],8),F+=32}function Zi(N,F,q){var oe;for(oe=0;8>oe;++oe)a(F,q+32*oe,N,8)}function Dl(N,F){var q,oe=8;for(q=0;8>q;++q)oe+=N[F+q-32]+N[F-1+32*q];Zi(oe>>4,N,F)}function va(N,F){var q,oe=4;for(q=0;8>q;++q)oe+=N[F+q-32];Zi(oe>>3,N,F)}function Qn(N,F){var q,oe=4;for(q=0;8>q;++q)oe+=N[F-1+32*q];Zi(oe>>3,N,F)}function hu(N,F){Zi(128,N,F)}function Rl(N,F,q){var oe=N[F-q],Pe=N[F+0],Ve=3*(Pe-oe)+P3[1020+N[F-2*q]-N[F+q]],qe=wN[112+(Ve+4>>3)];N[F-q]=xu[255+oe+wN[112+(Ve+3>>3)]],N[F+0]=xu[255+Pe-qe]}function eo(N,F,q,oe){var Pe=N[F+0],Ve=N[F+q];return Zu[255+N[F-2*q]-N[F-q]]>oe||Zu[255+Ve-Pe]>oe}function Uc(N,F,q,oe){return 4*Zu[255+N[F-q]-N[F+0]]+Zu[255+N[F-2*q]-N[F+q]]<=oe}function Qc(N,F,q,oe,Pe){var Ve=N[F-3*q],qe=N[F-2*q],Je=N[F-q],ot=N[F+0],gt=N[F+q],Dt=N[F+2*q],Jt=N[F+3*q];return 4*Zu[255+Je-ot]+Zu[255+qe-gt]>oe?0:Zu[255+N[F-4*q]-Ve]<=Pe&&Zu[255+Ve-qe]<=Pe&&Zu[255+qe-Je]<=Pe&&Zu[255+Jt-Dt]<=Pe&&Zu[255+Dt-gt]<=Pe&&Zu[255+gt-ot]<=Pe}function Ac(N,F,q,oe){var Pe=2*oe+1;for(oe=0;16>oe;++oe)Uc(N,F+oe,q,Pe)&&Rl(N,F+oe,q)}function ll(N,F,q,oe){var Pe=2*oe+1;for(oe=0;16>oe;++oe)Uc(N,F+oe*q,1,Pe)&&Rl(N,F+oe*q,1)}function Au(N,F,q,oe){var Pe;for(Pe=3;0<Pe;--Pe)Ac(N,F+=4*q,q,oe)}function zA(N,F,q,oe){var Pe;for(Pe=3;0<Pe;--Pe)ll(N,F+=4,q,oe)}function cl(N,F,q,oe,Pe,Ve,qe,Je){for(Ve=2*Ve+1;0<Pe--;){if(Qc(N,F,q,Ve,qe))if(eo(N,F,q,Je))Rl(N,F,q);else{var ot=N,gt=F,Dt=q,Jt=ot[gt-2*Dt],xt=ot[gt-Dt],Lt=ot[gt+0],Kt=ot[gt+Dt],fr=ot[gt+2*Dt],Xt=27*(gr=P3[1020+3*(Lt-xt)+P3[1020+Jt-Kt]])+63>>7,mr=18*gr+63>>7,gr=9*gr+63>>7;ot[gt-3*Dt]=xu[255+ot[gt-3*Dt]+gr],ot[gt-2*Dt]=xu[255+Jt+mr],ot[gt-Dt]=xu[255+xt+Xt],ot[gt+0]=xu[255+Lt-Xt],ot[gt+Dt]=xu[255+Kt-mr],ot[gt+2*Dt]=xu[255+fr-gr]}F+=oe}}function Vc(N,F,q,oe,Pe,Ve,qe,Je){for(Ve=2*Ve+1;0<Pe--;){if(Qc(N,F,q,Ve,qe))if(eo(N,F,q,Je))Rl(N,F,q);else{var ot=N,gt=F,Dt=q,Jt=ot[gt-Dt],xt=ot[gt+0],Lt=ot[gt+Dt],Kt=wN[112+(4+(fr=3*(xt-Jt))>>3)],fr=wN[112+(fr+3>>3)],Xt=Kt+1>>1;ot[gt-2*Dt]=xu[255+ot[gt-2*Dt]+Xt],ot[gt-Dt]=xu[255+Jt+fr],ot[gt+0]=xu[255+xt-Kt],ot[gt+Dt]=xu[255+Lt-Xt]}F+=oe}}function Ff(N,F,q,oe,Pe,Ve){cl(N,F,q,1,16,oe,Pe,Ve)}function Ao(N,F,q,oe,Pe,Ve){cl(N,F,1,q,16,oe,Pe,Ve)}function Wu(N,F,q,oe,Pe,Ve){var qe;for(qe=3;0<qe;--qe)Vc(N,F+=4*q,q,1,16,oe,Pe,Ve)}function M(N,F,q,oe,Pe,Ve){var qe;for(qe=3;0<qe;--qe)Vc(N,F+=4,1,q,16,oe,Pe,Ve)}function Ee(N,F,q,oe,Pe,Ve,qe,Je){cl(N,F,Pe,1,8,Ve,qe,Je),cl(q,oe,Pe,1,8,Ve,qe,Je)}function mt(N,F,q,oe,Pe,Ve,qe,Je){cl(N,F,1,Pe,8,Ve,qe,Je),cl(q,oe,1,Pe,8,Ve,qe,Je)}function jt(N,F,q,oe,Pe,Ve,qe,Je){Vc(N,F+4*Pe,Pe,1,8,Ve,qe,Je),Vc(q,oe+4*Pe,Pe,1,8,Ve,qe,Je)}function $t(N,F,q,oe,Pe,Ve,qe,Je){Vc(N,F+4,1,Pe,8,Ve,qe,Je),Vc(q,oe+4,1,Pe,8,Ve,qe,Je)}function Ar(){this.ba=new me,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new pt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Nr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function an(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function fn(){this.ua=0,this.Wa=new je,this.vb=new je,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new P}function Bn(){this.xb=this.a=0,this.l=new He,this.ca=new me,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new fn,this.ab=0,this.gc=o(4,an),this.Oc=0}function Vn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new He,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function da(N,F,q,oe,Pe,Ve,qe){for(N=N==null?0:N[F+0],F=0;F<qe;++F)Pe[Ve+F]=N+q[oe+F]&255,N=Pe[Ve+F]}function Oa(N,F,q,oe,Pe,Ve,qe){var Je;if(N==null)da(null,null,q,oe,Pe,Ve,qe);else for(Je=0;Je<qe;++Je)Pe[Ve+Je]=N[F+Je]+q[oe+Je]&255}function Zs(N,F,q,oe,Pe,Ve,qe){if(N==null)da(null,null,q,oe,Pe,Ve,qe);else{var Je,ot=N[F+0],gt=ot,Dt=ot;for(Je=0;Je<qe;++Je)gt=Dt+(ot=N[F+Je])-gt,Dt=q[oe+Je]+(-256&gt?0>gt?0:255:gt)&255,gt=ot,Pe[Ve+Je]=Dt}}function $a(N,F,q,oe){var Pe=F.width,Ve=F.o;if(e(N!=null&&F!=null),0>q||0>=oe||q+oe>Ve)return null;if(!N.Cc){if(N.ga==null){var qe;if(N.ga=new Vn,(qe=N.ga==null)||(qe=F.width*F.o,e(N.Gb.length==0),N.Gb=s(qe),N.Uc=0,N.Gb==null?qe=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,qe=1),qe=!qe),!qe){qe=N.ga;var Je=N.Fa,ot=N.P,gt=N.qc,Dt=N.mb,Jt=N.nb,xt=ot+1,Lt=gt-1,Kt=qe.l;if(e(Je!=null&&Dt!=null&&F!=null),n0[0]=null,n0[1]=da,n0[2]=Oa,n0[3]=Zs,qe.ca=Dt,qe.tb=Jt,qe.c=F.width,qe.i=F.height,e(0<qe.c&&0<qe.i),1>=gt)F=0;else if(qe.$a=3&Je[ot+0],qe.Z=Je[ot+0]>>2&3,qe.Lc=Je[ot+0]>>4&3,ot=Je[ot+0]>>6&3,0>qe.$a||1<qe.$a||4<=qe.Z||1<qe.Lc||ot)F=0;else if(Kt.put=ke,Kt.ac=Vt,Kt.bc=Ne,Kt.ma=qe,Kt.width=F.width,Kt.height=F.height,Kt.Da=F.Da,Kt.v=F.v,Kt.va=F.va,Kt.j=F.j,Kt.o=F.o,qe.$a)e:{e(qe.$a==1),F=$e();t:for(;;){if(F==null){F=0;break e}if(e(qe!=null),qe.mc=F,F.c=qe.c,F.i=qe.i,F.l=qe.l,F.l.ma=qe,F.l.width=qe.c,F.l.height=qe.i,F.a=0,ae(F.m,Je,xt,Lt),!ze(qe.c,qe.i,1,F,null)||(F.ab==1&&F.gc[0].hc==3&&V(F.s)?(qe.ic=1,Je=F.c*F.i,F.Ta=null,F.Ua=0,F.V=s(Je),F.Ba=0,F.V==null?(F.a=1,F=0):F=1):(qe.ic=0,F=Ke(F,qe.c)),!F))break t;F=1;break e}qe.mc=null,F=0}else F=Lt>=qe.c*qe.i;qe=!F}if(qe)return null;N.ga.Lc!=1?N.Ga=0:oe=Ve-q}e(N.ga!=null),e(q+oe<=Ve);e:{if(F=(Je=N.ga).c,Ve=Je.l.o,Je.$a==0){if(xt=N.rc,Lt=N.Vc,Kt=N.Fa,ot=N.P+1+q*F,gt=N.mb,Dt=N.nb+q*F,e(ot<=N.P+N.qc),Je.Z!=0)for(e(n0[Je.Z]!=null),qe=0;qe<oe;++qe)n0[Je.Z](xt,Lt,Kt,ot,gt,Dt,F),xt=gt,Lt=Dt,Dt+=F,ot+=F;else for(qe=0;qe<oe;++qe)n(gt,Dt,Kt,ot,F),xt=gt,Lt=Dt,Dt+=F,ot+=F;N.rc=xt,N.Vc=Lt}else{if(e(Je.mc!=null),F=q+oe,e((qe=Je.mc)!=null),e(F<=qe.i),qe.C>=F)F=1;else if(Je.ic||Hc(),Je.ic){Je=qe.V,xt=qe.Ba,Lt=qe.c;var fr=qe.i,Xt=(Kt=1,ot=qe.$/Lt,gt=qe.$%Lt,Dt=qe.m,Jt=qe.s,qe.$),mr=Lt*fr,gr=Lt*F,Br=Jt.wc,Er=Xt<gr?W(Jt,gt,ot):null;e(Xt<=mr),e(F<=fr),e(V(Jt));t:for(;;){for(;!Dt.h&&Xt<gr;){if(gt&Br||(Er=W(Jt,gt,ot)),e(Er!=null),Y(Dt),256>(fr=At(Er.G[0],Er.H[0],Dt)))Je[xt+Xt]=fr,++Xt,++gt>=Lt&&(gt=0,++ot<=F&&!(ot%16)&&fe(qe,ot));else{if(!(280>fr)){Kt=0;break t}fr=Le(fr-256,Dt);var yn,ln=At(Er.G[4],Er.H[4],Dt);if(Y(Dt),!(Xt>=(ln=ft(Lt,ln=Le(ln,Dt)))&&mr-Xt>=fr)){Kt=0;break t}for(yn=0;yn<fr;++yn)Je[xt+Xt+yn]=Je[xt+Xt+yn-ln];for(Xt+=fr,gt+=fr;gt>=Lt;)gt-=Lt,++ot<=F&&!(ot%16)&&fe(qe,ot);Xt<gr&&gt&Br&&(Er=W(Jt,gt,ot))}e(Dt.h==R(Dt))}fe(qe,ot>F?F:ot);break t}!Kt||Dt.h&&Xt<mr?(Kt=0,qe.a=Dt.h?5:3):qe.$=Xt,F=Kt}else F=Be(qe,qe.V,qe.Ba,qe.c,qe.i,F,yt);if(!F){oe=0;break e}}q+oe>=Ve&&(N.Cc=1),oe=1}if(!oe)return null;if(N.Cc&&((oe=N.ga)!=null&&(oe.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+q*Pe}function xi(N,F,q,oe,Pe,Ve){for(;0<Pe--;){var qe,Je=N,ot=F+(q?1:0),gt=N,Dt=F+(q?0:3);for(qe=0;qe<oe;++qe){var Jt=gt[Dt+4*qe];Jt!=255&&(Jt*=32897,Je[ot+4*qe+0]=Je[ot+4*qe+0]*Jt>>23,Je[ot+4*qe+1]=Je[ot+4*qe+1]*Jt>>23,Je[ot+4*qe+2]=Je[ot+4*qe+2]*Jt>>23)}F+=Ve}}function ei(N,F,q,oe,Pe){for(;0<oe--;){var Ve;for(Ve=0;Ve<q;++Ve){var qe=N[F+2*Ve+0],Je=15&(gt=N[F+2*Ve+1]),ot=4369*Je,gt=(240&gt|gt>>4)*ot>>16;N[F+2*Ve+0]=(240&qe|qe>>4)*ot>>16&240|(15&qe|qe<<4)*ot>>16>>4&15,N[F+2*Ve+1]=240&gt|Je}F+=Pe}}function vi(N,F,q,oe,Pe,Ve,qe,Je){var ot,gt,Dt=255;for(gt=0;gt<Pe;++gt){for(ot=0;ot<oe;++ot){var Jt=N[F+ot];Ve[qe+4*ot]=Jt,Dt&=Jt}F+=q,qe+=Je}return Dt!=255}function ti(N,F,q,oe,Pe){var Ve;for(Ve=0;Ve<Pe;++Ve)q[oe+Ve]=N[F+Ve]>>8}function Hc(){K1=xi,eL=ei,tL=vi,rL=ti}function Xu(N,F,q){E[N]=function(oe,Pe,Ve,qe,Je,ot,gt,Dt,Jt,xt,Lt,Kt,fr,Xt,mr,gr,Br){var Er,yn=Br-1>>1,ln=Je[ot+0]|gt[Dt+0]<<16,Yn=Jt[xt+0]|Lt[Kt+0]<<16;e(oe!=null);var An=3*ln+Yn+131074>>2;for(F(oe[Pe+0],255&An,An>>16,fr,Xt),Ve!=null&&(An=3*Yn+ln+131074>>2,F(Ve[qe+0],255&An,An>>16,mr,gr)),Er=1;Er<=yn;++Er){var ga=Je[ot+Er]|gt[Dt+Er]<<16,po=Jt[xt+Er]|Lt[Kt+Er]<<16,Jn=ln+ga+Yn+po+524296,mn=Jn+2*(ga+Yn)>>3;An=mn+ln>>1,ln=(Jn=Jn+2*(ln+po)>>3)+ga>>1,F(oe[Pe+2*Er-1],255&An,An>>16,fr,Xt+(2*Er-1)*q),F(oe[Pe+2*Er-0],255&ln,ln>>16,fr,Xt+(2*Er-0)*q),Ve!=null&&(An=Jn+Yn>>1,ln=mn+po>>1,F(Ve[qe+2*Er-1],255&An,An>>16,mr,gr+(2*Er-1)*q),F(Ve[qe+2*Er+0],255&ln,ln>>16,mr,gr+(2*Er+0)*q)),ln=ga,Yn=po}1&Br||(An=3*ln+Yn+131074>>2,F(oe[Pe+Br-1],255&An,An>>16,fr,Xt+(Br-1)*q),Ve!=null&&(An=3*Yn+ln+131074>>2,F(Ve[qe+Br-1],255&An,An>>16,mr,gr+(Br-1)*q)))}}function Yu(){ed[NN]=Tde,ed[CN]=hL,ed[lL]=Bde,ed[_N]=AL,ed[EN]=mL,ed[T3]=pL,ed[cL]=kde,ed[B3]=hL,ed[k3]=AL,ed[SN]=mL,ed[F3]=pL}function _(N){return N&-16384?0>N?0:255:N>>Fde}function J(N,F){return _((19077*N>>8)+(26149*F>>8)-14234)}function ve(N,F,q){return _((19077*N>>8)-(6419*F>>8)-(13320*q>>8)+8708)}function et(N,F){return _((19077*N>>8)+(33050*F>>8)-17685)}function Gt(N,F,q,oe,Pe){oe[Pe+0]=J(N,q),oe[Pe+1]=ve(N,F,q),oe[Pe+2]=et(N,F)}function rr(N,F,q,oe,Pe){oe[Pe+0]=et(N,F),oe[Pe+1]=ve(N,F,q),oe[Pe+2]=J(N,q)}function Mr(N,F,q,oe,Pe){var Ve=ve(N,F,q);F=Ve<<3&224|et(N,F)>>3,oe[Pe+0]=248&J(N,q)|Ve>>5,oe[Pe+1]=F}function pa(N,F,q,oe,Pe){var Ve=240&et(N,F)|15;oe[Pe+0]=240&J(N,q)|ve(N,F,q)>>4,oe[Pe+1]=Ve}function ri(N,F,q,oe,Pe){oe[Pe+0]=255,Gt(N,F,q,oe,Pe+1)}function aa(N,F,q,oe,Pe){rr(N,F,q,oe,Pe),oe[Pe+3]=255}function Ia(N,F,q,oe,Pe){Gt(N,F,q,oe,Pe),oe[Pe+3]=255}function vs(N,F,q){E[N]=function(oe,Pe,Ve,qe,Je,ot,gt,Dt,Jt){for(var xt=Dt+(-2&Jt)*q;Dt!=xt;)F(oe[Pe+0],Ve[qe+0],Je[ot+0],gt,Dt),F(oe[Pe+1],Ve[qe+0],Je[ot+0],gt,Dt+q),Pe+=2,++qe,++ot,Dt+=2*q;1&Jt&&F(oe[Pe+0],Ve[qe+0],Je[ot+0],gt,Dt)}}function mu(N,F,q){return q==0?N==0?F==0?6:5:F==0?4:0:q}function Ml(N,F,q,oe,Pe){switch(N>>>30){case 3:Ym(F,q,oe,Pe,0);break;case 2:Ju(F,q,oe,Pe);break;case 1:Qa(F,q,oe,Pe)}}function ul(N,F){var q,oe,Pe=F.M,Ve=F.Nb,qe=N.oc,Je=N.pc+40,ot=N.oc,gt=N.pc+584,Dt=N.oc,Jt=N.pc+600;for(q=0;16>q;++q)qe[Je+32*q-1]=129;for(q=0;8>q;++q)ot[gt+32*q-1]=129,Dt[Jt+32*q-1]=129;for(0<Pe?qe[Je-1-32]=ot[gt-1-32]=Dt[Jt-1-32]=129:(a(qe,Je-32-1,127,21),a(ot,gt-32-1,127,9),a(Dt,Jt-32-1,127,9)),oe=0;oe<N.za;++oe){var xt=F.ya[F.aa+oe];if(0<oe){for(q=-1;16>q;++q)n(qe,Je+32*q-4,qe,Je+32*q+12,4);for(q=-1;8>q;++q)n(ot,gt+32*q-4,ot,gt+32*q+4,4),n(Dt,Jt+32*q-4,Dt,Jt+32*q+4,4)}var Lt=N.Gd,Kt=N.Hd+oe,fr=xt.ad,Xt=xt.Hc;if(0<Pe&&(n(qe,Je-32,Lt[Kt].y,0,16),n(ot,gt-32,Lt[Kt].f,0,8),n(Dt,Jt-32,Lt[Kt].ea,0,8)),xt.Za){var mr=qe,gr=Je-32+16;for(0<Pe&&(oe>=N.za-1?a(mr,gr,Lt[Kt].y[15],4):n(mr,gr,Lt[Kt+1].y,0,4)),q=0;4>q;q++)mr[gr+128+q]=mr[gr+256+q]=mr[gr+384+q]=mr[gr+0+q];for(q=0;16>q;++q,Xt<<=2)mr=qe,gr=Je+xL[q],Kd[xt.Ob[q]](mr,gr),Ml(Xt,fr,16*+q,mr,gr)}else if(mr=mu(oe,Pe,xt.Ob[0]),r0[mr](qe,Je),Xt!=0)for(q=0;16>q;++q,Xt<<=2)Ml(Xt,fr,16*+q,qe,Je+xL[q]);for(q=xt.Gc,mr=mu(oe,Pe,xt.Dd),Ch[mr](ot,gt),Ch[mr](Dt,Jt),Xt=fr,mr=ot,gr=gt,255&(xt=0|q)&&(170&xt?Rf(Xt,256,mr,gr):fs(Xt,256,mr,gr)),xt=Dt,Xt=Jt,255&(q>>=8)&&(170&q?Rf(fr,320,xt,Xt):fs(fr,320,xt,Xt)),Pe<N.Ub-1&&(n(Lt[Kt].y,0,qe,Je+480,16),n(Lt[Kt].f,0,ot,gt+224,8),n(Lt[Kt].ea,0,Dt,Jt+224,8)),q=8*Ve*N.B,Lt=N.sa,Kt=N.ta+16*oe+16*Ve*N.R,fr=N.qa,xt=N.ra+8*oe+q,Xt=N.Ha,mr=N.Ia+8*oe+q,q=0;16>q;++q)n(Lt,Kt+q*N.R,qe,Je+32*q,16);for(q=0;8>q;++q)n(fr,xt+q*N.B,ot,gt+32*q,8),n(Xt,mr+q*N.B,Dt,Jt+32*q,8)}}function Gd(N,F,q,oe,Pe,Ve,qe,Je,ot){var gt=[0],Dt=[0],Jt=0,xt=ot!=null?ot.kd:0,Lt=ot??new Nr;if(N==null||12>q)return 7;Lt.data=N,Lt.w=F,Lt.ha=q,F=[F],q=[q],Lt.gb=[Lt.gb];e:{var Kt=F,fr=q,Xt=Lt.gb;if(e(N!=null),e(fr!=null),e(Xt!=null),Xt[0]=0,12<=fr[0]&&!r(N,Kt[0],"RIFF")){if(r(N,Kt[0]+8,"WEBP")){Xt=3;break e}var mr=se(N,Kt[0]+4);if(12>mr||4294967286<mr){Xt=3;break e}if(xt&&mr>fr[0]-8){Xt=7;break e}Xt[0]=mr,Kt[0]+=12,fr[0]-=12}Xt=0}if(Xt!=0)return Xt;for(mr=0<Lt.gb[0],q=q[0];;){e:{var gr=N;fr=F,Xt=q;var Br=gt,Er=Dt,yn=Kt=[0];if((An=Jt=[Jt])[0]=0,8>Xt[0])Xt=7;else{if(!r(gr,fr[0],"VP8X")){if(se(gr,fr[0]+4)!=10){Xt=3;break e}if(18>Xt[0]){Xt=7;break e}var ln=se(gr,fr[0]+8),Yn=1+Xe(gr,fr[0]+12);if(2147483648<=Yn*(gr=1+Xe(gr,fr[0]+15))){Xt=3;break e}yn!=null&&(yn[0]=ln),Br!=null&&(Br[0]=Yn),Er!=null&&(Er[0]=gr),fr[0]+=18,Xt[0]-=18,An[0]=1}Xt=0}}if(Jt=Jt[0],Kt=Kt[0],Xt!=0)return Xt;if(fr=!!(2&Kt),!mr&&Jt)return 3;if(Ve!=null&&(Ve[0]=!!(16&Kt)),qe!=null&&(qe[0]=fr),Je!=null&&(Je[0]=0),qe=gt[0],Kt=Dt[0],Jt&&fr&&ot==null){Xt=0;break}if(4>q){Xt=7;break}if(mr&&Jt||!mr&&!Jt&&!r(N,F[0],"ALPH")){q=[q],Lt.na=[Lt.na],Lt.P=[Lt.P],Lt.Sa=[Lt.Sa];e:{ln=N,Xt=F,mr=q;var An=Lt.gb;Br=Lt.na,Er=Lt.P,yn=Lt.Sa,Yn=22,e(ln!=null),e(mr!=null),gr=Xt[0];var ga=mr[0];for(e(Br!=null),e(yn!=null),Br[0]=null,Er[0]=null,yn[0]=0;;){if(Xt[0]=gr,mr[0]=ga,8>ga){Xt=7;break e}var po=se(ln,gr+4);if(4294967286<po){Xt=3;break e}var Jn=8+po+1&-2;if(Yn+=Jn,0<An&&Yn>An){Xt=3;break e}if(!r(ln,gr,"VP8 ")||!r(ln,gr,"VP8L")){Xt=0;break e}if(ga[0]<Jn){Xt=7;break e}r(ln,gr,"ALPH")||(Br[0]=ln,Er[0]=gr+8,yn[0]=po),gr+=Jn,ga-=Jn}}if(q=q[0],Lt.na=Lt.na[0],Lt.P=Lt.P[0],Lt.Sa=Lt.Sa[0],Xt!=0)break}q=[q],Lt.Ja=[Lt.Ja],Lt.xa=[Lt.xa];e:if(An=N,Xt=F,mr=q,Br=Lt.gb[0],Er=Lt.Ja,yn=Lt.xa,ln=Xt[0],gr=!r(An,ln,"VP8 "),Yn=!r(An,ln,"VP8L"),e(An!=null),e(mr!=null),e(Er!=null),e(yn!=null),8>mr[0])Xt=7;else{if(gr||Yn){if(An=se(An,ln+4),12<=Br&&An>Br-12){Xt=3;break e}if(xt&&An>mr[0]-8){Xt=7;break e}Er[0]=An,Xt[0]+=8,mr[0]-=8,yn[0]=Yn}else yn[0]=5<=mr[0]&&An[ln+0]==47&&!(An[ln+4]>>5),Er[0]=mr[0];Xt=0}if(q=q[0],Lt.Ja=Lt.Ja[0],Lt.xa=Lt.xa[0],F=F[0],Xt!=0)break;if(4294967286<Lt.Ja)return 3;if(Je==null||fr||(Je[0]=Lt.xa?2:1),qe=[qe],Kt=[Kt],Lt.xa){if(5>q){Xt=7;break}Je=qe,xt=Kt,fr=Ve,N==null||5>q?N=0:5<=q&&N[F+0]==47&&!(N[F+4]>>5)?(mr=[0],An=[0],Br=[0],ae(Er=new H,N,F,q),pe(Er,mr,An,Br)?(Je!=null&&(Je[0]=mr[0]),xt!=null&&(xt[0]=An[0]),fr!=null&&(fr[0]=Br[0]),N=1):N=0):N=0}else{if(10>q){Xt=7;break}Je=Kt,N==null||10>q||!dn(N,F+3,q-3)?N=0:(xt=N[F+0]|N[F+1]<<8|N[F+2]<<16,fr=16383&(N[F+7]<<8|N[F+6]),N=16383&(N[F+9]<<8|N[F+8]),1&xt||3<(xt>>1&7)||!(xt>>4&1)||xt>>5>=Lt.Ja||!fr||!N?N=0:(qe&&(qe[0]=fr),Je&&(Je[0]=N),N=1))}if(!N||(qe=qe[0],Kt=Kt[0],Jt&&(gt[0]!=qe||Dt[0]!=Kt)))return 3;ot!=null&&(ot[0]=Lt,ot.offset=F-ot.w,e(4294967286>F-ot.w),e(ot.offset==ot.ha-q));break}return Xt==0||Xt==7&&Jt&&ot==null?(Ve!=null&&(Ve[0]|=Lt.na!=null&&0<Lt.na.length),oe!=null&&(oe[0]=qe),Pe!=null&&(Pe[0]=Kt),0):Xt}function M1(N,F,q){var oe=F.width,Pe=F.height,Ve=0,qe=0,Je=oe,ot=Pe;if(F.Da=N!=null&&0<N.Da,F.Da&&(Je=N.cd,ot=N.bd,Ve=N.v,qe=N.j,11>q||(Ve&=-2,qe&=-2),0>Ve||0>qe||0>=Je||0>=ot||Ve+Je>oe||qe+ot>Pe))return 0;if(F.v=Ve,F.j=qe,F.va=Ve+Je,F.o=qe+ot,F.U=Je,F.T=ot,F.da=N!=null&&0<N.da,F.da){if(!Se(Je,ot,q=[N.ib],Ve=[N.hb]))return 0;F.ib=q[0],F.hb=Ve[0]}return F.ob=N!=null&&N.ob,F.Kb=N==null||!N.Sd,F.da&&(F.ob=F.ib<3*oe/4&&F.hb<3*Pe/4,F.Kb=0),1}function L1(N){if(N==null)return 2;if(11>N.S){var F=N.f.RGBA;F.fb+=(N.height-1)*F.A,F.A=-F.A}else F=N.f.kb,N=N.height,F.O+=(N-1)*F.fa,F.fa=-F.fa,F.N+=(N-1>>1)*F.Ab,F.Ab=-F.Ab,F.W+=(N-1>>1)*F.Db,F.Db=-F.Db,F.F!=null&&(F.J+=(N-1)*F.lb,F.lb=-F.lb);return 0}function WA(N,F,q,oe){if(oe==null||0>=N||0>=F)return 2;if(q!=null){if(q.Da){var Pe=q.cd,Ve=q.bd,qe=-2&q.v,Je=-2&q.j;if(0>qe||0>Je||0>=Pe||0>=Ve||qe+Pe>N||Je+Ve>F)return 2;N=Pe,F=Ve}if(q.da){if(!Se(N,F,Pe=[q.ib],Ve=[q.hb]))return 2;N=Pe[0],F=Ve[0]}}oe.width=N,oe.height=F;e:{var ot=oe.width,gt=oe.height;if(N=oe.S,0>=ot||0>=gt||!(N>=NN&&13>N))N=2;else{if(0>=oe.Rd&&oe.sd==null){qe=Ve=Pe=F=0;var Dt=(Je=ot*vL[N])*gt;if(11>N||(Ve=(gt+1)/2*(F=(ot+1)/2),N==12&&(qe=(Pe=ot)*gt)),(gt=s(Dt+2*Ve+qe))==null){N=1;break e}oe.sd=gt,11>N?((ot=oe.f.RGBA).eb=gt,ot.fb=0,ot.A=Je,ot.size=Dt):((ot=oe.f.kb).y=gt,ot.O=0,ot.fa=Je,ot.Fd=Dt,ot.f=gt,ot.N=0+Dt,ot.Ab=F,ot.Cd=Ve,ot.ea=gt,ot.W=0+Dt+Ve,ot.Db=F,ot.Ed=Ve,N==12&&(ot.F=gt,ot.J=0+Dt+2*Ve),ot.Tc=qe,ot.lb=Pe)}if(F=1,Pe=oe.S,Ve=oe.width,qe=oe.height,Pe>=NN&&13>Pe)if(11>Pe)N=oe.f.RGBA,F&=(Je=Math.abs(N.A))*(qe-1)+Ve<=N.size,F&=Je>=Ve*vL[Pe],F&=N.eb!=null;else{N=oe.f.kb,Je=(Ve+1)/2,Dt=(qe+1)/2,ot=Math.abs(N.fa),gt=Math.abs(N.Ab);var Jt=Math.abs(N.Db),xt=Math.abs(N.lb),Lt=xt*(qe-1)+Ve;F&=ot*(qe-1)+Ve<=N.Fd,F&=gt*(Dt-1)+Je<=N.Cd,F=(F&=Jt*(Dt-1)+Je<=N.Ed)&ot>=Ve&gt>=Je&Jt>=Je,F&=N.y!=null,F&=N.f!=null,F&=N.ea!=null,Pe==12&&(F&=xt>=Ve,F&=Lt<=N.Tc,F&=N.F!=null)}else F=0;N=F?0:2}}return N!=0||q!=null&&q.fd&&(N=L1(oe)),N}var Wm=64,pu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],gu=24,XA=32,wh=8,YA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Et("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(N){return N},E.Predictor2=function(N,F,q){return F[q+0]},E.Predictor3=function(N,F,q){return F[q+1]},E.Predictor4=function(N,F,q){return F[q-1]},E.Predictor5=function(N,F,q){return Ft(Ft(N,F[q+1]),F[q+0])},E.Predictor6=function(N,F,q){return Ft(N,F[q-1])},E.Predictor7=function(N,F,q){return Ft(N,F[q+0])},E.Predictor8=function(N,F,q){return Ft(F[q-1],F[q+0])},E.Predictor9=function(N,F,q){return Ft(F[q+0],F[q+1])},E.Predictor10=function(N,F,q){return Ft(Ft(N,F[q-1]),Ft(F[q+0],F[q+1]))},E.Predictor11=function(N,F,q){var oe=F[q+0];return 0>=Tt(oe>>24&255,N>>24&255,(F=F[q-1])>>24&255)+Tt(oe>>16&255,N>>16&255,F>>16&255)+Tt(oe>>8&255,N>>8&255,F>>8&255)+Tt(255&oe,255&N,255&F)?oe:N},E.Predictor12=function(N,F,q){var oe=F[q+0];return(Qt((N>>24&255)+(oe>>24&255)-((F=F[q-1])>>24&255))<<24|Qt((N>>16&255)+(oe>>16&255)-(F>>16&255))<<16|Qt((N>>8&255)+(oe>>8&255)-(F>>8&255))<<8|Qt((255&N)+(255&oe)-(255&F)))>>>0},E.Predictor13=function(N,F,q){var oe=F[q-1];return(Ut((N=Ft(N,F[q+0]))>>24&255,oe>>24&255)<<24|Ut(N>>16&255,oe>>16&255)<<16|Ut(N>>8&255,oe>>8&255)<<8|Ut(255&N,255&oe))>>>0};var U1=E.PredictorAdd0;E.PredictorAdd1=Re,Et("Predictor2","PredictorAdd2"),Et("Predictor3","PredictorAdd3"),Et("Predictor4","PredictorAdd4"),Et("Predictor5","PredictorAdd5"),Et("Predictor6","PredictorAdd6"),Et("Predictor7","PredictorAdd7"),Et("Predictor8","PredictorAdd8"),Et("Predictor9","PredictorAdd9"),Et("Predictor10","PredictorAdd10"),Et("Predictor11","PredictorAdd11"),Et("Predictor12","PredictorAdd12"),Et("Predictor13","PredictorAdd13");var Jg=E.PredictorAdd2;Oe("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),Oe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Bi,yN=E.ColorIndexInverseTransform,Of=E.MapARGB,Df=E.VP8LColorIndexInverseTransformAlpha,Q1=E.MapAlpha,V1=E.VP8LPredictorsAdd=[];V1.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var H1,$1,JA,ZA,e0,Xm,t0,Ym,Ju,Rf,Qa,fs,ki,mo,Nh,G1,Zg,bN,z8,W8,X8,Y8,J8,Z8,K1,eL,tL,rL,nL=s(511),aL=s(2041),sL=s(225),iL=s(767),oL=0,P3=aL,wN=sL,xu=iL,Zu=nL,NN=0,CN=1,lL=2,_N=3,EN=4,T3=5,cL=6,B3=7,k3=8,SN=9,F3=10,gde=[2,3,7],xde=[3,3,11],uL=[280,256,256,256,40],vde=[0,1,1,1,0],yde=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],bde=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],wde=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Nde=8,O3=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],D3=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],q1=null,Cde=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],_de=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],dL=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ede=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Sde=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],jde=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ide=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],r0=[],Kd=[],Ch=[],Pde=1,fL=2,n0=[],ed=[];Xu("UpsampleRgbLinePair",Gt,3),Xu("UpsampleBgrLinePair",rr,3),Xu("UpsampleRgbaLinePair",Ia,4),Xu("UpsampleBgraLinePair",aa,4),Xu("UpsampleArgbLinePair",ri,4),Xu("UpsampleRgba4444LinePair",pa,2),Xu("UpsampleRgb565LinePair",Mr,2);var Tde=E.UpsampleRgbLinePair,Bde=E.UpsampleBgrLinePair,hL=E.UpsampleRgbaLinePair,AL=E.UpsampleBgraLinePair,mL=E.UpsampleArgbLinePair,pL=E.UpsampleRgba4444LinePair,kde=E.UpsampleRgb565LinePair,jN=16,IN=1<<jN-1,z1=-227,R3=482,Fde=6,gL=0,Ode=s(256),Dde=s(256),Rde=s(256),Mde=s(256),Lde=s(R3-z1),Ude=s(R3-z1);vs("YuvToRgbRow",Gt,3),vs("YuvToBgrRow",rr,3),vs("YuvToRgbaRow",Ia,4),vs("YuvToBgraRow",aa,4),vs("YuvToArgbRow",ri,4),vs("YuvToRgba4444Row",pa,2),vs("YuvToRgb565Row",Mr,2);var xL=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],PN=[0,2,8],Qde=[8,7,6,4,4,2,2,2,1,1,1,1],Vde=1;this.WebPDecodeRGBA=function(N,F,q,oe,Pe){var Ve=CN,qe=new Ar,Je=new me;qe.ba=Je,Je.S=Ve,Je.width=[Je.width],Je.height=[Je.height];var ot=Je.width,gt=Je.height,Dt=new we;if(Dt==null||N==null)var Jt=2;else e(Dt!=null),Jt=Gd(N,F,q,Dt.width,Dt.height,Dt.Pd,Dt.Qd,Dt.format,null);if(Jt!=0?ot=0:(ot!=null&&(ot[0]=Dt.width[0]),gt!=null&&(gt[0]=Dt.height[0]),ot=1),ot){Je.width=Je.width[0],Je.height=Je.height[0],oe!=null&&(oe[0]=Je.width),Pe!=null&&(Pe[0]=Je.height);e:{if(oe=new He,(Pe=new Nr).data=N,Pe.w=F,Pe.ha=q,Pe.kd=1,F=[0],e(Pe!=null),((N=Gd(Pe.data,Pe.w,Pe.ha,null,null,null,F,null,Pe))==0||N==7)&&F[0]&&(N=4),(F=N)==0){if(e(qe!=null),oe.data=Pe.data,oe.w=Pe.w+Pe.offset,oe.ha=Pe.ha-Pe.offset,oe.put=ke,oe.ac=Vt,oe.bc=Ne,oe.ma=qe,Pe.xa){if((N=$e())==null){qe=1;break e}if(function(xt,Lt){var Kt=[0],fr=[0],Xt=[0];t:for(;;){if(xt==null)return 0;if(Lt==null)return xt.a=2,0;if(xt.l=Lt,xt.a=0,ae(xt.m,Lt.data,Lt.w,Lt.ha),!pe(xt.m,Kt,fr,Xt)){xt.a=3;break t}if(xt.xb=fL,Lt.width=Kt[0],Lt.height=fr[0],!ze(Kt[0],fr[0],1,xt,null))break t;return 1}return e(xt.a!=0),0}(N,oe)){if(oe=(F=WA(oe.width,oe.height,qe.Oa,qe.ba))==0){t:{oe=N;r:for(;;){if(oe==null){oe=0;break t}if(e(oe.s.yc!=null),e(oe.s.Ya!=null),e(0<oe.s.Wb),e((q=oe.l)!=null),e((Pe=q.ma)!=null),oe.xb!=0){if(oe.ca=Pe.ba,oe.tb=Pe.tb,e(oe.ca!=null),!M1(Pe.Oa,q,_N)){oe.a=2;break r}if(!Ke(oe,q.width)||q.da)break r;if((q.da||xe(oe.ca.S))&&Hc(),11>oe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),oe.ca.f.kb.F!=null&&Hc()),oe.Pb&&0<oe.s.ua&&oe.s.vb.X==null&&!ee(oe.s.vb,oe.s.Wa.Xa)){oe.a=1;break r}oe.xb=0}if(!Be(oe,oe.V,oe.Ba,oe.c,oe.i,q.o,re))break r;Pe.Dc=oe.Ma,oe=1;break t}e(oe.a!=0),oe=0}oe=!oe}oe&&(F=N.a)}else F=N.a}else{if((N=new Bt)==null){qe=1;break e}if(N.Fa=Pe.na,N.P=Pe.P,N.qc=Pe.Sa,Jr(N,oe)){if((F=WA(oe.width,oe.height,qe.Oa,qe.ba))==0){if(N.Aa=0,q=qe.Oa,e((Pe=N)!=null),q!=null){if(0<(ot=0>(ot=q.Md)?0:100<ot?255:255*ot/100)){for(gt=Dt=0;4>gt;++gt)12>(Jt=Pe.pb[gt]).lc&&(Jt.ia=ot*Qde[0>Jt.lc?0:Jt.lc]>>3),Dt|=Jt.ia;Dt&&(alert("todo:VP8InitRandom"),Pe.ia=1)}Pe.Ga=q.Id,100<Pe.Ga?Pe.Ga=100:0>Pe.Ga&&(Pe.Ga=0)}(function(xt,Lt){if(xt==null)return 0;if(Lt==null)return xr(xt,2,"NULL VP8Io parameter in VP8Decode().");if(!xt.cb&&!Jr(xt,Lt))return 0;if(e(xt.cb),Lt.ac==null||Lt.ac(Lt)){Lt.ob&&(xt.L=0);var Kt=PN[xt.L];if(xt.L==2?(xt.yb=0,xt.zb=0):(xt.yb=Lt.v-Kt>>4,xt.zb=Lt.j-Kt>>4,0>xt.yb&&(xt.yb=0),0>xt.zb&&(xt.zb=0)),xt.Va=Lt.o+15+Kt>>4,xt.Hb=Lt.va+15+Kt>>4,xt.Hb>xt.za&&(xt.Hb=xt.za),xt.Va>xt.Ub&&(xt.Va=xt.Ub),0<xt.L){var fr=xt.ed;for(Kt=0;4>Kt;++Kt){var Xt;if(xt.Qa.Cb){var mr=xt.Qa.Lb[Kt];xt.Qa.Fb||(mr+=fr.Tb)}else mr=fr.Tb;for(Xt=0;1>=Xt;++Xt){var gr=xt.gd[Kt][Xt],Br=mr;if(fr.Pc&&(Br+=fr.vd[0],Xt&&(Br+=fr.od[0])),0<(Br=0>Br?0:63<Br?63:Br)){var Er=Br;0<fr.wb&&(Er=4<fr.wb?Er>>2:Er>>1)>9-fr.wb&&(Er=9-fr.wb),1>Er&&(Er=1),gr.dd=Er,gr.tc=2*Br+Er,gr.ld=40<=Br?2:15<=Br?1:0}else gr.tc=0;gr.La=Xt}}}Kt=0}else xr(xt,6,"Frame setup failed"),Kt=xt.a;if(Kt=Kt==0){if(Kt){xt.$c=0,0<xt.Aa||(xt.Ic=Vde);t:{Kt=xt.Ic,fr=4*(Er=xt.za);var yn=32*Er,ln=Er+1,Yn=0<xt.L?Er*(0<xt.Aa?2:1):0,An=(xt.Aa==2?2:1)*Er;if((gr=fr+832+(Xt=3*(16*Kt+PN[xt.L])/2*yn)+(mr=xt.Fa!=null&&0<xt.Fa.length?xt.Kc.c*xt.Kc.i:0))!=gr)Kt=0;else{if(gr>xt.Vb){if(xt.Vb=0,xt.Ec=s(gr),xt.Fc=0,xt.Ec==null){Kt=xr(xt,1,"no memory during frame initialization.");break t}xt.Vb=gr}gr=xt.Ec,Br=xt.Fc,xt.Ac=gr,xt.Bc=Br,Br+=fr,xt.Gd=o(yn,Zr),xt.Hd=0,xt.rb=o(ln+1,Ir),xt.sb=1,xt.wa=Yn?o(Yn,nr):null,xt.Y=0,xt.D.Nb=0,xt.D.wa=xt.wa,xt.D.Y=xt.Y,0<xt.Aa&&(xt.D.Y+=Er),e(!0),xt.oc=gr,xt.pc=Br,Br+=832,xt.ya=o(An,or),xt.aa=0,xt.D.ya=xt.ya,xt.D.aa=xt.aa,xt.Aa==2&&(xt.D.aa+=Er),xt.R=16*Er,xt.B=8*Er,Er=(yn=PN[xt.L])*xt.R,yn=yn/2*xt.B,xt.sa=gr,xt.ta=Br+Er,xt.qa=xt.sa,xt.ra=xt.ta+16*Kt*xt.R+yn,xt.Ha=xt.qa,xt.Ia=xt.ra+8*Kt*xt.B+yn,xt.$c=0,Br+=Xt,xt.mb=mr?gr:null,xt.nb=mr?Br:null,e(Br+mr<=xt.Fc+xt.Vb),er(xt),a(xt.Ac,xt.Bc,0,fr),Kt=1}}if(Kt){if(Lt.ka=0,Lt.y=xt.sa,Lt.O=xt.ta,Lt.f=xt.qa,Lt.N=xt.ra,Lt.ea=xt.Ha,Lt.Vd=xt.Ia,Lt.fa=xt.R,Lt.Rc=xt.B,Lt.F=null,Lt.J=0,!oL){for(Kt=-255;255>=Kt;++Kt)nL[255+Kt]=0>Kt?-Kt:Kt;for(Kt=-1020;1020>=Kt;++Kt)aL[1020+Kt]=-128>Kt?-128:127<Kt?127:Kt;for(Kt=-112;112>=Kt;++Kt)sL[112+Kt]=-16>Kt?-16:15<Kt?15:Kt;for(Kt=-255;510>=Kt;++Kt)iL[255+Kt]=0>Kt?0:255<Kt?255:Kt;oL=1}t0=ge,Ym=he,Rf=tt,Qa=nt,fs=lt,Ju=jn,ki=Ff,mo=Ao,Nh=Ee,G1=mt,Zg=Wu,bN=M,z8=jt,W8=$t,X8=Ac,Y8=ll,J8=Au,Z8=zA,Kd[0]=jr,Kd[1]=Pt,Kd[2]=Wr,Kd[3]=Vr,Kd[4]=pr,Kd[5]=Tn,Kd[6]=Pr,Kd[7]=wn,Kd[8]=ua,Kd[9]=gn,r0[0]=zt,r0[1]=Nt,r0[2]=It,r0[3]=qt,r0[4]=ar,r0[5]=wr,r0[6]=dr,Ch[0]=Dl,Ch[1]=wt,Ch[2]=xa,Ch[3]=Ji,Ch[4]=Qn,Ch[5]=va,Ch[6]=hu,Kt=1}else Kt=0}Kt&&(Kt=function(ga,po){for(ga.M=0;ga.M<ga.Va;++ga.M){var Jn,mn=ga.Jc[ga.M&ga.Xb],zr=ga.m,Fi=ga;for(Jn=0;Jn<Fi.za;++Jn){var Kn=zr,ya=Fi,Ss=ya.Ac,dl=ya.Bc+4*Jn,mc=ya.zc,yi=ya.ya[ya.aa+Jn];if(ya.Qa.Bb?yi.$b=te(Kn,ya.Pa.jb[0])?2+te(Kn,ya.Pa.jb[2]):te(Kn,ya.Pa.jb[1]):yi.$b=0,ya.kc&&(yi.Ad=te(Kn,ya.Bd)),yi.Za=!te(Kn,145)+0,yi.Za){var Ll=yi.Ob,pc=0;for(ya=0;4>ya;++ya){var go,Ca=mc[0+ya];for(go=0;4>go;++go){Ca=Sde[Ss[dl+go]][Ca];for(var Ga=dL[te(Kn,Ca[0])];0<Ga;)Ga=dL[2*Ga+te(Kn,Ca[Ga])];Ca=-Ga,Ss[dl+go]=Ca}n(Ll,pc,Ss,dl,4),pc+=4,mc[0+ya]=Ca}}else Ca=te(Kn,156)?te(Kn,128)?1:3:te(Kn,163)?2:0,yi.Ob[0]=Ca,a(Ss,dl,Ca,4),a(mc,0,Ca,4);yi.Dd=te(Kn,142)?te(Kn,114)?te(Kn,183)?1:3:2:0}if(Fi.m.Ka)return xr(ga,7,"Premature end-of-partition0 encountered.");for(;ga.ja<ga.za;++ga.ja){if(Fi=mn,Kn=(zr=ga).rb[zr.sb-1],Ss=zr.rb[zr.sb+zr.ja],Jn=zr.ya[zr.aa+zr.ja],dl=zr.kc?Jn.Ad:0)Kn.la=Ss.la=0,Jn.Za||(Kn.Na=Ss.Na=0),Jn.Hc=0,Jn.Gc=0,Jn.ia=0;else{var bi,Ka;if(Kn=Ss,Ss=Fi,dl=zr.Pa.Xc,mc=zr.ya[zr.aa+zr.ja],yi=zr.pb[mc.$b],ya=mc.ad,Ll=0,pc=zr.rb[zr.sb-1],Ca=go=0,a(ya,Ll,0,384),mc.Za)var fl=0,qd=dl[3];else{Ga=s(16);var Oi=Kn.Na+pc.Na;if(Oi=q1(Ss,dl[1],Oi,yi.Eb,0,Ga,0),Kn.Na=pc.Na=(0<Oi)+0,1<Oi)t0(Ga,0,ya,Ll);else{var $c=Ga[0]+3>>3;for(Ga=0;256>Ga;Ga+=16)ya[Ll+Ga]=$c}fl=1,qd=dl[0]}var hs=15&Kn.la,xo=15&pc.la;for(Ga=0;4>Ga;++Ga){var vu=1&xo;for($c=Ka=0;4>$c;++$c)hs=hs>>1|(vu=(Oi=q1(Ss,qd,Oi=vu+(1&hs),yi.Sc,fl,ya,Ll))>fl)<<7,Ka=Ka<<2|(3<Oi?3:1<Oi?2:ya[Ll+0]!=0),Ll+=16;hs>>=4,xo=xo>>1|vu<<7,go=(go<<8|Ka)>>>0}for(qd=hs,fl=xo>>4,bi=0;4>bi;bi+=2){for(Ka=0,hs=Kn.la>>4+bi,xo=pc.la>>4+bi,Ga=0;2>Ga;++Ga){for(vu=1&xo,$c=0;2>$c;++$c)Oi=vu+(1&hs),hs=hs>>1|(vu=0<(Oi=q1(Ss,dl[2],Oi,yi.Qc,0,ya,Ll)))<<3,Ka=Ka<<2|(3<Oi?3:1<Oi?2:ya[Ll+0]!=0),Ll+=16;hs>>=2,xo=xo>>1|vu<<5}Ca|=Ka<<4*bi,qd|=hs<<4<<bi,fl|=(240&xo)<<bi}Kn.la=qd,pc.la=fl,mc.Hc=go,mc.Gc=Ca,mc.ia=43690&Ca?0:yi.ia,dl=!(go|Ca)}if(0<zr.L&&(zr.wa[zr.Y+zr.ja]=zr.gd[Jn.$b][Jn.Za],zr.wa[zr.Y+zr.ja].La|=!dl),Fi.Ka)return xr(ga,7,"Premature end-of-file encountered.")}if(er(ga),zr=po,Fi=1,Jn=(mn=ga).D,Kn=0<mn.L&&mn.M>=mn.zb&&mn.M<=mn.Va,mn.Aa==0)t:{if(Jn.M=mn.M,Jn.uc=Kn,ul(mn,Jn),Fi=1,Jn=(Ka=mn.D).Nb,Kn=(Ca=PN[mn.L])*mn.R,Ss=Ca/2*mn.B,Ga=16*Jn*mn.R,$c=8*Jn*mn.B,dl=mn.sa,mc=mn.ta-Kn+Ga,yi=mn.qa,ya=mn.ra-Ss+$c,Ll=mn.Ha,pc=mn.Ia-Ss+$c,xo=(hs=Ka.M)==0,go=hs>=mn.Va-1,mn.Aa==2&&ul(mn,Ka),Ka.uc)for(vu=(Oi=mn).D.M,e(Oi.D.uc),Ka=Oi.yb;Ka<Oi.Hb;++Ka){fl=Ka,qd=vu;var gc=(yu=(hl=Oi).D).Nb;bi=hl.R;var yu=yu.wa[yu.Y+fl],bu=hl.sa,Gc=hl.ta+16*gc*bi+16*fl,wu=yu.dd,ys=yu.tc;if(ys!=0)if(e(3<=ys),hl.L==1)0<fl&&Y8(bu,Gc,bi,ys+4),yu.La&&Z8(bu,Gc,bi,ys),0<qd&&X8(bu,Gc,bi,ys+4),yu.La&&J8(bu,Gc,bi,ys);else{var Nu=hl.B,zd=hl.qa,Jm=hl.ra+8*gc*Nu+8*fl,_h=hl.Ha,hl=hl.Ia+8*gc*Nu+8*fl;gc=yu.ld,0<fl&&(mo(bu,Gc,bi,ys+4,wu,gc),G1(zd,Jm,_h,hl,Nu,ys+4,wu,gc)),yu.La&&(bN(bu,Gc,bi,ys,wu,gc),W8(zd,Jm,_h,hl,Nu,ys,wu,gc)),0<qd&&(ki(bu,Gc,bi,ys+4,wu,gc),Nh(zd,Jm,_h,hl,Nu,ys+4,wu,gc)),yu.La&&(Zg(bu,Gc,bi,ys,wu,gc),z8(zd,Jm,_h,hl,Nu,ys,wu,gc))}}if(mn.ia&&alert("todo:DitherRow"),zr.put!=null){if(Ka=16*hs,hs=16*(hs+1),xo?(zr.y=mn.sa,zr.O=mn.ta+Ga,zr.f=mn.qa,zr.N=mn.ra+$c,zr.ea=mn.Ha,zr.W=mn.Ia+$c):(Ka-=Ca,zr.y=dl,zr.O=mc,zr.f=yi,zr.N=ya,zr.ea=Ll,zr.W=pc),go||(hs-=Ca),hs>zr.o&&(hs=zr.o),zr.F=null,zr.J=null,mn.Fa!=null&&0<mn.Fa.length&&Ka<hs&&(zr.J=$a(mn,zr,Ka,hs-Ka),zr.F=mn.mb,zr.F==null&&zr.F.length==0)){Fi=xr(mn,3,"Could not decode alpha data.");break t}Ka<zr.j&&(Ca=zr.j-Ka,Ka=zr.j,e(!(1&Ca)),zr.O+=mn.R*Ca,zr.N+=mn.B*(Ca>>1),zr.W+=mn.B*(Ca>>1),zr.F!=null&&(zr.J+=zr.width*Ca)),Ka<hs&&(zr.O+=zr.v,zr.N+=zr.v>>1,zr.W+=zr.v>>1,zr.F!=null&&(zr.J+=zr.v),zr.ka=Ka-zr.j,zr.U=zr.va-zr.v,zr.T=hs-Ka,Fi=zr.put(zr))}Jn+1!=mn.Ic||go||(n(mn.sa,mn.ta-Kn,dl,mc+16*mn.R,Kn),n(mn.qa,mn.ra-Ss,yi,ya+8*mn.B,Ss),n(mn.Ha,mn.Ia-Ss,Ll,pc+8*mn.B,Ss))}if(!Fi)return xr(ga,6,"Output aborted.")}return 1}(xt,Lt)),Lt.bc!=null&&Lt.bc(Lt),Kt&=1}return Kt?(xt.cb=0,Kt):0})(N,oe)||(F=N.a)}}else F=N.a}F==0&&qe.Oa!=null&&qe.Oa.fd&&(F=L1(qe.ba))}qe=F}Ve=qe!=0?null:11>Ve?Je.f.RGBA.eb:Je.f.kb.y}else Ve=null;return Ve};var vL=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(E,B){for(var k="",T=0;T<4;T++)k+=String.fromCharCode(E[B++]);return k}function d(E,B){return E[B+0]|E[B+1]<<8}function f(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16)>>>0}function A(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16|E[B+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,v=t,y=function(E,B){var k={},T=0,P=!1,G=0,ce=0;if(k.frames=[],!function(O,H){for(var K=0;K<4;K++)if(O[H+K]!="RIFF".charCodeAt(K))return!0;return!1}(E,B)){for(A(E,B+=4),B+=8;B<E.length;){var ue=u(E,B),le=A(E,B+=4);B+=4;var Ae=le+(1&le);switch(ue){case"VP8 ":case"VP8L":k.frames[T]===void 0&&(k.frames[T]={}),(De=k.frames[T]).src_off=P?ce:B-8,De.src_size=G+le+8,T++,P&&(P=!1,G=0,ce=0);break;case"VP8X":(De=k.header={}).feature_flags=E[B];var ae=B+4;De.canvas_width=1+f(E,ae),ae+=3,De.canvas_height=1+f(E,ae),ae+=3;break;case"ALPH":P=!0,G=Ae+8,ce=B-8;break;case"ANIM":(De=k.header).bgcolor=A(E,B),ae=B+4,De.loop_count=d(E,ae),ae+=2;break;case"ANMF":var _e,De;(De=k.frames[T]={}).offset_x=2*f(E,B),B+=3,De.offset_y=2*f(E,B),B+=3,De.width=1+f(E,B),B+=3,De.height=1+f(E,B),B+=3,De.duration=f(E,B),B+=3,_e=E[B++],De.dispose=1&_e,De.blend=_e>>1&1}ue!="ANMF"&&(B+=Ae)}return k}}(v,0);y.response=v,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,w=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var I=0;I<w.length&&w[I].blend!=0;I++);}var j=w[0],C=x.WebPDecodeRGBA(v,j.src_off,j.src_size,m,h);j.rgba=C,j.imgwidth=m[0],j.imgheight=h[0];for(var S=0;S<m[0]*h[0]*4;S++)p[S]=C[S];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,a,s,o,l,c,u,d=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new c,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new o,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new o,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=O;Object.defineProperty(this,"pdf",{get:function(){return H}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(ee){K=!!ee}});var R=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return R},set:function(ee){R=!!ee}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(ee){isNaN(ee)||(X=ee)}});var Y=0;Object.defineProperty(this,"posY",{get:function(){return Y},set:function(ee){isNaN(ee)||(Y=ee)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(ee){var Fe;typeof ee=="number"?Fe=[ee,ee,ee,ee]:((Fe=new Array(4))[0]=ee[0],Fe[1]=ee.length>=2?ee[1]:Fe[0],Fe[2]=ee.length>=3?ee[2]:Fe[0],Fe[3]=ee.length>=4?ee[3]:Fe[1]),u.margin=Fe}});var D=!1;Object.defineProperty(this,"autoPaging",{get:function(){return D},set:function(ee){D=ee}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(ee){Q=ee}});var te=[];Object.defineProperty(this,"pageBreaks",{get:function(){return te},set:function(ee){te=ee}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(ee){ee instanceof d&&(u=ee)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(ee){u.path=ee}});var be=[];Object.defineProperty(this,"ctxStack",{get:function(){return be},set:function(ee){be=ee}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ee){var Fe;Fe=A(ee),this.ctx.fillStyle=Fe.style,this.ctx.isFillTransparent=Fe.a===0,this.ctx.fillOpacity=Fe.a,this.pdf.setFillColor(Fe.r,Fe.g,Fe.b,{a:Fe.a}),this.pdf.setTextColor(Fe.r,Fe.g,Fe.b,{a:Fe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ee){var Fe=A(ee);this.ctx.strokeStyle=Fe.style,this.ctx.isStrokeTransparent=Fe.a===0,this.ctx.strokeOpacity=Fe.a,Fe.a===0?this.pdf.setDrawColor(255,255,255):(Fe.a,this.pdf.setDrawColor(Fe.r,Fe.g,Fe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ee){["butt","round","square"].indexOf(ee)!==-1&&(this.ctx.lineCap=ee,this.pdf.setLineCap(ee))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ee){isNaN(ee)||(this.ctx.lineWidth=ee,this.pdf.setLineWidth(ee))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ee){["bevel","round","miter"].indexOf(ee)!==-1&&(this.ctx.lineJoin=ee,this.pdf.setLineJoin(ee))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ee){isNaN(ee)||(this.ctx.miterLimit=ee,this.pdf.setMiterLimit(ee))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ee){this.ctx.textBaseline=ee}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ee){["right","end","center","left","start"].indexOf(ee)!==-1&&(this.ctx.textAlign=ee)}});var U=null,Xe=null,se=null;Object.defineProperty(this,"fontFaces",{get:function(){return se},set:function(ee){U=null,Xe=null,se=ee}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ee){var Fe;if(this.ctx.font=ee,(Fe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ee))!==null){var je=Fe[1];Fe[2];var Se=Fe[3],Ze=Fe[4];Fe[5];var ut=Fe[6],Et=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ze)[2];Ze=Math.floor(Et==="px"?parseFloat(Ze)*this.pdf.internal.scaleFactor:Et==="em"?parseFloat(Ze)*this.pdf.getFontSize():parseFloat(Ze)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ze);var St=function(Oe){var Ie,We,Z=[],Qe=Oe.trim();if(Qe==="")return g5;if(Qe in kV)return[kV[Qe]];for(;Qe!=="";){switch(We=null,Ie=(Qe=OV(Qe)).charAt(0)){case'"':case"'":We=iPe(Qe.substring(1),Ie);break;default:We=oPe(Qe)}if(We===null||(Z.push(We[0]),(Qe=OV(We[1]))!==""&&Qe.charAt(0)!==","))return g5;Qe=Qe.replace(/^,/,"")}return Z}(ut);if(this.fontFaces){var Ft=function(Oe,Ie){var We=Oe.getFontList(),Z=JSON.stringify(We);if(U===null||Xe!==Z){var Qe=function(at){var Ge=[];return Object.keys(at).forEach(function(ie){at[ie].forEach(function(xe){var de=null;switch(xe){case"bold":de={family:ie,weight:"bold"};break;case"italic":de={family:ie,style:"italic"};break;case"bolditalic":de={family:ie,weight:"bold",style:"italic"};break;case"":case"normal":de={family:ie}}de!==null&&(de.ref={name:ie,style:xe},Ge.push(de))})}),Ge}(We);U=function(at){for(var Ge={},ie=0;ie<at.length;++ie){var xe=p5(at[ie]),de=xe.family,Me=xe.stretch,me=xe.style,we=xe.weight;Ge[de]=Ge[de]||{},Ge[de][Me]=Ge[de][Me]||{},Ge[de][Me][me]=Ge[de][Me][me]||{},Ge[de][Me][me][we]=xe}return Ge}(Qe.concat(Ie)),Xe=Z}return U}(this.pdf,this.fontFaces),Qt=St.map(function(Oe){return{family:Oe,stretch:"normal",weight:Se,style:je}}),Ut=function(Oe,Ie,We){for(var Z=(We=We||{}).defaultFontFamily||"times",Qe=Object.assign({},sPe,We.genericFontFamilies||{}),at=null,Ge=null,ie=0;ie<Ie.length;++ie)if(Qe[(at=p5(Ie[ie])).family]&&(at.family=Qe[at.family]),Oe.hasOwnProperty(at.family)){Ge=Oe[at.family];break}if(!(Ge=Ge||Oe[Z]))throw new Error("Could not find a font-family for the rule '"+FV(at)+"' and default family '"+Z+"'.");if(Ge=function(xe,de){if(de[xe])return de[xe];var Me=qk[xe],me=Me<=qk.normal?-1:1,we=BV(de,Vre,Me,me);if(!we)throw new Error("Could not find a matching font-stretch value for "+xe);return we}(at.stretch,Ge),Ge=function(xe,de){if(de[xe])return de[xe];for(var Me=Qre[xe],me=0;me<Me.length;++me)if(de[Me[me]])return de[Me[me]];throw new Error("Could not find a matching font-style for "+xe)}(at.style,Ge),!(Ge=function(xe,de){if(de[xe])return de[xe];if(xe===400&&de[500])return de[500];if(xe===500&&de[400])return de[400];var Me=aPe[xe],me=BV(de,Hre,Me,xe<400?-1:1);if(!me)throw new Error("Could not find a matching font-weight for value "+xe);return me}(at.weight,Ge)))throw new Error("Failed to resolve a font for the rule '"+FV(at)+"'.");return Ge}(Ft,Qt);this.pdf.setFont(Ut.ref.name,Ut.ref.style)}else{var Tt="";(Se==="bold"||parseInt(Se,10)>=700||je==="bold")&&(Tt="bold"),je==="italic"&&(Tt+="italic"),Tt.length===0&&(Tt="normal");for(var Re="",Te={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ye=0;Ye<St.length;Ye++){if(this.pdf.internal.getFont(St[Ye],Tt,{noFallback:!0,disableWarning:!0})!==void 0){Re=St[Ye];break}if(Tt==="bolditalic"&&this.pdf.internal.getFont(St[Ye],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Re=St[Ye],Tt="bold";else if(this.pdf.internal.getFont(St[Ye],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Re=St[Ye],Tt="normal";break}}if(Re===""){for(var ht=0;ht<St.length;ht++)if(Te[St[ht]]){Re=Te[St[ht]];break}}Re=Re===""?"Times":Re,this.pdf.setFont(Re,Tt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ee){this.ctx.globalCompositeOperation=ee}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ee){this.ctx.globalAlpha=ee}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ee){this.ctx.lineDashOffset=ee,De.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ee){this.ctx.lineDash=ee,De.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ee){this.ctx.ignoreClearRect=!!ee}})};f.prototype.setLineDash=function(O){this.lineDash=O},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){w.call(this,"fill",!1)},f.prototype.stroke=function(){w.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(O,H){if(isNaN(O)||isNaN(H))throw As.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(O,H)},f.prototype.closePath=function(){var O=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&ts(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){O=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(O.x,O.y)},f.prototype.lineTo=function(O,H){if(isNaN(O)||isNaN(H))throw As.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},f.prototype.quadraticCurveTo=function(O,H,K,R){if(isNaN(K)||isNaN(R)||isNaN(O)||isNaN(H))throw As.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new o(K,R)),Y=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"qct",x1:Y.x,y1:Y.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},f.prototype.bezierCurveTo=function(O,H,K,R,X,Y){if(isNaN(X)||isNaN(Y)||isNaN(O)||isNaN(H)||isNaN(K)||isNaN(R))throw As.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var D=this.ctx.transform.applyToPoint(new o(X,Y)),Q=this.ctx.transform.applyToPoint(new o(O,H)),te=this.ctx.transform.applyToPoint(new o(K,R));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:te.x,y2:te.y,x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},f.prototype.arc=function(O,H,K,R,X,Y){if(isNaN(O)||isNaN(H)||isNaN(K)||isNaN(R)||isNaN(X))throw As.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Y=!!Y,!this.ctx.transform.isIdentity){var D=this.ctx.transform.applyToPoint(new o(O,H));O=D.x,H=D.y;var Q=this.ctx.transform.applyToPoint(new o(0,K)),te=this.ctx.transform.applyToPoint(new o(0,0));K=Math.sqrt(Math.pow(Q.x-te.x,2)+Math.pow(Q.y-te.y,2))}Math.abs(X-R)>=2*Math.PI&&(R=0,X=2*Math.PI),this.path.push({type:"arc",x:O,y:H,radius:K,startAngle:R,endAngle:X,counterclockwise:Y})},f.prototype.arcTo=function(O,H,K,R,X){throw new Error("arcTo not implemented.")},f.prototype.rect=function(O,H,K,R){if(isNaN(O)||isNaN(H)||isNaN(K)||isNaN(R))throw As.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,H),this.lineTo(O+K,H),this.lineTo(O+K,H+R),this.lineTo(O,H+R),this.lineTo(O,H),this.lineTo(O+K,H),this.lineTo(O,H)},f.prototype.fillRect=function(O,H,K,R){if(isNaN(O)||isNaN(H)||isNaN(K)||isNaN(R))throw As.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,H,K,R),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},f.prototype.strokeRect=function(O,H,K,R){if(isNaN(O)||isNaN(H)||isNaN(K)||isNaN(R))throw As.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(O,H,K,R),this.stroke())},f.prototype.clearRect=function(O,H,K,R){if(isNaN(O)||isNaN(H)||isNaN(K)||isNaN(R))throw As.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,H,K,R))},f.prototype.save=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var R=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=R}},f.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage(H),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(O){var H,K,R,X;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))H=0,K=0,R=0,X=0;else{var Y=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(Y!==null)H=parseInt(Y[1]),K=parseInt(Y[2]),R=parseInt(Y[3]),X=1;else if((Y=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)H=parseInt(Y[1]),K=parseInt(Y[2]),R=parseInt(Y[3]),X=parseFloat(Y[4]);else{if(X=1,typeof O=="string"&&O.charAt(0)!=="#"){var D=new Fre(O);O=D.ok?D.toHex():"#000000"}O.length===4?(H=O.substring(1,2),H+=H,K=O.substring(2,3),K+=K,R=O.substring(3,4),R+=R):(H=O.substring(1,3),K=O.substring(3,5),R=O.substring(5,7)),H=parseInt(H,16),K=parseInt(K,16),R=parseInt(R,16)}}return{r:H,g:K,b:R,a:X,style:O}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(O,H,K,R){if(isNaN(H)||isNaN(K)||typeof O!="string")throw As.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(R=isNaN(R)?void 0:R,!h.call(this)){var X=Ae(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;T.call(this,{text:O,x:H,y:K,scale:Y,angle:X,align:this.textAlign,maxWidth:R})}},f.prototype.strokeText=function(O,H,K,R){if(isNaN(H)||isNaN(K)||typeof O!="string")throw As.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){R=isNaN(R)?void 0:R;var X=Ae(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;T.call(this,{text:O,x:H,y:K,scale:Y,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:R})}},f.prototype.measureText=function(O){if(typeof O!="string")throw As.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,K=this.pdf.internal.scaleFactor,R=H.internal.getFontSize(),X=H.getStringUnitWidth(O)*R/H.internal.scaleFactor;return new function(Y){var D=(Y=Y||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this}({width:X*=Math.round(96*K/72*1e4)/1e4})},f.prototype.scale=function(O,H){if(isNaN(O)||isNaN(H))throw As.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new c(O,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.rotate=function(O){if(isNaN(O))throw As.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new c(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.translate=function(O,H){if(isNaN(O)||isNaN(H))throw As.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new c(1,0,0,1,O,H);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.transform=function(O,H,K,R,X,Y){if(isNaN(O)||isNaN(H)||isNaN(K)||isNaN(R)||isNaN(X)||isNaN(Y))throw As.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var D=new c(O,H,K,R,X,Y);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.setTransform=function(O,H,K,R,X,Y){O=isNaN(O)?1:O,H=isNaN(H)?0:H,K=isNaN(K)?0:K,R=isNaN(R)?1:R,X=isNaN(X)?0:X,Y=isNaN(Y)?0:Y,this.ctx.transform=new c(O,H,K,R,X,Y)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(O,H,K,R,X,Y,D,Q,te){var be=this.pdf.getImageProperties(O),U=1,Xe=1,se=1,ee=1;R!==void 0&&Q!==void 0&&(se=Q/R,ee=te/X,U=be.width/R*Q/R,Xe=be.height/X*te/X),Y===void 0&&(Y=H,D=K,H=0,K=0),R!==void 0&&Q===void 0&&(Q=R,te=X),R===void 0&&Q===void 0&&(Q=be.width,te=be.height);var Fe=this.ctx.transform.decompose(),je=Ae(Fe.rotate.shx),Se=new c,Ze=(Se=(Se=(Se=Se.multiply(Fe.translate)).multiply(Fe.skew)).multiply(Fe.scale)).applyToRectangle(new l(Y-H*se,D-K*ee,R*U,X*Xe));if(this.autoPaging){for(var ut,Et=x.call(this,Ze),St=[],Ft=0;Ft<Et.length;Ft+=1)St.indexOf(Et[Ft])===-1&&St.push(Et[Ft]);b(St);for(var Qt=St[0],Ut=St[St.length-1],Tt=Qt;Tt<Ut+1;Tt++){this.pdf.setPage(Tt);var Re=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Te=Tt===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ht=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Oe=Tt===1?0:Ye+(Tt-2)*ht;if(this.ctx.clip_path.length!==0){var Ie=this.path;ut=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ut,this.posX+this.margin[3],-Oe+Te+this.ctx.prevPageLastElemOffset),I.call(this,"fill",!0),this.path=Ie}var We=JSON.parse(JSON.stringify(Ze));We=y([We],this.posX+this.margin[3],-Oe+Te+this.ctx.prevPageLastElemOffset)[0];var Z=(Tt>Qt||Tt<Ut)&&p.call(this);Z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Re,ht,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",We.x,We.y,We.w,We.h,null,null,je),Z&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",Ze.x,Ze.y,Ze.w,Ze.h,null,null,je)};var x=function(O,H,K){var R=[];H=H||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":R.push(Math.floor((O.y+X)/K)+1);break;case"arc":R.push(Math.floor((O.y+X-O.radius)/K)+1),R.push(Math.floor((O.y+X+O.radius)/K)+1);break;case"qct":var Y=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);R.push(Math.floor((Y.y+X)/K)+1),R.push(Math.floor((Y.y+Y.h+X)/K)+1);break;case"bct":var D=_e(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);R.push(Math.floor((D.y+X)/K)+1),R.push(Math.floor((D.y+D.h+X)/K)+1);break;case"rect":R.push(Math.floor((O.y+X)/K)+1),R.push(Math.floor((O.y+O.h+X)/K)+1)}for(var Q=0;Q<R.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<R[Q];)v.call(this);return R},v=function(){var O=this.fillStyle,H=this.strokeStyle,K=this.font,R=this.lineCap,X=this.lineWidth,Y=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=H,this.font=K,this.lineCap=R,this.lineWidth=X,this.lineJoin=Y},y=function(O,H,K){for(var R=0;R<O.length;R++)switch(O[R].type){case"bct":O[R].x2+=H,O[R].y2+=K;case"qct":O[R].x1+=H,O[R].y1+=K;default:O[R].x+=H,O[R].y+=K}return O},b=function(O){return O.sort(function(H,K){return H-K})},w=function(O,H){var K=this.fillStyle,R=this.strokeStyle,X=this.lineCap,Y=this.lineWidth,D=Math.abs(Y*this.ctx.transform.scaleX),Q=this.lineJoin;if(this.autoPaging){for(var te,be,U=JSON.parse(JSON.stringify(this.path)),Xe=JSON.parse(JSON.stringify(this.path)),se=[],ee=0;ee<Xe.length;ee++)if(Xe[ee].x!==void 0)for(var Fe=x.call(this,Xe[ee]),je=0;je<Fe.length;je+=1)se.indexOf(Fe[je])===-1&&se.push(Fe[je]);for(var Se=0;Se<se.length;Se++)for(;this.pdf.internal.getNumberOfPages()<se[Se];)v.call(this);b(se);for(var Ze=se[0],ut=se[se.length-1],Et=Ze;Et<ut+1;Et++){this.pdf.setPage(Et),this.fillStyle=K,this.strokeStyle=R,this.lineCap=X,this.lineWidth=D,this.lineJoin=Q;var St=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ft=Et===1?this.posY+this.margin[0]:this.margin[0],Qt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ut=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tt=Et===1?0:Qt+(Et-2)*Ut;if(this.ctx.clip_path.length!==0){var Re=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(te,this.posX+this.margin[3],-Tt+Ft+this.ctx.prevPageLastElemOffset),I.call(this,O,!0),this.path=Re}if(be=JSON.parse(JSON.stringify(U)),this.path=y(be,this.posX+this.margin[3],-Tt+Ft+this.ctx.prevPageLastElemOffset),H===!1||Et===0){var Te=(Et>Ze||Et<ut)&&p.call(this);Te&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],St,Ut,null).clip().discardPath()),I.call(this,O,H),Te&&this.pdf.restoreGraphicsState()}this.lineWidth=Y}this.path=U}else this.lineWidth=D,I.call(this,O,H),this.lineWidth=Y},I=function(O,H){if((O!=="stroke"||H||!m.call(this))&&(O==="stroke"||H||!h.call(this))){for(var K,R,X=[],Y=this.path,D=0;D<Y.length;D++){var Q=Y[D];switch(Q.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:Q,deltas:[],abs:[]});break;case"lt":var te=X.length;if(Y[D-1]&&!isNaN(Y[D-1].x)&&(K=[Q.x-Y[D-1].x,Q.y-Y[D-1].y],te>0)){for(;te>=0;te--)if(X[te-1].close!==!0&&X[te-1].begin!==!0){X[te-1].deltas.push(K),X[te-1].abs.push(Q);break}}break;case"bct":K=[Q.x1-Y[D-1].x,Q.y1-Y[D-1].y,Q.x2-Y[D-1].x,Q.y2-Y[D-1].y,Q.x-Y[D-1].x,Q.y-Y[D-1].y],X[X.length-1].deltas.push(K);break;case"qct":var be=Y[D-1].x+2/3*(Q.x1-Y[D-1].x),U=Y[D-1].y+2/3*(Q.y1-Y[D-1].y),Xe=Q.x+2/3*(Q.x1-Q.x),se=Q.y+2/3*(Q.y1-Q.y),ee=Q.x,Fe=Q.y;K=[be-Y[D-1].x,U-Y[D-1].y,Xe-Y[D-1].x,se-Y[D-1].y,ee-Y[D-1].x,Fe-Y[D-1].y],X[X.length-1].deltas.push(K);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(Q)}}R=H?null:O==="stroke"?"stroke":"fill";for(var je=!1,Se=0;Se<X.length;Se++)if(X[Se].arc)for(var Ze=X[Se].abs,ut=0;ut<Ze.length;ut++){var Et=Ze[ut];Et.type==="arc"?S.call(this,Et.x,Et.y,Et.radius,Et.startAngle,Et.endAngle,Et.counterclockwise,void 0,H,!je):P.call(this,Et.x,Et.y),je=!0}else if(X[Se].close===!0)this.pdf.internal.out("h"),je=!1;else if(X[Se].begin!==!0){var St=X[Se].start.x,Ft=X[Se].start.y;G.call(this,X[Se].deltas,St,Ft),je=!0}R&&E.call(this,R),H&&B.call(this)}},j=function(O){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-K;case"top":return O+H-K;case"hanging":return O+H-2*K;case"middle":return O+H/2-K;default:return O}},C=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(H,K){this.colorStops.push([H,K])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(O,H,K,R,X,Y,D,Q,te){for(var be=ue.call(this,K,R,X,Y),U=0;U<be.length;U++){var Xe=be[U];U===0&&(te?k.call(this,Xe.x1+O,Xe.y1+H):P.call(this,Xe.x1+O,Xe.y1+H)),ce.call(this,O,H,Xe.x2,Xe.y2,Xe.x3,Xe.y3,Xe.x4,Xe.y4)}Q?B.call(this):E.call(this,D)},E=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(O,H){this.pdf.internal.out(r(O)+" "+n(H)+" m")},T=function(O){var H;switch(O.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var K,R,X,Y=this.pdf.getTextDimensions(O.text),D=j.call(this,O.y),Q=C.call(this,D)-Y.h,te=this.ctx.transform.applyToPoint(new o(O.x,D));if(this.autoPaging){var be=this.ctx.transform.decompose(),U=new c;U=(U=(U=U.multiply(be.translate)).multiply(be.skew)).multiply(be.scale);for(var Xe=this.ctx.transform.applyToRectangle(new l(O.x,D,Y.w,Y.h)),se=U.applyToRectangle(new l(O.x,Q,Y.w,Y.h)),ee=x.call(this,se),Fe=[],je=0;je<ee.length;je+=1)Fe.indexOf(ee[je])===-1&&Fe.push(ee[je]);b(Fe);for(var Se=Fe[0],Ze=Fe[Fe.length-1],ut=Se;ut<Ze+1;ut++){this.pdf.setPage(ut);var Et=ut===1?this.posY+this.margin[0]:this.margin[0],St=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ft=this.pdf.internal.pageSize.height-this.margin[2],Qt=Ft-this.margin[0],Ut=this.pdf.internal.pageSize.width-this.margin[1],Tt=Ut-this.margin[3],Re=ut===1?0:St+(ut-2)*Qt;if(this.ctx.clip_path.length!==0){var Te=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(K,this.posX+this.margin[3],-1*Re+Et),I.call(this,"fill",!0),this.path=Te}var Ye=y([JSON.parse(JSON.stringify(se))],this.posX+this.margin[3],-Re+Et+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*O.scale),X=this.lineWidth,this.lineWidth=X*O.scale);var ht=this.autoPaging!=="text";if(ht||Ye.y+Ye.h<=Ft){if(ht||Ye.y>=Et&&Ye.x<=Ut){var Oe=ht?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||Ut-Ye.x)[0],Ie=y([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-Re+Et+this.ctx.prevPageLastElemOffset)[0],We=ht&&(ut>Se||ut<Ze)&&p.call(this);We&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,Qt,null).clip().discardPath()),this.pdf.text(Oe,Ie.x,Ie.y,{angle:O.angle,align:H,renderingMode:O.renderingMode}),We&&this.pdf.restoreGraphicsState()}}else Ye.y<Ft&&(this.ctx.prevPageLastElemOffset+=Ft-Ye.y);O.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=X)}}else O.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*O.scale),X=this.lineWidth,this.lineWidth=X*O.scale),this.pdf.text(O.text,te.x+this.posX,te.y+this.posY,{angle:O.angle,align:H,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=X)},P=function(O,H,K,R){K=K||0,R=R||0,this.pdf.internal.out(r(O+K)+" "+n(H+R)+" l")},G=function(O,H,K){return this.pdf.lines(O,H,K,null,null)},ce=function(O,H,K,R,X,Y,D,Q){this.pdf.internal.out([e(a(K+O)),e(s(R+H)),e(a(X+O)),e(s(Y+H)),e(a(D+O)),e(s(Q+H)),"c"].join(" "))},ue=function(O,H,K,R){for(var X=2*Math.PI,Y=Math.PI/2;H>K;)H-=X;var D=Math.abs(K-H);D<X&&R&&(D=X-D);for(var Q=[],te=R?-1:1,be=H;D>1e-5;){var U=be+te*Math.min(D,Y);Q.push(le.call(this,O,be,U)),D-=Math.abs(U-be),be=U}return Q},le=function(O,H,K){var R=(K-H)/2,X=O*Math.cos(R),Y=O*Math.sin(R),D=X,Q=-Y,te=D*D+Q*Q,be=te+D*X+Q*Y,U=4/3*(Math.sqrt(2*te*be)-be)/(D*Y-Q*X),Xe=D-U*Q,se=Q+U*D,ee=Xe,Fe=-se,je=R+H,Se=Math.cos(je),Ze=Math.sin(je);return{x1:O*Math.cos(H),y1:O*Math.sin(H),x2:Xe*Se-se*Ze,y2:Xe*Ze+se*Se,x3:ee*Se-Fe*Ze,y3:ee*Ze+Fe*Se,x4:O*Math.cos(K),y4:O*Math.sin(K)}},Ae=function(O){return 180*O/Math.PI},ae=function(O,H,K,R,X,Y){var D=O+.5*(K-O),Q=H+.5*(R-H),te=X+.5*(K-X),be=Y+.5*(R-Y),U=Math.min(O,X,D,te),Xe=Math.max(O,X,D,te),se=Math.min(H,Y,Q,be),ee=Math.max(H,Y,Q,be);return new l(U,se,Xe-U,ee-se)},_e=function(O,H,K,R,X,Y,D,Q){var te,be,U,Xe,se,ee,Fe,je,Se,Ze,ut,Et,St,Ft,Qt=K-O,Ut=R-H,Tt=X-K,Re=Y-R,Te=D-X,Ye=Q-Y;for(be=0;be<41;be++)Se=(Fe=(U=O+(te=be/40)*Qt)+te*((se=K+te*Tt)-U))+te*(se+te*(X+te*Te-se)-Fe),Ze=(je=(Xe=H+te*Ut)+te*((ee=R+te*Re)-Xe))+te*(ee+te*(Y+te*Ye-ee)-je),be==0?(ut=Se,Et=Ze,St=Se,Ft=Ze):(ut=Math.min(ut,Se),Et=Math.min(Et,Ze),St=Math.max(St,Se),Ft=Math.max(Ft,Ze));return new l(Math.round(ut),Math.round(Et),Math.round(St-ut),Math.round(Ft-Et))},De=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,H,K=(O=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:H}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(rn.API),function(t){var e=function(o){var l,c,u,d,f,A,h,m,p,x;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(A=(f=((f=((f=((f=(f-(x=f%85))/85)-(p=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(A+33,h+33,m+33,p+33,x+33)):c.push(122);return function(v,y){for(var b=y;b>0;b--)v.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,A=String,h="length",m=255,p="charCodeAt",x="slice",v="replace";for(o[x](-2),o=o[x](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[x](o[h]%5||5))[h];f>d;d+=5)c=52200625*(o[p](d)-33)+614125*(o[p](d+1)-33)+7225*(o[p](d+2)-33)+85*(o[p](d+3)-33)+(o[p](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var w=b;w>0;w--)y.pop()}(u,l[h]),A.fromCharCode.apply(A,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Uk(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(rn.API),function(t){t.loadFile=function(e,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,A=0,h=function(m){var p=m.length,x=[],v=String.fromCharCode;for(A=0;A<p;A+=1)x.push(v(255&m.charCodeAt(A)));return x.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(a,s,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(rn.API),function(t){function e(){return(Ln.html2canvas?Promise.resolve(Ln.html2canvas):lA(()=>Promise.resolve().then(()=>q6),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Ln.DOMPurify?Promise.resolve(Ln.DOMPurify):lA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=ts(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],p=m.src.find(function(x){return x.format==="truetype"});p&&u.addFont(p.url,m.ref.name,m.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,u.context2d.save(!0),c(this.prop.container,A)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||rn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(A){return u.updateProgress(null,d),A}).then(d,f).then(function(A){return u.updateProgress(1),A})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),A=u.call(f,l,c);return o.convert(A,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,rn.getPageSize=function(l,c,u){if(ts(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,A=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(A))p=h[A][1]/f,x=h[A][0]/f;else try{p=u[1],x=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:f,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(p5):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(rn.API),rn.API.addJS=function(t){return RV=t,this.internal.events.subscribe("postPutResources",function(){LC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(LC+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),DV=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+RV+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){LC!==void 0&&DV!==void 0&&this.internal.out("/Names <</JavaScript "+LC+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var A=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(rn.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var A,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(f.charCodeAt(x+1))!==-1){A=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),p={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:A,numcomponents:f.charCodeAt(x+9)};break}h=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(rn.API),rn.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,s=HIe(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;a=u&&c===1?function(S){for(var E=S.width,B=S.height,k=S.data,T=S.palette,P=S.depth,G=!1,ce=[],ue=[],le=void 0,Ae=!1,ae=0,_e=0;_e<T.length;_e++){var De=QQ(T[_e],4),O=De[0],H=De[1],K=De[2],R=De[3];ce.push(O,H,K),R!=null&&(R===0?(ae++,ue.length<1&&ue.push(_e)):R<255&&(Ae=!0))}if(Ae||ae>1){G=!0,ue=void 0;var X=E*B;le=new Uint8Array(X);for(var Y=new DataView(k.buffer),D=0;D<X;D++){var Q=x5(Y,D,P),te=QQ(T[Q],4)[3];le[D]=te}}else ae===0&&(ue=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:G?8:void 0,colorBytes:k,alphaBytes:le,needSMask:G,palette:ce,mask:ue}}(s):c===2||c===4?function(S){for(var E=S.data,B=S.width,k=S.height,T=S.channels,P=S.depth,G=T===2?"DeviceGray":"DeviceRGB",ce=T-1,ue=B*k,le=ce,Ae=ue*le,ae=1*ue,_e=Math.ceil(Ae*P/8),De=Math.ceil(ae*P/8),O=new Uint8Array(_e),H=new Uint8Array(De),K=new DataView(E.buffer),R=new DataView(O.buffer),X=new DataView(H.buffer),Y=!1,D=0;D<ue;D++){for(var Q=D*T,te=0;te<le;te++)KV(R,x5(K,Q+te,P),D*le+te,P);var be=x5(K,Q+le,P);be<(1<<P)-1&&(Y=!0),KV(X,be,1*D,P)}return{colorSpace:G,colorsPerPixel:ce,sMaskBitsPerComponent:Y?P:void 0,colorBytes:O,alphaBytes:H,needSMask:Y}}(s):function(S){var E=S.data,B=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(k){for(var T=k.length,P=new Uint8Array(2*T),G=new DataView(P.buffer,P.byteOffset,P.byteLength),ce=0;ce<T;ce++)G.setUint16(2*ce,k[ce],!1);return P}(E):E,needSMask:!1}}(s);var f,A,h,m=a,p=m.colorSpace,x=m.colorsPerPixel,v=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,w=m.needSMask,I=m.palette,j=m.mask,C=null;return n!==rn.API.image_compression.NONE&&typeof Uk=="function"?(C=function(S){var E;switch(S){case rn.API.image_compression.FAST:E=11;break;case rn.API.image_compression.MEDIUM:E=13;break;case rn.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),f=this.decode.FLATE_DECODE,A="/Predictor ".concat(C," /Colors ").concat(x," /BitsPerComponent ").concat(d," /Columns ").concat(o),t=QV(y,Math.ceil(o*x*d/8),x,d,n),w&&(h=QV(b,Math.ceil(o*v/8),1,v,n))):(f=void 0,A=void 0,t=y,w&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:f,decodeParameters:A,transparency:j,palette:I,sMask:h,predictor:C,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:v,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,a){var s=new dPe(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new v5(100).encode(u,100);return t.processJPEG.call(this,d,r,n,a)},t.processGIF87A=t.processGIF89A}(rn.API),Xd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Xd.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){As.log("bit decode error:"+r)}},Xd.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Xd.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Xd.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Xd.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=t}},Xd.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},Xd.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Xd.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Xd.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,a){var s=new Xd(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new v5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(rn.API),zV.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,a){var s=new zV(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new v5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(rn.API),rn.API.processRGBA=function(t,e,r){for(var n=t.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],A=n[u+2],h=n[u+3];s[l++]=d,s[l++]=f,s[l++]=A,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},rn.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},mx=rn.API,UC=mx.getCharWidthsArray=function(t,e){var r,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=e.doKerning!==!1,A=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof a.metadata.widthOfString=="function"?x.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(A=f&&ts(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,x.push((l[n]||p)/c+A)),m=n;return x},MV=mx.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return mx.processArabic&&(t=mx.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,a)/r:UC.apply(this,arguments).reduce(function(s,o){return s+o},0)},LV=function(t,e,r,n){for(var a=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<r;)l+=e[s],s++;a.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>n&&(a.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&a.push(t.slice(c,s)),a},UV=function(t,e,r){r||(r={});var n,a,s,o,l,c,u,d=[],f=[d],A=r.textIndent||0,h=0,m=0,p=t.split(" "),x=UC.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),y=[];p.map(function(w){(w=w.split(/\s*\n/)).length>1?y=y.concat(w.map(function(I,j){return(j&&I.length?`
`:"")+I})):y.push(w[0])}),p=y,c=MV.apply(this,[v,r])}for(s=0,o=p.length;s<o;s++){var b=0;if(n=p[s],c&&n[0]==`
`&&(n=n.substr(1),b=1),A+h+(m=(a=UC.apply(this,[n,r])).reduce(function(w,I){return w+I},0))>e||b){if(m>e){for(l=LV.apply(this,[n,a,e-(A+h),e]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(w,I){return w+I},0)}else d=[n];f.push(d),A=m+c,h=x}else d.push(n),A+=h+m,h=x}return u=c?function(w,I){return(I?v:"")+w.join(" ")}:function(w){return w.join(" ")},f.map(u)},mx.splitTextToSize=function(t,e,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),A="Unicode";return f.metadata[A]?{widths:f.metadata[A].widths||{0:1},kerning:f.metadata[A].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(UV.apply(this,[n[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=e[s],a[e[s]]=r[s];var o=function(A){return"0x"+parseInt(A,10).toString(16)},l=t.__fontmetrics__.compress=function(A){var h,m,p,x,v=["{"];for(var y in A){if(h=A[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+a[p.slice(-1)];else{if(ts(h)!=="object")throw new Error("Don't know what to do with value type "+ts(h)+".");p=l(h)}v.push(m+p)}return v.push("}"),v.join("")},c=t.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,v={},y=1,b=v,w=[],I="",j="",C=A.length-1,S=1;S<C;S+=1)(x=A[S])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(w.push([b,p]),b={},p=void 0):x=="}"?((m=w.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?y=-1:p===void 0?n.hasOwnProperty(x)?(I+=n[x],p=parseInt(I,16)*y,y=1,I=""):I+=x:n.hasOwnProperty(x)?(j+=n[x],b[p]=parseInt(j,16)*y,y=1,p=void 0,j=""):j+=x;return v},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(A){var h=A.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(rn.API),function(t){var e=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};t.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(xE(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(rn),rn.API.addSvgAsImage=function(t,e,r,n,a,s,o,l){if(isNaN(e)||isNaN(r))throw As.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw As.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Ln.canvg?Promise.resolve(Ln.canvg):lA(()=>import("./index.es-Bow-B9ru.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(u,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),e,r,n,a,o,l)})},rn.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,r);return this},rn.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function A(m,p){var x,v=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(ts(t)==="object"){for(a in t)if(s=t[a],A(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&A(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(rn.API),function(t){var e=t.API,r=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,A=s.length;f<A;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,A;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,A=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<A;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,A=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<A.length;m++)h+=String.fromCharCode(A[m]);var p=u();d({data:h,addLength1:!0,objectId:p}),c("endobj");var x=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Fx(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Fx(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+Fx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,A="",h=0;h<f.length;h++)A+=String.fromCharCode(f[h]);var m=u();d({data:A,addLength1:!0,objectId:m}),c("endobj");var p=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Fx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Fx(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},A=f.pdfEscape,h=f.activeFontKey,m=f.fonts,p=h,x="",v=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),v=0;v<y.length;v+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[v].charCodeAt(0)]),o||y[v].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=y[v]:x+="";var w="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?w=A(x,p).split("").map(function(I){return I.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(w=r(x,m[p])),f.isHex=!0,{text:w,x:c,y:u,options:d,mutex:f}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(rn),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(rn.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,d,f=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var w=function(k){var T=k.charCodeAt(),P=T>>8,G=p[P];return G!==void 0?f[256*G+(255&T)]:P===252||P===253?"AL":v.test(P)?"L":P===8?"R":"N"},I=function(k){for(var T,P=0;P<k.length;P++){if((T=w(k.charAt(P)))==="L")return!1;if(T==="R")return!0}return!1},j=function(k,T,P,G){var ce,ue,le,Ae,ae=T[G];switch(ae){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(ae="AN");break;case"AL":y=!0,ae="R";break;case"WS":case"BN":ae="N";break;case"CS":G<1||G+1>=T.length||(ce=P[G-1])!=="EN"&&ce!=="AN"||(ue=T[G+1])!=="EN"&&ue!=="AN"?ae="N":y&&(ue="AN"),ae=ue===ce?ue:"N";break;case"ES":ae=(ce=G>0?P[G-1]:"B")==="EN"&&G+1<T.length&&T[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&P[G-1]==="EN"){ae="EN";break}if(y){ae="N";break}for(le=G+1,Ae=T.length;le<Ae&&T[le]==="ET";)le++;ae=le<Ae&&T[le]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Ae=T.length,le=G+1;le<Ae&&T[le]==="NSM";)le++;if(le<Ae){var _e=k[G],De=_e>=1425&&_e<=2303||_e===64286;if(ce=T[le],De&&(ce==="R"||ce==="AL")){ae="R";break}}}ae=G<1||(ce=T[G-1])==="B"?"N":P[G-1];break;case"B":y=!1,a=!0,ae=b;break;case"S":s=!0,ae="N"}return ae},C=function(k,T,P){var G=k.split("");return P&&S(G,P,{hiLevel:b}),G.reverse(),T&&T.reverse(),G.join("")},S=function(k,T,P){var G,ce,ue,le,Ae,ae=-1,_e=k.length,De=0,O=[],H=b?h:A,K=[];for(y=!1,a=!1,s=!1,ce=0;ce<_e;ce++)K[ce]=w(k[ce]);for(ue=0;ue<_e;ue++){if(Ae=De,O[ue]=j(k,K,O,ue),G=240&(De=H[Ae][m[O[ue]]]),De&=15,T[ue]=le=H[De][5],G>0)if(G===16){for(ce=ae;ce<ue;ce++)T[ce]=1;ae=-1}else ae=-1;if(H[De][6])ae===-1&&(ae=ue);else if(ae>-1){for(ce=ae;ce<ue;ce++)T[ce]=le;ae=-1}K[ue]==="B"&&(T[ue]=0),P.hiLevel|=le}s&&function(R,X,Y){for(var D=0;D<Y;D++)if(R[D]==="S"){X[D]=b;for(var Q=D-1;Q>=0&&R[Q]==="WS";Q--)X[Q]=b}}(K,T,_e)},E=function(k,T,P,G,ce){if(!(ce.hiLevel<k)){if(k===1&&b===1&&!a)return T.reverse(),void(P&&P.reverse());for(var ue,le,Ae,ae,_e=T.length,De=0;De<_e;){if(G[De]>=k){for(Ae=De+1;Ae<_e&&G[Ae]>=k;)Ae++;for(ae=De,le=Ae-1;ae<le;ae++,le--)ue=T[ae],T[ae]=T[le],T[le]=ue,P&&(ue=P[ae],P[ae]=P[le],P[le]=ue);De=Ae}De++}}},B=function(k,T,P){var G=k.split(""),ce={hiLevel:b};return P||(P=[]),S(G,P,ce),function(ue,le,Ae){if(Ae.hiLevel!==0&&d)for(var ae,_e=0;_e<ue.length;_e++)le[_e]===1&&(ae=x.indexOf(ue[_e]))>=0&&(ue[_e]=x[ae+1])}(G,P,ce),E(2,G,T,P,ce),E(1,G,T,P,ce),G.join("")};return this.__bidiEngine__.doBidiReorder=function(k,T,P){if(function(ce,ue){if(ue)for(var le=0;le<ce.length;le++)ue[le]=le;l===void 0&&(l=I(ce)),u===void 0&&(u=I(ce))}(k,T),o||!c||u)if(o&&c&&l^u)b=l?1:0,k=C(k,T,P);else if(!o&&c&&u)b=l?1:0,k=B(k,T,P),k=C(k,T);else if(!o||l||c||u){if(o&&!c&&l^u)k=C(k,T),l?(b=0,k=B(k,T,P)):(b=1,k=B(k,T,P),k=C(k,T));else if(o&&l&&!c&&u)b=1,k=B(k,T,P),k=C(k,T);else if(!o&&!c&&l^u){var G=d;l?(b=1,k=B(k,T,P),b=0,d=!1,k=B(k,T,P),d=G):(b=0,k=B(k,T,P),k=C(k,T),b=1,d=!1,k=B(k,T,P),d=G,k=C(k,T))}}else b=0,k=B(k,T,P);else b=l?1:0,k=B(k,T,P);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,u=k.isOutputRtl,d=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(rn),rn.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Im(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new EPe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new fPe(this.contents),this.head=new APe(this),this.name=new vPe(this),this.cmap=new Gre(this),this.toUnicode={},this.hhea=new mPe(this),this.maxp=new yPe(this),this.hmtx=new bPe(this),this.post=new gPe(this),this.os2=new pPe(this),this.loca=new _Pe(this),this.glyf=new wPe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var a,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Bf,Im=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,a;for(a=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(e.charCodeAt(r)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,a,s,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)r=e[n],s.push(this.writeByte(r));return s},t}(),fPe=function(){var t;function e(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,a,s,o,l,c,u,d,f,A,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),d=16*h-f,(a=new Im).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(d),s=16*h,u=a.pos+s,l=null,m=[],r)for(A=r[p],a.writeString(p),a.writeInt(t(A)),a.writeInt(u),a.writeInt(A.length),m=m.concat(A),p==="head"&&(l=u),u+=A.length;u%4;)m.push(0),u++;return a.write(m),n=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(n),a.data},t=function(r){var n,a,s,o;for(r=Kre.call(r);r.length%4;)r.push(0);for(s=new Im(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),hPe={}.hasOwnProperty,xh=function(t,e){for(var r in e)hPe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Bf=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var APe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Im).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),WV=function(){function t(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),A=h/2,e.pos+=6,s=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),e.pos+=2,p=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),u=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),d=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),a=(this.length-e.pos+this.offset)/2,l=function(){var w,I;for(I=[],c=w=0;0<=a?w<a:w>a;c=0<=a?++w:--w)I.push(e.readUInt16());return I}(),c=v=0,b=s.length;v<b;c=++v)for(x=s[c],n=y=m=p[c];m<=x?y<=x:y>=x;n=m<=x?++y:--y)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(A-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=f}return t.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,I,j,C,S,E,B,k,T,P,G,ce,ue,le,Ae,ae,_e,De,O,H,K,R,X,Y,D,Q,te,be,U;switch(G=new Im,o=Object.keys(e).sort(function(Xe,se){return Xe-se}),r){case"macroman":for(p=0,x=function(){var Xe=[];for(m=0;m<256;++m)Xe.push(0);return Xe}(),y={0:0},s={},ce=0,ae=o.length;ce<ae;ce++)y[Q=e[a=o[ce]]]==null&&(y[Q]=++p),s[a]={old:e[a],new:y[e[a]]},x[a]=y[e[a]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(x),{charMap:s,subtable:G.data,maxGlyphID:p+1};case"unicode":for(T=[],f=[],b=0,y={},n={},v=u=null,ue=0,_e=o.length;ue<_e;ue++)y[I=e[a=o[ue]]]==null&&(y[I]=++b),n[a]={old:I,new:y[I]},l=y[I]-a,v!=null&&l===u||(v&&f.push(v),T.push(a),u=l),v=a;for(v&&f.push(v),f.push(65535),T.push(65535),B=2*(E=T.length),S=2*Math.pow(Math.log(E)/Math.LN2,2),A=Math.log(S/2)/Math.LN2,C=2*E-S,c=[],j=[],h=[],m=le=0,De=T.length;le<De;m=++le){if(k=T[m],d=f[m],k===65535){c.push(0),j.push(0);break}if(k-(P=n[k].new)>=32768)for(c.push(0),j.push(2*(h.length+E-m)),a=Ae=k;k<=d?Ae<=d:Ae>=d;a=k<=d?++Ae:--Ae)h.push(n[a].new);else c.push(P-k),j.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*E+2*h.length),G.writeUInt16(0),G.writeUInt16(B),G.writeUInt16(S),G.writeUInt16(A),G.writeUInt16(C),Y=0,O=f.length;Y<O;Y++)a=f[Y],G.writeUInt16(a);for(G.writeUInt16(0),D=0,H=T.length;D<H;D++)a=T[D],G.writeUInt16(a);for(te=0,K=c.length;te<K;te++)l=c[te],G.writeUInt16(l);for(be=0,R=j.length;be<R;be++)w=j[be],G.writeUInt16(w);for(U=0,X=h.length;U<X;U++)p=h[U],G.writeUInt16(p);return{charMap:n,subtable:G.data,maxGlyphID:b+1}}},t}(),Gre=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new WV(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,a;return r==null&&(r="macroman"),n=WV.encode(e,r),(a=new Im).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},t}(),mPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),pPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),gPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)r=e.readByte(),a.push(this.names.push(e.readString(r)));return a;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),xPe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},vPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,a,s,o,l,c,u,d,f,A;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)a=n[s],e.pos=a.offset,u=e.readString(a.length),o=new xPe(u,a),c[A=a.nameID]==null&&(c[A]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),yPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),bPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,a,s,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)d.push(e.readInt16());return d}(),this.widths=(function(){var u,d,f,A;for(A=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],A.push(s.advance);return A}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),Kre=[].slice,wPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,a,s,o,l,c,u,d,f;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(e),(a=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new Im(r.read(a))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[e]=o===-1?new CPe(l,u,f,c,d):new NPe(l,o,u,f,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=e[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},t}(),NPe=function(){function t(e,r,n,a,s,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),CPe=function(){function t(e,r,n,a,s){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Im(Kre.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),_Pe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return xh(t,Bf),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},t}(),EPe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[r],e[r]=a[n];return e},t.prototype.glyphsFor=function(e){var r,n,a,s,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[s=e[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},t.prototype.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v;for(a in n=Gre.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},v=n.charMap)h[(c=v[a]).old]=c.new;for(m in A=n.maxGlyphID,o)m in h||(h[m]=A++);return d=function(y){var b,w;for(b in w={},y)w[y[b]]=b;return w}(h),f=Object.keys(d).sort(function(y,b){return y-b}),p=function(){var y,b,w;for(w=[],y=0,b=f.length;y<b;y++)l=f[y],w.push(d[l]);return w}(),s=this.font.glyf.encode(o,p,h),u=this.font.loca.encode(s.offsets,p),x={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();rn.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+r},e}();const zk=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:nPe,AcroFormAppearance:cn,AcroFormButton:_o,AcroFormCheckBox:kb,AcroFormChoiceField:Qp,AcroFormComboBox:Hp,AcroFormEditBox:Tb,AcroFormListBox:Vp,AcroFormPasswordField:Fb,AcroFormPushButton:Bb,AcroFormRadioButton:$p,AcroFormTextField:mm,GState:B2,ShadingPattern:V0,TilingPattern:Pp,default:rn,jsPDF:rn},Symbol.toStringTag,{value:"Module"}));async function XV(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:yr.now()};return Gn(Ct(Ce,"inventory_batches"),e)}async function qre(t,e){await kn(Yt(Ce,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:yr.now()})}async function SPe(t,e){const r=sr(Ct(Ce,"batch_allocations"),cr("saleDate",">=",t),cr("saleDate","<=",e)),n=await Ht(r),a={};return n.forEach(s=>{const o=s.data(),l=o.batchId;a[l]||(a[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),a[l].quantity+=Number(o.quantity||0),a[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(a)}async function zre(t){const e=Yt(Ce,"salesV2",t),r=await gs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const u=String((c==null?void 0:c.batchId)||"").trim(),d=Number((c==null?void 0:c.qty)||0);u&&d&&a.push({batchId:u,qty:d})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),u=Number((l==null?void 0:l.qty)||0);c&&u&&a.push({batchId:c,qty:u})}if(a.length===0)return await zs(Ce,async l=>{l.delete(e)}),{restored:0};const s=new Map;for(const l of a)s.set(l.batchId,Number((s.get(l.batchId)||0)+l.qty));let o=0;return await zs(Ce,async l=>{const c=Array.from(s.entries()),u=c.map(([f])=>Yt(Ce,"inventory_batches",f)),d=await Promise.all(u.map(f=>l.get(f)));c.forEach(([f,A],h)=>{const m=d[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),v=Number((x+Number(A||0)).toFixed(3));l.update(u[h],{remaining:v}),o+=Number(A||0)}),l.delete(e)}),{restored:o}}var Wre={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},YV=oi.createContext&&oi.createContext(Wre),jPe=["attr","size","title"];function IPe(t,e){if(t==null)return{};var r=PPe(t,e),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)n=s[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function PPe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function RS(){return RS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},RS.apply(this,arguments)}function JV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function MS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JV(Object(r),!0).forEach(function(n){TPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function TPe(t,e,r){return e=BPe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BPe(t){var e=kPe(t,"string");return typeof e=="symbol"?e:e+""}function kPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xre(t){return t&&t.map((e,r)=>oi.createElement(e.tag,MS({key:r},e.attr),Xre(e.child)))}function FPe(t){return e=>oi.createElement(OPe,RS({attr:MS({},t.attr)},e),Xre(t.child))}function OPe(t){var e=r=>{var{attr:n,size:a,title:s}=t,o=IPe(t,jPe),l=a||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),oi.createElement("svg",RS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:MS(MS({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&oi.createElement("title",null,s),t.children)};return YV!==void 0?oi.createElement(YV.Consumer,null,r=>e(r)):e(Wre)}function DPe(t){return FPe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Mc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(DPe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}function Lc(){const[t,e]=g.useState(0),r=g.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const pl=t=>Math.round((Number(t)||0)*100)/100,Th=t=>Math.round((Number(t)||0)*1e3)/1e3,td=t=>Number(t??0).toFixed(2),Bh=t=>Number(t??0).toFixed(3),ZV=(t,e)=>{var o;const r=t.date?String(t.date):"",n=(o=t.timestamp)!=null&&o.toDate?Lr(t.timestamp.toDate(),"yyyy-MM-dd"):"";let a=r||n;if(r&&n){const l=new Date(r+"T00:00:00").getTime(),c=new Date(n+"T00:00:00").getTime(),u=Math.abs(l-c)/(1e3*60*60*24);isFinite(u)&&u>30&&(a=n)}if(!a)return[];const s=t.type??"CONTADO";return Array.isArray(t.items)&&t.items.length>0?t.items.map((l,c)=>{const u=Number((l==null?void 0:l.qty)??0),d=Number((l==null?void 0:l.lineFinal)??0)||Math.max(0,Number((l==null?void 0:l.unitPrice)||0)*u-Number((l==null?void 0:l.discount)||0));return{id:`${e}#${c}`,productName:String((l==null?void 0:l.productName)??"(sin nombre)"),quantity:u,amount:pl(d),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String((l==null?void 0:l.measurement)??t.measurement??""),allocations:Array.isArray(l==null?void 0:l.allocations)?l.allocations:t.allocations,avgUnitCost:Number((l==null?void 0:l.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((l==null?void 0:l.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String(t.measurement??""),allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]};function RPe({role:t,roles:e}){const[r,n]=g.useState([]),[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),[m,p]=g.useState("ALL"),[x,v]=g.useState({}),[y,b]=g.useState(null),[w,I]=g.useState(0),[j,C]=g.useState(0),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState("0"),G=Lr(new Date,"yyyy-MM-dd"),[ce,ue]=g.useState(G),[le,Ae]=g.useState(G),[ae,_e]=g.useState(!1),[De,O]=g.useState(!1),[H,K]=g.useState(!1),[R,X]=g.useState(""),Y=g.useRef(null),{refreshKey:D,refresh:Q}=Lc(),te=e&&e.length?e:t,be=cbe(te,"bills","cerrarVentas"),U=En(te,"admin"),Xe=({title:me,open:we,onToggle:pt,right:vt})=>i.jsxs("button",{type:"button",onClick:pt,className:"w-full flex items-center justify-between gap-3 px-4 py-3 rounded-xl border bg-gray-50 hover:bg-gray-100 active:bg-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.jsx("span",{className:"font-semibold truncate",children:me}),vt?i.jsx("span",{className:"text-xs text-gray-600",children:vt}):null]}),i.jsx("div",{className:"shrink-0 text-lg font-bold leading-none",children:we?"":"+"})]});g.useEffect(()=>{if(!ce||!le)return;u(!0);const me=sr(Ct(Ce,"salesV2"),cr("date",">=",ce),cr("date","<=",le)),we=Pd(me,pt=>{const vt=[];pt.forEach(bt=>{const kt=ZV(bt.data(),bt.id);vt.push(...kt)}),n(vt),u(!1)},pt=>{console.error("Error cargando ventas por periodo:",pt),n([]),u(!1)});return()=>we()},[ce,le,D]),g.useEffect(()=>{if(!ce||!le)return;const me=sr(Ct(Ce,"salesV2"),cr("status","==","FLOTANTE"),cr("date",">=",ce),cr("date","<=",le)),we=Pd(me,pt=>{const vt=[];pt.forEach(bt=>{const kt=ZV(bt.data(),bt.id);vt.push(...kt)}),s(vt)});return()=>we()},[ce,le,D]),g.useEffect(()=>{(async()=>{try{const me=await Ht(Ct(Ce,"users")),we={};me.forEach(pt=>{const vt=pt.data(),bt=String(vt.email||"").trim().toLowerCase(),kt=String(vt.name||"").trim();bt&&(we[bt]=kt||vt.email||"")}),v(we)}catch(me){console.error("Error cargando usuarios:",me),v({})}})()},[]);const se=me=>{const we=String(me||"").trim().toLowerCase();return x[we]||me||""};g.useEffect(()=>{(async()=>{const we=sr(Ct(Ce,"daily_closures"),cr("date","==",G)),pt=await Ht(we);if(pt.empty)l(null);else{const vt=pt.docs[0];l({id:vt.id,...vt.data()})}})()},[G,D]);const ee=oi.useMemo(()=>{let me=[];if(A==="FLOTANTE"){const pt=[...r,...a],vt=new Map;for(const bt of pt)bt.status==="FLOTANTE"&&vt.set(bt.id,bt);me=Array.from(vt.values())}else if(A==="ALL"){const pt=[...r,...a],vt=new Map;for(const bt of pt)vt.set(bt.id,bt);me=Array.from(vt.values())}else me=r.filter(pt=>pt.status==="PROCESADA");m!=="ALL"&&(me=me.filter(pt=>pt.type===m));const we=R.trim().toLowerCase();if(we){const pt=bt=>String(bt||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),vt=pt(we);me=me.filter(bt=>pt(bt.productName).includes(vt))}return me},[A,r,a,R,m]),Fe=pl(ee.reduce((me,we)=>me+(we.amount||0),0)),je=pl(ee.reduce((me,we)=>me+Number(we.cogsAmount??0),0)),Se=me=>String(me||"").trim().toLowerCase()!=="lb",Ze=ee.filter(me=>me.type==="CONTADO"),ut=ee.filter(me=>me.type==="CREDITO"),Et=Th(Ze.filter(me=>Se(me.measurement)).reduce((me,we)=>me+(we.quantity||0),0)),St=Th(Ze.filter(me=>!Se(me.measurement)).reduce((me,we)=>me+(we.quantity||0),0)),Ft=Th(ut.filter(me=>Se(me.measurement)).reduce((me,we)=>me+(we.quantity||0),0)),Qt=Th(ut.filter(me=>!Se(me.measurement)).reduce((me,we)=>me+(we.quantity||0),0)),Ut=pl(Ze.reduce((me,we)=>me+(we.amount||0),0)),Tt=pl(ut.reduce((me,we)=>me+(we.amount||0),0)),Re=pl(Ze.reduce((me,we)=>me+Number(we.cogsAmount??0),0)),Te=pl(ut.reduce((me,we)=>me+Number(we.cogsAmount??0),0)),Ye=pl(Ut-Re),ht=pl(Tt-Te),Oe=Th(Et+Ft),Ie=Th(St+Qt),We=pl(Ut+Tt),Z={};ee.forEach(me=>{const we=me.productName||"(sin nombre)";Z[we]||(Z[we]={totalQuantity:0,totalAmount:0}),Z[we].totalQuantity=Th(Z[we].totalQuantity+(me.quantity||0)),Z[we].totalAmount=pl(Z[we].totalAmount+(me.amount||0))});const Qe=Object.entries(Z).map(([me,we])=>({productName:me,totalQuantity:we.totalQuantity,totalAmount:we.totalAmount})),at=async()=>{try{const me=ee.filter(ke=>ke.status==="FLOTANTE"),we=me.length>0?me:r.filter(ke=>ke.status!=="PROCESADA");if(we.length===0){f("No hay ventas para procesar.");return}const pt={totalCharged:pl(we.reduce((ke,Ne)=>ke+(Ne.amount||0),0)),totalSuggested:pl(we.reduce((ke,Ne)=>ke+(Ne.amountSuggested||0),0)),totalUnits:Th(we.reduce((ke,Ne)=>ke+(Ne.quantity||0),0)),totalCOGS:pl(we.reduce((ke,Ne)=>ke+Number(Ne.cogsAmount??0),0))},vt=pl(pt.totalCharged-pt.totalSuggested),bt=pl(pt.totalCharged-pt.totalCOGS),kt=await Gn(Ct(Ce,"daily_closures"),{date:G,createdAt:yr.now(),periodStart:ce,periodEnd:le,totalCharged:pt.totalCharged,totalSuggested:pt.totalSuggested,totalDifference:vt,totalUnits:pt.totalUnits,totalCOGS:pt.totalCOGS,grossProfit:bt,products:we.map(ke=>({productName:ke.productName,quantity:ke.quantity,amount:ke.amount})),salesV2:we.map(ke=>({id:ke.id,productName:ke.productName,quantity:ke.quantity,amount:ke.amount,amountSuggested:ke.amountSuggested,userEmail:ke.userEmail,clientName:ke.clientName,amountReceived:ke.amountReceived,change:ke.change,status:ke.status,cogsAmount:ke.cogsAmount??0,avgUnitCost:ke.avgUnitCost??null,allocations:ke.allocations??[],date:ke.date})),productSummary:Object.entries(we.reduce((ke,Ne)=>{const pe=Ne.productName||"(sin nombre)";return ke[pe]||(ke[pe]={totalQuantity:0,totalAmount:0}),ke[pe].totalQuantity=Th(ke[pe].totalQuantity+(Ne.quantity||0)),ke[pe].totalAmount=pl(ke[pe].totalAmount+(Ne.amount||0)),ke},{})).map(([ke,Ne])=>({productName:ke,totalQuantity:Ne.totalQuantity,totalAmount:Ne.totalAmount}))}),Vt=Ic(Ce);we.forEach(ke=>{Vt.update(Yt(Ce,"salesV2",ke.id.split("#")[0]),{status:"PROCESADA",closureId:kt.id,closureDate:G,date:ke.date})}),await Vt.commit(),f(` Cierre guardado. Ventas procesadas: ${we.length}.`)}catch(me){console.error(me),f(" Error al guardar el cierre.")}},Ge=async me=>{if(!U){f(" No tienes permisos para revertir esta venta.");return}if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await kn(Yt(Ce,"salesV2",me.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),f(" Venta revertida a FLOTANTE.")}catch(we){console.error(we),f(" No se pudo revertir la venta.")}},ie=me=>{if(!U){f(" No tienes permisos para editar esta venta.");return}b(me),I(me.quantity),C(me.amount),E(me.clientName),k(me.amountReceived),P(me.change)},xe=async()=>{if(!U){f(" No tienes permisos para guardar cambios.");return}if(y)try{await kn(Yt(Ce,"salesV2",y.id.split("#")[0]),{quantity:w,amount:j,amountCharged:j,clientName:S,amountReceived:B,change:T}),b(null),f(" Venta actualizada.")}catch(me){console.error(me),f(" No se pudo actualizar la venta.")}},de=async me=>{if(!U){f(" No tienes permisos para eliminar esta venta.");return}if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:we}=await zre(me.split("#")[0]);f(` Venta eliminada. Stock restaurado: ${Number(we).toFixed(2)}.`)}catch(we){console.error(we),f(" No se pudo eliminar la venta.")}},Me=async()=>{if(Y.current){Y.current.classList.add("force-pdf-colors"),Y.current.classList.add("pdf-print-mode");try{const we=(await Hm(Y.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),pt=new rn;pt.addImage(we,"PNG",10,10,190,0),pt.save(`cierre_${G}.pdf`)}finally{Y.current.classList.remove("pdf-print-mode"),Y.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[i.jsxs("h2",{className:"text-2xl font-bold",children:["Cierre de Ventas - ",ce,"  ",le]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(Mc,{onClick:Q})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx(Xe,{title:"Filtros",open:ae,onToggle:()=>_e(me=>!me),right:i.jsxs("span",{className:"ml-1",children:[ce,"  ",le,A!=="ALL"?`  ${A}`:"",m!=="ALL"?`  ${m==="CREDITO"?"Crdito":"Cash"}`:"",R.trim()?`  "${R.trim()}"`:""]})}),ae&&i.jsx("div",{className:"mt-3 border rounded-xl p-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Periodo desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:ce,onChange:me=>ue(me.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:le,onChange:me=>Ae(me.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:A,onChange:me=>h(me.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Tipo Operacin"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:m,onChange:me=>p(me.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),i.jsx("option",{value:"CREDITO",children:"Crdito"}),i.jsx("option",{value:"CONTADO",children:"Cash"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-2 w-full",placeholder:"Buscar por producto...",value:R,onChange:me=>X(me.target.value)})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:Y,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[ee.map(me=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${me.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:me.status})}),i.jsx("td",{className:"border p-1",children:me.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:me.productName}),i.jsx("td",{className:"border p-1",children:Bh(me.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(me.amount)]}),i.jsx("td",{className:"border p-1",children:me.date}),i.jsx("td",{className:"border p-1",children:se(me.userEmail)}),i.jsx("td",{className:"border p-1",children:me.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:U?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ie(me),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>de(me.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):me.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:U?i.jsx("button",{onClick:()=>Ge(me.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},me.id)),ee.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden mb-4",children:[i.jsx(Xe,{title:"Ventas",open:De,onToggle:()=>O(me=>!me),right:i.jsxs("span",{className:"ml-1",children:[ee.length,"  C$",td(Fe)]})}),De&&i.jsxs("div",{className:"mt-3 space-y-3",children:[ee.map(me=>i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:me.productName}),i.jsx("div",{className:"text-xs text-gray-500",children:me.date})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",td(me.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${me.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:me.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cantidad"}),i.jsx("strong",{children:Bh(me.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("strong",{children:me.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:se(me.userEmail)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("strong",{className:"text-right break-all",children:me.clientName||""})]}),i.jsx("div",{className:"pt-2",children:me.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:U?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ie(me),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>de(me.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):me.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:U?i.jsx("button",{onClick:()=>Ge(me.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},me.id)),ee.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Total libras Cash: ",i.jsx("strong",{children:Bh(St)})]}),i.jsxs("div",{children:["Total Unidades cash: ",i.jsx("strong",{children:Bh(Et)})]}),i.jsxs("div",{children:["Total libras credito: ",i.jsx("strong",{children:Bh(Qt)})]}),i.jsxs("div",{children:["Total Unidades credito: ",i.jsx("strong",{children:Bh(Ft)})]}),i.jsxs("div",{children:["Total facturado Cash: ",i.jsxs("strong",{children:["C$",td(Re)]})]}),i.jsxs("div",{children:["Total facturado credito:"," ",i.jsxs("strong",{children:["C$",td(Te)]})]}),i.jsxs("div",{children:["Total venta Cash: ",i.jsxs("strong",{children:["C$",td(Ut)]})]}),i.jsxs("div",{children:["Total venta Credito: ",i.jsxs("strong",{children:["C$",td(Tt)]})]}),i.jsxs("div",{children:["Utilidad bruta Cash: ",i.jsxs("strong",{children:["C$",td(Ye)]})]}),i.jsxs("div",{children:["Utilidad bruta credito:"," ",i.jsxs("strong",{children:["C$",td(ht)]})]}),i.jsxs("div",{children:["Total libras cash y credito: ",i.jsx("strong",{children:Bh(Ie)})]}),i.jsxs("div",{children:["Total unidades cash y credito:"," ",i.jsx("strong",{children:Bh(Oe)})]}),i.jsxs("div",{children:["Total ventas Cash y credito:"," ",i.jsxs("strong",{children:["C$",td(We)]})]}),i.jsxs("div",{children:["Total facturado a precio compra:"," ",i.jsxs("strong",{children:["C$",td(je)]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx(Xe,{title:"Consolidado por producto",open:H,onToggle:()=>K(me=>!me),right:i.jsx("span",{className:"ml-1",children:Qe.length})}),H&&i.jsx("div",{className:"mt-3",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[Qe.map(me=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:me.productName}),i.jsx("td",{className:"border p-1",children:Bh(me.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(me.totalAmount)]})]},me.productName)),Qe.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[i.jsx("button",{disabled:!be,onClick:at,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:Me,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),y&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[y.productName,"  ",se(y.userEmail)]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:w,onChange:me=>I(parseFloat(me.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:j,onChange:me=>C(parseFloat(me.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:S,onChange:me=>E(me.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:me=>k(parseFloat(me.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:T,onChange:me=>P(me.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>b(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:xe,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const rd=t=>Number(t??0).toFixed(2),px=t=>Number(t??0).toFixed(3);function MPe(){var y,b,w,I;const t=async j=>{if(!window.confirm(`Eliminar el cierre del ${j.date}?`))return;const C=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(C){const S=await Ht(sr(Ct(Ce,"salesV2"),cr("closureId","==",j.id)));if(!S.empty){const E=Ic(Ce);S.forEach(B=>{E.update(Yt(Ce,"salesV2",B.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await E.commit()}}await Wn(Yt(Ce,"daily_closures",j.id)),(u==null?void 0:u.id)===j.id&&d(null),await m(),A(` Cierre eliminado${C?" y ventas reabiertas.":"."}`)}catch(S){console.error(S),A(" No se pudo eliminar el cierre.")}},[e,r]=g.useState(Lr(Jee(new Date),"yyyy-MM-dd")),[n,a]=g.useState(Lr(new Date,"yyyy-MM-dd")),[s,o]=g.useState(!0),[l,c]=g.useState([]),[u,d]=g.useState(null),[f,A]=g.useState(""),h=g.useRef(null),m=async()=>{try{o(!0);const j=sr(Ct(Ce,"daily_closures"),cr("date",">=",e),cr("date","<=",n)),C=await Ht(j),S=[];C.forEach(E=>S.push({id:E.id,...E.data()})),S.sort((E,B)=>E.date<B.date?1:E.date>B.date?-1:0),c(S)}catch(j){console.error(j),A(" Error cargando el historial.")}finally{o(!1)}};g.useEffect(()=>{m()},[]);const p=async j=>{j.preventDefault(),m()},x=g.useMemo(()=>{if(!u)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const j=Number(u.totalUnits??0),C=Number(u.totalSuggested??0),S=Number(u.totalCharged??0),E=Number(u.totalDifference??(isFinite(S-C)?S-C:0)),B=Number(u.totalCOGS??0),k=Number(u.grossProfit??(isFinite(S-B)?S-B:0));return{units:j,sug:C,chg:S,diff:E,cogs:B,profit:k}},[u]),v=async()=>{if(!h.current||!u)return;const j=h.current;j.classList.add("force-pdf-colors");try{const[{default:C},{jsPDF:S}]=await Promise.all([lA(()=>Promise.resolve().then(()=>q6),void 0),lA(()=>Promise.resolve().then(()=>zk),void 0)]),B=(await C(j,{backgroundColor:"#ffffff",onclone:P=>{const G=P.defaultView;P.body.querySelectorAll("*").forEach(ue=>{const le=G.getComputedStyle(ue);le.color&&(ue.style.color=le.color),le.backgroundColor&&le.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ue.style.backgroundColor=le.backgroundColor),le.borderColor&&(ue.style.borderColor=le.borderColor)})}})).toDataURL("image/png"),{jsPDF:k}=await lA(async()=>{const{jsPDF:P}=await Promise.resolve().then(()=>zk);return{jsPDF:P}},void 0),T=new k;T.addImage(B,"PNG",10,10,190,0),T.save(`cierre_${u.date}.pdf`)}finally{j.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:j=>r(j.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:j=>a(j.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),s?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(j=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.date}),i.jsx("td",{className:"border p-1",children:px(j.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.grossProfit??Number(j.totalCharged??0)-Number(j.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>d(j),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(j),children:"Eliminar"})]})})]},j.id))})]}),u&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",u.date]}),i.jsx("button",{onClick:()=>d(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:v,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:px(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",rd(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",rd(x.profit)]})]})]}),(y=u.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:u.salesV2.map((j,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:px(j.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:j.date??""}),i.jsx("td",{className:"border p-1",children:j.userEmail??""})]},C))})]})]}):(b=u.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:u.sales.map((j,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:px(j.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.amount)]}),i.jsx("td",{className:"border p-1",children:j.userEmail??""}),i.jsx("td",{className:"border p-1",children:j.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof j.change=="number"?rd(j.change):j.change??"0"})]},C))})]})]}):(w=u.products)!=null&&w.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:u.products.map((j,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName}),i.jsx("td",{className:"border p-1",children:px(j.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.amount)]})]},C))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(I=u.productSummary)!=null&&I.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:u.productSummary.map((j,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName}),i.jsx("td",{className:"border p-1",children:px(j.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(j.totalAmount)]})]},C))})]})]}):null]})]}),f&&i.jsx("p",{className:"mt-3 text-sm",children:f})]})}function LPe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(""),[o,l]=g.useState(!1),[c,u]=g.useState(["vendedor_pollo"]),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState([]),[x,v]=g.useState(!0),[y,b]=g.useState(null),[w,I]=g.useState(["vendedor_pollo"]),[j,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(!1),[T,P]=g.useState([]),G=R=>!R||R==="vendedor"?"vendedor_pollo":R==="admin"||R==="supervisor_pollo"||R==="contador"||R==="vendedor_pollo"||R==="vendedor_ropa"||R==="vendedor_dulces"?R:"vendedor_pollo",ce=R=>R?Array.isArray(R)?R.map(X=>G(String(X))):[G(String(R))]:["vendedor_pollo"],ue=async()=>{v(!0);const R=await Ht(Ct(Ce,"users")),X=[];R.forEach(Y=>{const D=Y.data();X.push({id:Y.id,email:D.email??"",name:D.name??"",roles:ce(D.roles??D.role),sellerCandyId:D.sellerCandyId??""})}),p(X),v(!1)},le=async()=>{try{const R=await Ht(Ct(Ce,"sellers_candies")),X=[];R.forEach(Y=>{const D=Y.data();X.push({id:Y.id,name:D.name??"(sin nombre)",branchLabel:D.branch??"",commissionPercent:Number(D.commissionPercent??0)})}),P(X)}catch(R){console.error("Error cargando sellers_candies:",R)}};g.useEffect(()=>{ue(),le()},[]);const Ae=()=>{e(""),n(""),s(""),u(["vendedor_pollo"]),h("")},ae=async R=>{if(R.preventDefault(),f(""),y){if(a&&a.length>0&&a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}}else if(a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}if(!t.trim()){f(" El nombre es obligatorio.");return}try{if(y){const U=Yt(Ce,"users",y),Xe=w.length?w:["vendedor_pollo"],se=Xe.includes("vendedor_dulces")&&(j||A)||"";if(await kn(U,{email:r,name:t.trim(),roles:Xe,role:Xe[0]||"vendedor_pollo",sellerCandyId:se}),p(ee=>ee.map(Fe=>Fe.id===y?{...Fe,email:r,name:t.trim(),roles:Xe,sellerCandyId:se}:Fe)),a&&a.length>=6)try{const ee=GB(),Fe=S||r;await Ege(ee,Fe),f(` Usuario actualizado. Se envi correo de restablecimiento a ${Fe}`)}catch(ee){console.error("Error sending password reset:",ee),f(" Usuario actualizado. No se pudo enviar correo de restablecimiento.")}else f(" Usuario actualizado correctamente.");De();return}const X=BD(),Y=TD(X.options,"Secondary"),D=GB(Y),Q=await Sge(D,r,a),te=c.length?c:["vendedor_pollo"],be=te.includes("vendedor_dulces")&&A||"";await Bee(Yt(Ct(Ce,"users"),Q.user.uid),{email:r,name:t.trim(),roles:te,role:te[0]||"vendedor_pollo",sellerCandyId:be}),await UD(D),await vpe(Y),p(U=>[{id:Q.user.uid,email:r,name:t.trim(),roles:te,sellerCandyId:be},...U]),f(" Usuario creado correctamente."),Ae(),k(!1)}catch(X){console.error(X),f(" Error al crear el usuario: "+X.message)}},_e=R=>{b(R.id),e(R.name||""),n(R.email||""),E(R.email||""),I(R.roles&&R.roles.length?R.roles:["vendedor_pollo"]),h(R.sellerCandyId||""),C(R.sellerCandyId||""),s(""),k(!0)},De=()=>{b(null),I(["vendedor_pollo"]),C(""),E(""),Ae(),k(!1)},O=async R=>{confirm("Eliminar este usuario del listado?")&&(await Wn(Yt(Ce,"users",R)),p(Y=>Y.filter(D=>D.id!==R)))},H=R=>{const X=R==="admin"?"admin":R==="supervisor_pollo"?"supervisor_pollo":R==="vendedor_ropa"?"vendedor_ropa":R==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",Y=X==="admin"?"bg-blue-100 text-blue-700":X==="supervisor_pollo"?"bg-amber-100 text-amber-700":X==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":X==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Y}`,children:X})},K=R=>`${R.name}  ${R.branchLabel||"Sin sucursal"}  ${R.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>k(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(R=>{const X=y===R.id,Y=(X?w:R.roles).includes("vendedor_dulces");return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:R.name||""}),i.jsx("td",{className:"p-2 border",children:R.email}),i.jsx("td",{className:"p-2 border",children:X?i.jsxs("div",{className:"space-y-2 text-left",children:[["supervisor_pollo","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(D=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:w.includes(D),onChange:()=>I(Q=>Q.includes(D)?Q.filter(te=>te!==D):[...Q,D])}),i.jsx("span",{className:"text-sm",children:D})]},D)),w.includes("vendedor_dulces")&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs mt-1",value:j,onChange:D=>C(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),T.map(D=>i.jsx("option",{value:D.id,children:K(D)},D.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex gap-2 justify-center",children:R.roles.map(D=>i.jsx("span",{children:H(D)},D))}),Y&&R.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>_e(R),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(R.id),children:"Eliminar"})]})})]},R.id)})})]})}),d&&i.jsx("p",{className:"text-sm mt-2",children:d}),B&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>k(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:y?"Editar usuario":"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:De,type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:R=>e(R.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:R=>n(R.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:a,onChange:R=>s(R.target.value),required:!y}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(R=>!R),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Roles"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["supervisor_pollo","contador","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(R=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:y?w.includes(R):c.includes(R),onChange:()=>{y?I(X=>X.includes(R)?X.filter(Y=>Y!==R):[...X,R]):u(X=>X.includes(R)?X.filter(Y=>Y!==R):[...X,R])}}),i.jsx("span",{className:"text-sm",children:R})]},R))})]}),(y?w.includes("vendedor_dulces"):c.includes("vendedor_dulces"))&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:A,onChange:R=>h(R.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),T.map(R=>i.jsx("option",{value:R.id,children:K(R)},R.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:De,children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:y?"Guardar cambios":"Crear usuario"})]})]}),d&&i.jsx("p",{className:"text-sm mt-2",children:d})]})]})]})}const eH=t=>`C$${(Number(t)||0).toFixed(2)}`;function UPe(){const[t,e]=g.useState(""),[r,n]=g.useState(0),[a,s]=g.useState(0),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState([]),[m,p]=g.useState(!0),[x,v]=g.useState(!1),[y,b]=g.useState(null),[w,I]=g.useState(""),[j,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState(0),[G,ce]=g.useState(!1),ue=async()=>{p(!0);const K=await Ht(Ct(Ce,"products")),R=[];K.forEach(X=>{const Y=X.data();R.push({id:X.id,name:Y.name??"",price:Number(Y.price??0),providerPrice:Number(Y.providerPrice??0),category:Y.category??"",measurement:Y.measurement??"",active:Y.active!==!1})}),h(R),p(!1)};g.useEffect(()=>{ue()},[]);const le=async K=>{if(K.preventDefault(),l(""),!t||r<=0||!d){l(" Completa nombre, precio vlido y unidad de medida");return}try{const R={name:t,price:parseFloat(r.toFixed(2)),providerPrice:parseFloat((a||0).toFixed(2)),category:c,measurement:d,active:!0},X=await Gn(Ct(Ce,"products"),R);h(Y=>[{id:X.id,...R},...Y]),l(" Producto registrado con exito."),e(""),n(0),s(0),f(""),u(""),ce(!1)}catch(R){l(" Error: "+R.message)}},Ae=K=>{b(K.id),I(K.name),C(K.category),E(K.measurement),k(K.price),P(K.providerPrice||0)},ae=()=>{b(null),I(""),C(""),E(""),k(0)},_e=async()=>{if(!y)return;const K=Yt(Ce,"products",y);await kn(K,{name:w,category:j,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((T||0).toFixed(2))}),h(R=>R.map(X=>X.id===y?{...X,name:w,category:j,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((T||0).toFixed(2))}:X)),ae()},De=async K=>{const R=Yt(Ce,"products",K.id),X=K.active===!1;await kn(R,{active:X}),h(Y=>Y.map(D=>D.id===K.id?{...D,active:X}:D))},O=async K=>{const R=sr(Ct(Ce,"inventory_batches"),cr("productId","==",K),yS(1));if(!(await Ht(R)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await Wn(Yt(Ce,"products",K)),h(D=>D.filter(Q=>Q.id!==K)))},H=x?A:A.filter(K=>K.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{l(""),ce(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),G&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>ce(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ce(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:le,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:c,onChange:K=>u(K.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:K=>e(K.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:d,onChange:K=>f(K.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio proveedor (ej: 40.00)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(a)?"":a,onChange:K=>s(parseFloat(K.target.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:K=>n(parseFloat(K.target.value)),onFocus:K=>K.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),o&&i.jsx("p",{className:"text-sm mt-2",children:o})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:K=>v(K.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):H.map(K=>{const R=y===K.id,X=K.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:R?i.jsx("input",{className:"w-full border p-1 rounded",value:w,onChange:Y=>I(Y.target.value)}):K.name}),i.jsx("td",{className:"p-2 border",children:R?i.jsxs("select",{className:"w-full border p-1 rounded",value:j,onChange:Y=>C(Y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):K.category}),i.jsx("td",{className:"p-2 border",children:R?i.jsxs("select",{className:"w-full border p-1 rounded",value:S,onChange:Y=>E(Y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):K.measurement}),i.jsx("td",{className:"p-2 border",children:R?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(T)?"":T,onChange:Y=>P(parseFloat(Y.target.value))}):eH(K.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:R?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(B)?"":B,onChange:Y=>k(parseFloat(Y.target.value))}):eH(K.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${X?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:X?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:R?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:_e,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ae,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ae(K),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${X?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>De(K),children:X?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(K.id),children:"Eliminar"})]})})]},K.id)})})]})})]})}const gl=[];for(let t=0;t<256;++t)gl.push((t+256).toString(16).slice(1));function QPe(t,e=0){return(gl[t[e+0]]+gl[t[e+1]]+gl[t[e+2]]+gl[t[e+3]]+"-"+gl[t[e+4]]+gl[t[e+5]]+"-"+gl[t[e+6]]+gl[t[e+7]]+"-"+gl[t[e+8]]+gl[t[e+9]]+"-"+gl[t[e+10]]+gl[t[e+11]]+gl[t[e+12]]+gl[t[e+13]]+gl[t[e+14]]+gl[t[e+15]]).toLowerCase()}let y5;const VPe=new Uint8Array(16);function HPe(){if(!y5){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");y5=crypto.getRandomValues.bind(crypto)}return y5(VPe)}const $Pe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tH={randomUUID:$Pe};function GPe(t,e,r){var a;if(tH.randomUUID&&!t)return tH.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??HPe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,QPe(n)}async function KPe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const a=Ct(t,"inventory_batches"),s=sr(a,cr("productName","==",e)),c=(await Ht(s)).docs.map(u=>({id:u.id,data:u.data()})).sort((u,d)=>{var p,x;const f=u.data.date??"",A=d.data.date??"";if(f!==A)return f<A?-1:1;const h=((p=u.data.createdAt)==null?void 0:p.seconds)??0,m=((x=d.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(u=>Yt(t,"inventory_batches",u.id));return zs(t,async u=>{let d=Number(r);const f=[],A=await Promise.all(c.map(x=>u.get(x)));for(let x=0;x<c.length&&d>0;x++){const v=c[x],y=A[x];if(!y.exists())continue;const b=y.data(),w=Number(b.quantity??0),I=Number(b.remaining??w??0),j=Number(b.purchasePrice??0);if(I<=0)continue;const C=Math.min(I,d),S=Number((I-C).toFixed(3));u.update(v,{remaining:S}),f.push({batchId:v.id,qty:C,unitCost:j,lineCost:Number((C*j).toFixed(2))}),d=Number((d-C).toFixed(3))}if(d>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${d} unidades.`);const h=Number(f.reduce((x,v)=>x+v.lineCost,0).toFixed(2)),m=f.reduce((x,v)=>x+v.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:f,avgUnitCost:p,cogsAmount:h}})}const Yre=3,qPe=.5*10**-Yre;function ms(t){const e=Number(t??0);return Number(e.toFixed(Yre))}function b5(t,e){return ms((t??0)+(e??0))}function QC(t,e){return ms(t)+qPe>=ms(e)}async function zPe(t,e){const r=await Ht(Ct(Ce,"inventory_batches")),n=t.trim().toLowerCase();let a=0;for(const s of r.docs){const o=s.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await kn(Yt(Ce,"inventory_batches",s.id),{productId:e}),a++)}return a}const m0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function rH({user:t,role:e,roles:r}){r&&r.length;const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState(""),[u,d]=g.useState(Lr(new Date,"yyyy-MM-dd")),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState(0),[b,w]=g.useState(0),[I,j]=g.useState("0"),[C,S]=g.useState(""),[E,B]=g.useState(!1),[k,T]=g.useState({}),P=Re=>Math.round(Re*100)/100,G=Re=>ms(Re).toFixed(3),[ce,ue]=g.useState("CONTADO"),[le,Ae]=g.useState([]),[ae,_e]=g.useState(""),[De,O]=g.useState(0),H=Re=>{ue(Re),Re==="CREDITO"?(A(""),w(0),j("0.00")):(_e(""),O(0))},K=Re=>{const Te=Number(Re.specialPrice||0);return Te>0?Te:Number(Re.price||0)},R=async Re=>{if(!Re)return 0;const Te=sr(Ct(Ce,"inventory_batches"),cr("productId","==",Re)),Ye=await Ht(Te);let ht=0;return Ye.forEach(Oe=>{const Ie=Oe.data();ht=b5(ht,Number(Ie.remaining||0))}),ms(ht)},X=async Re=>{if(!Re)return 0;const Te=await Ht(Ct(Ce,"inventory_batches"));let Ye=0;return Te.forEach(ht=>{const Oe=ht.data();(Oe.productName||"").trim().toLowerCase()===Re.trim().toLowerCase()&&(Ye=b5(Ye,Number(Oe.remaining||0)))}),ms(Ye)};g.useEffect(()=>{(async()=>{const Re=await Ht(Ct(Ce,"products")),Te=[];Re.forEach(Ye=>{const ht=Ye.data();(ht==null?void 0:ht.active)!==!1&&Te.push({id:Ye.id,productName:ht.name??ht.productName??"(sin nombre)",price:Number(ht.price??0),measurement:ht.measurement??"(sin unidad)",category:ht.category??"(sin categora)"})}),a(Te)})()},[]),g.useEffect(()=>{(async()=>{const Re=await Ht(Ct(Ce,"inventory_batches")),Te={};Re.forEach(Ye=>{const ht=Ye.data(),Oe=ht.productId,Ie=Number(ht.remaining||0);Oe&&(Te[Oe]=b5(Te[Oe]||0,Ie))}),Object.keys(Te).forEach(Ye=>Te[Ye]=ms(Te[Ye])),T(Te)})()},[]),g.useEffect(()=>{(async()=>{const Re=await Ht(Ct(Ce,"users")),Te=[];Re.forEach(Ye=>{const ht=Ye.data();Te.push({id:Ye.id,email:ht.email??"(sin email)",role:ht.role??"USER"})}),o(Te)})()},[]);const Y=async()=>{if(!l)return;const Re=n.find(Ye=>Ye.id===l);if(!Re)return;if(p.some(Ye=>Ye.productId===Re.id)){c("");return}const Te=await R(Re.id);x(Ye=>[...Ye,{productId:Re.id,productName:Re.productName,measurement:Re.measurement,price:Number(Re.price||0),specialPrice:0,stock:Te,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},D=async Re=>{if(!Re)return;const Te=n.find(ht=>ht.id===Re);if(!Te||p.some(ht=>ht.productId===Te.id))return;const Ye=await R(Te.id);x(ht=>[...ht,{productId:Te.id,productName:Te.productName,measurement:Te.measurement,price:Number(Te.price||0),specialPrice:0,stock:Ye,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},Q=Re=>{x(Te=>Te.filter(Ye=>Ye.productId!==Re))},te=Re=>{const Te=String(Re||"").replace(",",".");if(Te==="")return"";const Ye=Te.split(".");return Ye.length===1?Te:`${Ye[0]}.${Ye.slice(1).join("")}`},be=async(Re,Te)=>{x(Ye=>Ye.map(ht=>{if(ht.productId!==Re)return ht;const Oe=(ht.measurement||"").toLowerCase()!=="lb",Ie=te(Te);if(Ie.trim()==="")return{...ht,qty:0,qtyInput:""};if(!Oe&&Ie===".")return{...ht,qty:0,qtyInput:"0."};const We=Number(Ie),Z=Number.isFinite(We)?We:0;let Qe=Oe?Math.max(0,Math.round(Z)):ms(Z);const at=Oe?Math.max(0,Math.floor(Number(ht.stock||0))):ms(Number(ht.stock||0));if(Qe>at){Qe=at,S(` Cantidad limitada a existencias (${at})`);const ie=Oe?String(Qe):Qe===0?"":String(Qe);return{...ht,qty:Qe,qtyInput:ie}}const Ge=Oe?String(Qe):Ie.endsWith(".")?Ie:String(Qe);return{...ht,qty:Qe,qtyInput:Ge}}))},U=(Re,Te)=>{x(Ye=>Ye.map(ht=>{if(ht.productId!==Re)return ht;const Oe=te(Te);if(Oe.trim()==="")return{...ht,specialPrice:0,specialPriceInput:""};if(Oe===".")return{...ht,specialPrice:0,specialPriceInput:"0."};const Ie=Number(Oe),We=Number.isFinite(Ie)?Math.max(0,P(Ie)):0,Z=Oe.endsWith(".")?Oe:String(We);return{...ht,specialPrice:We,specialPriceInput:Z}}))},Xe=(Re,Te)=>{x(Ye=>Ye.map(ht=>{if(ht.productId!==Re)return ht;const Oe=te(Te);if(Oe.trim()==="")return{...ht,discount:0,discountInput:""};if(Oe===".")return{...ht,discount:0,discountInput:"0."};const Ie=Number(Oe),We=Number.isFinite(Ie)?Math.max(0,Math.floor(Ie)):0,Z=Oe.endsWith(".")?Oe:String(We);return{...ht,discount:We,discountInput:Z}}))},se=g.useMemo(()=>{let Re=0;for(const Te of p){const Ye=K(Te),ht=Number(Ye||0)*Number(Te.qty||0),Oe=Math.max(0,ht-Math.max(0,Number(Te.discount||0)));Re+=Oe}return P(Re)},[p]);g.useEffect(()=>{y(se)},[se]),g.useEffect(()=>{const Re=Number(b)||0,Te=Number(v)||0;j((Re-Te).toFixed(2))},[b,v]);const ee=Re=>{Re.key===","&&(Re.preventDefault(),Re.target.value+=".")},[Fe,je]=g.useState(!1);g.useEffect(()=>{var Ye;const Re=window.matchMedia("(max-width: 900px)"),Te=()=>je(Re.matches);return Te(),(Ye=Re.addEventListener)==null||Ye.call(Re,"change",Te),()=>{var ht;return(ht=Re.removeEventListener)==null?void 0:ht.call(Re,"change",Te)}},[]),g.useEffect(()=>{(async()=>{try{const Re=await Ht(Ct(Ce,"customers_pollo")),Te=[];Re.forEach(Ye=>{const ht=Ye.data();Te.push({id:Ye.id,name:ht.name??"",phone:ht.phone??"",status:ht.status??"ACTIVO",creditLimit:Number(ht.creditLimit??0),vendorId:ht.vendorId??"",vendorName:ht.vendorName??"",balance:0})});for(const Ye of Te)try{const ht=sr(Ct(Ce,"ar_movements_pollo"),cr("customerId","==",Ye.id)),Oe=await Ht(ht);let Ie=0;Oe.forEach(Z=>{Ie+=Number(Z.data().amount||0)});const We=Number(Ye.initialDebt||0);Ye.balance=Ie+We}catch{Ye.balance=0}Te.sort((Ye,ht)=>(Ye.name||"").localeCompare(ht.name||"")),Ae(Te)}catch(Re){console.error("Error cargando customers_pollo:",Re),Ae([])}})()},[]);const Se=g.useMemo(()=>le.find(Re=>Re.id===ae)||null,[le,ae]),Ze=Number((Se==null?void 0:Se.balance)||0),ut=ce==="CREDITO"?Math.max(0,Number(Ze||0)+Math.max(0,Number(v||0))):0;g.useEffect(()=>{ce==="CREDITO"&&O(Re=>Math.min(Math.max(0,Number(Re||0)),ut))},[ce,ut]),g.useEffect(()=>{ce==="CREDITO"&&(w(Number(De||0)),j("0.00"))},[ce,De]);const Et=ce==="CREDITO"?Ze+Math.max(0,Number(v||0))-Math.max(0,Number(De||0)):0,St=async()=>{if(p.length===0)return"Agrega al menos un producto.";for(const Re of p){if(!Re.qty||Re.qty<=0)return`Cantidad invlida para "${Re.productName}".`;const Te=await R(Re.productId);if(!QC(Te,Re.qty)){const Ye=await X(Re.productName);if(QC(Ye,0)&&!QC(Te,0)){const ht=await zPe(Re.productName,Re.productId),Oe=await R(Re.productId);if(!QC(Oe,Re.qty))return`Stock insuficiente tras corregir ${ht} lote(s) para "${Re.productName}".`}else return`Stock insuficiente para "${Re.productName}". Disponible: ${Te}`}}return null},Ft=async Re=>{var Ye,ht;Re.preventDefault(),S("");const Te=await St();if(Te){S(" "+Te);return}try{B(!0);const Oe=[];if(ce==="CONTADO"){if(!f.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!ae)return"Selecciona un cliente (crdito).";if(De<0)return"El pago inicial no puede ser negativo.";if(De>v)return"El pago inicial no puede superar el total.";if((Se==null?void 0:Se.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede fiar."}for(const ie of p){const xe=ie.qty,{allocations:de,avgUnitCost:Me,cogsAmount:me}=await KPe(Ce,ie.productName,xe,!1),we=K(ie),pt=Number(we||0)*Number(xe||0),vt=Math.max(0,Number(ie.discount||0)),bt=Math.max(0,pt-vt);Oe.push({productId:ie.productId,productName:ie.productName,measurement:ie.measurement,unitPrice:Number(we||0),regularPrice:Number(ie.price||0),specialPrice:Number(ie.specialPrice||0)>0?Number(ie.specialPrice):null,qty:xe,discount:vt,lineTotal:P(pt),lineFinal:P(bt),allocations:de,avgUnitCost:Me,cogsAmount:me})}const Ie=Oe.reduce((ie,xe)=>ie+xe.lineFinal,0),We=Oe.reduce((ie,xe)=>ie+Number(xe.qty||0),0),Z=Number(ce==="CREDITO"?De||0:b||0),Qe=ce==="CREDITO"?"0.00":I,at={id:GPe(),quantity:We,amount:Ie,amountCharged:Ie,timestamp:yr.now(),date:u,userEmail:(t==null?void 0:t.email)??((Ye=s[0])==null?void 0:Ye.email)??"sin usuario",vendor:e??((ht=s[0])==null?void 0:ht.role)??"sin usuario",status:"FLOTANTE",items:Oe,itemsTotal:Ie,type:ce,amountReceived:Z,change:Qe,customerId:ce==="CREDITO"?ae:"",customerName:ce==="CREDITO"?(Se==null?void 0:Se.name)||"":f.trim(),clientName:ce==="CONTADO"?f.trim():""};if(ce==="CONTADO"){if(!f.trim()){S(" Ingresa el nombre del cliente (contado).");return}}else{if(!ae){S(" Selecciona un cliente (crdito).");return}if(De<0){S(" El pago inicial no puede ser negativo.");return}if(De>v){S(" El pago inicial no puede superar el total.");return}if((Se==null?void 0:Se.status)==="BLOQUEADO"){S(" El cliente est BLOQUEADO. No se puede fiar.");return}const ie=Number((Se==null?void 0:Se.creditLimit)||0);if(ie>0&&Et>ie){S(` Supera el lmite de crdito (C$ ${ie.toFixed(2)}).`);return}}const Ge=await Gn(Ct(Ce,"salesV2"),at);if(ce==="CREDITO"&&ae){const ie={customerId:ae,date:u,createdAt:yr.now(),ref:{saleId:Ge.id}};await Gn(Ct(Ce,"ar_movements_pollo"),{...ie,type:"CARGO",amount:Number(Ie)||0}),Number(De)>0&&await Gn(Ct(Ce,"ar_movements_pollo"),{...ie,type:"ABONO",amount:-Number(De)}),Ae(xe=>xe.map(de=>de.id===ae?{...de,balance:Number(de.balance||0)+Number(Ie||0)-Number(De||0)}:de))}S(" Venta registrada y asignada a inventario (FIFO)."),x([]),c(""),y(0),w(0),j("0"),A(""),d(Lr(new Date,"yyyy-MM-dd")),_e(""),O(0),ue("CONTADO")}catch(Oe){console.error(Oe),S(` ${(Oe==null?void 0:Oe.message)||"Error al registrar la venta."}`)}finally{B(!1)}},Qt=g.useMemo(()=>new Set(p.map(Re=>Re.productId)),[p]),Ut=g.useMemo(()=>n.filter(Re=>(k[Re.id]||0)>0),[n,k]),Tt=g.useMemo(()=>{const Re=String(h||"").trim().toLowerCase();return Re?Ut.filter(Te=>`${Te.productName||""}`.toLowerCase().includes(Re)):Ut},[Ut,h]);return Fe?i.jsx("div",{className:"w-full max-w-lg mx-auto p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"font-bold text-lg text-blue-700",children:"Registrar venta (Pollo)"}),i.jsx("input",{type:"date",className:"text-sm text-gray-700 border rounded px-2 py-1",value:u,onChange:Re=>d(Re.target.value),"aria-label":"Fecha de la venta"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ce,onChange:Re=>H(Re.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),ce==="CONTADO"?i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:f,onChange:Re=>A(Re.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ae,onChange:Re=>_e(Re.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),le.map(Re=>i.jsxs("option",{value:Re.status==="ACTIVO"?Re.id:"",disabled:Re.status==="BLOQUEADO",children:[Re.name,"  Saldo: ",m0(Re.balance||0)]},Re.id))]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:m0(Ze)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:m0(Et)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold",children:"Pago inicial"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",type:"number",step:"0.01",inputMode:"decimal",max:ut,value:De===0?"":De,onChange:Re=>{const Te=Math.max(0,Number(Re.target.value||0)),Ye=Math.min(Te,ut);O(Ye)},placeholder:"0.00"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",m0(ut)]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 mb-2",placeholder:"Buscar producto por nombre...",value:h,onChange:Re=>m(Re.target.value)}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{className:"flex-1 border rounded px-1 py-2 text-sm",value:l,onChange:async Re=>{const Te=Re.target.value;c(Te),await D(Te)},children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Tt.map(Re=>i.jsxs("option",{value:Re.id,disabled:Qt.has(Re.id),children:[Re.productName," | C$ ",Re.price," | Disp:"," ",G(k[Re.id]||0)]},Re.id))]})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Items"}),p.length===0?i.jsx("div",{className:"text-gray-500",children:"Agrega productos al carrito."}):i.jsx("div",{className:"space-y-2",children:p.map(Re=>{const Te=K(Re),Ye=Number(Te||0)*Number(Re.qty||0),ht=Math.max(0,Ye-Math.max(0,Number(Re.discount||0))),Oe=(Re.measurement||"").toLowerCase()!=="lb";return i.jsxs("div",{className:"border rounded p-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"font-semibold",children:Re.productName}),i.jsxs("div",{className:"text-sm",children:["C$ ",P(Te).toFixed(2)]})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 items-center",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:Oe?"numeric":"decimal",step:Oe?1:.01,value:Re.qtyInput??(Re.qty===0?"":Re.qty),onKeyDown:ee,onChange:Ie=>be(Re.productId,Ie.target.value),placeholder:Oe?"Unid":"Libras",title:Oe?"Unidades":"Libras"}),i.jsx("input",{className:"border rounded px-1 py-1 text-right",inputMode:"numeric",value:Re.discountInput??(Re.discount===0?"":Re.discount),onChange:Ie=>Xe(Re.productId,Ie.target.value),placeholder:"Descuento",title:"Descuento (C$)"}),i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:"decimal",value:Re.specialPriceInput??(Re.specialPrice===0?"":Re.specialPrice),onChange:Ie=>U(Re.productId,Ie.target.value),placeholder:"Sugerido",title:"Precio sugerido (opcional)"})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Exist:"," ",ms(Number(Re.stock)-Number(Re.qty||0)).toFixed(3)]}),i.jsxs("div",{className:"font-semibold",children:["C$ ",P(ht).toFixed(2)]})]}),i.jsx("div",{className:"mt-2 text-right",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600",onClick:()=>Q(Re.productId),children:"Quitar"})})]},Re.productId)})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Monto total"}),i.jsxs("div",{className:"text-xl font-bold",children:["C$ ",v.toFixed(2)]})]}),ce==="CONTADO"&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-2",inputMode:"decimal",value:b===0?"":b,onChange:Re=>w(Number(Re.target.value||0)),placeholder:"Monto recibido"}),i.jsxs("div",{className:"border rounded px-2 py-2 bg-gray-100",children:["Cambio: C$ ",I]})]}),i.jsx("button",{onClick:Ft,disabled:p.length===0||E,className:"w-full bg-blue-600 text-white px-4 py-2 rounded",children:E?"Guardando...":"Guardar venta"}),C&&i.jsx("div",{className:`text-sm ${C.startsWith("")?"text-green-600":C.startsWith("")?"text-yellow-600":"text-red-600"}`,children:C})]})}):i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:Ft,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl\r
                 p-4 sm:p-6 md:p-8\r
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:Re=>c(Re.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Ut.map(Re=>i.jsxs("option",{value:Re.id,disabled:Qt.has(Re.id),title:Qt.has(Re.id)?"Ya est en la lista":`Disponible: ${G(k[Re.id]||0)}`,children:[Re.productName,"  ",Re.measurement,"  C$ ",Re.price," (disp:"," ",G(k[Re.id]||0),")"]},Re.id))]}),i.jsx("button",{type:"button",onClick:Y,disabled:!l||Qt.has(l),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:u,onChange:Re=>d(Re.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:ce,onChange:Re=>H(Re.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),ce==="CONTADO"?i.jsxs("div",{className:"md:col-span-2 space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:f,onChange:Re=>A(Re.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"md:col-span-2 space-y-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:ae,onChange:Re=>_e(Re.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),le.map(Re=>i.jsxs("option",{value:Re.status==="ACTIVO"?Re.id:"",disabled:Re.status==="BLOQUEADO",children:[Re.name,"  Saldo: ",m0(Re.balance||0)]},Re.id))]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:m0(Ze)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Pago inicial"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",m0(ut)]}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:ut,className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:De===0?"":De,onChange:Re=>{const Te=Math.max(0,Number(Re.target.value||0)),Ye=Math.min(Te,ut);O(Ye)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:m0(Et)})]})]})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):p.map(Re=>{const Te=K(Re),Ye=Number(Te||0)*Number(Re.qty||0),ht=Math.max(0,Ye-Math.max(0,Number(Re.discount||0))),Oe=(Re.measurement||"").toLowerCase()!=="lb",Ie=ms(Number(Re.stock)-Number(Re.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Re.productName,"  ",Re.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",P(Re.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Re.specialPrice===0?"":Re.specialPrice,onKeyDown:ee,onChange:We=>U(Re.productId,We.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",P(Te).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ie.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:Oe?1:.01,inputMode:Oe?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:Re.qtyInput??(Re.qty===0?"":Re.qty),onKeyDown:ee,onChange:We=>be(Re.productId,We.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:Re.discount===0?"":Re.discount,onChange:We=>Xe(Re.productId,We.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",P(ht).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>Q(Re.productId),title:"Quitar",children:""})})]},Re.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${v.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),ce==="CONTADO"&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:b===0?"":b,onChange:Re=>w(Number(Re.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${I}`,readOnly:!0})]})]})}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:p.length===0||E,children:E?"Guardando...":"Guardar venta"}),C&&i.jsx("p",{className:`text-sm mt-2 ${C.startsWith("")?"text-green-600":C.startsWith("")?"text-yellow-600":"text-red-600"}`,children:C})]}),E&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}function Jre(t,e,r,n,a){n=n||{};var s=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():s,u=l*c,d=/\r\n|\r|\n/g,f="",A=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof t=="string"?t.split(d):t,A=f.length||1),r+=l*(2-s),n.valign==="middle"?r-=A/2*u:n.valign==="bottom"&&(r-=A*u),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&A>=1){for(var m=0;m<f.length;m++)a.text(f[m],e-a.getStringUnitWidth(f[m])*h,r),r+=u;return a}e-=a.getStringUnitWidth(t)*h}return n.halign==="justify"?a.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(t,e,r),a}var nH={},pv=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:nH=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,a,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=t.unifyColor(e.textColor),d&&(a=this.jsPDFDocument).setTextColor.apply(a,d),d=t.unifyColor(e.lineColor),d&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,a,s){return this.jsPDFDocument.rect(e,r,n,a,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return nH||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Wk=function(t,e){return Wk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Wk(t,e)};function Zre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Wk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ene=function(t){Zre(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function WPe(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function XPe(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function LS(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return a}function tne(t,e,r,n){var a=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:a,lineColor:s});var o=rne(a,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,o)}function rne(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function lP(t,e){var r,n,a,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(a=t.right)!==null&&a!==void 0?a:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function nne(t,e){var r=lP(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function YPe(t,e,r,n,a){var s={},o=1.3333333333333333,l=w5(e,function(b){return a.getComputedStyle(b).backgroundColor});l!=null&&(s.fillColor=l);var c=w5(e,function(b){return a.getComputedStyle(b).color});c!=null&&(s.textColor=c);var u=ZPe(n,r);u&&(s.cellPadding=u);var d="borderTopColor",f=o*r,A=n.borderTopWidth;if(n.borderBottomWidth===A&&n.borderRightWidth===A&&n.borderLeftWidth===A){var h=(parseFloat(A)||0)/f;h&&(s.lineWidth=h)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=w5(e,function(b){return a.getComputedStyle(b)[d]});m!=null&&(s.lineColor=m);var p=["left","right","center","justify"];p.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),p=["middle","bottom","top"],p.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(s.fontSize=x/o);var v=JPe(n);v&&(s.fontStyle=v);var y=(n.fontFamily||"").toLowerCase();return t.indexOf(y)!==-1&&(s.font=y),s}function JPe(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function w5(t,e){var r=ane(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function ane(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:ane(t.parentElement,e):r}function ZPe(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),a=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(l){return parseInt(l||"0")/n}),o=lP(s,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function sne(t,e,r,n,a){var s,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),d=[],f=[],A=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:d,body:f,foot:A};for(var h=0;h<l.rows.length;h++){var m=l.rows[h],p=(o=(s=m==null?void 0:m.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),x=e3e(c,u,r,m,n,a);x&&(p==="thead"?d.push(x):p==="tfoot"?A.push(x):f.push(x))}return{head:d,body:f,foot:A}}function e3e(t,e,r,n,a,s){for(var o=new ene(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(a||u.display!=="none"){var d=void 0;s&&(d=YPe(t,c,e,u,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:t3e(c)})}}var f=r.getComputedStyle(n);if(o.length>0&&(a||f.display!=="none"))return o}function t3e(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function r3e(t,e,r){for(var n=0,a=[t,e,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Jh(t,e,r,n,a){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function ine(t,e){var r=new pv(t),n=r.getDocumentOptions(),a=r.getGlobalOptions();r3e(a,n,e);var s=Jh({},a,n,e),o;typeof window<"u"&&(o=window);var l=n3e(a,n,e),c=a3e(a,n,e),u=s3e(r,s),d=o3e(r,s,o);return{id:e.tableId,content:d,hooks:c,styles:l,settings:u}}function n3e(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=t[c],d=e[c],f=r[c];n.columnStyles=Jh({},u,d,f)}else{var A=[t,e,r],h=A.map(function(m){return m[c]||{}});n[c]=Jh({},h[0],h[1],h[2])}},s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];a(l)}return n}function a3e(t,e,r){for(var n=[t,e,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=n;s<o.length;s++){var l=o[s];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function s3e(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m=lP(e.margin,40/t.scaleFactor()),p=(r=i3e(t,e.startY))!==null&&r!==void 0?r:m.top,x;e.showFoot===!0?x="everyPage":e.showFoot===!1?x="never":x=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(a=e.showHead)!==null&&a!==void 0?a:"everyPage";var y=(s=e.useCss)!==null&&s!==void 0?s:!1,b=e.theme||(y?"plain":"striped"),w=!!e.horizontalPageBreak,I=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:y,theme:b,startY:p,margin:m,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:v,showFoot:x,tableLineWidth:(f=e.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(A=e.tableLineColor)!==null&&A!==void 0?A:200,horizontalPageBreak:w,horizontalPageBreakRepeat:I,horizontalPageBreakBehaviour:(h=e.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function i3e(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),a=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===a}return typeof e=="number"?e:(e==null||e===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function o3e(t,e,r){var n=e.head||[],a=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=sne(t,e.html,r,o,e.useCss)||{};n=l.head||n,a=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||l3e(n,a,s);return{columns:c,head:n,body:a,foot:s}}function l3e(t,e,r){var n=t[0]||e[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var u=void 0;Array.isArray(n)?u=a.length:u=s+(c>0?"_".concat(c):"");var d={dataKey:u};a.push(d)}}),a}var Xk=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),c3e=function(t){Zre(e,t);function e(r,n,a,s,o,l){var c=t.call(this,r,n,l)||this;return c.cell=a,c.row=s,c.column=o,c.section=s.section,c}return e}(Xk),u3e=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,a,s,o){for(var l=0,c=r;l<c.length;l++){var u=c[l],d=new c3e(e,this,n,a,s,o),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new Xk(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new Xk(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),one=function(){function t(e,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof ene&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(a,s){var o=n.cells[s.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),u=c+l;return u>a?u:a},0)},t}(),lne=function(){function t(e,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(a=e.content)!==null&&a!==void 0?a:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/e*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=lP(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),d3e=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,a=e.allRows();n<a.length;n++){var s=a[n],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function f3e(t,e){h3e(t,e);var r=[],n=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=e.getWidth(t.pageSize().width)-n;a&&(a=Yk(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=Yk(r,a,function(s){return s.minWidth})),a=Math.abs(a),!e.settings.horizontalPageBreak&&a>.1/t.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),m3e(e),p3e(e,t),A3e(e)}function h3e(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,a=nne(t,e);e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(t,d,u,s,c,null);var f=u.padding("horizontal");u.contentWidth=LS(u.text,u.styles,t)+f;var A=LS(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=A+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Yk(t,e,r){for(var n=e,a=t.reduce(function(h,m){return h+m.wrappedWidth},0),s=0;s<t.length;s++){var o=t[s],l=o.wrappedWidth/a,c=n*l,u=o.width+c,d=r(o),f=u<d?d:u;e-=f-o.width,o.width=f}if(e=Math.round(e*1e10)/1e10,e){var A=t.filter(function(h){return e<0?h.width>r(h):!0});A.length&&(e=Yk(A,e,r))}return e}function A3e(t){for(var e={},r=1,n=t.allRows(),a=0;a<n.length;a++)for(var s=n[a],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=e[c.index];if(r>1)r--,delete s.cells[c.index];else if(u)u.cell.height+=s.height,r=u.cell.colSpan,delete s.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=s.cells[c.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var f=n.length-a,A=d.rowSpan>f?f:d.rowSpan;e[c.index]={cell:d,left:A,row:s}}}}}function m3e(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],a=null,s=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])s+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+s}else{var u=n.cells[c.index];if(!u)continue;if(o=u.colSpan,s=0,u.colSpan>1){a=u,s+=c.width;continue}u.width=c.width+s}}}function p3e(t,e){for(var r={count:0,height:0},n=0,a=t.allRows();n<a.length;n++){for(var s=a[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=aH(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=aH(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var A=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<A*u.rowSpan?r={height:A,count:u.rowSpan}:r&&r.count>0&&r.height>A&&(A=r.height),A>s.height&&(s.height=A)}}r.count--}}function aH(t,e,r,n,a){return t.map(function(s){return g3e(s,e,r,n,a)})}function g3e(t,e,r,n,a){var s=1e4*n.scaleFactor();if(e=Math.ceil(e*s)/s,e>=LS(t,r,n))return t;for(;e<LS(t+a,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+a}function cne(t,e){var r=new pv(t),n=x3e(e,r.scaleFactor()),a=new u3e(e,n);return f3e(r,a),r.applyStyles(r.userStyles),a}function x3e(t,e){var r=t.content,n=y3e(r.columns);if(r.head.length===0){var a=sH(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=sH(n,"foot");a&&r.foot.push(a)}var s=t.settings.theme,o=t.styles;return{columns:n,head:N5("head",r.head,n,o,s,e),body:N5("body",r.body,n,o,s,e),foot:N5("foot",r.foot,n,o,s,e)}}function N5(t,e,r,n,a,s){var o={},l=e.map(function(c,u){for(var d=0,f={},A=0,h=0,m=0,p=r;m<p.length;m++){var x=p[m];if(o[x.index]==null||o[x.index].left===0)if(h===0){var v=void 0;Array.isArray(c)?v=c[x.index-A-d]:v=c[x.dataKey];var y={};typeof v=="object"&&!Array.isArray(v)&&(y=(v==null?void 0:v.styles)||{});var b=b3e(t,x,u,a,n,s,y),w=new lne(v,b,t);f[x.dataKey]=w,f[x.index]=w,h=w.colSpan-1,o[x.index]={left:w.rowSpan-1,times:h}}else h--,A++;else o[x.index].left--,h=o[x.index].times,d++}return new one(c,u,t,f)});return l}function sH(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var a=v3e(e,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function v3e(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function y3e(t){return t.map(function(e,r){var n,a;return typeof e=="object"?a=(n=e.dataKey)!==null&&n!==void 0?n:r:a=r,new d3e(a,e,r)})}function b3e(t,e,r,n,a,s,o){var l=XPe(n),c;t==="head"?c=a.headStyles:t==="body"?c=a.bodyStyles:t==="foot"&&(c=a.footStyles);var u=Jh({},l.table,l[t],a.styles,c),d=a.columnStyles[e.dataKey]||a.columnStyles[e.index]||{},f=t==="body"?d:{},A=t==="body"&&r%2===0?Jh({},l.alternateRow,a.alternateRowStyles):{},h=WPe(s),m=Jh({},h,u,A,f);return Jh(m,o)}function w3e(t,e,r){var n;r===void 0&&(r={});var a=nne(t,e),s=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(A){var h=e.columns.find(function(m){return m.dataKey===A||m.index===A});h&&!s.has(h.index)&&(s.set(h.index,!0),o.push(h.index),l.push(e.columns[h.index]),a-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<e.columns.length;){if(s.has(d)){d++;continue}var f=e.columns[d].wrappedWidth;if(u||a>=f)u=!1,o.push(d),l.push(e.columns[d]),a-=f;else break;d++}return{colIndexes:o,columns:l,lastIndex:d-1}}function N3e(t,e){for(var r=[],n=0;n<e.columns.length;n++){var a=w3e(t,e,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function une(t,e){var r=e.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(A,h){return A+h.height},0);l+=u}var d=new pv(t);(r.pageBreak==="always"||r.startY!=null&&l>d.pageSize().height)&&(fne(d),s.y=a.top),e.callWillDrawPageHooks(d,s);var f=Jh({},s);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?C3e(d,e,f,s):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(A){return wA(d,e,A,s,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(A,h){var m=h===e.body.length-1;US(d,e,A,m,f,s,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(A){return wA(d,e,A,s,e.columns)})),tne(d,e,f,s),e.callEndPageHooks(d,s),e.finalY=s.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function C3e(t,e,r,n){var a=N3e(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,d){t.applyStyles(t.userStyles),d>0?Ob(t,e,r,n,u.columns,!0):iH(t,e,n,u.columns),_3e(t,e,r,n,u.columns),C5(t,e,n,u.columns)});else for(var o=-1,l=a[0],c=function(){var u=o;if(l){t.applyStyles(t.userStyles);var d=l.columns;o>=0?Ob(t,e,r,n,d,!0):iH(t,e,n,d),u=oH(t,e,o+1,n,d),C5(t,e,n,d)}var f=u-o;a.slice(1).forEach(function(A){t.applyStyles(t.userStyles),Ob(t,e,r,n,A.columns,!0),oH(t,e,o+1,n,A.columns,f),C5(t,e,n,A.columns)}),o=u};o<e.body.length-1;)c()}function iH(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(s){return wA(t,e,s,r,n)})}function _3e(t,e,r,n,a){t.applyStyles(t.userStyles),e.body.forEach(function(s,o){var l=o===e.body.length-1;US(t,e,s,l,r,n,a)})}function oH(t,e,r,n,a,s){t.applyStyles(t.userStyles),s=s??e.body.length;var o=Math.min(r+s,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,u){var d=r+u===e.body.length-1,f=dne(t,e,d,n);c.canEntireRowFit(f,a)&&(wA(t,e,c,n,a),l=r+u)}),l}function C5(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(s){return wA(t,e,s,r,n)})}function E3e(t,e,r){var n=r.getLineHeight(t.styles.fontSize),a=t.padding("vertical"),s=Math.floor((e-a)/n);return Math.max(0,s)}function S3e(t,e,r,n){var a={};t.spansMultiplePages=!0,t.height=0;for(var s=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new lne(u.raw,u.styles,u.section);d=Jh(d,u),d.text=[];var f=E3e(u,e,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var A=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(A,h),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),d.contentHeight=d.getContentHeight(A,h),d.contentHeight>s&&(s=d.contentHeight),a[c.index]=d}}var m=new one(t.raw,-1,t.section,a,!0);m.height=s;for(var p=0,x=r.columns;p<x.length;p++){var c=x[p],d=m.cells[c.index];d&&(d.height=m.height);var u=t.cells[c.index];u&&(u.height=t.height)}return m}function j3e(t,e,r,n){var a=t.pageSize().height,s=n.settings.margin,o=s.top+s.bottom,l=a-o;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(n.columns),f=e.getMaxCellHeight(n.columns)>l;return f?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function US(t,e,r,n,a,s,o){var l=dne(t,e,n,s);if(r.canEntireRowFit(l,o))wA(t,e,r,s,o);else if(j3e(t,r,l,e)){var c=S3e(r,l,e,t);wA(t,e,r,s,o),Ob(t,e,a,s,o),US(t,e,c,n,a,s,o)}else Ob(t,e,a,s,o),US(t,e,r,n,a,s,o)}function wA(t,e,r,n,a){n.x=e.settings.margin.left;for(var s=0,o=a;s<o.length;s++){var l=o[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}I3e(t,c,n);var d=c.getTextPos();Jre(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function I3e(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=rne(n.lineWidth,n.fillColor);a&&t.rect(e.x,r.y,e.width,e.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),P3e(t,e,r,n.lineWidth))}function P3e(t,e,r,n){var a,s,o,l;n.top&&(a=r.x,s=r.y,o=r.x+e.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,o,l)),n.bottom&&(a=r.x,s=r.y+e.height,o=r.x+e.width,l=r.y+e.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,o,l)),n.left&&(a=r.x,s=r.y,o=r.x,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,s,o,l)),n.right&&(a=r.x+e.width,s=r.y,o=r.x+e.width,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,s,o,l));function c(u,d,f,A,h){t.getDocument().setLineWidth(u),t.getDocument().line(d,f,A,h,"S")}}function dne(t,e,r,n){var a=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-a}function Ob(t,e,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(l){return wA(t,e,l,n,a)}),e.callEndPageHooks(t,n);var o=e.settings.margin;tne(t,e,r,n),fne(t),e.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return wA(t,e,l,n,a)}),t.applyStyles(t.userStyles))}function fne(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function T3e(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],a=ine(this,n),s=cne(this,a);return une(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,a){Jre(e,r,n,a,this)},t.API.autoTableSetDefaults=function(e){return pv.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){pv.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new pv(this),s=sne(a,e,window,r,!1),o=s.head,l=s.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var _5;function H0(t,e){var r=ine(t,e),n=cne(t,r);une(t,n)}try{if(typeof window<"u"&&window){var lH=window,cH=lH.jsPDF||((_5=lH.jspdf)===null||_5===void 0?void 0:_5.jsPDF);cH&&T3e(cH)}}catch(t){console.error("Could not apply autoTable plugin",t)}const qa=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function E5(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function B3e({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const[a,s]=g.useState([]),[o,l]=g.useState([]),[c,u]=g.useState(!0),[d,f]=g.useState(""),{refreshKey:A,refresh:h}=Lc(),m=e&&e.length?e:t,p=En(m,"admin"),x=p||En(m,"contador"),[v,y]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[b,w]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[I,j]=g.useState(""),[C,S]=g.useState(!1),[E,B]=g.useState(""),[k,T]=g.useState(Lr(new Date,"yyyy-MM-dd")),[P,G]=g.useState("lb"),[ce,ue]=g.useState(""),[le,Ae]=g.useState(0),[ae,_e]=g.useState(NaN),[De,O]=g.useState(0),[H,K]=g.useState([]),[R,X]=g.useState(null),[Y,D]=g.useState([]),[Q,te]=g.useState(!1),[be,U]=g.useState(null),[Xe,se]=g.useState(!1),[ee,Fe]=g.useState(null),[je,Se]=g.useState(null),Ze=Ne=>Se(pe=>pe===Ne?null:Ne),[ut,Et]=g.useState(!1),St=()=>Et(Ne=>!Ne),[Ft,Qt]=g.useState("all"),[Ut,Tt]=g.useState({}),Re=Ne=>Tt(pe=>({...pe,[Ne]:!(pe[Ne]??!1)})),Te=(Ne,pe)=>{const Le=[];return Ne>0&&Le.push(`${Ne.toFixed(3)} lb`),pe>0&&Le.push(`${pe.toFixed(3)} un`),Le.length===0?"0":Le.join("  ")},Ye=Ne=>{const pe=(Ne||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(pe)||pe==="lb"};g.useEffect(()=>{(async()=>{u(!0),f("");const Ne=await Ht(Ct(Ce,"products")),pe=[];Ne.forEach(ct=>{const W=ct.data();W.active===!0&&pe.push({id:ct.id,name:W.name??W.productName??"(sin nombre)",category:W.category??"(sin categora)",measurement:W.measurement??"lb",price:Number(W.price??0),providerPrice:Object.prototype.hasOwnProperty.call(W,"providerPrice")?Number(W.providerPrice):void 0})}),s(pe);const Le=sr(Ct(Ce,"inventory_batches"),Sn("date","desc")),ft=await Ht(Le),At=[];ft.forEach(ct=>{const W=ct.data(),z=ms(Number(W.quantity||0)),re=Number(W.purchasePrice||0),V=Number(W.salePrice||0),L=Number((z*re).toFixed(2)),fe=Number((z*V).toFixed(2));At.push({id:ct.id,productId:W.productId,productName:W.productName,category:W.category,unit:W.unit,quantity:z,remaining:ms(Number(W.remaining||0)),purchasePrice:re,salePrice:V,invoiceTotal:W.invoiceTotal!=null?Number(W.invoiceTotal):L,expectedTotal:W.expectedTotal!=null?Number(W.expectedTotal):fe,date:W.date,createdAt:W.createdAt,status:W.status,notes:W.notes,paidAmount:Number(W.paidAmount||0),paidAt:W.paidAt,batchGroupId:W.batchGroupId,orderName:W.orderName})}),l(At),u(!1)})()},[A]);const ht=g.useMemo(()=>o.filter(Ne=>!(v&&Ne.date<v||b&&Ne.date>b||I&&Ne.productId!==I)),[o,v,b,I]),Oe=g.useMemo(()=>{if(!I)return"Todos";const Ne=a.find(pe=>pe.id===I);return Ne?`${Ne.name}  ${Ne.category}`:"Filtro activo"},[I,a]),Ie=g.useMemo(()=>{const Ne=ht.reduce((re,V)=>re+Number(V.invoiceTotal||0),0),pe=ht.reduce((re,V)=>re+Number(V.expectedTotal||0),0);let Le=0,ft=0,At=0,ct=0;for(const re of ht)Ye(re.unit)?(Le+=re.quantity,ft+=re.remaining):(At+=re.quantity,ct+=re.remaining);const W=ht.reduce((re,V)=>re+V.quantity,0),z=ht.reduce((re,V)=>re+V.remaining,0);return{lbsIng:Le,lbsRem:ft,udsIng:At,udsRem:ct,qty:W,rem:z,totalFacturado:Ne,totalEsperado:pe}},[ht]),We=g.useMemo(()=>{var Le,ft;const Ne=new Map;for(const At of ht){const ct=At.batchGroupId&&String(At.batchGroupId).trim()||At.id;Ne.has(ct)||Ne.set(ct,[]),Ne.get(ct).push(At)}const pe=[];for(const[At,ct]of Ne.entries()){const W=[...ct].sort((Ue,rt)=>{var Ot,nr;const st=((Ot=Ue.createdAt)==null?void 0:Ot.seconds)??0;return(((nr=rt.createdAt)==null?void 0:nr.seconds)??0)-st}),z=((Le=W[0])==null?void 0:Le.date)||"",re=String(((ft=W[0])==null?void 0:ft.orderName)||"").trim()||`Pedido ${z||""}`.trim()||"Pedido",V=new Set(W.map(Ue=>String(Ue.category||"").trim()).filter(Boolean)),L=V.size===1?Array.from(V)[0].toUpperCase():"MIXTO",fe=W.some(Ue=>Ue.status==="PENDIENTE")?"PENDIENTE":"PAGADO",Be=ms(W.reduce((Ue,rt)=>Ue+(Ye(rt.unit)?Number(rt.quantity||0):0),0)),ye=ms(W.reduce((Ue,rt)=>Ue+(Ye(rt.unit)?Number(rt.remaining||0):0),0)),$e=ms(W.reduce((Ue,rt)=>Ue+(Ye(rt.unit)?0:Number(rt.quantity||0)),0)),ze=ms(W.reduce((Ue,rt)=>Ue+(Ye(rt.unit)?0:Number(rt.remaining||0)),0)),Ke=Number(W.reduce((Ue,rt)=>Ue+Number(rt.invoiceTotal||0),0).toFixed(2)),yt=Number(W.reduce((Ue,rt)=>Ue+Number(rt.expectedTotal||0),0).toFixed(2)),ne=Number((yt-Ke).toFixed(2));pe.push({groupId:At,orderName:re,date:z,typeLabel:L,status:fe,lbsIn:Be,lbsRem:ye,udsIn:$e,udsRem:ze,totalFacturado:Ke,totalEsperado:yt,utilidadBruta:ne,items:W})}return pe.sort((At,ct)=>At.date===ct.date?At.groupId<ct.groupId?1:-1:At.date<ct.date?1:-1),pe},[ht]),Z=g.useMemo(()=>Ft==="all"?We:We.filter(Ne=>{const pe=Ne.lbsRem>0||Ne.udsRem>0;return Ft==="with"?pe:!pe}),[We,Ft]),Qe=g.useMemo(()=>{const Ne=new Map;return Z.forEach(pe=>{const Le=pe.typeLabel||"MIXTO";Ne.has(Le)||Ne.set(Le,[]),Ne.get(Le).push(pe)}),Array.from(Ne.entries()).map(([pe,Le])=>({type:pe,items:Le}))},[Z]),at=g.useMemo(()=>{const Ne=String(P||"").toLowerCase().trim();return a.filter(Le=>String(Le.measurement||"").toLowerCase().trim()===Ne).sort((Le,ft)=>Le.name.localeCompare(ft.name,"es"))},[a,P]);g.useEffect(()=>{const Ne=H.find(Le=>Le.productId===ce);if(Ne){Ae(Number(Ne.quantity||0)),_e(Number(Ne.purchasePrice||0)),O(Number(Ne.salePrice||0));return}const pe=a.find(Le=>Le.id===ce);pe?(Ae(0),O(Number(pe.price||0)),pe.providerPrice!=null&&Number.isFinite(Number(pe.providerPrice))?_e(Number(pe.providerPrice)):_e(NaN)):(Ae(0),O(0),_e(NaN))},[ce,a,A,H]);const Ge=()=>{f("");const Ne=a.find(z=>z.id===ce);if(!Ne)return f("Selecciona un producto.");if(le<=0||!Number.isFinite(ae)||ae<=0)return f("Completa libras a ingresar y precio proveedor.");const pe=ms(le),Le=Ne.measurement,ft=Number((pe*Number(ae||0)).toFixed(2)),At=Number((pe*Number(De||0)).toFixed(2)),ct=Number((At-ft).toFixed(2)),W=H.findIndex(z=>z.productId===Ne.id);W>=0?K(z=>z.map((re,V)=>V!==W?re:{...re,quantity:pe,remaining:pe,purchasePrice:Number(ae||0),salePrice:Number(De||0),invoiceTotal:ft,expectedTotal:At,utilidadBruta:ct})):K(z=>[...z,{tempId:E5("IT"),productId:Ne.id,productName:Ne.name,category:Ne.category,unit:Le,quantity:pe,remaining:pe,purchasePrice:Number(ae||0),salePrice:Number(De||0),invoiceTotal:ft,expectedTotal:At,utilidadBruta:ct}]),ue(""),Ae(0),_e(NaN),O(0)},ie=Ne=>{K(pe=>pe.filter(Le=>Le.tempId!==Ne))},xe=(Ne,pe,Le)=>{K(ft=>ft.map(At=>{if(At.tempId!==Ne)return At;const ct={...At};return pe==="quantity"&&(ct.quantity=ms(Math.max(0,Le)),R||(ct.remaining=ct.quantity)),pe==="purchasePrice"&&(ct.purchasePrice=Math.max(0,Number(Le||0))),pe==="salePrice"&&(ct.salePrice=Math.max(0,Number(Le||0))),ct.invoiceTotal=Number((ct.quantity*ct.purchasePrice).toFixed(2)),ct.expectedTotal=Number((ct.quantity*ct.salePrice).toFixed(2)),ct.utilidadBruta=Number((ct.expectedTotal-ct.invoiceTotal).toFixed(2)),ct}))},de=g.useMemo(()=>{const Ne=ms(H.reduce((ct,W)=>ct+(Ye(W.unit)?Number(W.quantity||0):0),0)),pe=ms(H.reduce((ct,W)=>ct+(Ye(W.unit)?Number(W.remaining||0):0),0)),Le=Number(H.reduce((ct,W)=>ct+Number(W.invoiceTotal||0),0).toFixed(2)),ft=Number(H.reduce((ct,W)=>ct+Number(W.expectedTotal||0),0).toFixed(2)),At=Number((ft-Le).toFixed(2));return{lbsIn:Ne,lbsRem:pe,totalFacturado:Le,totalEsperado:ft,utilidadBruta:At}},[H]),Me=()=>{X(null),D([]),B(""),T(Lr(new Date,"yyyy-MM-dd")),G("lb"),ue(""),Ae(0),_e(NaN),O(0),K([])},me=async()=>{if(f(""),!H.length)return f("Agrega al menos un producto al pedido.");const Ne=k||Lr(new Date,"yyyy-MM-dd"),pe=String(E||"").trim()||`Pedido ${Ne}`,Le=R||E5("BATCH");try{if(!R){for(const W of H)await XV({productId:W.productId,productName:W.productName,category:W.category,unit:W.unit,quantity:ms(W.quantity),purchasePrice:Number(W.purchasePrice||0),salePrice:Number(W.salePrice||0),invoiceTotal:Number(W.invoiceTotal||0),expectedTotal:Number(W.expectedTotal||0),date:Ne,notes:"",batchGroupId:Le,orderName:pe});f(" Pedido creado"),S(!1),Me(),h();return}const ft=Y,At=new Map;for(const W of ft)At.set(W.productId,W);const ct=new Set(H.map(W=>W.productId));for(const W of H){const z=At.get(W.productId),re=ms(W.quantity);if(z){const V=ms(z.quantity-z.remaining),L=Math.max(0,ms(re-V));await kn(Yt(Ce,"inventory_batches",z.id),{date:Ne,orderName:pe,batchGroupId:Le,quantity:re,purchasePrice:Number(W.purchasePrice||0),salePrice:Number(W.salePrice||0),invoiceTotal:Number(W.invoiceTotal||0),expectedTotal:Number(W.expectedTotal||0),remaining:L})}else await XV({productId:W.productId,productName:W.productName,category:W.category,unit:W.unit,quantity:re,purchasePrice:Number(W.purchasePrice||0),salePrice:Number(W.salePrice||0),invoiceTotal:Number(W.invoiceTotal||0),expectedTotal:Number(W.expectedTotal||0),date:Ne,notes:"",batchGroupId:Le,orderName:pe})}for(const W of ft)ct.has(W.productId)||await Wn(Yt(Ce,"inventory_batches",W.id));f(" Pedido actualizado"),S(!1),Me(),h()}catch(ft){console.error(ft),f(" Error al guardar pedido")}},we=Ne=>{U(Ne),te(!0)},pt=Ne=>{X(Ne.groupId),D(Ne.items),B(Ne.orderName),T(Ne.date||Lr(new Date,"yyyy-MM-dd"));const pe=Ne.items.map(Le=>{const ft=Number(Le.invoiceTotal||0),At=Number(Le.expectedTotal||0);return{tempId:E5("IT"),productId:Le.productId,productName:Le.productName,category:Le.category,unit:Le.unit,quantity:ms(Le.quantity),remaining:ms(Le.remaining),purchasePrice:Number(Le.purchasePrice||0),salePrice:Number(Le.salePrice||0),invoiceTotal:ft,expectedTotal:At,utilidadBruta:Number((At-ft).toFixed(2))}});K(pe),S(!0)},vt=async Ne=>{if(confirm(`Eliminar el pedido "${Ne.orderName}" del ${Ne.date}?`))try{for(const Le of Ne.items)await Wn(Yt(Ce,"inventory_batches",Le.id));f(" Pedido eliminado"),h()}catch(Le){console.error(Le),f(" Error al eliminar pedido")}},bt=Ne=>{Fe(Ne),se(!0)},kt=async()=>{if(ee)try{for(const Ne of ee.items){if(Ne.status!=="PENDIENTE")continue;await qre(Ne.id),await kn(Yt(Ce,"inventory_batches",Ne.id),{remaining:0});const pe={date:Ne.date,productName:Ne.productName,quantity:Ne.quantity,amount:Number((Ne.expectedTotal??Ne.salePrice*Ne.quantity).toFixed(2)),allocations:[{batchId:Ne.id,qty:Ne.quantity,unitCost:Ne.purchasePrice,lineCost:Number((Ne.purchasePrice*Ne.quantity).toFixed(2))}],avgUnitCost:Ne.purchasePrice,measurement:Ne.unit,createdAt:yr.now(),autoGeneratedFromInventory:!0};await Gn(Ct(Ce,"salesV2"),pe)}f(" Pedido pagado y reflejado como venta"),h()}catch(Ne){console.error(Ne),f(" Error al pagar pedido")}finally{se(!1),Fe(null)}},Vt=()=>{se(!1),Fe(null)},ke=()=>{const Ne=new rn({unit:"pt",format:"a4",orientation:"landscape"}),pe="Inventario de Pollo",Le=`Rango: ${v||"(sin inicio)"} a ${b||"(sin fin)"}`,ft=`Producto: ${Oe}`,At=z=>Number(z||0).toFixed(3);let ct=40;Ne.setFontSize(16),Ne.text(pe,40,ct),ct+=16,Ne.setFontSize(10),Ne.text(Le,40,ct),ct+=12,Ne.text(ft,40,ct),ct+=14;const W=()=>{var z;ct=(z=Ne.lastAutoTable)!=null&&z.finalY?Ne.lastAutoTable.finalY+18:ct+18};H0(Ne,{startY:ct,head:[["KPI","Valor"]],body:[["Libras ingresadas",At(Ie.lbsIng)],["Libras restantes",At(Ie.lbsRem)],["Unidades ingresadas",At(Ie.udsIng)],["Unidades restantes",At(Ie.udsRem)],["Total esperado",qa(Ie.totalEsperado)],["Total facturado",qa(Ie.totalFacturado)],["Ganancia sin gastos",qa(Ie.totalEsperado-Ie.totalFacturado)],["Cantidad de lotes",ht.length.toString()]],styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),W(),H0(Ne,{startY:ct,head:[["Fecha","Pedido","Tipo","Lb In","Lb Rem","Ud In","Ud Rem","Facturado","Esperado","Utilidad","Estado"]],body:We.map(z=>[z.date,z.orderName,z.typeLabel,At(z.lbsIn),At(z.lbsRem),At(z.udsIn),At(z.udsRem),qa(z.totalFacturado),qa(z.totalEsperado),qa(z.utilidadBruta),z.status]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),W(),We.forEach(z=>{Ne.setFontSize(11),Ne.text(`Pedido: ${z.orderName} (${z.date})  ${z.typeLabel}`,40,ct),ct+=12,H0(Ne,{startY:ct,head:[["Producto","Unidad","Ingresado","Restante","Precio compra","Precio venta","Total facturado","Total esperado","Utilidad","Estado"]],body:z.items.map(re=>[re.productName,(re.unit||"").toUpperCase(),At(re.quantity),At(re.remaining),qa(re.purchasePrice),qa(re.salePrice),qa(re.invoiceTotal||re.purchasePrice*re.quantity),qa(re.expectedTotal||re.salePrice*re.quantity),qa((re.expectedTotal||re.salePrice*re.quantity)-(re.invoiceTotal||re.purchasePrice*re.quantity)),re.status]),styles:{fontSize:8},headStyles:{fillColor:[230,230,230],textColor:[0,0,0]}}),W()}),Ne.save(`inventario_pollo_${v||"sin_desde"}_a_${b||"sin_hasta"}.pdf`)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-gray-900 text-white hover:bg-black",type:"button",onClick:ke,disabled:c,children:"Exportar PDF"}),x&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{Me(),S(!0)},children:"Crear Lote"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:Ne=>y(Ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:b,onChange:Ne=>w(Ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:I,onChange:Ne=>j(Ne.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),a.map(Ne=>i.jsxs("option",{value:Ne.id,children:[Ne.name,"  ",Ne.category]},Ne.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{y(""),w(""),j("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(Mc,{onClick:()=>h(),loading:c})})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:[i.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:St,role:"button","aria-expanded":ut,children:[i.jsxs("div",{className:"flex gap-6 items-center",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Ie.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Ie.lbsRem.toFixed(3)]})]}),i.jsx("div",{className:"text-sm text-gray-500",children:ut?"Cerrar":"Ver ms"})]}),ut&&i.jsx("div",{className:"mt-3",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Ie.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Ie.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Ie.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Ie.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",Ie.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",Ie.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(Ie.totalEsperado-Ie.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",ht.length.toLocaleString()]})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx("div",{className:"flex gap-2",children:[{key:"all",label:"Todos"},{key:"with",label:"Con disponibilidad"},{key:"without",label:"Sin disponibilidad"}].map(Ne=>{const pe=Ft===Ne.key;return i.jsx("button",{type:"button",onClick:()=>Qt(Ne.key),className:`flex-1 px-3 py-2 rounded-xl text-sm font-semibold shadow ${pe?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:Ne.label},Ne.key)})}),c?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow",children:"Cargando"}):Z.length===0?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow text-center",children:Ft==="with"?"Sin lotes con disponibilidad.":Ft==="without"?"Sin lotes sin disponibilidad.":"Sin lotes"}):Qe.map(({type:Ne,items:pe})=>{const Le=Ut[Ne]??!1;return i.jsxs("div",{className:"bg-white border rounded-2xl",children:[i.jsxs("button",{type:"button",onClick:()=>Re(Ne),className:"w-full px-4 py-3 flex items-center justify-between text-left",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:Ne}),i.jsxs("div",{className:"text-xs text-gray-500",children:[pe.length," ",pe.length===1?"lote":"lotes"]})]}),i.jsx("span",{className:"text-xs text-gray-500",children:Le?"Cerrar":"Ver"})]}),Le&&i.jsx("div",{className:"space-y-3 px-2 pb-4",children:pe.map(ft=>{const At=je===ft.groupId,ct=ft.lbsRem>0||ft.udsRem>0;return i.jsxs("div",{className:"bg-gray-50 border rounded-2xl",children:[i.jsxs("div",{className:"p-4 flex items-start justify-between gap-3 cursor-pointer",onClick:()=>Ze(ft.groupId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"font-semibold text-lg",children:[ft.date,i.jsxs("div",{className:"text-sm text-gray-500",children:["Producto: ",ft.typeLabel]})]}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Nombre: ",ft.orderName]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${ft.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ft.status})})]}),i.jsxs("div",{className:"pb-4 p-4 flex items-start justify-between gap-1 cursor-pointer",children:[i.jsxs("div",{className:"px-2 py-1 rounded text-xs shrink-0 bg-green-100 font-semibold text-gray-700",children:["Ingresado: ",Te(ft.lbsIn,ft.udsIn)]}),i.jsxs("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${ct?"bg-green-100 font-semibold text-gray-700":"bg-red-100 font-semibold text-red-700"}`,children:["Disponible: ",Te(ft.lbsRem,ft.udsRem)]})]}),At&&i.jsxs("div",{className:"p-4 pt-0",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Tipo"}),i.jsx("div",{className:"font-semibold",children:ft.typeLabel})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Utilidad bruta"}),i.jsx("div",{className:"font-semibold",children:qa(ft.utilidadBruta)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs ingresadas"}),i.jsx("div",{className:"font-semibold",children:ft.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs restantes"}),i.jsx("div",{className:"font-semibold",children:ft.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2 col-span-2",children:[i.jsxs("div",{className:"flex justify-between text-[11px] text-gray-500",children:[i.jsx("span",{children:"Total facturado"}),i.jsx("span",{children:"Total esperado"})]}),i.jsxs("div",{className:"flex justify-between font-semibold",children:[i.jsx("span",{children:qa(ft.totalFacturado)}),i.jsx("span",{children:qa(ft.totalEsperado)})]})]}),ft.items.length>0&&i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 col-span-2 border border-gray-100",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-2",children:"Productos asociados"}),i.jsx("div",{className:"space-y-1",children:ft.items.map(W=>i.jsxs("div",{className:"flex items-center text-xs justify-between gap-2",children:[i.jsx("div",{className:"font-semibold text-gray-800 truncate",children:W.productName}),i.jsxs("div",{className:"text-gray-600 text-right",children:[i.jsxs("div",{children:["Ingresado:"," ",W.quantity.toFixed(3)]}),i.jsxs("div",{children:["Restante:"," ",W.remaining.toFixed(3)]})]})]},W.id))})]})]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>we(ft),children:"Ver detalle"}),p?i.jsxs(i.Fragment,{children:[ft.status==="PENDIENTE"&&i.jsx("button",{className:"px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm",onClick:()=>bt(ft),children:"Pagar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-yellow-600 hover:bg-yellow-700 text-white text-sm",onClick:()=>pt(ft),children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm",onClick:()=>vt(ft),children:"Borrar"})]}):null]})]})]},ft.groupId)})})]},Ne)})]}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Unidades ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Unidades restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:c?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):We.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin lotes"})}):We.map(Ne=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>we(Ne),title:Ne.orderName,children:Ne.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:Ne.orderName})]}),i.jsx("td",{className:"p-2 border",children:Ne.typeLabel}),i.jsx("td",{className:"p-2 border",children:Ne.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ne.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ne.udsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ne.udsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:qa(Ne.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:qa(Ne.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:qa(Ne.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ne.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Ne.status})}),i.jsx("td",{className:"p-2 border",children:p?i.jsxs("div",{className:"flex gap-2 justify-center",children:[Ne.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>bt(Ne),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>pt(Ne),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>vt(Ne),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},Ne.groupId))})]})}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),C&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:R?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:E,onChange:Ne=>B(Ne.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:k,onChange:Ne=>T(Ne.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:Ne=>{G(Ne.target.value),ue(""),Ae(0),_e(NaN),O(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ce,onChange:Ne=>ue(Ne.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),at.map(Ne=>i.jsxs("option",{value:Ne.id,children:[Ne.name,"  ",Ne.category,"  ",Ne.measurement]},Ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:le===0?"":le,onChange:Ne=>{const pe=Ne.target.value.replace(",","."),Le=parseFloat(pe),ft=Number.isFinite(Le)?parseFloat(Le.toFixed(3)):0;Ae(Math.max(0,ft));const At=H.find(ct=>ct.productId===ce);At&&xe(At.tempId,"quantity",ft)},disabled:!ce})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Number.isNaN(ae)?"":ae,onChange:Ne=>{const pe=Ne.target.value.replace(",",".");if(pe==="")return _e(NaN);const Le=parseFloat(pe),ft=Number.isFinite(Le)?parseFloat(Le.toFixed(2)):NaN;_e(Number.isFinite(ft)?Math.max(0,ft):NaN);const At=H.find(ct=>ct.productId===ce);At&&Number.isFinite(ft)&&xe(At.tempId,"purchasePrice",ft)},disabled:!ce})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:De===0?"":De,onChange:Ne=>{const pe=Ne.target.value.replace(",","."),Le=parseFloat(pe),ft=Number.isFinite(Le)?parseFloat(Le.toFixed(2)):0;O(Math.max(0,ft));const At=H.find(ct=>ct.productId===ce);At&&xe(At.tempId,"salePrice",ft)},disabled:!ce})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:Ge,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):H.map(Ne=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[Ne.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[Ne.category,"  ",Ne.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ne.quantity,onChange:pe=>{const Le=pe.target.value.replace(",","."),ft=parseFloat(Le),At=Number.isFinite(ft)?parseFloat(ft.toFixed(3)):0;xe(Ne.tempId,"quantity",At)}})}),i.jsx("td",{className:"p-2 border",children:Number(Ne.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ne.purchasePrice,onChange:pe=>{const Le=pe.target.value.replace(",","."),ft=parseFloat(Le),At=Number.isFinite(ft)?parseFloat(ft.toFixed(2)):0;xe(Ne.tempId,"purchasePrice",At)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ne.salePrice,onChange:pe=>{const Le=pe.target.value.replace(",","."),ft=parseFloat(Le),At=Number.isFinite(ft)?parseFloat(ft.toFixed(2)):0;xe(Ne.tempId,"salePrice",At)}})}),i.jsx("td",{className:"p-2 border",children:qa(Ne.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:qa(Ne.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:qa(Ne.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(Ne.tempId),children:"Quitar"})})]},Ne.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:de.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:de.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:qa(de.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:qa(de.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:qa(de.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:me,disabled:H.length===0,children:R?"Editar pedido":"Crear pedido"})]})]})]}),document.body),Q&&be&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{te(!1),U(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:be.orderName})," "," ",be.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{te(!1),U(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:be.items.map(Ne=>{const pe=Number(Ne.invoiceTotal||0),Le=Number(Ne.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:Ne.productName}),i.jsx("td",{className:"p-2 border",children:(Ne.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Ne.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ne.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:qa(Ne.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:qa(Ne.salePrice)}),i.jsx("td",{className:"p-2 border",children:qa(pe)}),i.jsx("td",{className:"p-2 border",children:qa(Le)}),i.jsx("td",{className:"p-2 border",children:qa(Le-pe)}),i.jsx("td",{className:"p-2 border",children:Ne.status})]},Ne.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:be.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:be.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:qa(be.utilidadBruta)})]})]})]})]}),document.body),Xe&&ee&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Vt}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:ee.orderName})," "," ",ee.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:kt,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:Vt,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const kh=t=>`C$${(Number(t)||0).toFixed(2)}`;function k3e(){const t=dwe(new Date),[e,r]=g.useState(Lr(t,"yyyy-MM")),[n,a]=g.useState([]),[s,o]=g.useState(!1),[l,c]=g.useState(""),u=g.useRef(null),d=g.useMemo(()=>{const[x,v]=e.split("-").map(w=>parseInt(w,10)),y=Lr(Qd(new Date(x,v-1,1)),"yyyy-MM-dd"),b=Lr(Ud(new Date(x,v-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),f=async()=>{o(!0);try{const x=await SPe(d.from,d.to),v=[];for(const y of x){const b=Yt(Ce,"inventory_batches",y.batchId),w=await gs(b);if(!w.exists())continue;const I=w.data();v.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:I.status??"PENDIENTE",purchasePrice:Number(I.purchasePrice||0),salePrice:Number(I.salePrice||0),supplier:I.supplier})}a(v)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};g.useEffect(()=>{f()},[e]);const A=async x=>{confirm("Marcar este lote como PAGADO?")&&(await qre(x),a(y=>y.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=g.useMemo(()=>{const x=n.reduce((w,I)=>w+I.soldQty,0),v=n.reduce((w,I)=>w+I.soldAmount,0),y=n.reduce((w,I)=>w+I.soldQty*I.purchasePrice,0),b=v-y;return{q:x,amt:v,cogs:y,profit:b}},[n]),m=g.useMemo(()=>{const x=new Map;for(const v of n){const y=v.productName||"(sin nombre)";x.has(y)||x.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(y);b.qty+=v.soldQty,b.revenue+=v.soldAmount;const w=v.soldQty*v.purchasePrice;b.cogs+=w,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((v,y)=>v.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!u.current)return;const x=u.current;x.classList.add("force-pdf-colors");try{const[{default:v},{jsPDF:y}]=await Promise.all([lA(()=>Promise.resolve().then(()=>q6),void 0),lA(()=>Promise.resolve().then(()=>zk),void 0)]),w=(await v(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),I=new y("p","mm","a4"),j=190,C=I.getImageProperties(w),S=j,E=C.height*S/C.width;I.addImage(w,"PNG",10,10,S,E),I.save(`liquidaciones_${e}.pdf`)}catch(v){console.error(v),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:f,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:u,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",kh(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",kh(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",kh(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const v=x.soldQty*x.purchasePrice,y=x.soldAmount-v;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:kh(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:kh(v)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:kh(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>A(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:kh(x.revenue)}),i.jsx("td",{className:"p-2 border",children:kh(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:kh(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Yr=t=>`C$${Number(t??0).toFixed(2)}`,F3e=()=>Lr(new Date,"yyyy-MM-dd"),oa=t=>Number(t||0).toFixed(3);function O3e(){const[t,e]=g.useState(()=>{const V=new Date,L=new Date(V.getFullYear(),V.getMonth(),1);return Lr(L,"yyyy-MM-dd")}),[r,n]=g.useState(F3e()),[a,s]=g.useState(!0),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState(!1),[m,p]=g.useState(null),[x,v]=g.useState(0),[y,b]=g.useState(0),[w,I]=g.useState(0),[j,C]=g.useState(0),[S,E]=g.useState({}),[B,k]=g.useState({}),{refreshKey:T,refresh:P}=Lc(),[G,ce]=g.useState({}),[ue,le]=g.useState({}),[Ae,ae]=g.useState(!1),_e=()=>ae(V=>!V),[De,O]=g.useState(!1),H=()=>O(V=>!V),[K,R]=g.useState(!1),[X,Y]=g.useState(!1),[D,Q]=g.useState(!1),[te,be]=g.useState(!1),[U,Xe]=g.useState(!1),[se,ee]=g.useState(!1),Fe=()=>R(V=>!V),je=()=>Y(V=>!V),Se=()=>Q(V=>!V),Ze=()=>be(V=>!V),ut=()=>Xe(V=>!V),Et=()=>ee(V=>!V),[St,Ft]=g.useState("");g.useEffect(()=>{(async()=>{s(!0);const L=sr(Ct(Ce,"salesV2"),cr("date",">=",t),cr("date","<=",r)),fe=await Ht(L),Be=[];fe.forEach(Ke=>{const yt=Ke.data(),ne=yt.date??"";if(Array.isArray(yt.items)&&yt.items.length>0){yt.items.forEach((Ue,rt)=>{const st=String(Ue.productName??"(sin nombre)"),_t=Number(Ue.qty??0),Ot=Number(Ue.lineFinal??0)||Math.max(0,Number(Ue.unitPrice||0)*_t-Number(Ue.discount||0));Be.push({id:`${Ke.id}#${rt}`,date:ne,productName:st,quantity:_t,amount:Ot,allocations:Array.isArray(Ue.allocations)?Ue.allocations:yt.allocations,avgUnitCost:Number(Ue.avgUnitCost??yt.avgUnitCost??0),measurement:Ue.measurement??yt.measurement??"",type:yt.type??"CONTADO"})});return}Be.push({id:Ke.id,date:ne,productName:yt.productName??"(sin nombre)",quantity:Number(yt.quantity??0),amount:Number(yt.amount??yt.amountCharged??0),allocations:Array.isArray(yt.allocations)?yt.allocations:[],avgUnitCost:Number(yt.avgUnitCost??0),measurement:yt.measurement??"",type:yt.type??"CONTADO"})}),l(Be);const ye=sr(Ct(Ce,"expenses"),cr("date",">=",t),cr("date","<=",r)),$e=await Ht(ye),ze=[];$e.forEach(Ke=>{const yt=Ke.data();ze.push({id:Ke.id,date:yt.date??"",category:yt.category??"(sin categora)",description:yt.description??"",amount:Number(yt.amount??0),status:yt.status??"PAGADO",createdAt:yt.createdAt})}),u(ze),s(!1)})()},[t,r,T]),g.useMemo(()=>{const V=o.reduce(($e,ze)=>$e+(ze.amount||0),0);let L=0;o.forEach($e=>{var ze;(ze=$e.allocations)!=null&&ze.length?L+=$e.allocations.reduce((Ke,yt)=>Ke+Number(yt.lineCost||0),0):$e.avgUnitCost&&$e.quantity&&(L+=Number($e.avgUnitCost)*Number($e.quantity))});const fe=V-L,Be=c.reduce(($e,ze)=>$e+(ze.amount||0),0),ye=fe-Be;return{revenue:V,cogsReal:L,grossProfit:fe,expensesSum:Be,netProfit:ye}},[o,c]);const Qt=g.useMemo(()=>St?o.filter(V=>(V.productName||"")===St):o,[o,St]),Ut=g.useMemo(()=>{const V=Qt.reduce(($e,ze)=>$e+(ze.amount||0),0);let L=0;Qt.forEach($e=>{var ze;(ze=$e.allocations)!=null&&ze.length?L+=$e.allocations.reduce((Ke,yt)=>Ke+Number(yt.lineCost||0),0):$e.avgUnitCost&&$e.quantity&&(L+=Number($e.avgUnitCost)*Number($e.quantity))});const fe=V-L,Be=c.reduce(($e,ze)=>$e+(ze.amount||0),0),ye=fe-Be;return{revenue:V,cogsReal:L,grossProfit:fe,expensesSum:Be,netProfit:ye}},[Qt,c]),Tt=g.useMemo(()=>{const V=Qt.filter(ze=>ze.type==="CONTADO"),L=V.reduce((ze,Ke)=>ze+(Ke.amount||0),0);let fe=0;V.forEach(ze=>{var Ke;(Ke=ze.allocations)!=null&&Ke.length?fe+=ze.allocations.reduce((yt,ne)=>yt+Number(ne.lineCost||0),0):ze.avgUnitCost&&ze.quantity&&(fe+=Number(ze.avgUnitCost)*Number(ze.quantity))});const Be=L-fe,ye=c.reduce((ze,Ke)=>ze+(Ke.amount||0),0),$e=Be-ye;return{revenue:L,cogsReal:fe,grossProfit:Be,expensesSum:ye,netProfit:$e}},[Qt,c]),Re=g.useMemo(()=>{const V=Qt.filter(ye=>ye.type==="CREDITO"),L=V.reduce((ye,$e)=>ye+($e.amount||0),0);let fe=0;V.forEach(ye=>{var $e;($e=ye.allocations)!=null&&$e.length?fe+=ye.allocations.reduce((ze,Ke)=>ze+Number(Ke.lineCost||0),0):ye.avgUnitCost&&ye.quantity&&(fe+=Number(ye.avgUnitCost)*Number(ye.quantity))});const Be=L-fe;return{revenue:L,cogsReal:fe,grossProfit:Be}},[Qt]),Te=V=>String(V??"").toLowerCase().trim(),Ye=V=>Number(V.qty??V.quantity??0),ht=V=>["lb","lbs","libra","libras"].includes(Te(V)),Oe=V=>["unidad","unidades","ud","uds","pieza","piezas"].includes(Te(V)),Ie=V=>V?typeof V=="string"?V:V!=null&&V.toDate?Lr(V.toDate(),"yyyy-MM-dd"):"":"";g.useEffect(()=>{(async()=>{h(!0);try{const L=await Ht(Ct(Ce,"customers_pollo")),fe={};L.forEach(er=>{const ir=er.data();fe[er.id]=String(ir.name??"(sin nombre)")});const Be=await Ht(Ct(Ce,"ar_movements_pollo")),ye={},$e={},ze={},Ke={},yt={},ne=new Set,Ue={},rt={},st={},_t={};let Ot=0,nr=0;const Ir=er=>{var ir;return er!=null&&er.date?String(er.date):(ir=er==null?void 0:er.createdAt)!=null&&ir.toDate?Lr(er.createdAt.toDate(),"yyyy-MM-dd"):""};Be.forEach(er=>{var nt,lt,ge;const ir=er.data(),Sr=String(ir.customerId??"").trim();if(!Sr)return;const vr=Number(ir.amount??0);ye[Sr]=(ye[Sr]||0)+vr;const Fr=String(ir.type??"").toUpperCase(),jn=String(ir.debtStatus??ir.creditStatus??ir.cycleStatus??ir.status??"").toUpperCase().trim(),he=["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"].includes(jn),tt=ir.createdAt??null;if(Fr==="ABONO"){Ot+=Math.abs(vr);const it=Ir(ir);it&&it>=t&&it<=r&&(nr+=Math.abs(vr));const Pt=(nt=ir==null?void 0:ir.ref)!=null&&nt.saleId?String(ir.ref.saleId):"";Pt?(Ue[Pt]=(Ue[Pt]||0)+Math.abs(vr),it&&it>=t&&it<=r&&(st[Pt]=(st[Pt]||0)+Math.abs(vr)),ne.add(Pt)):(rt[Sr]=(rt[Sr]||0)+Math.abs(vr),it&&it>=t&&it<=r&&(_t[Sr]=(_t[Sr]||0)+Math.abs(vr)));const wt=ze[Sr],Nt=!(wt!=null&&wt.ts)||(tt!=null&&tt.toDate&&((lt=wt.ts)!=null&&lt.toDate)?tt.toDate()>wt.ts.toDate():!1);(!wt||Nt)&&(ze[Sr]={amount:Math.abs(vr),date:ir.date??"",ts:tt})}if(Fr==="CARGO"){const it=(ge=ir==null?void 0:ir.ref)!=null&&ge.saleId?String(ir.ref.saleId):"";it&&(Ke[Sr]||(Ke[Sr]=new Set),Ke[Sr].add(it),he||(yt[Sr]||(yt[Sr]=new Set),yt[Sr].add(it)),ne.add(it)),he||($e[Sr]=($e[Sr]||0)+Math.abs(vr))}});const Qr=new Map;await Promise.all(Array.from(ne).map(async er=>{const ir=await gs(Yt(Ce,"salesV2",er));ir.exists()&&Qr.set(er,ir.data())}));let or=0,kr=0;const Zr=er=>{const ir=Number(er.qty??er.quantity??0);return Number(er.lineFinal??0)||Math.max(0,Number(er.unitPrice||0)*ir-Number(er.discount||0))},nn=er=>{if(Array.isArray(er.items)&&er.items.length>0){let Fr=0,jn=0;return er.items.forEach(he=>{const tt=Number(he.qty??he.quantity??0);if(Fr+=Zr(he),Array.isArray(he.allocations)&&he.allocations.length>0)jn+=he.allocations.reduce((nt,lt)=>nt+Number(lt.lineCost||0),0);else{const nt=Number(he.avgUnitCost??er.avgUnitCost??0);jn+=nt*tt}}),{total:Fr,cogs:jn}}const ir=Number(er.quantity??0),Sr=Number(er.amount??er.amountCharged??0)||0;let vr=0;return Array.isArray(er.allocations)&&er.allocations.length>0?vr=er.allocations.reduce((Fr,jn)=>Fr+Number(jn.lineCost||0),0):er.avgUnitCost&&(vr=Number(er.avgUnitCost)*ir),{total:Sr,cogs:vr}},_r=new Map;Qr.forEach((er,ir)=>{const{total:Sr,cogs:vr}=nn(er);_r.set(ir,{total:Sr,cogs:vr,grossProfit:Sr-vr})});const He={},Bt={},xr={},dn={};Object.keys(Ue).forEach(er=>{const ir=_r.get(er);if(!(ir!=null&&ir.total))return;const Sr=Number(Ue[er]||0);Bt[er]=Sr;const vr=Math.min(1,Sr/ir.total),Fr=ir.grossProfit*vr;He[er]=Fr,or+=Fr}),Object.keys(st).forEach(er=>{const ir=_r.get(er);if(!(ir!=null&&ir.total))return;const Sr=Number(st[er]||0);dn[er]=Sr;const vr=Math.min(1,Sr/ir.total),Fr=ir.grossProfit*vr;xr[er]=Fr,kr+=Fr}),Object.keys(rt).forEach(er=>{const ir=Ke[er];if(!ir||ir.size===0)return;let Sr=0,vr=0,Fr=0,jn=0;ir.forEach(ge=>{const it=_r.get(ge);it&&(Sr+=it.total,vr+=it.grossProfit,Bt[ge]&&(Fr+=Math.min(it.total,Bt[ge])),jn+=He[ge]||0)});const he=Math.max(0,Sr-Fr),tt=Math.max(0,vr-jn);if(!he||!tt)return;const nt=Number(rt[er]||0),lt=Math.min(1,nt/he);or+=tt*lt}),Object.keys(_t).forEach(er=>{const ir=Ke[er];if(!ir||ir.size===0)return;let Sr=0,vr=0,Fr=0,jn=0;ir.forEach(ge=>{const it=_r.get(ge);it&&(Sr+=it.total,vr+=it.grossProfit,dn[ge]&&(Fr+=Math.min(it.total,dn[ge])),jn+=xr[ge]||0)});const he=Math.max(0,Sr-Fr),tt=Math.max(0,vr-jn);if(!he||!tt)return;const nt=Number(_t[er]||0),lt=Math.min(1,nt/he);kr+=tt*lt});const Jr=[];Object.keys(ye).forEach(er=>{const ir=Number(ye[er]||0);if(ir<=0)return;const Sr=new Map;let vr=0,Fr=0,jn="";(yt[er]||new Set).forEach(lt=>{const ge=Qr.get(lt);if(!ge)return;const it=String(ge.date??"");it&&(!jn||it>jn)&&(jn=it),(Array.isArray(ge.items)&&ge.items.length>0?ge.items:[{productName:ge.productName,qty:ge.quantity,unitPrice:ge.unitPrice,discount:ge.discount,lineFinal:ge.amount??ge.amountCharged,measurement:ge.measurement}]).forEach(wt=>{const Nt=String(wt.productName??"(sin nombre)"),It=Number(wt.qty??wt.quantity??0),qt=String(wt.measurement??""),Mt=Number(wt.lineFinal??0)||Math.max(0,Number(wt.unitPrice||0)*It-Number(wt.discount||0));ht(qt)?vr+=It:Fr+=It;const zt=`${Nt}||${qt}`,ar=Sr.get(zt)||{productName:Nt,qty:0,amount:0,measurement:qt};ar.qty+=It,ar.amount+=Mt,Sr.set(zt,ar)})});const tt=ze[er],nt=Number($e[er]||0);Jr.push({customerId:er,name:fe[er]||"(sin nombre)",balance:ir,globalBalance:nt>0?nt:ir,lbs:vr,units:Fr,lastPaymentAmount:Number((tt==null?void 0:tt.amount)||0),lastSaleDate:jn||"",lastPaymentDate:Ie((tt==null?void 0:tt.ts)||(tt==null?void 0:tt.date)),products:Array.from(Sr.values()).sort((lt,ge)=>lt.productName.localeCompare(ge.productName))})});const br=Jr.filter(er=>er.products.length);br.sort((er,ir)=>ir.balance-er.balance),f(br),v(Ot),b(nr),I(or),C(kr)}catch(L){console.error("Error cargando saldos pendientes:",L),f([]),v(0),b(0),C(0)}finally{h(!1)}})()},[T,t,r]),g.useEffect(()=>{(async()=>{try{const L=await Ht(sr(Ct(Ce,"inventory_batches"))),fe=NS(t,"yyyy-MM-dd",new Date),Be=NS(r,"yyyy-MM-dd",new Date),ye=Lr(Qd(fe),"yyyy-MM-dd"),$e=Lr(Ud(Be),"yyyy-MM-dd"),ze={};L.forEach(Ke=>{var Ot;const yt=Ke.data(),ne=String(yt.productName??"(sin nombre)"),Ue=Number(yt.quantity??0),rt=Number(yt.remaining??0),st=(Ot=yt==null?void 0:yt.date)!=null&&Ot.toDate?Lr(yt.date.toDate(),"yyyy-MM-dd"):String((yt==null?void 0:yt.date)??(yt==null?void 0:yt.createdAt)??""),_t=st&&st>=ye&&st<=$e;ze[ne]||(ze[ne]={incomingQty:0,remainingQty:0}),_t&&(ze[ne].incomingQty+=Ue),ze[ne].remainingQty+=rt}),E(ze)}catch(L){console.error("Error cargando inventario:",L),E({})}})()},[T,t,r]);const We=g.useMemo(()=>o.reduce((V,L)=>ht(L.measurement)?V+Ye(L):V,0),[o]);g.useMemo(()=>Qt.reduce((V,L)=>ht(L.measurement)?V+Ye(L):V,0),[Qt]);const Z=g.useMemo(()=>Qt.filter(V=>V.type==="CONTADO"),[Qt]),Qe=g.useMemo(()=>Qt.filter(V=>V.type==="CREDITO"),[Qt]),at=g.useMemo(()=>Z.reduce((V,L)=>V+(L.amount||0),0),[Z]),Ge=g.useMemo(()=>Qe.reduce((V,L)=>V+(L.amount||0),0),[Qe]),ie=g.useMemo(()=>d.reduce((V,L)=>V+Number(L.balance||0),0),[d]),xe=g.useMemo(()=>Tt.revenue,[Tt.revenue]),de=g.useMemo(()=>at,[at]),Me=g.useMemo(()=>at+y,[at,y]),me=g.useMemo(()=>Tt.grossProfit+j,[Tt.grossProfit,j]),we=g.useMemo(()=>Tt.netProfit+j,[Tt.netProfit,j]),pt=g.useMemo(()=>Z.reduce((V,L)=>ht(L.measurement)?V+Ye(L):V,0),[Z]),vt=g.useMemo(()=>Qe.reduce((V,L)=>ht(L.measurement)?V+Ye(L):V,0),[Qe]),bt=g.useMemo(()=>o.reduce((V,L)=>Oe(L.measurement)?V+Ye(L):V,0),[o]);g.useMemo(()=>Qt.reduce((V,L)=>Oe(L.measurement)?V+Ye(L):V,0),[Qt]);const kt=g.useMemo(()=>Z.reduce((V,L)=>Oe(L.measurement)?V+Ye(L):V,0),[Z]),Vt=g.useMemo(()=>Qe.reduce((V,L)=>Oe(L.measurement)?V+Ye(L):V,0),[Qe]),ke=g.useMemo(()=>Array.from(new Set(o.map(V=>V.productName||"(sin nombre)"))).sort(),[o]),Ne=g.useMemo(()=>{var L;const V=new Map;for(const fe of Qt){const Be=fe.productName||"(sin nombre)";V.has(Be)||V.set(Be,{productName:Be,units:0,revenue:0,cogs:0,profit:0,firstDate:fe.date||"",lastDate:fe.date||""});const ye=V.get(Be);ye.units+=Number(fe.quantity||0),ye.revenue+=Number(fe.amount||0),(!ye.firstDate||fe.date<(ye.firstDate||fe.date))&&(ye.firstDate=fe.date),(!ye.lastDate||fe.date>(ye.lastDate||fe.date))&&(ye.lastDate=fe.date);let $e=0;(L=fe.allocations)!=null&&L.length?$e=fe.allocations.reduce((ze,Ke)=>ze+Number(Ke.lineCost||0),0):fe.avgUnitCost&&($e=Number(fe.avgUnitCost)*Number(fe.quantity||0)),ye.cogs+=$e,ye.profit=ye.revenue-ye.cogs}return Array.from(V.values()).sort((fe,Be)=>fe.productName.localeCompare(Be.productName))},[Qt]),pe=g.useMemo(()=>[...Ne].sort((V,L)=>L.units-V.units).slice(0,3).map((V,L)=>({idx:L+1,name:V.productName,units:V.units})),[Ne]),Le=V=>ce(L=>({...L,[V]:!L[V]})),ft=V=>le(L=>({...L,[V]:!L[V]})),At=()=>{const V=new rn({unit:"pt",format:"a4"}),L="Dashboard Financiero",fe=`Rango: ${t} a ${r}`,Be=St?`Producto: ${St}`:"Producto: Todos";V.setFontSize(16),V.text(L,40,40),V.setFontSize(10),V.text(fe,40,58),V.text(Be,40,72);let ye=90;const $e=()=>{var Ke;ye=(Ke=V.lastAutoTable)!=null&&Ke.finalY?V.lastAutoTable.finalY+18:ye+18},ze=(Ke,yt)=>{yt.length&&(V.setFontSize(11),V.text(Ke,40,ye),ye+=12,H0(V,{startY:ye,head:[["KPI","Valor"]],body:yt,styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),$e())};ze("KPIs Generales",[["Ventas (rango)",Yr(Ut.revenue)],["Costo",Yr(Ut.cogsReal)],["Utilidad Bruta",Yr(Ut.grossProfit)],["Gastos",Yr(Ut.expensesSum)],["Utilidad Neta",Yr(Ut.netProfit)]]),ze("KPIs Cash",[["Ventas Cash",Yr(xe)],["Costo Cash",Yr(Tt.cogsReal)],["Utilidad Bruta Cash",Yr(Tt.grossProfit)]]),ze("KPIs Crdito",[["Ventas Crdito",Yr(Re.revenue)],["Costo Crdito",Yr(Re.cogsReal)],["Utilidad Bruta Crdito",Yr(Re.grossProfit)]]),ze("Fondos y Utilidades",[["CxC",Yr(ie)],["Recaudacin (Abonos)",Yr(x)],["Recaudacin a la fecha",Yr(y)],["Recolectado Cash + Abonos",Yr(Me)],["Utilidad Neta Crdito (Caja)",Yr(j)],["Utilidad Bruta Cash + Crdito",Yr(me)],["Gastos",Yr(Tt.expensesSum)],["Utilidad Neta Cash + Crdito",Yr(we)]]),ze("KPIs de Volumen y Ventas",[["Ventas Cash",Yr(de)],["Ventas Crdito",Yr(Ge)],["Libras Cash",oa(pt)],["Libras Crdito",oa(vt)],["Libras Cash + Crdito",oa(pt+vt)],["Unidades Cash",oa(kt)],["Unidades Crdito",oa(Vt)],["Unidades Cash + Crdito",oa(kt+Vt)]]),pe.length>0&&(V.setFontSize(11),V.text("Top productos por unidades",40,ye),ye+=12,H0(V,{startY:ye,head:[["#","Producto","Cantidad"]],body:pe.map(Ke=>[String(Ke.idx),Ke.name,oa(Ke.units)]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),$e()),H0(V,{startY:ye,head:[["Cliente","Libras","Unidades","Saldo Global","ltimo abono","Saldo pendiente","Fecha ult. abono"]],body:d.map(Ke=>[Ke.name,oa(Ke.lbs),oa(Ke.units),Yr(Ke.globalBalance),Yr(Ke.lastPaymentAmount),Yr(Ke.balance),Ke.lastPaymentDate||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]},didDrawPage:Ke=>{Ke.pageNumber>1&&(V.setFontSize(10),V.text(L,40,30))}}),$e(),H0(V,{startY:ye,head:[["Producto","Ingresado","Disponibilidad","Fechas","Cantidad","Venta","Costo","Utilidad"]],body:Ne.map(Ke=>{var yt,ne;return[Ke.productName,oa(((yt=S[Ke.productName])==null?void 0:yt.incomingQty)||0),oa(((ne=S[Ke.productName])==null?void 0:ne.remainingQty)||0),Ke.firstDate&&Ke.lastDate?Ke.firstDate===Ke.lastDate?Ke.firstDate:`${Ke.firstDate}  ${Ke.lastDate}`:"",oa(Ke.units),Yr(Ke.revenue),Yr(Ke.cogs),Yr(Ke.profit)]}),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),$e(),H0(V,{startY:ye,head:[["Fecha","Categora","Descripcin","Monto","Estado"]],body:c.map(Ke=>[Ke.date,Ke.category,Ke.description||"",Yr(Ke.amount),Ke.status||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),V.save(`dashboard_${t}_a_${r}.pdf`)},[ct,W]=g.useState(!1),z=g.useRef(!1),re=async(V=!1)=>{try{W(!0);const L=ic.currentUser,fe={from:t,to:r,createdAt:Dee(),user:L?{uid:L.uid,email:L.email??null,displayName:L.displayName??null}:null,kpis:{visible:Ut,cash:Tt,credit:Re},totals:{totalLbs:We,totalUnits:bt,totalSalesCash:at,totalSalesCredit:Ge,totalPendingBalance:ie,totalAbonos:x,totalAbonosRange:y,collectedCashPlusAbonos:Me,grossProfitCashPlusCredit:me,netProfitCashPlusCredit:we},topProducts:pe,byProduct:Ne.map(Be=>({productName:Be.productName,units:Be.units,revenue:Be.revenue,cogs:Be.cogs,profit:Be.profit}))};await Gn(Ct(Ce,"financial_snapshots"),fe),V||window.alert("KPIs guardados en la coleccin 'financial_snapshots'.")}catch(L){console.error("Error guardando snapshot de KPIs:",L),V||window.alert("Error guardando snapshot de KPIs. Revisa la consola.")}finally{W(!1)}};return g.useEffect(()=>{if(!z.current){z.current=!0;return}const V=setTimeout(()=>{re(!0)},800);return()=>clearTimeout(V)},[t,r]),i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Dashboard Financiero"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",onClick:At,className:"px-3 py-2 rounded-lg text-sm bg-gray-900 text-white hover:bg-black",children:"Exportar PDF"}),i.jsx("button",{type:"button",onClick:re,disabled:ct,className:"px-3 py-2 rounded-lg text-sm bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:ct?"Guardando":"Guardar KPIs"}),i.jsx(Mc,{onClick:P,loading:a})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:V=>e(V.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:V=>n(V.target.value)})]})]}),a?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:Fe,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Kpi Financiero"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Ventas: ",i.jsx("b",{children:Yr(Ut.revenue)}),"  Utilidad Neta:"," ",i.jsx("b",{children:Yr(Ut.netProfit)})]})]}),i.jsx("div",{className:"text-gray-500",children:K?"Cerrar":"Ver"})]}),K&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"flex gap-2 mb-2 items-center",children:i.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:St,onChange:V=>Ft(V.target.value),children:[i.jsx("option",{value:"",children:"Todos los productos"}),ke.map(V=>i.jsx("option",{value:V,children:V},V))]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:Ze,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Ventas cash - Credito"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Resumen"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:te?"Cerrar":"Ver"})]}),te&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(is,{title:"Ventas",subtitle:"Ventas cash",value:Yr(xe),valueClass:"text-[#1E4D2B]"}),i.jsx(is,{title:"Costo",value:Yr(Tt.cogsReal)}),i.jsx(is,{title:"Utilidad Bruta Cash",value:Yr(Tt.grossProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(is,{title:"Ventas Crdito",value:Yr(Re.revenue)}),i.jsx(is,{title:"Costo",value:Yr(Re.cogsReal),negative:!0}),i.jsx(is,{title:"Utilidad Bruta Crdito",value:Yr(Re.grossProfit),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:ut,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Fondos"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Liquidez"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:U?"Cerrar":"Ver"})]}),U&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[i.jsx(is,{title:"CxC",value:Yr(ie)}),i.jsx(is,{title:"Recaudacin Global(Abonos)",value:Yr(x)}),i.jsx(is,{title:"Recaudacin a la fecha",value:Yr(y)}),i.jsx(is,{title:"Recolectado Cash + Abonos",value:Yr(Me),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(is,{title:"Utilidad Neta Crdito (Caja)",value:Yr(j),valueClass:"text-[#BF5700]"}),i.jsx(is,{title:"Utilidad Bruta Cash + Crdito",value:Yr(me),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(is,{title:"Gastos",value:Yr(Tt.expensesSum),negative:!0}),i.jsx(is,{title:"Utilidad Neta Cash + Crdito",value:Yr(we),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:Et,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Detalles"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Mtricas adicionales"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:se?"Cerrar":"Ver"})]}),se&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ql,{title:"Ventas Cash",value:Yr(de)}),i.jsx(ql,{title:"Ventas Crdito",value:Yr(Ge)}),i.jsx(ql,{title:"Libras Cash",value:oa(pt)}),i.jsx(ql,{title:"Libras Crdito",value:oa(vt)}),i.jsx(ql,{title:"Unidades Cash",value:oa(kt)}),i.jsx(ql,{title:"Unidades Crdito",value:oa(Vt)})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(ql,{title:"Libras Cash + Credito",value:oa(pt+vt)}),i.jsx(ql,{title:"Unidades Cash + Credito",value:oa(kt+Vt)}),i.jsx(uH,{title:"Productos ms vendidos",items:pe.map(V=>({key:`${V.idx}`,label:`${V.idx}. ${V.name}`,value:`(${oa(V.units)})`}))})]})]})]})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(is,{title:"Ventas Cash",value:Yr(xe),positive:!0}),i.jsx(is,{title:"Costo",value:Yr(Tt.cogsReal),negative:!0}),i.jsx(is,{title:"Utilidad Bruta Cash",value:Yr(Tt.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(is,{title:"Ventas Crdito",value:Yr(Re.revenue),positive:!0}),i.jsx(is,{title:"Costo",value:Yr(Re.cogsReal),negative:!0}),i.jsx(is,{title:"Utilidad Bruta Crdito",value:Yr(Re.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(is,{title:"CxC",value:Yr(ie),negative:!0}),i.jsx(is,{title:"Recaudacin Global(Abonos)",value:Yr(x),positive:!0}),i.jsx(is,{title:"Recaudacin a la fecha",value:Yr(y),positive:!0}),i.jsx(is,{title:"Recolectado Cash + Abonos",value:Yr(Me),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-4 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(is,{title:"Utilidad Neta Crdito (Caja)",value:Yr(j),valueClass:"text-[#BF5700]"}),i.jsx(is,{title:"Utilidad Bruta Cash + Crdito",value:Yr(me),positive:!0}),i.jsx(is,{title:"Gastos",value:Yr(Tt.expensesSum),negative:!0}),i.jsx(is,{title:"Utilidad Neta Cash + Crdito",value:Yr(we),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ql,{title:"Ventas Cash",value:Yr(de)}),i.jsx(ql,{title:"Ventas Crdito",value:Yr(Ge)}),i.jsx(ql,{title:"Libras Cash",value:oa(pt)}),i.jsx(ql,{title:"Libras Crdito",value:oa(vt)}),i.jsx(ql,{title:"Unidades Cash",value:oa(kt)}),i.jsx(ql,{title:"Unidades Crdito",value:oa(Vt)})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(ql,{title:"Libras Cash + Credito",value:oa(pt+vt)}),i.jsx(ql,{title:"Unidades Cash + Credito",value:oa(kt+Vt)}),i.jsx(uH,{title:"Productos ms vendidos",items:pe.map(V=>({key:`${V.idx}`,label:`${V.idx}. ${V.name}`,value:`(${oa(V.units)})`}))})]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:je,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Saldos pendientes"}),i.jsx("div",{className:"text-gray-500",children:X?"Cerrar":"Ver"})]}),X&&i.jsx("div",{className:"border rounded-2xl p-3 sm:p-4 bg-gray-50 mt-3",children:A?i.jsx("div",{className:"text-sm text-gray-600",children:"Cargando saldos"}):d.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"Sin saldos pendientes."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-white",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Libras"}),i.jsx("th",{className:"border p-2",children:"Unidades"}),i.jsx("th",{className:"border p-2",children:"Saldo Global"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:d.map(V=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1 text-left",children:V.name}),i.jsx("td",{className:"border p-1",children:oa(V.lbs)}),i.jsx("td",{className:"border p-1",children:oa(V.units)}),i.jsx("td",{className:"border p-1",children:Yr(V.globalBalance)}),i.jsx("td",{className:"border p-1",children:Yr(V.lastPaymentAmount)}),i.jsx("td",{className:"border p-1",children:Yr(V.balance)}),i.jsx("td",{className:"border p-1",children:V.lastPaymentDate||""}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",onClick:()=>p(V),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},V.customerId))})]})})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:Se,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Ventas y Gastos"}),i.jsx("div",{className:"text-gray-500",children:D?"Cerrar":"Ver"})]}),D&&i.jsxs("div",{className:"mt-3",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Ingresado Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Disponibilidad"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"}),i.jsx("th",{className:"border p-2",children:"Cantidad Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[Ne.map(V=>{var L,fe;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:V.productName}),i.jsx("td",{className:"border p-1",children:oa(((L=S[V.productName])==null?void 0:L.incomingQty)||0)}),i.jsx("td",{className:"border p-1",children:oa(((fe=S[V.productName])==null?void 0:fe.remainingQty)||0)}),i.jsx("td",{className:"border p-1",children:V.firstDate&&V.lastDate?V.firstDate===V.lastDate?V.firstDate:`${V.firstDate}  ${V.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:oa(V.units)}),i.jsx("td",{className:"border p-1",children:Yr(V.revenue)}),i.jsx("td",{className:"border p-1",children:Yr(V.cogs)}),i.jsx("td",{className:`border p-1 ${V.profit>=0?"text-green-700":"text-red-700"}`,children:Yr(V.profit)})]},V.productName)}),Ne.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:_e,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Ventas por producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Ne.length," productos"]})]}),i.jsx("div",{className:"text-gray-500",children:Ae?"Cerrar":"Ver"})]}),Ae&&i.jsx("div",{className:"space-y-2 mt-3",children:Ne.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin datos en el rango seleccionado."}):Ne.map(V=>{var Be,ye,$e,ze;const L=!!G[V.productName],fe=V.firstDate&&V.lastDate?V.firstDate===V.lastDate?V.firstDate:`${V.firstDate}  ${V.lastDate}`:"";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>Le(V.productName),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:V.productName}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Libras/Unidades"}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendidas: ",i.jsx("b",{children:oa(V.units)}),"  Disponible:"," ",i.jsx("b",{className:((Be=S[V.productName])==null?void 0:Be.remainingQty)>0?"text-green-700":"text-red-700",children:oa(((ye=S[V.productName])==null?void 0:ye.remainingQty)||0)})]})]}),i.jsx("div",{className:"text-gray-500 text-xs pt-0.10",children:L?"Cerrar":"Ver"})]}),L&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx(nd,{label:"Lb/Un Ingresadas",value:oa((($e=S[V.productName])==null?void 0:$e.incomingQty)||0)}),i.jsx(nd,{label:"Lb/Un Disponibles",value:oa(((ze=S[V.productName])==null?void 0:ze.remainingQty)||0)}),i.jsx(nd,{label:"Fechas Venta",value:fe}),i.jsx(nd,{label:"Lb/Un Vendidas",value:oa(V.units)}),i.jsx(nd,{label:"Facturado al costo",value:Yr(V.cogs)}),i.jsx(nd,{label:"Monto Venta",value:Yr(V.revenue)}),i.jsx(nd,{label:"Utilidad bruta",value:Yr(V.profit),valueClass:V.profit>=0?"text-green-700 font-semibold":"text-red-700 font-semibold"})]})})]},V.productName)})})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(V=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:V.date}),i.jsx("td",{className:"border p-1",children:V.category}),i.jsx("td",{className:"border p-1",children:V.description}),i.jsx("td",{className:"border p-1",children:Yr(V.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${V.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:V.status})})]},V.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:H,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Gastos del periodo"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[c.length," registros"]})]}),i.jsx("div",{className:"text-gray-500",children:De?"Cerrar":"Abrir"})]}),De&&i.jsx("div",{className:"space-y-2 mt-3",children:c.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin gastos en el rango seleccionado."}):c.map(V=>{const L=!!ue[V.id],fe=V.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>ft(V.id),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:V.category}),i.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] ${fe}`,children:V.status})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[V.date,"  ",i.jsx("b",{children:Yr(V.amount)})]})]}),i.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:L?"Cerrar":"Ver"})]}),L&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsx(nd,{label:"Fecha",value:V.date}),i.jsx(nd,{label:"Categora",value:V.category}),i.jsx(nd,{label:"Descripcin",value:V.description||""}),i.jsx(nd,{label:"Monto",value:Yr(V.amount)}),i.jsx(nd,{label:"Estado",value:V.status||""})]})})]},V.id)})})]})]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:m.name}),i.jsx("button",{type:"button",onClick:()=>p(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras/Unidades"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"})]})}),i.jsx("tbody",{children:m.products.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin productos asociados."})}):m.products.map(V=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1",children:V.productName}),i.jsx("td",{className:"border p-1 text-center",children:oa(V.qty)}),i.jsx("td",{className:"border p-1 text-center",children:Yr(V.amount)}),i.jsx("td",{className:"border p-1 text-center",children:m.lastSaleDate||""})]},`${V.productName}-${V.measurement}`))})]})})]})})]})}function is({title:t,value:e,positive:r,negative:n,valueClass:a,subtitle:s}){const o=a||(r?"text-[#568203]":n?"text-[#AB274F]":"");return i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),s?i.jsx("div",{className:"text-[11px] sm:text-[12px] text-gray-400",children:s}):null,i.jsx("div",{className:`text-[26px] sm:text-[30px] font-bold ${o}`,children:e})]})}function ql({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[18px] sm:text-[20px] font-semibold",children:e})]})}function uH({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}function nd({label:t,value:e,valueClass:r}){return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:t}),i.jsx("div",{className:`text-sm mt-0.5 ${r||""}`,children:e})]})}function D3e({open:t,onClose:e,children:r}){return t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-lg w-full relative",children:[i.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-2xl font-bold",onClick:e,"aria-label":"Cerrar",children:""}),r]})}):null}const S5=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],p0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function R3e(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[o,l]=g.useState(Lr(new Date,"yyyy-MM-dd")),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState("PENDIENTE"),[x,v]=g.useState(""),[y,b]=g.useState([]),[w,I]=g.useState(!0),[j,C]=g.useState(""),[S,E]=g.useState(null),[B,k]=g.useState(""),[T,P]=g.useState(""),[G,ce]=g.useState(""),[ue,le]=g.useState(0),[Ae,ae]=g.useState("PENDIENTE"),[_e,De]=g.useState(""),[O,H]=g.useState(!1),K=()=>H(!0),R=()=>H(!1),[X,Y]=g.useState(null),D=Se=>Y(Ze=>Ze===Se?null:Se);g.useEffect(()=>{(async()=>{I(!0),C("");try{const Se=sr(Ct(Ce,"expenses"),Sn("date","desc")),Ze=await Ht(Se),ut=[];Ze.forEach(Et=>{const St=Et.data();ut.push({id:Et.id,date:St.date||Lr(new Date,"yyyy-MM-dd"),category:St.category||"",description:St.description||"",amount:Number(St.amount||0),status:St.status||"PENDIENTE",notes:St.notes||"",createdAt:St.createdAt??yr.now()})}),b(ut)}catch(Se){console.error(Se),C(" Error al cargar gastos")}finally{I(!1)}})()},[t]);const Q=g.useMemo(()=>y.filter(Se=>!(r&&Se.date<r||a&&Se.date>a)),[y,r,a]),te=g.useMemo(()=>{const Se=Q.reduce((Et,St)=>Et+(St.amount||0),0),Ze=Q.filter(Et=>Et.status==="PAGADO").reduce((Et,St)=>Et+(St.amount||0),0),ut=Se-Ze;return{total:Se,pagado:Ze,pendiente:ut}},[Q]),be=()=>{l(Lr(new Date,"yyyy-MM-dd")),u(""),f(""),h(0),p("PENDIENTE"),v("")},U=async Se=>{if(Se.preventDefault(),C(""),!c)return C("Selecciona una categora.");if(!d.trim())return C("Ingresa una descripcin.");if(!A||A<=0)return C("Ingresa un monto vlido.");try{const Ze={date:o,category:c,description:d.trim(),amount:Number(Number(A||0).toFixed(2)),status:m,notes:x||"",createdAt:yr.now()},ut=await Gn(Ct(Ce,"expenses"),Ze);b(Et=>[{id:ut.id,...Ze},...Et]),be(),C(" Gasto registrado")}catch(Ze){console.error(Ze),C(" Error al guardar gasto")}},Xe=Se=>{C(""),E(Se.id),k(Se.date),P(Se.category||""),ce(Se.description||""),le(Number(Se.amount||0)),ae(Se.status||"PENDIENTE"),De(Se.notes||"")},se=()=>{E(null),k(""),P(""),ce(""),le(0),ae("PENDIENTE"),De("")},ee=async()=>{if(S){if(!T)return C("Selecciona una categora.");if(!G.trim())return C("Ingresa una descripcin.");if(!ue||ue<=0)return C("Ingresa un monto vlido.");try{const Se={date:B,category:T,description:G.trim(),amount:Number(Number(ue||0).toFixed(2)),status:Ae,notes:_e||""};await kn(Yt(Ce,"expenses",S),Se),b(Ze=>Ze.map(ut=>ut.id===S?{...ut,...Se}:ut)),se(),C(" Gasto actualizado")}catch(Se){console.error(Se),C(" Error al actualizar gasto")}}},Fe=async Se=>{if(confirm(`Eliminar el gasto "${Se.description}"?`))try{await Wn(Yt(Ce,"expenses",Se.id)),b(ut=>ut.filter(Et=>Et.id!==Se.id)),C(" Gasto borrado")}catch(ut){console.error(ut),C(" Error al borrar gasto")}},je=Se=>Se==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2 flex-wrap",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Gastos (Pollo)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:K,type:"button",children:"Crear pago"}),i.jsx(Mc,{onClick:e,loading:w})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Se=>n(Se.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Se=>s(Se.target.value)})]})]}),i.jsxs("div",{className:"sm:ml-auto text-sm bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",p0(te.total)]}),i.jsxs("div",{children:["Pagado: ",p0(te.pagado)]}),i.jsxs("div",{children:["Pendiente: ",p0(te.pendiente)]})]})]}),i.jsxs(D3e,{open:O,onClose:R,children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Crear gasto"}),i.jsxs("form",{onSubmit:Se=>{U(Se),!(!c||!d.trim()||!A||A<=0)&&R()},className:"grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:Se=>l(Se.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:Se=>u(Se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S5.map(Se=>i.jsx("option",{value:Se,children:Se},Se))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:Se=>f(Se.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:Se=>{const Ze=String(Se.target.value||"").replace(",","."),ut=parseFloat(Ze);h(Number.isFinite(ut)?Math.max(0,ut):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:Se=>p(Se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:x,onChange:Se=>v(Se.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[x.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:()=>{be(),R()},children:"Cancelar"})]})]}),j&&i.jsx("p",{className:"mt-2 text-sm",children:j})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:w?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):Q.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin gastos en el rango seleccionado."}):Q.map(Se=>{const Ze=X===Se.id,ut=S===Se.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full text-left px-3 py-3 flex items-start justify-between bg-white",onClick:()=>D(Se.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:Se.description}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Se.category||"","  ",Se.date]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold",children:p0(Se.amount)}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${je(Se.status)}`,children:Se.status})]})]}),Ze&&i.jsxs("div",{className:"p-3",children:[i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:Se.notes?Se.notes:""}),ut?i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm",children:[i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:Et=>k(Et.target.value)}),i.jsxs("select",{className:"w-full border p-2 rounded",value:T,onChange:Et=>P(Et.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S5.map(Et=>i.jsx("option",{value:Et,children:Et},Et))]}),i.jsx("input",{className:"w-full border p-2 rounded",value:G,onChange:Et=>ce(Et.target.value)}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(ue)?"":ue,onChange:Et=>{const St=String(Et.target.value||"").replace(",","."),Ft=parseFloat(St);le(Number.isFinite(Ft)?Math.max(0,Ft):0)}}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ae,onChange:Et=>ae(Et.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:_e,onChange:Et=>De(Et.target.value),maxLength:500}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ee,children:"Guardar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:se,children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Xe(Se),children:"Editar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Fe(Se),children:"Borrar"})]})]})]},Se.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded-2xl shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-1 text-left",children:"Fecha"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Categora"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Descripcin"}),i.jsx("th",{className:"px-2 py-1 text-right",children:"Monto"}),i.jsx("th",{className:"px-2 py-1 text-center",children:"Estado"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Comentario"}),i.jsx("th",{className:"px-2 py-1 text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-4",children:"Cargando"})}):Q.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-4",children:"Sin gastos en el rango seleccionado."})}):Q.map(Se=>{const Ze=S===Se.id;return i.jsx("tr",{className:Ze?"bg-yellow-50":"",children:Ze?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-2 py-1",children:i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:ut=>k(ut.target.value)})}),i.jsx("td",{className:"px-2 py-1",children:i.jsxs("select",{className:"w-full border p-1 rounded",value:T,onChange:ut=>P(ut.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S5.map(ut=>i.jsx("option",{value:ut,children:ut},ut))]})}),i.jsx("td",{className:"px-2 py-1",children:i.jsx("input",{className:"w-full border p-1 rounded",value:G,onChange:ut=>ce(ut.target.value)})}),i.jsx("td",{className:"px-2 py-1 text-right",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ue)?"":ue,onChange:ut=>{const Et=String(ut.target.value||"").replace(",","."),St=parseFloat(Et);le(Number.isFinite(St)?Math.max(0,St):0)}})}),i.jsx("td",{className:"px-2 py-1 text-center",children:i.jsxs("select",{className:"w-full border p-1 rounded",value:Ae,onChange:ut=>ae(ut.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})}),i.jsx("td",{className:"px-2 py-1",children:i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:_e,onChange:ut=>De(ut.target.value),maxLength:500})}),i.jsxs("td",{className:"px-2 py-1 text-center flex gap-1",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ee,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:se,children:"Cancelar"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-2 py-1",children:Se.date}),i.jsx("td",{className:"px-2 py-1",children:Se.category||""}),i.jsx("td",{className:"px-2 py-1",children:Se.description}),i.jsx("td",{className:"px-2 py-1 text-right",children:p0(Se.amount)}),i.jsx("td",{className:"px-2 py-1 text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${je(Se.status)}`,children:Se.status})}),i.jsx("td",{className:"px-2 py-1",children:Se.notes?Se.notes:""}),i.jsxs("td",{className:"px-2 py-1 text-center flex gap-1",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Xe(Se),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Fe(Se),children:"Borrar"})]})]})},Se.id)})})]})}),i.jsxs("div",{className:"mt-6 flex flex-col md:flex-row gap-4 justify-center items-stretch",children:[i.jsxs("div",{className:"flex-1 bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:p0(te.total)})]}),i.jsxs("div",{className:"flex-1 bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Pagado"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:p0(te.pagado)})]}),i.jsxs("div",{className:"flex-1 bg-yellow-50 border border-yellow-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold mb-1",children:"Pendiente"}),i.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:p0(te.pendiente)})]})]}),j&&i.jsx("p",{className:"mt-2 text-sm",children:j})]})}function QS(t){return(t||"").trim().toLowerCase()}async function hne(){const t=await Ht(Ct(Ce,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),a=QS(n.name??n.productName);a&&e.set(a,r.id)}),e}async function M3e(t=!1){const e=await hne(),r=await Ht(Ct(Ce,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const a of r.docs){n.checked++;const s=a.data(),o=QS(s.productName);if(!o){n.missingName++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"withoutMatch"});continue}if(s.productId===l){n.alreadyOk++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"alreadyOk"});continue}t||await kn(Yt(Ce,"inventory_batches",a.id),{productId:l}),n.fixed++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function L3e(t,e=!1){const r=QS(t),a=(await hne()).get(r);if(!a)throw new Error(`No existe un producto activo con nombre "${t}".`);const s=await Ht(Ct(Ce,"inventory_batches"));let o=0;for(const l of s.docs){const c=l.data();QS(c.productName)===r&&c.productId!==a&&(e||await kn(Yt(Ce,"inventory_batches",l.id),{productId:a}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function U3e(){const[t,e]=g.useState(!1),[r,n]=g.useState(""),a=async()=>{try{e(!0),n("");const c=await M3e(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[s,o]=g.useState(""),l=async()=>{if(!s.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await L3e(s.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${s}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:s,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const Q3e=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"];function V3e({onCreated:t,onClose:e}){const[r,n]=g.useState(Lr(new Date,"yyyy-MM-dd")),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState(0),[d]=g.useState("PAGADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(!1),v=async y=>{if(y.preventDefault(),m(""),!a)return m("Selecciona una categora.");if(!o.trim())return m("Ingresa una descripcin.");if(!c||c<=0)return m("Ingresa un monto vlido.");try{x(!0);const b={date:r,category:a,description:o.trim(),amount:Number(Number(c||0).toFixed(2)),status:"PAGADO",notes:f||"",createdAt:yr.now()},w=await Gn(Ct(Ce,"expenses"),b);t({id:w.id,...b}),m(" Gasto registrado"),e()}catch{m(" Error al guardar gasto")}finally{x(!1)}};return i.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-xl p-6 relative",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear gasto"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:v,className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:r,onChange:y=>n(y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:y=>s(y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),Q3e.map(y=>i.jsx("option",{value:y,children:y},y))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",value:o,onChange:y=>l(y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:c===0?"":c,onChange:y=>u(Number(y.target.value)),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100 text-gray-500 cursor-not-allowed",value:"PAGADO",readOnly:!0,disabled:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:f,onChange:y=>A(y.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[f.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",disabled:p,children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:e,children:"Cancelar"})]}),h&&i.jsx("div",{className:"text-sm mt-2",children:h})]})]})})}const Al=t=>`C$${Number(t||0).toFixed(2)}`,Yd=t=>Number(t||0).toFixed(3),dH=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),j5=()=>{const t=new Date;return Lr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},VC=()=>Lr(new Date,"yyyy-MM-dd");function Ane({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState(j5()),[o,l]=g.useState(VC()),[c,u]=g.useState(""),d=g.useMemo(()=>{const Ge=new Map;return n.forEach(ie=>Ge.set(ie.productId,{id:ie.productId,name:ie.productName})),Array.from(Ge.values()).sort((ie,xe)=>ie.name.localeCompare(xe.name))},[n]),f=g.useMemo(()=>n.filter(Ge=>!(a&&Ge.date<a||o&&Ge.date>o||c&&Ge.productId!==c)),[n,a,o,c]),[A,h]=g.useState(VC()),[m,p]=g.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,v]=g.useState(""),[y,b]=g.useState([]),[w,I]=g.useState([]),[j,C]=g.useState([]),[S,E]=g.useState(!1),[B,k]=g.useState(j5()),[T,P]=g.useState(VC()),[G,ce]=g.useState(!1);g.useEffect(()=>{(async()=>{try{E(!0);const Ge=sr(Ct(Ce,"expenses"),Sn("date","desc")),ie=await Ht(Ge),xe=[];ie.forEach(de=>{const Me=de.data();xe.push({id:de.id,date:Me.date,description:Me.description,amount:Number(Me.amount||0)})}),I(xe)}catch(Ge){console.error(Ge)}finally{E(!1)}})()},[]);const ue=Ge=>{I(ie=>[Ge,...ie]),C(ie=>[Ge.id,...ie])},le=g.useMemo(()=>w.filter(Ge=>!(!Ge.date||B&&Ge.date<B||T&&Ge.date>T)),[w,B,T]),[Ae,ae]=g.useState([]),[_e,De]=g.useState(!1),[O,H]=g.useState(""),[K,R]=g.useState("DEBITO"),[X,Y]=g.useState(""),D=()=>{const Ge=Number(X);!O.trim()||!isFinite(Ge)||Ge<=0||(ae(ie=>[...ie,{id:`${Date.now()}_${ie.length+1}`,description:O.trim(),type:K,amount:Number(Ge.toFixed(2))}]),H(""),Y(""))},[Q,te]=g.useState(null),[be,U]=g.useState(""),[Xe,se]=g.useState("DEBITO"),[ee,Fe]=g.useState(""),je=Ge=>{te(Ge.id),U(Ge.description),se(Ge.type),Fe(Ge.amount.toFixed(2))},Se=()=>{te(null),U(""),se("DEBITO"),Fe("")},Ze=()=>{if(!Q)return;const Ge=Number(ee);!isFinite(Ge)||Ge<=0||(ae(ie=>ie.map(xe=>xe.id===Q?{...xe,description:be.trim(),type:Xe,amount:Number(Ge.toFixed(2))}:xe)),Se())},ut=Ge=>{ae(ie=>ie.filter(xe=>xe.id!==Ge)),Q===Ge&&Se()},Et=(Ge,ie)=>{C(xe=>ie?[...new Set([...xe,Ge])]:xe.filter(de=>de!==Ge))},[St,Ft]=g.useState([]),[Qt,Ut]=g.useState(0),Tt=g.useMemo(()=>{let Ge=0,ie=0,xe=0,de=0;for(const Me of St){const me=Number(Me.totalQuantity||0);dH(Me.measurement||"")?Ge+=me:ie+=me,xe+=Number(Me.totalExpected||0),de+=Number(Me.totalInvoiced||0)}return{totalLbs:Ge,totalUnits:ie,totalExpected:Number(xe.toFixed(2)),totalFacturado:Number(de.toFixed(2)),grossProfit:Number((xe-de).toFixed(2))}},[St]),Re=g.useMemo(()=>Number(((Tt.totalExpected||0)+(Qt||0)-(Tt.totalFacturado||0)).toFixed(2)),[Tt,Qt]);g.useEffect(()=>{(async()=>{if(!a||!o){Ft([]),Ut(0);return}try{const ie=sr(Ct(Ce,"salesV2"),cr("date",">=",a),cr("date","<=",o)),xe=await Ht(ie),de={};xe.forEach(pt=>{const vt=pt.data(),bt=vt.date??"";if(String(vt.type??"CONTADO").toUpperCase()!=="CONTADO")return;const Vt=(At,ct,W,z,re)=>{const V=`${At}||${ct}`;de[V]||(de[V]={measurement:ct||"",totalQuantity:0,totalExpected:0,totalInvoiced:0}),de[V].totalQuantity+=W,de[V].totalExpected+=z,de[V].totalInvoiced+=re};if(Array.isArray(vt.items)&&vt.items.length>0){vt.items.forEach(At=>{const ct=String(At.productName??"(sin nombre)"),W=Number(At.qty??At.quantity??0),z=Number(At.unitPrice??At.price??vt.amountSuggested??0),re=Number(At.lineFinal??0)||Math.max(0,Number(z||0)*W-Number(At.discount||0)),V=Number(re||0),L=Array.isArray(At.allocations)?At.allocations:Array.isArray(vt.allocations)?vt.allocations:[];let fe=0;L&&L.length?fe=L.reduce((Be,ye)=>Be+Number(ye.lineCost||0),0):fe=Number(At.avgUnitCost??vt.avgUnitCost??0)*W,Vt(ct,At.measurement??vt.measurement??"",W,V,fe)});return}const ke=String(vt.productName??"(sin nombre)"),Ne=Number(vt.quantity??0),pe=Number(vt.amount??vt.amountCharged??0)||Number(vt.amountSuggested??vt.unitPrice??0)*Ne,Le=Array.isArray(vt.allocations)?vt.allocations:[];let ft=0;Le&&Le.length?ft=Le.reduce((At,ct)=>At+Number(ct.lineCost||0),0):ft=Number(vt.avgUnitCost??0)*Ne,Vt(ke,vt.measurement??"",Ne,pe,ft)});const Me=Object.entries(de).map(([pt,vt])=>{const[bt]=pt.split("||"),kt=Number((vt.totalExpected-vt.totalInvoiced).toFixed(2));return{productName:bt,measurement:vt.measurement,totalQuantity:Number(vt.totalQuantity.toFixed(3)),totalExpected:Number(vt.totalExpected.toFixed(2)),totalInvoiced:Number(vt.totalInvoiced.toFixed(2)),grossProfit:kt}});Ft(Me.sort((pt,vt)=>vt.totalInvoiced-pt.totalInvoiced));const me=await Ht(Ct(Ce,"ar_movements_pollo"));let we=0;me.forEach(pt=>{var ke;const vt=pt.data();if(String(vt.type??"").toUpperCase()!=="ABONO")return;const kt=Math.abs(Number(vt.amount??0)),Vt=vt!=null&&vt.date?String(vt.date):(ke=vt==null?void 0:vt.createdAt)!=null&&ke.toDate?Lr(vt.createdAt.toDate(),"yyyy-MM-dd"):"";Vt&&Vt>=a&&Vt<=o&&(we+=kt)}),Ut(Number(we.toFixed(2)))}catch(ie){console.error("Error cargando consolidado de ventas/abonos:",ie),Ft([]),Ut(0)}})()},[a,o]);const Te=g.useMemo(()=>f.filter(Ge=>y.includes(Ge.id)),[f,y]),Ye=g.useMemo(()=>Ae.filter(Ge=>Ge.type==="DEBITO").reduce((Ge,ie)=>Ge+ie.amount,0),[Ae]),ht=g.useMemo(()=>Ae.filter(Ge=>Ge.type==="CREDITO").reduce((Ge,ie)=>Ge+ie.amount,0),[Ae]),Oe=g.useMemo(()=>{let Ge=0,ie=0,xe=0,de=0;for(const we of Te){dH(we.unit)?Ge+=Number(we.quantity||0):ie+=Number(we.quantity||0);const pt=we.expectedTotal??Number((Number(we.quantity||0)*Number(we.salePrice||0)).toFixed(2)),vt=we.invoiceTotal!==void 0&&we.invoiceTotal!==null?Number(we.invoiceTotal):Number((Number(we.quantity||0)*Number(we.purchasePrice||0)).toFixed(2));xe+=Number(pt||0),de+=Number(vt||0)}const Me=le.filter(we=>j.includes(we.id)).reduce((we,pt)=>we+Number(pt.amount||0),0),me=xe-Me-Ye+ht;return{totalLbs:Ge,totalUnits:ie,totalExpected:Number(xe.toFixed(2)),totalInvoiced:Number(de.toFixed(2)),totalGastos:Number(Me.toFixed(2)),debits:Number(Ye.toFixed(2)),credits:Number(ht.toFixed(2)),finalAmount:Number(me.toFixed(2)),grossProfit:Number((xe-de).toFixed(2))}},[Te,le,j,Ye,ht]),[Ie,We]=g.useState(!1),[Z,Qe]=g.useState(""),at=async()=>{Qe("");const Ge=Array.isArray(St)&&St.length>0;if(!Ge&&Te.length===0){Qe("Selecciona al menos 1 lote pagado o genera un consolidado.");return}try{We(!0);const ie=(St||[]).map(bt=>({productName:bt.productName,measurement:bt.measurement,quantity:Number(Yd(bt.totalQuantity)),expectedTotal:Number(bt.totalExpected),invoiceTotal:Number(bt.totalInvoiced)})),xe=Number(Yd(Ge?Tt.totalLbs:Oe.totalLbs)),de=Number(Yd(Ge?Tt.totalUnits:Oe.totalUnits)),Me=Ge?Number((Tt.totalExpected+Qt).toFixed(2)):Oe.totalExpected,me=Ge?Tt.totalFacturado:Oe.totalInvoiced,we=Number(((Me||0)-Number(Oe.totalGastos||0)-Number(Oe.debits||0)+Number(Oe.credits||0)).toFixed(2)),pt={number:m.trim(),date:A,description:x.trim(),status:"PENDIENTE",createdAt:yr.now(),totalLbs:xe,totalUnits:de,totalAmount:Me,invoiceTotal:me,totalExpenses:Oe.totalGastos,totalDebits:Oe.debits,totalCredits:Oe.credits,finalAmount:we,batches:(Ge?[]:Te).map(bt=>{var kt;return{id:bt.id,productId:bt.productId,productName:bt.productName,unit:bt.unit,quantity:Number(Yd(bt.quantity)),salePrice:Number(Number(bt.salePrice||0).toFixed(2)),purchasePrice:Number(Number(bt.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(bt.quantity||0)*Number(bt.salePrice||0)).toFixed(2)),invoiceTotal:bt.invoiceTotal!==void 0&&bt.invoiceTotal!==null?Number(bt.invoiceTotal):Number((Number(bt.quantity||0)*Number(bt.purchasePrice||0)).toFixed(2)),batchDate:bt.date,paidAt:(kt=bt.paidAt)!=null&&kt.toDate?Lr(bt.paidAt.toDate(),"yyyy-MM-dd"):null}}),consolidatedProducts:ie,expenses:le.filter(bt=>j.includes(bt.id)).map(bt=>({id:bt.id,date:bt.date||null,description:bt.description||"",amount:Number(Number(bt.amount||0).toFixed(2))})),adjustments:Ae.map(bt=>({id:bt.id,description:bt.description,type:bt.type,amount:Number(bt.amount.toFixed(2))}))},vt=await Gn(Ct(Ce,"invoices"),pt);if(Ge)try{await Gn(Ct(Ce,"consolidated_reports"),{invoiceId:vt.id,lotFrom:a,lotTo:o,consolidatedProducts:ie,consolidatedTotals:{totalLbs:Tt.totalLbs,totalUnits:Tt.totalUnits,totalExpected:Tt.totalExpected,totalFacturado:Tt.totalFacturado,grossProfit:Tt.grossProfit},abonosRangeTotal:Qt,createdAt:yr.now()})}catch(bt){console.error("Error saving consolidated report:",bt)}Qe(" Factura creada."),r()}catch(ie){console.error(ie),Qe(` Error al crear factura: ${(ie==null?void 0:ie.message)||"desconocido"}`)}finally{We(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:A,onChange:Ge=>h(Ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:Ge=>p(Ge.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:Ge=>v(Ge.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Ge=>s(Ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:Ge=>l(Ge.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:Ge=>u(Ge.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),d.map(Ge=>i.jsx("option",{value:Ge.id,children:Ge.name},Ge.id))]})]}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{s(j5()),l(VC()),u("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Consolidado ventas (CASH)"}),i.jsxs("div",{className:"text-sm text-gray-600 ml-auto",children:["Periodo: ",a,"  ",o]})]}),i.jsxs("div",{className:"flex gap-3 mb-3 items-stretch",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-3 text-center min-w-[120px]",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold",children:"Total libras"}),i.jsx("div",{className:"text-xl font-bold text-blue-900",children:Yd(Tt.totalLbs)})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-3 text-center min-w-[120px]",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold",children:"Total unidades"}),i.jsx("div",{className:"text-xl font-bold text-blue-900",children:Yd(Tt.totalUnits)})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-center min-w-[180px]",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold",children:"Total facturado"}),i.jsx("div",{className:"text-xl font-bold text-green-900",children:Al(Tt.totalFacturado)})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-center min-w-[200px]",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold",children:"Total esperado"}),i.jsx("div",{className:"text-xl font-bold text-green-900",children:Al(Tt.totalExpected)})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-3 text-center min-w-[180px]",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold",children:"Utilidad bruta"}),i.jsx("div",{className:"text-xl font-bold text-yellow-900",children:Al(Re)})]})]}),St.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas cash en el periodo."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Total facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Total esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:St.map(Ge=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Ge.productName}),i.jsx("td",{className:"p-2 border",children:Ge.measurement||""}),i.jsx("td",{className:"p-2 border text-right",children:Yd(Ge.totalQuantity)}),i.jsx("td",{className:"p-2 border text-right",children:Al(Ge.totalInvoiced)}),i.jsx("td",{className:"p-2 border text-right",children:Al(Ge.totalExpected)}),i.jsx("td",{className:"p-2 border text-right",children:Al(Ge.grossProfit)})]},Ge.productName))})]})}),i.jsxs("div",{className:"mt-3",children:[i.jsx("h4",{className:"font-semibold",children:"Abonos (Periodo)"}),i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"p-3 border rounded bg-white inline-block",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Periodo"}),i.jsxs("div",{className:"font-semibold",children:[a,"  ",o]})]}),i.jsxs("div",{className:"p-3 border rounded bg-white inline-block ml-3",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Total recaudado"}),i.jsx("div",{className:"font-semibold",children:Al(Qt)})]})]})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),S&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>ce(!0),children:"Crear gasto"}),i.jsxs("div",{className:"flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:B,onChange:Ge=>k(Ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:T,onChange:Ge=>P(Ge.target.value)})]})]})]}),le.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:le.map(Ge=>{const ie=j.includes(Ge.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:ie,onChange:xe=>Et(Ge.id,xe.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Ge.date||""}),i.jsx("td",{className:"p-2 border",children:Ge.description||""}),i.jsx("td",{className:"p-2 border",children:Al(Number(Ge.amount||0))})]},Ge.id)})})]})}),G&&i.jsx(V3e,{onCreated:ue,onClose:()=>ce(!1)})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>De(!0),children:"Crear Cargo"})]}),Ae.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Ae.map(Ge=>{const ie=Q===Ge.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ie?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:be,onChange:xe=>U(xe.target.value)}):i.jsx("span",{title:Ge.description,children:Ge.description.length>60?`${Ge.description.slice(0,60)}`:Ge.description})}),i.jsx("td",{className:"p-2 border",children:ie?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Xe,onChange:xe=>se(xe.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ge.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:Ge.type})}),i.jsx("td",{className:"p-2 border",children:ie?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:ee,onChange:xe=>Fe(xe.target.value)}):Al(Ge.amount)}),i.jsx("td",{className:"p-2 border",children:ie?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Ze,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Se,children:"Cancelar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ut(Ge.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>je(Ge),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ut(Ge.id),children:"Eliminar"})]})})]},Ge.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total libras"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:Yd(Tt.totalLbs)})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total unidades"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:Yd(Tt.totalUnits)})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Total facturado"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:Al(Tt.totalFacturado)})]})]}),i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-red-700 font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"text-2xl font-bold text-red-900",children:Al(Oe.totalGastos)})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-orange-700 font-semibold mb-1",children:"Dbitos"}),i.jsx("div",{className:"text-2xl font-bold text-orange-900",children:Al(Oe.debits)})]}),i.jsxs("div",{className:"bg-lime-50 border border-lime-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-lime-700 font-semibold mb-1",children:"Crditos"}),i.jsx("div",{className:"text-2xl font-bold text-lime-900",children:Al(Oe.credits)})]})]}),i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Total Cash + Abonos"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:Al(Tt.totalExpected+Qt)})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold mb-1",children:"Ganancia bruta"}),i.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:Al(Re)})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-purple-700 font-semibold mb-1",children:"Ganancia neta"}),i.jsx("div",{className:"text-2xl font-bold text-purple-900",children:Al(Re-Oe.totalGastos-Oe.debits)})]})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-4 bg-blue-100 border border-blue-300 rounded-xl text-center font-semibold text-lg shadow",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:Al(Oe.finalAmount)})]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:Ie,onClick:at,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:Ie?"Creando":"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Z&&i.jsx("span",{className:"text-sm ml-2",children:Z})]}),Ie&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),_e&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{type:"button",className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>De(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:O,onChange:Ge=>H(Ge.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:K,onChange:Ge=>R(Ge.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:X,onChange:Ge=>Y(Ge.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Agregar"})})]})]})})]})}const ad=t=>`C$ ${Number(t||0).toFixed(2)}`,Kc=t=>Number(t||0).toFixed(3),H3e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function $3e(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(!1),[o,l]=g.useState(null),[c,u]=g.useState(Lr(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[d,f]=g.useState(Lr(new Date,"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(!1),{refreshKey:x,refresh:v}=Lc(),[y,b]=g.useState(!1),w=()=>b(P=>!P),[I,j]=g.useState(null),C=P=>j(G=>G===P?null:P);g.useEffect(()=>{(async()=>{n(!0);const P=sr(Ct(Ce,"inventory_batches"),cr("status","==","PAGADO"),Sn("date","desc")),G=await Ht(P),ce=[];G.forEach(ue=>{const le=ue.data(),Ae=Number(le.quantity||0),ae=Number(le.remaining||0),_e=Number(le.purchasePrice||0),De=Number(le.salePrice||0),O=Number((Ae*_e).toFixed(2)),H=Number((Ae*De).toFixed(2));ce.push({id:ue.id,productId:le.productId,productName:le.productName,category:le.category,unit:le.unit,quantity:Ae,remaining:ae,purchasePrice:_e,salePrice:De,invoiceTotal:le.invoiceTotal!=null?Number(le.invoiceTotal):O,expectedTotal:le.expectedTotal!=null?Number(le.expectedTotal):H,date:le.date,status:le.status,paidAt:le.paidAt})}),e(ce),n(!1)})()},[x]);const S=g.useMemo(()=>t.filter(P=>!(c&&P.date<c||d&&P.date>d||A&&P.productId!==A)),[t,c,d,A]),E=g.useMemo(()=>{let P=0,G=0,ce=0,ue=0,le=0,Ae=0;for(const ae of S)H3e(ae.unit)?(P+=ae.quantity,G+=ae.remaining):(ce+=ae.quantity,ue+=ae.remaining),le+=Number(ae.expectedTotal||0),Ae+=Number(ae.invoiceTotal||0);return{lbsIng:P,lbsRem:G,udsIng:ce,udsRem:ue,totalEsperado:le,totalFact:Ae,gross:le-Ae}},[S]),B=P=>{l(P),s(!0)},k=async()=>{if(o)try{const P=Yt(Ce,"inventory_batches",o.id);await kn(P,{status:"PENDIENTE",remaining:o.quantity});const G=Ct(Ce,"salesV2"),ce=await Ht(sr(G,cr("batchId","==",o.id))),ue=await Ht(sr(G,cr("productName","==",o.productName),cr("date","==",o.date))),le=[...ce.docs,...ue.docs];for(const Ae of le)await Wn(Yt(Ce,"salesV2",Ae.id));s(!1),l(null),v()}catch(P){console.error("Error al marcar pendiente:",P)}},T=g.useMemo(()=>{const P=new Map;return t.forEach(G=>P.set(G.productId,{id:G.productId,name:G.productName})),Array.from(P.values()).sort((G,ce)=>G.name.localeCompare(ce.name))},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(Mc,{onClick:v,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:P=>u(P.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:P=>f(P.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:P=>h(P.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),T.map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"})]}),i.jsx("button",{type:"button",className:"sm:ml-auto px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"md:hidden",children:[i.jsxs("button",{type:"button",onClick:w,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Totales"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Libras: ",i.jsx("b",{children:Kc(E.lbsIng)}),"  Restantes:"," ",i.jsx("b",{children:Kc(E.lbsRem)})]})]}),i.jsx("div",{className:"text-gray-500",children:y?"":""})]}),y&&i.jsx("div",{className:"mt-3 bg-gray-50 p-3 rounded-2xl shadow-2xl border text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Kc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Kc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",ad(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Kc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Kc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",ad(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",ad(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"hidden md:block bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Kc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Kc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",ad(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Kc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Kc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",ad(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",ad(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:r?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):S.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin lotes pagados"}):S.map(P=>{var ce;const G=I===P.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>C(P.id),className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:P.productName}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[(P.category||"").toUpperCase(),"  ",P.date," "," ",(P.unit||"").toUpperCase()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-bold",children:ad(P.expectedTotal||0)}),i.jsx("div",{className:"text-[11px] text-gray-500",children:G?"Detalles":"Esperado"})]})]}),G&&i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ingresado"}),i.jsx("div",{className:"font-semibold",children:Kc(P.quantity)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:Kc(P.remaining)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Costo"}),i.jsx("div",{className:"font-semibold",children:ad(P.invoiceTotal||0)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Fecha pago"}),i.jsx("div",{className:"font-semibold",children:(ce=P.paidAt)!=null&&ce.toDate?Lr(P.paidAt.toDate(),"yyyy-MM-dd"):""})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(P),children:"Marcar PENDIENTE"})})]})]},P.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):S.map(P=>{var G;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:(P.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:P.productName}),i.jsx("td",{className:"p-2 border",children:(P.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Kc(P.quantity)}),i.jsx("td",{className:"p-2 border",children:Kc(P.remaining)}),i.jsx("td",{className:"p-2 border",children:ad(P.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:ad(P.salePrice)}),i.jsx("td",{className:"p-2 border",children:ad(P.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:ad(P.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(G=P.paidAt)!=null&&G.toDate?Lr(P.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(P),children:"Marcar PENDIENTE"})})]},P.id)})})]})}),m&&i.jsx(Ane,{paidBatches:t,onClose:()=>p(!1),onCreated:()=>p(!1)}),a&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-xl",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded-xl",children:"Confirmar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var VS={};VS.version="0.18.5";var mne=1252,G3e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Z6={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},eR=function(t){G3e.indexOf(t)!=-1&&(mne=Z6[0]=t)};function K3e(){eR(1252)}var mf=function(t){eR(t)};function tR(){mf(1200),K3e()}function fH(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function q3e(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function pne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Zy=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?q3e(t.slice(2)):e==254&&r==255?pne(t.slice(2)):e==65279?t.slice(1):t},HC=function(e){return String.fromCharCode(e)},hH=function(e){return String.fromCharCode(e)},k2,J0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function F2(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,a=t.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),e+=J0.charAt(s)+J0.charAt(o)+J0.charAt(l)+J0.charAt(c);return e}function $u(t){var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=J0.indexOf(t.charAt(u++)),o=J0.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),l=J0.indexOf(t.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=J0.indexOf(t.charAt(u++)),a=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var ra=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),MA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Pm(t){return ra?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function AH(t){return ra?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Tu=function(e){return ra?MA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function cP(t){if(typeof ArrayBuffer>"u")return Tu(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function $m(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function z3e(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function rR(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return rR(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Zo=ra?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:MA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function W3e(t){for(var e=[],r=0,n=t.length+250,a=Pm(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Pm(65535),n=65530)}return e.push(a.slice(0,r)),Zo(e)}var kc=/\u0000/g,eb=/[\u0001-\u0006]/g;function gv(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function pf(t,e){var r=""+t;return r.length>=e?r:Si("0",e-r.length)+r}function nR(t,e){var r=""+t;return r.length>=e?r:Si(" ",e-r.length)+r}function HS(t,e){var r=""+t;return r.length>=e?r:r+Si(" ",e-r.length)}function X3e(t,e){var r=""+Math.round(t);return r.length>=e?r:Si("0",e-r.length)+r}function Y3e(t,e){var r=""+t;return r.length>=e?r:Si("0",e-r.length)+r}var mH=Math.pow(2,32);function gx(t,e){if(t>mH||t<-mH)return X3e(t,e);var r=Math.round(t);return Y3e(r,e)}function $S(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var pH=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],I5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function J3e(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Fn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},gH={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z3e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function GS(t,e,r){for(var n=t<0?-1:1,a=t*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<e&&(f=Math.floor(a),l=f*o+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=u,u=d;if(d>e&&(u>e?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var A=Math.floor(n*l/d);return[A,n*l-A*d,d]}function Tp(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),s=0,o=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=s4e(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var gne=new Date(1899,11,31,0,0,0),e4e=gne.getTime(),t4e=new Date(1900,2,1,0,0,0);function xne(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=t4e&&(r+=24*60*60*1e3),(r-(e4e+(t.getTimezoneOffset()-gne.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function aR(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function r4e(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function n4e(t){var e=t<0?12:11,r=aR(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function a4e(t){var e=aR(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function O2(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=n4e(t):e===10?r=t.toFixed(10).substr(0,12):r=a4e(t),aR(r4e(r.toUpperCase()))}function gg(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):O2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Dd(14,xne(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function s4e(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function i4e(t,e,r,n){var a="",s=0,o=0,l=r.y,c,u=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return I5[r.m-1][1];case 5:return I5[r.m-1][0];default:return I5[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return pH[r.q][0];default:return pH[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?pf(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=pf(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?pf(c,u):"";return d}function Z0(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var vne=/%/g;function o4e(t,e,r){var n=e.replace(vne,""),a=e.length-n.length;return cA(t,n,r*Math.pow(10,2*a))+Si("%",a)}function l4e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return cA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function yne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+yne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var bne=/# (\?+)( ?)\/( ?)(\d+)/;function c4e(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?Si(" ",t[1].length+1+t[4].length):nR(o,t[1].length)+t[2]+"/"+t[3]+pf(l,t[4].length))}function u4e(t,e,r){return r+(e===0?"":""+e)+Si(" ",t[1].length+2+t[4].length)}var wne=/^#*0*\.([0#]+)/,Nne=/\).*[0#]/,Cne=/\(###\) ###\\?-####/;function _c(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function xH(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function vH(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function d4e(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function f4e(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ud(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Nne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ud("n",n,r):"("+ud("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return l4e(t,e,r);if(e.indexOf("%")!==-1)return o4e(t,e,r);if(e.indexOf("E")!==-1)return yne(e,r);if(e.charCodeAt(0)===36)return"$"+ud(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+gx(c,e.length);if(e.match(/^[#?]+$/))return a=gx(r,0),a==="0"&&(a=""),a.length>e.length?a:_c(e.substr(0,e.length-a.length))+a;if(s=e.match(bne))return c4e(s,c,u);if(e.match(/^#+0+$/))return u+gx(c,e.length-e.indexOf("0"));if(s=e.match(wne))return a=xH(r,s[1].length).replace(/^([^\.]+)$/,"$1."+_c(s[1])).replace(/\.$/,"."+_c(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Si("0",_c(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+xH(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Z0(gx(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ud(t,e,-r):Z0(""+(Math.floor(r)+d4e(r,s[1].length)))+"."+pf(vH(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ud(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gv(ud(t,e.replace(/[\\-]/g,""),r)),o=0,gv(gv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(Cne))return a=ud(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=GS(c,Math.pow(10,o)-1,!1),a=""+u,d=cA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=HS(l[2],o),d.length<s[4].length&&(d=_c(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=GS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?nR(l[1],o)+s[2]+"/"+s[3]+HS(l[2],o):Si(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=gx(r,0),e.length<=a.length?a:_c(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return _c(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=vH(r,s[1].length),r<0?"-"+ud(t,e,-r):Z0(f4e(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?pf(0,3-m.length):"")+m})+"."+pf(o,s[1].length);switch(e){case"###,##0.00":return ud(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Z0(gx(c,0));return h!=="0"?u+h:"";case"###,###.00":return ud(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ud(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function h4e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return cA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function A4e(t,e,r){var n=e.replace(vne,""),a=e.length-n.length;return cA(t,n,r*Math.pow(10,2*a))+Si("%",a)}function _ne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_ne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Gf(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Nne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gf("n",n,r):"("+Gf("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return h4e(t,e,r);if(e.indexOf("%")!==-1)return A4e(t,e,r);if(e.indexOf("E")!==-1)return _ne(e,r);if(e.charCodeAt(0)===36)return"$"+Gf(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+pf(c,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:_c(e.substr(0,e.length-a.length))+a;if(s=e.match(bne))return u4e(s,c,u);if(e.match(/^#+0+$/))return u+pf(c,e.length-e.indexOf("0"));if(s=e.match(wne))return a=(""+r).replace(/^([^\.]+)$/,"$1."+_c(s[1])).replace(/\.$/,"."+_c(s[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+Si("0",_c(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Z0(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gf(t,e,-r):Z0(""+r)+"."+Si("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Gf(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gv(Gf(t,e.replace(/[\\-]/g,""),r)),o=0,gv(gv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(Cne))return a=Gf(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=GS(c,Math.pow(10,o)-1,!1),a=""+u,d=cA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=HS(l[2],o),d.length<s[4].length&&(d=_c(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=GS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?nR(l[1],o)+s[2]+"/"+s[3]+HS(l[2],o):Si(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:_c(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return _c(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Gf(t,e,-r):Z0(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?pf(0,3-m.length):"")+m})+"."+pf(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=Z0(""+c);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return Gf(t,e.slice(0,e.lastIndexOf(".")),r)+_c(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function cA(t,e,r){return(r|0)===r?Gf(t,e,r):ud(t,e,r)}function m4e(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Ene=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function w1(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":$S(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Ene))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function p4e(t,e,r,n){for(var a=[],s="",o=0,l="",c="t",u,d,f,A="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!$S(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=Tp(e,r,t.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Tp(e,r),u==null))return"";for(s=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=A),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=Tp(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",A="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,A="h"):t.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,A="h"):(p.t="t",++o),u==null&&p.t==="T")return"";a[a.length]=p,c=l;break;case"[":for(s=l;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Ene)){if(u==null&&(u=Tp(e,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",w1(t)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<t.length&&(l=t.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;t.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var x=0,v=0,y;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=A,c="h",x<1&&(x=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[o].v.match(/[Hh]/)&&(x=1),x<2&&a[o].v.match(/[Mm]/)&&(x=2),x<3&&a[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",w;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=i4e(a[o].t.charCodeAt(0),a[o].v,u,v),a[o].t="t";break;case"n":case"?":for(w=o+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[o].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[o].v,o=w-1;break;case"G":a[o].t="t",a[o].v=gg(e,r);break}var I="",j,C;if(b.length>0){b.charCodeAt(0)==40?(j=e<0&&b.charCodeAt(0)===45?-e:e,C=cA("n",b,j)):(j=e<0&&n>1?-e:e,C=cA("n",b,j),j<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),w=C.length-1;var S=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){S=o;break}var E=a.length;if(S===a.length&&C.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(w>=a[o].v.length-1?(w-=a[o].v.length,a[o].v=C.substr(w+1,a[o].v.length)):w<0?a[o].v="":(a[o].v=C.substr(0,w+1),w=-1),a[o].t="t",E=o);w>=0&&E<a.length&&(a[E].v=C.substr(0,w+1)+a[E].v)}else if(S!==a.length&&C.indexOf("E")===-1){for(w=C.indexOf(".")-1,o=S;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")-1:a[o].v.length-1,I=a[o].v.substr(d+1);d>=0;--d)w>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(I=C.charAt(w--)+I);a[o].v=I,a[o].t="t",E=o}for(w>=0&&E<a.length&&(a[E].v=C.substr(0,w+1)+a[E].v),w=C.indexOf(".")+1,o=S;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==S)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")+1:0,I=a[o].v.substr(0,d);d<a[o].v.length;++d)w<C.length&&(I+=C.charAt(w++));a[o].v=I,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(j=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=cA(a[o].t,a[o].v,j),a[o].t="t");var B="";for(o=0;o!==a.length;++o)a[o]!=null&&(B+=a[o].v);return B}var yH=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bH(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function g4e(t,e){var r=m4e(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(yH),l=r[1].match(yH);return bH(e,o)?[n,r[0]]:bH(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Dd(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Fn)[t],n==null&&(n=r.table&&r.table[gH[t]]||Fn[gH[t]]),n==null&&(n=Z3e[t]||"General");break}if($S(n,0))return gg(e,r);e instanceof Date&&(e=xne(e,r.date1904));var a=g4e(n,e);if($S(a[1]))return gg(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return p4e(a[1],e,r,a[0])}function uA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Fn[r]==null){e<0&&(e=r);continue}if(Fn[r]==t){e=r;break}}e<0&&(e=391)}return Fn[e]=t,e}function uP(t){for(var e=0;e!=392;++e)t[e]!==void 0&&uA(t[e],e)}function N1(){Fn=J3e()}var x4e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Sne=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function v4e(t){var e=typeof t=="number"?Fn[t]:t;return e=e.replace(Sne,"(\\d+)"),new RegExp("^"+e+"$")}function y4e(t,e,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(Sne)||[]).forEach(function(f,A){var h=parseInt(r[A+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var b4e=function(){var t={};t.version="1.2.0";function e(){for(var C=0,S=new Array(256),E=0;E!=256;++E)C=E,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,S[E]=C;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(C){var S=0,E=0,B=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)k[B]=C[B];for(B=0;B!=256;++B)for(E=C[B],S=256+B;S<4096;S+=256)E=k[S]=E>>>8^C[E&255];var T=[];for(B=1;B!=16;++B)T[B-1]=typeof Int32Array<"u"?k.subarray(B*256,B*256+256):k.slice(B*256,B*256+256);return T}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],A=a[7],h=a[8],m=a[9],p=a[10],x=a[11],v=a[12],y=a[13],b=a[14];function w(C,S){for(var E=S^-1,B=0,k=C.length;B<k;)E=E>>>8^r[(E^C.charCodeAt(B++))&255];return~E}function I(C,S){for(var E=S^-1,B=C.length-15,k=0;k<B;)E=b[C[k++]^E&255]^y[C[k++]^E>>8&255]^v[C[k++]^E>>16&255]^x[C[k++]^E>>>24]^p[C[k++]]^m[C[k++]]^h[C[k++]]^A[C[k++]]^f[C[k++]]^d[C[k++]]^u[C[k++]]^c[C[k++]]^l[C[k++]]^o[C[k++]]^s[C[k++]]^r[C[k++]];for(B+=15;k<B;)E=E>>>8^r[(E^C[k++])&255];return~E}function j(C,S){for(var E=S^-1,B=0,k=C.length,T=0,P=0;B<k;)T=C.charCodeAt(B++),T<128?E=E>>>8^r[(E^T)&255]:T<2048?(E=E>>>8^r[(E^(192|T>>6&31))&255],E=E>>>8^r[(E^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,P=C.charCodeAt(B++)&1023,E=E>>>8^r[(E^(240|T>>8&7))&255],E=E>>>8^r[(E^(128|T>>2&63))&255],E=E>>>8^r[(E^(128|P>>6&15|(T&3)<<4))&255],E=E>>>8^r[(E^(128|P&63))&255]):(E=E>>>8^r[(E^(224|T>>12&15))&255],E=E>>>8^r[(E^(128|T>>6&63))&255],E=E>>>8^r[(E^(128|T&63))&255]);return~E}return t.table=r,t.bstr=w,t.buf=I,t.str=j,t}(),_n=function(){var e={};e.version="1.2.1";function r(W,z){for(var re=W.split("/"),V=z.split("/"),L=0,fe=0,Be=Math.min(re.length,V.length);L<Be;++L){if(fe=re[L].length-V[L].length)return fe;if(re[L]!=V[L])return re[L]<V[L]?-1:1}return re.length-V.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var z=W.lastIndexOf("/");return z===-1?W:W.slice(0,z+1)}function a(W){if(W.charAt(W.length-1)=="/")return a(W.slice(0,-1));var z=W.lastIndexOf("/");return z===-1?W:W.slice(z+1)}function s(W,z){typeof z=="string"&&(z=new Date(z));var re=z.getHours();re=re<<6|z.getMinutes(),re=re<<5|z.getSeconds()>>>1,W.write_shift(2,re);var V=z.getFullYear()-1980;V=V<<4|z.getMonth()+1,V=V<<5|z.getDate(),W.write_shift(2,V)}function o(W){var z=W.read_shift(2)&65535,re=W.read_shift(2)&65535,V=new Date,L=re&31;re>>>=5;var fe=re&15;re>>>=4,V.setMilliseconds(0),V.setFullYear(re+1980),V.setMonth(fe-1),V.setDate(L);var Be=z&31;z>>>=5;var ye=z&63;return z>>>=6,V.setHours(z),V.setMinutes(ye),V.setSeconds(Be<<1),V}function l(W){Sl(W,0);for(var z={},re=0;W.l<=W.length-4;){var V=W.read_shift(2),L=W.read_shift(2),fe=W.l+L,Be={};switch(V){case 21589:re=W.read_shift(1),re&1&&(Be.mtime=W.read_shift(4)),L>5&&(re&2&&(Be.atime=W.read_shift(4)),re&4&&(Be.ctime=W.read_shift(4))),Be.mtime&&(Be.mt=new Date(Be.mtime*1e3));break}W.l=fe,z[V]=Be}return z}var c;function u(){return c||(c={})}function d(W,z){if(W[0]==80&&W[1]==75)return de(W,z);if((W[0]|32)==109&&(W[1]|32)==105)return ke(W,z);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var re=3,V=512,L=0,fe=0,Be=0,ye=0,$e=0,ze=[],Ke=W.slice(0,512);Sl(Ke,0);var yt=f(Ke);switch(re=yt[0],re){case 3:V=512;break;case 4:V=4096;break;case 0:if(yt[1]==0)return de(W,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+re)}V!==512&&(Ke=W.slice(0,V),Sl(Ke,28));var ne=W.slice(0,V);A(Ke,re);var Ue=Ke.read_shift(4,"i");if(re===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);Ke.l+=4,Be=Ke.read_shift(4,"i"),Ke.l+=4,Ke.chk("00100000","Mini Stream Cutoff Size: "),ye=Ke.read_shift(4,"i"),L=Ke.read_shift(4,"i"),$e=Ke.read_shift(4,"i"),fe=Ke.read_shift(4,"i");for(var rt=-1,st=0;st<109&&(rt=Ke.read_shift(4,"i"),!(rt<0));++st)ze[st]=rt;var _t=h(W,V);x($e,fe,_t,V,ze);var Ot=y(_t,Be,ze,V);Ot[Be].name="!Directory",L>0&&ye!==P&&(Ot[ye].name="!MiniFAT"),Ot[ze[0]].name="!FAT",Ot.fat_addrs=ze,Ot.ssz=V;var nr={},Ir=[],Qr=[],or=[];b(Be,Ot,_t,Ir,L,nr,Qr,ye),m(Qr,or,Ir),Ir.shift();var kr={FileIndex:Qr,FullPaths:or};return z&&z.raw&&(kr.raw={header:ne,sectors:_t}),kr}function f(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(G,"Header Signature: "),W.l+=16;var z=W.read_shift(2,"u");return[W.read_shift(2,"u"),z]}function A(W,z){var re=9;switch(W.l+=2,re=W.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+re);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+re);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+re)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function h(W,z){for(var re=Math.ceil(W.length/z)-1,V=[],L=1;L<re;++L)V[L-1]=W.slice(L*z,(L+1)*z);return V[re-1]=W.slice(re*z),V}function m(W,z,re){for(var V=0,L=0,fe=0,Be=0,ye=0,$e=re.length,ze=[],Ke=[];V<$e;++V)ze[V]=Ke[V]=V,z[V]=re[V];for(;ye<Ke.length;++ye)V=Ke[ye],L=W[V].L,fe=W[V].R,Be=W[V].C,ze[V]===V&&(L!==-1&&ze[L]!==L&&(ze[V]=ze[L]),fe!==-1&&ze[fe]!==fe&&(ze[V]=ze[fe])),Be!==-1&&(ze[Be]=V),L!==-1&&V!=ze[V]&&(ze[L]=ze[V],Ke.lastIndexOf(L)<ye&&Ke.push(L)),fe!==-1&&V!=ze[V]&&(ze[fe]=ze[V],Ke.lastIndexOf(fe)<ye&&Ke.push(fe));for(V=1;V<$e;++V)ze[V]===V&&(fe!==-1&&ze[fe]!==fe?ze[V]=ze[fe]:L!==-1&&ze[L]!==L&&(ze[V]=ze[L]));for(V=1;V<$e;++V)if(W[V].type!==0){if(ye=V,ye!=ze[ye])do ye=ze[ye],z[V]=z[ye]+"/"+z[V];while(ye!==0&&ze[ye]!==-1&&ye!=ze[ye]);ze[V]=-1}for(z[0]+="/",V=1;V<$e;++V)W[V].type!==2&&(z[V]+="/")}function p(W,z,re){for(var V=W.start,L=W.size,fe=[],Be=V;re&&L>0&&Be>=0;)fe.push(z.slice(Be*T,Be*T+T)),L-=T,Be=Cp(re,Be*4);return fe.length===0?ur(0):Zo(fe).slice(0,W.size)}function x(W,z,re,V,L){var fe=P;if(W===P){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var Be=re[W],ye=(V>>>2)-1;if(!Be)return;for(var $e=0;$e<ye&&(fe=Cp(Be,$e*4))!==P;++$e)L.push(fe);x(Cp(Be,V-4),z-1,re,V,L)}}function v(W,z,re,V,L){var fe=[],Be=[];L||(L=[]);var ye=V-1,$e=0,ze=0;for($e=z;$e>=0;){L[$e]=!0,fe[fe.length]=$e,Be.push(W[$e]);var Ke=re[Math.floor($e*4/V)];if(ze=$e*4&ye,V<4+ze)throw new Error("FAT boundary crossed: "+$e+" 4 "+V);if(!W[Ke])break;$e=Cp(W[Ke],ze)}return{nodes:fe,data:kH([Be])}}function y(W,z,re,V){var L=W.length,fe=[],Be=[],ye=[],$e=[],ze=V-1,Ke=0,yt=0,ne=0,Ue=0;for(Ke=0;Ke<L;++Ke)if(ye=[],ne=Ke+z,ne>=L&&(ne-=L),!Be[ne]){$e=[];var rt=[];for(yt=ne;yt>=0;){rt[yt]=!0,Be[yt]=!0,ye[ye.length]=yt,$e.push(W[yt]);var st=re[Math.floor(yt*4/V)];if(Ue=yt*4&ze,V<4+Ue)throw new Error("FAT boundary crossed: "+yt+" 4 "+V);if(!W[st]||(yt=Cp(W[st],Ue),rt[yt]))break}fe[ne]={nodes:ye,data:kH([$e])}}return fe}function b(W,z,re,V,L,fe,Be,ye){for(var $e=0,ze=V.length?2:0,Ke=z[W].data,yt=0,ne=0,Ue;yt<Ke.length;yt+=128){var rt=Ke.slice(yt,yt+128);Sl(rt,64),ne=rt.read_shift(2),Ue=dR(rt,0,ne-ze),V.push(Ue);var st={name:Ue,type:rt.read_shift(1),color:rt.read_shift(1),L:rt.read_shift(4,"i"),R:rt.read_shift(4,"i"),C:rt.read_shift(4,"i"),clsid:rt.read_shift(16),state:rt.read_shift(4,"i"),start:0,size:0},_t=rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2);_t!==0&&(st.ct=w(rt,rt.l-8));var Ot=rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2);Ot!==0&&(st.mt=w(rt,rt.l-8)),st.start=rt.read_shift(4,"i"),st.size=rt.read_shift(4,"i"),st.size<0&&st.start<0&&(st.size=st.type=0,st.start=P,st.name=""),st.type===5?($e=st.start,L>0&&$e!==P&&(z[$e].name="!StreamData")):st.size>=4096?(st.storage="fat",z[st.start]===void 0&&(z[st.start]=v(re,st.start,z.fat_addrs,z.ssz)),z[st.start].name=st.name,st.content=z[st.start].data.slice(0,st.size)):(st.storage="minifat",st.size<0?st.size=0:$e!==P&&st.start!==P&&z[$e]&&(st.content=p(st,z[$e].data,(z[ye]||{}).data))),st.content&&Sl(st.content,0),fe[Ue]=st,Be.push(st)}}function w(W,z){return new Date((Pu(W,z+4)/1e7*Math.pow(2,32)+Pu(W,z)/1e7-11644473600)*1e3)}function I(W,z){return u(),d(c.readFileSync(W),z)}function j(W,z){var re=z&&z.type;switch(re||ra&&Buffer.isBuffer(W)&&(re="buffer"),re||"base64"){case"file":return I(W,z);case"base64":return d(Tu($u(W)),z);case"binary":return d(Tu(W),z)}return d(W,z)}function C(W,z){var re=z||{},V=re.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=V+"/",W.FileIndex[0]={name:V,type:5}),re.CLSID&&(W.FileIndex[0].clsid=re.CLSID),S(W)}function S(W){var z="Sh33tJ5";if(!_n.find(W,"/"+z)){var re=ur(4);re[0]=55,re[1]=re[3]=50,re[2]=54,W.FileIndex.push({name:z,type:2,content:re,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+z),E(W)}}function E(W,z){C(W);for(var re=!1,V=!1,L=W.FullPaths.length-1;L>=0;--L){var fe=W.FileIndex[L];switch(fe.type){case 0:V?re=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(fe.R*fe.L*fe.C)&&(re=!0),fe.R>-1&&fe.L>-1&&fe.R==fe.L&&(re=!0);break;default:re=!0;break}}if(!(!re&&!z)){var Be=new Date(1987,1,19),ye=0,$e=Object.create?Object.create(null):{},ze=[];for(L=0;L<W.FullPaths.length;++L)$e[W.FullPaths[L]]=!0,W.FileIndex[L].type!==0&&ze.push([W.FullPaths[L],W.FileIndex[L]]);for(L=0;L<ze.length;++L){var Ke=n(ze[L][0]);V=$e[Ke],V||(ze.push([Ke,{name:a(Ke).replace("/",""),type:1,clsid:ue,ct:Be,mt:Be,content:null}]),$e[Ke]=!0)}for(ze.sort(function(Ue,rt){return r(Ue[0],rt[0])}),W.FullPaths=[],W.FileIndex=[],L=0;L<ze.length;++L)W.FullPaths[L]=ze[L][0],W.FileIndex[L]=ze[L][1];for(L=0;L<ze.length;++L){var yt=W.FileIndex[L],ne=W.FullPaths[L];if(yt.name=a(ne).replace("/",""),yt.L=yt.R=yt.C=-(yt.color=1),yt.size=yt.content?yt.content.length:0,yt.start=0,yt.clsid=yt.clsid||ue,L===0)yt.C=ze.length>1?1:-1,yt.size=0,yt.type=5;else if(ne.slice(-1)=="/"){for(ye=L+1;ye<ze.length&&n(W.FullPaths[ye])!=ne;++ye);for(yt.C=ye>=ze.length?-1:ye,ye=L+1;ye<ze.length&&n(W.FullPaths[ye])!=n(ne);++ye);yt.R=ye>=ze.length?-1:ye,yt.type=1}else n(W.FullPaths[L+1]||"")==n(ne)&&(yt.R=L+1),yt.type=2}}}function B(W,z){var re=z||{};if(re.fileType=="mad")return Ne(W,re);switch(E(W),re.fileType){case"zip":return me(W,re)}var V=function(Ue){for(var rt=0,st=0,_t=0;_t<Ue.FileIndex.length;++_t){var Ot=Ue.FileIndex[_t];if(Ot.content){var nr=Ot.content.length;nr>0&&(nr<4096?rt+=nr+63>>6:st+=nr+511>>9)}}for(var Ir=Ue.FullPaths.length+3>>2,Qr=rt+7>>3,or=rt+127>>7,kr=Qr+st+Ir+or,Zr=kr+127>>7,nn=Zr<=109?0:Math.ceil((Zr-109)/127);kr+Zr+nn+127>>7>Zr;)nn=++Zr<=109?0:Math.ceil((Zr-109)/127);var _r=[1,nn,Zr,or,Ir,st,rt,0];return Ue.FileIndex[0].size=rt<<6,_r[7]=(Ue.FileIndex[0].start=_r[0]+_r[1]+_r[2]+_r[3]+_r[4]+_r[5])+(_r[6]+7>>3),_r}(W),L=ur(V[7]<<9),fe=0,Be=0;{for(fe=0;fe<8;++fe)L.write_shift(1,ce[fe]);for(fe=0;fe<8;++fe)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),fe=0;fe<3;++fe)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,V[2]),L.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:P),L.write_shift(4,V[3]),L.write_shift(-4,V[1]?V[0]-1:P),L.write_shift(4,V[1]),fe=0;fe<109;++fe)L.write_shift(-4,fe<V[2]?V[1]+fe:-1)}if(V[1])for(Be=0;Be<V[1];++Be){for(;fe<236+Be*127;++fe)L.write_shift(-4,fe<V[2]?V[1]+fe:-1);L.write_shift(-4,Be===V[1]-1?P:Be+1)}var ye=function(Ue){for(Be+=Ue;fe<Be-1;++fe)L.write_shift(-4,fe+1);Ue&&(++fe,L.write_shift(-4,P))};for(Be=fe=0,Be+=V[1];fe<Be;++fe)L.write_shift(-4,le.DIFSECT);for(Be+=V[2];fe<Be;++fe)L.write_shift(-4,le.FATSECT);ye(V[3]),ye(V[4]);for(var $e=0,ze=0,Ke=W.FileIndex[0];$e<W.FileIndex.length;++$e)Ke=W.FileIndex[$e],Ke.content&&(ze=Ke.content.length,!(ze<4096)&&(Ke.start=Be,ye(ze+511>>9)));for(ye(V[6]+7>>3);L.l&511;)L.write_shift(-4,le.ENDOFCHAIN);for(Be=fe=0,$e=0;$e<W.FileIndex.length;++$e)Ke=W.FileIndex[$e],Ke.content&&(ze=Ke.content.length,!(!ze||ze>=4096)&&(Ke.start=Be,ye(ze+63>>6)));for(;L.l&511;)L.write_shift(-4,le.ENDOFCHAIN);for(fe=0;fe<V[4]<<2;++fe){var yt=W.FullPaths[fe];if(!yt||yt.length===0){for($e=0;$e<17;++$e)L.write_shift(4,0);for($e=0;$e<3;++$e)L.write_shift(4,-1);for($e=0;$e<12;++$e)L.write_shift(4,0);continue}Ke=W.FileIndex[fe],fe===0&&(Ke.start=Ke.size?Ke.start-1:P);var ne=fe===0&&re.root||Ke.name;if(ze=2*(ne.length+1),L.write_shift(64,ne,"utf16le"),L.write_shift(2,ze),L.write_shift(1,Ke.type),L.write_shift(1,Ke.color),L.write_shift(-4,Ke.L),L.write_shift(-4,Ke.R),L.write_shift(-4,Ke.C),Ke.clsid)L.write_shift(16,Ke.clsid,"hex");else for($e=0;$e<4;++$e)L.write_shift(4,0);L.write_shift(4,Ke.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Ke.start),L.write_shift(4,Ke.size),L.write_shift(4,0)}for(fe=1;fe<W.FileIndex.length;++fe)if(Ke=W.FileIndex[fe],Ke.size>=4096)if(L.l=Ke.start+1<<9,ra&&Buffer.isBuffer(Ke.content))Ke.content.copy(L,L.l,0,Ke.size),L.l+=Ke.size+511&-512;else{for($e=0;$e<Ke.size;++$e)L.write_shift(1,Ke.content[$e]);for(;$e&511;++$e)L.write_shift(1,0)}for(fe=1;fe<W.FileIndex.length;++fe)if(Ke=W.FileIndex[fe],Ke.size>0&&Ke.size<4096)if(ra&&Buffer.isBuffer(Ke.content))Ke.content.copy(L,L.l,0,Ke.size),L.l+=Ke.size+63&-64;else{for($e=0;$e<Ke.size;++$e)L.write_shift(1,Ke.content[$e]);for(;$e&63;++$e)L.write_shift(1,0)}if(ra)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function k(W,z){var re=W.FullPaths.map(function($e){return $e.toUpperCase()}),V=re.map(function($e){var ze=$e.split("/");return ze[ze.length-($e.slice(-1)=="/"?2:1)]}),L=!1;z.charCodeAt(0)===47?(L=!0,z=re[0].slice(0,-1)+z):L=z.indexOf("/")!==-1;var fe=z.toUpperCase(),Be=L===!0?re.indexOf(fe):V.indexOf(fe);if(Be!==-1)return W.FileIndex[Be];var ye=!fe.match(eb);for(fe=fe.replace(kc,""),ye&&(fe=fe.replace(eb,"!")),Be=0;Be<re.length;++Be)if((ye?re[Be].replace(eb,"!"):re[Be]).replace(kc,"")==fe||(ye?V[Be].replace(eb,"!"):V[Be]).replace(kc,"")==fe)return W.FileIndex[Be];return null}var T=64,P=-2,G="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ae(W,z,re){u();var V=B(W,re);c.writeFileSync(z,V)}function ae(W){for(var z=new Array(W.length),re=0;re<W.length;++re)z[re]=String.fromCharCode(W[re]);return z.join("")}function _e(W,z){var re=B(W,z);switch(z&&z.type||"buffer"){case"file":return u(),c.writeFileSync(z.filename,re),re;case"binary":return typeof re=="string"?re:ae(re);case"base64":return F2(typeof re=="string"?re:ae(re));case"buffer":if(ra)return Buffer.isBuffer(re)?re:MA(re);case"array":return typeof re=="string"?Tu(re):re}return re}var De;function O(W){try{var z=W.InflateRaw,re=new z;if(re._processChunk(new Uint8Array([3,0]),re._finishFlushFlag),re.bytesRead)De=W;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function H(W,z){if(!De)return ie(W,z);var re=De.InflateRaw,V=new re,L=V._processChunk(W.slice(W.l),V._finishFlushFlag);return W.l+=V.bytesRead,L}function K(W){return De?De.deflateRawSync(W):ht(W)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(W){var z=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(z>>16|z>>8|z)&255}for(var Q=typeof Uint8Array<"u",te=Q?new Uint8Array(256):[],be=0;be<256;++be)te[be]=D(be);function U(W,z){var re=te[W&255];return z<=8?re>>>8-z:(re=re<<8|te[W>>8&255],z<=16?re>>>16-z:(re=re<<8|te[W>>16&255],re>>>24-z))}function Xe(W,z){var re=z&7,V=z>>>3;return(W[V]|(re<=6?0:W[V+1]<<8))>>>re&3}function se(W,z){var re=z&7,V=z>>>3;return(W[V]|(re<=5?0:W[V+1]<<8))>>>re&7}function ee(W,z){var re=z&7,V=z>>>3;return(W[V]|(re<=4?0:W[V+1]<<8))>>>re&15}function Fe(W,z){var re=z&7,V=z>>>3;return(W[V]|(re<=3?0:W[V+1]<<8))>>>re&31}function je(W,z){var re=z&7,V=z>>>3;return(W[V]|(re<=1?0:W[V+1]<<8))>>>re&127}function Se(W,z,re){var V=z&7,L=z>>>3,fe=(1<<re)-1,Be=W[L]>>>V;return re<8-V||(Be|=W[L+1]<<8-V,re<16-V)||(Be|=W[L+2]<<16-V,re<24-V)||(Be|=W[L+3]<<24-V),Be&fe}function Ze(W,z,re){var V=z&7,L=z>>>3;return V<=5?W[L]|=(re&7)<<V:(W[L]|=re<<V&255,W[L+1]=(re&7)>>8-V),z+3}function ut(W,z,re){var V=z&7,L=z>>>3;return re=(re&1)<<V,W[L]|=re,z+1}function Et(W,z,re){var V=z&7,L=z>>>3;return re<<=V,W[L]|=re&255,re>>>=8,W[L+1]=re,z+8}function St(W,z,re){var V=z&7,L=z>>>3;return re<<=V,W[L]|=re&255,re>>>=8,W[L+1]=re&255,W[L+2]=re>>>8,z+16}function Ft(W,z){var re=W.length,V=2*re>z?2*re:z+5,L=0;if(re>=z)return W;if(ra){var fe=AH(V);if(W.copy)W.copy(fe);else for(;L<W.length;++L)fe[L]=W[L];return fe}else if(Q){var Be=new Uint8Array(V);if(Be.set)Be.set(W);else for(;L<re;++L)Be[L]=W[L];return Be}return W.length=V,W}function Qt(W){for(var z=new Array(W),re=0;re<W;++re)z[re]=0;return z}function Ut(W,z,re){var V=1,L=0,fe=0,Be=0,ye=0,$e=W.length,ze=Q?new Uint16Array(32):Qt(32);for(fe=0;fe<32;++fe)ze[fe]=0;for(fe=$e;fe<re;++fe)W[fe]=0;$e=W.length;var Ke=Q?new Uint16Array($e):Qt($e);for(fe=0;fe<$e;++fe)ze[L=W[fe]]++,V<L&&(V=L),Ke[fe]=0;for(ze[0]=0,fe=1;fe<=V;++fe)ze[fe+16]=ye=ye+ze[fe-1]<<1;for(fe=0;fe<$e;++fe)ye=W[fe],ye!=0&&(Ke[fe]=ze[ye+16]++);var yt=0;for(fe=0;fe<$e;++fe)if(yt=W[fe],yt!=0)for(ye=U(Ke[fe],V)>>V-yt,Be=(1<<V+4-yt)-1;Be>=0;--Be)z[ye|Be<<yt]=yt&15|fe<<4;return V}var Tt=Q?new Uint16Array(512):Qt(512),Re=Q?new Uint16Array(32):Qt(32);if(!Q){for(var Te=0;Te<512;++Te)Tt[Te]=0;for(Te=0;Te<32;++Te)Re[Te]=0}(function(){for(var W=[],z=0;z<32;z++)W.push(5);Ut(W,Re,32);var re=[];for(z=0;z<=143;z++)re.push(8);for(;z<=255;z++)re.push(9);for(;z<=279;z++)re.push(7);for(;z<=287;z++)re.push(8);Ut(re,Tt,288)})();var Ye=function(){for(var z=Q?new Uint8Array(32768):[],re=0,V=0;re<Y.length-1;++re)for(;V<Y[re+1];++V)z[V]=re;for(;V<32768;++V)z[V]=29;var L=Q?new Uint8Array(259):[];for(re=0,V=0;re<X.length-1;++re)for(;V<X[re+1];++V)L[V]=re;function fe(ye,$e){for(var ze=0;ze<ye.length;){var Ke=Math.min(65535,ye.length-ze),yt=ze+Ke==ye.length;for($e.write_shift(1,+yt),$e.write_shift(2,Ke),$e.write_shift(2,~Ke&65535);Ke-- >0;)$e[$e.l++]=ye[ze++]}return $e.l}function Be(ye,$e){for(var ze=0,Ke=0,yt=Q?new Uint16Array(32768):[];Ke<ye.length;){var ne=Math.min(65535,ye.length-Ke);if(ne<10){for(ze=Ze($e,ze,+(Ke+ne==ye.length)),ze&7&&(ze+=8-(ze&7)),$e.l=ze/8|0,$e.write_shift(2,ne),$e.write_shift(2,~ne&65535);ne-- >0;)$e[$e.l++]=ye[Ke++];ze=$e.l*8;continue}ze=Ze($e,ze,+(Ke+ne==ye.length)+2);for(var Ue=0;ne-- >0;){var rt=ye[Ke];Ue=(Ue<<5^rt)&32767;var st=-1,_t=0;if((st=yt[Ue])&&(st|=Ke&-32768,st>Ke&&(st-=32768),st<Ke))for(;ye[st+_t]==ye[Ke+_t]&&_t<250;)++_t;if(_t>2){rt=L[_t],rt<=22?ze=Et($e,ze,te[rt+1]>>1)-1:(Et($e,ze,3),ze+=5,Et($e,ze,te[rt-23]>>5),ze+=3);var Ot=rt<8?0:rt-4>>2;Ot>0&&(St($e,ze,_t-X[rt]),ze+=Ot),rt=z[Ke-st],ze=Et($e,ze,te[rt]>>3),ze-=3;var nr=rt<4?0:rt-2>>1;nr>0&&(St($e,ze,Ke-st-Y[rt]),ze+=nr);for(var Ir=0;Ir<_t;++Ir)yt[Ue]=Ke&32767,Ue=(Ue<<5^ye[Ke])&32767,++Ke;ne-=_t-1}else rt<=143?rt=rt+48:ze=ut($e,ze,1),ze=Et($e,ze,te[rt]),yt[Ue]=Ke&32767,++Ke}ze=Et($e,ze,0)-1}return $e.l=(ze+7)/8|0,$e.l}return function($e,ze){return $e.length<8?fe($e,ze):Be($e,ze)}}();function ht(W){var z=ur(50+Math.floor(W.length*1.1)),re=Ye(W,z);return z.slice(0,re)}var Oe=Q?new Uint16Array(32768):Qt(32768),Ie=Q?new Uint16Array(32768):Qt(32768),We=Q?new Uint16Array(128):Qt(128),Z=1,Qe=1;function at(W,z){var re=Fe(W,z)+257;z+=5;var V=Fe(W,z)+1;z+=5;var L=ee(W,z)+4;z+=4;for(var fe=0,Be=Q?new Uint8Array(19):Qt(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$e=1,ze=Q?new Uint8Array(8):Qt(8),Ke=Q?new Uint8Array(8):Qt(8),yt=Be.length,ne=0;ne<L;++ne)Be[R[ne]]=fe=se(W,z),$e<fe&&($e=fe),ze[fe]++,z+=3;var Ue=0;for(ze[0]=0,ne=1;ne<=$e;++ne)Ke[ne]=Ue=Ue+ze[ne-1]<<1;for(ne=0;ne<yt;++ne)(Ue=Be[ne])!=0&&(ye[ne]=Ke[Ue]++);var rt=0;for(ne=0;ne<yt;++ne)if(rt=Be[ne],rt!=0){Ue=te[ye[ne]]>>8-rt;for(var st=(1<<7-rt)-1;st>=0;--st)We[Ue|st<<rt]=rt&7|ne<<3}var _t=[];for($e=1;_t.length<re+V;)switch(Ue=We[je(W,z)],z+=Ue&7,Ue>>>=3){case 16:for(fe=3+Xe(W,z),z+=2,Ue=_t[_t.length-1];fe-- >0;)_t.push(Ue);break;case 17:for(fe=3+se(W,z),z+=3;fe-- >0;)_t.push(0);break;case 18:for(fe=11+je(W,z),z+=7;fe-- >0;)_t.push(0);break;default:_t.push(Ue),$e<Ue&&($e=Ue);break}var Ot=_t.slice(0,re),nr=_t.slice(re);for(ne=re;ne<286;++ne)Ot[ne]=0;for(ne=V;ne<30;++ne)nr[ne]=0;return Z=Ut(Ot,Oe,286),Qe=Ut(nr,Ie,30),z}function Ge(W,z){if(W[0]==3&&!(W[1]&3))return[Pm(z),2];for(var re=0,V=0,L=AH(z||1<<18),fe=0,Be=L.length>>>0,ye=0,$e=0;!(V&1);){if(V=se(W,re),re+=3,V>>>1)V>>1==1?(ye=9,$e=5):(re=at(W,re),ye=Z,$e=Qe);else{re&7&&(re+=8-(re&7));var ze=W[re>>>3]|W[(re>>>3)+1]<<8;if(re+=32,ze>0)for(!z&&Be<fe+ze&&(L=Ft(L,fe+ze),Be=L.length);ze-- >0;)L[fe++]=W[re>>>3],re+=8;continue}for(;;){!z&&Be<fe+32767&&(L=Ft(L,fe+32767),Be=L.length);var Ke=Se(W,re,ye),yt=V>>>1==1?Tt[Ke]:Oe[Ke];if(re+=yt&15,yt>>>=4,!(yt>>>8&255))L[fe++]=yt;else{if(yt==256)break;yt-=257;var ne=yt<8?0:yt-4>>2;ne>5&&(ne=0);var Ue=fe+X[yt];ne>0&&(Ue+=Se(W,re,ne),re+=ne),Ke=Se(W,re,$e),yt=V>>>1==1?Re[Ke]:Ie[Ke],re+=yt&15,yt>>>=4;var rt=yt<4?0:yt-2>>1,st=Y[yt];for(rt>0&&(st+=Se(W,re,rt),re+=rt),!z&&Be<Ue&&(L=Ft(L,Ue+100),Be=L.length);fe<Ue;)L[fe]=L[fe-st],++fe}}}return z?[L,re+7>>>3]:[L.slice(0,fe),re+7>>>3]}function ie(W,z){var re=W.slice(W.l||0),V=Ge(re,z);return W.l+=V[1],V[0]}function xe(W,z){if(W)typeof console<"u"&&console.error(z);else throw new Error(z)}function de(W,z){var re=W;Sl(re,0);var V=[],L=[],fe={FileIndex:V,FullPaths:L};C(fe,{root:z.root});for(var Be=re.length-4;(re[Be]!=80||re[Be+1]!=75||re[Be+2]!=5||re[Be+3]!=6)&&Be>=0;)--Be;re.l=Be+4,re.l+=4;var ye=re.read_shift(2);re.l+=6;var $e=re.read_shift(4);for(re.l=$e,Be=0;Be<ye;++Be){re.l+=20;var ze=re.read_shift(4),Ke=re.read_shift(4),yt=re.read_shift(2),ne=re.read_shift(2),Ue=re.read_shift(2);re.l+=8;var rt=re.read_shift(4),st=l(re.slice(re.l+yt,re.l+yt+ne));re.l+=yt+ne+Ue;var _t=re.l;re.l=rt+4,Me(re,ze,Ke,fe,st),re.l=_t}return fe}function Me(W,z,re,V,L){W.l+=2;var fe=W.read_shift(2),Be=W.read_shift(2),ye=o(W);if(fe&8257)throw new Error("Unsupported ZIP encryption");for(var $e=W.read_shift(4),ze=W.read_shift(4),Ke=W.read_shift(4),yt=W.read_shift(2),ne=W.read_shift(2),Ue="",rt=0;rt<yt;++rt)Ue+=String.fromCharCode(W[W.l++]);if(ne){var st=l(W.slice(W.l,W.l+ne));(st[21589]||{}).mt&&(ye=st[21589].mt),((L||{})[21589]||{}).mt&&(ye=L[21589].mt)}W.l+=ne;var _t=W.slice(W.l,W.l+ze);switch(Be){case 8:_t=H(W,Ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Be)}var Ot=!1;fe&8&&($e=W.read_shift(4),$e==134695760&&($e=W.read_shift(4),Ot=!0),ze=W.read_shift(4),Ke=W.read_shift(4)),ze!=z&&xe(Ot,"Bad compressed size: "+z+" != "+ze),Ke!=re&&xe(Ot,"Bad uncompressed size: "+re+" != "+Ke),Le(V,Ue,_t,{unsafe:!0,mt:ye})}function me(W,z){var re=z||{},V=[],L=[],fe=ur(1),Be=re.compression?8:0,ye=0,$e=0,ze=0,Ke=0,yt=0,ne=W.FullPaths[0],Ue=ne,rt=W.FileIndex[0],st=[],_t=0;for($e=1;$e<W.FullPaths.length;++$e)if(Ue=W.FullPaths[$e].slice(ne.length),rt=W.FileIndex[$e],!(!rt.size||!rt.content||Ue=="Sh33tJ5")){var Ot=Ke,nr=ur(Ue.length);for(ze=0;ze<Ue.length;++ze)nr.write_shift(1,Ue.charCodeAt(ze)&127);nr=nr.slice(0,nr.l),st[yt]=b4e.buf(rt.content,0);var Ir=rt.content;Be==8&&(Ir=K(Ir)),fe=ur(30),fe.write_shift(4,67324752),fe.write_shift(2,20),fe.write_shift(2,ye),fe.write_shift(2,Be),rt.mt?s(fe,rt.mt):fe.write_shift(4,0),fe.write_shift(-4,st[yt]),fe.write_shift(4,Ir.length),fe.write_shift(4,rt.content.length),fe.write_shift(2,nr.length),fe.write_shift(2,0),Ke+=fe.length,V.push(fe),Ke+=nr.length,V.push(nr),Ke+=Ir.length,V.push(Ir),fe=ur(46),fe.write_shift(4,33639248),fe.write_shift(2,0),fe.write_shift(2,20),fe.write_shift(2,ye),fe.write_shift(2,Be),fe.write_shift(4,0),fe.write_shift(-4,st[yt]),fe.write_shift(4,Ir.length),fe.write_shift(4,rt.content.length),fe.write_shift(2,nr.length),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(4,0),fe.write_shift(4,Ot),_t+=fe.l,L.push(fe),_t+=nr.length,L.push(nr),++yt}return fe=ur(22),fe.write_shift(4,101010256),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,yt),fe.write_shift(2,yt),fe.write_shift(4,_t),fe.write_shift(4,Ke),fe.write_shift(2,0),Zo([Zo(V),Zo(L),fe])}var we={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function pt(W,z){if(W.ctype)return W.ctype;var re=W.name||"",V=re.match(/\.([^\.]+)$/);return V&&we[V[1]]||z&&(V=(re=z).match(/[\.\\]([^\.\\])+$/),V&&we[V[1]])?we[V[1]]:"application/octet-stream"}function vt(W){for(var z=F2(W),re=[],V=0;V<z.length;V+=76)re.push(z.slice(V,V+76));return re.join(`\r
`)+`\r
`}function bt(W){var z=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ze){var Ke=ze.charCodeAt(0).toString(16).toUpperCase();return"="+(Ke.length==1?"0"+Ke:Ke)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var re=[],V=z.split(`\r
`),L=0;L<V.length;++L){var fe=V[L];if(fe.length==0){re.push("");continue}for(var Be=0;Be<fe.length;){var ye=76,$e=fe.slice(Be,Be+ye);$e.charAt(ye-1)=="="?ye--:$e.charAt(ye-2)=="="?ye-=2:$e.charAt(ye-3)=="="&&(ye-=3),$e=fe.slice(Be,Be+ye),Be+=ye,Be<fe.length&&($e+="="),re.push($e)}}return re.join(`\r
`)}function kt(W){for(var z=[],re=0;re<W.length;++re){for(var V=W[re];re<=W.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+W[++re];z.push(V)}for(var L=0;L<z.length;++L)z[L]=z[L].replace(/[=][0-9A-Fa-f]{2}/g,function(fe){return String.fromCharCode(parseInt(fe.slice(1),16))});return Tu(z.join(`\r
`))}function Vt(W,z,re){for(var V="",L="",fe="",Be,ye=0;ye<10;++ye){var $e=z[ye];if(!$e||$e.match(/^\s*$/))break;var ze=$e.match(/^(.*?):\s*([^\s].*)$/);if(ze)switch(ze[1].toLowerCase()){case"content-location":V=ze[2].trim();break;case"content-type":fe=ze[2].trim();break;case"content-transfer-encoding":L=ze[2].trim();break}}switch(++ye,L.toLowerCase()){case"base64":Be=Tu($u(z.slice(ye).join("")));break;case"quoted-printable":Be=kt(z.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Ke=Le(W,V.slice(re.length),Be,{unsafe:!0});fe&&(Ke.ctype=fe)}function ke(W,z){if(ae(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var re=z&&z.root||"",V=(ra&&Buffer.isBuffer(W)?W.toString("binary"):ae(W)).split(`\r
`),L=0,fe="";for(L=0;L<V.length;++L)if(fe=V[L],!!/^Content-Location:/i.test(fe)&&(fe=fe.slice(fe.indexOf("file")),re||(re=fe.slice(0,fe.lastIndexOf("/")+1)),fe.slice(0,re.length)!=re))for(;re.length>0&&(re=re.slice(0,re.length-1),re=re.slice(0,re.lastIndexOf("/")+1),fe.slice(0,re.length)!=re););var Be=(V[1]||"").match(/boundary="(.*?)"/);if(!Be)throw new Error("MAD cannot find boundary");var ye="--"+(Be[1]||""),$e=[],ze=[],Ke={FileIndex:$e,FullPaths:ze};C(Ke);var yt,ne=0;for(L=0;L<V.length;++L){var Ue=V[L];Ue!==ye&&Ue!==ye+"--"||(ne++&&Vt(Ke,V.slice(yt,L),re),yt=L)}return Ke}function Ne(W,z){var re=z||{},V=re.boundary||"SheetJS";V="------="+V;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],fe=W.FullPaths[0],Be=fe,ye=W.FileIndex[0],$e=1;$e<W.FullPaths.length;++$e)if(Be=W.FullPaths[$e].slice(fe.length),ye=W.FileIndex[$e],!(!ye.size||!ye.content||Be=="Sh33tJ5")){Be=Be.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_t){return"_x"+_t.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_t){return"_u"+_t.charCodeAt(0).toString(16)+"_"});for(var ze=ye.content,Ke=ra&&Buffer.isBuffer(ze)?ze.toString("binary"):ae(ze),yt=0,ne=Math.min(1024,Ke.length),Ue=0,rt=0;rt<=ne;++rt)(Ue=Ke.charCodeAt(rt))>=32&&Ue<128&&++yt;var st=yt>=ne*4/5;L.push(V),L.push("Content-Location: "+(re.root||"file:///C:/SheetJS/")+Be),L.push("Content-Transfer-Encoding: "+(st?"quoted-printable":"base64")),L.push("Content-Type: "+pt(ye,Be)),L.push(""),L.push(st?bt(Ke):vt(Ke))}return L.push(V+`--\r
`),L.join(`\r
`)}function pe(W){var z={};return C(z,W),z}function Le(W,z,re,V){var L=V&&V.unsafe;L||C(W);var fe=!L&&_n.find(W,z);if(!fe){var Be=W.FullPaths[0];z.slice(0,Be.length)==Be?Be=z:(Be.slice(-1)!="/"&&(Be+="/"),Be=(Be+z).replace("//","/")),fe={name:a(z),type:2},W.FileIndex.push(fe),W.FullPaths.push(Be),L||_n.utils.cfb_gc(W)}return fe.content=re,fe.size=re?re.length:0,V&&(V.CLSID&&(fe.clsid=V.CLSID),V.mt&&(fe.mt=V.mt),V.ct&&(fe.ct=V.ct)),fe}function ft(W,z){C(W);var re=_n.find(W,z);if(re){for(var V=0;V<W.FileIndex.length;++V)if(W.FileIndex[V]==re)return W.FileIndex.splice(V,1),W.FullPaths.splice(V,1),!0}return!1}function At(W,z,re){C(W);var V=_n.find(W,z);if(V){for(var L=0;L<W.FileIndex.length;++L)if(W.FileIndex[L]==V)return W.FileIndex[L].name=a(re),W.FullPaths[L]=re,!0}return!1}function ct(W){E(W,!0)}return e.find=k,e.read=j,e.parse=d,e.write=_e,e.writeFile=Ae,e.utils={cfb_new:pe,cfb_add:Le,cfb_del:ft,cfb_mov:At,cfb_gc:ct,ReadShift:Db,CheckField:Wne,prep_blob:Sl,bconcat:Zo,use_zlib:O,_deflateRaw:ht,_inflateRaw:ie,consts:le},e}();function w4e(t){return typeof t=="string"?cP(t):Array.isArray(t)?z3e(t):t}function Uw(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=cP(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?th(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([w4e(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=$m(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function N4e(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ti(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function wH(t,e){for(var r=[],n=Ti(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function dP(t){for(var e=[],r=Ti(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function fP(t){for(var e=[],r=Ti(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function C4e(t){for(var e=[],r=Ti(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var KS=new Date(1899,11,30,0,0,0);function Do(t,e){var r=t.getTime(),n=KS.getTime()+(t.getTimezoneOffset()-KS.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var jne=new Date,_4e=KS.getTime()+(jne.getTimezoneOffset()-KS.getTimezoneOffset())*6e4,NH=jne.getTimezoneOffset();function hP(t){var e=new Date;return e.setTime(t*24*60*60*1e3+_4e),e.getTimezoneOffset()!==NH&&e.setTime(e.getTime()+(e.getTimezoneOffset()-NH)*6e4),e}function E4e(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[s],10)}return e}var CH=new Date("2017-02-19T19:06:09.000Z"),Ine=isNaN(CH.getFullYear())?new Date("2/19/17"):CH,S4e=Ine.getFullYear()==2017;function Rs(t,e){var r=new Date(t);if(S4e)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Ine.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xg(t,e){if(ra&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return th(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return th(pne(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return th(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return th(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function Ms(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ms(t[r]));return e}function Si(t,e){for(var r="";r.length<e;)r+=t;return r}function yf(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var j4e=["january","february","march","april","may","june","july","august","september","october","november","december"];function Vv(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&j4e.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var I4e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function Pne(t){return t?t.content&&t.type?xg(t.content,!0):t.data?Zy(t.data):t.asNodeBuffer&&ra?Zy(t.asNodeBuffer().toString("binary")):t.asBinary?Zy(t.asBinary()):t._data&&t._data.getContent?Zy(xg(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Tne(t){if(!t)return null;if(t.data)return fH(t.data);if(t.asNodeBuffer&&ra)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?fH(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function P4e(t){return t&&t.name.slice(-4)===".bin"?Tne(t):Pne(t)}function gd(t,e){for(var r=t.FullPaths||Ti(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function sR(t,e){var r=gd(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ao(t,e,r){if(!r)return P4e(sR(t,e));if(!e)return null;try{return ao(t,e)}catch{return null}}function Bu(t,e,r){if(!r)return Pne(sR(t,e));if(!e)return null;try{return Bu(t,e)}catch{return null}}function T4e(t,e,r){return Tne(sR(t,e))}function _H(t){for(var e=t.FullPaths||Ti(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Zn(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ra?n=MA(r):n=W3e(r),_n.utils.cfb_add(t,e,n)}_n.utils.cfb_add(t,e,r)}else t.file(e,r)}function iR(){return _n.utils.cfb_new()}function Bne(t,e){switch(e.type){case"base64":return _n.read(t,{type:"base64"});case"binary":return _n.read(t,{type:"binary"});case"buffer":case"array":return _n.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function tb(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Yi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,B4e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,EH=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,k4e=/<[^>]*>/g,fc=Yi.match(EH)?EH:k4e,F4e=/<\w*:/,O4e=/<(\/?)\w+:/;function Dn(t,e,r){for(var n={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(B4e),l=0,c="",u=0,d="",f="",A=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(A=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+A,f.length-A),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function vh(t){return t.replace(O4e,"<$1")}var kne={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},oR=dP(kne),Sa=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(l,c){return kne[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),lR=/[&<>'"]/g,D4e=/[\u0000-\u0008\u000b-\u001f]/g;function ns(t){var e=t+"";return e.replace(lR,function(r){return oR[r]}).replace(D4e,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function SH(t){return ns(t).replace(/ /g,"_x0020_")}var Fne=/[\u0000-\u001f]/g;function cR(t){var e=t+"";return e.replace(lR,function(r){return oR[r]}).replace(/\n/g,"<br/>").replace(Fne,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function R4e(t){var e=t+"";return e.replace(lR,function(r){return oR[r]}).replace(Fne,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jH=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function M4e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function ks(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function P5(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function IH(t){var e=Pm(2*t.length),r,n,a=1,s=0,o=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function PH(t){return MA(t,"binary").toString("utf8")}var $C="foo bar baz",us=ra&&(PH($C)==P5($C)&&PH||IH($C)==P5($C)&&IH)||P5,th=ra?function(t){return MA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},D2=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),One=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),L4e=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),U4e=/<\/?(?:vt:)?variant>/g,Q4e=/<(?:vt:)([^>]*)>([\s\S]*)</;function TH(t,e){var r=Dn(t),n=t.match(L4e(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(U4e,"").match(Q4e);o&&a.push({v:us(o[2]),t:o[1]})}),a}var Dne=/(^\s|\s$|\n)/;function Il(t,e){return"<"+t+(e.match(Dne)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function R2(t){return Ti(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function $r(t,e,r){return"<"+t+(r!=null?R2(r):"")+(e!=null?(e.match(Dne)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Jk(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function V4e(t,e){switch(typeof t){case"string":var r=$r("vt:lpwstr",ns(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return $r((t|0)==t?"vt:i4":"vt:r8",ns(String(t)));case"boolean":return $r("vt:bool",t?"true":"false")}if(t instanceof Date)return $r("vt:filetime",Jk(t));throw new Error("Unable to serialize "+t)}function uR(t){if(ra&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return us($m(rR(t)));throw new Error("Bad input format: expected Buffer or string")}var M2=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,To={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Qg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Iu={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function H4e(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function $4e(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=n?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)t[r+l]=s&255;t[r+6]=(a&15)<<4|s&15,t[r+7]=a>>4|n}var BH=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,s=t[0][n].length;a<s;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},kH=ra?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:MA(e)})):BH(t)}:BH,FH=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Zh(t,a)));return n.join("").replace(kc,"")},dR=ra?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(kc,""):FH(t,e,r)}:FH,OH=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},Rne=ra?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):OH(t,e,r)}:OH,DH=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Ox(t,a)));return n.join("")},Qw=ra?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):DH(e,r,n)}:DH,Mne=function(t,e){var r=Pu(t,e);return r>0?Qw(t,e+4,e+4+r-1):""},Lne=Mne,Une=function(t,e){var r=Pu(t,e);return r>0?Qw(t,e+4,e+4+r-1):""},Qne=Une,Vne=function(t,e){var r=2*Pu(t,e);return r>0?Qw(t,e+4,e+4+r-1):""},Hne=Vne,$ne=function(e,r){var n=Pu(e,r);return n>0?dR(e,r+4,r+4+n):""},Gne=$ne,Kne=function(t,e){var r=Pu(t,e);return r>0?Qw(t,e+4,e+4+r):""},qne=Kne,zne=function(t,e){return H4e(t,e)},qS=zne,fR=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ra&&(Lne=function(e,r){if(!Buffer.isBuffer(e))return Mne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Qne=function(e,r){if(!Buffer.isBuffer(e))return Une(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Hne=function(e,r){if(!Buffer.isBuffer(e))return Vne(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Gne=function(e,r){if(!Buffer.isBuffer(e))return $ne(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},qne=function(e,r){if(!Buffer.isBuffer(e))return Kne(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},qS=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):zne(e,r)},fR=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ox=function(t,e){return t[e]},Zh=function(t,e){return t[e+1]*256+t[e]},G4e=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Pu=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Cp=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},K4e=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Db(t,e){var r="",n,a,s=[],o,l,c,u;switch(e){case"dbcs":if(u=this.l,ra&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Zh(this,u)),u+=2;t*=2;break;case"utf8":r=Qw(this,this.l,this.l+t);break;case"utf16le":t*=2,r=dR(this,this.l,this.l+t);break;case"wstr":return Db.call(this,t,"dbcs");case"lpstr-ansi":r=Lne(this,this.l),t=4+Pu(this,this.l);break;case"lpstr-cp":r=Qne(this,this.l),t=4+Pu(this,this.l);break;case"lpwstr":r=Hne(this,this.l),t=4+2*Pu(this,this.l);break;case"lpp4":t=4+Pu(this,this.l),r=Gne(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Pu(this,this.l),r=qne(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Ox(this,this.l+t++))!==0;)s.push(HC(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Zh(this,this.l+t))!==0;)s.push(HC(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ox(this,u),this.l=u+1,l=Db.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(HC(Zh(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ox(this,u),this.l=u+1,l=Db.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(HC(Ox(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Ox(this,this.l),this.l++,n;case 2:return n=(e==="i"?G4e:Zh)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Cp:K4e)(this,this.l),this.l+=4,n):(a=Pu(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=qS(this,this.l):a=qS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=Rne(this,this.l,t);break}}return this.l+=t,r}var q4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},z4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},W4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function X4e(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)W4e(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,q4e(this,e,this.l);break;case 8:if(n=8,r==="f"){$4e(this,e,this.l);break}case 16:break;case-4:n=4,z4e(this,e,this.l);break}return this.l+=n,this}function Wne(t,e){var r=Rne(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sl(t,e){t.l=e,t.read_shift=Db,t.chk=Wne,t.write_shift=X4e}function dc(t,e){t.l+=e}function ur(t){var e=Pm(t);return Sl(e,0),e}function LA(t,e,r){if(t){var n,a,s;Sl(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var u=$2[l]||$2[65535];for(n=t.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=t.read_shift(1))&127)<<7*a;c=t.l+s;var d=u.f&&u.f(t,s,r);if(t.l=c,e(d,u,l))return}}}function lu(){var t=[],e=ra?256:2048,r=function(u){var d=ur(u);return Sl(d,0),d},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,e)))},o=function(){return a(),Zo(t)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:l,end:o,_bufs:t}}function Cr(t,e,r,n){var a=+e,s;if(!isNaN(a)){n||(n=$2[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&fR(r)&&t.push(r)}}function Rb(t,e,r){var n=Ms(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function RH(t,e,r){var n=Ms(t);return n.s=Rb(n.s,e.s,r),n.e=Rb(n.e,e.s,r),n}function Mb(t,e){if(t.cRel&&t.c<0)for(t=Ms(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ms(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=On(t);return!t.cRel&&t.cRel!=null&&(r=Z4e(r)),!t.rRel&&t.rRel!=null&&(r=Y4e(r)),r}function T5(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ui(t.s.c)+":"+(t.e.cRel?"":"$")+ui(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Wi(t.s.r)+":"+(t.e.rRel?"":"$")+Wi(t.e.r):Mb(t.s,e.biff)+":"+Mb(t.e,e.biff)}function hR(t){return parseInt(J4e(t),10)-1}function Wi(t){return""+(t+1)}function Y4e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function J4e(t){return t.replace(/\$(\d+)$/,"$1")}function AR(t){for(var e=e5e(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function ui(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Z4e(t){return t.replace(/^([A-Z])/,"$$$1")}function e5e(t){return t.replace(/^\$([A-Z])/,"$1")}function t5e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function di(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function On(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function cu(t){var e=t.indexOf(":");return e==-1?{s:di(t),e:di(t)}:{s:di(t.slice(0,e)),e:di(t.slice(e+1))}}function Xn(t,e){return typeof e>"u"||typeof e=="number"?Xn(t.s,t.e):(typeof t!="string"&&(t=On(t)),typeof e!="string"&&(e=On(e)),t==e?t:t+":"+e)}function ja(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=t.length;for(r=0;n<s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function MH(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Dd(t.z,r?Do(e):e)}catch{}try{return t.w=Dd((t.XF||{}).numFmtId||(r?14:0),r?Do(e):e)}catch{return""+e}}function NA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?UA[t.v]||t.v:e==null?MH(t,t.v):MH(t,e))}function Gm(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Xne(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,s=t||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?di(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=ja(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var A=0;A!=e[f].length;++A)if(!(typeof e[f][A]>"u")){var h={v:e[f][A]},m=o+f,p=l+A;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),e[f][A]&&typeof e[f][A]=="object"&&!Array.isArray(e[f][A])&&!(e[f][A]instanceof Date))h=e[f][A];else if(Array.isArray(h.v)&&(h.f=e[f][A][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Fn[14],n.cellDates?(h.t="d",h.w=Dd(h.z,Do(h.v))):(h.t="n",h.v=Do(h.v),h.w=Dd(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var x=On({c:p,r:m});s[x]&&s[x].z&&(h.z=s[x].z),s[x]=h}}}return u.s.c<1e7&&(s["!ref"]=Xn(u)),s}function C1(t,e){return Xne(null,t,e)}function r5e(t){return t.read_shift(4,"i")}function bf(t,e){return e||(e=ur(4)),e.write_shift(4,t),e}function lc(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function el(t,e){var r=!1;return e==null&&(r=!0,e=ur(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function n5e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function a5e(t,e){return e||(e=ur(4)),e.write_shift(2,0),e.write_shift(2,0),e}function mR(t,e){var r=t.l,n=t.read_shift(1),a=lc(t),s=[],o={t:a,h:a};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)s.push(n5e(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function s5e(t,e){var r=!1;return e==null&&(r=!0,e=ur(15+4*t.t.length)),e.write_shift(1,0),el(t.t,e),r?e.slice(0,e.l):e}var i5e=mR;function o5e(t,e){var r=!1;return e==null&&(r=!0,e=ur(23+4*t.t.length)),e.write_shift(1,1),el(t.t,e),e.write_shift(4,1),a5e({},e),r?e.slice(0,e.l):e}function Vd(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Vg(t,e){return e==null&&(e=ur(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Hg(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function $g(t,e){return e==null&&(e=ur(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var l5e=lc,Yne=el;function pR(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function zS(t,e){var r=!1;return e==null&&(r=!0,e=ur(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var c5e=lc,Zk=pR,gR=zS;function xR(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?qS([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Cp(e,0)>>2;return r?a/100:a}function Jne(t,e){e==null&&(e=ur(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Zne(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function u5e(t,e){return e||(e=ur(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Gg=Zne,_1=u5e;function sc(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function vg(t,e){return(e||ur(8)).write_shift(8,t,"f")}function d5e(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var u=Gp[a];u&&(e.rgb=U2(u));break;case 2:e.rgb=U2([o,l,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function WS(t,e){if(e||(e=ur(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function f5e(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function h5e(t,e){e||(e=ur(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function eae(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function A5e(t){return eae(t,1)}function m5e(t){return eae(t,2)}var vR=2,Yc=3,GC=11,LH=12,XS=19,KC=64,p5e=65,g5e=71,x5e=4108,v5e=4126,Xo=80,tae=81,y5e=[Xo,tae],eF={1:{n:"CodePage",t:vR},2:{n:"Category",t:Xo},3:{n:"PresentationFormat",t:Xo},4:{n:"ByteCount",t:Yc},5:{n:"LineCount",t:Yc},6:{n:"ParagraphCount",t:Yc},7:{n:"SlideCount",t:Yc},8:{n:"NoteCount",t:Yc},9:{n:"HiddenCount",t:Yc},10:{n:"MultimediaClipCount",t:Yc},11:{n:"ScaleCrop",t:GC},12:{n:"HeadingPairs",t:x5e},13:{n:"TitlesOfParts",t:v5e},14:{n:"Manager",t:Xo},15:{n:"Company",t:Xo},16:{n:"LinksUpToDate",t:GC},17:{n:"CharacterCount",t:Yc},19:{n:"SharedDoc",t:GC},22:{n:"HyperlinksChanged",t:GC},23:{n:"AppVersion",t:Yc,p:"version"},24:{n:"DigSig",t:p5e},26:{n:"ContentType",t:Xo},27:{n:"ContentStatus",t:Xo},28:{n:"Language",t:Xo},29:{n:"Version",t:Xo},255:{},2147483648:{n:"Locale",t:XS},2147483651:{n:"Behavior",t:XS},1919054434:{}},tF={1:{n:"CodePage",t:vR},2:{n:"Title",t:Xo},3:{n:"Subject",t:Xo},4:{n:"Author",t:Xo},5:{n:"Keywords",t:Xo},6:{n:"Comments",t:Xo},7:{n:"Template",t:Xo},8:{n:"LastAuthor",t:Xo},9:{n:"RevNumber",t:Xo},10:{n:"EditTime",t:KC},11:{n:"LastPrinted",t:KC},12:{n:"CreatedDate",t:KC},13:{n:"ModifiedDate",t:KC},14:{n:"PageCount",t:Yc},15:{n:"WordCount",t:Yc},16:{n:"CharCount",t:Yc},17:{n:"Thumbnail",t:g5e},18:{n:"Application",t:Xo},19:{n:"DocSecurity",t:Yc},255:{},2147483648:{n:"Locale",t:XS},2147483651:{n:"Behavior",t:XS},1919054434:{}},UH={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},b5e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function w5e(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var N5e=w5e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gp=Ms(N5e),UA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rae={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rF={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},qC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function yR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function C5e(t){var e=yR();if(!t||!t.match)return e;var r={};if((t.match(fc)||[]).forEach(function(n){var a=Dn(n);switch(a[0].replace(F4e,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[rF[a.ContentType]]!==void 0&&e[rF[a.ContentType]].push(a.PartName);break}}),e.xmlns!==To.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function nae(t,e){var r=C4e(rF),n=[],a;n[n.length]=Yi,n[n.length]=$r("Types",null,{xmlns:To.CT,"xmlns:xsd":To.xsd,"xmlns:xsi":To.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return $r("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(a=t[c][0],n[n.length]=$r("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:qC[c][e.bookType]||qC[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=$r("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:qC[c][e.bookType]||qC[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){n[n.length]=$r("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ia={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function L2(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Lb(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(fc)||[]).forEach(function(a){var s=Dn(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:tb(s.Target,e);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function xv(t){var e=[Yi,$r("Relationships",null,{xmlns:To.RELS})];return Ti(t["!id"]).forEach(function(r){e[e.length]=$r("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Za(t,e,r,n,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[ia.HLINK,ia.XPATH,ia.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var _5e="application/vnd.oasis.opendocument.spreadsheet";function E5e(t,e){for(var r=uR(t),n,a;n=M2.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Dn(n[0],!1),a.path=="/"&&a.type!==_5e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function S5e(t){var e=[Yi];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function QH(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function j5e(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function I5e(t){var e=[Yi];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(QH(t[r][0],t[r][1])),e.push(j5e("",t[r][0]));return e.push(QH("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function aae(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+VS.version+"</meta:generator></office:meta></office:document-meta>"}var Td=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],P5e=function(){for(var t=new Array(Td.length),e=0;e<Td.length;++e){var r=Td[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function sae(t){var e={};t=us(t);for(var r=0;r<Td.length;++r){var n=Td[r],a=t.match(P5e[r]);a!=null&&a.length>0&&(e[n[1]]=Sa(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Rs(e[n[1]]))}return e}function B5(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=ns(e),n[n.length]=r?$r(t,e,r):Il(t,e))}function iae(t,e){var r=e||{},n=[Yi,$r("cp:coreProperties",null,{"xmlns:cp":To.CORE_PROPS,"xmlns:dc":To.dc,"xmlns:dcterms":To.dcterms,"xmlns:dcmitype":To.dcmitype,"xmlns:xsi":To.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&B5("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Jk(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&B5("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Jk(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Td.length;++s){var o=Td[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&B5(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Kp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],oae=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function lae(t,e,r,n){var a=[];if(typeof t=="string")a=TH(t,n);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(d){return{v:d}}));var o=typeof e=="string"?TH(e,n).map(function(d){return d.v}):e,l=0,c=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function T5e(t,e,r){var n={};return e||(e={}),t=us(t),Kp.forEach(function(a){var s=(t.match(D2(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=Sa(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&lae(n.HeadingPairs,n.TitlesOfParts,e,r),e}function cae(t){var e=[],r=$r;return t||(t={}),t.Application="SheetJS",e[e.length]=Yi,e[e.length]=$r("Properties",null,{xmlns:To.EXT_PROPS,"xmlns:vt":To.vt}),Kp.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=ns(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ns(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var B5e=/<[^>]+>[^<]*/g;function k5e(t,e){var r={},n="",a=t.match(B5e);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=Dn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Sa(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Sa(d);break;case"bool":r[n]=ks(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Rs(d);break;case"cy":case"error":r[n]=Sa(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function uae(t){var e=[Yi,$r("Properties",null,{xmlns:To.CUST_PROPS,"xmlns:vt":To.vt})];if(!t)return e.join("");var r=1;return Ti(t).forEach(function(a){++r,e[e.length]=$r("property",V4e(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ns(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var nF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},k5;function F5e(t,e,r){k5||(k5=dP(nF)),e=k5[e]||e,t[e]=r}function O5e(t,e){var r=[];return Ti(nF).map(function(n){for(var a=0;a<Td.length;++a)if(Td[a][1]==n)return Td[a];for(a=0;a<Kp.length;++a)if(Kp[a][1]==n)return Kp[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Il(nF[n[1]]||n[1],a))}}),$r("DocumentProperties",r.join(""),{xmlns:Iu.o})}function D5e(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Ti(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Td.length;++o)if(s==Td[o][1])return;for(o=0;o<Kp.length;++o)if(s==Kp[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=t[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push($r(SH(s),l,{"dt:dt":c}))}}),e&&Ti(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push($r(SH(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Iu.o+'">'+a.join("")+"</"+n+">"}function bR(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function R5e(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=ur(8);return o.write_shift(4,n),o.write_shift(4,a),o}function dae(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function fae(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function hae(t,e,r){return e===31?fae(t):dae(t,e,r)}function aF(t,e,r){return hae(t,e,r===!1?0:4)}function M5e(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return hae(t,e,0)}function L5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(kc,""),t.l-a&2&&(t.l+=2)}return r}function U5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(kc,"");return r}function Q5e(t){var e=t.l,r=YS(t,tae);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=YS(t,Yc);return[r,n]}function V5e(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(Q5e(t));return r}function VH(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(kc,"").replace(eb,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Aae(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function H5e(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function YS(t,e,r){var n=t.read_shift(2),a,s=r||{};if(t.l+=2,e!==LH&&n!==e&&y5e.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===LH?n:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return dae(t,n,4).replace(kc,"");case 31:return fae(t);case 64:return bR(t);case 65:return Aae(t);case 71:return H5e(t);case 80:return aF(t,n,!s.raw).replace(kc,"");case 81:return M5e(t,n).replace(kc,"");case 4108:return V5e(t);case 4126:case 4127:return n==4127?L5e(t):U5e(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function HH(t,e){var r=ur(4),n=ur(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ur(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=R5e(e);break;case 31:case 80:for(n=ur(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Zo([r,n])}function $H(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=a;++o){var d=t.read_shift(4),f=t.read_shift(4);s[o]=[d,f+r]}s.sort(function(y,b){return y[1]-b[1]});var A={};for(o=0;o!=a;++o){if(t.l!==s[o][1]){var h=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(h=!1,t.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[s[o][0]];if(A[m.n]=YS(t,m.t,{raw:!0}),m.p==="version"&&(A[m.n]=String(A[m.n]>>16)+"."+("0000"+String(A[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(A[m.n]){case 0:A[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:mf(l=A[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+A[m.n])}}else if(s[o][0]===1){if(l=A.CodePage=YS(t,vR),mf(l),c!==-1){var p=t.l;t.l=s[c][1],u=VH(t,l),t.l=p}}else if(s[o][0]===0){if(l===0){c=o,t.l=s[o+1][1];continue}u=VH(t,l)}else{var x=u[s[o][0]],v;switch(t[t.l]){case 65:t.l+=4,v=Aae(t);break;case 30:t.l+=4,v=aF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=aF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=Li(t,4);break;case 64:t.l+=4,v=Rs(bR(t));break;default:throw new Error("unparsed value: "+t[t.l])}A[x]=v}}return t.l=r+n,A}var mae=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $5e(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function GH(t,e,r){var n=ur(8),a=[],s=[],o=8,l=0,c=ur(8),u=ur(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!e){u=ur(8),u.write_shift(4,0),a.unshift(u);var d=[ur(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=ur(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Zo(d),s.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(mae.indexOf(t[l][0])>-1||oae.indexOf(t[l][0])>-1)&&t[l][1]!=null){var A=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof A=="string"){var p=A.split(".");A=(+p[0]<<16)+(+p[1]||0)}c=HH(m.t,A)}else{var x=$5e(A);x==-1&&(x=31,A=String(A)),c=HH(x,A)}s.push(c),u=ur(8),u.write_shift(4,e?h:2+l),a.push(u),o+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Zo([n].concat(a).concat(s))}function KH(t,e,r){var n=t.content;if(!n)return{};Sl(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==_n.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=$H(n,e),A={SystemIdentifier:u};for(var h in f)A[h]=f[h];if(A.FMTID=s,a===1)return A;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=$H(n,null)}catch{}for(h in m)A[h]=m[h];return A.FMTID=[s,o],A}function qH(t,e,r,n,a,s){var o=ur(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,_n.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var c=GH(t,r,n);if(l.push(c),a){var u=GH(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Zo(l)}function g0(t,e){return t.read_shift(e),null}function G5e(t,e){e||(e=ur(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function K5e(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Li(t,e){return t.read_shift(e)===1}function Ec(t,e){return e||(e=ur(2)),e.write_shift(2,+!!t),e}function so(t){return t.read_shift(2,"u")}function xd(t,e){return e||(e=ur(2)),e.write_shift(2,t),e}function pae(t,e){return K5e(t,e,so)}function q5e(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function gae(t,e,r){return r||(r=ur(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Vw(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function z5e(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return a&&(t.l+=4*o),n&&(t.l+=l),c.t=d,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function W5e(t){var e=t.t||"",r=ur(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ur(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return Zo(a)}function yg(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Hw(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):yg(t,n,r)}function Kg(t,e,r){if(r.biff>5)return Hw(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function xae(t,e,r){return r||(r=ur(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function X5e(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Y5e(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(kc,"");return n&&(t.l+=24),a}function J5e(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(kc,"");return r+o}function Z5e(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Y5e(t);case"0303000000000000c000000000000046":return J5e(t);default:throw new Error("Unsupported Moniker "+r)}}function zC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(kc,""):"";return r}function zH(t,e){e||(e=ur(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function eTe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var s,o,l,c,u="",d,f;a&16&&(s=zC(t,r-t.l)),a&128&&(o=zC(t,r-t.l)),(a&257)===257&&(l=zC(t,r-t.l)),(a&257)===1&&(c=Z5e(t,r-t.l)),a&8&&(u=zC(t,r-t.l)),a&32&&(d=t.read_shift(16)),a&64&&(f=bR(t)),t.l=r;var A=o||l||c||"";A&&u&&(A+="#"+u),A||(A="#"+u),a&2&&A.charAt(0)=="/"&&A.charAt(1)!="/"&&(A="file://"+A);var h={Target:A};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function tTe(t){var e=ur(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),zH(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),s&8&&zH(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function vae(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function yae(t,e){var r=vae(t);return r[3]=0,r}function yh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function bg(t,e,r,n){return n||(n=ur(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function rTe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function nTe(t,e,r){return e===0?"":Kg(t,e,r)}function aTe(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,s,o]}function bae(t){var e=t.read_shift(2),r=xR(t);return[e,r]}function sTe(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=Vw(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,a}function AP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function wae(t,e){return e||(e=ur(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Nae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var iTe=Nae;function Cae(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function oTe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function lTe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function zl(t){t.l+=2,t.l+=t.read_shift(2)}var cTe={0:zl,4:zl,5:zl,6:zl,7:lTe,8:zl,9:zl,10:zl,11:zl,12:zl,13:oTe,14:zl,15:zl,16:zl,17:zl,18:zl,19:zl,20:zl,21:Cae};function uTe(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(cTe[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function WC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function wR(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ur(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function dTe(t,e){return e===0||t.read_shift(2),1200}function fTe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Kg(t,0,r);return t.read_shift(e+n-t.l),a}function hTe(t,e){var r=!e||e.biff==8,n=ur(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function ATe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function mTe(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Vw(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function pTe(t,e){var r=!e||e.biff>=8?2:1,n=ur(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function gTe(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0;o!=a&&t.l<r;++o)s.push(z5e(t));return s.Count=n,s.Unique=a,s}function xTe(t,e){var r=ur(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=W5e(t[a]);var s=Zo([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function vTe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function yTe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function bTe(t){var e=rTe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function wTe(t){return t.read_shift(2),t.read_shift(4)}function WH(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function NTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function CTe(){var t=ur(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function _Te(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function ETe(t){var e=ur(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function STe(){}function jTe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Vw(t,0,r),n}function ITe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,s=ur(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function PTe(t){var e=yh(t);return e.isst=t.read_shift(4),e}function TTe(t,e,r,n){var a=ur(10);return bg(t,e,n,a),a.write_shift(4,r),a}function BTe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=yh(t);r.biff==2&&t.l++;var s=Hw(t,n-t.l,r);return a.val=s,a}function kTe(t,e,r,n,a){var s=!a||a.biff==8,o=ur(8+ +s+(1+s)*r.length);return bg(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function FTe(t,e,r){var n=t.read_shift(2),a=Kg(t,0,r);return[n,a]}function OTe(t,e,r,n){var a=r&&r.biff==5;n||(n=ur(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var DTe=Kg;function XH(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,s=t.read_shift(a),o=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:l},e:{r:o,c}}}function RTe(t,e){var r=e.biff==8||!e.biff?4:2,n=ur(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function MTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=bae(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function LTe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(bae(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function UTe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function QTe(t,e,r,n){var a={},s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=b5e[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function VTe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=QTe(t,e,n.fStyle,r),n}function YH(t,e,r,n){var a=r&&r.biff==5;n||(n=ur(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function HTe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function $Te(t){var e=ur(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function JH(t,e,r){var n=yh(t);(r.biff==2||e==9)&&++t.l;var a=q5e(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function GTe(t,e,r,n,a,s){var o=ur(8);return bg(t,e,n,o),gae(r,s,o),o}function KTe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=yh(t),a=sc(t);return n.val=a,n}function qTe(t,e,r,n){var a=ur(14);return bg(t,e,n,a),vg(r,a),a}var ZH=nTe;function zTe(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=yg(t,s),l=[];n>t.l;)l.push(Hw(t));return[s,a,o,l]}function e$(t,e,r){var n=t.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=sTe(t,e-2,r)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var WTe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function t$(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=yg(t,o,r);a&32&&(u=WTe[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var f=n==t.l||l===0||!(d>0)?[]:uDe(t,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function _ae(t,e,r){if(r.biff<8)return XTe(t,e,r);for(var n=[],a=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(aTe(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function XTe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Vw(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function YTe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),s=yg(t,n,r),o=yg(t,a,r);return[s,o]}function JTe(t,e,r){var n=Nae(t);t.l++;var a=t.read_shift(1);return e-=8,[dDe(t,e,r),a,n]}function r$(t,e,r){var n=iTe(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,lDe(t,e,r)]}function ZTe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function eBe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=Kg(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},l,o,s]}}function tBe(t,e,r){return eBe(t,e,r)}function rBe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(AP(t));return r}function nBe(t){var e=ur(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)wae(t[r],e);return e}function aBe(t,e,r){if(r&&r.biff<8)return iBe(t,e,r);var n=Cae(t),a=uTe(t,e-22,n[1]);return{cmo:n,ft:a}}var sBe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function iBe(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((sBe[n]||dc)(t,e,r)),{cmo:[a,n,s],ft:o}}function oBe(t,e,r){var n=t.l,a="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=X5e(t,6,r);var l=t.read_shift(2);t.read_shift(2),so(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],f=yg(t,t.lens[u+1]-t.lens[u]-1);if(a+=f,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function lBe(t,e){var r=AP(t);t.l+=16;var n=eTe(t,e-24);return[r,n]}function cBe(t){var e=ur(24),r=di(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return Zo([e,tTe(t[1])])}function uBe(t,e){t.read_shift(2);var r=AP(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(kc,""),[r,n]}function dBe(t){var e=t[1].Tooltip,r=ur(10+2*(e.length+1));r.write_shift(2,2048);var n=di(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function fBe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=UH[r]||r,r=t.read_shift(2),e[1]=UH[r]||r,e}function hBe(t){return t||(t=ur(4)),t.write_shift(2,1),t.write_shift(2,1),t}function ABe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(yae(t));return r}function mBe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(yae(t));return r}function pBe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Eae(t,e,r){if(!r.cellStyles)return dc(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function gBe(t,e){var r=ur(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function xBe(t,e){var r={};return e<32||(t.l+=16,r.header=sc(t),r.footer=sc(t),t.l+=2),r}function vBe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function yBe(t){for(var e=ur(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var bBe=yh,wBe=pae,NBe=Hw;function CBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function _Be(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=yh(t);++t.l;var a=Kg(t,e-7,r);return n.t="str",n.val=a,n}function EBe(t){var e=yh(t);++t.l;var r=sc(t);return e.t="n",e.val=r,e}function SBe(t,e,r){var n=ur(15);return qw(n,t,e),n.write_shift(8,r,"f"),n}function jBe(t){var e=yh(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function IBe(t,e,r){var n=ur(9);return qw(n,t,e),n.write_shift(2,r),n}function PBe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function TBe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function BBe(t,e,r){var n=t.l+e,a=yh(t),s=t.read_shift(2),o=yg(t,s,r);return t.l=n,a.t="str",a.val=o,a}var kBe=[2,3,48,49,131,139,140,245],sF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=dP({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Pm(1);switch(c.type){case"base64":d=Tu($u(l));break;case"binary":d=Tu(l);break;case"buffer":case"array":d=l;break}Sl(d,0);var f=d.read_shift(1),A=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,A=!0;break;case 49:h=!0,A=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=d.read_shift(2));var v=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=t[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var b=[],w={},I=Math.min(d.length,f==2?521:x-10-(h?264:0)),j=m?32:11;d.l<I&&d[d.l]!=13;)switch(w={},w.name=k2.utils.decode(y,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,w.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),f==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&b.push(w),f!=2&&(d.l+=m?13:14),w.type){case"B":(!h||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var C=0,S=0;for(u[0]=[],S=0;S!=b.length;++S)u[0][S]=b[S].name;for(;p-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++C]=[],S=0,S=0;S!=b.length;++S){var E=d.slice(d.l,d.l+b[S].len);d.l+=b[S].len,Sl(E,0);var B=k2.utils.decode(y,E);switch(b[S].type){case"C":B.trim().length&&(u[C][S]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[C][S]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[C][S]=B;break;case"F":u[C][S]=parseFloat(B.trim());break;case"+":case"I":u[C][S]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[C][S]=!0;break;case"N":case"F":u[C][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!A)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[C][S]="##MEMO##"+(m?parseInt(B.trim(),10):E.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[C][S]=+B||0);break;case"@":u[C][S]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[C][S]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[C][S]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[C][S]=-E.read_shift(-8,"f");break;case"B":if(h&&b[S].len==8){u[C][S]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=C1(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{return Gm(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&mf(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=lu(),f=ej(l,{header:1,raw:!0,cellDates:!0}),A=f[0],h=f.slice(1),m=l["!cols"]||[],p=0,x=0,v=0,y=1;for(p=0;p<A.length;++p){if(((m[p]||{}).DBF||{}).name){A[p]=m[p].DBF.name,++v;continue}if(A[p]!=null){if(++v,typeof A[p]=="number"&&(A[p]=A[p].toString(10)),typeof A[p]!="string")throw new Error("DBF Invalid column name "+A[p]+" |"+typeof A[p]+"|");if(A.indexOf(A[p])!==p){for(x=0;x<1024;++x)if(A.indexOf(A[p]+"_"+x)==-1){A[p]+="_"+x;break}}}}var b=ja(l["!ref"]),w=[],I=[],j=[];for(p=0;p<=b.e.c-b.s.c;++p){var C="",S="",E=0,B=[];for(x=0;x<h.length;++x)h[x][p]!=null&&B.push(h[x][p]);if(B.length==0||A[p]==null){w[p]="?";continue}for(x=0;x<B.length;++x){switch(typeof B[x]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=B[x]instanceof Date?"D":"C";break;default:S="C"}E=Math.max(E,String(B[x]).length),C=C&&C!=S?"C":S}E>250&&(E=250),S=((m[p]||{}).DBF||{}).type,S=="C"&&m[p].DBF.len>E&&(E=m[p].DBF.len),C=="B"&&S=="N"&&(C="N",j[p]=m[p].DBF.dec,E=m[p].DBF.len),I[p]=C=="C"||S=="N"?E:s[C]||0,y+=I[p],w[p]=C}var k=d.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*v),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[mne]||3)<<8),p=0,x=0;p<A.length;++p)if(A[p]!=null){var T=d.next(32),P=(A[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,P,"sbcs"),T.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),T.write_shift(4,x),T.write_shift(1,I[p]||s[w[p]]||0),T.write_shift(1,j[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),x+=I[p]||s[w[p]]||0}var G=d.next(264);for(G.write_shift(4,13),p=0;p<65;++p)G.write_shift(4,0);for(p=0;p<h.length;++p){var ce=d.next(y);for(ce.write_shift(1,0),x=0;x<A.length;++x)if(A[x]!=null)switch(w[x]){case"L":ce.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":ce.write_shift(8,h[p][x]||0,"f");break;case"N":var ue="0";for(typeof h[p][x]=="number"&&(ue=h[p][x].toFixed(j[x]||0)),v=0;v<I[x]-ue.length;++v)ce.write_shift(1,32);ce.write_shift(1,ue,"sbcs");break;case"D":h[p][x]?(ce.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var le=String(h[p][x]!=null?h[p][x]:"").slice(0,I[x]);for(ce.write_shift(1,le,"sbcs"),v=0;v<I[x]-le.length;++v)ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),Sae=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ti(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(A,h){var m=t[h];return typeof m=="number"?hH(m):m},n=function(A,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?A:hH(p)};t["|"]=254;function a(A,h){switch(h.type){case"base64":return s($u(A),h);case"binary":return s(A,h);case"buffer":return s(ra&&Buffer.isBuffer(A)?A.toString("binary"):$m(A),h);case"array":return s(xg(A),h)}throw new Error("Unrecognized type "+h.type)}function s(A,h){var m=A.split(/[\n\r]+/),p=-1,x=-1,v=0,y=0,b=[],w=[],I=null,j={},C=[],S=[],E=[],B=0,k;for(+h.codepage>=0&&mf(+h.codepage);v!==m.length;++v){B=0;var T=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=T.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),G=P[0],ce;if(T.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&w.push(T.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,le=!1,Ae=!1,ae=!1,_e=-1,De=-1;for(y=1;y<P.length;++y)switch(P[y].charAt(0)){case"A":break;case"X":x=parseInt(P[y].slice(1))-1,le=!0;break;case"Y":for(p=parseInt(P[y].slice(1))-1,le||(x=0),k=b.length;k<=p;++k)b[k]=[];break;case"K":ce=P[y].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(yf(ce))?isNaN(Vv(ce).getDate())||(ce=Rs(ce)):(ce=yf(ce),I!==null&&w1(I)&&(ce=hP(ce))),ue=!0;break;case"E":ae=!0;var O=vv(P[y].slice(1),{r:p,c:x});b[p][x]=[b[p][x],O];break;case"S":Ae=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":_e=parseInt(P[y].slice(1))-1;break;case"C":De=parseInt(P[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(ue&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=ce:b[p][x]=ce,I=null),Ae){if(ae)throw new Error("SYLK shared formula cannot have own formula");var H=_e>-1&&b[_e][De];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=Gae(H[1],{r:p-_e,c:x-De})}break;case"F":var K=0;for(y=1;y<P.length;++y)switch(P[y].charAt(0)){case"X":x=parseInt(P[y].slice(1))-1,++K;break;case"Y":for(p=parseInt(P[y].slice(1))-1,k=b.length;k<=p;++k)b[k]=[];break;case"M":B=parseInt(P[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=w[parseInt(P[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=P[y].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)B=parseInt(E[2],10),S[k-1]=B===0?{hidden:!0}:{wch:B},Tm(S[k-1]);break;case"C":x=parseInt(P[y].slice(1))-1,S[x]||(S[x]={});break;case"R":p=parseInt(P[y].slice(1))-1,C[p]||(C[p]={}),B>0?(C[p].hpt=B,C[p].hpx=$v(B)):B===0&&(C[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}K<1&&(I=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return C.length>0&&(j["!rows"]=C),S.length>0&&(j["!cols"]=S),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,j]}function o(A,h){var m=a(A,h),p=m[0],x=m[1],v=C1(p,h);return Ti(x).forEach(function(y){v[y]=x[y]}),v}function l(A,h){return Gm(o(A,h),h)}function c(A,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(A.t){case"n":x+=A.v||0,A.f&&!A.F&&(x+=";E"+jR(A.f,{r:m,c:p}));break;case"b":x+=A.v?"TRUE":"FALSE";break;case"e":x+=A.w||A.v;break;case"d":x+='"'+(A.w||A.v)+'"';break;case"s":x+='"'+A.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(A,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Q2(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=V2(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&A.push(x)})}function d(A,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*H2(m.hpx)+";"),x.length>2&&A.push(x+"R"+(p+1))})}function f(A,h){var m=["ID;PWXL;N;E"],p=[],x=ja(A["!ref"]),v,y=Array.isArray(A),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),A["!cols"]&&u(m,A["!cols"]),A["!rows"]&&d(m,A["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var w=x.s.r;w<=x.e.r;++w)for(var I=x.s.c;I<=x.e.c;++I){var j=On({r:w,c:I});v=y?(A[w]||[])[I]:A[j],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,A,w,I))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),jae=function(){function t(s,o){switch(o.type){case"base64":return e($u(s),o);case"binary":return e(s,o);case"buffer":return e(ra&&Buffer.isBuffer(s)?s.toString("binary"):$m(s),o);case"array":return e(xg(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var A=l[d].trim().split(","),h=A[0],m=A[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(yf(m))?isNaN(Vv(m).getDate())?f[c][u]=m:f[c][u]=Rs(m):f[c][u]=yf(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return C1(t(s,o),o)}function n(s,o){return Gm(r(s,o),o)}var a=function(){var s=function(c,u,d,f,A){c.push(u),c.push(d+","+f),c.push('"'+A.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=ja(c["!ref"]),f,A=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var p=On({r:h,c:m});if(f=A?(c[h]||[])[m]:c[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,x,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Dd(f.z||Fn[14],Do(Rs(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Iae=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,A){for(var h=f.split(`
`),m=-1,p=-1,x=0,v=[];x!==h.length;++x){var y=h[x].trim().split(":");if(y[0]==="cell"){var b=di(y[1]);if(v.length<=b.r)for(m=v.length;m<=b.r;++m)v[m]||(v[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":v[m][p]=t(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],w])}}}return A&&A.sheetRows&&(v=v.slice(0,A.sheetRows)),v}function n(f,A){return C1(r(f,A),A)}function a(f,A){return Gm(n(f,A),A)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var A=[],h=[],m,p="",x=cu(f["!ref"]),v=Array.isArray(f),y=x.s.r;y<=x.e.r;++y)for(var b=x.s.c;b<=x.e.c;++b)if(p=On({r:y,c:b}),m=v?(f[y]||[])[b]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var w=Do(Rs(m.v));h[2]="vtc",h[3]="nd",h[4]=""+w,h[5]=m.w||Dd(m.z||Fn[14],w);break;case"e":continue}A.push(h.join(":"))}return A.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),A.push("valueformat:1:text-wiki"),A.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Hv=function(){function t(d,f,A,h,m){m.raw?f[A][h]=d:d===""||(d==="TRUE"?f[A][h]=!0:d==="FALSE"?f[A][h]=!1:isNaN(yf(d))?isNaN(Vv(d).getDate())?f[A][h]=d:f[A][h]=Rs(d):f[A][h]=yf(d))}function e(d,f){var A=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,x=Math.max(x,v);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,x).trim(),h,y,b,A),b=1;b<=(m[y].length-x)/10+1;++b)t(m[y].slice(x+(b-1)*10,x+b*10).trim(),h,y,b,A)}return A.sheetRows&&(h=h.slice(0,A.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},A=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?A=!A:!A&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function s(d,f){var A=f||{},h="",m=A.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):A&&A.FS?h=A.FS:h=a(d.slice(0,1024));var x=0,v=0,y=0,b=0,w=0,I=h.charCodeAt(0),j=!1,C=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=A.dateNF!=null?v4e(A.dateNF):null;function B(){var k=d.slice(b,w),T={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)T.t="z";else if(A.raw)T.t="s",T.v=k;else if(k.trim().length===0)T.t="s",T.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(T.t="s",T.v=k.slice(2,-1).replace(/""/g,'"')):zFe(k)?(T.t="n",T.f=k.slice(1)):(T.t="s",T.v=k);else if(k=="TRUE")T.t="b",T.v=!0;else if(k=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=yf(k)))T.t="n",A.cellText!==!1&&(T.w=k),T.v=y;else if(!isNaN(Vv(k).getDate())||E&&k.match(E)){T.z=A.dateNF||Fn[14];var P=0;E&&k.match(E)&&(k=y4e(k,A.dateNF,k.match(E)||[]),P=1),A.cellDates?(T.t="d",T.v=Rs(k,P)):(T.t="n",T.v=Do(Rs(k,P))),A.cellText!==!1&&(T.w=Dd(T.z,T.v instanceof Date?Do(T.v):T.v)),A.cellNF||delete T.z}else T.t="s",T.v=k;if(T.t=="z"||(A.dense?(m[x]||(m[x]=[]),m[x][v]=T):m[On({c:v,r:x})]=T),b=w+1,S=d.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<x&&(p.e.r=x),C==I)++v;else if(v=0,++x,A.sheetRows&&A.sheetRows<=x)return!0}e:for(;w<d.length;++w)switch(C=d.charCodeAt(w)){case 34:S===34&&(j=!j);break;case I:case 10:case 13:if(!j&&B())break e;break}return w-b>0&&B(),m["!ref"]=Xn(p),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):C1(e(d,f),f)}function l(d,f){var A="",h=f.type=="string"?[0,0,0,0]:DR(d,f);switch(f.type){case"base64":A=$u(d);break;case"binary":A=d;break;case"buffer":f.codepage==65001?A=d.toString("utf8"):f.codepage&&typeof k2<"u"||(A=ra&&Buffer.isBuffer(d)?d.toString("binary"):$m(d));break;case"array":A=xg(d);break;case"string":A=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?A=us(A.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?A=us(A):f.type=="binary"&&typeof k2<"u",A.slice(0,19)=="socialcalc:version:"?Iae.to_sheet(f.type=="string"?A:us(A),f):o(A,f)}function c(d,f){return Gm(l(d,f),f)}function u(d){for(var f=[],A=ja(d["!ref"]),h,m=Array.isArray(d),p=A.s.r;p<=A.e.r;++p){for(var x=[],v=A.s.c;v<=A.e.c;++v){var y=On({r:p,c:v});if(h=m?(d[p]||[])[v]:d[y],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(NA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(v===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function FBe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=Sae.to_workbook(t,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Hv.to_workbook(t,e)}}var qp=function(){function t(O,H,K){if(O){Sl(O,O.l||0);for(var R=K.Enum||_e;O.l<O.length;){var X=O.read_shift(2),Y=R[X]||R[65535],D=O.read_shift(2),Q=O.l+D,te=Y.f&&Y.f(O,D,K);if(O.l=Q,H(te,Y,X))return}}}function e(O,H){switch(H.type){case"base64":return r(Tu($u(O)),H);case"binary":return r(Tu(O),H);case"buffer":case"array":return r(O,H)}throw"Unsupported type "+H.type}function r(O,H){if(!O)return O;var K=H||{},R=K.dense?[]:{},X="Sheet1",Y="",D=0,Q={},te=[],be=[],U={s:{r:0,c:0},e:{r:0,c:0}},Xe=K.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)K.Enum=_e,t(O,function(je,Se,Ze){switch(Ze){case 0:K.vers=je,je>=4096&&(K.qpro=!0);break;case 6:U=je;break;case 204:je&&(Y=je);break;case 222:Y=je;break;case 15:case 51:K.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:Ze==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=K.dateNF||Fn[14],K.cellDates&&(je[1].t="d",je[1].v=hP(je[1].v))),K.qpro&&je[3]>D&&(R["!ref"]=Xn(U),Q[X]=R,te.push(X),R=K.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},D=je[3],X=Y||"Sheet"+(D+1),Y="");var ut=K.dense?(R[je[0].r]||[])[je[0].c]:R[On(je[0])];if(ut){ut.t=je[1].t,ut.v=je[1].v,je[1].z!=null&&(ut.z=je[1].z),je[1].f!=null&&(ut.f=je[1].f);break}K.dense?(R[je[0].r]||(R[je[0].r]=[]),R[je[0].r][je[0].c]=je[1]):R[On(je[0])]=je[1];break}},K);else if(O[2]==26||O[2]==14)K.Enum=De,O[2]==14&&(K.qpro=!0,O.l=0),t(O,function(je,Se,Ze){switch(Ze){case 204:X=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>D&&(R["!ref"]=Xn(U),Q[X]=R,te.push(X),R=K.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},D=je[3],X="Sheet"+(D+1)),Xe>0&&je[0].r>=Xe)break;K.dense?(R[je[0].r]||(R[je[0].r]=[]),R[je[0].r][je[0].c]=je[1]):R[On(je[0])]=je[1],U.e.c<je[0].c&&(U.e.c=je[0].c),U.e.r<je[0].r&&(U.e.r=je[0].r);break;case 27:je[14e3]&&(be[je[14e3][0]]=je[14e3][1]);break;case 1537:be[je[0]]=je[1],je[0]==D&&(X=je[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(R["!ref"]=Xn(U),Q[Y||X]=R,te.push(Y||X),!be.length)return{SheetNames:te,Sheets:Q};for(var se={},ee=[],Fe=0;Fe<be.length;++Fe)Q[te[Fe]]?(ee.push(be[Fe]||te[Fe]),se[be[Fe]]=Q[be[Fe]]||Q[te[Fe]]):(ee.push(be[Fe]),se[be[Fe]]={"!ref":"A1"});return{SheetNames:ee,Sheets:se}}function n(O,H){var K=H||{};if(+K.codepage>=0&&mf(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var R=lu(),X=ja(O["!ref"]),Y=Array.isArray(O),D=[];Gr(R,0,s(1030)),Gr(R,6,c(X));for(var Q=Math.min(X.e.r,8191),te=X.s.r;te<=Q;++te)for(var be=Wi(te),U=X.s.c;U<=X.e.c;++U){te===X.s.r&&(D[U]=ui(U));var Xe=D[U]+be,se=Y?(O[te]||[])[U]:O[Xe];if(!(!se||se.t=="z"))if(se.t=="n")(se.v|0)==se.v&&se.v>=-32768&&se.v<=32767?Gr(R,13,h(te,U,se.v)):Gr(R,14,p(te,U,se.v));else{var ee=NA(se);Gr(R,15,f(te,U,ee.slice(0,239)))}}return Gr(R,1),R.end()}function a(O,H){var K=H||{};if(+K.codepage>=0&&mf(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var R=lu();Gr(R,0,o(O));for(var X=0,Y=0;X<O.SheetNames.length;++X)(O.Sheets[O.SheetNames[X]]||{})["!ref"]&&Gr(R,27,ae(O.SheetNames[X],Y++));var D=0;for(X=0;X<O.SheetNames.length;++X){var Q=O.Sheets[O.SheetNames[X]];if(!(!Q||!Q["!ref"])){for(var te=ja(Q["!ref"]),be=Array.isArray(Q),U=[],Xe=Math.min(te.e.r,8191),se=te.s.r;se<=Xe;++se)for(var ee=Wi(se),Fe=te.s.c;Fe<=te.e.c;++Fe){se===te.s.r&&(U[Fe]=ui(Fe));var je=U[Fe]+ee,Se=be?(Q[se]||[])[Fe]:Q[je];if(!(!Se||Se.t=="z"))if(Se.t=="n")Gr(R,23,B(se,Fe,D,Se.v));else{var Ze=NA(Se);Gr(R,22,C(se,Fe,D,Ze.slice(0,239)))}}++D}}return Gr(R,1),R.end()}function s(O){var H=ur(2);return H.write_shift(2,O),H}function o(O){var H=ur(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var K=0,R=0,X=0,Y=0;Y<O.SheetNames.length;++Y){var D=O.SheetNames[Y],Q=O.Sheets[D];if(!(!Q||!Q["!ref"])){++X;var te=cu(Q["!ref"]);K<te.e.r&&(K=te.e.r),R<te.e.c&&(R=te.e.c)}}return K>8191&&(K=8191),H.write_shift(2,K),H.write_shift(1,X),H.write_shift(1,R),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(O,H,K){var R={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&K.qpro?(R.s.c=O.read_shift(1),O.l++,R.s.r=O.read_shift(2),R.e.c=O.read_shift(1),O.l++,R.e.r=O.read_shift(2),R):(R.s.c=O.read_shift(2),R.s.r=O.read_shift(2),H==12&&K.qpro&&(O.l+=2),R.e.c=O.read_shift(2),R.e.r=O.read_shift(2),H==12&&K.qpro&&(O.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(O){var H=ur(8);return H.write_shift(2,O.s.c),H.write_shift(2,O.s.r),H.write_shift(2,O.e.c),H.write_shift(2,O.e.r),H}function u(O,H,K){var R=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(R[0].c=O.read_shift(1),R[3]=O.read_shift(1),R[0].r=O.read_shift(2),O.l+=2):(R[2]=O.read_shift(1),R[0].c=O.read_shift(2),R[0].r=O.read_shift(2)),R}function d(O,H,K){var R=O.l+H,X=u(O,H,K);if(X[1].t="s",K.vers==20768){O.l++;var Y=O.read_shift(1);return X[1].v=O.read_shift(Y,"utf8"),X}return K.qpro&&O.l++,X[1].v=O.read_shift(R-O.l,"cstr"),X}function f(O,H,K){var R=ur(7+K.length);R.write_shift(1,255),R.write_shift(2,H),R.write_shift(2,O),R.write_shift(1,39);for(var X=0;X<R.length;++X){var Y=K.charCodeAt(X);R.write_shift(1,Y>=128?95:Y)}return R.write_shift(1,0),R}function A(O,H,K){var R=u(O,H,K);return R[1].v=O.read_shift(2,"i"),R}function h(O,H,K){var R=ur(7);return R.write_shift(1,255),R.write_shift(2,H),R.write_shift(2,O),R.write_shift(2,K,"i"),R}function m(O,H,K){var R=u(O,H,K);return R[1].v=O.read_shift(8,"f"),R}function p(O,H,K){var R=ur(13);return R.write_shift(1,255),R.write_shift(2,H),R.write_shift(2,O),R.write_shift(8,K,"f"),R}function x(O,H,K){var R=O.l+H,X=u(O,H,K);if(X[1].v=O.read_shift(8,"f"),K.qpro)O.l=R;else{var Y=O.read_shift(2);w(O.slice(O.l,O.l+Y),X),O.l+=Y}return X}function v(O,H,K){var R=H&32768;return H&=-32769,H=(R?O:0)+(H>=8192?H-16384:H),(R?"":"$")+(K?ui(H):Wi(H))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(O,H){Sl(O,0);for(var K=[],R=0,X="",Y="",D="",Q="";O.l<O.length;){var te=O[O.l++];switch(te){case 0:K.push(O.read_shift(8,"f"));break;case 1:Y=v(H[0].c,O.read_shift(2),!0),X=v(H[0].r,O.read_shift(2),!1),K.push(Y+X);break;case 2:{var be=v(H[0].c,O.read_shift(2),!0),U=v(H[0].r,O.read_shift(2),!1);Y=v(H[0].c,O.read_shift(2),!0),X=v(H[0].r,O.read_shift(2),!1),K.push(be+U+":"+Y+X)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(O.read_shift(2));break;case 6:{for(var Xe="";te=O[O.l++];)Xe+=String.fromCharCode(te);K.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:Q=K.pop(),D=K.pop(),K.push(["AND","OR"][te-20]+"("+D+","+Q+")");break;default:if(te<32&&b[te])Q=K.pop(),D=K.pop(),K.push(D+b[te]+Q);else if(y[te]){if(R=y[te][1],R==69&&(R=O[O.l++]),R>K.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+K.join("|")+"|");return}var se=K.slice(-R);K.length-=R,K.push(y[te][0]+"("+se.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}K.length==1?H[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function I(O){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=O.read_shift(2),H[3]=O[O.l++],H[0].c=O[O.l++],H}function j(O,H){var K=I(O);return K[1].t="s",K[1].v=O.read_shift(H-4,"cstr"),K}function C(O,H,K,R){var X=ur(6+R.length);X.write_shift(2,O),X.write_shift(1,K),X.write_shift(1,H),X.write_shift(1,39);for(var Y=0;Y<R.length;++Y){var D=R.charCodeAt(Y);X.write_shift(1,D>=128?95:D)}return X.write_shift(1,0),X}function S(O,H){var K=I(O);K[1].v=O.read_shift(2);var R=K[1].v>>1;if(K[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return K[1].v=R,K}function E(O,H){var K=I(O),R=O.read_shift(4),X=O.read_shift(4),Y=O.read_shift(2);if(Y==65535)return R===0&&X===3221225472?(K[1].t="e",K[1].v=15):R===0&&X===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var D=Y&32768;return Y=(Y&32767)-16446,K[1].v=(1-D*2)*(X*Math.pow(2,Y+32)+R*Math.pow(2,Y)),K}function B(O,H,K,R){var X=ur(14);if(X.write_shift(2,O),X.write_shift(1,K),X.write_shift(1,H),R==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var Y=0,D=0,Q=0,te=0;return R<0&&(Y=1,R=-R),D=Math.log2(R)|0,R/=Math.pow(2,D-31),te=R>>>0,te&2147483648||(R/=2,++D,te=R>>>0),R-=te,te|=2147483648,te>>>=0,R*=Math.pow(2,32),Q=R>>>0,X.write_shift(4,Q),X.write_shift(4,te),D+=16383+(Y?32768:0),X.write_shift(2,D),X}function k(O,H){var K=E(O);return O.l+=H-14,K}function T(O,H){var K=I(O),R=O.read_shift(4);return K[1].v=R>>6,K}function P(O,H){var K=I(O),R=O.read_shift(8,"f");return K[1].v=R,K}function G(O,H){var K=P(O);return O.l+=H-10,K}function ce(O,H){return O[O.l+H-1]==0?O.read_shift(H,"cstr"):""}function ue(O,H){var K=O[O.l++];K>H-1&&(K=H-1);for(var R="";R.length<K;)R+=String.fromCharCode(O[O.l++]);return R}function le(O,H,K){if(!(!K.qpro||H<21)){var R=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var X=O.read_shift(H-21,"cstr");return[R,X]}}function Ae(O,H){for(var K={},R=O.l+H;O.l<R;){var X=O.read_shift(2);if(X==14e3){for(K[X]=[0,""],K[X][0]=O.read_shift(2);O[O.l];)K[X][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return K}function ae(O,H){var K=ur(5+O.length);K.write_shift(2,14e3),K.write_shift(2,H);for(var R=0;R<O.length;++R){var X=O.charCodeAt(R);K[K.l++]=X>127?95:X}return K[K.l++]=0,K}var _e={0:{n:"BOF",f:so},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},De={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function OBe(t){var e={},r=t.match(fc),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Dn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Z6[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var DBe=function(){var t=D2("t"),e=D2("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:Sa(o[1])},c=s.match(e);return c&&(l.s=OBe(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),RBe=function(){var e=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),MBe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,LBe=/<(?:\w+:)?r>/,UBe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function NR(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Sa(us(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=us(t),r&&(n.h=cR(n.t))):t.match(LBe)&&(n.r=us(t),n.t=Sa(us((t.replace(UBe,"").match(MBe)||[]).join("").replace(fc,""))),r&&(n.h=RBe(DBe(n.r)))),n):{t:""}}var QBe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,VBe=/<(?:\w+:)?(?:si|sstItem)>/g,HBe=/<\/(?:\w+:)?(?:si|sstItem)>/;function $Be(t,e){var r=[],n="";if(!t)return r;var a=t.match(QBe);if(a){n=a[2].replace(VBe,"").split(HBe);for(var s=0;s!=n.length;++s){var o=NR(n[s].trim(),e);o!=null&&(r[r.length]=o)}a=Dn(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var GBe=/^\s|\s$|[\t\n\r]/;function Pae(t,e){if(!e.bookSST)return"";var r=[Yi];r[r.length]=$r("sst",null,{xmlns:Qg[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(GBe)&&(s+=' xml:space="preserve"'),s+=">"+ns(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function KBe(t){return[t.read_shift(4),t.read_shift(4)]}function qBe(t,e){var r=[],n=!1;return LA(t,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function zBe(t,e){return e||(e=ur(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var WBe=s5e;function XBe(t){var e=lu();Cr(e,159,zBe(t));for(var r=0;r<t.length;++r)Cr(e,19,WBe(t[r]));return Cr(e,160),e.end()}function Tae(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function dA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function YBe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=dA(t,4),e.U=dA(t,4),e.W=dA(t,4),e}function JBe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function ZBe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(JBe(t));return e}function eke(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function tke(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=dA(t,4),e.U=dA(t,4),e.W=dA(t,4),e}function rke(t){var e=tke(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Bae(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function kae(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function nke(t){var e=dA(t);switch(e.Minor){case 2:return[e.Minor,ake(t)];case 3:return[e.Minor,ske()];case 4:return[e.Minor,ike(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function ake(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Bae(t,r),a=kae(t,t.length-t.l);return{t:"Std",h:n,v:a}}function ske(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ike(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(fc,function(s){var o=Dn(s);switch(vh(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function oke(t,e){var r={},n=r.EncryptionVersionInfo=dA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=Bae(t,a),e-=a,r.EncryptionVerifier=kae(t,e),r}function lke(t){var e={},r=e.EncryptionVersionInfo=dA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function CR(t){var e=0,r,n=Tae(t),a=n.length+1,s,o,l,c,u;for(r=Pm(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=e&16384?1:0,c=e<<1&32767,u=l|c,e=u^o;return e^52811}var Fae=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=e[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=Tae(o),c=s(l),u=l.length,d=Pm(16),f=0;f!=16;++f)d[f]=0;var A,h,m;for((u&1)===1&&(A=c>>8,d[u]=a(t[0],A),--u,A=c&255,h=l[l.length-1],d[u]=a(h,A));u>0;)--u,A=c>>8,d[u]=a(l[u],A),--u,A=c&255,d[u]=a(l[u],A);for(u=15,m=15-l.length;m>0;)A=c>>8,d[u]=a(t[m],A),--u,--m,A=c&255,d[u]=a(l[u],A),--u,--m;return d}}(),cke=function(t,e,r,n,a){a||(a=e),n||(n=Fae(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},uke=function(t){var e=0,r=Fae(t);return function(n){var a=cke("",n,e,r);return e=a[1],a[0]}};function dke(t,e,r,n){var a={key:so(t),verificationBytes:so(t)};return r.password&&(a.verifier=CR(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=uke(r.password)),a}function fke(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=lke(t):n.Data=oke(t,e),n}function hke(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?fke(t,e-2,n):dke(t,r.biff>=8?e:e-2,r,n),n}var Oae=function(){function t(a,s){switch(s.type){case"base64":return e($u(a),s);case"binary":return e(a,s);case"buffer":return e(ra&&Buffer.isBuffer(a)?a.toString("binary"):$m(a),s);case"array":return e(xg(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var A=/\\\w+\b/g,h=0,m,p=-1;m=A.exec(d);){switch(m[0]){case"\\cell":var x=d.slice(h,A.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var v={v:x,t:"s"};Array.isArray(l)?l[f][p]=v:l[On({r:f,c:p})]=v}break}h=A.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Xn(u),l}function r(a,s){return Gm(t(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=ja(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=On({r:u,c:d});l=c?(a[u]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(NA(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Ake(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function U2(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function mke(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),s=Math.min(e,r,n),o=a-s;if(o===0)return[0,0,e];var l=0,c=0,u=a+s;switch(c=o/(u>1?2-u:u),a){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,u/2]}function pke(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function JS(t,e){if(e===0)return t;var r=mke(Ake(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),U2(pke(r))}var Dae=6,gke=15,xke=1,ac=Dae;function Q2(t){return Math.floor((t+Math.round(128/ac)/256)*ac)}function V2(t){return Math.floor((t-5)/ac*100+.5)/100}function ZS(t){return Math.round((t*ac+5)/ac*256)/256}function F5(t){return ZS(V2(Q2(t)))}function _R(t){var e=Math.abs(t-F5(t)),r=ac;if(e>.005)for(ac=xke;ac<gke;++ac)Math.abs(t-F5(t))<=e&&(e=Math.abs(t-F5(t)),r=ac);ac=r}function Tm(t){t.width?(t.wpx=Q2(t.width),t.wch=V2(t.wpx),t.MDW=ac):t.wpx?(t.wch=V2(t.wpx),t.width=ZS(t.wch),t.MDW=ac):typeof t.wch=="number"&&(t.width=ZS(t.wch),t.wpx=Q2(t.width),t.MDW=ac),t.customWidth&&delete t.customWidth}var vke=96,Rae=vke;function H2(t){return t*96/Rae}function $v(t){return t*Rae/96}var yke={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function bke(t,e,r,n){e.Borders=[];var a={},s=!1;(t[0].match(fc)||[]).forEach(function(o){var l=Dn(o);switch(vh(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=ks(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=ks(l.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function wke(t,e,r,n){e.Fills=[];var a={},s=!1;(t[0].match(fc)||[]).forEach(function(o){var l=Dn(o);switch(vh(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function Nke(t,e,r,n){e.Fonts=[];var a={},s=!1;(t[0].match(fc)||[]).forEach(function(o){var l=Dn(o);switch(vh(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=us(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?ks(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?ks(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?ks(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?ks(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?ks(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?ks(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?ks(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Z6[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=ks(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Gp[a.color.index];a.color.index==81&&(c=Gp[1]),c||(c=Gp[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=JS(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Cke(t,e,r){e.NumberFmt=[];for(var n=Ti(Fn),a=0;a<n.length;++a)e.NumberFmt[n[a]]=Fn[n[a]];var s=t[0].match(fc);if(s)for(a=0;a<s.length;++a){var o=Dn(s[a]);switch(vh(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Sa(us(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}uA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function _ke(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=$r("numFmt",null,{numFmtId:n,formatCode:ns(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=$r("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var XC=["numFmtId","fillId","fontId","borderId","xfId"],YC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Eke(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(fc)||[]).forEach(function(s){var o=Dn(s),l=0;switch(vh(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<XC.length;++l)n[XC[l]]&&(n[XC[l]]=parseInt(n[XC[l]],10));for(l=0;l<YC.length;++l)n[YC[l]]&&(n[YC[l]]=ks(n[YC[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=ks(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Ske(t){var e=[];return e[e.length]=$r("cellXfs",null),t.forEach(function(r){e[e.length]=$r("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=$r("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var jke=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(e))&&Cke(f,d,u),(f=l.match(a))&&Nke(f,d,c,u),(f=l.match(n))&&wke(f,d,c,u),(f=l.match(s))&&bke(f,d,c,u),(f=l.match(r))&&Eke(f,d,u),d}}();function Mae(t,e){var r=[Yi,$r("styleSheet",null,{xmlns:Qg[0],"xmlns:vt":To.vt})],n;return t.SSF&&(n=_ke(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Ske(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ike(t,e){var r=t.read_shift(2),n=lc(t);return[r,n]}function Pke(t,e,r){r||(r=ur(6+4*e.length)),r.write_shift(2,t),el(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Tke(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=f5e(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=d5e(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=lc(t),n}function Bke(t,e){e||(e=ur(25+4*32)),e.write_shift(2,t.sz*20),h5e(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),WS(t.color,e);var n=0;return n=2,e.write_shift(1,n),el(t.name,e),e.length>e.l?e.slice(0,e.l):e}var kke=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],O5,Fke=dc;function n$(t,e){e||(e=ur(4*3+8*7+16*1)),O5||(O5=dP(kke));var r=O5[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(WS({auto:1},e),WS({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Oke(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function Lae(t,e,r){r||(r=ur(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function by(t,e){return e||(e=ur(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Dke=dc;function Rke(t,e){return e||(e=ur(51)),e.write_shift(1,0),by(null,e),by(null,e),by(null,e),by(null,e),by(null,e),e.length>e.l?e.slice(0,e.l):e}function Mke(t,e){return e||(e=ur(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),zS(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Lke(t,e,r){var n=ur(2052);return n.write_shift(4,t),zS(e,n),zS(r,n),n.length>n.l?n.slice(0,n.l):n}function Uke(t,e,r){var n={};n.NumberFmt=[];for(var a in Fn)n.NumberFmt[a]=Fn[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return LA(t,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],uA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=JS(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Qke(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Cr(t,615,bf(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Cr(t,44,Pke(a,e[a]))}),Cr(t,616))}}function Vke(t){var e=1;Cr(t,611,bf(e)),Cr(t,43,Bke({sz:12,color:{theme:1},name:"Calibri",family:2})),Cr(t,612)}function Hke(t){var e=2;Cr(t,603,bf(e)),Cr(t,45,n$({patternType:"none"})),Cr(t,45,n$({patternType:"gray125"})),Cr(t,604)}function $ke(t){var e=1;Cr(t,613,bf(e)),Cr(t,46,Rke()),Cr(t,614)}function Gke(t){var e=1;Cr(t,626,bf(e)),Cr(t,47,Lae({numFmtId:0},65535)),Cr(t,627)}function Kke(t,e){Cr(t,617,bf(e.length)),e.forEach(function(r){Cr(t,47,Lae(r,0))}),Cr(t,618)}function qke(t){var e=1;Cr(t,619,bf(e)),Cr(t,48,Mke({xfId:0,name:"Normal"})),Cr(t,620)}function zke(t){var e=0;Cr(t,505,bf(e)),Cr(t,506)}function Wke(t){var e=0;Cr(t,508,Lke(e,"TableStyleMedium9","PivotStyleMedium4")),Cr(t,509)}function Xke(t,e){var r=lu();return Cr(r,278),Qke(r,t.SSF),Vke(r),Hke(r),$ke(r),Gke(r),Kke(r,e.cellXfs),qke(r),zke(r),Wke(r),Cr(r,279),r.end()}var Yke=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Jke(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(fc)||[]).forEach(function(a){var s=Dn(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Yke.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Zke(){}function eFe(){}var tFe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,rFe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,nFe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function aFe(t,e,r){e.themeElements={};var n;[["clrScheme",tFe,Jke],["fontScheme",rFe,Zke],["fmtScheme",nFe,eFe]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var sFe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Uae(t,e){(!t||t.length===0)&&(t=ER());var r,n={};if(!(r=t.match(sFe)))throw new Error("themeElements not found in theme");return aFe(r[0],n,e),n.raw=t,n}function ER(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Yi];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function iFe(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=Bne(s,{type:"array"})}catch{return}var l=Bu(o,"theme/theme/theme1.xml",!0);if(l)return Uae(l,r)}}function oFe(t){return t.read_shift(4)}function lFe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=cFe(t,4);break;case 2:e.xclrValue=vae(t);break;case 3:e.xclrValue=oFe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function cFe(t,e){return dc(t,e)}function uFe(t,e){return dc(t,e)}function dFe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=lFe(t);break;case 6:n[1]=uFe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function fFe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(dFe(t,r-t.l));return{ixfe:n,ext:s}}function hFe(t,e){e.forEach(function(r){switch(r[0]){}})}function AFe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:lc(t)}}function mFe(t){var e=ur(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),el(t.name,e),e.slice(0,e.l)}function pFe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function gFe(t){var e=ur(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function xFe(t,e){var r=ur(8+2*e.length);return r.write_shift(4,t),el(e,r),r.slice(0,r.l)}function vFe(t){return t.l+=4,t.read_shift(4)!=0}function yFe(t,e){var r=ur(8);return r.write_shift(4,t),r.write_shift(4,1),r}function bFe(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return LA(t,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function wFe(){var t=lu();return Cr(t,332),Cr(t,334,bf(1)),Cr(t,335,mFe({name:"XLDAPR",version:12e4,flags:3496657072})),Cr(t,336),Cr(t,339,xFe(1,"XLDAPR")),Cr(t,52),Cr(t,35,bf(514)),Cr(t,4096,bf(0)),Cr(t,4097,xd(1)),Cr(t,36),Cr(t,53),Cr(t,340),Cr(t,337,yFe(1)),Cr(t,51,gFe([[1,0]])),Cr(t,338),Cr(t,333),t.end()}function NFe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,s=2,o;return t.replace(fc,function(l){var c=Dn(l);switch(vh(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function Qae(){var t=[Yi];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function CFe(t){var e=[];if(!t)return e;var r=1;return(t.match(fc)||[]).forEach(function(n){var a=Dn(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function _Fe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=On(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function EFe(t,e,r){var n=[];return LA(t,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function SFe(t,e,r,n){if(!t)return t;var a=n||{},s=!1;LA(t,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function jFe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Yx=1024;function Vae(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[$r("xml",null,{"xmlns:v":Iu.v,"xmlns:o":Iu.o,"xmlns:x":Iu.x,"xmlns:mv":Iu.mv}).replace(/\/>/,">"),$r("o:shapelayout",$r("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),$r("v:shapetype",[$r("v:stroke",null,{joinstyle:"miter"}),$r("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Yx<t*1e3;)Yx+=1e3;return e.forEach(function(s){var o=di(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?$r("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=$r("v:fill",c,l),d={on:"t",obscured:"t"};++Yx,a=a.concat(["<v:shape"+R2({id:"_x0000_s"+Yx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,$r("v:shadow",null,d),$r("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Il("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Il("x:AutoFill","False"),Il("x:Row",String(o.r)),Il("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function a$(t,e,r,n){var a=Array.isArray(t),s;e.forEach(function(o){var l=di(o.ref);if(a?(t[l.r]||(t[l.r]=[]),s=t[l.r][l.c]):s=t[o.ref],!s){s={t:"z"},a?t[l.r][l.c]=s:t[o.ref]=s;var c=ja(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Xn(c);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function IFe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Dn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=di(c.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),A=!!f&&!!f[1]&&NR(f[1])||{r:"",t:"",h:""};u.r=A.r,A.r=="<t></t>"&&(A.t=A.h=""),u.t=(A.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=A.h),n.push(u)}}}}),n}function Hae(t){var e=[Yi,$r("comments",null,{xmlns:Qg[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var s=ns(a.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(ns(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Il("t",ns(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(Il("t",ns(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function PFe(t,e){var r=[],n=!1,a={},s=0;return t.replace(fc,function(l,c){var u=Dn(l);switch(vh(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function TFe(t,e,r){var n=[Yi,$r("ThreadedComments",null,{xmlns:To.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push($r("threadedComment",Il("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function BFe(t,e){var r=[],n=!1;return t.replace(fc,function(s){var o=Dn(s);switch(vh(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function kFe(t){var e=[Yi,$r("personList",null,{xmlns:To.TCMNT,"xmlns:x":Qg[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push($r("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function FFe(t){var e={};e.iauthor=t.read_shift(4);var r=Gg(t);return e.rfx=r.s,e.ref=On(r.s),t.l+=16,e}function OFe(t,e){return e==null&&(e=ur(36)),e.write_shift(4,t[1].iauthor),_1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var DFe=lc;function RFe(t){return el(t.slice(0,54))}function MFe(t,e){var r=[],n=[],a={},s=!1;return LA(t,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function LFe(t){var e=lu(),r=[];return Cr(e,628),Cr(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Cr(e,632,RFe(a.a)))})}),Cr(e,631),Cr(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:di(n[0]),e:di(n[0])};Cr(e,635,OFe([s,a])),a.t&&a.t.length>0&&Cr(e,637,o5e(a)),Cr(e,636),delete a.iauthor})}),Cr(e,634),Cr(e,629),e.end()}var UFe="application/vnd.ms-office.vbaProject";function QFe(t){var e=_n.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_n.utils.cfb_add(e,a,t.FileIndex[n].content)}}),_n.write(e)}function VFe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&_n.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var $ae=["xlsb","xlsm","xlam","biff8","xla"];function HFe(){return{"!type":"dialog"}}function $Fe(){return{"!type":"dialog"}}function GFe(){return{"!type":"macro"}}function KFe(){return{"!type":"macro"}}var vv=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=e.c:--d,c?u+=e.r:--u,a+(l?"":"$")+ui(d)+(c?"":"$")+Wi(u)}return function(a,s){return e=s,a.replace(t,r)}}(),SR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,jR=function(){return function(e,r){return e.replace(SR,function(n,a,s,o,l,c){var u=AR(o)-(s?0:r.c),d=hR(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",A=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+A})}}();function Gae(t,e){return t.replace(SR,function(r,n,a,s,o,l){return n+(a=="$"?a+s:ui(AR(s)+e.c))+(o=="$"?o+l:Wi(hR(l)+e.r))})}function qFe(t,e,r){var n=cu(e),a=n.s,s=di(r),o={r:s.r-a.r,c:s.c-a.c};return Gae(t,o)}function zFe(t){return t.length!=1}function s$(t){return t.replace(/_xlfn\./g,"")}function to(t){t.l+=1}function Bm(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Kae(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return qae(t);r.biff==12&&(n=4)}var a=t.read_shift(n),s=t.read_shift(n),o=Bm(t),l=Bm(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function qae(t){var e=Bm(t),r=Bm(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function WFe(t,e,r){if(r.biff<8)return qae(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),s=Bm(t),o=Bm(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function zae(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return XFe(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Bm(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function XFe(t){var e=Bm(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function YFe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function JFe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ZFe(t);var a=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function ZFe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function eOe(t,e,r){var n=(t[t.l++]&96)>>5,a=Kae(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function tOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Kae(t,s,r);return[n,a,o]}function rOe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function nOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,a]}function aOe(t,e,r){var n=(t[t.l++]&96)>>5,a=WFe(t,e-1,r);return[n,a]}function sOe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function i$(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function iOe(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function oOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function lOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function cOe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function uOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Wae(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function dOe(t){return t.read_shift(2),Wae(t)}function fOe(t){return t.read_shift(2),Wae(t)}function hOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=zae(t,0,r);return[n,a]}function AOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=JFe(t,0,r);return[n,a]}function mOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=zae(t,0,r);return[n,a,s]}function pOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[vDe[a],Jae[a],n]}function gOe(t,e,r){var n=t[t.l++],a=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:xOe(t);return[a,(s[0]===0?Jae:xDe)[s[1]]]}function xOe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function vOe(t,e,r){t.l+=r&&r.biff==2?3:4}function yOe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function bOe(t){return t.l++,UA[t.read_shift(1)]}function wOe(t){return t.l++,t.read_shift(2)}function NOe(t){return t.l++,t.read_shift(1)!==0}function COe(t){return t.l++,sc(t)}function _Oe(t,e,r){return t.l++,Vw(t,e-1,r)}function EOe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Li(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=UA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=sc(t);break;case 2:r[1]=Kg(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function SOe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Gg:AP)(t));return a}function jOe(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=EOe(t,r.biff);return o}function IOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function POe(t,e,r){if(r.biff==5)return TOe(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[n,a,s]}function TOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function BOe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function kOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function FOe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function OOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,a]}var DOe=dc,ROe=dc,MOe=dc;function $w(t,e,r){return t.l+=2,[YFe(t)]}function IR(t){return t.l+=6,[]}var LOe=$w,UOe=IR,QOe=IR,VOe=$w;function Xae(t){return t.l+=2,[so(t),t.read_shift(2)&1]}var HOe=$w,$Oe=Xae,GOe=IR,KOe=$w,qOe=$w,zOe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WOe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),o=zOe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:s}}function XOe(t){return t.l+=2,[t.read_shift(4)]}function YOe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function JOe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function eDe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function tDe(t){return t.l+=4,[0,0]}var o$={1:{n:"PtgExp",f:yOe},2:{n:"PtgTbl",f:MOe},3:{n:"PtgAdd",f:to},4:{n:"PtgSub",f:to},5:{n:"PtgMul",f:to},6:{n:"PtgDiv",f:to},7:{n:"PtgPower",f:to},8:{n:"PtgConcat",f:to},9:{n:"PtgLt",f:to},10:{n:"PtgLe",f:to},11:{n:"PtgEq",f:to},12:{n:"PtgGe",f:to},13:{n:"PtgGt",f:to},14:{n:"PtgNe",f:to},15:{n:"PtgIsect",f:to},16:{n:"PtgUnion",f:to},17:{n:"PtgRange",f:to},18:{n:"PtgUplus",f:to},19:{n:"PtgUminus",f:to},20:{n:"PtgPercent",f:to},21:{n:"PtgParen",f:to},22:{n:"PtgMissArg",f:to},23:{n:"PtgStr",f:_Oe},26:{n:"PtgSheet",f:YOe},27:{n:"PtgEndSheet",f:JOe},28:{n:"PtgErr",f:bOe},29:{n:"PtgBool",f:NOe},30:{n:"PtgInt",f:wOe},31:{n:"PtgNum",f:COe},32:{n:"PtgArray",f:sOe},33:{n:"PtgFunc",f:pOe},34:{n:"PtgFuncVar",f:gOe},35:{n:"PtgName",f:IOe},36:{n:"PtgRef",f:hOe},37:{n:"PtgArea",f:eOe},38:{n:"PtgMemArea",f:BOe},39:{n:"PtgMemErr",f:DOe},40:{n:"PtgMemNoMem",f:ROe},41:{n:"PtgMemFunc",f:kOe},42:{n:"PtgRefErr",f:FOe},43:{n:"PtgAreaErr",f:rOe},44:{n:"PtgRefN",f:AOe},45:{n:"PtgAreaN",f:aOe},46:{n:"PtgMemAreaN",f:ZOe},47:{n:"PtgMemNoMemN",f:eDe},57:{n:"PtgNameX",f:POe},58:{n:"PtgRef3d",f:mOe},59:{n:"PtgArea3d",f:tOe},60:{n:"PtgRefErr3d",f:OOe},61:{n:"PtgAreaErr3d",f:nOe},255:{}},rDe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},nDe={1:{n:"PtgElfLel",f:Xae},2:{n:"PtgElfRw",f:KOe},3:{n:"PtgElfCol",f:LOe},6:{n:"PtgElfRwV",f:qOe},7:{n:"PtgElfColV",f:VOe},10:{n:"PtgElfRadical",f:HOe},11:{n:"PtgElfRadicalS",f:GOe},13:{n:"PtgElfColS",f:UOe},15:{n:"PtgElfColSV",f:QOe},16:{n:"PtgElfRadicalLel",f:$Oe},25:{n:"PtgList",f:WOe},29:{n:"PtgSxName",f:XOe},255:{}},aDe={0:{n:"PtgAttrNoop",f:tDe},1:{n:"PtgAttrSemi",f:uOe},2:{n:"PtgAttrIf",f:lOe},4:{n:"PtgAttrChoose",f:iOe},8:{n:"PtgAttrGoto",f:oOe},16:{n:"PtgAttrSum",f:vOe},32:{n:"PtgAttrBaxcel",f:i$},33:{n:"PtgAttrBaxcel",f:i$},64:{n:"PtgAttrSpace",f:dOe},65:{n:"PtgAttrSpaceSemi",f:fOe},128:{n:"PtgAttrIfError",f:cOe},255:{}};function Gw(t,e,r,n){if(n.biff<8)return dc(t,e);for(var a=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=jOe(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=SOe(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&s.push(dc(t,e)),s}function Kw(t,e,r){for(var n=t.l+e,a,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],a=o$[s]||o$[rDe[s]],(s===24||s===25)&&(a=(s===24?nDe:aDe)[t[t.l+1]]),!a||!a.f?dc(t,e):o.push([a.n,a.f(t,e,r)]);return o}function sDe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var iDe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function oDe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Yae(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function l$(t,e,r){var n=Yae(t,e,r);return n=="#REF"?n:oDe(n,r)}function rc(t,e,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,A=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",v=0,y=t[0].length;v<y;++v){var b=t[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=Si(" ",t[0][p][1][1]);break;case 1:x=Si("\r",t[0][p][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+x,p=-1}l.push(u+iDe[b[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Rb(b[1][1],o,a),l.push(Mb(d,s));break;case"PtgRefN":d=r?Rb(b[1][1],r,a):b[1][1],l.push(Mb(d,s));break;case"PtgRef3d":f=b[1][1],d=Rb(b[1][2],o,a),m=l$(n,f,a),l.push(m+"!"+Mb(d,s));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],I=b[1][1];w||(w=0),w&=127;var j=w==0?[]:l.slice(-w);l.length-=w,I==="User"&&(I=j.shift()),l.push(I+"("+j.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=RH(b[1][1],r?{s:r}:o,a),l.push(T5(h,a));break;case"PtgArea":h=RH(b[1][1],o,a),l.push(T5(h,a));break;case"PtgArea3d":f=b[1][1],h=b[1][2],m=l$(n,f,a),l.push(m+"!"+T5(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":A=b[1][2];var C=(n.names||[])[A-1]||(n[0]||[])[A],S=C?C.Name:"SH33TJSNAME"+String(A);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var E=b[1][1];A=b[1][2];var B;if(a.biff<=5)E<0&&(E=-E),n[E]&&(B=n[E][A]);else{var k="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][A]&&n[E][A].itab>0&&(k=n.SheetNames[n[E][A].itab-1]+"!"):k=n.SheetNames[A-1]+"!"),n[E]&&n[E][A])k+=n[E][A].Name;else if(n[0]&&n[0][A])k+=n[0][A].Name;else{var T=(Yae(n,E,a)||"").split(";;");T[A-1]?k=T[A-1]:k+="SH33TJSERRX"}l.push(k);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var P="(",G=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:P=Si(" ",t[0][p][1][1])+P;break;case 3:P=Si("\r",t[0][p][1][1])+P;break;case 4:G=Si(" ",t[0][p][1][1])+G;break;case 5:G=Si("\r",t[0][p][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(P+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var ce={c:r.c,r:r.r};if(n.sharedf[On(d)]){var ue=n.sharedf[On(d)];l.push(rc(ue,o,ce,n,a))}else{var le=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(rc(u[1],o,ce,n,a)),le=!0;break}le||l.push(b[1])}break;case"PtgArray":l.push("{"+sDe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var Ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&Ae.indexOf(t[0][v][0])==-1){b=t[0][p];var ae=!0;switch(b[1][0]){case 4:ae=!1;case 0:x=Si(" ",b[1][1]);break;case 5:ae=!1;case 1:x=Si("\r",b[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((ae?x:"")+l.pop()+(ae?"":x)),p=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function lDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],dc(t,e-2)];var l=Kw(t,o,r);return e!==o+a&&(s=Gw(t,e-o-a,l,r)),t.l=n,[l,s]}function cDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],dc(t,e-2)];var l=Kw(t,o,r);return e!==o+a&&(s=Gw(t,e-o-a,l,r)),t.l=n,[l,s]}function uDe(t,e,r,n){var a=t.l+e,s=Kw(t,n,r),o;return a!==t.l&&(o=Gw(t,a-t.l,s,r)),[s,o]}function dDe(t,e,r){var n=t.l+e,a,s=t.read_shift(2),o=Kw(t,s,r);return s==65535?[[],dc(t,e-2)]:(e!==s+2&&(a=Gw(t,n-s-2,o,r)),[o,a])}function fDe(t){var e;if(Zh(t,t.l+6)!==65535)return[sc(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function hDe(t){if(t==null){var e=ur(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return vg(t);return vg(0)}function D5(t,e,r){var n=t.l+e,a=yh(t);r.biff==2&&++t.l;var s=fDe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=cDe(t,n-t.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function ADe(t,e,r,n,a){var s=bg(e,r,a),o=hDe(t.v),l=ur(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=ur(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var f=Zo([s,o,l,u]);return f}function mP(t,e,r){var n=t.read_shift(4),a=Kw(t,n,r),s=t.read_shift(4),o=s>0?Gw(t,s,a,r):null;return[a,o]}var mDe=mP,pP=mP,pDe=mP,gDe=mP,xDe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Jae={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vDe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function c$(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function yDe(t){var e="of:="+t.replace(SR,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function R5(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function bDe(t){return t.replace(/\./,"!")}var Ub={},yv={},Qb=typeof Map<"u";function PR(t,e,r){var n=0,a=t.length;if(r){if(Qb?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Qb?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Qb?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function gP(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(ac=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=V2(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ZS(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function zp(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Km(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){uA(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===n)return a;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Zae(t,e,r,n,a,s){try{n.cellNF&&(t.z=Fn[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Rs(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Fn[e]==null&&uA(x4e[e]||"General",e),t.t==="e")t.w=t.w||UA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=O2(t.v);else if(t.t==="d"){var o=Do(t.v);(o|0)===o?t.w=o.toString(10):t.w=O2(o)}else{if(t.v===void 0)return"";t.w=gg(t.v,yv)}else t.t==="d"?t.w=Dd(e,Do(t.v),yv):t.w=Dd(e,t.v,yv)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=JS(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=JS(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function wDe(t,e,r){if(t&&t["!ref"]){var n=ja(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function NDe(t,e){var r=ja(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Xn(r))}var CDe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_De=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,EDe=/<(?:\w:)?hyperlink [^>]*>/mg,SDe=/"(\w*:\w*)"/,jDe=/<(?:\w:)?col\b[^>]*[\/]?>/g,IDe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,PDe=/<(?:\w:)?pageMargins[^>]*\/>/g,ese=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,TDe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,BDe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kDe(t,e,r,n,a,s,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=t.match(_De);f?(u=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):u=d=t;var A=u.match(ese);A?TR(A[0],l,a,r):(A=u.match(TDe))&&ODe(A[0],A[1]||"",l,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(SDe);m&&NDe(l,m[1])}var p=u.match(BDe);p&&p[1]&&zDe(p[1],a);var x=[];if(e.cellStyles){var v=u.match(jDe);v&&HDe(x,v)}f&&YDe(f[1],l,e,c,s,o);var y=d.match(IDe);y&&(l["!autofilter"]=GDe(y[0]));var b=[],w=d.match(CDe);if(w)for(h=0;h!=w.length;++h)b[h]=ja(w[h].slice(w[h].indexOf('"')+1));var I=d.match(EDe);I&&UDe(l,I,n);var j=d.match(PDe);if(j&&(l["!margins"]=QDe(Dn(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Xn(c)),e.sheetRows>0&&l["!ref"]){var C=ja(l["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>c.e.r&&(C.e.r=c.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>c.e.c&&(C.e.c=c.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Xn(C))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function FDe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Xn(t[r])+'"/>';return e+"</mergeCells>"}function TR(t,e,r,n){var a=Dn(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Sa(us(a.codeName)))}function ODe(t,e,r,n,a){TR(t.slice(0,t.indexOf(">")),r,n,a)}function DDe(t,e,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=th(ns(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),l=(l||"")+$r("outlinePr",null,u)}!s&&!l||(a[a.length]=$r("sheetPr",l,o))}var RDe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],MDe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function LDe(t){var e={sheet:1};return RDe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),MDe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=CR(t.password).toString(16).toUpperCase()),$r("sheetProtection",null,e)}function UDe(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var s=Dn(us(e[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Sa(s.location))):(s.Target="#"+Sa(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=ja(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=On({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function QDe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function VDe(t){return zp(t),$r("pageMargins",null,t)}function HDe(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=Dn(e[n],!0);a.hidden&&(a.hidden=ks(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,_R(a.width)),Tm(a);s<=o;)t[s++]=Ms(a)}}function $De(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=$r("col",null,gP(a,n)));return r[r.length]="</cols>",r.join("")}function GDe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function KDe(t,e,r,n){var a=typeof t.ref=="string"?t.ref:Xn(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=cu(a);o.s.r==o.e.r&&(o.e.r=cu(e["!ref"]).e.r,a=Xn(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),$r("autoFilter",null,{ref:a})}var qDe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function zDe(t,e){e.Views||(e.Views=[{}]),(t.match(qDe)||[]).forEach(function(r,n){var a=Dn(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),ks(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function WDe(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),$r("sheetViews",$r("sheetView",null,a),{})}function XDe(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=UA[t.v];break;case"d":n&&n.cellDates?a=Rs(t.v,-1).toISOString():(t=Ms(t),t.t="n",a=""+(t.v=Do(Rs(t.v)))),typeof t.z>"u"&&(t.z=Fn[14]);break;default:a=t.v;break}var l=Il("v",ns(a)),c={r:e},u=Km(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Il("v",""+PR(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=$r("f",ns(t.f),d)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),$r("c",l,c)}var YDe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=D2("v"),o=D2("f");return function(c,u,d,f,A,h){for(var m=0,p="",x=[],v=[],y=0,b=0,w=0,I="",j,C,S=0,E=0,B,k,T=0,P=0,G=Array.isArray(h.CellXf),ce,ue=[],le=[],Ae=Array.isArray(u),ae=[],_e={},De=!1,O=!!d.sheetStubs,H=c.split(e),K=0,R=H.length;K!=R;++K){p=H[K].trim();var X=p.length;if(X!==0){var Y=0;e:for(m=0;m<X;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(C=Dn(p.slice(Y,m),!0),S=C.r!=null?parseInt(C.r,10):S+1,E=-1,d.sheetRows&&d.sheetRows<S)continue;_e={},De=!1,C.ht&&(De=!0,_e.hpt=parseFloat(C.ht),_e.hpx=$v(_e.hpt)),C.hidden=="1"&&(De=!0,_e.hidden=!0),C.outlineLevel!=null&&(De=!0,_e.level=+C.outlineLevel),De&&(ae[S-1]=_e)}break;case"<":Y=m;break}if(Y>=m)break;if(C=Dn(p.slice(Y,m),!0),S=C.r!=null?parseInt(C.r,10):S+1,E=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(_e={},De=!1,C.ht&&(De=!0,_e.hpt=parseFloat(C.ht),_e.hpx=$v(_e.hpt)),C.hidden=="1"&&(De=!0,_e.hidden=!0),C.outlineLevel!=null&&(De=!0,_e.level=+C.outlineLevel),De&&(ae[S-1]=_e)),x=p.slice(m).split(t);for(var D=0;D!=x.length&&x[D].trim().charAt(0)=="<";++D);for(x=x.slice(D),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(v=p.match(r),y=m,b=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,I=v[1],b=0;b!=I.length&&!((w=I.charCodeAt(b)-64)<1||w>26);++b)y=26*y+w;--y,E=y}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,C=Dn(p.slice(0,b),!0),C.r||(C.r=On({r:S-1,c:E})),I=p.slice(b),j={t:""},(v=I.match(s))!=null&&v[1]!==""&&(j.v=Sa(v[1])),d.cellFormula){if((v=I.match(o))!=null&&v[1]!==""){if(j.f=Sa(us(v[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=s$(j.f)),v[0].indexOf('t="array"')>-1)j.F=(I.match(a)||[])[1],j.F.indexOf(":")>-1&&ue.push([ja(j.F),j.F]);else if(v[0].indexOf('t="shared"')>-1){k=Dn(v[0]);var Q=Sa(us(v[1]));d.xlfn||(Q=s$(Q)),le[parseInt(k.si,10)]=[k,Q,C.r]}}else(v=I.match(/<f[^>]*\/>/))&&(k=Dn(v[0]),le[k.si]&&(j.f=qFe(le[k.si][1],le[k.si][2],C.r)));var te=di(C.r);for(b=0;b<ue.length;++b)te.r>=ue[b][0].s.r&&te.r<=ue[b][0].e.r&&te.c>=ue[b][0].s.c&&te.c<=ue[b][0].e.c&&(j.F=ue[b][1])}if(C.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(O)j.t="z";else continue;else j.t=C.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),j.t){case"n":if(j.v==""||j.v==null){if(!O)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!O)continue;j.t="z"}else B=Ub[parseInt(j.v,10)],j.v=B.t,j.r=B.r,d.cellHTML&&(j.h=B.h);break;case"str":j.t="s",j.v=j.v!=null?us(j.v):"",d.cellHTML&&(j.h=cR(j.v));break;case"inlineStr":v=I.match(n),j.t="s",v!=null&&(B=NR(v[1]))?(j.v=B.t,d.cellHTML&&(j.h=B.h)):j.v="";break;case"b":j.v=ks(j.v);break;case"d":d.cellDates?j.v=Rs(j.v,1):(j.v=Do(Rs(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=rae[j.v];break}if(T=P=0,ce=null,G&&C.s!==void 0&&(ce=h.CellXf[C.s],ce!=null&&(ce.numFmtId!=null&&(T=ce.numFmtId),d.cellStyles&&ce.fillId!=null&&(P=ce.fillId))),Zae(j,T,P,d,A,h),d.cellDates&&G&&j.t=="n"&&w1(Fn[T])&&(j.t="d",j.v=hP(j.v)),C.cm&&d.xlmeta){var be=(d.xlmeta.Cell||[])[+C.cm-1];be&&be.type=="XLDAPR"&&(j.D=!0)}if(Ae){var U=di(C.r);u[U.r]||(u[U.r]=[]),u[U.r][U.c]=j}else u[C.r]=j}}}}ae.length>0&&(u["!rows"]=ae)}}();function JDe(t,e,r,n){var a=[],s=[],o=ja(t["!ref"]),l="",c,u="",d=[],f=0,A=0,h=t["!rows"],m=Array.isArray(t),p={r:u},x,v=-1;for(A=o.s.c;A<=o.e.c;++A)d[A]=ui(A);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=Wi(f),A=o.s.c;A<=o.e.c;++A){c=d[A]+u;var y=m?(t[f]||[])[A]:t[c];y!==void 0&&(l=XDe(y,c,t,e))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(p={r:u},h&&h[f]&&(x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=H2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),a[a.length]=$r("row",s.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=H2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level),a[a.length]=$r("row","",p));return a.join("")}function tse(t,e,r,n){var a=[Yi,$r("worksheet",null,{xmlns:Qg[0],"xmlns:r":To.r})],s=r.SheetNames[t],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=ja(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Xn(d)}n||(n={}),c["!comments"]=[];var f=[];DDe(c,r,t,e,a),a[a.length]=$r("dimension",null,{ref:u}),a[a.length]=WDe(c,e,t,r),e.sheetFormat&&(a[a.length]=$r("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=$De(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=JDe(c,e),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=LDe(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=KDe(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=FDe(c["!merges"]));var A=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Za(n,-1,ns(p[1].Target).replace(/#.*$/,""),ia.HLINK),h["r:id"]="rId"+m),(A=p[1].Target.indexOf("#"))>-1&&(h.location=ns(p[1].Target.slice(A+1))),p[1].Tooltip&&(h.tooltip=ns(p[1].Tooltip)),a[a.length]=$r("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=VDe(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Il("ignoredErrors",$r("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Za(n,-1,"../drawings/drawing"+(t+1)+".xml",ia.DRAW),a[a.length]=$r("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Za(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ia.VML),a[a.length]=$r("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function ZDe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function e6e(t,e,r){var n=ur(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;a.hpx?s=H2(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var f=-1,A=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[On(u)];m&&(f<0&&(f=h),A=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,A))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function t6e(t,e,r,n){var a=e6e(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Cr(t,0,a)}var r6e=Gg,n6e=_1;function a6e(){}function s6e(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=l5e(t),r}function i6e(t,e,r){r==null&&(r=ur(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return WS({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Yne(t,r),r.slice(0,r.l)}function o6e(t){var e=Vd(t);return[e]}function l6e(t,e,r){return r==null&&(r=ur(8)),Vg(e,r)}function c6e(t){var e=Hg(t);return[e]}function u6e(t,e,r){return r==null&&(r=ur(4)),$g(e,r)}function d6e(t){var e=Vd(t),r=t.read_shift(1);return[e,r,"b"]}function f6e(t,e,r){return r==null&&(r=ur(9)),Vg(e,r),r.write_shift(1,t.v?1:0),r}function h6e(t){var e=Hg(t),r=t.read_shift(1);return[e,r,"b"]}function A6e(t,e,r){return r==null&&(r=ur(5)),$g(e,r),r.write_shift(1,t.v?1:0),r}function m6e(t){var e=Vd(t),r=t.read_shift(1);return[e,r,"e"]}function p6e(t,e,r){return r==null&&(r=ur(9)),Vg(e,r),r.write_shift(1,t.v),r}function g6e(t){var e=Hg(t),r=t.read_shift(1);return[e,r,"e"]}function x6e(t,e,r){return r==null&&(r=ur(8)),$g(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function v6e(t){var e=Vd(t),r=t.read_shift(4);return[e,r,"s"]}function y6e(t,e,r){return r==null&&(r=ur(12)),Vg(e,r),r.write_shift(4,e.v),r}function b6e(t){var e=Hg(t),r=t.read_shift(4);return[e,r,"s"]}function w6e(t,e,r){return r==null&&(r=ur(8)),$g(e,r),r.write_shift(4,e.v),r}function N6e(t){var e=Vd(t),r=sc(t);return[e,r,"n"]}function C6e(t,e,r){return r==null&&(r=ur(16)),Vg(e,r),vg(t.v,r),r}function rse(t){var e=Hg(t),r=sc(t);return[e,r,"n"]}function _6e(t,e,r){return r==null&&(r=ur(12)),$g(e,r),vg(t.v,r),r}function E6e(t){var e=Vd(t),r=xR(t);return[e,r,"n"]}function S6e(t,e,r){return r==null&&(r=ur(12)),Vg(e,r),Jne(t.v,r),r}function j6e(t){var e=Hg(t),r=xR(t);return[e,r,"n"]}function I6e(t,e,r){return r==null&&(r=ur(8)),$g(e,r),Jne(t.v,r),r}function P6e(t){var e=Vd(t),r=mR(t);return[e,r,"is"]}function T6e(t){var e=Vd(t),r=lc(t);return[e,r,"str"]}function B6e(t,e,r){return r==null&&(r=ur(12+4*t.v.length)),Vg(e,r),el(t.v,r),r.length>r.l?r.slice(0,r.l):r}function k6e(t){var e=Hg(t),r=lc(t);return[e,r,"str"]}function F6e(t,e,r){return r==null&&(r=ur(8+4*t.v.length)),$g(e,r),el(t.v,r),r.length>r.l?r.slice(0,r.l):r}function O6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"b"];if(r.cellFormula){t.l+=2;var l=pP(t,n-t.l,r);o[3]=rc(l,null,a,r.supbooks,r)}else t.l=n;return o}function D6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"e"];if(r.cellFormula){t.l+=2;var l=pP(t,n-t.l,r);o[3]=rc(l,null,a,r.supbooks,r)}else t.l=n;return o}function R6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=sc(t),o=[a,s,"n"];if(r.cellFormula){t.l+=2;var l=pP(t,n-t.l,r);o[3]=rc(l,null,a,r.supbooks,r)}else t.l=n;return o}function M6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=lc(t),o=[a,s,"str"];if(r.cellFormula){t.l+=2;var l=pP(t,n-t.l,r);o[3]=rc(l,null,a,r.supbooks,r)}else t.l=n;return o}var L6e=Gg,U6e=_1;function Q6e(t,e){return e==null&&(e=ur(4)),e.write_shift(4,t),e}function V6e(t,e){var r=t.l+e,n=Gg(t),a=pR(t),s=lc(t),o=lc(t),l=lc(t);t.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function H6e(t,e){var r=ur(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));_1({s:di(t[0]),e:di(t[0])},r),gR("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return el(a||"",r),el(t[1].Tooltip||"",r),el("",r),r.slice(0,r.l)}function $6e(){}function G6e(t,e,r){var n=t.l+e,a=Zne(t),s=t.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=mDe(t,n-t.l,r);o[1]=l}else t.l=n;return o}function K6e(t,e,r){var n=t.l+e,a=Gg(t),s=[a];if(r.cellFormula){var o=gDe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function q6e(t,e,r){r==null&&(r=ur(18));var n=gP(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var nse=["left","right","top","bottom","header","footer"];function z6e(t){var e={};return nse.forEach(function(r){e[r]=sc(t)}),e}function W6e(t,e){return e==null&&(e=ur(6*8)),zp(t),nse.forEach(function(r){vg(t[r],e)}),e}function X6e(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Y6e(t,e,r){r==null&&(r=ur(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function J6e(t){var e=ur(24);return e.write_shift(4,4),e.write_shift(4,1),_1(t,e),e}function Z6e(t,e){return e==null&&(e=ur(16*4+2)),e.write_shift(2,t.password?CR(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function eRe(){}function tRe(){}function rRe(t,e,r,n,a,s,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,A=!1,h,m,p,x,v,y,b,w,I,j=[];l.biff=12,l["!row"]=0;var C=0,S=!1,E=[],B={},k=l.supbooks||a.supbooks||[[]];if(k.sharedf=B,k.arrayf=E,k.SheetNames=a.SheetNames||a.Sheets.map(function(Ae){return Ae.name}),!l.supbooks&&(l.supbooks=k,a.Names))for(var T=0;T<a.Names.length;++T)k[0][T+1]=a.Names[T];var P=[],G=[],ce=!1;$2[16]={n:"BrtShortReal",f:rse};var ue;if(LA(t,function(ae,_e,De){if(!A)switch(De){case 148:u=ae;break;case 0:h=ae,l.sheetRows&&l.sheetRows<=h.r&&(A=!0),w=Wi(x=h.r),l["!row"]=h.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=$v(ae.hpt)),G[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:ae[2]},ae[2]){case"n":m.v=ae[1];break;case"s":b=Ub[ae[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!ae[1];break;case"e":m.v=ae[1],l.cellText!==!1&&(m.w=UA[m.v]);break;case"str":m.t="s",m.v=ae[1];break;case"is":m.t="s",m.v=ae[1].t;break}if((p=o.CellXf[ae[0].iStyleRef])&&Zae(m,p.numFmtId,null,l,s,o),v=ae[0].c==-1?v+1:ae[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[ui(v)+w]=m,l.cellFormula){for(S=!1,C=0;C<E.length;++C){var O=E[C];h.r>=O[0].s.r&&h.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(m.F=Xn(O[0]),S=!0)}!S&&ae.length>3&&(m.f=ae[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),l.cellDates&&p&&m.t=="n"&&w1(Fn[p.numFmtId])){var H=Tp(m.v);H&&(m.t="d",m.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}ue&&(ue.type=="XLDAPR"&&(m.D=!0),ue=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},v=ae[0].c==-1?v+1:ae[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[ui(v)+w]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),ue&&(ue.type=="XLDAPR"&&(m.D=!0),ue=void 0);break;case 176:j.push(ae);break;case 49:ue=((l.xlmeta||{}).Cell||[])[ae-1];break;case 494:var K=n["!id"][ae.relId];for(K?(ae.Target=K.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=K):ae.relId==""&&(ae.Target="#"+ae.loc),x=ae.rfx.s.r;x<=ae.rfx.e.r;++x)for(v=ae.rfx.s.c;v<=ae.rfx.e.c;++v)l.dense?(c[x]||(c[x]=[]),c[x][v]||(c[x][v]={t:"z",v:void 0}),c[x][v].l=ae):(y=On({c:v,r:x}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=ae);break;case 426:if(!l.cellFormula)break;E.push(ae),I=l.dense?c[x][v]:c[ui(v)+w],I.f=rc(ae[1],d,{r:h.r,c:v},k,l),I.F=Xn(ae[0]);break;case 427:if(!l.cellFormula)break;B[On(ae[0].s)]=ae[1],I=l.dense?c[x][v]:c[ui(v)+w],I.f=rc(ae[1],d,{r:h.r,c:v},k,l);break;case 60:if(!l.cellStyles)break;for(;ae.e>=ae.s;)P[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},ce||(ce=!0,_R(ae.w/256)),Tm(P[ae.e+1]);break;case 161:c["!autofilter"]={ref:Xn(ae)};break;case 476:c["!margins"]=ae;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ae.name&&(a.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(c["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!_e.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+De.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Xn(u||d)),l.sheetRows&&c["!ref"]){var le=ja(c["!ref"]);l.sheetRows<=+le.e.r&&(le.e.r=l.sheetRows-1,le.e.r>d.e.r&&(le.e.r=d.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>d.e.c&&(le.e.c=d.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Xn(le))}return j.length>0&&(c["!merges"]=j),P.length>0&&(c["!cols"]=P),G.length>0&&(c["!rows"]=G),c}function nRe(t,e,r,n,a,s,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Ms(e),e.z=e.z||Fn[14],e.v=Do(Rs(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=Km(a.cellXfs,e,a),e.l&&s["!links"].push([On(c),e.l]),e.c&&s["!comments"].push([On(c),e.c]),e.t){case"s":case"str":return a.bookSST?(l=PR(a.Strings,e.v,a.revStrings),c.t="s",c.v=l,o?Cr(t,18,w6e(e,c)):Cr(t,7,y6e(e,c))):(c.t="str",o?Cr(t,17,F6e(e,c)):Cr(t,6,B6e(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Cr(t,13,I6e(e,c)):Cr(t,2,S6e(e,c)):o?Cr(t,16,_6e(e,c)):Cr(t,5,C6e(e,c)),!0;case"b":return c.t="b",o?Cr(t,15,A6e(e,c)):Cr(t,4,f6e(e,c)),!0;case"e":return c.t="e",o?Cr(t,14,x6e(e,c)):Cr(t,3,p6e(e,c)),!0}return o?Cr(t,12,u6e(e,c)):Cr(t,1,l6e(e,c)),!0}function aRe(t,e,r,n){var a=ja(e["!ref"]||"A1"),s,o="",l=[];Cr(t,145);var c=Array.isArray(e),u=a.e.r;e["!rows"]&&(u=Math.max(a.e.r,e["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=Wi(d),t6e(t,e,a,d);var f=!1;if(d<=a.e.r)for(var A=a.s.c;A<=a.e.c;++A){d===a.s.r&&(l[A]=ui(A)),s=l[A]+o;var h=c?(e[d]||[])[A]:e[s];if(!h){f=!1;continue}f=nRe(t,h,d,A,n,e,f)}}Cr(t,146)}function sRe(t,e){!e||!e["!merges"]||(Cr(t,177,Q6e(e["!merges"].length)),e["!merges"].forEach(function(r){Cr(t,176,U6e(r))}),Cr(t,178))}function iRe(t,e){!e||!e["!cols"]||(Cr(t,390),e["!cols"].forEach(function(r,n){r&&Cr(t,60,q6e(n,r))}),Cr(t,391))}function oRe(t,e){!e||!e["!ref"]||(Cr(t,648),Cr(t,649,J6e(ja(e["!ref"]))),Cr(t,650))}function lRe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=Za(r,-1,n[1].Target.replace(/#.*$/,""),ia.HLINK);Cr(t,494,H6e(n,a))}}),delete e["!links"]}function cRe(t,e,r,n){if(e["!comments"].length>0){var a=Za(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ia.VML);Cr(t,551,gR("rId"+a)),e["!legacy"]=a}}function uRe(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:Xn(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=cu(s);l.s.r==l.e.r&&(l.e.r=cu(e["!ref"]).e.r,s=Xn(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Cr(t,161,_1(ja(s))),Cr(t,162)}}function dRe(t,e,r){Cr(t,133),Cr(t,137,Y6e(e,r)),Cr(t,138),Cr(t,134)}function fRe(t,e){e["!protect"]&&Cr(t,535,Z6e(e["!protect"]))}function hRe(t,e,r,n){var a=lu(),s=r.SheetNames[t],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=ja(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Cr(a,129),(r.vbaraw||o["!outline"])&&Cr(a,147,i6e(l,o["!outline"])),Cr(a,148,n6e(c)),dRe(a,o,r.Workbook),iRe(a,o),aRe(a,o,t,e),fRe(a,o),uRe(a,o,r,t),sRe(a,o),lRe(a,o,n),o["!margins"]&&Cr(a,476,W6e(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&oRe(a,o),cRe(a,o,t,n),Cr(a,130),a.end()}function ARe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=Sa((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function mRe(t,e,r,n,a,s){var o=s||{"!type":"chart"};if(!t)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var A=ARe(f);d.s.r=d.s.c=0,d.e.c=l,u=ui(l),A[0].forEach(function(h,m){o[u+Wi(m)]={t:"n",v:h,z:A[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=Xn(d)),o}function pRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(ese);return l&&TR(l[0],s,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function gRe(t,e){t.l+=10;var r=lc(t);return{name:r}}function xRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return LA(t,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var BR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vRe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],yRe=[],bRe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function u$(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ks(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function d$(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ks(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function ase(t){d$(t.WBProps,BR),d$(t.CalcPr,bRe),u$(t.WBView,vRe),u$(t.Sheets,yRe),yv.date1904=ks(t.WBProps.date1904)}function wRe(t){return!t.Workbook||!t.Workbook.WBProps?"false":ks(t.Workbook.WBProps.date1904)?"true":"false"}var NRe="][*?/\\".split("");function sse(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return NRe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function CRe(t,e,r){t.forEach(function(n,a){sse(n);for(var s=0;s<a;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function _Re(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];CRe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)wDe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var ERe=/<\w+:workbook/;function SRe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(t.replace(fc,function(c,u){var d=Dn(c);switch(vh(d[0])){case"<?xml":break;case"<workbook":c.match(ERe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":BR.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=ks(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=us(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Sa(us(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=us(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),ks(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=Sa(us(t.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Qg.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ase(r),r}function ise(t){var e=[Yi];e[e.length]=$r("workbook",null,{xmlns:Qg[0],"xmlns:r":To.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(BR.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=$r("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:ns(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=$r("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=$r("definedName",ns(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function jRe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Zk(t),r.name=lc(t),r}function IRe(t,e){return e||(e=ur(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),gR(t.strRelID,e),el(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function PRe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?lc(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function TRe(t,e){e||(e=ur(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Yne(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function BRe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function kRe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=c5e(t),o=pDe(t,0,r),l=pR(t);t.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function FRe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],$2[16]={n:"BrtFRTArchID$",f:BRe},LA(t,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=rc(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),ase(r),r.Names=s,r.supbooks=o,r}function ORe(t,e){Cr(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Cr(t,156,IRe(a))}Cr(t,144)}function DRe(t,e){e||(e=ur(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return el("SheetJS",e),el(VS.version,e),el(VS.version,e),el("7262",e),e.length>e.l?e.slice(0,e.l):e}function RRe(t,e){e||(e=ur(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function MRe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Cr(t,135),Cr(t,158,RRe(a)),Cr(t,136))}}function LRe(t,e){var r=lu();return Cr(r,131),Cr(r,128,DRe()),Cr(r,153,TRe(t.Workbook&&t.Workbook.WBProps||null)),MRe(r,t),ORe(r,t),Cr(r,132),r.end()}function URe(t,e,r){return e.slice(-4)===".bin"?FRe(t,r):SRe(t,r)}function QRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?rRe(t,n,r,a,s,o,l):kDe(t,n,r,a,s,o,l)}function VRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?xRe(t,n,r,a,s):pRe(t,n,r,a,s)}function HRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?GFe():KFe()}function $Re(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?HFe():$Fe()}function GRe(t,e,r,n){return e.slice(-4)===".bin"?Uke(t,r,n):jke(t,r,n)}function KRe(t,e,r){return Uae(t,r)}function qRe(t,e,r){return e.slice(-4)===".bin"?qBe(t,r):$Be(t,r)}function zRe(t,e,r){return e.slice(-4)===".bin"?MFe(t,r):IFe(t,r)}function WRe(t,e,r){return e.slice(-4)===".bin"?EFe(t):CFe(t)}function XRe(t,e,r,n){return r.slice(-4)===".bin"?SFe(t,e,r,n):void 0}function YRe(t,e,r){return e.slice(-4)===".bin"?bFe(t,e,r):NFe(t,e,r)}function JRe(t,e,r){return(e.slice(-4)===".bin"?LRe:ise)(t)}function ZRe(t,e,r,n,a){return(e.slice(-4)===".bin"?hRe:tse)(t,r,n,a)}function eMe(t,e,r){return(e.slice(-4)===".bin"?Xke:Mae)(t,r)}function tMe(t,e,r){return(e.slice(-4)===".bin"?XBe:Pae)(t,r)}function rMe(t,e,r){return(e.slice(-4)===".bin"?LFe:Hae)(t)}function nMe(t){return(t.slice(-4)===".bin"?wFe:Qae)()}var ose=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,lse=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Jd(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(ose),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(lse),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function aMe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(ose),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(lse),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Vb;function sMe(t,e){var r=Vb[t]||Sa(t);return r==="General"?gg(e):Dd(r,e)}function iMe(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ks(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Rs(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Sa(e)]=a}function oMe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||UA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=O2(t.v):t.w=gg(t.v):t.w=sMe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Vb[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&w1(n)){var a=Tp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function lMe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=yke[n.Pattern]||n.Pattern)}t[e.ID]=e}function cMe(t,e,r,n,a,s,o,l,c,u){var d="General",f=n.StyleID,A={};u=u||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ks(t);break;case"String":n.t="s",n.r=jH(Sa(t)),n.v=t.indexOf("<")>-1?Sa(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Rs(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Sa(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=rae[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=jH(e||t));break}if(oMe(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=Sa(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=vv(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=vv("RC:RC",a):n.ArrayRange&&(n.F=vv(n.ArrayRange,a),c.push([ja(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(x){!A.patternType&&x.patternType&&(A.patternType=x.patternType)}),n.s=A),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function uMe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function M5(t,e){var r=e||{};N1();var n=Zy(uR(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=us(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Ms(r);return o.type="string",Hv.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Se){a.indexOf("<"+Se)>=0&&(s=!0)}),s)return WMe(n,r);Vb={"General Number":"General","General Date":Fn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Fn[15],"Short Date":Fn[14],"Long Time":Fn[19],"Medium Time":Fn[18],"Short Time":Fn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Fn[2],Standard:Fn[4],Percent:Fn[10],Scientific:Fn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],A=r.dense?[]:{},h="",m={},p={},x=Jd('<Data ss:Type="String">'),v=0,y=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},j={},C="",S=0,E=[],B={},k={},T=0,P=[],G=[],ce={},ue=[],le,Ae=!1,ae=[],_e=[],De={},O=0,H=0,K={Sheets:[],WBProps:{date1904:!1}},R={};M2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";l=M2.exec(n);)switch(l[3]=(X=l[3]).toLowerCase()){case"data":if(X=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?cMe(n.slice(v,l.index),C,x,c[c.length-1][0]=="comment"?ce:m,{c:y,r:b},I,ue[y],p,ae,r):(C="",x=Jd(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(G.length>0&&(m.c=G),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(A[b]||(A[b]=[]),A[b][y]=m):A[ui(y)+Wi(b)]=m),m.HRef&&(m.l={Target:Sa(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(O=y+(parseInt(m.MergeAcross,10)|0),H=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:y,r:b},e:{c:O,r:H}})),!r.sheetStubs)m.MergeAcross?y=O+1:++y;else if(m.MergeAcross||m.MergeDown){for(var Y=y;Y<=O;++Y)for(var D=b;D<=H;++D)(Y>y||D>b)&&(r.dense?(A[D]||(A[D]=[]),A[D][Y]={t:"z"}):A[ui(Y)+Wi(D)]={t:"z"});y=O+1}else++y;else m=aMe(l[0]),m.Index&&(y=+m.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),l[0].slice(-2)==="/>"&&++y,G=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),l[0].slice(-2)==="/>"&&(p=Jd(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=Jd(l[0]),p.Index&&(b=+p.Index-1),De={},(p.AutoFitHeight=="0"||p.Height)&&(De.hpx=parseInt(p.Height,10),De.hpt=H2(De.hpx),_e[b]=De),p.Hidden=="1"&&(De.hidden=!0,_e[b]=De));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(A["!ref"]=Xn(w),r.sheetRows&&r.sheetRows<=w.e.r&&(A["!fullref"]=A["!ref"],w.e.r=r.sheetRows-1,A["!ref"]=Xn(w))),E.length&&(A["!merges"]=E),ue.length>0&&(A["!cols"]=ue),_e.length>0&&(A["!rows"]=_e),d[h]=A}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),u=Jd(l[0]),h=Sa(u.Name),A=r.dense?[]:{},E=[],ae=[],_e=[],R={name:h,Hidden:0},K.Sheets.push(R);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ue=[],Ae=!1}break;case"style":l[1]==="/"?lMe(I,j,r):j=Jd(l[0]);break;case"numberformat":j.nf=Sa(Jd(l[0]).Format||"General"),Vb[j.nf]&&(j.nf=Vb[j.nf]);for(var Q=0;Q!=392&&Fn[Q]!=j.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Fn[Q]==null){uA(j.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(le=Jd(l[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!Ae&&le.wpx>10){Ae=!0,ac=Dae;for(var te=0;te<ue.length;++te)ue[te]&&Tm(ue[te])}Ae&&Tm(le),ue[le.Index-1||ue.length]=le;for(var be=0;be<+le.Span;++be)ue[ue.length]=Ms(le);break;case"namedrange":if(l[1]==="/")break;K.Names||(K.Names=[]);var U=Dn(l[0]),Xe={Name:U.Name,Ref:vv(U.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Xe.Sheet=K.Sheets.length-1),K.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?C+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Jd(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?F5e(B,X,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));uMe(ce),G.push(ce)}else c.push([l[3],!1]),u=Jd(l[0]),ce={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var se=Jd(l[0]);A["!autofilter"]={ref:vv(se.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return p$(n,r);var ee=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ee=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ee=!1}break;case"excelworkbook":switch(l[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ee=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:ee=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else T=l.index+l[0].length;break;case"header":A["!margins"]||zp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].header=+Dn(l[0]).Margin);break;case"footer":A["!margins"]||zp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].footer=+Dn(l[0]).Margin);break;case"pagemargins":var Fe=Dn(l[0]);A["!margins"]||zp(A["!margins"]={},"xlml"),isNaN(+Fe.Top)||(A["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(A["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(A["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(A["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ee=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ee=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ee=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ee=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ee=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ee=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ee=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ee=!1}break;case"smarttags":break;default:ee=!1;break}if(ee||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?iMe(k,X,P,n.slice(T,l.index)):(P=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=d),je.SheetNames=f,je.Workbook=K,je.SSF=Ms(Fn),je.Props=B,je.Custprops=k,je}function iF(t,e){switch(FR(e=e||{}),e.type||"base64"){case"base64":return M5($u(t),e);case"binary":case"buffer":case"file":return M5(t,e);case"array":return M5($m(t),e)}}function dMe(t,e){var r=[];return t.Props&&r.push(O5e(t.Props,e)),t.Custprops&&r.push(D5e(t.Props,t.Custprops)),r.join("")}function fMe(){return""}function hMe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push($r("NumberFormat",null,{"ss:Format":ns(Fn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push($r("Style",s.join(""),o))}),$r("Styles",r.join(""))}function cse(t){return $r("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+jR(t.Ref,{r:0,c:0})})}function AMe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(cse(a)))}return $r("Names",r.join(""))}function mMe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(cse(l)))}return s.join("")}function pMe(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push($r("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push($r("Footer",null,{"x:Margin":t["!margins"].footer})),a.push($r("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push($r("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Il("ProtectContents","True")),t["!protect"].objects&&a.push(Il("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Il("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Il("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Il("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":$r("WorksheetOptions",a.join(""),{xmlns:Iu.x})}function gMe(t){return t.map(function(e){var r=M4e(e.t||""),n=$r("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return $r("Comment",n,{"ss:Author":e.a})}).join("")}function xMe(t,e,r,n,a,s,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+ns(jR(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=di(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=ns(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=ns(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",A="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",A=String(t.v);break;case"b":f="Boolean",A=t.v?"1":"0";break;case"e":f="Error",A=UA[t.v];break;case"d":f="DateTime",A=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Fn[14]);break;case"s":f="String",A=R4e(t.v||"");break}var h=Km(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?A:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=gMe(t.c)),$r("Cell",p,l)}function vMe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=$v(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function yMe(t,e,r,n){if(!t["!ref"])return"";var a=ja(t["!ref"]),s=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,v){Tm(x);var y=!!x.width,b=gP(v,x),w={"ss:Index":v+1};y&&(w["ss:Width"]=Q2(b.width)),x.hidden&&(w["ss:Hidden"]="1"),l.push($r("Column",null,w))});for(var c=Array.isArray(t),u=a.s.r;u<=a.e.r;++u){for(var d=[vMe(u,(t["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var A=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(A=!0);break}if(!A){var h={r:u,c:f},m=On(h),p=c?(t[u]||[])[f]:t[m];d.push(xMe(p,m,t,e,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function bMe(t,e,r){var n=[],a=r.SheetNames[t],s=r.Sheets[a],o=s?mMe(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?yMe(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(pMe(s,e,t,r)),n.join("")}function wMe(t,e){e||(e={}),t.SSF||(t.SSF=Ms(Fn)),t.SSF&&(N1(),uP(t.SSF),e.revssf=fP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Km(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(dMe(t,e)),r.push(fMe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push($r("Worksheet",bMe(n,e,t),{"ss:Name":ns(t.SheetNames[n])}));return r[2]=hMe(t,e),r[3]=AMe(t),Yi+$r("Workbook",r.join(""),{xmlns:Iu.ss,"xmlns:o":Iu.o,"xmlns:x":Iu.x,"xmlns:ss":Iu.ss,"xmlns:dt":Iu.dt,"xmlns:html":Iu.html})}function NMe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=A5e(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=m5e(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var CMe=[60,1084,2066,2165,2175];function _Me(t,e,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Zh(r,r.l),u=oF[c],d=0;u!=null&&CMe.indexOf(c)>-1;)s=Zh(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=oF[c=Zh(r,r.l)];var f=Zo(o);Sl(f,0);var A=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(A),A+=o[h].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,a)}function Qf(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Fn[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||UA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=O2(t.v):t.w=gg(t.v):t.w=Dd(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&w1(Fn[n]||String(n))){var a=Tp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function JC(t,e,r){return{v:t,ixfe:e,t:r}}function EMe(t,e){var r={opts:{}},n={},a=e.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,A="",h,m,p,x,v={},y=[],b,w,I=[],j=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},E=function(ht){return ht<8?Gp[ht]:ht<64&&j[ht-8]||Gp[ht]},B=function(ht,Oe,Ie){var We=Oe.XF.data;if(!(!We||!We.patternType||!Ie||!Ie.cellStyles)){Oe.s={},Oe.s.patternType=We.patternType;var Z;(Z=U2(E(We.icvFore)))&&(Oe.s.fgColor={rgb:Z}),(Z=U2(E(We.icvBack)))&&(Oe.s.bgColor={rgb:Z})}},k=function(ht,Oe,Ie){if(!(De>1)&&!(Ie.sheetRows&&ht.r>=Ie.sheetRows)){if(Ie.cellStyles&&Oe.XF&&Oe.XF.data&&B(ht,Oe,Ie),delete Oe.ixfe,delete Oe.XF,f=ht,A=On(ht),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ht.r<o.s.r&&(o.s.r=ht.r),ht.c<o.s.c&&(o.s.c=ht.c),ht.r+1>o.e.r&&(o.e.r=ht.r+1),ht.c+1>o.e.c&&(o.e.c=ht.c+1),Ie.cellFormula&&Oe.f){for(var We=0;We<y.length;++We)if(!(y[We][0].s.c>ht.c||y[We][0].s.r>ht.r)&&!(y[We][0].e.c<ht.c||y[We][0].e.r<ht.r)){Oe.F=Xn(y[We][0]),(y[We][0].s.c!=ht.c||y[We][0].s.r!=ht.r)&&delete Oe.f,Oe.f&&(Oe.f=""+rc(y[We][1],o,ht,ae,T));break}}Ie.dense?(a[ht.r]||(a[ht.r]=[]),a[ht.r][ht.c]=Oe):a[A]=Oe}},T={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var P,G=[],ce=[],ue=[],le=[],Ae=!1,ae=[];ae.SheetNames=T.snames,ae.sharedf=T.sharedf,ae.arrayf=T.arrayf,ae.names=[],ae.XTI=[];var _e=0,De=0,O=0,H=[],K=[],R;T.codepage=1200,mf(1200);for(var X=!1;t.l<t.length-1;){var Y=t.l,D=t.read_shift(2);if(D===0&&_e===10)break;var Q=t.l===t.length?0:t.read_shift(2),te=oF[D];if(te&&te.f){if(e.bookSheets&&_e===133&&D!==133)break;if(_e=D,te.r===2||te.r==12){var be=t.read_shift(2);if(Q-=2,!T.enc&&be!==D&&((be&255)<<8|be>>8)!==D)throw new Error("rt mismatch: "+be+"!="+D);te.r==12&&(t.l+=10,Q-=10)}var U={};if(D===10?U=te.f(t,Q,T):U=_Me(D,te,t,Q,T),De==0&&[9,521,1033,2057].indexOf(_e)===-1)continue;switch(D){case 34:r.opts.Date1904=C.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=U;break;case 66:var Xe=Number(U);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}mf(T.codepage=Xe),X=!0;break;case 317:T.rrtabid=U;break;case 25:T.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:T.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(a["!type"]="dialog"),U.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),U.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(U);break;case 430:ae.push([U]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(U);break;case 24:case 536:R={Name:U.Name,Ref:rc(U.rgce,o,null,ae,T)},U.itab>0&&(R.Sheet=U.itab-1),ae.names.push(R),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(K[U.itab-1]={ref:Xn(U.rgce[0][0][1][2])});break;case 22:T.ExternCount=U;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(U),ae.XTI=ae.XTI.concat(U);break;case 2196:if(T.biff<8)break;R!=null&&(R.Comment=U[1]);break;case 18:a["!protect"]=U;break;case 19:U!==0&&T.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,T.snames.push(U.name);break;case 10:{if(--De)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=Xn(o),e.sheetRows&&e.sheetRows<=o.e.r){var se=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Xn(o),o.e.r=se}o.e.r++,o.e.c++}G.length>0&&(a["!merges"]=G),ce.length>0&&(a["!objects"]=ce),ue.length>0&&(a["!cols"]=ue),le.length>0&&(a["!rows"]=le),C.Sheets.push(S)}u===""?d=a:n[u]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[D]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),T.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(T.biff=5,X=!0,mf(T.codepage=28591)),T.biff==8&&U.BIFFVer==0&&U.dt==16&&(T.biff=2),De++)break;if(a=e.dense?[]:{},T.biff<8&&!X&&(X=!0,mf(T.codepage=e.codepage||1252)),T.biff<5||U.BIFFVer==0&&U.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ee={pos:t.l-Q,name:u};s[ee.pos]=ee,T.snames.push(u)}else u=(s[Y]||{name:""}).name;U.dt==32&&(a["!type"]="chart"),U.dt==64&&(a["!type"]="macro"),G=[],ce=[],T.arrayf=y=[],ue=[],le=[],Ae=!1,S={Hidden:(s[Y]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[U.r]||[])[U.c]:a[On({c:U.c,r:U.r})])&&++U.c,b={ixfe:U.ixfe,XF:I[U.ixfe]||{},v:U.val,t:"n"},O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 5:case 517:b={ixfe:U.ixfe,XF:I[U.ixfe],v:U.val,t:U.t},O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 638:b={ixfe:U.ixfe,XF:I[U.ixfe],v:U.rknum,t:"n"},O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 189:for(var Fe=U.c;Fe<=U.C;++Fe){var je=U.rkrec[Fe-U.c][0];b={ixfe:je,XF:I[je],v:U.rkrec[Fe-U.c][1],t:"n"},O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:Fe,r:U.r},b,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){l=U;break}if(b=JC(U.val,U.cell.ixfe,U.tt),b.XF=I[b.ixfe],e.cellFormula){var Se=U.formula;if(Se&&Se[0]&&Se[0][0]&&Se[0][0][0]=="PtgExp"){var Ze=Se[0][0][1][0],ut=Se[0][0][1][1],Et=On({r:Ze,c:ut});v[Et]?b.f=""+rc(U.formula,o,U.cell,ae,T):b.F=((e.dense?(a[Ze]||[])[ut]:a[Et])||{}).F}else b.f=""+rc(U.formula,o,U.cell,ae,T)}O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k(U.cell,b,e),l=U}break;case 7:case 519:if(l)l.val=U,b=JC(U,l.cell.ixfe,"s"),b.XF=I[b.ixfe],e.cellFormula&&(b.f=""+rc(l.formula,o,l.cell,ae,T)),O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(U);var St=On(U[0].s);if(h=e.dense?(a[U[0].s.r]||[])[U[0].s.c]:a[St],e.cellFormula&&h){if(!l||!St||!h)break;h.f=""+rc(U[1],o,U[0],ae,T),h.F=Xn(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(A){if(!l)break;v[On(l.cell)]=U[0],h=e.dense?(a[l.cell.r]||[])[l.cell.c]:a[On(l.cell)],(h||{}).f=""+rc(U[0],o,f,ae,T)}}break;case 253:b=JC(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(b.h=c[U.isst].h),b.XF=I[b.ixfe],O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:U.ixfe,XF:I[U.ixfe],t:"z"},O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e));break;case 190:if(e.sheetStubs)for(var Ft=U.c;Ft<=U.C;++Ft){var Qt=U.ixfe[Ft-U.c];b={ixfe:Qt,XF:I[Qt],t:"z"},O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:Ft,r:U.r},b,e)}break;case 214:case 516:case 4:b=JC(U.val,U.ixfe,"s"),b.XF=I[b.ixfe],O>0&&(b.z=H[b.ixfe>>8&63]),Qf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 0:case 512:De===1&&(o=U);break;case 252:c=U;break;case 1054:if(T.biff==4){H[O++]=U[1];for(var Ut=0;Ut<O+163&&Fn[Ut]!=U[1];++Ut);Ut>=163&&uA(U[1],O+163)}else uA(U[1],U[0]);break;case 30:{H[O++]=U;for(var Tt=0;Tt<O+163&&Fn[Tt]!=U;++Tt);Tt>=163&&uA(U,O+163)}break;case 229:G=G.concat(U);break;case 93:ce[U.cmo[0]]=T.lastobj=U;break;case 438:T.lastobj.TxO=U;break;case 127:T.lastobj.ImData=U;break;case 440:for(x=U[0].s.r;x<=U[0].e.r;++x)for(p=U[0].s.c;p<=U[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&(h.l=U[1]);break;case 2048:for(x=U[0].s.r;x<=U[0].e.r;++x)for(p=U[0].s.c;p<=U[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&h.l&&(h.l.Tooltip=U[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=e.dense?(a[U[0].r]||[])[U[0].c]:a[On(U[0])];var Re=ce[U[2]];h||(e.dense?(a[U[0].r]||(a[U[0].r]=[]),h=a[U[0].r][U[0].c]={t:"z"}):h=a[On(U[0])]={t:"z"},o.e.r=Math.max(o.e.r,U[0].r),o.s.r=Math.min(o.s.r,U[0].r),o.e.c=Math.max(o.e.c,U[0].c),o.s.c=Math.min(o.s.c,U[0].c)),h.c||(h.c=[]),m={a:U[1],t:Re.TxO.t},h.c.push(m)}break;case 2173:hFe(I[U.ixfe],U.ext);break;case 125:{if(!T.cellStyles)break;for(;U.e>=U.s;)ue[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},Ae||(Ae=!0,_R(U.w/256)),Tm(ue[U.e+1])}break;case 520:{var Te={};U.level!=null&&(le[U.r]=Te,Te.level=U.level),U.hidden&&(le[U.r]=Te,Te.hidden=!0),U.hpt&&(le[U.r]=Te,Te.hpt=U.hpt,Te.hpx=$v(U.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zp(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[D]]=U;break;case 161:a["!margins"]||zp(a["!margins"]={}),a["!margins"].header=U.header,a["!margins"].footer=U.footer;break;case 574:U.RTL&&(C.Views[0].RTL=!0);break;case 146:j=U;break;case 2198:P=U;break;case 140:w=U;break;case 442:u?S.CodeName=U||S.name:C.WBProps.CodeName=U||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+D.toString(16)),t.l+=Q}return r.SheetNames=Ti(s).sort(function(Ye,ht){return Number(Ye)-Number(ht)}).map(function(Ye){return s[Ye].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&K.forEach(function(Ye,ht){r.Sheets[r.SheetNames[ht]]["!autofilter"]=Ye}),r.Strings=c,r.SSF=Ms(Fn),T.enc&&(r.Encryption=T.enc),P&&(r.Themes=P),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),ae.names.length>0&&(C.Names=ae.names),r.Workbook=C,r}var Hb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function SMe(t,e,r){var n=_n.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=KH(n,eF,Hb.DSI);for(var s in a)e[s]=a[s]}catch(u){if(r.WTF)throw u}var o=_n.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=KH(o,tF,Hb.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(lae(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function jMe(t,e){var r=[],n=[],a=[],s=0,o,l=wH(eF,"n"),c=wH(tF,"n");if(t.Props)for(o=Ti(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=Ti(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)mae.indexOf(a[s][0])>-1||oae.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&_n.utils.cfb_add(e,"/SummaryInformation",qH(n,Hb.SI,c,tF)),(r.length||u.length)&&_n.utils.cfb_add(e,"/DocumentSummaryInformation",qH(r,Hb.DSI,l,eF,u.length?u:null,Hb.UDI))}function use(t,e){e||(e={}),FR(e),tR(),e.codepage&&eR(e.codepage);var r,n;if(t.FullPaths){if(_n.find(t,"/encryption"))throw new Error("File is password-protected");r=_n.find(t,"!CompObj"),n=_n.find(t,"/Workbook")||_n.find(t,"/Book")}else{switch(e.type){case"base64":t=Tu($u(t));break;case"binary":t=Tu(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sl(t,0),n={content:t}}var a,s;if(r&&NMe(r),e.bookProps&&!e.bookSheets)a={};else{var o=ra?"buffer":"array";if(n&&n.content)a=EMe(n.content,e);else if((s=_n.find(t,"PerfectOffice_MAIN"))&&s.content)a=qp.to_workbook(s.content,(e.type=o,e));else if((s=_n.find(t,"NativeContent_MAIN"))&&s.content)a=qp.to_workbook(s.content,(e.type=o,e));else throw(s=_n.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&_n.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=QFe(t))}var l={};return t.FullPaths&&SMe(t,l,e),a.Props=a.Custprops=l,e.bookFiles&&(a.cfb=t),a}function IMe(t,e){var r=e||{},n=_n.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return _n.utils.cfb_add(n,a,dse(t,r)),r.biff==8&&(t.Props||t.Custprops)&&jMe(t,n),r.biff==8&&t.vbaraw&&VFe(n,_n.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var $2={0:{f:ZDe},1:{f:o6e},2:{f:E6e},3:{f:m6e},4:{f:d6e},5:{f:N6e},6:{f:T6e},7:{f:v6e},8:{f:M6e},9:{f:R6e},10:{f:O6e},11:{f:D6e},12:{f:c6e},13:{f:j6e},14:{f:g6e},15:{f:h6e},16:{f:rse},17:{f:k6e},18:{f:b6e},19:{f:mR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:kRe},40:{},42:{},43:{f:Tke},44:{f:Ike},45:{f:Fke},46:{f:Dke},47:{f:Oke},48:{},49:{f:r5e},50:{},51:{f:pFe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Eae},62:{f:P6e},63:{f:_Fe},64:{f:eRe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:dc,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X6e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:s6e},148:{f:r6e,p:16},151:{f:$6e},152:{},153:{f:PRe},154:{},155:{},156:{f:jRe},157:{},158:{},159:{T:1,f:KBe},160:{T:-1},161:{T:1,f:Gg},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:L6e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:AFe},336:{T:-1},337:{f:vFe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zk},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_ae},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:G6e},427:{f:K6e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:z6e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:a6e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:V6e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zk},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DFe},633:{T:1},634:{T:-1},635:{T:1,f:FFe},636:{T:-1},637:{f:i5e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:gRe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:tRe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},oF={6:{f:D5},10:{f:g0},12:{f:so},13:{f:so},14:{f:Li},15:{f:Li},16:{f:sc},17:{f:Li},18:{f:Li},19:{f:so},20:{f:ZH},21:{f:ZH},23:{f:_ae},24:{f:t$},25:{f:Li},26:{},27:{},28:{f:tBe},29:{},34:{f:Li},35:{f:e$},38:{f:sc},39:{f:sc},40:{f:sc},41:{f:sc},42:{f:Li},43:{f:Li},47:{f:hke},49:{f:jTe},51:{f:so},60:{},61:{f:NTe},64:{f:Li},65:{f:STe},66:{f:so},77:{},80:{},81:{},82:{},85:{f:so},89:{},90:{},91:{},92:{f:fTe},93:{f:aBe},94:{},95:{f:Li},96:{},97:{},99:{f:Li},125:{f:Eae},128:{f:HTe},129:{f:ATe},130:{f:so},131:{f:Li},132:{f:Li},133:{f:mTe},134:{},140:{f:fBe},141:{f:so},144:{},146:{f:mBe},151:{},152:{},153:{},154:{},155:{},156:{f:so},157:{},158:{},160:{f:wBe},161:{f:xBe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:LTe},190:{f:UTe},193:{f:g0},197:{},198:{},199:{},200:{},201:{},202:{f:Li},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:so},220:{},221:{f:Li},222:{},224:{f:VTe},225:{f:dTe},226:{f:g0},227:{},229:{f:rBe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:gTe},253:{f:PTe},255:{f:vTe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pae},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Li},353:{f:g0},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:zTe},431:{f:Li},432:{},433:{},434:{},437:{},438:{f:oBe},439:{f:Li},440:{f:lBe},441:{},442:{f:Hw},443:{},444:{f:so},445:{},446:{},448:{f:g0},449:{f:wTe,r:2},450:{f:g0},512:{f:XH},513:{f:bBe},515:{f:KTe},516:{f:BTe},517:{f:JH},519:{f:NBe},520:{f:yTe},523:{},545:{f:r$},549:{f:WH},566:{},574:{f:_Te},638:{f:MTe},659:{},1048:{},1054:{f:FTe},1084:{},1212:{f:JTe},2048:{f:uBe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:WC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:g0},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:pBe,r:12},2173:{f:fFe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Li,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:YTe,r:12},2197:{},2198:{f:iFe,r:12},2199:{},2200:{},2201:{},2202:{f:ZTe,r:12},2203:{f:g0},2204:{},2205:{},2206:{},2207:{},2211:{f:bTe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:so},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vBe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ABe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:XH},1:{},2:{f:jBe},3:{f:EBe},4:{f:_Be},5:{f:JH},7:{f:PBe},8:{},9:{f:WC},11:{},22:{f:so},30:{f:DTe},31:{},32:{},33:{f:r$},36:{},37:{f:WH},50:{f:TBe},62:{},52:{},67:{},68:{f:so},69:{},86:{},126:{},127:{f:CBe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BBe},223:{},234:{},354:{},421:{},518:{f:D5},521:{f:WC},536:{f:t$},547:{f:e$},561:{},579:{},1030:{f:D5},1033:{f:WC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Gr(t,e,r,n){var a=e;if(!isNaN(a)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&fR(r)&&t.push(r)}}function PMe(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Gr(t,e,r,a);var s=e;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<a;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function qw(t,e,r){return t||(t=ur(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function TMe(t,e,r,n){var a=ur(9);return qw(a,t,e),gae(r,n||"b",a),a}function BMe(t,e,r){var n=ur(8+2*r.length);return qw(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function kMe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Do(Rs(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Gr(t,2,IBe(r,n,a)):Gr(t,3,SBe(r,n,a));return;case"b":case"e":Gr(t,5,TMe(r,n,e.v,e.t));return;case"s":case"str":Gr(t,4,BMe(r,n,(e.v||"").slice(0,255)));return}Gr(t,1,qw(null,r,n))}function FMe(t,e,r,n){var a=Array.isArray(e),s=ja(e["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Xn(s)}for(var u=s.s.r;u<=s.e.r;++u){l=Wi(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=ui(d)),o=c[d]+l;var f=a?(e[u]||[])[d]:e[o];f&&kMe(t,f,u,d)}}}function OMe(t,e){for(var r=e||{},n=lu(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Gr(n,r.biff==4?1033:r.biff==3?521:9,wR(t,16,r)),FMe(n,t.Sheets[t.SheetNames[a]],a,r),Gr(n,10),n.end()}function DMe(t,e,r){Gr(t,49,ITe({sz:12,name:"Arial"},r))}function RMe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Gr(t,1054,OTe(a,e[a],r))})}function MMe(t,e){var r=ur(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Gr(t,2151,r),r=ur(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),wae(ja(e["!ref"]||"A1"),r),r.write_shift(4,4),Gr(t,2152,r)}function LMe(t,e){for(var r=0;r<16;++r)Gr(t,224,YH({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Gr(t,224,YH(n,0,e))})}function UMe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Gr(t,440,cBe(n)),n[1].Tooltip&&Gr(t,2048,dBe(n))}delete e["!links"]}function QMe(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Gr(t,125,gBe(gP(a,n),a))})}}function VMe(t,e,r,n,a){var s=16+Km(a.cellXfs,e,a);if(e.v==null&&!e.bf){Gr(t,513,bg(r,n,s));return}if(e.bf)Gr(t,6,ADe(e,r,n,a,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Do(Rs(e.v)):e.v;Gr(t,515,qTe(r,n,o,s));break;case"b":case"e":Gr(t,517,GTe(r,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var l=PR(a.Strings,e.v,a.revStrings);Gr(t,253,TTe(r,n,l,s))}else Gr(t,516,kTe(r,n,(e.v||"").slice(0,255),s,a));break;default:Gr(t,513,bg(r,n,s))}}function HMe(t,e,r){var n=lu(),a=r.SheetNames[t],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,d,f="",A=[],h=ja(s["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Gr(n,2057,wR(r,16,e)),Gr(n,13,xd(1)),Gr(n,12,xd(100)),Gr(n,15,Ec(!0)),Gr(n,17,Ec(!1)),Gr(n,16,vg(.001)),Gr(n,95,Ec(!0)),Gr(n,42,Ec(!1)),Gr(n,43,Ec(!1)),Gr(n,130,xd(1)),Gr(n,128,$Te()),Gr(n,131,Ec(!1)),Gr(n,132,Ec(!1)),u&&QMe(n,s["!cols"]),Gr(n,512,RTe(h,e)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=Wi(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(A[x]=ui(x)),d=A[x]+f;var v=c?(s[p]||[])[x]:s[d];v&&(VMe(n,v,p,x,e),u&&v.l&&s["!links"].push([d,v.l]))}}var y=l.CodeName||l.name||a;return u&&Gr(n,574,ETe((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Gr(n,229,nBe(s["!merges"])),u&&UMe(n,s),Gr(n,442,xae(y)),u&&MMe(n,s),Gr(n,10),n.end()}function $Me(t,e,r){var n=lu(),a=(t||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Gr(n,2057,wR(t,5,r)),r.bookType=="xla"&&Gr(n,135),Gr(n,225,l?xd(1200):null),Gr(n,193,G5e(2)),c&&Gr(n,191),c&&Gr(n,192),Gr(n,226),Gr(n,92,hTe("SheetJS",r)),Gr(n,66,xd(l?1200:1252)),l&&Gr(n,353,xd(0)),l&&Gr(n,448),Gr(n,317,yBe(t.SheetNames.length)),l&&t.vbaraw&&Gr(n,211),l&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";Gr(n,442,xae(u))}Gr(n,156,xd(17)),Gr(n,25,Ec(!1)),Gr(n,18,Ec(!1)),Gr(n,19,xd(0)),l&&Gr(n,431,Ec(!1)),l&&Gr(n,444,xd(0)),Gr(n,61,CTe()),Gr(n,64,Ec(!1)),Gr(n,141,xd(0)),Gr(n,34,Ec(wRe(t)=="true")),Gr(n,14,Ec(!0)),l&&Gr(n,439,Ec(!1)),Gr(n,218,xd(0)),DMe(n,t,r),RMe(n,t.SSF,r),LMe(n,r),l&&Gr(n,352,Ec(!1));var d=n.end(),f=lu();l&&Gr(f,140,hBe()),l&&r.Strings&&PMe(f,252,xTe(r.Strings)),Gr(f,10);var A=f.end(),h=lu(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=d.length+m+A.length;for(p=0;p<t.SheetNames.length;++p){var v=s[p]||{};Gr(h,133,pTe({pos:x,hs:v.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return d.length&&b.push(d),y.length&&b.push(y),A.length&&b.push(A),Zo(b)}function GMe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Ms(Fn)),t&&t.SSF&&(N1(),uP(t.SSF),r.revssf=fP(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,OR(r),r.cellXfs=[],Km(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=HMe(a,r,t);return n.unshift($Me(t,n,r)),Zo(n)}function dse(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=cu(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return GMe(t,e);case 4:case 3:case 2:return OMe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function f$(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=a.index,l=s&&s.index||t.length,c=I4e(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,A=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(x!="<td"&&x!="<th")){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var I=0;I<m.length;++I){var j=m[I];j.s.c==d&&j.s.r<u&&u<=j.e.r&&(d=j.e.c+1,I=-1)}var C=Dn(y.slice(0,y.indexOf(">")));A=C.colspan?+C.colspan:1,((f=+C.rowspan)>1||A>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+A-1}});var S=C.t||C["data-t"]||"";if(!b.length){d+=A;continue}if(b=One(b),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!b.length){d+=A;continue}var E={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(yf(b))?isNaN(Vv(b).getDate())||(E={t:"d",v:Rs(b)},r.cellDates||(E={t:"n",v:Do(E.v)}),E.z=r.dateNF||Fn[14]):E={t:"n",v:yf(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=E):n[On({r:u,c:d})]=E,d+=A}}}}return n["!ref"]=Xn(h),m.length&&(n["!merges"]=m),n}function KMe(t,e,r,n){for(var a=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=On({r,c:o}),f=n.dense?(t[r]||[])[o]:t[d],A=f&&f.v!=null&&(f.h||cR(f.w||(NA(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?A='<span contenteditable="true">'+A+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(A='<a href="'+f.l.Target+'">'+A+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push($r("td",A,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var qMe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',zMe="</body></html>";function WMe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Gm(f$(r[0],e),e);var n=MR();return r.forEach(function(a,s){LR(n,f$(a,e),"Sheet"+(s+1))}),n}function XMe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function fse(t,e){var r=e||{},n=r.header!=null?r.header:qMe,a=r.footer!=null?r.footer:zMe,s=[n],o=cu(t["!ref"]);r.dense=Array.isArray(t),s.push(XMe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(KMe(t,o,l,r));return s.push("</table>"+a),s.join("")}function hse(t,e,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?di(n.origin):n.origin;a=o.r,s=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var d=cu(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],A=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,v=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var w=l[m];if(h$(w)){if(n.display)continue;h[p]={hidden:!0}}var I=w.children;for(x=v=0;x<I.length;++x){var j=I[x];if(!(n.display&&h$(j))){var C=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):One(j.innerHTML),S=j.getAttribute("data-z")||j.getAttribute("z");for(A=0;A<f.length;++A){var E=f[A];E.s.c==v+s&&E.s.r<p+a&&p+a<=E.e.r&&(v=E.e.c+1-s,A=-1)}b=+j.getAttribute("colspan")||1,((y=+j.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+s},e:{r:p+a+(y||1)-1,c:v+s+(b||1)-1}});var B={t:"s",v:C},k=j.getAttribute("data-t")||j.getAttribute("t")||"";C!=null&&(C.length==0?B.t=k||"z":n.raw||C.trim().length==0||k=="s"||(C==="TRUE"?B={t:"b",v:!0}:C==="FALSE"?B={t:"b",v:!1}:isNaN(yf(C))?isNaN(Vv(C).getDate())||(B={t:"d",v:Rs(C)},n.cellDates||(B={t:"n",v:Do(B.v)}),B.z=n.dateNF||Fn[14]):B={t:"n",v:yf(C)})),B.z===void 0&&S!=null&&(B.z=S);var T="",P=j.getElementsByTagName("A");if(P&&P.length)for(var G=0;G<P.length&&!(P[G].hasAttribute("href")&&(T=P[G].getAttribute("href"),T.charAt(0)!="#"));++G);T&&T.charAt(0)!="#"&&(B.l={Target:T}),n.dense?(t[p+a]||(t[p+a]=[]),t[p+a][v+s]=B):t[On({c:v+s,r:p+a})]=B,u.e.c<v+s&&(u.e.c=v+s),v+=b}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),t["!ref"]=Xn(u),p>=c&&(t["!fullref"]=Xn((u.e.r=l.length-m+p-1+a,u))),t}function Ase(t,e){var r=e||{},n=r.dense?[]:{};return hse(n,t,e)}function YMe(t,e){return Gm(Ase(t,e),e)}function h$(t){var e="",r=JMe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function JMe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function ZMe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Sa(e.replace(/<[^>]*>/g,""));return[r]}var A$={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mse(t,e){var r=e||{},n=uR(t),a=[],s,o,l={name:""},c="",u=0,d,f,A={},h=[],m=r.dense?[]:{},p,x,v={value:""},y="",b=0,w=[],I=-1,j=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,E={},B=[],k={},T=0,P=0,G=[],ce=1,ue=1,le=[],Ae={Names:[]},ae={},_e=["",""],De=[],O={},H="",K=0,R=!1,X=!1,Y=0;for(M2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=M2.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?m["!ref"]=Xn(C):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(m["!fullref"]=m["!ref"],C.e.r=r.sheetRows-1,m["!ref"]=Xn(C)),B.length&&(m["!merges"]=B),G.length&&(m["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),A[d.name]=m,X=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Dn(p[0],!1),I=j=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,m=r.dense?[]:{},B=[],G=[],X=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){I+=ce,ce=1;break}if(f=Dn(p[0],!1),f.?I=f.-1:I==-1&&(I=0),ce=+f["number-rows-repeated"]||1,ce<10)for(Y=0;Y<ce;++Y)S>0&&(G[I+Y]={level:S});j=-1;break;case"covered-table-cell":p[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(m[I]||(m[I]=[]),m[I][j]={t:"z"}):m[On({r:I,c:j})]={t:"z"}),y="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++j,v=Dn(p[0],!1),ue=parseInt(v["number-columns-repeated"]||"1",10),x={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(x.f=c$(Sa(v.formula))),(v.||v["value-type"])=="string"&&(x.t="s",x.v=Sa(v["string-value"]||""),r.dense?(m[I]||(m[I]=[]),m[I][j]=x):m[On({r:I,c:j})]=x),j+=ue-1;else if(p[1]!=="/"){++j,y="",b=0,w=[],ue=1;var D=ce?I+ce-1:I;if(j>C.e.c&&(C.e.c=j),j<C.s.c&&(C.s.c=j),I<C.s.r&&(C.s.r=I),D>C.e.r&&(C.e.r=D),v=Dn(p[0],!1),De=[],O={},x={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Sa(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(T=parseInt(v["number-matrix-rows-spanned"],10)||0,P=parseInt(v["number-matrix-columns-spanned"],10)||0,k={s:{r:I,c:j},e:{r:I+T-1,c:j+P-1}},x.F=Xn(k),le.push([k,x.F])),v.formula)x.f=c$(v.formula);else for(Y=0;Y<le.length;++Y)I>=le[Y][0].s.r&&I<=le[Y][0].e.r&&j>=le[Y][0].s.c&&j<=le[Y][0].e.c&&(x.F=le[Y][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(T=parseInt(v["number-rows-spanned"],10)||0,P=parseInt(v["number-columns-spanned"],10)||0,k={s:{r:I,c:j},e:{r:I+T-1,c:j+P-1}},B.push(k)),v["number-columns-repeated"]&&(ue=parseInt(v["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=ks(v["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(v.value);break;case"percentage":x.t="n",x.v=parseFloat(v.value);break;case"currency":x.t="n",x.v=parseFloat(v.value);break;case"date":x.t="d",x.v=Rs(v["date-value"]),r.cellDates||(x.t="n",x.v=Do(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=E4e(v["time-value"])/86400,r.cellDates&&(x.t="d",x.v=hP(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(v.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",v["string-value"]!=null&&(y=Sa(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(R=!1,x.t==="s"&&(x.v=y||"",w.length&&(x.R=w),R=b==0),ae.Target&&(x.l=ae),De.length>0&&(x.c=De,De=[]),y&&r.cellText!==!1&&(x.w=y),R&&(x.t="z",delete x.v),(!R||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var Q=0;Q<ce;++Q){if(ue=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[I+Q]||(m[I+Q]=[]),m[I+Q][j]=Q==0?x:Ms(x);--ue>0;)m[I+Q][j+ue]=Ms(x);else for(m[On({r:I+Q,c:j})]=x;--ue>0;)m[On({r:I+Q,c:j+ue})]=Ms(x);C.e.c<=j&&(C.e.c=j)}ue=parseInt(v["number-columns-repeated"]||"1",10),j+=ue-1,ue=0,x={},y="",w=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;O.t=y,w.length&&(O.R=w),O.a=H,De.push(O)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);H="",K=0,y="",b=0,w=[];break;case"creator":p[1]==="/"?H=n.slice(K,p.index):K=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Dn(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=A$[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=A$[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=Dn(p[0],!1),_e=R5(o["cell-range-address"]);var te={Name:o.name,Ref:_e[0]+"!"+_e[1]};X&&(te.Sheet=h.length),Ae.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var be=ZMe(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+be[0]}else Dn(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{_e=R5(Dn(p[0])["target-range-address"]),A[_e[0]]["!autofilter"]={ref:_e[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(ae=Dn(p[0],!1),!ae.href)break;ae.Target=Sa(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(_e=R5(ae.Target.slice(1)),ae.Target="#"+_e[0]+"!"+_e[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var U={Sheets:A,SheetNames:h,Workbook:Ae};return r.bookSheets&&delete U.Sheets,U}function m$(t,e){e=e||{},gd(t,"META-INF/manifest.xml")&&E5e(ao(t,"META-INF/manifest.xml"),e);var r=Bu(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=mse(us(r),e);return gd(t,"meta.xml")&&(n.Props=sae(ao(t,"meta.xml"))),n}function p$(t,e){return mse(t,e)}var e8e=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+R2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Yi+e}}(),g$=function(){var t=function(s){return ns(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+ns(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=cu(s["!ref"]||"A1"),A=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(u=0;u<f.s.r;++u)p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(e);for(;d<=f.e.c;++d){var v=!1,y={},b="";for(h=0;h!=A.length;++h)if(!(A[h].s.c>d)&&!(A[h].s.r>u)&&!(A[h].e.c<d)&&!(A[h].e.r<u)){(A[h].s.c!=d||A[h].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=A[h].e.c-A[h].s.c+1,y["table:number-rows-spanned"]=A[h].e.r-A[h].s.r+1;break}if(v){c.push(r);continue}var w=On({r:u,c:d}),I=m?(s[u]||[])[d]:s[w];if(I&&I.f&&(y["table:formula"]=ns(yDe(I.f)),I.F&&I.F.slice(0,w.length)==w)){var j=cu(I.F);y["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,y["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!I){c.push(e);continue}switch(I.t){case"b":b=I.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=I.v?"true":"false";break;case"n":b=I.w||String(I.v||0),y["office:value-type"]="float",y["office:value"]=I.v||0;break;case"s":case"str":b=I.v==null?"":I.v,y["office:value-type"]="string";break;case"d":b=I.w||Rs(I.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Rs(I.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var C=t(b);if(I.l&&I.l.Target){var S=I.l.Target;S=S.charAt(0)=="#"?"#"+bDe(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),C=$r("text:a",C,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+$r("table:table-cell",$r("text:p",C,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Tm(f),f.ods=l;var A=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+A+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Yi],u=R2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=R2({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(aae().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function pse(t,e){if(e.bookType=="fods")return g$(t,e);var r=iR(),n="",a=[],s=[];return n="mimetype",Zn(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Zn(r,n,g$(t,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Zn(r,n,e8e(t,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Zn(r,n,Yi+aae()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Zn(r,n,I5e(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Zn(r,n,S5e(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function wg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function lF(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):us($m(t))}function t8e(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Tu(th(t))}function r8e(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function km(t){var e=t.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function x$(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function n8e(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function a8e(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=r>=0?0:128}function G2(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Xa(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ii(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Pa(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=G2(t,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=G2(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};e[a]==null?e[a]=[u]:e[a].push(u)}return e}function xl(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Xa(n*8+a.type)),a.type==2&&e.push(Xa(a.data.length)),e.push(a.data))})}),km(e)}function kR(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function dd(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=G2(t,n),s=Pa(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:Ii(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Pa(l.data),u=Ii(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=Ii(s[3][0].data)>>>0>0),r.push(o)}return r}function xx(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Xa(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Xa(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Xa(o.data.length)}],n[2].push({data:xl(o.meta),type:2})});var s=xl(n);e.push(Xa(s.length)),e.push(s),a.forEach(function(o){return e.push(o)})}),km(e)}function s8e(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=G2(e,r),a=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[km(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=km(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function fd(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(s8e(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return km(e)}function vx(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var s=Xa(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return km(e)}function i8e(t,e,r,n){var a=wg(t),s=a.getUint32(4,!0),o=(n>1?12:8)+x$(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=x$(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function o8e(t,e,r){var n=wg(t),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=n8e(t,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return f}function L5(t,e){var r=new Uint8Array(32),n=wg(r),a=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,a8e(r,a,t.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,a)}function U5(t,e){var r=new Uint8Array(32),n=wg(r),a=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,a)}function l8e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return i8e(t,e,r,t[0]);case 5:return o8e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ec(t){var e=Pa(t);return G2(e[1][0].data)}function v$(t,e){var r=Pa(e.data),n=Ii(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=Pa(o.data),c=Ii(l[1][0].data)>>>0;switch(n){case 1:s[c]=lF(l[3][0].data);break;case 8:{var u=t[ec(l[9][0].data)][0],d=Pa(u.data),f=t[ec(d[1][0].data)][0],A=Ii(f.meta[1][0].data);if(A!=2001)throw new Error("2000 unexpected reference to ".concat(A));var h=Pa(f.data);s[c]=h[3].map(function(m){return lF(m.data)}).join("")}break}}),s}function c8e(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=Pa(t),v=Ii(x[1][0].data)>>>0,y=Ii(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Ii(x[8][0].data)>0||!1,w,I;if((s=(a=x[7])==null?void 0:a[0])!=null&&s.data&&e!=0)w=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,I=(u=(c=x[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=x[4])==null?void 0:d[0])!=null&&f.data&&e!=1)w=(h=(A=x[4])==null?void 0:A[0])==null?void 0:h.data,I=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=b?4:1,C=wg(w),S=[],E=0;E<w.length/2;++E){var B=C.getUint16(E*2,!0);B<65535&&S.push([E,B])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var k=[];for(E=0;E<S.length-1;++E)k[S[E][0]]=I.subarray(S[E][1]*j,S[E+1][1]*j);return S.length>=1&&(k[S[S.length-1][0]]=I.subarray(S[S.length-1][1]*j)),{R:v,cells:k}}function u8e(t,e){var r,n=Pa(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ii(n[7][0].data)>>>0>0?1:0:-1,s=kR(n[5],function(o){return c8e(o,a)});return{nrows:Ii(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function d8e(t,e,r){var n,a=Pa(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ii(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ii(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Xn(s);var o=Pa(a[4][0].data),l=v$(t,t[ec(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?v$(t,t[ec(o[17][0].data)][0]):[],u=Pa(o[3][0].data),d=0;u[1].forEach(function(f){var A=Pa(f.data),h=t[ec(A[2][0].data)][0],m=Ii(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=u8e(t,h);p.data.forEach(function(x,v){x.forEach(function(y,b){var w=On({r:d+v,c:b}),I=l8e(y,l,c);I&&(r[w]=I)})}),d+=p.nrows})}function f8e(t,e){var r=Pa(e.data),n={"!ref":"A1"},a=t[ec(r[2][0].data)],s=Ii(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return d8e(t,a[0],n),n}function h8e(t,e){var r,n=Pa(e.data),a={name:(r=n[1])!=null&&r[0]?lF(n[1][0].data):"",sheets:[]},s=kR(n[2],ec);return s.forEach(function(o){t[o].forEach(function(l){var c=Ii(l.meta[1][0].data);c==6e3&&a.sheets.push(f8e(t,l))})}),a}function A8e(t,e){var r=MR(),n=Pa(e.data),a=kR(n[1],ec);if(a.forEach(function(s){t[s].forEach(function(o){var l=Ii(o.meta[1][0].data);if(l==2){var c=h8e(t,o);c.sheets.forEach(function(u,d){LR(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Q5(t){var e,r,n,a,s={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=fd(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=dd(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ii(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Ii(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return A8e(s,l)}function m8e(t,e,r){var n,a,s,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&Ii(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=wg(t[7][0].data),d=0,f=[],A=wg(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),A.setUint16(p*2,h,!0);var x,v;switch(typeof e[p]){case"string":x=L5({t:"s",v:e[p]},r),v=U5({t:"s",v:e[p]},r);break;case"number":x=L5({t:"n",v:e[p]},r),v=U5({t:"n",v:e[p]},r);break;case"boolean":x=L5({t:"b",v:e[p]},r),v=U5({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(x),d+=x.length,m.push(v),h+=v.length,++c}for(t[2][0].data=Xa(c);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535,!0);return t[6][0].data=km(f),t[3][0].data=km(m),c}function p8e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=cu(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Xn(n)));var s=ej(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(K){typeof K=="string"&&o.push(K)})});var l={},c=[],u=_n.read(e.numbers,{type:"base64"});u.FileIndex.map(function(H,K){return[H,u.FullPaths[K]]}).forEach(function(H){var K=H[0],R=H[1];if(K.type==2&&K.name.match(/\.iwa/)){var X=K.content,Y=fd(X),D=dd(Y);D.forEach(function(Q){c.push(Q.id),l[Q.id]={deps:[],location:R,type:Ii(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(H,K){return H-K});var d=c.filter(function(H){return H>1}).map(function(H){return[H,Xa(H)]});u.FileIndex.map(function(H,K){return[H,u.FullPaths[K]]}).forEach(function(H){var K=H[0];if(H[1],!!K.name.match(/\.iwa/)){var R=dd(fd(K.content));R.forEach(function(X){X.messages.forEach(function(Y){d.forEach(function(D){X.messages.some(function(Q){return Ii(Q.meta[1][0].data)!=11006&&r8e(Q.data,D[1])})&&l[D[0]].deps.push(X.id)})})})}});for(var f=_n.find(u,l[1].location),A=dd(fd(f.content)),h,m=0;m<A.length;++m){var p=A[m];p.id==1&&(h=p)}var x=ec(Pa(h.messages[0].data)[1][0].data);for(f=_n.find(u,l[x].location),A=dd(fd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=ec(Pa(h.messages[0].data)[2][0].data),f=_n.find(u,l[x].location),A=dd(fd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=ec(Pa(h.messages[0].data)[2][0].data),f=_n.find(u,l[x].location),A=dd(fd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);var v=Pa(h.messages[0].data);{v[6][0].data=Xa(n.e.r+1),v[7][0].data=Xa(n.e.c+1);var y=ec(v[46][0].data),b=_n.find(u,l[y].location),w=dd(fd(b.content));{for(var I=0;I<w.length&&w[I].id!=y;++I);if(w[I].id!=y)throw"Bad ColumnRowUIDMapArchive";var j=Pa(w[I].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var C=0;C<=n.e.c;++C){var S=[];S[1]=S[2]=[{type:0,data:Xa(C+420690)}],j[1].push({type:2,data:xl(S)}),j[2].push({type:0,data:Xa(C)}),j[3].push({type:0,data:Xa(C)})}j[4]=[],j[5]=[],j[6]=[];for(var E=0;E<=n.e.r;++E)S=[],S[1]=S[2]=[{type:0,data:Xa(E+726270)}],j[4].push({type:2,data:xl(S)}),j[5].push({type:0,data:Xa(E)}),j[6].push({type:0,data:Xa(E)});w[I].messages[0].data=xl(j)}b.content=vx(xx(w)),b.size=b.content.length,delete v[46];var B=Pa(v[4][0].data);{B[7][0].data=Xa(n.e.r+1);var k=Pa(B[1][0].data),T=ec(k[2][0].data);b=_n.find(u,l[T].location),w=dd(fd(b.content));{if(w[0].id!=T)throw"Bad HeaderStorageBucket";var P=Pa(w[0].messages[0].data);for(E=0;E<s.length;++E){var G=Pa(P[2][0].data);G[1][0].data=Xa(E),G[4][0].data=Xa(s[E].length),P[2][E]={type:P[2][0].type,data:xl(G)}}w[0].messages[0].data=xl(P)}b.content=vx(xx(w)),b.size=b.content.length;var ce=ec(B[2][0].data);b=_n.find(u,l[ce].location),w=dd(fd(b.content));{if(w[0].id!=ce)throw"Bad HeaderStorageBucket";for(P=Pa(w[0].messages[0].data),C=0;C<=n.e.c;++C)G=Pa(P[2][0].data),G[1][0].data=Xa(C),G[4][0].data=Xa(n.e.r+1),P[2][C]={type:P[2][0].type,data:xl(G)};w[0].messages[0].data=xl(P)}b.content=vx(xx(w)),b.size=b.content.length;var ue=ec(B[4][0].data);(function(){for(var H=_n.find(u,l[ue].location),K=dd(fd(H.content)),R,X=0;X<K.length;++X){var Y=K[X];Y.id==ue&&(R=Y)}var D=Pa(R.messages[0].data);{D[3]=[];var Q=[];o.forEach(function(U,Xe){Q[1]=[{type:0,data:Xa(Xe)}],Q[2]=[{type:0,data:Xa(1)}],Q[3]=[{type:2,data:t8e(U)}],D[3].push({type:2,data:xl(Q)})})}R.messages[0].data=xl(D);var te=xx(K),be=vx(te);H.content=be,H.size=H.content.length})();var le=Pa(B[3][0].data);{var Ae=le[1][0];delete le[2];var ae=Pa(Ae.data);{var _e=ec(ae[2][0].data);(function(){for(var H=_n.find(u,l[_e].location),K=dd(fd(H.content)),R,X=0;X<K.length;++X){var Y=K[X];Y.id==_e&&(R=Y)}var D=Pa(R.messages[0].data);{delete D[6],delete le[7];var Q=new Uint8Array(D[5][0].data);D[5]=[];for(var te=0,be=0;be<=n.e.r;++be){var U=Pa(Q);te+=m8e(U,s[be],o),U[1][0].data=Xa(be),D[5].push({data:xl(U),type:2})}D[1]=[{type:0,data:Xa(n.e.c+1)}],D[2]=[{type:0,data:Xa(n.e.r+1)}],D[3]=[{type:0,data:Xa(te)}],D[4]=[{type:0,data:Xa(n.e.r+1)}]}R.messages[0].data=xl(D);var Xe=xx(K),se=vx(Xe);H.content=se,H.size=H.content.length})()}Ae.data=xl(ae)}B[3][0].data=xl(le)}v[4][0].data=xl(B)}h.messages[0].data=xl(v);var De=xx(A),O=vx(De);return f.content=O,f.size=f.content.length,u}function gse(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function FR(t){gse([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function OR(t){gse([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function g8e(t){return ia.WS.indexOf(t)>-1?"sheet":t==ia.CS?"chart":t==ia.DS?"dialog":t==ia.MS?"macro":t&&t.length?t:"sheet"}function x8e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,g8e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function v8e(t,e,r,n,a,s,o,l,c,u,d,f){try{s[n]=Lb(Bu(t,r,!0),e);var A=ao(t,e),h;switch(l){case"sheet":h=QRe(A,e,a,c,s[n],u,d,f);break;case"chart":if(h=VRe(A,e,a,c,s[n],u,d,f),!h||!h["!drawel"])break;var m=tb(h["!drawel"].Target,e),p=L2(m),x=jFe(Bu(t,m,!0),Lb(Bu(t,p,!0),m)),v=tb(x,m),y=L2(v);h=mRe(Bu(t,v,!0),v,c,Lb(Bu(t,y,!0),v),u,h);break;case"macro":h=HRe(A,e,a,c,s[n],u,d,f);break;case"dialog":h=$Re(A,e,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];s&&s[n]&&Ti(s[n]).forEach(function(w){var I="";if(s[n][w].Type==ia.CMNT){I=tb(s[n][w].Target,e);var j=zRe(ao(t,I,!0),I,c);if(!j||!j.length)return;a$(h,j,!1)}s[n][w].Type==ia.TCMNT&&(I=tb(s[n][w].Target,e),b=b.concat(PFe(ao(t,I,!0),c)))}),b&&b.length&&a$(h,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function sd(t){return t.charAt(0)=="/"?t.slice(1):t}function y8e(t,e){if(N1(),e=e||{},FR(e),gd(t,"META-INF/manifest.xml")||gd(t,"objectdata.xml"))return m$(t,e);if(gd(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Q5<"u"){if(t.FileIndex)return Q5(t);var r=_n.utils.cfb_new();return _H(t).forEach(function(G){Zn(r,G,T4e(t,G))}),Q5(r)}throw new Error("Unsupported NUMBERS file")}if(!gd(t,"[Content_Types].xml"))throw gd(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):gd(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=_H(t),a=C5e(Bu(t,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",ao(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!ao(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(Ub=[],a.sst)try{Ub=qRe(ao(t,sd(a.sst)),a.sst,e)}catch(G){if(e.WTF)throw G}e.cellStyles&&a.themes.length&&(c=KRe(Bu(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(u=GRe(ao(t,sd(a.style)),a.style,c,e))}a.links.map(function(G){try{var ce=Lb(Bu(t,L2(sd(G))),G);return XRe(ao(t,sd(G)),ce,G,e)}catch{}});var d=URe(ao(t,sd(a.workbooks[0])),a.workbooks[0],e),f={},A="";a.coreprops.length&&(A=ao(t,sd(a.coreprops[0]),!0),A&&(f=sae(A)),a.extprops.length!==0&&(A=ao(t,sd(a.extprops[0]),!0),A&&T5e(A,f,e)));var h={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(A=Bu(t,sd(a.custprops[0]),!0),A&&(h=k5e(A,e)));var m={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(ce){return ce.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),e.bookProps&&(m.Props=f,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&a.calcchain&&(p=WRe(ao(t,sd(a.calcchain)),a.calcchain));var x=0,v={},y,b;{var w=d.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var I=0;I!=w.length;++I)f.SheetNames[I]=w[I].name}var j=s?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");gd(t,S)||(S="xl/_rels/workbook."+j+".rels");var E=Lb(Bu(t,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=YRe(ao(t,sd(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=BFe(ao(t,sd(a.people[0])),e)),E&&(E=x8e(E,d.Sheets));var B=ao(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var k="sheet";if(E&&E[x]?(y="xl/"+E[x][1].replace(/[\/]?xl\//,""),gd(t,y)||(y=E[x][1]),gd(t,y)||(y=S.replace(/_rels\/.*$/,"")+E[x][1]),k=E[x][2]):(y="xl/worksheets/sheet"+(x+1-B)+"."+j,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,P=0;P!=e.sheets.length;++P)typeof e.sheets[P]=="number"&&e.sheets[P]==x&&(T=1),typeof e.sheets[P]=="string"&&e.sheets[P].toLowerCase()==f.SheetNames[x].toLowerCase()&&(T=1);if(!T)continue e}}v8e(t,y,b,f.SheetNames[x],x,v,o,k,e,d,c,u)}return m={Directory:a,Workbook:d,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Ub,Styles:u,Themes:c,SSF:Ms(Fn)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(G,ce){G=G.replace(/^Root Entry[\/]/,""),m.keys.push(G),m.files[G]=t.FileIndex[ce]}))),e&&e.bookVBA&&(a.vba.length>0?m.vbaraw=ao(t,sd(a.vba[0]),!0):a.defaults&&a.defaults.bin===UFe&&(m.vbaraw=ao(t,"xl/vbaProject.bin",!0))),m}function b8e(t,e){var r=e||{},n="Workbook",a=_n.find(t,n);try{if(n="/!DataSpaces/Version",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(YBe(a.content),n="/!DataSpaces/DataSpaceMap",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=ZBe(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=eke(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);rke(a.content)}catch{}if(n="/EncryptionInfo",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=nke(a.content);if(n="/EncryptedPackage",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function w8e(t,e){return e.bookType=="ods"?pse(t,e):e.bookType=="numbers"?p8e(t,e):e.bookType=="xlsb"?N8e(t,e):C8e(t,e)}function N8e(t,e){Yx=1024,t&&!t.SSF&&(t.SSF=Ms(Fn)),t&&t.SSF&&(N1(),uP(t.SSF),e.revssf=fP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Qb?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=$ae.indexOf(e.bookType)>-1,a=yR();OR(e=e||{});var s=iR(),o="",l=0;if(e.cellXfs=[],Km(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Zn(s,o,iae(t.Props,e)),a.coreprops.push(o),Za(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Zn(s,o,cae(t.Props)),a.extprops.push(o),Za(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&Ti(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Zn(s,o,uae(t.Custprops)),a.custprops.push(o),Za(e.rels,4,o,ia.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],A=(f||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Zn(s,o,ZRe(l-1,o,e,t,d)),a.sheets.push(o),Za(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Zn(s,p,rMe(h,p)),a.comments.push(p),Za(d,-1,"../comments"+l+"."+r,ia.CMNT),m=!0),f["!legacy"]&&m&&Zn(s,"xl/drawings/vmlDrawing"+l+".vml",Vae(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Zn(s,L2(o),xv(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Zn(s,o,tMe(e.Strings,o,e)),a.strs.push(o),Za(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Zn(s,o,JRe(t,o)),a.workbooks.push(o),Za(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Zn(s,o,ER(t.Themes,e)),a.themes.push(o),Za(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Zn(s,o,eMe(t,o,e)),a.styles.push(o),Za(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Zn(s,o,t.vbaraw),a.vba.push(o),Za(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Zn(s,o,nMe(o)),a.metadata.push(o),Za(e.wbrels,-1,"metadata."+r,ia.XLMETA),Zn(s,"[Content_Types].xml",nae(a,e)),Zn(s,"_rels/.rels",xv(e.rels)),Zn(s,"xl/_rels/workbook."+r+".rels",xv(e.wbrels)),delete e.revssf,delete e.ssf,s}function C8e(t,e){Yx=1024,t&&!t.SSF&&(t.SSF=Ms(Fn)),t&&t.SSF&&(N1(),uP(t.SSF),e.revssf=fP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Qb?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=$ae.indexOf(e.bookType)>-1,a=yR();OR(e=e||{});var s=iR(),o="",l=0;if(e.cellXfs=[],Km(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Zn(s,o,iae(t.Props,e)),a.coreprops.push(o),Za(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Zn(s,o,cae(t.Props)),a.extprops.push(o),Za(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&Ti(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Zn(s,o,uae(t.Custprops)),a.custprops.push(o),Za(e.rels,4,o,ia.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},A=t.Sheets[t.SheetNames[l-1]],h=(A||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Zn(s,o,tse(l-1,e,t,f)),a.sheets.push(o),Za(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(A){var m=A["!comments"],p=!1,x="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+l+"."+r,Zn(s,x,TFe(m,d,e)),a.threadedcomments.push(x),Za(f,-1,"../threadedComments/threadedComment"+l+"."+r,ia.TCMNT)),x="xl/comments"+l+"."+r,Zn(s,x,Hae(m)),a.comments.push(x),Za(f,-1,"../comments"+l+"."+r,ia.CMNT),p=!0}A["!legacy"]&&p&&Zn(s,"xl/drawings/vmlDrawing"+l+".vml",Vae(l,A["!comments"])),delete A["!comments"],delete A["!legacy"]}f["!id"].rId1&&Zn(s,L2(o),xv(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Zn(s,o,Pae(e.Strings,e)),a.strs.push(o),Za(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Zn(s,o,ise(t)),a.workbooks.push(o),Za(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Zn(s,o,ER(t.Themes,e)),a.themes.push(o),Za(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Zn(s,o,Mae(t,e)),a.styles.push(o),Za(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Zn(s,o,t.vbaraw),a.vba.push(o),Za(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Zn(s,o,Qae()),a.metadata.push(o),Za(e.wbrels,-1,"metadata."+r,ia.XLMETA),d.length>1&&(o="xl/persons/person.xml",Zn(s,o,kFe(d)),a.people.push(o),Za(e.wbrels,-1,"persons/person.xml",ia.PEOPLE)),Zn(s,"[Content_Types].xml",nae(a,e)),Zn(s,"_rels/.rels",xv(e.rels)),Zn(s,"xl/_rels/workbook."+r+".rels",xv(e.wbrels)),delete e.revssf,delete e.ssf,s}function DR(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=$u(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _8e(t,e){return _n.find(t,"EncryptedPackage")?b8e(t,e):use(t,e)}function E8e(t,e){var r,n=t,a=e||{};return a.type||(a.type=ra&&Buffer.isBuffer(t)?"buffer":"base64"),r=Bne(n,a),y8e(r,a)}function xse(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return iF(t.slice(r),e);default:break e}return Hv.to_workbook(t,e)}function S8e(t,e){var r="",n=DR(t,e);switch(e.type){case"base64":r=$u(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=xg(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=us(r)),e.type="binary",xse(r,e)}function j8e(t,e){var r=t;return e.type=="base64"&&(r=$u(r)),r=k2.utils.decode(1200,r.slice(2),"str"),e.type="binary",xse(r,e)}function I8e(t){return t.match(/[^\x00-\x7F]/)?th(t):t}function V5(t,e,r,n){return n?(r.type="string",Hv.to_workbook(t,r)):Hv.to_workbook(e,r)}function Gv(t,e){tR();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Gv(new Uint8Array(t),(r=Ms(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),yv={},r.dateNF&&(yv.dateNF=r.dateNF),r.type||(r.type=ra&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ra?"buffer":"binary",n=N4e(t),typeof Uint8Array<"u"&&!ra&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=I8e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Ms(r),r.type="array",Gv(rR(n),r)}switch((a=DR(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return _8e(_n.read(n,r),r);break;case 9:if(a[1]<=8)return use(n,r);break;case 60:return iF(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return FBe(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return jae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?E8e(n,r):V5(t,n,r,s);case 239:return a[3]===60?iF(n,r):V5(t,n,r,s);case 255:if(a[1]===254)return j8e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return qp.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return qp.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return sF.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Oae.to_workbook(n,r);break;case 10:case 13:case 32:return S8e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return kBe.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?sF.to_workbook(n,r):V5(t,n,r,s)}function vse(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Uw(e.file,_n.write(t,{type:ra?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return _n.write(t,e)}function P8e(t,e){var r=Ms(e||{}),n=w8e(t,r);return T8e(n,r)}function T8e(t,e){var r={},n=ra?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?_n.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(cP(a))}return e.password&&typeof encrypt_agile<"u"?vse(encrypt_agile(a,e.password),e):e.type==="file"?Uw(e.file,a):e.type=="string"?us(a):a}function B8e(t,e){var r=e||{},n=IMe(t,r);return vse(n,r)}function Kf(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return F2(th(n));case"binary":return th(n);case"string":return t;case"file":return Uw(e.file,n,"utf8");case"buffer":return ra?MA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Kf(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function k8e(t,e){switch(e.type){case"base64":return F2(t);case"binary":return t;case"string":return t;case"file":return Uw(e.file,t,"binary");case"buffer":return ra?MA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ZC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?F2(r):e.type=="string"?us(r):r;case"file":return Uw(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function E1(t,e){tR(),_Re(t);var r=Ms(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=E1(t,r);return r.type="array",cP(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Kf(wMe(t,r),r);case"slk":case"sylk":return Kf(Sae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Kf(fse(t.Sheets[t.SheetNames[a]],r),r);case"txt":return k8e(yse(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Kf(RR(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Kf(jae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return ZC(sF.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Kf(Hv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Kf(Oae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Kf(Iae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Kf(pse(t,r),r);case"wk1":return ZC(qp.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return ZC(qp.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ZC(dse(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),B8e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return P8e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function F8e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function K2(t,e,r){var n={};return n.type="file",n.file=e,F8e(n),E1(t,n)}function O8e(t,e,r,n,a,s,o,l){var c=Wi(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,A=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(A,"__rowNum__",{value:r,enumerable:!1})}catch{A.__rowNum__=r}else A.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(A[s[h]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)A[s[h]]=null;else if(u!==void 0)A[s[h]]=u;else if(d&&p===null)A[s[h]]=null;else continue;else A[s[h]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:NA(m,p,l);p!=null&&(f=!1)}}return{row:A,isempty:f}}function ej(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=ja(d);break;case"number":c=ja(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=Wi(c.s.r),A=[],h=[],m=0,p=0,x=Array.isArray(t),v=c.s.r,y=0,b={};x&&!t[v]&&(t[v]=[]);var w=u.skipHidden&&t["!cols"]||[],I=u.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(A[y]=ui(y),r=x?t[v][y]:t[A[y]+f],n){case 1:s[y]=y-c.s.c;break;case 2:s[y]=A[y];break;case 3:s[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=NA(r,null,u),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}s[y]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(I[v]||{}).hidden){var j=O8e(t,c,v,A,n,s,x,u);(j.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=j.row)}return h.length=m,h}var y$=/"/g;function D8e(t,e,r,n,a,s,o,l){for(var c=!0,u=[],d="",f=Wi(r),A=e.s.c;A<=e.e.c;++A)if(n[A]){var h=l.dense?(t[r]||[])[A]:t[n[A]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:NA(h,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||p===34||l.forceQuotes){d='"'+d.replace(y$,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(y$,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function RR(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=ja(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(t);for(var A=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(A[m]||{}).hidden||(f[m]=ui(m));for(var p=0,x=a.s.r;x<=a.e.r;++x)(h[x]||{}).hidden||(d=D8e(t,a,x,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function yse(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=RR(t,e);return r}function R8e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=ja(t["!ref"]),s="",o=[],l,c=[],u=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=ui(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=Wi(d),l=a.s.c;l<=a.e.c;++l)if(e=o[l]+s,r=u?(t[d]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function bse(t,e,r){var n=r||{},a=+!n.skipHeader,s=t||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?di(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+e.length-1+a}};if(s["!ref"]){var f=ja(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+e.length-1+a)}else o==-1&&(o=0,d.e.r=e.length-1+a);var A=n.header||[],h=0;e.forEach(function(p,x){Ti(p).forEach(function(v){(h=A.indexOf(v))==-1&&(A[h=A.length]=v);var y=p[v],b="z",w="",I=On({c:l+h,r:o+x+a});u=q2(s,I),y&&typeof y=="object"&&!(y instanceof Date)?s[I]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=Do(y)),w=n.dateNF||Fn[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,w&&(u.z=w)):s[I]=u={t:b,v:y},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,l+A.length-1);var m=Wi(o);if(a)for(h=0;h<A.length;++h)s[ui(h+l)+m]={t:"s",v:A[h]};return s["!ref"]=Xn(d),s}function M8e(t,e){return bse(null,t,e)}function q2(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=di(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?q2(t,On(e)):q2(t,On({r:e,c:r||0}))}function L8e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function MR(){return{SheetNames:[],Sheets:{}}}function LR(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(sse(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function U8e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=L8e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Q8e(t,e){return t.z=e,t}function wse(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function V8e(t,e,r){return wse(t,"#"+e,r)}function H8e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function $8e(t,e,r,n){for(var a=typeof e!="string"?e:ja(e),s=typeof e=="string"?e:Xn(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=q2(t,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return t}var ha={encode_col:ui,encode_row:Wi,encode_cell:On,encode_range:Xn,decode_col:AR,decode_row:hR,split_cell:t5e,decode_cell:di,decode_range:cu,format_cell:NA,sheet_add_aoa:Xne,sheet_add_json:bse,sheet_add_dom:hse,aoa_to_sheet:C1,json_to_sheet:M8e,table_to_sheet:Ase,table_to_book:YMe,sheet_to_csv:RR,sheet_to_txt:yse,sheet_to_json:ej,sheet_to_html:fse,sheet_to_formulae:R8e,sheet_to_row_object_array:ej,sheet_get_cell:q2,book_new:MR,book_append_sheet:LR,book_set_sheet_visibility:U8e,cell_set_number_format:Q8e,cell_set_hyperlink:wse,cell_set_internal_link:V8e,cell_add_comment:H8e,sheet_set_array_formula:$8e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const xP="pollo_cash_audits";async function G8e(t){return(await Gn(Ct(Ce,xP),{...t,createdAt:t.createdAt??yr.now()})).id}async function K8e(t){const e=Ct(Ce,xP),r=(()=>{if(t!=null&&t.createdFrom&&(t!=null&&t.createdTo)){const s=yr.fromDate(t.createdFrom),o=yr.fromDate(t.createdTo);return sr(e,cr("createdAt",">=",s),cr("createdAt","<=",o),Sn("createdAt","desc"))}return sr(e,Sn("createdAt","desc"))})();return(await Ht(r)).docs.map(s=>{const o=s.data();return{id:s.id,createdAt:o.createdAt,createdByUid:o.createdByUid||"",createdByName:o.createdByName||"",contadorUid:o.contadorUid||"",contadorName:o.contadorName||"",entregadoPor:o.entregadoPor||"",recibidoPor:o.recibidoPor||"",rangeFrom:o.rangeFrom||"",rangeTo:o.rangeTo||"",ventasCash:Number(o.ventasCash||0),abonos:Number(o.abonos||0),ingresosExtra:Number(o.ingresosExtra||0),debitos:Number(o.debitos||0),subTotal:Number(o.subTotal||0),totalEntregado:Number(o.totalEntregado||0),comment:o.comment||""}})}async function q8e(t){await Wn(Yt(Ce,xP,t))}async function z8e(t,e){await kn(Yt(Ce,xP,t),e)}const wi=t=>`C$ ${(Number(t)||0).toFixed(2)}`,e_=t=>Number(t||0).toFixed(3),Mi=t=>{const e=Number(String(t??"").replace(/,/g,"."));return isNaN(e)?0:Math.round(e*100)/100},tj=t=>{const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},tp=()=>{const t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},W8e=()=>{const t=new Date;return tj(new Date(t.getFullYear(),t.getMonth(),1))},X8e=()=>{const t=new Date;return tj(new Date(t.getFullYear(),t.getMonth()+1,0))},Y8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),J8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),Nse=t=>String(t??"").toLowerCase().trim(),t_=t=>Number(t.qty??t.quantity??0),b$=t=>["lb","lbs","libra","libras"].includes(Nse(t)),w$=t=>["unidad","unidades","ud","uds","pieza","piezas"].includes(Nse(t));function Z8e(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(!1),[o,l]=g.useState(!1),[c,u]=g.useState(null),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(""),[j,C]=g.useState(tp()),[S,E]=g.useState(tp()),[B,k]=g.useState(0),[T,P]=g.useState(0),[G,ce]=g.useState(0),[ue,le]=g.useState(0),[Ae,ae]=g.useState(""),[_e,De]=g.useState([]),[O,H]=g.useState(0),[K,R]=g.useState(!1),X=g.useMemo(()=>Mi(B+T+G),[B,T,G]),Y=g.useMemo(()=>Mi(X-ue),[X,ue]),[D,Q]=g.useState([]),[te,be]=g.useState(!1),[U,Xe]=g.useState(W8e()),[se,ee]=g.useState(X8e()),[Fe,je]=g.useState([]),[Se,Ze]=g.useState(0),[ut,Et]=g.useState(!1);async function St(){var ie;const Z=(await Ht(sr(Ct(Ce,"users")))).docs.map(xe=>{const de=xe.data();return{uid:xe.id,name:de.displayName||de.name||de.email||xe.id,role:de.role,roles:de.roles}}).filter(xe=>xe.role==="contador"||Array.isArray(xe.roles)&&xe.roles.includes("contador"));h(Z);const Qe=((ie=ic.currentUser)==null?void 0:ie.uid)||"",Ge=Z.find(xe=>xe.uid===Qe)||Z[0];Ge&&(p(Ge.uid),v(Ge.name))}async function Ft(){be(!0);try{const Ie=U&&se?{createdFrom:Y8e(new Date(U)),createdTo:J8e(new Date(se))}:void 0,We=await K8e(Ie);Q(We)}finally{be(!1)}}g.useEffect(()=>{St(),Ft()},[]),g.useEffect(()=>{Ft()},[U,se]),g.useEffect(()=>{(async()=>{if(!(!U||!se)){Et(!0);try{const We=sr(Ct(Ce,"salesV2"),cr("date",">=",U),cr("date","<=",se)),Z=await Ht(We),Qe=[];Z.forEach(xe=>{const de=xe.data(),Me=de.date??"";if(Array.isArray(de.items)&&de.items.length>0){de.items.forEach((me,we)=>{const pt=String(me.productName??"(sin nombre)"),vt=Number(me.qty??0),bt=Number(me.lineFinal??0)||Math.max(0,Number(me.unitPrice||0)*vt-Number(me.discount||0));Qe.push({id:`${xe.id}#${we}`,date:Me,productName:pt,quantity:vt,amount:bt,measurement:me.measurement??de.measurement??"",type:de.type??"CONTADO"})});return}Qe.push({id:xe.id,date:Me,productName:de.productName??"(sin nombre)",quantity:Number(de.quantity??0),amount:Number(de.amount??de.amountCharged??0),measurement:de.measurement??"",type:de.type??"CONTADO"})}),je(Qe);const at=await Ht(Ct(Ce,"ar_movements_pollo"));let Ge=0;const ie=xe=>{var de;return xe!=null&&xe.date?String(xe.date):(de=xe==null?void 0:xe.createdAt)!=null&&de.toDate?tj(xe.createdAt.toDate()):""};at.forEach(xe=>{const de=xe.data();if(String(de.type??"").toUpperCase()!=="ABONO")return;const me=Math.abs(Number(de.amount??0)),we=ie(de);we&&we>=U&&we<=se&&(Ge+=me)}),Ze(Ge)}catch(We){console.error("Error cargando KPIs del periodo:",We),je([]),Ze(0)}finally{Et(!1)}}})()},[U,se]),g.useEffect(()=>{(async()=>{if(!(!j||!S)){R(!0);try{const We=sr(Ct(Ce,"salesV2"),cr("date",">=",j),cr("date","<=",S)),Z=await Ht(We),Qe=[];Z.forEach(xe=>{const de=xe.data(),Me=de.date??"";if(Array.isArray(de.items)&&de.items.length>0){de.items.forEach((me,we)=>{const pt=String(me.productName??"(sin nombre)"),vt=Number(me.qty??0),bt=Number(me.lineFinal??0)||Math.max(0,Number(me.unitPrice||0)*vt-Number(me.discount||0));Qe.push({id:`${xe.id}#${we}`,date:Me,productName:pt,quantity:vt,amount:bt,measurement:me.measurement??de.measurement??"",type:de.type??"CONTADO"})});return}Qe.push({id:xe.id,date:Me,productName:de.productName??"(sin nombre)",quantity:Number(de.quantity??0),amount:Number(de.amount??de.amountCharged??0),measurement:de.measurement??"",type:de.type??"CONTADO"})}),De(Qe);const at=await Ht(Ct(Ce,"ar_movements_pollo"));let Ge=0;const ie=xe=>{var de;return xe!=null&&xe.date?String(xe.date):(de=xe==null?void 0:xe.createdAt)!=null&&de.toDate?tj(xe.createdAt.toDate()):""};at.forEach(xe=>{const de=xe.data();if(String(de.type??"").toUpperCase()!=="ABONO")return;const me=Math.abs(Number(de.amount??0)),we=ie(de);we&&we>=j&&we<=S&&(Ge+=me)}),H(Ge)}catch(We){console.error("Error cargando KPI de modal:",We),De([]),H(0)}finally{R(!1)}}})()},[j,S]);const Qt=g.useMemo(()=>{const Ie=D.reduce((Qe,at)=>Qe+(Number(at.totalEntregado)||0),0),We=D.reduce((Qe,at)=>Qe+(Number(at.debitos)||0),0),Z=D.reduce((Qe,at)=>Qe+(Number(at.subTotal)||0),0);return{sumTotal:Mi(Ie),sumDeb:Mi(We),sumSub:Mi(Z)}},[D]),Ut=g.useMemo(()=>{const Ie=Fe.filter(de=>de.type==="CONTADO"),We=Fe.filter(de=>de.type==="CREDITO"),Z=Ie.reduce((de,Me)=>de+(Me.amount||0),0),Qe=Z+Se,at=Ie.reduce((de,Me)=>b$(Me.measurement)?de+t_(Me):de,0),Ge=Ie.reduce((de,Me)=>w$(Me.measurement)?de+t_(Me):de,0),ie=We.reduce((de,Me)=>b$(Me.measurement)?de+t_(Me):de,0),xe=We.reduce((de,Me)=>w$(Me.measurement)?de+t_(Me):de,0);return{ventasCash:Mi(Z),recaudado:Mi(Qe),lbsCash:e_(at),unitsCash:e_(Ge),lbsCredit:e_(ie),unitsCredit:e_(xe)}},[Fe,Se]),Tt=g.useMemo(()=>{const Z=_e.filter(Qe=>Qe.type==="CONTADO").reduce((Qe,at)=>Qe+(at.amount||0),0)+O;return{recaudado:Mi(Z)}},[_e,O]);function Re(){b(""),I(""),C(tp()),E(tp()),k(0),P(0),ce(0),le(0),ae(""),s(!1),l(!1),u(null)}function Te(Ie){u(Ie.id),e(!0),s(!0),l(!0),p(Ie.contadorUid||""),v(Ie.contadorName||""),b(Ie.recibidoPor||""),I(Ie.entregadoPor||""),C(Ie.rangeFrom||tp()),E(Ie.rangeTo||tp()),k(Number(Ie.ventasCash||0)),P(Number(Ie.abonos||0)),ce(Number(Ie.ingresosExtra||0)),le(Number(Ie.debitos||0)),ae(Ie.comment||"")}async function Ye(){var Ie,We,Z;if(!m)return alert("Seleccione Contador.");if(!y.trim())return alert("Recibido por es obligatorio.");if(!j||!S)return alert("Seleccione el rango arqueado.");if(new Date(j)>new Date(S))return alert("Rango invlido: Desde no puede ser mayor que Hasta.");n(!0);try{if(c)await z8e(c,{contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:j,rangeTo:S,ventasCash:Mi(B),abonos:Mi(T),ingresosExtra:Mi(G),debitos:Mi(ue),subTotal:Mi(X),totalEntregado:Mi(Y),comment:Ae.trim()});else{const Qe=((Ie=ic.currentUser)==null?void 0:Ie.uid)||"",at=((We=ic.currentUser)==null?void 0:We.displayName)||((Z=ic.currentUser)==null?void 0:Z.email)||Qe;await G8e({createdAt:yr.now(),createdByUid:Qe,createdByName:at,contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:j,rangeTo:S,ventasCash:Mi(B),abonos:Mi(T),ingresosExtra:Mi(G),debitos:Mi(ue),subTotal:Mi(X),totalEntregado:Mi(Y),comment:Ae.trim()})}e(!1),Re(),await Ft()}finally{n(!1)}}async function ht(Ie){var Z;if(window.confirm(`Eliminar el arqueo creado el ${(Z=Ie.createdAt)!=null&&Z.toDate?Ie.createdAt.toDate().toLocaleString():""}?`)){n(!0);try{await q8e(Ie.id),await Ft()}finally{n(!1)}}}function Oe(){const Ie=D.map(Qe=>{var at;return{"Fecha de creacin":(at=Qe.createdAt)!=null&&at.toDate?Qe.createdAt.toDate().toLocaleString():"","Rango arqueado":`${Qe.rangeFrom} a ${Qe.rangeTo}`,"Arqueado por (Contador)":Qe.contadorName,"Recibido por":Qe.recibidoPor,"Entregado por":Qe.entregadoPor,"Ventas cash":Qe.ventasCash,Abonos:Qe.abonos,"Ingresos extra":Qe.ingresosExtra,"Sub total":Qe.subTotal,Dbitos:Qe.debitos,"Monto entregado":Qe.totalEntregado,Comentario:Qe.comment||""}}),We=ha.json_to_sheet(Ie),Z=ha.book_new();ha.book_append_sheet(Z,We,"Arqueos"),K2(Z,`arqueos_pollo_${tp()}.xlsx`)}return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Arqueo fsico y entregas (Pollo)"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Registro de arqueos, dbitos por gasto/reabastecimiento y monto entregado."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{Re(),e(!0)},className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo arqueo"}),i.jsx("button",{onClick:Oe,className:"px-3 py-2 rounded bg-emerald-600 text-white text-sm hover:bg-emerald-700",children:"Exportar Excel"})]})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Filtro por fecha (creacin)"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:U,onChange:Ie=>Xe(Ie.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:se,onChange:Ie=>ee(Ie.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]})]}),i.jsx("button",{onClick:()=>{Xe(""),ee("")},className:"mt-2 text-xs text-blue-600 hover:underline",children:"Limpiar filtro"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-xl font-semibold",children:wi(Qt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]})]}),i.jsxs("div",{className:"mt-3 hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Ut.ventasCash)}),ut&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Ut.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.unitsCredit})]})]}),i.jsx("div",{className:"mt-3 md:hidden",children:i.jsx(H5,{title:"KPIs",open:d,onToggle:()=>f(Ie=>!Ie),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Ut.ventasCash)}),ut&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Ut.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Ut.unitsCredit})]})]})]})})}),i.jsx("div",{className:"mt-4 block md:hidden space-y-3",children:te?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):D.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"No hay arqueos en este rango."}):D.map(Ie=>{var We;return i.jsxs("div",{className:"bg-white border rounded-2xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha de creacin"}),i.jsx("div",{className:"font-semibold text-sm",children:(We=Ie.createdAt)!=null&&We.toDate?Ie.createdAt.toDate().toLocaleString():""}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Rango arqueado"}),i.jsxs("div",{className:"text-sm",children:[Ie.rangeFrom," a ",Ie.rangeTo]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto entregado"}),i.jsx("div",{className:"font-semibold",children:wi(Ie.totalEntregado)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-gray-600",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Contador:"})," ",Ie.contadorName]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Recibido:"})," ",Ie.recibidoPor]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Sub total:"})," ",wi(Ie.subTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Dbitos:"})," ",wi(Ie.debitos)]})]}),i.jsxs("div",{className:"mt-3 flex justify-end",children:[i.jsx("button",{type:"button",onClick:()=>Te(Ie),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>ht(Ie),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},Ie.id)})}),i.jsxs("div",{className:"mt-4 bg-white rounded shadow overflow-hidden hidden md:block",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Arqueos guardados"}),i.jsx("div",{className:"text-xs text-gray-500",children:te?"Cargando...":`${D.length} registro(s)`})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 text-gray-600",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left px-3 py-2",children:"Fecha de creacin"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Rango arqueado"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Arqueado por"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Recibido por"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Sub total"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Dbitos"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Monto entregado"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[!te&&D.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-3 py-6 text-center text-gray-500",children:"No hay arqueos en este rango."})}),D.map(Ie=>{var We;return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-3 py-2",children:(We=Ie.createdAt)!=null&&We.toDate?Ie.createdAt.toDate().toLocaleString():""}),i.jsxs("td",{className:"px-3 py-2",children:[Ie.rangeFrom," a ",Ie.rangeTo]}),i.jsx("td",{className:"px-3 py-2",children:Ie.contadorName}),i.jsx("td",{className:"px-3 py-2",children:Ie.recibidoPor}),i.jsx("td",{className:"px-3 py-2 text-right font-medium",children:wi(Ie.subTotal)}),i.jsx("td",{className:"px-3 py-2 text-right",children:wi(Ie.debitos)}),i.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:wi(Ie.totalEntregado)}),i.jsxs("td",{className:"px-3 py-2 text-right",children:[i.jsx("button",{type:"button",onClick:()=>Te(Ie),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>ht(Ie),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},Ie.id)})]})]})})]}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-3xl rounded shadow-lg overflow-hidden",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:c?"Editar arqueo":"Nuevo arqueo"}),i.jsx("button",{onClick:()=>{e(!1),Re()},className:"text-sm px-2 py-1 rounded hover:bg-gray-100",children:""})]}),i.jsxs("div",{className:"p-3 md:p-4 space-y-3 text-sm",children:[i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx(H5,{title:"Datos colaboradores",open:a,onToggle:()=>s(Ie=>!Ie),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:Ie=>{const We=Ie.target.value,Z=A.find(Qe=>Qe.uid===We);p(We),v((Z==null?void 0:Z.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(Ie=>i.jsx("option",{value:Ie.uid,children:Ie.name},Ie.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:Ie=>b(Ie.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:Ie=>I(Ie.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:j,onChange:Ie=>C(Ie.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:Ie=>E(Ie.target.value),className:"w-full border rounded px-2 py-2"})]})]})]})}),i.jsxs(H5,{title:"Inputs y KPIs",open:o,onToggle:()=>l(Ie=>!Ie),children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:wi(Tt.recaudado)}),K&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsx(x0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(x0,{label:"Abonos",value:T,onChange:P}),i.jsx(x0,{label:"Ingresos extra oficiales",value:G,onChange:ce}),i.jsx(x0,{label:"Dbitos (gasto o reabastecimiento)",value:ue,onChange:le})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[i.jsx(r_,{title:"Sub total (ventas + abonos + ingresos)",value:wi(X)}),i.jsx(r_,{title:"Total (sub total - dbitos)",value:wi(Y)})]})]})]}),i.jsxs("div",{className:"hidden md:block space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:Ie=>{const We=Ie.target.value,Z=A.find(Qe=>Qe.uid===We);p(We),v((Z==null?void 0:Z.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(Ie=>i.jsx("option",{value:Ie.uid,children:Ie.name},Ie.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:Ie=>b(Ie.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:Ie=>I(Ie.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:j,onChange:Ie=>C(Ie.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:Ie=>E(Ie.target.value),className:"w-full border rounded px-2 py-2"})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:wi(Tt.recaudado)}),K&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(x0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(x0,{label:"Abonos",value:T,onChange:P}),i.jsx(x0,{label:"Ingresos extra oficiales",value:G,onChange:ce}),i.jsx(x0,{label:"Dbitos (gasto o reabastecimiento)",value:ue,onChange:le})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(r_,{title:"Sub total (ventas + abonos + ingresos)",value:wi(X)}),i.jsx(r_,{title:"Total (sub total - dbitos)",value:wi(Y)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Comentario / Nota"}),i.jsx("textarea",{value:Ae,onChange:Ie=>ae(Ie.target.value),className:"w-full border rounded px-2 py-2 min-h-[90px]",placeholder:"Opcional..."})]})]}),i.jsxs("div",{className:"p-3 border-t flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>{e(!1),Re()},className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",disabled:r,children:"Cancelar"}),i.jsx("button",{onClick:Ye,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-60",disabled:r,children:r?"Guardando...":c?"Guardar cambios":"Guardar arqueo"})]})]})})]})}function r_({title:t,value:e}){return i.jsxs("div",{className:"bg-gray-50 border rounded p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-semibold",children:e})]})}function x0({label:t,value:e,onChange:r}){return i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:t}),i.jsx("input",{inputMode:"decimal",value:String(e),onChange:n=>r(Mi(n.target.value)),className:"w-full border rounded px-2 py-2",placeholder:"0.00"})]})}function H5({title:t,open:e,onToggle:r,children:n}){return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold text-sm",children:t}),i.jsx("button",{type:"button",onClick:r,className:"text-xs px-3 py-1.5 rounded border hover:bg-gray-50",children:e?"Cerrar":"Ver"})]}),e&&i.jsx("div",{className:"px-3 pb-3 pt-1",children:n})]})}const js=t=>`C$ ${Number(t??0).toFixed(2)}`,rp=t=>Number(t??0).toFixed(3);async function eLe(t){const e=new Set;for(const n of t)for(const a of n.batches||[]){const s=(a.batchId||a.id||"").trim();if(!s)continue;(a.purchasePrice===void 0||a.purchasePrice===null)&&(a.invoiceTotal===void 0||a.invoiceTotal===null)&&e.add(s)}if(e.size===0)return t;const r=new Map;return await Promise.all(Array.from(e).map(async n=>{try{const a=await gs(Yt(Ce,"inventory_batches",n));if(a.exists()){const s=a.data();r.set(n,Number(s.purchasePrice||0))}}catch{}})),t.map(n=>({...n,batches:(n.batches||[]).map(a=>{if((a.purchasePrice===void 0||a.purchasePrice===null)&&(a.invoiceTotal===void 0||a.invoiceTotal===null)){const s=(a.batchId||a.id||"").trim(),o=s?r.get(s):void 0;if(o!==void 0)return{...a,purchasePrice:o}}return a})}))}function $5(t){var p,x;const e=t.batches||[],r=t.expenses||[],n=t.adjustments||[],a=Number(((p=t.totals)==null?void 0:p.lbs)??t.totalLbs??0),s=Number(((x=t.totals)==null?void 0:x.units)??t.totalUnits??0);let o=0,l=0;for(const v of e){const y=Number(v.quantity??0);let b=v.expectedTotal!==void 0&&v.expectedTotal!==null?Number(v.expectedTotal):y*Number(v.salePrice??0);isFinite(b)||(b=0);let w=y*Number(v.purchasePrice??Number.NaN);isFinite(w)||(w=v.invoiceTotal!==void 0&&v.invoiceTotal!==null?Number(v.invoiceTotal):0),o+=b,l+=w}const c=r.reduce((v,y)=>v+Number(y.amount||0),0),u=n.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),d=n.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):u,A=t.totalCredits!==void 0?Number(t.totalCredits):d,h=o-l,m=o-c-f+A;return{lbs:a,units:s,expectedSum:o,invoicedSum:l,expenses:c,debits:f,credits:A,grossProfit:h,finalAmount:m}}function tLe(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),[u,d]=g.useState([]),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState(""),b=t.filter(P=>{let G=!0;return f&&P.date<f&&(G=!1),h&&P.date>h&&(G=!1),p&&!(P.number||"").toLowerCase().includes(p.toLowerCase())&&(G=!1),v&&P.status!==v&&(G=!1),G}),[w,I]=g.useState(1),j=5,C=Math.ceil(b.length/j)||1,S=b.slice((w-1)*j,w*j);oi.useEffect(()=>{I(1)},[f,h,p,v,t]);const E=async()=>{n(!0);const P=sr(Ct(Ce,"invoices"),Sn("date","desc")),G=await Ht(P),ce=[];G.forEach(ae=>{const _e=ae.data();ce.push({id:ae.id,..._e,batches:_e.batches||[],expenses:_e.expenses||[],adjustments:_e.adjustments||[],totals:_e.totals||{lbs:_e.totalLbs||0,units:_e.totalUnits||0,amount:_e.totalAmount||0,expenses:_e.totalExpenses||0,finalAmount:_e.finalAmount||0,invoiceTotal:_e.invoiceTotal||0},totalDebits:_e.totalDebits||0,totalCredits:_e.totalCredits||0})});const ue=await eLe(ce);e(ue);const le=await Ht(Ct(Ce,"inventory_batches")),Ae=[];le.forEach(ae=>{const _e=ae.data();Ae.push({id:ae.id,..._e})}),d(Ae),n(!1)};g.useEffect(()=>{E()},[]);const B=async P=>{const G=P.status==="PAGADA"?"PENDIENTE":"PAGADA";await kn(Yt(Ce,"invoices",P.id),{status:G}),e(ce=>ce.map(ue=>ue.id===P.id?{...ue,status:G}:ue)),(a==null?void 0:a.id)===P.id&&s({...P,status:G})},k=async P=>{if(window.confirm(`Eliminar factura del ${P.date}?`))try{const G=Yt(Ce,"invoices",P.id),ce=await gs(G),ue=ce.exists()?ce.data():null,le=Ic(Ce),Ae=(ue==null?void 0:ue.batches)||[];for(const ae of Ae){const _e=ae.batchId||ae.id;if(!_e)continue;const De=Yt(Ce,"inventory_batches",_e);le.update(De,{invoiceId:null,invoiceNumber:null,invoiceTotal:null})}le.delete(G),await le.commit(),e(ae=>ae.filter(_e=>_e.id!==P.id)),(a==null?void 0:a.id)===P.id&&s(null)}catch(G){console.error(G),alert("No se pudo eliminar la factura por completo.")}},T=async()=>{if(!o.current||!a)return;const P=o.current,G=await Hm(P,{backgroundColor:"#ffffff",onclone:ae=>{const _e=ae.body;_e.style.background="#ffffff",_e.querySelectorAll("*").forEach(De=>{const O=ae.defaultView.getComputedStyle(De);O.boxShadow&&O.boxShadow!=="none"&&(De.style.boxShadow="none")})},scale:2}),ce=G.toDataURL("image/png"),ue=new rn("p","mm","a4"),le=ue.internal.pageSize.getWidth(),Ae=G.height*le/G.width;ue.addImage(ce,"PNG",0,0,le,Ae),ue.save(`factura_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Facturacin"}),i.jsx("div",{className:"mb-4 flex justify-end",children:i.jsx("button",{type:"button",className:"px-4 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>c(!0),children:"Crear factura"})}),l&&i.jsx(Ane,{paidBatches:u,onClose:()=>c(!1),onCreated:()=>{c(!1),E()}}),i.jsxs("div",{className:"bg-white p-3 rounded-xl shadow border mb-4 flex flex-wrap gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:P=>A(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:h,onChange:P=>m(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"N factura"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-1",placeholder:"Buscar...",value:p,onChange:P=>x(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:v,onChange:P=>y(P.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"PAGADA",children:"Pagada"}),i.jsx("option",{value:"PENDIENTE",children:"Pendiente"})]})]}),i.jsx("button",{type:"button",className:"ml-auto text-xs px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),m(""),x(""),y("")},children:"Limpiar filtros"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4",children:i.jsxs("table",{className:"min-w-full w-full- text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"N factura"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Unidades"}),i.jsx("th",{className:"p-2 border",children:"Facturado"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),i.jsx("th",{className:"p-2 border",children:"Gastos"}),i.jsx("th",{className:"p-2 border",children:"Dbitos"}),i.jsx("th",{className:"p-2 border",children:"Crditos"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsxs("tbody",{children:[r?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Sin facturas"})}):S.map(P=>{const G=$5(P);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:P.number||""}),i.jsx("td",{className:"p-2 border",children:P.description||""}),i.jsx("td",{className:"p-2 border",children:rp(G.lbs)}),i.jsx("td",{className:"p-2 border",children:rp(G.units)}),i.jsx("td",{className:"p-2 border",children:js(G.invoicedSum)}),i.jsx("td",{className:"p-2 border",children:js(G.expectedSum)}),i.jsx("td",{className:"p-2 border",children:js(G.expenses)}),i.jsx("td",{className:"p-2 border",children:js(G.debits)}),i.jsx("td",{className:"p-2 border",children:js(G.credits)}),i.jsx("td",{className:"p-2 border",children:js(G.finalAmount)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:P.status})}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(P),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>B(P),children:P.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>k(P),children:"Eliminar"})]})})]},P.id)}),i.jsxs("div",{className:"flex justify-center items-center gap-2 mb-4",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",onClick:()=>I(P=>Math.max(1,P-1)),disabled:w===1,children:"Anterior"}),i.jsxs("span",{className:"text-sm",children:["Pgina ",w," de ",C]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",onClick:()=>I(P=>Math.min(C,P+1)),disabled:w===C,children:"Siguiente"})]})]})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:T,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const P=$5(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras:"})," ",rp(P.lbs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades:"})," ",rp(P.units)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Facturado:"})," ",js(P.invoicedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Ventas (Esperado):"})," ",js(P.expectedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia Bruta:"})," ",js(P.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",js(P.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",js(P.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",js(P.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Lotes"}),i.jsxs("table",{className:"min-w-full text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:(a.batches||[]).map((P,G)=>{const ce=Number(P.quantity??0),ue=P.expectedTotal!==void 0&&P.expectedTotal!==null?Number(P.expectedTotal):ce*Number(P.salePrice??0);let le=ce*Number(P.purchasePrice??Number.NaN);isFinite(le)||(le=P.invoiceTotal!==void 0&&P.invoiceTotal!==null?Number(P.invoiceTotal):0);const Ae=ue-le;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.productName||"(sin nombre)"}),i.jsx("td",{className:"p-2 border",children:(P.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:rp(P.quantity)}),i.jsx("td",{className:"p-2 border",children:js(P.salePrice)}),i.jsx("td",{className:"p-2 border",children:js(le)}),i.jsx("td",{className:"p-2 border",children:js(ue)}),i.jsx("td",{className:"p-2 border",children:js(Ae)})]},G)})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((P,G)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:P.description}),i.jsx("td",{className:"p-2 border",children:js(P.amount)})]},G)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin gastos"})})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((P,G)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.description}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:P.type})}),i.jsx("td",{className:"p-2 border",children:js(P.amount)}),i.jsx("td",{className:"p-2 border",children:a.date})]},G)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin cargos extras"})})})]}),(()=>{const P=$5(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:rp(P.lbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:rp(P.units)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:js(P.invoicedSum)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:js(P.expectedSum)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:js(P.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:js(P.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:js(P.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:js(P.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Monto final (esperado  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:js(P.finalAmount)})]})})]})})()]})]})}const Vo=t=>`C$ ${(Number(t)||0).toFixed(2)}`,rLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function n_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function nLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function aLe(t){const e="ROP",r=n_(t.subcat).slice(0,3)||"GEN",n=nLe(t.gender),a=n_(t.color).slice(0,3)||"COL",s=n_(t.size)||"TLL",o=n_(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${a}-${s}-${o}-${l}`}const wy=/^[A-Za-z0-9._-]{0,32}$/;function sLe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(Lr(new Date,"yyyy-MM-dd")),[y,b]=g.useState(0),[w,I]=g.useState(0),[j,C]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(0),[T,P]=g.useState(""),[G,ce]=g.useState(""),[ue,le]=g.useState(""),[Ae,ae]=g.useState(""),[_e,De]=g.useState(""),[O,H]=g.useState(""),[K,R]=g.useState(""),[X,Y]=g.useState(!1),[D,Q]=g.useState(""),[te,be]=g.useState("Camisa"),[U,Xe]=g.useState(null),[se,ee]=g.useState(""),[Fe,je]=g.useState(0),[Se,Ze]=g.useState(0),[ut,Et]=g.useState(0),[St,Ft]=g.useState(0),[Qt,Ut]=g.useState(0),[Tt,Re]=g.useState(""),[Te,Ye]=g.useState(""),[ht,Oe]=g.useState(""),[Ie,We]=g.useState(""),[Z,Qe]=g.useState(""),[at,Ge]=g.useState(""),[ie,xe]=g.useState(""),[de,Me]=g.useState(null),[me,we]=g.useState({x:0,y:0}),[pt,vt]=g.useState(!1);g.useEffect(()=>{const z=()=>Me(null),re=V=>V.key==="Escape"&&Me(null);return document.addEventListener("click",z),document.addEventListener("keydown",re),()=>{document.removeEventListener("click",z),document.removeEventListener("keydown",re)}},[]);const bt=(z,re,V=192,L=160)=>{let Be=z;z+V+8>window.innerWidth&&(Be=z-V),Be=Math.max(8,Math.min(Be,window.innerWidth-V-8));let ye=re;return re+L+8>window.innerHeight&&(ye=window.innerHeight-L-8),ye=Math.max(8,Math.min(ye,window.innerHeight-L-8)),{x:Be,y:ye}},kt=(z,re)=>{z.stopPropagation();const V=z.currentTarget.getBoundingClientRect(),L=V.right,fe=V.bottom,Be=bt(L,fe);we(Be),Me(ye=>ye===re?null:re)};g.useEffect(()=>{const z=()=>Me(null),re=V=>{V.key==="Escape"&&Me(null)};return document.addEventListener("click",z),document.addEventListener("keydown",re),()=>{document.removeEventListener("click",z),document.removeEventListener("keydown",re)}},[]),g.useEffect(()=>{if(!de)return;const z=()=>Me(null);return window.addEventListener("scroll",z,!0),window.addEventListener("resize",z),()=>{window.removeEventListener("scroll",z,!0),window.removeEventListener("resize",z)}},[de]),g.useEffect(()=>{(async()=>{const z=await Ht(Ct(Ce,"products_clothes")),re=[];z.forEach(Be=>{const ye=Be.data();re.push({id:Be.id,name:ye.name??"(sin nombre)",category:ye.category??"(sin categora)",measurement:ye.measurement??"unidad",price:Number(ye.price??0),sku:ye.sku||"",size:ye.size||"",color:ye.color||"",gender:ye.gender||"",brand:ye.brand||""})}),e(re);const V=sr(Ct(Ce,"inventory_clothes_batches"),Sn("date","desc")),L=await Ht(V),fe=[];L.forEach(Be=>{const ye=Be.data();fe.push({id:Be.id,productId:ye.productId,productName:ye.productName,category:ye.category,unit:ye.unit,quantity:Number(ye.quantity||0),remaining:Number(ye.remaining??ye.quantity??0),purchasePrice:Number(ye.purchasePrice||0),salePrice:Number(ye.salePrice||0),invoiceTotal:Number(ye.invoiceTotal??Number(ye.quantity||0)*Number(ye.purchasePrice||0)),expectedTotal:Number(ye.expectedTotal??Number(ye.quantity||0)*Number(ye.salePrice||0)),date:ye.date,createdAt:ye.createdAt,status:ye.status,notes:ye.notes||"",sku:ye.sku||"",size:ye.size||"",color:ye.color||"",gender:ye.gender||"",brand:ye.brand||"",clientCode:ye.clientCode||""})}),n(fe),s(!1)})()},[]),g.useEffect(()=>{const z=t.find(re=>re.id===m);z&&(C(Number(z.price||0)),z.sku&&ce(z.sku),z.size&&le(re=>re||z.size),z.color&&ae(re=>re||z.color),z.gender&&De(re=>re||z.gender),z.brand&&H(re=>re||z.brand))},[m,t]),g.useEffect(()=>{E(Math.floor(y*w*100)/100)},[y,w]),g.useEffect(()=>{k(Math.floor(y*j*100)/100)},[y,j]),g.useEffect(()=>{const z=t.find(L=>L.id===m);if(z!=null&&z.sku){ce(z.sku);return}const re=X&&te?te:(z==null?void 0:z.category)||"";if(!re&&!_e&&!Ae&&!ue&&!O){ce("");return}const V=aLe({subcat:re,gender:_e||"",color:Ae||"",size:ue||"",brand:O||""});ce(V)},[X,te,m,_e,Ae,ue,O,t]);const Vt=g.useMemo(()=>r.filter(z=>!(c&&z.date<c||d&&z.date>d||A&&z.productId!==A)),[r,c,d,A]),ke=g.useMemo(()=>{const z=Vt.reduce((fe,Be)=>fe+(Be.invoiceTotal||0),0),re=Vt.reduce((fe,Be)=>fe+(Be.expectedTotal||0),0),V=Vt.reduce((fe,Be)=>fe+Be.quantity,0),L=Vt.reduce((fe,Be)=>fe+Be.remaining,0);return{udsIng:V,udsRem:L,totalFacturado:z,totalEsperado:re}},[Vt]),Ne=async z=>{z.preventDefault(),l("");const re=!!m&&!X,V=t.find(ye=>ye.id===m),L=re?(V==null?void 0:V.name)||"":D||"",fe=re?(V==null?void 0:V.category)||"":te||"General",Be=re&&(V==null?void 0:V.measurement)||"unidad";if(!L||y<=0||w<=0){l("Completa nombre/cantidad/costo.");return}if(K&&!wy.test(K)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const ye=await Gn(Ct(Ce,"inventory_clothes_batches"),{productId:re?V.id:"",productName:L,category:fe,unit:Be,quantity:y,remaining:y,purchasePrice:w,salePrice:j,invoiceTotal:S,expectedTotal:B,date:x,createdAt:yr.now(),status:"PENDIENTE",notes:T||"",sku:G||"",size:ue||"",color:Ae||"",gender:_e||"",brand:O||"",clientCode:K||""});n($e=>[{id:ye.id,productId:re?V.id:"",productName:L,category:fe,unit:Be,quantity:y,remaining:y,purchasePrice:w,salePrice:j,invoiceTotal:S,expectedTotal:B,date:x,createdAt:yr.now(),status:"PENDIENTE",notes:T||"",sku:G||"",size:ue||"",color:Ae||"",gender:_e||"",brand:O||"",clientCode:K||""},...$e]),l(" Lote de ropa creado"),p(""),v(Lr(new Date,"yyyy-MM-dd")),b(0),I(0),C(0),E(0),k(0),P(""),ce(""),le(""),ae(""),De(""),H(""),R(""),Y(!1),Q(""),be("Camisa")}catch(ye){console.error(ye),l(" Error al crear lote")}},pe=async z=>{confirm(`Marcar PAGADO el lote del ${z.date} (${z.productName})?`)&&(await kn(Yt(Ce,"inventory_clothes_batches",z.id),{status:"PAGADO"}),n(V=>V.map(L=>L.id===z.id?{...L,status:"PAGADO"}:L)))},Le=z=>{Xe(z.id),ee(z.date),je(z.quantity),Ze(z.purchasePrice),Et(z.salePrice),Ft(Number((z.quantity*z.purchasePrice).toFixed(2))),Ut(Number((z.quantity*z.salePrice).toFixed(2))),Re(z.notes||""),Ye(z.sku||""),Oe(z.size||""),We(z.color||""),Qe(z.gender||""),Ge(z.brand||""),xe(z.clientCode||"")},ft=()=>{Xe(null),ee(""),je(0),Ze(0),Et(0),Ft(0),Ut(0),Re(""),Ye(""),Oe(""),We(""),Qe(""),Ge(""),xe("")};g.useEffect(()=>{U&&Ft(Math.floor(Fe*Se*100)/100)},[U,Fe,Se]),g.useEffect(()=>{U&&Ut(Math.floor(Fe*ut*100)/100)},[U,Fe,ut]);const At=async()=>{if(!U)return;const z=r.find(fe=>fe.id===U);if(!z)return;const re=Math.max(0,z.quantity-z.remaining),V=Math.max(0,Fe-re);if(ie&&!wy.test(ie)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const L=Yt(Ce,"inventory_clothes_batches",U);await kn(L,{date:se,quantity:Fe,purchasePrice:Se,salePrice:ut,invoiceTotal:St,expectedTotal:Qt,notes:Tt,remaining:V,sku:Te,size:ht,color:Ie,gender:Z||"",brand:at||"",clientCode:ie||""}),n(fe=>fe.map(Be=>Be.id===U?{...Be,date:se,quantity:Fe,purchasePrice:Se,salePrice:ut,invoiceTotal:St,expectedTotal:Qt,notes:Tt,remaining:V,sku:Te,size:ht,color:Ie,gender:Z||"",brand:at||"",clientCode:ie||""}:Be)),ft(),l(" Lote actualizado")},ct=async z=>{confirm(`Eliminar el lote del ${z.date} (${z.productName})?`)&&(await Wn(Yt(Ce,"inventory_clothes_batches",z.id)),n(V=>V.filter(L=>L.id!==z.id)),l(" Lote eliminado"))},W=()=>{const z=(c?`Desde ${c}`:"Desde inicio")+"  "+(d?`Hasta ${d}`:"Hasta hoy"),re=Be=>(Be||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),V=Vt.map(Be=>`
      <tr>
        <td>${Be.date}</td>
        <td>${(Be.category||"").toUpperCase()}</td>
        <td>${re(Be.productName)}</td>
        <td>${re(Be.sku||"")}</td>
        <td>${re(Be.size||"")}</td>
        <td>${re(Be.color||"")}</td>
        <td>${re(Be.clientCode||"")}</td>
        <td>${re(Be.gender||"")}</td>
        <td>${(Be.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${Be.quantity.toFixed(0)}</td>
        <td style="text-align:right">${Be.remaining.toFixed(0)}</td>
        <td style="text-align:right">${Vo(Be.purchasePrice)}</td>
        <td style="text-align:right">${Vo(Be.salePrice)}</td>
        <td style="text-align:right">${Vo(Be.invoiceTotal||0)}</td>
        <td style="text-align:right">${Vo(Be.expectedTotal||0)}</td>
        <td>${re((Be.notes||"").slice(0,120))}</td>
        <td>${Be.status}</td>
      </tr>`).join(""),L=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${z}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${ke.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${ke.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${Vo(ke.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${Vo(ke.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${Vo(Number((ke.totalEsperado-ke.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${V||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,fe=window.open("","_blank");fe&&(fe.document.open(),fe.document.write(L),fe.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>vt(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:z=>u(z.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:z=>f(z.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:z=>h(z.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(z=>i.jsxs("option",{value:z.id,children:[z.name,"  ",z.category]},z.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:W,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",ke.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",ke.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Vo(ke.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Vo(ke.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Vo(Number((ke.totalEsperado-ke.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):Vt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):Vt.map(z=>{const re=U===z.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:re?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:se,onChange:V=>ee(V.target.value)}):z.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(z.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:z.productName,children:z.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:Te,onChange:V=>Ye(V.target.value)}):i.jsx("span",{className:"block truncate",title:z.sku||"",children:z.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:ht,onChange:V=>Oe(V.target.value)}):z.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:Ie,onChange:V=>We(V.target.value)}):z.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:ie,onChange:V=>{const L=V.target.value;wy.test(L)&&xe(L)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:z.clientCode||"",children:z.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:re?i.jsx("select",{className:"w-full border p-1 rounded",value:Z,onChange:V=>Qe(V.target.value),children:rLe.map(V=>i.jsx("option",{value:V,children:V||""},V))}):z.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(z.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:re?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(Fe)?"":Fe,onChange:V=>je(Math.max(0,parseInt(V.target.value||"0",10)))}):z.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:re?z.remaining:z.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:re?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(Se)?"":Se,onChange:V=>Ze(Math.max(0,parseFloat(V.target.value||"0")))}):Vo(z.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:re?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(ut)?"":ut,onChange:V=>Et(Math.max(0,parseFloat(V.target.value||"0")))}):Vo(z.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Vo(re?St:z.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Vo(re?Qt:z.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:re?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Tt,onChange:V=>Re(V.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:z.notes||"",children:z.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${z.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:z.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:re?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:At,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ft,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:V=>kt(V,z.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},z.id)})})]})})}),de&&Lu.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>Me(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:me.x,top:me.y},onClick:z=>z.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const z=Vt.find(re=>re.id===de);return(z==null?void 0:z.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{Me(null),pe(z)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const z=Vt.find(re=>re.id===de);z&&(Me(null),Le(z))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const z=Vt.find(re=>re.id===de);z&&(Me(null),ct(z))},children:" Borrar"})]})})]}),document.body),pt&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>vt(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>vt(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ne,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:z=>p(z.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(z=>i.jsxs("option",{value:z.id,children:[z.name,"  ",z.category,"  ",z.sku?`SKU: ${z.sku}`:""]},z.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:z=>v(z.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:z=>b(Math.max(0,parseInt(z.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:z=>I(Math.max(0,parseFloat(z.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:j===0?"":j,onChange:z=>C(Math.max(0,parseFloat(z.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:G,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ue,readOnly:!0,onChange:z=>le(z.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Ae,readOnly:!0,onChange:z=>ae(z.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:_e,readOnly:!0,onChange:z=>De(z.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:O,onChange:z=>H(z.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:K,onChange:z=>{const re=z.target.value;wy.test(re)&&R(re)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!wy.test(K)&&K.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:T,onChange:z=>P(z.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[T.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Vo(S),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Vo(B),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>vt(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const iLe=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],oLe=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],lLe=["XS","S","M","L","XL","2XL"],cLe=["2","4","6","8","10","12","14"],uLe=["26","28","30","32","34","36","38"],dLe=["Shein","Usado","Otro"],fLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function a_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function hLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function ALe(t){const e="ROP",r=a_(t.subcat).slice(0,3)||"GEN",n=hLe(t.gender),a=a_(t.color).slice(0,3)||"COL",s=a_(t.size)||"TLL",o=a_(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${a}-${s}-${o}`}const mLe=/^[A-Za-z0-9._-]{0,32}$/;function pLe(){const[t,e]=g.useState(""),[r,n]=g.useState("Camisa"),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState("Shein"),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState("0"),[j,C]=g.useState(""),[S,E]=g.useState(""),B=g.useMemo(()=>{const R=Number(w||0),X=Number(y||0);return Math.floor(R*X*100)/100},[w,y]),[k,T]=g.useState([]),[P,G]=g.useState(!0),[ce,ue]=g.useState(""),{refreshKey:le,refresh:Ae}=Lc(),[ae,_e]=g.useState(!1),De=g.useMemo(()=>r.toLowerCase()==="jean"?uLe:d==="NINO"||d==="NINA"?cLe:lLe,[r,d]);g.useEffect(()=>{p(ALe({subcat:r,gender:d,color:o,size:a,brand:c}))},[r,d,o,a,c]),g.useEffect(()=>{(async()=>{G(!0);const R=sr(Ct(Ce,"products_clothes"),Sn("createdAt","desc")),X=await Ht(R),Y=[];X.forEach(D=>{const Q=D.data();Y.push({id:D.id,name:Q.name??"(sin nombre)",category:Q.category??"",measurement:Q.measurement??"unidad",sku:Q.sku??"",size:Q.size||"",color:Q.color||"",brand:Q.brand||"",gender:Q.gender||"",clientCode:Q.clientCode||"",notes:Q.notes||"",createdAt:Q.createdAt??yr.now()})}),T(Y),G(!1)})()},[le]);const O=()=>{e(""),n("Camisa"),s(""),l(""),u("Shein"),f(""),h(""),v(""),b(""),I("0"),C(""),E("")},H=async R=>{if(R.preventDefault(),ue(""),!t.trim()){ue("Ingresa el nombre del producto.");return}if(A&&!mLe.test(A)){ue("Cdigo del cliente invlido");return}const X=Number(w||0),Y=Number(y||0);if(X<0){ue("La cantidad de piezas debe ser 0 o mayor.");return}if(Y<0){ue("El precio de venta no puede ser negativo.");return}try{const D=await Gn(Ct(Ce,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:yr.now(),price:Y||0});if(T(Q=>[{id:D.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:yr.now()},...Q]),X>0){const Q=new Date().toISOString().slice(0,10),te=j||Q;await Gn(Ct(Ce,"inventory_clothes_batches"),{productId:D.id,productName:t.trim(),category:r,unit:"unidad",quantity:X,remaining:X,purchasePrice:0,salePrice:Y||0,invoiceTotal:0,expectedTotal:B||0,date:te,createdAt:yr.now(),status:"PENDIENTE",notes:S||"",sku:m||"",size:a||"",color:o||"",gender:d||"",brand:c||"",clientCode:A||""})}ue(X>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),O()}catch(D){console.error(D),ue(" Error al crear producto")}},K=async R=>{confirm(`Eliminar el producto "${R.name}"?`)&&(await Wn(Yt(Ce,"products_clothes",R.id)),T(Y=>Y.filter(D=>D.id!==R.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Mc,{onClick:Ae,loading:P}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{_e(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),ae&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:R=>e(R.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:R=>n(R.target.value),children:iLe.map(R=>i.jsx("option",{value:R,children:R},R))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:d,onChange:R=>f(R.target.value),children:fLe.map(R=>i.jsx("option",{value:R,children:R||""},R))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:R=>s(R.target.value),children:[i.jsx("option",{value:"",children:""}),De.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:R=>l(R.target.value),children:[i.jsx("option",{value:"",children:""}),oLe.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:R=>u(R.target.value),children:dLe.map(R=>i.jsx("option",{value:R,children:R},R))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:R=>h(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:R=>b(R.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:w,onChange:R=>I(R.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:j,onChange:R=>C(R.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(B)?"":B.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:O,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>_e(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):k.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):k.map(R=>{var X;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(X=R.createdAt)!=null&&X.toDate?R.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:R.category}),i.jsx("td",{className:"p-2 border",children:R.name}),i.jsx("td",{className:"p-2 border",children:R.sku}),i.jsx("td",{className:"p-2 border",children:R.size||""}),i.jsx("td",{className:"p-2 border",children:R.color||""}),i.jsx("td",{className:"p-2 border",children:R.brand||""}),i.jsx("td",{className:"p-2 border",children:R.gender||""}),i.jsx("td",{className:"p-2 border",children:R.clientCode||""}),i.jsx("td",{className:"p-2 border",children:R.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>K(R),children:"Borrar"})})]},R.id)})})]})}),ce&&i.jsx("p",{className:"mt-2 text-sm",children:ce})]})}async function gLe(t){const{productId:e,quantity:r,saleDate:n,saleId:a}=t,s=Math.max(0,Math.floor(Number(r||0)));if(!e||s<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=sr(Ct(Ce,"inventory_clothes_batches"),cr("productId","==",e)),u=(await Ht(o)).docs.map(f=>({id:f.id,data:f.data()})).sort((f,A)=>{var v,y;const h=String(f.data.date||""),m=String(A.data.date||"");if(h!==m)return h<m?-1:1;const p=((v=f.data.createdAt)==null?void 0:v.seconds)??0,x=((y=A.data.createdAt)==null?void 0:y.seconds)??0;return p-x}).map(f=>Yt(Ce,"inventory_clothes_batches",f.id)),d=[];return await zs(Ce,async f=>{const A=await Promise.all(u.map(m=>f.get(m)));let h=s;for(let m=0;m<u.length&&h>0;m++){const p=u[m],x=A[m];if(!x.exists())continue;const v=x.data(),y=Math.max(0,Math.floor(Number(v.quantity||0))),b=Number.isFinite(Number(v.remaining))?Math.max(0,Math.floor(Number(v.remaining||0))):y;if(b<=0)continue;const w=Math.min(b,h),I=Math.max(0,b-w);f.update(p,{remaining:I}),d.push({batchId:p.id,qty:w,batchDate:String(v.date||""),productName:String(v.productName||"")}),h-=w}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(a)for(const m of d)await Gn(Ct(Ce,"batch_clothes_allocations"),{saleId:a,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:yr.now()})}),{allocations:d}}async function cF(t){const e=Yt(Ce,"sales_clothes",t),r=await gs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const u=n.allocationsByItem[c],d=String((u==null?void 0:u.productId)||c||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];l[d]=f.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}for(const c of n.items){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),f=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))})):l[u]||[];a.push({productId:u,productName:String((c==null?void 0:c.productName)||""),qty:d,allocations:f.length?f:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),u=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),d=Array.isArray(n.allocations)?n.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):[];c&&u>0&&a.push({productId:c,productName:String(l.productName||n.productName||""),qty:u,allocations:d.length?d:void 0})}return a.length===0?(await zs(Ce,async l=>{l.delete(e)}),{restored:0}):a.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await zs(Ce,async c=>{const u=[];for(const f of a)for(const A of f.allocations||[])u.push({ref:Yt(Ce,"inventory_clothes_batches",A.batchId),addBack:Math.max(0,Math.floor(Number(A.qty||0)))});const d=await Promise.all(u.map(f=>c.get(f.ref)));for(let f=0;f<u.length;f++){const A=d[f];if(!A.exists())continue;const h=A.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(u[f].ref,{remaining:m+u[f].addBack})}c.delete(e)}),{restored:a.reduce((c,u)=>c+(u.allocations||[]).reduce((d,f)=>d+f.qty,0),0)}):(await zs(Ce,async l=>{const c={};for(const h of a){if(!h.productId||h.qty<=0)continue;const m=sr(Ct(Ce,"inventory_clothes_batches"),cr("productId","==",h.productId)),x=(await Ht(m)).docs.map(v=>{const y=v.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),w=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:v.id,date:String(y.date||""),quantity:b,remaining:w}}).sort((v,y)=>v.date.localeCompare(y.date));c[h.productId]=x}const u=[];for(const h of a){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)u.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const v=Math.max(0,x.quantity-x.remaining);if(v<=0)continue;const y=Math.min(v,p);u.push({id:x.id,addBack:y}),p-=y}for(const x of m){if(p<=0)break;const v=Math.min(p,h.qty);u.push({id:x.id,addBack:v}),p-=v}}const d={};for(const h of u)d[h.id]=(d[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const f=Object.keys(d).map(h=>Yt(Ce,"inventory_clothes_batches",h)),A=await Promise.all(f.map(h=>l.get(h)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),v=Math.max(0,Math.floor(Number(d[f[h].id]||0)));l.update(f[h],{remaining:x+v})}l.delete(e)}),{restored:a.reduce((l,c)=>l+c.qty,0)})}const N$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Fh=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function s_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function C$(t){const e=sr(Ct(Ce,"ar_movements"),cr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Wn(Yt(Ce,"ar_movements",n.id))))}function xLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async ke=>{e(!0),n(!0),s(ke),l([]);try{const pe=(await Ht(sr(Ct(Ce,"sales_clothes"),cr("__name__","==",ke)))).docs[0],Le=pe==null?void 0:pe.data(),At=(Array.isArray(Le==null?void 0:Le.items)?Le.items:Le!=null&&Le.item?[Le.item]:[]).map(ct=>({productName:String(ct.productName||""),qty:Number(ct.qty||0),unitPrice:Number(ct.unitPrice||0),discount:Number(ct.discount||0),total:Number(ct.total||0)}));l(At)}catch(Ne){console.error(Ne)}finally{n(!1)}},[u,d]=g.useState(""),[f,A]=g.useState("+505 "),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState("ACTIVO"),[b,w]=g.useState(0),[I,j]=g.useState([]),[C,S]=g.useState(!0),[E,B]=g.useState(""),[k,T]=g.useState(null),[P,G]=g.useState(""),[ce,ue]=g.useState("+505 "),[le,Ae]=g.useState(""),[ae,_e]=g.useState(""),[De,O]=g.useState("ACTIVO"),[H,K]=g.useState(0),[R,X]=g.useState(!1),[Y,D]=g.useState(null),[Q,te]=g.useState(!1),[be,U]=g.useState([]),[Xe,se]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[ee,Fe]=g.useState(!1),[je,Se]=g.useState(0),[Ze,ut]=g.useState(new Date().toISOString().slice(0,10)),[Et,St]=g.useState(""),[Ft,Qt]=g.useState(!1),[Ut,Tt]=g.useState(null),[Re,Te]=g.useState(""),[Ye,ht]=g.useState(0),[Oe,Ie]=g.useState(""),[We,Z]=g.useState(!1);g.useEffect(()=>{(async()=>{const ke=sr(Ct(Ce,"customers_clothes"),Sn("createdAt","desc")),Ne=await Ht(ke),pe=[];Ne.forEach(Le=>{const ft=Le.data();pe.push({id:Le.id,name:ft.name??"",phone:ft.phone??"+505 ",place:ft.place??"",notes:ft.notes??"",status:ft.status??"ACTIVO",creditLimit:Number(ft.creditLimit??0),createdAt:ft.createdAt??yr.now(),balance:0})});for(const Le of pe)try{const ft=sr(Ct(Ce,"ar_movements"),cr("customerId","==",Le.id)),At=await Ht(ft);let ct=0;At.forEach(W=>ct+=Number(W.data().amount||0)),Le.balance=ct}catch{Le.balance=0}j(pe),S(!1)})()},[]);const Qe=()=>{d(""),A("+505 "),m(""),x(""),y("ACTIVO"),w(0)},at=async ke=>{if(ke.preventDefault(),B(""),!u.trim()){B("Ingresa el nombre.");return}const Ne=s_(f);if(Ne.length<6){B("Telfono incompleto.");return}try{const pe=await Gn(Ct(Ce,"customers_clothes"),{name:u.trim(),phone:Ne,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:yr.now()});j(Le=>[{id:pe.id,name:u.trim(),phone:Ne,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:yr.now(),balance:0},...Le]),Qe(),Z(!1),B(" Cliente creado")}catch(pe){console.error(pe),B(" Error al crear cliente")}},Ge=ke=>{T(ke.id),G(ke.name),ue(ke.phone||"+505 "),Ae(ke.place||""),_e(ke.notes||""),O(ke.status||"ACTIVO"),K(Number(ke.creditLimit||0))},ie=()=>{T(null),G(""),ue("+505 "),Ae(""),_e(""),O("ACTIVO"),K(0)},xe=async()=>{if(!k)return;const ke=s_(ce);if(!P.trim()){B("Ingresa el nombre.");return}try{await kn(Yt(Ce,"customers_clothes",k),{name:P.trim(),phone:ke,place:le||"",notes:ae||"",status:De,creditLimit:Number(H||0)}),j(Ne=>Ne.map(pe=>pe.id===k?{...pe,name:P.trim(),phone:ke,place:le||"",notes:ae||"",status:De,creditLimit:Number(H||0)}:pe)),ie(),B(" Cliente actualizado")}catch(Ne){console.error(Ne),B(" Error al actualizar")}},de=async ke=>{if(confirm(`Eliminar al cliente "${ke.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{S(!0);const pe=sr(Ct(Ce,"sales_clothes"),cr("customerId","==",ke.id)),Le=await Ht(pe);for(const ct of Le.docs){const W=ct.id;try{await cF(W)}catch(z){console.warn("restoreSaleAndDeleteClothes error",z);try{await Wn(Yt(Ce,"sales_clothes",W))}catch{}}await C$(W)}const ft=sr(Ct(Ce,"ar_movements"),cr("customerId","==",ke.id)),At=await Ht(ft);await Promise.all(At.docs.map(ct=>Wn(Yt(Ce,"ar_movements",ct.id)))),await Wn(Yt(Ce,"customers_clothes",ke.id)),j(ct=>ct.filter(W=>W.id!==ke.id)),B(" Cliente eliminado y prendas devueltas al inventario")}catch(pe){console.error(pe),B(" No se pudo eliminar el cliente.")}finally{S(!1)}},Me=async ke=>{D(ke),U([]),se({saldoActual:0,totalAbonado:0,totalCargos:0}),X(!0),Fe(!1),Se(0),ut(new Date().toISOString().slice(0,10)),St(""),Tt(null),te(!0);try{const Ne=sr(Ct(Ce,"ar_movements"),cr("customerId","==",ke.id)),pe=await Ht(Ne),Le=[];pe.forEach(ft=>{var ct,W;const At=ft.data();Le.push({id:ft.id,date:At.date??((W=(ct=At.createdAt)==null?void 0:ct.toDate)!=null&&W.call(ct)?At.createdAt.toDate().toISOString().slice(0,10):""),type:At.type??"CARGO",amount:Number(At.amount||0),ref:At.ref||{},comment:At.comment||"",createdAt:At.createdAt})}),Le.sort((ft,At)=>{var z,re;if(ft.date!==At.date)return ft.date.localeCompare(At.date);const ct=((z=ft.createdAt)==null?void 0:z.seconds)||0,W=((re=At.createdAt)==null?void 0:re.seconds)||0;return ct-W}),U(Le),me(Le)}catch(Ne){console.error(Ne),B(" No se pudo cargar el estado de cuenta")}finally{te(!1)}},me=ke=>{const Ne=ke.reduce((ft,At)=>ft+(Number(At.amount)||0),0),pe=ke.filter(ft=>Number(ft.amount)<0).reduce((ft,At)=>ft+Math.abs(Number(At.amount)||0),0),Le=ke.filter(ft=>Number(ft.amount)>0).reduce((ft,At)=>ft+Number(At.amount)||0,0);se({saldoActual:Ne,totalAbonado:pe,totalCargos:Le})},we=async()=>{if(!Y)return;B("");const ke=Number(je||0);if(!(ke>0)){B("Ingresa un monto de abono mayor a 0.");return}const Ne=parseFloat(ke.toFixed(2));if(!Ze){B("Selecciona la fecha del abono.");return}try{Qt(!0);const pe={customerId:Y.id,type:"ABONO",amount:-Ne,date:Ze,comment:Et||"",createdAt:yr.now()},ft={id:(await Gn(Ct(Ce,"ar_movements"),pe)).id,date:Ze,type:"ABONO",amount:-Ne,comment:Et||"",createdAt:yr.now()},At=[...be,ft].sort((ct,W)=>{var V,L;if(ct.date!==W.date)return ct.date.localeCompare(W.date);const z=((V=ct.createdAt)==null?void 0:V.seconds)||0,re=((L=W.createdAt)==null?void 0:L.seconds)||0;return z-re});U(At),me(At),j(ct=>ct.map(W=>W.id===Y.id?{...W,balance:(W.balance||0)-Ne}:W)),D(ct=>ct&&{...ct,balance:(ct.balance||0)-Ne}),Se(0),St(""),ut(new Date().toISOString().slice(0,10)),Fe(!1),B(" Abono registrado")}catch(pe){console.error(pe),B(" Error al registrar el abono")}finally{Qt(!1)}},pt=ke=>{Tt(ke.id),Te(ke.date||new Date().toISOString().slice(0,10)),ht(Math.abs(Number(ke.amount||0))),Ie(ke.comment||"")},vt=()=>{Tt(null),Te(""),ht(0),Ie("")},bt=async()=>{if(!Ut)return;const ke=be.findIndex(ft=>ft.id===Ut);if(ke===-1)return;const Ne=be[ke],pe=Number(Ye||0);if(!(pe>0)){B("El monto debe ser mayor a 0.");return}const Le=Ne.type==="ABONO"?-parseFloat(pe.toFixed(2)):+parseFloat(pe.toFixed(2));try{await kn(Yt(Ce,"ar_movements",Ut),{date:Re,amount:Le,comment:Oe||""});const ft=[...be];ft[ke]={...Ne,date:Re,amount:Le,comment:Oe||""},ft.sort((ct,W)=>{var V,L;if(ct.date!==W.date)return ct.date.localeCompare(W.date);const z=((V=ct.createdAt)==null?void 0:V.seconds)||0,re=((L=W.createdAt)==null?void 0:L.seconds)||0;return z-re}),U(ft),me(ft);const At=ft.reduce((ct,W)=>ct+(Number(W.amount)||0),0);j(ct=>ct.map(W=>W.id===(Y==null?void 0:Y.id)?{...W,balance:At}:W)),D(ct=>ct&&{...ct,balance:At}),vt(),B(" Movimiento actualizado")}catch(ft){console.error(ft),B(" Error al actualizar movimiento")}},kt=async ke=>{var pe,Le;if(confirm(`Eliminar este movimiento (${ke.type==="ABONO"?"Abono":"Compra"}) del ${ke.date}?${ke.type==="CARGO"&&((pe=ke.ref)!=null&&pe.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(S(!0),ke.type==="CARGO"&&((Le=ke.ref)!=null&&Le.saleId)){try{await cF(ke.ref.saleId)}catch(ct){console.warn("restoreSaleAndDeleteClothes error",ct),S(!1),B(" No se pudo devolver inventario de la venta.");return}await C$(ke.ref.saleId)}else await Wn(Yt(Ce,"ar_movements",ke.id));const ft=be.filter(ct=>{var W,z;return ke.type==="CARGO"&&((W=ke.ref)!=null&&W.saleId)?((z=ct.ref)==null?void 0:z.saleId)!==ke.ref.saleId:ct.id!==ke.id});U(ft),me(ft);const At=ft.reduce((ct,W)=>ct+(Number(W.amount)||0),0);j(ct=>ct.map(W=>W.id===(Y==null?void 0:Y.id)?{...W,balance:At}:W)),D(ct=>ct&&{...ct,balance:At}),B(" Movimiento eliminado")}catch(ft){console.error(ft),B(" Error al eliminar movimiento")}finally{S(!1)}},Vt=g.useMemo(()=>[...I].sort((ke,Ne)=>{var pe,Le;return ke.status!==Ne.status?ke.status==="BLOQUEADO"?1:-1:(((pe=Ne.createdAt)==null?void 0:pe.seconds)||0)-(((Le=ke.createdAt)==null?void 0:Le.seconds)||0)}),[I]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Z(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:C?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Vt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):Vt.map(ke=>{var pe;const Ne=k===ke.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(pe=ke.createdAt)!=null&&pe.toDate?ke.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:Le=>G(Le.target.value)}):ke.name}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsx("input",{className:"w-full border p-1 rounded",value:ce,onChange:Le=>ue(s_(Le.target.value))}):ke.phone}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsxs("select",{className:"w-full border p-1 rounded",value:le,onChange:Le=>Ae(Le.target.value),children:[i.jsx("option",{value:"",children:""}),N$.map(Le=>i.jsx("option",{value:Le,children:Le},Le))]}):ke.place||""}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsxs("select",{className:"w-full border p-1 rounded",value:De,onChange:Le=>O(Le.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ke.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ke.status})}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(H)?"":H,onChange:Le=>K(Math.max(0,Number(Le.target.value||0)))}):Fh(ke.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Fh(ke.balance||0)}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:ae,onChange:Le=>_e(Le.target.value),maxLength:500}):i.jsx("span",{title:ke.notes||"",children:(ke.notes||"").length>40?(ke.notes||"").slice(0,40)+"":ke.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Ne?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:xe,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ie,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ge(ke),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>de(ke),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Me(ke),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},ke.id)})})]})}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),We&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Z(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Z(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:at,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:u,onChange:ke=>d(ke.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:ke=>A(s_(ke.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:ke=>m(ke.target.value),children:[i.jsx("option",{value:"",children:""}),N$.map(ke=>i.jsx("option",{value:ke,children:ke},ke))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:ke=>y(ke.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:ke=>w(Math.max(0,Number(ke.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:ke=>x(ke.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Z(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),R&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(Y==null?void 0:Y.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Se(0),ut(new Date().toISOString().slice(0,10)),St(""),Fe(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>X(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Fh(Xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Fh(Xe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Fh(Xe.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Q?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):be.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):be.map(ke=>{var pe,Le;const Ne=Ut===ke.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ne?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Re,onChange:ft=>Te(ft.target.value)}):ke.date||""}),i.jsx("td",{className:"p-2 border",children:ke.amount>=0?(pe=ke.ref)!=null&&pe.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(ke.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Le=ke.ref)!=null&&Le.saleId?`Venta #${ke.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsx("input",{className:"w-full border p-1 rounded",value:Oe,onChange:ft=>Ie(ft.target.value),placeholder:"Comentario"}):i.jsx("span",{title:ke.comment||"",children:(ke.comment||"").length>40?(ke.comment||"").slice(0,40)+"":ke.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:Ne?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ye)?"":Ye,onChange:ft=>{const At=Number(ft.target.value||0),ct=Number.isFinite(At)?Math.max(0,parseFloat(At.toFixed(2))):0;ht(ct)},placeholder:"0.00",title:ke.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Fh(ke.amount)}),i.jsx("td",{className:"p-2 border",children:Ne?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:bt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:vt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>pt(ke),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>kt(ke),children:"Borrar"})]})})]},ke.id)})})]})})]})}),ee&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(Y==null?void 0:Y.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ze,onChange:ke=>ut(ke.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:je===0?"":je,onChange:ke=>{const Ne=Number(ke.target.value||0),pe=Number.isFinite(Ne)?Math.max(0,parseFloat(Ne.toFixed(2))):0;Se(pe)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Et,onChange:ke=>St(ke.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Et.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Fe(!1),disabled:Ft,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:we,disabled:Ft,children:Ft?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((ke,Ne)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ke.productName}),i.jsx("td",{className:"p-2 border text-right",children:ke.qty}),i.jsx("td",{className:"p-2 border text-right",children:Fh(ke.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Fh(ke.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Fh(ke.total)})]},Ne))})]})})]})})]})}const yx=t=>`C$ ${(Number(t)||0).toFixed(2)}`,vLe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function yLe(t){if(!t)return 0;const e=sr(Ct(Ce,"inventory_clothes_batches"),cr("productId","==",t)),r=await Ht(e);let n="0000-00-00",a=-1,s=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),u=Number(l.salePrice||0),d=l.createdAt,f=((d==null?void 0:d.seconds)??0)*1e3+((d==null?void 0:d.nanoseconds)??0)/1e6;c>n?(n=c,a=f,s=u):c===n&&f>a&&(a=f,s=u)}),Number(s||0)}async function _$(t){if(!t)return 0;const e=sr(Ct(Ce,"inventory_clothes_batches"),cr("productId","==",t)),r=await Ht(e);let n=0;return r.forEach(a=>n+=Number(a.data().remaining||0)),n}function E$(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function bLe({role:t="",roles:e}={role:""}){const r=e&&e.length?e:t;En(r,"admin"),En(r,"vendedor_ropa");const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState({}),[u,d]=g.useState("CONTADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(new Date().toISOString().slice(0,10)),[v,y]=g.useState(""),[b,w]=g.useState([]),I=g.useMemo(()=>b.reduce((je,Se)=>je+(Se.qty||0),0),[b]),j=g.useMemo(()=>{const je=b.reduce((Se,Ze)=>{const ut=Math.max(0,(Number(Ze.unitPrice)||0)*(Ze.qty||0)-(Number(Ze.discount)||0));return Se+ut},0);return Math.floor(je*100)/100},[b]),[C,S]=g.useState(0),[E,B]=g.useState(""),[k,T]=g.useState(!1),[P,G]=g.useState(!1),[ce,ue]=g.useState(""),[le,Ae]=g.useState("+505 "),[ae,_e]=g.useState(""),[De,O]=g.useState(""),[H,K]=g.useState("ACTIVO"),[R,X]=g.useState(0),Y=()=>{ue(""),Ae("+505 "),_e(""),O(""),K("ACTIVO"),X(0)};g.useEffect(()=>{(async()=>{const je=sr(Ct(Ce,"customers_clothes"),Sn("createdAt","desc")),Se=await Ht(je),Ze=[];Se.forEach(Tt=>{const Re=Tt.data();Ze.push({id:Tt.id,name:Re.name??"",phone:Re.phone??"+505 ",place:Re.place??"",status:Re.status??"ACTIVO",creditLimit:Number(Re.creditLimit??0),balance:0})});for(const Tt of Ze)try{const Re=sr(Ct(Ce,"ar_movements"),cr("customerId","==",Tt.id)),Te=await Ht(Re);let Ye=0;Te.forEach(ht=>Ye+=Number(ht.data().amount||0)),Tt.balance=Ye}catch{Tt.balance=0}a(Ze);const ut=sr(Ct(Ce,"products_clothes"),Sn("createdAt","desc")),Et=await Ht(ut),St=[];Et.forEach(Tt=>{const Re=Tt.data();St.push({id:Tt.id,name:Re.name??"(sin nombre)",sku:Re.sku??""})}),o(St);const Ft=sr(Ct(Ce,"inventory_clothes_batches"),cr("remaining",">",0)),Qt=await Ht(Ft),Ut={};Qt.forEach(Tt=>{const Re=Tt.data(),Te=Re.productId||"",Ye=Number(Re.remaining||0);Te&&(Ut[Te]=(Ut[Te]||0)+Ye)}),c(Ut)})()},[]);const D=g.useMemo(()=>n.find(je=>je.id===f),[n,f]),Q=(D==null?void 0:D.balance)||0,te=u==="CREDITO"?Q+Math.max(0,Number(j||0))-Math.max(0,Number(C||0)):0,be=async je=>{if(!je)return;if(b.some(St=>St.productId===je)){y("");return}const Se=s.find(St=>St.id===je);if(!Se){y("");return}let Ze=await yLe(je);Ze||(Ze=Number((Se==null?void 0:Se.price)||0));const ut=await _$(je),Et={productId:je,productName:Se.name||"",sku:Se.sku||"",unitPrice:Number(Ze)||0,available:Number(ut)||0,qty:0,discount:0};w(St=>[...St,Et]),y("")},U=(je,Se)=>{w(Ze=>Ze.map(ut=>{if(ut.productId!==je)return ut;if(Se==="")return{...ut,qty:0};const Et=Math.max(0,Math.floor(Number(Se)));return{...ut,qty:Et}}))},Xe=(je,Se)=>{w(Ze=>Ze.map(ut=>{if(ut.productId!==je)return ut;if(Se==="")return{...ut,discount:0};const Et=Math.max(0,Math.floor(Number(Se)));return{...ut,discount:Et}}))},se=je=>w(Se=>Se.filter(Ze=>Ze.productId!==je)),ee=async()=>{if(!p)return"Selecciona la fecha.";if(b.length===0)return"Agrega al menos un producto.";const je=b.filter(Se=>(Se.qty||0)>0);if(je.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(j>0))return"El total debe ser mayor a cero.";if(u==="CONTADO"){if(!h.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!f)return"Selecciona un cliente (crdito).";if(C<0)return"El pago inicial no puede ser negativo.";if(C>j)return"El pago inicial no puede superar el total.";if((D==null?void 0:D.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Se of je){const Ze=await _$(Se.productId);if(Se.qty>Ze)return`Inventario insuficiente para "${Se.productName}". Disponible: ${Ze} unidades.`;const ut=(Number(Se.unitPrice)||0)*(Se.qty||0),Et=Number(Se.discount)||0;if(!Number.isInteger(Et)||Et<0)return`El descuento en "${Se.productName}" debe ser entero y  0.`;if(Et>ut)return`El descuento en "${Se.productName}" no puede exceder C$ ${ut.toFixed(2)}.`}return null},Fe=async je=>{je.preventDefault(),B("");const Se=await ee();if(Se){B(" "+Se);return}try{T(!0);const Ze=b.filter(Ft=>(Ft.qty||0)>0).map(Ft=>{const Qt=(Number(Ft.unitPrice)||0)*(Ft.qty||0),Ut=Math.max(0,Math.floor(Number(Ft.discount)||0)),Tt=Math.max(0,Qt-Ut);return{productId:Ft.productId,productName:Ft.productName,sku:Ft.sku||"",qty:Ft.qty,unitPrice:Number(Ft.unitPrice)||0,discount:Ut,total:Math.floor(Tt*100)/100}}),ut={type:u,date:p,createdAt:yr.now(),itemsTotal:Number(j)||0,total:Number(j)||0,quantity:Number(I)||0,items:Ze};u==="CONTADO"?ut.customerName=h.trim():(ut.customerId=f,ut.downPayment=Number(C)||0);const Et=await Gn(Ct(Ce,"sales_clothes"),ut);if(u==="CREDITO"&&f){const Ft={customerId:f,date:p,createdAt:yr.now(),ref:{saleId:Et.id}};await Gn(Ct(Ce,"ar_movements"),{...Ft,type:"CARGO",amount:Number(j)||0}),Number(C)>0&&await Gn(Ct(Ce,"ar_movements"),{...Ft,type:"ABONO",amount:-Number(C)})}const St={};for(const Ft of Ze)if(Ft.qty>0){const{allocations:Qt}=await gLe({productId:Ft.productId,quantity:Ft.qty,saleDate:p,saleId:Et.id});St[Ft.productId]={productId:Ft.productId,allocations:Qt}}await kn(Yt(Ce,"sales_clothes",Et.id),{allocationsByItem:St}),d("CONTADO"),A(""),m(""),x(new Date().toISOString().slice(0,10)),w([]),S(0),u==="CREDITO"&&f&&a(Ft=>Ft.map(Qt=>Qt.id===f?{...Qt,balance:(Qt.balance||0)+(Number(j)||0)-(Number(C)||0)}:Qt)),B(" Venta registrada"),(async()=>{const Ft=sr(Ct(Ce,"inventory_clothes_batches"),cr("remaining",">",0)),Qt=await Ht(Ft),Ut={};Qt.forEach(Tt=>{const Re=Tt.data(),Te=Re.productId||"",Ye=Number(Re.remaining||0);Te&&(Ut[Te]=(Ut[Te]||0)+Ye)}),c(Ut)})()}catch(Ze){console.error(Ze),B(" Error al guardar la venta")}finally{T(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:Fe,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:u,onChange:je=>d(je.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),u==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:h,onChange:je=>m(je.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:f,onChange:je=>A(je.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),n.map(je=>i.jsxs("option",{value:je.status==="ACTIVO"?je.id:"",disabled:je.status==="BLOQUEADO",children:[je.name," | ",je.phone," | Saldo: ",yx(je.balance||0)]},je.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>G(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:yx(Q)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:C===0?"":C,onChange:je=>S(Math.max(0,Number(je.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:yx(te)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:p,onChange:je=>x(je.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:async je=>{const Se=je.target.value;y(Se),await be(Se)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),s.map(je=>{const Se=b.some(Et=>Et.productId===je.id),Ze=l[je.id]||0,ut=Se||Ze<=0;return i.jsxs("option",{value:ut?"":je.id,disabled:ut,children:[je.name," ",je.sku?` ${je.sku}`:""," ",Ze>0?`(disp: ${Ze})`:"(sin stock)",Se?" (seleccionado)":""]},je.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),b.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):b.map(je=>{const Se=Math.max(0,(je.available||0)-(je.qty||0)),Ze=(Number(je.unitPrice)||0)*(je.qty||0),ut=Math.max(0,Ze-(Number(je.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[je.productName,je.sku?`  ${je.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:yx(je.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:Se}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(je.qty)||je.qty===0?"":je.qty,onChange:Et=>U(je.productId,Et.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(je.discount)||je.discount===0?"":je.discount,onChange:Et=>Xe(je.productId,Et.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:yx(ut)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>se(je.productId),title:"Quitar producto",children:""})})]},je.productId)})]}),b.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:I})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:yx(j)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:k,children:k?"Guardando...":"Registrar venta"})})]}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ce,onChange:je=>ue(je.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:le,onChange:je=>Ae(E$(je.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:je=>_e(je.target.value),children:[i.jsx("option",{value:"",children:""}),vLe.map(je=>i.jsx("option",{value:je,children:je},je))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:H,onChange:je=>K(je.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:R===0?"":R,onChange:je=>X(Math.max(0,Number(je.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:De,onChange:je=>O(je.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Y(),G(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(B(""),!ce.trim()){B("Ingresa el nombre del nuevo cliente.");return}const je=E$(le);try{const Se=await Gn(Ct(Ce,"customers_clothes"),{name:ce.trim(),phone:je,place:ae||"",notes:De||"",status:H,creditLimit:Number(R||0),createdAt:yr.now()}),Ze={id:Se.id,name:ce.trim(),phone:je,place:ae||"",status:H,creditLimit:Number(R||0),balance:0};a(ut=>[Ze,...ut]),A(Se.id),Y(),G(!1),B(" Cliente creado")}catch(Se){console.error(Se),B(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),k&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const vo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function vE(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Lr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function wLe(t,e){const r=vE(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},a=Number(t.quantity??n.qty??0),s=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??s??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:a,unitPrice:Number(n.unitPrice??(s&&a?s/a:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function NLe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}function CLe(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),[T,P]=g.useState(!1),[G,ce]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});g.useEffect(()=>{(async()=>{b(!0),I("");try{const O=await Ht(Ct(Ce,"sales_clothes")),H=[],K=[];O.forEach(se=>{const ee=se.data(),Fe=wLe(ee,se.id);Fe&&(Fe.date<=a&&H.push(Fe),Fe.date>=r&&Fe.date<=a&&K.push(Fe))}),u(H),l(K);const R=await Ht(Ct(Ce,"inventory_clothes_batches")),X=[];R.forEach(se=>{const ee=se.data(),Fe=vE(ee);!Fe||Fe>a||X.push({id:se.id,productId:ee.productId,productName:ee.productName||"",date:Fe,quantity:Number(ee.quantity||0),remaining:Number(ee.remaining||0),purchasePrice:Number(ee.purchasePrice||0)})}),f(X);const Y=await Ht(Ct(Ce,"expenses_clothes")),D=[];Y.forEach(se=>{const ee=se.data(),Fe=vE(ee);Fe&&Fe>=r&&Fe<=a&&D.push({id:se.id,date:Fe,category:ee.category||"",description:ee.description||"",amount:Number(ee.amount||0),status:ee.status||""})}),h(D);const Q=await Ht(Ct(Ce,"ar_movements")),te=[],be={};Q.forEach(se=>{const ee=se.data(),Fe=vE(ee);if(!Fe)return;const je=ee.customerId,Se=Number(ee.amount||0);je&&(be[je]=(be[je]||0)+Se),ee.type==="ABONO"&&Fe>=r&&Fe<=a&&te.push({id:se.id,customerId:je,type:"ABONO",amount:Se,date:Fe})}),p(te);const U=await Ht(Ct(Ce,"customers_clothes")),Xe=[];U.forEach(se=>{const ee=se.data();Xe.push({id:se.id,name:ee.name||"",balance:be[se.id]||0})}),v(Xe)}catch(O){console.error(O),I(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ue=g.useMemo(()=>{try{return NLe(d,c,r,a)}catch(O){return console.error(O),0}},[d,c,r,a]),le=g.useMemo(()=>{const O=o.reduce((be,U)=>be+(U.total||0),0),H=A.reduce((be,U)=>be+(U.amount||0),0),K=O-ue,R=K-H,X=m.reduce((be,U)=>be+Math.abs(U.amount||0),0),Y=x.filter(be=>(be.balance||0)>0),D=Y.reduce((be,U)=>be+(U.balance||0),0);let Q=0,te=0;for(const be of o){const U=(be.items||[]).reduce((Xe,se)=>Xe+(Number(se.qty)||0),0);be.type==="CONTADO"?Q+=U:te+=U}return{ventasTotales:O,costoMercaderia:ue,gastosPeriodo:H,gananciaAntes:K,gananciaDespues:R,abonosRecibidos:X,saldosPendientes:D,clientesConSaldo:Y.length,prendasCash:Q,prendasCredito:te}},[o,A,m,x,ue]),Ae=g.useMemo(()=>{const O={};for(const H of o){if(H.type!=="CREDITO"||!H.customerId)continue;const K=(H.items||[]).reduce((R,X)=>R+(Number(X.qty)||0),0);O[H.customerId]=(O[H.customerId]||0)+K}return x.filter(H=>(H.balance||0)>0).map(H=>({customerId:H.id,name:H.name,prendasCredito:O[H.id]||0,saldo:H.balance||0})).sort((H,K)=>K.saldo-H.saldo)},[x,o]),ae=g.useMemo(()=>{const O={};return x.forEach(H=>O[H.id]=H.name),O},[x]),_e=g.useMemo(()=>[...o].sort((O,H)=>H.date.localeCompare(O.date)).map(O=>{var R;const H=(O.items||[]).reduce((X,Y)=>X+(Number(Y.qty)||0),0);let K="Cash";return O.type==="CREDITO"&&O.customerId?K=ae[O.customerId]||"":O.type==="CONTADO"&&(K=((R=O.customerName)==null?void 0:R.trim())||"Cash"),{id:O.id,date:O.date,type:O.type==="CREDITO"?"Crdito":"Cash",customer:K,piezas:H,total:Number(O.total||0)}}),[o,ae]),De=async O=>{C(!0),E({id:O.customerId,name:O.name}),k([]),P(!0),ce({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const H=[];let K=0,R=0,X=0;for(const te of o)if(!(te.type!=="CREDITO"||te.customerId!==O.customerId))for(const be of te.items||[]){const U=Number(be.qty||0),Xe=Number(be.unitPrice||0),se=U*Xe,ee=Math.max(0,Number(be.discount||0)),Fe=Math.max(0,se-ee);H.push({saleId:te.id,date:te.date,productName:be.productName,sku:be.sku||"",qty:U,unitPrice:Xe,lineTotal:se,discount:ee,lineFinal:Fe}),K+=se,R+=ee,X+=Fe}let Y=0;for(const te of m)te.customerId===O.customerId&&(Y+=Math.abs(te.amount||0));const D=x.find(te=>te.id===O.customerId),Q=(D==null?void 0:D.balance)||0;k(H),ce({totalBruto:K,totalDescuento:R,totalFiado:X,saldoActual:Q,abonadoPeriodo:Y})}catch(H){console.error(H),I(" No se pudo cargar el detalle del cliente.")}finally{P(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(Mc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:O=>n(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:O=>s(O.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(le.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(le.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:vo(le.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(le.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:vo(le.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(le.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(le.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:le.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:le.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:le.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):Ae.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):Ae.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De({customerId:O.customerId,name:O.name}),title:"Ver piezas fiadas del periodo",children:O.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:vo(O.saldo)})]},O.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):_e.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):_e.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.customer}),i.jsx("td",{className:"p-2 border",children:O.type}),i.jsx("td",{className:"p-2 border",children:O.piezas}),i.jsx("td",{className:"p-2 border",children:vo(O.total)})]},O.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((O,H)=>O.date.localeCompare(H.date)).map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.category||""}),i.jsx("td",{className:"p-2 border",children:O.description?i.jsx("span",{title:O.description,children:O.description.length>40?O.description.slice(0,40)+"":O.description}):""}),i.jsx("td",{className:"p-2 border",children:vo(O.amount)}),i.jsx("td",{className:"p-2 border",children:O.status||""})]},O.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(S==null?void 0:S.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>C(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(G.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(G.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(G.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(G.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(G.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):B.sort((O,H)=>O.date.localeCompare(H.date)).map((O,H)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.productName}),i.jsx("td",{className:"p-2 border",children:O.sku||""}),i.jsx("td",{className:"p-2 border",children:O.qty}),i.jsx("td",{className:"p-2 border",children:vo(O.unitPrice)}),i.jsx("td",{className:"p-2 border",children:vo(O.lineTotal)}),i.jsx("td",{className:"p-2 border",children:vo(O.discount)}),i.jsx("td",{className:"p-2 border",children:vo(O.lineFinal)})]},`${O.saleId}-${H}`))})]})})]})})]})}const S$=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],i_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function _Le(){const[t,e]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Lr(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,C]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState(""),[G,ce]=g.useState(0),[ue,le]=g.useState("PENDIENTE"),[Ae,ae]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(Ct(Ce,"expenses_clothes"),Sn("date","desc")),Q=await Ht(D),te=[];Q.forEach(be=>{const U=be.data();te.push({id:be.id,date:U.date||Lr(new Date,"yyyy-MM-dd"),category:U.category||"",description:U.description||"",amount:Number(U.amount||0),status:U.status||"PENDIENTE",notes:U.notes||"",createdAt:U.createdAt??yr.now()})}),v(te)}catch(D){console.error(D),I(" Error al cargar gastos")}finally{b(!1)}})()},[]);const _e=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),De=g.useMemo(()=>{const D=_e.reduce((be,U)=>be+(U.amount||0),0),Q=_e.filter(be=>be.status==="PAGADO").reduce((be,U)=>be+(U.amount||0),0),te=D-Q;return{total:D,pagado:Q,pendiente:te}},[_e]),O=()=>{s(Lr(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),I(""),!o){I("Selecciona una categora.");return}if(!c.trim()){I("Ingresa una descripcin.");return}if(!d||d<=0){I("Ingresa un monto vlido.");return}try{const Q=await Gn(Ct(Ce,"expenses_clothes"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:yr.now()});v(te=>[{id:Q.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:yr.now()},...te]),O(),I(" Gasto registrado")}catch(Q){console.error(Q),I(" Error al guardar gasto")}},K=D=>{C(D.id),E(D.date),k(D.category||""),P(D.description||""),ce(Number(D.amount||0)),le(D.status||"PENDIENTE"),ae(D.notes||"")},R=()=>{C(null),E(""),k(""),P(""),ce(0),le("PENDIENTE"),ae("")},X=async()=>{if(j){if(!B){I("Selecciona una categora.");return}if(!T.trim()){I("Ingresa una descripcin.");return}if(!G||G<=0){I("Ingresa un monto vlido.");return}try{await kn(Yt(Ce,"expenses_clothes",j),{date:S,category:B,description:T.trim(),amount:Number(G.toFixed(2)),status:ue,notes:Ae||""}),v(D=>D.map(Q=>Q.id===j?{...Q,date:S,category:B,description:T.trim(),amount:Number(G.toFixed(2)),status:ue,notes:Ae||""}:Q)),R(),I(" Gasto actualizado")}catch(D){console.error(D),I(" Error al actualizar gasto")}}},Y=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await Wn(Yt(Ce,"expenses_clothes",D.id)),v(te=>te.filter(be=>be.id!==D.id)),I(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",i_(De.total)]}),i.jsxs("div",{children:["Pagado: ",i_(De.pagado)]}),i.jsxs("div",{children:["Pendiente: ",i_(De.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S$.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):_e.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):_e.slice().sort((D,Q)=>D.date.localeCompare(Q.date)).map(D=>{const Q=j===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:te=>E(te.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:te=>k(te.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S$.map(te=>i.jsx("option",{value:te,children:te},te))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:te=>P(te.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(G)?"":G,onChange:te=>ce(Math.max(0,Number(te.target.value||0)))}):i_(D.amount)}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:ue,onChange:te=>le(te.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Ae,onChange:te=>ae(te.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:X,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:R,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>K(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Y(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const Zd=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function ELe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Lr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function SLe(t,e){const r=ELe(t);if(!r)return null;const n=t.item||{},a=Number((n==null?void 0:n.qty)??t.quantity??0)||0,s=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(a>0?s/a:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||a||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:a,unitPrice:o,total:a*o}}}async function jLe(t,e){if(e<=0)return;const r=sr(Ct(Ce,"inventory_clothes_batches"),cr("productId","==",t)),n=await Ht(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,s);s-=l,await kn(Yt(Ce,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}s>0&&console.warn("consumeFIFO: falt inventario",s)}async function ILe(t,e){if(e<=0)return;const r=sr(Ct(Ce,"inventory_clothes_batches"),cr("productId","==",t)),n=await Ht(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,s);s-=c,await kn(Yt(Ce,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}s>0&&console.warn("restoreFIFO: no se devolvi todo",s)}async function Cse(t){const e=sr(Ct(Ce,"ar_movements"),cr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Wn(Yt(Ce,"ar_movements",n.id))))}async function PLe(t,e,r){if(await Cse(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:yr.now(),ref:{saleId:t.id}},{addDoc:a}=await lA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>nbe);return{addDoc:o}},void 0);await a(Ct(Ce,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const s=Math.max(0,Number(r??t.downPayment??0));s>0&&await a(Ct(Ce,"ar_movements"),{...n,type:"ABONO",amount:-s})}function TLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async se=>{e(!0),n(!0),s(se),l([]);try{const Fe=(await Ht(sr(Ct(Ce,"sales_clothes"),cr("__name__","==",se)))).docs[0],je=Fe==null?void 0:Fe.data(),Ze=(Array.isArray(je==null?void 0:je.items)?je.items:je!=null&&je.item?[je.item]:[]).map(ut=>({productName:String(ut.productName||""),qty:Number(ut.qty||0),unitPrice:Number(ut.unitPrice||0),discount:Number(ut.discount||0),total:Number(ut.total||0)}));l(Ze)}catch(ee){console.error(ee)}finally{n(!1)}},[u,d]=g.useState(Lr(new Date,"yyyy-MM-01")),[f,A]=g.useState(Lr(new Date,"yyyy-MM-dd")),[h,m]=g.useState([]),[p,x]=g.useState([]),[v,y]=g.useState(!0),[b,w]=g.useState(""),[I,j]=g.useState(""),[C,S]=g.useState(""),[E,B]=g.useState(null),[k,T]=g.useState(!1),[P,G]=g.useState(null),[ce,ue]=g.useState(0),le=15,[Ae,ae]=g.useState(1),_e=g.useMemo(()=>{const se={};return h.forEach(ee=>se[ee.id]=ee.name),se},[h]);g.useEffect(()=>{(async()=>{y(!0),w("");try{const se=await Ht(Ct(Ce,"customers_clothes")),ee=[];se.forEach(Se=>ee.push({id:Se.id,name:Se.data().name||""})),m(ee);const Fe=await Ht(sr(Ct(Ce,"sales_clothes"),Sn("createdAt","desc"))),je=[];Fe.forEach(Se=>{const Ze=SLe(Se.data(),Se.id);Ze&&Ze.date>=u&&Ze.date<=f&&je.push(Ze)}),x(je.sort((Se,Ze)=>Ze.date.localeCompare(Se.date))),ae(1)}catch(se){console.error(se),w(" Error cargando transacciones.")}finally{y(!1)}})()},[u,f]);const De=g.useMemo(()=>p.filter(se=>!(I&&se.customerId!==I||C&&se.type!==C)),[p,I,C]),O=g.useMemo(()=>{let se=0,ee=0,Fe=0,je=0;for(const Se of De)Se.type==="CONTADO"?(se+=Se.item.qty,Fe+=Se.total):(ee+=Se.item.qty,je+=Se.total);return{piezasCash:se,piezasCredito:ee,montoCash:Fe,montoCredito:je}},[De]),H=Math.max(1,Math.ceil(De.length/le)),K=g.useMemo(()=>{const se=(Ae-1)*le;return De.slice(se,se+le)},[De,Ae]),R=se=>{B(null),G(se),ue(se.item.qty||0),T(!0)},X=async se=>{if(B(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await cF(se.id),await Cse(se.id),x(ee=>ee.filter(Fe=>Fe.id!==se.id)),w(" Venta eliminada")}catch(ee){console.error(ee),w(" No se pudo eliminar la venta.")}finally{y(!1)}},Y=async()=>{if(!P)return;const se=Number(P.item.qty||0),ee=Math.max(1,Math.floor(Number(ce)||0));if(ee===se){T(!1);return}const Fe=Number(P.item.unitPrice||0),je=Number((Fe*ee).toFixed(2));try{y(!0);const Se=ee-se;Se>0?await jLe(P.item.productId,Se):Se<0&&await ILe(P.item.productId,-Se);const Ze=Yt(Ce,"sales_clothes",P.id);await kn(Ze,{quantity:ee,total:je,itemsTotal:je,"item.qty":ee,"item.total":je,updatedAt:yr.now()});const ut=Math.min(Number(P.downPayment||0),je);await PLe(P,je,ut),x(Et=>Et.map(St=>St.id===P.id?{...St,quantity:ee,total:je,item:{...St.item,qty:ee,total:je},downPayment:ut}:St)),w(" Venta actualizada"),T(!1)}catch(Se){console.error(Se),w(" No se pudo actualizar la venta.")}finally{y(!1)}},D=()=>{const se=`Reporte de transacciones (Ropa)  ${u} a ${f}`,ee=Ze=>(Ze||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Fe=De.map(Ze=>{const ut=Ze.customerName||(Ze.customerId?_e[Ze.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Ze.date}</td>
          <td>${ee(ut)}</td>
          <td>${Ze.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ze.item.qty}</td>
          <td style="text-align:right">${Zd(Ze.total)}</td>
        </tr>`}).join(""),je=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${ee(se)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${ee(se)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${O.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${O.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${Zd(O.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Zd(O.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${Fe||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Se=window.open("","_blank");Se&&(Se.document.open(),Se.document.write(je),Se.document.close())},Q=()=>ae(1),te=()=>ae(se=>Math.max(1,se-1)),be=()=>ae(se=>Math.min(H,se+1)),U=()=>ae(H),Xe=()=>{const se=[];if(H<=7)for(let Fe=1;Fe<=H;Fe++)se.push(Fe);else{const Fe=Math.max(1,Ae-2),je=Math.min(H,Ae+2);se.push(1),Fe>2&&se.push(-1);for(let Se=Fe;Se<=je;Se++)Se!==1&&Se!==H&&se.push(Se);je<H-1&&se.push(-2),se.push(H)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Q,disabled:Ae===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:te,disabled:Ae===1,children:" Anterior"}),se.map((Fe,je)=>typeof Fe=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${Fe===Ae?"bg-blue-600 text-white":""}`,onClick:()=>ae(Fe),children:Fe},je):i.jsx("span",{className:"px-2",children:""},je)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:be,disabled:Ae===H,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:U,disabled:Ae===H,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Ae," de ",H,"  ",De.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:se=>{d(se.target.value),ae(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:se=>{A(se.target.value),ae(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:I,onChange:se=>{j(se.target.value),ae(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(se=>i.jsx("option",{value:se.id,children:se.name},se.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:C,onChange:se=>{S(se.target.value),ae(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Zd(O.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Zd(O.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:v?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):K.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):K.map(se=>{const ee=se.customerName||(se.customerId?_e[se.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:se.date}),i.jsx("td",{className:"p-2 border",children:ee}),i.jsx("td",{className:"p-2 border",children:se.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(se.id),children:se.item.qty})}),i.jsx("td",{className:"p-2 border",children:Zd(se.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>B(Fe=>Fe===se.id?null:se.id),title:"Acciones",children:""}),E===se.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>R(se),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>X(se),children:"Eliminar"})]})]})]},se.id)})})]}),Xe()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),k&&P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[P.item.productName," ",P.item.sku?` ${P.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:ce,onChange:se=>ue(Math.max(1,Math.floor(Number(se.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:Zd(P.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:Zd(Number(P.item.unitPrice)*Number(ce||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{T(!1),G(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Y,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((se,ee)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:se.productName}),i.jsx("td",{className:"p-2 border text-right",children:se.qty}),i.jsx("td",{className:"p-2 border text-right",children:Zd(se.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Zd(se.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Zd(se.total)})]},ee))})]})})]})})]})}const j$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],qc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,v0=t=>Math.round((Number(t)||0)*100)/100,BLe=new Set(["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"]),Ny=t=>{const e=String(t||"").trim().toUpperCase();return BLe.has(e)?"PAGADA":"PENDIENTE"};function o_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function I$(t){const e=sr(Ct(Ce,"ar_movements_pollo"),cr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Wn(Yt(Ce,"ar_movements_pollo",n.id))))}function kLe({role:t="",roles:e,sellerPolloId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=En(a,"vendedor_pollo"),l=En(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(!1),[j,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),T=async he=>{var tt;I(!0),C(!0),E(he),k([]);try{const nt=await gs(Yt(Ce,"salesV2",he));let lt=null;if(nt.exists()?lt=nt.data():lt=(tt=(await Ht(sr(Ct(Ce,"salesV2"),cr("name","==",he)))).docs[0])==null?void 0:tt.data(),!lt){k([]);return}let ge=[];if(Array.isArray(lt.items)&&lt.items.length>0)ge=lt.items;else if(lt.items&&typeof lt.items=="object")try{ge=Object.values(lt.items)}catch{ge=[]}else lt.item?ge=[lt.item]:Array.isArray(lt.products)&&lt.products.length>0?ge=lt.products:Array.isArray(lt.lines)&&lt.lines.length>0?ge=lt.lines:Array.isArray(lt.detalles)&&lt.detalles.length>0?ge=lt.detalles:(lt.productName||lt.product)&&(ge=[{productName:lt.productName||lt.product||"",qty:lt.qty??lt.quantity??lt.lbs??0,unitPrice:lt.unitPrice??lt.price??0,discount:lt.discount??0,total:lt.total??lt.amount??0}]);const it=Mt=>{if(Mt==null)return NaN;if(typeof Mt=="number")return Mt;let zt=String(Mt).trim();if(!zt)return NaN;if(zt=zt.replace(/[^0-9.,-]/g,""),!zt)return NaN;zt.indexOf(".")>-1&&zt.indexOf(",")>-1?zt=zt.replace(/,/g,""):zt.indexOf(",")>-1&&zt.indexOf(".")===-1&&(zt=zt.replace(/,/g,"."));const ar=Number(zt);return Number.isNaN(ar)?NaN:ar},Pt=new Set;for(const Mt of ge)if(Array.isArray(Mt==null?void 0:Mt.allocations))for(const zt of Mt.allocations){const ar=String((zt==null?void 0:zt.batchId)||"").trim();ar&&Pt.add(ar)}else if(Mt!=null&&Mt.allocations&&typeof Mt.allocations=="object")try{for(const zt of Object.values(Mt.allocations)){const ar=String((zt==null?void 0:zt.batchId)||"").trim();ar&&Pt.add(ar)}}catch{}if(Array.isArray(lt==null?void 0:lt.allocations))for(const Mt of lt.allocations){const zt=String((Mt==null?void 0:Mt.batchId)||"").trim();zt&&Pt.add(zt)}const wt={};Pt.size>0&&await Promise.all(Array.from(Pt).map(async Mt=>{try{const zt=await gs(Yt(Ce,"inventory_batches",Mt));if(zt.exists()){const ar=zt.data();wt[Mt]=Number(ar.salePrice??ar.sale_price??ar.price??0)}}catch{}}));const Nt=new Set;for(const Mt of ge){const zt=String(Mt.productId||"").trim();zt&&Nt.add(zt)}const It={};Nt.size>0&&await Promise.all(Array.from(Nt).map(async Mt=>{try{const zt=await gs(Yt(Ce,"products",Mt));if(zt.exists()){const ar=zt.data();It[Mt]=Number(ar.salePrice??ar.price??0)}}catch{}}));const qt=ge.map(Mt=>{const zt=String(Mt.productName||Mt.product||Mt.name||"(sin nombre)"),ar=Number(Mt.qty??Mt.quantity??Mt.lbs??Mt.weight??0)||0,wr=it(Mt.total??Mt.lineFinal??Mt.amount??Mt.monto??Mt.line_total)||0;let dr=0;const Rt=[Mt.unitPrice,Mt.unitPricePackage,Mt.salePrice,Mt.sale_price,Mt.price,Mt.unit_price,Mt.pricePerUnit,Mt.price_per_unit];for(const jr of Rt){const pr=it(jr);if(!Number.isNaN(pr)&&pr!==0){dr=pr;break}}if(!dr){const jr=(lt==null?void 0:lt.salePrice)??(lt==null?void 0:lt.sale_price)??(lt==null?void 0:lt.unitPrice)??(lt==null?void 0:lt.unit_price)??(lt==null?void 0:lt.price)??(lt==null?void 0:lt.pricePerUnit),pr=it(jr);!Number.isNaN(pr)&&pr!==0&&(dr=pr)}if(!dr){const jr=Array.isArray(Mt.allocations)?Mt.allocations[0]:Mt.allocations&&typeof Mt.allocations=="object"?Object.values(Mt.allocations)[0]:null,pr=jr?String(jr.batchId||"").trim():"";pr&&wt[pr]&&(dr=wt[pr]||0)}!dr&&Mt.productId&&(dr=It[String(Mt.productId)]||0),(!dr||dr===0)&&wr>0&&ar>0&&(dr=wr/ar);const Wr=it(Mt.discount??Mt.desc??0)||0;let Vr=wr;return(!Vr||Vr===0)&&(Vr=Number(dr*ar||0)),Vr=Number(Vr)||0,{productName:zt,qty:ar,unitPrice:dr,discount:Wr,total:Vr}});k(qt)}catch(nt){console.error(nt)}finally{C(!1)}},[P,G]=g.useState(""),[ce,ue]=g.useState("+505 "),[le,Ae]=g.useState(""),[ae,_e]=g.useState(""),[De,O]=g.useState("ACTIVO"),[H,K]=g.useState(0),[R,X]=g.useState(""),[Y,D]=g.useState(0),[Q,te]=g.useState([]),[be,U]=g.useState(!0),[Xe,se]=g.useState(""),[ee,Fe]=g.useState(null),[je,Se]=g.useState(""),[Ze,ut]=g.useState("+505 "),[Et,St]=g.useState(""),[Ft,Qt]=g.useState(""),[Ut,Tt]=g.useState("ACTIVO"),[Re,Te]=g.useState(0),[Ye,ht]=g.useState(""),[Oe,Ie]=g.useState(!1),[We,Z]=g.useState(null),[Qe,at]=g.useState(!1),[Ge,ie]=g.useState([]),[xe,de]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[Me,me]=g.useState(!1),[we,pt]=g.useState(0),[vt,bt]=g.useState(new Date().toISOString().slice(0,10)),[kt,Vt]=g.useState(""),[ke,Ne]=g.useState(!1),[pe,Le]=g.useState(null),[ft,At]=g.useState(""),[ct,W]=g.useState(0),[z,re]=g.useState(""),[V,L]=g.useState(null),[fe,Be]=g.useState(!1),[ye,$e]=g.useState(null),[ze,Ke]=g.useState(!1),[yt,ne]=g.useState(!1),[Ue,rt]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(U(!0),o&&!s){te([]),se(" Este usuario no tiene vendedor asociado (sellerPolloId vaco).");return}const he=await Ht(Ct(Ce,"sellers_candies")),tt=[];he.forEach(it=>{const Pt=it.data();tt.push({id:it.id,name:String(Pt.name||"")})}),u(tt);const nt=o?sr(Ct(Ce,"customers_pollo"),cr("vendorId","==",s),Sn("createdAt","desc")):sr(Ct(Ce,"customers_pollo"),Sn("createdAt","desc")),lt=await Ht(nt),ge=[];lt.forEach(it=>{const Pt=it.data();ge.push({id:it.id,name:Pt.name??"",phone:Pt.phone??"+505 ",place:Pt.place??"",notes:Pt.notes??"",status:Pt.status??"ACTIVO",creditLimit:Number(Pt.creditLimit??0),createdAt:Pt.createdAt??yr.now(),balance:0,vendorId:Pt.vendorId||"",vendorName:Pt.vendorName||"",initialDebt:Number(Pt.initialDebt||0),lastAbonoDate:"",lastAbonoAmount:0})});for(const it of ge)try{const Pt=sr(Ct(Ce,"ar_movements_pollo"),cr("customerId","==",it.id)),wt=await Ht(Pt);let Nt=0,It=null,qt=!1;wt.forEach(wr=>{var Wr,Vr,jr;const dr=wr.data(),Rt=Number(dr.amount||0);if(Nt+=Rt,Rt>0&&Ny(dr.debtStatus??dr.creditStatus??dr.cycleStatus??dr.status)==="PENDIENTE"&&(qt=!0),Rt<0){const pr=dr.date??((Vr=(Wr=dr.createdAt)==null?void 0:Wr.toDate)!=null&&Vr.call(Wr)?dr.createdAt.toDate().toISOString().slice(0,10):""),Pr=(jr=dr.createdAt)!=null&&jr.seconds?Number(dr.createdAt.seconds):0;(!It||Pr>=It.ts)&&(It={date:pr,amount:Math.abs(Rt),ts:Pr})}});const Mt=Number(it.initialDebt||0),zt=v0(Mt+Nt);it.balance=zt,(qt||zt>0)&&It?(it.lastAbonoDate=It.date,it.lastAbonoAmount=It.amount):(it.lastAbonoDate="",it.lastAbonoAmount=0)}catch{it.balance=Number(it.initialDebt||0),it.lastAbonoDate="",it.lastAbonoAmount=0}te(ge)}catch(he){console.error(he),se(" Error cargando clientes.")}finally{U(!1)}})()},[o,s]);const st=()=>{G(""),ue("+505 "),Ae(""),_e(""),O("ACTIVO"),K(0),X(""),D(0)},_t=async he=>{var ge;if(he.preventDefault(),se(""),!P.trim()){se("Ingresa el nombre.");return}const tt=o_(ce);if(tt.length<6){se("Telfono incompleto.");return}const nt=o?s:String(R||""),lt=nt&&((ge=c.find(it=>it.id===nt))==null?void 0:ge.name)||"";try{const it=Number(Y||0),Pt=await Gn(Ct(Ce,"customers_pollo"),{name:P.trim(),phone:tt,place:le||"",notes:ae||"",status:De,creditLimit:Number(H||0),vendorId:nt,vendorName:lt,initialDebt:it,createdAt:yr.now()});te(wt=>[{id:Pt.id,name:P.trim(),phone:tt,place:le||"",notes:ae||"",status:De,creditLimit:Number(H||0),vendorId:nt,vendorName:lt,initialDebt:it,createdAt:yr.now(),balance:it,lastAbonoDate:"",lastAbonoAmount:0},...wt]),st(),Be(!1),se(" Cliente creado")}catch(it){console.error(it),se(" Error al crear cliente")}},Ot=he=>{if(o){se(" No permitido: vendedores no editan clientes desde el listado.");return}Fe(he.id),Se(he.name),ut(he.phone||"+505 "),St(he.place||""),Qt(he.notes||""),Tt(he.status||"ACTIVO"),Te(Number(he.creditLimit||0)),ht(String(he.vendorId||""))},nr=()=>{Fe(null),Se(""),ut("+505 "),St(""),Qt(""),Tt("ACTIVO"),Te(0),ht("")},Ir=async()=>{var Pt;if(o){se(" No permitido.");return}if(!ee)return;const he=o_(Ze);if(!je.trim()){se("Ingresa el nombre.");return}const tt=Q.find(wt=>wt.id===ee),nt=String((tt==null?void 0:tt.vendorId)||""),lt=o?s:String(Ye||"");if(o&&nt&&nt!==s){se(" Este cliente pertenece a otro vendedor.");return}if(l&&nt&&lt&&nt!==lt){se(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const ge=o?s:String(Ye||""),it=ge&&((Pt=c.find(wt=>wt.id===ge))==null?void 0:Pt.name)||"";try{await kn(Yt(Ce,"customers_pollo",ee),{name:je.trim(),phone:he,place:Et||"",notes:Ft||"",status:Ut,creditLimit:Number(Re||0),vendorId:ge,vendorName:it}),te(wt=>wt.map(Nt=>Nt.id===ee?{...Nt,name:je.trim(),phone:he,place:Et||"",notes:Ft||"",status:Ut,creditLimit:Number(Re||0),vendorId:ge,vendorName:it}:Nt)),nr(),se(" Cliente actualizado")}catch(wt){console.error(wt),se(" Error al actualizar")}},Qr=async he=>{if(confirm(`Eliminar al cliente "${he.name}"?
Se borrarn todas sus ventas y movimientos.`))try{U(!0);const nt=sr(Ct(Ce,"salesV2"),cr("customerId","==",he.id)),lt=await Ht(nt);for(const Pt of lt.docs){const wt=Pt.id;try{await Wn(Yt(Ce,"salesV2",wt))}catch(Nt){console.warn("delete sale error",Nt)}await I$(wt)}const ge=sr(Ct(Ce,"ar_movements_pollo"),cr("customerId","==",he.id)),it=await Ht(ge);await Promise.all(it.docs.map(Pt=>Wn(Yt(Ce,"ar_movements_pollo",Pt.id)))),await Wn(Yt(Ce,"customers_pollo",he.id)),te(Pt=>Pt.filter(wt=>wt.id!==he.id)),se(" Cliente eliminado y registros borrados")}catch(nt){console.error(nt),se(" No se pudo eliminar el cliente.")}finally{U(!1)}},or=(he,tt)=>{const nt=he.reduce((Pt,wt)=>Pt+(Number(wt.amount)||0),0),lt=he.filter(Pt=>Number(Pt.amount)<0).reduce((Pt,wt)=>Pt+Math.abs(Number(wt.amount)||0),0),ge=he.filter(Pt=>Number(Pt.amount)>0).reduce((Pt,wt)=>Pt+(Number(wt.amount)||0),0),it=Number(tt||0)+nt;de({saldoActual:it,totalAbonado:lt,totalCargos:Number(tt||0)+ge,saldoRestante:it})},kr=async he=>{Z(he),ie([]),de({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),Ie(!0),Ke(!1),ne(!1),rt(null),me(!1),pt(0),bt(new Date().toISOString().slice(0,10)),Vt(""),Le(null),at(!0);try{const tt=sr(Ct(Ce,"ar_movements_pollo"),cr("customerId","==",he.id)),nt=await Ht(tt),lt=[];nt.forEach(ge=>{var Nt,It;const it=ge.data(),Pt=it.date??((It=(Nt=it.createdAt)==null?void 0:Nt.toDate)!=null&&It.call(Nt)?it.createdAt.toDate().toISOString().slice(0,10):""),wt=Number(it.amount||0);lt.push({id:ge.id,date:Pt,type:it.type??(wt<0?"ABONO":"CARGO"),amount:wt,ref:it.ref||{},comment:it.comment||"",createdAt:it.createdAt,debtStatus:Ny(it.debtStatus??it.creditStatus??it.cycleStatus??it.status)})}),lt.sort((ge,it)=>{var Nt,It;if(ge.date!==it.date)return ge.date.localeCompare(it.date);const Pt=((Nt=ge.createdAt)==null?void 0:Nt.seconds)||0,wt=((It=it.createdAt)==null?void 0:It.seconds)||0;return Pt-wt}),ie(lt),or(lt,Number(he.initialDebt||0))}catch(tt){console.error(tt),se(" No se pudo cargar el estado de cuenta")}finally{at(!1)}},Zr=(he,tt)=>v0(tt||0)>0?!0:he.some(nt=>nt.type==="CARGO"&&Ny(nt.debtStatus)==="PENDIENTE"),nn=he=>{const tt=he.filter(nt=>Number(nt.amount)<0).map(nt=>{var lt;return{date:nt.date,amount:Math.abs(Number(nt.amount||0)),ts:((lt=nt.createdAt)==null?void 0:lt.seconds)||0}}).sort((nt,lt)=>(nt.ts||0)-(lt.ts||0));return tt.length?tt[tt.length-1]:null},_r=async()=>{if(!We)return;se("");const he=Number(we||0);if(!(he>0)){se("Ingresa un monto de abono mayor a 0.");return}const tt=parseFloat(he.toFixed(2));if(!vt){se("Selecciona la fecha del abono.");return}try{Ne(!0);const nt={customerId:We.id,type:"ABONO",amount:-tt,date:vt,comment:kt||"",createdAt:yr.now()},ge={id:(await Gn(Ct(Ce,"ar_movements_pollo"),nt)).id,date:vt,type:"ABONO",amount:-tt,comment:kt||"",createdAt:yr.now()},it=[...Ge,ge].sort((It,qt)=>{var ar,wr;if(It.date!==qt.date)return It.date.localeCompare(qt.date);const Mt=((ar=It.createdAt)==null?void 0:ar.seconds)||0,zt=((wr=qt.createdAt)==null?void 0:wr.seconds)||0;return Mt-zt});ie(it),or(it,Number(We.initialDebt||0));const Pt=it.reduce((It,qt)=>It+(Number(qt.amount)||0),0),wt=v0(Number(We.initialDebt||0)+Pt),Nt=Zr(it,wt);te(It=>It.map(qt=>{if(qt.id!==We.id)return qt;const Mt=v0((qt.balance||0)-tt);return{...qt,balance:Mt,lastAbonoDate:Nt?vt:"",lastAbonoAmount:Nt?tt:0}})),Z(It=>It&&{...It,balance:v0((It.balance||0)-tt),lastAbonoDate:Nt?vt:"",lastAbonoAmount:Nt?tt:0}),pt(0),Vt(""),bt(new Date().toISOString().slice(0,10)),me(!1),se(" Abono registrado")}catch(nt){console.error(nt),se(" Error al registrar el abono")}finally{Ne(!1)}},He=he=>{Le(he.id),At(he.date||new Date().toISOString().slice(0,10)),W(Math.abs(Number(he.amount||0))),re(he.comment||"")},Bt=()=>{Le(null),At(""),W(0),re("")},xr=async()=>{if(!pe||!We)return;const he=Ge.findIndex(ge=>ge.id===pe);if(he===-1)return;const tt=Ge[he],nt=Number(ct||0);if(!(nt>0)){se("El monto debe ser mayor a 0.");return}const lt=tt.type==="ABONO"?-parseFloat(nt.toFixed(2)):+parseFloat(nt.toFixed(2));try{await kn(Yt(Ce,"ar_movements_pollo",pe),{date:ft,amount:lt,comment:z||""});const ge=[...Ge];ge[he]={...tt,date:ft,amount:lt,comment:z||""},ge.sort((It,qt)=>{var ar,wr;if(It.date!==qt.date)return It.date.localeCompare(qt.date);const Mt=((ar=It.createdAt)==null?void 0:ar.seconds)||0,zt=((wr=qt.createdAt)==null?void 0:wr.seconds)||0;return Mt-zt}),ie(ge),or(ge,Number(We.initialDebt||0));const it=ge.reduce((It,qt)=>It+(Number(qt.amount)||0),0),Pt=v0(Number(We.initialDebt||0)+it),wt=Zr(ge,Pt),Nt=wt?nn(ge):null;te(It=>It.map(qt=>qt.id===We.id?{...qt,balance:Pt,lastAbonoDate:wt&&Nt?Nt.date:"",lastAbonoAmount:wt&&Nt?Nt.amount:0}:qt)),Z(It=>It&&{...It,balance:Pt,lastAbonoDate:wt&&Nt?Nt.date:"",lastAbonoAmount:wt&&Nt?Nt.amount:0}),Bt(),se(" Movimiento actualizado")}catch(ge){console.error(ge),se(" Error al actualizar movimiento")}},dn=async he=>{var nt,lt;if(confirm(`Eliminar este movimiento (${he.type==="ABONO"?"Abono":"Compra"}) del ${he.date}?${he.type==="CARGO"&&((nt=he.ref)!=null&&nt.saleId)?`
Se borrarn los registros de esa venta.`:""}`)&&We)try{if(U(!0),he.type==="CARGO"&&((lt=he.ref)!=null&&lt.saleId)){try{await Wn(Yt(Ce,"salesV2",he.ref.saleId))}catch(It){console.warn("delete sale error",It),U(!1),se(" No se pudo borrar la venta asociada.");return}await I$(he.ref.saleId)}else await Wn(Yt(Ce,"ar_movements_pollo",he.id));const ge=Ge.filter(It=>{var qt,Mt;return he.type==="CARGO"&&((qt=he.ref)!=null&&qt.saleId)?((Mt=It.ref)==null?void 0:Mt.saleId)!==he.ref.saleId:It.id!==he.id});ie(ge),or(ge,Number(We.initialDebt||0));const it=ge.reduce((It,qt)=>It+(Number(qt.amount)||0),0),Pt=v0(Number(We.initialDebt||0)+it),wt=Zr(ge,Pt),Nt=wt?nn(ge):null;te(It=>It.map(qt=>qt.id===We.id?{...qt,balance:Pt,lastAbonoDate:wt&&Nt?Nt.date:"",lastAbonoAmount:wt&&Nt?Nt.amount:0}:qt)),Z(It=>It&&{...It,balance:Pt,lastAbonoDate:wt&&Nt?Nt.date:"",lastAbonoAmount:wt&&Nt?Nt.amount:0}),rt(null),se(" Movimiento eliminado")}catch(ge){console.error(ge),se(" Error al eliminar movimiento")}finally{U(!1)}},Jr=async he=>{if(he.type!=="CARGO")return;const tt=Ny(he.debtStatus)==="PAGADA"?"PENDIENTE":"PAGADA";try{L(he.id),await kn(Yt(Ce,"ar_movements_pollo",he.id),{debtStatus:tt});const nt=Ge.map(lt=>lt.id===he.id?{...lt,debtStatus:tt}:lt);if(ie(nt),We){or(nt,Number(We.initialDebt||0));const lt=nt.reduce((wt,Nt)=>wt+(Number(Nt.amount)||0),0),ge=v0(Number(We.initialDebt||0)+lt),it=Zr(nt,ge),Pt=it?nn(nt):null;te(wt=>wt.map(Nt=>Nt.id===We.id?{...Nt,balance:ge,lastAbonoDate:it&&Pt?Pt.date:"",lastAbonoAmount:it&&Pt?Pt.amount:0}:Nt)),Z(wt=>wt&&{...wt,balance:ge,lastAbonoDate:it&&Pt?Pt.date:"",lastAbonoAmount:it&&Pt?Pt.amount:0})}se(tt==="PAGADA"?" Compra marcada como pagada":" Compra marcada como pendiente")}catch(nt){console.error(nt),se(" No se pudo actualizar el estado de la compra")}finally{L(null)}},br=g.useMemo(()=>[...Q].sort((he,tt)=>{var nt,lt;return he.status!==tt.status?he.status==="BLOQUEADO"?1:-1:(((nt=tt.createdAt)==null?void 0:nt.seconds)||0)-(((lt=he.createdAt)==null?void 0:lt.seconds)||0)}),[Q]),er=he=>he==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",ir=g.useMemo(()=>{const he=A.trim().toLowerCase(),tt=x.trim()===""?null:Number(x),nt=y.trim()===""?null:Number(y);return br.filter(lt=>{const ge=!he||String(lt.name||"").toLowerCase().includes(he),it=!m||lt.status===m,Pt=Number(lt.balance||0),wt=tt===null||!Number.isNaN(tt)&&Pt>=tt,Nt=nt===null||!Number.isNaN(nt)&&Pt<=nt;return ge&&it&&wt&&Nt})},[br,A,m,x,y]),Sr=g.useMemo(()=>ir.reduce((he,tt)=>he+Number(tt.balance||0),0),[ir]),vr=g.useMemo(()=>ir.filter(he=>he.status==="ACTIVO").length,[ir]),Fr=ir.length,jn=()=>{h(""),p(""),v(""),b("")};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Pollo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Be(!0),o&&X(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Saldo pendiente"}),i.jsx("div",{className:"text-2xl font-semibold",children:qc(Sr)}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Calculado sobre los clientes filtrados"})]}),i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Clientes activos"}),i.jsx("div",{className:"text-2xl font-semibold",children:vr}),i.jsxs("p",{className:"text-[11px] text-gray-500 mt-1",children:["De un total de ",Fr]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm p-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Filtrar cliente"}),i.jsx("input",{className:"w-full border rounded px-3 py-2",placeholder:"Nombre, telfono o nota",value:A,onChange:he=>h(he.target.value)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-gray-50 hover:bg-gray-100",onClick:()=>f(he=>!he),children:d?"Ocultar filtros":"Ms filtros"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-white hover:bg-gray-50",onClick:jn,children:"Limpiar"})]})]}),d&&i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border rounded px-3 py-2",value:m,onChange:he=>p(he.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"Activo"}),i.jsx("option",{value:"BLOQUEADO",children:"Bloqueado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mnimo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:x,onChange:he=>v(he.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mximo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:y,onChange:he=>b(he.target.value),placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:be?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):ir.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):ir.map(he=>{var nt;const tt=ee===he.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(nt=he.createdAt)!=null&&nt.toDate?he.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:je,onChange:lt=>Se(lt.target.value)}):i.jsx("div",{className:"font-medium",children:he.name})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:Ze,onChange:lt=>ut(o_(lt.target.value))}):he.phone}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ye,onChange:lt=>ht(lt.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(lt=>i.jsx("option",{value:lt.id,children:lt.name},lt.id))]}):he.vendorName||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:Et,onChange:lt=>St(lt.target.value),children:[i.jsx("option",{value:"",children:""}),j$.map(lt=>i.jsx("option",{value:lt,children:lt},lt))]}):he.place||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:Ut,onChange:lt=>Tt(lt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${er(he.status)}`,children:he.status})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Re)?"":Re,onChange:lt=>Te(Math.max(0,Number(lt.target.value||0)))}):qc(he.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:qc(he.balance||0)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ft,onChange:lt=>Qt(lt.target.value),maxLength:500}):i.jsx("span",{title:he.notes||"",children:(he.notes||"").length>40?(he.notes||"").slice(0,40)+"":he.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:tt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ir,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:nr,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ot(he),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Qr(he),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>kr(he),children:"Estado de cuenta"})]})})})]},he.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-2",children:be?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Cargando"}):ir.length===0?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Sin clientes"}):ir.map(he=>i.jsxs("div",{className:"border rounded-lg bg-white p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-base",children:he.name}),i.jsx("div",{className:"text-xs text-gray-600",children:he.phone||""}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:he.vendorName||""})]})]}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${er(he.status)}`,children:he.status})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:qc(he.balance||0)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Lmite"}),i.jsx("div",{className:"font-semibold",children:qc(he.creditLimit||0)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["ltimo abono:"," ",i.jsx("span",{className:"font-medium",children:he.lastAbonoDate?`${he.lastAbonoDate} (${qc(he.lastAbonoAmount||0)})`:""})]}),he.notes?i.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Nota:"})," ",(he.notes||"").length>80?(he.notes||"").slice(0,80)+"":he.notes]}):null,i.jsxs("div",{className:"mt-3 flex gap-2 flex-wrap",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white text-sm",onClick:()=>kr(he),children:"Estado de cuenta"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-yellow-600 text-white text-sm",onClick:()=>Ot(he),disabled:o,title:o?"Vendedor no edita":"Editar",children:"Editar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-red-600 text-white text-sm disabled:opacity-50",onClick:()=>Qr(he),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"})]})]},he.id))})]}),Xe&&i.jsx("p",{className:"mt-2 text-sm",children:Xe}),fe&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Be(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Be(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:_t,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:P,onChange:he=>G(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ce,onChange:he=>ue(o_(he.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:le,onChange:he=>Ae(he.target.value),children:[i.jsx("option",{value:"",children:""}),j$.map(he=>i.jsx("option",{value:he,children:he},he))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:De,onChange:he=>O(he.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:R,onChange:he=>X(he.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(he=>i.jsx("option",{value:he.id,children:he.name},he.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Y===0?"":Y,onChange:he=>D(Math.max(0,Number(he.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:he=>K(Math.max(0,Number(he.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ae,onChange:he=>_e(he.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ae.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Be(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),Oe&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[50]",style:{zIndex:50},children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ie(!1)}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-full max-w-5xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-3",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(We==null?void 0:We.name)||""]}),i.jsxs("div",{className:"flex gap-2 shrink-0",children:[i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{pt(0),bt(new Date().toISOString().slice(0,10)),Vt(""),me(!0)},children:"Abonar"}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ie(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(Number((We==null?void 0:We.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(xe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(xe.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Estado compra"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Qe?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):Ge.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):Ge.map(he=>{var lt;const tt=pe===he.id,nt=Ny(he.debtStatus);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:ft,onChange:ge=>At(ge.target.value)}):he.date||""}),i.jsx("td",{className:"p-2 border",children:he.amount>=0?(lt=he.ref)!=null&&lt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",onClick:()=>T(he.ref.saleId),children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:he.type==="CARGO"?i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${nt==="PAGADA"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:nt==="PAGADA"?"Pagada":"Pendiente"}):""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:z,onChange:ge=>re(ge.target.value)}):i.jsx("span",{title:he.comment||"",children:(he.comment||"").length>40?(he.comment||"").slice(0,40)+"":he.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ct)?"":ct,onChange:ge=>W(Number(ge.target.value||0))}):qc(he.amount)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:xr,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Bt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>He(he),children:"Editar"}),he.type==="CARGO"&&i.jsx("button",{type:"button",className:`px-2 py-1 rounded text-white ${nt==="PAGADA"?"bg-gray-600 hover:bg-gray-700":"bg-emerald-600 hover:bg-emerald-700"} disabled:opacity-50`,onClick:()=>Jr(he),disabled:V===he.id,children:nt==="PAGADA"?"Marcar pendiente":"Marcar pagada"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>dn(he),children:"Borrar"})]})})]},he.id)})})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",style:{zIndex:60},children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," "]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>I(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:j?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((he,tt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:he.productName}),i.jsx("td",{className:"p-2 border text-right",children:he.qty}),i.jsx("td",{className:"p-2 border text-right",children:qc(he.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:qc(he.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:qc(he.total)})]},tt))})]})})]})})]}),document.body),Me&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[90]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(We==null?void 0:We.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:vt,onChange:he=>bt(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:we===0?"":we,onChange:he=>{const tt=Number(he.target.value||0),nt=Number.isFinite(tt)?Math.max(0,parseFloat(tt.toFixed(2))):0;pt(nt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:kt,onChange:he=>Vt(he.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[kt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>me(!1),disabled:ke,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:_r,disabled:ke,children:ke?"Guardando...":"Guardar abono"})]})]})})]})}function FLe(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function OLe(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var DLe=function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o])},t(r,n)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),RLe=function(t){DLe(e,t);function e(r,n){var a=this.constructor,s=t.call(this,r,n)||this;return Object.defineProperty(s,"name",{value:a.name,enumerable:!1,configurable:!0}),FLe(s,a.prototype),OLe(s),s}return e}(Error),MLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),du=function(t){MLe(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind="Exception",e}(RLe),LLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vi=function(t){LLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArgumentException",e}(du),ULe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pn=function(t){ULe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(du),_se=function(){function t(e){if(this.binarizer=e,e===null)throw new Pn("Binarizer must be non-null.")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,a){var s=this.binarizer.getLuminanceSource().crop(e,r,n,a);return new t(this.binarizer.createBinarizer(s))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},t}(),QLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),co=function(t){QLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(du),VLe=function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t}(),Cs=function(){function t(){}return t.arraycopy=function(e,r,n,a,s){for(;s--;)n[a++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t}(),HLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),UR=function(t){HLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(du),$Le=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),P$=function(t){$Le(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var a=t.call(this,n)||this;return a.index=r,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(UR),GLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bo=function(){function t(){}return t.fill=function(e,r){for(var n=0,a=e.length;n<a;n++)e[n]=r},t.fillWithin=function(e,r,n,a){t.rangeCheck(e.length,r,n);for(var s=r;s<n;s++)e[s]=a},t.rangeCheck=function(e,r,n){if(r>n)throw new Pn("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new P$(r);if(n>e)throw new P$(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var a=1;try{for(var s=GLe(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=31*a+l}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var a=n-r,s=new Int32Array(a);return Cs.arraycopy(e,r,s,0,a),s},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var a=0,s=e.length-1;a<=s;){var o=s+a>>1,l=n(r,e[o]);if(l>0)a=o+1;else if(l<0)s=o-1;else return o}return-a-1},t.numberComparator=function(e,r){return e-r},t}(),sa=function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),tl=function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);Cs.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=~n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=~n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new Pn;if(r!==e){r--;for(var n=Math.floor(e/32),a=Math.floor(r/32),s=this.bits,o=n;o<=a;o++){var l=o>n?0:e&31,c=o<a?31:r&31,u=(2<<c)-(1<<l);s[o]|=u}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new Pn;if(r===e)return!0;r--;for(var a=Math.floor(e/32),s=Math.floor(r/32),o=this.bits,l=a;l<=s;l++){var c=l>a?0:e&31,u=l<s?31:r&31,d=(2<<u)-(1<<c)&4294967295;if((o[l]&d)!==(n?d:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new Pn("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new Pn("Sizes don't match");for(var r=this.bits,n=0,a=r.length;n<a;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,a){for(var s=0;s<a;s++){for(var o=0,l=0;l<8;l++)this.get(e)&&(o|=1<<7-l),e++;r[n+s]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits,s=0;s<n;s++){var o=a[s];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-s]=o}if(this.size!==n*32){for(var l=n*32-this.size,c=e[0]>>>l,s=1;s<n;s++){var u=e[s];c|=u<<32-l,e[s-1]=c,c=u>>>l}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+Bo.hashCode(this.bits)},t.prototype.toString=function(){for(var e="",r=0,n=this.size;r<n;r++)r&7||(e+=" "),e+=this.get(r)?"X":".";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t}(),uF;(function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",t[t.ASSUME_GS1=8]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(uF||(uF={}));const _s=uF;var KLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kr=function(t){KLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(du),qLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Wa;(function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"})(Wa||(Wa={}));var Po=function(){function t(e,r,n){for(var a,s,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];this.valueIdentifier=e,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,u=0,d=c.length;u!==d;u++){var f=c[u];t.VALUES_TO_ECI.set(f,this)}try{for(var A=qLe(o),h=A.next();!h.done;h=A.next()){var m=h.value;t.NAME_TO_ECI.set(m,this)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new Kr("incorect value");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new Kr("incorect value");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new Kr("incorect value");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(Wa.Cp437,Int32Array.from([0,2]),"Cp437"),t.ISO8859_1=new t(Wa.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),t.ISO8859_2=new t(Wa.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),t.ISO8859_3=new t(Wa.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),t.ISO8859_4=new t(Wa.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),t.ISO8859_5=new t(Wa.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),t.ISO8859_6=new t(Wa.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),t.ISO8859_7=new t(Wa.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),t.ISO8859_8=new t(Wa.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),t.ISO8859_9=new t(Wa.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),t.ISO8859_10=new t(Wa.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),t.ISO8859_11=new t(Wa.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),t.ISO8859_13=new t(Wa.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),t.ISO8859_14=new t(Wa.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),t.ISO8859_15=new t(Wa.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),t.ISO8859_16=new t(Wa.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),t.SJIS=new t(Wa.SJIS,20,"SJIS","Shift_JIS"),t.Cp1250=new t(Wa.Cp1250,21,"Cp1250","windows-1250"),t.Cp1251=new t(Wa.Cp1251,22,"Cp1251","windows-1251"),t.Cp1252=new t(Wa.Cp1252,23,"Cp1252","windows-1252"),t.Cp1256=new t(Wa.Cp1256,24,"Cp1256","windows-1256"),t.UnicodeBigUnmarked=new t(Wa.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),t.UTF8=new t(Wa.UTF8,26,"UTF8","UTF-8"),t.ASCII=new t(Wa.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),t.Big5=new t(Wa.Big5,28,"Big5"),t.GB18030=new t(Wa.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),t.EUC_KR=new t(Wa.EUC_KR,30,"EUC_KR","EUC-KR"),t}(),zLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yE=function(t){zLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(du),Bd=function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e==="ISO-8859-1"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},t.encodingName=function(e){return typeof e=="string"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof Po?e:Po.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var a="",s=0,o=e.length;s<o;s++){var l=e[s].toString(16);l.length<2&&(l="0"+l),a+="%"+l}return decodeURIComponent(a)}if(n.equals(Po.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new yE("Encoding "+this.encodingName(r)+" not supported by fallback.")},t.isDecodeFallbackSupported=function(e){return e.equals(Po.UTF8)||e.equals(Po.ISO8859_1)||e.equals(Po.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(""),a=[],s=0;s<n.length;s++)a.push(n[s].charCodeAt(0));return new Uint8Array(a)},t}(),Na=function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return Bd.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(_s.CHARACTER_SET)!==void 0)return r.get(_s.CHARACTER_SET).toString();for(var n=e.length,a=!0,s=!0,o=!0,l=0,c=0,u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,b=0;b<n&&(a||s||o);b++){var w=e[b]&255;o&&(l>0?w&128?l--:o=!1:w&128&&(w&64?(l++,w&32?(l++,w&16?(l++,w&8?o=!1:d++):u++):c++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&v++),s&&(f>0?w<64||w===127||w>252?s=!1:f--:w===128||w===160||w>239?s=!1:w>160&&w<224?(A++,m=0,h++,h>p&&(p=h)):w>127?(f++,h=0,m++,m>x&&(x=m)):(h=0,m=0))}return o&&l>0&&(o=!1),s&&f>0&&(s=!1),o&&(y||c+u+d>0)?t.UTF8:s&&(t.ASSUME_SHIFT_JIS||p>=3||x>=3)?t.SHIFT_JIS:a&&s?p===2&&A===2||v*10>=n?t.SHIFT_JIS:t.ISO88591:a?t.ISO88591:s?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=-1;function s(l,c,u,d,f,A){if(l==="%%")return"%";if(r[++a]!==void 0){l=d?parseInt(d.substr(1)):void 0;var h=f?parseInt(f.substr(1)):void 0,m;switch(A){case"s":m=r[a];break;case"c":m=r[a][0];break;case"f":m=parseFloat(r[a]).toFixed(l);break;case"p":m=parseFloat(r[a]).toPrecision(l);break;case"e":m=parseFloat(r[a]).toExponential(l);break;case"x":m=parseInt(r[a]).toString(h||16);break;case"d":m=parseFloat(parseInt(r[a],h||10).toPrecision(l)).toFixed(0);break}m=typeof m=="object"?JSON.stringify(m):(+m).toString(h);for(var p=parseInt(u),x=u&&u[0]+""=="0"?"0":" ";m.length<p;)m=c!==void 0?m+x:x+m;return m}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,s)},t.getBytes=function(e,r){return Bd.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=Po.SJIS.getName(),t.GB2312="GB2312",t.ISO88591=Po.ISO8859_1.getName(),t.EUC_JP="EUC_JP",t.UTF8=Po.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t}(),ta=function(){function t(e){e===void 0&&(e=""),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=Na.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var a=r;r<r+n;a++)this.append(e[a]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=""},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t}(),uh=function(){function t(e,r,n,a){if(this.width=e,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=e),this.height=r,e<1||r<1)throw new Pn("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,a=new t(n,r),s=0;s<r;s++)for(var o=e[s],l=0;l<n;l++)o[l]&&a.set(l,s);return a},t.parseFromString=function(e,r,n){if(e===null)throw new Pn("stringRepresentation cannot be null");for(var a=new Array(e.length),s=0,o=0,l=-1,c=0,u=0;u<e.length;)if(e.charAt(u)===`
`||e.charAt(u)==="\r"){if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");o=s,c++}u++}else if(e.substring(u,u+r.length)===r)u+=r.length,a[s]=!0,s++;else if(e.substring(u,u+n.length)===n)u+=n.length,a[s]=!1,s++;else throw new Pn("illegal character encountered: "+e.substring(u));if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");c++}for(var d=new t(l,c),f=0;f<s;f++)a[f]&&d.set(Math.floor(f%l),Math.floor(f/l));return d},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new Pn("input matrix dimensions do not match");for(var r=new tl(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,s=0,o=this.height;s<o;s++)for(var l=s*n,c=e.getRow(s,r).getBitArray(),u=0;u<n;u++)a[l+u]^=c[u]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,a){if(r<0||e<0)throw new Pn("Left and top must be nonnegative");if(a<1||n<1)throw new Pn("Height and width must be at least 1");var s=e+n,o=r+a;if(o>this.height||s>this.width)throw new Pn("The region must fit inside the matrix");for(var l=this.rowSize,c=this.bits,u=r;u<o;u++)for(var d=u*l,f=e;f<s;f++)c[d+Math.floor(f/32)]|=1<<(f&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new tl(this.width):r.clear();for(var n=this.rowSize,a=this.bits,s=e*n,o=0;o<n;o++)r.setBulk(o*32,a[s+o]);return r},t.prototype.setRow=function(e,r){Cs.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new tl(e),a=new tl(e),s=0,o=Math.floor((r+1)/2);s<o;s++)n=this.getRow(s,n),a=this.getRow(r-1-s,a),n.reverse(),a.reverse(),this.setRow(s,a),this.setRow(r-1-s,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,a=this.bits,s=e,o=r,l=-1,c=-1,u=0;u<r;u++)for(var d=0;d<n;d++){var f=a[u*n+d];if(f!==0){if(u<o&&(o=u),u>c&&(c=u),d*32<s){for(var A=0;!(f<<31-A&4294967295);)A++;d*32+A<s&&(s=d*32+A)}if(d*32+31>l){for(var A=31;!(f>>>A);)A--;d*32+A>l&&(l=d*32+A)}}}return l<s||c<o?null:Int32Array.from([s,o,l-s+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var a=n/e,s=n%e*32,o=r[n],l=0;!(o<<31-l&4294967295);)l++;return s+=l,Int32Array.from([s,a])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),s=Math.floor(n%e)*32,o=r[n],l=31;!(o>>>l);)l--;return s+=l,Int32Array.from([s,a])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Bo.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e="X "),r===void 0&&(r="  "),n===void 0&&(n=`
`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var a=new ta,s=0,o=this.height;s<o;s++){for(var l=0,c=this.width;l<c;l++)a.append(this.get(l,s)?e:r);a.append(n)}return a.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t}(),WLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lr=function(t){WLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(du),XLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),YLe=function(t){XLe(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var a=this.getLuminanceSource(),s=a.getWidth();n==null||n.getSize()<s?n=new tl(s):n.clear(),this.initArrays(s);for(var o=a.getRow(r,this.luminances),l=this.buckets,c=0;c<s;c++)l[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(l);if(s<3)for(var c=0;c<s;c++)(o[c]&255)<u&&n.set(c);else for(var d=o[0]&255,f=o[1]&255,c=1;c<s-1;c++){var A=o[c+1]&255;(f*4-d-A)/2<u&&n.set(c),d=f,f=A}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight(),s=new uh(n,a);this.initArrays(n);for(var o=this.buckets,l=1;l<5;l++)for(var c=Math.floor(a*l/5),u=r.getRow(c,this.luminances),d=Math.floor(n*4/5),f=Math.floor(n/5);f<d;f++){var A=u[f]&255;o[A>>e.LUMINANCE_SHIFT]++}for(var h=e.estimateBlackPoint(o),m=r.getMatrix(),l=0;l<a;l++)for(var p=l*n,f=0;f<n;f++){var A=m[p+f]&255;A<h&&s.set(f,l)}return s},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(r){for(var n=r.length,a=0,s=0,o=0,l=0;l<n;l++)r[l]>o&&(s=l,o=r[l]),r[l]>a&&(a=r[l]);for(var c=0,u=0,l=0;l<n;l++){var d=l-s,f=r[l]*d*d;f>u&&(c=l,u=f)}if(s>c){var A=s;s=c,c=A}if(c-s<=n/16)throw new lr;for(var h=c-1,m=-1,l=c-1;l>s;l--){var p=l-s,f=p*p*(c-l)*(a-r[l]);f>m&&(h=l,m=f)}return h<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(VLe),JLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ese=function(t){JLe(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var s=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var l=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&l++;var c=e.calculateBlackPoints(s,o,l,n,a),u=new uh(n,a);e.calculateThresholdForBlock(s,o,l,n,a,c,u),this.matrix=u}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,a,s,o,l,c){for(var u=o-e.BLOCK_SIZE,d=s-e.BLOCK_SIZE,f=0;f<a;f++){var A=f<<e.BLOCK_SIZE_POWER;A>u&&(A=u);for(var h=e.cap(f,2,a-3),m=0;m<n;m++){var p=m<<e.BLOCK_SIZE_POWER;p>d&&(p=d);for(var x=e.cap(m,2,n-3),v=0,y=-2;y<=2;y++){var b=l[h+y];v+=b[x-2]+b[x-1]+b[x]+b[x+1]+b[x+2]}var w=v/25;e.thresholdBlock(r,p,A,w,s,c)}}},e.cap=function(r,n,a){return r<n?n:r>a?a:r},e.thresholdBlock=function(r,n,a,s,o,l){for(var c=0,u=a*o+n;c<e.BLOCK_SIZE;c++,u+=o)for(var d=0;d<e.BLOCK_SIZE;d++)(r[u+d]&255)<=s&&l.set(n+d,a+c)},e.calculateBlackPoints=function(r,n,a,s,o){for(var l=o-e.BLOCK_SIZE,c=s-e.BLOCK_SIZE,u=new Array(a),d=0;d<a;d++){u[d]=new Int32Array(n);var f=d<<e.BLOCK_SIZE_POWER;f>l&&(f=l);for(var A=0;A<n;A++){var h=A<<e.BLOCK_SIZE_POWER;h>c&&(h=c);for(var m=0,p=255,x=0,v=0,y=f*s+h;v<e.BLOCK_SIZE;v++,y+=s){for(var b=0;b<e.BLOCK_SIZE;b++){var w=r[y+b]&255;m+=w,w<p&&(p=w),w>x&&(x=w)}if(x-p>e.MIN_DYNAMIC_RANGE)for(v++,y+=s;v<e.BLOCK_SIZE;v++,y+=s)for(var b=0;b<e.BLOCK_SIZE;b++)m+=r[y+b]&255}var I=m>>e.BLOCK_SIZE_POWER*2;if(x-p<=e.MIN_DYNAMIC_RANGE&&(I=p/2,d>0&&A>0)){var j=(u[d-1][A]+2*u[d][A-1]+u[d-1][A-1])/4;p<j&&(I=j)}u[d][A]=I}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(YLe),zw=function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,a){throw new yE("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new yE("This luminance source does not support rotation by 90 degrees.")},t.prototype.rotateCounterClockwise45=function(){throw new yE("This luminance source does not support rotation by 45 degrees.")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new ta,n=0;n<this.height;n++){for(var a=this.getRow(n,e),s=0;s<this.width;s++){var o=a[s]&255,l=void 0;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",r.append(l)}r.append(`
`)}return r.toString()},t}(),ZLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vP=function(t){ZLe(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var a=this.delegate.getRow(r,n),s=this.getWidth(),o=0;o<s;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),s=0;s<n;s++)a[s]=255-(r[s]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,a,s){return new e(this.delegate.crop(r,n,a,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(zw),eUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tUe=function(t){eUe(e,t);function e(r,n){n===void 0&&(n=!1);var a=t.call(this,r.width,r.height)||this;return a.canvas=r,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(r,n),a}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var a=r.getContext("2d").getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height,n)},e.toGrayscaleBuffer=function(r,n,a,s){s===void 0&&(s=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!s)for(var l=0,c=0,u=r.length;l<u;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=d}else for(var l=0,c=0,p=r.length;l<p;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=255-d}return o},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement(),a=n.getContext("2d"),s=r*e.DEGREE_TO_RADIANS,o=this.canvas.width,l=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(s))*o+Math.abs(Math.sin(s))*l),u=Math.ceil(Math.abs(Math.sin(s))*o+Math.abs(Math.cos(s))*l);return n.width=c,n.height=u,a.translate(c/2,u/2),a.rotate(s),a.drawImage(this.canvas,o/-2,l/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new vP(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(zw),rUe=function(){function t(e,r,n){this.deviceId=e,this.label=r,this.kind="videoinput",this.groupId=n||void 0}return t.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},t}(),xc=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},vc=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},nUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},S1=function(){function t(e,r,n){r===void 0&&(r=500),this.reader=e,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(t.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),t.prototype.listVideoInputDevices=function(){return xc(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return vc(this,function(h){switch(h.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=nUe(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device "+(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.prototype.getVideoInputDevices=function(){return xc(this,void 0,void 0,function(){var e;return vc(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=r.sent(),[2,e.map(function(n){return new rUe(n.deviceId,n.label)})]}})})},t.prototype.findDeviceById=function(e){return xc(this,void 0,void 0,function(){var r;return vc(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2,null]}})})},t.prototype.decodeFromInputVideoDevice=function(e,r){return xc(this,void 0,void 0,function(){return vc(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return xc(this,void 0,void 0,function(){var n,a;return vc(this,function(s){switch(s.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return xc(this,void 0,void 0,function(){var n;return vc(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return xc(this,void 0,void 0,function(){var n,a;return vc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return n=s.sent(),[4,this.decodeOnce(n)];case 2:return a=s.sent(),[2,a]}})})},t.prototype.decodeFromInputVideoDeviceContinuously=function(e,r,n){return xc(this,void 0,void 0,function(){return vc(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,r,n)];case 1:return[2,a.sent()]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return xc(this,void 0,void 0,function(){var a,s;return vc(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return xc(this,void 0,void 0,function(){var a;return vc(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=s.sent(),[4,this.decodeFromStream(a,r,n)];case 2:return[2,s.sent()]}})})},t.prototype.decodeFromStream=function(e,r,n){return xc(this,void 0,void 0,function(){var a;return vc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return a=s.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,s.sent()]}})})},t.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},t.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},t.prototype.attachStreamToVideo=function(e,r){return xc(this,void 0,void 0,function(){var n;return vc(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(r),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},t.prototype.playVideoOnLoadAsync=function(e){var r=this;return new Promise(function(n,a){return r.playVideoOnLoad(e,function(){return n()})})},t.prototype.playVideoOnLoad=function(e,r){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",r),this.tryPlayVideo(e)},t.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},t.prototype.tryPlayVideo=function(e){return xc(this,void 0,void 0,function(){return vc(this,function(r){switch(r.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.play()];case 2:return r.sent(),[3,4];case 3:return r.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},t.prototype.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Vi("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Vi("element with id '"+e+"' must be an "+r+" element");return n},t.prototype.decodeFromImage=function(e,r){if(!e&&!r)throw new Vi("either imageElement with a src set or an url must be provided");return r&&!e?this.decodeFromImageUrl(r):this.decodeFromImageElement(e)},t.prototype.decodeFromVideo=function(e,r){if(!e&&!r)throw new Vi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(e)},t.prototype.decodeFromVideoContinuously=function(e,r,n){if(e===void 0&&r===void 0)throw new Vi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(e,n)},t.prototype.decodeFromImageElement=function(e){if(!e)throw new Vi("An image element must be provided.");this.reset();var r=this.prepareImageElement(e);this.imageElement=r;var n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n},t.prototype.decodeFromVideoElement=function(e){var r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(r)},t.prototype.decodeFromVideoElementContinuously=function(e,r){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,r)},t.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new Vi("A video element must be provided.");this.reset();var r=this.prepareVideoElement(e);return this.videoElement=r,r},t.prototype.decodeFromImageUrl=function(e){if(!e)throw new Vi("An URL must be provided.");this.reset();var r=this.prepareImageElement();this.imageElement=r;var n=this._decodeOnLoadImage(r);return r.src=e,n},t.prototype.decodeFromVideoUrl=function(e){if(!e)throw new Vi("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=e,n},t.prototype.decodeFromVideoUrlContinuously=function(e,r){if(!e)throw new Vi("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=e,a},t.prototype._decodeOnLoadImage=function(e){var r=this;return new Promise(function(n,a){r.imageLoadedListener=function(){return r.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",r.imageLoadedListener)})},t.prototype._decodeOnLoadVideo=function(e){return xc(this,void 0,void 0,function(){return vc(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return r.sent(),[4,this.decodeOnce(e)];case 2:return[2,r.sent()]}})})},t.prototype._decodeOnLoadVideoContinuously=function(e,r){return xc(this,void 0,void 0,function(){return vc(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,r),[2]}})})},t.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.prototype.prepareImageElement=function(e){var r;return typeof e>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(r=e),r},t.prototype.prepareVideoElement=function(e){var r;return!e&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(r=e),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.prototype.decodeOnce=function(e,r,n){var a=this;r===void 0&&(r=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var s=function(o,l){if(a._stopAsyncDecode){l(new lr("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var c=a.decode(e);o(c)}catch(A){var u=r&&A instanceof lr,d=A instanceof co||A instanceof Kr,f=d&&n;if(u||f)return setTimeout(s,a._timeBetweenDecodingAttempts,o,l);l(A)}};return new Promise(function(o,l){return s(o,l)})},t.prototype.decodeContinuously=function(e,r){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var s=n.decode(e);r(s,null),setTimeout(a,n.timeBetweenScansMillis)}catch(c){r(null,c);var o=c instanceof co||c instanceof Kr,l=c instanceof lr;(o||l)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},t.prototype.decode=function(e){var r=this.createBinaryBitmap(e);return this.decodeBitmap(r)},t.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var r=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),r=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new tUe(n,r),s=new Ese(a);return new _se(s)},t.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var r=this.getCaptureCanvas(e),n=void 0;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},t.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var r=this.createCaptureCanvas(e);this.captureCanvas=r}return this.captureCanvas},t.prototype.drawFrameOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.drawImageOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},t.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var r=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r},t.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},t.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},t.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},t.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},t.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},t.prototype.addVideoSource=function(e,r){try{e.srcObject=r}catch{e.src=URL.createObjectURL(r)}},t.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},t}(),hc=function(){function t(e,r,n,a,s,o){n===void 0&&(n=r==null?0:8*r.length),o===void 0&&(o=Cs.currentTimeMillis()),this.text=e,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=s,this.timestamp=o,this.text=e,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=s,this.resultMetadata=null,o==null?this.timestamp=Cs.currentTimeMillis():this.timestamp=o}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(e,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,r)},t.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},t.prototype.addResultPoints=function(e){var r=this.resultPoints;if(r===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(r.length+e.length);Cs.arraycopy(r,0,n,0,r.length),Cs.arraycopy(e,0,n,r.length,e.length),this.resultPoints=n}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}(),dF;(function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(dF||(dF={}));const In=dF;var fF;(function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(fF||(fF={}));const Tl=fF;var yP=function(){function t(e,r,n,a,s,o){s===void 0&&(s=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(e){this.numBits=e},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(e){this.erasures=e},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(e){this.other=e},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t}(),rb=function(){function t(){}return t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.addOrSubtract=function(e,r){return e^r},t}(),pm=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),Cs.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var r=this.coefficients,n;if(e===1){n=0;for(var a=0,s=r.length;a!==s;a++){var o=r[a];n=rb.addOrSubtract(n,o)}return n}n=r[0];for(var l=r.length,c=this.field,a=1;a<l;a++)n=rb.addOrSubtract(c.multiply(e,n),r[a]);return n},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;Cs.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=rb.addOrSubtract(r[l-o],n[l]);return new t(this.field,s)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=this.field,c=0;c<n;c++)for(var u=r[c],d=0;d<s;d++)o[c+d]=rb.addOrSubtract(o[c+d],l.multiply(u,a[d]));return new t(l,o)},t.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var r=this.coefficients.length,n=this.field,a=new Int32Array(r),s=this.coefficients,o=0;o<r;o++)a[o]=n.multiply(s[o],e);return new t(n,a)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,s=new Int32Array(a+e),o=this.field,l=0;l<a;l++)s[l]=o.multiply(n[l],r);return new t(o,s)},t.prototype.divide=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new Pn("Divide by 0");for(var r=this.field,n=r.getZero(),a=this,s=e.getCoefficient(e.getDegree()),o=r.inverse(s);a.getDegree()>=e.getDegree()&&!a.isZero();){var l=a.getDegree()-e.getDegree(),c=r.multiply(a.getCoefficient(a.getDegree()),o),u=e.multiplyByMonomial(l,c),d=r.buildMonomial(l,c);n=n.addOrSubtract(d),a=a.addOrSubtract(u)}return[n,a]},t.prototype.toString=function(){for(var e="",r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),r===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}r!==0&&(r===1?e+="x":(e+="x^",e+=r))}}return e},t}(),aUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Sse=function(t){aUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(du),sUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tu=function(t){sUe(e,t);function e(r,n,a){var s=t.call(this)||this;s.primitive=r,s.size=n,s.generatorBase=a;for(var o=new Int32Array(n),l=1,c=0;c<n;c++)o[c]=l,l*=2,l>=n&&(l^=r,l&=n-1);s.expTable=o;for(var u=new Int32Array(n),c=0;c<n-1;c++)u[o[c]]=c;return s.logTable=u,s.zero=new pm(s,Int32Array.from([0])),s.one=new pm(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new pm(this,a)},e.prototype.inverse=function(r){if(r===0)throw new Sse;return this.expTable[this.size-this.logTable[r]-1]},e.prototype.multiply=function(r,n){return r===0||n===0?0:this.expTable[(this.logTable[r]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+sa.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(r){return r===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(rb),iUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),l_=function(t){iUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(du),oUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ww=function(t){oUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(du),bP=function(){function t(e){this.field=e}return t.prototype.decode=function(e,r){for(var n=this.field,a=new pm(n,e),s=new Int32Array(r),o=!0,l=0;l<r;l++){var c=a.evaluateAt(n.exp(l+n.getGeneratorBase()));s[s.length-1-l]=c,c!==0&&(o=!1)}if(!o)for(var u=new pm(n,s),d=this.runEuclideanAlgorithm(n.buildMonomial(r,1),u,r),f=d[0],A=d[1],h=this.findErrorLocations(f),m=this.findErrorMagnitudes(A,h),l=0;l<h.length;l++){var p=e.length-1-n.log(h[l]);if(p<0)throw new l_("Bad error location");e[p]=tu.addOrSubtract(e[p],m[l])}},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=this.field,o=e,l=r,c=s.getZero(),u=s.getOne();l.getDegree()>=(n/2|0);){var d=o,f=c;if(o=l,c=u,o.isZero())throw new l_("r_{i-1} was zero");l=d;for(var A=s.getZero(),h=o.getCoefficient(o.getDegree()),m=s.inverse(h);l.getDegree()>=o.getDegree()&&!l.isZero();){var p=l.getDegree()-o.getDegree(),x=s.multiply(l.getCoefficient(l.getDegree()),m);A=A.addOrSubtract(s.buildMonomial(p,x)),l=l.addOrSubtract(o.multiplyByMonomial(p,x))}if(u=A.multiply(c).addOrSubtract(f),l.getDegree()>=o.getDegree())throw new Ww("Division algorithm failed to reduce polynomial?")}var v=u.getCoefficient(0);if(v===0)throw new l_("sigmaTilde(0) was zero");var y=s.inverse(v),b=u.multiplyScalar(y),w=l.multiplyScalar(y);return[b,w]},t.prototype.findErrorLocations=function(e){var r=e.getDegree();if(r===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(r),a=0,s=this.field,o=1;o<s.getSize()&&a<r;o++)e.evaluateAt(o)===0&&(n[a]=s.inverse(o),a++);if(a!==r)throw new l_("Error locator degree does not match number of roots");return n},t.prototype.findErrorMagnitudes=function(e,r){for(var n=r.length,a=new Int32Array(n),s=this.field,o=0;o<n;o++){for(var l=s.inverse(r[o]),c=1,u=0;u<n;u++)if(o!==u){var d=s.multiply(r[u],l),f=d&1?d&-2:d|1;c=s.multiply(c,f)}a[o]=s.multiply(e.evaluateAt(l),s.inverse(c)),s.getGeneratorBase()!==0&&(a[o]=s.multiply(a[o],l))}return a},t}(),vl;(function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"})(vl||(vl={}));var T$=function(){function t(){}return t.prototype.decode=function(e){this.ddata=e;var r=e.getBits(),n=this.extractBits(r),a=this.correctBits(n),s=t.convertBoolArrayToByteArray(a),o=t.getEncodedData(a),l=new yP(s,o,null,null);return l.setNumBits(a.length),l},t.highLevelDecode=function(e){return this.getEncodedData(e)},t.getEncodedData=function(e){for(var r=e.length,n=vl.UPPER,a=vl.UPPER,s="",o=0;o<r;)if(a===vl.BINARY){if(r-o<5)break;var l=t.readCode(e,o,5);if(o+=5,l===0){if(r-o<11)break;l=t.readCode(e,o,11)+31,o+=11}for(var c=0;c<l;c++){if(r-o<8){o=r;break}var u=t.readCode(e,o,8);s+=Na.castAsNonUtf8Char(u),o+=8}a=n}else{var d=a===vl.DIGIT?4:5;if(r-o<d)break;var u=t.readCode(e,o,d);o+=d;var f=t.getCharacter(a,u);f.startsWith("CTRL_")?(n=a,a=t.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(s+=f,a=n)}return s},t.getTable=function(e){switch(e){case"L":return vl.LOWER;case"P":return vl.PUNCT;case"M":return vl.MIXED;case"D":return vl.DIGIT;case"B":return vl.BINARY;case"U":default:return vl.UPPER}},t.getCharacter=function(e,r){switch(e){case vl.UPPER:return t.UPPER_TABLE[r];case vl.LOWER:return t.LOWER_TABLE[r];case vl.MIXED:return t.MIXED_TABLE[r];case vl.PUNCT:return t.PUNCT_TABLE[r];case vl.DIGIT:return t.DIGIT_TABLE[r];default:throw new Ww("Bad table")}},t.prototype.correctBits=function(e){var r,n;this.ddata.getNbLayers()<=2?(n=6,r=tu.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=tu.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=tu.AZTEC_DATA_10):(n=12,r=tu.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),s=e.length/n;if(s<a)throw new Kr;for(var o=e.length%n,l=new Int32Array(s),c=0;c<s;c++,o+=n)l[c]=t.readCode(e,o,n);try{var u=new bP(r);u.decode(l,s-a)}catch(x){throw new Kr(x)}for(var d=(1<<n)-1,f=0,c=0;c<a;c++){var A=l[c];if(A===0||A===d)throw new Kr;(A===1||A===d-1)&&f++}for(var h=new Array(a*n-f),m=0,c=0;c<a;c++){var A=l[c];if(A===1||A===d-1)h.fill(A>1,m,m+n-1),m+=n-1;else for(var p=n-1;p>=0;--p)h[m++]=(A&1<<p)!==0}return h},t.prototype.extractBits=function(e){var r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,s=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,r));if(r)for(var l=0;l<s.length;l++)s[l]=l;else for(var c=a+1+2*sa.truncDivision(sa.truncDivision(a,2)-1,15),u=a/2,d=sa.truncDivision(c,2),l=0;l<u;l++){var f=l+sa.truncDivision(l,15);s[u-l-1]=d-f-1,s[u+l]=d+f+1}for(var l=0,A=0;l<n;l++){for(var h=(n-l)*4+(r?9:12),m=l*2,p=a-1-m,x=0;x<h;x++)for(var v=x*2,y=0;y<2;y++)o[A+v+y]=e.get(s[m+y],s[m+x]),o[A+2*h+v+y]=e.get(s[m+x],s[p-y]),o[A+4*h+v+y]=e.get(s[p-y],s[p-x]),o[A+6*h+v+y]=e.get(s[p-x],s[m+y]);A+=h*8}return o},t.readCode=function(e,r,n){for(var a=0,s=r;s<r+n;s++)a<<=1,e[s]&&(a|=1);return a},t.readByte=function(e,r){var n=e.length-r;return n>=8?t.readCode(e,r,8):t.readCode(e,r,n)<<8-n},t.convertBoolArrayToByteArray=function(e){for(var r=new Uint8Array((e.length+7)/8),n=0;n<r.length;n++)r[n]=t.readByte(e,8*n);return r},t.prototype.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],t.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],t}(),Ta=function(){function t(){}return t.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},t.distance=function(e,r,n,a){var s=e-n,o=r-a;return Math.sqrt(s*s+o*o)},t.sum=function(e){for(var r=0,n=0,a=e.length;n!==a;n++){var s=e[n];r+=s}return r},t}(),hF=function(){function t(){}return t.floatToIntBits=function(e){return e},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),hn=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*hF.floatToIntBits(this.x)+hF.floatToIntBits(this.y)},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.orderBestPatterns=function(e){var r=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),s,o,l;if(n>=r&&n>=a?(o=e[0],s=e[1],l=e[2]):a>=n&&a>=r?(o=e[1],s=e[0],l=e[2]):(o=e[2],s=e[0],l=e[1]),this.crossProductZ(s,o,l)<0){var c=s;s=l,l=c}e[0]=s,e[1]=o,e[2]=l},t.distance=function(e,r){return Ta.distance(e.x,e.y,r.x,r.y)},t.crossProductZ=function(e,r,n){var a=r.x,s=r.y;return(n.x-a)*(e.y-s)-(n.y-s)*(e.x-a)},t}(),QR=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),lUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cUe=function(t){lUe(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n)||this;return l.compact=a,l.nbDatablocks=s,l.nbLayers=o,l}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(QR),AF=function(){function t(e,r,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),r==null&&(r=t.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var s=r/2|0;if(this.leftInit=n-s,this.rightInit=n+s,this.upInit=a-s,this.downInit=a+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new lr}return t.prototype.detect=function(){for(var e=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,s=!1,o=!0,l=!1,c=!1,u=!1,d=!1,f=!1,A=this.width,h=this.height;o;){o=!1;for(var m=!0;(m||!c)&&r<A;)m=this.containsBlackPoint(n,a,r,!1),m?(r++,o=!0,c=!0):c||r++;if(r>=A){s=!0;break}for(var p=!0;(p||!u)&&a<h;)p=this.containsBlackPoint(e,r,a,!0),p?(a++,o=!0,u=!0):u||a++;if(a>=h){s=!0;break}for(var x=!0;(x||!d)&&e>=0;)x=this.containsBlackPoint(n,a,e,!1),x?(e--,o=!0,d=!0):d||e--;if(e<0){s=!0;break}for(var v=!0;(v||!f)&&n>=0;)v=this.containsBlackPoint(e,r,n,!0),v?(n--,o=!0,f=!0):f||n--;if(n<0){s=!0;break}o&&(l=!0)}if(!s&&l){for(var y=r-e,b=null,w=1;b===null&&w<y;w++)b=this.getBlackPointOnSegment(e,a-w,e+w,a);if(b==null)throw new lr;for(var I=null,w=1;I===null&&w<y;w++)I=this.getBlackPointOnSegment(e,n+w,e+w,n);if(I==null)throw new lr;for(var j=null,w=1;j===null&&w<y;w++)j=this.getBlackPointOnSegment(r,n+w,r-w,n);if(j==null)throw new lr;for(var C=null,w=1;C===null&&w<y;w++)C=this.getBlackPointOnSegment(r,a-w,r-w,a);if(C==null)throw new lr;return this.centerEdges(C,b,j,I)}else throw new lr},t.prototype.getBlackPointOnSegment=function(e,r,n,a){for(var s=Ta.round(Ta.distance(e,r,n,a)),o=(n-e)/s,l=(a-r)/s,c=this.image,u=0;u<s;u++){var d=Ta.round(e+u*o),f=Ta.round(r+u*l);if(c.get(d,f))return new hn(d,f)}return null},t.prototype.centerEdges=function(e,r,n,a){var s=e.getX(),o=e.getY(),l=r.getX(),c=r.getY(),u=n.getX(),d=n.getY(),f=a.getX(),A=a.getY(),h=t.CORR;return s<this.width/2?[new hn(f-h,A+h),new hn(l+h,c+h),new hn(u-h,d-h),new hn(s+h,o-h)]:[new hn(f+h,A+h),new hn(l+h,c-h),new hn(u-h,d+h),new hn(s-h,o-h)]},t.prototype.containsBlackPoint=function(e,r,n,a){var s=this.image;if(a){for(var o=e;o<=r;o++)if(s.get(o,n))return!0}else for(var l=e;l<=r;l++)if(s.get(n,l))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t}(),B$=function(){function t(){}return t.checkAndNudgePoints=function(e,r){for(var n=e.getWidth(),a=e.getHeight(),s=!0,o=0;o<r.length&&s;o+=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new lr;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}s=!0;for(var o=r.length-2;o>=0&&s;o-=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new lr;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}},t}(),jse=function(){function t(e,r,n,a,s,o,l,c,u){this.a11=e,this.a21=r,this.a31=n,this.a12=a,this.a22=s,this.a32=o,this.a13=l,this.a23=c,this.a33=u}return t.quadrilateralToQuadrilateral=function(e,r,n,a,s,o,l,c,u,d,f,A,h,m,p,x){var v=t.quadrilateralToSquare(e,r,n,a,s,o,l,c),y=t.squareToQuadrilateral(u,d,f,A,h,m,p,x);return y.times(v)},t.prototype.transformPoints=function(e){for(var r=e.length,n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=0;A<r;A+=2){var h=e[A],m=e[A+1],p=s*h+c*m+f;e[A]=(n*h+o*m+u)/p,e[A+1]=(a*h+l*m+d)/p}},t.prototype.transformPointsWithValues=function(e,r){for(var n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=e.length,h=0;h<A;h++){var m=e[h],p=r[h],x=s*m+c*p+f;e[h]=(n*m+o*p+u)/x,r[h]=(a*m+l*p+d)/x}},t.squareToQuadrilateral=function(e,r,n,a,s,o,l,c){var u=e-n+s-l,d=r-a+o-c;if(u===0&&d===0)return new t(n-e,s-n,e,a-r,o-a,r,0,0,1);var f=n-s,A=l-s,h=a-o,m=c-o,p=f*m-A*h,x=(u*m-A*d)/p,v=(f*d-u*h)/p;return new t(n-e+x*n,l-e+v*l,e,a-r+x*a,c-r+v*c,r,x,v,1)},t.quadrilateralToSquare=function(e,r,n,a,s,o,l,c){return t.squareToQuadrilateral(e,r,n,a,s,o,l,c).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t}(),uUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),dUe=function(t){uUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sampleGrid=function(r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w){var I=jse.quadrilateralToQuadrilateral(s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w);return this.sampleGridWithTransform(r,n,a,I)},e.prototype.sampleGridWithTransform=function(r,n,a,s){if(n<=0||a<=0)throw new lr;for(var o=new uh(n,a),l=new Float32Array(2*n),c=0;c<a;c++){for(var u=l.length,d=c+.5,f=0;f<u;f+=2)l[f]=f/2+.5,l[f+1]=d;s.transformPoints(l),B$.checkAndNudgePoints(r,l);try{for(var f=0;f<u;f+=2)r.get(Math.floor(l[f]),Math.floor(l[f+1]))&&o.set(f/2,c)}catch{throw new lr}}return o},e}(B$),VR=function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new dUe,t}(),zc=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.toResultPoint=function(){return new hn(this.getX(),this.getY())},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t}(),fUe=function(){function t(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return t.prototype.detect=function(){return this.detectMirror(!1)},t.prototype.detectMirror=function(e){var r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var s=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new cUe(s,o,this.compact,this.nbDataBlocks,this.nbLayers)},t.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new lr;var r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],r),this.sampleLine(e[1],e[2],r),this.sampleLine(e[2],e[3],r),this.sampleLine(e[3],e[0],r)]);this.shift=this.getRotation(n,r);for(var a=0,s=0;s<4;s++){var o=n[(this.shift+s)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var l=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)},t.prototype.getRotation=function(e,r){var n=0;e.forEach(function(s,o,l){var c=(s>>r-2<<1)+(s&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(sa.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new lr},t.prototype.getCorrectedParameterData=function(e,r){var n,a;r?(n=7,a=2):(n=10,a=4);for(var s=n-a,o=new Int32Array(n),l=n-1;l>=0;--l)o[l]=e&15,e>>=4;try{var c=new bP(tu.AZTEC_PARAM);c.decode(o,s)}catch{throw new lr}for(var u=0,l=0;l<a;l++)u=(u<<4)+o[l];return u},t.prototype.getBullsEyeCorners=function(e){var r=e,n=e,a=e,s=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var l=this.getFirstDifferent(r,o,1,-1),c=this.getFirstDifferent(n,o,1,1),u=this.getFirstDifferent(a,o,-1,1),d=this.getFirstDifferent(s,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(d,l)*this.nbCenterLayers/(this.distancePoint(s,r)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(l,c,u,d))break}r=l,n=c,a=u,s=d,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new lr;this.compact=this.nbCenterLayers===5;var A=new hn(r.getX()+.5,r.getY()-.5),h=new hn(n.getX()+.5,n.getY()+.5),m=new hn(a.getX()-.5,a.getY()+.5),p=new hn(s.getX()-.5,s.getY()-.5);return this.expandSquare([A,h,m,p],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},t.prototype.getMatrixCenter=function(){var e,r,n,a;try{var s=new AF(this.image).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{var o=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new zc(o+7,l-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new zc(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new zc(o-7,l+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new zc(o-7,l-7),!1,-1,-1).toResultPoint()}var c=Ta.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=Ta.round((e.getY()+a.getY()+r.getY()+n.getY())/4);try{var s=new AF(this.image,15,c,u).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{e=this.getFirstDifferent(new zc(c+7,u-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new zc(c+7,u+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new zc(c-7,u+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new zc(c-7,u-7),!1,-1,-1).toResultPoint()}return c=Ta.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=Ta.round((e.getY()+a.getY()+r.getY()+n.getY())/4),new zc(c,u)},t.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},t.prototype.sampleGrid=function(e,r,n,a,s){var o=VR.getInstance(),l=this.getDimension(),c=l/2-this.nbCenterLayers,u=l/2+this.nbCenterLayers;return o.sampleGrid(e,l,l,c,c,u,c,u,u,c,u,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),s.getX(),s.getY())},t.prototype.sampleLine=function(e,r,n){for(var a=0,s=this.distanceResultPoint(e,r),o=s/n,l=e.getX(),c=e.getY(),u=o*(r.getX()-e.getX())/s,d=o*(r.getY()-e.getY())/s,f=0;f<n;f++)this.image.get(Ta.round(l+f*u),Ta.round(c+f*d))&&(a|=1<<n-f-1);return a},t.prototype.isWhiteOrBlackRectangle=function(e,r,n,a){var s=3;e=new zc(e.getX()-s,e.getY()+s),r=new zc(r.getX()-s,r.getY()-s),n=new zc(n.getX()+s,n.getY()-s),a=new zc(a.getX()+s,a.getY()+s);var o=this.getColor(a,e);if(o===0)return!1;var l=this.getColor(e,r);return l!==o||(l=this.getColor(r,n),l!==o)?!1:(l=this.getColor(n,a),l===o)},t.prototype.getColor=function(e,r){for(var n=this.distancePoint(e,r),a=(r.getX()-e.getX())/n,s=(r.getY()-e.getY())/n,o=0,l=e.getX(),c=e.getY(),u=this.image.get(e.getX(),e.getY()),d=Math.ceil(n),f=0;f<d;f++)l+=a,c+=s,this.image.get(Ta.round(l),Ta.round(c))!==u&&o++;var A=o/n;return A>.1&&A<.9?0:A<=.1===u?1:-1},t.prototype.getFirstDifferent=function(e,r,n,a){for(var s=e.getX()+n,o=e.getY()+a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n,o+=a;for(s-=n,o-=a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n;for(s-=n;this.isValid(s,o)&&this.image.get(s,o)===r;)o+=a;return o-=a,new zc(s,o)},t.prototype.expandSquare=function(e,r,n){var a=n/(2*r),s=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),l=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,u=new hn(l+a*s,c+a*o),d=new hn(l-a*s,c-a*o);s=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),l=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var f=new hn(l+a*s,c+a*o),A=new hn(l-a*s,c-a*o),h=[u,f,d,A];return h},t.prototype.isValid=function(e,r){return e>=0&&e<this.image.getWidth()&&r>0&&r<this.image.getHeight()},t.prototype.isValidPoint=function(e){var r=Ta.round(e.getX()),n=Ta.round(e.getY());return this.isValid(r,n)},t.prototype.distancePoint=function(e,r){return Ta.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.distanceResultPoint=function(e,r){return Ta.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(sa.truncDivision(this.nbLayers-4,8)+1)+15},t}(),rj=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=null,a=new fUe(e.getBlackMatrix()),s=null,o=null;try{var l=a.detectMirror(!1);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new T$().decode(l)}catch(f){n=f}if(o==null)try{var l=a.detectMirror(!0);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new T$().decode(l)}catch(f){throw n??f}var c=new hc(o.getText(),o.getRawBytes(),o.getNumBits(),s,In.AZTEC,Cs.currentTimeMillis()),u=o.getByteSegments();u!=null&&c.putMetadata(Tl.BYTE_SEGMENTS,u);var d=o.getECLevel();return d!=null&&c.putMetadata(Tl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reportFoundResultPoints=function(e,r){if(e!=null){var n=e.get(_s.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach(function(a,s,o){n.foundPossibleResultPoint(a)})}},t.prototype.reset=function(){},t}(),hUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){hUe(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new rj,r)||this}return e})(S1);var Fo=function(){function t(){}return t.prototype.decode=function(e,r){try{return this.doDecode(e,r)}catch{var n=r&&r.get(_s.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),s=this.doDecode(a,r),o=s.getResultMetadata(),l=270;o!==null&&o.get(Tl.ORIENTATION)===!0&&(l=l+o.get(Tl.ORIENTATION)%360),s.putMetadata(Tl.ORIENTATION,l);var c=s.getResultPoints();if(c!==null)for(var u=a.getHeight(),d=0;d<c.length;d++)c[d]=new hn(u-c[d].getY()-1,c[d].getX());return s}else throw new lr}},t.prototype.reset=function(){},t.prototype.doDecode=function(e,r){var n=e.getWidth(),a=e.getHeight(),s=new tl(n),o=r&&r.get(_s.TRY_HARDER)===!0,l=Math.max(1,a>>(o?8:5)),c;o?c=a:c=15;for(var u=Math.trunc(a/2),d=0;d<c;d++){var f=Math.trunc((d+1)/2),A=(d&1)===0,h=u+l*(A?f:-f);if(h<0||h>=a)break;try{s=e.getBlackRow(h,s)}catch{continue}for(var m=function(y){if(y===1&&(s.reverse(),r&&r.get(_s.NEED_RESULT_POINT_CALLBACK)===!0)){var b=new Map;r.forEach(function(j,C){return b.set(C,j)}),b.delete(_s.NEED_RESULT_POINT_CALLBACK),r=b}try{var w=p.decodeRow(h,s,r);if(y===1){w.putMetadata(Tl.ORIENTATION,180);var I=w.getResultPoints();I!==null&&(I[0]=new hn(n-I[0].getX()-1,I[0].getY()),I[1]=new hn(n-I[1].getX()-1,I[1].getY()))}return{value:w}}catch{}},p=this,x=0;x<2;x++){var v=m(x);if(typeof v=="object")return v.value}}throw new lr},t.recordPattern=function(e,r,n){for(var a=n.length,s=0;s<a;s++)n[s]=0;var o=e.getSize();if(r>=o)throw new lr;for(var l=!e.get(r),c=0,u=r;u<o;){if(e.get(u)!==l)n[c]++;else{if(++c===a)break;n[c]=1,l=!l}u++}if(!(c===a||c===a-1&&u===o))throw new lr},t.recordPatternInReverse=function(e,r,n){for(var a=n.length,s=e.get(r);r>0&&a>=0;)e.get(--r)!==s&&(a--,s=!s);if(a>=0)throw new lr;t.recordPattern(e,r+1,n)},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return Number.POSITIVE_INFINITY;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return Number.POSITIVE_INFINITY;u+=h}return u/s},t}(),AUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),k$=function(t){AUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.findStartPattern=function(r){for(var n=r.getSize(),a=r.getNextSet(0),s=0,o=Int32Array.from([0,0,0,0,0,0]),l=a,c=!1,u=6,d=a;d<n;d++)if(r.get(d)!==c)o[s]++;else{if(s===u-1){for(var f=e.MAX_AVG_VARIANCE,A=-1,h=e.CODE_START_A;h<=e.CODE_START_C;h++){var m=Fo.patternMatchVariance(o,e.CODE_PATTERNS[h],e.MAX_INDIVIDUAL_VARIANCE);m<f&&(f=m,A=h)}if(A>=0&&r.isRange(Math.max(0,l-(d-l)/2),l,!1))return Int32Array.from([l,d,A]);l+=o[0]+o[1],o=o.slice(2,o.length),o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,c=!c}throw new lr},e.decodeCode=function(r,n,a){Fo.recordPattern(r,a,n);for(var s=e.MAX_AVG_VARIANCE,o=-1,l=0;l<e.CODE_PATTERNS.length;l++){var c=e.CODE_PATTERNS[l],u=this.patternMatchVariance(n,c,e.MAX_INDIVIDUAL_VARIANCE);u<s&&(s=u,o=l)}if(o>=0)return o;throw new lr},e.prototype.decodeRow=function(r,n,a){var s=a&&a.get(_s.ASSUME_GS1)===!0,o=e.findStartPattern(n),l=o[2],c=0,u=new Uint8Array(20);u[c++]=l;var d;switch(l){case e.CODE_START_A:d=e.CODE_CODE_A;break;case e.CODE_START_B:d=e.CODE_CODE_B;break;case e.CODE_START_C:d=e.CODE_CODE_C;break;default:throw new Kr}for(var f=!1,A=!1,h="",m=o[0],p=o[1],x=Int32Array.from([0,0,0,0,0,0]),v=0,y=0,b=l,w=0,I=!0,j=!1,C=!1;!f;){var S=A;switch(A=!1,v=y,y=e.decodeCode(n,x,p),u[c++]=y,y!==e.CODE_STOP&&(I=!0),y!==e.CODE_STOP&&(w++,b+=w*y),m=p,p+=x.reduce(function(le,Ae){return le+Ae},0),y){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new Kr}switch(d){case e.CODE_CODE_A:if(y<64)C===j?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),C=!1;else if(y<96)C===j?h+=String.fromCharCode(y-64):h+=String.fromCharCode(y+64),C=!1;else switch(y!==e.CODE_STOP&&(I=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!j&&C?(j=!0,C=!1):j&&C?(j=!1,C=!1):C=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_B;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(y<96)C===j?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),C=!1;else switch(y!==e.CODE_STOP&&(I=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!j&&C?(j=!0,C=!1):j&&C?(j=!1,C=!1):C=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_A;break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(y<100)y<10&&(h+="0"),h+=y;else switch(y!==e.CODE_STOP&&(I=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}S&&(d=d===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var E=p-m;if(p=n.getNextUnset(p),!n.isRange(p,Math.min(n.getSize(),p+(p-m)/2),!1))throw new lr;if(b-=w*v,b%103!==v)throw new co;var B=h.length;if(B===0)throw new lr;B>0&&I&&(d===e.CODE_CODE_C?h=h.substring(0,B-2):h=h.substring(0,B-1));for(var k=(o[1]+o[0])/2,T=m+E/2,P=u.length,G=new Uint8Array(P),ce=0;ce<P;ce++)G[ce]=u[ce];var ue=[new hn(k,r),new hn(T,r)];return new hc(h,G,0,ue,In.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(Fo),mUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},F$=function(t){mUe(e,t);function e(r,n){r===void 0&&(r=!1),n===void 0&&(n=!1);var a=t.call(this)||this;return a.usingCheckDigit=r,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.counters;u.fill(0),this.decodeRowResult="";var d=e.findAsteriskPattern(n,u),f=n.getNextSet(d[1]),A=n.getSize(),h,m;do{e.recordPattern(n,f,u);var p=e.toNarrowWidePattern(u);if(p<0)throw new lr;h=e.patternToChar(p),this.decodeRowResult+=h,m=f;try{for(var x=(s=void 0,G5(u)),v=x.next();!v.done;v=x.next()){var y=v.value;f+=y}}catch(P){s={error:P}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}f=n.getNextSet(f)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=G5(u),I=w.next();!I.done;I=w.next()){var y=I.value;b+=y}}catch(P){l={error:P}}finally{try{I&&!I.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}var j=f-m-b;if(f!==A&&j*2<b)throw new lr;if(this.usingCheckDigit){for(var C=this.decodeRowResult.length-1,S=0,E=0;E<C;E++)S+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(E));if(this.decodeRowResult.charAt(C)!==e.ALPHABET_STRING.charAt(S%43))throw new co;this.decodeRowResult=this.decodeRowResult.substring(0,C)}if(this.decodeRowResult.length===0)throw new lr;var B;this.extendedMode?B=e.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;var k=(d[1]+d[0])/2,T=m+b/2;return new hc(B,null,0,[new hn(k,r),new hn(T,r)],In.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(r,n){for(var a=r.getSize(),s=r.getNextSet(0),o=0,l=s,c=!1,u=n.length,d=s;d<a;d++)if(r.get(d)!==c)n[o]++;else{if(o===u-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&r.isRange(Math.max(0,l-Math.floor((d-l)/2)),l,!1))return[l,d];l+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,c=!c}throw new lr},e.toNarrowWidePattern=function(r){var n,a,s=r.length,o=0,l;do{var c=2147483647;try{for(var u=(n=void 0,G5(r)),d=u.next();!d.done;d=u.next()){var f=d.value;f<c&&f>o&&(c=f)}}catch(p){n={error:p}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o=c,l=0;for(var A=0,h=0,m=0;m<s;m++){var f=r[m];f>o&&(h|=1<<s-1-m,l++,A+=f)}if(l===3){for(var m=0;m<s&&l>0;m++){var f=r[m];if(f>o&&(l--,f*2>=A))return-1}return h}}while(l>3);return-1},e.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);if(r===e.ASTERISK_ENCODING)return"*";throw new lr},e.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o==="+"||o==="$"||o==="%"||o==="/"){var l=r.charAt(s+1),c="\0";switch(o){case"+":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Kr;break;case"$":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Kr;break;case"%":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l==="X"||l==="Y"||l==="Z")c="";else throw new Kr;break;case"/":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Kr;break}a+=c,s++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(Fo),pUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),K5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},O$=function(t){pUe(e,t);function e(){var r=t.call(this)||this;return r.decodeRowResult="",r.counters=new Int32Array(6),r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.findAsteriskPattern(n),d=n.getNextSet(u[1]),f=n.getSize(),A=this.counters;A.fill(0),this.decodeRowResult="";var h,m;do{e.recordPattern(n,d,A);var p=this.toPattern(A);if(p<0)throw new lr;h=this.patternToChar(p),this.decodeRowResult+=h,m=d;try{for(var x=(s=void 0,K5(A)),v=x.next();!v.done;v=x.next()){var y=v.value;d+=y}}catch(E){s={error:E}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}d=n.getNextSet(d)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=K5(A),I=w.next();!I.done;I=w.next()){var y=I.value;b+=y}}catch(E){l={error:E}}finally{try{I&&!I.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}if(d===f||!n.get(d))throw new lr;if(this.decodeRowResult.length<2)throw new lr;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var j=this.decodeExtended(this.decodeRowResult),C=(u[1]+u[0])/2,S=m+b/2;return new hc(j,null,0,[new hn(C,r),new hn(S,r)],In.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(r){var n=r.getSize(),a=r.getNextSet(0);this.counters.fill(0);for(var s=this.counters,o=a,l=!1,c=s.length,u=0,d=a;d<n;d++)if(r.get(d)!==l)s[u]++;else{if(u===c-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([o,d]);o+=s[0]+s[1],s.copyWithin(0,2,2+u-1),s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,l=!l}throw new lr},e.prototype.toPattern=function(r){var n,a,s=0;try{for(var o=K5(r),l=o.next();!l.done;l=o.next()){var c=l.value;s+=c}}catch(m){n={error:m}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var u=0,d=r.length,f=0;f<d;f++){var A=Math.round(r[f]*9/s);if(A<1||A>4)return-1;if(f&1)u<<=A;else for(var h=0;h<A;h++)u=u<<1|1}return u},e.prototype.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);throw new lr},e.prototype.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o>="a"&&o<="d"){if(s>=n-1)throw new Kr;var l=r.charAt(s+1),c="\0";switch(o){case"d":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Kr;break;case"a":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Kr;break;case"b":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l>="X"&&l<="Z")c="";else throw new Kr;break;case"c":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Kr;break}a+=c,s++}else a+=o}return a},e.prototype.checkChecksums=function(r){var n=r.length;this.checkOneChecksum(r,n-2,20),this.checkOneChecksum(r,n-1,15)},e.prototype.checkOneChecksum=function(r,n,a){for(var s=1,o=0,l=n-1;l>=0;l--)o+=s*e.ALPHABET_STRING.indexOf(r.charAt(l)),++s>a&&(s=1);if(r.charAt(n)!==e.ALPHABET_STRING[o%47])throw new co},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(Fo),gUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},D$=function(t){gUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return e.prototype.decodeRow=function(r,n,a){var s,o,l=this.decodeStart(n),c=this.decodeEnd(n),u=new ta;e.decodeMiddle(n,l[1],c[0],u);var d=u.toString(),f=null;a!=null&&(f=a.get(_s.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var A=d.length,h=!1,m=0;try{for(var p=xUe(f),x=p.next();!x.done;x=p.next()){var v=x.value;if(A===v){h=!0;break}v>m&&(m=v)}}catch(w){s={error:w}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}if(!h&&A>m&&(h=!0),!h)throw new Kr;var y=[new hn(l[1],r),new hn(c[0],r)],b=new hc(d,null,0,y,In.ITF,new Date().getTime());return b},e.decodeMiddle=function(r,n,a,s){var o=new Int32Array(10),l=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),l.fill(0),c.fill(0);n<a;){Fo.recordPattern(r,n,o);for(var u=0;u<5;u++){var d=2*u;l[u]=o[d],c[u]=o[d+1]}var f=e.decodeDigit(l);s.append(f.toString()),f=this.decodeDigit(c),s.append(f.toString()),o.forEach(function(A){n+=A})}},e.prototype.decodeStart=function(r){var n=e.skipWhiteSpace(r),a=e.findGuardPattern(r,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a},e.prototype.validateQuietZone=function(r,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var s=n-1;a>0&&s>=0&&!r.get(s);s--)a--;if(a!==0)throw new lr},e.skipWhiteSpace=function(r){var n=r.getSize(),a=r.getNextSet(0);if(a===n)throw new lr;return a},e.prototype.decodeEnd=function(r){r.reverse();try{var n=e.skipWhiteSpace(r),a=void 0;try{a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof lr&&(a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);var s=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-s,a}finally{r.reverse()}},e.findGuardPattern=function(r,n,a){var s=a.length,o=new Int32Array(s),l=r.getSize(),c=!1,u=0,d=n;o.fill(0);for(var f=n;f<l;f++)if(r.get(f)!==c)o[u]++;else{if(u===s-1){if(Fo.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[d,f];d+=o[0]+o[1],Cs.arraycopy(o,2,o,0,u-1),o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,c=!c}throw new lr},e.decodeDigit=function(r){for(var n=e.MAX_AVG_VARIANCE,a=-1,s=e.PATTERNS.length,o=0;o<s;o++){var l=e.PATTERNS[o],c=Fo.patternMatchVariance(r,l,e.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,a=o):c===n&&(a=-1)}if(a>=0)return a%10;throw new lr},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(Fo),vUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kv=function(t){vUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.decodeRowStringBuffer="",r}return e.findStartGuardPattern=function(r){for(var n=!1,a,s=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(r,s,!1,this.START_END_PATTERN,o);var l=a[0];s=a[1];var c=l-(s-l);c>=0&&(n=r.isRange(c,l,!1))}return a},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Kr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Kr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(r,n,a,s){return this.findGuardPattern(r,n,a,s,new Int32Array(s.length))},e.findGuardPattern=function(r,n,a,s,o){var l=r.getSize();n=a?r.getNextUnset(n):r.getNextSet(n);for(var c=0,u=n,d=s.length,f=a,A=n;A<l;A++)if(r.get(A)!==f)o[c]++;else{if(c===d-1){if(Fo.patternMatchVariance(o,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([u,A]);u+=o[0]+o[1];for(var h=o.slice(2,o.length),m=0;m<c-1;m++)o[m]=h[m];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,f=!f}throw new lr},e.decodeDigit=function(r,n,a,s){this.recordPattern(r,a,n);for(var o=this.MAX_AVG_VARIANCE,l=-1,c=s.length,u=0;u<c;u++){var d=s[u],f=Fo.patternMatchVariance(n,d,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,l=u)}if(l>=0)return l;throw new lr},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(Fo),yUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},bUe=function(){function t(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new hn((n[0]+n[1])/2,e),new hn(s,e)],u=new hc(o,null,0,c,In.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<5&&c<l;d++){var f=Kv.decodeDigit(e,o,c,Kv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,yUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<4-d),d!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==5)throw new lr;var p=this.determineCheckDigit(u);if(t.extensionChecksum(n.toString())!==p)throw new lr;return c},t.extensionChecksum=function(e){for(var r=e.length,n=0,a=r-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=r-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},t.prototype.determineCheckDigit=function(e){for(var r=0;r<10;r++)if(e===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new lr},t.parseExtensionString=function(e){if(e.length!==5)return null;var r=t.parseExtension5String(e);return r==null?null:new Map([[Tl.SUGGESTED_PRICE,r]])},t.parseExtension5String=function(e){var r;switch(e.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),s=n%100,o=s<10?"0"+s:s.toString();return r+a+"."+o},t}(),wUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},NUe=function(){function t(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new hn((n[0]+n[1])/2,e),new hn(s,e)],u=new hc(o,null,0,c,In.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<2&&c<l;d++){var f=Kv.decodeDigit(e,o,c,Kv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,wUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<1-d),d!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==2)throw new lr;if(parseInt(n.toString())%4!==u)throw new lr;return c},t.parseExtensionString=function(e){return e.length!==2?null:new Map([[Tl.ISSUE_NUMBER,parseInt(e)]])},t}(),CUe=function(){function t(){}return t.decodeRow=function(e,r,n){var a=Kv.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new bUe;return s.decodeRow(e,r,a)}catch{var o=new NUe;return o.decodeRow(e,r,a)}},t.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),t}(),_Ue=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Eo=function(t){_Ue(e,t);function e(){var r=t.call(this)||this;r.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(l){return Int32Array.from(l)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],s=new Int32Array(a.length),o=0;o<a.length;o++)s[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=s}return r}return e.prototype.decodeRow=function(r,n,a){var s=e.findStartGuardPattern(n),o=a==null?null:a.get(_s.NEED_RESULT_POINT_CALLBACK);if(o!=null){var l=new hn((s[0]+s[1])/2,r);o.foundPossibleResultPoint(l)}var c=this.decodeMiddle(n,s,this.decodeRowStringBuffer),u=c.rowOffset,d=c.resultString;if(o!=null){var f=new hn(u,r);o.foundPossibleResultPoint(f)}var A=e.decodeEnd(n,u);if(o!=null){var h=new hn((A[0]+A[1])/2,r);o.foundPossibleResultPoint(h)}var m=A[1],p=m+(m-A[0]);if(p>=n.getSize()||!n.isRange(m,p,!1))throw new lr;var x=d.toString();if(x.length<8)throw new Kr;if(!e.checkChecksum(x))throw new co;var v=(s[1]+s[0])/2,y=(A[1]+A[0])/2,b=this.getBarcodeFormat(),w=[new hn(v,r),new hn(y,r)],I=new hc(x,null,0,w,b,new Date().getTime()),j=0;try{var C=CUe.decodeRow(r,n,A[1]);I.putMetadata(Tl.UPC_EAN_EXTENSION,C.getText()),I.putAllMetadata(C.getResultMetadata()),I.addResultPoints(C.getResultPoints()),j=C.getText().length}catch{}var S=a==null?null:a.get(_s.ALLOWED_EAN_EXTENSIONS);if(S!=null){var E=!1;for(var B in S)if(j.toString()===B){E=!0;break}if(!E)throw new lr}return b===In.EAN_13||In.UPC_A,I},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Kr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Kr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(Kv),EUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),R$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mF=function(t){EUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0,h=0;h<6&&f<d;h++){var m=Eo.decodeDigit(r,u,f,Eo.L_AND_G_PATTERNS);a+=String.fromCharCode(48+m%10);try{for(var p=(s=void 0,R$(u)),x=p.next();!x.done;x=p.next()){var v=x.value;f+=v}}catch(I){s={error:I}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}m>=10&&(A|=1<<5-h)}a=e.determineFirstDigit(a,A);var y=Eo.findGuardPattern(r,f,!0,Eo.MIDDLE_PATTERN,new Int32Array(Eo.MIDDLE_PATTERN.length).fill(0));f=y[1];for(var h=0;h<6&&f<d;h++){var m=Eo.decodeDigit(r,u,f,Eo.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var b=(l=void 0,R$(u)),w=b.next();!w.done;w=b.next()){var v=w.value;f+=v}}catch(C){l={error:C}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return In.EAN_13},e.determineFirstDigit=function(r,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new lr},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(Eo),SUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),M$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},L$=function(t){SUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0;A<4&&f<d;A++){var h=Eo.decodeDigit(r,u,f,Eo.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var m=(s=void 0,M$(u)),p=m.next();!p.done;p=m.next()){var x=p.value;f+=x}}catch(w){s={error:w}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(s)throw s.error}}}var v=Eo.findGuardPattern(r,f,!0,Eo.MIDDLE_PATTERN,new Int32Array(Eo.MIDDLE_PATTERN.length).fill(0));f=v[1];for(var A=0;A<4&&f<d;A++){var h=Eo.decodeDigit(r,u,f,Eo.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var y=(l=void 0,M$(u)),b=y.next();!b.done;b=y.next()){var x=b.value;f+=x}}catch(j){l={error:j}}finally{try{b&&!b.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return In.EAN_8},e}(Eo),jUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),U$=function(t){jUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.ean13Reader=new mF,r}return e.prototype.getBarcodeFormat=function(){return In.UPC_A},e.prototype.decode=function(r,n){return this.maybeReturnResult(this.ean13Reader.decode(r))},e.prototype.decodeRow=function(r,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,n,a))},e.prototype.decodeMiddle=function(r,n,a){return this.ean13Reader.decodeMiddle(r,n,a)},e.prototype.maybeReturnResult=function(r){var n=r.getText();if(n.charAt(0)==="0"){var a=new hc(n.substring(1),null,null,r.getResultPoints(),In.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new lr},e.prototype.reset=function(){this.ean13Reader.reset()},e}(Eo),IUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),PUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q$=function(t){IUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=new Int32Array(4),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l=this.decodeMiddleCounters.map(function(x){return x});l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=r.getSize(),u=n[1],d=0,f=0;f<6&&u<c;f++){var A=e.decodeDigit(r,l,u,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);try{for(var h=(s=void 0,PUe(l)),m=h.next();!m.done;m=h.next()){var p=m.value;u+=p}}catch(x){s={error:x}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(s)throw s.error}}A>=10&&(d|=1<<5-f)}return e.determineNumSysAndCheckDigit(new ta(a),d),u},e.prototype.decodeEnd=function(r,n){return e.findGuardPatternWithoutCounters(r,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(r){return Eo.checkChecksum(e.convertUPCEtoUPCA(r))},e.determineNumSysAndCheckDigit=function(r,n){for(var a=0;a<=1;a++)for(var s=0;s<10;s++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][s]){r.insert(0,"0"+a),r.append("0"+s);return}throw lr.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return In.UPC_E},e.convertUPCEtoUPCA=function(r){var n=r.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new ta;a.append(r.charAt(0));var s=n[5];switch(s){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(s),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(s);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(Eo),TUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),V$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q5=function(t){TUe(e,t);function e(r){var n=t.call(this)||this,a=r==null?null:r.get(_s.POSSIBLE_FORMATS),s=[];return a!=null&&(a.indexOf(In.EAN_13)>-1&&s.push(new mF),a.indexOf(In.UPC_A)>-1&&s.push(new U$),a.indexOf(In.EAN_8)>-1&&s.push(new L$),a.indexOf(In.UPC_E)>-1&&s.push(new Q$)),s.length===0&&(s.push(new mF),s.push(new U$),s.push(new L$),s.push(new Q$)),n.readers=s,n}return e.prototype.decodeRow=function(r,n,a){var s,o;try{for(var l=V$(this.readers),c=l.next();!c.done;c=l.next()){var u=c.value;try{var d=u.decodeRow(r,n,a),f=d.getBarcodeFormat()===In.EAN_13&&d.getText().charAt(0)==="0",A=a==null?null:a.get(_s.POSSIBLE_FORMATS),h=A==null||A.includes(In.UPC_A);if(f&&h){var m=d.getRawBytes(),p=new hc(d.getText().substring(1),m,m?m.length:null,d.getResultPoints(),In.UPC_A);return p.putAllMetadata(d.getResultMetadata()),p}return d}catch{}}}catch(x){s={error:x}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}throw new lr},e.prototype.reset=function(){var r,n;try{for(var a=V$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;o.reset()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}(Fo),BUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),kUe=function(t){BUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},r}return e.prototype.decodeRow=function(r,n,a){var s=this.getValidRowData(n);if(!s)throw new lr;var o=this.codaBarDecodeRow(s.row);if(!o)throw new lr;return new hc(o,null,0,[new hn(s.left,r),new hn(s.right,r)],In.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(r){var n=r.toArray(),a=n.indexOf(!0);if(a===-1)return null;var s=n.lastIndexOf(!0);if(s<=a)return null;n=n.slice(a,s+1);for(var o=[],l=n[0],c=1,u=1;u<n.length;u++)n[u]===l?c++:(l=n[u],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:s}},e.prototype.codaBarDecodeRow=function(r){for(var n=[],a=Math.ceil(r.reduce(function(c,u){return(c+u)/2},0));r.length>0;){var s=r.splice(0,8).splice(0,7),o=s.map(function(c){return c<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var l=n.join("");return this.validCodaBarString(l)?l:null},e.prototype.validCodaBarString=function(r){var n=/^[A-D].{1,}[A-D]$/;return n.test(r)},e}(Fo),FUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),OUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mp=function(t){FUe(e,t);function e(){var r=t.call(this)||this;return r.decodeFinderCounters=new Int32Array(4),r.dataCharacterCounters=new Int32Array(8),r.oddRoundingErrors=new Array(4),r.evenRoundingErrors=new Array(4),r.oddCounts=new Array(r.dataCharacterCounters.length/2),r.evenCounts=new Array(r.dataCharacterCounters.length/2),r}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(r,n){for(var a=0;a<n.length;a++)if(Fo.patternMatchVariance(r,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new lr},e.count=function(r){return Ta.sum(new Int32Array(r))},e.increment=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]>s&&(s=n[o],a=o);r[a]++},e.decrement=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]<s&&(s=n[o],a=o);r[a]--},e.isFinderPattern=function(r){var n,a,s=r[0]+r[1],o=s+r[2]+r[3],l=s/o;if(l>=e.MIN_FINDER_PATTERN_RATIO&&l<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;try{for(var d=OUe(r),f=d.next();!f.done;f=d.next()){var A=f.value;A>u&&(u=A),A<c&&(c=A)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return u<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(Fo),nj=function(){function t(e,r){this.value=e,this.checksumPortion=r}return t.prototype.getValue=function(){return this.value},t.prototype.getChecksumPortion=function(){return this.checksumPortion},t.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value&&this.checksumPortion===r.checksumPortion},t.prototype.hashCode=function(){return this.value^this.checksumPortion},t}(),Ise=function(){function t(e,r,n,a,s){this.value=e,this.startEnd=r,this.value=e,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new hn(n,s)),this.resultPoints.push(new hn(a,s))}return t.prototype.getValue=function(){return this.value},t.prototype.getStartEnd=function(){return this.startEnd},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.hashCode=function(){return this.value},t}(),DUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jx=function(){function t(){}return t.getRSSvalue=function(e,r,n){var a,s,o=0;try{for(var l=DUe(e),c=l.next();!c.done;c=l.next()){var u=c.value;o+=u}}catch(y){a={error:y}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}for(var d=0,f=0,A=e.length,h=0;h<A-1;h++){var m=void 0;for(m=1,f|=1<<h;m<e[h];m++,f&=~(1<<h)){var p=t.combins(o-m-1,A-h-2);if(n&&f===0&&o-m-(A-h-1)>=A-h-1&&(p-=t.combins(o-m-(A-h),A-h-2)),A-h-1>1){for(var x=0,v=o-m-(A-h-2);v>r;v--)x+=t.combins(o-m-v-1,A-h-3);p-=x*(A-1-h)}else o-m>r&&p--;d+=p}o-=m}return d},t.combins=function(e,r){var n,a;e-r>r?(a=r,n=e-r):(a=e-r,n=r);for(var s=1,o=1,l=e;l>n;l--)s*=l,o<=a&&(s/=o,o++);for(;o<=a;)s/=o,o++;return s},t}(),RUe=function(){function t(){}return t.buildBitArray=function(e){var r=e.length*2-1;e[e.length-1].getRightChar()==null&&(r-=1);for(var n=12*r,a=new tl(n),s=0,o=e[0],l=o.getRightChar().getValue(),c=11;c>=0;--c)l&1<<c&&a.set(s),s++;for(var c=1;c<e.length;++c){for(var u=e[c],d=u.getLeftChar().getValue(),f=11;f>=0;--f)d&1<<f&&a.set(s),s++;if(u.getRightChar()!==null)for(var A=u.getRightChar().getValue(),f=11;f>=0;--f)A&1<<f&&a.set(s),s++}return a},t}(),np=function(){function t(e,r){r?this.decodedInformation=null:(this.finished=e,this.decodedInformation=r)}return t.prototype.getDecodedInformation=function(){return this.decodedInformation},t.prototype.isFinished=function(){return this.finished},t}(),HR=function(){function t(e){this.newPosition=e}return t.prototype.getNewPosition=function(){return this.newPosition},t}(),MUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ef=function(t){MUe(e,t);function e(r,n){var a=t.call(this,r)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(HR),LUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ap=function(t){LUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return a?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=n,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(HR),UUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),bx=function(t){UUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;if(n<0||n>10||a<0||a>10)throw new Kr;return s.firstDigit=n,s.secondDigit=a,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(HR),c_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},QUe=function(){function t(){}return t.parseFieldsInGeneralPurpose=function(e){var r,n,a,s,o,l,c,u;if(!e)return null;if(e.length<2)throw new lr;var d=e.substring(0,2);try{for(var f=c_(t.TWO_DIGIT_DATA_LENGTH),A=f.next();!A.done;A=f.next()){var h=A.value;if(h[0]===d)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(2,h[2],e):t.processFixedAI(2,h[1],e)}}catch(j){r={error:j}}finally{try{A&&!A.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}if(e.length<3)throw new lr;var m=e.substring(0,3);try{for(var p=c_(t.THREE_DIGIT_DATA_LENGTH),x=p.next();!x.done;x=p.next()){var h=x.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(3,h[2],e):t.processFixedAI(3,h[1],e)}}catch(j){a={error:j}}finally{try{x&&!x.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}try{for(var v=c_(t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),y=v.next();!y.done;y=v.next()){var h=y.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(j){o={error:j}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(o)throw o.error}}if(e.length<4)throw new lr;var b=e.substring(0,4);try{for(var w=c_(t.FOUR_DIGIT_DATA_LENGTH),I=w.next();!I.done;I=w.next()){var h=I.value;if(h[0]===b)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(j){c={error:j}}finally{try{I&&!I.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}throw new lr},t.processFixedAI=function(e,r,n){if(n.length<e)throw new lr;var a=n.substring(0,e);if(n.length<e+r)throw new lr;var s=n.substring(e,e+r),o=n.substring(e+r),l="("+a+")"+s,c=t.parseFieldsInGeneralPurpose(o);return c==null?l:l+c},t.processVariableAI=function(e,r,n){var a=n.substring(0,e),s;n.length<e+r?s=n.length:s=e+r;var o=n.substring(e,s),l=n.substring(s),c="("+a+")"+o,u=t.parseFieldsInGeneralPurpose(l);return u==null?c:c+u},t.VARIABLE_LENGTH=[],t.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",t.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",t.VARIABLE_LENGTH,20],["22",t.VARIABLE_LENGTH,29],["30",t.VARIABLE_LENGTH,8],["37",t.VARIABLE_LENGTH,8],["90",t.VARIABLE_LENGTH,30],["91",t.VARIABLE_LENGTH,30],["92",t.VARIABLE_LENGTH,30],["93",t.VARIABLE_LENGTH,30],["94",t.VARIABLE_LENGTH,30],["95",t.VARIABLE_LENGTH,30],["96",t.VARIABLE_LENGTH,30],["97",t.VARIABLE_LENGTH,3],["98",t.VARIABLE_LENGTH,30],["99",t.VARIABLE_LENGTH,30]],t.THREE_DIGIT_DATA_LENGTH=[["240",t.VARIABLE_LENGTH,30],["241",t.VARIABLE_LENGTH,30],["242",t.VARIABLE_LENGTH,6],["250",t.VARIABLE_LENGTH,30],["251",t.VARIABLE_LENGTH,30],["253",t.VARIABLE_LENGTH,17],["254",t.VARIABLE_LENGTH,20],["400",t.VARIABLE_LENGTH,30],["401",t.VARIABLE_LENGTH,30],["402",17],["403",t.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",t.VARIABLE_LENGTH,20],["421",t.VARIABLE_LENGTH,15],["422",3],["423",t.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",t.VARIABLE_LENGTH,15],["391",t.VARIABLE_LENGTH,18],["392",t.VARIABLE_LENGTH,15],["393",t.VARIABLE_LENGTH,18],["703",t.VARIABLE_LENGTH,30]],t.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",t.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",t.VARIABLE_LENGTH,20],["8003",t.VARIABLE_LENGTH,30],["8004",t.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",t.VARIABLE_LENGTH,30],["8008",t.VARIABLE_LENGTH,12],["8018",18],["8020",t.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",t.VARIABLE_LENGTH,70],["8200",t.VARIABLE_LENGTH,70]],t}(),bE=function(){function t(e){this.buffer=new ta,this.information=e}return t.prototype.decodeAllCodes=function(e,r){var n=r,a=null;do{var s=this.decodeGeneralPurposeField(n,a),o=QUe.parseFieldsInGeneralPurpose(s.getNewString());if(o!=null&&e.append(o),s.isRemaining()?a=""+s.getRemainingValue():a=null,n===s.getNewPosition())break;n=s.getNewPosition()}while(!0);return e.toString()},t.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var r=e;r<e+3;++r)if(this.information.get(r))return!0;return this.information.get(e+3)},t.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var r=this.extractNumericValueFromBitArray(e,4);return r===0?new bx(this.information.getSize(),bx.FNC1,bx.FNC1):new bx(this.information.getSize(),r-1,bx.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,s=(n-8)%11;return new bx(e+7,a,s)},t.prototype.extractNumericValueFromBitArray=function(e,r){return t.extractNumericValueFromBitArray(this.information,e,r)},t.extractNumericValueFromBitArray=function(e,r,n){for(var a=0,s=0;s<n;++s)e.get(r+s)&&(a|=1<<n-s-1);return a},t.prototype.decodeGeneralPurposeField=function(e,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new ap(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new ap(this.current.getPosition(),this.buffer.toString())},t.prototype.parseBlocks=function(){var e,r;do{var n=this.current.getPosition();this.current.isAlpha()?(r=this.parseAlphaBlock(),e=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),e=r.isFinished()):(r=this.parseNumericBlock(),e=r.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return r.getDecodedInformation()},t.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var r=void 0;return e.isSecondDigitFNC1()?r=new ap(this.current.getPosition(),this.buffer.toString()):r=new ap(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new np(!0,r)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var r=new ap(this.current.getPosition(),this.buffer.toString());return new np(!0,r)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new np(!1)},t.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new ap(this.current.getPosition(),this.buffer.toString());return new np(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new np(!1)},t.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new ap(this.current.getPosition(),this.buffer.toString());return new np(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new np(!1)},t.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},t.prototype.decodeIsoIec646=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new ef(e+5,ef.FNC1);if(r>=5&&r<15)return new ef(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new ef(e+7,""+(n+1));if(n>=90&&n<116)return new ef(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),s;switch(a){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new Kr}return new ef(e+8,s)},t.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},t.prototype.decodeAlphanumeric=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new ef(e+5,ef.FNC1);if(r>=5&&r<15)return new ef(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new ef(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new Ww("Decoding invalid alphanumeric value: "+n)}return new ef(e+6,a)},t.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<5&&r+e<this.information.getSize();++r)if(r===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+r))return!1;return!0},t.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var r=e;r<e+3;++r)if(this.information.get(r))return!1;return!0},t.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<4&&r+e<this.information.getSize();++r)if(this.information.get(e+r))return!1;return!0},t}(),Pse=function(){function t(e){this.information=e,this.generalDecoder=new bE(e)}return t.prototype.getInformation=function(){return this.information},t.prototype.getGeneralDecoder=function(){return this.generalDecoder},t}(),VUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),uf=function(t){VUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedGtin=function(r,n){r.append("(01)");var a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(r,n,a){for(var s=0;s<4;++s){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*s,10);o/100===0&&r.append("0"),o/10===0&&r.append("0"),r.append(o)}e.appendCheckDigit(r,a)},e.appendCheckDigit=function(r,n){for(var a=0,s=0;s<13;s++){var o=r.charAt(s+n).charCodeAt(0)-48;a+=s&1?o:3*o}a=10-a%10,a===10&&(a=0),r.append(a)},e.GTIN_SIZE=40,e}(Pse),HUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$Ue=function(t){HUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ta;r.append("(01)");var n=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(uf),GUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),KUe=function(t){GUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ta;return this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(Pse),qUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wE=function(t){qUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedWeight=function(r,n,a){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(r,s);for(var o=this.checkWeight(s),l=1e5,c=0;c<5;++c)o/l===0&&r.append("0"),l/=10;r.append(o)},e}(uf),zUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Tse=function(t){zUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+wE.GTIN_SIZE+e.WEIGHT_SIZE)throw new lr;var r=new ta;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+wE.GTIN_SIZE,e.WEIGHT_SIZE),r.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(wE),WUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),XUe=function(t){WUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){r.append("(3103)")},e.prototype.checkWeight=function(r){return r},e}(Tse),YUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),JUe=function(t){YUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){n<1e4?r.append("(3202)"):r.append("(3203)")},e.prototype.checkWeight=function(r){return r<1e4?r:r-1e4},e}(Tse),ZUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),e7e=function(t){ZUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+uf.GTIN_SIZE)throw new lr;var r=new ta;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+uf.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(392"),r.append(n),r.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+uf.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(uf),t7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),r7e=function(t){t7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+uf.GTIN_SIZE)throw new lr;var r=new ta;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+uf.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(393"),r.append(n),r.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+uf.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&r.append("0"),a/10===0&&r.append("0"),r.append(a);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+uf.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return r.append(s.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(uf),n7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),y0=function(t){n7e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.dateCode=a,s.firstAIdigits=n,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new lr;var r=new ta;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(r,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),r.toString()},e.prototype.encodeCompressedDate=function(r,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){r.append("("),r.append(this.dateCode),r.append(")");var s=a%32;a/=32;var o=a%12+1;a/=12;var l=a;l/10===0&&r.append("0"),r.append(l),o/10===0&&r.append("0"),r.append(o),s/10===0&&r.append("0"),r.append(s)}},e.prototype.addWeightCode=function(r,n){r.append("("),r.append(this.firstAIdigits),r.append(n/1e5),r.append(")")},e.prototype.checkWeight=function(r){return r%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(wE);function a7e(t){try{if(t.get(1))return new $Ue(t);if(!t.get(2))return new KUe(t);var e=bE.extractNumericValueFromBitArray(t,1,4);switch(e){case 4:return new XUe(t);case 5:return new JUe(t)}var r=bE.extractNumericValueFromBitArray(t,1,5);switch(r){case 12:return new e7e(t);case 13:return new r7e(t)}var n=bE.extractNumericValueFromBitArray(t,1,7);switch(n){case 56:return new y0(t,"310","11");case 57:return new y0(t,"320","11");case 58:return new y0(t,"310","13");case 59:return new y0(t,"320","13");case 60:return new y0(t,"310","15");case 61:return new y0(t,"320","15");case 62:return new y0(t,"310","17");case 63:return new y0(t,"320","17")}}catch(a){throw console.log(a),new Ww("unknown decoder: "+t)}}var H$=function(){function t(e,r,n,a){this.leftchar=e,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}return t.prototype.mayBeLast=function(){return this.maybeLast},t.prototype.getLeftChar=function(){return this.leftchar},t.prototype.getRightChar=function(){return this.rightchar},t.prototype.getFinderPattern=function(){return this.finderpattern},t.prototype.mustBeLast=function(){return this.rightchar==null},t.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},t.equals=function(e,r){return e instanceof t?t.equalsOrNull(e.leftchar,r.leftchar)&&t.equalsOrNull(e.rightchar,r.rightchar)&&t.equalsOrNull(e.finderpattern,r.finderpattern):!1},t.equalsOrNull=function(e,r){return e===null?r===null:t.equals(e,r)},t.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},t}(),s7e=function(){function t(e,r,n){this.pairs=e,this.rowNumber=r,this.wasReversed=n}return t.prototype.getPairs=function(){return this.pairs},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.isReversed=function(){return this.wasReversed},t.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},t.prototype.toString=function(){return"{ "+this.pairs+" }"},t.prototype.equals=function(e,r){return e instanceof t?this.checkEqualitity(e,r)&&e.wasReversed===r.wasReversed:!1},t.prototype.checkEqualitity=function(e,r){if(!(!e||!r)){var n;return e.forEach(function(a,s){r.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},t}(),i7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),b0=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o7e=function(t){i7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.pairs=new Array(e.MAX_PAIRS),r.rows=new Array,r.startEnd=[2],r}return e.prototype.decodeRow=function(r,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(r,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(r,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(r,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,r))}catch(l){if(l instanceof lr){if(!this.pairs.length)throw new lr;a=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(r,!1),s){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new lr},e.prototype.checkRowsBoolean=function(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return r&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(r,n){for(var a,s,o=n;o<this.rows.length;o++){var l=this.rows[o];this.pairs.length=0;try{for(var c=(a=void 0,b0(r)),u=c.next();!u.done;u=c.next()){var d=u.value;this.pairs.push(d.getPairs())}}catch(A){a={error:A}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}if(this.pairs.push(l.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(r);f.push(l);try{return this.checkRows(f,o+1)}catch(A){console.log(A)}}}throw new lr},e.isValidSequence=function(r){var n,a;try{for(var s=b0(e.FINDER_PATTERN_SEQUENCES),o=s.next();!o.done;o=s.next()){var l=o.value;if(!(r.length>l.length)){for(var c=!0,u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!==l[u]){c=!1;break}if(c)return!0}}}catch(d){n={error:d}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(r,n){for(var a=0,s=!1,o=!1;a<this.rows.length;){var l=this.rows[a];if(l.getRowNumber()>r){o=l.isEquivalent(this.pairs);break}s=l.isEquivalent(this.pairs),a++}o||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new s7e(this.pairs,r,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(r,n){var a,s,o,l,c,u;try{for(var d=b0(n),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.getPairs().length!==r.length){var h=!0;try{for(var m=(o=void 0,b0(A.getPairs())),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,b0(r)),b=y.next();!b.done;b=y.next()){var w=b.value;if(H$.equals(x,w)){v=!0;break}}}catch(I){c={error:I}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}v||(h=!1)}}catch(I){o={error:I}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}}}}catch(I){a={error:I}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}},e.isPartialRow=function(r,n){var a,s,o,l,c,u;try{for(var d=b0(n),f=d.next();!f.done;f=d.next()){var A=f.value,h=!0;try{for(var m=(o=void 0,b0(r)),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,b0(A.getPairs())),b=y.next();!b.done;b=y.next()){var w=b.value;if(x.equals(w)){v=!0;break}}}catch(I){c={error:I}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}if(!v){h=!1;break}}}catch(I){o={error:I}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}if(h)return!0}}catch(I){a={error:I}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(r){var n=RUe.buildBitArray(r),a=a7e(n),s=a.parseInformation(),o=r[0].getFinderPattern().getResultPoints(),l=r[r.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],l[0],l[1]];return new hc(s,null,null,c,In.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var r=this.pairs.get(0),n=r.getLeftChar(),a=r.getRightChar();if(a===null)return!1;for(var s=a.getChecksumPortion(),o=2,l=1;l<this.pairs.size();++l){var c=this.pairs.get(l);s+=c.getLeftChar().getChecksumPortion(),o++;var u=c.getRightChar();u!=null&&(s+=u.getChecksumPortion(),o++)}s%=211;var d=211*(o-4)+s;return d===n.getValue()},e.getNextSecondBar=function(r,n){var a;return r.get(n)?(a=r.getNextUnset(n),a=r.getNextSet(a)):(a=r.getNextSet(n),a=r.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(r,n,a){var s=n.length%2===0;this.startFromEven&&(s=!s);var o,l=!0,c=-1;do this.findNextPair(r,n,c),o=this.parseFoundFinderPattern(r,a,s),o===null?c=e.getNextSecondBar(r,this.startEnd[0]):l=!1;while(l);var u=this.decodeDataCharacter(r,o,s,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new lr;var d;try{d=this.decodeDataCharacter(r,o,s,!1)}catch(f){d=null,console.log(f)}return new H$(u,d,o,!0)},e.prototype.isEmptyPair=function(r){return r.length===0},e.prototype.findNextPair=function(r,n,a){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var o=r.getSize(),l;if(a>=0)l=a;else if(this.isEmptyPair(n))l=0;else{var c=n[n.length-1];l=c.getFinderPattern().getStartEnd()[1]}var u=n.length%2!==0;this.startFromEven&&(u=!u);for(var d=!1;l<o&&(d=!r.get(l),!!d);)l++;for(var f=0,A=l,h=l;h<o;h++)if(r.get(h)!==d)s[f]++;else{if(f===3){if(u&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=A,this.startEnd[1]=h;return}u&&e.reverseCounters(s),A+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,f--}else f++;s[f]=1,d=!d}throw new lr},e.reverseCounters=function(r){for(var n=r.length,a=0;a<n/2;++a){var s=r[a];r[a]=r[n-a-1],r[n-a-1]=s}},e.prototype.parseFoundFinderPattern=function(r,n,a){var s,o,l;if(a){for(var c=this.startEnd[0]-1;c>=0&&!r.get(c);)c--;c++,s=this.startEnd[0]-c,o=c,l=this.startEnd[1]}else o=this.startEnd[0],l=r.getNextUnset(this.startEnd[1]+1),s=l-this.startEnd[1];var u=this.getDecodeFinderCounters();Cs.arraycopy(u,0,u,1,u.length-1),u[0]=s;var d;try{d=this.parseFinderValue(u,e.FINDER_PATTERNS)}catch{return null}return new Ise(d,[o,l],o,l,n)},e.prototype.decodeDataCharacter=function(r,n,a,s){for(var o=this.getDataCharacterCounters(),l=0;l<o.length;l++)o[l]=0;if(s)e.recordPatternInReverse(r,n.getStartEnd()[0],o);else{e.recordPattern(r,n.getStartEnd()[1],o);for(var c=0,u=o.length-1;c<u;c++,u--){var d=o[c];o[c]=o[u],o[u]=d}}var f=17,A=Ta.sum(new Int32Array(o))/f,h=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(A-h)/h>.3)throw new lr;for(var m=this.getOddCounts(),p=this.getEvenCounts(),x=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var y=1*o[c]/A,b=y+.5;if(b<1){if(y<.3)throw new lr;b=1}else if(b>8){if(y>8.7)throw new lr;b=8}var w=c/2;c&1?(p[w]=b,v[w]=y-b):(m[w]=b,x[w]=y-b)}this.adjustOddEvenCounts(f);for(var I=4*n.getValue()+(a?0:2)+(s?0:1)-1,j=0,C=0,c=m.length-1;c>=0;c--){if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[I][2*c];C+=m[c]*S}j+=m[c]}for(var E=0,c=p.length-1;c>=0;c--)if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[I][2*c+1];E+=p[c]*S}var B=C+E;if(j&1||j>13||j<4)throw new lr;var k=(13-j)/2,T=e.SYMBOL_WIDEST[k],P=9-T,G=Jx.getRSSvalue(m,T,!0),ce=Jx.getRSSvalue(p,P,!1),ue=e.EVEN_TOTAL_SUBSET[k],le=e.GSUM[k],Ae=G*ue+ce+le;return new nj(Ae,B)},e.isNotA1left=function(r,n,a){return!(r.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(r){var n=Ta.sum(new Int32Array(this.getOddCounts())),a=Ta.sum(new Int32Array(this.getEvenCounts())),s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);var l=!1,c=!1;a>13?c=!0:a<4&&(l=!0);var u=n+a-r,d=(n&1)===1,f=(a&1)===0;if(u===1)if(d){if(f)throw new lr;o=!0}else{if(!f)throw new lr;c=!0}else if(u===-1)if(d){if(f)throw new lr;s=!0}else{if(!f)throw new lr;l=!0}else if(u===0){if(d){if(!f)throw new lr;n<a?(s=!0,c=!0):(o=!0,l=!0)}else if(f)throw new lr}else throw new lr;if(s){if(o)throw new lr;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new lr;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(mp),l7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),c7e=function(t){l7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.count=0,s.finderPattern=a,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(nj),u7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$$=function(t){u7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.possibleLeftPairs=[],r.possibleRightPairs=[],r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.decodePair(n,!1,r,a);e.addOrTally(this.possibleLeftPairs,u),n.reverse();var d=this.decodePair(n,!0,r,a);e.addOrTally(this.possibleRightPairs,d),n.reverse();try{for(var f=z5(this.possibleLeftPairs),A=f.next();!A.done;A=f.next()){var h=A.value;if(h.getCount()>1)try{for(var m=(l=void 0,z5(this.possibleRightPairs)),p=m.next();!p.done;p=m.next()){var x=p.value;if(x.getCount()>1&&e.checkChecksum(h,x))return e.constructResult(h,x)}}catch(v){l={error:v}}finally{try{p&&!p.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}}}catch(v){s={error:v}}finally{try{A&&!A.done&&(o=f.return)&&o.call(f)}finally{if(s)throw s.error}}throw new lr},e.addOrTally=function(r,n){var a,s;if(n!=null){var o=!1;try{for(var l=z5(r),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.getValue()===n.getValue()){u.incrementCount(),o=!0;break}}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}o||r.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(r,n){for(var a=4537077*r.getValue()+n.getValue(),s=new String(a).toString(),o=new ta,l=13-s.length;l>0;l--)o.append("0");o.append(s);for(var c=0,l=0;l<13;l++){var u=o.charAt(l).charCodeAt(0)-48;c+=l&1?u:3*u}c=10-c%10,c===10&&(c=0),o.append(c.toString());var d=r.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new hc(o.toString(),null,0,[d[0],d[1],f[0],f[1]],In.RSS_14,new Date().getTime())},e.checkChecksum=function(r,n){var a=(r.getChecksumPortion()+16*n.getChecksumPortion())%79,s=9*r.getFinderPattern().getValue()+n.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,a===s},e.prototype.decodePair=function(r,n,a,s){try{var o=this.findFinderPattern(r,n),l=this.parseFoundFinderPattern(r,a,n,o),c=s==null?null:s.get(_s.NEED_RESULT_POINT_CALLBACK);if(c!=null){var u=(o[0]+o[1])/2;n&&(u=r.getSize()-1-u),c.foundPossibleResultPoint(new hn(u,a))}var d=this.decodeDataCharacter(r,l,!0),f=this.decodeDataCharacter(r,l,!1);return new c7e(1597*d.getValue()+f.getValue(),d.getChecksumPortion()+4*f.getChecksumPortion(),l)}catch{return null}},e.prototype.decodeDataCharacter=function(r,n,a){for(var s=this.getDataCharacterCounters(),o=0;o<s.length;o++)s[o]=0;if(a)Fo.recordPatternInReverse(r,n.getStartEnd()[0],s);else{Fo.recordPattern(r,n.getStartEnd()[1]+1,s);for(var l=0,c=s.length-1;l<c;l++,c--){var u=s[l];s[l]=s[c],s[c]=u}}for(var d=a?16:15,f=Ta.sum(new Int32Array(s))/d,A=this.getOddCounts(),h=this.getEvenCounts(),m=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors(),l=0;l<s.length;l++){var x=s[l]/f,v=Math.floor(x+.5);v<1?v=1:v>8&&(v=8);var y=Math.floor(l/2);l&1?(h[y]=v,p[y]=x-v):(A[y]=v,m[y]=x-v)}this.adjustOddEvenCounts(a,d);for(var b=0,w=0,l=A.length-1;l>=0;l--)w*=9,w+=A[l],b+=A[l];for(var I=0,j=0,l=h.length-1;l>=0;l--)I*=9,I+=h[l],j+=h[l];var C=w+3*I;if(a){if(b&1||b>12||b<4)throw new lr;var S=(12-b)/2,E=e.OUTSIDE_ODD_WIDEST[S],B=9-E,k=Jx.getRSSvalue(A,E,!1),T=Jx.getRSSvalue(h,B,!0),P=e.OUTSIDE_EVEN_TOTAL_SUBSET[S],G=e.OUTSIDE_GSUM[S];return new nj(k*P+T+G,C)}else{if(j&1||j>10||j<4)throw new lr;var S=(10-j)/2,E=e.INSIDE_ODD_WIDEST[S],B=9-E,k=Jx.getRSSvalue(A,E,!0),T=Jx.getRSSvalue(h,B,!1),ce=e.INSIDE_ODD_TOTAL_SUBSET[S],G=e.INSIDE_GSUM[S];return new nj(T*ce+k+G,C)}},e.prototype.findFinderPattern=function(r,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var s=r.getSize(),o=!1,l=0;l<s&&(o=!r.get(l),n!==o);)l++;for(var c=0,u=l,d=l;d<s;d++)if(r.get(d)!==o)a[c]++;else{if(c===3){if(mp.isFinderPattern(a))return[u,d];u+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,o=!o}throw new lr},e.prototype.parseFoundFinderPattern=function(r,n,a,s){for(var o=r.get(s[0]),l=s[0]-1;l>=0&&o!==r.get(l);)l--;l++;var c=s[0]-l,u=this.getDecodeFinderCounters(),d=new Int32Array(u.length);Cs.arraycopy(u,0,d,1,u.length-1),d[0]=c;var f=this.parseFinderValue(d,e.FINDER_PATTERNS),A=l,h=s[1];return a&&(A=r.getSize()-1-A,h=r.getSize()-1-h),new Ise(f,[l,s[1]],A,h,n)},e.prototype.adjustOddEvenCounts=function(r,n){var a=Ta.sum(new Int32Array(this.getOddCounts())),s=Ta.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1,c=!1,u=!1;r?(a>12?l=!0:a<4&&(o=!0),s>12?u=!0:s<4&&(c=!0)):(a>11?l=!0:a<5&&(o=!0),s>10?u=!0:s<4&&(c=!0));var d=a+s-n,f=(a&1)===(r?1:0),A=(s&1)===1;if(d===1)if(f){if(A)throw new lr;l=!0}else{if(!A)throw new lr;u=!0}else if(d===-1)if(f){if(A)throw new lr;o=!0}else{if(!A)throw new lr;c=!0}else if(d===0){if(f){if(!A)throw new lr;a<s?(o=!0,u=!0):(l=!0,c=!0)}else if(A)throw new lr}else throw new lr;if(o){if(l)throw new lr;mp.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&mp.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(u)throw new lr;mp.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&mp.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(mp),d7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zx=function(t){d7e(e,t);function e(r){var n=t.call(this)||this;n.readers=[];var a=r?r.get(_s.POSSIBLE_FORMATS):null,s=r&&r.get(_s.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=r&&r.get(_s.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(In.EAN_13)||a.includes(In.UPC_A)||a.includes(In.EAN_8)||a.includes(In.UPC_E))&&n.readers.push(new q5(r)),a.includes(In.CODE_39)&&n.readers.push(new F$(s,o)),a.includes(In.CODE_93)&&n.readers.push(new O$),a.includes(In.CODE_128)&&n.readers.push(new k$),a.includes(In.ITF)&&n.readers.push(new D$),a.includes(In.CODABAR)&&n.readers.push(new kUe),a.includes(In.RSS_14)&&n.readers.push(new $$),a.includes(In.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new o7e))),n.readers.length===0&&(n.readers.push(new q5(r)),n.readers.push(new F$),n.readers.push(new O$),n.readers.push(new q5(r)),n.readers.push(new k$),n.readers.push(new D$),n.readers.push(new $$)),n}return e.prototype.decodeRow=function(r,n,a){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(r,n,a)}catch{}throw new lr},e.prototype.reset=function(){this.readers.forEach(function(r){return r.reset()})},e}(Fo),f7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){f7e(e,t);function e(r,n){return r===void 0&&(r=500),t.call(this,new Zx(n),r,n)||this}return e})(S1);var G$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Va=function(){function t(e,r,n){this.ecCodewords=e,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}return t.prototype.getECCodewords=function(){return this.ecCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),Da=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),h7e=function(){function t(e,r,n,a,s,o){var l,c;this.versionNumber=e,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=s,this.ecBlocks=o;var u=0,d=o.getECCodewords(),f=o.getECBlocks();try{for(var A=G$(f),h=A.next();!h.done;h=A.next()){var m=h.value;u+=m.getCount()*(m.getDataCodewords()+d)}}catch(p){l={error:p}}finally{try{h&&!h.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}this.totalCodewords=u}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},t.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},t.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},t.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t.getVersionForDimensions=function(e,r){var n,a;if(e&1||r&1)throw new Kr;try{for(var s=G$(t.VERSIONS),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.symbolSizeRows===e&&l.symbolSizeColumns===r)return l}}catch(c){n={error:c}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}throw new Kr},t.prototype.toString=function(){return""+this.versionNumber},t.buildVersions=function(){return[new t(1,10,10,8,8,new Va(5,new Da(1,3))),new t(2,12,12,10,10,new Va(7,new Da(1,5))),new t(3,14,14,12,12,new Va(10,new Da(1,8))),new t(4,16,16,14,14,new Va(12,new Da(1,12))),new t(5,18,18,16,16,new Va(14,new Da(1,18))),new t(6,20,20,18,18,new Va(18,new Da(1,22))),new t(7,22,22,20,20,new Va(20,new Da(1,30))),new t(8,24,24,22,22,new Va(24,new Da(1,36))),new t(9,26,26,24,24,new Va(28,new Da(1,44))),new t(10,32,32,14,14,new Va(36,new Da(1,62))),new t(11,36,36,16,16,new Va(42,new Da(1,86))),new t(12,40,40,18,18,new Va(48,new Da(1,114))),new t(13,44,44,20,20,new Va(56,new Da(1,144))),new t(14,48,48,22,22,new Va(68,new Da(1,174))),new t(15,52,52,24,24,new Va(42,new Da(2,102))),new t(16,64,64,14,14,new Va(56,new Da(2,140))),new t(17,72,72,16,16,new Va(36,new Da(4,92))),new t(18,80,80,18,18,new Va(48,new Da(4,114))),new t(19,88,88,20,20,new Va(56,new Da(4,144))),new t(20,96,96,22,22,new Va(68,new Da(4,174))),new t(21,104,104,24,24,new Va(56,new Da(6,136))),new t(22,120,120,18,18,new Va(68,new Da(6,175))),new t(23,132,132,20,20,new Va(62,new Da(8,163))),new t(24,144,144,22,22,new Va(62,new Da(8,156),new Da(2,155))),new t(25,8,18,6,16,new Va(7,new Da(1,5))),new t(26,8,32,6,14,new Va(11,new Da(1,10))),new t(27,12,26,10,24,new Va(14,new Da(1,16))),new t(28,12,36,10,16,new Va(18,new Da(1,22))),new t(29,16,36,14,16,new Va(24,new Da(1,32))),new t(30,16,48,14,22,new Va(28,new Da(1,49)))]},t.VERSIONS=t.buildVersions(),t}(),A7e=function(){function t(e){var r=e.getHeight();if(r<8||r>144||r&1)throw new Kr;this.version=t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new uh(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return t.prototype.getVersion=function(){return this.version},t.readVersion=function(e){var r=e.getHeight(),n=e.getWidth();return h7e.getVersionForDimensions(r,n)},t.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),r=0,n=4,a=0,s=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),l=!1,c=!1,u=!1,d=!1;do if(n===s&&a===0&&!l)e[r++]=this.readCorner1(s,o)&255,n-=2,a+=2,l=!0;else if(n===s-2&&a===0&&o&3&&!c)e[r++]=this.readCorner2(s,o)&255,n-=2,a+=2,c=!0;else if(n===s+4&&a===2&&!(o&7)&&!u)e[r++]=this.readCorner3(s,o)&255,n-=2,a+=2,u=!0;else if(n===s-2&&a===0&&(o&7)===4&&!d)e[r++]=this.readCorner4(s,o)&255,n-=2,a+=2,d=!0;else{do n<s&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n+=2,a-=2;while(n<s&&a>=0);n+=3,a+=1}while(n<s||a<o);if(r!==this.version.getTotalCodewords())throw new Kr;return e},t.prototype.readModule=function(e,r,n,a){return e<0&&(e+=n,r+=4-(n+4&7)),r<0&&(r+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(r,e),this.mappingBitMatrix.get(r,e)},t.prototype.readUtah=function(e,r,n,a){var s=0;return this.readModule(e-2,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-2,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r,n,a)&&(s|=1),s<<=1,this.readModule(e,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e,r,n,a)&&(s|=1),s},t.prototype.readCorner1=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,1,e,r)&&(n|=1),n<<=1,this.readModule(e-1,2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.readCorner2=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-4,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner3=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-3,e,r)&&(n|=1),n<<=1,this.readModule(1,r-2,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner4=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.extractDataRegion=function(e){var r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==r)throw new Pn("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),o=r/a|0,l=n/s|0,c=o*a,u=l*s,d=new uh(u,c),f=0;f<o;++f)for(var A=f*a,h=0;h<l;++h)for(var m=h*s,p=0;p<a;++p)for(var x=f*(a+2)+1+p,v=A+p,y=0;y<s;++y){var b=h*(s+2)+1+y;if(e.get(b,x)){var w=m+y;d.set(w,v)}}return d},t}(),K$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r){var n,a,s,o,l=r.getECBlocks(),c=0,u=l.getECBlocks();try{for(var d=K$(u),f=d.next();!f.done;f=d.next()){var A=f.value;c+=A.getCount()}}catch(G){n={error:G}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}var h=new Array(c),m=0;try{for(var p=K$(u),x=p.next();!x.done;x=p.next())for(var A=x.value,v=0;v<A.getCount();v++){var y=A.getDataCodewords(),b=l.getECCodewords()+y;h[m++]=new t(y,new Uint8Array(b))}}catch(G){s={error:G}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}for(var w=h[0].codewords.length,I=w-l.getECCodewords(),j=I-1,C=0,v=0;v<j;v++)for(var S=0;S<m;S++)h[S].codewords[v]=e[C++];for(var E=r.getVersionNumber()===24,B=E?8:m,S=0;S<B;S++)h[S].codewords[I-1]=e[C++];for(var k=h[0].codewords.length,v=I;v<k;v++)for(var S=0;S<m;S++){var T=E?(S+8)%m:S,P=E&&T>7?v-1:v;h[T].codewords[P]=e[C++]}if(C!==e.length)throw new Pn;return h},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),Bse=function(){function t(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new Pn(""+e);var r=0,n=this.bitOffset,a=this.byteOffset,s=this.bytes;if(n>0){var o=8-n,l=e<o?e:o,c=o-l,u=255>>8-l<<c;r=(s[a]&u)>>c,e-=l,n+=l,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)r=r<<8|s[a]&255,a++,e-=8;if(e>0){var c=8-e,u=255>>c<<c;r=r<<e|(s[a]&u)>>c,n+=e}}return this.bitOffset=n,this.byteOffset=a,r},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t}(),bo;(function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"})(bo||(bo={}));var p7e=function(){function t(){}return t.decode=function(e){var r=new Bse(e),n=new ta,a=new ta,s=new Array,o=bo.ASCII_ENCODE;do if(o===bo.ASCII_ENCODE)o=this.decodeAsciiSegment(r,n,a);else{switch(o){case bo.C40_ENCODE:this.decodeC40Segment(r,n);break;case bo.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case bo.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case bo.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case bo.BASE256_ENCODE:this.decodeBase256Segment(r,n,s);break;default:throw new Kr}o=bo.ASCII_ENCODE}while(o!==bo.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new yP(e,n.toString(),s.length===0?null:s,null)},t.decodeAsciiSegment=function(e,r,n){var a=!1;do{var s=e.readBits(8);if(s===0)throw new Kr;if(s<=128)return a&&(s+=128),r.append(String.fromCharCode(s-1)),bo.ASCII_ENCODE;if(s===129)return bo.PAD_ENCODE;if(s<=229){var o=s-130;o<10&&r.append("0"),r.append(""+o)}else switch(s){case 230:return bo.C40_ENCODE;case 231:return bo.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return bo.ANSIX12_ENCODE;case 239:return bo.TEXT_ENCODE;case 240:return bo.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new Kr;break}}while(e.available()>0);return bo.ASCII_ENCODE},t.decodeC40Segment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var u=this.C40_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new Kr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var u=this.C40_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Kr}s=0;break;case 3:n?(r.append(String.fromCharCode(c+224)),n=!1):r.append(String.fromCharCode(c+96)),s=0;break;default:throw new Kr}}}while(e.available()>0)},t.decodeTextSegment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var u=this.TEXT_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new Kr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var u=this.TEXT_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Kr}s=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var u=this.TEXT_SHIFT3_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u),s=0}else throw new Kr;break;default:throw new Kr}}}while(e.available()>0)},t.decodeAnsiX12Segment=function(e,r){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var s=0;s<3;s++){var o=n[s];switch(o){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(o<14)r.append(String.fromCharCode(o+44));else if(o<40)r.append(String.fromCharCode(o+51));else throw new Kr;break}}}while(e.available()>0)},t.parseTwoBytes=function(e,r,n){var a=(e<<8)+r-1,s=Math.floor(a/1600);n[0]=s,a-=s*1600,s=Math.floor(a/40),n[1]=s,n[2]=a-s*40},t.decodeEdifactSegment=function(e,r){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}a&32||(a|=64),r.append(String.fromCharCode(a))}}while(e.available()>0)},t.decodeBase256Segment=function(e,r,n){var a=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),a++),o;if(s===0?o=e.available()/8|0:s<250?o=s:o=250*(s-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new Kr;for(var l=new Uint8Array(o),c=0;c<o;c++){if(e.available()<8)throw new Kr;l[c]=this.unrandomize255State(e.readBits(8),a++)}n.push(l);try{r.append(Bd.decode(l,Na.ISO88591))}catch(u){throw new Ww("Platform does not support required encoding: "+u.message)}},t.unrandomize255State=function(e,r){var n=149*r%255+1,a=e-n;return a>=0?a:a+256},t.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],t.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.TEXT_SHIFT2_SET_CHARS=t.C40_SHIFT2_SET_CHARS,t.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],t}(),g7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},x7e=function(){function t(){this.rsDecoder=new bP(tu.DATA_MATRIX_FIELD_256)}return t.prototype.decode=function(e){var r,n,a=new A7e(e),s=a.getVersion(),o=a.readCodewords(),l=m7e.getDataBlocks(o,s),c=0;try{for(var u=g7e(l),d=u.next();!d.done;d=u.next()){var f=d.value;c+=f.getNumDataCodewords()}}catch(b){r={error:b}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}for(var A=new Uint8Array(c),h=l.length,m=0;m<h;m++){var p=l[m],x=p.getCodewords(),v=p.getNumDataCodewords();this.correctErrors(x,v);for(var y=0;y<v;y++)A[y*h+m]=x[y]}return p7e.decode(A)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new co}for(var a=0;a<r;a++)e[a]=n[a]},t}(),v7e=function(){function t(e){this.image=e,this.rectangleDetector=new AF(this.image)}return t.prototype.detect=function(){var e=this.rectangleDetector.detect(),r=this.detectSolid1(e);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new lr;r=this.shiftToModuleCenter(r);var n=r[0],a=r[1],s=r[2],o=r[3],l=this.transitionsBetween(n,o)+1,c=this.transitionsBetween(s,o)+1;(l&1)===1&&(l+=1),(c&1)===1&&(c+=1),4*l<7*c&&4*c<7*l&&(l=c=Math.max(l,c));var u=t.sampleGrid(this.image,n,a,s,o,l,c);return new QR(u,[n,a,s,o])},t.shiftPoint=function(e,r,n){var a=(r.getX()-e.getX())/(n+1),s=(r.getY()-e.getY())/(n+1);return new hn(e.getX()+a,e.getY()+s)},t.moveAway=function(e,r,n){var a=e.getX(),s=e.getY();return a<r?a-=1:a+=1,s<n?s-=1:s+=1,new hn(a,s)},t.prototype.detectSolid1=function(e){var r=e[0],n=e[1],a=e[3],s=e[2],o=this.transitionsBetween(r,n),l=this.transitionsBetween(n,a),c=this.transitionsBetween(a,s),u=this.transitionsBetween(s,r),d=o,f=[s,r,n,a];return d>l&&(d=l,f[0]=r,f[1]=n,f[2]=a,f[3]=s),d>c&&(d=c,f[0]=n,f[1]=a,f[2]=s,f[3]=r),d>u&&(f[0]=a,f[1]=s,f[2]=r,f[3]=n),f},t.prototype.detectSolid2=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=t.shiftPoint(n,a,(o+1)*4),c=t.shiftPoint(a,n,(o+1)*4),u=this.transitionsBetween(l,r),d=this.transitionsBetween(c,s);return u<d?(e[0]=r,e[1]=n,e[2]=a,e[3]=s):(e[0]=n,e[1]=a,e[2]=s,e[3]=r),e},t.prototype.correctTopRight=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=this.transitionsBetween(n,s),c=t.shiftPoint(r,n,(l+1)*4),u=t.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(c,s),l=this.transitionsBetween(u,s);var d=new hn(s.getX()+(a.getX()-n.getX())/(o+1),s.getY()+(a.getY()-n.getY())/(o+1)),f=new hn(s.getX()+(r.getX()-n.getX())/(l+1),s.getY()+(r.getY()-n.getY())/(l+1));if(!this.isValid(d))return this.isValid(f)?f:null;if(!this.isValid(f))return d;var A=this.transitionsBetween(c,d)+this.transitionsBetween(u,d),h=this.transitionsBetween(c,f)+this.transitionsBetween(u,f);return A>h?d:f},t.prototype.shiftToModuleCenter=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s)+1,l=this.transitionsBetween(a,s)+1,c=t.shiftPoint(r,n,l*4),u=t.shiftPoint(a,n,o*4);o=this.transitionsBetween(c,s)+1,l=this.transitionsBetween(u,s)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);var d=(r.getX()+n.getX()+a.getX()+s.getX())/4,f=(r.getY()+n.getY()+a.getY()+s.getY())/4;r=t.moveAway(r,d,f),n=t.moveAway(n,d,f),a=t.moveAway(a,d,f),s=t.moveAway(s,d,f);var A,h;return c=t.shiftPoint(r,n,l*4),c=t.shiftPoint(c,s,o*4),A=t.shiftPoint(n,r,l*4),A=t.shiftPoint(A,a,o*4),u=t.shiftPoint(a,s,l*4),u=t.shiftPoint(u,n,o*4),h=t.shiftPoint(s,a,l*4),h=t.shiftPoint(h,r,o*4),[c,A,u,h]},t.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},t.sampleGrid=function(e,r,n,a,s,o,l){var c=VR.getInstance();return c.sampleGrid(e,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,r.getX(),r.getY(),s.getX(),s.getY(),a.getX(),a.getY(),n.getX(),n.getY())},t.prototype.transitionsBetween=function(e,r){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),s=Math.trunc(r.getX()),o=Math.trunc(r.getY()),l=Math.abs(o-a)>Math.abs(s-n);if(l){var c=n;n=a,a=c,c=s,s=o,o=c}for(var u=Math.abs(s-n),d=Math.abs(o-a),f=-u/2,A=a<o?1:-1,h=n<s?1:-1,m=0,p=this.image.get(l?a:n,l?n:a),x=n,v=a;x!==s;x+=h){var y=this.image.get(l?v:x,l?x:v);if(y!==p&&(m++,p=y),f+=d,f>0){if(v===o)break;v+=A,f-=u}}return m},t}(),aj=function(){function t(){this.decoder=new x7e}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n,a;if(r!=null&&r.has(_s.PURE_BARCODE)){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(s),a=t.NO_POINTS}else{var o=new v7e(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var l=n.getRawBytes(),c=new hc(n.getText(),l,8*l.length,a,In.DATA_MATRIX,Cs.currentTimeMillis()),u=n.getByteSegments();u!=null&&c.putMetadata(Tl.BYTE_SEGMENTS,u);var d=n.getECLevel();return d!=null&&c.putMetadata(Tl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r==null||n==null)throw new lr;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0],u=(c-l+1)/a,d=(o-s+1)/a;if(u<=0||d<=0)throw new lr;var f=a/2;s+=f,l+=f;for(var A=new uh(u,d),h=0;h<d;h++)for(var m=s+h*a,p=0;p<u;p++)e.get(l+p*a,m)&&A.set(p,h);return A},t.moduleSize=function(e,r){for(var n=r.getWidth(),a=e[0],s=e[1];a<n&&r.get(a,s);)a++;if(a===n)throw new lr;var o=a-e[0];if(o===0)throw new lr;return o},t.NO_POINTS=[],t}(),y7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){y7e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new aj,r)||this}return e})(S1);var ev;(function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"})(ev||(ev={}));var b7e=function(){function t(e,r,n){this.value=e,this.stringValue=r,this.bits=n,t.FOR_BITS.set(n,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new Vi(e+"not available")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new Pn;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t(ev.L,"L",1),t.M=new t(ev.M,"M",0),t.Q=new t(ev.Q,"Q",3),t.H=new t(ev.H,"H",2),t}(),w7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},kse=function(){function t(e){this.errorCorrectionLevel=b7e.forBits(e>>3&3),this.dataMask=e&7}return t.numBitsDiffering=function(e,r){return sa.bitCount(e^r)},t.decodeFormatInformation=function(e,r){var n=t.doDecodeFormatInformation(e,r);return n!==null?n:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,r^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,r){var n,a,s=Number.MAX_SAFE_INTEGER,o=0;try{for(var l=w7e(t.FORMAT_INFO_DECODE_LOOKUP),c=l.next();!c.done;c=l.next()){var u=c.value,d=u[0];if(d===e||d===r)return new t(u[1]);var f=t.numBitsDiffering(e,d);f<s&&(o=u[1],s=f),e!==r&&(f=t.numBitsDiffering(r,d),f<s&&(o=u[1],s=f))}}catch(A){n={error:A}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s<=3?new t(o):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t}(),N7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Wt=function(){function t(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=r}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var e,r,n=0,a=this.ecBlocks;try{for(var s=N7e(a),o=s.next();!o.done;o=s.next()){var l=o.value;n+=l.getCount()}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),dt=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),C7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Wp=function(){function t(e,r){for(var n,a,s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=r,this.ecBlocks=s;var l=0,c=s[0].getECCodewordsPerBlock(),u=s[0].getECBlocks();try{for(var d=C7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;l+=A.getCount()*(A.getDataCodewords()+c)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this.totalCodewords=l}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},t.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new Kr;try{return this.getVersionForNumber((e-17)/4)}catch{throw new Kr}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new Pn;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var r=Number.MAX_SAFE_INTEGER,n=0,a=0;a<t.VERSION_DECODE_INFO.length;a++){var s=t.VERSION_DECODE_INFO[a];if(s===e)return t.getVersionForNumber(a+7);var o=kse.numBitsDiffering(e,s);o<r&&(n=a+7,r=o)}return r<=3?t.getVersionForNumber(n):null},t.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),r=new uh(e);r.setRegion(0,0,9,9),r.setRegion(e-8,0,8,9),r.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var s=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||r.setRegion(this.alignmentPatternCenters[o]-2,s,5,5);return r.setRegion(6,9,1,e-17),r.setRegion(9,6,e-17,1),this.versionNumber>6&&(r.setRegion(e-11,0,3,6),r.setRegion(0,e-11,6,3)),r},t.prototype.toString=function(){return""+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new Wt(7,new dt(1,19)),new Wt(10,new dt(1,16)),new Wt(13,new dt(1,13)),new Wt(17,new dt(1,9))),new t(2,Int32Array.from([6,18]),new Wt(10,new dt(1,34)),new Wt(16,new dt(1,28)),new Wt(22,new dt(1,22)),new Wt(28,new dt(1,16))),new t(3,Int32Array.from([6,22]),new Wt(15,new dt(1,55)),new Wt(26,new dt(1,44)),new Wt(18,new dt(2,17)),new Wt(22,new dt(2,13))),new t(4,Int32Array.from([6,26]),new Wt(20,new dt(1,80)),new Wt(18,new dt(2,32)),new Wt(26,new dt(2,24)),new Wt(16,new dt(4,9))),new t(5,Int32Array.from([6,30]),new Wt(26,new dt(1,108)),new Wt(24,new dt(2,43)),new Wt(18,new dt(2,15),new dt(2,16)),new Wt(22,new dt(2,11),new dt(2,12))),new t(6,Int32Array.from([6,34]),new Wt(18,new dt(2,68)),new Wt(16,new dt(4,27)),new Wt(24,new dt(4,19)),new Wt(28,new dt(4,15))),new t(7,Int32Array.from([6,22,38]),new Wt(20,new dt(2,78)),new Wt(18,new dt(4,31)),new Wt(18,new dt(2,14),new dt(4,15)),new Wt(26,new dt(4,13),new dt(1,14))),new t(8,Int32Array.from([6,24,42]),new Wt(24,new dt(2,97)),new Wt(22,new dt(2,38),new dt(2,39)),new Wt(22,new dt(4,18),new dt(2,19)),new Wt(26,new dt(4,14),new dt(2,15))),new t(9,Int32Array.from([6,26,46]),new Wt(30,new dt(2,116)),new Wt(22,new dt(3,36),new dt(2,37)),new Wt(20,new dt(4,16),new dt(4,17)),new Wt(24,new dt(4,12),new dt(4,13))),new t(10,Int32Array.from([6,28,50]),new Wt(18,new dt(2,68),new dt(2,69)),new Wt(26,new dt(4,43),new dt(1,44)),new Wt(24,new dt(6,19),new dt(2,20)),new Wt(28,new dt(6,15),new dt(2,16))),new t(11,Int32Array.from([6,30,54]),new Wt(20,new dt(4,81)),new Wt(30,new dt(1,50),new dt(4,51)),new Wt(28,new dt(4,22),new dt(4,23)),new Wt(24,new dt(3,12),new dt(8,13))),new t(12,Int32Array.from([6,32,58]),new Wt(24,new dt(2,92),new dt(2,93)),new Wt(22,new dt(6,36),new dt(2,37)),new Wt(26,new dt(4,20),new dt(6,21)),new Wt(28,new dt(7,14),new dt(4,15))),new t(13,Int32Array.from([6,34,62]),new Wt(26,new dt(4,107)),new Wt(22,new dt(8,37),new dt(1,38)),new Wt(24,new dt(8,20),new dt(4,21)),new Wt(22,new dt(12,11),new dt(4,12))),new t(14,Int32Array.from([6,26,46,66]),new Wt(30,new dt(3,115),new dt(1,116)),new Wt(24,new dt(4,40),new dt(5,41)),new Wt(20,new dt(11,16),new dt(5,17)),new Wt(24,new dt(11,12),new dt(5,13))),new t(15,Int32Array.from([6,26,48,70]),new Wt(22,new dt(5,87),new dt(1,88)),new Wt(24,new dt(5,41),new dt(5,42)),new Wt(30,new dt(5,24),new dt(7,25)),new Wt(24,new dt(11,12),new dt(7,13))),new t(16,Int32Array.from([6,26,50,74]),new Wt(24,new dt(5,98),new dt(1,99)),new Wt(28,new dt(7,45),new dt(3,46)),new Wt(24,new dt(15,19),new dt(2,20)),new Wt(30,new dt(3,15),new dt(13,16))),new t(17,Int32Array.from([6,30,54,78]),new Wt(28,new dt(1,107),new dt(5,108)),new Wt(28,new dt(10,46),new dt(1,47)),new Wt(28,new dt(1,22),new dt(15,23)),new Wt(28,new dt(2,14),new dt(17,15))),new t(18,Int32Array.from([6,30,56,82]),new Wt(30,new dt(5,120),new dt(1,121)),new Wt(26,new dt(9,43),new dt(4,44)),new Wt(28,new dt(17,22),new dt(1,23)),new Wt(28,new dt(2,14),new dt(19,15))),new t(19,Int32Array.from([6,30,58,86]),new Wt(28,new dt(3,113),new dt(4,114)),new Wt(26,new dt(3,44),new dt(11,45)),new Wt(26,new dt(17,21),new dt(4,22)),new Wt(26,new dt(9,13),new dt(16,14))),new t(20,Int32Array.from([6,34,62,90]),new Wt(28,new dt(3,107),new dt(5,108)),new Wt(26,new dt(3,41),new dt(13,42)),new Wt(30,new dt(15,24),new dt(5,25)),new Wt(28,new dt(15,15),new dt(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new Wt(28,new dt(4,116),new dt(4,117)),new Wt(26,new dt(17,42)),new Wt(28,new dt(17,22),new dt(6,23)),new Wt(30,new dt(19,16),new dt(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new Wt(28,new dt(2,111),new dt(7,112)),new Wt(28,new dt(17,46)),new Wt(30,new dt(7,24),new dt(16,25)),new Wt(24,new dt(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new Wt(30,new dt(4,121),new dt(5,122)),new Wt(28,new dt(4,47),new dt(14,48)),new Wt(30,new dt(11,24),new dt(14,25)),new Wt(30,new dt(16,15),new dt(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new Wt(30,new dt(6,117),new dt(4,118)),new Wt(28,new dt(6,45),new dt(14,46)),new Wt(30,new dt(11,24),new dt(16,25)),new Wt(30,new dt(30,16),new dt(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new Wt(26,new dt(8,106),new dt(4,107)),new Wt(28,new dt(8,47),new dt(13,48)),new Wt(30,new dt(7,24),new dt(22,25)),new Wt(30,new dt(22,15),new dt(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new Wt(28,new dt(10,114),new dt(2,115)),new Wt(28,new dt(19,46),new dt(4,47)),new Wt(28,new dt(28,22),new dt(6,23)),new Wt(30,new dt(33,16),new dt(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new Wt(30,new dt(8,122),new dt(4,123)),new Wt(28,new dt(22,45),new dt(3,46)),new Wt(30,new dt(8,23),new dt(26,24)),new Wt(30,new dt(12,15),new dt(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new Wt(30,new dt(3,117),new dt(10,118)),new Wt(28,new dt(3,45),new dt(23,46)),new Wt(30,new dt(4,24),new dt(31,25)),new Wt(30,new dt(11,15),new dt(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new Wt(30,new dt(7,116),new dt(7,117)),new Wt(28,new dt(21,45),new dt(7,46)),new Wt(30,new dt(1,23),new dt(37,24)),new Wt(30,new dt(19,15),new dt(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new Wt(30,new dt(5,115),new dt(10,116)),new Wt(28,new dt(19,47),new dt(10,48)),new Wt(30,new dt(15,24),new dt(25,25)),new Wt(30,new dt(23,15),new dt(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new Wt(30,new dt(13,115),new dt(3,116)),new Wt(28,new dt(2,46),new dt(29,47)),new Wt(30,new dt(42,24),new dt(1,25)),new Wt(30,new dt(23,15),new dt(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new Wt(30,new dt(17,115)),new Wt(28,new dt(10,46),new dt(23,47)),new Wt(30,new dt(10,24),new dt(35,25)),new Wt(30,new dt(19,15),new dt(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new Wt(30,new dt(17,115),new dt(1,116)),new Wt(28,new dt(14,46),new dt(21,47)),new Wt(30,new dt(29,24),new dt(19,25)),new Wt(30,new dt(11,15),new dt(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new Wt(30,new dt(13,115),new dt(6,116)),new Wt(28,new dt(14,46),new dt(23,47)),new Wt(30,new dt(44,24),new dt(7,25)),new Wt(30,new dt(59,16),new dt(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new Wt(30,new dt(12,121),new dt(7,122)),new Wt(28,new dt(12,47),new dt(26,48)),new Wt(30,new dt(39,24),new dt(14,25)),new Wt(30,new dt(22,15),new dt(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new Wt(30,new dt(6,121),new dt(14,122)),new Wt(28,new dt(6,47),new dt(34,48)),new Wt(30,new dt(46,24),new dt(10,25)),new Wt(30,new dt(2,15),new dt(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new Wt(30,new dt(17,122),new dt(4,123)),new Wt(28,new dt(29,46),new dt(14,47)),new Wt(30,new dt(49,24),new dt(10,25)),new Wt(30,new dt(24,15),new dt(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new Wt(30,new dt(4,122),new dt(18,123)),new Wt(28,new dt(13,46),new dt(32,47)),new Wt(30,new dt(48,24),new dt(14,25)),new Wt(30,new dt(42,15),new dt(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new Wt(30,new dt(20,117),new dt(4,118)),new Wt(28,new dt(40,47),new dt(7,48)),new Wt(30,new dt(43,24),new dt(22,25)),new Wt(30,new dt(10,15),new dt(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new Wt(30,new dt(19,118),new dt(6,119)),new Wt(28,new dt(18,47),new dt(31,48)),new Wt(30,new dt(34,24),new dt(34,25)),new Wt(30,new dt(20,15),new dt(61,16)))],t}(),Go;(function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"})(Go||(Go={}));var q$=function(){function t(e,r){this.value=e,this.isMasked=r}return t.prototype.unmaskBitMatrix=function(e,r){for(var n=0;n<r;n++)for(var a=0;a<r;a++)this.isMasked(n,a)&&e.flip(a,n)},t.values=new Map([[Go.DATA_MASK_000,new t(Go.DATA_MASK_000,function(e,r){return(e+r&1)===0})],[Go.DATA_MASK_001,new t(Go.DATA_MASK_001,function(e,r){return(e&1)===0})],[Go.DATA_MASK_010,new t(Go.DATA_MASK_010,function(e,r){return r%3===0})],[Go.DATA_MASK_011,new t(Go.DATA_MASK_011,function(e,r){return(e+r)%3===0})],[Go.DATA_MASK_100,new t(Go.DATA_MASK_100,function(e,r){return(Math.floor(e/2)+Math.floor(r/3)&1)===0})],[Go.DATA_MASK_101,new t(Go.DATA_MASK_101,function(e,r){return e*r%6===0})],[Go.DATA_MASK_110,new t(Go.DATA_MASK_110,function(e,r){return e*r%6<3})],[Go.DATA_MASK_111,new t(Go.DATA_MASK_111,function(e,r){return(e+r+e*r%3&1)===0})]]),t}(),_7e=function(){function t(e){var r=e.getHeight();if(r<21||(r&3)!==1)throw new Kr;this.bitMatrix=e}return t.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,r=0;r<6;r++)e=this.copyBit(r,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),s=0,o=a-7,n=a-1;n>=o;n--)s=this.copyBit(8,n,s);for(var r=a-8;r<a;r++)s=this.copyBit(r,8,s);if(this.parsedFormatInfo=kse.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Kr},t.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),r=Math.floor((e-17)/4);if(r<=6)return Wp.getVersionForNumber(r);for(var n=0,a=e-11,s=5;s>=0;s--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,s,n);var l=Wp.decodeVersionInformation(n);if(l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;n=0;for(var o=5;o>=0;o--)for(var s=e-9;s>=a;s--)n=this.copyBit(o,s,n);if(l=Wp.decodeVersionInformation(n),l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;throw new Kr},t.prototype.copyBit=function(e,r,n){var a=this.isMirror?this.bitMatrix.get(r,e):this.bitMatrix.get(e,r);return a?n<<1|1:n<<1},t.prototype.readCodewords=function(){var e=this.readFormatInformation(),r=this.readVersion(),n=q$.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var s=r.buildFunctionPattern(),o=!0,l=new Uint8Array(r.getTotalCodewords()),c=0,u=0,d=0,f=a-1;f>0;f-=2){f===6&&f--;for(var A=0;A<a;A++)for(var h=o?a-1-A:A,m=0;m<2;m++)s.get(f-m,h)||(d++,u<<=1,this.bitMatrix.get(f-m,h)&&(u|=1),d===8&&(l[c++]=u,d=0,u=0));o=!o}if(c!==r.getTotalCodewords())throw new Kr;return l},t.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=q$.values.get(this.parsedFormatInfo.getDataMask()),r=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},t.prototype.mirror=function(){for(var e=this.bitMatrix,r=0,n=e.getWidth();r<n;r++)for(var a=r+1,s=e.getHeight();a<s;a++)e.get(r,a)!==e.get(a,r)&&(e.flip(a,r),e.flip(r,a))},t}(),z$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},E7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r,n){var a,s,o,l;if(e.length!==r.getTotalCodewords())throw new Pn;var c=r.getECBlocksForLevel(n),u=0,d=c.getECBlocks();try{for(var f=z$(d),A=f.next();!A.done;A=f.next()){var h=A.value;u+=h.getCount()}}catch(P){a={error:P}}finally{try{A&&!A.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}var m=new Array(u),p=0;try{for(var x=z$(d),v=x.next();!v.done;v=x.next())for(var h=v.value,y=0;y<h.getCount();y++){var b=h.getDataCodewords(),w=c.getECCodewordsPerBlock()+b;m[p++]=new t(b,new Uint8Array(w))}}catch(P){o={error:P}}finally{try{v&&!v.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}for(var I=m[0].codewords.length,j=m.length-1;j>=0;){var C=m[j].codewords.length;if(C===I)break;j--}j++;for(var S=I-c.getECCodewordsPerBlock(),E=0,y=0;y<S;y++)for(var B=0;B<p;B++)m[B].codewords[y]=e[E++];for(var B=j;B<p;B++)m[B].codewords[S]=e[E++];for(var k=m[0].codewords.length,y=S;y<k;y++)for(var B=0;B<p;B++){var T=B<j?y:y+1;m[B].codewords[T]=e[E++]}return m},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),Ad;(function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"})(Ad||(Ad={}));var Ts=function(){function t(e,r,n,a){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,t.FOR_BITS.set(a,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var r=t.FOR_BITS.get(e);if(r===void 0)throw new Pn;return r},t.prototype.getCharacterCountBits=function(e){var r=e.getVersionNumber(),n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(Ad.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(Ad.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(Ad.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(Ad.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),t.BYTE=new t(Ad.BYTE,"BYTE",Int32Array.from([8,16,16]),4),t.ECI=new t(Ad.ECI,"ECI",Int32Array.from([0,0,0]),7),t.KANJI=new t(Ad.KANJI,"KANJI",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(Ad.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(Ad.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),t.HANZI=new t(Ad.HANZI,"HANZI",Int32Array.from([8,10,12]),13),t}(),S7e=function(){function t(){}return t.decode=function(e,r,n,a){var s=new Bse(e),o=new ta,l=new Array,c=-1,u=-1;try{var d=null,f=!1,A=void 0;do{if(s.available()<4)A=Ts.TERMINATOR;else{var h=s.readBits(4);A=Ts.forBits(h)}switch(A){case Ts.TERMINATOR:break;case Ts.FNC1_FIRST_POSITION:case Ts.FNC1_SECOND_POSITION:f=!0;break;case Ts.STRUCTURED_APPEND:if(s.available()<16)throw new Kr;c=s.readBits(8),u=s.readBits(8);break;case Ts.ECI:var m=t.parseECIValue(s);if(d=Po.getCharacterSetECIByValue(m),d===null)throw new Kr;break;case Ts.HANZI:var p=s.readBits(4),x=s.readBits(A.getCharacterCountBits(r));p===t.GB2312_SUBSET&&t.decodeHanziSegment(s,o,x);break;default:var v=s.readBits(A.getCharacterCountBits(r));switch(A){case Ts.NUMERIC:t.decodeNumericSegment(s,o,v);break;case Ts.ALPHANUMERIC:t.decodeAlphanumericSegment(s,o,v,f);break;case Ts.BYTE:t.decodeByteSegment(s,o,v,d,l,a);break;case Ts.KANJI:t.decodeKanjiSegment(s,o,v);break;default:throw new Kr}break}}while(A!==Ts.TERMINATOR)}catch{throw new Kr}return new yP(e,o.toString(),l.length===0?null:l,n===null?null:n.toString(),c,u)},t.decodeHanziSegment=function(e,r,n){if(n*13>e.available())throw new Kr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,a[s]=l>>8&255,a[s+1]=l&255,s+=2,n--}try{r.append(Bd.decode(a,Na.GB2312))}catch(c){throw new Kr(c)}},t.decodeKanjiSegment=function(e,r,n){if(n*13>e.available())throw new Kr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,a[s]=l>>8,a[s+1]=l,s+=2,n--}try{r.append(Bd.decode(a,Na.SHIFT_JIS))}catch(c){throw new Kr(c)}},t.decodeByteSegment=function(e,r,n,a,s,o){if(8*n>e.available())throw new Kr;for(var l=new Uint8Array(n),c=0;c<n;c++)l[c]=e.readBits(8);var u;a===null?u=Na.guessEncoding(l,o):u=a.getName();try{r.append(Bd.decode(l,u))}catch(d){throw new Kr(d)}s.push(l)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new Kr;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,r,n,a){for(var s=r.length();n>1;){if(e.available()<11)throw new Kr;var o=e.readBits(11);r.append(t.toAlphaNumericChar(Math.floor(o/45))),r.append(t.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new Kr;r.append(t.toAlphaNumericChar(e.readBits(6)))}if(a)for(var l=s;l<r.length();l++)r.charAt(l)==="%"&&(l<r.length()-1&&r.charAt(l+1)==="%"?r.deleteCharAt(l+1):r.setCharAt(l,""))},t.decodeNumericSegment=function(e,r,n){for(;n>=3;){if(e.available()<10)throw new Kr;var a=e.readBits(10);if(a>=1e3)throw new Kr;r.append(t.toAlphaNumericChar(Math.floor(a/100))),r.append(t.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(t.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new Kr;var s=e.readBits(7);if(s>=100)throw new Kr;r.append(t.toAlphaNumericChar(Math.floor(s/10))),r.append(t.toAlphaNumericChar(s%10))}else if(n===1){if(e.available()<4)throw new Kr;var o=e.readBits(4);if(o>=10)throw new Kr;r.append(t.toAlphaNumericChar(o))}},t.parseECIValue=function(e){var r=e.readBits(8);if(!(r&128))return r&127;if((r&192)===128){var n=e.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){var a=e.readBits(16);return(r&31)<<16&4294967295|a}throw new Kr},t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.GB2312_SUBSET=1,t}(),Fse=function(){function t(e){this.mirrored=e}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var r=e[0];e[0]=e[2],e[2]=r}},t}(),W$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},j7e=function(){function t(){this.rsDecoder=new bP(tu.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(e,r){return this.decodeBitMatrix(uh.parseFromBooleanArray(e),r)},t.prototype.decodeBitMatrix=function(e,r){var n=new _7e(e),a=null;try{return this.decodeBitMatrixParser(n,r)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var s=this.decodeBitMatrixParser(n,r);return s.setOther(new Fse(!0)),s}catch(o){throw a!==null?a:o}},t.prototype.decodeBitMatrixParser=function(e,r){var n,a,s,o,l=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),u=e.readCodewords(),d=E7e.getDataBlocks(u,l,c),f=0;try{for(var A=W$(d),h=A.next();!h.done;h=A.next()){var m=h.value;f+=m.getNumDataCodewords()}}catch(j){n={error:j}}finally{try{h&&!h.done&&(a=A.return)&&a.call(A)}finally{if(n)throw n.error}}var p=new Uint8Array(f),x=0;try{for(var v=W$(d),y=v.next();!y.done;y=v.next()){var m=y.value,b=m.getCodewords(),w=m.getNumDataCodewords();this.correctErrors(b,w);for(var I=0;I<w;I++)p[x++]=b[I]}}catch(j){s={error:j}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(s)throw s.error}}return S7e.decode(p,l,c,r)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new co}for(var a=0;a<r;a++)e[a]=n[a]},t}(),I7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),P7e=function(t){I7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.estimatedModuleSize=a,s}return e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=(this.getX()+n)/2,o=(this.getY()+r)/2,l=(this.estimatedModuleSize+a)/2;return new e(s,o,l)},e}(hn),T7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},B7e=function(){function t(e,r,n,a,s,o,l){this.image=e,this.startX=r,this.startY=n,this.width=a,this.height=s,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var e=this.startX,r=this.height,n=this.width,a=e+n,s=this.startY+r/2,o=new Int32Array(3),l=this.image,c=0;c<r;c++){var u=s+(c&1?-Math.floor((c+1)/2):Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var d=e;d<a&&!l.get(d,u);)d++;for(var f=0;d<a;){if(l.get(d,u))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,d);if(A!==null)return A}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;d++}if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,a);if(A!==null)return A}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new lr},t.centerFromEnd=function(e,r){return r-e[2]-e[1]/2},t.prototype.foundPatternCross=function(e){for(var r=this.moduleSize,n=r/2,a=0;a<3;a++)if(Math.abs(r-e[a])>=n)return!1;return!0},t.prototype.crossCheckVertical=function(e,r,n,a){var s=this.image,o=s.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;for(var c=e;c>=0&&s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&!s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c)&&l[1]<=n;)l[1]++,c++;if(c===o||l[1]>n)return NaN;for(;c<o&&!s.get(r,c)&&l[2]<=n;)l[2]++,c++;if(l[2]>n)return NaN;var u=l[0]+l[1]+l[2];return 5*Math.abs(u-a)>=2*a?NaN:this.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n){var a,s,o=e[0]+e[1]+e[2],l=t.centerFromEnd(e,n),c=this.crossCheckVertical(r,l,2*e[1],o);if(!isNaN(c)){var u=(e[0]+e[1]+e[2])/3;try{for(var d=T7e(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.aboutEquals(u,c,l))return A.combineEstimate(c,l,u)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}var h=new P7e(l,c,u);this.possibleCenters.push(h),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(h)}return null},t}(),k7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),F7e=function(t){k7e(e,t);function e(r,n,a,s){var o=t.call(this,r,n)||this;return o.estimatedModuleSize=a,o.count=s,s===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=this.count+1,o=(this.count*this.getX()+n)/s,l=(this.count*this.getY()+r)/s,c=(this.count*this.estimatedModuleSize+a)/s;return new e(o,l,c,s)},e}(hn),O7e=function(){function t(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t}(),Cy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},D7e=function(){function t(e,r){this.image=e,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var r=e!=null&&e.get(_s.TRY_HARDER)!==void 0,n=e!=null&&e.get(_s.PURE_BARCODE)!==void 0,a=this.image,s=a.getHeight(),o=a.getWidth(),l=Math.floor(3*s/(4*t.MAX_MODULES));(l<t.MIN_SKIP||r)&&(l=t.MIN_SKIP);for(var c=!1,u=new Int32Array(5),d=l-1;d<s&&!c;d+=l){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;for(var f=0,A=0;A<o;A++)if(a.get(A,d))(f&1)===1&&f++,u[f]++;else if(f&1)u[f]++;else if(f===4)if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,A,n);if(h===!0)if(l=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var m=this.findRowSkip();m>u[2]&&(d+=m-u[2]-l,A=o-1)}else{u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;continue}f=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;else u[++f]++;if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,o,n);h===!0&&(l=u[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var p=this.selectBestPatterns();return hn.orderBestPatterns(p),new O7e(p)},t.centerFromEnd=function(e,r){return r-e[4]-e[3]-e[2]/2},t.foundPatternCross=function(e){for(var r=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;r+=a}if(r<7)return!1;var s=r/7,o=s/2;return Math.abs(s-e[0])<o&&Math.abs(s-e[1])<o&&Math.abs(3*s-e[2])<3*o&&Math.abs(s-e[3])<o&&Math.abs(s-e[4])<o},t.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},t.prototype.crossCheckDiagonal=function(e,r,n,a){for(var s=this.getCrossCheckStateCount(),o=0,l=this.image;e>=o&&r>=o&&l.get(r-o,e-o);)s[2]++,o++;if(e<o||r<o)return!1;for(;e>=o&&r>=o&&!l.get(r-o,e-o)&&s[1]<=n;)s[1]++,o++;if(e<o||r<o||s[1]>n)return!1;for(;e>=o&&r>=o&&l.get(r-o,e-o)&&s[0]<=n;)s[0]++,o++;if(s[0]>n)return!1;var c=l.getHeight(),u=l.getWidth();for(o=1;e+o<c&&r+o<u&&l.get(r+o,e+o);)s[2]++,o++;if(e+o>=c||r+o>=u)return!1;for(;e+o<c&&r+o<u&&!l.get(r+o,e+o)&&s[3]<n;)s[3]++,o++;if(e+o>=c||r+o>=u||s[3]>=n)return!1;for(;e+o<c&&r+o<u&&l.get(r+o,e+o)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return!1;var d=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(d-a)<2*a&&t.foundPatternCross(s)},t.prototype.crossCheckVertical=function(e,r,n,a){for(var s=this.image,o=s.getHeight(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(r,c);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(r,c)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(r,c)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=2*a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.crossCheckHorizontal=function(e,r,n,a){for(var s=this.image,o=s.getWidth(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(c,r);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(c,r)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(c,r)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(c,r);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(c,r)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(c,r)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n,a){var s=e[0]+e[1]+e[2]+e[3]+e[4],o=t.centerFromEnd(e,n),l=this.crossCheckVertical(r,Math.floor(o),e[2],s);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),e[2],s),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),e[2],s)))){for(var c=s/7,u=!1,d=this.possibleCenters,f=0,A=d.length;f<A;f++){var h=d[f];if(h.aboutEquals(c,l,o)){d[f]=h.combineEstimate(l,o,c),u=!0;break}}if(!u){var m=new F7e(o,l,c);d.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return!0}return!1},t.prototype.findRowSkip=function(){var e,r,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var s=Cy(this.possibleCenters),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.getCount()>=t.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,r,n,a,s=0,o=0,l=this.possibleCenters.length;try{for(var c=Cy(this.possibleCenters),u=c.next();!u.done;u=c.next()){var d=u.value;d.getCount()>=t.CENTER_QUORUM&&(s++,o+=d.getEstimatedModuleSize())}}catch(p){e={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(s<3)return!1;var f=o/l,A=0;try{for(var h=Cy(this.possibleCenters),m=h.next();!m.done;m=h.next()){var d=m.value;A+=Math.abs(d.getEstimatedModuleSize()-f)}}catch(p){n={error:p}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return A<=.05*o},t.prototype.selectBestPatterns=function(){var e,r,n,a,s=this.possibleCenters.length;if(s<3)throw new lr;var o=this.possibleCenters,l;if(s>3){var c=0,u=0;try{for(var d=Cy(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value,h=A.getEstimatedModuleSize();c+=h,u+=h*h}}catch(I){e={error:I}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}l=c/s;var m=Math.sqrt(u/s-l*l);o.sort(function(I,j){var C=Math.abs(j.getEstimatedModuleSize()-l),S=Math.abs(I.getEstimatedModuleSize()-l);return C<S?-1:C>S?1:0});for(var p=Math.max(.2*l,m),x=0;x<o.length&&o.length>3;x++){var v=o[x];Math.abs(v.getEstimatedModuleSize()-l)>p&&(o.splice(x,1),x--)}}if(o.length>3){var c=0;try{for(var y=Cy(o),b=y.next();!b.done;b=y.next()){var w=b.value;c+=w.getEstimatedModuleSize()}}catch(j){n={error:j}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}l=c/o.length,o.sort(function(j,C){if(C.getCount()===j.getCount()){var S=Math.abs(C.getEstimatedModuleSize()-l),E=Math.abs(j.getEstimatedModuleSize()-l);return S<E?1:S>E?-1:0}else return C.getCount()-j.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t}(),R7e=function(){function t(e){this.image=e}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(_s.NEED_RESULT_POINT_CALLBACK);var r=new D7e(this.image,this.resultPointCallback),n=r.find(e);return this.processFinderPatternInfo(n)},t.prototype.processFinderPatternInfo=function(e){var r=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),s=this.calculateModuleSize(r,n,a);if(s<1)throw new lr("No pattern found in proccess finder.");var o=t.computeDimension(r,n,a,s),l=Wp.getProvisionalVersionForDimension(o),c=l.getDimensionForVersion()-7,u=null;if(l.getAlignmentPatternCenters().length>0)for(var d=n.getX()-r.getX()+a.getX(),f=n.getY()-r.getY()+a.getY(),A=1-3/c,h=Math.floor(r.getX()+A*(d-r.getX())),m=Math.floor(r.getY()+A*(f-r.getY())),p=4;p<=16;p<<=1)try{u=this.findAlignmentInRegion(s,h,m,p);break}catch(b){if(!(b instanceof lr))throw b}var x=t.createTransform(r,n,a,u,o),v=t.sampleGrid(this.image,x,o),y;return u===null?y=[a,r,n]:y=[a,r,n,u],new QR(v,y)},t.createTransform=function(e,r,n,a,s){var o=s-3.5,l,c,u,d;return a!==null?(l=a.getX(),c=a.getY(),u=o-3,d=u):(l=r.getX()-e.getX()+n.getX(),c=r.getY()-e.getY()+n.getY(),u=o,d=o),jse.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,d,3.5,o,e.getX(),e.getY(),r.getX(),r.getY(),l,c,n.getX(),n.getY())},t.sampleGrid=function(e,r,n){var a=VR.getInstance();return a.sampleGridWithTransform(e,n,n,r)},t.computeDimension=function(e,r,n,a){var s=Ta.round(hn.distance(e,r)/a),o=Ta.round(hn.distance(e,n)/a),l=Math.floor((s+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new lr("Dimensions could be not found.")}return l},t.prototype.calculateModuleSize=function(e,r,n){return(this.calculateModuleSizeOneWay(e,r)+this.calculateModuleSizeOneWay(e,n))/2},t.prototype.calculateModuleSizeOneWay=function(e,r){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,r,n,a){var s=this.sizeOfBlackWhiteBlackRun(e,r,n,a),o=1,l=e-(n-e);l<0?(o=e/(e-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(l-e),l=this.image.getWidth()-1);var c=Math.floor(r-(a-r)*o);return o=1,c<0?(o=r/(r-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-r)/(c-r),c=this.image.getHeight()-1),l=Math.floor(e+(l-e)*o),s+=this.sizeOfBlackWhiteBlackRun(e,r,l,c),s-1},t.prototype.sizeOfBlackWhiteBlackRun=function(e,r,n,a){var s=Math.abs(a-r)>Math.abs(n-e);if(s){var o=e;e=r,r=o,o=n,n=a,a=o}for(var l=Math.abs(n-e),c=Math.abs(a-r),u=-l/2,d=e<n?1:-1,f=r<a?1:-1,A=0,h=n+d,m=e,p=r;m!==h;m+=d){var x=s?p:m,v=s?m:p;if(A===1===this.image.get(x,v)){if(A===2)return Ta.distance(m,p,e,r);A++}if(u+=c,u>0){if(p===a)break;p+=f,u-=l}}return A===2?Ta.distance(n+d,a,e,r):NaN},t.prototype.findAlignmentInRegion=function(e,r,n,a){var s=Math.floor(a*e),o=Math.max(0,r-s),l=Math.min(this.image.getWidth()-1,r+s);if(l-o<e*3)throw new lr("Alignment top exceeds estimated module size.");var c=Math.max(0,n-s),u=Math.min(this.image.getHeight()-1,n+s);if(u-c<e*3)throw new lr("Alignment bottom exceeds estimated module size.");var d=new B7e(this.image,o,c,l-o,u-c,e,this.resultPointCallback);return d.find()},t}(),sj=function(){function t(){this.decoder=new j7e}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,r){var n,a;if(r!=null&&r.get(_s.PURE_BARCODE)!==void 0){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(s,r),a=t.NO_POINTS}else{var o=new R7e(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(o.getBits(),r),a=o.getPoints()}n.getOther()instanceof Fse&&n.getOther().applyMirroredCorrection(a);var l=new hc(n.getText(),n.getRawBytes(),void 0,a,In.QR_CODE,void 0),c=n.getByteSegments();c!==null&&l.putMetadata(Tl.BYTE_SEGMENTS,c);var u=n.getECLevel();return u!==null&&l.putMetadata(Tl.ERROR_CORRECTION_LEVEL,u),n.hasStructuredAppend()&&(l.putMetadata(Tl.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),l.putMetadata(Tl.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),l},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r===null||n===null)throw new lr;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0];if(l>=c||s>=o)throw new lr;if(o-s!==c-l&&(c=l+(o-s),c>=e.getWidth()))throw new lr;var u=Math.round((c-l+1)/a),d=Math.round((o-s+1)/a);if(u<=0||d<=0)throw new lr;if(d!==u)throw new lr;var f=Math.floor(a/2);s+=f,l+=f;var A=l+Math.floor((u-1)*a)-c;if(A>0){if(A>f)throw new lr;l-=A}var h=s+Math.floor((d-1)*a)-o;if(h>0){if(h>f)throw new lr;s-=h}for(var m=new uh(u,d),p=0;p<d;p++)for(var x=s+Math.floor(p*a),v=0;v<u;v++)e.get(l+Math.floor(v*a),x)&&m.set(v,p);return m},t.moduleSize=function(e,r){for(var n=r.getHeight(),a=r.getWidth(),s=e[0],o=e[1],l=!0,c=0;s<a&&o<n;){if(l!==r.get(s,o)){if(++c===5)break;l=!l}s++,o++}if(s===a||o===n)throw new lr;return(s-e[0])/7},t.NO_POINTS=new Array,t}(),M7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_a=function(){function t(){}return t.prototype.PDF417Common=function(){},t.getBitCountSum=function(e){return Ta.sum(e)},t.toIntArray=function(e){var r,n;if(e==null||!e.length)return t.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),s=0;try{for(var o=M7e(e),l=o.next();!l.done;l=o.next()){var c=l.value;a[s++]=c}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},t.getCodeword=function(e){var r=Bo.binarySearch(t.SYMBOL_TABLE,e&262143);return r<0?-1:(t.CODEWORD_TABLE[r]-1)%t.NUMBER_OF_CODEWORDS},t.NUMBER_OF_CODEWORDS=929,t.MAX_CODEWORDS_IN_BARCODE=t.NUMBER_OF_CODEWORDS-1,t.MIN_ROWS_IN_BARCODE=3,t.MAX_ROWS_IN_BARCODE=90,t.MODULES_IN_CODEWORD=17,t.MODULES_IN_STOP_PATTERN=18,t.BARS_IN_MODULE=8,t.EMPTY_INT_ARRAY=new Int32Array([]),t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),t}(),L7e=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),U7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q7e=function(){function t(){}return t.detectMultiple=function(e,r,n){var a=e.getBlackMatrix(),s=t.detect(n,a);return s.length||(a=a.clone(),a.rotate180(),s=t.detect(n,a)),new L7e(a,s)},t.detect=function(e,r){for(var n,a,s=new Array,o=0,l=0,c=!1;o<r.getHeight();){var u=t.findVertices(r,o,l);if(u[0]==null&&u[3]==null){if(!c)break;c=!1,l=0;try{for(var d=(n=void 0,U7e(s)),f=d.next();!f.done;f=d.next()){var A=f.value;A[1]!=null&&(o=Math.trunc(Math.max(o,A[1].getY()))),A[3]!=null&&(o=Math.max(o,Math.trunc(A[3].getY())))}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o+=t.ROW_STEP;continue}if(c=!0,s.push(u),!e)break;u[2]!=null?(l=Math.trunc(u[2].getX()),o=Math.trunc(u[2].getY())):(l=Math.trunc(u[4].getX()),o=Math.trunc(u[4].getY()))}return s},t.findVertices=function(e,r,n){var a=e.getHeight(),s=e.getWidth(),o=new Array(8);return t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.START_PATTERN),t.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY())),t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.STOP_PATTERN),t.INDEXES_STOP_PATTERN),o},t.copyToResult=function(e,r,n){for(var a=0;a<n.length;a++)e[n[a]]=r[a]},t.findRowsWithPattern=function(e,r,n,a,s,o){for(var l=new Array(4),c=!1,u=new Int32Array(o.length);a<r;a+=t.ROW_STEP){var d=t.findGuardPattern(e,s,a,n,!1,o,u);if(d!=null){for(;a>0;){var f=t.findGuardPattern(e,s,--a,n,!1,o,u);if(f!=null)d=f;else{a++;break}}l[0]=new hn(d[0],a),l[1]=new hn(d[1],a),c=!0;break}}var A=a+1;if(c){for(var h=0,f=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);A<r;A++){var d=t.findGuardPattern(e,f[0],A,n,!1,o,u);if(d!=null&&Math.abs(f[0]-d[0])<t.MAX_PATTERN_DRIFT&&Math.abs(f[1]-d[1])<t.MAX_PATTERN_DRIFT)f=d,h=0;else{if(h>t.SKIPPED_ROW_COUNT_MAX)break;h++}}A-=h+1,l[2]=new hn(f[0],A),l[3]=new hn(f[1],A)}return A-a<t.BARCODE_MIN_HEIGHT&&Bo.fill(l,null),l},t.findGuardPattern=function(e,r,n,a,s,o,l){Bo.fillWithin(l,0,l.length,0);for(var c=r,u=0;e.get(c,n)&&c>0&&u++<t.MAX_PIXEL_DRIFT;)c--;for(var d=c,f=0,A=o.length,h=s;d<a;d++){var m=e.get(d,n);if(m!==h)l[f]++;else{if(f===A-1){if(t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return new Int32Array([c,d]);c+=l[0]+l[1],Cs.arraycopy(l,2,l,0,f-1),l[f-1]=0,l[f]=0,f--}else f++;l[f]=1,h=!h}}return f===A-1&&t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE?new Int32Array([c,d-1]):null},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return 1/0;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return 1/0;u+=h}return u/s},t.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),t.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),t.MAX_AVG_VARIANCE=.42,t.MAX_INDIVIDUAL_VARIANCE=.8,t.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),t.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),t.MAX_PIXEL_DRIFT=3,t.MAX_PATTERN_DRIFT=5,t.SKIPPED_ROW_COUNT_MAX=25,t.ROW_STEP=5,t.BARCODE_MIN_HEIGHT=10,t}(),V7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bp=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),Cs.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){var r,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var s=V7e(this.coefficients),o=s.next();!o.done;o=s.next()){var l=o.value;a=this.field.add(a,l)}}catch(f){r={error:f}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}for(var c=this.coefficients[0],u=this.coefficients.length,d=1;d<u;d++)c=this.field.add(this.field.multiply(e,c),this.coefficients[d]);return c},t.prototype.add=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;Cs.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=this.field.add(r[l-o],n[l]);return new t(this.field,s)},t.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},t.prototype.multiply=function(e){return e instanceof t?this.multiplyOther(e):this.multiplyScalar(e)},t.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new t(this.field,new Int32Array([0]));for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=0;l<n;l++)for(var c=r[l],u=0;u<s;u++)o[l+u]=this.field.add(o[l+u],this.field.multiply(c,a[u]));return new t(this.field,o)},t.prototype.negative=function(){for(var e=this.coefficients.length,r=new Int32Array(e),n=0;n<e;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new t(this.field,r)},t.prototype.multiplyScalar=function(e){if(e===0)return new t(this.field,new Int32Array([0]));if(e===1)return this;for(var r=this.coefficients.length,n=new Int32Array(r),a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new t(this.field,n)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return new t(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),s=0;s<n;s++)a[s]=this.field.multiply(this.coefficients[s],r);return new t(this.field,a)},t.prototype.toString=function(){for(var e=new ta,r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(r===0||n!==1)&&e.append(n),r!==0&&(r===1?e.append("x"):(e.append("x^"),e.append(r))))}return e.toString()},t}(),H7e=function(){function t(){}return t.prototype.add=function(e,r){return(e+r)%this.modulus},t.prototype.subtract=function(e,r){return(this.modulus+e-r)%this.modulus},t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.prototype.inverse=function(e){if(e===0)throw new Sse;return this.expTable[this.modulus-this.logTable[e]-1]},t.prototype.multiply=function(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.modulus-1)]},t.prototype.getSize=function(){return this.modulus},t.prototype.equals=function(e){return e===this},t}(),$7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G7e=function(t){$7e(e,t);function e(r,n){var a=t.call(this)||this;a.modulus=r,a.expTable=new Int32Array(r),a.logTable=new Int32Array(r);for(var s=1,o=0;o<r;o++)a.expTable[o]=s,s=s*n%r;for(var o=0;o<r-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new Bp(a,new Int32Array([0])),a.one=new Bp(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new Bp(this,a)},e.PDF417_GF=new e(_a.NUMBER_OF_CODEWORDS,3),e}(H7e),K7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q7e=function(){function t(){this.field=G7e.PDF417_GF}return t.prototype.decode=function(e,r,n){for(var a,s,o=new Bp(this.field,e),l=new Int32Array(r),c=!1,u=r;u>0;u--){var d=o.evaluateAt(this.field.exp(u));l[r-u]=d,d!==0&&(c=!0)}if(!c)return 0;var f=this.field.getOne();if(n!=null)try{for(var A=K7e(n),h=A.next();!h.done;h=A.next()){var m=h.value,p=this.field.exp(e.length-1-m),x=new Bp(this.field,new Int32Array([this.field.subtract(0,p),1]));f=f.multiply(x)}}catch(S){a={error:S}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}for(var v=new Bp(this.field,l),y=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),v,r),b=y[0],w=y[1],I=this.findErrorLocations(b),j=this.findErrorMagnitudes(w,b,I),u=0;u<I.length;u++){var C=e.length-1-this.field.log(I[u]);if(C<0)throw co.getChecksumInstance();e[C]=this.field.subtract(e[C],j[u])}return I.length},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=e,o=r,l=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(n/2);){var u=s,d=l;if(s=o,l=c,s.isZero())throw co.getChecksumInstance();o=u;for(var f=this.field.getZero(),A=s.getCoefficient(s.getDegree()),h=this.field.inverse(A);o.getDegree()>=s.getDegree()&&!o.isZero();){var m=o.getDegree()-s.getDegree(),p=this.field.multiply(o.getCoefficient(o.getDegree()),h);f=f.add(this.field.buildMonomial(m,p)),o=o.subtract(s.multiplyByMonomial(m,p))}c=f.multiply(l).subtract(d).negative()}var x=c.getCoefficient(0);if(x===0)throw co.getChecksumInstance();var v=this.field.inverse(x),y=c.multiply(v),b=o.multiply(v);return[y,b]},t.prototype.findErrorLocations=function(e){for(var r=e.getDegree(),n=new Int32Array(r),a=0,s=1;s<this.field.getSize()&&a<r;s++)e.evaluateAt(s)===0&&(n[a]=this.field.inverse(s),a++);if(a!==r)throw co.getChecksumInstance();return n},t.prototype.findErrorMagnitudes=function(e,r,n){for(var a=r.getDegree(),s=new Int32Array(a),o=1;o<=a;o++)s[a-o]=this.field.multiply(o,r.getCoefficient(o));for(var l=new Bp(this.field,s),c=n.length,u=new Int32Array(c),o=0;o<c;o++){var d=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(d)),A=this.field.inverse(l.evaluateAt(d));u[o]=this.field.multiply(f,A)}return u},t}(),pF=function(){function t(e,r,n,a,s){e instanceof t?this.constructor_2(e):this.constructor_1(e,r,n,a,s)}return t.prototype.constructor_1=function(e,r,n,a,s){var o=r==null||n==null,l=a==null||s==null;if(o&&l)throw new lr;o?(r=new hn(0,a.getY()),n=new hn(0,s.getY())):l&&(a=new hn(e.getWidth()-1,r.getY()),s=new hn(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=s,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),s.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))},t.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},t.merge=function(e,r){return e==null?r:r==null?e:new t(e.image,e.topLeft,e.bottomLeft,r.topRight,r.bottomRight)},t.prototype.addMissingRows=function(e,r,n){var a=this.topLeft,s=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(e>0){var c=n?this.topLeft:this.topRight,u=Math.trunc(c.getY()-e);u<0&&(u=0);var d=new hn(c.getX(),u);n?a=d:o=d}if(r>0){var f=n?this.bottomLeft:this.bottomRight,A=Math.trunc(f.getY()+r);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);var h=new hn(f.getX(),A);n?s=h:l=h}return new t(this.image,a,s,o,l)},t.prototype.getMinX=function(){return this.minX},t.prototype.getMaxX=function(){return this.maxX},t.prototype.getMinY=function(){return this.minY},t.prototype.getMaxY=function(){return this.maxY},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getBottomRight=function(){return this.bottomRight},t}(),z7e=function(){function t(e,r,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}return t.prototype.getColumnCount=function(){return this.columnCount},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},t.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},t}(),$R=function(){function t(){this.buffer=""}return t.form=function(e,r){var n=-1;function a(o,l,c,u,d,f){if(o==="%%")return"%";if(r[++n]!==void 0){o=u?parseInt(u.substr(1)):void 0;var A=d?parseInt(d.substr(1)):void 0,h;switch(f){case"s":h=r[n];break;case"c":h=r[n][0];break;case"f":h=parseFloat(r[n]).toFixed(o);break;case"p":h=parseFloat(r[n]).toPrecision(o);break;case"e":h=parseFloat(r[n]).toExponential(o);break;case"x":h=parseInt(r[n]).toString(A||16);break;case"d":h=parseFloat(parseInt(r[n],A||10).toPrecision(o)).toFixed(0);break}h=typeof h=="object"?JSON.stringify(h):(+h).toString(A);for(var m=parseInt(c),p=c&&c[0]+""=="0"?"0":" ";h.length<m;)h=l!==void 0?h+p:p+h;return h}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,a)},t.prototype.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.buffer+=t.form(e,r)},t.prototype.toString=function(){return this.buffer},t}(),W7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ose=function(){function t(e){this.boundingBox=new pF(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return t.prototype.getCodewordNearby=function(e){var r=this.getCodeword(e);if(r!=null)return r;for(var n=1;n<t.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null},t.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},t.prototype.setCodeword=function(e,r){this.codewords[this.imageRowToCodewordIndex(e)]=r},t.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.getCodewords=function(){return this.codewords},t.prototype.toString=function(){var e,r,n=new $R,a=0;try{for(var s=W7e(this.codewords),o=s.next();!o.done;o=s.next()){var l=o.value;if(l==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n.toString()},t.MAX_NEARBY_DISTANCE=5,t}(),X7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Y7e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,s=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s},nb=function(){function t(){this.values=new Map}return t.prototype.setValue=function(e){e=Math.trunc(e);var r=this.values.get(e);r==null&&(r=0),r++,this.values.set(e,r)},t.prototype.getValue=function(){var e,r,n=-1,a=new Array,s=function(f,A){var h={getKey:function(){return f},getValue:function(){return A}};h.getValue()>n?(n=h.getValue(),a=[],a.push(h.getKey())):h.getValue()===n&&a.push(h.getKey())};try{for(var o=X7e(this.values.entries()),l=o.next();!l.done;l=o.next()){var c=Y7e(l.value,2),u=c[0],d=c[1];s(u,d)}}catch(f){e={error:f}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return _a.toIntArray(a)},t.prototype.getConfidence=function(e){return this.values.get(e)},t}(),J7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},X$=function(t){J7e(e,t);function e(r,n){var a=t.call(this,r)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var r,n;try{for(var a=W5(this.getCodewords()),s=a.next();!s.done;s=a.next()){var o=s.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(r){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,r);for(var a=this.getBoundingBox(),s=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=-1,d=1,f=0,A=l;A<c;A++)if(n[A]!=null){var h=n[A],m=h.getRowNumber()-u;if(m===0)f++;else if(m===1)d=Math.max(d,f),f=1,u=h.getRowNumber();else if(m<0||h.getRowNumber()>=r.getRowCount()||m>A)n[A]=null;else{var p=void 0;d>2?p=(d-2)*m:p=m;for(var x=p>=A,v=1;v<=p&&!x;v++)x=n[A-v]!=null;x?n[A]=null:(u=h.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var r,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var s=new Int32Array(a.getRowCount());try{for(var o=W5(this.getCodewords()),l=o.next();!l.done;l=o.next()){var c=l.value;if(c!=null){var u=c.getRowNumber();if(u>=s.length)continue;s[u]++}}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(r){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),s=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.getCodewords(),u=-1,d=o;d<l;d++)if(c[d]!=null){var f=c[d];f.setRowNumberAsRowIndicatorColumn();var A=f.getRowNumber()-u;A===0||(A===1?u=f.getRowNumber():f.getRowNumber()>=r.getRowCount()?c[d]=null:u=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var r,n,a=this.getCodewords(),s=new nb,o=new nb,l=new nb,c=new nb;try{for(var u=W5(a),d=u.next();!d.done;d=u.next()){var f=d.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var A=f.getValue()%30,h=f.getRowNumber();switch(this._isLeft||(h+=2),h%3){case 0:o.setValue(A*3+1);break;case 1:c.setValue(A/3),l.setValue(A%3);break;case 2:s.setValue(A+1);break}}}}catch(p){r={error:p}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}if(s.getValue().length===0||o.getValue().length===0||l.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<_a.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>_a.MAX_ROWS_IN_BARCODE)return null;var m=new z7e(s.getValue()[0],o.getValue()[0],l.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(a,m),m},e.prototype.removeIncorrectCodewords=function(r,n){for(var a=0;a<r.length;a++){var s=r[a];if(r[a]!=null){var o=s.getValue()%30,l=s.getRowNumber();if(l>n.getRowCount()){r[a]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(r[a]=null);break;case 2:o+1!==n.getColumnCount()&&(r[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+t.prototype.toString.call(this)},e}(Ose),Z7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},e9e=function(){function t(e,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return t.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=_a.MAX_CODEWORDS_IN_BARCODE,r;do r=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<r);return this.detectionResultColumns},t.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},t.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var r=1;r<this.barcodeColumnCount+1;r++)for(var n=this.detectionResultColumns[r].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n));return e},t.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},t.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&r[n]!=null&&e[n].getRowNumber()===r[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var s=this.detectionResultColumns[a].getCodewords()[n];s!=null&&(s.setRowNumber(e[n].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},t.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=this.barcodeColumnCount+1;o>0&&s<this.ADJUST_ROW_NUMBER_SKIP;o--){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,r=this.detectionResultColumns[0].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=1;o<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;o++){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.adjustRowNumberIfValid=function(e,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),r=0):++r),r},t.prototype.adjustRowNumbers=function(e,r,n){var a,s;if(this.detectionResultColumns[e-1]!=null){var o=n[r],l=this.detectionResultColumns[e-1].getCodewords(),c=l;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var u=new Array(14);u[2]=l[r],u[3]=c[r],r>0&&(u[0]=n[r-1],u[4]=l[r-1],u[5]=c[r-1]),r>1&&(u[8]=n[r-2],u[10]=l[r-2],u[11]=c[r-2]),r<n.length-1&&(u[1]=n[r+1],u[6]=l[r+1],u[7]=c[r+1]),r<n.length-2&&(u[9]=n[r+2],u[12]=l[r+2],u[13]=c[r+2]);try{for(var d=Z7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;if(t.adjustRowNumber(o,A))return}}catch(h){a={error:h}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}}},t.adjustRowNumber=function(e,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===e.getBucket()?(e.setRowNumber(r.getRowNumber()),!0):!1},t.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},t.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},t.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},t.prototype.setBoundingBox=function(e){this.boundingBox=e},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.setDetectionResultColumn=function(e,r){this.detectionResultColumns[e]=r},t.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},t.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var r=new $R,n=0;n<e.getCodewords().length;n++){r.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}var s=this.detectionResultColumns[a].getCodewords()[n];if(s==null){r.format("    |   ");continue}r.format(" %3d|%3d",s.getRowNumber(),s.getValue())}r.format("%n")}return r.toString()},t}(),t9e=function(){function t(e,r,n,a){this.rowNumber=t.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return t.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},t.prototype.isValidRowNumber=function(e){return e!==t.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},t.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},t.prototype.getWidth=function(){return this.endX-this.startX},t.prototype.getStartX=function(){return this.startX},t.prototype.getEndX=function(){return this.endX},t.prototype.getBucket=function(){return this.bucket},t.prototype.getValue=function(){return this.value},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.setRowNumber=function(e){this.rowNumber=e},t.prototype.toString=function(){return this.rowNumber+"|"+this.value},t.BARCODE_ROW_UNKNOWN=-1,t}(),r9e=function(){function t(){}return t.initialize=function(){for(var e=0;e<_a.SYMBOL_TABLE.length;e++)for(var r=_a.SYMBOL_TABLE[e],n=r&1,a=0;a<_a.BARS_IN_MODULE;a++){for(var s=0;(r&1)===n;)s+=1,r>>=1;n=r&1,t.RATIOS_TABLE[e]||(t.RATIOS_TABLE[e]=new Array(_a.BARS_IN_MODULE)),t.RATIOS_TABLE[e][_a.BARS_IN_MODULE-a-1]=Math.fround(s/_a.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},t.getDecodedValue=function(e){var r=t.getDecodedCodewordValue(t.sampleBitCounts(e));return r!==-1?r:t.getClosestDecodedValue(e)},t.sampleBitCounts=function(e){for(var r=Ta.sum(e),n=new Int32Array(_a.BARS_IN_MODULE),a=0,s=0,o=0;o<_a.MODULES_IN_CODEWORD;o++){var l=r/(2*_a.MODULES_IN_CODEWORD)+o*r/_a.MODULES_IN_CODEWORD;s+e[a]<=l&&(s+=e[a],a++),n[a]++}return n},t.getDecodedCodewordValue=function(e){var r=t.getBitValue(e);return _a.getCodeword(r)===-1?-1:r},t.getBitValue=function(e){for(var r=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)},t.getClosestDecodedValue=function(e){var r=Ta.sum(e),n=new Array(_a.BARS_IN_MODULE);if(r>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/r);var s=hF.MAX_VALUE,o=-1;this.bSymbolTableReady||t.initialize();for(var l=0;l<t.RATIOS_TABLE.length;l++){for(var c=0,u=t.RATIOS_TABLE[l],d=0;d<_a.BARS_IN_MODULE;d++){var f=Math.fround(u[d]-n[d]);if(c+=Math.fround(f*f),c>=s)break}c<s&&(s=c,o=_a.SYMBOL_TABLE[l])}return o},t.bSymbolTableReady=!1,t.RATIOS_TABLE=new Array(_a.SYMBOL_TABLE.length).map(function(e){return new Array(_a.BARS_IN_MODULE)}),t}(),n9e=function(){function t(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return t.prototype.getSegmentIndex=function(){return this.segmentIndex},t.prototype.setSegmentIndex=function(e){this.segmentIndex=e},t.prototype.getFileId=function(){return this.fileId},t.prototype.setFileId=function(e){this.fileId=e},t.prototype.getOptionalData=function(){return this.optionalData},t.prototype.setOptionalData=function(e){this.optionalData=e},t.prototype.isLastSegment=function(){return this.lastSegment},t.prototype.setLastSegment=function(e){this.lastSegment=e},t.prototype.getSegmentCount=function(){return this.segmentCount},t.prototype.setSegmentCount=function(e){this.segmentCount=e},t.prototype.getSender=function(){return this.sender||null},t.prototype.setSender=function(e){this.sender=e},t.prototype.getAddressee=function(){return this.addressee||null},t.prototype.setAddressee=function(e){this.addressee=e},t.prototype.getFileName=function(){return this.fileName},t.prototype.setFileName=function(e){this.fileName=e},t.prototype.getFileSize=function(){return this.fileSize},t.prototype.setFileSize=function(e){this.fileSize=e},t.prototype.getChecksum=function(){return this.checksum},t.prototype.setChecksum=function(e){this.checksum=e},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(e){this.timestamp=e},t}(),Y$=function(){function t(){}return t.parseLong=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t}(),a9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),s9e=function(t){a9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="NullPointerException",e}(du),i9e=function(){function t(){}return t.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},t.prototype.writeBytesOffset=function(e,r,n){if(e==null)throw new s9e;if(r<0||r>e.length||n<0||r+n>e.length||r+n<0)throw new UR;if(n===0)return;for(var a=0;a<n;a++)this.write(e[r+a])},t.prototype.flush=function(){},t.prototype.close=function(){},t}(),o9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),l9e=function(t){o9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(du),c9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),u9e=function(t){c9e(e,t);function e(r){r===void 0&&(r=32);var n=t.call(this)||this;if(n.count=0,r<0)throw new Pn("Negative initial size: "+r);return n.buf=new Uint8Array(r),n}return e.prototype.ensureCapacity=function(r){r-this.buf.length>0&&this.grow(r)},e.prototype.grow=function(r){var n=this.buf.length,a=n<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new l9e;a=sa.MAX_VALUE}this.buf=Bo.copyOfUint8Array(this.buf,a)},e.prototype.write=function(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1},e.prototype.writeBytesOffset=function(r,n,a){if(n<0||n>r.length||a<0||n+a-r.length>0)throw new UR;this.ensureCapacity(this.count+a),Cs.arraycopy(r,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(r){r.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return Bo.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(r){return new String(this.buf).toString()},e.prototype.toString_number=function(r){return new String(this.buf).toString()},e.prototype.close=function(){},e}(i9e),os;(function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(os||(os={}));function Dse(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var u_;function T0(t){if(typeof u_>"u"&&(u_=Dse()),u_===null)throw new Error("BigInt is not supported!");return u_(t)}function d9e(){var t=[];t[0]=T0(1);var e=T0(900);t[1]=e;for(var r=2;r<16;r++)t[r]=t[r-1]*e;return t}var f9e=function(){function t(){}return t.decode=function(e,r){var n=new ta(""),a=Po.ISO8859_1;n.enableDecoding(a);for(var s=1,o=e[s++],l=new n9e;s<e[0];){switch(o){case t.TEXT_COMPACTION_MODE_LATCH:s=t.textCompaction(e,s,n);break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:s=t.byteCompaction(o,e,a,s,n);break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s++]);break;case t.NUMERIC_COMPACTION_MODE_LATCH:s=t.numericCompaction(e,s,n);break;case t.ECI_CHARSET:Po.getCharacterSetECIByValue(e[s++]);break;case t.ECI_GENERAL_PURPOSE:s+=2;break;case t.ECI_USER_DEFINED:s++;break;case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=t.decodeMacroBlock(e,s,l);break;case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:throw new Kr;default:s--,s=t.textCompaction(e,s,n);break}if(s<e.length)o=e[s++];else throw Kr.getFormatInstance()}if(n.length()===0)throw Kr.getFormatInstance();var c=new yP(null,n.toString(),null,r);return c.setOther(l),c},t.decodeMacroBlock=function(e,r,n){if(r+t.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw Kr.getFormatInstance();for(var a=new Int32Array(t.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<t.NUMBER_OF_SEQUENCE_CODEWORDS;s++,r++)a[s]=e[r];n.setSegmentIndex(sa.parseInt(t.decodeBase900toBase10(a,t.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new ta;r=t.textCompaction(e,r,o),n.setFileId(o.toString());var l=-1;for(e[r]===t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=r+1);r<e[0];)switch(e[r]){case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,e[r]){case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new ta;r=t.textCompaction(e,r+1,c),n.setFileName(c.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var u=new ta;r=t.textCompaction(e,r+1,u),n.setSender(u.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var d=new ta;r=t.textCompaction(e,r+1,d),n.setAddressee(d.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new ta;r=t.numericCompaction(e,r+1,f),n.setSegmentCount(sa.parseInt(f.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var A=new ta;r=t.numericCompaction(e,r+1,A),n.setTimestamp(Y$.parseLong(A.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var h=new ta;r=t.numericCompaction(e,r+1,h),n.setChecksum(sa.parseInt(h.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var m=new ta;r=t.numericCompaction(e,r+1,m),n.setFileSize(Y$.parseLong(m.toString()));break;default:throw Kr.getFormatInstance()}break;case t.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw Kr.getFormatInstance()}if(l!==-1){var p=r-l;n.isLastSegment()&&p--,n.setOptionalData(Bo.copyOfRange(e,l,l+p))}return r},t.textCompaction=function(e,r,n){for(var a=new Int32Array((e[0]-r)*2),s=new Int32Array((e[0]-r)*2),o=0,l=!1;r<e[0]&&!l;){var c=e[r++];if(c<t.TEXT_COMPACTION_MODE_LATCH)a[o]=c/30,a[o+1]=c%30,o+=2;else switch(c){case t.TEXT_COMPACTION_MODE_LATCH:a[o++]=t.TEXT_COMPACTION_MODE_LATCH;break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,l=!0;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[r++],s[o]=c,o++;break}}return t.decodeTextCompaction(a,s,o,n),r},t.decodeTextCompaction=function(e,r,n,a){for(var s=os.ALPHA,o=os.ALPHA,l=0;l<n;){var c=e[l],u="";switch(s){case os.ALPHA:if(c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.LL:s=os.LOWER;break;case t.ML:s=os.MIXED;break;case t.PS:o=s,s=os.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=os.ALPHA;break}break;case os.LOWER:if(c<26)u=String.fromCharCode(97+c);else switch(c){case 26:u=" ";break;case t.AS:o=s,s=os.ALPHA_SHIFT;break;case t.ML:s=os.MIXED;break;case t.PS:o=s,s=os.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=os.ALPHA;break}break;case os.MIXED:if(c<t.PL)u=t.MIXED_CHARS[c];else switch(c){case t.PL:s=os.PUNCT;break;case 26:u=" ";break;case t.LL:s=os.LOWER;break;case t.AL:s=os.ALPHA;break;case t.PS:o=s,s=os.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=os.ALPHA;break}break;case os.PUNCT:if(c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=os.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=os.ALPHA;break}break;case os.ALPHA_SHIFT:if(s=o,c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.TEXT_COMPACTION_MODE_LATCH:s=os.ALPHA;break}break;case os.PUNCT_SHIFT:if(s=o,c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=os.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=os.ALPHA;break}break}u!==""&&a.append(u),l++}},t.byteCompaction=function(e,r,n,a,s){var o=new u9e,l=0,c=0,u=!1;switch(e){case t.BYTE_COMPACTION_MODE_LATCH:for(var d=new Int32Array(6),f=r[a++];a<r[0]&&!u;)switch(d[l++]=f,c=900*c+f,f=r[a++],f){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break;default:if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(T0(c)>>T0(8*(5-A))));c=0,l=0}break}a===r[0]&&f<t.TEXT_COMPACTION_MODE_LATCH&&(d[l++]=f);for(var h=0;h<l;h++)o.write(d[h]);break;case t.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!u;){var m=r[a++];if(m<t.TEXT_COMPACTION_MODE_LATCH)l++,c=900*c+m;else switch(m){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break}if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(T0(c)>>T0(8*(5-A))));c=0,l=0}}break}return s.append(Bd.decode(o.toByteArray(),n)),a},t.numericCompaction=function(e,r,n){for(var a=0,s=!1,o=new Int32Array(t.MAX_NUMERIC_CODEWORDS);r<e[0]&&!s;){var l=e[r++];if(r===e[0]&&(s=!0),l<t.TEXT_COMPACTION_MODE_LATCH)o[a]=l,a++;else switch(l){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,s=!0;break}(a%t.MAX_NUMERIC_CODEWORDS===0||l===t.NUMERIC_COMPACTION_MODE_LATCH||s)&&a>0&&(n.append(t.decodeBase900toBase10(o,a)),a=0)}return r},t.decodeBase900toBase10=function(e,r){for(var n=T0(0),a=0;a<r;a++)n+=t.EXP900[r-a-1]*T0(e[a]);var s=n.toString();if(s.charAt(0)!=="1")throw new Kr;return s.substring(1)},t.TEXT_COMPACTION_MODE_LATCH=900,t.BYTE_COMPACTION_MODE_LATCH=901,t.NUMERIC_COMPACTION_MODE_LATCH=902,t.BYTE_COMPACTION_MODE_LATCH_6=924,t.ECI_USER_DEFINED=925,t.ECI_GENERAL_PURPOSE=926,t.ECI_CHARSET=927,t.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,t.MACRO_PDF417_TERMINATOR=922,t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,t.MAX_NUMERIC_CODEWORDS=15,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,t.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,t.PL=25,t.LL=27,t.AS=27,t.ML=28,t.AL=28,t.PS=29,t.PAL=29,t.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,t.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",t.EXP900=Dse()?d9e():[],t.NUMBER_OF_SEQUENCE_CODEWORDS=2,t}(),_y=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},h9e=function(){function t(){}return t.decode=function(e,r,n,a,s,o,l){for(var c=new pF(e,r,n,a,s),u=null,d=null,f,A=!0;;A=!1){if(r!=null&&(u=t.getRowIndicatorColumn(e,c,r,!0,o,l)),a!=null&&(d=t.getRowIndicatorColumn(e,c,a,!1,o,l)),f=t.merge(u,d),f==null)throw lr.getNotFoundInstance();var h=f.getBoundingBox();if(A&&h!=null&&(h.getMinY()<c.getMinY()||h.getMaxY()>c.getMaxY()))c=h;else break}f.setBoundingBox(c);var m=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,u),f.setDetectionResultColumn(m,d);for(var p=u!=null,x=1;x<=m;x++){var v=p?x:m-x;if(f.getDetectionResultColumn(v)===void 0){var y=void 0;v===0||v===m?y=new X$(c,v===0):y=new Ose(c),f.setDetectionResultColumn(v,y);for(var b=-1,w=b,I=c.getMinY();I<=c.getMaxY();I++){if(b=t.getStartColumn(f,v,I,p),b<0||b>c.getMaxX()){if(w===-1)continue;b=w}var j=t.detectCodeword(e,c.getMinX(),c.getMaxX(),p,b,I,o,l);j!=null&&(y.setCodeword(I,j),w=b,o=Math.min(o,j.getWidth()),l=Math.max(l,j.getWidth()))}}}return t.createDecoderResult(f)},t.merge=function(e,r){if(e==null&&r==null)return null;var n=t.getBarcodeMetadata(e,r);if(n==null)return null;var a=pF.merge(t.adjustBoundingBox(e),t.adjustBoundingBox(r));return new e9e(n,a)},t.adjustBoundingBox=function(e){var r,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var s=t.getMax(a),o=0;try{for(var l=_y(a),c=l.next();!c.done;c=l.next()){var u=c.value;if(o+=s-u,u>0)break}}catch(h){r={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}for(var d=e.getCodewords(),f=0;o>0&&d[f]==null;f++)o--;for(var A=0,f=a.length-1;f>=0&&(A+=s-a[f],!(a[f]>0));f--);for(var f=d.length-1;A>0&&d[f]==null;f--)A--;return e.getBoundingBox().addMissingRows(o,A,e.isLeft())},t.getMax=function(e){var r,n,a=-1;try{for(var s=_y(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=Math.max(a,l)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.getBarcodeMetadata=function(e,r){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();var a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},t.getRowIndicatorColumn=function(e,r,n,a,s,o){for(var l=new X$(r,a),c=0;c<2;c++)for(var u=c===0?1:-1,d=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=r.getMaxY()&&f>=r.getMinY();f+=u){var A=t.detectCodeword(e,0,e.getWidth(),a,d,f,s,o);A!=null&&(l.setCodeword(f,A),a?d=A.getStartX():d=A.getEndX())}return l},t.adjustCodewordCount=function(e,r){var n=r[0][1],a=n.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-t.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(s<1||s>_a.MAX_CODEWORDS_IN_BARCODE)throw lr.getNotFoundInstance();n.setValue(s)}else a[0]!==s&&n.setValue(s)},t.createDecoderResult=function(e){var r=t.createBarcodeMatrix(e);t.adjustCodewordCount(e,r);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],o=new Array,l=0;l<e.getBarcodeRowCount();l++)for(var c=0;c<e.getBarcodeColumnCount();c++){var u=r[l][c+1].getValue(),d=l*e.getBarcodeColumnCount()+c;u.length===0?n.push(d):u.length===1?a[d]=u[0]:(o.push(d),s.push(u))}for(var f=new Array(s.length),A=0;A<f.length;A++)f[A]=s[A];return t.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,_a.toIntArray(n),_a.toIntArray(o),f)},t.createDecoderResultFromAmbiguousValues=function(e,r,n,a,s){for(var o=new Int32Array(a.length),l=100;l-- >0;){for(var c=0;c<o.length;c++)r[a[c]]=s[c][o[c]];try{return t.decodeCodewords(r,e,n)}catch(d){var u=d instanceof co;if(!u)throw d}if(o.length===0)throw co.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<s[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw co.getChecksumInstance()}throw co.getChecksumInstance()},t.createBarcodeMatrix=function(e){for(var r,n,a,s,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]=new nb;var u=0;try{for(var d=_y(e.getDetectionResultColumns()),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)try{for(var h=(a=void 0,_y(A.getCodewords())),m=h.next();!m.done;m=h.next()){var p=m.value;if(p!=null){var x=p.getRowNumber();if(x>=0){if(x>=o.length)continue;o[x][u].setValue(p.getValue())}}}}catch(v){a={error:v}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}u++}}catch(v){r={error:v}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return o},t.isValidBarcodeColumn=function(e,r){return r>=0&&r<=e.getBarcodeColumnCount()+1},t.getStartColumn=function(e,r,n,a){var s,o,l=a?1:-1,c=null;if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodeword(n)),c!=null)return a?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(r).getCodewordNearby(n),c!=null)return a?c.getStartX():c.getEndX();if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodewordNearby(n)),c!=null)return a?c.getEndX():c.getStartX();for(var u=0;t.isValidBarcodeColumn(e,r-l);){r-=l;try{for(var d=(s=void 0,_y(e.getDetectionResultColumn(r).getCodewords())),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)return(a?A.getEndX():A.getStartX())+l*u*(A.getEndX()-A.getStartX())}}catch(h){s={error:h}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(s)throw s.error}}u++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},t.detectCodeword=function(e,r,n,a,s,o,l,c){s=t.adjustCodewordStartColumn(e,r,n,a,s,o);var u=t.getModuleBitCount(e,r,n,a,s,o);if(u==null)return null;var d,f=Ta.sum(u);if(a)d=s+f;else{for(var A=0;A<u.length/2;A++){var h=u[A];u[A]=u[u.length-1-A],u[u.length-1-A]=h}d=s,s=d-f}if(!t.checkCodewordSkew(f,l,c))return null;var m=r9e.getDecodedValue(u),p=_a.getCodeword(m);return p===-1?null:new t9e(s,d,t.getCodewordBucketNumber(m),p)},t.getModuleBitCount=function(e,r,n,a,s,o){for(var l=s,c=new Int32Array(8),u=0,d=a?1:-1,f=a;(a?l<n:l>=r)&&u<c.length;)e.get(l,o)===f?(c[u]++,l+=d):(u++,f=!f);return u===c.length||l===(a?n:r)&&u===c.length-1?c:null},t.getNumberOfECCodeWords=function(e){return 2<<e},t.adjustCodewordStartColumn=function(e,r,n,a,s,o){for(var l=s,c=a?-1:1,u=0;u<2;u++){for(;(a?l>=r:l<n)&&a===e.get(l,o);){if(Math.abs(s-l)>t.CODEWORD_SKEW_SIZE)return s;l+=c}c=-c,a=!a}return l},t.checkCodewordSkew=function(e,r,n){return r-t.CODEWORD_SKEW_SIZE<=e&&e<=n+t.CODEWORD_SKEW_SIZE},t.decodeCodewords=function(e,r,n){if(e.length===0)throw Kr.getFormatInstance();var a=1<<r+1,s=t.correctErrors(e,n,a);t.verifyCodewordCount(e,a);var o=f9e.decode(e,""+r);return o.setErrorsCorrected(s),o.setErasures(n.length),o},t.correctErrors=function(e,r,n){if(r!=null&&r.length>n/2+t.MAX_ERRORS||n<0||n>t.MAX_EC_CODEWORDS)throw co.getChecksumInstance();return t.errorCorrection.decode(e,n,r)},t.verifyCodewordCount=function(e,r){if(e.length<4)throw Kr.getFormatInstance();var n=e[0];if(n>e.length)throw Kr.getFormatInstance();if(n===0)if(r<e.length)e[0]=e.length-r;else throw Kr.getFormatInstance()},t.getBitCountForCodeword=function(e){for(var r=new Int32Array(8),n=0,a=r.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)r[a]++,e>>=1;return r},t.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},t.getCodewordBucketNumber_number=function(e){return t.getCodewordBucketNumber(t.getBitCountForCodeword(e))},t.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},t.toString=function(e){for(var r=new $R,n=0;n<e.length;n++){r.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var s=e[n][a];s.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}r.format("%n")}return r.toString()},t.CODEWORD_SKEW_SIZE=2,t.MAX_ERRORS=3,t.MAX_EC_CODEWORDS=512,t.errorCorrection=new q7e,t}(),A9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ij=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=t.decode(e,r,!1);if(n==null||n.length===0||n[0]==null)throw lr.getNotFoundInstance();return n[0]},t.prototype.decodeMultiple=function(e,r){r===void 0&&(r=null);try{return t.decode(e,r,!0)}catch(n){throw n instanceof Kr||n instanceof co?lr.getNotFoundInstance():n}},t.decode=function(e,r,n){var a,s,o=new Array,l=Q7e.detectMultiple(e,r,n);try{for(var c=A9e(l.getPoints()),u=c.next();!u.done;u=c.next()){var d=u.value,f=h9e.decode(l.getBits(),d[4],d[5],d[6],d[7],t.getMinCodewordWidth(d),t.getMaxCodewordWidth(d)),A=new hc(f.getText(),f.getRawBytes(),void 0,d,In.PDF_417);A.putMetadata(Tl.ERROR_CORRECTION_LEVEL,f.getECLevel());var h=f.getOther();h!=null&&A.putMetadata(Tl.PDF417_EXTRA_METADATA,h),o.push(A)}}catch(m){a={error:m}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return o.map(function(m){return m})},t.getMaxWidth=function(e,r){return e==null||r==null?0:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMinWidth=function(e,r){return e==null||r==null?sa.MAX_VALUE:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(t.getMaxWidth(e[0],e[4]),t.getMaxWidth(e[6],e[2])*_a.MODULES_IN_CODEWORD/_a.MODULES_IN_STOP_PATTERN),Math.max(t.getMaxWidth(e[1],e[5]),t.getMaxWidth(e[7],e[3])*_a.MODULES_IN_CODEWORD/_a.MODULES_IN_STOP_PATTERN)))},t.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(t.getMinWidth(e[0],e[4]),t.getMinWidth(e[6],e[2])*_a.MODULES_IN_CODEWORD/_a.MODULES_IN_STOP_PATTERN),Math.min(t.getMinWidth(e[1],e[5]),t.getMinWidth(e[7],e[3])*_a.MODULES_IN_CODEWORD/_a.MODULES_IN_STOP_PATTERN)))},t.prototype.reset=function(){},t}(),m9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),J$=function(t){m9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReaderException",e}(du),Z$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Rse=function(){function t(){}return t.prototype.decode=function(e,r){return this.setHints(r),this.decodeInternal(e)},t.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},t.prototype.setHints=function(e){this.hints=e;var r=e!=null&&e.get(_s.TRY_HARDER)!==void 0,n=e==null?null:e.get(_s.POSSIBLE_FORMATS),a=new Array;if(n!=null){var s=n.some(function(o){return o===In.UPC_A||o===In.UPC_E||o===In.EAN_13||o===In.EAN_8||o===In.CODABAR||o===In.CODE_39||o===In.CODE_93||o===In.CODE_128||o===In.ITF||o===In.RSS_14||o===In.RSS_EXPANDED});s&&!r&&a.push(new Zx(e)),n.includes(In.QR_CODE)&&a.push(new sj),n.includes(In.DATA_MATRIX)&&a.push(new aj),n.includes(In.AZTEC)&&a.push(new rj),n.includes(In.PDF_417)&&a.push(new ij),s&&r&&a.push(new Zx(e))}a.length===0&&(r||a.push(new Zx(e)),a.push(new sj),a.push(new aj),a.push(new rj),a.push(new ij),r&&a.push(new Zx(e))),this.readers=a},t.prototype.reset=function(){var e,r;if(this.readers!==null)try{for(var n=Z$(this.readers),a=n.next();!a.done;a=n.next()){var s=a.value;s.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.decodeInternal=function(e){var r,n;if(this.readers===null)throw new J$("No readers where selected, nothing can be read.");try{for(var a=Z$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;try{return o.decode(e,this.hints)}catch(l){if(l instanceof J$)continue}}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new lr("No MultiFormat Readers were able to detect the code.")},t}(),p9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){p9e(e,t);function e(r,n){r===void 0&&(r=null),n===void 0&&(n=500);var a=this,s=new Rse;return s.setHints(r),a=t.call(this,s,n)||this,a}return e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e})(S1);var g9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){g9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new ij,r)||this}return e})(S1);var x9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){x9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new sj,r)||this}return e})(S1);var gF;(function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",t[t.MIN_SIZE=4]="MIN_SIZE",t[t.MAX_SIZE=5]="MAX_SIZE",t[t.MARGIN=6]="MARGIN",t[t.PDF417_COMPACT=7]="PDF417_COMPACT",t[t.PDF417_COMPACTION=8]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=10]="AZTEC_LAYERS",t[t.QR_VERSION=11]="QR_VERSION",t[t.GS1_FORMAT=12]="GS1_FORMAT",t[t.FORCE_C40=13]="FORCE_C40"})(gF||(gF={}));const d_=gF;var Mse=function(){function t(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new pm(e,Int32Array.from([1])))}return t.prototype.buildGenerator=function(e){var r=this.cachedGenerators;if(e>=r.length)for(var n=r[r.length-1],a=this.field,s=r.length;s<=e;s++){var o=n.multiply(new pm(a,Int32Array.from([1,a.exp(s-1+a.getGeneratorBase())])));r.push(o),n=o}return r[e]},t.prototype.encode=function(e,r){if(r===0)throw new Pn("No error correction bytes");var n=e.length-r;if(n<=0)throw new Pn("No data bytes provided");var a=this.buildGenerator(r),s=new Int32Array(n);Cs.arraycopy(e,0,s,0,n);var o=new pm(this.field,s);o=o.multiplyByMonomial(r,1);for(var l=o.divide(a)[1],c=l.getCoefficients(),u=r-c.length,d=0;d<u;d++)e[n+d]=0;Cs.arraycopy(c,0,e,n+u,c.length)},t}(),ab=function(){function t(){}return t.applyMaskPenaltyRule1=function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)},t.applyMaskPenaltyRule2=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s-1;o++)for(var l=n[o],c=0;c<a-1;c++){var u=l[c];u===l[c+1]&&u===n[o+1][c]&&u===n[o+1][c+1]&&r++}return t.N2*r},t.applyMaskPenaltyRule3=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=0;l<a;l++){var c=n[o];l+6<a&&c[l]===1&&c[l+1]===0&&c[l+2]===1&&c[l+3]===1&&c[l+4]===1&&c[l+5]===0&&c[l+6]===1&&(t.isWhiteHorizontal(c,l-4,l)||t.isWhiteHorizontal(c,l+7,l+11))&&r++,o+6<s&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(t.isWhiteVertical(n,l,o-4,o)||t.isWhiteVertical(n,l,o+7,o+11))&&r++}return r*t.N3},t.isWhiteHorizontal=function(e,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(var a=r;a<n;a++)if(e[a]===1)return!1;return!0},t.isWhiteVertical=function(e,r,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var s=n;s<a;s++)if(e[s][r]===1)return!1;return!0},t.applyMaskPenaltyRule4=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=n[o],c=0;c<a;c++)l[c]===1&&r++;var u=e.getHeight()*e.getWidth(),d=Math.floor(Math.abs(r*2-u)*10/u);return d*t.N4},t.getDataMaskBit=function(e,r,n){var a,s;switch(e){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:s=n*r,a=(s&1)+s%3;break;case 6:s=n*r,a=(s&1)+s%3&1;break;case 7:s=n*r,a=s%3+(n+r&1)&1;break;default:throw new Pn("Invalid mask pattern: "+e)}return a===0},t.applyMaskPenaltyRule1Internal=function(e,r){for(var n=0,a=r?e.getHeight():e.getWidth(),s=r?e.getWidth():e.getHeight(),o=e.getArray(),l=0;l<a;l++){for(var c=0,u=-1,d=0;d<s;d++){var f=r?o[l][d]:o[d][l];f===u?c++:(c>=5&&(n+=t.N1+(c-5)),c=1,u=f)}c>=5&&(n+=t.N1+(c-5))}return n},t.N1=3,t.N2=3,t.N3=40,t.N4=10,t}(),v9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},y9e=function(){function t(e,r){this.width=e,this.height=r;for(var n=new Array(r),a=0;a!==r;a++)n[a]=new Uint8Array(e);this.bytes=n}return t.prototype.getHeight=function(){return this.height},t.prototype.getWidth=function(){return this.width},t.prototype.get=function(e,r){return this.bytes[r][e]},t.prototype.getArray=function(){return this.bytes},t.prototype.setNumber=function(e,r,n){this.bytes[r][e]=n},t.prototype.setBoolean=function(e,r,n){this.bytes[r][e]=n?1:0},t.prototype.clear=function(e){var r,n;try{for(var a=v9e(this.bytes),s=a.next();!s.done;s=a.next()){var o=s.value;Bo.fill(o,e)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;if(this.width!==r.width||this.height!==r.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var s=this.bytes[n],o=r.bytes[n],l=0,c=this.width;l<c;++l)if(s[l]!==o[l])return!1;return!0},t.prototype.toString=function(){for(var e=new ta,r=0,n=this.height;r<n;++r){for(var a=this.bytes[r],s=0,o=this.width;s<o;++s)switch(a[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},t}(),xF=function(){function t(){this.maskPattern=-1}return t.prototype.getMode=function(){return this.mode},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getVersion=function(){return this.version},t.prototype.getMaskPattern=function(){return this.maskPattern},t.prototype.getMatrix=function(){return this.matrix},t.prototype.toString=function(){var e=new ta;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},t.prototype.setMode=function(e){this.mode=e},t.prototype.setECLevel=function(e){this.ecLevel=e},t.prototype.setVersion=function(e){this.version=e},t.prototype.setMaskPattern=function(e){this.maskPattern=e},t.prototype.setMatrix=function(e){this.matrix=e},t.isValidMaskPattern=function(e){return e>=0&&e<t.NUM_MASK_PATTERNS},t.NUM_MASK_PATTERNS=8,t}(),b9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ps=function(t){b9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="WriterException",e}(du),eG=function(){function t(){}return t.clearMatrix=function(e){e.clear(255)},t.buildMatrix=function(e,r,n,a,s){t.clearMatrix(s),t.embedBasicPatterns(n,s),t.embedTypeInfo(r,a,s),t.maybeEmbedVersionInfo(n,s),t.embedDataBits(e,a,s)},t.embedBasicPatterns=function(e,r){t.embedPositionDetectionPatternsAndSeparators(r),t.embedDarkDotAtLeftBottomCorner(r),t.maybeEmbedPositionAdjustmentPatterns(e,r),t.embedTimingPatterns(r)},t.embedTypeInfo=function(e,r,n){var a=new tl;t.makeTypeInfoBits(e,r,a);for(var s=0,o=a.getSize();s<o;++s){var l=a.get(a.getSize()-1-s),c=t.TYPE_INFO_COORDINATES[s],u=c[0],d=c[1];if(n.setBoolean(u,d,l),s<8){var f=n.getWidth()-s-1,A=8;n.setBoolean(f,A,l)}else{var f=8,A=n.getHeight()-7+(s-8);n.setBoolean(f,A,l)}}},t.maybeEmbedVersionInfo=function(e,r){if(!(e.getVersionNumber()<7)){var n=new tl;t.makeVersionInfoBits(e,n);for(var a=6*3-1,s=0;s<6;++s)for(var o=0;o<3;++o){var l=n.get(a);a--,r.setBoolean(s,r.getHeight()-11+o,l),r.setBoolean(r.getHeight()-11+o,s,l)}}},t.embedDataBits=function(e,r,n){for(var a=0,s=-1,o=n.getWidth()-1,l=n.getHeight()-1;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(var c=0;c<2;++c){var u=o-c;if(t.isEmpty(n.get(u,l))){var d=void 0;a<e.getSize()?(d=e.get(a),++a):d=!1,r!==255&&ab.getDataMaskBit(r,u,l)&&(d=!d),n.setBoolean(u,l,d)}}l+=s}s=-s,l+=s,o-=2}if(a!==e.getSize())throw new Ps("Not all bits consumed: "+a+"/"+e.getSize())},t.findMSBSet=function(e){return 32-sa.numberOfLeadingZeros(e)},t.calculateBCHCode=function(e,r){if(r===0)throw new Pn("0 polynomial");var n=t.findMSBSet(r);for(e<<=n-1;t.findMSBSet(e)>=n;)e^=r<<t.findMSBSet(e)-n;return e},t.makeTypeInfoBits=function(e,r,n){if(!xF.isValidMaskPattern(r))throw new Ps("Invalid mask pattern");var a=e.getBits()<<3|r;n.appendBits(a,5);var s=t.calculateBCHCode(a,t.TYPE_INFO_POLY);n.appendBits(s,10);var o=new tl;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new Ps("should not happen but we got: "+n.getSize())},t.makeVersionInfoBits=function(e,r){r.appendBits(e.getVersionNumber(),6);var n=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new Ps("should not happen but we got: "+r.getSize())},t.isEmpty=function(e){return e===255},t.embedTimingPatterns=function(e){for(var r=8;r<e.getWidth()-8;++r){var n=(r+1)%2;t.isEmpty(e.get(r,6))&&e.setNumber(r,6,n),t.isEmpty(e.get(6,r))&&e.setNumber(6,r,n)}},t.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new Ps;e.setNumber(8,e.getHeight()-8,1)},t.embedHorizontalSeparationPattern=function(e,r,n){for(var a=0;a<8;++a){if(!t.isEmpty(n.get(e+a,r)))throw new Ps;n.setNumber(e+a,r,0)}},t.embedVerticalSeparationPattern=function(e,r,n){for(var a=0;a<7;++a){if(!t.isEmpty(n.get(e,r+a)))throw new Ps;n.setNumber(e,r+a,0)}},t.embedPositionAdjustmentPattern=function(e,r,n){for(var a=0;a<5;++a)for(var s=t.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPattern=function(e,r,n){for(var a=0;a<7;++a)for(var s=t.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPatternsAndSeparators=function(e){var r=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-r,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-r,e);var n=8;t.embedHorizontalSeparationPattern(0,n-1,e),t.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;t.embedVerticalSeparationPattern(a,0,e),t.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),t.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},t.maybeEmbedPositionAdjustmentPatterns=function(e,r){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],s=0,o=a.length;s!==o;s++){var l=a[s];if(l>=0)for(var c=0;c!==o;c++){var u=a[c];u>=0&&t.isEmpty(r.get(u,l))&&t.embedPositionAdjustmentPattern(u-2,l-2,r)}}},t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),t.VERSION_INFO_POLY=7973,t.TYPE_INFO_POLY=1335,t.TYPE_INFO_MASK_PATTERN=21522,t}(),w9e=function(){function t(e,r){this.dataBytes=e,this.errorCorrectionBytes=r}return t.prototype.getDataBytes=function(){return this.dataBytes},t.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},t}(),tG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.calculateMaskPenalty=function(e){return ab.applyMaskPenaltyRule1(e)+ab.applyMaskPenaltyRule2(e)+ab.applyMaskPenaltyRule3(e)+ab.applyMaskPenaltyRule4(e)},t.encode=function(e,r,n){n===void 0&&(n=null);var a=t.DEFAULT_BYTE_MODE_ENCODING,s=n!==null&&n.get(d_.CHARACTER_SET)!==void 0;s&&(a=n.get(d_.CHARACTER_SET).toString());var o=this.chooseMode(e,a),l=new tl;if(o===Ts.BYTE&&(s||t.DEFAULT_BYTE_MODE_ENCODING!==a)){var c=Po.getCharacterSetECIByName(a);c!==void 0&&this.appendECI(c,l)}this.appendModeInfo(o,l);var u=new tl;this.appendBytes(e,o,u,a);var d;if(n!==null&&n.get(d_.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(d_.QR_VERSION).toString(),10);d=Wp.getVersionForNumber(f);var A=this.calculateBitsNeeded(o,l,u,d);if(!this.willFit(A,d,r))throw new Ps("Data too big for requested version")}else d=this.recommendVersion(r,o,l,u);var h=new tl;h.appendBitArray(l);var m=o===Ts.BYTE?u.getSizeInBytes():e.length;this.appendLengthInfo(m,d,o,h),h.appendBitArray(u);var p=d.getECBlocksForLevel(r),x=d.getTotalCodewords()-p.getTotalECCodewords();this.terminateBits(x,h);var v=this.interleaveWithECBytes(h,d.getTotalCodewords(),x,p.getNumBlocks()),y=new xF;y.setECLevel(r),y.setMode(o),y.setVersion(d);var b=d.getDimensionForVersion(),w=new y9e(b,b),I=this.chooseMaskPattern(v,r,d,w);return y.setMaskPattern(I),eG.buildMatrix(v,r,d,I,w),y.setMatrix(w),y},t.recommendVersion=function(e,r,n,a){var s=this.calculateBitsNeeded(r,n,a,Wp.getVersionForNumber(1)),o=this.chooseVersion(s,e),l=this.calculateBitsNeeded(r,n,a,o);return this.chooseVersion(l,e)},t.calculateBitsNeeded=function(e,r,n,a){return r.getSize()+e.getCharacterCountBits(a)+n.getSize()},t.getAlphanumericCode=function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1},t.chooseMode=function(e,r){if(r===void 0&&(r=null),Po.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(e))return Ts.KANJI;for(var n=!1,a=!1,s=0,o=e.length;s<o;++s){var l=e.charAt(s);if(t.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)a=!0;else return Ts.BYTE}return a?Ts.ALPHANUMERIC:n?Ts.NUMERIC:Ts.BYTE},t.isOnlyDoubleByteKanji=function(e){var r;try{r=Bd.encode(e,Po.SJIS)}catch{return!1}var n=r.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var s=r[a]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},t.chooseMaskPattern=function(e,r,n,a){for(var s=Number.MAX_SAFE_INTEGER,o=-1,l=0;l<xF.NUM_MASK_PATTERNS;l++){eG.buildMatrix(e,r,n,l,a);var c=this.calculateMaskPenalty(a);c<s&&(s=c,o=l)}return o},t.chooseVersion=function(e,r){for(var n=1;n<=40;n++){var a=Wp.getVersionForNumber(n);if(t.willFit(e,a,r))return a}throw new Ps("Data too big")},t.willFit=function(e,r,n){var a=r.getTotalCodewords(),s=r.getECBlocksForLevel(n),o=s.getTotalECCodewords(),l=a-o,c=(e+7)/8;return l>=c},t.terminateBits=function(e,r){var n=e*8;if(r.getSize()>n)throw new Ps("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(var a=0;a<4&&r.getSize()<n;++a)r.appendBit(!1);var s=r.getSize()&7;if(s>0)for(var a=s;a<8;a++)r.appendBit(!1);for(var o=e-r.getSizeInBytes(),a=0;a<o;++a)r.appendBits(a&1?17:236,8);if(r.getSize()!==n)throw new Ps("Bits size does not equal capacity")},t.getNumDataBytesAndNumECBytesForBlockID=function(e,r,n,a,s,o){if(a>=n)throw new Ps("Block ID too large");var l=e%n,c=n-l,u=Math.floor(e/n),d=u+1,f=Math.floor(r/n),A=f+1,h=u-f,m=d-A;if(h!==m)throw new Ps("EC bytes mismatch");if(n!==c+l)throw new Ps("RS blocks mismatch");if(e!==(f+h)*c+(A+m)*l)throw new Ps("Total bytes mismatch");a<c?(s[0]=f,o[0]=h):(s[0]=A,o[0]=m)},t.interleaveWithECBytes=function(e,r,n,a){var s,o,l,c;if(e.getSizeInBytes()!==n)throw new Ps("Number of bits and data bytes does not match");for(var u=0,d=0,f=0,A=new Array,h=0;h<a;++h){var m=new Int32Array(1),p=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(r,n,a,h,m,p);var x=m[0],v=new Uint8Array(x);e.toBytes(8*u,v,0,x);var y=t.generateECBytes(v,p[0]);A.push(new w9e(v,y)),d=Math.max(d,x),f=Math.max(f,y.length),u+=m[0]}if(n!==u)throw new Ps("Data bytes does not match offset");for(var b=new tl,h=0;h<d;++h)try{for(var w=(s=void 0,tG(A)),I=w.next();!I.done;I=w.next()){var j=I.value,v=j.getDataBytes();h<v.length&&b.appendBits(v[h],8)}}catch(B){s={error:B}}finally{try{I&&!I.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}for(var h=0;h<f;++h)try{for(var C=(l=void 0,tG(A)),S=C.next();!S.done;S=C.next()){var j=S.value,y=j.getErrorCorrectionBytes();h<y.length&&b.appendBits(y[h],8)}}catch(B){l={error:B}}finally{try{S&&!S.done&&(c=C.return)&&c.call(C)}finally{if(l)throw l.error}}if(r!==b.getSizeInBytes())throw new Ps("Interleaving error: "+r+" and "+b.getSizeInBytes()+" differ.");return b},t.generateECBytes=function(e,r){for(var n=e.length,a=new Int32Array(n+r),s=0;s<n;s++)a[s]=e[s]&255;new Mse(tu.QR_CODE_FIELD_256).encode(a,r);for(var o=new Uint8Array(r),s=0;s<r;s++)o[s]=a[n+s];return o},t.appendModeInfo=function(e,r){r.appendBits(e.getBits(),4)},t.appendLengthInfo=function(e,r,n,a){var s=n.getCharacterCountBits(r);if(e>=1<<s)throw new Ps(e+" is bigger than "+((1<<s)-1));a.appendBits(e,s)},t.appendBytes=function(e,r,n,a){switch(r){case Ts.NUMERIC:t.appendNumericBytes(e,n);break;case Ts.ALPHANUMERIC:t.appendAlphanumericBytes(e,n);break;case Ts.BYTE:t.append8BitBytes(e,n,a);break;case Ts.KANJI:t.appendKanjiBytes(e,n);break;default:throw new Ps("Invalid mode: "+r)}},t.getDigit=function(e){return e.charCodeAt(0)-48},t.isDigit=function(e){var r=t.getDigit(e);return r>=0&&r<=9},t.appendNumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getDigit(e.charAt(a));if(a+2<n){var o=t.getDigit(e.charAt(a+1)),l=t.getDigit(e.charAt(a+2));r.appendBits(s*100+o*10+l,10),a+=3}else if(a+1<n){var o=t.getDigit(e.charAt(a+1));r.appendBits(s*10+o,7),a+=2}else r.appendBits(s,4),a++}},t.appendAlphanumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getAlphanumericCode(e.charCodeAt(a));if(s===-1)throw new Ps;if(a+1<n){var o=t.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new Ps;r.appendBits(s*45+o,11),a+=2}else r.appendBits(s,6),a++}},t.append8BitBytes=function(e,r,n){var a;try{a=Bd.encode(e,n)}catch(c){throw new Ps(c)}for(var s=0,o=a.length;s!==o;s++){var l=a[s];r.appendBits(l,8)}},t.appendKanjiBytes=function(e,r){var n;try{n=Bd.encode(e,Po.SJIS)}catch(f){throw new Ps(f)}for(var a=n.length,s=0;s<a;s+=2){var o=n[s]&255,l=n[s+1]&255,c=o<<8&4294967295|l,u=-1;if(c>=33088&&c<=40956?u=c-33088:c>=57408&&c<=60351&&(u=c-49472),u===-1)throw new Ps("Invalid byte sequence");var d=(u>>8)*192+(u&255);r.appendBits(d,13)}},t.appendECI=function(e,r){r.appendBits(Ts.ECI.getBits(),4),r.appendBits(e.getValue(),8)},t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),t.DEFAULT_BYTE_MODE_ENCODING=Po.UTF8.getName(),t})();var N9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){N9e(e,t);function e(r,n,a,s,o,l,c,u){var d=t.call(this,l,c)||this;if(d.yuvData=r,d.dataWidth=n,d.dataHeight=a,d.left=s,d.top=o,s+l>n||o+c>a)throw new Pn("Crop rectangle does not fit within image data.");return u&&d.reverseHorizontal(l,c),d}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return Cs.arraycopy(this.yuvData,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return Cs.arraycopy(this.yuvData,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;Cs.arraycopy(this.yuvData,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+n,a,s,!1)},e.prototype.renderThumbnail=function(){for(var r=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*n),s=this.yuvData,o=this.top*this.dataWidth+this.left,l=0;l<n;l++){for(var c=l*r,u=0;u<r;u++){var d=s[o+u*e.THUMBNAIL_SCALE_FACTOR]&255;a[c+u]=4278190080|d*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(r,n){for(var a=this.yuvData,s=0,o=this.top*this.dataWidth+this.left;s<n;s++,o+=this.dataWidth)for(var l=o+r/2,c=o,u=o+r-1;c<l;c++,u--){var d=a[c];a[c]=a[u],a[u]=d}},e.prototype.invert=function(){return new vP(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(zw);var C9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){C9e(e,t);function e(r,n,a,s,o,l,c){var u=t.call(this,n,a)||this;if(u.dataWidth=s,u.dataHeight=o,u.left=l,u.top=c,r.BYTES_PER_ELEMENT===4){for(var d=n*a,f=new Uint8ClampedArray(d),A=0;A<d;A++){var h=r[A],m=h>>16&255,p=h>>7&510,x=h&255;f[A]=(m+p+x)/4&255}u.luminances=f}else u.luminances=r;if(s===void 0&&(u.dataWidth=n),o===void 0&&(u.dataHeight=a),l===void 0&&(u.left=0),c===void 0&&(u.top=0),u.left+n>u.dataWidth||u.top+a>u.dataHeight)throw new Pn("Crop rectangle does not fit within image data.");return u}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return Cs.arraycopy(this.luminances,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return Cs.arraycopy(this.luminances,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;Cs.arraycopy(this.luminances,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.luminances,a,s,this.dataWidth,this.dataHeight,this.left+r,this.top+n)},e.prototype.invert=function(){return new vP(this)},e})(zw);var _9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),E9e=function(t){_9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.forName=function(r){return this.getCharacterSetECIByName(r)},e}(Po),S9e=function(){function t(){}return t.ISO_8859_1=Po.ISO8859_1,t}(),vF,j9e=301,I9e=function(t,e){for(var r=1,n=0;n<255;n++)e[n]=r,t[r]=n,r*=2,r>=256&&(r^=j9e);return{LOG:t,ALOG:e}};vF=I9e([],[]),vF.LOG;vF.ALOG;var rG;(function(t){t[t.FORCE_NONE=0]="FORCE_NONE",t[t.FORCE_SQUARE=1]="FORCE_SQUARE",t[t.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(rG||(rG={}));var nG=129,Lse=230,P9e=231,T9e=235,B9e=236,k9e=237,F9e=238,O9e=239,D9e=240,X5=254,R9e=254,aG="[)>05",sG="[)>06",iG="",Ya=0,yl=1,bc=2,wo=3,zo=4,Yl=5,M9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Ya},t.prototype.encode=function(e){var r=df.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(r>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=df.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case Yl:e.writeCodeword(P9e),e.signalEncoderChange(Yl);return;case yl:e.writeCodeword(Lse),e.signalEncoderChange(yl);return;case wo:e.writeCodeword(F9e),e.signalEncoderChange(wo);break;case bc:e.writeCodeword(O9e),e.signalEncoderChange(bc);break;case zo:e.writeCodeword(D9e),e.signalEncoderChange(zo);break;default:throw new Error("Illegal mode: "+a)}else df.isExtendedASCII(n)?(e.writeCodeword(T9e),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},t.prototype.encodeASCIIDigits=function(e,r){if(df.isDigit(e)&&df.isDigit(r)){var n=(e-48)*10+(r-48);return n+130}throw new Error("not digits: "+e+r)},t}(),L9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Yl},t.prototype.encode=function(e){var r=new ta;for(r.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();r.append(n),e.pos++;var a=df.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(Ya);break}}var s=r.length()-1,o=1,l=e.getCodewordCount()+s+o;e.updateSymbolInfo(l);var c=e.getSymbolInfo().getDataCapacity()-l>0;if(e.hasMoreCharacters()||c)if(s<=249)r.setCharAt(0,Na.getCharAt(s));else if(s<=1555)r.setCharAt(0,Na.getCharAt(Math.floor(s/250)+249)),r.insert(1,Na.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var u=0,n=r.length();u<n;u++)e.writeCodeword(this.randomize255State(r.charAt(u).charCodeAt(0),e.getCodewordCount()+1))},t.prototype.randomize255State=function(e,r){var n=149*r%255+1,a=e+n;return a<=255?a:a-256},t}(),GR=function(){function t(){}return t.prototype.getEncodingMode=function(){return yl},t.prototype.encodeMaximal=function(e){for(var r=new ta,n=0,a=e.pos,s=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,r),r.length()%3===0&&(a=e.pos,s=r.length())}if(s!==r.length()){var l=Math.floor(r.length()/3*2),c=Math.floor(e.getCodewordCount()+l+1);e.updateSymbolInfo(c);var u=e.getSymbolInfo().getDataCapacity()-c,d=Math.floor(r.length()%3);(d===2&&u!==2||d===1&&(n>3||u!==1))&&(e.pos=a)}r.length()>0&&e.writeCodeword(Lse),this.handleEOD(e,r)},t.prototype.encode=function(e){for(var r=new ta;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,r),s=Math.floor(r.length()/3)*2,o=e.getCodewordCount()+s;e.updateSymbolInfo(o);var l=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var c=new ta;for(r.length()%3===2&&l!==2&&(a=this.backtrackOneCharacter(e,r,c,a));r.length()%3===1&&(a>3||l!==1);)a=this.backtrackOneCharacter(e,r,c,a);break}var u=r.length();if(u%3===0){var d=df.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(d!==this.getEncodingMode()){e.signalEncoderChange(Ya);break}}}this.handleEOD(e,r)},t.prototype.backtrackOneCharacter=function(e,r,n,a){var s=r.length(),o=r.toString().substring(0,s-a);r.setLengthToZero(),r.append(o),e.pos--;var l=e.getCurrentChar();return a=this.encodeChar(l,n),e.resetSymbolInfo(),a},t.prototype.writeNextTriplet=function(e,r){e.writeCodewords(this.encodeToCodewords(r.toString()));var n=r.toString().substring(3);r.setLengthToZero(),r.append(n)},t.prototype.handleEOD=function(e,r){var n=Math.floor(r.length()/3*2),a=r.length()%3,s=e.getCodewordCount()+n;e.updateSymbolInfo(s);var o=e.getSymbolInfo().getDataCapacity()-s;if(a===2){for(r.append("\0");r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(X5)}else if(o===1&&a===1){for(;r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(X5),e.pos--}else if(a===0){for(;r.length()>=3;)this.writeNextTriplet(e,r);(o>0||e.hasMoreCharacters())&&e.writeCodeword(X5)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(Ya)},t.prototype.encodeChar=function(e,r){if(e===32)return r.append(3),1;if(e>=48&&e<=57)return r.append(e-48+4),1;if(e>=65&&e<=90)return r.append(e-65+14),1;if(e<32)return r.append(0),r.append(e),2;if(e<=47)return r.append(1),r.append(e-33),2;if(e<=64)return r.append(1),r.append(e-58+15),2;if(e<=95)return r.append(1),r.append(e-91+22),2;if(e<=127)return r.append(2),r.append(e-96),2;r.append("1");var n=2;return n+=this.encodeChar(e-128,r),n},t.prototype.encodeToCodewords=function(e){var r=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=r/256,a=r%256,s=new ta;return s.append(n),s.append(a),s.toString()},t}(),U9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return zo},t.prototype.encode=function(e){for(var r=new ta;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,r),e.pos++;var a=r.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(r.toString()));var s=r.toString().substring(4);r.setLengthToZero(),r.append(s);var o=df.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(Ya);break}}}r.append(Na.getCharAt(31)),this.handleEOD(e,r)},t.prototype.handleEOD=function(e,r){try{var n=r.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,l=this.encodeToCodewords(r.toString()),c=!e.hasMoreCharacters(),u=c&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(u=!1,e.updateSymbolInfo(e.getCodewordCount()+l.length))}u?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(l)}finally{e.signalEncoderChange(Ya)}},t.prototype.encodeChar=function(e,r){e>=32&&e<=63?r.append(e):e>=64&&e<=94?r.append(Na.getCharAt(e-64)):df.illegalCharacter(Na.getCharAt(e))},t.prototype.encodeToCodewords=function(e){var r=e.length;if(r===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=r>=2?e.charAt(1).charCodeAt(0):0,s=r>=3?e.charAt(2).charCodeAt(0):0,o=r>=4?e.charAt(3).charCodeAt(0):0,l=(n<<18)+(a<<12)+(s<<6)+o,c=l>>16&255,u=l>>8&255,d=l&255,f=new ta;return f.append(c),r>=2&&f.append(u),r>=3&&f.append(d),f.toString()},t}(),Q9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),V9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},La=function(){function t(e,r,n,a,s,o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=r,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=s,this.dataRegions=o,this.rsBlockData=l,this.rsBlockError=c}return t.lookup=function(e,r,n,a,s){var o,l;r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!0);try{for(var c=V9e($9e),u=c.next();!u.done;u=c.next()){var d=u.value;if(!(r===1&&d.rectangular)&&!(r===2&&!d.rectangular)&&!(n!=null&&(d.getSymbolWidth()<n.getWidth()||d.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(d.getSymbolWidth()>a.getWidth()||d.getSymbolHeight()>a.getHeight()))&&e<=d.dataCapacity)return d}}catch(f){o={error:f}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},t.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},t.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},t.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},t.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},t.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},t.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},t.prototype.getDataCapacity=function(){return this.dataCapacity},t.prototype.getErrorCodewords=function(){return this.errorCodewords},t.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},t.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},t}(),H9e=function(t){Q9e(e,t);function e(){return t.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(r){return r<=8?156:155},e}(La),$9e=[new La(!1,3,5,8,8,1),new La(!1,5,7,10,10,1),new La(!0,5,7,16,6,1),new La(!1,8,10,12,12,1),new La(!0,10,11,14,6,2),new La(!1,12,12,14,14,1),new La(!0,16,14,24,10,1),new La(!1,18,14,16,16,1),new La(!1,22,18,18,18,1),new La(!0,22,18,16,10,2),new La(!1,30,20,20,20,1),new La(!0,32,24,16,14,2),new La(!1,36,24,22,22,1),new La(!1,44,28,24,24,1),new La(!0,49,28,22,14,2),new La(!1,62,36,14,14,4),new La(!1,86,42,16,16,4),new La(!1,114,48,18,18,4),new La(!1,144,56,20,20,4),new La(!1,174,68,22,22,4),new La(!1,204,84,24,24,4,102,42),new La(!1,280,112,14,14,16,140,56),new La(!1,368,144,16,16,16,92,36),new La(!1,456,192,18,18,16,114,48),new La(!1,576,224,20,20,16,144,56),new La(!1,696,272,22,22,16,174,68),new La(!1,816,336,24,24,16,136,56),new La(!1,1050,408,18,18,36,175,68),new La(!1,1304,496,20,20,36,163,62),new H9e],G9e=function(){function t(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var r=e.split("").map(function(l){return l.charCodeAt(0)}),n=new ta,a=0,s=r.length;a<s;a++){var o=String.fromCharCode(r[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new ta,this.newEncoding=-1}return t.prototype.setSymbolShape=function(e){this.shape=e},t.prototype.setSizeConstraints=function(e,r){this.minSize=e,this.maxSize=r},t.prototype.getMessage=function(){return this.msg},t.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},t.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCodewords=function(){return this.codewords},t.prototype.writeCodewords=function(e){this.codewords.append(e)},t.prototype.writeCodeword=function(e){this.codewords.append(e)},t.prototype.getCodewordCount=function(){return this.codewords.length()},t.prototype.getNewEncoding=function(){return this.newEncoding},t.prototype.signalEncoderChange=function(e){this.newEncoding=e},t.prototype.resetEncoderSignal=function(){this.newEncoding=-1},t.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},t.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},t.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},t.prototype.getSymbolInfo=function(){return this.symbolInfo},t.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=La.lookup(e,this.shape,this.minSize,this.maxSize,!0))},t.prototype.resetSymbolInfo=function(){this.symbolInfo=null},t}(),K9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),q9e=function(t){K9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return wo},e.prototype.encode=function(r){for(var n=new ta;r.hasMoreCharacters();){var a=r.getCurrentChar();r.pos++,this.encodeChar(a,n);var s=n.length();if(s%3===0){this.writeNextTriplet(r,n);var o=df.lookAheadTest(r.getMessage(),r.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){r.signalEncoderChange(Ya);break}}}this.handleEOD(r,n)},e.prototype.encodeChar=function(r,n){switch(r){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:r>=48&&r<=57?n.append(r-48+4):r>=65&&r<=90?n.append(r-65+14):df.illegalCharacter(Na.getCharAt(r));break}return 1},e.prototype.handleEOD=function(r,n){r.updateSymbolInfo();var a=r.getSymbolInfo().getDataCapacity()-r.getCodewordCount(),s=n.length();r.pos-=s,(r.getRemainingCharacters()>1||a>1||r.getRemainingCharacters()!==a)&&r.writeCodeword(R9e),r.getNewEncoding()<0&&r.signalEncoderChange(Ya)},e}(GR),z9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W9e=function(t){z9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return bc},e.prototype.encodeChar=function(r,n){if(r===32)return n.append(3),1;if(r>=48&&r<=57)return n.append(r-48+4),1;if(r>=97&&r<=122)return n.append(r-97+14),1;if(r<32)return n.append(0),n.append(r),2;if(r<=47)return n.append(1),n.append(r-33),2;if(r<=64)return n.append(1),n.append(r-58+15),2;if(r>=91&&r<=95)return n.append(1),n.append(r-91+22),2;if(r===96)return n.append(2),n.append(0),2;if(r<=90)return n.append(2),n.append(r-65+1),2;if(r<=127)return n.append(2),n.append(r-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(r-128,n),a},e}(GR),df=function(){function t(){}return t.randomize253State=function(e){var r=149*e%253+1,n=nG+r;return n<=254?n:n-254},t.encodeHighLevel=function(e,r,n,a,s){r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!1);var o=new GR,l=[new M9e,o,new W9e,new q9e,new U9e,new L9e],c=new G9e(e);c.setSymbolShape(r),c.setSizeConstraints(n,a),e.startsWith(aG)&&e.endsWith(iG)?(c.writeCodeword(B9e),c.setSkipAtEnd(2),c.pos+=aG.length):e.startsWith(sG)&&e.endsWith(iG)&&(c.writeCodeword(k9e),c.setSkipAtEnd(2),c.pos+=sG.length);var u=Ya;for(s&&(o.encodeMaximal(c),u=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)l[u].encode(c),c.getNewEncoding()>=0&&(u=c.getNewEncoding(),c.resetEncoderSignal());var d=c.getCodewordCount();c.updateSymbolInfo();var f=c.getSymbolInfo().getDataCapacity();d<f&&u!==Ya&&u!==Yl&&u!==zo&&c.writeCodeword("");var A=c.getCodewords();for(A.length()<f&&A.append(nG);A.length()<f;)A.append(this.randomize253State(A.length()+1));return c.getCodewords().toString()},t.lookAheadTest=function(e,r,n){var a=this.lookAheadTestIntern(e,r,n);if(n===wo&&a===wo){for(var s=Math.min(r+3,e.length),o=r;o<s;o++)if(!this.isNativeX12(e.charCodeAt(o)))return Ya}else if(n===zo&&a===zo){for(var s=Math.min(r+4,e.length),o=r;o<s;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return Ya}return a},t.lookAheadTestIntern=function(e,r,n){if(r>=e.length)return n;var a;n===Ya?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var s=0,o=new Uint8Array(6),l=[];;){if(r+s===e.length){Bo.fill(o,0),Bo.fill(l,0);var c=this.findMinimums(a,l,sa.MAX_VALUE,o),u=this.getMinimumCount(o);if(l[Ya]===c)return Ya;if(u===1){if(o[Yl]>0)return Yl;if(o[zo]>0)return zo;if(o[bc]>0)return bc;if(o[wo]>0)return wo}return yl}var d=e.charCodeAt(r+s);if(s++,this.isDigit(d)?a[Ya]+=.5:this.isExtendedASCII(d)?(a[Ya]=Math.ceil(a[Ya]),a[Ya]+=2):(a[Ya]=Math.ceil(a[Ya]),a[Ya]++),this.isNativeC40(d)?a[yl]+=2/3:this.isExtendedASCII(d)?a[yl]+=8/3:a[yl]+=4/3,this.isNativeText(d)?a[bc]+=2/3:this.isExtendedASCII(d)?a[bc]+=8/3:a[bc]+=4/3,this.isNativeX12(d)?a[wo]+=2/3:this.isExtendedASCII(d)?a[wo]+=13/3:a[wo]+=10/3,this.isNativeEDIFACT(d)?a[zo]+=3/4:this.isExtendedASCII(d)?a[zo]+=17/4:a[zo]+=13/4,this.isSpecialB256(d)?a[Yl]+=4:a[Yl]++,s>=4){if(Bo.fill(o,0),Bo.fill(l,0),this.findMinimums(a,l,sa.MAX_VALUE,o),l[Ya]<this.min(l[Yl],l[yl],l[bc],l[wo],l[zo]))return Ya;if(l[Yl]<l[Ya]||l[Yl]+1<this.min(l[yl],l[bc],l[wo],l[zo]))return Yl;if(l[zo]+1<this.min(l[Yl],l[yl],l[bc],l[wo],l[Ya]))return zo;if(l[bc]+1<this.min(l[Yl],l[yl],l[zo],l[wo],l[Ya]))return bc;if(l[wo]+1<this.min(l[Yl],l[yl],l[zo],l[bc],l[Ya]))return wo;if(l[yl]+1<this.min(l[Ya],l[Yl],l[zo],l[bc])){if(l[yl]<l[wo])return yl;if(l[yl]===l[wo]){for(var f=r+s+1;f<e.length;){var A=e.charCodeAt(f);if(this.isX12TermSep(A))return wo;if(!this.isNativeX12(A))break;f++}return yl}}}}},t.min=function(e,r,n,a,s){var o=Math.min(e,Math.min(r,Math.min(n,a)));return s===void 0?o:Math.min(o,s)},t.findMinimums=function(e,r,n,a){for(var s=0;s<6;s++){var o=r[s]=Math.ceil(e[s]);n>o&&(n=o,Bo.fill(a,0)),n===o&&(a[s]=a[s]+1)}return n},t.getMinimumCount=function(e){for(var r=0,n=0;n<6;n++)r+=e[n];return r||0},t.isDigit=function(e){return e>=48&&e<=57},t.isExtendedASCII=function(e){return e>=128&&e<=255},t.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},t.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},t.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},t.isX12TermSep=function(e){return e===13||e===42||e===62},t.isNativeEDIFACT=function(e){return e>=32&&e<=94},t.isSpecialB256=function(e){return!1},t.determineConsecutiveDigitCount=function(e,r){r===void 0&&(r=0);for(var n=e.length,a=r;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-r},t.illegalCharacter=function(e){var r=sa.toHexString(e.charCodeAt(0));throw r="0000".substring(0,4-r.length)+r,new Error("Illegal character: "+e+" (0x"+r+")")},t}(),Y5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},oG=function(){function t(e){this.charset=e,this.name=e.name}return t.prototype.canEncode=function(e){try{return Bd.encode(e,this.charset)!=null}catch{return!1}},t}(),X9e=function(){function t(e,r,n){var a,s,o,l,c,u;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(E){return new oG(E9e.forName(E))}),this.encoders=[];var d=[];d.push(new oG(S9e.ISO_8859_1));for(var f=r!=null&&r.name.startsWith("UTF"),A=0;A<e.length;A++){var h=!1;try{for(var m=(a=void 0,Y5(d)),p=m.next();!p.done;p=m.next()){var x=p.value,v=e.charAt(A),y=v.charCodeAt(0);if(y===n||x.canEncode(v)){h=!0;break}}}catch(E){a={error:E}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!h)try{for(var b=(o=void 0,Y5(this.ENCODERS)),w=b.next();!w.done;w=b.next()){var x=w.value;if(x.canEncode(e.charAt(A))){d.push(x),h=!0;break}}}catch(E){o={error:E}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(o)throw o.error}}h||(f=!0)}if(d.length===1&&!f)this.encoders=[d[0]];else{this.encoders=[];var I=0;try{for(var j=Y5(d),C=j.next();!C.done;C=j.next()){var x=C.value;this.encoders[I++]=x}}catch(E){c={error:E}}finally{try{C&&!C.done&&(u=j.return)&&u.call(j)}finally{if(c)throw c.error}}}var S=-1;if(r!=null){for(var A=0;A<this.encoders.length;A++)if(this.encoders[A]!=null&&r.name===this.encoders[A].name){S=A;break}}this.priorityEncoderIndex=S}return t.prototype.length=function(){return this.encoders.length},t.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},t.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},t.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},t.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},t.prototype.canEncode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return!0},t.prototype.encode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return Bd.encode(Na.getCharAt(e),this.encoders[r].name)},t}(),Y9e=3,J9e=function(){function t(e,r,n){this.fnc1=n;var a=new X9e(e,r,n);if(a.length()===1)for(var s=0;s<this.bytes.length;s++){var o=e.charAt(s).charCodeAt(0);this.bytes[s]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(e,r){if(e+r-1>=this.bytes.length)return!1;for(var n=0;n<r;n++)if(this.isECI(e+n))return!1;return!0},t.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},t.prototype.subSequence=function(e,r){if(e<0||e>r||r>this.length())throw new Error(""+e);for(var n=new ta,a=e;a<r;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},t.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},t.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},t.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},t.prototype.addEdge=function(e,r,n){(e[r][n.encoderIndex]==null||e[r][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[r][n.encoderIndex]=n)},t.prototype.addEdges=function(e,r,n,a,s,o){var l=e.charAt(a).charCodeAt(0),c=0,u=r.length();r.getPriorityEncoderIndex()>=0&&(l===o||r.canEncode(l,r.getPriorityEncoderIndex()))&&(c=r.getPriorityEncoderIndex(),u=c+1);for(var d=c;d<u;d++)(l===o||r.canEncode(l,d))&&this.addEdge(n,a+1,new lG(l,r,d,s,o))},t.prototype.encodeMinimally=function(e,r,n){var a=e.length,s=new lG[a+1][r.length()];this.addEdges(e,r,s,0,null,n);for(var o=1;o<=a;o++){for(var l=0;l<r.length();l++)s[o][l]!=null&&o<a&&this.addEdges(e,r,s,o,s[o][l],n);for(var l=0;l<r.length();l++)s[o-1][l]=null}for(var c=-1,u=sa.MAX_VALUE,l=0;l<r.length();l++)if(s[a][l]!=null){var d=s[a][l];d.cachedTotalSize<u&&(u=d.cachedTotalSize,c=l)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],A=s[a][c];A!=null;){if(A.isFNC1())f.unshift(1e3);else for(var h=r.encode(A.c,A.encoderIndex),o=h.length-1;o>=0;o--)f.unshift(h[o]&255);var m=A.previous===null?0:A.previous.encoderIndex;m!==A.encoderIndex&&f.unshift(256+r.getECIValue(A.encoderIndex)),A=A.previous}for(var p=[],o=0;o<p.length;o++)p[o]=f[o];return p},t}(),lG=function(){function t(e,r,n,a,s){this.c=e,this.encoderSet=r,this.encoderIndex=n,this.previous=a,this.fnc1=s,this.c=e===s?1e3:e;var o=this.isFNC1()?1:r.encode(e,n).length,l=a===null?0:a.encoderIndex;l!==n&&(o+=Y9e),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return this.c===1e3},t}(),Z9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var cG;(function(t){t[t.ASCII=0]="ASCII",t[t.C40=1]="C40",t[t.TEXT=2]="TEXT",t[t.X12=3]="X12",t[t.EDF=4]="EDF",t[t.B256=5]="B256"})(cG||(cG={}));(function(t){Z9e(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n,a)||this;return l.shape=s,l.macroId=o,l}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(J9e);var eQe=function(){function t(){}return t.prototype.isCompact=function(){return this.compact},t.prototype.setCompact=function(e){this.compact=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getLayers=function(){return this.layers},t.prototype.setLayers=function(e){this.layers=e},t.prototype.getCodeWords=function(){return this.codeWords},t.prototype.setCodeWords=function(e){this.codeWords=e},t.prototype.getMatrix=function(){return this.matrix},t.prototype.setMatrix=function(e){this.matrix=e},t}(),uG=function(){function t(){}return t.singletonList=function(e){return[e]},t.min=function(e,r){return e.sort(r)[0]},t}(),tQe=function(){function t(e){this.previous=e}return t.prototype.getPrevious=function(){return this.previous},t}(),rQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),KR=function(t){rQe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.value=n,s.bitCount=a,s}return e.prototype.appendTo=function(r,n){r.appendBits(this.value,this.bitCount)},e.prototype.add=function(r,n){return new e(this,r,n)},e.prototype.addBinaryShift=function(r,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,r,n)},e.prototype.toString=function(){var r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+sa.toBinaryString(r|1<<this.bitCount).substring(1)+">"},e}(tQe),nQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),aQe=function(t){nQe(e,t);function e(r,n,a){var s=t.call(this,r,0,0)||this;return s.binaryShiftStart=n,s.binaryShiftByteCount=a,s}return e.prototype.appendTo=function(r,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(r,n){return new e(this,r,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(KR);function sQe(t,e,r){return new aQe(t,e,r)}function Ey(t,e,r){return new KR(t,e,r)}var iQe=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],gm=0,oj=1,Ed=2,Use=3,rh=4,oQe=new KR(null,0,0),J5=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],lQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function cQe(t){var e,r;try{for(var n=lQe(t),a=n.next();!a.done;a=n.next()){var s=a.value;Bo.fill(s,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return t[gm][rh]=0,t[oj][rh]=0,t[oj][gm]=28,t[Use][rh]=0,t[Ed][rh]=0,t[Ed][gm]=15,t}var Qse=cQe(Bo.createInt32Array(6,6)),uQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dQe=function(){function t(e,r,n,a){this.token=e,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}return t.prototype.getMode=function(){return this.mode},t.prototype.getToken=function(){return this.token},t.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},t.prototype.getBitCount=function(){return this.bitCount},t.prototype.latchAndAppend=function(e,r){var n=this.bitCount,a=this.token;if(e!==this.mode){var s=J5[this.mode][e];a=Ey(a,s&65535,s>>16),n+=s>>16}var o=e===Ed?4:5;return a=Ey(a,r,o),new t(a,e,0,n+o)},t.prototype.shiftAndAppend=function(e,r){var n=this.token,a=this.mode===Ed?4:5;return n=Ey(n,Qse[this.mode][e],a),n=Ey(n,r,5),new t(n,this.mode,0,this.bitCount+a+5)},t.prototype.addBinaryShiftChar=function(e){var r=this.token,n=this.mode,a=this.bitCount;if(this.mode===rh||this.mode===Ed){var s=J5[n][gm];r=Ey(r,s&65535,s>>16),a+=s>>16,n=gm}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new t(r,n,this.binaryShiftByteCount+1,a+o);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(e+1)),l},t.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var r=this.token;return r=sQe(r,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new t(r,this.mode,0,this.bitCount)},t.prototype.isBetterThanOrEqualTo=function(e){var r=this.bitCount+(J5[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?r+=t.calculateBinaryShiftCost(e)-t.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(r+=10),r<=e.bitCount},t.prototype.toBitArray=function(e){for(var r,n,a=[],s=this.endBinaryShift(e.length).token;s!==null;s=s.getPrevious())a.unshift(s);var o=new tl;try{for(var l=uQe(a),c=l.next();!c.done;c=l.next()){var u=c.value;u.appendTo(o,e)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t.prototype.toString=function(){return Na.format("%s bits=%d bytes=%d",iQe[this.mode],this.bitCount,this.binaryShiftByteCount)},t.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},t.INITIAL_STATE=new t(oQe,gm,0,0),t}();function fQe(t){var e=Na.getCharCode(" "),r=Na.getCharCode("."),n=Na.getCharCode(",");t[gm][e]=1;for(var a=Na.getCharCode("Z"),s=Na.getCharCode("A"),o=s;o<=a;o++)t[gm][o]=o-s+2;t[oj][e]=1;for(var l=Na.getCharCode("z"),c=Na.getCharCode("a"),o=c;o<=l;o++)t[oj][o]=o-c+2;t[Ed][e]=1;for(var u=Na.getCharCode("9"),d=Na.getCharCode("0"),o=d;o<=u;o++)t[Ed][o]=o-d+2;t[Ed][n]=12,t[Ed][r]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],A=0;A<f.length;A++)t[Use][Na.getCharCode(f[A])]=A;for(var h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],A=0;A<h.length;A++)Na.getCharCode(h[A])>0&&(t[rh][Na.getCharCode(h[A])]=A);return t}var Z5=fQe(Bo.createInt32Array(5,256)),f_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},hQe=function(){function t(e){this.text=e}return t.prototype.encode=function(){for(var e=Na.getCharCode(" "),r=Na.getCharCode(`
`),n=uG.singletonList(dQe.INITIAL_STATE),a=0;a<this.text.length;a++){var s=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case Na.getCharCode("\r"):s=o===r?2:0;break;case Na.getCharCode("."):s=o===e?3:0;break;case Na.getCharCode(","):s=o===e?4:0;break;case Na.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=t.updateStateListForPair(n,a,s),a++):n=this.updateStateListForChar(n,a)}var l=uG.min(n,function(c,u){return c.getBitCount()-u.getBitCount()});return l.toBitArray(this.text)},t.prototype.updateStateListForChar=function(e,r){var n,a,s=[];try{for(var o=f_(e),l=o.next();!l.done;l=o.next()){var c=l.value;this.updateStateForChar(c,r,s)}}catch(u){n={error:u}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return t.simplifyStates(s)},t.prototype.updateStateForChar=function(e,r,n){for(var a=this.text[r]&255,s=Z5[e.getMode()][a]>0,o=null,l=0;l<=rh;l++){var c=Z5[l][a];if(c>0){if(o==null&&(o=e.endBinaryShift(r)),!s||l===e.getMode()||l===Ed){var u=o.latchAndAppend(l,c);n.push(u)}if(!s&&Qse[e.getMode()][l]>=0){var d=o.shiftAndAppend(l,c);n.push(d)}}}if(e.getBinaryShiftByteCount()>0||Z5[e.getMode()][a]===0){var f=e.addBinaryShiftChar(r);n.push(f)}},t.updateStateListForPair=function(e,r,n){var a,s,o=[];try{for(var l=f_(e),c=l.next();!c.done;c=l.next()){var u=c.value;this.updateStateForPair(u,r,n,o)}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}return this.simplifyStates(o)},t.updateStateForPair=function(e,r,n,a){var s=e.endBinaryShift(r);if(a.push(s.latchAndAppend(rh,n)),e.getMode()!==rh&&a.push(s.shiftAndAppend(rh,n)),n===3||n===4){var o=s.latchAndAppend(Ed,16-n).latchAndAppend(Ed,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var l=e.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(l)}},t.simplifyStates=function(e){var r,n,a,s,o=[];try{for(var l=f_(e),c=l.next();!c.done;c=l.next()){var u=c.value,d=!0,f=function(x){if(x.isBetterThanOrEqualTo(u))return d=!1,"break";u.isBetterThanOrEqualTo(x)&&(o=o.filter(function(v){return v!==x}))};try{for(var A=(a=void 0,f_(o)),h=A.next();!h.done;h=A.next()){var m=h.value,p=f(m);if(p==="break")break}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}d&&o.push(u)}}catch(x){r={error:x}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t}(),AQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.encodeBytes=function(e){return t.encode(e,t.DEFAULT_EC_PERCENT,t.DEFAULT_AZTEC_LAYERS)},t.encode=function(e,r,n){var a=new hQe(e).encode(),s=sa.truncDivision(a.getSize()*r,100)+11,o=a.getSize()+s,l,c,u,d,f;if(n!==t.DEFAULT_AZTEC_LAYERS){if(l=n<0,c=Math.abs(n),c>(l?t.MAX_NB_BITS_COMPACT:t.MAX_NB_BITS))throw new Pn(Na.format("Illegal value %s for layers",n));u=t.totalBitsInLayer(c,l),d=t.WORD_SIZE[c];var A=u-u%d;if(f=t.stuffBits(a,d),f.getSize()+s>A)throw new Pn("Data to large for user specified layer");if(l&&f.getSize()>d*64)throw new Pn("Data to large for user specified layer")}else{d=0,f=null;for(var h=0;;h++){if(h>t.MAX_NB_BITS)throw new Pn("Data too large for an Aztec code");if(l=h<=3,c=l?h+1:h,u=t.totalBitsInLayer(c,l),!(o>u)){(f==null||d!==t.WORD_SIZE[c])&&(d=t.WORD_SIZE[c],f=t.stuffBits(a,d));var A=u-u%d;if(!(l&&f.getSize()>d*64)&&f.getSize()+s<=A)break}}}var m=t.generateCheckWords(f,u,d),p=f.getSize()/d,x=t.generateModeMessage(l,c,p),v=(l?11:14)+c*4,y=new Int32Array(v),b;if(l){b=v;for(var h=0;h<y.length;h++)y[h]=h}else{b=v+1+2*sa.truncDivision(sa.truncDivision(v,2)-1,15);for(var w=sa.truncDivision(v,2),I=sa.truncDivision(b,2),h=0;h<w;h++){var j=h+sa.truncDivision(h,15);y[w-h-1]=I-j-1,y[w+h]=I+j+1}}for(var C=new uh(b),h=0,S=0;h<c;h++){for(var E=(c-h)*4+(l?9:12),B=0;B<E;B++)for(var k=B*2,T=0;T<2;T++)m.get(S+k+T)&&C.set(y[h*2+T],y[h*2+B]),m.get(S+E*2+k+T)&&C.set(y[h*2+B],y[v-1-h*2-T]),m.get(S+E*4+k+T)&&C.set(y[v-1-h*2-T],y[v-1-h*2-B]),m.get(S+E*6+k+T)&&C.set(y[v-1-h*2-B],y[h*2+T]);S+=E*8}if(t.drawModeMessage(C,l,b,x),l)t.drawBullsEye(C,sa.truncDivision(b,2),5);else{t.drawBullsEye(C,sa.truncDivision(b,2),7);for(var h=0,B=0;h<sa.truncDivision(v,2)-1;h+=15,B+=16)for(var T=sa.truncDivision(b,2)&1;T<b;T+=2)C.set(sa.truncDivision(b,2)-B,T),C.set(sa.truncDivision(b,2)+B,T),C.set(T,sa.truncDivision(b,2)-B),C.set(T,sa.truncDivision(b,2)+B)}var P=new eQe;return P.setCompact(l),P.setSize(b),P.setLayers(c),P.setCodeWords(p),P.setMatrix(C),P},t.drawBullsEye=function(e,r,n){for(var a=0;a<n;a+=2)for(var s=r-a;s<=r+a;s++)e.set(s,r-a),e.set(s,r+a),e.set(r-a,s),e.set(r+a,s);e.set(r-n,r-n),e.set(r-n+1,r-n),e.set(r-n,r-n+1),e.set(r+n,r-n),e.set(r+n,r-n+1),e.set(r+n,r+n-1)},t.generateModeMessage=function(e,r,n){var a=new tl;return e?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=t.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=t.generateCheckWords(a,40,4)),a},t.drawModeMessage=function(e,r,n,a){var s=sa.truncDivision(n,2);if(r)for(var o=0;o<7;o++){var l=s-3+o;a.get(o)&&e.set(l,s-5),a.get(o+7)&&e.set(s+5,l),a.get(20-o)&&e.set(l,s+5),a.get(27-o)&&e.set(s-5,l)}else for(var o=0;o<10;o++){var l=s-5+o+sa.truncDivision(o,5);a.get(o)&&e.set(l,s-7),a.get(o+10)&&e.set(s+7,l),a.get(29-o)&&e.set(l,s+7),a.get(39-o)&&e.set(s-7,l)}},t.generateCheckWords=function(e,r,n){var a,s,o=e.getSize()/n,l=new Mse(t.getGF(n)),c=sa.truncDivision(r,n),u=t.bitsToWords(e,n,c);l.encode(u,c-o);var d=r%n,f=new tl;f.appendBits(0,d);try{for(var A=AQe(Array.from(u)),h=A.next();!h.done;h=A.next()){var m=h.value;f.appendBits(m,n)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}return f},t.bitsToWords=function(e,r,n){var a=new Int32Array(n),s,o;for(s=0,o=e.getSize()/r;s<o;s++){for(var l=0,c=0;c<r;c++)l|=e.get(s*r+c)?1<<r-c-1:0;a[s]=l}return a},t.getGF=function(e){switch(e){case 4:return tu.AZTEC_PARAM;case 6:return tu.AZTEC_DATA_6;case 8:return tu.AZTEC_DATA_8;case 10:return tu.AZTEC_DATA_10;case 12:return tu.AZTEC_DATA_12;default:throw new Pn("Unsupported word size "+e)}},t.stuffBits=function(e,r){for(var n=new tl,a=e.getSize(),s=(1<<r)-2,o=0;o<a;o+=r){for(var l=0,c=0;c<r;c++)(o+c>=a||e.get(o+c))&&(l|=1<<r-1-c);(l&s)===s?(n.appendBits(l&s,r),o--):l&s?n.appendBits(l,r):(n.appendBits(l|1,r),o--)}return n},t.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.DEFAULT_EC_PERCENT=33,t.DEFAULT_AZTEC_LAYERS=0,t.MAX_NB_BITS=32,t.MAX_NB_BITS_COMPACT=4,t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),t})();var mQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pQe=function(t){mQe(e,t);function e(r){var n=t.call(this,r.width,r.height)||this;return n.canvas=r,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(r),n}return e.makeBufferFromCanvasImageData=function(r){var n;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height)},e.toGrayscaleBuffer=function(r,n,a){for(var s=new Uint8ClampedArray(n*a),o=0,l=0,c=r.length;o<c;o+=4,l++){var u=void 0,d=r[o+3];if(d===0)u=255;else{var f=r[o],A=r[o+1],h=r[o+2];u=306*f+601*A+117*h+512>>10}s[l]=u}return s},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new vP(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=r*e.DEGREE_TO_RADIANS,s=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(a))*s+Math.abs(Math.sin(a))*o),c=Math.ceil(Math.abs(Math.sin(a))*s+Math.abs(Math.cos(a))*o);n.width=l,n.height=c;var u=n.getContext("2d");if(!u)throw new Error("Could not create a Canvas Context element.");return u.translate(l/2,c/2),u.rotate(a),u.drawImage(this.canvas,s/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(zw);function Vse(){return typeof navigator<"u"}function gQe(){return Vse()&&!!navigator.mediaDevices}function xQe(){return!!(gQe()&&navigator.mediaDevices.enumerateDevices)}var tv=function(){return tv=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},tv.apply(this,arguments)},ni=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},ai=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},eT=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vQe={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},j1=function(){function t(e,r,n){r===void 0&&(r=new Map),n===void 0&&(n={}),this.reader=e,this.hints=r,this.options=tv(tv({},vQe),n)}return Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(_s.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),t.addVideoSource=function(e,r){try{e.srcObject=r}catch{console.error("got interrupted by new loading request")}},t.mediaStreamSetTorch=function(e,r){return ni(this,void 0,void 0,function(){return ai(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:r?"flash":"off",torch:!!r}]})];case 1:return n.sent(),[2]}})})},t.mediaStreamIsTorchCompatible=function(e){var r,n,a=e.getVideoTracks();try{for(var s=eT(a),o=s.next();!o.done;o=s.next()){var l=o.value;if(t.mediaStreamIsTorchCompatibleTrack(l))return!0}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},t.mediaStreamIsTorchCompatibleTrack=function(e){try{var r=e.getCapabilities();return"torch"in r}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},t.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},t.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Vi("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Vi("element with id '".concat(e,"' must be an ").concat(r," element"));return n},t.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return t.getMediaElement(e,"video");if(!e&&typeof document<"u"){var r=document.createElement("video");return r.width=200,r.height=200,r}throw new Error("Couldn't get videoElement from videoSource!")},t.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return t.getMediaElement(e,"img");if(typeof e>"u"){var r=document.createElement("img");return r.width=200,r.height=200,r}throw new Error("Couldn't get imageElement from imageSource!")},t.prepareVideoElement=function(e){var r=t.createVideoElement(e);return r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.createBinaryBitmapFromCanvas=function(e){var r=new pQe(e),n=new Ese(r);return new _se(n)},t.drawImageOnCanvas=function(e,r){e.drawImage(r,0,0)},t.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},t.createCaptureCanvas=function(e){if(!e)throw new Vi("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var r=document.createElement("canvas"),n=t.getMediaElementDimensions(e),a=n.width,s=n.height;return r.style.width=a+"px",r.style.height=s+"px",r.width=a,r.height=s,r},t.tryPlayVideo=function(e){return ni(this,void 0,void 0,function(){var r;return ai(this,function(n){switch(n.label){case 0:if(e!=null&&e.ended)return console.error("Trying to play video that has ended."),[2,!1];if(t.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return r=n.sent(),console.warn("It was not possible to play the video.",r),[2,!1];case 4:return[2]}})})},t.createCanvasFromMediaElement=function(e){var r=t.createCaptureCanvas(e),n=r.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return t.drawImageOnCanvas(n,e),r},t.createBinaryBitmapFromMediaElem=function(e){var r=t.createCanvasFromMediaElement(e);return t.createBinaryBitmapFromCanvas(r)},t.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},t.listVideoInputDevices=function(){return ni(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return ai(this,function(h){switch(h.label){case 0:if(!Vse())throw new Error("Can't enumerate devices, navigator is not present.");if(!xQe())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=eT(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device ".concat(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.findDeviceById=function(e){return ni(this,void 0,void 0,function(){var r;return ai(this,function(n){switch(n.label){case 0:return[4,t.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2]}})})},t.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},t.releaseAllStreams=function(){t.streamTracker.length!==0&&t.streamTracker.forEach(function(e){e.getTracks().forEach(function(r){return r.stop()})}),t.streamTracker=[]},t.playVideoOnLoadAsync=function(e,r){return ni(this,void 0,void 0,function(){var n;return ai(this,function(a){switch(a.label){case 0:return[4,t.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(s,o){var l=setTimeout(function(){t.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",c))},r),c=function(){t.tryPlayVideo(e).then(function(u){clearTimeout(l),e.removeEventListener("canplay",c),s(u)})};e.addEventListener("canplay",c)})]}})})},t.attachStreamToVideo=function(e,r,n){return n===void 0&&(n=5e3),ni(this,void 0,void 0,function(){var a;return ai(this,function(s){switch(s.label){case 0:return a=t.prepareVideoElement(r),t.addVideoSource(a,e),[4,t.playVideoOnLoadAsync(a,n)];case 1:return s.sent(),[2,a]}})})},t._waitImageLoad=function(e){return new Promise(function(r,n){var a=1e4,s=setTimeout(function(){t.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(s),e.removeEventListener("load",o),r()};e.addEventListener("load",o)})},t.checkCallbackFnOrThrow=function(e){if(!e)throw new Vi("`callbackFn` is a required parameter, you cannot capture results without it.")},t.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(r){return r.stop()}),e=void 0},t.prototype.decode=function(e){var r=t.createCanvasFromMediaElement(e);return this.decodeFromCanvas(r)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},t.prototype.decodeFromCanvas=function(e){var r=t.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(r)},t.prototype.decodeFromImageElement=function(e){return ni(this,void 0,void 0,function(){var r;return ai(this,function(n){switch(n.label){case 0:if(!e)throw new Vi("An image element must be provided.");return r=t.prepareImageElement(e),[4,this._decodeOnLoadImage(r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeFromImageUrl=function(e){return ni(this,void 0,void 0,function(){var r;return ai(this,function(n){switch(n.label){case 0:if(!e)throw new Vi("An URL must be provided.");r=t.prepareImageElement(),r.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(r)];case 2:return[2,n.sent()];case 3:return t.destroyImageElement(r),[7];case 4:return[2]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return ni(this,void 0,void 0,function(){var a,s;return ai(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,r,n)];case 3:return[2,o.sent()];case 4:throw s=o.sent(),t.disposeMediaStream(a),s;case 5:return[2]}})})},t.prototype.decodeFromStream=function(e,r,n){return ni(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A,h=this;return ai(this,function(m){switch(m.label){case 0:return t.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,t.attachStreamToVideo(e,r,a)];case 1:return s=m.sent(),o=function(){t.disposeMediaStream(e),t.cleanVideoSource(s)},l=this.scan(s,n,o),c=e.getVideoTracks(),u=tv(tv({},l),{stop:function(){l.stop()},streamVideoConstraintsApply:function(p,x){return ni(this,void 0,void 0,function(){var v,y,b,w,I,j,C;return ai(this,function(S){switch(S.label){case 0:v=x?c.filter(x):c,S.label=1;case 1:S.trys.push([1,6,7,8]),y=eT(v),b=y.next(),S.label=2;case 2:return b.done?[3,5]:(w=b.value,[4,w.applyConstraints(p)]);case 3:S.sent(),S.label=4;case 4:return b=y.next(),[3,2];case 5:return[3,8];case 6:return I=S.sent(),j={error:I},[3,8];case 7:try{b&&!b.done&&(C=y.return)&&C.call(y)}finally{if(j)throw j.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(p){return c.find(p).getConstraints()},streamVideoSettingsGet:function(p){return c.find(p).getSettings()},streamVideoCapabilitiesGet:function(p){return c.find(p).getCapabilities()}}),d=t.mediaStreamIsTorchCompatible(e),d&&(f=c==null?void 0:c.find(function(p){return t.mediaStreamIsTorchCompatibleTrack(p)}),A=function(p){return ni(h,void 0,void 0,function(){return ai(this,function(x){switch(x.label){case 0:return[4,t.mediaStreamSetTorch(f,p)];case 1:return x.sent(),[2]}})})},u.switchTorch=A,u.stop=function(){return ni(h,void 0,void 0,function(){return ai(this,function(p){switch(p.label){case 0:return l.stop(),[4,A(!1)];case 1:return p.sent(),[2]}})})}),[2,u]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return ni(this,void 0,void 0,function(){var a,s;return ai(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromVideoElement=function(e,r){return ni(this,void 0,void 0,function(){var n,a;return ai(this,function(s){switch(s.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Vi("A video element must be provided.");return n=t.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,a)];case 1:return s.sent(),[2,this.scan(n,r)]}})})},t.prototype.decodeFromVideoUrl=function(e,r){return ni(this,void 0,void 0,function(){var n,a,s,o;return ai(this,function(l){switch(l.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Vi("An URL must be provided.");return n=t.prepareVideoElement(),n.src=e,a=function(){t.cleanVideoSource(n)},s=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,s)];case 1:return l.sent(),o=this.scan(n,r,a),[2,o]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return ni(this,void 0,void 0,function(){var n;return ai(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return ni(this,void 0,void 0,function(){var n,a,s;return ai(this,function(o){switch(o.label){case 0:return n=!!r,[4,t.attachStreamToVideo(e,r)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return s=o.sent(),[2,s];case 4:return n||t.cleanVideoSource(a),[7];case 5:return[2]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return ni(this,void 0,void 0,function(){var n,a;return ai(this,function(s){switch(s.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromVideoElement=function(e){return ni(this,void 0,void 0,function(){var r,n;return ai(this,function(a){switch(a.label){case 0:if(!e)throw new Vi("A video element must be provided.");return r=t.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(r,n)];case 1:return a.sent(),[4,this.scanOneResult(r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromVideoUrl=function(e){return ni(this,void 0,void 0,function(){var r,n;return ai(this,function(a){switch(a.label){case 0:if(!e)throw new Vi("An URL must be provided.");r=t.prepareVideoElement(),r.src=e,n=this.decodeOnceFromVideoElement(r),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return t.cleanVideoSource(r),[7];case 4:return[2]}})})},t.prototype.scanOneResult=function(e,r,n,a){var s=this;return r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,l){s.scan(e,function(c,u,d){if(c){o(c),d.stop();return}if(u){if(u instanceof lr&&r||u instanceof co&&n||u instanceof Kr&&a)return;d.stop(),l(u)}})})},t.prototype.scan=function(e,r,n){var a=this;t.checkCallbackFnOrThrow(r);var s=t.createCaptureCanvas(e),o;try{o=s.getContext("2d",{willReadFrequently:!0})}catch{o=s.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var l=function(){o=void 0,s=void 0},c=!1,u,d=function(){c=!0,clearTimeout(u),l(),n&&n()},f={stop:d},A=function(){if(!c)try{t.drawImageOnCanvas(o,e);var h=a.decodeFromCanvas(s);r(h,void 0,f),u=setTimeout(A,a.options.delayBetweenScanSuccess)}catch(v){r(void 0,v,f);var m=v instanceof co,p=v instanceof Kr,x=v instanceof lr;if(m||p||x){u=setTimeout(A,a.options.delayBetweenScanAttempts);return}l(),n&&n(v)}};return A(),f},t.prototype._decodeOnLoadImage=function(e){return ni(this,void 0,void 0,function(){var r;return ai(this,function(n){switch(n.label){case 0:return r=t.isImageLoaded(e),r?[3,2]:[4,t._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},t.prototype.getUserMedia=function(e){return ni(this,void 0,void 0,function(){var r;return ai(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=n.sent(),t.streamTracker.push(r),[2,r]}})})},t.streamTracker=[],t}(),yQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){yQe(e,t);function e(r,n){return t.call(this,new rj,r,n)||this}return e})(j1);var bQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){bQe(e,t);function e(r,n){return t.call(this,new Zx(r),r,n)||this}return e})(j1);var wQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){wQe(e,t);function e(r,n){return t.call(this,new aj,r,n)||this}return e})(j1);var NQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z2=function(t){NQe(e,t);function e(r,n){var a=this,s=new Rse;return s.setHints(r),a=t.call(this,s,r,n)||this,a.reader=s,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(r){this.hints.set(_s.POSSIBLE_FORMATS,r),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e.prototype.setHints=function(r){this.hints=r,this.reader.setHints(this.hints)},e}(j1),CQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){CQe(e,t);function e(r,n){return t.call(this,new ij,r,n)||this}return e})(j1);var _Qe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){_Qe(e,t);function e(r,n){return t.call(this,new sj,r,n)||this}return e})(j1);const tT=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function ls(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Lh(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function w0(t,e=1){const r=Math.floor(Lh(t,e));return r>0?r:e}function EQe(t){return Object.values(t||{}).every(r=>ls(r)==="")}function sp(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(ls(a),a));for(const a of e){const s=n.get(ls(a));if(s!=null)return t[s]}}function SQe({open:t,code:e,onClose:r}){return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-lg border p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"font-bold text-lg",children:"Cdigo de barras"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Valor"}),i.jsx("div",{className:"text-xl font-mono font-semibold break-all",children:e})]}),i.jsx("div",{className:"mt-3 flex gap-2 justify-end",children:i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>{var n;try{(n=navigator.clipboard)==null||n.writeText(e)}catch{}},children:"Copiar"})})]})}):null}function jQe({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new z2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function IQe(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState(1),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(null),[j,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState(1),[G,ce]=g.useState(""),[ue,le]=g.useState(""),[Ae,ae]=g.useState(""),[_e,De]=g.useState(""),[O,H]=g.useState(""),[K,R]=g.useState(!1),[X,Y]=g.useState(""),[D,Q]=g.useState(!1),[te,be]=g.useState("create"),[U,Xe]=g.useState(!1),[se,ee]=g.useState(""),[Fe,je]=g.useState([]),[Se,Ze]=g.useState([]),[ut,Et]=g.useState(!1),[St,Ft]=g.useState(!1);g.useEffect(()=>{var ze;const ye=window.matchMedia("(max-width: 900px)"),$e=()=>Ft(ye.matches);return $e(),(ze=ye.addEventListener)==null||ze.call(ye,"change",$e),()=>{var Ke;return(Ke=ye.removeEventListener)==null?void 0:Ke.call(ye,"change",$e)}},[]);const[Qt,Ut]=g.useState(!0),[Tt,Re]=g.useState(!0);g.useEffect(()=>{St?(Ut(!1),Re(!1)):(Ut(!0),Re(!0))},[St]);const[Te,Ye]=g.useState(null),[ht,Oe]=g.useState({}),Ie=g.useRef(!1),We=g.useRef(null);g.useEffect(()=>{n(!0),s("");const ye=Ct(Ce,"products_candies"),$e=sr(ye,Sn("name","asc")),ze=Pd($e,Ke=>{const yt=[],ne={};Ke.forEach(st=>{const _t=st.data(),Ot=String(_t.barcode||"").trim()||void 0;Ot&&(ne[st.id]=Ot),yt.push({id:st.id,name:_t.name||"",category:_t.category||"",providerPrice:Number(_t.providerPrice||0),unitsPerPackage:Number(_t.unitsPerPackage||1),barcode:Ot,packaging:String(_t.packaging||_t.empaque||"").trim()||void 0,createdAt:_t.createdAt})});const Ue=Z.current||{};let rt=!1;for(const st of Object.keys(ne))if((ne[st]||"")!==(Ue[st]||"")){rt=!0;break}l(yt),Z.current=ne,n(!1),!Qe.current&&rt&&(s(" Catlogo actualizado."),setTimeout(()=>s(""),3e3)),Qe.current=!1},Ke=>{console.error(Ke),s(" Error sincronizando catlogo de dulces."),n(!1)});return()=>ze()},[t]);const Z=g.useRef({}),Qe=g.useRef(!0),at=g.useMemo(()=>{const ye=ls(Ae),$e=String(_e||"").trim(),ze=String(O||"").trim().toLowerCase();return ze?o.filter(Ke=>String(Ke.packaging||"").trim().toLowerCase()===ze):!ye&&!$e?o:o.filter(Ke=>{const yt=`${Ke.category} ${Ke.name}`.toLowerCase(),ne=ye?yt.includes(ye):!0,Ue=String(Ke.barcode||""),rt=$e?Ue.includes($e):!0;return ne&&rt})},[o,Ae,_e,O]),Ge=7,[ie,xe]=g.useState(1),de=g.useMemo(()=>{const ye={};return at.forEach($e=>{const ze=String($e.category||"(sin categora)").trim()||"(sin categora)";ye[ze]||(ye[ze]=[]),ye[ze].push($e)}),Object.entries(ye).map(([$e,ze])=>({category:$e,rows:ze.sort((Ke,yt)=>Ke.name.localeCompare(yt.name,"es"))})).sort(($e,ze)=>$e.category.localeCompare(ze.category,"es"))},[at]),Me=Math.max(1,Math.ceil((St?de.length:at.length)/Ge)),me=g.useMemo(()=>{const ye=(ie-1)*Ge;return at.slice(ye,ye+Ge)},[at,ie]),we=g.useMemo(()=>{const ye=(ie-1)*Ge;return de.slice(ye,ye+Ge)},[de,ie]);g.useEffect(()=>{xe(1)},[Ae,_e,O]),g.useEffect(()=>{xe(ye=>Math.min(ye,Me))},[Me]);const pt=()=>xe(1),vt=()=>xe(ye=>Math.max(1,ye-1)),bt=()=>xe(ye=>Math.min(Me,ye+1)),kt=()=>xe(Me),Vt=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:pt,disabled:ie===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:vt,disabled:ie===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",ie," de ",Me]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:bt,disabled:ie===Me,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:kt,disabled:ie===Me,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[at.length," producto(s)"]})]}),ke=ye=>{Oe($e=>({...$e,[ye]:!$e[ye]}))},Ne=g.useMemo(()=>{const ye=new Set;return o.forEach($e=>{const ze=String($e.category||"").trim();ze&&ye.add(ze)}),Array.from(ye).sort(($e,ze)=>$e.localeCompare(ze,"es"))},[o]),pe=()=>{u(""),f(""),h(0),p(1),v(""),b("")},Le=async ye=>{if(ye.preventDefault(),Ie.current||r)return;s("");const $e=String(c||"").trim(),ze=String(d||"").trim(),Ke=Math.max(0,Lh(A,0)),yt=w0(m,1),ne=String(x||"").trim();if(!$e)return s(" La categora es requerida.");if(!ze)return s(" El nombre del producto es requerido.");if(Ke<=0)return s(" El precio proveedor debe ser > 0.");if(yt<=0)return s(" Und x paquete debe ser > 0.");const Ue=`${ls($e)}::${ls(ze)}`,rt=Date.now();if(We.current&&We.current.key===Ue&&rt-We.current.ts<4e3){s(" Ya se est creando este producto.");return}if(o.some(_t=>ls(_t.category)===ls($e)&&ls(_t.name)===ls(ze)))return s(" Ya existe un producto con esa categora y nombre.");if(ne&&o.some(Ot=>String(Ot.barcode||"")===ne))return s(" Ya existe un producto con ese cdigo de barras.");Ie.current=!0,We.current={key:Ue,ts:rt};try{if(n(!0),!(await Ht(sr(Ct(Ce,"products_candies"),cr("category","==",$e),cr("name","==",ze),yS(1)))).empty){s(" Ya existe un producto con esa categora y nombre.");return}if(ne&&!(await Ht(sr(Ct(Ce,"products_candies"),cr("barcode","==",ne),yS(1)))).empty){s(" Ya existe un producto con ese cdigo de barras.");return}const Ot={category:$e,name:ze,providerPrice:Ke,unitsPerPackage:yt,createdAt:yr.now()};ne&&(Ot.barcode=ne);const nr=String(y||"").trim();nr&&(Ot.packaging=nr),await Gn(Ct(Ce,"products_candies"),Ot),s(" Producto creado."),pe()}catch(_t){console.error(_t),s(" Error creando producto.")}finally{n(!1),Ie.current=!1}},ft=ye=>{I(ye.id),C(ye.category),E(ye.name),k(ye.providerPrice),P(ye.unitsPerPackage||1),ce(String(ye.barcode||"")),le(String(ye.packaging||"")),s("")},At=()=>{I(null),C(""),E(""),k(0),P(1),ce(""),le("")},ct=async()=>{if(!w)return;s("");const ye=String(j||"").trim(),$e=String(S||"").trim(),ze=Math.max(0,Lh(B,0)),Ke=w0(T,1),yt=String(G||"").trim(),ne=String(ue||"").trim();if(!ye)return s(" La categora es requerida.");if(!$e)return s(" El nombre del producto es requerido.");if(ze<=0)return s(" El precio proveedor debe ser > 0.");if(Ke<=0)return s(" Und x paquete debe ser > 0.");if(o.some(rt=>rt.id!==w&&ls(rt.category)===ls(ye)&&ls(rt.name)===ls($e)))return s(" Ya existe otro producto con esa categora y nombre.");if(yt&&o.some(st=>st.id!==w&&String(st.barcode||"")===yt))return s(" Ya existe otro producto con ese cdigo de barras.");try{n(!0);const rt={category:ye,name:$e,providerPrice:ze,unitsPerPackage:Ke,updatedAt:yr.now()};rt.barcode=yt||"",rt.packaging=ne||"",await kn(Yt(Ce,"products_candies",w),rt),l(st=>st.map(_t=>_t.id===w?{..._t,category:ye,name:$e,providerPrice:ze,unitsPerPackage:Ke,barcode:yt||void 0,packaging:ne||void 0}:_t).sort((_t,Ot)=>_t.name.localeCompare(Ot.name,"es"))),St&&s(" Producto guardado."),At()}catch(rt){console.error(rt),s(" Error actualizando producto.")}finally{n(!1)}},W=async ye=>{if(confirm(`Eliminar "${ye.name}" (${ye.category}) del catlogo?`))try{n(!0),await Wn(Yt(Ce,"products_candies",ye.id)),l(ze=>ze.filter(Ke=>Ke.id!==ye.id)),s(" Producto eliminado.")}catch(ze){console.error(ze),s(" Error eliminando producto.")}finally{n(!1)}},z=()=>{const ye=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24,Empaque:"Tarro",Codigo:"7445074183182"}],$e=ha.json_to_sheet(ye),ze=ha.book_new();ha.book_append_sheet(ze,$e,"Productos");const Ke=E1(ze,{type:"array",bookType:"xlsx"}),yt=new Blob([Ke],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ne=URL.createObjectURL(yt),Ue=document.createElement("a");Ue.href=ne,Ue.download="template_productos_dulces.xlsx",document.body.appendChild(Ue),Ue.click(),Ue.remove(),URL.revokeObjectURL(ne)},re=ye=>{const $e=[],ze=[];ye.forEach((yt,ne)=>{if(!yt||typeof yt!="object"||EQe(yt))return;const Ue=String(sp(yt,["Id","ID","productId","docId"])??"").trim(),rt=String(sp(yt,["Categoria","Categora","Category","cat","category"])??"").trim(),st=String(sp(yt,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),_t=sp(yt,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),Ot=sp(yt,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),nr=sp(yt,["Codigo","Cdigo","Barcode","barcode","EAN","UPC","Code"]),Ir=String(nr??"").trim(),Qr=sp(yt,["Empaque","Packaging","PackagingType","Pack","Formato"]),or=String(Qr??"").trim(),kr=Math.max(0,Lh(_t,0)),Zr=w0(Ot,1),nn=ne+2;rt||ze.push(`Fila ${nn}: falta Categoria.`),st||ze.push(`Fila ${nn}: falta Producto/Nombre.`),kr<=0&&ze.push(`Fila ${nn}: PrecioProveedor debe ser > 0.`),Zr<=0&&ze.push(`Fila ${nn}: UnidadesPorPaquete debe ser > 0.`),rt&&st&&kr>0&&Zr>0&&$e.push({id:Ue||void 0,category:rt,name:st,providerPrice:kr,unitsPerPackage:Zr,barcode:Ir||void 0,packaging:or||void 0,_raw:yt})});const Ke=new Map;for(const yt of $e){const ne=yt.id?`id::${yt.id}`:`${ls(yt.category)}::${ls(yt.name)}`;Ke.set(ne,yt)}return{rows:Array.from(Ke.values()),errors:ze}},V=async ye=>{if(s(""),Ze([]),je([]),ee((ye==null?void 0:ye.name)||""),!ye)return;const $e=ye.name.toLowerCase(),ze=$e.endsWith(".xlsx")||$e.endsWith(".xls"),Ke=$e.endsWith(".csv");if(!ze&&!Ke){Ze(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Et(!0);const yt=new FileReader,ne=await new Promise((Ir,Qr)=>{yt.onerror=()=>Qr(new Error("No se pudo leer el archivo.")),yt.onload=()=>Ir(yt.result),yt.readAsArrayBuffer(ye)}),Ue=Gv(new Uint8Array(ne),{type:"array"}),rt=Ue.SheetNames[0],st=Ue.Sheets[rt],_t=ha.sheet_to_json(st,{defval:""}),{rows:Ot,errors:nr}=re(_t);je(Ot),Ze(nr),Ot.length===0&&nr.length===0&&Ze(["No se encontraron filas vlidas para importar."])}catch(yt){console.error(yt),Ze(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Et(!1)}},L=(ye,$e)=>{je(ze=>{const Ke=[...ze],yt=Ke[ye];return yt?(Ke[ye]={...yt,...$e},Ke):ze})},fe=async()=>{if(s(""),Se.length>0){s(" Correg los errores antes de importar.");return}if(Fe.length===0){s(" No hay filas para importar.");return}try{Et(!0);const ye={},$e={},ze={};o.forEach(Ue=>{ye[Ue.id]=Ue,$e[`${ls(Ue.category)}::${ls(Ue.name)}`]=Ue;const rt=String(Ue.barcode||"").trim();rt&&(ze[rt]=Ue)});const Ke=Ic(Ce);let yt=0,ne=0;for(const Ue of Fe){const rt=String(Ue.category||"").trim(),st=String(Ue.name||"").trim(),_t=Math.max(0,Lh(Ue.providerPrice,0)),Ot=w0(Ue.unitsPerPackage,1),nr=String(Ue.barcode||"").trim();if(!rt||!st||_t<=0||Ot<=0)continue;let Ir;if(Ue.id&&ye[Ue.id])Ir=ye[Ue.id];else{const Qr=`${ls(rt)}::${ls(st)}`;Ir=$e[Qr]}if(!Ir&&nr&&ze[nr]&&(Ir=ze[nr]),Ir){const Qr={category:rt,name:st,providerPrice:_t,unitsPerPackage:Ot,updatedAt:yr.now()};Ue.barcode!=null&&(Qr.barcode=nr||""),Ue.packaging!=null&&(Qr.packaging=String(Ue.packaging||"")||""),Ke.update(Yt(Ce,"products_candies",Ir.id),Qr),ne+=1}else{const Qr=Yt(Ct(Ce,"products_candies")),or={category:rt,name:st,providerPrice:_t,unitsPerPackage:Ot,createdAt:yr.now()};nr&&(or.barcode=nr),Ue.packaging&&(or.packaging=Ue.packaging),Ke.set(Qr,or),yt+=1}}await Ke.commit(),s(` Importacin lista. Creados: ${yt}, Actualizados: ${ne}`),Xe(!1),je([]),Ze([]),ee(""),e()}catch(ye){console.error(ye),s(" Error importando productos a Firestore.")}finally{Et(!1)}},Be=g.useMemo(()=>{const ye=new Set(o.map(ne=>ne.id)),$e=new Set(o.map(ne=>`${ls(ne.category)}::${ls(ne.name)}`)),ze=new Set(o.map(ne=>String(ne.barcode||"").trim()).filter(Boolean));let Ke=0,yt=0;for(const ne of Fe){if(ne.id&&ye.has(ne.id)){Ke+=1;continue}const Ue=`${ls(ne.category)}::${ls(ne.name)}`;if($e.has(Ue)){Ke+=1;continue}const rt=String(ne.barcode||"").trim();if(rt&&ze.has(rt)){Ke+=1;continue}yt+=1}return{willCreate:yt,willUpdate:Ke,total:Fe.length}},[Fe,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catalogo"}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Mc,{onClick:e,loading:r||ut}),!St&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Xe(!0),je([]),Ze([]),ee("")},children:"Importar"})]})})]}),St&&i.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-900 text-white",onClick:()=>Ut(ye=>!ye),children:Qt?"Ocultar creacin":"Crear producto"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Xe(!0),je([]),Ze([]),ee("")},children:"Importar"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-200",onClick:()=>Re(ye=>!ye),children:Tt?"Ocultar filtros":"Mostrar filtros"}),Tt&&i.jsxs("div",{className:"bg-white p-3 rounded shadow-sm border",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:ye=>H(ye.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),Qt&&i.jsxs("form",{onSubmit:Le,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:ye=>u(ye.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:d,onChange:ye=>f(ye.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:y,onChange:ye=>b(ye.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(A)?"":A,onChange:ye=>h(Math.max(0,Lh(ye.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:ye=>p(w0(ye.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo (opcional)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"w-full border rounded px-2 py-1",value:x,onChange:ye=>v(ye.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white hover:bg-black whitespace-nowrap",onClick:()=>{be("create"),Q(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"md:col-span-6 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:pe,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),Tt&&i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:Ae,onChange:ye=>ae(ye.target.value),placeholder:"Buscar por categora o producto"}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:ye=>H(ye.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:_e,onChange:ye=>De(ye.target.value),placeholder:"Ej: 7445074183182"}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("search"),Q(!0),Re(!0)},children:"Escanear producto"})}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ae(""),De("")},children:"Limpiar filtros"})})]}),i.jsxs("div",{className:"w-full md:w-auto text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:at.length})]})]}),St?i.jsxs("div",{className:"space-y-2",children:[r?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Cargando"}):at.length===0?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Sin productos."}):i.jsx("div",{className:"space-y-3",children:we.map(ye=>{const $e=!!ht[ye.category];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>ke(ye.category),"aria-expanded":$e,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:ye.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[ye.rows.length," producto(s)"]})]}),i.jsx("span",{className:`transition-transform ${$e?"rotate-180":""}`,children:""})]}),$e&&i.jsx("div",{className:"border-t p-2 space-y-2",children:ye.rows.map(ze=>{const Ke=w===ze.id,yt=Te===ze.id,ne=!!String(ze.barcode||"").trim();return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Ye(Ue=>Ue===ze.id?null:ze.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:ze.name}),i.jsx("div",{className:"text-xs text-gray-600 truncate",children:ze.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("div",{className:"font-bold tabular-nums",children:tT(ze.providerPrice)})]})]}),yt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Categora"}),Ke?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:j,onChange:Ue=>C(Ue.target.value)}):i.jsx("div",{className:"font-semibold",children:ze.category})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Und x paquete"}),Ke?i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:T,onChange:Ue=>P(w0(Ue.target.value,1))}):i.jsx("div",{className:"font-semibold text-right tabular-nums",children:ze.unitsPerPackage})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Empaque"}),Ke?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ue,onChange:Ue=>le(Ue.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"font-semibold",children:ze.packaging||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),Ke?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:Ue=>k(Math.max(0,Lh(Ue.target.value,0)))}):i.jsx("div",{className:"font-semibold tabular-nums",children:tT(ze.providerPrice)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Cdigo"}),Ke?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-1",value:G,onChange:Ue=>ce(Ue.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("edit"),Q(!0)},children:"Escanear"})]}):ne?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{Y(String(ze.barcode||"").trim()),R(!0)},children:"Ver cdigo"}):i.jsx("div",{className:"text-gray-600",children:"No"})]})]}),i.jsx("div",{className:"pt-2 flex gap-2",children:Ke?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-blue-600 text-white",onClick:ct,type:"button",children:"Guardar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("edit"),Q(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-200",onClick:At,type:"button",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400",onClick:()=>ft(ze),type:"button",children:"Editar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:()=>W(ze),type:"button",children:"Borrar"})]})})]})})]},ze.id)})})]},ye.category)})}),!r&&at.length>0&&Vt()]}):i.jsxs("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1050px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):at.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin productos."})}):me.map(ye=>{const $e=w===ye.id,ze=!!String(ye.barcode||"").trim();return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:$e?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:j,onChange:Ke=>C(Ke.target.value)}):ye.category}),i.jsx("td",{className:"p-2 border",children:$e?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:S,onChange:Ke=>E(Ke.target.value)}):ye.name}),i.jsx("td",{className:"p-2 border",children:$e?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ue,onChange:Ke=>le(Ke.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):ye.packaging||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:$e?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:Ke=>k(Math.max(0,Lh(Ke.target.value,0)))}):tT(ye.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:$e?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:T,onChange:Ke=>P(w0(Ke.target.value,1))}):ye.unitsPerPackage}),i.jsx("td",{className:"p-2 border text-center",children:$e?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:G,onChange:Ke=>ce(Ke.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-800 text-white hover:bg-black",onClick:()=>{be("edit"),Q(!0)},children:"Escanear"})]}):ze?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{Y(String(ye.barcode||"").trim()),R(!0)},children:"S"}):i.jsx("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-600",children:"No"})}),i.jsx("td",{className:"p-2 border",children:$e?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:ct,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:At,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>ft(ye),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>W(ye),type:"button",children:"Borrar"})]})})]},ye.id)})})]}),!r&&at.length>0&&Vt()]}),a?St&&a===" Producto guardado."?i.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[i.jsx("div",{className:"flex-1 text-sm",children:a}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white",onClick:()=>{s(""),At(),Q(!1)},children:"Aceptar"})]}):i.jsx("p",{className:"mt-2 text-sm",children:a}):null,i.jsx(SQe,{open:K,code:X,onClose:()=>R(!1)}),i.jsx(jQe,{open:D,onClose:()=>Q(!1),onDetected:async ye=>{const $e=String(ye||"").trim();if($e){if(te==="edit"&&w){if(o.some(Ke=>Ke.id!==w&&String(Ke.barcode||"")===$e)){s(" Ya existe otro producto con ese cdigo de barras."),ce($e),Q(!1);return}try{await kn(Yt(Ce,"products_candies",w),{barcode:$e}),l(Ke=>Ke.map(yt=>yt.id===w?{...yt,barcode:$e}:yt)),ce($e),St&&s(" Producto guardado.")}catch(Ke){console.error(Ke),s(" Error guardando cdigo de barras.")}finally{Q(!1)}return}if(te==="search"){De($e),Q(!1);return}te==="create"?v(ye):ce(ye)}}}),U&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Xe(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete, Empaque (opcional), Codigo (opcional)."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:z,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:ye=>{var $e;return V((($e=ye.target.files)==null?void 0:$e[0])||null)}}),se&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:se})]}),ut&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),Se.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:Se.slice(0,50).map((ye,$e)=>i.jsx("li",{children:ye},$e))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",Be.total," filas (Crear:"," ",Be.willCreate," / Actualizar:"," ",Be.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:fe,disabled:ut||Fe.length===0||Se.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1250px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Codigo (opcional)"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:Fe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):Fe.slice(0,300).map((ye,$e)=>{const ze=ye.id?o.some(Ue=>Ue.id===ye.id):!1,Ke=o.some(Ue=>`${ls(Ue.category)}::${ls(Ue.name)}`==`${ls(ye.category)}::${ls(ye.name)}`),yt=ye.barcode?o.some(Ue=>String(Ue.barcode||"")===ye.barcode):!1,ne=ze||Ke||yt;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ye.id||"",onChange:Ue=>L($e,{id:Ue.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ye.category,onChange:Ue=>L($e,{category:Ue.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:ye.name,onChange:Ue=>L($e,{name:Ue.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(ye.providerPrice)?"":ye.providerPrice,onChange:Ue=>L($e,{providerPrice:Math.max(0,Lh(Ue.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:ye.unitsPerPackage,onChange:Ue=>L($e,{unitsPerPackage:w0(Ue.target.value,1)})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ye.packaging||"",onChange:Ue=>L($e,{packaging:Ue.target.value.trim()||void 0}),placeholder:"Tarro, Bolsa..."})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ye.barcode||"",onChange:Ue=>L($e,{barcode:Ue.target.value.trim()||void 0}),placeholder:"EAN/UPC (opcional)"})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${ne?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:ne?"ACTUALIZA":"CREA"})})]},`${ye.id||""}-${$e}`)})})]}),i.jsx("datalist",{id:"categories-list",children:Ne.map(ye=>i.jsx("option",{value:ye},ye))})]}),Fe.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",Fe.length," filas (el import importa todas)."]})]})]})})]})}function Hse(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),a=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):a>0?Math.floor(a*e):0}function rT(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Hse(t)}const $se=t=>Math.max(0,Math.floor(Number(t??0)));function PQe(t){return $se(t.packages??t.totalPackages??t.packs??t.packagesInitial??t.initialPackages??0)}function TQe(t){return $se(t.remainingPackages??t.remainingPacks??t.packsRemaining??t.packagesRemaining??t.remaining_packages??0)}async function yF(t){const e=String(t||"").trim();if(!e)return{created:0,skipped:0,updated:0,totalItems:0};let r=Yt(Ce,"candy_main_orders",e),n=await gs(r);if(!n.exists()){const p=sr(Ct(Ce,"candy_main_orders"),cr("orderId","==",e)),x=await Ht(p);if(x.empty)throw new Error("Orden maestra no existe");r=x.docs[0].ref,n=x.docs[0]}const a=n.data(),s=r.id,o=Array.isArray(a.items)?a.items:[];if(!o.length)return{created:0,skipped:0,updated:0,totalItems:0};const l=await Ht(sr(Ct(Ce,"inventory_candies"),cr("orderId","==",s))),c=new Set,u=new Map;l.forEach(p=>{const x=p.data(),v=String(x.productId||"").trim();if(v&&c.add(v),!v)return;const y=u.get(v)||[];y.push({ref:p.ref,data:x}),u.set(v,y)});const d=Ic(Ce);let f=0,A=0,h=0;const m=String(a.date||"");for(const p of o){const x=String(p.id||p.productId||"").trim();if(!x)continue;const v=u.get(x)||[];if(v.length>0){if(v.length===1&&v.every(k=>{const T=Math.max(0,Math.floor(Number(k.data.remainingPackages||0))),P=Math.max(0,Math.floor(Number(k.data.remaining||0))),G=Math.max(0,Math.floor(Number(k.data.totalUnits||0)));return T<=0&&P<=0&&G<=0})){const k=v[0].ref,T=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),P=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),G=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let ce=Math.max(0,Math.floor(P||0)),ue=Math.max(0,Math.floor(G||0));ce<=0&&ue>0&&(ce=ue),ue<=0&&(ue=ce);const le=ce*T,Ae=ue*T;d.update(k,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:le,remaining:Ae,packages:ce,remainingPackages:ue,unitsPerPackage:T,totalUnits:le,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,status:"PENDIENTE",orderId:s,updatedAt:yr.now()}),h+=1;continue}A+=1;continue}const y=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),b=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),w=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let I=Math.max(0,Math.floor(b||0)),j=Math.max(0,Math.floor(w||0));I<=0&&j>0&&(I=j),j<=0&&(j=I);const C=I*y,S=j*y,E=Yt(Ct(Ce,"inventory_candies"));d.set(E,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:C,remaining:S,packages:I,remainingPackages:j,unitsPerPackage:y,totalUnits:C,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,createdAt:yr.now(),status:"PENDIENTE",orderId:s}),f+=1}return(f>0||h>0)&&await d.commit(),{created:f,skipped:A,updated:h,totalItems:o.length}}async function BQe(t){const e=Yt(Ce,"candy_main_orders",t);if((await gs(e)).exists())return e;const n=sr(Ct(Ce,"candy_main_orders"),cr("orderId","==",t)),a=await Ht(n);return a.empty?null:Yt(Ce,"candy_main_orders",a.docs[0].id)}async function nT(t){if(!t)return;const e=await BQe(t);if(!e)return;const r=sr(Ct(Ce,"inventory_candies"),cr("orderId","==",t)),n=await Ht(r),a=new Map;n.forEach(l=>{const c=l.data(),u=String(c.productId||"");if(!u)return;const d=PQe(c),f=TQe(c),A=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),v=h*d,y=m*d,b=p*d,w=x*d,I=y-v,j=b-v,C=w-v;a.has(u)||a.set(u,{productId:u,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:A,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const S=a.get(u);S.packages+=d,S.remainingPackages+=f,S.subtotal+=v,S.totalRivas+=y,S.totalSanJorge+=b,S.totalIsla+=w,S.gainRivas+=I,S.gainSanJorge+=j,S.gainIsla+=C,S.providerPrice=h,S.unitPriceRivas=m||S.unitPriceRivas,S.unitPriceSanJorge=p||S.unitPriceSanJorge,S.unitPriceIsla=x||S.unitPriceIsla,S.unitsPerPackage=A||S.unitsPerPackage,S.name=String(c.productName||S.name),S.category=String(c.category||S.category)});const s=Array.from(a.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=s.reduce((l,c)=>l+Number(c.packages||0),0);await kn(e,{totalPackages:o,items:s})}function kQe(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const a=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const s of a){const o=String(s.inventorySellerId||""),l=Math.max(0,Math.floor(Number(s.units??s.qty??s.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const a=e[n],s=Array.isArray(a==null?void 0:a.allocations)?a.allocations:[];for(const o of s){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function W2(t){const e=t.split("#")[0],r=Yt(Ce,"sales_candies",e),n=await gs(r);if(!n.exists())throw new Error("La venta no existe.");const a=n.data(),s=kQe(a);if(s&&s.allocations.length>0){let u=0;return await zs(Ce,async d=>{const f={};for(const p of s.allocations){const x=p.inventorySellerId,v=Math.max(0,Math.floor(Number(p.units||0)));!x||v<=0||(f[x]=(f[x]||0)+v,u+=v)}const h=Object.keys(f).map(p=>Yt(Ce,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>d.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=Number(v.remainingUnits??v.remaining??0),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),w=y+b,I=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),j=Math.floor(w/I);d.update(h[p],{remainingUnits:w,remainingPackages:j})}d.delete(r)}),{restored:u}}const o=[];if(Array.isArray(a.items)&&a.items.length>0){const u={};if(a.allocationsByItem&&typeof a.allocationsByItem=="object")for(const d of Object.keys(a.allocationsByItem)){const f=a.allocationsByItem[d],A=String((f==null?void 0:f.productId)||d||"");if(!A)continue;const h=Array.isArray(f==null?void 0:f.allocations)?f.allocations:[];u[A]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(a.allocationsByItem))for(const d of a.allocationsByItem){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];u[f]=A.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const d of a.items){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Math.max(0,Math.floor(Number((d==null?void 0:d.qty)||(d==null?void 0:d.quantity)||0))),h=Array.isArray(d==null?void 0:d.allocations)?d.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):u[f]||[];o.push({productId:f,productName:String((d==null?void 0:d.productName)||""),qty:A,allocations:h.length?h:void 0})}}else{const u=a.item||{},d=String(u.productId||a.productId||""),f=Math.max(0,Math.floor(Number(u.qty??a.quantity??0))),A=Array.isArray(a.allocations)?a.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];d&&f>0&&o.push({productId:d,productName:String(u.productName||a.productName||""),qty:f,allocations:A.length?A:void 0})}if(o.length===0)return await zs(Ce,async u=>{u.delete(r)}),{restored:0};if(o.every(u=>Array.isArray(u.allocations)&&u.allocations.length>0)){let u=0;return await zs(Ce,async d=>{const f=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));u+=p,f.push({ref:Yt(Ce,"inventory_candies",m.batchId),addBack:p})}const A=await Promise.all(f.map(h=>d.get(h.ref)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=rT(p),v=Math.max(0,Math.floor(Number(f[h].addBack||0))),y=x+v,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),w=Math.floor(y/b);d.update(f[h].ref,{remaining:y,remainingPackages:w,packages:w})}d.delete(r)}),{restored:u}}let c=0;return await zs(Ce,async u=>{const d={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=sr(Ct(Ce,"inventory_candies"),cr("productId","==",p.productId)),y=(await Ht(x)).docs.map(b=>{const w=b.data(),I=Hse(w),j=rT(w);return{id:b.id,date:String(w.date||""),baseUnits:I,remaining:j}}).sort((b,w)=>b.date.localeCompare(w.date));d[p.productId]=y}const f=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,f.push({id:y.batchId,addBack:b})}continue}const x=d[p.productId]||[];let v=p.qty;for(const y of x){if(v<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const w=Math.min(b,v);f.push({id:y.id,addBack:w}),c+=w,v-=w}for(const y of x){if(v<=0)break;const b=Math.min(v,p.qty);f.push({id:y.id,addBack:b}),c+=b,v-=b}}const A={};for(const p of f)A[p.id]=(A[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(A).map(p=>Yt(Ce,"inventory_candies",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=rT(v),b=Math.max(0,Math.floor(Number(A[h[p].id]||0))),w=y+b,I=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),j=Math.floor(w/I);u.update(h[p],{remaining:w,remainingPackages:j,packages:j})}u.delete(r)}),{restored:c}}async function FQe(t){return W2(t)}const yc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function aT(t){return isFinite(t)?Math.round(t):0}function tf(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function sT(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function OQe(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const a=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-a}function DQe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,I]=g.useState(0),[j,C]=g.useState(!1),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState([]);g.useEffect(()=>{(async()=>{try{s(!0);const X=await Ht(Ct(Ce,"products_candies")),Y=[];X.forEach(be=>{const U=be.data();Y.push({id:be.id,name:U.name??"(sin nombre)",category:U.category??"(sin categora)"})}),e(Y);const D=sr(Ct(Ce,"inventory_candies"),Sn("date","desc")),Q=await Ht(D),te=[];Q.forEach(be=>{const U=be.data(),Xe=Number(U.unitsPerPackage||0),se=Number(U.totalUnits??U.quantity??(U.packages||0)*(U.unitsPerPackage||0)),ee=Number(U.remaining??U.totalUnits??se??0);te.push({id:be.id,productId:U.productId,productName:U.productName,category:U.category,measurement:U.measurement??"unidad",packages:Number(U.packages||0),unitsPerPackage:Xe,totalUnits:se,remaining:ee,remainingPackages:typeof U.remainingPackages=="number"?Number(U.remainingPackages):void 0,providerPrice:Number(U.providerPrice||0),subtotal:Number(U.subtotal||0),totalRivas:Number(U.totalRivas||0),totalSanJorge:Number(U.totalSanJorge||0),totalIsla:Number(U.totalIsla||0),gainRivas:Number(U.gainRivas||0),gainSanJorge:Number(U.gainSanJorge||0),gainIsla:Number(U.gainIsla||0),unitPriceRivas:Number(U.unitPriceRivas||0),unitPriceSanJorge:Number(U.unitPriceSanJorge||0),unitPriceIsla:Number(U.unitPriceIsla||0),date:U.date,createdAt:U.createdAt,status:U.status??"PENDIENTE",orderId:U.orderId??null})}),n(te)}catch(X){console.error(X),l(" Error cargando inventario.")}finally{s(!1)}})()},[]);const G=g.useMemo(()=>r.filter(X=>!(c&&X.date<c||d&&X.date>d||A&&X.productId!==A||m&&String(X.category||"")!==m)),[r,c,d,A,m]),ce=g.useMemo(()=>{const X=new Set;for(const Y of t)Y.category&&X.add(Y.category);return Array.from(X).sort((Y,D)=>Y.localeCompare(D))},[t]),ue=g.useMemo(()=>{const X=G.reduce((U,Xe)=>U+tf(Xe),0),Y=G.reduce((U,Xe)=>U+sT(Xe),0),D=G.reduce((U,Xe)=>{const se=tf(Xe);return U+Number(Xe.providerPrice||0)*se},0),Q=G.reduce((U,Xe)=>{const se=tf(Xe);return U+Number(Xe.unitPriceRivas||0)*se},0),te=G.reduce((U,Xe)=>{const se=tf(Xe);return U+Number(Xe.unitPriceSanJorge||0)*se},0),be=G.reduce((U,Xe)=>{const se=tf(Xe);return U+Number(Xe.unitPriceIsla||0)*se},0);return{totalPaquetes:X,totalPaquetesRestantes:Y,totalSubtotal:D,totalRivas:Q,totalSJ:te,totalIsla:be}},[G]),le=g.useMemo(()=>{let X=0,Y=0;for(const D of G)D.status==="PENDIENTE"&&(X+=1),D.status==="PAGADO"&&(Y+=1);return{totalLotes:G.length,pendientes:X,pagados:Y}},[G]),Ae=g.useMemo(()=>{const X=new Map;for(const D of G){const Q=String(D.productId||"");Q&&(X.has(Q)||X.set(Q,{batches:[]}),X.get(Q).batches.push(D))}const Y=[];for(const[D,Q]of X.entries()){const te=[...Q.batches].sort(OQe),be=te[0],U=te.reduce((Qt,Ut)=>Qt+tf(Ut),0),Xe=te.reduce((Qt,Ut)=>Qt+sT(Ut),0),se=Number((be==null?void 0:be.providerPrice)||0),ee=Number((be==null?void 0:be.unitPriceRivas)||0),Fe=Number((be==null?void 0:be.unitPriceIsla)||0),je=te.reduce((Qt,Ut)=>{const Tt=tf(Ut);return Qt+Number(Ut.providerPrice||0)*Tt},0),Se=te.reduce((Qt,Ut)=>{const Tt=tf(Ut);return Qt+Number(Ut.unitPriceRivas||0)*Tt},0),Ze=te.reduce((Qt,Ut)=>{const Tt=tf(Ut);return Qt+Number(Ut.unitPriceIsla||0)*Tt},0),ut=Se-je,Et=Ze-je;let St="",Ft;for(const Qt of te)(!St||String(Qt.date||"")>St)&&(St=String(Qt.date||""),Ft=Qt.createdAt);Y.push({productId:D,productName:(be==null?void 0:be.productName)||"",category:(be==null?void 0:be.category)||"",totalPackages:U,remainingPackages:Xe,providerPrice:se,unitPriceRivas:ee,unitPriceIsla:Fe,subtotal:je,totalRivas:Se,totalIsla:Ze,gainRivas:ut,gainIsla:Et,lastDate:St,lastCreatedAt:Ft,batchCount:te.length})}return Y.sort((D,Q)=>String(Q.lastDate).localeCompare(String(D.lastDate))),Y},[G]),ae=X=>{v(X.id),b(X.date),I(X.providerPrice),l("")},_e=()=>{v(null),b(""),I(0)},De=async()=>{if(!x)return;const X=r.find(Ze=>Ze.id===x);if(!X)return;if(w<0){l("El precio proveedor no puede ser negativo.");return}const Y=tf(X),D=w*Y,Q=Y>0?D/.8:0,te=Y>0?D/.85:0,be=Y>0?D/.7:0,U=Q-D,Xe=te-D,se=be-D,ee=Y>0?aT(Q/Y):0,Fe=Y>0?aT(te/Y):0,je=Y>0?aT(be/Y):0,Se=Yt(Ce,"inventory_candies",x);await kn(Se,{date:y,providerPrice:w,subtotal:D,totalRivas:Q,totalSanJorge:te,totalIsla:be,gainRivas:U,gainSanJorge:Xe,gainIsla:se,unitPriceRivas:ee,unitPriceSanJorge:Fe,unitPriceIsla:je}),n(Ze=>Ze.map(ut=>ut.id===x?{...ut,date:y,providerPrice:w,subtotal:D,totalRivas:Q,totalSanJorge:te,totalIsla:be,gainRivas:U,gainSanJorge:Xe,gainIsla:se,unitPriceRivas:ee,unitPriceSanJorge:Fe,unitPriceIsla:je}:ut)),X.orderId&&await nT(String(X.orderId)),l(" Lote de dulces actualizado"),_e()},O=async X=>{confirm(`Marcar PAGADO el lote del ${X.date} (${X.productName})?`)&&(await kn(Yt(Ce,"inventory_candies",X.id),{status:"PAGADO"}),n(D=>D.map(Q=>Q.id===X.id?{...Q,status:"PAGADO"}:Q)),l(" Lote marcado como pagado"))},H=async X=>{confirm(`Eliminar el lote del ${X.date} (${X.productName})?`)&&(await Wn(Yt(Ce,"inventory_candies",X.id)),n(D=>D.filter(Q=>Q.id!==X.id)),X.orderId&&await nT(String(X.orderId)),l(" Lote eliminado"))},K=async(X,Y)=>{try{s(!0),l("");const D=sr(Ct(Ce,"inventory_candies"),cr("productId","==",X),Sn("date","desc")),Q=await Ht(D),te=[];Q.forEach(be=>{const U=be.data(),Xe=Number(U.unitsPerPackage||0),se=Number(U.totalUnits??U.quantity??(U.packages||0)*(U.unitsPerPackage||0)),ee=Number(U.remaining??U.totalUnits??se??0);te.push({id:be.id,productId:U.productId,productName:U.productName,category:U.category,measurement:U.measurement??"unidad",packages:Number(U.packages||0),unitsPerPackage:Xe,totalUnits:se,remaining:ee,remainingPackages:typeof U.remainingPackages=="number"?Number(U.remainingPackages):void 0,providerPrice:Number(U.providerPrice||0),subtotal:Number(U.subtotal||0),totalRivas:Number(U.totalRivas||0),totalSanJorge:Number(U.totalSanJorge||0),totalIsla:Number(U.totalIsla||0),gainRivas:Number(U.gainRivas||0),gainSanJorge:Number(U.gainSanJorge||0),gainIsla:Number(U.gainIsla||0),unitPriceRivas:Number(U.unitPriceRivas||0),unitPriceSanJorge:Number(U.unitPriceSanJorge||0),unitPriceIsla:Number(U.unitPriceIsla||0),date:U.date,createdAt:U.createdAt,status:U.status??"PENDIENTE",orderId:U.orderId??null})}),E(X),k(Y),P(te),C(!0)}catch(D){console.error(D),l(" Error abriendo detalle del producto.")}finally{s(!1)}},R=async(X,Y)=>{const D=r.filter(te=>te.productId===X);if(confirm(`Eliminar COMPLETAMENTE "${Y}"?
Esto eliminar ${D.length} lote(s) de este producto.`))try{s(!0),l("");const te=Array.from(new Set(D.map(be=>be.orderId?String(be.orderId):"").filter(Boolean)));for(const be of D)await Wn(Yt(Ce,"inventory_candies",be.id));n(be=>be.filter(U=>U.productId!==X)),l(" Producto eliminado (todos sus lotes).");for(const be of te)await nT(be);j&&S===X&&(C(!1),P([]),E(""),k(""))}catch(te){console.error(te),l(" Error eliminando lotes del producto.")}finally{s(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:X=>u(X.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:X=>f(X.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:X=>p(X.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),ce.map(X=>i.jsx("option",{value:X,children:X},X))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:X=>h(X.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(X=>i.jsxs("option",{value:X.id,children:[X.name,"  ",X.category]},X.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",le.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",le.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",le.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ue.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ue.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",yc(ue.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",yc(ue.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",yc(ue.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",yc(ue.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):Ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):Ae.map(X=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:X.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:X.productName,children:X.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",X.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:X.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:X.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:yc(X.gainIsla)}),i.jsx("td",{className:"p-2 border",children:X.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>K(X.productId,X.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>R(X.productId,X.productName),children:"Borrar"})]})})]},X.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",B||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",S]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{C(!1),P([]),E(""),k(""),_e()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):T.map(X=>{const Y=x===X.id,D=tf(X),Q=sT(X);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:Y?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:te=>b(te.target.value)}):X.date}),i.jsx("td",{className:"p-2 border align-top",children:X.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:X.productName,children:X.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",X.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:D}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Q}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:X.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Y?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(w)?"":w,onChange:te=>I(Math.max(0,parseFloat(te.target.value||"0")))}):yc(X.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:yc(X.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:yc(X.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:X.orderId?String(X.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${X.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:X.status})}),i.jsx("td",{className:"p-2 border align-top",children:Y?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:De,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:_e,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[X.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>O(X),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>ae(X),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>H(X),children:"Borrar"})]})})]},X.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>R(S,B),children:"Borrar producto (todos los lotes)"})})]})})]})}const iT=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Ho=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Sy(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function dG(t){const e=sr(Ct(Ce,"ar_movements"),cr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Wn(Yt(Ce,"ar_movements",n.id))))}function RQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=En(a,"vendedor_dulces"),l=En(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(!1),[j,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),T=async ge=>{var it;I(!0),C(!0),E(ge),k([]);try{const Pt=await gs(Yt(Ce,"sales_candies",ge));let wt=null;Pt.exists()?wt=Pt.data():wt=(it=(await Ht(sr(Ct(Ce,"sales_candies"),cr("name","==",ge)))).docs[0])==null?void 0:it.data();let Nt=[];if(Array.isArray(wt==null?void 0:wt.items))Nt=wt.items;else if(wt!=null&&wt.items&&typeof wt.items=="object")try{Nt=Object.values(wt.items)}catch{Nt=[]}else wt!=null&&wt.item&&(Nt=[wt.item]);const It=Nt.map(qt=>({productName:String(qt.productName||""),qty:Number(qt.packages??qt.qty??qt.quantity??0),unitPrice:Number(qt.unitPricePackage??qt.unitPrice??qt.price??0),discount:Number(qt.discount||0),total:Number(qt.total??qt.lineFinal??qt.amount??0)}));k(It)}catch(Pt){console.error(Pt)}finally{C(!1)}},[P,G]=g.useState(""),[ce,ue]=g.useState("+505 "),[le,Ae]=g.useState(""),[ae,_e]=g.useState(""),[De,O]=g.useState("ACTIVO"),[H,K]=g.useState(0),[R,X]=g.useState(""),[Y,D]=g.useState(0),[Q,te]=g.useState([]),[be,U]=g.useState(!0),[Xe,se]=g.useState(""),ee=10,[Fe,je]=g.useState(1),[Se,Ze]=g.useState(null),[ut,Et]=g.useState(""),[St,Ft]=g.useState("+505 "),[Qt,Ut]=g.useState(""),[Tt,Re]=g.useState(""),[Te,Ye]=g.useState("ACTIVO"),[ht,Oe]=g.useState(0),[Ie,We]=g.useState(""),[Z,Qe]=g.useState(!1),[at,Ge]=g.useState(null),[ie,xe]=g.useState(!1),[de,Me]=g.useState([]),[me,we]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[pt,vt]=g.useState(!1),[bt,kt]=g.useState(0),[Vt,ke]=g.useState(new Date().toISOString().slice(0,10)),[Ne,pe]=g.useState(""),[Le,ft]=g.useState(!1),[At,ct]=g.useState(null),[W,z]=g.useState(""),[re,V]=g.useState(0),[L,fe]=g.useState(""),[Be,ye]=g.useState(!1),[$e,ze]=g.useState(null),[Ke,yt]=g.useState(!1),[ne,Ue]=g.useState(!1),[rt,st]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(U(!0),o&&!s){te([]),se(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const ge=await Ht(Ct(Ce,"sellers_candies")),it=[];ge.forEach(It=>{const qt=It.data(),Mt=String(qt.status||"ACTIVO");Mt==="ACTIVO"&&it.push({id:It.id,name:String(qt.name||""),status:Mt})}),u(it);const Pt=o?sr(Ct(Ce,"customers_candies"),cr("vendorId","==",s),Sn("createdAt","desc")):sr(Ct(Ce,"customers_candies"),Sn("createdAt","desc")),wt=await Ht(Pt),Nt=[];wt.forEach(It=>{const qt=It.data();Nt.push({id:It.id,name:qt.name??"",phone:qt.phone??"+505 ",place:qt.place??"",notes:qt.notes??"",status:qt.status??"ACTIVO",creditLimit:Number(qt.creditLimit??0),createdAt:qt.createdAt??yr.now(),balance:0,sellerId:qt.sellerId||"",vendorId:qt.vendorId||"",vendorName:qt.vendorName||"",initialDebt:Number(qt.initialDebt||0),initialDebtDate:String(qt.initialDebtDate||"").trim(),lastAbonoDate:"",lastAbonoAmount:0})});for(const It of Nt)try{const qt=sr(Ct(Ce,"ar_movements"),cr("customerId","==",It.id)),Mt=await Ht(qt);let zt=0,ar=null;const wr=[];Mt.forEach(Wr=>{var Pr,Tn,wn;const Vr=Wr.data(),jr=Number(Vr.amount||0);zt+=jr;const pr=Vr.date??((Tn=(Pr=Vr.createdAt)==null?void 0:Pr.toDate)!=null&&Tn.call(Pr)?Vr.createdAt.toDate().toISOString().slice(0,10):"");if(wr.push({id:Wr.id,date:pr,type:Vr.type??(jr<0?"ABONO":"CARGO"),amount:jr,ref:Vr.ref||{},comment:Vr.comment||"",createdAt:Vr.createdAt}),jr<0){const gn=(wn=Vr.createdAt)!=null&&wn.seconds?Number(Vr.createdAt.seconds):0;(!ar||gn>=ar.ts)&&(ar={date:pr,amount:Math.abs(jr),ts:gn})}});const dr=Number(It.initialDebt||0),Rt=kr(dr,String(It.initialDebtDate||""),wr);It.balance=Rt+zt,ar?(It.lastAbonoDate=ar==null?void 0:ar.date,It.lastAbonoAmount=ar==null?void 0:ar.amount):(It.lastAbonoDate="",It.lastAbonoAmount=0)}catch{It.balance=Number(It.initialDebt||0),It.lastAbonoDate="",It.lastAbonoAmount=0}te(Nt)}catch(ge){console.error(ge),se(" Error cargando clientes.")}finally{U(!1)}})()},[o,s]);const _t=()=>{G(""),ue("+505 "),Ae(""),_e(""),O("ACTIVO"),K(0),X(""),D(0)},Ot=async ge=>{var Nt;if(ge.preventDefault(),se(""),!P.trim()){se("Ingresa el nombre.");return}const it=Sy(ce);if(it.length<6){se("Telfono incompleto.");return}const Pt=o?s:String(R||"").trim(),wt=Pt&&((Nt=c.find(It=>It.id===Pt))==null?void 0:Nt.name)||"";try{const It=Number(Y||0),qt=await Gn(Ct(Ce,"customers_candies"),{name:P.trim(),phone:it,place:le||"",notes:ae||"",status:De,creditLimit:Number(H||0),vendorId:Pt,vendorName:wt,initialDebt:It,createdAt:yr.now()});te(Mt=>[{id:qt.id,name:P.trim(),phone:it,place:le||"",notes:ae||"",status:De,creditLimit:Number(H||0),vendorId:Pt,vendorName:wt,initialDebt:It,createdAt:yr.now(),balance:It,lastAbonoDate:"",lastAbonoAmount:0},...Mt]),_t(),ye(!1),se(" Cliente creado")}catch(It){console.error(It),se(" Error al crear cliente")}},nr=ge=>{if(o){se(" No permitido: vendedores no editan clientes desde el listado.");return}Ze(ge.id),Et(ge.name),Ft(ge.phone||"+505 "),Ut(ge.place||""),Re(ge.notes||""),Ye(ge.status||"ACTIVO"),Oe(Number(ge.creditLimit||0)),We(String(ge.vendorId||""))},Ir=()=>{Ze(null),Et(""),Ft("+505 "),Ut(""),Re(""),Ye("ACTIVO"),Oe(0),We("")},Qr=async()=>{var qt;if(o){se(" No permitido.");return}if(!Se)return;const ge=Sy(St);if(!ut.trim()){se("Ingresa el nombre.");return}const it=Q.find(Mt=>Mt.id===Se),Pt=String((it==null?void 0:it.vendorId)||""),wt=o?s:String(Ie||"");if(o&&Pt&&Pt!==s){se(" Este cliente pertenece a otro vendedor.");return}if(l&&Pt&&wt&&Pt!==wt){se(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const Nt=o?s:String(Ie||""),It=Nt&&((qt=c.find(Mt=>Mt.id===Nt))==null?void 0:qt.name)||"";try{await kn(Yt(Ce,"customers_candies",Se),{name:ut.trim(),phone:ge,place:Qt||"",notes:Tt||"",status:Te,creditLimit:Number(ht||0),vendorId:Nt,vendorName:It}),te(Mt=>Mt.map(zt=>zt.id===Se?{...zt,name:ut.trim(),phone:ge,place:Qt||"",notes:Tt||"",status:Te,creditLimit:Number(ht||0),vendorId:Nt,vendorName:It}:zt)),Ir(),se(" Cliente actualizado")}catch(Mt){console.error(Mt),se(" Error al actualizar")}},or=async ge=>{if(confirm(`Eliminar al cliente "${ge.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{U(!0);const Pt=sr(Ct(Ce,"sales_candies"),cr("customerId","==",ge.id)),wt=await Ht(Pt);for(const qt of wt.docs){const Mt=qt.id;try{await W2(Mt)}catch(zt){console.warn("restoreSaleAndDeleteCandy error",zt);try{await Wn(Yt(Ce,"sales_candies",Mt))}catch{}}await dG(Mt)}const Nt=sr(Ct(Ce,"ar_movements"),cr("customerId","==",ge.id)),It=await Ht(Nt);await Promise.all(It.docs.map(qt=>Wn(Yt(Ce,"ar_movements",qt.id)))),await Wn(Yt(Ce,"customers_candies",ge.id)),te(qt=>qt.filter(Mt=>Mt.id!==ge.id)),se(" Cliente eliminado y dulces devueltos al inventario")}catch(Pt){console.error(Pt),se(" No se pudo eliminar el cliente.")}finally{U(!1)}},kr=(ge,it,Pt)=>{const wt=Number(ge||0);if(!wt)return 0;const Nt=String(it||"").trim();return Nt&&Pt.some(qt=>{var dr;const Mt=Number(qt.amount||0);if(!(Mt>0))return!1;const zt=Math.abs(Mt-wt)<.01,ar=String(qt.date||"").trim()===Nt,wr=!!((dr=qt.ref)!=null&&dr.saleId);return zt&&ar&&wr})?0:wt},Zr=(ge,it,Pt)=>{const wt=ge.reduce((zt,ar)=>zt+(Number(ar.amount)||0),0),Nt=ge.filter(zt=>Number(zt.amount)<0).reduce((zt,ar)=>zt+Math.abs(Number(ar.amount)||0),0),It=ge.filter(zt=>Number(zt.amount)>0).reduce((zt,ar)=>zt+(Number(ar.amount)||0),0),qt=kr(it,Pt,ge),Mt=Number(qt||0)+wt;we({saldoActual:Mt,totalAbonado:Nt,totalCargos:Number(qt||0)+It,saldoRestante:Mt})},nn=async ge=>{Ge(ge),Me([]),we({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),Qe(!0),yt(!1),Ue(!1),st(null),vt(!1),kt(0),ke(new Date().toISOString().slice(0,10)),pe(""),ct(null),xe(!0);try{const it=sr(Ct(Ce,"ar_movements"),cr("customerId","==",ge.id)),Pt=await Ht(it),wt=[];Pt.forEach(Nt=>{var zt,ar;const It=Nt.data(),qt=It.date??((ar=(zt=It.createdAt)==null?void 0:zt.toDate)!=null&&ar.call(zt)?It.createdAt.toDate().toISOString().slice(0,10):""),Mt=Number(It.amount||0);wt.push({id:Nt.id,date:qt,type:It.type??(Mt<0?"ABONO":"CARGO"),amount:Mt,ref:It.ref||{},comment:It.comment||"",createdAt:It.createdAt})}),wt.sort((Nt,It)=>{var zt,ar;if(Nt.date!==It.date)return Nt.date.localeCompare(It.date);const qt=((zt=Nt.createdAt)==null?void 0:zt.seconds)||0,Mt=((ar=It.createdAt)==null?void 0:ar.seconds)||0;return qt-Mt}),Me(wt),Zr(wt,Number(ge.initialDebt||0),String(ge.initialDebtDate||""))}catch(it){console.error(it),se(" No se pudo cargar el estado de cuenta")}finally{xe(!1)}},_r=ge=>{const it=ge.filter(Pt=>Number(Pt.amount)<0).map(Pt=>{var wt;return{date:Pt.date,amount:Math.abs(Number(Pt.amount||0)),ts:((wt=Pt.createdAt)==null?void 0:wt.seconds)||0}}).sort((Pt,wt)=>(Pt.ts||0)-(wt.ts||0));return it.length?it[it.length-1]:null},He=g.useMemo(()=>kr(Number((at==null?void 0:at.initialDebt)||0),String((at==null?void 0:at.initialDebtDate)||""),de),[at==null?void 0:at.initialDebt,at==null?void 0:at.initialDebtDate,de]),Bt=async()=>{if(!at)return;se("");const ge=Number(bt||0);if(!(ge>0)){se("Ingresa un monto de abono mayor a 0.");return}const it=parseFloat(ge.toFixed(2));if(!Vt){se("Selecciona la fecha del abono.");return}try{ft(!0);const Pt={customerId:at.id,type:"ABONO",amount:-it,date:Vt,comment:Ne||"",createdAt:yr.now()},Nt={id:(await Gn(Ct(Ce,"ar_movements"),Pt)).id,date:Vt,type:"ABONO",amount:-it,comment:Ne||"",createdAt:yr.now()},It=[...de,Nt].sort((ar,wr)=>{var Wr,Vr;if(ar.date!==wr.date)return ar.date.localeCompare(wr.date);const dr=((Wr=ar.createdAt)==null?void 0:Wr.seconds)||0,Rt=((Vr=wr.createdAt)==null?void 0:Vr.seconds)||0;return dr-Rt});Me(It),Zr(It,Number(at.initialDebt||0),String(at.initialDebtDate||""));const qt=It.reduce((ar,wr)=>ar+(Number(wr.amount)||0),0),Mt=kr(Number(at.initialDebt||0),String(at.initialDebtDate||""),It),zt=Number(Mt||0)+qt;te(ar=>ar.map(wr=>wr.id!==at.id?wr:{...wr,balance:zt,lastAbonoDate:Vt,lastAbonoAmount:it})),Ge(ar=>ar&&{...ar,balance:zt,lastAbonoDate:Vt,lastAbonoAmount:it}),kt(0),pe(""),ke(new Date().toISOString().slice(0,10)),vt(!1),se(" Abono registrado")}catch(Pt){console.error(Pt),se(" Error al registrar el abono")}finally{ft(!1)}},xr=ge=>{ct(ge.id),z(ge.date||new Date().toISOString().slice(0,10)),V(Math.abs(Number(ge.amount||0))),fe(ge.comment||"")},dn=()=>{ct(null),z(""),V(0),fe("")},Jr=async()=>{if(!At||!at)return;const ge=de.findIndex(Nt=>Nt.id===At);if(ge===-1)return;const it=de[ge],Pt=Number(re||0);if(!(Pt>0)){se("El monto debe ser mayor a 0.");return}const wt=it.type==="ABONO"?-parseFloat(Pt.toFixed(2)):+parseFloat(Pt.toFixed(2));try{await kn(Yt(Ce,"ar_movements",At),{date:W,amount:wt,comment:L||""});const Nt=[...de];Nt[ge]={...it,date:W,amount:wt,comment:L||""},Nt.sort((ar,wr)=>{var Wr,Vr;if(ar.date!==wr.date)return ar.date.localeCompare(wr.date);const dr=((Wr=ar.createdAt)==null?void 0:Wr.seconds)||0,Rt=((Vr=wr.createdAt)==null?void 0:Vr.seconds)||0;return dr-Rt}),Me(Nt),Zr(Nt,Number(at.initialDebt||0),String(at.initialDebtDate||""));const It=Nt.reduce((ar,wr)=>ar+(Number(wr.amount)||0),0),qt=kr(Number(at.initialDebt||0),String(at.initialDebtDate||""),Nt),Mt=Number(qt||0)+It,zt=_r(Nt);te(ar=>ar.map(wr=>wr.id===at.id?{...wr,balance:Mt,lastAbonoDate:(zt==null?void 0:zt.date)||"",lastAbonoAmount:(zt==null?void 0:zt.amount)||0}:wr)),Ge(ar=>ar&&{...ar,balance:Mt,lastAbonoDate:(zt==null?void 0:zt.date)||"",lastAbonoAmount:(zt==null?void 0:zt.amount)||0}),dn(),se(" Movimiento actualizado")}catch(Nt){console.error(Nt),se(" Error al actualizar movimiento")}},br=async ge=>{var Pt,wt;if(confirm(`Eliminar este movimiento (${ge.type==="ABONO"?"Abono":"Compra"}) del ${ge.date}?${ge.type==="CARGO"&&((Pt=ge.ref)!=null&&Pt.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`)&&at)try{if(U(!0),ge.type==="CARGO"&&((wt=ge.ref)!=null&&wt.saleId)){try{await W2(ge.ref.saleId)}catch(ar){console.warn("restoreSaleAndDeleteCandy error",ar),U(!1),se(" No se pudo devolver inventario de la venta.");return}await dG(ge.ref.saleId)}else await Wn(Yt(Ce,"ar_movements",ge.id));const Nt=de.filter(ar=>{var wr,dr;return ge.type==="CARGO"&&((wr=ge.ref)!=null&&wr.saleId)?((dr=ar.ref)==null?void 0:dr.saleId)!==ge.ref.saleId:ar.id!==ge.id});Me(Nt),Zr(Nt,Number(at.initialDebt||0),String(at.initialDebtDate||""));const It=Nt.reduce((ar,wr)=>ar+(Number(wr.amount)||0),0),qt=kr(Number(at.initialDebt||0),String(at.initialDebtDate||""),Nt),Mt=Number(qt||0)+It,zt=_r(Nt);te(ar=>ar.map(wr=>wr.id===at.id?{...wr,balance:Mt,lastAbonoDate:(zt==null?void 0:zt.date)||"",lastAbonoAmount:(zt==null?void 0:zt.amount)||0}:wr)),Ge(ar=>ar&&{...ar,balance:Mt,lastAbonoDate:(zt==null?void 0:zt.date)||"",lastAbonoAmount:(zt==null?void 0:zt.amount)||0}),st(null),se(" Movimiento eliminado")}catch(Nt){console.error(Nt),se(" Error al eliminar movimiento")}finally{U(!1)}},er=g.useMemo(()=>[...Q].sort((ge,it)=>{var Pt,wt;return ge.status!==it.status?ge.status==="BLOQUEADO"?1:-1:(((Pt=it.createdAt)==null?void 0:Pt.seconds)||0)-(((wt=ge.createdAt)==null?void 0:wt.seconds)||0)}),[Q]),ir=ge=>ge==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",Sr=g.useMemo(()=>{const ge=A.trim().toLowerCase(),it=x.trim()===""?null:Number(x),Pt=y.trim()===""?null:Number(y);return er.filter(wt=>{const Nt=!ge||String(wt.name||"").toLowerCase().includes(ge),It=!m||wt.status===m,qt=Number(wt.balance||0),Mt=it===null||!Number.isNaN(it)&&qt>=it,zt=Pt===null||!Number.isNaN(Pt)&&qt<=Pt;return Nt&&It&&Mt&&zt})},[er,A,m,x,y]),vr=Math.max(1,Math.ceil(Sr.length/ee)),Fr=g.useMemo(()=>{const ge=(Fe-1)*ee;return Sr.slice(ge,ge+ee)},[Sr,Fe]);g.useEffect(()=>{je(1)},[A,m,x,y]);const jn=()=>je(1),he=()=>je(ge=>Math.max(1,ge-1)),tt=()=>je(ge=>Math.min(vr,ge+1)),nt=()=>je(vr),lt=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:jn,disabled:Fe===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:he,disabled:Fe===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",Fe," de ",vr]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:tt,disabled:Fe===vr,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:nt,disabled:Fe===vr,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[Sr.length," cliente(s)"]})]});return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{ye(!0),o&&X(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border w-full md:w-auto",onClick:()=>f(ge=>!ge),children:d?"Ocultar filtros":"Mostrar filtros"}),d&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl p-3 grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:ge=>h(ge.target.value),placeholder:"Buscar por nombre"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ge=>p(ge.target.value||""),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mn."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:x,onChange:ge=>v(ge.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mx."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:y,onChange:ge=>b(ge.target.value),placeholder:""})]})]}),i.jsx("div",{className:"md:col-span-4 flex flex-wrap gap-2 justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border",onClick:()=>{h(""),p(""),v(""),b("")},children:"Limpiar"})})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:be?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Fr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Fr.map(ge=>{var Pt;const it=Se===ge.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Pt=ge.createdAt)!=null&&Pt.toDate?ge.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:it?i.jsx("input",{className:"w-full border p-1 rounded",value:ut,onChange:wt=>Et(wt.target.value)}):i.jsx("div",{className:"font-medium",children:ge.name})}),i.jsx("td",{className:"p-2 border",children:it?i.jsx("input",{className:"w-full border p-1 rounded",value:St,onChange:wt=>Ft(Sy(wt.target.value))}):ge.phone}),i.jsx("td",{className:"p-2 border",children:it?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ie,onChange:wt=>We(wt.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(wt=>i.jsx("option",{value:wt.id,children:wt.name},wt.id))]}):ge.vendorName||""}),i.jsx("td",{className:"p-2 border",children:it?i.jsxs("select",{className:"w-full border p-1 rounded",value:Qt,onChange:wt=>Ut(wt.target.value),children:[i.jsx("option",{value:"",children:""}),iT.map(wt=>i.jsx("option",{value:wt,children:wt},wt))]}):ge.place||""}),i.jsx("td",{className:"p-2 border",children:it?i.jsxs("select",{className:"w-full border p-1 rounded",value:Te,onChange:wt=>Ye(wt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ir(ge.status)}`,children:ge.status})}),i.jsx("td",{className:"p-2 border",children:it?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ht)?"":ht,onChange:wt=>Oe(Math.max(0,Number(wt.target.value||0)))}):Ho(ge.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Ho(ge.balance||0)}),i.jsx("td",{className:"p-2 border",children:it?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Tt,onChange:wt=>Re(wt.target.value),maxLength:500}):i.jsx("span",{title:ge.notes||"",children:(ge.notes||"").length>40?(ge.notes||"").slice(0,40)+"":ge.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:it?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Qr,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ir,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nr(ge),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>or(ge),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>nn(ge),children:"Estado de cuenta"})]})})})]},ge.id)})})]}),lt()]}),i.jsxs("div",{className:"md:hidden",children:[be?i.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):Fr.length===0?i.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):i.jsx("div",{className:"space-y-2",children:Fr.map(ge=>{const it=$e===ge.id,Pt=Se===ge.id,wt=i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${ir(ge.status)}`,children:ge.status});return i.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{se(""),!Pt&&ze(Nt=>Nt===ge.id?null:ge.id)},children:[i.jsx("div",{className:"min-w-0 flex-1",children:i.jsx("div",{className:"truncate font-semibold",children:ge.name})}),i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Pendiente"}),i.jsx("div",{className:"font-semibold leading-4",children:Ho(ge.balance||0)})]}),wt]})]}),it&&i.jsxs("div",{className:"px-3 pb-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"ltimo abono"}),i.jsx("div",{className:"font-medium",children:ge.lastAbonoDate?ge.lastAbonoDate:""}),i.jsx("div",{className:"text-[12px] text-gray-700",children:ge.lastAbonoAmount?Ho(ge.lastAbonoAmount):""})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo pendiente"}),i.jsx("div",{className:"text-lg font-bold",children:Ho(ge.balance||0)})]})]}),Pt?i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:ut,onChange:Nt=>Et(Nt.target.value)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:St,onChange:Nt=>Ft(Sy(Nt.target.value))})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:Te,onChange:Nt=>Ye(Nt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:Qt,onChange:Nt=>Ut(Nt.target.value),children:[i.jsx("option",{value:"",children:""}),iT.map(Nt=>i.jsx("option",{value:Nt,children:Nt},Nt))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:o?s:Ie,onChange:Nt=>We(Nt.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Nt=>i.jsx("option",{value:Nt.id,children:Nt.name},Nt.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lmite"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(ht)?"":ht,onChange:Nt=>Oe(Math.max(0,Number(Nt.target.value||0)))})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded-xl min-h-24 resize-y",value:Tt,onChange:Nt=>Re(Nt.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:Qr,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:()=>{Ir(),ze(null)},type:"button",children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nr(ge),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>or(ge),disabled:!l,title:l?"Borrar":"Solo admin",type:"button",children:"Borrar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>nn(ge),type:"button",children:"Estado"})]})]})]},ge.id)})}),lt()]})]}),Xe&&i.jsx("p",{className:"mt-2 text-sm",children:Xe}),Be&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>ye(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ye(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ot,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:P,onChange:ge=>G(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ce,onChange:ge=>ue(Sy(ge.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:le,onChange:ge=>Ae(ge.target.value),children:[i.jsx("option",{value:"",children:""}),iT.map(ge=>i.jsx("option",{value:ge,children:ge},ge))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:De,onChange:ge=>O(ge.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:R,onChange:ge=>X(ge.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(ge=>i.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Y===0?"":Y,onChange:ge=>D(Math.max(0,Number(ge.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:ge=>K(Math.max(0,Number(ge.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ae,onChange:ge=>_e(ge.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ae.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ye(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),Z&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4 max-h-[92vh] overflow-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(at==null?void 0:at.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{kt(0),ke(new Date().toISOString().slice(0,10)),pe(""),vt(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Qe(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(Number(He||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(me.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(me.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(me.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ie?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):de.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):de.map(ge=>{var Pt,wt;const it=At===ge.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:it?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:W,onChange:Nt=>z(Nt.target.value)}):ge.date||""}),i.jsx("td",{className:"p-2 border",children:ge.amount>=0?(Pt=ge.ref)!=null&&Pt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>T(ge.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(wt=ge.ref)!=null&&wt.saleId?`Venta #${ge.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:it?i.jsx("input",{className:"w-full border p-1 rounded",value:L,onChange:Nt=>fe(Nt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:ge.comment||"",children:(ge.comment||"").length>40?(ge.comment||"").slice(0,40)+"":ge.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:it?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(re)?"":re,onChange:Nt=>{const It=Number(Nt.target.value||0),qt=Number.isFinite(It)?Math.max(0,parseFloat(It.toFixed(2))):0;V(qt)},placeholder:"0.00"}):Ho(ge.amount)}),i.jsx("td",{className:"p-2 border",children:it?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Jr,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:dn,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xr(ge),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>br(ge),children:"Borrar"})]})})]},ge.id)})})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>yt(ge=>!ge),children:[i.jsx("div",{className:"font-semibold",children:"Estado de cuenta"}),i.jsx("div",{className:"text-sm text-gray-500",children:Ke?"Ocultar":"Ver"})]}),Ke&&i.jsxs("div",{className:"px-3 pb-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Deuda inicial"}),i.jsx("div",{className:"font-bold",children:Ho(Number(He||0))})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo actual"}),i.jsx("div",{className:"font-bold",children:Ho(me.saldoActual)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Total abonado"}),i.jsx("div",{className:"font-bold",children:Ho(me.totalAbonado)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo restante"}),i.jsx("div",{className:"font-bold",children:Ho(me.saldoRestante)})]})]})]}),i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Ue(ge=>!ge),children:[i.jsx("div",{className:"font-semibold",children:"Movimientos"}),i.jsx("div",{className:"text-sm text-gray-500",children:ne?"Ocultar":"Ver"})]}),ne&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:ie?i.jsx("div",{className:"text-center text-sm p-3",children:"Cargando"}):de.length===0?i.jsx("div",{className:"text-center text-sm p-3",children:"Sin movimientos"}):de.map(ge=>{var It,qt;const it=rt===ge.id,Pt=At===ge.id,wt=ge.amount>=0?"CARGO":"ABONO",Nt=ge.amount>=0?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700";return i.jsxs("div",{className:"border rounded-2xl overflow-hidden bg-white",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{Pt||st(Mt=>Mt===ge.id?null:ge.id)},children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Fecha"}),i.jsx("div",{className:"font-semibold",children:ge.date||""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${Nt}`,children:wt}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Monto"}),i.jsx("div",{className:"font-semibold",children:Ho(ge.amount)})]})]})]}),it&&i.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Referencia"}),i.jsx("div",{className:"font-medium",children:(It=ge.ref)!=null&&It.saleId?`Venta #${ge.ref.saleId}`:""}),((qt=ge.ref)==null?void 0:qt.saleId)&&i.jsx("button",{type:"button",className:"mt-2 text-xs underline text-blue-600",onClick:()=>T(ge.ref.saleId),children:"Ver productos de la venta"})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),Pt?i.jsx("input",{className:"w-full border p-2 rounded-xl",value:L,onChange:Mt=>fe(Mt.target.value),placeholder:"Comentario"}):i.jsx("div",{className:"font-medium",children:(ge.comment||"").trim()||""})]}),Pt&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded-xl",value:W,onChange:Mt=>z(Mt.target.value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(re)?"":re,onChange:Mt=>{const zt=Number(Mt.target.value||0),ar=Number.isFinite(zt)?Math.max(0,parseFloat(zt.toFixed(2))):0;V(ar)}})]})]}),Pt?i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:Jr,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:dn,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xr(ge),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700",onClick:()=>br(ge),type:"button",children:"Borrar"})]})]})]},ge.id)})})]})]}),pt&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(at==null?void 0:at.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Vt,onChange:ge=>ke(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:bt===0?"":bt,onChange:ge=>{const it=Number(ge.target.value||0),Pt=Number.isFinite(it)?Math.max(0,parseFloat(it.toFixed(2))):0;kt(Pt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ne,onChange:ge=>pe(ge.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Ne.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>vt(!1),disabled:Le,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Bt,disabled:Le,children:Le?"Guardando...":"Guardar abono"})]})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",S?` #${S}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>I(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:j?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((ge,it)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ge.productName}),i.jsx("td",{className:"p-2 border text-right",children:ge.qty}),i.jsx("td",{className:"p-2 border text-right",children:Ho(ge.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Ho(ge.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Ho(ge.total)})]},it))})]})})]})})]})}const Wc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,MQe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas","Pull","Tilgue","Balge","Santa Cruz","Moyogalpa","Santo Domingo","San Jos del Sur","San Fernando","Merida","La Paloma","San Lorenzo","San Carlos","San Miguel"];function LQe(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function UQe(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function QQe(t){const{saleId:e,date:r,customerName:n,branch:a,items:s,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:u}=t,d=new rn;let f=12;if(d.setFontSize(16),d.text("Multiservicios Ortiz",10,f),f+=6,d.setFontSize(12),d.text("Recibo de venta certificada",10,f),f+=8,d.setFontSize(12),d.text(`Fecha: ${r}`,10,f),f+=5,d.text(`Cliente: ${n||"Cliente Mostrador"}`,10,f),f+=5,d.text(`Sucursal: ${LQe(a)}`,10,f),f+=5,d.text(`Autorizado: ${e}`,10,f),f+=5,l&&(d.text(`Vendedor: ${l}`,10,f),f+=5),typeof c=="number"){const A=Number(u||0).toFixed(2),h=c.toFixed(2);d.text(`Comisin vendedor: ${h}%  C$ ${A}`,10,f),f+=8}else f+=3;d.setFontSize(12),d.text("Producto",10,f),d.text("Paquetes",110,f,{align:"right"}),d.text("Precio.",150,f,{align:"right"}),d.text("Subtotal",190,f,{align:"right"}),f+=4,d.line(10,f,190,f),f+=4,s.forEach(A=>{f>270&&(d.addPage(),f=12);const h=(A.productName||"").length>50?A.productName.slice(0,47)+"...":A.productName;d.text(h,10,f),d.text(String(A.qty),110,f,{align:"right"}),d.text(`C$ ${Number(A.unitPrice||0).toFixed(2)}`,150,f,{align:"right"}),d.text(`C$ ${Number(A.total||0).toFixed(2)}`,190,f,{align:"right"}),f+=5}),f+=4,d.line(10,f,190,f),f+=6,d.setFontSize(13),d.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,f,{align:"right"}),f+=6,d.setFontSize(9),d.text("Gracias por su compra.",10,f),d.save(`venta_dulces_${e}.pdf`)}async function fG(t,e){if(!t||!e)return 0;const r=sr(Ct(Ce,"inventory_candies_sellers"),cr("sellerId","==",e),cr("productId","==",t)),n=await Ht(r);let a=0;return n.forEach(s=>{const o=s.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(a+=l)}),a}const hG=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function VQe(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:a,saleId:s}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=sr(Ct(Ce,"inventory_candies_sellers"),cr("sellerId","==",r),cr("productId","==",e),cr("remainingUnits",">",0),Sn("date","asc"),Sn("createdAt","asc")),u=await Ht(c);for(const d of u.docs){if(o<=0)break;const f=d.data(),A=Number(f.remainingUnits||0);if(A<=0)continue;const h=Math.min(A,o),m=A-h,p=Math.max(1,Math.floor(Number(f.unitsPerPackage||1))),x=Math.floor(m/p);await kn(d.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:d.id,productId:e,units:h,saleDate:a,saleId:s}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function AG(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function HQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t;En(a,"admin"),En(a,"vendedor_dulces");const[s,o]=g.useState([]),[l,c]=g.useState([]),[u,d]=g.useState([]),[f,A]=g.useState({}),[h,m]=g.useState("CONTADO"),[p,x]=g.useState("RIVAS"),[v,y]=g.useState(""),[b,w]=g.useState(""),[I,j]=g.useState(hG()),[C,S]=g.useState(""),[E,B]=g.useState(!1),[k,T]=g.useState(""),[P,G]=g.useState([]),[ce,ue]=g.useState(!0),[le,Ae]=g.useState(!1),ae=g.useMemo(()=>P.reduce((pe,Le)=>pe+(Le.qtyPackages||0),0),[P]),_e=g.useMemo(()=>P.reduce((pe,Le)=>pe+(Le.qtyPackages||0)*(Le.unitsPerPackage||1),0),[P]),De=g.useMemo(()=>{const pe=P.reduce((Le,ft)=>{const At=(Number(ft.pricePerPackage)||0)*(ft.qtyPackages||0),ct=Number(ft.discount)||0,W=Math.max(0,At-ct);return Le+W},0);return Math.floor(pe*100)/100},[P]),[O,H]=g.useState(0),[K,R]=g.useState(""),[X,Y]=g.useState(!1),[D,Q]=g.useState(!1),[te,be]=g.useState(""),[U,Xe]=g.useState("+505 "),[se,ee]=g.useState(""),[Fe,je]=g.useState(""),[Se,Ze]=g.useState("ACTIVO"),[ut,Et]=g.useState(0),[St,Ft]=g.useState(""),Qt=()=>{be(""),Xe("+505 "),ee(""),je(""),Ze("ACTIVO"),Et(0)},[Ut,Tt]=g.useState(!1),Re=async pe=>{const Le=String(pe||"").trim();if(!Le)return;const ft=kt.find(z=>String(z.barcode||"")===Le),At=kt.find(z=>String(z.sku||"")===Le),ct=kt.find(z=>String(z.id||"")===Le),W=ft||At||ct||null;W?(await Me(W.id),R(" Producto agregado desde escner."),setTimeout(()=>R(""),2500)):(R(" Cdigo no corresponde a ningn producto disponible."),setTimeout(()=>R(""),2500))};function Te({open:pe,onClose:Le,onDetected:ft}){const At=g.useRef(null),ct=g.useRef(null),[W,z]=g.useState(""),re=g.useRef("");return g.useEffect(()=>{if(!pe)return;let V=!1;const L=new z2,fe=()=>{var ye,$e,ze;try{(ye=ct.current)==null||ye.stop()}catch{}ct.current=null;try{const Ke=($e=At.current)==null?void 0:$e.srcObject;try{(ze=Ke==null?void 0:Ke.getTracks)==null||ze.call(Ke).forEach(yt=>yt.stop())}catch{}}catch{}try{At.current&&(At.current.srcObject=null)}catch{}};return(async()=>{z("");try{if(!At.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(ze=>ze.stop())}catch{}const ye=await L.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},At.current,$e=>{if(!V&&$e){const ze=String($e.getText()||"").trim().replace(/\s+/g,"");if(!ze||ze===re.current)return;re.current=ze,fe(),ft(ze),Le()}});ct.current=ye}catch(ye){const $e=String((ye==null?void 0:ye.message)||""),ze=String((ye==null?void 0:ye.name)||"");$e.toLowerCase().includes("permission")||ze==="NotAllowedError"?z("Permiso de cmara denegado."):ze==="NotFoundError"||$e.toLowerCase().includes("notfound")?z("No se encontr cmara en este dispositivo."):$e.toLowerCase().includes("secure")||$e.toLowerCase().includes("https")?z("La cmara requiere HTTPS (sitio seguro)."):z($e||"No se pudo iniciar el escner.")}})(),()=>{var ye;V=!0;try{(ye=ct.current)==null||ye.stop()}catch{}ct.current=null}},[pe,Le,ft]),pe?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Le,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:At,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),W&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:W}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}const Ye=g.useMemo(()=>s.find(pe=>pe.id===v),[s,v]),ht=g.useMemo(()=>E&&C?s.filter(pe=>(pe.vendorId??pe.sellerId??"")===C):s,[s,E,C]),Oe=(Ye==null?void 0:Ye.balance)||0,Ie=h==="CREDITO"?Oe+Math.max(0,Number(De||0))-Math.max(0,Number(O||0)):0,We=g.useMemo(()=>{if(h!=="CREDITO")return 0;const pe=Math.max(0,Number(Oe||0))+Math.max(0,Number(De||0));return Math.floor(pe*100)/100},[h,Oe,De]),Z=pe=>{const Le=Math.max(0,Number(pe||0));return Math.min(Le,We)},Qe=g.useMemo(()=>u.find(pe=>pe.id===C)||null,[u,C]),at=(Qe==null?void 0:Qe.commissionPercent)||0,Ge=g.useMemo(()=>{const pe=P.reduce((Le,ft)=>Le+Number(ft.margenVendedor||0),0);return Number(pe.toFixed(2))},[P]);g.useEffect(()=>{(async()=>{const pe=sr(Ct(Ce,"customers_candies"),Sn("createdAt","desc")),Le=await Ht(pe),ft=[];Le.forEach(z=>{const re=z.data();ft.push({id:z.id,name:re.name??"",phone:re.phone??"+505 ",place:re.place??"",status:re.status??"ACTIVO",creditLimit:Number(re.creditLimit??0),balance:0,sellerId:re.sellerId??re.vendorId??"",vendorId:re.vendorId??re.sellerId??""})});for(const z of ft)try{const re=sr(Ct(Ce,"ar_movements"),cr("customerId","==",z.id)),V=await Ht(re);let L=0;V.forEach(Be=>L+=Number(Be.data().amount||0));const fe=Number(z.initialDebt||0);z.balance=L+fe}catch{z.balance=0}o(ft);const At=sr(Ct(Ce,"products_candies"),Sn("createdAt","desc")),ct=await Ht(At),W=[];ct.forEach(z=>{const re=z.data();W.push({id:z.id,name:re.name??"(sin nombre)",sku:re.sku??"",unitsPerPackage:Number(re.unitsPerPackage??1),barcode:String(re.barcode||""),priceRivas:Number(re.unitPriceRivas??0),priceSanJorge:Number(re.unitPriceSanJorge??0),priceIsla:Number(re.unitPriceIsla??0),providerPrice:Number(re.providerPrice??0),providerPricePerUnit:Number(re.providerPricePerUnit??0)})}),c(W);try{const z=await Ht(Ct(Ce,"sellers_candies")),re=[];z.forEach(V=>{const L=V.data(),fe=L.branch||"Rivas",Be=UQe(fe);re.push({id:V.id,name:L.name??"(sin nombre)",branch:Be,branchLabel:fe,commissionPercent:Number(L.commissionPercent??0)})}),d(re)}catch(z){console.error("Error cargando vendedores:",z)}A({})})()},[]),g.useEffect(()=>{var Le,ft;const pe=e&&e.length?e:t;if(pe&&((Le=pe.includes)!=null&&Le.call(pe,"vendedor_dulces"))&&r){S(r),B(!0);try{localStorage.setItem("pos_vendorId",r),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(pe&&((ft=pe.includes)!=null&&ft.call(pe,"admin"))){B(!1);return}try{const At=localStorage.getItem("pos_vendorId")||"",ct=localStorage.getItem("pos_role")||"";At&&S(At),ct.toUpperCase()==="VENDEDOR"&&B(!0)}catch{}},[t,r]);const ie=async pe=>{if(!pe){A({});return}const Le=sr(Ct(Ce,"inventory_candies_sellers"),cr("sellerId","==",pe)),ft=await Ht(Le),At={};ft.forEach(ct=>{const W=ct.data(),z=W.productId||"";if(!z)return;const re=Number(W.remainingUnits??W.remaining??W.totalUnits??0);re<=0||(At[z]=(At[z]||0)+re)}),A(At),G(ct=>{const W=[];for(const z of ct){const re=At[z.productId]??0;re>0&&W.push({...z,availableUnits:re})}return W})};g.useEffect(()=>{if(!C){A({});return}const pe=u.find(Le=>Le.id===C);pe&&x(pe.branch),ie(C)},[C,u]),g.useEffect(()=>{G(pe=>pe.map(Le=>{const ft=l.find(ct=>ct.id===Le.productId);if(!ft)return Le;const At=p==="RIVAS"?ft.priceRivas:p==="SAN_JORGE"?ft.priceSanJorge:ft.priceIsla;return{...Le,pricePerPackage:Number(At)||0}}))},[p,l]);async function xe(pe){const{productId:Le,vendorId:ft,branch:At}=pe;if(!Le||!ft)return 0;const ct=sr(Ct(Ce,"inventory_candies_sellers"),cr("sellerId","==",ft),cr("productId","==",Le)),W=await Ht(ct);if(W.empty)return 0;const z=W.docs[0].data(),re=Number(z.unitPriceVendor??0);if(re>0)return re;const V=Number(At==="RIVAS"?z.unitPriceRivas??0:At==="SAN_JORGE"?z.unitPriceSanJorge??0:z.unitPriceIsla??0);return Number(V||0)}const de=pe=>{const Le=Number(at||0),ft=Number(pe||0)*Le/100;return Math.max(0,Number(ft.toFixed(2)))},Me=async pe=>{var fe;if(!pe)return;if(!C){R("Selecciona primero el vendedor para usar su inventario."),T("");return}if(P.some(Be=>Be.productId===pe)){T("");return}const Le=l.find(Be=>Be.id===pe);if(!Le){T("");return}const ft=await fG(pe,C),At=((fe=u.find(Be=>Be.id===C))==null?void 0:fe.branch)??p,ct=await xe({productId:pe,vendorId:C,branch:At}),z=await(async Be=>{const{productId:ye,vendorId:$e}=Be;if(!ye||!$e)return 0;try{const ze=sr(Ct(Ce,"inventory_candies_sellers"),cr("sellerId","==",$e),cr("productId","==",ye)),Ke=await Ht(ze);if(Ke.empty)return 0;const yt=Ke.docs[0].data();return Number(yt.providerPrice??0)}catch{return 0}})({productId:pe,vendorId:C}),re=(()=>{const Be=Number(Le.providerPrice||0);if(Be>0)return Be;const ye=Number(Le.providerPricePerUnit||0);return ye>0?ye*Number(Le.unitsPerPackage||1):0})(),V=Number(z||0)>0?Number(z||0):Number(re||0),L={productId:pe,productName:Le.name||"",sku:Le.sku||"",unitsPerPackage:Le.unitsPerPackage||1,pricePerPackage:Number(ct)||0,availableUnits:Number(ft)||0,qtyPackages:0,discount:0,providerPricePerPackage:Number(V)||0,margenVendedor:0,uBruta:0};G(Be=>[...Be,L]),T("")},me=(pe,Le)=>{G(ft=>ft.map(At=>{if(At.productId!==pe)return At;if(Le==="")return{...At,qtyPackages:0};const ct=Math.max(0,Math.floor(Number(Le))),W=f[pe]??At.availableUnits??0,z=Math.max(1,Number(At.unitsPerPackage||1)),re=Math.floor(W/z);let V=ct;ct>re&&(V=re,R(` Solo hay ${re} paquetes disponibles.`),setTimeout(()=>R(""),2500));const L=Number(At.pricePerPackage||0)*V,fe=Number(At.providerPricePerPackage||0)*V,Be=L-fe,ye=de(Be);return{...At,qtyPackages:V,margenVendedor:ye,uBruta:Be}}))},we=(pe,Le)=>{G(ft=>ft.map(At=>{if(At.productId!==pe)return At;if(Le==="")return{...At,discount:0};const ct=Math.max(0,Math.floor(Number(Le))),W=At.qtyPackages||0,z=Number(At.pricePerPackage||0)*W,re=Number(At.providerPricePerPackage||0)*W,V=z-re,L=de(V);return{...At,discount:ct,margenVendedor:L,uBruta:V}}))},pt=pe=>G(Le=>Le.filter(ft=>ft.productId!==pe)),vt=async()=>{if(!I)return"Selecciona la fecha.";if(!C)return"Selecciona el vendedor para esta venta.";if(P.length===0)return"Agrega al menos un producto.";const pe=P.filter(Le=>(Le.qtyPackages||0)>0);if(pe.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(De>0))return"El total debe ser mayor a cero.";if(h==="CONTADO"){if(!b.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!v)return"Selecciona un cliente (crdito).";if(O<0)return"El pago inicial no puede ser negativo.";if(O>We)return"El pago inicial no puede superar el saldo a deber (saldo actual + venta).";if((Ye==null?void 0:Ye.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Le of pe){const ft=Le.unitsPerPackage||1,At=(Le.qtyPackages||0)*ft,ct=await fG(Le.productId,C),W=Math.floor(ct/ft);if(At>ct)return`Inventario insuficiente en el pedido del vendedor para "${Le.productName}". Disponible: ${W} paquetes.`;const z=(Number(Le.pricePerPackage)||0)*(Le.qtyPackages||0),re=Number(Le.discount)||0;if(!Number.isInteger(re)||re<0)return`El descuento en "${Le.productName}" debe ser entero y  0.`;if(re>z)return`El descuento en "${Le.productName}" no puede exceder C$ ${z.toFixed(2)}.`}return null},bt=async pe=>{pe.preventDefault(),R("");const Le=await vt();if(Le){R(" "+Le);return}try{Y(!0);const ft=P.filter(re=>(re.qtyPackages||0)>0).map(re=>{const V=re.unitsPerPackage||1,L=re.qtyPackages||0,fe=L*V,Be=(Number(re.pricePerPackage)||0)*(L||0),ye=Math.max(0,Math.floor(Number(re.discount)||0)),$e=Math.max(0,Be-ye),ze=Number(re.providerPricePerPackage||0),Ke=ze*L,yt=Be-Ke,ne=de(yt);return{productId:re.productId,productName:re.productName,sku:re.sku||"",qty:fe,packages:L,unitsPerPackage:V,branch:p,unitPricePackage:Number(re.pricePerPackage)||0,discount:ye,total:Math.floor($e*100)/100,providerPricePerPackage:ze,margenVendedor:ne,uBruta:yt}}),At={type:h,branch:p,date:I,createdAt:yr.now(),itemsTotal:Number(De)||0,total:Number(De)||0,quantity:Number(_e)||0,packagesTotal:Number(ae)||0,items:ft,vendorId:C},ct=u.find(re=>re.id===C);ct&&(At.vendorName=ct.name,At.vendorBranch=ct.branch,At.vendorBranchLabel=ct.branchLabel,At.vendorCommissionPercent=ct.commissionPercent||0,At.vendorCommissionAmount=Ge||0),h==="CONTADO"?At.customerName=b.trim():(At.customerId=v,At.downPayment=Number(O)||0);const W=await Gn(Ct(Ce,"sales_candies"),At);if(h==="CONTADO"){const re=(b||"").trim();if(re)try{await Gn(Ct(Ce,"cash_customers"),{name:re,date:I,branch:p,vendorId:C,createdAt:yr.now()})}catch(V){console.warn("No se pudo guardar cash_customer:",V)}}if(h==="CREDITO"&&v){const re={customerId:v,date:I,createdAt:yr.now(),ref:{saleId:W.id}};await Gn(Ct(Ce,"ar_movements"),{...re,type:"CARGO",amount:Number(De)||0}),Number(O)>0&&await Gn(Ct(Ce,"ar_movements"),{...re,type:"ABONO",amount:-Number(O)})}const z={};for(const re of ft)if(re.qty>0){const{allocations:V}=await VQe({productId:re.productId,vendorId:C,quantityUnits:re.qty,saleDate:I,saleId:W.id});z[re.productId]={productId:re.productId,vendorId:C,allocations:V}}await kn(Yt(Ce,"sales_candies",W.id),{allocationsByItem:z});try{const re=h==="CONTADO"?b.trim()||"Cliente Mostrador":(Ye==null?void 0:Ye.name)||"Cliente crdito";QQe({saleId:W.id,date:I,customerName:re,branch:p,items:ft.map(V=>({productName:V.productName,qty:V.packages,unitPrice:V.unitPricePackage,total:V.total})),total:Number(De)||0,vendorName:ct==null?void 0:ct.name,vendorCommissionPercent:(ct==null?void 0:ct.commissionPercent)||0,vendorCommissionAmount:Ge})}catch(re){console.error("Error generando voucher PDF:",re)}m("CONTADO"),y(""),w(""),j(hG()),G([]),H(0),h==="CREDITO"&&v&&o(re=>re.map(V=>V.id===v?{...V,balance:(V.balance||0)+(Number(De)||0)-(Number(O)||0)}:V)),R(" Venta de dulces registrada"),C?await ie(C):A({})}catch(ft){console.error(ft),R(" Error al guardar la venta de dulces")}finally{Y(!1)}},kt=g.useMemo(()=>l.filter(pe=>{const Le=f[pe.id]||0,ft=Math.max(1,Number(pe.unitsPerPackage||1));return Math.floor(Le/ft)>0}).sort((pe,Le)=>(pe.name||"").localeCompare(Le.name||"")),[l,f]),[Vt,ke]=g.useState(""),Ne=g.useMemo(()=>{const pe=String(Vt||"").trim().toLowerCase();return pe?kt.filter(Le=>`${Le.name||""} ${Le.sku||""}`.toLowerCase().includes(pe)||String(Le.id||"").includes(pe)):kt},[Vt,kt]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),i.jsxs("form",{onSubmit:bt,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6",children:[i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:pe=>m(pe.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:b,onChange:pe=>w(pe.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:v,onChange:pe=>y(pe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ht.map(pe=>i.jsxs("option",{value:pe.status==="ACTIVO"?pe.id:"",disabled:pe.status==="BLOQUEADO",children:[pe.name," | ",pe.phone," | Saldo: ",Wc(pe.balance||0)]},pe.id))]}),i.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>Q(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Wc(Oe)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:We,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:pe=>{const Le=Z(pe.target.value);H(Le)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Wc(Ie)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:I,onChange:pe=>j(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:C,onChange:pe=>{S(pe.target.value),G([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(pe=>i.jsxs("option",{value:pe.id,children:[pe.name,"  ",pe.branchLabel,"  ",pe.commissionPercent.toFixed(2),"%"," comisin"]},pe.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:p==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:p==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:p==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:C?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Vt,onChange:pe=>ke(pe.target.value),disabled:!C}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Tt(!0),disabled:!C,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async pe=>{const Le=pe.target.value;T(Le),await Me(Le)},disabled:!C,children:[i.jsx("option",{value:"",children:C?"Selecciona un producto":"Selecciona un vendedor primero"}),Ne.map(pe=>{const Le=P.some(W=>W.productId===pe.id),ft=f[pe.id]||0,At=Math.max(1,Number(pe.unitsPerPackage||1)),ct=Math.floor(ft/At);return ct<=0?null:i.jsxs("option",{value:Le?"":pe.id,disabled:Le,children:[pe.name," ",pe.sku?` ${pe.sku}`:""," (disp: ",ct," ","paq.)",Le?" ":""]},pe.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),P.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):P.map(pe=>{const Le=f[pe.productId]??pe.availableUnits??0,ft=pe.unitsPerPackage?Math.floor(Le/pe.unitsPerPackage):0,At=Math.max(0,ft-(pe.qtyPackages||0)),ct=(Number(pe.pricePerPackage)||0)*(pe.qtyPackages||0),W=Math.max(0,ct-(Number(pe.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[pe.productName,pe.sku?`  ${pe.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Wc(pe.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[At," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(pe.qtyPackages)||pe.qtyPackages===0?"":pe.qtyPackages,onChange:z=>me(pe.productId,z.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(pe.discount)||pe.discount===0?"":pe.discount,onChange:z=>we(pe.productId,z.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1 text-right",children:Wc(W)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>pt(pe.productId),title:"Quitar producto",children:""})})]},pe.productId)})]})}),P.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:ae})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Wc(De)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Wc(Ge)," ",at?`(${at.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:X,children:X?"Guardando...":"Registrar venta"})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>ue(pe=>!pe),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Datos de venta",i.jsx("span",{className:"text-lg",children:ce?"":"+"})]}),ce&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:I,onChange:pe=>j(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:pe=>m(pe.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (Cash)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mario Bergoglio",value:b,onChange:pe=>w(pe.target.value)})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:pe=>y(pe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ht.map(pe=>i.jsxs("option",{value:pe.status==="ACTIVO"?pe.id:"",disabled:pe.status==="BLOQUEADO",children:[pe.name," | Saldo: ",Wc(pe.balance||0)]},pe.id))]}),i.jsx("button",{type:"button",className:"w-full px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>Q(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:Wc(Oe)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:Wc(Ie)})]})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:We,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:pe=>{const Le=Z(pe.target.value);H(Le)},placeholder:"0.00"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:C,onChange:pe=>{S(pe.target.value),G([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(pe=>i.jsxs("option",{value:pe.id,children:[pe.name,"  "," ",pe.commissionPercent.toFixed(2),"%"]},pe.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor Logueado en esta app."})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>Ae(pe=>!pe),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Agrega Productos",i.jsx("span",{className:"text-lg",children:le?"":"+"})]}),le&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Productos"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:C?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Vt,onChange:pe=>ke(pe.target.value),disabled:!C}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Tt(!0),disabled:!C,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async pe=>{const Le=pe.target.value;T(Le),await Me(Le)},disabled:!C,children:[i.jsx("option",{value:"",children:C?"Selecciona un producto":"Selecciona un vendedor primero"}),Ne.map(pe=>{const Le=P.some(W=>W.productId===pe.id),ft=f[pe.id]||0,At=Math.max(1,Number(pe.unitsPerPackage||1)),ct=Math.floor(ft/At);return ct<=0?null:i.jsxs("option",{value:Le?"":pe.id,disabled:Le,children:[pe.name," ",pe.sku?` ${pe.sku}`:""," (disp:"," ",ct," paq.)",Le?" ":""]},pe.id)})]})]}),P.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay productos agregados."}):i.jsx("div",{className:"space-y-2",children:P.map(pe=>{const Le=f[pe.productId]??pe.availableUnits??0,ft=pe.unitsPerPackage?Math.floor(Le/pe.unitsPerPackage):0,At=Math.max(0,ft-(pe.qtyPackages||0)),ct=(Number(pe.pricePerPackage)||0)*(pe.qtyPackages||0),W=Math.max(0,ct-(Number(pe.discount)||0));return i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50 space-y-2",children:[i.jsxs("div",{className:"font-semibold leading-tight",children:[pe.productName,pe.sku?`  ${pe.sku}`:""]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio x Paquete"}),i.jsx("div",{className:"font-bold",children:Wc(pe.pricePerPackage)})]}),i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencias"}),i.jsxs("div",{className:"font-bold",children:[At," paq."]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cantidad Paquetes"}),i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(pe.qtyPackages)||pe.qtyPackages===0?"":pe.qtyPackages,onChange:z=>me(pe.productId,z.target.value),inputMode:"numeric",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Descuento"}),i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(pe.discount)||pe.discount===0?"":pe.discount,onChange:z=>we(pe.productId,z.target.value),inputMode:"numeric",placeholder:"0"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"font-regular text-gray-600",children:["Total ",Wc(W)]}),i.jsxs("div",{className:"font-regular text-gray-600",children:["Comision ",Wc(pe.margenVendedor||0)]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg bg-red-100 hover:bg-red-200",onClick:()=>pt(pe.productId),children:"Quitar"})]})]},pe.productId)})}),P.length>0&&i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:ae})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-semibold",children:Wc(De)})]})]})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl hover:bg-blue-700 disabled:opacity-60",disabled:X,children:X?"Guardando...":"Registrar venta"})]})]}),K&&i.jsx("p",{className:"mt-2 text-sm",children:K}),D&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:te,onChange:pe=>be(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:U,onChange:pe=>Xe(AG(pe.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:se,onChange:pe=>ee(pe.target.value),children:[i.jsx("option",{value:"",children:""}),MQe.map(pe=>i.jsx("option",{value:pe,children:pe},pe))]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:St,onChange:pe=>Ft(pe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.filter(pe=>(pe.status??"ACTIVO")==="ACTIVO").map(pe=>i.jsxs("option",{value:pe.id,children:[pe.name,"  ",pe.branchLabel]},pe.id))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Fe,onChange:pe=>je(pe.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Qt(),Q(!1)},children:"Cancelar"}),i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var ft;const pe=E?C||r:St;if(!pe){R("Selecciona el vendedor para asociar este cliente.");return}if(R(""),!te.trim()){R("Ingresa el nombre del nuevo cliente.");return}const Le=AG(U);try{const At=await Gn(Ct(Ce,"customers_candies"),{name:te.trim(),phone:Le,place:se||"",notes:Fe||"",status:Se,creditLimit:Number(ut||0),createdAt:yr.now(),sellerId:pe,vendorId:pe,vendorName:((ft=u.find(W=>W.id===pe))==null?void 0:ft.name)||""}),ct={id:At.id,name:te.trim(),phone:Le,place:se||"",status:Se,creditLimit:Number(ut||0),balance:0,sellerId:pe};o(W=>[ct,...W]),y(At.id),Qt(),Q(!1),R(" Cliente creado")}catch(At){console.error(At),R(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),i.jsx(Te,{open:Ut,onClose:()=>Tt(!1),onDetected:Re}),X&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const mG=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],h_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function $Qe(){const[t,e]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Lr(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,C]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState(""),[G,ce]=g.useState(0),[ue,le]=g.useState("PENDIENTE"),[Ae,ae]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(Ct(Ce,"expenses_candies"),Sn("date","desc")),Q=await Ht(D),te=[];Q.forEach(be=>{const U=be.data();te.push({id:be.id,date:U.date||Lr(new Date,"yyyy-MM-dd"),category:U.category||"",description:U.description||"",amount:Number(U.amount||0),status:U.status||"PENDIENTE",notes:U.notes||"",createdAt:U.createdAt??yr.now()})}),v(te)}catch(D){console.error(D),I(" Error al cargar gastos")}finally{b(!1)}})()},[]);const _e=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),De=g.useMemo(()=>{const D=_e.reduce((be,U)=>be+(U.amount||0),0),Q=_e.filter(be=>be.status==="PAGADO").reduce((be,U)=>be+(U.amount||0),0),te=D-Q;return{total:D,pagado:Q,pendiente:te}},[_e]),O=()=>{s(Lr(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),I(""),!o){I("Selecciona una categora.");return}if(!c.trim()){I("Ingresa una descripcin.");return}if(!d||d<=0){I("Ingresa un monto vlido.");return}try{const Q=await Gn(Ct(Ce,"expenses_candies"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:yr.now()});v(te=>[{id:Q.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:yr.now()},...te]),O(),I(" Gasto registrado")}catch(Q){console.error(Q),I(" Error al guardar gasto")}},K=D=>{C(D.id),E(D.date),k(D.category||""),P(D.description||""),ce(Number(D.amount||0)),le(D.status||"PENDIENTE"),ae(D.notes||"")},R=()=>{C(null),E(""),k(""),P(""),ce(0),le("PENDIENTE"),ae("")},X=async()=>{if(j){if(!B){I("Selecciona una categora.");return}if(!T.trim()){I("Ingresa una descripcin.");return}if(!G||G<=0){I("Ingresa un monto vlido.");return}try{await kn(Yt(Ce,"expenses_candies",j),{date:S,category:B,description:T.trim(),amount:Number(G.toFixed(2)),status:ue,notes:Ae||""}),v(D=>D.map(Q=>Q.id===j?{...Q,date:S,category:B,description:T.trim(),amount:Number(G.toFixed(2)),status:ue,notes:Ae||""}:Q)),R(),I(" Gasto actualizado")}catch(D){console.error(D),I(" Error al actualizar gasto")}}},Y=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await Wn(Yt(Ce,"expenses_candies",D.id)),v(te=>te.filter(be=>be.id!==D.id)),I(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",h_(De.total)]}),i.jsxs("div",{children:["Pagado: ",h_(De.pagado)]}),i.jsxs("div",{children:["Pendiente: ",h_(De.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),mG.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):_e.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):_e.slice().sort((D,Q)=>D.date.localeCompare(Q.date)).map(D=>{const Q=j===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:te=>E(te.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:te=>k(te.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),mG.map(te=>i.jsx("option",{value:te,children:te},te))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:te=>P(te.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(G)?"":G,onChange:te=>ce(Math.max(0,Number(te.target.value||0)))}):h_(D.amount)}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:ue,onChange:te=>le(te.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Ae,onChange:te=>ae(te.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:X,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:R,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>K(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Y(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const ro=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function GQe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Lr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function KQe(t,e){var c,u,d;const r=GQe(t);if(!r)return null;let n=0,a=0;const s=Array.isArray(t.items)&&t.items.length>0?t.items:t.item?[t.item]:[],o=s.length?s.map(f=>String(f.productName||f.name||"").trim()).filter(Boolean):t.productName?[String(t.productName).trim()]:[];let l=0;return s.length>0?(n=s.reduce((f,A)=>f+(Number(A.packages??A.qty??A.quantity??0)||0),0),a=Number(t.total??t.itemsTotal??0)||0,a||(a=s.reduce((f,A)=>f+(Number(A.total??A.lineFinal??0)||0),0)),l=s.reduce((f,A)=>f+(Number(A.margenVendedor||0)||0),0)):(n=Number(t.packagesTotal??t.quantity??((c=t.item)==null?void 0:c.packages)??((u=t.item)==null?void 0:u.qty)??0)||0,a=Number(t.total??((d=t.item)==null?void 0:d.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0,commissionFromItems:Number(l||0)||0,productNames:o}}async function qQe(t){const e=(t||"").trim();if(!e)return;const r=sr(Ct(Ce,"ar_movements"),cr("ref.saleId","==",e)),n=await Ht(r);await Promise.all(n.docs.map(a=>Wn(Yt(Ce,"ar_movements",a.id))))}function zQe({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=En(n,"vendedor_dulces"),s=En(n,"admin"),o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async Z=>{c(!0),d(!0),A(Z),m([]);try{const Qe=await gs(Yt(Ce,"sales_candies",Z)),at=Qe.exists()?Qe.data():null;if(!at){m([]);return}const ie=(Array.isArray(at==null?void 0:at.items)?at.items:at!=null&&at.item?[at.item]:[]).map(xe=>({productName:String(xe.productName||""),qty:Number(xe.packages??xe.qty??xe.quantity??0),unitPrice:Number(xe.unitPricePackage??xe.unitPrice??0),discount:Number(xe.discount||0),total:Number(xe.total??xe.lineFinal??0),commission:Number(xe.margenVendedor||0)}));m(ie)}catch(Qe){console.error(Qe)}finally{d(!1)}},[x,v]=g.useState(Lr(new Date,"yyyy-MM-01")),[y,b]=g.useState(Lr(new Date,"yyyy-MM-dd")),[w,I]=g.useState([]),[j,C]=g.useState([]),[S,E]=g.useState(""),[B,k]=g.useState([]),[T,P]=g.useState(!0),[G,ce]=g.useState(""),[ue,le]=g.useState(""),[Ae,ae]=g.useState(""),[_e,De]=g.useState(""),[O,H]=g.useState(null),K=15,[R,X]=g.useState(1),[Y,D]=g.useState(!1),[Q,te]=g.useState(!1),[be,U]=g.useState(!1),[Xe,se]=g.useState(!1),ee=g.useMemo(()=>{const Z={};return w.forEach(Qe=>Z[Qe.id]=Qe.name),Z},[w]),Fe=g.useMemo(()=>{const Z={};return B.forEach(Qe=>{Z[Qe.id]=Qe}),Z},[B]),je=g.useMemo(()=>{const Z=new Set;return j.forEach(Qe=>{(Qe.productNames||[]).forEach(at=>Z.add(at))}),Array.from(Z).sort((Qe,at)=>Qe.localeCompare(at))},[j]),Se=async()=>{P(!0),ce("");try{const Z=[];for(const Me of ut)try{const me=await gs(Yt(Ce,"sales_candies",Me.id)),we=me.exists()?me.data():null;if(!we)continue;const pt=Array.isArray(we.items)?we.items:we.item?[we.item]:[];if(pt.length>0)for(const vt of pt)Z.push({Fecha:Me.date,Venta:Me.id,Tipo:Me.type,Cliente:Me.customerName||"",Vendedor:Me.vendorName||"",Producto:vt.productName||vt.name||"",Paquetes:Number(vt.packages??vt.qty??vt.quantity??0),Precio:Number(vt.unitPricePackage??vt.unitPrice??0),Descuento:Number(vt.discount||0),Monto:Number(vt.total??vt.lineFinal??0),Comision:Number(vt.margenVendedor||0)});else Z.push({Fecha:Me.date,Venta:Me.id,Tipo:Me.type,Cliente:Me.customerName||"",Vendedor:Me.vendorName||"",Producto:Me.productNames&&Me.productNames[0]?Me.productNames[0]:"",Paquetes:Me.quantity,Precio:Me.total,Descuento:0,Monto:Me.total,Comision:Number(Me.commissionFromItems||Me.vendorCommissionAmount||0)})}catch(me){console.error("Error leyendo venta",Me.id,me)}const Qe=ha.json_to_sheet(Z),at=ha.book_new();ha.book_append_sheet(at,Qe,"Productos");const Ge=E1(at,{bookType:"xlsx",type:"array"}),ie=new Blob([Ge],{type:"application/octet-stream"}),xe=URL.createObjectURL(ie),de=document.createElement("a");de.href=xe,de.download=`ventas_productos_${x}_a_${y}.xlsx`,de.click(),URL.revokeObjectURL(xe),ce(` Exportado ${Z.length} fila(s)`)}catch(Z){console.error(Z),ce(" Error exportando a Excel")}finally{P(!1)}},Ze=Z=>{const Qe=Number(Z.commissionFromItems||0);if(Qe>0)return Number(Qe.toFixed(2));const at=Number(Z.vendorCommissionAmount||0);if(at>0)return Number(at.toFixed(2));if(!Z.vendorId)return 0;const Ge=Fe[Z.vendorId];if(!Ge||!Ge.commissionPercent)return 0;const ie=(Number(Z.total)||0)*(Number(Ge.commissionPercent)||0)/100;return Number(ie.toFixed(2))};g.useEffect(()=>{(async()=>{P(!0),ce("");try{const Z=await Ht(Ct(Ce,"customers_candies")),Qe=[];Z.forEach(de=>Qe.push({id:de.id,name:de.data().name||""})),I(Qe);const at=await Ht(Ct(Ce,"sellers_candies")),Ge=[];at.forEach(de=>{const Me=de.data();Ge.push({id:de.id,name:Me.name||"",commissionPercent:Number(Me.commissionPercent||0)})}),k(Ge);const ie=await Ht(sr(Ct(Ce,"sales_candies"),Sn("createdAt","desc"))),xe=[];ie.forEach(de=>{const Me=KQe(de.data(),de.id);Me&&Me.date>=x&&Me.date<=y&&xe.push(Me)}),C(xe.sort((de,Me)=>Me.date.localeCompare(de.date))),X(1)}catch(Z){console.error(Z),ce(" Error cargando transacciones.")}finally{P(!1)}})()},[x,y]);const ut=g.useMemo(()=>j.filter(Z=>!(a&&(!e||!Z.vendorId||Z.vendorId!==e)||_e&&(!Z.vendorId||Z.vendorId!==_e)||ue&&Z.customerId!==ue||Ae&&Z.type!==Ae||S&&(!Z.productNames||!Z.productNames.includes(S)))),[j,ue,Ae,S,_e,a,e]),Et=g.useMemo(()=>{let Z=0,Qe=0,at=0,Ge=0,ie=0,xe=0;for(const de of ut)de.type==="CONTADO"?(Z+=de.quantity,at+=de.total,ie+=Ze(de)):(Qe+=de.quantity,Ge+=de.total,xe+=Ze(de));return{packsCash:Z,packsCredito:Qe,montoCash:at,montoCredito:Ge,comisionCash:ie,comisionCredito:xe}},[ut]),St=Math.max(1,Math.ceil(ut.length/K)),Ft=g.useMemo(()=>{const Z=(R-1)*K;return ut.slice(Z,Z+K)},[ut,R]),Qt=g.useMemo(()=>Ft.filter(Z=>Z.type==="CONTADO"),[Ft]),Ut=g.useMemo(()=>Ft.filter(Z=>Z.type==="CREDITO"),[Ft]),Tt=g.useMemo(()=>f&&j.find(Z=>Z.id===f)||null,[f,j]),Re=async Z=>{if(s&&(H(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{P(!0);const Qe=Z.id.split("#")[0];await W2(Qe),await qQe(Qe),C(at=>at.filter(Ge=>Ge.id!==Z.id)),ce(" Venta eliminada y saldo del cliente ajustado")}catch(Qe){console.error(Qe),ce(" No se pudo eliminar la venta.")}finally{P(!1)}},Te=()=>{const Z=`Ventas del dia  ${x} a ${y}`,Qe=xe=>(xe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),at=ut.map(xe=>{const de=xe.customerName||(xe.customerId?ee[xe.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${xe.date}</td>
          <td>${Qe(de)}</td>
          <td>${xe.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${xe.quantity}</td>
          <td style="text-align:right">${ro(xe.total)}</td>
        </tr>`}).join(""),Ge=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Qe(Z)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Qe(Z)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${Et.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${Et.packsCredito}</div>
        <div><b>Monto Cash:</b> ${ro(Et.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${ro(Et.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${at||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,ie=window.open("","_blank");ie&&(ie.document.open(),ie.document.write(Ge),ie.document.close())},Ye=()=>X(1),ht=()=>X(Z=>Math.max(1,Z-1)),Oe=()=>X(Z=>Math.min(St,Z+1)),Ie=()=>X(St),We=()=>{const Z=[];if(St<=7)for(let at=1;at<=St;at++)Z.push(at);else{const at=Math.max(1,R-2),Ge=Math.min(St,R+2);Z.push(1),at>2&&Z.push(-1);for(let ie=at;ie<=Ge;ie++)ie!==1&&ie!==St&&Z.push(ie);Ge<St-1&&Z.push(-2),Z.push(St)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ye,disabled:R===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ht,disabled:R===1,children:" Anterior"}),Z.map((at,Ge)=>typeof at=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${at===R?"bg-blue-600 text-white":""}`,onClick:()=>X(at),children:at},Ge):i.jsx("span",{className:"px-2",children:""},Ge)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Oe,disabled:R===St,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ie,disabled:R===St,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",R," de ",St,"  ",ut.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(Z=>!Z),"aria-expanded":Y,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${Y?"rotate-180":""}`,children:""})]}),Y&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:Z=>{v(Z.target.value),X(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:Z=>{b(Z.target.value),X(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ue,onChange:Z=>{le(Z.target.value),X(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:_e,onChange:Z=>{De(Z.target.value),X(1)},children:[i.jsx("option",{value:"",children:"Todos"}),B.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Ae,onChange:Z=>{ae(Z.target.value),X(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:S,onChange:Z=>{E(Z.target.value),X(1)},disabled:je.length===0,children:[i.jsx("option",{value:"",children:"Todos"}),je.map(Z=>i.jsx("option",{value:Z,children:Z},Z))]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-2 py-1 text-sm sm:px-3 sm:py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Te,children:"Exportar PDF"}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-2 py-1 text-sm sm:px-3 sm:py-2 rounded bg-green-600 text-white hover:bg-green-700 w-full",onClick:Se,children:"Exportar Excel (Sbana)"})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>te(Z=>!Z),"aria-expanded":Q,children:[i.jsx("span",{children:"Indicadores"}),i.jsx("span",{className:`transition-transform ${Q?"rotate-180":""}`,children:""})]}),Q&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Et.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Et.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ro(Et.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:ro(Et.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ro(Et.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:ro(Et.comisionCredito)})]})]})})]}),i.jsxs("div",{className:"block md:hidden space-y-3",children:[T?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):Ft.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>U(Z=>!Z),"aria-expanded":be,children:[i.jsx("span",{children:"Cash"}),i.jsx("span",{className:`transition-transform ${be?"rotate-180":""}`,children:""})]}),be&&i.jsx("div",{className:"p-3 border-t space-y-3",children:Qt.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):Qt.map(Z=>{const Qe=Z.customerName||(Z.customerId?ee[Z.customerId]:"")||"Nombre cliente",at=Ze(Z);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Qe}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:Z.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-green-50 border-green-200 text-green-700",children:"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:Ge=>{Ge.preventDefault(),p(Z.id)},title:"Ver detalle",children:Z.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",ro(Z.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Qe})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:Z.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(Z.id),title:"Ver detalle",children:Z.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:ro(Z.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:at>0?ro(at):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:Z.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>H(Ge=>Ge===Z.id?null:Z.id),children:" Acciones"}),O===Z.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Re(Z),children:"Eliminar"})]})]})})]})},Z.id)})})]}),i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>se(Z=>!Z),"aria-expanded":Xe,children:[i.jsx("span",{children:"Crdito"}),i.jsx("span",{className:`transition-transform ${Xe?"rotate-180":""}`,children:""})]}),Xe&&i.jsx("div",{className:"p-3 border-t space-y-3",children:Ut.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):Ut.map(Z=>{const Qe=Z.customerName||(Z.customerId?ee[Z.customerId]:"")||"Nombre cliente",at=Ze(Z);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Qe}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:Z.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-yellow-50 border-yellow-200 text-yellow-700",children:"Crdito"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:Ge=>{Ge.preventDefault(),p(Z.id)},title:"Ver detalle",children:Z.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",ro(Z.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Qe})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:Z.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Crdito"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(Z.id),title:"Ver detalle",children:Z.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:ro(Z.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:at>0?ro(at):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:Z.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>H(Ge=>Ge===Z.id?null:Z.id),children:" Acciones"}),O===Z.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Re(Z),children:"Eliminar"})]})]})})]})},Z.id)})})]})]}),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:We()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):Ft.map(Z=>{const Qe=Z.customerName||(Z.customerId?ee[Z.customerId]:"")||"Nombre cliente",at=Ze(Z);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.date}),i.jsx("td",{className:"p-2 border",children:Qe}),i.jsx("td",{className:"p-2 border",children:Z.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(Z.id),children:Z.quantity})}),i.jsx("td",{className:"p-2 border",children:ro(Z.total)}),i.jsx("td",{className:"p-2 border",children:at>0?ro(at):""}),i.jsx("td",{className:"p-2 border",children:Z.vendorName||""}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>H(Ge=>Ge===Z.id?null:Z.id),title:"Acciones",children:""}),O===Z.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Re(Z),children:"Eliminar"})})]})]},Z.id)})})]}),We()]}),G&&i.jsx("p",{className:"mt-2 text-sm",children:G}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",f?` #${f}`:""]}),Tt&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:Ze(Tt)>0?ro(Ze(Tt)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"}),i.jsx("th",{className:"p-2 border text-right",children:"Comisin"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((Z,Qe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Z.productName}),i.jsx("td",{className:"p-2 border text-right",children:Z.qty}),i.jsx("td",{className:"p-2 border text-right",children:ro(Z.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:ro(Z.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:ro(Z.total)}),i.jsx("td",{className:"p-2 border text-right",children:ro(Z.commission||0)})]},Qe))})]})})]})})]})}const bn=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function sb(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Lr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function WQe(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/a:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}});if(t!=null&&t.item){const n=t.item,a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/a:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0),uBruta:Number((t==null?void 0:t.uBruta)??(t==null?void 0:t.grossProfit)??0)}]:[]}function XQe(t,e){const r=sb(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,a=t.vendorName||t.sellerName||void 0,s=WQe(t);let o=Number(t.total??t.itemsTotal??0)||s.reduce((l,c)=>{const u=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),d=Math.max(0,Number(c.discount||0)),f=Math.max(0,u-d);return l+f},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:s,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:a,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}function YQe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}async function JQe(t){const e=sr(Ct(Ce,"ar_movements"),cr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Wn(Yt(Ce,"ar_movements",n.id))))}function ZQe(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,C]=g.useState([]),[S,E]=g.useState({}),[B,k]=g.useState({}),[T,P]=g.useState(!1),[G,ce]=g.useState(null),[ue,le]=g.useState([]),[Ae,ae]=g.useState(!1),[_e,De]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[O,H]=g.useState(!1),[K,R]=g.useState(""),[X,Y]=g.useState([]),[D,Q]=g.useState(!1),[te,be]=g.useState("CASH"),[U,Xe]=g.useState(1),se=10,[ee,Fe]=g.useState(!1),[je,Se]=g.useState(null);g.useEffect(()=>{(async()=>{try{const Z=await Ht(Ct(Ce,"sellers_candies")),Qe=[];Z.forEach(at=>{const Ge=at.data();Qe.push({id:at.id,name:Ge.name||"",commissionPercent:Number(Ge.commissionPercent||0)})}),C(Qe)}catch(Z){console.error("Error cargando sellers_candies",Z)}})()},[]);const Ze=g.useMemo(()=>{const Z={};return j.forEach(Qe=>{Z[Qe.id]=Qe}),Z},[j]);g.useEffect(()=>{(async()=>{b(!0),I("");try{const Z=await Ht(Ct(Ce,"sales_candies")),Qe=[],at=[];Z.forEach(ke=>{const Ne=ke.data(),pe=XQe(Ne,ke.id);pe&&(pe.date<=a&&Qe.push(pe),pe.date>=r&&pe.date<=a&&at.push(pe))}),u(Qe),l(at);const Ge=await Ht(Ct(Ce,"inventory_candies")),ie=[];Ge.forEach(ke=>{const Ne=ke.data(),pe=sb(Ne);if(!pe||pe>a)return;const Le=Math.max(1,Math.floor(Number(Ne.unitsPerPackage||1))),ft=Number(Ne.totalUnits??Ne.quantity??0),At=Number(Ne.packages??0),ct=Number(Ne.remaining??0),W=Number(Ne.remainingPackages??0),z=At>0?At:ft>0?Math.floor(ft/Le):0,re=W>0?W:ct>0?Math.floor(ct/Le):0;ie.push({id:ke.id,productId:Ne.productId,productName:Ne.productName||"",date:pe,quantity:Number(z||0),remaining:Number(re||0),purchasePrice:Number(Ne.providerPrice||Ne.purchasePrice||0),unitsPerPackage:Le})}),f(ie);const xe=await Ht(Ct(Ce,"expenses_candies")),de=[];xe.forEach(ke=>{const Ne=ke.data(),pe=sb(Ne);pe&&pe>=r&&pe<=a&&de.push({id:ke.id,date:pe,category:Ne.category||"",description:Ne.description||"",amount:Number(Ne.amount||0),status:Ne.status||""})}),h(de);const Me=await Ht(Ct(Ce,"ar_movements")),me=[],we={};Me.forEach(ke=>{const Ne=ke.data(),pe=sb(Ne);if(!pe)return;const Le=Ne.customerId,ft=Number(Ne.amount||0);Le&&(we[Le]=(we[Le]||0)+ft),Ne.type==="ABONO"&&pe>=r&&pe<=a&&me.push({id:ke.id,customerId:Le,type:"ABONO",amount:ft,date:pe})}),p(me);const pt=await Ht(Ct(Ce,"customers_candies")),vt=[];pt.forEach(ke=>{const Ne=ke.data();vt.push({id:ke.id,name:Ne.name||"",balance:we[ke.id]||0})}),v(vt);const bt=await Ht(Ct(Ce,"inventory_candies_sellers")),kt={},Vt={};bt.forEach(ke=>{const Ne=ke.data(),pe=sb(Ne);if(!pe||pe<r||pe>a)return;const Le=Ne.sellerId||Ne.vendorId||"NO_VENDOR",ft=Ne.productName||"",At=Ne.sku||"",ct=Math.max(1,Math.floor(Number(Ne.unitsPerPackage||1))),W=Number(Ne.totalUnits??0),z=Number(Ne.packages??0),re=Number(Ne.remainingUnits??Ne.remaining??0),V=Number(Ne.remainingPackages??0),L=z>0?z:W>0?Math.floor(W/ct):0,fe=V>0?V:re>0?Math.floor(re/ct):0,Be=Number(Ne.totalVendor??0),ye=Number(Ne.uVendor??0),$e=Number(Ne.subtotal??0),ze=Number(Ne.uBruta??0),Ke=L,yt=Ke>0?Be/Ke:0,ne=Ke>0?ye/Ke:0,Ue=Ke>0?$e/Ke:0,rt=Ke>0?ze>0?ze/Ke:yt-Ue:0;if(kt[Le]||(kt[Le]={associated:[],remaining:[]}),L>0){const st=L,_t=st*yt,Ot=st*Ue,nr=_t,Ir=st*ne,Qr=st*rt;kt[Le].associated.push({saleId:ke.id,date:pe,productId:Ne.productId||Ne.id||"",productName:ft,sku:At,qty:st,unitPrice:yt,costTotal:Ot,lineTotal:_t,discount:0,lineFinal:nr,grossProfit:Qr,vendorCommissionAmount:Ir,type:"ASSOCIATED"}),Vt[Le]=(Vt[Le]||0)+st}if(fe>0){const st=fe,_t=st*yt,Ot=st*Ue,nr=_t,Ir=st*ne,Qr=st*rt;kt[Le].remaining.push({saleId:ke.id,date:pe,productId:Ne.productId||Ne.id||"",productName:ft,sku:At,qty:st,unitPrice:yt,costTotal:Ot,lineTotal:_t,discount:0,lineFinal:nr,grossProfit:Qr,vendorCommissionAmount:Ir,type:"REMAINING"})}}),E(kt),k(Vt)}catch(Z){console.error(Z),I(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ut=g.useCallback((Z,Qe)=>{const at=Number(Qe.vendorCommissionAmount||0)||0;if(at>0)return at;const Ge=Number(Z.vendorCommissionAmount||0)||0;if(Ge<=0)return 0;const ie=Number(Qe.qty||0),xe=Number(Qe.unitPrice||0),de=ie*xe,Me=Math.max(0,Number(Qe.discount||0)),me=Math.max(0,de-Me);return!me||!Z.total?0:Ge*me/Z.total},[]),Et=g.useMemo(()=>{try{return YQe(d,c,r,a)}catch(Z){return console.error(Z),0}},[d,c,r,a]),St=g.useMemo(()=>{const Z=o.reduce((bt,kt)=>bt+(kt.total||0),0),Qe=A.reduce((bt,kt)=>bt+(kt.amount||0),0),at=Z-Et,Ge=at-Qe;let ie=0;for(const bt of o)for(const kt of bt.items||[]){const Vt=Number(kt.uBruta||0);Number.isFinite(Vt)&&(ie+=Vt)}const xe=m.reduce((bt,kt)=>bt+Math.abs(kt.amount||0),0),de=x.filter(bt=>(bt.balance||0)>0),Me=de.reduce((bt,kt)=>bt+(kt.balance||0),0);let me=0,we=0,pt=0,vt=0;for(const bt of o){const kt=(bt.items||[]).reduce((ke,Ne)=>ke+(Number(Ne.qty)||0),0),Vt=(bt.items||[]).reduce((ke,Ne)=>ke+ut(bt,Ne),0);bt.type==="CONTADO"?(me+=kt,pt+=Vt):(we+=kt,vt+=Vt)}return{ventasTotales:Z,costoMercaderia:Et,gastosPeriodo:Qe,gananciaAntes:at,utilidadBrutaOrdenes:ie,gananciaDespues:Ge,abonosRecibidos:xe,saldosPendientes:Me,clientesConSaldo:de.length,paquetesCash:me,paquetesCredito:we,comisionCash:pt,comisionCredito:vt}},[o,A,m,x,Et,ut,S]),Ft=g.useMemo(()=>{const Z={},Qe={};for(const at of o)if(!(at.type!=="CREDITO"||!at.customerId))for(const Ge of at.items||[]){const ie=Number(Ge.qty||0),xe=Number(Ge.unitPrice||0),de=ie*xe,Me=Math.max(0,Number(Ge.discount||0)),me=Math.max(0,de-Me);Z[at.customerId]=(Z[at.customerId]||0)+ie,Qe[at.customerId]=(Qe[at.customerId]||0)+me}return x.filter(at=>(at.balance||0)>0).map(at=>({customerId:at.id,name:at.name,paquetesAsociados:Z[at.id]||0,saldoTotal:Qe[at.id]||0,saldoPendiente:at.balance||0})).sort((at,Ge)=>Ge.saldoPendiente-at.saldoPendiente)},[x,o]),Qt=g.useMemo(()=>{const Z={};return x.forEach(Qe=>Z[Qe.id]=Qe.name),Z},[x]),Ut=g.useMemo(()=>[...o].sort((Z,Qe)=>Qe.date.localeCompare(Z.date)).map(Z=>{var ie;const Qe=(Z.items||[]).reduce((xe,de)=>xe+(Number(de.qty)||0),0);let at="Cash";Z.type==="CREDITO"&&Z.customerId?at=Qt[Z.customerId]||"":Z.type==="CONTADO"&&(at=((ie=Z.customerName)==null?void 0:ie.trim())||"Cash");const Ge=Qe>0?Z.total/Qe:0;return{id:Z.id,date:Z.date,type:Z.type==="CREDITO"?"Crdito":"Cash",customer:at,paquetes:Qe,total:Number(Z.total||0),avgPrice:Ge}}),[o,Qt]),Tt=g.useMemo(()=>{var Qe,at;const Z=new Map;for(const Ge of o){const ie=Ge.vendorId||"NO_VENDOR",xe=Ge.vendorName||((Qe=Ze[ie])==null?void 0:Qe.name)||"Sin vendedor";Z.has(ie)||Z.set(ie,{vendorId:ie,vendorName:xe,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const de=Z.get(ie);for(const Me of Ge.items||[]){const me=Number(Me.qty||0),we=Number(Me.unitPrice||0),pt=me*we,vt=Math.max(0,Number(Me.discount||0)),bt=Math.max(0,pt-vt),kt=ut(Ge,Me);Ge.type==="CONTADO"?(de.paquetesVendidos+=me,de.totalVendido+=bt,de.comisionCash+=kt):(de.paquetesFiados+=me,de.totalFiado+=bt,de.comisionCredito+=kt)}}for(const[Ge,ie]of Object.entries(B)){const xe=Z.get(Ge),de=(xe==null?void 0:xe.vendorName)||((at=Ze[Ge])==null?void 0:at.name)||"Sin vendedor",Me=xe||{vendorId:Ge,vendorName:de,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};Me.paquetesAsociados=ie,Me.paquetesRestantes=Math.max(ie-Me.paquetesVendidos-Me.paquetesFiados,0),Z.set(Ge,Me)}return Array.from(Z.values()).sort((Ge,ie)=>ie.totalVendido+ie.totalFiado-(Ge.totalVendido+Ge.totalFiado))},[o,B,Ze,ut]),Re=async Z=>{P(!0),ce({id:Z.customerId,name:Z.name}),le([]),ae(!0),De({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const Qe=[];let at=0,Ge=0,ie=0;for(const me of o)if(!(me.type!=="CREDITO"||me.customerId!==Z.customerId))for(const we of me.items||[]){const pt=Number(we.qty||0),vt=Number(we.unitPrice||0),bt=pt*vt,kt=Math.max(0,Number(we.discount||0)),Vt=Math.max(0,bt-kt);Qe.push({saleId:me.id,date:me.date,productName:we.productName,sku:we.sku||"",qty:pt,unitPrice:vt,lineTotal:bt,discount:kt,lineFinal:Vt}),at+=bt,Ge+=kt,ie+=Vt}let xe=0;for(const me of m)me.customerId===Z.customerId&&(xe+=Math.abs(me.amount||0));const de=x.find(me=>me.id===Z.customerId),Me=(de==null?void 0:de.balance)||0;le(Qe),De({totalBruto:at,totalDescuento:Ge,totalFiado:ie,saldoActual:Me,abonadoPeriodo:xe})}catch(Qe){console.error(Qe),I(" No se pudo cargar el detalle del cliente.")}finally{ae(!1)}},Te=(Z,Qe,at)=>{H(!0),be(at),Xe(1);let Ge="";at==="ASSOCIATED"?Ge=`Paquetes asociados  ${Qe}`:at==="REMAINING"?Ge=`Paquetes restantes  ${Qe}`:at==="CASH"?Ge=`Paquetes vendidos (Cash)  ${Qe}`:Ge=`Paquetes fiados (Crdito)  ${Qe}`,R(Ge),Y([]),Q(!0);try{if(at==="ASSOCIATED"||at==="REMAINING"){const xe=S[Z],de=at==="ASSOCIATED"?(xe==null?void 0:xe.associated)||[]:(xe==null?void 0:xe.remaining)||[];Y([...de].sort((Me,me)=>(me.qty||0)-(Me.qty||0))),Q(!1);return}const ie=[];for(const xe of o)if(((xe.vendorId||"NO_VENDOR")===Z||!xe.vendorId&&Z==="NO_VENDOR")&&!(at==="CASH"&&xe.type!=="CONTADO")&&!(at==="CREDIT"&&xe.type!=="CREDITO"))for(const Me of xe.items||[]){const me=Number(Me.qty||0),we=Number(Me.unitPrice||0),pt=me*we,vt=Math.max(0,Number(Me.discount||0)),bt=Math.max(0,pt-vt),kt=ut(xe,Me);ie.push({saleId:xe.id,date:xe.date,productName:Me.productName,sku:Me.sku||"",qty:me,unitPrice:we,lineTotal:pt,discount:vt,lineFinal:bt,vendorCommissionAmount:kt,type:at})}Y(ie.sort((xe,de)=>xe.date.localeCompare(de.date)))}catch(ie){console.error(ie),I(" No se pudo cargar el detalle del vendedor.")}finally{Q(!1)}},Ye=g.useMemo(()=>te!=="ASSOCIATED"&&te!=="REMAINING"?1:Math.max(1,Math.ceil(X.length/se)),[te,X.length]),ht=g.useMemo(()=>{if(te!=="ASSOCIATED"&&te!=="REMAINING")return X;const Z=(U-1)*se;return X.slice(Z,Z+se)},[te,U,X]),Oe=te==="ASSOCIATED"||te==="REMAINING"?10:8;g.useEffect(()=>{te!=="ASSOCIATED"&&te!=="REMAINING"||U>Ye&&Xe(Ye)},[te,U,Ye]);const Ie=Z=>{const Qe=o.find(at=>at.id===Z)||null;Se(Qe),Fe(!0)},We=async Z=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await W2(Z),await JQe(Z),l(Qe=>Qe.filter(at=>at.id!==Z)),u(Qe=>Qe.filter(at=>at.id!==Z)),Fe(!1),Se(null)}catch(Qe){console.error(Qe),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(Mc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Z=>n(Z.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Z=>s(Z.target.value)})]})]}),i.jsx("div",{className:"md:hidden mb-4",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",open:!0,children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"KPIs"}),i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(St.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(St.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:St.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:St.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:St.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.comisionCredito)})]})]})})]})}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(St.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(St.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:St.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:St.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:St.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(St.comisionCredito)})]})]}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Consolidado clientes y vendedores"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border",children:"Saldo total"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ft.map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Re({customerId:Z.customerId,name:Z.name}),title:"Ver paquetes fiados del periodo",children:Z.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:bn(Z.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:bn(Z.saldoPendiente)})]},Z.customerId))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Tt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Tt.map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"ASSOCIATED"),children:Z.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"REMAINING"),children:Z.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"CASH"),children:Z.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"CREDIT"),children:Z.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.comisionCredito)})]},Z.vendorId))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ft.map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Re({customerId:Z.customerId,name:Z.name}),title:"Ver paquetes fiados del periodo",children:Z.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:bn(Z.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:bn(Z.saldoPendiente)})]},Z.customerId))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Tt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Tt.map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"ASSOCIATED"),children:Z.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"REMAINING"),children:Z.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"CASH"),children:Z.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(Z.vendorId,Z.vendorName,"CREDIT"),children:Z.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.comisionCredito)})]},Z.vendorId))})]})}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Transacciones y gastos"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Ut.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Ut.map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ie(Z.id),children:Z.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>We(Z.id),children:"Eliminar"})})]},Z.id))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((Z,Qe)=>Z.date.localeCompare(Qe.date)).map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.date}),i.jsx("td",{className:"p-2 border",children:Z.category||""}),i.jsx("td",{className:"p-2 border",children:Z.description?i.jsx("span",{title:Z.description,children:Z.description.length>40?Z.description.slice(0,40)+"":Z.description}):""}),i.jsx("td",{className:"p-2 border",children:bn(Z.amount)}),i.jsx("td",{className:"p-2 border",children:Z.status||""})]},Z.id))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Ut.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Ut.map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Z.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ie(Z.id),children:Z.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(Z.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>We(Z.id),children:"Eliminar"})})]},Z.id))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((Z,Qe)=>Z.date.localeCompare(Qe.date)).map(Z=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.date}),i.jsx("td",{className:"p-2 border",children:Z.category||""}),i.jsx("td",{className:"p-2 border",children:Z.description?i.jsx("span",{title:Z.description,children:Z.description.length>40?Z.description.slice(0,40)+"":Z.description}):""}),i.jsx("td",{className:"p-2 border",children:bn(Z.amount)}),i.jsx("td",{className:"p-2 border",children:Z.status||""})]},Z.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(G==null?void 0:G.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>P(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(_e.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(_e.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(_e.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(_e.abonadoPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(_e.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:Ae?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ue.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ue.sort((Z,Qe)=>Z.date.localeCompare(Qe.date)).map((Z,Qe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.date}),i.jsx("td",{className:"p-2 border",children:Z.productName}),i.jsx("td",{className:"p-2 border",children:Z.qty}),i.jsx("td",{className:"p-2 border",children:bn(Z.unitPrice)}),i.jsx("td",{className:"p-2 border",children:bn(Z.lineTotal)}),i.jsx("td",{className:"p-2 border",children:bn(Z.discount)}),i.jsx("td",{className:"p-2 border",children:bn(Z.lineFinal)})]},`${Z.saleId}-${Qe}`))})]})})]})}),O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:K}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>H(!1),children:"Cerrar"})]}),(te==="ASSOCIATED"||te==="REMAINING")&&!D&&i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2 text-sm",children:[i.jsxs("div",{className:"text-gray-600",children:["Pgina ",U," de ",Ye]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Xe(Z=>Math.max(1,Z-1)),disabled:U<=1,children:"Anterior"}),i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Xe(Z=>Math.min(Ye,Z+1)),disabled:U>=Ye,children:"Siguiente"})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha Orden"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Costo"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]}):i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Utilidad vendedor"})]}):i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:D?i.jsx("tr",{children:i.jsx("td",{colSpan:Oe,className:"p-4 text-center",children:"Cargando"})}):X.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:Oe,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):ht.map((Z,Qe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.date}),i.jsx("td",{className:"p-2 border",children:Z.productName}),i.jsx("td",{className:"p-2 border",children:Z.qty}),i.jsx("td",{className:"p-2 border",children:bn(Z.unitPrice)}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:bn(Z.costTotal??0)}),i.jsx("td",{className:"p-2 border",children:bn(Z.lineTotal)})]}):i.jsx("td",{className:"p-2 border",children:bn(Z.lineTotal)}),i.jsx("td",{className:"p-2 border",children:bn(Z.discount)}),i.jsx("td",{className:"p-2 border",children:bn(Z.lineFinal)}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:bn(Z.grossProfit||0)}),i.jsx("td",{className:"p-2 border",children:bn(Z.vendorCommissionAmount)})]}):i.jsx("td",{className:"p-2 border",children:bn(Z.vendorCommissionAmount)})]},`${Z.saleId}-${Qe}`))})]})})]})}),ee&&je&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",je.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Fe(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(je.items||[]).map((Z,Qe)=>{const at=Number(Z.qty||0),Ge=Number(Z.unitPrice||0),ie=at*Ge,xe=ut(je,Z);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Z.productName}),i.jsx("td",{className:"p-2 border",children:at}),i.jsx("td",{className:"p-2 border",children:bn(Ge)}),i.jsx("td",{className:"p-2 border",children:bn(ie)}),i.jsx("td",{className:"p-2 border",children:bn(xe)})]},Qe)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),bn(je.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>We(je.id),children:"Eliminar venta"})]})]})})]})}const pG=["Rivas","Isla Ometepe","San Jorge"];function eVe(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState("0"),[m,p]=g.useState("Rivas"),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,I]=g.useState("0"),[j,C]=g.useState("Rivas");g.useEffect(()=>{(async()=>{s(!0),l("");try{const G=sr(Ct(Ce,"sellers_candies"),Sn("name","asc")),ce=await Ht(G),ue=[];ce.forEach(le=>{const Ae=le.data();ue.push({id:le.id,name:Ae.name||"",commissionPercent:Number(Ae.commissionPercent||0),branch:Ae.branch||"Rivas",createdAt:Ae.createdAt||yr.now()})}),n(ue)}catch(G){console.error(G),l(" Error cargando vendedores.")}finally{s(!1)}})()},[t]);const S=()=>{f(""),h("0"),p("Rivas")},E=async G=>{G.preventDefault(),l("");const ce=d.trim();if(!ce){l("Ingresa el nombre y apellido del vendedor.");return}const ue=Number(A||0);if(ue<0){l("El margen no puede ser negativo.");return}try{const le={name:ce,commissionPercent:ue,branch:m,createdAt:yr.now()},Ae=await Gn(Ct(Ce,"sellers_candies"),le);n(ae=>[{id:Ae.id,...le},...ae]),l(" Vendedor creado correctamente."),S(),u(!1)}catch(le){console.error(le),l(" Error al crear el vendedor.")}},B=G=>{v(G.id),b(G.name),I(G.commissionPercent.toString()),C(G.branch)},k=()=>{v(null),b(""),I("0"),C("Rivas")},T=async()=>{if(!x)return;l("");const G=y.trim();if(!G){l("El nombre y apellido no pueden estar vacos.");return}const ce=Number(w||0);if(ce<0){l("El margen no puede ser negativo.");return}try{await kn(Yt(Ce,"sellers_candies",x),{name:G,commissionPercent:ce,branch:j}),n(ue=>ue.map(le=>le.id===x?{...le,name:G,commissionPercent:ce,branch:j}:le)),l(" Vendedor actualizado."),k()}catch(ue){console.error(ue),l(" Error al actualizar el vendedor.")}},P=async G=>{if(window.confirm(`Eliminar al vendedor "${G.name}"? Esta accin no se puede deshacer.`))try{await Wn(Yt(Ce,"sellers_candies",G.id)),n(ue=>ue.filter(le=>le.id!==G.id)),l(" Vendedor eliminado.")}catch(ue){console.error(ue),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Mc,{onClick:e,loading:a}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>u(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:G=>f(G.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Margen del vendedor (% sobre U Aproximada)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:A,onChange:G=>h(G.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje YA NO es comisin sobre venta. Se aplica as: U. Vendedor = U. Aproximada  (margen/100). U. Inversionista = U. Aproximada  U. Vendedor."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:G=>p(G.target.value),children:pG.map(G=>i.jsx("option",{value:G,children:G},G))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{S(),u(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Margen (% U Aproximada)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(G=>{const ce=x===G.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:ce?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:ue=>b(ue.target.value)}):G.name}),i.jsx("td",{className:"p-2 border",children:ce?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:w,onChange:ue=>I(ue.target.value)}):`${G.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:ce?i.jsx("select",{className:"border p-1 rounded text-xs",value:j,onChange:ue=>C(ue.target.value),children:pG.map(ue=>i.jsx("option",{value:ue,children:ue},ue))}):G.branch}),i.jsx("td",{className:"p-2 border",children:ce?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:T,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:k,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>B(G),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>P(G),children:"Borrar"})]})})]},G.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const la=t=>Math.max(0,Math.floor(Number(t||0)));function X2(t){return Math.max(1,la(t.unitsPerPackage||1))}function gG(t){const e=Number(t.remaining);if(Number.isFinite(e)&&e>0)return Math.floor(e);const r=Number(t.remainingPackages??t.remainingPacks??t.packagesRemaining??0);if(Number.isFinite(r)&&r>0){const l=X2(t);return Math.floor(r*l)}const n=X2(t),a=Number(t.totalUnits||0),s=Number(t.quantity||0),o=Number(t.packages||0);return a>0?Math.floor(a):s>0?Math.floor(s):o>0?Math.floor(o*n):0}async function tVe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);const n=!!t.deleteVendorAfter;if(!e||r<=0)return{restoredPackages:0,mode:"noop"};const a=sr(Ct(Ce,"inventory_transfers_candies"),cr("toVendorRowId","==",e)),s=await Ht(a);if(s.empty)return{restoredPackages:0,mode:"noop"};const o=s.docs.map(f=>({id:f.id,...f.data()})).filter(f=>String(f.fromVendorRowId||"").trim()!=="").sort((f,A)=>{var p,x;const h=Number(((p=f.createdAt)==null?void 0:p.seconds)??0);return Number(((x=A.createdAt)==null?void 0:x.seconds)??0)-h});if(!o.length)return{restoredPackages:0,mode:"noop"};const l=[];let c=r;for(const f of o){if(c<=0)break;const A=la(f.packagesMoved||0);if(A<=0)continue;const h=Math.min(c,A);h<=0||(l.push({fromVendorRowId:String(f.fromVendorRowId),packs:h}),c-=h)}if(!l.length)return{restoredPackages:0,mode:"noop"};const u=Yt(Ce,"inventory_candies_sellers",e),d=l.map(f=>Yt(Ce,"inventory_candies_sellers",f.fromVendorRowId));return await zs(Ce,async f=>{const A=await Promise.all(d.map(h=>f.get(h)));for(let h=0;h<l.length;h++){const m=d[h],p=A[h];if(!p.exists())continue;const x=p.data(),v=la(l[h].packs||0);if(v<=0)continue;const y=Math.max(1,la(x.unitsPerPackage||1)),b=v*y,w=Number(x.remainingPackages||0),I=Number(x.packages||0);f.update(m,{packages:Math.max(0,I+v),remainingPackages:Math.max(0,w+v),...y>0?{remainingUnits:Number(x.remainingUnits||0)+b}:{},transferDelta:Number(x.transferDelta||0)+v,updatedAt:yr.now()})}n&&f.delete(u)}),{restoredPackages:r-c,mode:"transfer"}}async function bF(t){const{orderId:e,productId:r}=t;let n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=sr(Ct(Ce,"inventory_candies"),cr("orderId","==",e),cr("productId","==",r),Sn("createdAt","asc")),s=await Ht(a);if(s.empty)return;const o=s.docs.map(l=>l.ref);await zs(Ce,async l=>{const c=await Promise.all(o.map(u=>l.get(u)));for(let u=0;u<o.length&&n>0;u++){const d=c[u];if(!d.exists())continue;const f=d.data(),A=X2(f),h=n*A,p=la(f.remaining??0)+h,x=Math.floor(p/A);l.update(o[u],{remaining:p,remainingPackages:x,packages:x,updatedAt:yr.now()}),n=0}})}async function wF(t){const{orderId:e,productId:r}=t,n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=Yt(Ce,"candy_main_orders",e);await zs(Ce,async s=>{const o=await s.get(a);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let u=!1;const d=c.map(f=>String((f==null?void 0:f.id)||"")!==String(r)?f:(u=!0,{...f,remainingPackages:la(f.remainingPackages)+n}));u&&s.update(a,{items:d,updatedAt:yr.now()})})}function NF(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),a=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),s=la((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,la((r==null?void 0:r.unitsPerPackage)||1));!n||!a||s<=0||e.push({batchId:n,masterOrderId:a,units:s,unitsPerPackage:o})}return e}function Y2(t,e){const r=la(t),n=Math.max(1,la(e));return Math.floor(r/n)}async function xG(t){const e=String(t.productId||"");let r=la(t.packagesToAllocate);if(!e||r<=0)return{allocations:[]};const n=sr(Ct(Ce,"inventory_candies"),cr("productId","==",e)),a=await Ht(n);if(a.empty)throw new Error("No hay inventario para este producto.");const o=a.docs.map(c=>({id:c.id,data:c.data()})).sort((c,u)=>{var m,p;const d=String(c.data.date||""),f=String(u.data.date||"");if(d!==f)return d<f?-1:1;const A=((m=c.data.createdAt)==null?void 0:m.seconds)??0,h=((p=u.data.createdAt)==null?void 0:p.seconds)??0;return A-h}).map(c=>Yt(Ce,"inventory_candies",c.id)),l=[];return await zs(Ce,async c=>{const u=await Promise.all(o.map(y=>c.get(y))),d=[];let f=r;for(let y=0;y<o.length&&f>0;y++){const b=o[y],w=u[y];if(!w.exists())continue;const I=w.data(),j=X2(I),C=gG(I);if(C<=0)continue;const S=Math.floor(C/j);if(S<=0)continue;const E=Math.min(S,f),B=E*j,k=Math.max(0,C-B),T=Math.floor(k/j),P=String(I.orderId||"");if(!P)throw new Error("Lote sin orderId (orden maestra).");l.push({batchId:b.id,masterOrderId:P,units:B,unitsPerPackage:j}),d.push({ref:b,newRemUnits:k,newRemPacks:T}),f-=E}if(f>0)throw new Error(`Inventario insuficiente. Faltan ${f} paquetes.`);const A={};for(const y of l){const b=Y2(y.units,y.unitsPerPackage);A[y.masterOrderId]=(A[y.masterOrderId]||0)+b}const h=new Map;for(let y=0;y<d.length;y++){const b=d[y];h.set(b.ref.id,b.newRemUnits)}const m={};for(let y=0;y<o.length;y++){const b=o[y],w=u[y];if(!w.exists())continue;const I=w.data(),j=String(I.orderId||""),C=String(I.productId||"");if(!j||!C)continue;const S=X2(I),E=h.get(b.id),B=typeof E=="number"?E:gG(I),k=Math.floor(B/S);m[j]||(m[j]={}),m[j][C]=(m[j][C]||0)+Math.max(0,k)}const p=Object.keys(A),x=p.map(y=>Yt(Ce,"candy_main_orders",y)),v=await Promise.all(x.map(y=>c.get(y)));for(let y=0;y<d.length;y++){const b=d[y];c.update(b.ref,{remaining:b.newRemUnits,remainingPackages:b.newRemPacks,packages:b.newRemPacks,updatedAt:yr.now()})}for(let y=0;y<x.length;y++){const b=v[y];if(!b.exists())throw new Error("Orden maestra no existe.");const w=b.data(),I=Array.isArray(w.items)?w.items:[],j=p[y];if(la(A[j]||0)<=0)continue;let S=!1;const E=I.map(B=>{var T;if(String((B==null?void 0:B.id)||"")!==e)return B;S=!0;const k=((T=m[j])==null?void 0:T[e])??la(B.remainingPackages||0);return{...B,remainingPackages:Math.max(0,la(k||0))}});S&&c.update(x[y],{items:E,updatedAt:yr.now()})}}),{allocations:l}}async function rVe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);if(!e)throw new Error("vendorInventoryId requerido");if(r<=0)return{restoredPackages:0,mode:"noop"};const n=Yt(Ce,"inventory_candies_sellers",e),a=await gs(n);if(!a.exists())throw new Error("No existe la orden del vendedor");const s=a.data(),o=String(s.productId||"");if(!o)throw new Error("La orden del vendedor no tiene productId");if(!NF(s.masterAllocations||s.allocations||s.allocationsByBatch).length){const u=String(s.orderId||"");if(!u)throw new Error("La orden del vendedor no tiene orderId");return await bF({orderId:u,productId:o,packagesToReturn:r}),await wF({orderId:u,productId:o,packagesToReturn:r}),{restoredPackages:r,mode:"legacy"}}let c=0;return await zs(Ce,async u=>{const d=await u.get(n);if(!d.exists())throw new Error("No existe la orden del vendedor");const f=d.data(),A=String(f.productId||"");if(!A)throw new Error("Doc vendedor sin productId");let h=NF(f.masterAllocations||f.allocations||f.allocationsByBatch);if(!h.length)throw new Error("No hay masterAllocations guardadas en este doc (no se puede restaurar blindado).");const m=[];let p=r;for(let E=h.length-1;E>=0&&p>0;E--){const B=h[E],k=Math.max(1,la(B.unitsPerPackage||1)),T=Y2(B.units,k);if(T<=0)continue;const P=Math.min(T,p),G=P*k;m.push({batchId:B.batchId,masterOrderId:B.masterOrderId,units:G,unitsPerPackage:k}),p-=P}const x=r-p;if(x<=0)return;c=x;const v=m.map(E=>Yt(Ce,"inventory_candies",E.batchId)),y={};for(const E of m){const B=Y2(E.units,E.unitsPerPackage);B>0&&(y[E.masterOrderId]=(y[E.masterOrderId]||0)+B)}const w=Object.keys(y).map(E=>Yt(Ce,"candy_main_orders",E)),[I,j]=await Promise.all([Promise.all(v.map(E=>u.get(E))),Promise.all(w.map(E=>u.get(E)))]);for(let E=0;E<m.length;E++){const B=m[E],k=I[E];if(!k.exists())continue;const T=k.data(),P=Math.max(1,la(B.unitsPerPackage||T.unitsPerPackage||1)),G=la(B.units),ue=la(T.remaining??0)+G,le=Math.floor(ue/P);u.update(v[E],{remaining:ue,remainingPackages:le,packages:le,updatedAt:yr.now()})}for(let E=0;E<w.length;E++){const B=j[E];if(!B.exists())continue;const k=w[E].id,T=la(y[k]||0);if(T<=0)continue;const P=B.data(),G=Array.isArray(P.items)?P.items:[];let ce=!1;const ue=G.map(le=>String((le==null?void 0:le.id)||"")!==String(A)?le:(ce=!0,{...le,remainingPackages:la(le.remainingPackages)+T}));ce&&u.update(w[E],{items:ue,updatedAt:yr.now()})}const C=new Map;for(const E of m){const B=`${E.batchId}__${E.masterOrderId}__${E.unitsPerPackage}`;C.set(B,(C.get(B)||0)+la(E.units))}const S=[];for(const E of h){const B=Math.max(1,la(E.unitsPerPackage||1)),k=`${E.batchId}__${E.masterOrderId}__${B}`,T=la(C.get(k)||0);if(T<=0){S.push(E);continue}const G=la(E.units)-T;G>0&&S.push({...E,units:G,unitsPerPackage:B}),C.delete(k)}u.update(n,{masterAllocations:S,updatedAt:yr.now()})}),{restoredPackages:c,mode:"blind"}}async function vG(t){if(!t)throw new Error("vendorInventoryId requerido");const e=Yt(Ce,"inventory_candies_sellers",t),r=await gs(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),a=String(n.productId||""),s=la(n.remainingPackages||n.packages||0),o=la(n.packages||n.remainingPackages||0),l=NF(n.masterAllocations||n.allocations||n.allocationsByBatch),c=await tVe({vendorInventoryId:t,packagesToReturn:s,deleteVendorAfter:!1});if(!l.length){const d=String(n.orderId||"");if(!d)throw new Error("La orden del vendedor no tiene orderId");if(!a)throw new Error("La orden del vendedor no tiene productId");if(c.restoredPackages>0){const f=Math.max(0,s-c.restoredPackages);return f<=0?(await zs(Ce,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages,mode:"transfer"}):(await bF({orderId:d,productId:a,packagesToReturn:f}),await wF({orderId:d,productId:a,packagesToReturn:f}),await zs(Ce,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages+f,mode:"transfer+legacy"})}return o<=0?(await zs(Ce,async f=>{f.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await bF({orderId:d,productId:a,packagesToReturn:o}),await wF({orderId:d,productId:a,packagesToReturn:o}),await zs(Ce,async f=>{f.delete(e)}),{restoredPackages:o,mode:"legacy"})}let u=0;return await zs(Ce,async d=>{const f={};for(const y of l){const b=Math.max(1,la(y.unitsPerPackage||1)),w=la(y.units),I=Y2(w,b);I>0&&(f[y.masterOrderId]=(f[y.masterOrderId]||0)+I)}const A=l.map(y=>Yt(Ce,"inventory_candies",y.batchId)),m=Object.keys(f).map(y=>Yt(Ce,"candy_main_orders",y)),[p,x]=await Promise.all([Promise.all(A.map(y=>d.get(y))),Promise.all(m.map(y=>d.get(y)))]);let v=0;for(let y=0;y<l.length;y++){const b=l[y],w=p[y];if(!w.exists())continue;const I=w.data(),j=Math.max(1,la(b.unitsPerPackage||I.unitsPerPackage||1)),C=la(b.units),E=la(I.remaining??0)+C,B=Math.floor(E/j);d.update(A[y],{remaining:E,remainingPackages:B,packages:B,updatedAt:yr.now()});const k=Y2(C,j);k>0&&(v+=k)}for(let y=0;y<m.length;y++){const b=x[y];if(!b.exists())continue;const w=m[y].id,I=la(f[w]||0);if(I<=0)continue;const j=b.data(),C=Array.isArray(j.items)?j.items:[];let S=!1;const E=C.map(B=>String((B==null?void 0:B.id)||"")!==String(a)?B:(S=!0,{...B,remainingPackages:la(B.remainingPackages)+I}));S&&d.update(m[y],{items:E,updatedAt:yr.now()})}d.delete(e),u=v}),{restoredPackages:u,mode:"blind"}}const oT=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Gse=(t,e)=>`${t}__${e}`,nVe=t=>t?typeof t=="string"?t:t!=null&&t.seconds?new Date(t.seconds*1e3).toISOString().slice(0,10):t!=null&&t.toDate?t.toDate().toISOString().slice(0,10):"":"",aVe=t=>{const e=t.sellerId||"",r=nVe(t.date);return e&&r?Gse(e,r):t.orderId?t.orderId:t.id},yG=(t,e=!1)=>{if(!t)return null;const r=new Date(t);return Number.isNaN(r.getTime())?null:(e?r.setHours(23,59,59,999):r.setHours(0,0,0,0),r)},sVe=t=>{var e,r;if((e=t.createdAt)!=null&&e.toDate)return t.createdAt.toDate();if((r=t.createdAt)!=null&&r.seconds)return new Date(t.createdAt.seconds*1e3);if(t.date){const n=new Date(t.date);if(!Number.isNaN(n.getTime()))return n}return null},bG=t=>{const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"},CF=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},wG=(t,e)=>{const r=CF(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}},NG=(t,e)=>e?e==="RIVAS"?t.unitPriceRivas||0:e==="SAN_JORGE"?t.unitPriceSanJorge||0:t.unitPriceIsla||0:t.unitPriceIsla||0,CG=(t,e)=>e?e==="RIVAS"?t.grossProfitPerPackRivas||0:e==="SAN_JORGE"?t.grossProfitPerPackSanJorge||0:t.grossProfitPerPackIsla||0:t.grossProfitPerPackIsla||0,_G=(t,e)=>e?e==="RIVAS"?t.uApproxPerPackRivas||0:e==="SAN_JORGE"?t.uApproxPerPackSanJorge||0:t.uApproxPerPackIsla||0:t.uApproxPerPackIsla||0;function iVe({open:t,onClose:e,orders:r,rows:n,setRows:a,isAdmin:s,currentUserEmail:o,currentUserName:l,sellerCandyId:c,sellers:u,products:d,transferAgg:f,setTransferAgg:A,setTransferRowDeltas:h}){const[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState(""),[w,I]=g.useState(""),[j,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState("0"),[T,P]=g.useState(""),[G,ce]=g.useState(!1),[ue,le]=g.useState(""),[Ae,ae]=g.useState(!1),[_e,De]=g.useState(""),[O,H]=g.useState(()=>new Date().toISOString().slice(0,10)),[K,R]=g.useState(""),[X,Y]=g.useState(()=>{const Te=new Date;return new Date(Te.getFullYear(),Te.getMonth(),1).toISOString().slice(0,10)}),[D,Q]=g.useState(()=>new Date().toISOString().slice(0,10)),te=g.useMemo(()=>{const Te={};return u.forEach(Ye=>{Te[Ye.id]=Ye}),Te},[u]),be=g.useMemo(()=>{const Te={};return d.forEach(Ye=>{Te[Ye.id]=Ye}),Te},[d]),U=_e&&te[_e]||null,Xe=g.useMemo(()=>r.map(Te=>Te.orderKey),[r]),se=g.useMemo(()=>{const Te={};return r.forEach(Ye=>Te[Ye.orderKey]=Ye),Te},[r]),ee=n,Fe=g.useMemo(()=>{const Te={};return ee.forEach(Ye=>{const ht=aVe(Ye),Oe=new Set;ht&&Oe.add(ht),Ye.orderId&&Oe.add(String(Ye.orderId)),Oe.add(Ye.id),Oe.forEach(Ie=>{Te[Ie]||(Te[Ie]=[]),Te[Ie].push(Ye)})}),Te},[ee]),je=g.useMemo(()=>y?Fe[y]||[]:[],[Fe,y]),Se=g.useMemo(()=>je.filter(Te=>{const Ye=Te.remainingPackages??Te.remaining??Te.packages??0;return Number(Ye||0)>0}),[je]),Ze=g.useMemo(()=>{const Te=K.trim().toLowerCase();return Te?Se.filter(Ye=>`${Ye.category||""} ${Ye.productName||""}`.toLowerCase().trim().includes(Te)):Se},[Se,K]),ut=g.useMemo(()=>w&&ee.find(Te=>Te.id===w)||null,[ee,w]),Et=g.useMemo(()=>{if(ut!=null&&ut.sellerId)return ut.sellerId;const Te=se[y];return(Te==null?void 0:Te.sellerId)||""},[ut,se,y]),St=g.useMemo(()=>j?Fe[j]||[]:[],[Fe,j]),Ft=g.useMemo(()=>ut?St.filter(Te=>Te.productId===ut.productId):[],[St,ut]),Qt=async()=>{try{p(!0);let Te=[];if(!s&&c){const Ye=sr(Ct(Ce,"inventory_transfers_candies"),cr("fromSellerId","==",c),Sn("createdAt","desc")),ht=sr(Ct(Ce,"inventory_transfers_candies"),cr("toSellerId","==",c),Sn("createdAt","desc")),[Oe,Ie]=await Promise.all([Ht(Ye),Ht(ht)]),We=new Set,Z=Qe=>{Qe.forEach(at=>{if(We.has(at.id))return;We.add(at.id);const Ge=at.data();Te.push({id:at.id,...Ge})})};Z(Oe),Z(Ie),Te.sort((Qe,at)=>{var xe,de;const Ge=((xe=Qe.createdAt)==null?void 0:xe.seconds)||0;return(((de=at.createdAt)==null?void 0:de.seconds)||0)-Ge})}else{const Ye=sr(Ct(Ce,"inventory_transfers_candies"),Sn("createdAt","desc"));(await Ht(Ye)).forEach(Oe=>{const Ie=Oe.data();Te.push({id:Oe.id,...Ie})})}v(Te)}catch{le(" Error cargando traslados.")}finally{p(!1)}};g.useEffect(()=>{t&&Qt()},[t]);const Ut=g.useMemo(()=>{const Te=yG(X),Ye=yG(D,!0);return x.filter(ht=>{const Oe=sVe(ht);return Oe?!(Te&&Oe<Te||Ye&&Oe>Ye):!0})},[x,X,D]);g.useEffect(()=>{R("")},[y]),g.useEffect(()=>{if(Ae){if(!_e){const Te=se[y];Te!=null&&Te.sellerId&&De(Te.sellerId)}O||H(new Date().toISOString().slice(0,10))}},[Ae,_e,O,se,y]);const Tt=()=>{b(""),I(""),C(""),E(""),k("0"),P(""),ae(!1),De(""),H(new Date().toISOString().slice(0,10))},Re=async()=>{if(!s){le("No tienes permiso para hacer traslados.");return}le("");const Te=Number(B||0);if(!(Te>0)){le("La cantidad de paquetes debe ser mayor a 0.");return}if(!T.trim()){le("Debes escribir el motivo de la movida.");return}if(!y||!w){le("Selecciona el pedido origen y el producto.");return}const Ye=Ae;if(!Ye&&!j){le("Selecciona el pedido destino.");return}if(Ye){if(!_e){le("Selecciona el vendedor de la nueva orden.");return}if(!O){le("Selecciona la fecha de la nueva orden.");return}}const ht=!Ye&&j&&se[j]||null;if(!Ye&&!ht){le("Selecciona un pedido destino vlido.");return}const Oe=ht?te[ht.sellerId]||{id:ht.sellerId||"",name:ht.sellerName||"",email:ht.sellerEmail||"",branch:ht.branch,branchLabel:ht.branchLabel,commissionPercent:ht.vendorMarginPercent??ht.commissionPercent??0}:null,Ie=n.find(me=>me.id===w)||null,We=!Ye&&S&&n.find(me=>me.id===S)||null;if(!Ie){le("No se encontr la fila origen/destino.");return}if(!Ye&&We&&w===S){le("Origen y destino no pueden ser el mismo.");return}if(!Ye&&We&&Ie.productId!==We.productId){le("El producto destino no coincide con el producto origen.");return}if(Number(Ie.remainingPackages||0)<Te){le("El origen no tiene suficientes paquetes disponibles.");return}const Z=Ye?U:null;if(Ye&&!Z){le("Selecciona un vendedor destino vlido.");return}const Qe=be[Ie.productId]||null,at=Ye?bG((Z==null?void 0:Z.branch)||(Z==null?void 0:Z.branchLabel)):void 0,Ge=!Ye&&!S&&!!ht,ie=Ye||Ge;let xe=null,de=null,Me="";if(Ye&&Z){const me=CF(Z.commissionPercent??0),we=at,pt=Number((Qe==null?void 0:Qe.unitsPerPackage)??Ie.unitsPerPackage??0),vt=pt>0?pt*Te:0;Qe?NG(Qe,we):Number(Ie.unitPriceRivas||Ie.unitPriceIsla||0);const kt=(Qe?CG(Qe,we):Number(Ie.grossProfit||0)/Math.max(1,Ie.packages||1))*Te,Vt=Qe?Number(Qe.logisticAllocatedPerPack||0)*Te:Number(Ie.logisticAllocated||0),Ne=(Qe?_G(Qe,we):Number(Ie.uAproximada||0)/Math.max(1,Ie.packages||1))*Te,pe=wG(kt,me),Le=Number(kt||0)-Number(Vt||0)-Number(pe.uVendor||0),ft=((Qe==null?void 0:Qe.unitPriceRivas)||Ie.unitPriceRivas||0)*Te,At=((Qe==null?void 0:Qe.unitPriceSanJorge)||Ie.unitPriceSanJorge||0)*Te,ct=((Qe==null?void 0:Qe.unitPriceIsla)||Ie.unitPriceIsla||0)*Te;Me=Gse(Z.id,O),xe={sellerId:Z.id,sellerName:Z.name,sellerEmail:Z.email||"",branch:we||"",branchLabel:Z.branchLabel||"",productId:Ie.productId,productName:Ie.productName,category:Ie.category,orderId:Me,date:O,packages:Te,unitsPerPackage:pt,totalUnits:vt,remainingPackages:Te,remainingUnits:vt,totalRivas:ft,totalSanJorge:At,totalIsla:ct,unitPriceRivas:(Qe==null?void 0:Qe.unitPriceRivas)||Ie.unitPriceRivas||0,unitPriceSanJorge:(Qe==null?void 0:Qe.unitPriceSanJorge)||Ie.unitPriceSanJorge||0,unitPriceIsla:(Qe==null?void 0:Qe.unitPriceIsla)||Ie.unitPriceIsla||0,grossProfit:kt,logisticAllocated:Vt,vendorMarginPercent:pe.vendorMarginPercent,uVendor:pe.uVendor,uInvestor:pe.uInvestor,uAproximada:Ne,uNeta:Le,providerPrice:Ie.providerPrice,transferDelta:0}}if(Ge&&ht){const me=CF((Oe==null?void 0:Oe.commissionPercent)??ht.vendorMarginPercent??0),we=bG((Oe==null?void 0:Oe.branch)||(Oe==null?void 0:Oe.branchLabel)||ht.branch||ht.branchLabel),pt=Number((Qe==null?void 0:Qe.unitsPerPackage)??Ie.unitsPerPackage??0),vt=pt>0?pt*Te:0;Qe?NG(Qe,we):Number(Ie.unitPriceRivas||Ie.unitPriceIsla||0);const kt=(Qe?CG(Qe,we):Number(Ie.grossProfit||0)/Math.max(1,Ie.packages||1))*Te,Vt=Qe?Number(Qe.logisticAllocatedPerPack||0)*Te:Number(Ie.logisticAllocated||0),Ne=(Qe?_G(Qe,we):Number(Ie.uAproximada||0)/Math.max(1,Ie.packages||1))*Te,pe=wG(kt,me),Le=Number(kt||0)-Number(Vt||0)-Number(pe.uVendor||0),ft=((Qe==null?void 0:Qe.unitPriceRivas)||Ie.unitPriceRivas||0)*Te,At=((Qe==null?void 0:Qe.unitPriceSanJorge)||Ie.unitPriceSanJorge||0)*Te,ct=((Qe==null?void 0:Qe.unitPriceIsla)||Ie.unitPriceIsla||0)*Te;de={sellerId:ht.sellerId,sellerName:(Oe==null?void 0:Oe.name)||ht.sellerName||"",sellerEmail:(Oe==null?void 0:Oe.email)||ht.sellerEmail||"",branch:we||ht.branch||"",branchLabel:(Oe==null?void 0:Oe.branchLabel)||ht.branchLabel||"",productId:Ie.productId,productName:Ie.productName,category:Ie.category,orderId:ht.orderKey||j,date:ht.date||new Date().toISOString().slice(0,10),packages:Te,unitsPerPackage:pt,totalUnits:vt,remainingPackages:Te,remainingUnits:vt,totalRivas:ft,totalSanJorge:At,totalIsla:ct,unitPriceRivas:(Qe==null?void 0:Qe.unitPriceRivas)||Ie.unitPriceRivas||0,unitPriceSanJorge:(Qe==null?void 0:Qe.unitPriceSanJorge)||Ie.unitPriceSanJorge||0,unitPriceIsla:(Qe==null?void 0:Qe.unitPriceIsla)||Ie.unitPriceIsla||0,grossProfit:kt,logisticAllocated:Vt,vendorMarginPercent:pe.vendorMarginPercent,uVendor:pe.uVendor,uInvestor:pe.uInvestor,uAproximada:Ne,uNeta:Le,providerPrice:Ie.providerPrice,transferDelta:0}}try{ce(!0);const me=Yt(Ce,"inventory_candies_sellers",Ie.id),we=Ye||Ge?Yt(Ct(Ce,"inventory_candies_sellers")):Yt(Ce,"inventory_candies_sellers",We.id),pt=yr.now(),vt=new Date().toISOString().slice(0,10);let bt=null;await zs(Ce,async kt=>{const Vt=await kt.get(me);if(!Vt.exists())throw new Error("Orden origen no existe.");const ke=Vt.data(),Ne=Number(ke.remainingPackages||0);if(Ne<Te)throw new Error("Origen no tiene suficientes paquetes.");let pe=null;if(!Ye&&!Ge){const z=await kt.get(we);if(!z.exists())throw new Error("Orden destino no existe.");pe=z.data()}const Le=Number(ke.unitsPerPackage||Ie.unitsPerPackage||0),ft=Le>0?Te*Le:0,At=Number(ke.transferDelta||0);kt.update(me,{packages:Math.max(0,Number(ke.packages||0)-Te),remainingPackages:Ne-Te,...Le>0?{remainingUnits:Number(ke.remainingUnits||0)-ft}:{},updatedAt:pt,transferDelta:At-Te});let ct=null;if(Ye){const z={...xe,createdAt:pt,updatedAt:pt,remainingPackages:Te,remainingUnits:Number((xe==null?void 0:xe.unitsPerPackage)||0)>0?Te*Number((xe==null?void 0:xe.unitsPerPackage)||0):xe==null?void 0:xe.remainingUnits,transferDelta:0};kt.set(we,z),ct=z,bt={id:we.id,...z}}else if(Ge&&de){const z={...de,createdAt:pt,updatedAt:pt,remainingPackages:Te,remainingUnits:Number(de.unitsPerPackage||0)>0?Te*Number(de.unitsPerPackage||0):de.remainingUnits,transferDelta:0};kt.set(we,z),ct=z,bt={id:we.id,...z}}else{const z=pe,re=Number(z.unitsPerPackage||Ie.unitsPerPackage||0),V=re>0?Te*re:0,L=Number(z.transferDelta||0);kt.update(we,{packages:Math.max(0,Number(z.packages||0)+Te),remainingPackages:Number(z.remainingPackages||0)+Te,...re>0?{remainingUnits:Number(z.remainingUnits||0)+V}:{},updatedAt:pt,transferDelta:L+Te}),ct={...z,remainingPackages:Number(z.remainingPackages||0)+Te,remainingUnits:re>0?Number(z.remainingUnits||0)+V:z.remainingUnits,sellerId:z.sellerId,sellerName:z.sellerName,orderId:z.orderId||(We==null?void 0:We.id)||"",transferDelta:L+Te}}const W=Yt(Ct(Ce,"inventory_transfers_candies"));kt.set(W,{createdAt:pt,date:vt,createdByEmail:(o||"").trim(),createdByName:String(l||"").trim(),productId:String(ke.productId||""),productName:String(ke.productName||""),packagesMoved:Te,providerPrice:Number(ke.providerPrice||0),unitPriceRivas:Number(ke.unitPriceRivas||0),unitPriceIsla:Number(ke.unitPriceIsla||0),fromSellerId:String(ke.sellerId||""),fromSellerName:String(ke.sellerName||""),fromOrderKey:String(ke.orderId||Ie.id||""),fromOrderLabel:String(ke.orderId||Ie.id||""),toSellerId:Ye?(Z==null?void 0:Z.id)||"":String((ct==null?void 0:ct.sellerId)||""),toSellerName:Ye?(Z==null?void 0:Z.name)||"":String((ct==null?void 0:ct.sellerName)||""),toOrderKey:Ye?Me:String((ct==null?void 0:ct.orderId)||j||""),toOrderLabel:Ye?Me:String((ct==null?void 0:ct.orderId)||j||""),fromVendorRowId:Ie.id,toVendorRowId:Ye||Ge?we.id:We.id,comment:T.trim(),destRowWasNew:ie})}),a(kt=>{const Vt=kt.reduce((ke,Ne)=>{if(Ne.id===Ie.id){const pe=Number(Ne.unitsPerPackage||0),Le=pe>0?Te*pe:0;return ke.push({...Ne,packages:Math.max(0,Number(Ne.packages||0)-Te),remainingPackages:Number(Ne.remainingPackages||0)-Te,remainingUnits:pe>0?Number(Ne.remainingUnits||0)-Le:Ne.remainingUnits,transferDelta:Number(Ne.transferDelta||0)-Te}),ke}if(!Ye&&We&&Ne.id===We.id){const pe=Number(Ne.unitsPerPackage||0),Le=pe>0?Te*pe:0;return ke.push({...Ne,packages:Math.max(0,Number(Ne.packages||0)+Te),remainingPackages:Number(Ne.remainingPackages||0)+Te,remainingUnits:pe>0?Number(Ne.remainingUnits||0)+Le:Ne.remainingUnits,transferDelta:Number(Ne.transferDelta||0)+Te}),ke}return ke.push(Ne),ke},[]);return bt?[...Vt,bt]:Vt}),await Qt(),A(kt=>{const Vt={...kt},ke=y,Ne=Ye?Me:j;return ke&&(Vt[ke]=Vt[ke]||{out:0,in:0},Vt[ke].out+=Te),Ne&&(Vt[Ne]=Vt[Ne]||{out:0,in:0},Vt[Ne].in+=Te),Vt}),h(kt=>{const Vt={...kt};if(Ie.id&&(Vt[Ie.id]=(Vt[Ie.id]||0)-Te),!ie){const ke=Ge||Ye?bt==null?void 0:bt.id:We==null?void 0:We.id;ke&&(Vt[ke]=(Vt[ke]||0)+Te)}return Vt}),Tt(),le(" Traslado realizado.")}catch(me){le((me==null?void 0:me.message)||" Error realizando el traslado.")}finally{ce(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[G&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{e(),Tt()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:y,onChange:Te=>{b(Te.target.value),I(""),C(""),E(""),k("0")},disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xe.map(Te=>{const Ye=se[Te];return i.jsxs("option",{value:Te,children:["Vendedor: ",(Ye==null?void 0:Ye.sellerName)||"","  Existencias:"," ",(Ye==null?void 0:Ye.totalRemainingPackages)||"0"," Paquetes - Fecha Orden:"," ",(Ye==null?void 0:Ye.date)||""]},Te)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsx("input",{type:"text",className:"mt-1 mb-2 w-full border p-2 rounded text-sm",placeholder:"Buscar producto...",value:K,onChange:Te=>R(Te.target.value),disabled:!s||!y}),i.jsxs("select",{className:"w-full border p-2 rounded",value:w,onChange:Te=>{I(Te.target.value),C(""),E(""),k("0")},disabled:!s||!y,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ze.map(Te=>i.jsxs("option",{value:Te.id,children:[Te.productName,"  Existencias:"," ",Number(Te.remainingPackages??Te.packages??0)," Paquetes - Precio Costo: $",Te.providerPrice]},Te.id))]})]}),!Ae&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:j,onChange:Te=>{C(Te.target.value),E("")},disabled:!s||!w,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xe.filter(Te=>Te!==y).map(Te=>{const Ye=se[Te];return i.jsxs("option",{value:Te,children:["Vendedor: ",(Ye==null?void 0:Ye.sellerName)||"","  Existencias:"," ",(Ye==null?void 0:Ye.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Ye==null?void 0:Ye.date)||""]},Te)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:S,onChange:Te=>E(Te.target.value),disabled:!s||!j||!ut,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ft.map(Te=>i.jsxs("option",{value:Te.id,children:["Tipo: ",Te.category," - ",Te.productName,"  Existencias:"," ",Number(Te.remainingPackages??Te.packages??0),"Paquetes - Precio Costo: $",Te.providerPrice]},Te.id))]}),j&&ut&&Ft.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. Si dejas este campo vaco se crear automticamente al moverlo."}),j&&i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este campo es opcional; salo solo si el pedido ya tiene el producto y quieres sumar a esa fila."})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Ae,onChange:Te=>{const Ye=Te.target.checked;ae(Ye),Ye&&(C(""),E(""))},disabled:!s}),i.jsx("span",{className:"text-sm font-semibold",children:"Crear nueva orden destino (independiente)"})]}),Ae&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor destino (nueva orden)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_e,onChange:Te=>De(Te.target.value),disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),u.map(Te=>i.jsxs("option",{value:Te.id,disabled:Te.id===Et,children:[Te.name,Te.id===Et?" (origen)":""]},Te.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de la nueva orden"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:O,onChange:Te=>H(Te.target.value),disabled:!s}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esta orden ser independiente. Asegrate de usar una fecha que no tenga otro pedido activo para el mismo vendedor."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:B,onChange:Te=>k(Te.target.value),disabled:!s||!w||!Ae&&!j})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:T,onChange:Te=>P(Te.target.value),disabled:!s,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:Tt,disabled:!s||G,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:Re,disabled:!s||G||!w||!Ae&&!j||Number(B||0)<=0||!T.trim(),children:"Hacer traslado"})]}),ue&&i.jsx("div",{className:"text-sm text-red-600 mt-2",children:ue})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:X,onChange:Te=>Y(Te.target.value)}),i.jsx("span",{className:"text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:D,onChange:Te=>Q(Te.target.value)}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Qt,disabled:m,type:"button",children:m?"Cargando...":"Recargar"})]})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Desde vendedor"}),i.jsx("th",{className:"p-2 border",children:"Desde orden"}),i.jsx("th",{className:"p-2 border",children:"Hacia vendedor"}),i.jsx("th",{className:"p-2 border",children:"Hacia orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Ut.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin traslados"})}):Ut.map(Te=>{var Ie,We;const Ye=((We=(Ie=Te.createdAt)==null?void 0:Ie.toDate)==null?void 0:We.call(Ie))||(Te.createdAt?new Date(Te.createdAt.seconds*1e3):null),ht=Ye?`${Ye.toISOString().slice(0,10)} ${Ye.toISOString().slice(11,19)}`:Te.date||"",Oe=(Te.createdByName||"").trim()||(Te.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:ht}),i.jsx("td",{className:"p-2 border",children:Oe}),i.jsx("td",{className:"p-2 border text-left",children:Te.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(Te.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:oT(Te.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:oT(Te.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:oT(Te.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:Te.fromSellerName||""}),i.jsx("td",{className:"p-2 border",children:Te.fromOrderLabel||Te.fromOrderKey||""}),i.jsx("td",{className:"p-2 border",children:Te.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:Te.toOrderLabel||Te.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:Te.comment||""})]},Te.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}):null}const si=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function EG(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const Ni=t=>Math.max(0,Math.floor(Number(t||0))),sf=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},id=(t,e)=>{const r=sf(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}};function oVe({role:t="",sellerCandyId:e="",currentUserEmail:r,roles:n}){const{refreshKey:a,refresh:s}=Lc(),o=n&&n.length?n:t,l=!o||En(o,"admin"),c=En(o,"vendedor_dulces"),u=(r||"").trim().toLowerCase(),d=!l&&c,[f,A]=g.useState(!0),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState([]),[b,w]=g.useState({}),[I,j]=g.useState([]),C=g.useRef({});g.useEffect(()=>{const he={};I.forEach(tt=>{he[tt.id]=tt}),C.current=he},[I]);const[S,E]=g.useState(!1),[B,k]=g.useState(null),[T,P]=g.useState(""),[G,ce]=g.useState(""),[ue,le]=g.useState(""),[Ae,ae]=g.useState(""),[_e,De]=g.useState("0"),[O,H]=g.useState([]),[K,R]=g.useState(""),[X,Y]=g.useState(""),[D,Q]=g.useState(!1),[te,be]=g.useState(!1),[U,Xe]=g.useState(!1),se=20,[ee,Fe]=g.useState(1),je=20,[Se,Ze]=g.useState(1),[ut,Et]=g.useState({}),[St,Ft]=g.useState(!1),[Qt,Ut]=g.useState({}),[Tt,Re]=g.useState({}),[Te,Ye]=g.useState(!1),[ht,Oe]=g.useState({}),[Ie,We]=g.useState({}),Z=g.useMemo(()=>p.find(he=>he.id===T)||null,[T,p]);Z==null||Z.branch,g.useEffect(()=>{!S||!T||!O.length||H(he=>he.map(tt=>{const nt=v.find(dr=>dr.id===tt.productId)||null,lt=p.find(dr=>dr.id===T)||null,ge=lt==null?void 0:lt.branch,it=Ni(tt.packages),Pt=nt?we(nt,ge):Number(tt.pricePerPackage||0),Nt=(nt?pt(nt,ge):0)*it,It=nt?nt.logisticAllocatedPerPack*it:Number(tt.logisticAllocated||0),Mt=(nt?vt(nt,ge):0)*it,zt=bt(T),ar=tt.vendorMarginPercent!=null&&String(tt.vendorMarginPercent).trim()!==""?sf(tt.vendorMarginPercent):zt,wr=id(Nt,ar);return{...tt,pricePerPackage:Pt,totalExpected:Pt*it,grossProfit:Nt,logisticAllocated:It,vendorMarginPercent:wr.vendorMarginPercent,uAproximada:Mt,uVendor:wr.uVendor,uInvestor:wr.uInvestor,totalRivas:((nt==null?void 0:nt.unitPriceRivas)||tt.unitPriceRivas||0)*it,totalSanJorge:((nt==null?void 0:nt.unitPriceSanJorge)||tt.unitPriceSanJorge||0)*it,totalIsla:((nt==null?void 0:nt.unitPriceIsla)||tt.unitPriceIsla||0)*it,unitPriceRivas:(nt==null?void 0:nt.unitPriceRivas)||tt.unitPriceRivas||0,unitPriceSanJorge:(nt==null?void 0:nt.unitPriceSanJorge)||tt.unitPriceSanJorge||0,unitPriceIsla:(nt==null?void 0:nt.unitPriceIsla)||tt.unitPriceIsla||0}}))},[S,T,O.length,v,p]);const Qe=g.useMemo(()=>!c||!u?null:p.find(he=>(he.email||"").trim().toLowerCase()===u)||null,[c,u,p]);g.useMemo(()=>new Set(O.map(he=>he.productId)),[O]);const at=g.useMemo(()=>v.filter(he=>(b[he.id]??0)>1).sort((he,tt)=>`${he.category} ${he.name}`.localeCompare(`${tt.category} ${tt.name}`)),[v,b]),Ge=g.useMemo(()=>{const he=K.trim().toLowerCase();return he?at.filter(tt=>`${tt.category??""} ${tt.name??""}`.toLowerCase().includes(he)):at},[at,K]),ie=g.useMemo(()=>v.find(he=>he.id===Ae)||null,[Ae,v]),xe=g.useMemo(()=>c&&Qe?I.filter(he=>he.sellerId===Qe.id):I,[I,c,Qe]),de=async()=>{try{const he=Ct(Ce,"inventory_transfers_candies"),tt=(Nt,It,qt,Mt)=>{It&&(Nt[It]=Nt[It]||{out:0,in:0},Nt[It][qt]+=Mt)},nt=(Nt,It,qt)=>{const Mt=String(It||"");Mt&&(Nt[Mt]=(Nt[Mt]||0)+qt)},lt={},ge={},it=C.current,Pt=Nt=>{var dr,Rt;if(Nt.destRowWasNew!=null)return!!Nt.destRowWasNew;const It=String(Nt.toVendorRowId||"");if(!It)return!1;const qt=it[It];if(!qt)return!1;const Mt=Number(((dr=qt.createdAt)==null?void 0:dr.seconds)??0),zt=Number(((Rt=Nt.createdAt)==null?void 0:Rt.seconds)??0),ar=Mt>0&&zt>0&&Math.abs(Mt-zt)<=1,wr=Math.max(0,Number(qt.packages||0))===Math.max(0,Number(Nt.packagesMoved||0));return ar&&wr},wt=Nt=>{const It=Nt.data(),qt=Number(It.packagesMoved||0);qt>0&&(tt(lt,String(It.fromOrderKey||""),"out",qt),tt(lt,String(It.toOrderKey||""),"in",qt),nt(ge,It.fromVendorRowId,-qt),Pt(It)||nt(ge,It.toVendorRowId,qt))};if(!c)(await Ht(he)).forEach(wt);else{const Nt=sr(he,cr("fromSellerId","==",e)),It=sr(he,cr("toSellerId","==",e)),[qt,Mt]=await Promise.all([Ht(Nt),Ht(It)]),zt=new Set,ar=wr=>{wr.forEach(dr=>{zt.has(dr.id)||(zt.add(dr.id),wt(dr))})};ar(qt.docs),ar(Mt.docs)}Ut(lt),Re(ge)}catch(he){console.error(he),Ut({}),Re({})}};g.useEffect(()=>{(async()=>{A(!0),m("");try{const he=await Ht(sr(Ct(Ce,"sellers_candies"),Sn("name","asc"))),tt=[];he.forEach(dr=>{const Rt=dr.data(),Wr=Rt.branch||Rt.branchLabel||Rt.route||Rt.sucursal||Rt.location||"";tt.push({id:dr.id,name:Rt.name||"",email:Rt.email||"",commissionPercent:Number(Rt.commissionPercent||0),branch:EG(Wr),branchLabel:Wr})}),x(tt);const nt=await Ht(sr(Ct(Ce,"candy_main_orders"),Sn("createdAt","desc"))),lt={},ge={},it=(dr,Rt)=>`${dr}#${String(Rt).padStart(10,"0")}`;nt.forEach(dr=>{var pr;const Rt=dr.data(),Wr=Number(((pr=Rt.createdAt)==null?void 0:pr.seconds)??0),Vr=String(Rt.date||""),jr=Array.isArray(Rt.items)?Rt.items:[];for(const Pr of jr){const Tn=String(Pr.id||Pr.productId||"");if(!Tn)continue;const wn=Ni(Pr.remainingPackages??Pr.remainingPacks??0);wn>0&&(lt[Tn]=(lt[Tn]||0)+wn);const gn=Math.max(1,Ni(Pr.packages??0)),ua=Number(Pr.providerPrice??Pr.provider_price??Pr.priceProvider??Pr.costProvider??0),xa=Number(Pr.unitPriceRivas||0),Ji=Number(Pr.unitPriceSanJorge||0),Zi=Number(Pr.unitPriceIsla||0),Dl=Number(Pr.gainRivas??Pr.grossProfitRivas??Pr.grossProfit??0),va=Number(Pr.gainSanJorge??Pr.grossProfitSanJorge??Pr.grossProfit??0),Qn=Number(Pr.gainIsla??Pr.grossProfitIsla??Pr.grossProfit??0),hu=Number(Pr.logisticAllocated??Pr.prorrateo??Pr.prorrateoLogistico??Pr.gastos??0),eo=Number(Pr.uAproximada??Pr.uApprox??Pr.netProfit??Pr.vendorProfit??Pr.gainVendor??0)/gn,Uc=hu/gn,Qc={id:Tn,name:String(Pr.name||Pr.productName||""),category:String(Pr.category||""),unitsPerPackage:Ni(Pr.unitsPerPackage??0),providerPrice:ua,unitPriceRivas:xa,unitPriceSanJorge:Ji,unitPriceIsla:Zi,grossProfitPerPackRivas:Dl/gn,grossProfitPerPackSanJorge:va/gn,grossProfitPerPackIsla:Qn/gn,uApproxPerPackRivas:eo,uApproxPerPackSanJorge:eo,uApproxPerPackIsla:eo,logisticAllocatedPerPack:Uc,masterOrderId:dr.id,key:it(Vr,Wr)},Ac=ge[Tn];(!Ac||Qc.key>Ac.key)&&(ge[Tn]=Qc)}});const Pt=await Ht(sr(Ct(Ce,"inventory_candies"),Sn("createdAt","desc"))),wt=dr=>{const Rt=Math.max(1,Ni(dr.unitsPerPackage||1)),Wr=Number(dr.remaining??0);if(Number.isFinite(Wr)&&Wr>0)return Math.floor(Wr/Rt);const Vr=Number(dr.remainingPackages??0);return Number.isFinite(Vr)&&Vr>0?Math.floor(Vr):0},Nt={};Pt.forEach(dr=>{const Rt=dr.data(),Wr=String(Rt.productId||"");if(!Wr)return;const Vr=wt(Rt);Vr<=0||(Nt[Wr]=(Nt[Wr]||0)+Vr)});const It={};(Object.keys(Nt).length?Object.keys(Nt):Object.keys(lt)).forEach(dr=>{const Rt=Object.keys(Nt).length?Nt[dr]:lt[dr];It[dr]=Math.max(0,Ni(Rt))}),w(It);const Mt=await Ht(c?sr(Ct(Ce,"inventory_candies_sellers"),cr("sellerId","==",e),Sn("createdAt","desc")):sr(Ct(Ce,"inventory_candies_sellers"),Sn("createdAt","desc"))),zt=Object.keys(ge).map(dr=>{const Rt=ge[dr];return{id:Rt.id,name:Rt.name,category:Rt.category,unitsPerPackage:Rt.unitsPerPackage,providerPrice:Rt.providerPrice,unitPriceRivas:Rt.unitPriceRivas,unitPriceSanJorge:Rt.unitPriceSanJorge,unitPriceIsla:Rt.unitPriceIsla,grossProfitPerPackRivas:Rt.grossProfitPerPackRivas,grossProfitPerPackSanJorge:Rt.grossProfitPerPackSanJorge,grossProfitPerPackIsla:Rt.grossProfitPerPackIsla,uApproxPerPackRivas:Rt.uApproxPerPackRivas,uApproxPerPackSanJorge:Rt.uApproxPerPackSanJorge,uApproxPerPackIsla:Rt.uApproxPerPackIsla,logisticAllocatedPerPack:Rt.logisticAllocatedPerPack,existingPacks:It[Rt.id]??0,masterOrderId:Rt.masterOrderId}}).sort((dr,Rt)=>`${dr.category} ${dr.name}`.localeCompare(`${Rt.category} ${Rt.name}`));y(zt);const ar=[];Mt.forEach(dr=>{const Rt=dr.data(),Wr=Object.prototype.hasOwnProperty.call(Rt,"transferDelta"),Vr=tt.find(ua=>ua.id===Rt.sellerId)||null,jr=sf(Rt.vendorMarginPercent??Rt.vendorMargin??Rt.commissionPercent??(Vr==null?void 0:Vr.commissionPercent)??0),pr=Number(Rt.uAproximada??Rt.uApprox??Rt.netProfit??Rt.uAprox??Rt.uApproxTotal??0),Pr=Rt.uVendor??Rt.vendorProfit??Rt.gainVendor??0,Tn=Rt.uVendor!=null,wn=id(Number(Rt.grossProfit??Rt.gainVendor??0),jr),gn=Tn?{uAproximada:Number(pr||0),vendorMarginPercent:jr,uVendor:Number(Pr||0),uInvestor:Number(pr||0)-Number(Pr||0)}:{uAproximada:Number(pr||0),vendorMarginPercent:wn.vendorMarginPercent,uVendor:wn.uVendor,uInvestor:wn.uInvestor};ar.push({id:dr.id,sellerId:Rt.sellerId,sellerName:Rt.sellerName||"",orderName:Rt.orderName||"",productId:Rt.productId,productName:Rt.productName||"",category:Rt.category||"",orderId:Rt.orderId||null,packages:Number(Rt.packages||0),unitsPerPackage:Number(Rt.unitsPerPackage||0),totalUnits:Number(Rt.totalUnits||0),remainingPackages:Number(Rt.remainingPackages||0),remainingUnits:Number(Rt.remainingUnits||0),totalRivas:Number(Rt.totalRivas||0),totalSanJorge:Number(Rt.totalSanJorge||0),totalIsla:Number(Rt.totalIsla||0),unitPriceRivas:Number(Rt.unitPriceRivas||0),unitPriceSanJorge:Number(Rt.unitPriceSanJorge||0),unitPriceIsla:Number(Rt.unitPriceIsla||0),grossProfit:Number(Rt.grossProfit??Rt.gainVendor??0),logisticAllocated:Number(Rt.logisticAllocated??Rt.gastos??Rt.gasto??0),vendorMarginPercent:gn.vendorMarginPercent,uAproximada:gn.uAproximada,uVendor:gn.uVendor,uInvestor:gn.uInvestor,vendorProfit:Number(Rt.vendorProfit??gn.uVendor??0),transferDelta:Wr&&typeof Rt.transferDelta=="number"?Number(Rt.transferDelta||0):void 0,subtotal:Number(Rt.subtotal||0),providerPrice:Number(Rt.providerPrice||0),date:Rt.date||"",createdAt:Rt.createdAt||yr.now()})});const wr={};ar.forEach(dr=>{wr[dr.id]=dr}),C.current=wr,j(ar),await de()}catch(he){console.error(he),m(" Error cargando datos de vendedores / pedidos.")}finally{A(!1)}})()},[a,t,e]);const Me=(he,tt)=>`${he}__${tt}`,me=he=>he.orderId||Me(he.sellerId,he.date),we=(he,tt)=>tt?tt==="RIVAS"?he.unitPriceRivas||0:tt==="SAN_JORGE"?he.unitPriceSanJorge||0:he.unitPriceIsla||0:he.unitPriceIsla||he.unitPriceRivas||he.unitPriceSanJorge||0,pt=(he,tt)=>tt?tt==="RIVAS"?he.grossProfitPerPackRivas||0:tt==="SAN_JORGE"?he.grossProfitPerPackSanJorge||0:he.grossProfitPerPackIsla||0:he.grossProfitPerPackIsla||he.grossProfitPerPackRivas||he.grossProfitPerPackSanJorge||0,vt=(he,tt)=>tt?tt==="RIVAS"?he.uApproxPerPackRivas||0:tt==="SAN_JORGE"?he.uApproxPerPackSanJorge||0:he.uApproxPerPackIsla||0:he.uApproxPerPackIsla||he.uApproxPerPackRivas||he.uApproxPerPackSanJorge||0,bt=he=>{const tt=p.find(nt=>nt.id===he)||null;return sf((tt==null?void 0:tt.commissionPercent)??0)},kt=he=>{const tt=Tt[he.id];return typeof tt=="number"&&Number.isFinite(tt)?tt:typeof he.transferDelta=="number"?Number(he.transferDelta||0):0},Vt=he=>{const tt=Math.max(0,Number(he.packages||0)),nt=kt(he);return Math.max(0,tt+nt)},ke=he=>{const tt=Math.max(1,Ni(he.unitsPerPackage||1)),nt=Number(he.remaining??0);if(Number.isFinite(nt)&&nt>0)return Math.floor(nt/tt);const lt=Number(he.remainingPackages??0);return Number.isFinite(lt)&&lt>0?Math.floor(lt):0},Ne=async(he,tt)=>{const nt=String(he||"").trim();if(!nt)return{byId:0,byName:0};const lt=await Ht(sr(Ct(Ce,"inventory_candies"),cr("productId","==",nt)));let ge=0;lt.forEach(Nt=>{ge+=ke(Nt.data())});const it=Math.max(0,ge);let Pt=0;const wt=String(tt||"").trim();return it===0&&wt&&((await Ht(sr(Ct(Ce,"inventory_candies"),cr("productName","==",wt)))).forEach(It=>{Pt+=ke(It.data())}),Pt=Math.max(0,Pt)),{byId:it,byName:Pt}},pe=g.useMemo(()=>{const he=new Map;for(const nt of xe){const lt=me(nt),ge=he.get(lt)||{orderKey:lt,sellerId:nt.sellerId,sellerName:nt.sellerName,orderName:nt.orderName||"",date:nt.date,totalPackages:0,totalActivePackages:0,totalRemainingPackages:0,totalExpected:0,totalExpectedActive:0,grossProfit:0,grossProfitActive:0,vendorProfit:0,vendorProfitActive:0,gastos:0,gastosActive:0,transferredOut:0,transferredIn:0},it=Math.max(0,Number(nt.packages||0)),Pt=Math.max(0,Number(nt.remainingPackages||0)),wt=Vt(nt),Nt=it>0?wt/it:1;ge.totalPackages+=it,ge.totalRemainingPackages+=Pt,ge.totalActivePackages+=wt;const It=p.find(wn=>wn.id===nt.sellerId)||null,qt=It==null?void 0:It.branch,Mt=v.find(wn=>wn.id===String(nt.productId))||null,zt=Mt?we(Mt,qt):Number(qt==="RIVAS"?nt.unitPriceRivas||0:qt==="SAN_JORGE"?nt.unitPriceSanJorge||0:nt.unitPriceIsla||0),ar=zt*it,wr=zt*wt;ge.totalExpected+=Number(ar||0),ge.totalExpectedActive+=Number(wr||0);const dr=Mt?pt(Mt,qt):it>0?Number(nt.grossProfit||0)/it:0,Rt=dr*it,Wr=dr*wt;ge.grossProfit+=Number(Rt||0),ge.grossProfitActive+=Number(Wr||0);const Vr=typeof(Mt==null?void 0:Mt.logisticAllocatedPerPack)=="number"?Number(Mt.logisticAllocatedPerPack||0):(()=>{const wn=Number(nt.logisticAllocated??nt.gastos??nt.gasto??0),gn=it>0?it:wt||1;return gn>0?wn/gn:0})(),jr=Vr*it,pr=Vr*wt;ge.gastos=(ge.gastos||0)+Number(jr||0),ge.gastosActive=(ge.gastosActive||0)+Number(pr||0);const Pr=bt(nt.sellerId),Tn=id(Rt,Pr);ge.vendorProfit+=Number(Tn.uVendor||0),ge.vendorProfitActive+=Number(Tn.uVendor||0)*Nt,he.set(lt,ge)}const tt=[];for(const nt of he.values()){const lt=Qt[nt.orderKey]||{out:0,in:0};nt.transferredOut=lt.out||0,nt.transferredIn=lt.in||0,Number.isFinite(nt.totalExpectedActive)||(nt.totalExpectedActive=nt.totalExpected),Number.isFinite(nt.grossProfitActive)||(nt.grossProfitActive=nt.grossProfit),Number.isFinite(nt.vendorProfitActive)||(nt.vendorProfitActive=nt.vendorProfit),Number.isFinite(nt.gastosActive||0)||(nt.gastosActive=nt.gastos),tt.push(nt)}return tt.sort((nt,lt)=>(lt.date||"").localeCompare(nt.date||"")),tt},[xe,p,Qt,v,Tt]),Le=g.useMemo(()=>Math.max(1,Math.ceil(pe.length/se)),[pe.length]);g.useEffect(()=>{ee>Le&&Fe(Le)},[Le]);const ft=g.useMemo(()=>{const he=(ee-1)*se;return pe.slice(he,he+se)},[pe,ee]),At=()=>Fe(he=>Math.max(1,he-1)),ct=()=>Fe(he=>Math.min(Le,he+1)),W=g.useMemo(()=>{const he=X.trim().toLowerCase();return he?O.filter(tt=>{const nt=String(tt.productName||"").toLowerCase(),lt=String(tt.category||"").toLowerCase();return nt.includes(he)||lt.includes(he)}):O},[O,X]),z=g.useMemo(()=>Math.max(1,Math.ceil(W.length/je)),[W.length]);g.useEffect(()=>{Se>z&&Ze(z)},[z]);const re=g.useMemo(()=>{const he=(Se-1)*je;return W.slice(he,he+je)},[W,Se]),V=g.useMemo(()=>{const he=new Map;for(const tt of re){const nt=(tt.category||"Sin categora").trim()||"Sin categora",lt=he.get(nt)||[];lt.push(tt),he.set(nt,lt)}return Array.from(he.entries())},[re]),L=he=>{Et(tt=>({...tt,[he]:!tt[he]}))},fe=()=>Ze(he=>Math.max(1,he-1)),Be=()=>Ze(he=>Math.min(z,he+1)),ye=he=>{Oe(tt=>({...tt,[he]:!0}))},$e=he=>{Oe(tt=>({...tt,[he]:!1}))},ze=he=>{We(tt=>({...tt,[he]:!0}))},Ke=he=>{We(tt=>({...tt,[he]:!1}))},yt=he=>{const tt=Math.max(0,Number(he.packages||0)),nt=Number(he.transferDelta||0);return Math.max(0,tt+nt)},ne=he=>{const tt=Math.max(0,Number(he.packages||0)),nt=yt(he);return tt===0?nt>0?1:0:nt/tt},Ue=(he,tt)=>Number(tt||0)*ne(he),rt=he=>Number(he.logisticAllocated??he.logisticAllocated??he.gastos??he.gasto??0),st=he=>{const tt=Ue(he,Number(he.totalExpected||0)),nt=Ue(he,Number(he.grossProfit||0)),lt=Ue(he,rt(he)),ge=Ue(he,Number(he.uVendor||0)),it=nt-lt-ge;return{totalExpected:tt,grossProfit:nt,gastos:lt,uVendor:ge,uNeta:it}},_t=g.useMemo(()=>O.reduce((he,tt)=>{const nt=Math.max(0,Number(tt.packages||0)),lt=yt(tt),ge=st(tt);return he.totalPackages+=nt,he.totalActivePackages+=lt,he.totalExpected+=ge.totalExpected,he.grossProfit+=ge.grossProfit,he.gastosTotal+=ge.gastos,he.uVendor+=ge.uVendor,he},{totalPackages:0,totalActivePackages:0,totalExpected:0,grossProfit:0,gastosTotal:0,uVendor:0}),[O]),Ot=g.useMemo(()=>_t.grossProfit-_t.gastosTotal-_t.uVendor,[_t.grossProfit,_t.gastosTotal,_t.uVendor]),nr=()=>{k(null),P(""),ce(""),le(""),ae(""),De("0"),H([]),R(""),Ze(1),Oe({}),We({})},Ir=()=>{m(""),nr(),c&&Qe&&P(Qe.id);const he=new Date,tt=he.getFullYear(),nt=String(he.getMonth()+1).padStart(2,"0"),lt=String(he.getDate()).padStart(2,"0");ce(`${tt}-${nt}-${lt}`),le(""),E(!0)},Qr=()=>{E(!1)},or=he=>{m(""),nr(),k(he);const[tt,nt]=he.split("__");P(tt||""),ce(nt||"");const lt=xe.filter(Nt=>me(Nt)===he),ge=lt[0]||null;le((ge==null?void 0:ge.orderName)||"");const it=p.find(Nt=>Nt.id===tt)||null,Pt=it==null?void 0:it.branch,wt=lt.map(Nt=>{const It=v.find(Tn=>Tn.id===String(Nt.productId))||null,qt=Number(Nt.unitPriceRivas||(It==null?void 0:It.unitPriceRivas)||0),Mt=Number(Nt.unitPriceSanJorge||(It==null?void 0:It.unitPriceSanJorge)||0),zt=Number(Nt.unitPriceIsla||(It==null?void 0:It.unitPriceIsla)||0),ar=Number(Nt.packages||0),wr=Pt==="RIVAS"?qt:Pt==="SAN_JORGE"?Mt:zt,dr=Number(Nt.totalRivas||0),Rt=Number(Nt.totalSanJorge||0),Wr=Number(Nt.totalIsla||0),Vr=Pt==="RIVAS"?dr:Pt==="SAN_JORGE"?Rt:Wr,jr=sf(Nt.vendorMarginPercent??bt(tt)),pr=id(Number(Nt.grossProfit||0),jr),Pr=Number(Nt.logisticAllocated??Nt.gastos??0)||(It?It.logisticAllocatedPerPack*ar:0);return{id:Nt.id,productId:String(Nt.productId||""),productName:Nt.productName||(It==null?void 0:It.name)||"",category:Nt.category||(It==null?void 0:It.category)||"",unitsPerPackage:Number(Nt.unitsPerPackage||(It==null?void 0:It.unitsPerPackage)||0),packages:ar,totalExpected:Vr,pricePerPackage:wr,grossProfit:Number(Nt.grossProfit||0),logisticAllocated:Pr,vendorMarginPercent:pr.vendorMarginPercent,uAproximada:Number(Nt.uAproximada||0),uVendor:Number(Nt.uVendor??pr.uVendor??0),uInvestor:Number(Nt.uInvestor??pr.uInvestor??0),totalRivas:dr,totalSanJorge:Rt,totalIsla:Wr,unitPriceRivas:qt,unitPriceSanJorge:Mt,unitPriceIsla:zt,providerPrice:Number(Nt.providerPrice||0),remainingPackages:Number(Nt.remainingPackages||0),transferDelta:kt(Nt)}});H(wt),E(!0)},kr=()=>{if(m(""),!T)return m(" Seleccion un vendedor.");if(!G)return m(" Seleccion una fecha.");if(!Ae)return m(" Seleccion un producto.");const he=Ni(_e);if(he<=0)return m(" Paquetes debe ser > 0.");const tt=v.find(wr=>wr.id===Ae);if(!tt)return m(" Producto no encontrado.");if(O.some(wr=>wr.productId===tt.id))return m(" Ese producto ya est agregado al pedido.");const nt=p.find(wr=>wr.id===T)||null,lt=nt==null?void 0:nt.branch,ge=we(tt,lt),it=pt(tt,lt),wt=vt(tt,lt)*he,Nt=ge*he,It=it*he,qt=tt.logisticAllocatedPerPack*he,Mt=bt(T),zt=id(It,Mt),ar={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:tt.id,productName:tt.name,category:tt.category,unitsPerPackage:tt.unitsPerPackage,packages:he,totalExpected:Nt,pricePerPackage:ge,grossProfit:It,logisticAllocated:qt,providerPrice:tt.providerPrice,vendorMarginPercent:zt.vendorMarginPercent,uAproximada:wt,uVendor:zt.uVendor,uInvestor:zt.uInvestor,totalRivas:(tt.unitPriceRivas||0)*he,totalSanJorge:(tt.unitPriceSanJorge||0)*he,totalIsla:(tt.unitPriceIsla||0)*he,unitPriceRivas:tt.unitPriceRivas||0,unitPriceSanJorge:tt.unitPriceSanJorge||0,unitPriceIsla:tt.unitPriceIsla||0,remainingPackages:he,transferDelta:0};H(wr=>[ar,...wr]),ae(""),De("0"),Ze(1)},Zr=he=>{H(tt=>tt.filter(nt=>nt.id!==he))},nn=(he,tt)=>{const nt=Math.max(0,Ni(tt));H(lt=>lt.map(ge=>{if(ge.id!==he)return ge;const it=v.find(Wr=>Wr.id===ge.productId),Pt=p.find(Wr=>Wr.id===T)||null,wt=Pt==null?void 0:Pt.branch,Nt=it?we(it,wt):ge.pricePerPackage||0,qt=(it?pt(it,wt):0)*nt,Mt=it?it.logisticAllocatedPerPack*nt:ge.logisticAllocated||0,ar=(it?vt(it,wt):0)*nt,wr=ge.vendorMarginPercent!=null?ge.vendorMarginPercent:bt(T),dr=id(qt,wr),Rt=String(ge.id||"").startsWith("tmp_")||Number(ge.remainingPackages||0)===Number(ge.packages||0);return{...ge,packages:nt,pricePerPackage:Nt,totalExpected:Nt*nt,grossProfit:qt,logisticAllocated:Mt,providerPrice:(it==null?void 0:it.providerPrice)??ge.providerPrice??Number(ge.providerPrice||0),vendorMarginPercent:dr.vendorMarginPercent,uAproximada:ar,uVendor:dr.uVendor,uInvestor:dr.uInvestor,totalRivas:((it==null?void 0:it.unitPriceRivas)||ge.unitPriceRivas||0)*nt,totalSanJorge:((it==null?void 0:it.unitPriceSanJorge)||ge.unitPriceSanJorge||0)*nt,totalIsla:((it==null?void 0:it.unitPriceIsla)||ge.unitPriceIsla||0)*nt,remainingPackages:Rt?nt:ge.remainingPackages}}))},_r=(he,tt)=>{const nt=sf(tt);H(lt=>lt.map(ge=>{if(ge.id!==he)return ge;const it=v.find(ar=>ar.id===ge.productId),Pt=p.find(ar=>ar.id===T)||null,wt=Pt==null?void 0:Pt.branch,Nt=Ni(ge.packages),qt=(it?vt(it,wt):0)*Nt,Mt=Number(ge.grossProfit||0),zt=id(Mt,nt);return{...ge,vendorMarginPercent:zt.vendorMarginPercent,uAproximada:qt,uVendor:zt.uVendor,uInvestor:zt.uInvestor}}))},He=async()=>{if(l&&!te)try{be(!0),m("");const he=I;if(!he.length){m(" No hay documentos para actualizar.");return}const tt=wt=>v.find(Nt=>Nt.id===wt)||null,nt=wt=>{const Nt=p.find(It=>It.id===wt)||null;return Nt==null?void 0:Nt.branch},lt=(wt,Nt)=>Math.abs(Number(wt||0)-Number(Nt||0))>.01;let ge=Ic(Ce),it=0,Pt=0;for(const wt of he){const Nt=nt(wt.sellerId)||"ISLA",It=Math.max(1,Number(wt.unitsPerPackage||0)||1),qt=Number(wt.totalUnits||0),Mt=Number(wt.remainingUnits||0),ar=Math.max(0,qt-Mt)/It,wr=Number(wt.remainingPackages||0),dr=Math.max(0,wr+ar),Rt=tt(String(wt.productId||"")),Wr=Rt&&dr>0?pt(Rt,Nt)*dr:Number(wt.grossProfit||0),Vr=Rt&&dr>0?Rt.logisticAllocatedPerPack*dr:Number(wt.logisticAllocated||0),jr=Rt?vt(Rt,Nt):0,pr=dr>0?jr*dr:0,Pr=wt.vendorMarginPercent!=null?sf(wt.vendorMarginPercent):bt(wt.sellerId),Tn=id(Wr,Pr),wn=Tn.uVendor,gn=Tn.uInvestor,ua=Wr-Vr-wn;if(!(lt(wt.packages,dr)||wt.uVendor==null||wt.uNeta==null||wt.uAproximada==null||wt.uInvestor==null||wt.logisticAllocated==null||lt(wt.uVendor,wn)||lt(wt.uNeta,ua)||lt(wt.uAproximada,pr)||lt(wt.uInvestor,gn)||lt(wt.logisticAllocated,Vr)))continue;const Ji=Yt(Ce,"inventory_candies_sellers",wt.id);ge.update(Ji,{packages:dr,vendorMarginPercent:Pr,grossProfit:Wr,logisticAllocated:Vr,uAproximada:pr,uVendor:wn,uInvestor:gn,uNeta:ua,vendorProfit:wn,updatedAt:yr.now()}),it+=1,Pt+=1,it>=400&&(await ge.commit(),ge=Ic(Ce),it=0)}it>0&&await ge.commit(),m(` Actualizados ${Pt} documentos.`),s()}catch(he){console.error(he),m(" Error actualizando documentos.")}finally{be(!1)}},Bt=(he,tt,nt="Hoja1")=>{const lt=ha.book_new(),ge=ha.aoa_to_sheet(tt);ha.book_append_sheet(lt,ge,nt),K2(lt,he)},xr=()=>{if(!l){m(" Solo admin puede exportar Excel.");return}const he=["Vendedor","Sucursal","Fecha","Producto ID","Producto","Categora","Paquetes","Paquetes restantes","Precio paquete","Precio proveedor","Total esperado","U. Bruta","U. Vendedor","U. Neta","P. Rivas","P. San Jorge","P. Isla","Total Rivas","Total San Jorge","Total Isla","Unidades x paquete","vendorMarginPercent","uVendor"],tt=p.find(it=>it.id===T)||null,nt=(tt==null?void 0:tt.branch)||EG(tt==null?void 0:tt.branchLabel)||"",lt=[he,...O.map(it=>{const{totalExpected:Pt,grossProfit:wt,uVendor:Nt,uNeta:It}=st(it);return[(tt==null?void 0:tt.name)||"",String(nt),G||"",it.productId,it.productName,it.category,Number(it.packages||0),Number(it.remainingPackages||0),Number(it.pricePerPackage||0),Number(it.providerPrice||0),Number(Pt||0),Number(wt||0),Number(Nt||0),Number(It||0),Number(it.unitPriceRivas||0),Number(it.unitPriceSanJorge||0),Number(it.unitPriceIsla||0),Number(it.totalRivas||0),Number(it.totalSanJorge||0),Number(it.totalIsla||0),Number(it.unitsPerPackage||0),Number(it.vendorMarginPercent||0),Number(it.uVendor||0)]})],ge=`vendor_order_items_${((tt==null?void 0:tt.name)||"vendedor").replace(/\s+/g,"_")}_${G||"sin_fecha"}.xlsx`;Bt(ge,lt,"Productos")},dn=()=>{const he=["productId","productName","category","Existentes","Paquetes","vendorMarginPercent","uNeta"],tt=v.map(lt=>({id:lt.id,name:lt.name,category:lt.category,existentes:Number(lt.existingPacks||0)})).filter(lt=>lt.existentes>0).sort((lt,ge)=>`${lt.category} ${lt.name}`.localeCompare(`${ge.category} ${ge.name}`)),nt=[he,...tt.map(lt=>[lt.id,lt.name,lt.category,lt.existentes,"","",""])];Bt("plantilla_orden_vendedor.xlsx",nt,"Plantilla")},Jr=async he=>{try{m("");const tt=await he.arrayBuffer(),nt=Gv(tt,{type:"array"}),lt=nt.SheetNames||[],ge=nt.Sheets.Plantilla||nt.Sheets.Productos||nt.Sheets[lt[0]];if(!ge)return m(" Archivo sin hojas.");const it=ha.sheet_to_json(ge,{header:1,defval:""});if(!it.length)return m(" Archivo vaco.");const Pt=(it[0]||[]).map(wr=>String(wr||"").trim().toLowerCase()),wt=Pt.findIndex(wr=>wr==="productid"||wr==="producto id"||wr==="id"),Nt=Pt.findIndex(wr=>wr==="paquetes"||wr==="packages"),It=Pt.findIndex(wr=>wr==="vendormarginpercent"||wr==="vendor_margin_percent"||wr==="marginvendorpercent"||wr==="margen"||wr==="margen vendedor"||wr==="margen_del_vendedor");if(wt<0||Nt<0)return m(" Plantilla invlida: debe tener columnas productId y Paquetes.");if(!T)return m(" Seleccion un vendedor antes de importar.");if(!G)return m(" Seleccion una fecha antes de importar.");const qt=p.find(wr=>wr.id===T)||null,Mt=qt==null?void 0:qt.branch,zt=bt(T),ar=[];for(let wr=1;wr<it.length;wr++){const dr=it[wr]||[],Rt=String(dr[wt]||"").trim();if(!Rt)continue;const Wr=Ni(dr[Nt]);if(Wr<=0)continue;const Vr=v.find(Qn=>Qn.id===Rt);if(!Vr)continue;const jr=It>=0?sf(dr[It]):0,pr=It>=0&&String(dr[It]??"").trim()!==""?jr:zt,Pr=we(Vr,Mt),Tn=pt(Vr,Mt),wn=Pr*Wr,gn=Tn*Wr,ua=Vr.logisticAllocatedPerPack*Wr,Ji=vt(Vr,Mt)*Wr,Zi=id(gn,pr),Dl=O.find(Qn=>Qn.productId===Rt);if(Dl){const Qn=It>=0&&String(dr[It]??"").trim()!==""?pr:Dl.vendorMarginPercent,hu=id(gn,Qn);H(Rl=>Rl.map(eo=>eo.id===Dl.id?{...eo,packages:Wr,pricePerPackage:Pr,totalExpected:wn,grossProfit:gn,logisticAllocated:ua,vendorMarginPercent:hu.vendorMarginPercent,uAproximada:Ji,uVendor:hu.uVendor,uInvestor:hu.uInvestor,totalRivas:(Vr.unitPriceRivas||0)*Wr,totalSanJorge:(Vr.unitPriceSanJorge||0)*Wr,totalIsla:(Vr.unitPriceIsla||0)*Wr}:eo));continue}const va={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:Vr.id,productName:Vr.name,category:Vr.category,unitsPerPackage:Vr.unitsPerPackage,packages:Wr,pricePerPackage:Pr,totalExpected:wn,grossProfit:gn,logisticAllocated:ua,providerPrice:Vr.providerPrice,vendorMarginPercent:Zi.vendorMarginPercent,uAproximada:Ji,uVendor:Zi.uVendor,uInvestor:Zi.uInvestor,totalRivas:(Vr.unitPriceRivas||0)*Wr,totalSanJorge:(Vr.unitPriceSanJorge||0)*Wr,totalIsla:(Vr.unitPriceIsla||0)*Wr,unitPriceRivas:Vr.unitPriceRivas||0,unitPriceSanJorge:Vr.unitPriceSanJorge||0,unitPriceIsla:Vr.unitPriceIsla||0,remainingPackages:Wr};ar.push(va)}if(!ar.length)return m(" No se encontraron filas con Paquetes > 0.");H(wr=>[...ar,...wr]),Ze(1),m(` Importados ${ar.length} productos desde plantilla.`)}catch(tt){console.error(tt),m(" Error importando Excel.")}},br=async()=>{var he;try{if(m(""),d)return m(" Solo lectura.");if(!T)return m(" Seleccion un vendedor.");if(!G)return m(" Seleccion una fecha.");if(!O.length)return m(" Agreg al menos 1 producto.");const tt=p.find(jr=>jr.id===T)||null;if(!tt)return m(" Vendedor invlido.");const nt=tt.branch,lt=B?xe.filter(jr=>me(jr)===B):[],ge=String(((he=lt[0])==null?void 0:he.orderName)||"").trim(),it=String(ue||"").trim(),Pt=B?ge!==it:it!=="",wt=jr=>String(jr??"").trim(),Nt=new Map;lt.forEach(jr=>Nt.set(wt(jr.productId),jr));const It=jr=>Nt.get(wt(jr))||null,qt=jr=>{const pr=It(jr.productId),Pr=Ni(jr.packages),Tn=pr?Ni(pr.packages):0,wn=!pr||Pr!==Tn,gn=sf(pr?pr.vendorMarginPercent:jr.vendorMarginPercent),ua=sf(jr.vendorMarginPercent);return{prev:pr,newPacks:Pr,oldPacks:Tn,packsChanged:wn,marginChanged:pr?gn!==ua:!0}},Mt=B?O.filter(jr=>{const pr=qt(jr);return!pr.prev||pr.packsChanged||pr.marginChanged}):O;for(const jr of Mt){const pr=Ni(jr.packages),Pr=B?It(jr.productId):null,Tn=Pr?Ni(Pr.packages):0,wn=pr-Tn;if(wn>0){let gn=b[jr.productId]??0;const ua=v.find(xa=>xa.id===jr.productId)||null;if(wn>gn&&(ua!=null&&ua.masterOrderId))try{await yF(ua.masterOrderId);const xa=await Ne(jr.productId,jr.productName);gn=xa.byId,w(Ji=>({...Ji,[jr.productId]:xa.byId}))}catch{}if(wn>gn){const xa=await Ne(jr.productId,jr.productName);return xa.byId===0&&xa.byName>0?m(` "${jr.productName}" no tiene inventario por ID (${jr.productId}). Pero existe por nombre: ${xa.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`):m(` "${jr.productName}" excede existencias de orden maestra. Existentes: ${xa.byId} (faltan ${wn})`)}}}Q(!0);const zt=yr.now(),ar=Me(T,G),wr=bt(T),dr=new Set(O.map(jr=>String(jr.id||""))),Rt=B?lt.filter(jr=>!dr.has(String(jr.id||""))):[];if(B&&Mt.length===0&&!Rt.length&&!Pt)return Q(!1),m(" No hay cambios para guardar.");if(B&&Mt.length===0&&!Rt.length&&Pt){const jr=Ic(Ce);lt.forEach(pr=>{jr.update(Yt(Ce,"inventory_candies_sellers",pr.id),{orderName:it,updatedAt:yr.now()})}),await jr.commit(),j(pr=>pr.map(Pr=>me(Pr)===B?{...Pr,orderName:it}:Pr)),m(" Pedido guardado."),E(!1),nr(),s();return}if(B){const jr=[];for(const pr of Rt)await vG(pr.id),jr.push(pr.id);jr.length&&j(pr=>pr.filter(Pr=>!jr.includes(Pr.id)));for(const pr of O){const Pr=It(pr.productId);if(!Pr)continue;const Tn=Ni(pr.packages),wn=Ni(Pr.packages),gn=Tn-wn;if(gn<0){const ua=Math.abs(gn),xa=Ni(Pr.remainingPackages);if(ua>xa)return m(` No pods bajar "${pr.productName}" en ${ua} porque solo quedan ${xa} paquetes restantes.`);await rVe({vendorInventoryId:Pr.id,packagesToReturn:ua})}}}const Wr=new Map;let Vr="";for(const jr of Mt){const pr=qt(jr),Pr=pr.newPacks-pr.oldPacks;if(pr.packsChanged&&Pr>0)try{const{allocations:Tn}=await xG({productId:jr.productId,packagesToAllocate:Pr});Wr.set(jr.productId,Tn||[])}catch{const wn=v.find(gn=>gn.id===jr.productId)||null;if(wn!=null&&wn.masterOrderId)try{await yF(wn.masterOrderId);const{allocations:gn}=await xG({productId:jr.productId,packagesToAllocate:Pr});Wr.set(jr.productId,gn||[]);continue}catch{const ua=await Ne(jr.productId,jr.productName);ua.byId===0&&ua.byName>0?Vr=` "${jr.productName}" no tiene inventario por ID (${jr.productId}). Pero existe por nombre: ${ua.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Vr=` No hay paquetes disponibles en orden maestra para "${jr.productName}". Disponibles: ${ua.byId}.`;break}{const gn=await Ne(jr.productId,jr.productName);gn.byId===0&&gn.byName>0?Vr=` "${jr.productName}" no tiene inventario por ID (${jr.productId}). Pero existe por nombre: ${gn.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Vr=` No hay paquetes disponibles en orden maestra para "${jr.productName}". Disponibles: ${gn.byId}.`}break}}if(Vr)return Q(!1),m(Vr);if(await zs(Ce,async jr=>{for(const pr of Mt){const Pr=qt(pr),Tn=Pr.prev;if(B&&Tn&&!Pr.packsChanged){const M=pr.vendorMarginPercent!=null?pr.vendorMarginPercent:wr,Ee=Number(Tn.grossProfit??pr.grossProfit??0),mt=Number(Tn.logisticAllocated??pr.logisticAllocated??0),jt=id(Ee,M),$t=Number(Ee||0)-Number(mt||0)-Number(jt.uVendor||0),Ar=Yt(Ce,"inventory_candies_sellers",pr.id);jr.update(Ar,{vendorMarginPercent:jt.vendorMarginPercent,uVendor:jt.uVendor,uInvestor:jt.uInvestor,uNeta:$t,vendorProfit:jt.uVendor});continue}const wn=Ni(pr.packages),gn=Ni(pr.unitsPerPackage),ua=wn*gn,xa=Tn?Ni(Tn.packages):0,Ji=Tn?Ni(Tn.remainingPackages):0,Zi=wn-xa,Dl=Tn?Math.max(0,Ji+Zi):wn,va=Dl*gn,Qn=v.find(M=>M.id===pr.productId),hu=Qn?we(Qn,nt):Number(pr.pricePerPackage||0),eo=(Qn?pt(Qn,nt):0)*wn,Uc=Qn?Qn.logisticAllocatedPerPack*wn:pr.logisticAllocated||0,Ac=(Qn?vt(Qn,nt):0)*wn,ll=pr.vendorMarginPercent!=null?pr.vendorMarginPercent:wr,Au=id(eo,ll),zA=Number(eo||0)-Number(Uc||0)-Number(Au.uVendor||0),cl=((Qn==null?void 0:Qn.unitPriceRivas)||pr.unitPriceRivas||0)*wn,Vc=((Qn==null?void 0:Qn.unitPriceSanJorge)||pr.unitPriceSanJorge||0)*wn,Ff=((Qn==null?void 0:Qn.unitPriceIsla)||pr.unitPriceIsla||0)*wn,Ao={sellerId:tt.id,sellerName:tt.name,sellerEmail:tt.email||"",branch:tt.branch||"",branchLabel:tt.branchLabel||"",orderName:String(ue||"").trim(),productId:pr.productId,productName:pr.productName,category:pr.category,orderId:ar,date:G,createdAt:zt,packages:wn,unitsPerPackage:gn,totalUnits:ua,remainingPackages:Dl,remainingUnits:va,totalRivas:cl,totalSanJorge:Vc,totalIsla:Ff,unitPriceRivas:(Qn==null?void 0:Qn.unitPriceRivas)||pr.unitPriceRivas||0,unitPriceSanJorge:(Qn==null?void 0:Qn.unitPriceSanJorge)||pr.unitPriceSanJorge||0,unitPriceIsla:(Qn==null?void 0:Qn.unitPriceIsla)||pr.unitPriceIsla||0,grossProfit:eo,logisticAllocated:Uc,vendorMarginPercent:Au.vendorMarginPercent,uVendor:Au.uVendor,uNeta:zA,uAproximada:Ac,uInvestor:Au.uInvestor,providerPrice:Number(pr.providerPrice??(Qn==null?void 0:Qn.providerPrice)??0),vendorProfit:Au.uVendor,transferDelta:Tn?Number(Tn.transferDelta||0):0},Wu=Wr.get(pr.productId)||[];if(B)if(String(pr.id||"").startsWith("tmp_")){const M=Yt(Ct(Ce,"inventory_candies_sellers"));Ao.masterAllocations=Wu,jr.set(M,Ao)}else{const M=Yt(Ce,"inventory_candies_sellers",pr.id);Wu.length>0&&(Ao.masterAllocations=Ree(...Wu)),jr.set(M,Ao,{merge:!0})}else{const M=Yt(Ct(Ce,"inventory_candies_sellers"));Ao.masterAllocations=Wu,jr.set(M,Ao)}}}),B&&Pt){const jr=new Set(Rt.map(Pr=>Pr.id)),pr=Ic(Ce);lt.forEach(Pr=>{jr.has(Pr.id)||pr.update(Yt(Ce,"inventory_candies_sellers",Pr.id),{orderName:it,updatedAt:yr.now()})}),await pr.commit(),j(Pr=>Pr.map(Tn=>me(Tn)===B?{...Tn,orderName:it}:Tn))}m(" Pedido guardado."),E(!1),nr(),s()}catch(tt){console.error(tt),m(" Error guardando el pedido.")}finally{Q(!1)}},er=async he=>{try{if(m(""),!l)return m(" Solo admin.");Q(!0);const tt=xe.filter(nt=>me(nt)===he);for(const nt of tt)await vG(nt.id);m(" Pedido eliminado."),s()}catch(tt){console.error(tt),m(" Error eliminando pedido.")}finally{Q(!1)}},ir=oi.useRef(null),Sr=()=>{var he;if(d)return m(" Solo lectura.");if(!T)return m(" Seleccion un vendedor.");if(!G)return m(" Seleccion una fecha.");(he=ir.current)==null||he.click()},vr=async he=>{var nt;const tt=(nt=he.target.files)==null?void 0:nt[0];he.target.value="",tt&&await Jr(tt)},Fr=!l,jn=l?12:9;return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-3 mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-lg md:text-2xl font-semibold",children:"rdenes de Vendedor (Dulces)"}),i.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Pedidos agrupados por vendedor + fecha. U. Bruta viene de la orden maestra. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(Mc,{onClick:s}),l&&i.jsx("button",{onClick:()=>Ye(!0),className:"px-3 py-2 rounded bg-amber-600 text-white text-sm hover:bg-amber-700",children:"Traslados"}),!d&&i.jsx("button",{onClick:Ir,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo pedido"})]})]}),h&&!S&&i.jsx("div",{className:"mb-3 p-2 rounded border text-sm bg-white",children:h}),f?i.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"hidden md:block bg-white border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:pe.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:()=>{if(!S){m(" Abr un pedido para exportar productos asociados.");return}xr()},children:"Exportar asociados"}),l&&i.jsx(i.Fragment,{children:i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:He,disabled:te,children:te?"Actualizando campos...":"Actualizar campos calculados"})})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Nombre"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Asociados"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Salida"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Entrada"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[ft.map(he=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:he.orderName||""}),i.jsx("td",{className:"p-2 border-b",children:he.date}),i.jsx("td",{className:"p-2 border-b",children:he.sellerName}),i.jsx("td",{className:"p-2 border-b text-right",children:he.totalPackages}),i.jsx("td",{className:"p-2 border-b text-right",children:he.totalRemainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:si(he.totalExpectedActive??he.totalExpected)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:si(he.grossProfitActive??he.grossProfit)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:si((he.gastosActive??he.gastos)||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:si(he.vendorProfitActive??he.vendorProfit)}),i.jsx("td",{className:"p-2 border-b text-right",children:he.transferredOut}),i.jsx("td",{className:"p-2 border-b text-right",children:he.transferredIn}),i.jsx("td",{className:"p-2 border-b",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded bg-gray-900 text-white text-xs hover:bg-black",onClick:()=>or(he.orderKey),children:"Ver / Editar"}),l&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este pedido completo?")&&er(he.orderKey)},children:"Eliminar"})]})})]},he.orderKey)),!ft.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:jn,children:"No hay pedidos."})})]})]})}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina ",ee," / ",Le]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:At,disabled:ee<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:ct,disabled:ee>=Le,children:""})]})]})]}),i.jsxs("div",{className:"md:hidden space-y-2",children:[i.jsxs("div",{className:"bg-white border rounded p-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:pe.length})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:[ee,"/",Le]})]}),ft.map(he=>i.jsxs("div",{className:"bg-white border rounded",role:"button",tabIndex:0,onClick:()=>or(he.orderKey),onKeyDown:tt=>{(tt.key==="Enter"||tt.key===" ")&&(tt.preventDefault(),or(he.orderKey))},children:[i.jsxs("div",{className:"p-2 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:he.sellerName}),i.jsxs("div",{className:"text-xs text-gray-600",children:[he.orderName||"","  ",he.date]})]}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm text-red-600",onClick:tt=>{tt.stopPropagation(),confirm("Eliminar este pedido completo?")&&er(he.orderKey)},children:"Eliminar"})]}),i.jsx("div",{className:"px-2 pb-2",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Asociados"}),i.jsx("div",{className:"font-semibold",children:he.totalPackages})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Restantes"}),i.jsx("div",{className:"font-semibold",children:he.totalRemainingPackages})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:si(he.totalExpectedActive??he.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:si(he.vendorProfitActive??he.vendorProfit)})]})]})})]},he.orderKey)),!ft.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 bg-white border rounded",children:"No hay pedidos."}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:At,disabled:ee<=1,children:""}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:ct,disabled:ee>=Le,children:""})]})]})]}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3 md:p-6",children:i.jsxs("div",{className:"bg-white w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded shadow relative",children:[D&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"text-sm font-semibold",children:"Guardando"})}),i.jsxs("div",{className:"p-3 md:p-5 border-b flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-semibold",children:B?"Editar pedido":"Nuevo pedido"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Nombre: ",ue||""]}),i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta viene de Orden Maestra. U. Vendedor e Inversionista se calculan aqu. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Qr,children:"Cerrar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:br,children:"Guardar"})]})]}),i.jsxs("div",{className:"p-3 md:p-5 space-y-3",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Xe(he=>!he),children:[i.jsx("span",{children:"Filtros y KPIs"}),i.jsx("span",{children:U?"":"+"})]}),i.jsxs("div",{className:`${U?"block":"hidden"} md:block space-y-3`,children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[i.jsxs("div",{className:"md:col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Nombre"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:ue,onChange:he=>le(he.target.value),placeholder:"Nombre de la orden",disabled:d})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:T,onChange:he=>P(he.target.value),disabled:Fr,children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),p.map(he=>i.jsxs("option",{value:he.id,children:[he.name," ",he.branch?`(${he.branch})`:""]},he.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",value:G,onChange:he=>ce(he.target.value)})]}),i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:dn,children:"Plantilla"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Sr,children:"Importar Excel"}),i.jsx("input",{ref:ir,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:vr})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. asociados"}),i.jsx("div",{className:"text-lg font-semibold",children:_t.totalPackages})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:si(_t.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:si(_t.grossProfit)})]})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:si(_t.uVendor)})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"text-lg font-semibold",children:si(Ot)})]})]})]}),i.jsxs("div",{className:"border rounded p-3 space-y-2",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Ft(he=>!he),children:[i.jsx("span",{children:"Agregar producto"}),i.jsx("span",{children:St?"":"+"})]}),i.jsxs("div",{className:`${St?"block":"hidden"} md:block space-y-2`,children:[i.jsx("div",{className:"text-sm font-semibold hidden md:block",children:"Agregar producto"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-2",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:K,onChange:he=>R(he.target.value),placeholder:"Buscar por categora o nombre"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:Ae,onChange:he=>ae(he.target.value),children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),Ge.map(he=>i.jsxs("option",{value:he.id,children:[he.category," - ",he.name," (exist:"," ",b[he.id]??0,")"]},he.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:_e,onChange:he=>De(he.target.value),inputMode:"numeric"})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{className:"w-full px-3 py-2 rounded bg-gray-900 text-white text-sm hover:bg-black",onClick:kr,disabled:!ie,children:"Agregar"})})]})]})]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm font-semibold",children:["Productos asociados (",O.length,")"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Buscar producto",value:X,onChange:he=>{Y(he.target.value),Ze(1)}}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:xr,disabled:!O.length,children:"Exportar Excel"})]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Categora"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Producto"}),i.jsxs("th",{className:"text-right p-2 border-b",children:["P. Asociados"," "]}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Precio prov."}),i.jsx("th",{className:"text-right p-2 border-b",children:"Precio/paq"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"})]}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Neta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Margen (%)"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[re.map(he=>{const{totalExpected:tt,grossProfit:nt,gastos:lt,uVendor:ge,uNeta:it}=st(he);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:he.category}),i.jsx("td",{className:"p-2 border-b",children:he.productName}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsx("span",{children:he.packages}):ht[he.id]?i.jsx("input",{className:"w-20 border rounded p-1 text-right",value:String(he.packages),onChange:Pt=>nn(he.id,Pt.target.value),onBlur:()=>$e(he.id),onKeyDown:Pt=>{(Pt.key==="Enter"||Pt.key==="Escape")&&$e(he.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:he.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ye(he.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 border-b text-right",children:he.remainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:si(he.providerPrice||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:si(he.pricePerPackage)}),i.jsx("td",{className:"p-2 border-b text-right",children:si(tt)}),l&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border-b text-right",children:si(nt)}),i.jsx("td",{className:"p-2 border-b text-right",children:si(lt)})]}),i.jsx("td",{className:"p-2 border-b text-right",children:si(ge)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:si(it)}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsxs("span",{children:[Number(he.vendorMarginPercent??bt(T)).toFixed(3),"%"]}):Ie[he.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-20 border rounded p-1 text-right",value:String(he.vendorMarginPercent??bt(T)),onChange:Pt=>_r(he.id,Pt.target.value),onBlur:()=>Ke(he.id),onKeyDown:Pt=>{(Pt.key==="Enter"||Pt.key==="Escape")&&Ke(he.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{children:[Number(he.vendorMarginPercent??bt(T)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ze(he.id),"aria-label":"Editar margen",children:""})]})}),i.jsx("td",{className:"p-2 border-b",children:!d&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este producto?")&&Zr(he.id)},children:""})})]},he.id)}),!re.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:l?13:9,children:"No hay productos asociados."})})]})]})}),i.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[V.map(([he,tt])=>{const nt=!!ut[he];return i.jsxs("div",{className:"border rounded",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-2 flex items-center justify-between text-sm",onClick:()=>L(he),children:[i.jsx("span",{className:"font-semibold",children:he}),i.jsxs("span",{className:"text-xs text-gray-600",children:[tt.length," ",tt.length===1?"producto":"productos"]})]}),nt&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:tt.map(lt=>{const{totalExpected:ge,grossProfit:it,gastos:Pt,uVendor:wt,uNeta:Nt}=st(lt);return i.jsxs("div",{className:"border rounded p-2 text-xs space-y-2",children:[i.jsx("div",{className:"font-semibold text-sm",children:lt.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes"}),d?i.jsx("div",{className:"font-semibold",children:lt.packages}):ht[lt.id]?i.jsx("input",{className:"w-full border rounded p-1 text-right",value:String(lt.packages),onChange:It=>nn(lt.id,It.target.value),onBlur:()=>$e(lt.id),onKeyDown:It=>{(It.key==="Enter"||It.key==="Escape")&&$e(lt.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:lt.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ye(lt.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:lt.remainingPackages})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Precio/paq"}),i.jsx("div",{className:"font-semibold",children:si(lt.pricePerPackage)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:si(ge)})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"font-semibold",children:si(it)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Gastos"}),i.jsx("div",{className:"font-semibold",children:si(Pt)})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:si(wt)})]}),l&&i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"font-semibold",children:si(Nt)})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-gray-600",children:"Margen (%)"}),d?i.jsxs("div",{className:"font-semibold",children:[Number(lt.vendorMarginPercent??bt(T)).toFixed(3),"%"]}):Ie[lt.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-full border rounded p-1 text-right",value:String(lt.vendorMarginPercent??bt(T)),onChange:It=>_r(lt.id,It.target.value),onBlur:()=>Ke(lt.id),onKeyDown:It=>{(It.key==="Enter"||It.key==="Escape")&&Ke(lt.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{className:"font-semibold",children:[Number(lt.vendorMarginPercent??bt(T)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ze(lt.id),"aria-label":"Editar margen",children:""})]})]}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>{confirm("Eliminar este producto?")&&Zr(lt.id)},children:""})]})]},lt.id)})})]},he)}),!re.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 text-center",children:"No hay productos asociados."})]}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina items ",Se," / ",z]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:fe,disabled:Se<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Be,disabled:Se>=z,children:""})]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center md:justify-between",children:[i.jsx("div",{className:"text-xs text-gray-600",children:B?i.jsxs(i.Fragment,{children:["Editando: ",i.jsx("b",{children:B})]}):i.jsx(i.Fragment,{children:"Nuevo pedido (an no guardado)"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Qr,children:"Cancelar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:br,children:"Guardar pedido"})]})]}),h&&i.jsx("div",{className:"text-sm text-gray-700",children:h})]})]})}),i.jsx(iVe,{open:Te,onClose:()=>Ye(!1),orders:pe,rows:I,setRows:j,isAdmin:l,currentUserEmail:r||"",currentUserName:"",sellerCandyId:e,sellers:p,products:v,transferAgg:Qt,setTransferAgg:Ut,setTransferRowDeltas:Re})]})}const Hn=t=>Math.max(0,Math.floor(Number(t)||0)),$b=t=>Math.round(t||0),NE=99.999;function Kse(t){const e=Math.max(1,Hn(t.unitsPerPackage||1)),r=Hn(t.totalUnits||0),n=Hn(t.quantity||0),a=Hn(t.packages||0);return r>0?r:n>0?n:a>0?a*e:0}function lVe(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Kse(t)}function SG(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,Hn(t.unitsPerPackage||1)),n=lVe(t);return Math.max(0,Math.floor(n/r))}function cVe(t){const e=Math.max(1,Hn(t.unitsPerPackage||1)),r=Kse(t);return Math.max(0,Math.floor(r/e))}function Gb(t){return String(t??"").trim().toLowerCase().replace(/\s+/g," ")}function Vf(t){const e=String(t??"").trim();if(!e)return 0;const r=e.replace(/,/g,"."),n=Number(r);return Number.isFinite(n)?n:0}function Oh(t,e){const r={};Object.keys(t||{}).forEach(n=>r[Gb(n)]=t[n]);for(const n of e){const a=r[Gb(n)];if(a!=null&&String(a).trim()!=="")return a}}function ip(t,e,r){const n=t*e,a=NE,s=Math.min(Math.max(r.marginR,0),a)/100,o=Math.min(Math.max(r.marginSJ,0),a)/100,l=Math.min(Math.max(r.marginIsla,0),a)/100,c=e>0&&s<1?n/(1-s):n,u=e>0&&o<1?n/(1-o):n,d=e>0&&l<1?n/(1-l):n,f=c-n,A=u-n,h=d-n,m=e>0?$b(c/e):0,p=e>0?$b(u/e):0,x=e>0?$b(d/e):0;return{subtotal:n,totalRivas:c,totalSanJorge:u,totalIsla:d,gainRivas:f,gainSanJorge:A,gainIsla:h,unitPriceRivas:m,unitPriceSanJorge:p,unitPriceIsla:x}}function uVe(t){return Number(t.gainRivas||0)}function dVe(t){return Number(t.gainIsla||0)}function lT(t,e,r){const n=uVe(t),a=dVe(t),s=Number(t.subtotal||0),o=e>0&&r>0?e*s/r:0;return{...t,grossProfit:n,grossProfitIsla:a,logisticAllocated:o}}function fVe(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState(""),[a,s]=g.useState(!0),[o,l]=g.useState(!1),[c,u]=g.useState(!1),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState({}),[w,I]=g.useState(!1),[j,C]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState("20"),[G,ce]=g.useState("15"),[ue,le]=g.useState("30"),[Ae,ae]=g.useState("0"),[_e,De]=g.useState([]),[O,H]=g.useState({}),[K,R]=g.useState({}),[X,Y]=g.useState({}),[D,Q]=g.useState({}),[te,be]=g.useState({}),[U,Xe]=g.useState({}),[se,ee]=g.useState({}),Fe=He=>H(Bt=>({...Bt,[He]:!0})),je=He=>H(Bt=>({...Bt,[He]:!1})),Se=He=>R(Bt=>({...Bt,[He]:!0})),Ze=He=>R(Bt=>({...Bt,[He]:!1})),ut=He=>Y(Bt=>({...Bt,[He]:!0})),Et=He=>Y(Bt=>({...Bt,[He]:!1})),St=He=>Q(Bt=>({...Bt,[He]:!0})),Ft=He=>Q(Bt=>({...Bt,[He]:!1})),Qt=He=>be(Bt=>({...Bt,[He]:!0})),Ut=He=>be(Bt=>({...Bt,[He]:!1})),Tt=He=>Xe(Bt=>({...Bt,[He]:!0})),Re=He=>Xe(Bt=>({...Bt,[He]:!1})),Te=He=>ee(Bt=>({...Bt,[He]:!0})),Ye=He=>ee(Bt=>({...Bt,[He]:!1})),[ht,Oe]=g.useState(""),[Ie,We]=g.useState(""),[Z,Qe]=g.useState(""),[at,Ge]=g.useState("1"),[ie,xe]=g.useState("0"),[de,Me]=g.useState("DATOS"),[me,we]=g.useState(""),[pt,vt]=g.useState(1),bt=15,kt=g.useMemo(()=>Math.max(1,Math.ceil(x.length/bt)),[x.length]);g.useEffect(()=>vt(1),[x.length]);const Vt=g.useMemo(()=>{const He=(pt-1)*bt;return x.slice(He,He+bt)},[x,pt]),ke=g.useMemo(()=>{const He=new Set;for(const Bt of A){const xr=String(Bt.category||"").trim();xr&&He.add(xr)}return Array.from(He).sort((Bt,xr)=>Bt.localeCompare(xr,"es"))},[A]);g.useEffect(()=>{!ht&&ke.length>0&&Oe(ke[0])},[ke]);const Ne=async()=>{p(!0);try{const He=await Ht(sr(Ct(Ce,"products_candies"),Sn("createdAt","desc"))),Bt=[];He.forEach(xr=>{const dn=xr.data();Bt.push({id:xr.id,name:String(dn.name??"").trim(),category:String(dn.category??"").trim()||"Caramelo",providerPrice:Number(dn.providerPrice??0),unitsPerPackage:Number(dn.unitsPerPackage??1)})}),h(Bt)}catch(He){console.error(He),n(" Error cargando catlogo de dulces.")}finally{p(!1)}};g.useEffect(()=>{Ne()},[t]);const pe=g.useMemo(()=>(ht.trim().length>0?A.filter(Bt=>Bt.category===ht):A).sort((Bt,xr)=>Bt.name.localeCompare(xr.name,"es")),[A,ht]);g.useEffect(()=>{if(!Ie){Qe(""),Ge("1");return}const He=A.find(Bt=>Bt.id===Ie);He&&(Qe(String(He.providerPrice??0)),Ge(String(He.unitsPerPackage??1)))},[Ie,A]);const Le=()=>{C(null),E(""),k(""),De([]),H({}),R({}),Y({}),Q({}),be({}),Xe({}),ee({}),Oe(ke[0]||""),We(""),Qe(""),xe("0"),Ge("1"),P("20"),ce("15"),le("30"),ae("0"),Me("DATOS"),we("")},ft=()=>{if(n(""),!Ie){n("Selecciona un producto del catlogo.");return}const He=A.find(vr=>vr.id===Ie);if(!He){n("Producto de catlogo no encontrado (refresca).");return}const Bt=Number(He.providerPrice||0),xr=Hn(ie||0),dn=Hn(He.unitsPerPackage||0);if(Bt<0){n("El precio proveedor no puede ser negativo.");return}if(xr<=0){n("Los paquetes deben ser mayor que 0.");return}if(dn<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const Jr=Number(T||0),br=Number(G||0),er=Number(ue||0),ir=ip(Bt,xr,{marginR:Jr,marginSJ:br,marginIsla:er});if(_e.find(vr=>vr.id===He.id))De(vr=>vr.map(Fr=>{if(Fr.id!==He.id)return Fr;const jn=Hn(Fr.packages||0)+xr,he=ip(Bt,jn,{marginR:Number(Fr.marginRivas??Jr),marginSJ:Number(Fr.marginSanJorge??br),marginIsla:Number(Fr.marginIsla??er)}),nt=Hn(Fr.remainingPackages??Fr.packages)+xr;return{...Fr,providerPrice:Bt,unitsPerPackage:dn,packages:jn,remainingPackages:nt,...he}}));else{const vr={id:He.id,name:He.name,category:He.category,providerPrice:Bt,packages:xr,unitsPerPackage:dn,marginRivas:Jr,marginSanJorge:br,marginIsla:er,subtotal:ir.subtotal,totalRivas:ir.totalRivas,totalSanJorge:ir.totalSanJorge,totalIsla:ir.totalIsla,gainRivas:ir.gainRivas,gainSanJorge:ir.gainSanJorge,gainIsla:ir.gainIsla,unitPriceRivas:ir.unitPriceRivas,unitPriceSanJorge:ir.unitPriceSanJorge,unitPriceIsla:ir.unitPriceIsla,remainingPackages:xr};De(Fr=>[...Fr,vr])}We(""),xe("0"),Me("ITEMS")},At=He=>{De(Bt=>Bt.filter(xr=>xr.id!==He))},ct=(He,Bt,xr)=>{De(dn=>dn.map(Jr=>{if(Jr.id!==He)return Jr;let br={...Jr};if(Bt==="packages"&&(br.packages=Hn(xr||0)),Bt==="unitsPerPackage"&&(br.unitsPerPackage=Hn(xr||0)),Bt==="remainingPackages"){const er=Math.max(0,Hn(br.packages||0)),ir=Hn(xr||0);br.remainingPackages=Math.min(er,Math.max(0,ir))}if(Bt==="unitPriceRivas"||Bt==="unitPriceIsla"){const er=Math.max(0,Number(xr)||0),ir=Math.max(0,Hn(br.packages||0)),Sr=Number(br.providerPrice||0)*ir,vr=ir>0?er*ir:0;if(Bt==="unitPriceRivas"){br.unitPriceRivas=er,br.totalRivas=vr,br.gainRivas=vr-Sr;const Fr=vr>0?(1-Sr/vr)*100:0;br.marginRivas=Math.min(Math.max(Fr,0),NE)}else{br.unitPriceIsla=er,br.totalIsla=vr,br.gainIsla=vr-Sr;const Fr=vr>0?(1-Sr/vr)*100:0;br.marginIsla=Math.min(Math.max(Fr,0),NE)}}if(Bt==="marginRivas"&&(br.marginRivas=Number(xr||0)),Bt==="marginIsla"&&(br.marginIsla=Number(xr||0)),Bt==="marginSanJorge"&&(br.marginSanJorge=Number(xr||0)),Bt==="packages"||Bt==="marginRivas"||Bt==="marginIsla"||Bt==="marginSanJorge"){const er=ip(br.providerPrice,br.packages,{marginR:Number(br.marginRivas||0),marginSJ:Number(br.marginSanJorge||0),marginIsla:Number(br.marginIsla||0)});br={...br,...er}}if(br.remainingPackages===void 0||br.remainingPackages===null)br.remainingPackages=br.packages;else if(Bt==="packages"){const er=Hn(br.remainingPackages);br.remainingPackages=Math.min(er,Math.max(0,br.packages))}return br}))},W=g.useMemo(()=>{const He=_e.reduce((br,er)=>br+Hn(er.packages),0),Bt=_e.reduce((br,er)=>br+Number(er.subtotal||0),0),xr=_e.reduce((br,er)=>br+Number(er.totalRivas||0),0),dn=_e.reduce((br,er)=>br+Number(er.totalSanJorge||0),0),Jr=_e.reduce((br,er)=>br+Number(er.totalIsla||0),0);return{totalPackages:He,subtotal:Bt,totalRivas:xr,totalSanJorge:dn,totalIsla:Jr}},[_e]),z=g.useMemo(()=>{const He=Math.max(0,Vf(Ae||0)),Bt=Number(W.subtotal||0),xr=_e.map(er=>lT(er,He,Bt)),dn=xr.reduce((er,ir)=>er+Number(ir.grossProfit||0),0),Jr=xr.reduce((er,ir)=>er+Number(ir.grossProfitIsla||0),0),br=xr.reduce((er,ir)=>er+Number(ir.logisticAllocated||0),0);return{items:xr,logisticsTotal:He,grossTotal:dn,grossIslaTotal:Jr,logisticAllocatedTotal:br}},[_e,Ae,W.subtotal]),re=g.useMemo(()=>{const He=String(me||"").trim().toLowerCase();return He?z.items.filter(Bt=>{const xr=String(Bt.name||"").toLowerCase(),dn=String(Bt.category||"").toLowerCase();return xr.includes(He)||dn.includes(He)}):z.items},[z.items,me]),[V,L]=g.useState(1),fe=15,Be=g.useMemo(()=>Math.max(1,Math.ceil(re.length/fe)),[re.length]);g.useEffect(()=>L(1),[re.length]);const ye=g.useMemo(()=>{const He=(V-1)*fe;return re.slice(He,He+fe)},[re,V]),[$e,ze]=g.useState({});g.useEffect(()=>ze({}),[re.length]);const[Ke,yt]=g.useState({});g.useEffect(()=>{const He={};for(const Bt of x)Bt&&Bt.id&&(He[Bt.id]=!1);yt(He)},[x]);const ne=g.useMemo(()=>({totalPackages:W.totalPackages,subtotalCosto:W.subtotal,esperadoRivas:W.totalRivas,esperadoIsla:W.totalIsla,gastosLogisticos:z.logisticsTotal,utilidadBrutaRivas:z.grossTotal,utilidadBrutaIsla:z.grossIslaTotal}),[W,z]),Ue=()=>{if(n(""),!A.length){n(" No hay catlogo cargado para generar plantilla.");return}const He=Number(T||0),Bt=Number(ue||0),xr=A.slice().sort((Sr,vr)=>Sr.name.localeCompare(vr.name,"es")).map(Sr=>({Producto:Sr.name,Paquetes:"","Margen rivas":He,"Margen Isla":Bt,"P. unidad Rivas":"","P. unidad Isla":""})),dn=[{Campo:"Gastos logisticos",Valor:Vf(Ae||0)}],Jr=ha.book_new(),br=ha.json_to_sheet(xr),er=ha.json_to_sheet(dn);ha.book_append_sheet(Jr,br,"Productos"),ha.book_append_sheet(Jr,er,"Config");const ir=B&&String(B).trim()||new Date().toISOString().slice(0,10);K2(Jr,`plantilla_orden_maestra_${ir}.xlsx`)},rt=()=>{if(n(""),!z.items.length){n(" No hay items para exportar.");return}const He=z.items.slice().sort((br,er)=>br.name.localeCompare(er.name,"es")).map(br=>({Categora:br.category,Producto:br.name,Paquetes:Hn(br.packages),"Paquetes restantes":Hn(br.remainingPackages??br.packages),"Und x Paquete":Hn(br.unitsPerPackage),"Precio proveedor":Number(br.providerPrice||0),Facturado:Number(br.subtotal||0),"Esperado Rivas":Number(br.totalRivas||0),"Esperado Isla":Number(br.totalIsla||0),"MV Rivas":Number(br.marginRivas||0),"MV Isla":Number(br.marginIsla||0),"Utilidad Bruta":Number(br.grossProfit||0),"Utilidad Bruta Isla":Number(br.grossProfitIsla||0),"Prorrateo logistico":Number(br.logisticAllocated||0),"Precio Rivas":Number(br.unitPriceRivas||0),"Precio Isla":Number(br.unitPriceIsla||0)})),Bt=[{KPI:"Paquetes totales",Valor:ne.totalPackages},{KPI:"Subtotal costo",Valor:ne.subtotalCosto},{KPI:"Esperado Rivas",Valor:ne.esperadoRivas},{KPI:"Esperado Isla",Valor:ne.esperadoIsla},{KPI:"Gastos logsticos",Valor:ne.gastosLogisticos},{KPI:"Utilidad Bruta Rivas",Valor:ne.utilidadBrutaRivas},{KPI:"Utilidad Bruta Isla",Valor:ne.utilidadBrutaIsla}],xr=ha.book_new();ha.book_append_sheet(xr,ha.json_to_sheet(He),"Productos"),ha.book_append_sheet(xr,ha.json_to_sheet(Bt),"Resumen");const dn=B&&String(B).trim()||new Date().toISOString().slice(0,10),Jr=S&&String(S).trim()||`Orden_${dn}`;K2(xr,`orden_maestra_${Jr.replace(/[^\w\-]+/g,"_")}_${dn}.xlsx`)},st=g.useRef(null),[_t,Ot]=g.useState(!1),nr=()=>{var He;if(!A.length){n(" Catlogo no cargado todava. Esper y prob de nuevo.");return}(He=st.current)==null||He.click()},Ir=async He=>{var xr;const Bt=(xr=He.target.files)==null?void 0:xr[0];if(Bt){He.target.value="",Ot(!0),n("");try{const dn=await Bt.arrayBuffer(),Jr=Gv(dn,{type:"array"}),br=Jr.SheetNames||[],er=Jr.Sheets.Productos||Jr.Sheets.Plantilla||Jr.Sheets[br[0]];if(!er){n(" No se encontr hoja de Productos/Plantilla.");return}const ir=ha.sheet_to_json(er,{defval:""});if(!ir.length){n(" El Excel viene vaco.");return}let Sr=0;const vr=Jr.Sheets.Config;if(vr){const nt=ha.sheet_to_json(vr,{defval:""}),lt=new Map;for(const ge of nt){const it=Gb(Oh(ge,["Campo","Key","Nombre"])??""),Pt=Oh(ge,["Valor","Value"]);it&&lt.set(it,Pt)}lt.has("gastos logisticos")&&(Sr=Math.max(0,Vf(lt.get("gastos logisticos"))))}else for(const nt of ir){const lt=Oh(nt,["Gastos","Gasto","Gastos logisticos","Logistica"]),ge=Vf(lt);if(ge>0){Sr=ge;break}}ae(String(Sr||0));const Fr=new Map;for(const nt of A)Fr.set(Gb(nt.name),nt);const jn=[],he=new Map;for(let nt=0;nt<ir.length;nt++){const lt=ir[nt],ge=Oh(lt,["Producto","Product","Nombre","Name"]),it=Oh(lt,["Paquetes","Packages"]),Pt=Oh(lt,["Margen rivas","Margen Rivas","MV Rivas"]),wt=Oh(lt,["Margen Isla","Margen isla","MV Isla"]),Nt=Oh(lt,["P. unidad Rivas","P unidad Rivas","Precio Rivas"]),It=Oh(lt,["P. unidad Isla","P unidad Isla","Precio Isla"]),qt=Gb(ge);if(!qt)continue;const Mt=Fr.get(qt);if(!Mt){jn.push(`Fila ${nt+2}: Producto no existe en catlogo: "${String(ge).trim()}".`);continue}const zt=Math.floor(Vf(it));if(zt<=0){jn.push(`Fila ${nt+2}: "Paquetes" invlido para "${Mt.name}".`);continue}const ar=String(Pt??"").trim()!==""?Vf(Pt):Number(T||0),wr=String(wt??"").trim()!==""?Vf(wt):Number(ue||0),dr=Math.floor(Vf(Nt)),Rt=Math.floor(Vf(It)),Wr=he.get(Mt.id);Wr?he.set(Mt.id,{packages:Wr.packages+zt,mR:ar,mI:wr,puR:dr>0?dr:Wr.puR,puI:Rt>0?Rt:Wr.puI}):he.set(Mt.id,{packages:zt,mR:ar,mI:wr,puR:dr>0?dr:void 0,puI:Rt>0?Rt:void 0})}const tt=[];he.forEach((nt,lt)=>{const ge=A.find(Rt=>Rt.id===lt);if(!ge)return;const it=Number(ge.providerPrice||0),Pt=Math.max(1,Hn(ge.unitsPerPackage||1)),wt=Math.max(1,Hn(nt.packages)),Nt=it*wt,It=Number(nt.puR||0),qt=Number(nt.puI||0),Mt=It>0||qt>0;let zt=nt.mR,ar=nt.mI;const wr=Number(G||0);let dr;if(Mt){const Rt=ip(it,wt,{marginR:zt,marginSJ:wr,marginIsla:ar}),Wr=It>0?It*wt:Rt.totalRivas,Vr=qt>0?qt*wt:Rt.totalIsla,jr=pr=>{if(!Number.isFinite(pr)||pr<=0)return 0;const Pr=(1-Nt/pr)*100;return Math.min(Math.max(Pr,0),NE)};It>0&&(zt=jr(Wr)),qt>0&&(ar=jr(Vr)),dr={subtotal:Nt,totalRivas:Wr,totalSanJorge:Rt.totalSanJorge,totalIsla:Vr,gainRivas:Wr-Nt,gainSanJorge:Rt.gainSanJorge,gainIsla:Vr-Nt,unitPriceRivas:wt>0?$b(Wr/wt):0,unitPriceSanJorge:Rt.unitPriceSanJorge,unitPriceIsla:wt>0?$b(Vr/wt):0}}else dr=ip(it,wt,{marginR:zt,marginSJ:wr,marginIsla:ar});tt.push({id:ge.id,name:ge.name,category:ge.category,providerPrice:it,packages:wt,unitsPerPackage:Pt,marginRivas:zt,marginSanJorge:wr,marginIsla:ar,subtotal:dr.subtotal,totalRivas:dr.totalRivas,totalSanJorge:dr.totalSanJorge,totalIsla:dr.totalIsla,gainRivas:dr.gainRivas,gainSanJorge:dr.gainSanJorge,gainIsla:dr.gainIsla,unitPriceRivas:dr.unitPriceRivas,unitPriceSanJorge:dr.unitPriceSanJorge,unitPriceIsla:dr.unitPriceIsla,remainingPackages:wt})}),De(nt=>{const lt=new Map;nt.forEach(ge=>lt.set(ge.id,ge));for(const ge of tt){const it=lt.get(ge.id);if(!it)lt.set(ge.id,ge);else{const Pt=Hn(it.packages)+Hn(ge.packages),wt=ip(it.providerPrice,Pt,{marginR:ge.marginRivas,marginSJ:Number(it.marginSanJorge||0),marginIsla:ge.marginIsla});lt.set(ge.id,{...it,packages:Pt,marginRivas:ge.marginRivas,marginIsla:ge.marginIsla,remainingPackages:Hn(it.remainingPackages??it.packages)+Hn(ge.packages),...wt})}}return Array.from(lt.values()).sort((ge,it)=>ge.name.localeCompare(it.name,"es"))}),Me("ITEMS"),jn.length?(n(` Importado con detalles. Errores: ${jn.length}.`),console.warn("Errores import:",jn)):n(` Importacin lista: ${tt.length} productos agregados.`)}catch(dn){console.error(dn),n(" Error importando Excel. Revis hojas: Productos + Config (o Plantilla).")}finally{Ot(!1)}}};g.useEffect(()=>{(async()=>{s(!0);try{const He=sr(Ct(Ce,"candy_main_orders"),Sn("createdAt","desc")),Bt=await Ht(He),xr=[];Bt.forEach(br=>{const er=br.data();xr.push({id:br.id,name:er.name??"",date:er.date??"",totalPackages:Number(er.totalPackages??0),subtotal:Number(er.subtotal??0),totalRivas:Number(er.totalRivas??0),totalSanJorge:Number(er.totalSanJorge??0),totalIsla:Number(er.totalIsla??0),marginRivas:Number(er.marginRivas??20),marginSanJorge:Number(er.marginSanJorge??15),marginIsla:Number(er.marginIsla??30),logisticsCost:Number(er.logisticsCost??0),createdAt:er.createdAt??yr.now()})}),v(xr);const dn=await Ht(Ct(Ce,"inventory_candies")),Jr={};dn.forEach(br=>{const er=br.data(),ir=er.orderId;if(!ir)return;const Sr=cVe(er),vr=SG(er);Jr[ir]||(Jr[ir]={orderId:ir,totalPackages:0,remainingPackages:0}),Jr[ir].totalPackages+=Sr,Jr[ir].remainingPackages+=vr}),b(Jr)}catch(He){console.error(He),n(" Error cargando pedidos generales.")}finally{s(!1)}})()},[t]);const Qr=He=>{var Bt;return He.date?He.date:(Bt=He.createdAt)!=null&&Bt.toDate?He.createdAt.toDate().toISOString().slice(0,10):""},or=async He=>{if(He.preventDefault(),n(""),l(!0),!_e.length){n("Agrega al menos un producto a la orden.");return}try{const Bt=new Date().toISOString().slice(0,10),xr=B||Bt,dn=Number(T||0),Jr=Number(G||0),br=Number(ue||0),er=Math.max(0,Vf(Ae||0));for(const nt of _e){if(!String(nt.name||"").trim()){n("Hay un producto sin nombre en el pedido.");return}if(Number(nt.providerPrice||0)<0){n(`El precio proveedor no puede ser negativo (producto: ${nt.name}).`);return}if(Hn(nt.packages)<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${nt.name}).`);return}if(Hn(nt.unitsPerPackage)<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${nt.name}).`);return}}const ir=Number(W.subtotal||0),Sr=_e.map(nt=>lT(nt,er,ir)),vr={totalPackages:W.totalPackages,subtotal:W.subtotal,totalRivas:W.totalRivas,totalSanJorge:W.totalSanJorge,totalIsla:W.totalIsla},Fr={name:S||`Pedido ${xr}`,date:xr,totalPackages:vr.totalPackages,subtotal:vr.subtotal,totalRivas:vr.totalRivas,totalSanJorge:vr.totalSanJorge,totalIsla:vr.totalIsla,marginRivas:dn,marginSanJorge:Jr,marginIsla:br,logisticsCost:er,uBrutaGlobal:z.grossTotal,items:Sr};if(j){await kn(Yt(Ce,"candy_main_orders",j),{...Fr});for(const ge of Sr){const it=await Ht(sr(Ct(Ce,"inventory_candies"),cr("orderId","==",j),cr("productId","==",ge.id))),Pt=Math.max(1,Hn(ge.unitsPerPackage||1)),wt=Hn(ge.packages)*Pt,Nt=Math.min(Hn(ge.remainingPackages??ge.packages),Hn(ge.packages)),It=Math.max(0,Nt*Pt);if(it.empty)await Gn(Ct(Ce,"inventory_candies"),{productId:ge.id,productName:ge.name,category:ge.category,measurement:"unidad",quantity:wt,remaining:It,packages:Hn(ge.packages),remainingPackages:Nt,unitsPerPackage:Pt,totalUnits:wt,providerPrice:ge.providerPrice,subtotal:ge.subtotal,totalRivas:ge.totalRivas,totalSanJorge:ge.totalSanJorge,totalIsla:ge.totalIsla,gainRivas:ge.gainRivas,gainSanJorge:ge.gainSanJorge,gainIsla:ge.gainIsla,unitPriceRivas:ge.unitPriceRivas,unitPriceSanJorge:ge.unitPriceSanJorge,unitPriceIsla:ge.unitPriceIsla,date:xr,createdAt:yr.now(),status:"PENDIENTE",orderId:j});else for(const qt of it.docs)await kn(Yt(Ce,"inventory_candies",qt.id),{productName:ge.name,category:ge.category,unitsPerPackage:Pt,totalUnits:wt,quantity:wt,remaining:It,packages:Hn(ge.packages),remainingPackages:Nt,providerPrice:ge.providerPrice,subtotal:ge.subtotal,totalRivas:ge.totalRivas,totalSanJorge:ge.totalSanJorge,totalIsla:ge.totalIsla,gainRivas:ge.gainRivas,gainSanJorge:ge.gainSanJorge,gainIsla:ge.gainIsla,unitPriceRivas:ge.unitPriceRivas,unitPriceSanJorge:ge.unitPriceSanJorge,unitPriceIsla:ge.unitPriceIsla,date:xr})}const nt=await Ht(sr(Ct(Ce,"inventory_candies"),cr("orderId","==",j))),lt=new Set(Sr.map(ge=>ge.id));for(const ge of nt.docs){const it=ge.data(),Pt=String(it.productId||"");Pt&&!lt.has(Pt)&&await Wn(Yt(Ce,"inventory_candies",ge.id))}v(ge=>ge.map(it=>it.id===j?{...it,name:Fr.name,date:Fr.date,totalPackages:Fr.totalPackages,subtotal:Fr.subtotal,totalRivas:Fr.totalRivas,totalSanJorge:Fr.totalSanJorge,totalIsla:Fr.totalIsla,marginRivas:Fr.marginRivas,marginSanJorge:Fr.marginSanJorge,marginIsla:Fr.marginIsla,logisticsCost:Fr.logisticsCost}:it)),n(" Orden maestra actualizada (pedido + inventario)."),Le(),I(!1),e();return}const he=(await Gn(Ct(Ce,"candy_main_orders"),{...Fr,createdAt:yr.now()})).id,tt=Ic(Ce);for(const nt of Sr){const lt=Math.max(1,Hn(nt.unitsPerPackage||1)),ge=Hn(nt.packages)*lt,it=Math.min(Hn(nt.remainingPackages??nt.packages),Hn(nt.packages)),Pt=Math.max(0,it*lt),wt=Yt(Ct(Ce,"inventory_candies"));tt.set(wt,{productId:nt.id,productName:nt.name,category:nt.category,measurement:"unidad",quantity:ge,remaining:Pt,packages:Hn(nt.packages),remainingPackages:it,unitsPerPackage:lt,totalUnits:ge,providerPrice:nt.providerPrice,subtotal:nt.subtotal,totalRivas:nt.totalRivas,totalSanJorge:nt.totalSanJorge,totalIsla:nt.totalIsla,gainRivas:nt.gainRivas,gainSanJorge:nt.gainSanJorge,gainIsla:nt.gainIsla,unitPriceRivas:nt.unitPriceRivas,unitPriceSanJorge:nt.unitPriceSanJorge,unitPriceIsla:nt.unitPriceIsla,date:xr,createdAt:yr.now(),status:"PENDIENTE",orderId:he})}await tt.commit(),n(" Orden maestra creada y registrada en inventario."),Le(),I(!1),e()}catch(Bt){console.error(Bt),n(" Error al guardar orden maestra.")}finally{l(!1)}},kr=async He=>{try{s(!0),n(""),C(He.id),E(He.name),k(He.date),P(String(He.marginRivas??20)),ce(String(He.marginSanJorge??15)),le(String(He.marginIsla??30));const Bt=Number(He.logisticsCost??0);ae(String(Bt||0)),Me("DATOS");const xr=Yt(Ce,"candy_main_orders",He.id),dn=await gs(xr);if(!dn.exists()){n(" No se encontr la orden.");return}const Jr=dn.data(),br=Array.isArray(Jr.items)?Jr.items:[],er=await Ht(sr(Ct(Ce,"inventory_candies"),cr("orderId","==",He.id))),ir={};er.forEach(vr=>{const Fr=vr.data(),jn=String(Fr.productId||"");if(!jn)return;const he=SG(Fr);ir[jn]=(ir[jn]||0)+he});const Sr=br.map(vr=>{const Fr=A.find(it=>it.id===vr.id),jn=Number((Fr==null?void 0:Fr.providerPrice)??vr.providerPrice??0),he=Math.max(1,Hn((Fr==null?void 0:Fr.unitsPerPackage)??vr.unitsPerPackage??1)),tt=Number(vr.marginRivas??0),nt=Number(vr.marginSanJorge??Number(G||0)),lt=Number(vr.marginIsla??0),ge=ip(jn,Hn(vr.packages||0),{marginR:tt,marginSJ:nt,marginIsla:lt});return{...vr,name:String((Fr==null?void 0:Fr.name)??vr.name??"").trim(),category:String((Fr==null?void 0:Fr.category)??vr.category??"Caramelo").trim(),providerPrice:jn,unitsPerPackage:he,remainingPackages:ir[vr.id]??vr.remainingPackages??vr.packages??0,...ge}});De(Sr),I(!0)}catch(Bt){console.error(Bt),n(" Error al abrir orden maestra.")}finally{s(!1)}},Zr=async He=>{if(confirm(`Eliminar la orden "${He.name}" y todo su inventario asociado?`)){n("");try{const xr=await Ht(sr(Ct(Ce,"inventory_candies"),cr("orderId","==",He.id)));for(const dn of xr.docs)await Wn(Yt(Ce,"inventory_candies",dn.id));await Wn(Yt(Ce,"candy_main_orders",He.id)),v(dn=>dn.filter(Jr=>Jr.id!==He.id)),n(" Orden maestra eliminada."),e()}catch(xr){console.error(xr),n(" Error al eliminar orden maestra.")}}},nn=async()=>{if(!c)try{u(!0),n("");const He=await Ht(Ct(Ce,"candy_main_orders"));let Bt=Ic(Ce),xr=0,dn=0;const Jr=(br,er)=>Math.abs(Number(br||0)-Number(er||0))>.01;He.forEach(br=>{const er=br.data(),ir=Array.isArray(er.items)?er.items:[];if(!ir.length)return;const Sr=ir.reduce((nt,lt)=>nt+Number(lt.subtotal||0),0);let vr=Number(er.logisticsCost??er.gastosLogisticos??er.gastos??0);if(Number.isFinite(vr)||(vr=0),!vr){const nt=ir.reduce((lt,ge)=>lt+Number(ge.logisticAllocated??0),0);vr=Number(nt||0)}const Fr=ir.map(nt=>lT(nt,vr,Sr)),jn=Fr.reduce((nt,lt)=>nt+Number(lt.grossProfit||0),0);if(!(Jr(er.logisticsCost,vr)||Jr(er.uBrutaGlobal,jn)||Fr.some((nt,lt)=>{const ge=ir[lt]||{};return Jr(ge.logisticAllocated,nt.logisticAllocated)||Jr(ge.grossProfit,nt.grossProfit)||Jr(ge.grossProfitIsla,nt.grossProfitIsla)})))return;const tt=Yt(Ce,"candy_main_orders",br.id);Bt.update(tt,{logisticsCost:vr,uBrutaGlobal:jn,items:Fr,updatedAt:yr.now()}),xr+=1,dn+=1,xr>=400&&(Bt.commit(),Bt=Ic(Ce),xr=0)}),xr>0&&await Bt.commit(),n(` Ordenes maestras actualizadas: ${dn}`),e()}catch(He){console.error(He),n(" Error actualizando prorrateo de rdenes maestras.")}finally{u(!1)}},_r=async()=>{if(j&&!d)try{f(!0),n("");const He=await yF(j);He.created>0||He.updated>0?n(` Inventario listo: ${He.created} creados, ${He.updated} reparados (de ${He.totalItems}).`):He.totalItems>0?n(" No haba inventario faltante para crear o reparar."):n(" La orden no tiene items para crear inventario."),e()}catch(He){console.error(He),n(" Error creando inventario faltante.")}finally{f(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"})}),i.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[i.jsx("div",{}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Mc,{onClick:e,loading:a||m}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-gray-200 text-gray-800 px-2 md:px-3 py-2 rounded-2xl hover:bg-gray-300 disabled:opacity-60",onClick:nn,disabled:c,children:c?"Actualizando prorrateo...":"Actualizar prorrateo"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-2 md:px-3 py-2 rounded-2xl hover:bg-indigo-700 w-full md:w-auto max-w-[220px] justify-center",onClick:()=>{Le(),I(!0)},children:[i.jsx("span",{className:"items-center gap-4 inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Orden"]})]})]}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]}),w&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"relative bg-white p-4 md:p-6 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[o&&i.jsx("div",{className:"absolute inset-0 bg-white/70 z-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white border rounded-xl px-4 py-3 shadow flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-semibold",children:"Guardando orden"})]})}),i.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-3 border-b",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h3",{className:"text-lg md:text-xl font-bold",children:j?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[j&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",disabled:o||d,onClick:_r,children:d?"Creando inventario...":"Crear inventario faltante"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:o,onClick:()=>{Le(),I(!1)},children:"Cerrar"})]})]}),i.jsx("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-1 gap-2",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold",children:"Gastos logsticos (orden)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:Ae,onChange:He=>ae(He.target.value),placeholder:"0",min:0})]})}),i.jsx("div",{className:"md:hidden mt-3",children:i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[i.jsx("button",{type:"button",onClick:()=>Me("DATOS"),className:`px-2 py-2 rounded text-xs font-semibold border ${de==="DATOS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Datos"}),i.jsx("button",{type:"button",onClick:()=>Me("AGREGAR"),className:`px-2 py-2 rounded text-xs font-semibold border ${de==="AGREGAR"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Agregar"}),i.jsxs("button",{type:"button",onClick:()=>Me("ITEMS"),className:`px-2 py-2 rounded text-xs font-semibold border ${de==="ITEMS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:["Items (",_e.length,")"]}),i.jsx("button",{type:"button",onClick:()=>Me("TOTALES"),className:`px-2 py-2 rounded text-xs font-semibold border ${de==="TOTALES"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Totales"})]})})]}),i.jsxs("form",{onSubmit:or,className:"space-y-4 pt-4",children:[i.jsx("input",{ref:st,type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:Ir}),i.jsx("div",{className:`${de==="DATOS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:S,onChange:He=>E(He.target.value),placeholder:"Ej: Pedido enero 19"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:He=>k(He.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:T,onChange:He=>P(He.target.value)})]}),i.jsx("input",{type:"hidden",value:G,readOnly:!0}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:ue,onChange:He=>le(He.target.value)})]})]})}),i.jsx("div",{className:`${de==="AGREGAR"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:ht,onChange:He=>{Oe(He.target.value),We("")},disabled:m,children:ke.length===0?i.jsx("option",{value:"",children:m?"Cargando...":"No hay categoras en catlogo"}):ke.map(He=>i.jsx("option",{value:He,children:He},He))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ie,onChange:He=>We(He.target.value),children:[i.jsx("option",{value:"",children:m?"Cargando catlogo...":"Selecciona producto"}),pe.map(He=>i.jsx("option",{value:He.id,children:He.name},He.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:Z,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:ie,onChange:He=>xe(He.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:at,readOnly:!0})]})]}),i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-end gap-2 mt-3",children:i.jsx("button",{type:"button",onClick:ft,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto"})})]})}),i.jsxs("div",{className:"hidden md:flex items-center justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:Ue,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",title:"Descarga plantilla (Productos + Config)",children:"Descargar plantilla"}),i.jsx("button",{type:"button",onClick:nr,disabled:_t,className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",title:"Importa desde Excel (Productos + Config)",children:_t?"Importando...":"Importar Excel"}),i.jsx("button",{type:"button",onClick:rt,className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",title:"Exporta la orden actual (Productos + Resumen)",children:"Exportar Excel"})]}),i.jsx("div",{className:`${de==="ITEMS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"mb-2 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Items:"," ",i.jsx("span",{className:"font-semibold",children:_e.length}),me.trim()?i.jsxs(i.Fragment,{children:[" "," Mostrando"," ",i.jsx("span",{className:"font-semibold",children:re.length})]}):null]}),i.jsx("input",{value:me,onChange:He=>we(He.target.value),placeholder:"Buscar producto o categora",className:"w-full md:w-80 border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsx("div",{className:"overflow-x-auto border rounded pb-5",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2",children:"Categora"}),i.jsx("th",{className:"text-left p-2",children:"Producto"}),i.jsx("th",{className:"text-right p-2",children:"Paquetes"}),i.jsx("th",{className:"text-right p-2",children:"Restantes"}),i.jsx("th",{className:"text-right p-2",children:"Und x Paq"}),i.jsx("th",{className:"text-right p-2",children:"Precio prov"}),i.jsx("th",{className:"text-right p-2",children:"Facturado"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Isla"}),i.jsx("th",{className:"text-right p-2",children:"MV Rivas"}),i.jsx("th",{className:"text-right p-2",children:"MV Isla"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Rivas"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Isla"}),i.jsx("th",{className:"text-right p-2",children:"Prorrateo"}),i.jsx("th",{className:"text-right p-2",children:"Precio Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Precio Isla"}),i.jsx("th",{className:"text-center p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[ye.map(He=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:He.category}),i.jsx("td",{className:"p-2 font-semibold",children:He.name}),i.jsx("td",{className:"p-2 text-right",children:O[He.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:He.packages,onChange:Bt=>ct(He.id,"packages",Bt.target.value),onBlur:()=>je(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&je(He.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:He.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Fe(He.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:X[He.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Hn(He.remainingPackages??He.packages),onChange:Bt=>ct(He.id,"remainingPackages",Bt.target.value),onBlur:()=>Et(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Et(He.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Hn(He.remainingPackages??He.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ut(He.id),"aria-label":"Editar paquetes restantes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:K[He.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:He.unitsPerPackage,onChange:Bt=>ct(He.id,"unitsPerPackage",Bt.target.value),onBlur:()=>Ze(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ze(He.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:He.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Se(He.id),"aria-label":"Editar unidades por paquete",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(He.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(He.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(He.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(He.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:U[He.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(He.marginRivas??0),onChange:Bt=>ct(He.id,"marginRivas",Bt.target.value),onBlur:()=>Re(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Re(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(He.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Tt(He.id),"aria-label":"Editar margen Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:se[He.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(He.marginIsla??0),onChange:Bt=>ct(He.id,"marginIsla",Bt.target.value),onBlur:()=>Ye(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ye(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(He.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Te(He.id),"aria-label":"Editar margen Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(He.grossProfit||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(He.grossProfitIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(He.logisticAllocated||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:D[He.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(He.unitPriceRivas||0),onChange:Bt=>ct(He.id,"unitPriceRivas",Bt.target.value),onBlur:()=>Ft(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ft(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(He.unitPriceRivas||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>St(He.id),"aria-label":"Editar precio Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:te[He.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(He.unitPriceIsla||0),onChange:Bt=>ct(He.id,"unitPriceIsla",Bt.target.value),onBlur:()=>Ut(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ut(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(He.unitPriceIsla||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Qt(He.id),"aria-label":"Editar precio Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>At(He.id),children:"Quitar"})})]},He.id)),re.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center text-gray-500",children:"No hay productos en la orden."})})]})]})}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando"," ",Math.min((V-1)*fe+1,re.length),"-",Math.min(V*fe,re.length)," ","de ",re.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:V<=1,onClick:()=>L(He=>Math.max(1,He-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[V," / ",Be]}),i.jsx("button",{type:"button",disabled:V>=Be,onClick:()=>L(He=>Math.min(Be,He+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]}),i.jsx("div",{className:"md:hidden space-y-3",children:re.length===0?i.jsx("div",{className:"p-4 border rounded bg-gray-50 text-gray-600",children:"No hay productos en esta orden."}):re.map(He=>i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-base leading-tight truncate",children:He.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:He.category})]}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>At(He.id),children:"Quitar"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),O[He.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:He.packages,onChange:Bt=>ct(He.id,"packages",Bt.target.value),onBlur:()=>je(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&je(He.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:He.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Fe(He.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes restantes"}),X[He.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Hn(He.remainingPackages??He.packages),onChange:Bt=>ct(He.id,"remainingPackages",Bt.target.value),onBlur:()=>Et(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Et(He.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Hn(He.remainingPackages??He.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ut(He.id),"aria-label":"Editar paquetes restantes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Und x Paquete"}),K[He.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:He.unitsPerPackage,onChange:Bt=>ct(He.id,"unitsPerPackage",Bt.target.value),onBlur:()=>Ze(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ze(He.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:He.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Se(He.id),"aria-label":"Editar unidades por paquete",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Number(He.providerPrice||0).toFixed(2),readOnly:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Rivas (%)"}),U[He.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:He.marginRivas??0,onChange:Bt=>ct(He.id,"marginRivas",Bt.target.value),onBlur:()=>Re(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Re(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(He.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Tt(He.id),"aria-label":"Editar margen Rivas",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Isla (%)"}),se[He.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:He.marginIsla??0,onChange:Bt=>ct(He.id,"marginIsla",Bt.target.value),onBlur:()=>Ye(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ye(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(He.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Te(He.id),"aria-label":"Editar margen Isla",children:""})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Facturado"}),i.jsx("div",{className:"font-semibold",children:Number(He.subtotal||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(He.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(He.totalIsla||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prorrateo logstico"}),i.jsx("div",{className:"font-semibold",children:Number(He.logisticAllocated||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(He.grossProfit||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Isla"}),i.jsx("div",{className:"font-semibold",children:Number(He.grossProfitIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Rivas (paq)"}),D[He.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(He.unitPriceRivas||0),onChange:Bt=>ct(He.id,"unitPriceRivas",Bt.target.value),onBlur:()=>Ft(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ft(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:He.unitPriceRivas}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>St(He.id),"aria-label":"Editar precio Rivas",children:""})]})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Isla (paq)"}),te[He.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(He.unitPriceIsla||0),onChange:Bt=>ct(He.id,"unitPriceIsla",Bt.target.value),onBlur:()=>Ut(He.id),onKeyDown:Bt=>{(Bt.key==="Enter"||Bt.key==="Escape")&&Ut(He.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:He.unitPriceIsla}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Qt(He.id),"aria-label":"Editar precio Isla",children:""})]})]})]})]},He.id))})]})}),i.jsxs("div",{className:`${de==="TOTALES"?"block":"hidden"} md:block`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"text-lg font-semibold",children:ne.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (facturado)"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.subtotalCosto||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado (Rivas / Isla)"}),i.jsxs("div",{className:"text-sm font-semibold",children:["Rivas: ",Number(ne.esperadoRivas||0).toFixed(2),i.jsx("br",{}),"Isla: ",Number(ne.esperadoIsla||0).toFixed(2)]})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos logsticos"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.gastosLogisticos||0).toFixed(2)})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Rivas"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.utilidadBrutaRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Isla"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.utilidadBrutaIsla||0).toFixed(2)})]})]}),i.jsx("div",{className:"mt-3 border rounded p-3 bg-white",children:i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:rt,disabled:!z.items.length,title:"Exporta la orden actual (productos + resumen)",children:"Exportar orden a Excel"})})})]})]}),i.jsxs("div",{className:"sticky bottom-0 bg-white pt-3 mt-4 border-t",children:[i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:Le,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{Le(),I(!1)},className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:o||_e.length===0,children:o?"Guardando...":"Guardar orden"})]}),i.jsx("div",{className:"md:hidden mt-2",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>{Me(de==="DATOS"&&!j?"AGREGAR":de==="DATOS"||de==="AGREGAR"?"ITEMS":de==="ITEMS"?"TOTALES":"DATOS")},children:"Siguiente"})})]})]})]})}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"md:hidden space-y-3",children:a?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Cargando"}):x.length===0?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Sin ordenes maestras."}):x.map(He=>{const Bt=y[He.id],xr=Qr(He),dn=He.totalPackages>0?(He.subtotal/He.totalPackages).toFixed(2):"0.00",Jr=Number(He.logisticsCost||0),br=Number(He.totalRivas||0)-Number(He.subtotal||0);return i.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-xs text-gray-500",children:xr}),i.jsx("div",{className:"font-semibold text-base leading-tight",children:He.name})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-xs",onClick:()=>kr(He),children:"Ver"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>Zr(He),children:"Borrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:He.totalPackages})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:Bt?Bt.remainingPackages:0})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Proveedor"}),i.jsx("div",{className:"font-semibold",children:dn})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),i.jsx("div",{className:"font-semibold",children:Number(He.subtotal||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(He.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(He.totalIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Gastos log."}),i.jsx("div",{className:"font-semibold",children:Jr.toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta (est)"}),i.jsx("div",{className:"font-semibold",children:br.toFixed(2)})]})]})]},He.id)})}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Esperado Rivas"}),i.jsx("th",{className:"p-2 border",children:"Esperado Isla"}),i.jsx("th",{className:"p-2 border",children:"Gastos log."}),i.jsx("th",{className:"p-2 border",children:"U. Bruta (est)"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin ordenes maestras."})}):Vt.map(He=>{const Bt=y[He.id],xr=Qr(He),dn=He.totalPackages>0?(He.subtotal/He.totalPackages).toFixed(2):"0.00",Jr=Number(He.logisticsCost||0),br=Number(He.totalRivas||0)-Number(He.subtotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:xr}),i.jsx("td",{className:"p-2 border text-left",children:He.name}),i.jsx("td",{className:"p-2 border",children:He.totalPackages}),i.jsx("td",{className:"p-2 border",children:Bt?Bt.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:dn}),i.jsx("td",{className:"p-2 border",children:Number(He.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(He.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(He.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Jr.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:br.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>kr(He),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Zr(He),children:"Borrar"})]})})]},He.id)})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",Math.min((pt-1)*bt+1,x.length),"-",Math.min(pt*bt,x.length)," de ",x.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:pt<=1,onClick:()=>vt(He=>Math.max(1,He-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[pt," / ",kt]}),i.jsx("button",{type:"button",disabled:pt>=kt,onClick:()=>vt(He=>Math.min(kt,He+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]})]})]})}const N0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function cT(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),a=r*e,s=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),u=a*(1+o/100),d=a*(1+l/100),f=a*(1+c/100),A=u-a,h=d-a,m=f-a,p=u/s,x=d/s,v=f/s;return{...t,subtotal:Number(a.toFixed(2)),totalRivas:Number(u.toFixed(2)),totalSanJorge:Number(d.toFixed(2)),totalIsla:Number(f.toFixed(2)),gainRivas:Number(A.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(v.toFixed(2))}}function jG(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function Xc(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function uT(t){const{margin:e,gain:r,subtotal:n,orderMargin:a}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const s=Number(n||0),o=Number(r);return Number.isFinite(o)&&s>0?o/s*100:Number(a||0)}function hVe(){var R,X,Y;const[t,e]=g.useState([]),[r,n]=g.useState({}),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Lr(Qd(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Lr(Ud(new Date),"yyyy-MM-dd")),[A,h]=g.useState(!1),[m,p]=g.useState(!1),[x,v]=g.useState(null),[y,b]=g.useState([]),[w,I]=g.useState(0),[j,C]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(""),[T,P]=g.useState(""),[G,ce]=g.useState(0),[ue,le]=g.useState(0),[Ae,ae]=g.useState(1);g.useEffect(()=>{(async()=>{try{s(!0),l("");const D=sr(Ct(Ce,"candy_main_orders"),Sn("createdAt","desc")),Q=await Ht(D),te=[];Q.forEach(Xe=>{const se=Xe.data();te.push({id:Xe.id,name:se.name??"",date:se.date??"",totalPackages:Number(se.totalPackages??0),subtotal:Number(se.subtotal??0),totalRivas:Number(se.totalRivas??0),totalSanJorge:Number(se.totalSanJorge??0),totalIsla:Number(se.totalIsla??0),marginRivas:Number(se.marginRivas??0),marginSanJorge:Number(se.marginSanJorge??0),marginIsla:Number(se.marginIsla??0),createdAt:se.createdAt??yr.now()})}),e(te);const be=await Ht(sr(Ct(Ce,"inventory_candies"))),U={};be.forEach(Xe=>{const se=Xe.data(),ee=se.orderId;if(!ee)return;const Fe=Number(se.unitsPerPackage||1)||1,je=Number(se.totalUnits??(se.packages||0)*Fe),Se=Math.round(je/Fe),Ze=Number(se.remaining??se.totalUnits??je),ut=Number(se.remainingPackages??NaN),Et=Number.isFinite(ut)?Math.round(ut):Math.round(Ze/Fe);U[ee]||(U[ee]={orderId:ee,totalPackages:0,remainingPackages:0}),U[ee].totalPackages+=Se,U[ee].remainingPackages+=Et}),n(U)}catch(D){console.error(D),l(" Error cargando inventario de pedidos.")}finally{s(!1)}})()},[]);const _e=g.useMemo(()=>t.filter(D=>{var te;const Q=D.date||((te=D.createdAt)!=null&&te.toDate?D.createdAt.toDate().toISOString().slice(0,10):"");return!(!Q||c&&Q<c||d&&Q>d)}),[t,c,d]),De=g.useMemo(()=>{let D=0,Q=0,te=0,be=0,U=0,Xe=0;for(const se of _e){D+=se.totalPackages,Q+=se.subtotal,te+=se.totalRivas,be+=se.totalSanJorge,U+=se.totalIsla;const ee=r[se.id];ee&&(Xe+=ee.remainingPackages)}return{totalPaquetes:D,totalSubtotal:Q,totalRivas:te,totalSJ:be,totalIsla:U,totalPaquetesRestantes:Xe,totalPedidos:_e.length}},[_e,r]),O=async(D,Q,te)=>{if(!x)return;const be=Number(te||0),U=y.map(ee=>ee.id!==D?ee:cT({...ee,[Q]:be}));b(U);const Xe=U.find(ee=>ee.id===D);if(!Xe)return;const se=jG(U);try{await kn(Yt(Ce,"products_candies",D),{marginRivas:Xe.marginRivas,marginSanJorge:Xe.marginSanJorge,marginIsla:Xe.marginIsla,subtotal:Xe.subtotal,totalRivas:Xe.totalRivas,totalSanJorge:Xe.totalSanJorge,totalIsla:Xe.totalIsla,unitPriceRivas:Xe.unitPriceRivas,unitPriceSanJorge:Xe.unitPriceSanJorge,unitPriceIsla:Xe.unitPriceIsla,gainRivas:Xe.gainRivas,gainSanJorge:Xe.gainSanJorge,gainIsla:Xe.gainIsla}),await kn(Yt(Ce,"candy_main_orders",x.id),{totalPackages:se.totalPackages,subtotal:Number(se.subtotal.toFixed(2)),totalRivas:Number(se.totalRivas.toFixed(2)),totalSanJorge:Number(se.totalSanJorge.toFixed(2)),totalIsla:Number(se.totalIsla.toFixed(2))}),v(ee=>ee&&{...ee,totalPackages:se.totalPackages,subtotal:Number(se.subtotal.toFixed(2)),totalRivas:Number(se.totalRivas.toFixed(2)),totalSanJorge:Number(se.totalSanJorge.toFixed(2)),totalIsla:Number(se.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(ee){console.error(ee),l(" Error actualizando mrgenes del producto.")}},H=async()=>{if(x)try{l("");const D=Number.isFinite(w)&&w!==0?w:x.marginRivas||0,Q=Number.isFinite(j)&&j!==0?j:x.marginSanJorge||0,te=Number.isFinite(S)&&S!==0?S:x.marginIsla||0,be=cT({id:"tmp",name:B.trim(),category:T.trim(),providerPrice:Number(G||0),packages:Number(ue||0),unitsPerPackage:Number(Ae||1),marginRivas:Number(D||0),marginSanJorge:Number(Q||0),marginIsla:Number(te||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ue||0)}),U=await Gn(Ct(Ce,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:be.name,category:be.category,providerPrice:be.providerPrice,packages:be.packages,unitsPerPackage:be.unitsPerPackage,marginRivas:be.marginRivas,marginSanJorge:be.marginSanJorge,marginIsla:be.marginIsla,gainRivas:be.gainRivas,gainSanJorge:be.gainSanJorge,gainIsla:be.gainIsla,subtotal:be.subtotal,totalRivas:be.totalRivas,totalSanJorge:be.totalSanJorge,totalIsla:be.totalIsla,unitPriceRivas:be.unitPriceRivas,unitPriceSanJorge:be.unitPriceSanJorge,unitPriceIsla:be.unitPriceIsla,createdAt:yr.now()}),se=[{...be,id:U.id},...y];b(se);const ee=jG(se);await kn(Yt(Ce,"candy_main_orders",x.id),{totalPackages:ee.totalPackages,subtotal:Number(ee.subtotal.toFixed(2)),totalRivas:Number(ee.totalRivas.toFixed(2)),totalSanJorge:Number(ee.totalSanJorge.toFixed(2)),totalIsla:Number(ee.totalIsla.toFixed(2))}),v(Fe=>Fe&&{...Fe,totalPackages:ee.totalPackages,subtotal:Number(ee.subtotal.toFixed(2)),totalRivas:Number(ee.totalRivas.toFixed(2)),totalSanJorge:Number(ee.totalSanJorge.toFixed(2)),totalIsla:Number(ee.totalIsla.toFixed(2))}),I(0),C(0),E(0),k(""),P(""),ce(0),le(0),ae(1),l(" Producto agregado con mrgenes por sucursal.")}catch(D){console.error(D),l(" Error agregando producto al pedido.")}},K=async D=>{try{v(D),b([]),h(!0),p(!0),l("");const Q=await Ht(sr(Ct(Ce,"inventory_candies"),cr("orderId","==",D.id))),te={};Q.forEach(Xe=>{const se=Xe.data(),ee=se.productId;if(!ee)return;const Fe=Number(se.unitsPerPackage||1)||1,je=Number(se.remaining??se.totalUnits??0),Se=Number(se.remainingPackages??NaN),Ze=Number.isFinite(Se)?Math.round(Se):Math.round(je/Fe);te[ee]=(te[ee]||0)+Ze});const be=await Ht(sr(Ct(Ce,"products_candies"),cr("orderId","==",D.id))),U=[];be.forEach(Xe=>{const se=Xe.data(),ee=Xc(se.providerPrice,0),Fe=Xc(se.packages,0),je=se.subtotal??ee*Fe,Se=uT({margin:se.marginRivas,gain:se.gainRivas,subtotal:je,orderMargin:D.marginRivas||0}),Ze=uT({margin:se.marginSanJorge,gain:se.gainSanJorge,subtotal:je,orderMargin:D.marginSanJorge||0}),ut=uT({margin:se.marginIsla,gain:se.gainIsla,subtotal:je,orderMargin:D.marginIsla||0}),Et=cT({id:Xe.id,name:se.name??"",category:se.category??"",providerPrice:ee,packages:Fe,unitsPerPackage:Xc(se.unitsPerPackage,1),marginRivas:Number(Se||0),marginSanJorge:Number(Ze||0),marginIsla:Number(ut||0),subtotal:Xc(se.subtotal,0),totalRivas:Xc(se.totalRivas,0),totalSanJorge:Xc(se.totalSanJorge,0),totalIsla:Xc(se.totalIsla,0),gainRivas:Xc(se.gainRivas,0),gainSanJorge:Xc(se.gainSanJorge,0),gainIsla:Xc(se.gainIsla,0),unitPriceRivas:Xc(se.unitPriceRivas,0),unitPriceSanJorge:Xc(se.unitPriceSanJorge,0),unitPriceIsla:Xc(se.unitPriceIsla,0),remainingPackages:te[Xe.id]??Xc(se.packages,0)});U.push(Et)}),b(U)}catch(Q){console.error(Q),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:D=>f(D.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:De.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",De.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",De.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",N0(De.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",N0(De.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",N0(De.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",N0(De.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):_e.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):_e.map(D=>{var se;const Q=D.totalPackages>0?Math.round(D.totalRivas/D.totalPackages):0,te=D.totalPackages>0?Math.round(D.totalSanJorge/D.totalPackages):0,be=D.totalPackages>0?Math.round(D.totalIsla/D.totalPackages):0,U=D.date||((se=D.createdAt)!=null&&se.toDate?D.createdAt.toDate().toISOString().slice(0,10):""),Xe=r[D.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:U}),i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.totalPackages}),i.jsx("td",{className:"p-2 border",children:Xe?Xe.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Q}),i.jsx("td",{className:"p-2 border",children:te}),i.jsx("td",{className:"p-2 border",children:be}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>K(D),children:"Ver pedido"})})]},D.id)})})]})}),A&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),v(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((R=x.createdAt)!=null&&R.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((X=r[x.id])==null?void 0:X.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((Y=r[x.id])==null?void 0:Y.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:N0(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:N0(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:N0(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:N0(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:w,onChange:D=>I(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:j,onChange:D=>C(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:S,onChange:D=>E(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:B,onChange:D=>k(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:T,onChange:D=>P(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:G,onChange:D=>ce(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ue,onChange:D=>le(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:Ae,onChange:D=>ae(Number(D.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:H,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(D=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.category}),i.jsx("td",{className:"p-2 border",children:D.packages}),i.jsx("td",{className:"p-2 border",children:D.remainingPackages??D.packages}),i.jsx("td",{className:"p-2 border",children:D.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:D.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginRivas??0,onChange:Q=>O(D.id,"marginRivas",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginSanJorge??0,onChange:Q=>O(D.id,"marginSanJorge",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginIsla??0,onChange:Q=>O(D.id,"marginIsla",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:D.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:D.unitPriceIsla})]},D.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!A&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const wa=t=>Math.round((Number(t)||0)*100)/100,op=t=>Math.round((Number(t)||0)*1e3)/1e3,Ra=t=>Number(t??0).toFixed(2),rf=t=>Number(t??0).toFixed(3),IG=t=>String(t??"").trim().toLowerCase();async function AVe(t){if(!t)return;const e=sr(Ct(Ce,"ar_movements"),cr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Wn(Yt(Ce,"ar_movements",n.id))))}const mVe=(t,e)=>{var v;const r=t.date??((v=t.timestamp)!=null&&v.toDate?Lr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,u=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((y,b)=>{const w=Number((y==null?void 0:y.packages)??(y==null?void 0:y.qty)??(y==null?void 0:y.quantity)??0),I=Number((y==null?void 0:y.lineFinal)??0)||Math.max(0,Number((y==null?void 0:y.unitPricePackage)||(y==null?void 0:y.unitPrice)||0)*w-Number((y==null?void 0:y.discount)||0));let j=0;c>0&&l>0&&Number(I||0)>0&&(j=wa(c*Number(I||0)/l));const C=Number((y==null?void 0:y.margenVendedor)??(y==null?void 0:y.uBruta)??(y==null?void 0:y.grossProfit)??0)||0,S=Number((y==null?void 0:y.prorrateo)??0)||0,E=Number((y==null?void 0:y.uBruta)??0)||0,B=wa(E-S-C);return{id:`${e}#${b}`,productName:String((y==null?void 0:y.productName)??"(sin nombre)"),quantity:w,amount:wa(I),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(y==null?void 0:y.allocations)?y.allocations:t.allocations,avgUnitCost:Number((y==null?void 0:y.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((y==null?void 0:y.cogsAmount)??0),type:s,vendorId:o,vendorCommissionAmount:j,vendorUtility:C,vendorNetUtility:B,commissionFromItems:Number((y==null?void 0:y.margenVendedor)??0)||0,processedDate:u||""}});const d=Number(t.packagesTotal??t.quantity??0),f=Number(t.amount??t.amountCharged??t.total??0)||0;let A=0;A=wa(Number(t.vendorCommissionAmount??0)||0);const h=Number(t.margenVendedor??t.uBruta??t.grossProfit??0)||0,m=Number(t.prorrateo??0)||0,p=Number(t.uBruta??0)||0,x=wa(p-m-h);return[{id:e,productName:t.productName??"(sin nombre)",quantity:d,amount:f,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:s,vendorId:o,vendorCommissionAmount:A,vendorUtility:h,vendorNetUtility:x,commissionFromItems:Number(t.margenVendedor??0)||0,processedDate:u||""}]};function pVe({role:t,currentUserEmail:e,sellerCandyId:r,roles:n}){const[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),m=Lr(new Date,"yyyy-MM-dd"),[p,x]=g.useState(m),[v,y]=g.useState(m),[b,w]=g.useState("ALL"),[I,j]=g.useState("ALL"),[C,S]=g.useState(null),[E,B]=g.useState(0),[k,T]=g.useState(0),[P,G]=g.useState(""),[ce,ue]=g.useState(0),[le,Ae]=g.useState("0"),[ae,_e]=g.useState(!1),[De,O]=g.useState(!1),[H,K]=g.useState(!1),[R,X]=g.useState(!1),[Y,D]=g.useState(!1),[Q,te]=g.useState(!1),be=g.useRef(null),U=n&&n.length?n:t,Xe=!U||En(U,"admin"),se=En(U,"vendedor_dulces"),ee=(e||"").trim().toLowerCase(),[Fe,je]=g.useState([]),[Se,Ze]=g.useState({}),[ut,Et]=g.useState({}),St=oi.useMemo(()=>{const L=new Set;return a.forEach(fe=>{const Be=(fe.productName||"").trim();Be&&L.add(Be)}),Array.from(L).sort((fe,Be)=>fe.localeCompare(Be))},[a]);g.useEffect(()=>{if(!p||!v)return;u(!0);const L=sr(Ct(Ce,"sales_candies"),cr("date",">=",p),cr("date","<=",v),Sn("date","asc")),fe=Pd(L,Be=>{const ye=[];Be.forEach($e=>{const ze=mVe($e.data(),$e.id);ye.push(...ze)}),s(ye),u(!1)},Be=>{console.error("Error cargando ventas por periodo:",Be),s([]),u(!1)});return()=>fe()},[p,v]),g.useEffect(()=>{(async()=>{const fe=sr(Ct(Ce,"daily_closures_candies"),cr("date","==",m)),Be=await Ht(fe);if(Be.empty)l(null);else{const ye=Be.docs[0];l({id:ye.id,...ye.data()})}})()},[m]),g.useEffect(()=>{(async()=>{try{const fe=await Ht(Ct(Ce,"sellers_candies")),Be=[];fe.forEach(ye=>{const $e=ye.data();Be.push({id:ye.id,name:$e.name||"",commissionPercent:Number($e.commissionPercent||0)})}),je(Be)}catch(fe){console.error("Error cargando sellers_candies",fe)}})()},[]),g.useEffect(()=>{(async()=>{try{const fe=await Ht(Ct(Ce,"products_candies")),Be={};fe.forEach(ye=>{const $e=ye.data(),ze=IG($e==null?void 0:$e.name);if(!ze)return;const Ke=String(($e==null?void 0:$e.category)||"").trim();Be[ze]=Ke||"(sin categora)"}),Ze(Be)}catch(fe){console.error("Error cargando products_candies",fe)}})()},[]);const Ft=L=>wa(Number(L.vendorCommissionAmount??0)||0),Qt=L=>wa(Number(L.vendorUtility??0)||0),Ut=L=>wa(Number(L.vendorNetUtility??0)||0),Tt=L=>wa(Number(L.commissionFromItems??0)||0),Re=oi.useMemo(()=>{let L=[...a];return A==="FLOTANTE"&&(L=L.filter(fe=>fe.status==="FLOTANTE")),A==="PROCESADA"&&(L=L.filter(fe=>fe.status==="PROCESADA")),I!=="ALL"&&(L=L.filter(fe=>(fe.productName||"").trim()===I)),Xe&&b!=="ALL"&&(L=L.filter(fe=>(fe.vendorId||"")===b)),se&&(r?L=L.filter(fe=>(fe.vendorId||"")===r):ee?L=L.filter(fe=>(fe.sellerEmail||"").toLowerCase()===ee):L=[]),L},[A,a,I,Xe,b,se,r,ee]),Te=oi.useMemo(()=>Re.filter(L=>L.type!=="CREDITO"),[Re]),Ye=oi.useMemo(()=>Re.filter(L=>L.type==="CREDITO"),[Re]),ht=oi.useMemo(()=>Re.filter(L=>L.status==="FLOTANTE").length,[Re]),Oe=oi.useMemo(()=>Re.filter(L=>L.status==="PROCESADA").length,[Re]),Ie=oi.useMemo(()=>Re.filter(L=>L.type==="CREDITO").length,[Re]),We=oi.useMemo(()=>Re.filter(L=>L.type!=="CREDITO").length,[Re]),Z=op(Re.reduce((L,fe)=>L+(fe.quantity||0),0)),Qe=wa(Re.reduce((L,fe)=>L+Number(fe.cogsAmount??0),0)),at=wa(Re.reduce((L,fe)=>L+(fe.amount||0),0)),Ge=wa(at-Qe);let ie=0,xe=0,de=0,Me=0,me=0,we=0,pt=0;Re.forEach(L=>{const fe=Number(L.amount||0),Be=Number(L.amountReceived||0),ye=Ft(L);me+=ye,L.type==="CREDITO"?(ie+=L.quantity||0,de+=fe-Be,pt+=ye):(xe+=L.quantity||0,Me+=fe,we+=ye)}),de=wa(de),Me=wa(Me),me=wa(me),we=wa(we),pt=wa(pt);const vt=oi.useMemo(()=>{const L={};for(const fe of Re){const Be=(fe.vendorId||"").trim();if(!Be||fe.type==="CREDITO")continue;const ye=Ft(fe);if(!L[Be]){const $e=Fe.find(ze=>ze.id===Be);L[Be]={vendorId:Be,name:($e==null?void 0:$e.name)||fe.userEmail||"(sin vendedor)",total:0}}L[Be].total=wa(L[Be].total+ye)}return Object.values(L).filter(fe=>fe.total>0).sort((fe,Be)=>Be.total-fe.total)},[Re,Fe]),bt=oi.useMemo(()=>{const L={};for(const fe of Re){const Be=(fe.vendorId||"").trim();if(!Be||fe.type!=="CREDITO")continue;const ye=Ft(fe);if(!L[Be]){const $e=Fe.find(ze=>ze.id===Be);L[Be]={vendorId:Be,name:($e==null?void 0:$e.name)||fe.userEmail||"(sin vendedor)",total:0}}L[Be].total=wa(L[Be].total+ye)}return Object.values(L).filter(fe=>fe.total>0).sort((fe,Be)=>Be.total-fe.total)},[Re,Fe]),kt={};Re.forEach(L=>{const fe=L.productName||"(sin nombre)";kt[fe]||(kt[fe]={totalQuantity:0,totalAmount:0,totalCommission:0}),kt[fe].totalQuantity=op(kt[fe].totalQuantity+(L.quantity||0)),kt[fe].totalAmount=wa(kt[fe].totalAmount+(L.amount||0)),kt[fe].totalCommission=wa(kt[fe].totalCommission+Ft(L))});const Vt=Object.entries(kt).map(([L,fe])=>({productName:L,category:Se[IG(L)]||"(sin categora)",totalQuantity:fe.totalQuantity,totalAmount:fe.totalAmount,totalCommission:fe.totalCommission})),ke=oi.useMemo(()=>{const L={};for(const fe of Vt){const Be=fe.category||"(sin categora)";L[Be]||(L[Be]={category:Be,rows:[],totalQuantity:0,totalAmount:0,totalCommission:0}),L[Be].rows.push(fe),L[Be].totalQuantity=op(L[Be].totalQuantity+(fe.totalQuantity||0)),L[Be].totalAmount=wa(L[Be].totalAmount+(fe.totalAmount||0)),L[Be].totalCommission=wa(L[Be].totalCommission+(fe.totalCommission||0))}return Object.values(L).map(fe=>({...fe,rows:[...fe.rows].sort((Be,ye)=>ye.totalAmount-Be.totalAmount)})).sort((fe,Be)=>Be.totalAmount-fe.totalAmount)},[Vt]),Ne=L=>{Et(fe=>({...fe,[L]:!fe[L]}))},pe=async()=>{if(Xe)try{const L=Re.filter(ne=>ne.status==="FLOTANTE");if(L.length===0){f("No hay ventas flotantes para procesar en este perodo.");return}const fe={totalCharged:wa(L.reduce((ne,Ue)=>ne+(Ue.amount||0),0)),totalSuggested:wa(L.reduce((ne,Ue)=>ne+(Ue.amountSuggested||0),0)),totalUnits:op(L.reduce((ne,Ue)=>ne+(Ue.quantity||0),0)),totalCOGS:wa(L.reduce((ne,Ue)=>ne+Number(Ue.cogsAmount??0),0))},Be=wa(fe.totalCharged-fe.totalSuggested),ye=wa(fe.totalCharged-fe.totalCOGS),$e=L.reduce((ne,Ue)=>{const rt=Number(Ue.quantity||0),st=Number(Ue.amount||0),_t=Number(Ue.vendorCommissionAmount||0);return Ue.type==="CREDITO"?(ne.packsCredit+=rt,ne.amountCredit+=st,ne.comCredit+=_t):(ne.packsCash+=rt,ne.amountCash+=st,ne.comCash+=_t),ne},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),ze={totalPacksCash:op($e.packsCash),totalPacksCredit:op($e.packsCredit),totalAmountCash:wa($e.amountCash),totalAmountCredit:wa($e.amountCredit),totalCommissionCash:wa($e.comCash),totalCommissionCredit:wa($e.comCredit)},Ke=await Gn(Ct(Ce,"daily_closures_candies"),{date:m,createdAt:yr.now(),periodStart:p,periodEnd:v,totalCharged:fe.totalCharged,totalSuggested:fe.totalSuggested,totalDifference:Be,totalUnits:fe.totalUnits,totalCOGS:fe.totalCOGS,grossProfit:ye,...ze,products:L.map(ne=>({productName:ne.productName,quantity:ne.quantity,amount:ne.amount})),sales:L.map(ne=>({id:ne.id,productName:ne.productName,quantity:ne.quantity,amount:ne.amount,amountSuggested:ne.amountSuggested,userEmail:ne.userEmail,clientName:ne.clientName,amountReceived:ne.amountReceived,change:ne.change,status:ne.status,cogsAmount:ne.cogsAmount??0,avgUnitCost:ne.avgUnitCost??null,allocations:ne.allocations??[],date:ne.date,type:ne.type??"CONTADO",vendorId:ne.vendorId??"",vendorCommissionAmount:Number(ne.vendorCommissionAmount??0)||0,processedDate:m})),productSummary:Object.entries(L.reduce((ne,Ue)=>{const rt=Ue.productName||"(sin nombre)";return ne[rt]||(ne[rt]={totalQuantity:0,totalAmount:0}),ne[rt].totalQuantity=op(ne[rt].totalQuantity+(Ue.quantity||0)),ne[rt].totalAmount=wa(ne[rt].totalAmount+(Ue.amount||0)),ne},{})).map(([ne,Ue])=>({productName:ne,totalQuantity:Ue.totalQuantity,totalAmount:Ue.totalAmount}))}),yt=Ic(Ce);L.forEach(ne=>{yt.update(Yt(Ce,"sales_candies",ne.id.split("#")[0]),{status:"PROCESADA",closureId:Ke.id,closureDate:m,processedDate:m,processedAt:yr.now()})}),await yt.commit(),f(` Cierre guardado. Ventas procesadas: ${L.length}. (Proceso: ${m})`)}catch(L){console.error(L),f(" Error al guardar el cierre de dulces.")}},Le=async L=>{if(Xe&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await kn(Yt(Ce,"sales_candies",L.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),f(" Venta revertida a FLOTANTE.")}catch(fe){console.error(fe),f(" No se pudo revertir la venta.")}},ft=L=>{Xe&&(S(L),B(L.quantity),T(L.amount),G(L.clientName),ue(L.amountReceived),Ae(L.change))},At=async()=>{if(!(!C||!Xe))try{await kn(Yt(Ce,"sales_candies",C.id.split("#")[0]),{packagesTotal:E,amount:k,amountCharged:k,clientName:P,amountReceived:ce,change:le}),S(null),f(" Venta de dulces actualizada.")}catch(L){console.error(L),f(" No se pudo actualizar la venta de dulces.")}},ct=async L=>{if(Xe&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const fe=L.split("#")[0],{restored:Be}=await FQe(fe);await AVe(fe),f(` Venta eliminada. Stock restaurado (unidades internas): ${Number(Be).toFixed(2)}. Estado de cuenta ajustado.`)}catch(fe){console.error(fe),f(" No se pudo eliminar la venta de dulces.")}},W=async()=>{if(be.current){be.current.classList.add("force-pdf-colors"),be.current.classList.add("pdf-print-mode");try{const fe=(await Hm(be.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Be=new rn;Be.addImage(fe,"PNG",10,10,190,0),Be.save(`cierre_dulces_${p}_a_${v}_proc_${m}.pdf`)}finally{be.current.classList.remove("pdf-print-mode"),be.current.classList.remove("force-pdf-colors")}}},z=L=>`"${String(L??"").replace(/\"/g,'""')}"`,re=()=>{const L=["id","productName","type","quantity","amount","commissionFromItems","vendorNetUtility","date","processedDate","vendor","status"],fe=Re.map(Ke=>[Ke.id,Ke.productName,Ke.type,Ke.quantity??0,Number(Ke.amount??0).toFixed(2),Number(Ke.commissionFromItems??0).toFixed(2),Number(Ke.vendorNetUtility??0).toFixed(2),Ke.date,Ke.processedDate??"",Ke.userEmail??"",Ke.status]),Be=[L.join(","),...fe.map(Ke=>Ke.map(z).join(","))].join(`
`),ye=new Blob([Be],{type:"text/csv;charset=utf-8;"}),$e=URL.createObjectURL(ye),ze=document.createElement("a");ze.href=$e,ze.download=`cierre_dulces_${p}_a_${v}.csv`,ze.click(),URL.revokeObjectURL($e)},V=()=>{const L=Re.map(yt=>({id:yt.id,productName:yt.productName,type:yt.type,quantity:yt.quantity??0,amount:Number(yt.amount??0).toFixed(2),commissionFromItems:Number(yt.commissionFromItems??0).toFixed(2),vendorNetUtility:Number(yt.vendorNetUtility??0).toFixed(2),date:yt.date,processedDate:yt.processedDate??"",vendor:yt.userEmail??"",status:yt.status})),fe=ha.json_to_sheet(L),Be=ha.book_new();ha.book_append_sheet(Be,fe,"Ventas");const ye=E1(Be,{bookType:"xlsx",type:"array"}),$e=new Blob([ye],{type:"application/octet-stream"}),ze=URL.createObjectURL($e),Ke=document.createElement("a");Ke.href=ze,Ke.download=`cierre_dulces_${p}_a_${v}.xlsx`,Ke.click(),URL.revokeObjectURL(ze)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
        .pdf-print-mode .collapsible-content { display: block !important; }
      `}),i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",m]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>_e(L=>!L),"aria-expanded":ae,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${ae?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${ae?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:p,onChange:L=>x(L.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:L=>y(L.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:L=>h(L.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),Xe&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:L=>w(L.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),Fe.map(L=>i.jsx("option",{value:L.id,children:L.name||L.id},L.id))]})]}),i.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[i.jsx("label",{className:"text-xs md:text-sm whitespace-nowrap",children:"Productos:"}),i.jsxs("select",{className:"border rounded px-2 py-1 text-xs w-full md:w-48 lg:w-56",value:I,onChange:L=>j(L.target.value),disabled:St.length===0,children:[i.jsx("option",{value:"ALL",children:"Todos"}),St.map(L=>i.jsx("option",{value:L,children:L},L))]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>O(L=>!L),"aria-expanded":De,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${De?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${De?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-7 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:ht}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:Oe}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Ie}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:We}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-2xl font-bold",children:rf(xe)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:rf(ie)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ra(we)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ra(pt)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>K(L=>!L),"aria-expanded":H,children:[i.jsx("span",{children:"KPIs por vendedor"}),i.jsx("span",{className:`transition-transform ${H?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${H?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),vt.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:vt.map(L=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:L.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ra(L.total)]})]},L.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),bt.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:bt.map(L=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:L.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ra(L.total)]})]},L.vendorId))})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:be,children:[i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>X(L=>!L),"aria-expanded":R,children:[i.jsx("span",{children:"Transacciones Cash"}),i.jsx("span",{className:`transition-transform ${R?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${R?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"U. Vendedor"}),i.jsx("th",{className:"border p-2",children:"U. Neta"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Te.map(L=>{Ft(L),Qt(L);const fe=(L.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})}),i.jsx("td",{className:"border p-1",children:L.productName}),i.jsx("td",{className:"border p-1",children:"Cash"}),i.jsx("td",{className:"border p-1",children:rf(L.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ra(L.amount)]}),i.jsx("td",{className:"border p-1",children:Tt(L)>0?`C$${Ra(Tt(L))}`:""}),i.jsx("td",{className:"border p-1",children:Ut(L)>0?`C$${Ra(Ut(L))}`:""}),i.jsx("td",{className:"border p-1",children:L.date}),i.jsx("td",{className:"border p-1",children:fe||""}),i.jsx("td",{className:"border p-1",children:L.userEmail}),i.jsx("td",{className:"border p-1",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ft(L),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ct(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},L.id)}),Te.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin ventas cash para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Te.map(L=>{const fe=Ft(L);Qt(L);const Be=(L.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:L.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Cash  ",L.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",Ra(L.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Tt(L)>0?`C$${Ra(Tt(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Neta"}),i.jsx("strong",{children:Ut(L)>0?`C$${Ra(Ut(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:fe>0?`C$${Ra(fe)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:Be||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:L.userEmail})]}),i.jsx("div",{className:"pt-2",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ft(L),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ct(L.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},L.id)}),Te.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas cash para mostrar."})]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(L=>!L),"aria-expanded":Y,children:[i.jsx("span",{children:"Transacciones Crdito"}),i.jsx("span",{className:`transition-transform ${Y?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${Y?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"U. Vendedor"}),i.jsx("th",{className:"border p-2",children:"U. Neta"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Ye.map(L=>{Ft(L),Qt(L);const fe=(L.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})}),i.jsx("td",{className:"border p-1",children:L.productName}),i.jsx("td",{className:"border p-1",children:"Crdito"}),i.jsx("td",{className:"border p-1",children:rf(L.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ra(L.amount)]}),i.jsx("td",{className:"border p-1",children:Tt(L)>0?`C$${Ra(Tt(L))}`:""}),i.jsx("td",{className:"border p-1",children:Ut(L)>0?`C$${Ra(Ut(L))}`:""}),i.jsx("td",{className:"border p-1",children:L.date}),i.jsx("td",{className:"border p-1",children:fe||""}),i.jsx("td",{className:"border p-1",children:L.userEmail}),i.jsx("td",{className:"border p-1",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ft(L),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ct(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},L.id)}),Ye.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-3 text-center text-gray-500",children:"Sin ventas crdito para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Ye.map(L=>{const fe=Ft(L),Be=Qt(L),ye=(L.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:L.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Crdito  ",L.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",Ra(L.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:rf(L.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Be>0?`C$${Ra(Be)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Tt(L)>0?`C$${Ra(Tt(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Neta"}),i.jsx("strong",{children:Ut(L)>0?`C$${Ra(Ut(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:fe>0?`C$${Ra(fe)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Be>0?`C$${Ra(Be)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:ye||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:L.userEmail})]}),i.jsx("div",{className:"pt-2",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ft(L),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ct(L.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},L.id)}),Ye.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas crdito para mostrar."})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:rf(ie)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:rf(xe)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",Ra(de)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",Ra(Me)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",Ra(me)]})]})]}),(Qe>0||Ge!==at)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",Ra(Qe)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",Ra(Ge)]})]}),i.jsxs("div",{children:["Total paquetes (visibles):"," ",i.jsx("strong",{children:rf(Z)})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>te(L=>!L),"aria-expanded":Q,children:[i.jsx("span",{children:"Consolidado por producto"}),i.jsx("span",{className:`transition-transform ${Q?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Q?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"space-y-3",children:[ke.map(L=>{const fe=!!ut[L.category];return i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ne(L.category),"aria-expanded":fe,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"truncate",children:L.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[rf(L.totalQuantity)," paquetes  C$",Ra(L.totalAmount),"  Comisin"," ",L.totalCommission>0?`C$${Ra(L.totalCommission)}`:""]})]}),i.jsx("span",{className:`transition-transform ${fe?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${fe?"block":"hidden"} border-t p-3`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsx("tbody",{children:L.rows.map(Be=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Be.productName}),i.jsx("td",{className:"border p-1",children:rf(Be.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ra(Be.totalAmount)]}),i.jsx("td",{className:"border p-1",children:Be.totalCommission>0?`C$${Ra(Be.totalCommission)}`:""})]},Be.productName))})]})}),i.jsx("div",{className:"pdf-mobile md:hidden space-y-2",children:L.rows.map(Be=>i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[i.jsx("div",{className:"font-semibold",children:Be.productName}),i.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),i.jsx("strong",{children:rf(Be.totalQuantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total dinero"}),i.jsxs("strong",{children:["C$",Ra(Be.totalAmount)]})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:Be.totalCommission>0?`C$${Ra(Be.totalCommission)}`:""})]})]})]},Be.productName))})]})]},L.category)}),ke.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[Xe&&i.jsx("button",{onClick:pe,className:"bg-blue-600 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-blue-700",children:"Procesar"}),i.jsx("button",{onClick:W,className:"bg-green-600 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-green-700",children:"PDF"}),i.jsx("button",{onClick:re,className:"bg-gray-700 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-gray-800",children:"CSV"}),i.jsx("button",{onClick:V,className:"bg-amber-600 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-amber-700",children:"Excel"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),C&&Xe&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[C.productName,"  ",C.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:E,onChange:L=>B(parseFloat(L.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:k,onChange:L=>T(parseFloat(L.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:P,onChange:L=>G(L.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:ce,onChange:L=>ue(parseFloat(L.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:le,onChange:L=>Ae(L.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>S(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:At,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Dh=t=>`C$ ${(Number(t)||0).toFixed(2)}`,_u=t=>Math.round((Number(t)||0)*100)/100;function gVe(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function xVe(t){return t.toISOString().slice(0,10)}function vVe(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function yVe(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return xVe(r)}function bVe(){const[t,e]=g.useState(vVe()),[r,n]=g.useState(yVe()),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState({}),[d,f]=g.useState({}),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState({}),[y,b]=g.useState(!1),[w,I]=g.useState(null),[j,C]=g.useState(null),S=g.useMemo(()=>w&&A.find(ue=>ue.vendorId===w)||null,[w,A]),E=g.useMemo(()=>{var ue;return!w||!j?[]:((ue=x[w])==null?void 0:ue[j])||[]},[w,j,x]),B=g.useMemo(()=>_u(A.reduce((ue,le)=>ue+(le.totalSoldMoney||0),0)),[A]),k=g.useMemo(()=>_u(A.reduce((ue,le)=>ue+(le.totalCreditMoney||0),0)),[A]);g.useEffect(()=>{(async()=>{try{const ue=await Ht(Ct(Ce,"sellers_candies")),le={};ue.forEach(_e=>{const De=_e.data(),O=De.branch||"Rivas";let H="RIVAS";O==="San Jorge"?H="SAN_JORGE":O==="Isla Ometepe"&&(H="ISLA"),le[_e.id]={id:_e.id,name:De.name??"(sin nombre)",branch:H,branchLabel:O,commissionPercent:Number(De.commissionPercent??0)}});const Ae=await Ht(Ct(Ce,"products_candies")),ae={};Ae.forEach(_e=>{const De=_e.data();ae[_e.id]={id:_e.id,name:De.name??"(sin nombre)"}}),u(le),f(ae)}catch(ue){console.error(ue),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const T=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}s(!0),l("");try{const ue={},le={},Ae=sr(Ct(Ce,"inventory_candies_sellers"),cr("date",">=",t),cr("date","<=",r)),ae=await Ht(Ae),_e={},De={},O={},H={};ae.forEach(je=>{var Me,me;const Se=je.data(),Ze=Se.sellerId||"";if(!Ze)return;const ut=Se.productId||"",Et=Se.productName||((Me=d[ut])==null?void 0:Me.name)||"(sin nombre)",St=Math.max(1,Math.floor(Number(Se.unitsPerPackage||1))),Ft=Number(Se.totalUnits??0),Qt=Number(Se.packages??0),Ut=Number(Se.remainingUnits??Se.remaining??0),Tt=Number(Se.remainingPackages??0),Re=Qt>0?Qt:Ft>0?Math.floor(Ft/St):0,Te=Tt>0?Tt:Ut>0?Math.floor(Ut/St):0;_e[Ze]=(_e[Ze]||0)+Re,De[Ze]=(De[Ze]||0)+Te;const Ye=Se.orderId||Se.vendorOrderId||Se.orderNumber||Se.order||je.id;O[Ze]||(O[Ze]=new Set),O[Ze].add(Ye);const ht=((me=c[Ze])==null?void 0:me.name)||Se.sellerName||"(sin vendedor)",Oe=String(Se.date||""),Ie=Number(Se.totalVendor??0),We=Number(Se.gainVendor??0),Z=Qt>0?Qt:Ft>0?Math.floor(Ft/St):0,Qe=Z>0?Ie/Z:0,at=Z>0?We/Z:0,Ge=_u(Re*Qe),ie=_u(Re*at),xe=_u(Te*Qe),de=_u(Te*at);H[Ze]||(H[Ze]={ordered:[],remaining:[]}),Re>0&&H[Ze].ordered.push({date:Oe,vendorName:ht,productName:Et,packages:Re,totalMoney:Ge,vendorCommission:ie}),Te>0&&H[Ze].remaining.push({date:Oe,vendorName:ht,productName:Et,packages:Te,totalMoney:xe,vendorCommission:de})});const K={};Object.keys(O).forEach(je=>{K[je]=O[je].size});const R=sr(Ct(Ce,"sales_candies"),cr("date",">=",t),cr("date","<=",r)),X=await Ht(R),Y={},D={},Q={},te={},be={},U={};X.forEach(je=>{const Se=je.data(),Ze=Se.date||"",ut=Se.vendorId||Se.sellerId||"";if(!ut)return;const Et=c[ut],St=Se.vendorName||(Et==null?void 0:Et.name)||"(sin vendedor)",Ft=Number(Se.vendorCommissionPercent??(Et==null?void 0:Et.commissionPercent)??0)||0,Qt=Array.isArray(Se.items)?Se.items:[];if(!Qt.length)return;const Ut=String(Se.type||"").toUpperCase()==="CREDITO";be[ut]||(be[ut]={sold:[],credit:[]}),Qt.forEach(Tt=>{var Ge;const Re=Tt.productName||((Ge=d[Tt.productId||""])==null?void 0:Ge.name)||"(sin nombre)",Te=Tt.packages??Tt.qty??Tt.quantity??0,Ye=Number(Te||0);if(Ye<=0)return;const ht=Number(Tt.unitPricePackage??Tt.unitPrice??0)||0,Oe=Math.max(0,Number(Tt.discount||0)),Ie=Ye*ht,We=_u(Math.max(0,Ie-Oe));if(We<=0)return;console.log("DBG",{isCredit:Ut,vendorId:ut,commissionPercent:Ft,lineFinal:We,storedItemCommission:Number(Tt.vendorCommissionAmount??0)});let Z=0;const Qe=Number(Tt.vendorCommissionAmount??0);Qe?Z=_u(Qe):Ft>0&&(Z=_u(We*Ft/100)),Ut?(D[ut]=(D[ut]||0)+Ye,te[ut]=(te[ut]||0)+We):(Y[ut]=(Y[ut]||0)+Ye,Q[ut]=(Q[ut]||0)+We),Ut?le[ut]=(le[ut]||0)+Z:ue[ut]=(ue[ut]||0)+Z,Ut?be[ut].credit.push({date:Ze,vendorName:St,productName:Re,packages:Ye,totalMoney:We,vendorCommission:0}):be[ut].sold.push({date:Ze,vendorName:St,productName:Re,packages:Ye,totalMoney:We,vendorCommission:Z});const at=Re;U[at]||(U[at]={productName:Re,packages:0,totalMoney:0}),U[at].packages+=Ye,U[at].totalMoney+=We})});const Xe=new Set([...Object.keys(_e),...Object.keys(De),...Object.keys(Y),...Object.keys(D)]),se=[],ee={};Xe.forEach(je=>{var Te,Ye,ht,Oe;const Se=c[je],Ze=(Se==null?void 0:Se.name)||"(sin vendedor)",ut=Se?Se.branchLabel||gVe(Se.branch):"",Et=_e[je]||0,St=De[je]||0,Ft=Y[je]||0,Qt=D[je]||0,Ut=_u(Q[je]||0),Tt=_u(te[je]||0),Re=K[je]||0;se.push({vendorId:je,vendorName:Ze,branchLabel:ut,orderedPackages:Et,remainingPackages:St,soldPackages:Ft,creditPackages:Qt,totalSoldMoney:Ut,totalCreditMoney:Tt,ordersCreated:Re,commissionCash:_u(ue[je]||0),commissionCredit:0}),ee[je]={ordered:(((Te=H[je])==null?void 0:Te.ordered)||[]).sort((Ie,We)=>Ie.date.localeCompare(We.date)),remaining:(((Ye=H[je])==null?void 0:Ye.remaining)||[]).sort((Ie,We)=>Ie.date.localeCompare(We.date)),sold:(((ht=be[je])==null?void 0:ht.sold)||[]).sort((Ie,We)=>Ie.date.localeCompare(We.date)),credit:(((Oe=be[je])==null?void 0:Oe.credit)||[]).sort((Ie,We)=>Ie.date.localeCompare(We.date))}}),se.sort((je,Se)=>je.vendorName.localeCompare(Se.vendorName,"es")),h(se),v(ee);const Fe=Object.values(U).map(je=>({productName:je.productName,packages:je.packages,totalMoney:_u(je.totalMoney)})).sort((je,Se)=>Se.packages-je.packages).slice(0,10);p(Fe),se.length||l("Sin datos para el rango seleccionado.")}catch(ue){console.error(ue),l(" Error cargando consolidado de vendedores.")}finally{s(!1)}};g.useEffect(()=>{Object.keys(c).length&&T()},[c]);const P=(ue,le)=>{I(ue),C(le),b(!0)},G=()=>{b(!1),I(null),C(null)},ce=()=>{if(!A.length){l("No hay datos para exportar.");return}const ue=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],le=A.map(O=>[O.vendorName,O.branchLabel,O.orderedPackages.toString(),O.remainingPackages.toString(),O.soldPackages.toString(),O.creditPackages.toString(),O.totalSoldMoney.toFixed(2),O.commissionCash.toFixed(2),O.totalCreditMoney.toFixed(2),O.commissionCredit.toFixed(2),O.ordersCreated.toString()]),Ae=[ue,...le].map(O=>O.map(H=>`"${String(H).replace(/"/g,'""')}"`).join(",")).join(`
`),ae=new Blob([Ae],{type:"text/csv;charset=utf-8;"}),_e=URL.createObjectURL(ae),De=document.createElement("a");De.href=_e,De.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,De.click(),URL.revokeObjectURL(_e)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ue=>e(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ue=>n(ue.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:a,children:a?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:ce,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Dh(B)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Dh(k)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:A.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[A.map(ue=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ue.vendorName}),i.jsx("td",{className:"border p-1",children:ue.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ue.vendorId,"ordered"),children:ue.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ue.vendorId,"remaining"),children:ue.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ue.vendorId,"sold"),children:ue.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ue.vendorId,"credit"),children:ue.creditPackages})}),i.jsx("td",{className:"border p-1",children:Dh(ue.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Dh(ue.commissionCash)}),i.jsx("td",{className:"border p-1",children:Dh(ue.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Dh(ue.commissionCredit)}),i.jsx("td",{className:"border p-1",children:ue.ordersCreated})]},ue.vendorId)),A.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((ue,le)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:le+1}),i.jsx("td",{className:"border p-1",children:ue.productName}),i.jsx("td",{className:"border p-1",children:ue.packages}),i.jsx("td",{className:"border p-1",children:Dh(ue.totalMoney)})]},ue.productName)),m.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&j&&w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",j==="ordered"?"Paquetes ordenados":j==="remaining"?"Paquetes restantes":j==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[S==null?void 0:S.vendorName,"  ",S==null?void 0:S.branchLabel]})]}),i.jsx("button",{onClick:G,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[E.map((ue,le)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ue.date}),i.jsx("td",{className:"border p-1",children:ue.productName}),i.jsx("td",{className:"border p-1",children:ue.packages}),i.jsx("td",{className:"border p-1",children:Dh(ue.totalMoney)}),i.jsx("td",{className:"border p-1",children:ue.vendorName}),i.jsx("td",{className:"border p-1",children:Dh(ue.vendorCommission)})]},le)),E.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const Wl=t=>`C$${Number(t||0).toFixed(2)}`,A_=t=>Number(t||0).toFixed(3),dT=()=>{const t=new Date;return Lr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},m_=()=>Lr(new Date,"yyyy-MM-dd");function wVe({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState([]),o=g.useMemo(()=>{const ie={};return a.forEach(xe=>{xe.email&&(ie[xe.email.trim().toLowerCase()]=xe)}),ie},[a]);g.useEffect(()=>{(async()=>{try{const ie=sr(Ct(Ce,"sellers_candies"),Sn("name","asc")),xe=await Ht(ie),de=[];xe.forEach(Me=>{const me=Me.data();de.push({id:Me.id,name:me.name||"",email:me.email||"",commissionPercent:Number(me.commissionPercent||0)})}),s(de)}catch(ie){console.error(ie)}})()},[]);const[l,c]=g.useState(dT()),[u,d]=g.useState(m_()),[f,A]=g.useState(""),[h,m]=g.useState(""),p=g.useMemo(()=>{const ie=new Map;return n.forEach(xe=>{const de=xe.productId||xe.productName;ie.set(de,{key:de,name:xe.productName})}),Array.from(ie.values()).sort((xe,de)=>xe.name.localeCompare(de.name))},[n]),x=g.useMemo(()=>{const ie=new Map;return n.forEach(xe=>{const de=(xe.sellerEmail||"").trim().toLowerCase();if(!de)return;const Me=o[de],me=(Me==null?void 0:Me.name)||xe.vendorName||de;ie.set(de,{email:de,label:me})}),Array.from(ie.values()).sort((xe,de)=>xe.label.localeCompare(de.label))},[n,o]),v=g.useMemo(()=>n.filter(ie=>!(l&&ie.date<l||u&&ie.date>u||f&&(ie.productId||ie.productName)!==f||h&&(ie.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,u,f,h]),[y,b]=g.useState(m_()),[w,I]=g.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[j,C]=g.useState(""),[S,E]=g.useState("0"),[B,k]=g.useState(()=>v.map(ie=>ie.id));g.useEffect(()=>{k(ie=>ie.filter(xe=>v.some(de=>de.id===xe)))},[v]);const[T,P]=g.useState([]),[G,ce]=g.useState([]),[ue,le]=g.useState(!1),[Ae,ae]=g.useState(dT()),[_e,De]=g.useState(m_());g.useEffect(()=>{(async()=>{try{le(!0);const ie=sr(Ct(Ce,"expensesCandies"),Sn("date","desc")),xe=await Ht(ie),de=[];xe.forEach(Me=>{const me=Me.data();de.push({id:Me.id,date:me.date,description:me.description,amount:Number(me.amount||0)})}),P(de)}catch(ie){console.error(ie)}finally{le(!1)}})()},[]);const O=g.useMemo(()=>T.filter(ie=>!(!ie.date||Ae&&ie.date<Ae||_e&&ie.date>_e)),[T,Ae,_e]),[H,K]=g.useState([]),[R,X]=g.useState(!1),[Y,D]=g.useState(""),[Q,te]=g.useState("DEBITO"),[be,U]=g.useState(""),Xe=()=>{const ie=Number(be);!Y.trim()||!isFinite(ie)||ie<=0||(K(xe=>[...xe,{id:`${Date.now()}_${xe.length+1}`,description:Y.trim(),type:Q,amount:Number(ie.toFixed(2))}]),D(""),U(""))},[se,ee]=g.useState(null),[Fe,je]=g.useState(""),[Se,Ze]=g.useState("DEBITO"),[ut,Et]=g.useState(""),St=ie=>{ee(ie.id),je(ie.description),Ze(ie.type),Et(ie.amount.toFixed(2))},Ft=()=>{ee(null),je(""),Ze("DEBITO"),Et("")},Qt=()=>{if(!se)return;const ie=Number(ut);!isFinite(ie)||ie<=0||(K(xe=>xe.map(de=>de.id===se?{...de,description:Fe.trim(),type:Se,amount:Number(ie.toFixed(2))}:de)),Ft())},Ut=ie=>{K(xe=>xe.filter(de=>de.id!==ie)),se===ie&&Ft()},Tt=(ie,xe)=>{k(de=>xe?[...new Set([...de,ie])]:de.filter(Me=>Me!==ie))},Re=ie=>{k(ie?v.map(xe=>xe.id):[])},Te=(ie,xe)=>{ce(de=>xe?[...new Set([...de,ie])]:de.filter(Me=>Me!==ie))},Ye=g.useMemo(()=>v.filter(ie=>B.includes(ie.id)),[v,B]),ht=g.useMemo(()=>H.filter(ie=>ie.type==="DEBITO").reduce((ie,xe)=>ie+xe.amount,0),[H]),Oe=g.useMemo(()=>H.filter(ie=>ie.type==="CREDITO").reduce((ie,xe)=>ie+xe.amount,0),[H]),Ie=g.useMemo(()=>{let ie=0,xe=0,de=0,Me=0;for(const kt of Ye){const Vt=Number(kt.packages||0),ke=Number(kt.cogsAmount||0),Ne=Number(kt.amount||0);ie+=Vt,xe+=ke,de+=Ne;const pe=(kt.sellerEmail||"").trim().toLowerCase(),Le=o[pe],ft=Number((Le==null?void 0:Le.commissionPercent)||0),At=Ne*ft/100;Me+=At}const me=O.filter(kt=>G.includes(kt.id)).reduce((kt,Vt)=>kt+Number(Vt.amount||0),0),we=de-xe,pt=de-me-ht+Oe-Me,vt=Number(S||0),bt=de*vt/100;return{totalPackages:Number(A_(ie)),totalProvider:Number(xe.toFixed(2)),totalSale:Number(de.toFixed(2)),totalGastos:Number(me.toFixed(2)),debits:Number(ht.toFixed(2)),credits:Number(Oe.toFixed(2)),grossProfit:Number(we.toFixed(2)),finalAmount:Number(pt.toFixed(2)),totalCommissionVendors:Number(Me.toFixed(2)),branchProfit:Number(bt.toFixed(2)),branchFactor:vt}},[Ye,O,G,ht,Oe,o,S]),[We,Z]=g.useState(!1),[Qe,at]=g.useState(""),Ge=async()=>{if(at(""),Ye.length===0){at("Selecciona al menos 1 transaccin procesada.");return}try{Z(!0);const ie={number:w.trim(),date:y,description:j.trim(),status:"PENDIENTE",createdAt:yr.now(),totalPackages:Ie.totalPackages,totalProvider:Ie.totalProvider,totalSale:Ie.totalSale,totalExpenses:Ie.totalGastos,totalDebits:Ie.debits,totalCredits:Ie.credits,grossProfit:Ie.grossProfit,totalCommissionVendors:Ie.totalCommissionVendors,branchFactorPercent:Ie.branchFactor,branchProfit:Ie.branchProfit,finalAmount:Ie.finalAmount,transactions:Ye.map(xe=>{const de=Number(xe.packages||0)||1,Me=Number(xe.cogsAmount||0),me=Number(xe.amount||0),we=Me/de,pt=me/de,vt=(xe.sellerEmail||"").trim().toLowerCase(),bt=o[vt],kt=Number((bt==null?void 0:bt.commissionPercent)||0),Vt=me*kt/100;return{id:xe.id,date:xe.date,productId:xe.productId||null,productName:xe.productName,vendorName:xe.vendorName,sellerEmail:xe.sellerEmail||null,packages:Number(A_(xe.packages)),providerPricePack:Number(we.toFixed(4)),salePricePack:Number(pt.toFixed(4)),totalProvider:Number(Me.toFixed(2)),totalSale:Number(me.toFixed(2)),commissionPercent:kt,commissionAmount:Number(Vt.toFixed(2))}}),expenses:O.filter(xe=>G.includes(xe.id)).map(xe=>({id:xe.id,date:xe.date||null,description:xe.description||"",amount:Number(Number(xe.amount||0).toFixed(2))})),adjustments:H.map(xe=>({id:xe.id,description:xe.description,type:xe.type,amount:Number(xe.amount.toFixed(2))}))};await Gn(Ct(Ce,"invoicesCandies"),ie),at(" Factura de dulces creada."),r()}catch(ie){console.error(ie),at(` Error al crear factura: ${(ie==null?void 0:ie.message)||"desconocido"}`)}finally{Z(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:ie=>b(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:w,onChange:ie=>I(ie.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:ie=>E(ie.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:j,onChange:ie=>C(ie.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:ie=>c(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:ie=>d(ie.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:f,onChange:ie=>A(ie.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(ie=>i.jsx("option",{value:ie.key,children:ie.name},ie.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:ie=>m(ie.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(ie=>i.jsx("option",{value:ie.email,children:ie.label},ie.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(dT()),d(m_()),A(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.length>0&&B.length===v.length,onChange:ie=>Re(ie.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),v.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:v.map(ie=>{const xe=B.includes(ie.id),de=Number(ie.packages||0)||1,Me=Number(ie.cogsAmount||0),me=Number(ie.amount||0),we=Me/de,pt=me/de,vt=(ie.sellerEmail||"").trim().toLowerCase(),bt=o[vt],kt=Number((bt==null?void 0:bt.commissionPercent)||0),Vt=me*kt/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:xe,onChange:ke=>Tt(ie.id,ke.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ie.date}),i.jsx("td",{className:"p-2 border",children:(bt==null?void 0:bt.name)||ie.vendorName}),i.jsx("td",{className:"p-2 border",children:ie.productName}),i.jsx("td",{className:"p-2 border",children:A_(ie.packages)}),i.jsx("td",{className:"p-2 border",children:Wl(we)}),i.jsx("td",{className:"p-2 border",children:Wl(pt)}),i.jsx("td",{className:"p-2 border",children:Wl(Me)}),i.jsx("td",{className:"p-2 border",children:Wl(me)}),i.jsx("td",{className:"p-2 border",children:kt>0?`${Wl(Vt)} (${kt.toFixed(2)}%)`:""})]},ie.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ue&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:Ae,onChange:ie=>ae(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:_e,onChange:ie=>De(ie.target.value)})]})]})]}),O.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:O.map(ie=>{const xe=G.includes(ie.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:xe,onChange:de=>Te(ie.id,de.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ie.date||""}),i.jsx("td",{className:"p-2 border",children:ie.description||""}),i.jsx("td",{className:"p-2 border",children:Wl(Number(ie.amount||0))})]},ie.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>X(!0),children:"Crear Cargo"})]}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.map(ie=>{const xe=se===ie.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:xe?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:Fe,onChange:de=>je(de.target.value)}):i.jsx("span",{title:ie.description,children:ie.description.length>60?`${ie.description.slice(0,60)}`:ie.description})}),i.jsx("td",{className:"p-2 border",children:xe?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Se,onChange:de=>Ze(de.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ie.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:ie.type})}),i.jsx("td",{className:"p-2 border",children:xe?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:ut,onChange:de=>Et(de.target.value)}):Wl(ie.amount)}),i.jsx("td",{className:"p-2 border",children:xe?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Qt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Ft,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Ut(ie.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>St(ie),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Ut(ie.id),children:"Eliminar"})]})})]},ie.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:A_(Ie.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:Wl(Ie.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:Wl(Ie.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:Wl(Ie.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Wl(Ie.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Wl(Ie.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Wl(Ie.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:Wl(Ie.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:Wl(Ie.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:Wl(Ie.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:We,onClick:Ge,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:We?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Qe&&i.jsx("span",{className:"text-sm ml-2",children:Qe})]}),We&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),R&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>X(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:Y,onChange:ie=>D(ie.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Q,onChange:ie=>te(ie.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:be,onChange:ie=>U(ie.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Xe,children:"Agregar"})})]})]})})]})}const za=t=>`C$ ${Number(t??0).toFixed(2)}`,p_=t=>Number(t??0).toFixed(3);function fT(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),a=Number(t.totalSale??0),s=Number(t.totalCommissionVendors??0);if(e.length>0&&(a===0||r===0)){r=0,n=0,a=0,s=0;for(const v of e){const y=Number(v.packages??0);r+=y,n+=Number(v.totalProvider??y*(v.providerPricePack??0)),a+=Number(v.totalSale??y*(v.salePricePack??0));const b=v.commissionAmount??Number(v.totalSale??0)*Number(v.commissionPercent??0)/100;s+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((v,y)=>v+Number(y.amount||0),0),u=l.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),d=l.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):u,A=t.totalCredits!==void 0?Number(t.totalCredits):d,h=a-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):a-s-c-f+A;return{totalPackages:r,totalProvider:n,totalSale:a,commissionTotal:s,expenses:c,debits:f,credits:A,grossProfit:h,branchProfit:p,finalAmount:x}}function PG(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function NVe(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),u=async()=>{n(!0);const h=sr(Ct(Ce,"invoicesCandies"),Sn("date","desc")),m=await Ht(h),p=[];m.forEach(x=>{const v=x.data();p.push({id:x.id,date:v.date,number:v.number,description:v.description,status:v.status||"PENDIENTE",totalPackages:v.totalPackages||0,totalProvider:v.totalProvider||0,totalSale:v.totalSale||0,totalExpenses:v.totalExpenses||0,totalDebits:v.totalDebits||0,totalCredits:v.totalCredits||0,totalCommissionVendors:v.totalCommissionVendors||0,finalAmount:v.finalAmount||0,branchFactorPercent:v.branchFactorPercent||0,branchProfit:v.branchProfit||0,transactions:(v.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(v.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(v.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};g.useEffect(()=>{u()},[]);const d=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await kn(Yt(Ce,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(a==null?void 0:a.id)===h.id&&s({...h,status:m})},f=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await Wn(Yt(Ce,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(a==null?void 0:a.id)===h.id&&s(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},A=async()=>{if(!o.current||!a)return;const h=o.current,m=await Hm(h,{backgroundColor:"#ffffff",onclone:b=>{const w=b.body;w.style.background="#ffffff",w.querySelectorAll("*").forEach(I=>{const j=b.defaultView.getComputedStyle(I);j.boxShadow&&j.boxShadow!=="none"&&(I.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new rn("p","mm","a4"),v=x.internal.pageSize.getWidth(),y=m.height*v/m.width;x.addImage(p,"PNG",0,0,v,y),x.save(`factura_candy_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(wVe,{onClose:()=>c(!1),onCreated:()=>{c(!1),u()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=fT(h),p=PG(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p_(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>d(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>f(h),children:"Eliminar"})]})})]},h.id)})})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=fT(a),m=PG(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",p_(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",za(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",za(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",za(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",za(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",za(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",za(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",za(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(a.transactions||[]).length>0?(a.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p_(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[za(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:za(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=fT(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:p_(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:za(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:za(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:za(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:za(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:za(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:za(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:za(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:za(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:za(h.finalAmount)})]})})]})})()]})]})}const Qs=t=>Math.round((Number(t)||0)*100)/100,C0=t=>Math.round((Number(t)||0)*1e3)/1e3,yo=t=>Number(t??0).toFixed(2),Rh=t=>Number(t??0).toFixed(3),CVe=(t,e)=>{var A;const r=t.date??((A=t.timestamp)!=null&&A.toDate?Lr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((h,m)=>{const p=Number((h==null?void 0:h.packages)??(h==null?void 0:h.qty)??(h==null?void 0:h.quantity)??0),x=Number((h==null?void 0:h.lineFinal)??0)||Math.max(0,Number((h==null?void 0:h.unitPricePackage)||(h==null?void 0:h.unitPrice)||0)*p-Number((h==null?void 0:h.discount)||0));let v=0;return c>0&&l>0&&Number(x||0)>0&&(v=Qs(c*Number(x||0)/l)),{id:`${e}#${m}`,productName:String((h==null?void 0:h.productName)??"(sin nombre)"),quantity:p,amount:Qs(x),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:v}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0,f=Qs(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:String((t==null?void 0:t.productName)??"(sin nombre)"),quantity:u,amount:Qs(d),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:f}]};function _Ve({role:t,roles:e,currentUserEmail:r,sellerCandyId:n}){const a=e&&e.length?e:t,s=!a||En(a,"admin"),o="daily_closures_candies",l="sales_candies",c="sellers_candies",[u,d]=g.useState(Lr(Jee(new Date),"yyyy-MM-dd")),[f,A]=g.useState(Lr(new Date,"yyyy-MM-dd")),[h,m]=g.useState(!0),[p,x]=g.useState([]),[v,y]=g.useState(null),[b,w]=g.useState(""),[I,j]=g.useState([]),[C,S]=g.useState("ALL"),[E,B]=g.useState({}),k=g.useRef(null);if(!s)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const T=async()=>{try{const Y=await Ht(Ct(Ce,c)),D=[];Y.forEach(Q=>{const te=Q.data();D.push({id:Q.id,name:te.name||"",commissionPercent:Number(te.commissionPercent||0)})}),j(D)}catch(Y){console.error("Error cargando sellers_candies",Y)}},P=async()=>{const Y=performance.now();try{m(!0);const D=sr(Ct(Ce,o),cr("date",">=",u),cr("date","<=",f)),Q=await Ht(D),te=performance.now();console.log(" getDocs ms:",(te-Y).toFixed(1),"docs:",Q.size);const be=[];Q.forEach(ee=>be.push({id:ee.id,...ee.data()}));const U=performance.now();console.log(" parse+set ms:",(U-te).toFixed(1),"rows:",be.length),be.sort((ee,Fe)=>ee.date<Fe.date?1:ee.date>Fe.date?-1:0),x(be),y(null);const Xe=new Set;be.forEach(ee=>{(ee.sales||[]).forEach(Fe=>{const je=String((Fe==null?void 0:Fe.id)??"").split("#")[0].trim();je&&Xe.add(je)})});const se=Array.from(Xe).filter(ee=>!E[ee]);if(se.length>0){const ee={};for(const Fe of se)try{const je=await gs(Yt(Ce,l,Fe));if(je.exists()){const Se=je.data();ee[Fe]=CVe(Se,Fe)}else ee[Fe]=[]}catch(je){console.error("Error leyendo sale",Fe,je),ee[Fe]=[]}B(Fe=>({...Fe,...ee}))}}catch(D){console.error(D),w(" Error cargando liquidaciones.")}finally{m(!1)}};g.useEffect(()=>{T()},[]),g.useEffect(()=>{P()},[]);const G=async Y=>{Y.preventDefault(),await P()},ce=g.useMemo(()=>{const Y={};return I.forEach(D=>Y[D.id]=D.name||D.id),Y},[I]),ue=Y=>{const D=[];return(Y.sales||[]).forEach(Q=>{const te=String((Q==null?void 0:Q.id)??"").trim();if(!te)return;const be=te.split("#")[0],Xe=(E[be]||[]).find(se=>se.id===te);Xe?D.push(Xe):D.push({id:te,productName:String((Q==null?void 0:Q.productName)??"(sin nombre)"),quantity:Number((Q==null?void 0:Q.quantity)??0),amount:Qs(Number((Q==null?void 0:Q.amount)??0)),date:String((Q==null?void 0:Q.date)??""),type:"CONTADO",vendorId:"",userEmail:String((Q==null?void 0:Q.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),D},le=Y=>C==="ALL"?Y:Y.filter(D=>(D.vendorId||"")===C),Ae=g.useMemo(()=>p.map(Y=>{const D=le(ue(Y));let Q=0,te=0,be=0,U=0,Xe=0,se=0;for(const ee of D){const Fe=Number(ee.quantity||0),je=Number(ee.amount||0),Se=Number(ee.vendorCommissionAmount||0);ee.type==="CREDITO"?(te+=Fe,U+=je,se+=Se):(Q+=Fe,be+=je,Xe+=Se)}return{...Y,_sales:D,_packsCash:C0(Q),_packsCredit:C0(te),_amountCash:Qs(be),_amountCredit:Qs(U),_comCash:Qs(Xe),_comCredit:Qs(se)}}),[p,E,C]),ae=g.useMemo(()=>{let Y=0,D=0,Q=0,te=0,be=0,U=0;for(const Xe of Ae)Y+=Number(Xe._packsCash||0),D+=Number(Xe._packsCredit||0),Q+=Number(Xe._amountCash||0),te+=Number(Xe._amountCredit||0),be+=Number(Xe._comCash||0),U+=Number(Xe._comCredit||0);return{packsCash:C0(Y),packsCredit:C0(D),totalSales:Qs(Q+te),amountCash:Qs(Q),amountCredit:Qs(te),comCash:Qs(be),comCredit:Qs(U)}},[Ae]),_e=g.useMemo(()=>{const Y={},D={};for(const Q of Ae){const te=Q._sales||[];for(const be of te){const U=(be.vendorId||"").trim();if(!U)continue;const Xe=ce[U]||be.userEmail||U,se=Qs(Number(be.vendorCommissionAmount||0));be.type==="CREDITO"?(D[U]||(D[U]={vendorId:U,name:Xe,total:0}),D[U].total=Qs(D[U].total+se)):(Y[U]||(Y[U]={vendorId:U,name:Xe,total:0}),Y[U].total=Qs(Y[U].total+se))}}return{cashRows:Object.values(Y).filter(Q=>Q.total>0).sort((Q,te)=>te.total-Q.total),creditRows:Object.values(D).filter(Q=>Q.total>0).sort((Q,te)=>te.total-Q.total)}},[Ae,ce]),De=g.useMemo(()=>I.map(Y=>({id:Y.id,label:Y.name||Y.id})).sort((Y,D)=>Y.label.localeCompare(D.label)),[I]),O=g.useMemo(()=>v&&Ae.find(Y=>Y.id===v.id)||null,[v,Ae]),H=g.useMemo(()=>O?O._sales||[]:[],[O]),K=g.useMemo(()=>{let Y=0,D=0,Q=0,te=0;for(const be of H)be.type==="CREDITO"?(D+=Number(be.quantity||0),te+=Number(be.amount||0)):(Y+=Number(be.quantity||0),Q+=Number(be.amount||0));return{packsCash:C0(Y),packsCredit:C0(D),amountCash:Qs(Q),amountCredit:Qs(te)}},[H]),R=g.useMemo(()=>{const Y={};for(const D of H){const Q=D.productName||"(sin nombre)";Y[Q]||(Y[Q]={productName:Q,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const te=Number(D.quantity||0),be=Number(D.amount||0),U=Number(D.vendorCommissionAmount||0);D.type==="CREDITO"?(Y[Q].packsCredit=C0(Y[Q].packsCredit+te),Y[Q].amountCredit=Qs(Y[Q].amountCredit+be),Y[Q].comCredit=Qs(Y[Q].comCredit+U)):(Y[Q].packsCash=C0(Y[Q].packsCash+te),Y[Q].amountCash=Qs(Y[Q].amountCash+be),Y[Q].comCash=Qs(Y[Q].comCash+U))}return Object.values(Y)},[H]),X=async()=>{if(!k.current||!O)return;const Y=k.current;Y.classList.add("force-pdf-colors");try{const Q=(await Hm(Y,{backgroundColor:"#ffffff"})).toDataURL("image/png"),te=new rn;te.addImage(Q,"PNG",10,10,190,0),te.save(`liquidacion_${O.date}.pdf`)}finally{Y.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:G,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:Y=>d(Y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:Y=>A(Y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:C,onChange:Y=>S(Y.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),De.map(Y=>i.jsx("option",{value:Y.id,children:Y.label},Y.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Rh(ae.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Rh(ae.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(ae.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(ae.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(ae.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(ae.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(ae.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),_e.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:_e.cashRows.map(Y=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Y.name}),i.jsxs("strong",{className:"ml-2",children:["C$",yo(Y.total)]})]},Y.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),_e.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:_e.creditRows.map(Y=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Y.name}),i.jsxs("strong",{className:"ml-2",children:["C$",yo(Y.total)]})]},Y.vendorId))})]})]}),h?i.jsx("p",{children:"Cargando..."}):Ae.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:Ae.map(Y=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Y.date}),i.jsx("td",{className:"border p-1",children:Rh(Y._packsCash)}),i.jsx("td",{className:"border p-1",children:Rh(Y._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>y(Y),children:"Ver detalle"})})})]},Y.id))})]}),O&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",O.date]}),i.jsx("button",{onClick:()=>y(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:X,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:k,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",yo(K.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",yo(K.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Rh(K.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Rh(K.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:H.map((Y,D)=>{const Q=Y.vendorId&&ce[Y.vendorId]?ce[Y.vendorId]:Y.userEmail,te=Qs(Number(Y.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Q}),i.jsx("td",{className:"border p-1",children:Y.productName}),i.jsx("td",{className:"border p-1",children:Y.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Rh(Y.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y.amount)]}),i.jsx("td",{className:"border p-1",children:te>0?`C$${yo(te)}`:""}),i.jsx("td",{className:"border p-1",children:Y.date||""})]},D)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),R.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:R.map((Y,D)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Y.productName}),i.jsx("td",{className:"border p-1",children:Rh(Y.packsCash)}),i.jsx("td",{className:"border p-1",children:Rh(Y.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(Y.comCredit)]})]},D))})]})]})]}),b&&i.jsx("p",{className:"mt-3 text-sm",children:b})]})}const qr=t=>Math.round((Number(t)||0)*100)/100,ml=t=>Math.round((Number(t)||0)*1e3)/1e3,Ur=t=>Number(t??0).toFixed(2),ii=t=>Number(t??0).toFixed(3),lj=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},Rr=t=>{const e=Number(t);return Number.isFinite(e)?e:0},EVe=t=>Math.max(0,Math.min(1,t));function TG({title:t,series:e,valuePrefix:r="C$"}){const u=e.map(b=>Number(b.value||0)),d=u.length?Math.min(...u):0,f=u.length?Math.max(...u):0,A=f-d||1,h=840,m=204,p=e.map((b,w)=>{const I=44+(e.length<=1?h/2:w/(e.length-1)*h),j=18+(1-(Number(b.value||0)-d)/A)*m;return{x:I,y:j,...b}}),x=p.map((b,w)=>`${w===0?"M":"L"} ${b.x.toFixed(2)} ${b.y.toFixed(2)}`).join(" "),v=p[p.length-1],y=v?v.value:0;return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base",children:t}),i.jsxs("div",{className:"text-xs text-gray-600 whitespace-nowrap",children:["ltimo: ",i.jsx("strong",{children:r+Ur(y)})]})]}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("svg",{viewBox:"0 0 900 260",className:"min-w-[720px] w-full h-auto",role:"img","aria-label":t,children:[[0,1,2,3].map(b=>{const w=18+b/3*m;return i.jsx("line",{x1:44,y1:w,x2:884,y2:w,stroke:"#e5e7eb",strokeWidth:"1"},b)}),i.jsxs("text",{x:8,y:28,fontSize:"12",fill:"#6b7280",children:[r,Ur(f)]}),i.jsxs("text",{x:8,y:18+m,fontSize:"12",fill:"#6b7280",children:[r,Ur(d)]}),i.jsx("path",{d:x,fill:"none",stroke:"#111827",strokeWidth:"2.5"}),p.map((b,w)=>i.jsx("circle",{cx:b.x,cy:b.y,r:"3.5",fill:"#111827"},w)),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("text",{x:44,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"start",children:e[0].label}),i.jsx("text",{x:884,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"end",children:e[e.length-1].label})]})]})})]})}function SVe({title:t,items:e}){const r=e.reduce((f,A)=>f+Number(A.value||0),0),n=240,a=86,s=120,o=120,l=r>0?r:1;let c=0;const u=["#111827","#374151","#6b7280","#9ca3af"],d=e.map((f,A)=>{const h=Math.max(0,Number(f.value||0)),m=c/l,p=h/l;c+=h;const x=m+p,v=m*Math.PI*2-Math.PI/2,y=x*Math.PI*2-Math.PI/2,b=s+a*Math.cos(v),w=o+a*Math.sin(v),I=s+a*Math.cos(y),j=o+a*Math.sin(y),C=p>.5?1:0;return{d:[`M ${s} ${o}`,`L ${b.toFixed(2)} ${w.toFixed(2)}`,`A ${a} ${a} 0 ${C} 1 ${I.toFixed(2)} ${j.toFixed(2)}`,"Z"].join(" "),fill:u[A%u.length],...f,frac:p}});return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base mb-2",children:t}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("div",{className:"w-full md:w-auto overflow-x-auto",children:i.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"min-w-[240px] w-[260px] h-auto",role:"img","aria-label":t,children:[d.map((f,A)=>i.jsx("path",{d:f.d,fill:f.fill},A)),i.jsx("circle",{cx:s,cy:o,r:"48",fill:"#ffffff"}),i.jsx("text",{x:s,y:o-4,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:"Total"}),i.jsxs("text",{x:s,y:o+16,textAnchor:"middle",fontSize:"14",fill:"#111827",fontWeight:"700",children:["C$",Ur(r)]})]})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.map((f,A)=>{const h=Number(f.value||0),m=EVe(h/(r||1))*100;return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"text-sm font-semibold truncate",children:f.label}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Ur(h)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[m.toFixed(1),"%"]}),i.jsx("div",{className:"h-2 bg-white border rounded-full mt-2 overflow-hidden",children:i.jsx("div",{className:"h-full",style:{width:`${m}%`,background:u[A%u.length]}})})]},f.label)})}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Distribucin basada en ventas del perodo con los filtros actuales."})]})]})]})}const jVe=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?Lr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),a=t.status??"FLOTANTE",s=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),u=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",d=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,f=Number(t.vendorCommissionAmount??0)||0,A=lj(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((v,y)=>{const b=Number((v==null?void 0:v.packages)??0)||0,w=Number((v==null?void 0:v.total)??0)||Math.max(0,Number((v==null?void 0:v.unitPricePackage)||0)*b-Number((v==null?void 0:v.discount)||0)),I=lj(v==null?void 0:v.branch)||A;let j=0;return f>0&&d>0&&w>0&&(j=qr(f*w/d)),{id:`${e}#${y}`,docId:e,productId:String((v==null?void 0:v.productId)??""),productName:String((v==null?void 0:v.productName)??"(sin nombre)"),date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:I||"",packages:b,amount:qr(w),commission:qr(j)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=qr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:A||"",packages:h,amount:qr(m),commission:qr(p)}]};function IVe({role:t,roles:e}){var yt;const r=e&&e.length?e:t,n=!r||En(r,"admin"),a=Lr(new Date,"yyyy-MM-dd"),[s,o]=g.useState(a),[l,c]=g.useState(a),[u,d]=g.useState("TODAS"),[f,A]=g.useState("AMBAS"),[h,m]=g.useState("ALL"),[p,x]=g.useState("ALL"),[v,y]=g.useState(""),[b,w]=g.useState(""),[I,j]=g.useState(""),[C,S]=g.useState(""),[E,B]=g.useState("DIA"),[k,T]=g.useState(!0),[P,G]=g.useState(""),[ce,ue]=g.useState([]),[le,Ae]=g.useState([]),[ae,_e]=g.useState([]),[De,O]=g.useState({}),[H,K]=g.useState([]),[R,X]=g.useState([]),[Y,D]=g.useState([]),[Q,te]=g.useState([]),[be,U]=g.useState([]),[Xe,se]=g.useState([]),[ee,Fe]=g.useState(""),[je,Se]=g.useState(""),[Ze,ut]=g.useState(null),Et=g.useRef(null),[St,Ft]=g.useState([]),[Qt,Ut]=g.useState("DETALLE"),[Tt,Re]=g.useState(!1),[Te,Ye]=g.useState(!1),[ht,Oe]=g.useState(!1),[Ie,We]=g.useState(!1),[Z,Qe]=g.useState(!1),[at,Ge]=g.useState(!1),ie=g.useMemo(()=>{const ne={};return R.forEach(Ue=>ne[Ue.id]=String(Ue.name||"").trim()),ne},[R]),xe=g.useMemo(()=>{const ne={};return le.forEach(Ue=>ne[Ue.id]=Ue),ne},[le]),de=ne=>{const Ue=ne.customerId?ie[ne.customerId]:"";return(ne.customerName||Ue||"").trim()||(ne.customerId?ie[ne.customerId]||ne.customerId:"")||""};g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ht(Ct(Ce,"inventory_candies")),rt=[];Ue.forEach(st=>rt.push({id:st.id,...st.data()})),Ft(rt)}catch(Ue){console.error("inventory_candies all error:",Ue),Ft([])}})()},[n]),g.useEffect(()=>{(async()=>{try{const Ue=await Ht(Ct(Ce,"sellers_candies")),rt=[];Ue.forEach(_t=>{const Ot=_t.data();rt.push({id:_t.id,name:String(Ot.name||"").trim(),commissionPercent:Number(Ot.commissionPercent||0),branch:Ot.branch||""})});const st=new Map;rt.forEach(_t=>st.set(_t.id,_t)),Ae(Array.from(st.values()).sort((_t,Ot)=>_t.name.localeCompare(Ot.name)))}catch(Ue){console.error(Ue)}})()},[]),g.useEffect(()=>{if(!n||!s||!l)return;T(!0),G("");const ne=sr(Ct(Ce,"sales_candies"),cr("date",">=",s),cr("date","<=",l),Sn("date","asc")),Ue=Pd(ne,rt=>{const st=[];rt.forEach(_t=>st.push(...jVe(_t.data(),_t.id))),ue(st),T(!1)},rt=>{console.error("sales_candies periodo error:",rt),ue([]),T(!1),G(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>Ue()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=sr(Ct(Ce,"candy_main_orders"),cr("date",">=",s),cr("date","<=",l)),rt=await Ht(Ue),st=[];rt.forEach(_t=>st.push({id:_t.id,..._t.data()})),_e(st)}catch(Ue){console.error("candy_main_orders error:",Ue),_e([])}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ht(sr(Ct(Ce,"candy_main_orders"),Sn("createdAt","desc"))),rt={},st=(_t,Ot)=>`${_t}#${String(Ot).padStart(10,"0")}`;Ue.forEach(_t=>{var kr;const Ot=_t.data(),nr=Number(((kr=Ot.createdAt)==null?void 0:kr.seconds)??0),Ir=String(Ot.date||""),Qr=st(Ir,nr),or=Array.isArray(Ot.items)?Ot.items:[];for(const Zr of or){const nn=String(Zr.id||Zr.productId||"");if(!nn)continue;const _r={unitPriceRivas:Number(Zr.unitPriceRivas||0),unitPriceSanJorge:Number(Zr.unitPriceSanJorge||0),unitPriceIsla:Number(Zr.unitPriceIsla||0),key:Qr},He=rt[nn];(!He||_r.key>He.key)&&(rt[nn]=_r)}}),O(rt)}catch(Ue){console.error("candy_main_orders catalog error:",Ue),O({})}})()},[n]),g.useEffect(()=>{if(!n)return;const ne=sr(Ct(Ce,"inventory_candies_sellers"),cr("date",">=",s),cr("date","<=",l)),Ue=Pd(ne,rt=>{const st=[];rt.forEach(_t=>st.push({id:_t.id,..._t.data()})),K(st)},rt=>{console.error("inventory_candies_sellers error:",rt),K([])});return()=>Ue()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=sr(Ct(Ce,"expenses_candies"),cr("date",">=",s),cr("date","<=",l),Sn("date","asc")),rt=await Ht(Ue),st=[];rt.forEach(_t=>st.push({id:_t.id,..._t.data()})),te(st)}catch(Ue){console.warn("expenses_candies sin ndice, usando fallback:",Ue);try{const rt=await Ht(Ct(Ce,"expenses_candies")),st=[];rt.forEach(_t=>st.push({id:_t.id,..._t.data()})),te(st.filter(_t=>String(_t.date||"")>=s&&String(_t.date||"")<=l))}catch(rt){console.error(rt),te([])}}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ht(Ct(Ce,"inventory_candies")),rt=[];Ue.forEach(st=>rt.push({id:st.id,...st.data()})),U(rt)}catch(Ue){console.error("inventory_candies global error:",Ue),U([])}})()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ht(Ct(Ce,"inventory_candies_sellers")),rt=[];Ue.forEach(st=>rt.push({id:st.id,...st.data()})),se(rt)}catch(Ue){console.error("inventory_candies_sellers global error:",Ue),se([])}})()},[n]),g.useEffect(()=>{if(!n)return;const ne=sr(Ct(Ce,"customers_candies")),Ue=Pd(ne,rt=>{const st=[];rt.forEach(_t=>{var Ot,nr,Ir;return st.push({id:_t.id,name:String(((Ot=_t.data())==null?void 0:Ot.name)||"").trim(),initialDebt:Number(((nr=_t.data())==null?void 0:nr.initialDebt)||0),initialDebtDate:String(((Ir=_t.data())==null?void 0:Ir.initialDebtDate)||"").trim()})}),X(st)},rt=>{console.error("customers_candies snapshot error:",rt),X([])});return()=>Ue()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=sr(Ct(Ce,"ar_movements"),cr("date","<=",l),Sn("date","asc")),rt=await Ht(Ue),st=[];rt.forEach(_t=>st.push({id:_t.id,..._t.data()})),D(st)}catch(Ue){console.warn("ar_movements sin ndice, usando fallback:",Ue);try{const rt=await Ht(Ct(Ce,"ar_movements")),st=[];rt.forEach(_t=>st.push({id:_t.id,..._t.data()})),D(st.filter(_t=>String(_t.date||"")<=l))}catch(rt){console.error(rt),D([])}}})()},[n,l]);const Me=g.useMemo(()=>{let ne=[...ce];if(u!=="TODAS"&&(ne=ne.filter(st=>st.status===u)),f==="CASH"&&(ne=ne.filter(st=>st.type==="CONTADO")),f==="CREDITO"&&(ne=ne.filter(st=>st.type==="CREDITO")),h!=="ALL"&&(ne=ne.filter(st=>(st.vendorId||"")===h)),p!=="ALL"&&(ne=ne.filter(st=>st.branch===p)),v.trim()){const st=v.trim().toLowerCase();ne=ne.filter(_t=>(_t.productName||"").toLowerCase().includes(st))}if(b.trim()){const st=b.trim().toLowerCase();ne=ne.filter(_t=>(de(_t)||"").toLowerCase().includes(st))}const Ue=I.trim()?Number(I):null,rt=C.trim()?Number(C):null;return Ue!==null&&!Number.isNaN(Ue)&&(ne=ne.filter(st=>(st.amount||0)>=Ue)),rt!==null&&!Number.isNaN(rt)&&(ne=ne.filter(st=>(st.amount||0)<=rt)),ne},[ce,u,f,h,p,v,b,I,C,ie]),me=g.useMemo(()=>{let ne=0,Ue=0,rt=0,st=0,_t=0,Ot=0;for(const Ir of Me){const Qr=Rr(Ir.packages),or=Rr(Ir.amount),kr=Rr(Ir.commission);Ir.type==="CREDITO"?(Ue+=Qr,st+=or,Ot+=kr):(ne+=Qr,rt+=or,_t+=kr)}const nr=qr(rt+st);return{packsCash:ml(ne),packsCredit:ml(Ue),salesCash:qr(rt),salesCredit:qr(st),salesTotal:nr,commCash:qr(_t),commCredit:qr(Ot),commTotal:qr(_t+Ot)}},[Me]),we=g.useMemo(()=>{let ne=0,Ue=0,rt=0,st=0,_t=0,Ot=0;for(const nr of ae){const Ir=Array.isArray(nr.items)?nr.items:[];for(const Qr of Ir)ne+=Rr(Qr.totalRivas),Ue+=Rr(Qr.totalSanJorge),rt+=Rr(Qr.totalIsla),st+=Rr(Qr.gainRivas),_t+=Rr(Qr.gainSanJorge),Ot+=Rr(Qr.gainIsla)}return{expectedRivas:qr(ne),expectedSanJorge:qr(Ue),expectedIsla:qr(rt),grossRivas:qr(st),grossSanJorge:qr(_t),grossIsla:qr(Ot),grossTotal:qr(st+_t+Ot),expectedTotal:qr(ne+Ue+rt)}},[ae]),pt=g.useMemo(()=>{const ne={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const Ue of Me){const rt=Ue.branch;rt&&(ne[rt].sales+=Rr(Ue.amount),ne[rt].packages+=Rr(Ue.packages))}return{RIVAS:{sales:qr(ne.RIVAS.sales),packages:ml(ne.RIVAS.packages)},SAN_JORGE:{sales:qr(ne.SAN_JORGE.sales),packages:ml(ne.SAN_JORGE.packages)},ISLA:{sales:qr(ne.ISLA.sales),packages:ml(ne.ISLA.packages)}}},[Me]),vt=g.useMemo(()=>({RIVAS:qr(pt.RIVAS.sales-we.expectedRivas),SAN_JORGE:qr(pt.SAN_JORGE.sales-we.expectedSanJorge),ISLA:qr(pt.ISLA.sales-we.expectedIsla)}),[pt,we]),bt=g.useMemo(()=>{const ne={},Ue={};for(const _t of Me){const Ot=(_t.vendorId||"").trim();if(!Ot)continue;const nr=le.find(or=>or.id===Ot),Ir=(nr==null?void 0:nr.name)||_t.vendorName||"(sin vendedor)",Qr=Rr(_t.commission);_t.type==="CREDITO"?(Ue[Ot]||(Ue[Ot]={vendorId:Ot,name:Ir,total:0}),Ue[Ot].total=qr(Ue[Ot].total+Qr)):(ne[Ot]||(ne[Ot]={vendorId:Ot,name:Ir,total:0}),ne[Ot].total=qr(ne[Ot].total+Qr))}const rt=Object.values(ne).sort((_t,Ot)=>Ot.total-_t.total),st=Object.values(Ue).sort((_t,Ot)=>Ot.total-_t.total);return{cashArr:rt,creditArr:st}},[Me,le]),kt=g.useMemo(()=>{const ne=(_r,He)=>_r.reduce((Bt,xr)=>Bt+Number((xr==null?void 0:xr[He])??0),0),Ue=_r=>{const He=Number(_r);return Number.isFinite(He)?Math.floor(He):0},rt=_r=>{const He=Number((_r==null?void 0:_r.totalPackages)??0);if(He>0)return He;const Bt=Array.isArray(_r==null?void 0:_r.items)?_r.items:[];return ne(Bt,"packages")};let st=0,_t=0;for(const _r of ae){const He=Array.isArray(_r.items)?_r.items:[];if(He.length)for(const Bt of He)st+=Number((Bt==null?void 0:Bt.subtotal)??0);else st+=Number(_r.subtotal??0);_t+=rt(_r)}let Ot=0,nr=0,Ir=0;const Qr=_r=>{const He=Number(_r==null?void 0:_r.remainingPackages);if(Number.isFinite(He)&&He>0)return Math.floor(He);const Bt=Math.max(1,Ue((_r==null?void 0:_r.unitsPerPackage)??1)),xr=Ue((_r==null?void 0:_r.remainingUnits)??(_r==null?void 0:_r.remaining)??0);return xr>0?Math.max(0,Math.floor(xr/Bt)):0};for(const _r of H)Ot+=Number(_r.subtotal??0),nr+=Number(_r.packages??0),Ir+=Qr(_r);const or=new Set(ae.filter(_r=>String(_r.date||"")>=s&&String(_r.date||"")<=l).map(_r=>_r.id));let kr=0;for(const _r of St){const He=String(_r.orderId||"").trim();He&&or.has(He)&&(kr+=Number(_r.remainingPackages??0))}const Zr=be.reduce((_r,He)=>_r+Rr(He.remainingPackages),0),nn=Xe.reduce((_r,He)=>_r+Rr(He.remainingPackages),0);return{providerTotalMaster:qr(st),providerTotalVendor:qr(Ot),orderedPacksMaster:ml(_t),remainingPacksMaster:ml(kr),orderedPacksVendor:ml(nr),remainingPacksVendor:ml(Ir),globalRemainingMaster:ml(Zr),globalRemainingVendor:ml(nn)}},[ae,H,St,s,l,be,Xe]),Vt=g.useMemo(()=>{const ne={};let Ue=0;for(const rt of Q){const st=String(rt.date||"").trim();if(!st)continue;const _t=Math.max(0,Rr(rt.amount));Ue+=_t,ne[st]=qr((ne[st]||0)+_t)}return{total:qr(Ue),byDay:ne}},[Q]),ke=g.useMemo(()=>{let ne=0;for(const Ue of ae){const rt=Array.isArray(Ue.items)?Ue.items:[];if(rt.length)for(const st of rt)ne+=Rr(st==null?void 0:st.subtotal);else ne+=Rr(Ue.subtotal)}return qr(ne)},[ae]),Ne=g.useMemo(()=>{var Qr;const ne=or=>{const kr=Math.max(1,Math.floor(Rr(or.unitsPerPackage||1))),Zr=Rr(or.totalUnits)>0?Rr(or.totalUnits):Rr(or.packages)*kr;let nn=0;Rr(or.remainingUnits)>0?nn=Rr(or.remainingUnits):Rr(or.remainingPackages)>0?nn=Rr(or.remainingPackages)*kr:nn=0;const _r=Math.max(0,Zr-nn);return{orderedUnits:Zr,remainingUnits:nn,soldUnits:_r,upp:kr}},Ue=or=>{const kr=xe[or];return lj(kr==null?void 0:kr.branch)||"ISLA"},rt=(or,kr)=>{var Zr,nn,_r;return kr==="ISLA"?Rr(((Zr=De[String(or.productId||"")])==null?void 0:Zr.unitPriceIsla)??or.unitPriceIsla):kr==="RIVAS"?Rr(((nn=De[String(or.productId||"")])==null?void 0:nn.unitPriceRivas)??or.unitPriceRivas):kr==="SAN_JORGE"?Rr(((_r=De[String(or.productId||"")])==null?void 0:_r.unitPriceSanJorge)??or.unitPriceSanJorge):0},st=(or,kr)=>{const Zr=Math.max(0,Math.floor(Rr(or.packages))),nn=rt(or,kr),_r=qr(nn*Zr);if(_r>0)return _r;const He=Rr(or.totalVendor)||(kr==="ISLA"?Rr(or.totalIsla):kr==="RIVAS"?Rr(or.totalRivas):kr==="SAN_JORGE"?Rr(or.totalSanJorge):0);if(He>0)return He;const Bt=Rr(or.unitPriceVendor);if(Bt>0){const{orderedUnits:xr}=ne(or);return Bt*xr}return 0},_t=(or,kr)=>{const Zr=rt(or,kr),{orderedUnits:nn,upp:_r}=ne(or);if(Zr>0&&_r>0)return Zr/_r;const He=Rr(or.unitPriceVendor);if(He>0)return He;const Bt=st(or,kr);return Bt>0&&nn>0?Bt/nn:0},Ot=new Map;for(const or of H){const kr=String(or.orderId||"").trim(),Zr=kr||`DOC:${or.id}`,nn=String(or.sellerId||"").trim(),_r=String(or.sellerName||"").trim()||nn&&((Qr=xe[nn])==null?void 0:Qr.name)||""||"(sin vendedor)",He=String(or.date||"").trim(),Bt=nn?Ue(nn):"",{orderedUnits:xr,remainingUnits:dn,soldUnits:Jr}=ne(or),br=st(or,Bt),er=_t(or,Bt),ir=er>0?er*Jr:xr>0?br*Jr/xr:0,Sr=qr(br-ir);Ot.has(Zr)||Ot.set(Zr,{orderKey:Zr,orderId:kr||Zr,date:He,sellerId:nn,sellerName:_r,branch:Bt,totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0,lines:[]});const vr=Ot.get(Zr);vr.lines.push({...or,orderedUnits:xr,soldUnits:Jr,remainingUnits:dn,lineTotal:qr(br),lineSoldValue:qr(ir),lineRemainingValue:qr(Sr)}),vr.totalOrden+=br,vr.vendido+=ir,vr.restante+=Sr,vr.comision+=Rr(or.uVendor??or.vendorProfit??or.gainVendor)}for(const or of Ot.values())or.comision=qr(or.comision),or.totalEsperado=qr(or.totalOrden-or.comision),or.totalOrden=qr(or.totalOrden),or.vendido=qr(or.vendido),or.restante=qr(or.restante);const nr=Array.from(Ot.values()).sort((or,kr)=>or.date&&kr.date?or.date<kr.date?1:-1:kr.totalOrden-or.totalOrden),Ir=nr.reduce((or,kr)=>(or.totalOrden+=Rr(kr.totalOrden),or.vendido+=Rr(kr.vendido),or.restante+=Rr(kr.restante),or.comision+=Rr(kr.comision),or.totalEsperado+=Rr(kr.totalEsperado),or),{totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0});return{global:{totalOrden:qr(Ir.totalOrden),vendido:qr(Ir.vendido),restante:qr(Ir.restante),comision:qr(Ir.comision),totalEsperado:qr(Ir.totalEsperado)},orders:nr}},[H,xe,De]),pe=g.useMemo(()=>{var st,_t,Ot;let ne=0,Ue=0;for(const nr of H){const Ir=String(nr.sellerId||"").trim(),Qr=Ir?xe[Ir]:void 0,or=lj(Qr==null?void 0:Qr.branch)||"ISLA",kr=Math.max(0,Math.floor(Rr(nr.packages)));if(!kr)continue;const Zr=Rr(or==="ISLA"?((st=De[String(nr.productId||"")])==null?void 0:st.unitPriceIsla)??nr.unitPriceIsla:or==="RIVAS"?((_t=De[String(nr.productId||"")])==null?void 0:_t.unitPriceRivas)??nr.unitPriceRivas:((Ot=De[String(nr.productId||"")])==null?void 0:Ot.unitPriceSanJorge)??nr.unitPriceSanJorge);let nn=qr(Zr*kr);nn||(nn=Rr(or==="ISLA"?nr.totalIsla:or==="RIVAS"?nr.totalRivas:nr.totalSanJorge)),nn&&(ne+=nn,Ue+=nn)}const rt=qr(Rr(we.expectedIsla)-Ue);return{dispersedTotal:qr(ne),dispersedIsla:qr(Ue),totalExistenteIsla:rt}},[H,xe,we.expectedIsla,De]),Le=g.useMemo(()=>({net:qr(H.reduce((Ue,rt)=>{const st=rt.uNeta,_t=Rr(st);if(_t!==0||st===0)return Ue+_t;const Ot=Rr(rt.grossProfit),nr=Rr(rt.logisticAllocated??rt.gastos??rt.gasto),Ir=Rr(rt.uVendor??rt.vendorProfit);return Ue+(Ot-nr-Ir)},0))}),[H]),ft=g.useMemo(()=>{let ne=0,Ue=0,rt=0;for(const st of Me){if(st.type!=="CREDITO")continue;const _t=Rr(st.amount),Ot=Rr(st.commission);ne+=_t,Ue+=_t-Ot}for(const st of Y){const _t=String(st.date||"").trim();if(!_t||_t<s||_t>l)continue;const Ot=Rr(st.amount);(st.type||(Ot<0?"ABONO":"CARGO"))==="ABONO"&&(rt+=Math.abs(Ot))}return{cxc:qr(ne),recaudado:qr(rt),utilidadBruta:qr(Ue)}},[Me,Y,s,l]),At=g.useMemo(()=>{if(!je)return null;const ne=Ne.orders.find(st=>st.orderKey===je);if(!ne)return null;const Ue={};for(const st of ne.lines){const _t=String(st.productName||"(sin nombre)");Ue[_t]||(Ue[_t]={productName:_t,asociados:0,vendidos:0,restantes:0});const Ot=Math.max(0,Math.floor(Rr(st.packages))),nr=Math.max(1,Math.floor(Rr(st.unitsPerPackage||1))),Ir=Math.max(0,Math.floor(Rr(st.remainingPackages)||(Rr(st.remainingUnits)>0?Rr(st.remainingUnits)/nr:0))),Qr=Math.max(0,Ot-Ir);Ue[_t].asociados+=Ot,Ue[_t].vendidos+=Qr,Ue[_t].restantes+=Ir}const rt=Object.values(Ue).map(st=>({...st,asociados:Math.floor(st.asociados),vendidos:Math.floor(st.vendidos),restantes:Math.floor(st.restantes)})).sort((st,_t)=>_t.asociados-st.asociados);return{...ne,products:rt}},[je,Ne.orders]),ct=g.useMemo(()=>{const ne=be.reduce((rt,st)=>rt+Rr(st.remainingPackages),0),Ue=Xe.reduce((rt,st)=>rt+Rr(st.remainingPackages),0);return{masterRemainingPackages:ml(ne),vendorRemainingPackages:ml(Ue)}},[be,Xe]),W=g.useMemo(()=>{const ne=new Map,Ue=st=>E==="DIA"?{key:st.date,label:st.date}:E==="VENDEDOR"?{key:st.vendorId||"",label:st.vendorName||""}:E==="PRODUCTO"?{key:st.productName||"",label:st.productName||""}:{key:st.branch||"",label:st.branch||""};for(const st of Me){const{key:_t,label:Ot}=Ue(st);ne.has(_t)||ne.set(_t,{key:_t,label:Ot,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const nr=ne.get(_t);nr.rows.push(st),st.type==="CREDITO"?(nr.packsCredit+=Rr(st.packages),nr.salesCredit+=Rr(st.amount),nr.commCredit+=Rr(st.commission)):(nr.packsCash+=Rr(st.packages),nr.salesCash+=Rr(st.amount),nr.commCash+=Rr(st.commission))}const rt=Array.from(ne.values()).map(st=>({...st,packsCash:ml(st.packsCash),packsCredit:ml(st.packsCredit),salesCash:qr(st.salesCash),salesCredit:qr(st.salesCredit),commCash:qr(st.commCash),commCredit:qr(st.commCredit)}));return E==="DIA"?rt.sort((st,_t)=>st.key<_t.key?1:-1):rt.sort((st,_t)=>_t.salesCash+_t.salesCredit-(st.salesCash+st.salesCredit)),rt},[Me,E]),z=g.useMemo(()=>{if(!ee)return[];const ne=W.find(Ue=>Ue.key===ee);return(ne==null?void 0:ne.rows)||[]},[ee,W]),re=g.useMemo(()=>{const ne={};for(const Ue of z){const rt=Ue.productName||"(sin nombre)";ne[rt]||(ne[rt]={productName:rt,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),Ue.type==="CREDITO"?(ne[rt].packsCredit+=Rr(Ue.packages),ne[rt].salesCredit+=Rr(Ue.amount),ne[rt].commCredit+=Rr(Ue.commission)):(ne[rt].packsCash+=Rr(Ue.packages),ne[rt].salesCash+=Rr(Ue.amount),ne[rt].commCash+=Rr(Ue.commission))}return Object.values(ne).map(Ue=>({...Ue,packsCash:ml(Ue.packsCash),packsCredit:ml(Ue.packsCredit),salesCash:qr(Ue.salesCash),salesCredit:qr(Ue.salesCredit),commCash:qr(Ue.commCash),commCredit:qr(Ue.commCredit)})).sort((Ue,rt)=>rt.salesCash+rt.salesCredit-(Ue.salesCash+Ue.salesCredit))},[z]),V=g.useMemo(()=>{const ne={},Ue=Ot=>(ie[Ot]||"").trim()||Ot;for(const Ot of R){const nr=String(Ot.id||"").trim();nr&&(ne[nr]={customerId:nr,name:Ue(nr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:Rr(Ot.initialDebt),initialDebtDate:String(Ot.initialDebtDate||"").trim(),movements:[]})}for(const Ot of Y){const nr=String(Ot.customerId||"").trim();if(!nr)continue;const Ir=String(Ot.date||"");Ir&&Ir>l||(ne[nr]||(ne[nr]={customerId:nr,name:Ue(nr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:0,initialDebtDate:"",movements:[]}),ne[nr].movements.push(Ot))}const rt=(Ot,nr,Ir)=>{const Qr=Number(Ot||0);if(!Qr)return 0;const or=String(nr||"").trim();return or&&Ir.some(Zr=>{var xr;const nn=Number(Zr.amount||0);if(!(nn>0))return!1;const _r=Math.abs(nn-Qr)<.01,He=String(Zr.date||"").trim()===or,Bt=!!((xr=Zr.ref)!=null&&xr.saleId);return _r&&He&&Bt})?0:Qr},st=Object.values(ne).map(Ot=>{const nr=Ot.movements.reduce((kr,Zr)=>kr+Rr(Zr.amount),0),Ir=rt(Ot.initialDebt,Ot.initialDebtDate,Ot.movements);let Qr="",or=0;for(const kr of Ot.movements){const Zr=kr.type||(Rr(kr.amount)<0?"ABONO":"CARGO"),nn=String(kr.date||"");if(Zr==="ABONO"){const _r=Math.abs(Rr(kr.amount));(!Qr||nn>Qr)&&(Qr=nn,or=_r)}}return{customerId:Ot.customerId,name:Ot.name,balance:qr(Ir+nr),lastPayment:Qr,lastPaymentAmount:qr(or)}}).filter(Ot=>Ot.balance>0).sort((Ot,nr)=>nr.balance-Ot.balance),_t=qr(st.reduce((Ot,nr)=>Ot+nr.balance,0));return{count:st.length,totalPending:_t,list:st.slice(0,20)}},[Y,ie,R,l]),L=g.useMemo(()=>{if(!Ze)return[];const ne=Y.filter(rt=>(rt.customerId||"").trim()===Ze.customerId).filter(rt=>!rt.date||String(rt.date)<=l).map(rt=>({id:rt.id,date:String(rt.date||""),type:String(rt.type||""),amount:qr(Rr(rt.amount))})).sort((rt,st)=>rt.date<st.date?-1:rt.date>st.date?1:0);let Ue=0;return ne.map(rt=>{const st=rt.type==="ABONO"?-rt.amount:rt.amount;return Ue=qr(Ue+st),{...rt,running:Ue}})},[Ze,Y,l]),fe=g.useMemo(()=>Ze?ce.filter(ne=>(ne.customerId||"").trim()===Ze.customerId).filter(ne=>!ne.date||String(ne.date)<=l).sort((ne,Ue)=>ne.date<Ue.date?-1:ne.date>Ue.date?1:0):[],[Ze,ce,l]),Be=g.useMemo(()=>{const ne=qr(me.salesTotal),Ue=qr(me.commTotal),rt=qr(Vt.total),st=qr(ne-Ue-rt),_t=new Set;for(const kr of Me)kr.date&&_t.add(kr.date);const Ot=Math.max(1,_t.size),nr=qr(ne/Ot),Ir=qr(Ue/Ot),Qr=qr(rt/Ot),or=qr(st/Ot);return{ingreso:ne,comision:Ue,gastos:rt,gananciaNeta:st,daysCount:Ot,ingresoDia:nr,comisionDia:Ir,gastosDia:Qr,netaDia:or}},[me,Vt.total,Me]),ye=g.useMemo(()=>{const ne={};for(const _t of Me){const Ot=_t.date;Ot&&(ne[Ot]||(ne[Ot]={date:Ot,ingreso:0,comision:0}),ne[Ot].ingreso+=Rr(_t.amount),ne[Ot].comision+=Rr(_t.commission))}const Ue=Object.keys(ne).sort((_t,Ot)=>_t<Ot?-1:1),rt=Ue.map(_t=>({label:_t.slice(5),value:qr(ne[_t].ingreso)})),st=Ue.map(_t=>{var or,kr;const Ot=Rr((or=ne[_t])==null?void 0:or.ingreso),nr=Rr((kr=ne[_t])==null?void 0:kr.comision),Ir=Rr(Vt.byDay[_t]||0),Qr=Ot-nr-Ir;return{label:_t.slice(5),value:qr(Qr)}});return{seriesIngreso:rt,seriesNeta:st,datesCount:Ue.length}},[Me,Vt.byDay]),$e=g.useMemo(()=>[{label:"Rivas",value:Rr(pt.RIVAS.sales)},{label:"San Jorge",value:Rr(pt.SAN_JORGE.sales)},{label:"Isla",value:Rr(pt.ISLA.sales)}].map(ne=>({...ne,value:qr(ne.value)})),[pt]),ze=async()=>{if(Et.current){Et.current.classList.add("force-pdf-colors");try{const Ue=(await Hm(Et.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),rt=new rn;rt.addImage(Ue,"PNG",10,10,190,0),rt.save(`data_center_dulces_${s}_a_${l}.pdf`)}finally{Et.current.classList.remove("force-pdf-colors")}}},Ke=()=>{const Ue=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...Me.map(Ot=>[Ot.date,Ot.processedDate||"",Ot.status,Ot.type,Ot.vendorId,`"${String(Ot.vendorName||"").replace(/"/g,'""')}"`,Ot.branch||"",`"${String(Ot.productName||"").replace(/"/g,'""')}"`,ii(Ot.packages),Ur(Ot.amount),Ur(Ot.commission),Ot.customerId||"",`"${String(de(Ot)||"").replace(/"/g,'""')}"`].join(","))],rt=new Blob([Ue.join(`
`)],{type:"text/csv;charset=utf-8;"}),st=URL.createObjectURL(rt),_t=document.createElement("a");_t.href=st,_t.download=`data_center_dulces_${s}_a_${l}.csv`,_t.click(),URL.revokeObjectURL(st)};return n?i.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-0",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[i.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-end",children:[i.jsx("button",{onClick:ze,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-green-600 text-white hover:bg-green-700 transition-colors\r
              `,children:"Exportar PDF"}),i.jsx("button",{onClick:Ke,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-gray-800 text-white hover:bg-black transition-colors\r
              `,children:"Exportar CSV"})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Re(ne=>!ne),"aria-expanded":Tt,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${Tt?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Tt?"block":"hidden"} border-t p-3 sm:p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:s,onChange:ne=>o(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:l,onChange:ne=>c(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:u,onChange:ne=>d(ne.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Tipo"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:f,onChange:ne=>A(ne.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:h,onChange:ne=>m(ne.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),le.map(ne=>i.jsx("option",{value:ne.id,children:ne.name||ne.id},ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Sucursal"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:p,onChange:ne=>x(ne.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:v,onChange:ne=>y(ne.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:b,onChange:ne=>w(ne.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto min"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:I,onChange:ne=>j(ne.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto max"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:C,onChange:ne=>S(ne.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:E,onChange:ne=>{Fe(""),B(ne.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})})]}),i.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{Se(""),Ut("MACRO")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Qt==="MACRO"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Macro"}),i.jsx("button",{onClick:()=>{Se(""),Ut("DETALLE")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Qt==="DETALLE"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Detalle"})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Gastos del perodo (expenses_candies):"," ",i.jsxs("strong",{children:["C$",Ur(Vt.total)]})]})]}),i.jsxs("div",{ref:Et,children:[Qt==="MACRO"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ye(ne=>!ne),"aria-expanded":Te,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${Te?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Te?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ingreso (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(Be.ingreso)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin vendedor (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Ur(Be.comision)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Ur(me.commCash),"  Crdito: C$",Ur(me.commCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos (expenses_candies)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Ur(Be.gastos)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se calcula automtico por fechas"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia neta (real)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(Be.gananciaNeta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ingreso  Comisin  Gastos"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Promedio neto por da"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(Be.netaDia)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Das con ventas: ",i.jsx("strong",{children:Be.daysCount})]})]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[i.jsx(TG,{title:"Ventas por da (Ingreso)",series:ye.seriesIngreso,valuePrefix:"C$"}),i.jsx(TG,{title:"Ganancia neta por da (real)",series:ye.seriesNeta,valuePrefix:"C$"})]}),i.jsx("div",{className:"mb-6",children:i.jsx(SVe,{title:"Distribucin de ventas por sucursal",items:$e})})]}),Qt==="DETALLE"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ye(ne=>!ne),"aria-expanded":Te,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${Te?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${Te?"block":"hidden"} border-t p-3`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(me.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(me.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(me.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Ur(me.salesCash),"  Crdito: C$",Ur(me.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(me.commTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Ur(me.commCash),"  Crdito: C$",Ur(me.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Aprox. (rdenes maestras)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(we.grossIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Ur(we.expectedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Ur(pt.ISLA.sales)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Ur(vt.ISLA)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado (precio proveedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(ke)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes maestras (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad neta (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(Le.net)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"U bruta  Gastos  U vendedor"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(kt.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:ii(kt.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:ii(ct.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(kt.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:ii(kt.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:ii(ct.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(kt.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos dispersados (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(pe.dispersedTotal)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes de vendedores (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Dispersado Isla (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(pe.dispersedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Usado para Total existente"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total existente en productos (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(pe.totalExistenteIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esperado Isla  Dispersado Isla"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"CxC (ventas crdito)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(ft.cxc)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(me.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Recaudacin (abonos)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(ft.recaudado)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"abonos en ar_movements"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta crdito (ventas  comisin)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Ur(ft.utilidadBruta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Paquetes vendidos al crdito"})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Oe(ne=>!ne),"aria-expanded":ht,children:[i.jsx("span",{children:"rdenes vendedores"}),i.jsx("span",{className:`transition-transform ${ht?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${ht?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-4 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Global)"}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Basado en ",i.jsx("strong",{children:"precio de venta"})," (por sucursal del vendedor)"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Ur(Ne.global.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Ur(Ne.global.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Ur(Ne.global.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Ur(Ne.global.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Ur(Ne.global.totalEsperado)]})]})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Detalle por orden)"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Click/Tap en una orden para ver productos asociados/vendidos/restantes"})]}),Ne.orders.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:Ne.orders.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.orderId}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1 truncate",children:[ne.sellerName," ",ne.branch?` ${ne.branch}`:""," ",ne.date?` ${ne.date}`:""]})]}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>Se(ne.orderKey),children:"Ver"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.totalOrden)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendido"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.vendido)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restante"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.restante)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.comision)]})]})]})]},ne.orderKey))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total orden"}),i.jsx("th",{className:"border p-2",children:"Vendido"}),i.jsx("th",{className:"border p-2",children:"Restante"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Total esperado"}),i.jsx("th",{className:"border p-2",children:"Accin"})]})}),i.jsx("tbody",{children:Ne.orders.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.sellerName}),i.jsx("td",{className:"border p-2",children:ne.branch||""}),i.jsx("td",{className:"border p-2",children:ne.date||""}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.totalOrden)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.vendido)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.restante)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.comision)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.totalEsperado)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>Se(ne.orderKey),children:"Ver detalle"})})]},ne.orderKey))})]})}),At&&i.jsxs("div",{className:"mt-4 rounded-2xl border-2 border-gray-100 p-3 sm:p-4 shadow-lg bg-white",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h4",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle orden vendedor "," ",At.orderId]}),i.jsx("button",{onClick:()=>Se(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Ur(At.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Ur(At.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Ur(At.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Ur(At.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Ur(At.totalEsperado)]})]})]}),i.jsx("h5",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Productos asociados (Nombre - Asociados - Vendidos - Restantes)"}),i.jsx("div",{className:"md:hidden space-y-2",children:At.products.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:ne.productName}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Asociados"}),i.jsx("div",{className:"font-bold",children:ne.asociados})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendidos"}),i.jsx("div",{className:"font-bold",children:ne.vendidos})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-bold",children:ne.restantes})]})]})]},ne.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Nombre producto"}),i.jsx("th",{className:"border p-2",children:"Asociados"}),i.jsx("th",{className:"border p-2",children:"Vendidos"}),i.jsx("th",{className:"border p-2",children:"Restantes"})]})}),i.jsxs("tbody",{children:[At.products.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.productName}),i.jsx("td",{className:"border p-2",children:ne.asociados}),i.jsx("td",{className:"border p-2",children:ne.vendidos}),i.jsx("td",{className:"border p-2",children:ne.restantes})]},ne.productName)),At.products.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-500",children:"Sin productos."})})]})]})})]})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>We(ne=>!ne),"aria-expanded":Ie,children:[i.jsx("span",{children:"Existencias"}),i.jsx("span",{className:`transition-transform ${Ie?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Ie?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(ct.masterRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (vendedores)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(ct.vendorRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Qe(ne=>!ne),"aria-expanded":Z,children:[i.jsx("span",{children:"Vendedores"}),i.jsx("span",{className:`transition-transform ${Z?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Z?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),bt.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:bt.cashArr.map(ne=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ne.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ur(ne.total)]})]},ne.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),bt.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:bt.creditArr.map(ne=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ne.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ur(ne.total)]})]},ne.vendorId))})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-6",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ge(ne=>!ne),"aria-expanded":at,children:[i.jsx("span",{children:"Saldos pendientes"}),i.jsx("span",{className:`transition-transform ${at?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${at?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:["Saldos pendientes (hasta ",l,")"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:V.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Ur(V.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),V.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:V.list.map(ne=>i.jsxs("div",{className:"border rounded-xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.name}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Ur(ne.balance)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["ltimo abono:"," ",i.jsxs("b",{children:["C$",Ur(ne.lastPaymentAmount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha ult. abono:"," ",i.jsx("span",{className:"font-medium",children:ne.lastPayment||""})]}),i.jsx("div",{className:"mt-2",children:i.jsx("button",{type:"button",onClick:()=>ut(ne),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},ne.customerId))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:V.list.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.name}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.balance)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.lastPaymentAmount)]}),i.jsx("td",{className:"border p-2",children:ne.lastPayment||""}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{type:"button",onClick:()=>ut(ne),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},ne.customerId))})]})})]})]})]}),i.jsxs("div",{className:"mb-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold text-sm sm:text-base",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 sm:ml-auto",children:"Tap/Click en Ver detalle para drill-down"})]}),k?i.jsx("p",{className:"text-sm",children:"Cargando..."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2 mb-6",children:W.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."}):W.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.label}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>Fe(ne.key),children:"Ver detalle"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"font-bold",children:ii(ne.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"font-bold",children:ii(ne.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.commCredit)]})]})]})]},ne.key))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-6 shadow-2xl rounded-xl border",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[W.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.label}),i.jsx("td",{className:"border p-2",children:ii(ne.packsCash)}),i.jsx("td",{className:"border p-2",children:ii(ne.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.commCredit)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>Fe(ne.key),children:"Ver detalle"})})]},ne.key)),W.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]})})]}),ee&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-3 sm:p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h2",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle "," ",((yt=W.find(ne=>ne.key===ee))==null?void 0:yt.label)||ee]}),i.jsx("button",{onClick:()=>Fe(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Ur(z.filter(ne=>ne.type==="CONTADO").reduce((ne,Ue)=>ne+Rr(Ue.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Ur(z.filter(ne=>ne.type==="CREDITO").reduce((ne,Ue)=>ne+Rr(Ue.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes cash:"," ",i.jsx("strong",{children:ii(z.filter(ne=>ne.type==="CONTADO").reduce((ne,Ue)=>ne+Rr(Ue.packages),0))})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes crdito:"," ",i.jsx("strong",{children:ii(z.filter(ne=>ne.type==="CREDITO").reduce((ne,Ue)=>ne+Rr(Ue.packages),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Ventas incluidas"}),i.jsx("div",{className:"md:hidden space-y-2 mb-4",children:z.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin detalle."}):z.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.productName}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Ur(ne.amount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:ne.vendorName})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Tipo"}),i.jsx("div",{className:"font-bold",children:ne.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Sucursal"}),i.jsx("div",{className:"font-bold",children:ne.branch||""})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-bold",children:ii(ne.packages)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.commission)]})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Fecha: ",ne.date]})]},ne.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[z.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2",children:ne.vendorName}),i.jsx("td",{className:"border p-2",children:ne.productName}),i.jsx("td",{className:"border p-2",children:ne.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-2",children:ne.branch||""}),i.jsx("td",{className:"border p-2",children:ii(ne.packages)}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.amount)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.commission)]}),i.jsx("td",{className:"border p-2",children:ne.date})]},ne.id)),z.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin detalle."})})]})]})}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Consolidado por producto"}),i.jsx("div",{className:"md:hidden space-y-2",children:re.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin consolidado."}):re.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:ne.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq cash"}),i.jsx("div",{className:"font-bold",children:ii(ne.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq crdito"}),i.jsx("div",{className:"font-bold",children:ii(ne.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Ur(ne.commCredit)]})]})]})]},ne.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[re.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.productName}),i.jsx("td",{className:"border p-2",children:ii(ne.packsCash)}),i.jsx("td",{className:"border p-2",children:ii(ne.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Ur(ne.commCredit)]})]},ne.productName)),re.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Sin consolidado."})})]})]})})]})]})]}),P&&i.jsx("p",{className:"mt-3 text-sm",children:P})]}),Ze&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:Ze.name}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Saldo pendiente: ",i.jsxs("b",{children:["C$",Ur(Ze.balance)]})]})]}),i.jsx("button",{type:"button",onClick:()=>ut(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Saldo"})]})}),i.jsx("tbody",{children:L.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin movimientos."})}):L.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ne.date||""}),i.jsx("td",{className:"border p-1",children:ne.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Ur(ne.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Ur(ne.running)]})]},ne.id))})]})}),i.jsx("div",{className:"mt-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:fe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"border p-2 text-center text-gray-500",children:"Sin ventas asociadas."})}):fe.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ne.date||""}),i.jsx("td",{className:"border p-1",children:ne.productName||""}),i.jsx("td",{className:"border p-1",children:ne.vendorName||""}),i.jsx("td",{className:"border p-1",children:ne.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Ur(ne.amount)]})]},ne.id))})]})})]})})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 md:p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function qse(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=qse(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ss(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=qse(t))&&(n&&(n+=" "),n+=e);return n}var PVe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function qR(t){if(typeof t!="string")return!1;var e=PVe;return e.includes(t)}var TVe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],BVe=new Set(TVe);function zse(t){return typeof t!="string"?!1:BVe.has(t)}function Wse(t){return typeof t=="string"&&t.startsWith("data-")}function dh(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(zse(r)||Wse(r))&&(e[r]=t[r]);return e}function J2(t){if(t==null)return null;if(g.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return dh(e)}return typeof t=="object"&&!Array.isArray(t)?dh(t):null}function Rd(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(zse(r)||Wse(r)||qR(r))&&(e[r]=t[r]);return e}var kVe=["children","width","height","viewBox","className","style","title","desc"];function _F(){return _F=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_F.apply(null,arguments)}function FVe(t,e){if(t==null)return{};var r,n,a=OVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function OVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var zR=g.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:u}=t,d=FVe(t,kVe),f=s||{width:n,height:a,x:0,y:0},A=ss("recharts-surface",o);return g.createElement("svg",_F({},Rd(d),{className:A,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),g.createElement("title",null,c),g.createElement("desc",null,u),r)}),DVe=["children","className"];function EF(){return EF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EF.apply(null,arguments)}function RVe(t,e){if(t==null)return{};var r,n,a=MVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function MVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Fc=g.forwardRef((t,e)=>{var{children:r,className:n}=t,a=RVe(t,DVe),s=ss("recharts-layer",n);return g.createElement("g",EF({className:s},Rd(a),{ref:e}),r)}),Xse=g.createContext(null),LVe=()=>g.useContext(Xse);function bs(t){return function(){return t}}const Yse=Math.cos,cj=Math.sin,kf=Math.sqrt,uj=Math.PI,wP=2*uj,SF=Math.PI,jF=2*SF,pp=1e-6,UVe=jF-pp;function Jse(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function QVe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Jse;const r=10**e;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class VVe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Jse:QVe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,s,o){this._append`C${+e},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(e,r,n,a,s){if(e=+e,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-e,u=a-r,d=o-e,f=l-r,A=d*d+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(A>pp)if(!(Math.abs(f*c-u*d)>pp)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let h=n-o,m=a-l,p=c*c+u*u,x=h*h+m*m,v=Math.sqrt(p),y=Math.sqrt(A),b=s*Math.tan((SF-Math.acos((p+A-x)/(2*v*y)))/2),w=b/y,I=b/v;Math.abs(w-1)>pp&&this._append`L${e+w*d},${r+w*f}`,this._append`A${s},${s},0,0,${+(f*h>d*m)},${this._x1=e+I*c},${this._y1=r+I*u}`}}arc(e,r,n,a,s,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=e+l,d=r+c,f=1^o,A=o?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>pp||Math.abs(this._y1-d)>pp)&&this._append`L${u},${d}`,n&&(A<0&&(A=A%jF+jF),A>UVe?this._append`A${n},${n},0,1,${f},${e-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:A>pp&&this._append`A${n},${n},0,${+(A>=SF)},${f},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function WR(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new VVe(e)}function XR(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Zse(t){this._context=t}Zse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function NP(t){return new Zse(t)}function eie(t){return t[0]}function tie(t){return t[1]}function rie(t,e){var r=bs(!0),n=null,a=NP,s=null,o=WR(l);t=typeof t=="function"?t:t===void 0?eie:bs(t),e=typeof e=="function"?e:e===void 0?tie:bs(e);function l(c){var u,d=(c=XR(c)).length,f,A=!1,h;for(n==null&&(s=a(h=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===A&&((A=!A)?s.lineStart():s.lineEnd()),A&&s.point(+t(f,u,c),+e(f,u,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:bs(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:bs(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:bs(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function g_(t,e,r){var n=null,a=bs(!0),s=null,o=NP,l=null,c=WR(u);t=typeof t=="function"?t:t===void 0?eie:bs(+t),e=typeof e=="function"?e:bs(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?tie:bs(+r);function u(f){var A,h,m,p=(f=XR(f)).length,x,v=!1,y,b=new Array(p),w=new Array(p);for(s==null&&(l=o(y=c())),A=0;A<=p;++A){if(!(A<p&&a(x=f[A],A,f))===v)if(v=!v)h=A,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=A-1;m>=h;--m)l.point(b[m],w[m]);l.lineEnd(),l.areaEnd()}v&&(b[A]=+t(x,A,f),w[A]=+e(x,A,f),l.point(n?+n(x,A,f):b[A],r?+r(x,A,f):w[A]))}if(y)return l=null,y+""||null}function d(){return rie().defined(a).curve(o).context(s)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:bs(+f),n=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:bs(+f),u):t},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:bs(+f),u):n},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:bs(+f),r=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:bs(+f),u):e},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:bs(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(t).y(e)},u.lineY1=function(){return d().x(t).y(r)},u.lineX1=function(){return d().x(n).y(e)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:bs(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class nie{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function HVe(t){return new nie(t,!0)}function $Ve(t){return new nie(t,!1)}const YR={draw(t,e){const r=kf(e/uj);t.moveTo(r,0),t.arc(0,0,r,0,wP)}},GVe={draw(t,e){const r=kf(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},aie=kf(1/3),KVe=aie*2,qVe={draw(t,e){const r=kf(e/KVe),n=r*aie;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},zVe={draw(t,e){const r=kf(e),n=-r/2;t.rect(n,n,r,r)}},WVe=.8908130915292852,sie=cj(uj/10)/cj(7*uj/10),XVe=cj(wP/10)*sie,YVe=-Yse(wP/10)*sie,JVe={draw(t,e){const r=kf(e*WVe),n=XVe*r,a=YVe*r;t.moveTo(0,-r),t.lineTo(n,a);for(let s=1;s<5;++s){const o=wP*s/5,l=Yse(o),c=cj(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*a,c*n+l*a)}t.closePath()}},hT=kf(3),ZVe={draw(t,e){const r=-kf(e/(hT*3));t.moveTo(0,r*2),t.lineTo(-hT*r,-r),t.lineTo(hT*r,-r),t.closePath()}},od=-.5,ld=kf(3)/2,IF=1/kf(12),eHe=(IF/2+1)*3,tHe={draw(t,e){const r=kf(e/eHe),n=r/2,a=r*IF,s=n,o=r*IF+r,l=-s,c=o;t.moveTo(n,a),t.lineTo(s,o),t.lineTo(l,c),t.lineTo(od*n-ld*a,ld*n+od*a),t.lineTo(od*s-ld*o,ld*s+od*o),t.lineTo(od*l-ld*c,ld*l+od*c),t.lineTo(od*n+ld*a,od*a-ld*n),t.lineTo(od*s+ld*o,od*o-ld*s),t.lineTo(od*l+ld*c,od*c-ld*l),t.closePath()}};function rHe(t,e){let r=null,n=WR(a);t=typeof t=="function"?t:bs(t||YR),e=typeof e=="function"?e:bs(e===void 0?64:+e);function a(){let s;if(r||(r=s=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:bs(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:bs(+s),a):e},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function dj(){}function fj(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function iie(t){this._context=t}iie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:fj(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:fj(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function nHe(t){return new iie(t)}function oie(t){this._context=t}oie.prototype={areaStart:dj,areaEnd:dj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:fj(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function aHe(t){return new oie(t)}function lie(t){this._context=t}lie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:fj(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function sHe(t){return new lie(t)}function cie(t){this._context=t}cie.prototype={areaStart:dj,areaEnd:dj,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function iHe(t){return new cie(t)}function BG(t){return t<0?-1:1}function kG(t,e,r){var n=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(n||a<0&&-0),o=(r-t._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(BG(s)+BG(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function FG(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function AT(t,e,r){var n=t._x0,a=t._y0,s=t._x1,o=t._y1,l=(s-n)/3;t._context.bezierCurveTo(n+l,a+l*e,s-l,o-l*r,s,o)}function hj(t){this._context=t}hj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:AT(this,this._t0,FG(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,AT(this,FG(this,r=kG(this,t,e)),r);break;default:AT(this,this._t0,r=kG(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function uie(t){this._context=new die(t)}(uie.prototype=Object.create(hj.prototype)).point=function(t,e){hj.prototype.point.call(this,e,t)};function die(t){this._context=t}die.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,s){this._context.bezierCurveTo(e,t,n,r,s,a)}};function oHe(t){return new hj(t)}function lHe(t){return new uie(t)}function fie(t){this._context=t}fie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=OG(t),a=OG(e),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function OG(t){var e,r=t.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function cHe(t){return new fie(t)}function CP(t,e){this._context=t,this._t=e}CP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function uHe(t){return new CP(t,.5)}function dHe(t){return new CP(t,0)}function fHe(t){return new CP(t,1)}function Ng(t,e){if((o=t.length)>1)for(var r=1,n,a,s=t[e[0]],o,l=s.length;r<o;++r)for(a=s,s=t[e[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function PF(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function hHe(t,e){return t[e]}function AHe(t){const e=[];return e.key=t,e}function mHe(){var t=bs([]),e=PF,r=Ng,n=hHe;function a(s){var o=Array.from(t.apply(this,arguments),AHe),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=XR(e(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:bs(Array.from(s)),a):t},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:bs(+s),a):n},a.order=function(s){return arguments.length?(e=s==null?PF:typeof s=="function"?s:bs(Array.from(s)),a):e},a.offset=function(s){return arguments.length?(r=s??Ng,a):r},a}function pHe(t,e){if((n=t.length)>0){for(var r,n,a=0,s=t[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<n;++r)t[r][a][1]/=o}Ng(t,e)}}function gHe(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}Ng(t,e)}}function xHe(t,e){if(!(!((o=t.length)>0)||!((s=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=t[e[l]],f=d[n][1]||0,A=d[n-1][1]||0,h=(f-A)/2,m=0;m<l;++m){var p=t[e[m]],x=p[n][1]||0,v=p[n-1][1]||0;h+=x-v}c+=f,u+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Ng(t,e)}}var _P={},hie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(hie);var JR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(JR);var EP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}t.toKey=e})(EP);var SP={},Aie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(Aie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Aie,r=EP;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=e.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];u?f==="\\"&&l+1<o?(l++,c+=a[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}t.toPath=n})(SP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hie,r=JR,n=EP,a=SP;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||e.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}t.get=s})(_P);var vHe=_P.get;const Cg=TA(vHe);var yHe=4;function em(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yHe,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function _i(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((a,s,o)=>{var l=r[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+em(l)+s:a+s},"")}var Bl=t=>t===0?0:t>0?1:-1,fh=t=>typeof t=="number"&&t!=+t,CA=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Cn=t=>(typeof t=="number"||t instanceof Number)&&!fh(t),hh=t=>Cn(t)||typeof t=="string",bHe=0,Z2=t=>{var e=++bHe;return"".concat(t||"").concat(e)},cc=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Cn(e)&&typeof e!="string")return n;var s;if(CA(e)){if(r==null)return n;var o=e.indexOf("%");s=r*parseFloat(e.slice(0,o))/100}else s=+e;return fh(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},mie=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function So(t,e,r){return Cn(t)&&Cn(e)?em(t+r*(e-t)):e}function wHe(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):Cg(n,e))===r)}var il=t=>t===null||typeof t>"u",Xw=t=>il(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function NHe(t){return t!=null}function Yw(){}var CHe=["type","size","sizeType"];function TF(){return TF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},TF.apply(null,arguments)}function DG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function RG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DG(Object(r),!0).forEach(function(n){_He(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _He(t,e,r){return(e=EHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EHe(t){var e=SHe(t,"string");return typeof e=="symbol"?e:e+""}function SHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jHe(t,e){if(t==null)return{};var r,n,a=IHe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function IHe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var pie={symbolCircle:YR,symbolCross:GVe,symbolDiamond:qVe,symbolSquare:zVe,symbolStar:JVe,symbolTriangle:ZVe,symbolWye:tHe},PHe=Math.PI/180,THe=t=>{var e="symbol".concat(Xw(t));return pie[e]||YR},BHe=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*PHe;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},kHe=(t,e)=>{pie["symbol".concat(Xw(t))]=e},ZR=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=jHe(t,CHe),s=RG(RG({},a),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var A=THe(o),h=rHe().type(A).size(BHe(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=Rd(s);return Cn(u)&&Cn(d)&&Cn(r)?g.createElement("path",TF({},f,{className:ss("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};ZR.registerSymbol=kHe;var gie=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,FHe=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(g.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{qR(a)&&(n[a]=s=>r[a](r,s))}),n},OHe=(t,e,r)=>n=>(t(e,r,n),null),Jw=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var s=t[a];qR(a)&&typeof s=="function"&&(n||(n={}),n[a]=OHe(s,e,r))}),n};function MG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function DHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MG(Object(r),!0).forEach(function(n){RHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function RHe(t,e,r){return(e=MHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MHe(t){var e=LHe(t,"string");return typeof e=="symbol"?e:e+""}function LHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ol(t,e){var r=DHe({},t),n=e,a=Object.keys(e),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function Aj(){return Aj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Aj.apply(null,arguments)}function LG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function UHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?LG(Object(r),!0).forEach(function(n){QHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QHe(t,e,r){return(e=VHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VHe(t){var e=HHe(t,"string");return typeof e=="symbol"?e:e+""}function HHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var md=32,$He={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function GHe(t){var{data:e,iconType:r,inactiveColor:n}=t,a=md/2,s=md/6,o=md/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return g.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:md,y2:a,className:"recharts-legend-icon"})}if(c==="line")return g.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(md,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return g.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(md/8,"h").concat(md,"v").concat(md*3/4,"h").concat(-md,"z"),className:"recharts-legend-icon"});if(g.isValidElement(e.legendIcon)){var d=UHe({},e);return delete d.legendIcon,g.cloneElement(e.legendIcon,d)}return g.createElement(ZR,{fill:l,cx:a,cy:a,size:md,sizeType:"diameter",type:c})}function KHe(t){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=t,l={x:0,y:0,width:md,height:md},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((d,f)=>{var A=d.formatter||a,h=ss({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,p=A?A(d.value,d,f):d.value;return g.createElement("li",Aj({className:h,style:c,key:"legend-item-".concat(f)},Jw(t,d,f)),g.createElement(zR,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(p," legend icon")},g.createElement(GHe,{data:d,iconType:o,inactiveColor:s})),g.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},p))})}var qHe=t=>{var e=Ol(t,$He),{payload:r,layout:n,align:a}=e;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return g.createElement("ul",{className:"recharts-default-legend",style:s},g.createElement(KHe,Aj({},e,{payload:r})))},xie={},vie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}t.uniqBy=e})(vie);var eM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(eM);var yie={},jP={},bie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(bie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=bie;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(jP);var wie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(wie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=jP,r=wie;function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(yie);var Nie={},Cie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_P;function r(n){return function(a){return e.get(a,n)}}t.property=r})(Cie);var _ie={},tM={},Eie={},rM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(rM);var nM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(nM);var aM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(aM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=rM,r=nM,n=aM;function a(d,f,A){return typeof A!="function"?a(d,f,()=>{}):s(d,f,function h(m,p,x,v,y,b){const w=A(m,p,x,v,y,b);return w!==void 0?!!w:s(m,p,h,b)},new Map)}function s(d,f,A,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,A,h);case"function":return Object.keys(f).length>0?s(d,{...f},A,h):n.eq(d,f);default:return e.isObject(d)?typeof f=="string"?f==="":!0:n.eq(d,f)}}function o(d,f,A,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,A,h);if(f instanceof Map)return l(d,f,A,h);if(f instanceof Set)return u(d,f,A,h);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let p=0;p<m.length;p++){const x=m[p];if(!r.isPrimitive(d)&&!(x in d)||f[x]===void 0&&d[x]!==void 0||f[x]===null&&d[x]!==null||!A(d[x],f[x],x,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(d,f,A,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,p]of f.entries()){const x=d.get(m);if(A(x,p,m,d,f,h)===!1)return!1}return!0}function c(d,f,A,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let p=0;p<f.length;p++){const x=f[p];let v=!1;for(let y=0;y<d.length;y++){if(m.has(y))continue;const b=d[y];let w=!1;if(A(b,x,p,d,f,h)&&(w=!0),w){m.add(y),v=!0;break}}if(!v)return!1}return!0}function u(d,f,A,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],A,h):!1}t.isMatchWith=a,t.isSetMatch=u})(Eie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Eie;function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(tM);var Sie={},sM={},jie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(jie);var iM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(iM);var oM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",A="[object ArrayBuffer]",h="[object Object]",m="[object Error]",p="[object DataView]",x="[object Uint8Array]",v="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",I="[object Int8Array]",j="[object Int16Array]",C="[object Int32Array]",S="[object BigInt64Array]",E="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=s,t.arrayBufferTag=A,t.arrayTag=d,t.bigInt64ArrayTag=S,t.bigUint64ArrayTag=w,t.booleanTag=a,t.dataViewTag=p,t.dateTag=l,t.errorTag=m,t.float32ArrayTag=E,t.float64ArrayTag=B,t.functionTag=f,t.int16ArrayTag=j,t.int32ArrayTag=C,t.int8ArrayTag=I,t.mapTag=c,t.numberTag=n,t.objectTag=h,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=y,t.uint32ArrayTag=b,t.uint8ArrayTag=x,t.uint8ClampedArrayTag=v})(oM);var Iie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(Iie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=jie,r=iM,n=oM,a=nM,s=Iie;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,A,h=new Map,m=void 0){const p=m==null?void 0:m(d,f,A,h);if(p!==void 0)return p;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const x=new Array(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return Object.hasOwn(d,"index")&&(x.index=d.index),Object.hasOwn(d,"input")&&(x.input=d.input),x}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const x=new RegExp(d.source,d.flags);return x.lastIndex=d.lastIndex,x}if(d instanceof Map){const x=new Map;h.set(d,x);for(const[v,y]of d)x.set(v,l(y,v,A,h,m));return x}if(d instanceof Set){const x=new Set;h.set(d,x);for(const v of d)x.add(l(v,void 0,A,h,m));return x}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const x=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return x}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const x=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,x),c(x,d,A,h,m),x}if(typeof File<"u"&&d instanceof File){const x=new File([d],d.name,{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(typeof Blob<"u"&&d instanceof Blob){const x=new Blob([d],{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Error){const x=new d.constructor;return h.set(d,x),x.message=d.message,x.name=d.name,x.stack=d.stack,x.cause=d.cause,c(x,d,A,h,m),x}if(d instanceof Boolean){const x=new Boolean(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Number){const x=new Number(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof String){const x=new String(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(typeof d=="object"&&u(d)){const x=Object.create(Object.getPrototypeOf(d));return h.set(d,x),c(x,d,A,h,m),x}return d}function c(d,f,A=d,h,m){const p=[...Object.keys(f),...e.getSymbols(f)];for(let x=0;x<p.length;x++){const v=p[x],y=Object.getOwnPropertyDescriptor(d,v);(y==null||y.writable)&&(d[v]=l(f[v],v,A,h,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(sM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sM;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(Sie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=tM,r=Sie;function n(a){return a=r.cloneDeep(a),s=>e.isMatch(s,a)}t.matches=n})(_ie);var Pie={},Tie={},Bie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sM,r=oM;function n(a,s){return e.cloneDeepWith(a,(o,l,c,u)=>{const d=s==null?void 0:s(o,l,c,u);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return e.copyProperties(f,a),f}case r.argumentsTag:{const f={};return e.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}t.cloneDeepWith=n})(Bie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Bie;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(Tie);var kie={},lM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(lM);var Fie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iM;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(Fie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=JR,r=lM,n=Fie,a=SP;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=s})(kie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=tM,r=EP,n=Tie,a=_P,s=kie;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:e.isMatch(d,c)}}t.matchesProperty=o})(Pie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eM,r=Cie,n=_ie,a=Pie;function s(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=s})(Nie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=vie,r=eM,n=yie,a=Nie;function s(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),a.iteratee(l)):[]}t.uniqBy=s})(xie);var zHe=xie.uniqBy;const UG=TA(zHe);function Oie(t,e,r){return e===!0?UG(t,r):typeof e=="function"?UG(t,e):t}var Die={exports:{}},Rie={},Mie={exports:{}},Lie={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv=g;function WHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var XHe=typeof Object.is=="function"?Object.is:WHe,YHe=qv.useState,JHe=qv.useEffect,ZHe=qv.useLayoutEffect,e$e=qv.useDebugValue;function t$e(t,e){var r=e(),n=YHe({inst:{value:r,getSnapshot:e}}),a=n[0].inst,s=n[1];return ZHe(function(){a.value=r,a.getSnapshot=e,mT(a)&&s({inst:a})},[t,r,e]),JHe(function(){return mT(a)&&s({inst:a}),t(function(){mT(a)&&s({inst:a})})},[t]),e$e(r),r}function mT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!XHe(t,r)}catch{return!0}}function r$e(t,e){return e()}var n$e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?r$e:t$e;Lie.useSyncExternalStore=qv.useSyncExternalStore!==void 0?qv.useSyncExternalStore:n$e;Mie.exports=Lie;var a$e=Mie.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IP=g,s$e=a$e;function i$e(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var o$e=typeof Object.is=="function"?Object.is:i$e,l$e=s$e.useSyncExternalStore,c$e=IP.useRef,u$e=IP.useEffect,d$e=IP.useMemo,f$e=IP.useDebugValue;Rie.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=c$e(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=d$e(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,o$e(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=l$e(t,s[0],s[1]);return u$e(function(){o.hasValue=!0,o.value=l},[l]),f$e(l),l};Die.exports=Rie;var h$e=Die.exports,cM=g.createContext(null),A$e=t=>t,Es=()=>{var t=g.useContext(cM);return t?t.store.dispatch:A$e},CE=()=>{},m$e=()=>CE,p$e=(t,e)=>t===e;function vn(t){var e=g.useContext(cM);return h$e.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:m$e,e?e.store.getState:CE,e?e.store.getState:CE,e?t:CE,p$e)}function g$e(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function x$e(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function v$e(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var QG=t=>Array.isArray(t)?t:[t];function y$e(t){const e=Array.isArray(t[0])?t[0]:t;return v$e(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function b$e(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var w$e=class{constructor(t){this.value=t}deref(){return this.value}},N$e=typeof WeakRef<"u"?WeakRef:w$e,C$e=0,VG=1;function x_(){return{s:C$e,v:void 0,o:null,p:null}}function Uie(t,e={}){let r=x_();const{resultEqualityCheck:n}=e;let a,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let A=0,h=c;A<h;A++){const m=arguments[A];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(m);x===void 0?(l=x_(),p.set(m,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(m);x===void 0?(l=x_(),p.set(m,l)):l=x}}const u=l;let d;if(l.s===VG)d=l.v;else if(d=t.apply(null,arguments),s++,n){const A=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;A!=null&&n(A,d)&&(d=A,s!==0&&s--),a=typeof d=="object"&&d!==null||typeof d=="function"?new N$e(d):d}return u.s=VG,u.v=d,d}return o.clearCache=()=>{r=x_(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function _$e(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let s=0,o=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),g$e(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:A=[],argsMemoize:h=Uie,argsMemoizeOptions:m=[]}=d,p=QG(A),x=QG(m),v=y$e(a),y=f(function(){return s++,u.apply(null,arguments)},...p),b=h(function(){o++;const I=b$e(v,arguments);return l=y.apply(null,I),l},...x);return Object.assign(b,{resultFunc:u,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var tr=_$e(Uie),E$e=Object.assign((t,e=tr)=>{x$e(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>E$e}),Qie={},Vie={},Hie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=e(n),l=e(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};t.compareValues=r})(Hie);var $ie={},uM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(uM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uM,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||e.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}t.isKey=a})($ie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Hie,r=$ie,n=SP;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,m)=>{let p=h;for(let x=0;x<m.length&&p!=null;++x)p=p[m[x]];return p},d=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>d(m,h))})).slice().sort((h,m)=>{for(let p=0;p<f.length;p++){const x=e.compareValues(h.criteria[p],m.criteria[p],l[p]);if(x!==0)return x}return 0}).map(h=>h.original)}t.orderBy=a})(Vie);var Gie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):a.push(d)}};return o(r,0),a}t.flatten=e})(Gie);var dM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=lM,r=jP,n=rM,a=aM;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}t.isIterateeCall=s})(dM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Vie,r=Gie,n=dM;function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(s,r.flatten(o),["asc"])}t.sortBy=a})(Qie);var S$e=Qie.sortBy;const PP=TA(S$e);var Kie=t=>t.legend.settings,j$e=t=>t.legend.size,I$e=t=>t.legend.payload,P$e=tr([I$e,Kie],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?PP(n,r):n});function T$e(){return vn(P$e)}var v_=1;function qie(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=g.useState({height:0,left:0,top:0,width:0}),n=g.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-e.height)>v_||Math.abs(o.left-e.left)>v_||Math.abs(o.top-e.top)>v_||Math.abs(o.width-e.width)>v_)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function bl(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var B$e=typeof Symbol=="function"&&Symbol.observable||"@@observable",HG=B$e,pT=()=>Math.random().toString(36).substring(7).split("").join("."),k$e={INIT:`@@redux/INIT${pT()}`,REPLACE:`@@redux/REPLACE${pT()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${pT()}`},mj=k$e;function fM(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function zie(t,e,r){if(typeof t!="function")throw new Error(bl(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(bl(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(bl(1));return r(zie)(t,e)}let n=t,a=e,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((x,v)=>{o.set(v,x)}))}function d(){if(c)throw new Error(bl(3));return a}function f(x){if(typeof x!="function")throw new Error(bl(4));if(c)throw new Error(bl(5));let v=!0;u();const y=l++;return o.set(y,x),function(){if(v){if(c)throw new Error(bl(6));v=!1,u(),o.delete(y),s=null}}}function A(x){if(!fM(x))throw new Error(bl(7));if(typeof x.type>"u")throw new Error(bl(8));if(typeof x.type!="string")throw new Error(bl(17));if(c)throw new Error(bl(9));try{c=!0,a=n(a,x)}finally{c=!1}return(s=o).forEach(y=>{y()}),x}function h(x){if(typeof x!="function")throw new Error(bl(10));n=x,A({type:mj.REPLACE})}function m(){const x=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(bl(11));function y(){const w=v;w.next&&w.next(d())}return y(),{unsubscribe:x(y)}},[HG](){return this}}}return A({type:mj.INIT}),{dispatch:A,subscribe:f,getState:d,replaceReducer:h,[HG]:m}}function F$e(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:mj.INIT})>"u")throw new Error(bl(12));if(typeof r(void 0,{type:mj.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(bl(13))})}function Wie(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let a;try{F$e(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],A=r[f],h=o[f],m=A(h,l);if(typeof m>"u")throw l&&l.type,new Error(bl(14));u[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?u:o}}function pj(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function O$e(...t){return e=>(r,n)=>{const a=e(r,n);let s=()=>{throw new Error(bl(15))};const o={getState:a.getState,dispatch:(c,...u)=>s(c,...u)},l=t.map(c=>c(o));return s=pj(...l)(a.dispatch),{...a,dispatch:s}}}function Xie(t){return fM(t)&&"type"in t&&typeof t.type=="string"}var Yie=Symbol.for("immer-nothing"),$G=Symbol.for("immer-draftable"),Oc=Symbol.for("immer-state");function ff(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ru=Object,zv=Ru.getPrototypeOf,gj="constructor",TP="prototype",BF="configurable",xj="enumerable",_E="writable",ew="value",_A=t=>!!t&&!!t[Oc];function Sf(t){var e;return t?Jie(t)||kP(t)||!!t[$G]||!!((e=t[gj])!=null&&e[$G])||FP(t)||OP(t):!1}var D$e=Ru[TP][gj].toString(),GG=new WeakMap;function Jie(t){if(!t||!hM(t))return!1;const e=zv(t);if(e===null||e===Ru[TP])return!0;const r=Ru.hasOwnProperty.call(e,gj)&&e[gj];if(r===Object)return!0;if(!Dx(r))return!1;let n=GG.get(r);return n===void 0&&(n=Function.toString.call(r),GG.set(r,n)),n===D$e}function BP(t,e,r=!0){Zw(t)===0?(r?Reflect.ownKeys(t):Ru.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function Zw(t){const e=t[Oc];return e?e.type_:kP(t)?1:FP(t)?2:OP(t)?3:0}var KG=(t,e,r=Zw(t))=>r===2?t.has(e):Ru[TP].hasOwnProperty.call(t,e),kF=(t,e,r=Zw(t))=>r===2?t.get(e):t[e],vj=(t,e,r,n=Zw(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function R$e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var kP=Array.isArray,FP=t=>t instanceof Map,OP=t=>t instanceof Set,hM=t=>typeof t=="object",Dx=t=>typeof t=="function",gT=t=>typeof t=="boolean";function M$e(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Hh=t=>t.copy_||t.base_,AM=t=>t.modified_?t.copy_:t.base_;function FF(t,e){if(FP(t))return new Map(t);if(OP(t))return new Set(t);if(kP(t))return Array[TP].slice.call(t);const r=Jie(t);if(e===!0||e==="class_only"&&!r){const n=Ru.getOwnPropertyDescriptors(t);delete n[Oc];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l[_E]===!1&&(l[_E]=!0,l[BF]=!0),(l.get||l.set)&&(n[o]={[BF]:!0,[_E]:!0,[xj]:l[xj],[ew]:t[o]})}return Ru.create(zv(t),n)}else{const n=zv(t);if(n!==null&&r)return{...t};const a=Ru.create(n);return Ru.assign(a,t)}}function mM(t,e=!1){return DP(t)||_A(t)||!Sf(t)||(Zw(t)>1&&Ru.defineProperties(t,{set:y_,add:y_,clear:y_,delete:y_}),Ru.freeze(t),e&&BP(t,(r,n)=>{mM(n,!0)},!1)),t}function L$e(){ff(2)}var y_={[ew]:L$e};function DP(t){return t===null||!hM(t)?!0:Ru.isFrozen(t)}var yj="MapSet",OF="Patches",qG="ArrayMethods",Zie={};function _g(t){const e=Zie[t];return e||ff(0,t),e}var zG=t=>!!Zie[t],tw,eoe=()=>tw,U$e=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:zG(yj)?_g(yj):void 0,arrayMethodsPlugin_:zG(qG)?_g(qG):void 0});function WG(t,e){e&&(t.patchPlugin_=_g(OF),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function DF(t){RF(t),t.drafts_.forEach(Q$e),t.drafts_=null}function RF(t){t===tw&&(tw=t.parent_)}var XG=t=>tw=U$e(tw,t);function Q$e(t){const e=t[Oc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function YG(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[Oc].modified_&&(DF(e),ff(4)),Sf(t)&&(t=JG(e,t));const{patchPlugin_:a}=e;a&&a.generateReplacementPatches_(r[Oc].base_,t,e)}else t=JG(e,r);return V$e(e,t,!0),DF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Yie?t:void 0}function JG(t,e){if(DP(e))return e;const r=e[Oc];if(!r)return bj(e,t.handledSet_,t);if(!RP(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);noe(r,t)}return r.copy_}function V$e(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&mM(e,r)}function toe(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var RP=(t,e)=>t.scope_===e,H$e=[];function roe(t,e,r,n){const a=Hh(t),s=t.type_;if(n!==void 0&&kF(a,n,s)===e){vj(a,n,r,s);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;BP(a,(c,u)=>{if(_A(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=t.draftLocations_.get(e)??H$e;for(const l of o)vj(a,l,r,s)}function $$e(t,e,r){t.callbacks_.push(function(a){var l;const s=e;if(!s||!RP(s,a))return;(l=a.mapSetPlugin_)==null||l.fixSetContents(s);const o=AM(s);roe(t,s.draft_??s,o,r),noe(s,a)})}function noe(t,e){var n;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((n=t.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=e;if(a){const s=a.getPath(t);s&&a.generatePatches_(t,s,e)}toe(t)}}function G$e(t,e,r){const{scope_:n}=t;if(_A(r)){const a=r[Oc];RP(a,n)&&a.callbacks_.push(function(){EE(t);const o=AM(a);roe(t,r,o,e)})}else Sf(r)&&t.callbacks_.push(function(){const s=Hh(t);t.type_===3?s.has(r)&&bj(r,n.handledSet_,n):kF(s,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&bj(kF(t.copy_,e,t.type_),n.handledSet_,n)})}function bj(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||_A(t)||e.has(t)||!Sf(t)||DP(t)||(e.add(t),BP(t,(n,a)=>{if(_A(a)){const s=a[Oc];if(RP(s,r)){const o=AM(s);vj(t,n,o,t.type_),toe(s)}}else Sf(a)&&bj(a,e,r)})),t}function K$e(t,e){const r=kP(t),n={type_:r?1:0,scope_:e?e.scope_:eoe(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=wj;r&&(a=[n],s=rw);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,[l,n]}var wj={get(t,e){if(e===Oc)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r!=null&&r.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const a=Hh(t);if(!KG(a,e,t.type_))return q$e(t,a,e);const s=a[e];if(t.finalized_||!Sf(s)||n&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&M$e(e))return s;if(s===xT(t.base_,e)){EE(t);const o=t.type_===1?+e:e,l=LF(t.scope_,s,t,o);return t.copy_[o]=l}return s},has(t,e){return e in Hh(t)},ownKeys(t){return Reflect.ownKeys(Hh(t))},set(t,e,r){const n=aoe(Hh(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=xT(Hh(t),e),s=a==null?void 0:a[Oc];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(R$e(r,a)&&(r!==void 0||KG(t.base_,e,t.type_)))return!0;EE(t),MF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),G$e(t,e,r)),!0},deleteProperty(t,e){return EE(t),xT(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),MF(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Hh(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[_E]:!0,[BF]:t.type_!==1||e!=="length",[xj]:n[xj],[ew]:r[e]}},defineProperty(){ff(11)},getPrototypeOf(t){return zv(t.base_)},setPrototypeOf(){ff(12)}},rw={};for(let t in wj){let e=wj[t];rw[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}}rw.deleteProperty=function(t,e){return rw.set.call(this,t,e,void 0)};rw.set=function(t,e,r){return wj.set.call(this,t[0],e,r,t[0])};function xT(t,e){const r=t[Oc];return(r?Hh(r):t)[e]}function q$e(t,e,r){var a;const n=aoe(e,r);return n?ew in n?n[ew]:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function aoe(t,e){if(!(e in t))return;let r=zv(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=zv(r)}}function MF(t){t.modified_||(t.modified_=!0,t.parent_&&MF(t.parent_))}function EE(t){t.copy_||(t.assigned_=new Map,t.copy_=FF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var z$e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Dx(r)&&!Dx(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Dx(n)||ff(6),a!==void 0&&!Dx(a)&&ff(7);let s;if(Sf(r)){const o=XG(this),l=LF(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?DF(o):RF(o)}return WG(o,a),YG(s,o)}else if(!r||!hM(r)){if(s=n(r),s===void 0&&(s=r),s===Yie&&(s=void 0),this.autoFreeze_&&mM(s,!0),a){const o=[],l=[];_g(OF).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else ff(1,r)},this.produceWithPatches=(r,n)=>{if(Dx(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let a,s;return[this.produce(r,n,(l,c)=>{a=l,s=c}),a,s]},gT(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),gT(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),gT(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Sf(e)||ff(8),_A(e)&&(e=wf(e));const r=XG(this),n=LF(r,e,void 0);return n[Oc].isManual_=!0,RF(r),n}finishDraft(e,r){const n=e&&e[Oc];(!n||!n.isManual_)&&ff(9);const{scope_:a}=n;return WG(a,r),YG(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(r=r.slice(n+1));const a=_g(OF).applyPatches_;return _A(e)?a(e,r):this.produce(e,s=>a(s,r))}};function LF(t,e,r,n){const[a,s]=FP(e)?_g(yj).proxyMap_(e,r):OP(e)?_g(yj).proxySet_(e,r):K$e(e,r);return((r==null?void 0:r.scope_)??eoe()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?$$e(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),a}function wf(t){return _A(t)||ff(10,t),soe(t)}function soe(t){if(!Sf(t)||DP(t))return t;const e=t[Oc];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=FF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=FF(t,!0);return BP(r,(a,s)=>{vj(r,a,soe(s))},n),e&&(e.finalized_=!1),r}var W$e=new z$e,ioe=W$e.produce;function ooe(t){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,t):a(s)}var X$e=ooe(),Y$e=ooe,J$e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?pj:pj.apply(null,arguments)};function Md(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(Uu(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Xie(n)&&n.type===t,r}var loe=class ib extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ib.prototype)}static get[Symbol.species](){return ib}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ib(...e[0].concat(this)):new ib(...e.concat(this))}};function ZG(t){return Sf(t)?ioe(t,()=>{}):t}function b_(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function Z$e(t){return typeof t=="boolean"}var eGe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=e??{};let o=new loe;return r&&(Z$e(r)?o.push(X$e):o.push(Y$e(r.extraArgument))),o},coe="RTK_autoBatch",Vs=()=>t=>({payload:t,meta:{[coe]:!0}}),eK=t=>e=>{setTimeout(e,t)},uoe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,s=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:eK(10):t.type==="callback"?t.queueNotification:eK(t.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),A=n.subscribe(f);return l.add(d),()=>{A(),l.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[coe]),s=!a,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},tGe=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new loe(t);return n&&a.push(uoe(typeof n=="object"?n:void 0)),a};function rGe(t){const e=eGe(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(fM(r))l=Wie(r);else throw new Error(Uu(1));let c;typeof n=="function"?c=n(e):c=e();let u=pj;a&&(u=J$e({trace:!1,...typeof a=="object"&&a}));const d=O$e(...c),f=tGe(d);let A=typeof o=="function"?o(f):f();const h=u(...A);return zie(l,s,h)}function doe(t){const e={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Uu(28));if(l in e)throw new Error(Uu(29));return e[l]=o,a},addAsyncThunk(s,o){return o.pending&&(e[s.pending.type]=o.pending),o.rejected&&(e[s.rejected.type]=o.rejected),o.fulfilled&&(e[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return t(a),[e,r,n]}function nGe(t){return typeof t=="function"}function aGe(t,e){let[r,n,a]=doe(e),s;if(nGe(t))s=()=>ZG(t());else{const l=ZG(t);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(_A(d)){const h=f(d,c);return h===void 0?d:h}else{if(Sf(d))return ioe(d,A=>f(A,c));{const A=f(d,c);if(A===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return d},l)}return o.getInitialState=s,o}var sGe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",iGe=(t=21)=>{let e="",r=t;for(;r--;)e+=sGe[Math.random()*64|0];return e},oGe=Symbol.for("rtk-slice-createasyncthunk");function lGe(t,e){return`${t}/${e}`}function cGe({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[oGe];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Uu(11));const l=(typeof a.reducers=="function"?a.reducers(dGe()):a.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,I){const j=typeof w=="string"?w:w.type;if(!j)throw new Error(Uu(12));if(j in u.sliceCaseReducersByType)throw new Error(Uu(13));return u.sliceCaseReducersByType[j]=I,d},addMatcher(w,I){return u.sliceMatchers.push({matcher:w,reducer:I}),d},exposeAction(w,I){return u.actionCreators[w]=I,d},exposeCaseReducer(w,I){return u.sliceCaseReducersByName[w]=I,d}};c.forEach(w=>{const I=l[w],j={reducerName:w,type:lGe(s,w),createNotation:typeof a.reducers=="function"};hGe(I)?mGe(j,I,d,e):fGe(j,I,d)});function f(){const[w={},I=[],j=void 0]=typeof a.extraReducers=="function"?doe(a.extraReducers):[a.extraReducers],C={...w,...u.sliceCaseReducersByType};return aGe(a.initialState,S=>{for(let E in C)S.addCase(E,C[E]);for(let E of u.sliceMatchers)S.addMatcher(E.matcher,E.reducer);for(let E of I)S.addMatcher(E.matcher,E.reducer);j&&S.addDefaultCase(j)})}const A=w=>w,h=new Map,m=new WeakMap;let p;function x(w,I){return p||(p=f()),p(w,I)}function v(){return p||(p=f()),p.getInitialState()}function y(w,I=!1){function j(S){let E=S[w];return typeof E>"u"&&I&&(E=b_(m,j,v)),E}function C(S=A){const E=b_(h,I,()=>new WeakMap);return b_(E,S,()=>{const B={};for(const[k,T]of Object.entries(a.selectors??{}))B[k]=uGe(T,S,()=>b_(m,S,v),I);return B})}return{reducerPath:w,getSelectors:C,get selectors(){return C(j)},selectSlice:j}}const b={name:s,reducer:x,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...y(o),injectInto(w,{reducerPath:I,...j}={}){const C=I??o;return w.inject({reducerPath:C,reducer:x},j),{...b,...y(C,!0)}}};return b}}function uGe(t,e,r,n){function a(s,...o){let l=e(s);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return a.unwrapped=t,a}var fu=cGe();function dGe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function fGe({type:t,reducerName:e,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!AGe(n))throw new Error(Uu(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?Md(t,o):Md(t))}function hGe(t){return t._reducerDefinitionType==="asyncThunk"}function AGe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function mGe({type:t,reducerName:e},r,n,a){if(!a)throw new Error(Uu(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=a(t,s,d);n.exposeAction(e,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(e,{fulfilled:o||w_,pending:l||w_,rejected:c||w_,settled:u||w_})}function w_(){}var pGe="task",foe="listener",hoe="completed",pM="cancelled",gGe=`task-${pM}`,xGe=`task-${hoe}`,UF=`${foe}-${pM}`,vGe=`${foe}-${hoe}`,MP=class{constructor(t){Tr(this,"name","TaskAbortError");Tr(this,"message");this.code=t,this.message=`${pGe} ${pM} (reason: ${t})`}},gM=(t,e)=>{if(typeof t!="function")throw new TypeError(Uu(32))},Nj=()=>{},Aoe=(t,e=Nj)=>(t.catch(e),t),moe=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Xp=t=>{if(t.aborted)throw new MP(t.reason)};function poe(t,e){let r=Nj;return new Promise((n,a)=>{const s=()=>a(new MP(t.reason));if(t.aborted){s();return}r=moe(t,s),e.finally(()=>r()).then(n,a)}).finally(()=>{r=Nj})}var yGe=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof MP?"cancelled":"rejected",error:r}}finally{e==null||e()}},Cj=t=>e=>Aoe(poe(t,e).then(r=>(Xp(t),r))),goe=t=>{const e=Cj(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:bv}=Object,tK={},LP="listenerMiddleware",bGe=(t,e)=>{const r=n=>moe(t,()=>n.abort(t.reason));return(n,a)=>{gM(n);const s=new AbortController;r(s);const o=yGe(async()=>{Xp(t),Xp(s.signal);const l=await n({pause:Cj(s.signal),delay:goe(s.signal),signal:s.signal});return Xp(s.signal),l},()=>s.abort(xGe));return a!=null&&a.autoJoin&&e.push(o.catch(Nj)),{result:Cj(t)(o),cancel(){s.abort(gGe)}}}},wGe=(t,e)=>{const r=async(n,a)=>{Xp(e);let s=()=>{};const l=[new Promise((c,u)=>{let d=t({predicate:n,effect:(f,A)=>{A.unsubscribe(),c([f,A.getState(),A.getOriginalState()])}});s=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await poe(e,Promise.race(l));return Xp(e),c}finally{s()}};return(n,a)=>Aoe(r(n,a))},xoe=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:s}=t;if(e)a=Md(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Uu(21));return gM(s),{predicate:a,type:e,effect:s}},voe=bv(t=>{const{type:e,predicate:r,effect:n}=xoe(t);return{id:iGe(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Uu(22))}}},{withTypes:()=>voe}),rK=(t,e)=>{const{type:r,effect:n,predicate:a}=xoe(e);return Array.from(t.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},QF=t=>{t.pending.forEach(e=>{e.abort(UF)})},NGe=(t,e)=>()=>{for(const r of e.keys())QF(r);t.clear()},nK=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},yoe=bv(Md(`${LP}/add`),{withTypes:()=>yoe}),CGe=Md(`${LP}/removeAll`),boe=bv(Md(`${LP}/remove`),{withTypes:()=>boe}),_Ge=(...t)=>{console.error(`${LP}/error`,...t)},eN=(t={})=>{const e=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=_Ge}=t;gM(o);const l=h=>(h.unsubscribe=()=>e.delete(h.id),e.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&QF(h)}),c=h=>{const m=rK(e,h)??voe(h);return l(m)};bv(c,{withTypes:()=>c});const u=h=>{const m=rK(e,h);return m&&(m.unsubscribe(),h.cancelActive&&QF(m)),!!m};bv(u,{withTypes:()=>u});const d=async(h,m,p,x)=>{const v=new AbortController,y=wGe(c,v.signal),b=[];try{h.pending.add(v),n(h),await Promise.resolve(h.effect(m,bv({},p,{getOriginalState:x,condition:(w,I)=>y(w,I).then(Boolean),take:y,delay:goe(v.signal),pause:Cj(v.signal),extra:s,signal:v.signal,fork:bGe(v.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{e.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((w,I,j)=>{w!==v&&(w.abort(UF),j.delete(w))})},cancel:()=>{v.abort(UF),h.pending.delete(v)},throwIfCancelled:()=>{Xp(v.signal)}})))}catch(w){w instanceof MP||nK(o,w,{raisedBy:"effect"})}finally{await Promise.all(b),v.abort(vGe),a(h),h.pending.delete(v)}},f=NGe(e,r);return{middleware:h=>m=>p=>{if(!Xie(p))return m(p);if(yoe.match(p))return c(p.payload);if(CGe.match(p)){f();return}if(boe.match(p))return u(p.payload);let x=h.getState();const v=()=>{if(x===tK)throw new Error(Uu(23));return x};let y;try{if(y=m(p),e.size>0){const b=h.getState(),w=Array.from(e.values());for(const I of w){let j=!1;try{j=I.predicate(p,b,x)}catch(C){j=!1,nK(o,C,{raisedBy:"predicate"})}j&&d(I,p,h,v)}}}finally{x=tK}return y},startListening:c,stopListening:u,clearListeners:f}};function Uu(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var EGe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},woe=fu({name:"chartLayout",initialState:EGe,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,s;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(s=e.payload.left)!==null&&s!==void 0?s:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:SGe,setLayout:jGe,setChartSize:IGe,setScale:PGe}=woe.actions,TGe=woe.reducer;function Noe(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function pi(t){return Number.isFinite(t)}function Fm(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function aK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aK(Object(r),!0).forEach(function(n){BGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BGe(t,e,r){return(e=kGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kGe(t){var e=FGe(t,"string");return typeof e=="symbol"?e:e+""}function FGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ds(t,e,r){return il(t)||il(e)?r:hh(e)?Cg(t,e,r):typeof e=="function"?e(t):r}var OGe=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&Cn(t[s]))return rv(rv({},t),{},{[s]:t[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&Cn(t[o]))return rv(rv({},t),{},{[o]:t[o]+(a||0)})}return t},qg=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",sK=1e-4,DGe=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-sK,s=Math.max(n[0],n[1])+sK,o=t(e[0]),l=t(e[r-1]);(o<a||o>s||l<a||l>s)&&t.domain([e[0],e[r-1]])}},RGe=(t,e)=>{if(!e||e.length!==2||!Cn(e[0])||!Cn(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!Cn(t[0])||t[0]<r)&&(a[0]=r),(!Cn(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},MGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0,l=0;l<r;++l){var c=t[l],u=c==null?void 0:c[a];if(u!=null){var d=u[1],f=u[0],A=fh(d)?f:d;A>=0?(u[0]=s,u[1]=s+A,s=d):(u[0]=o,u[1]=o+A,o=d)}}}},LGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0;o<r;++o){var l=t[o],c=l==null?void 0:l[a];if(c!=null){var u=fh(c[1])?c[0]:c[1];u>=0?(c[0]=s,c[1]=s+u,s=c[1]):(c[0]=0,c[1]=0)}}}},UGe={sign:MGe,expand:pHe,none:Ng,silhouette:gHe,wiggle:xHe,positive:LGe},QGe=(t,e,r)=>{var n,a=(n=UGe[r])!==null&&n!==void 0?n:Ng,s=mHe().keys(e).value((l,c)=>Number(Ds(l,c,0))).order(PF).offset(a),o=s(t);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=Ds(t[d],e[c],0);Array.isArray(f)&&f.length===2&&Cn(f[0])&&Cn(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function VGe(t){return t==null?void 0:String(t)}var iK=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:s,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=Ds(s,e.dataKey,e.scale.domain()[o]);return il(l)?null:e.scale(l)-a/2+n},HGe=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},$Ge=t=>{var e=t.flat(2).filter(Cn);return[Math.min(...e),Math.max(...e)]},GGe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],KGe=(t,e,r)=>{if(t!=null)return GGe(Object.keys(t).reduce((n,a)=>{var s=t[a];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=Noe(u,e,r),f=$Ge(d);return!pi(f[0])||!pi(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},oK=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,lK=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,_j=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=PP(e,d=>d.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],u=a[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function cK(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:s}=t;return rv(rv({},e),{},{dataKey:r,payload:n,value:a,name:s})}function UP(t,e){if(t)return String(t);if(typeof e=="string")return e}var qGe=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},zGe=(t,e)=>e==="centric"?t.angle:t.radius,QA=t=>t.layout.width,VA=t=>t.layout.height,WGe=t=>t.layout.scale,Coe=t=>t.layout.margin,QP=tr(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),VP=tr(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),_oe="data-recharts-item-index",Eoe="data-recharts-item-id",tN=60;function uK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function N_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uK(Object(r),!0).forEach(function(n){XGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XGe(t,e,r){return(e=YGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YGe(t){var e=JGe(t,"string");return typeof e=="symbol"?e:e+""}function JGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZGe=t=>t.brush.height;function eKe(t){var e=VP(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:tN;return r+a}return r},0)}function tKe(t){var e=VP(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:tN;return r+a}return r},0)}function rKe(t){var e=QP(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function nKe(t){var e=QP(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Mo=tr([QA,VA,Coe,ZGe,eKe,tKe,rKe,nKe,Kie,j$e],(t,e,r,n,a,s,o,l,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},A=N_(N_({},f),d),h=A.bottom;A.bottom+=n,A=OGe(A,c,u);var m=t-A.left-A.right,p=e-A.top-A.bottom;return N_(N_({brushBottom:h},A),{},{width:Math.max(m,0),height:Math.max(p,0)})}),aKe=tr(Mo,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),xM=tr(QA,VA,(t,e)=>({x:0,y:0,width:t,height:e})),sKe=g.createContext(null),zu=()=>g.useContext(sKe)!=null,HP=t=>t.brush,$P=tr([HP,Mo,Coe],(t,e,r)=>({height:t.height,x:Cn(t.x)?t.x:e.left,y:Cn(t.y)?t.y:e.top+e.height+e.brushBottom-((r==null?void 0:r.bottom)||0),width:Cn(t.width)?t.width:e.width})),Soe={},joe={},Ioe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),p()};let A=null;const h=()=>{A!=null&&clearTimeout(A),A=setTimeout(()=>{A=null,f()},n)},m=()=>{A!==null&&(clearTimeout(A),A=null)},p=()=>{m(),o=void 0,l=null},x=()=>{d()},v=function(...y){if(a!=null&&a.aborted)return;o=this,l=y;const b=A==null;h(),c&&b&&d()};return v.schedule=h,v.cancel=p,v.flush=x,a==null||a.addEventListener("abort",p,{once:!0}),v}t.debounce=e})(Ioe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ioe;function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const A=e.debounce(function(...p){d=n.apply(this,p),f=null},a,{edges:u}),h=function(...p){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,p),f=Date.now(),A.cancel(),A.schedule(),d):(A.apply(this,p),d)},m=()=>(A.flush(),d);return h.cancel=A.cancel,h.flush=m,h}t.debounce=r})(joe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=joe;function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return e.debounce(n,a,{leading:o,maxWait:a,trailing:l})}t.throttle=r})(Soe);var iKe=Soe.throttle;const oKe=TA(iKe);var dK=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},Poe=(t,e,r)=>{var{width:n="100%",height:a="100%",aspect:s,maxHeight:o}=r,l=CA(n)?t:Number(n),c=CA(a)?e:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},lKe={width:0,height:0,overflow:"visible"},cKe={width:0,overflowX:"visible"},uKe={height:0,overflowY:"visible"},dKe={},fKe=t=>{var{width:e,height:r}=t,n=CA(e),a=CA(r);return n&&a?lKe:n?cKe:a?uKe:dKe};function hKe(t){var{width:e,height:r,aspect:n}=t,a=e,s=r;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=n&&n>0?void 0:"100%":s===void 0&&(s=n&&n>0?void 0:"100%"),{width:a,height:s}}function VF(){return VF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},VF.apply(null,arguments)}function fK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function hK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fK(Object(r),!0).forEach(function(n){AKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AKe(t,e,r){return(e=mKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mKe(t){var e=pKe(t,"string");return typeof e=="symbol"?e:e+""}function pKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Toe=g.createContext({width:-1,height:-1});function gKe(t){return Fm(t.width)&&Fm(t.height)}function Boe(t){var{children:e,width:r,height:n}=t,a=g.useMemo(()=>({width:r,height:n}),[r,n]);return gKe(a)?g.createElement(Toe.Provider,{value:a},e):null}var vM=()=>g.useContext(Toe),xKe=g.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:f,className:A,onResize:h,style:m={}}=t,p=g.useRef(null),x=g.useRef();x.current=h,g.useImperativeHandle(e,()=>p.current);var[v,y]=g.useState({containerWidth:n.width,containerHeight:n.height}),b=g.useCallback((S,E)=>{y(B=>{var k=Math.round(S),T=Math.round(E);return B.containerWidth===k&&B.containerHeight===T?B:{containerWidth:k,containerHeight:T}})},[]);g.useEffect(()=>{if(p.current==null||typeof ResizeObserver>"u")return Yw;var S=T=>{var P,{width:G,height:ce}=T[0].contentRect;b(G,ce),(P=x.current)===null||P===void 0||P.call(x,G,ce)};d>0&&(S=oKe(S,d,{trailing:!0,leading:!1}));var E=new ResizeObserver(S),{width:B,height:k}=p.current.getBoundingClientRect();return b(B,k),E.observe(p.current),()=>{E.disconnect()}},[b,d]);var{containerWidth:w,containerHeight:I}=v;dK(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:j,calculatedHeight:C}=Poe(w,I,{width:a,height:s,aspect:r,maxHeight:c});return dK(j!=null&&j>0||C!=null&&C>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,C,a,s,o,l,r),g.createElement("div",{id:f?"".concat(f):void 0,className:ss("recharts-responsive-container",A),style:hK(hK({},m),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:p},g.createElement("div",{style:fKe({width:a,height:s})},g.createElement(Boe,{width:j,height:C},u)))}),AK=g.forwardRef((t,e)=>{var r=vM();if(Fm(r.width)&&Fm(r.height))return t.children;var{width:n,height:a}=hKe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:s,calculatedHeight:o}=Poe(void 0,void 0,{width:n,height:a,aspect:t.aspect,maxHeight:t.maxHeight});return Cn(s)&&Cn(o)?g.createElement(Boe,{width:s,height:o},t.children):g.createElement(xKe,VF({},t,{width:n,height:a,ref:e}))});function koe(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var GP=()=>{var t,e=zu(),r=vn(aKe),n=vn($P),a=(t=vn(HP))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},vKe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},yKe=()=>{var t;return(t=vn(Mo))!==null&&t!==void 0?t:vKe},Foe=()=>vn(QA),Ooe=()=>vn(VA),bKe=()=>vn(t=>t.layout.margin),Fa=t=>t.layout.layoutType,rN=()=>vn(Fa),wKe=()=>{var t=rN();return t!==void 0},KP=t=>{var e=Es(),r=zu(),{width:n,height:a}=t,s=vM(),o=n,l=a;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:a),g.useEffect(()=>{!r&&Fm(o)&&Fm(l)&&e(IGe({width:o,height:l}))},[e,r,o,l]),null},Doe=Symbol.for("immer-nothing"),mK=Symbol.for("immer-draftable"),Gu=Symbol.for("immer-state");function hf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var nw=Object.getPrototypeOf;function Wv(t){return!!t&&!!t[Gu]}function Eg(t){var e;return t?Roe(t)||Array.isArray(t)||!!t[mK]||!!((e=t.constructor)!=null&&e[mK])||nN(t)||zP(t):!1}var NKe=Object.prototype.constructor.toString(),pK=new WeakMap;function Roe(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=pK.get(r);return n===void 0&&(n=Function.toString.call(r),pK.set(r,n)),n===NKe}function Ej(t,e,r=!0){qP(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function qP(t){const e=t[Gu];return e?e.type_:Array.isArray(t)?1:nN(t)?2:zP(t)?3:0}function HF(t,e){return qP(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Moe(t,e,r){const n=qP(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function CKe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function nN(t){return t instanceof Map}function zP(t){return t instanceof Set}function gp(t){return t.copy_||t.base_}function $F(t,e){if(nN(t))return new Map(t);if(zP(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Roe(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Gu];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(nw(t),n)}else{const n=nw(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function yM(t,e=!1){return WP(t)||Wv(t)||!Eg(t)||(qP(t)>1&&Object.defineProperties(t,{set:C_,add:C_,clear:C_,delete:C_}),Object.freeze(t),e&&Object.values(t).forEach(r=>yM(r,!0))),t}function _Ke(){hf(2)}var C_={value:_Ke};function WP(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var EKe={};function Sg(t){const e=EKe[t];return e||hf(0,t),e}var aw;function Loe(){return aw}function SKe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function gK(t,e){e&&(Sg("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function GF(t){KF(t),t.drafts_.forEach(jKe),t.drafts_=null}function KF(t){t===aw&&(aw=t.parent_)}function xK(t){return aw=SKe(aw,t)}function jKe(t){const e=t[Gu];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function vK(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Gu].modified_&&(GF(e),hf(4)),Eg(t)&&(t=Sj(e,t),e.parent_||jj(e,t)),e.patches_&&Sg("Patches").generateReplacementPatches_(r[Gu].base_,t,e.patches_,e.inversePatches_)):t=Sj(e,r,[]),GF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Doe?t:void 0}function Sj(t,e,r){if(WP(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[Gu];if(!a)return Ej(e,(s,o)=>yK(t,a,e,s,o,r),n),e;if(a.scope_!==t)return e;if(!a.modified_)return jj(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),Ej(o,(c,u)=>yK(t,a,s,c,u,r,l),n),jj(t,s,!1),r&&t.patches_&&Sg("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function yK(t,e,r,n,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=WP(a);if(!(l&&!o)){if(Wv(a)){const c=s&&e&&e.type_!==3&&!HF(e.assigned_,n)?s.concat(n):void 0,u=Sj(t,a,c);if(Moe(r,n,u),Wv(u))t.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Eg(a)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===a&&l)return;Sj(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(nN(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&jj(t,a)}}}function jj(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&yM(e,r)}function IKe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:Loe(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=bM;r&&(a=[n],s=sw);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var bM={get(t,e){if(e===Gu)return t;const r=gp(t);if(!HF(r,e))return PKe(t,r,e);const n=r[e];return t.finalized_||!Eg(n)?n:n===vT(t.base_,e)?(yT(t),t.copy_[e]=zF(n,t)):n},has(t,e){return e in gp(t)},ownKeys(t){return Reflect.ownKeys(gp(t))},set(t,e,r){const n=Uoe(gp(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=vT(gp(t),e),s=a==null?void 0:a[Gu];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(CKe(r,a)&&(r!==void 0||HF(t.base_,e)))return!0;yT(t),qF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return vT(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,yT(t),qF(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=gp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){hf(11)},getPrototypeOf(t){return nw(t.base_)},setPrototypeOf(){hf(12)}},sw={};Ej(bM,(t,e)=>{sw[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});sw.deleteProperty=function(t,e){return sw.set.call(this,t,e,void 0)};sw.set=function(t,e,r){return bM.set.call(this,t[0],e,r,t[0])};function vT(t,e){const r=t[Gu];return(r?gp(r):t)[e]}function PKe(t,e,r){var a;const n=Uoe(e,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Uoe(t,e){if(!(e in t))return;let r=nw(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=nw(r)}}function qF(t){t.modified_||(t.modified_=!0,t.parent_&&qF(t.parent_))}function yT(t){t.copy_||(t.copy_=$F(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var TKe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&hf(6),n!==void 0&&typeof n!="function"&&hf(7);let a;if(Eg(e)){const s=xK(this),o=zF(e,void 0);let l=!0;try{a=r(o),l=!1}finally{l?GF(s):KF(s)}return gK(s,n),vK(a,s)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===Doe&&(a=void 0),this.autoFreeze_&&yM(a,!0),n){const s=[],o=[];Sg("Patches").generateReplacementPatches_(e,a,s,o),n(s,o)}return a}else hf(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,a;return[this.produce(e,r,(o,l)=>{n=o,a=l}),n,a]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Eg(t)||hf(8),Wv(t)&&(t=BKe(t));const e=xK(this),r=zF(t,void 0);return r[Gu].isManual_=!0,KF(e),r}finishDraft(t,e){const r=t&&t[Gu];(!r||!r.isManual_)&&hf(9);const{scope_:n}=r;return gK(n,e),vK(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=Sg("Patches").applyPatches_;return Wv(t)?n(t,e):this.produce(t,a=>n(a,e))}};function zF(t,e){const r=nN(t)?Sg("MapSet").proxyMap_(t,e):zP(t)?Sg("MapSet").proxySet_(t,e):IKe(t,e);return(e?e.scope_:Loe()).drafts_.push(r),r}function BKe(t){return Wv(t)||hf(10,t),Qoe(t)}function Qoe(t){if(!Eg(t)||WP(t))return t;const e=t[Gu];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=$F(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=$F(t,!0);return Ej(r,(a,s)=>{Moe(r,a,Qoe(s))},n),e&&(e.finalized_=!1),r}var kKe=new TKe;kKe.produce;var FKe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Voe=fu({name:"legend",initialState:FKe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:Vs()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,a=wf(t).payload.indexOf(r);a>-1&&(t.payload[a]=n)},prepare:Vs()},removeLegendPayload:{reducer(t,e){var r=wf(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:Vs()}}}),{setLegendSize:bK,setLegendSettings:OKe,addLegendPayload:Hoe,replaceLegendPayload:$oe,removeLegendPayload:Goe}=Voe.actions,DKe=Voe.reducer,RKe=["contextPayload"];function WF(){return WF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WF.apply(null,arguments)}function wK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Xv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wK(Object(r),!0).forEach(function(n){MKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function MKe(t,e,r){return(e=LKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LKe(t){var e=UKe(t,"string");return typeof e=="symbol"?e:e+""}function UKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QKe(t,e){if(t==null)return{};var r,n,a=VKe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function VKe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function HKe(t){return t.value}function $Ke(t){var{contextPayload:e}=t,r=QKe(t,RKe),n=Oie(e,t.payloadUniqBy,HKe),a=Xv(Xv({},r),{},{payload:n});return g.isValidElement(t.content)?g.cloneElement(t.content,a):typeof t.content=="function"?g.createElement(t.content,a):g.createElement(qHe,a)}function GKe(t,e,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=e,u,d;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?d={top:((a||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Xv(Xv({},u),d)}function KKe(t){var e=Es();return g.useEffect(()=>{e(OKe(t))},[e,t]),null}function qKe(t){var e=Es();return g.useEffect(()=>(e(bK(t)),()=>{e(bK({width:0,height:0}))}),[e,t]),null}function zKe(t,e,r,n){return t==="vertical"&&Cn(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var WKe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function XF(t){var e=Ol(t,WKe),r=T$e(),n=LVe(),a=bKe(),{width:s,height:o,wrapperStyle:l,portal:c}=e,[u,d]=qie([r]),f=Foe(),A=Ooe();if(f==null||A==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=zKe(e.layout,o,s,h),p=c?l:Xv(Xv({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},GKe(l,e,a,f,A,u)),l),x=c??n;if(x==null||r==null)return null;var v=g.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},g.createElement(KKe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&g.createElement(qKe,{width:u.width,height:u.height}),g.createElement($Ke,WF({},e,m,{margin:a,chartWidth:f,chartHeight:A,contextPayload:r})));return Lu.createPortal(v,x)}XF.displayName="Legend";function YF(){return YF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},YF.apply(null,arguments)}function NK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NK(Object(r),!0).forEach(function(n){XKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XKe(t,e,r){return(e=YKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YKe(t){var e=JKe(t,"string");return typeof e=="symbol"?e:e+""}function JKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZKe(t){return Array.isArray(t)&&hh(t[0])&&hh(t[1])?t.join(" ~ "):t}var eqe=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:A=!1}=t,h=()=>{if(s&&s.length){var I={padding:0,margin:0},j=(l?PP(s,l):s).map((C,S)=>{if(C.type==="none")return null;var E=C.formatter||o||ZKe,{value:B,name:k}=C,T=B,P=k;if(E){var G=E(B,k,C,S,s);if(Array.isArray(G))[T,P]=G;else if(G!=null)T=G;else return null}var ce=bT({display:"block",paddingTop:4,paddingBottom:4,color:C.color||"#000"},n);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:ce},hh(P)?g.createElement("span",{className:"recharts-tooltip-item-name"},P):null,hh(P)?g.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,g.createElement("span",{className:"recharts-tooltip-item-value"},T),g.createElement("span",{className:"recharts-tooltip-item-unit"},C.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:I},j)}return null},m=bT({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=bT({margin:0},a),x=!il(d),v=x?d:"",y=ss("recharts-default-tooltip",c),b=ss("recharts-tooltip-label",u);x&&f&&s!==void 0&&s!==null&&(v=f(d,s));var w=A?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",YF({className:y,style:m},w),g.createElement("p",{className:b,style:p},g.isValidElement(v)?v:"".concat(v)),h())},jy="recharts-tooltip-wrapper",tqe={visibility:"hidden"};function rqe(t){var{coordinate:e,translateX:r,translateY:n}=t;return ss(jy,{["".concat(jy,"-right")]:Cn(r)&&e&&Cn(e.x)&&r>=e.x,["".concat(jy,"-left")]:Cn(r)&&e&&Cn(e.x)&&r<e.x,["".concat(jy,"-bottom")]:Cn(n)&&e&&Cn(e.y)&&n>=e.y,["".concat(jy,"-top")]:Cn(n)&&e&&Cn(e.y)&&n<e.y})}function CK(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(s&&Cn(s[n]))return s[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(e[n])return o[n]?d:f;var A=c[n];if(A==null)return 0;if(o[n]){var h=d,m=A;return h<m?Math.max(f,A):Math.max(d,A)}if(u==null)return 0;var p=f+l,x=A+u;return p>x?Math.max(d,A):Math.max(f,A)}function nqe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function aqe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,u,d,f;return o.height>0&&o.width>0&&r?(d=CK({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=CK({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=nqe({translateX:d,translateY:f,useTranslate3d:l})):u=tqe,{cssProperties:u,cssClasses:rqe({translateX:d,translateY:f,coordinate:r})}}function _K(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function __(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_K(Object(r),!0).forEach(function(n){JF(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_K(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JF(t,e,r){return(e=sqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sqe(t){var e=iqe(t,"string");return typeof e=="symbol"?e:e+""}function iqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oqe extends g.PureComponent{constructor(){super(...arguments),JF(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),JF(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:A,viewBox:h,wrapperStyle:m,lastBoundingBox:p,innerRef:x,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=aqe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:p.height,width:p.width},useTranslate3d:A,viewBox:h}),w=v?{}:__(__({transition:c&&e?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),I=__(__({},w),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},m);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:I,ref:x},s)}}var Koe=()=>{var t;return(t=vn(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function ZF(){return ZF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZF.apply(null,arguments)}function EK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function SK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EK(Object(r),!0).forEach(function(n){lqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lqe(t,e,r){return(e=cqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cqe(t){var e=uqe(t,"string");return typeof e=="symbol"?e:e+""}function uqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jK={curveBasisClosed:aHe,curveBasisOpen:sHe,curveBasis:nHe,curveBumpX:HVe,curveBumpY:$Ve,curveLinearClosed:iHe,curveLinear:NP,curveMonotoneX:oHe,curveMonotoneY:lHe,curveNatural:cHe,curveStep:uHe,curveStepAfter:fHe,curveStepBefore:dHe},Ij=t=>pi(t.x)&&pi(t.y),IK=t=>t.base!=null&&Ij(t.base)&&Ij(t),Iy=t=>t.x,Py=t=>t.y,dqe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(Xw(t));return(r==="curveMonotone"||r==="curveBump")&&e?jK["".concat(r).concat(e==="vertical"?"Y":"X")]:jK[r]||NP},fqe=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=t,o=dqe(e,a),l=s?r.filter(Ij):r,c;if(Array.isArray(n)){var u=r.map((h,m)=>SK(SK({},h),{},{base:n[m]}));a==="vertical"?c=g_().y(Py).x1(Iy).x0(h=>h.base.x):c=g_().x(Iy).y1(Py).y0(h=>h.base.y);var d=c.defined(IK).curve(o),f=s?u.filter(IK):u;return d(f)}a==="vertical"&&Cn(n)?c=g_().y(Py).x1(Iy).x0(n):Cn(n)?c=g_().x(Iy).y1(Py).y0(n):c=rie().x(Iy).y(Py);var A=c.defined(Ij).curve(o);return A(l)},wM=t=>{var{className:e,points:r,path:n,pathRef:a}=t,s=rN();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||s,connectNulls:t.connectNulls},l=r&&r.length?fqe(o):n;return g.createElement("path",ZF({},dh(t),FHe(t),{className:ss("recharts-curve",e),d:l===null?void 0:l,ref:a}))},hqe=["x","y","top","left","width","height","className"];function eO(){return eO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},eO.apply(null,arguments)}function PK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Aqe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PK(Object(r),!0).forEach(function(n){mqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mqe(t,e,r){return(e=pqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pqe(t){var e=gqe(t,"string");return typeof e=="symbol"?e:e+""}function gqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xqe(t,e){if(t==null)return{};var r,n,a=vqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var yqe=(t,e,r,n,a,s)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(s,",").concat(e,"h").concat(r),bqe=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=t,c=xqe(t,hqe),u=Aqe({x:e,y:r,top:n,left:a,width:s,height:o},c);return!Cn(e)||!Cn(r)||!Cn(s)||!Cn(o)||!Cn(n)||!Cn(a)?null:g.createElement("path",eO({},Rd(u),{className:ss("recharts-cross",l),d:yqe(e,r,s,o,n,a)}))};function wqe(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function TK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function BK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?TK(Object(r),!0).forEach(function(n){Nqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nqe(t,e,r){return(e=Cqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cqe(t){var e=_qe(t,"string");return typeof e=="symbol"?e:e+""}function _qe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Eqe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),qoe=(t,e,r)=>t.map(n=>"".concat(Eqe(n)," ").concat(e,"ms ").concat(r)).join(","),Sqe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),iw=(t,e)=>Object.keys(e).reduce((r,n)=>BK(BK({},r),{},{[n]:t(n,e[n])}),{});function kK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function jo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kK(Object(r),!0).forEach(function(n){jqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jqe(t,e,r){return(e=Iqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iqe(t){var e=Pqe(t,"string");return typeof e=="symbol"?e:e+""}function Pqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pj=(t,e,r)=>t+(e-t)*r,tO=t=>{var{from:e,to:r}=t;return e!==r},zoe=(t,e,r)=>{var n=iw((a,s)=>{if(tO(s)){var[o,l]=t(s.from,s.to,s.velocity);return jo(jo({},s),{},{from:o,velocity:l})}return s},e);return r<1?iw((a,s)=>tO(s)&&n[a]!=null?jo(jo({},s),{},{velocity:Pj(s.velocity,n[a].velocity,r),from:Pj(s.from,n[a].from,r)}):s,e):zoe(t,n,r-1)};function Tqe(t,e,r,n,a,s){var o,l=n.reduce((A,h)=>jo(jo({},A),{},{[h]:{from:t[h],velocity:0,to:e[h]}}),{}),c=()=>iw((A,h)=>h.from,l),u=()=>!Object.values(l).filter(tO).length,d=null,f=A=>{o||(o=A);var h=A-o,m=h/r.dt;l=zoe(r,l,m),a(jo(jo(jo({},t),e),c())),o=A,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var A;(A=d)===null||A===void 0||A()})}function Bqe(t,e,r,n,a,s,o){var l=null,c=a.reduce((f,A)=>{var h=t[A],m=e[A];return h==null||m==null?f:jo(jo({},f),{},{[A]:[h,m]})},{}),u,d=f=>{u||(u=f);var A=(f-u)/n,h=iw((p,x)=>Pj(...x,r(A)),c);if(s(jo(jo(jo({},t),e),h)),A<1)l=o.setTimeout(d);else{var m=iw((p,x)=>Pj(...x,r(1)),c);s(jo(jo(jo({},t),e),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const kqe=(t,e,r,n,a,s)=>{var o=Sqe(t,e);return r==null?()=>(a(jo(jo({},t),e)),()=>{}):r.isStepper===!0?Tqe(t,e,r,o,a,s):Bqe(t,e,r,n,o,a,s)};var Tj=1e-4,Woe=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],Xoe=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),FK=(t,e)=>r=>{var n=Woe(t,e);return Xoe(n,r)},Fqe=(t,e)=>r=>{var n=Woe(t,e),a=[...n.map((s,o)=>s*o).slice(1),0];return Xoe(a,r)},Oqe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},Dqe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=Oqe(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},Rqe=(t,e,r,n)=>{var a=FK(t,r),s=FK(e,n),o=Fqe(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,A=0;A<8;++A){var h=a(f)-d,m=o(f);if(Math.abs(h-d)<Tj||m<Tj)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},OK=function(){return Rqe(...Dqe(...arguments))},Mqe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*a/1e3,A=c*a/1e3+o;return Math.abs(A-l)<Tj&&Math.abs(f)<Tj?[l,0]:[A,f]};return s.isStepper=!0,s.dt=a,s},Lqe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return OK(t);case"spring":return Mqe();default:if(t.split("(")[0]==="cubic-bezier")return OK(t)}return typeof t=="function"?t:null};function Uqe(t){var e,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){a=t.setTimeout(s.bind(null,u),c);return}s(c),a=t.setTimeout(s.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class Qqe{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function Vqe(){return Uqe(new Qqe)}var Hqe=g.createContext(Vqe);function $qe(t,e){var r=g.useContext(Hqe);return g.useMemo(()=>e??r(t),[t,e,r])}var Gqe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),XP={isSsr:Gqe()},Kqe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},DK={t:0},wT={t:1};function YP(t){var e=Ol(t,Kqe),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,d=r==="auto"?!XP.isSsr:r,f=$qe(e.animationId,e.animationManager),[A,h]=g.useState(d?DK:wT),m=g.useRef(null);return g.useEffect(()=>{d||h(wT)},[d]),g.useEffect(()=>{if(!d||!n)return Yw;var p=kqe(DK,wT,Lqe(s),a,h,f.getTimeoutController()),x=()=>{m.current=p()};return f.start([c,o,x,a,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,a,s,o,c,l,f]),u(A.t)}function JP(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=g.useRef(Z2(e)),n=g.useRef(t);return n.current!==t&&(r.current=Z2(e),n.current=t),r.current}var qqe=["radius"],zqe=["radius"],RK,MK,LK,UK,QK,VK,HK,$K,GK,KK;function qK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qK(Object(r),!0).forEach(function(n){Wqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Wqe(t,e,r){return(e=Xqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xqe(t){var e=Yqe(t,"string");return typeof e=="symbol"?e:e+""}function Yqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bj(){return Bj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bj.apply(null,arguments)}function WK(t,e){if(t==null)return{};var r,n,a=Jqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Jqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Hf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var XK=(t,e,r,n,a)=>{var s=em(r),o=em(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&a instanceof Array){for(var A=[0,0,0,0],h=0,m=4;h<m;h++)A[h]=a[h]>l?l:a[h];f=_i(RK||(RK=Hf(["M",",",""])),t,e+c*A[0]),A[0]>0&&(f+=_i(MK||(MK=Hf(["A ",",",",0,0,",",",",",""])),A[0],A[0],d,t+u*A[0],e)),f+=_i(LK||(LK=Hf(["L ",",",""])),t+r-u*A[1],e),A[1]>0&&(f+=_i(UK||(UK=Hf(["A ",",",",0,0,",`,
        `,",",""])),A[1],A[1],d,t+r,e+c*A[1])),f+=_i(QK||(QK=Hf(["L ",",",""])),t+r,e+n-c*A[2]),A[2]>0&&(f+=_i(VK||(VK=Hf(["A ",",",",0,0,",`,
        `,",",""])),A[2],A[2],d,t+r-u*A[2],e+n)),f+=_i(HK||(HK=Hf(["L ",",",""])),t+u*A[3],e+n),A[3]>0&&(f+=_i($K||($K=Hf(["A ",",",",0,0,",`,
        `,",",""])),A[3],A[3],d,t,e+n-c*A[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var p=Math.min(l,a);f=_i(GK||(GK=Hf(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*p,p,p,d,t+u*p,e,t+r-u*p,e,p,p,d,t+r,e+c*p,t+r,e+n-c*p,p,p,d,t+r-u*p,e+n,t+u*p,e+n,p,p,d,t,e+n-c*p)}else f=_i(KK||(KK=Hf(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return f},YK={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Yoe=t=>{var e=Ol(t,YK),r=g.useRef(null),[n,a]=g.useState(-1);g.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var le=r.current.getTotalLength();le&&a(le)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=e,{animationEasing:f,animationDuration:A,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:p}=e,x=g.useRef(l),v=g.useRef(c),y=g.useRef(s),b=g.useRef(o),w=g.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),I=JP(w,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var j=ss("recharts-rectangle",d);if(!p){var C=Rd(e),{radius:S}=C,E=WK(C,qqe);return g.createElement("path",Bj({},E,{x:em(s),y:em(o),width:em(l),height:em(c),radius:typeof u=="number"?u:void 0,className:j,d:XK(s,o,l,c,u)}))}var B=x.current,k=v.current,T=y.current,P=b.current,G="0px ".concat(n===-1?1:n,"px"),ce="".concat(n,"px 0px"),ue=qoe(["strokeDasharray"],A,typeof f=="string"?f:YK.animationEasing);return g.createElement(YP,{animationId:I,key:I,canBegin:n>0,duration:A,easing:f,isActive:p,begin:h},le=>{var Ae=So(B,l,le),ae=So(k,c,le),_e=So(T,s,le),De=So(P,o,le);r.current&&(x.current=Ae,v.current=ae,y.current=_e,b.current=De);var O;m?le>0?O={transition:ue,strokeDasharray:ce}:O={strokeDasharray:G}:O={strokeDasharray:ce};var H=Rd(e),{radius:K}=H,R=WK(H,zqe);return g.createElement("path",Bj({},R,{radius:typeof u=="number"?u:void 0,className:j,d:XK(_e,De,Ae,ae,u),ref:r,style:zK(zK({},O),e.style)}))})};function JK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ZK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JK(Object(r),!0).forEach(function(n){Zqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zqe(t,e,r){return(e=eze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eze(t){var e=tze(t,"string");return typeof e=="symbol"?e:e+""}function tze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kj=Math.PI/180,rze=t=>t*180/Math.PI,uo=(t,e,r,n)=>({x:t+Math.cos(-kj*n)*r,y:e+Math.sin(-kj*n)*r}),Joe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},nze=(t,e)=>{var{x:r,y:n}=t,{x:a,y:s}=e;return Math.sqrt((r-a)**2+(n-s)**2)},aze=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:s}=e,o=nze({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:rze(c),angleInRadian:c}},sze=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:e-s*360,endAngle:r-s*360}},ize=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return t+o*360},oze=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:a,angle:s}=aze({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:u}=sze(e),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?ZK(ZK({},e),{},{radius:a,angle:ize(d,e)}):null};function Zoe(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:s}=t,o=uo(e,r,n,a),l=uo(e,r,n,s);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:a,endAngle:s}}var eq,tq,rq,nq,aq,sq,iq;function rO(){return rO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rO.apply(null,arguments)}function kp(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var lze=(t,e)=>{var r=Bl(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},E_=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,d=Math.asin(l/u)/kj,f=c?a:a+s*d,A=uo(e,r,u,f),h=uo(e,r,n,f),m=c?a-s*d:a,p=uo(e,r,u*Math.cos(d*kj),m);return{center:A,circleTangency:h,lineTangency:p,theta:d}},ele=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=t,l=lze(s,o),c=s+l,u=uo(e,r,a,s),d=uo(e,r,a,c),f=_i(eq||(eq=kp(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var A=uo(e,r,n,s),h=uo(e,r,n,c);f+=_i(tq||(tq=kp(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),A.x,A.y)}else f+=_i(rq||(rq=kp(["L ",","," Z"])),e,r);return f},cze=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,d=Bl(u-c),{circleTangency:f,lineTangency:A,theta:h}=E_({cx:e,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:p,theta:x}=E_({cx:e,cy:r,radius:a,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),v=l?Math.abs(c-u):Math.abs(c-u)-h-x;if(v<0)return o?_i(nq||(nq=kp(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),A.x,A.y,s,s,s*2,s,s,-s*2):ele({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var y=_i(aq||(aq=kp(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),A.x,A.y,s,s,+(d<0),f.x,f.y,a,a,+(v>180),+(d<0),m.x,m.y,s,s,+(d<0),p.x,p.y);if(n>0){var{circleTangency:b,lineTangency:w,theta:I}=E_({cx:e,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:j,lineTangency:C,theta:S}=E_({cx:e,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),E=l?Math.abs(c-u):Math.abs(c-u)-I-S;if(E<0&&s===0)return"".concat(y,"L").concat(e,",").concat(r,"Z");y+=_i(sq||(sq=kp(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),C.x,C.y,s,s,+(d<0),j.x,j.y,n,n,+(E>180),+(d>0),b.x,b.y,s,s,+(d<0),w.x,w.y)}else y+=_i(iq||(iq=kp(["L",",","Z"])),e,r);return y},uze={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},tle=t=>{var e=Ol(t,uze),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=e;if(s<a||u===d)return null;var A=ss("recharts-sector",f),h=s-a,m=cc(o,h,0,!0),p;return m>0&&Math.abs(u-d)<360?p=cze({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):p=ele({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d}),g.createElement("path",rO({},Rd(e),{className:A,d:p}))};function dze(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(gie(e)){if(t==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:o,angle:l}=e,c=uo(n,a,s,l),u=uo(n,a,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Zoe(e)}}var rle={},nle={},ale={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uM;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(ale);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ale;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(nle);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dM,r=nle;function n(a,s,o){o&&typeof o!="number"&&e.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=o;return c}t.range=n})(rle);var fze=rle.range;const sle=TA(fze);function xm(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hze(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function NM(t){let e,r,n;t.length!==2?(e=xm,r=(l,c)=>xm(t(l),c),n=(l,c)=>t(l)-c):(e=t===xm||t===hze?t:Aze,r=t,n=t);function a(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function Aze(){return 0}function ile(t){return t===null?NaN:+t}function*mze(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const pze=NM(xm),aN=pze.right;NM(ile).center;class oq extends Map{constructor(e,r=vze){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(lq(this,e))}has(e){return super.has(lq(this,e))}set(e,r){return super.set(gze(this,e),r)}delete(e){return super.delete(xze(this,e))}}function lq({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function gze({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function xze({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function vze(t){return t!==null&&typeof t=="object"?t.valueOf():t}function yze(t=xm){if(t===xm)return ole;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function ole(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const bze=Math.sqrt(50),wze=Math.sqrt(10),Nze=Math.sqrt(2);function Fj(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=bze?10:s>=wze?5:s>=Nze?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?Fj(t,e,r*2):[l,c,u]}function nO(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,s,o]=n?Fj(e,t,r):Fj(t,e,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(a+u)/-o;else for(let u=0;u<l;++u)c[u]=(a+u)*o;return c}function aO(t,e,r){return e=+e,t=+t,r=+r,Fj(t,e,r)[2]}function sO(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?aO(e,t,r):aO(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function cq(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function uq(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function lle(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?ole:yze(a);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),A=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(e-u*f/c+A)),m=Math.min(n,Math.floor(e+(c-u)*f/c+A));lle(t,e,h,m,a)}const s=t[e];let o=r,l=n;for(Ty(t,r,e),a(t[n],s)>0&&Ty(t,r,n);o<l;){for(Ty(t,o,l),++o,--l;a(t[o],s)<0;)++o;for(;a(t[l],s)>0;)--l}a(t[r],s)===0?Ty(t,r,l):(++l,Ty(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function Ty(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Cze(t,e,r){if(t=Float64Array.from(mze(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return uq(t);if(e>=1)return cq(t);var n,a=(n-1)*e,s=Math.floor(a),o=cq(lle(t,s).subarray(0,s+1)),l=uq(t.subarray(s+1));return o+(l-o)*(a-s)}}function _ze(t,e,r=ile){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,s=Math.floor(a),o=+r(t[s],s,t),l=+r(t[s+1],s+1,t);return o+(l-o)*(a-s)}}function Eze(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,s=new Array(a);++n<a;)s[n]=t+n*r;return s}function Hd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function HA(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const iO=Symbol("implicit");function CM(){var t=new oq,e=[],r=[],n=iO;function a(s){let o=t.get(s);if(o===void 0){if(n!==iO)return n;t.set(s,o=e.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new oq;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return CM(e,r).unknown(n)},Hd.apply(a,arguments),a}function _M(){var t=CM().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,s,o,l=!1,c=0,u=0,d=.5;delete t.unknown;function f(){var A=e().length,h=a<n,m=h?a:n,p=h?n:a;s=(p-m)/Math.max(1,A-c+u*2),l&&(s=Math.floor(s)),m+=(p-m-s*(A-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var x=Eze(A).map(function(v){return m+s*v});return r(h?x.reverse():x)}return t.domain=function(A){return arguments.length?(e(A),f()):e()},t.range=function(A){return arguments.length?([n,a]=A,n=+n,a=+a,f()):[n,a]},t.rangeRound=function(A){return[n,a]=A,n=+n,a=+a,l=!0,f()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(A){return arguments.length?(l=!!A,f()):l},t.padding=function(A){return arguments.length?(c=Math.min(1,u=+A),f()):c},t.paddingInner=function(A){return arguments.length?(c=Math.min(1,A),f()):c},t.paddingOuter=function(A){return arguments.length?(u=+A,f()):u},t.align=function(A){return arguments.length?(d=Math.max(0,Math.min(1,A)),f()):d},t.copy=function(){return _M(e(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Hd.apply(f(),arguments)}function cle(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return cle(e())},t}function Sze(){return cle(_M.apply(null,arguments).paddingInner(1))}function EM(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ule(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function sN(){}var ow=.7,Oj=1/ow,wv="\\s*([+-]?\\d+)\\s*",lw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jze=/^#([0-9a-f]{3,8})$/,Ize=new RegExp(`^rgb\\(${wv},${wv},${wv}\\)$`),Pze=new RegExp(`^rgb\\(${lh},${lh},${lh}\\)$`),Tze=new RegExp(`^rgba\\(${wv},${wv},${wv},${lw}\\)$`),Bze=new RegExp(`^rgba\\(${lh},${lh},${lh},${lw}\\)$`),kze=new RegExp(`^hsl\\(${lw},${lh},${lh}\\)$`),Fze=new RegExp(`^hsla\\(${lw},${lh},${lh},${lw}\\)$`),dq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};EM(sN,cw,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fq,formatHex:fq,formatHex8:Oze,formatHsl:Dze,formatRgb:hq,toString:hq});function fq(){return this.rgb().formatHex()}function Oze(){return this.rgb().formatHex8()}function Dze(){return dle(this).formatHsl()}function hq(){return this.rgb().formatRgb()}function cw(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=jze.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Aq(e):r===3?new au(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?S_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?S_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ize.exec(t))?new au(e[1],e[2],e[3],1):(e=Pze.exec(t))?new au(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Tze.exec(t))?S_(e[1],e[2],e[3],e[4]):(e=Bze.exec(t))?S_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kze.exec(t))?gq(e[1],e[2]/100,e[3]/100,1):(e=Fze.exec(t))?gq(e[1],e[2]/100,e[3]/100,e[4]):dq.hasOwnProperty(t)?Aq(dq[t]):t==="transparent"?new au(NaN,NaN,NaN,0):null}function Aq(t){return new au(t>>16&255,t>>8&255,t&255,1)}function S_(t,e,r,n){return n<=0&&(t=e=r=NaN),new au(t,e,r,n)}function Rze(t){return t instanceof sN||(t=cw(t)),t?(t=t.rgb(),new au(t.r,t.g,t.b,t.opacity)):new au}function oO(t,e,r,n){return arguments.length===1?Rze(t):new au(t,e,r,n??1)}function au(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}EM(au,oO,ule(sN,{brighter(t){return t=t==null?Oj:Math.pow(Oj,t),new au(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ow:Math.pow(ow,t),new au(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new au(Yp(this.r),Yp(this.g),Yp(this.b),Dj(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mq,formatHex:mq,formatHex8:Mze,formatRgb:pq,toString:pq}));function mq(){return`#${Fp(this.r)}${Fp(this.g)}${Fp(this.b)}`}function Mze(){return`#${Fp(this.r)}${Fp(this.g)}${Fp(this.b)}${Fp((isNaN(this.opacity)?1:this.opacity)*255)}`}function pq(){const t=Dj(this.opacity);return`${t===1?"rgb(":"rgba("}${Yp(this.r)}, ${Yp(this.g)}, ${Yp(this.b)}${t===1?")":`, ${t})`}`}function Dj(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Yp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Fp(t){return t=Yp(t),(t<16?"0":"")+t.toString(16)}function gq(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Af(t,e,r,n)}function dle(t){if(t instanceof Af)return new Af(t.h,t.s,t.l,t.opacity);if(t instanceof sN||(t=cw(t)),!t)return new Af;if(t instanceof Af)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(e===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new Af(o,l,c,t.opacity)}function Lze(t,e,r,n){return arguments.length===1?dle(t):new Af(t,e,r,n??1)}function Af(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}EM(Af,Lze,ule(sN,{brighter(t){return t=t==null?Oj:Math.pow(Oj,t),new Af(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ow:Math.pow(ow,t),new Af(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new au(NT(t>=240?t-240:t+120,a,n),NT(t,a,n),NT(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new Af(xq(this.h),j_(this.s),j_(this.l),Dj(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Dj(this.opacity);return`${t===1?"hsl(":"hsla("}${xq(this.h)}, ${j_(this.s)*100}%, ${j_(this.l)*100}%${t===1?")":`, ${t})`}`}}));function xq(t){return t=(t||0)%360,t<0?t+360:t}function j_(t){return Math.max(0,Math.min(1,t||0))}function NT(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const SM=t=>()=>t;function Uze(t,e){return function(r){return t+r*e}}function Qze(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Vze(t){return(t=+t)==1?fle:function(e,r){return r-e?Qze(e,r,t):SM(isNaN(e)?r:e)}}function fle(t,e){var r=e-t;return r?Uze(t,r):SM(isNaN(t)?e:t)}const vq=function t(e){var r=Vze(e);function n(a,s){var o=r((a=oO(a)).r,(s=oO(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),u=fle(a.opacity,s.opacity);return function(d){return a.r=o(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=t,n}(1);function Hze(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=t[a]*(1-s)+e[a]*s;return n}}function $ze(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Gze(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=I1(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function Kze(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Rj(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function qze(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=I1(t[a],e[a]):n[a]=e[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var lO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,CT=new RegExp(lO.source,"g");function zze(t){return function(){return t}}function Wze(t){return function(e){return t(e)+""}}function Xze(t,e){var r=lO.lastIndex=CT.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=lO.exec(t))&&(a=CT.exec(e));)(s=a.index)>r&&(s=e.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:Rj(n,a)})),r=CT.lastIndex;return r<e.length&&(s=e.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?Wze(c[0].x):zze(e):(e=c.length,function(u){for(var d=0,f;d<e;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function I1(t,e){var r=typeof e,n;return e==null||r==="boolean"?SM(e):(r==="number"?Rj:r==="string"?(n=cw(e))?(e=n,vq):Xze:e instanceof cw?vq:e instanceof Date?Kze:$ze(e)?Hze:Array.isArray(e)?Gze:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?qze:Rj)(t,e)}function jM(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Yze(t,e){e===void 0&&(e=t,t=I1);for(var r=0,n=e.length-1,a=e[0],s=new Array(n<0?0:n);r<n;)s[r]=t(a,a=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function Jze(t){return function(){return t}}function Mj(t){return+t}var yq=[0,1];function Pc(t){return t}function cO(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Jze(isNaN(e)?NaN:.5)}function Zze(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function eWe(t,e,r){var n=t[0],a=t[1],s=e[0],o=e[1];return a<n?(n=cO(a,n),s=r(o,s)):(n=cO(n,a),s=r(s,o)),function(l){return s(n(l))}}function tWe(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=cO(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(l){var c=aN(t,l,1,n)-1;return s[c](a[c](l))}}function iN(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ZP(){var t=yq,e=yq,r=I1,n,a,s,o=Pc,l,c,u;function d(){var A=Math.min(t.length,e.length);return o!==Pc&&(o=Zze(t[0],t[A-1])),l=A>2?tWe:eWe,c=u=null,f}function f(A){return A==null||isNaN(A=+A)?s:(c||(c=l(t.map(n),e,r)))(n(o(A)))}return f.invert=function(A){return o(a((u||(u=l(e,t.map(n),Rj)))(A)))},f.domain=function(A){return arguments.length?(t=Array.from(A,Mj),d()):t.slice()},f.range=function(A){return arguments.length?(e=Array.from(A),d()):e.slice()},f.rangeRound=function(A){return e=Array.from(A),r=jM,d()},f.clamp=function(A){return arguments.length?(o=A?!0:Pc,d()):o!==Pc},f.interpolate=function(A){return arguments.length?(r=A,d()):r},f.unknown=function(A){return arguments.length?(s=A,f):s},function(A,h){return n=A,a=h,d()}}function IM(){return ZP()(Pc,Pc)}function rWe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Lj(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Yv(t){return t=Lj(Math.abs(t)),t?t[1]:NaN}function nWe(t,e){return function(r,n){for(var a=r.length,s=[],o=0,l=t[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return s.reverse().join(e)}}function aWe(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var sWe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function uw(t){if(!(e=sWe.exec(t)))throw new Error("invalid format: "+t);var e;return new PM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}uw.prototype=PM.prototype;function PM(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}PM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function iWe(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var Uj;function oWe(t,e){var r=Lj(t,e);if(!r)return Uj=void 0,t.toPrecision(e);var n=r[0],a=r[1],s=a-(Uj=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Lj(t,Math.max(0,e+s-1))[0]}function bq(t,e){var r=Lj(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const wq={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:rWe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>bq(t*100,e),r:bq,s:oWe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Nq(t){return t}var Cq=Array.prototype.map,_q=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function lWe(t){var e=t.grouping===void 0||t.thousands===void 0?Nq:nWe(Cq.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Nq:aWe(Cq.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f,A){f=uw(f);var h=f.fill,m=f.align,p=f.sign,x=f.symbol,v=f.zero,y=f.width,b=f.comma,w=f.precision,I=f.trim,j=f.type;j==="n"?(b=!0,j="g"):wq[j]||(w===void 0&&(w=12),I=!0,j="g"),(v||h==="0"&&m==="=")&&(v=!0,h="0",m="=");var C=(A&&A.prefix!==void 0?A.prefix:"")+(x==="$"?r:x==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():""),S=(x==="$"?n:/[%p]/.test(j)?o:"")+(A&&A.suffix!==void 0?A.suffix:""),E=wq[j],B=/[defgprs%]/.test(j);w=w===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function k(T){var P=C,G=S,ce,ue,le;if(j==="c")G=E(T)+G,T="";else{T=+T;var Ae=T<0||1/T<0;if(T=isNaN(T)?c:E(Math.abs(T),w),I&&(T=iWe(T)),Ae&&+T==0&&p!=="+"&&(Ae=!1),P=(Ae?p==="("?p:l:p==="-"||p==="("?"":p)+P,G=(j==="s"&&!isNaN(T)&&Uj!==void 0?_q[8+Uj/3]:"")+G+(Ae&&p==="("?")":""),B){for(ce=-1,ue=T.length;++ce<ue;)if(le=T.charCodeAt(ce),48>le||le>57){G=(le===46?a+T.slice(ce+1):T.slice(ce))+G,T=T.slice(0,ce);break}}}b&&!v&&(T=e(T,1/0));var ae=P.length+T.length+G.length,_e=ae<y?new Array(y-ae+1).join(h):"";switch(b&&v&&(T=e(_e+T,_e.length?y-G.length:1/0),_e=""),m){case"<":T=P+T+G+_e;break;case"=":T=P+_e+T+G;break;case"^":T=_e.slice(0,ae=_e.length>>1)+P+T+G+_e.slice(ae);break;default:T=_e+P+T+G;break}return s(T)}return k.toString=function(){return f+""},k}function d(f,A){var h=Math.max(-8,Math.min(8,Math.floor(Yv(A)/3)))*3,m=Math.pow(10,-h),p=u((f=uw(f),f.type="f",f),{suffix:_q[8+h/3]});return function(x){return p(m*x)}}return{format:u,formatPrefix:d}}var I_,TM,hle;cWe({thousands:",",grouping:[3],currency:["$",""]});function cWe(t){return I_=lWe(t),TM=I_.format,hle=I_.formatPrefix,I_}function uWe(t){return Math.max(0,-Yv(Math.abs(t)))}function dWe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Yv(e)/3)))*3-Yv(Math.abs(t)))}function fWe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Yv(e)-Yv(t))+1}function Ale(t,e,r,n){var a=sO(t,e,r),s;switch(n=uw(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(s=dWe(a,o))&&(n.precision=s),hle(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=fWe(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=uWe(a))&&(n.precision=s-(n.type==="%")*2);break}}return TM(n)}function qm(t){var e=t.domain;return t.ticks=function(r){var n=e();return nO(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return Ale(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,s=n.length-1,o=n[a],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=a,a=s,s=u);d-- >0;){if(u=aO(o,l,r),u===c)return n[a]=o,n[s]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function mle(){var t=IM();return t.copy=function(){return iN(t,mle())},Hd.apply(t,arguments),qm(t)}function ple(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Mj),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return ple(t).unknown(e)},t=arguments.length?Array.from(t,Mj):[0,1],qm(r)}function gle(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],s=t[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),t[r]=e.floor(a),t[n]=e.ceil(s),t}function Eq(t){return Math.log(t)}function Sq(t){return Math.exp(t)}function hWe(t){return-Math.log(-t)}function AWe(t){return-Math.exp(-t)}function mWe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function pWe(t){return t===10?mWe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function gWe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function jq(t){return(e,r)=>-t(-e,r)}function BM(t){const e=t(Eq,Sq),r=e.domain;let n=10,a,s;function o(){return a=gWe(n),s=pWe(n),r()[0]<0?(a=jq(a),s=jq(s),t(hWe,AWe)):t(Eq,Sq),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let A=a(u),h=a(d),m,p;const x=l==null?10:+l;let v=[];if(!(n%1)&&h-A<x){if(A=Math.floor(A),h=Math.ceil(h),u>0){for(;A<=h;++A)for(m=1;m<n;++m)if(p=A<0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}}else for(;A<=h;++A)for(m=n-1;m>=1;--m)if(p=A>0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}v.length*2<x&&(v=nO(u,d,x))}else v=nO(A,h,Math.min(h-A,x)).map(s);return f?v.reverse():v},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=uw(c)).precision==null&&(c.trim=!0),c=TM(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},e.nice=()=>r(gle(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),e}function xle(){const t=BM(ZP()).domain([1,10]);return t.copy=()=>iN(t,xle()).base(t.base()),Hd.apply(t,arguments),t}function Iq(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Pq(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function kM(t){var e=1,r=t(Iq(e),Pq(e));return r.constant=function(n){return arguments.length?t(Iq(e=+n),Pq(e)):e},qm(r)}function vle(){var t=kM(ZP());return t.copy=function(){return iN(t,vle()).constant(t.constant())},Hd.apply(t,arguments)}function Tq(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function xWe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function vWe(t){return t<0?-t*t:t*t}function FM(t){var e=t(Pc,Pc),r=1;function n(){return r===1?t(Pc,Pc):r===.5?t(xWe,vWe):t(Tq(r),Tq(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},qm(e)}function OM(){var t=FM(ZP());return t.copy=function(){return iN(t,OM()).exponent(t.exponent())},Hd.apply(t,arguments),t}function yWe(){return OM.apply(null,arguments).exponent(.5)}function Bq(t){return Math.sign(t)*t*t}function bWe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function yle(){var t=IM(),e=[0,1],r=!1,n;function a(s){var o=bWe(t(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return t.invert(Bq(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((e=Array.from(s,Mj)).map(Bq)),a):e.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return yle(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Hd.apply(a,arguments),qm(a)}function ble(){var t=[],e=[],r=[],n;function a(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=_ze(t,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:e[aN(r,o)]}return s.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(xm),a()},s.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return ble().domain(t).range(e).unknown(n)},Hd.apply(s,arguments)}function wle(){var t=0,e=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[aN(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return wle().domain([t,e]).range(a).unknown(s)},Hd.apply(qm(o),arguments)}function Nle(){var t=[.5],e=[0,1],r,n=1;function a(s){return s!=null&&s<=s?e[aN(t,s,0,n)]:r}return a.domain=function(s){return arguments.length?(t=Array.from(s),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return Nle().domain(t).range(e).unknown(r)},Hd.apply(a,arguments)}const _T=new Date,ET=new Date;function Lo(t,e,r,n){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),e(s,l),t(s);while(u<s&&s<o);return c},a.filter=s=>Lo(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!s(o););else for(;--l>=0;)for(;e(o,1),!s(o););}),r&&(a.count=(s,o)=>(_T.setTime(+s),ET.setTime(+o),t(_T),t(ET),Math.floor(r(_T,ET))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const Qj=Lo(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Qj.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Lo(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Qj);Qj.range;const eA=1e3,Sd=eA*60,tA=Sd*60,EA=tA*24,DM=EA*7,kq=EA*30,ST=EA*365,Op=Lo(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*eA)},(t,e)=>(e-t)/eA,t=>t.getUTCSeconds());Op.range;const RM=Lo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*eA)},(t,e)=>{t.setTime(+t+e*Sd)},(t,e)=>(e-t)/Sd,t=>t.getMinutes());RM.range;const MM=Lo(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Sd)},(t,e)=>(e-t)/Sd,t=>t.getUTCMinutes());MM.range;const LM=Lo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*eA-t.getMinutes()*Sd)},(t,e)=>{t.setTime(+t+e*tA)},(t,e)=>(e-t)/tA,t=>t.getHours());LM.range;const UM=Lo(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*tA)},(t,e)=>(e-t)/tA,t=>t.getUTCHours());UM.range;const oN=Lo(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Sd)/EA,t=>t.getDate()-1);oN.range;const e3=Lo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/EA,t=>t.getUTCDate()-1);e3.range;const Cle=Lo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/EA,t=>Math.floor(t/EA));Cle.range;function zg(t){return Lo(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Sd)/DM)}const t3=zg(0),Vj=zg(1),wWe=zg(2),NWe=zg(3),Jv=zg(4),CWe=zg(5),_We=zg(6);t3.range;Vj.range;wWe.range;NWe.range;Jv.range;CWe.range;_We.range;function Wg(t){return Lo(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/DM)}const r3=Wg(0),Hj=Wg(1),EWe=Wg(2),SWe=Wg(3),Zv=Wg(4),jWe=Wg(5),IWe=Wg(6);r3.range;Hj.range;EWe.range;SWe.range;Zv.range;jWe.range;IWe.range;const QM=Lo(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());QM.range;const VM=Lo(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());VM.range;const SA=Lo(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());SA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Lo(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});SA.range;const jA=Lo(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());jA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Lo(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});jA.range;function _le(t,e,r,n,a,s){const o=[[Op,1,eA],[Op,5,5*eA],[Op,15,15*eA],[Op,30,30*eA],[s,1,Sd],[s,5,5*Sd],[s,15,15*Sd],[s,30,30*Sd],[a,1,tA],[a,3,3*tA],[a,6,6*tA],[a,12,12*tA],[n,1,EA],[n,2,2*EA],[r,1,DM],[e,1,kq],[e,3,3*kq],[t,1,ST]];function l(u,d,f){const A=d<u;A&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),m=h?h.range(u,+d+1):[];return A?m.reverse():m}function c(u,d,f){const A=Math.abs(d-u)/f,h=NM(([,,x])=>x).right(o,A);if(h===o.length)return t.every(sO(u/ST,d/ST,f));if(h===0)return Qj.every(Math.max(sO(u,d,f),1));const[m,p]=o[A/o[h-1][2]<o[h][2]/A?h-1:h];return m.every(p)}return[l,c]}const[PWe,TWe]=_le(jA,VM,r3,Cle,UM,MM),[BWe,kWe]=_le(SA,QM,t3,oN,LM,RM);function jT(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function IT(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function By(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function FWe(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,s=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=ky(a),d=Fy(a),f=ky(s),A=Fy(s),h=ky(o),m=Fy(o),p=ky(l),x=Fy(l),v=ky(c),y=Fy(c),b={a:le,A:Ae,b:ae,B:_e,c:null,d:Lq,e:Lq,f:nXe,g:hXe,G:mXe,H:eXe,I:tXe,j:rXe,L:Ele,m:aXe,M:sXe,p:De,q:O,Q:Vq,s:Hq,S:iXe,u:oXe,U:lXe,V:cXe,w:uXe,W:dXe,x:null,X:null,y:fXe,Y:AXe,Z:pXe,"%":Qq},w={a:H,A:K,b:R,B:X,c:null,d:Uq,e:Uq,f:yXe,g:PXe,G:BXe,H:gXe,I:xXe,j:vXe,L:jle,m:bXe,M:wXe,p:Y,q:D,Q:Vq,s:Hq,S:NXe,u:CXe,U:_Xe,V:EXe,w:SXe,W:jXe,x:null,X:null,y:IXe,Y:TXe,Z:kXe,"%":Qq},I={a:B,A:k,b:T,B:P,c:G,d:Rq,e:Rq,f:XWe,g:Dq,G:Oq,H:Mq,I:Mq,j:KWe,L:WWe,m:GWe,M:qWe,p:E,q:$We,Q:JWe,s:ZWe,S:zWe,u:LWe,U:UWe,V:QWe,w:MWe,W:VWe,x:ce,X:ue,y:Dq,Y:Oq,Z:HWe,"%":YWe};b.x=j(r,b),b.X=j(n,b),b.c=j(e,b),w.x=j(r,w),w.X=j(n,w),w.c=j(e,w);function j(Q,te){return function(be){var U=[],Xe=-1,se=0,ee=Q.length,Fe,je,Se;for(be instanceof Date||(be=new Date(+be));++Xe<ee;)Q.charCodeAt(Xe)===37&&(U.push(Q.slice(se,Xe)),(je=Fq[Fe=Q.charAt(++Xe)])!=null?Fe=Q.charAt(++Xe):je=Fe==="e"?" ":"0",(Se=te[Fe])&&(Fe=Se(be,je)),U.push(Fe),se=Xe+1);return U.push(Q.slice(se,Xe)),U.join("")}}function C(Q,te){return function(be){var U=By(1900,void 0,1),Xe=S(U,Q,be+="",0),se,ee;if(Xe!=be.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(te&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(se=IT(By(U.y,0,1)),ee=se.getUTCDay(),se=ee>4||ee===0?Hj.ceil(se):Hj(se),se=e3.offset(se,(U.V-1)*7),U.y=se.getUTCFullYear(),U.m=se.getUTCMonth(),U.d=se.getUTCDate()+(U.w+6)%7):(se=jT(By(U.y,0,1)),ee=se.getDay(),se=ee>4||ee===0?Vj.ceil(se):Vj(se),se=oN.offset(se,(U.V-1)*7),U.y=se.getFullYear(),U.m=se.getMonth(),U.d=se.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),ee="Z"in U?IT(By(U.y,0,1)).getUTCDay():jT(By(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(ee+5)%7:U.w+U.U*7-(ee+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,IT(U)):jT(U)}}function S(Q,te,be,U){for(var Xe=0,se=te.length,ee=be.length,Fe,je;Xe<se;){if(U>=ee)return-1;if(Fe=te.charCodeAt(Xe++),Fe===37){if(Fe=te.charAt(Xe++),je=I[Fe in Fq?te.charAt(Xe++):Fe],!je||(U=je(Q,be,U))<0)return-1}else if(Fe!=be.charCodeAt(U++))return-1}return U}function E(Q,te,be){var U=u.exec(te.slice(be));return U?(Q.p=d.get(U[0].toLowerCase()),be+U[0].length):-1}function B(Q,te,be){var U=h.exec(te.slice(be));return U?(Q.w=m.get(U[0].toLowerCase()),be+U[0].length):-1}function k(Q,te,be){var U=f.exec(te.slice(be));return U?(Q.w=A.get(U[0].toLowerCase()),be+U[0].length):-1}function T(Q,te,be){var U=v.exec(te.slice(be));return U?(Q.m=y.get(U[0].toLowerCase()),be+U[0].length):-1}function P(Q,te,be){var U=p.exec(te.slice(be));return U?(Q.m=x.get(U[0].toLowerCase()),be+U[0].length):-1}function G(Q,te,be){return S(Q,e,te,be)}function ce(Q,te,be){return S(Q,r,te,be)}function ue(Q,te,be){return S(Q,n,te,be)}function le(Q){return o[Q.getDay()]}function Ae(Q){return s[Q.getDay()]}function ae(Q){return c[Q.getMonth()]}function _e(Q){return l[Q.getMonth()]}function De(Q){return a[+(Q.getHours()>=12)]}function O(Q){return 1+~~(Q.getMonth()/3)}function H(Q){return o[Q.getUTCDay()]}function K(Q){return s[Q.getUTCDay()]}function R(Q){return c[Q.getUTCMonth()]}function X(Q){return l[Q.getUTCMonth()]}function Y(Q){return a[+(Q.getUTCHours()>=12)]}function D(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var te=j(Q+="",b);return te.toString=function(){return Q},te},parse:function(Q){var te=C(Q+="",!1);return te.toString=function(){return Q},te},utcFormat:function(Q){var te=j(Q+="",w);return te.toString=function(){return Q},te},utcParse:function(Q){var te=C(Q+="",!0);return te.toString=function(){return Q},te}}}var Fq={"-":"",_:" ",0:"0"},ol=/^\s*\d+/,OWe=/^%/,DWe=/[\\^$*+?|[\]().{}]/g;function ka(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(e)+a:a)}function RWe(t){return t.replace(DWe,"\\$&")}function ky(t){return new RegExp("^(?:"+t.map(RWe).join("|")+")","i")}function Fy(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function MWe(t,e,r){var n=ol.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function LWe(t,e,r){var n=ol.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function UWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function QWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function VWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function Oq(t,e,r){var n=ol.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Dq(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function HWe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function $We(t,e,r){var n=ol.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function GWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Rq(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function KWe(t,e,r){var n=ol.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Mq(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function qWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function zWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function WWe(t,e,r){var n=ol.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function XWe(t,e,r){var n=ol.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function YWe(t,e,r){var n=OWe.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function JWe(t,e,r){var n=ol.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function ZWe(t,e,r){var n=ol.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Lq(t,e){return ka(t.getDate(),e,2)}function eXe(t,e){return ka(t.getHours(),e,2)}function tXe(t,e){return ka(t.getHours()%12||12,e,2)}function rXe(t,e){return ka(1+oN.count(SA(t),t),e,3)}function Ele(t,e){return ka(t.getMilliseconds(),e,3)}function nXe(t,e){return Ele(t,e)+"000"}function aXe(t,e){return ka(t.getMonth()+1,e,2)}function sXe(t,e){return ka(t.getMinutes(),e,2)}function iXe(t,e){return ka(t.getSeconds(),e,2)}function oXe(t){var e=t.getDay();return e===0?7:e}function lXe(t,e){return ka(t3.count(SA(t)-1,t),e,2)}function Sle(t){var e=t.getDay();return e>=4||e===0?Jv(t):Jv.ceil(t)}function cXe(t,e){return t=Sle(t),ka(Jv.count(SA(t),t)+(SA(t).getDay()===4),e,2)}function uXe(t){return t.getDay()}function dXe(t,e){return ka(Vj.count(SA(t)-1,t),e,2)}function fXe(t,e){return ka(t.getFullYear()%100,e,2)}function hXe(t,e){return t=Sle(t),ka(t.getFullYear()%100,e,2)}function AXe(t,e){return ka(t.getFullYear()%1e4,e,4)}function mXe(t,e){var r=t.getDay();return t=r>=4||r===0?Jv(t):Jv.ceil(t),ka(t.getFullYear()%1e4,e,4)}function pXe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ka(e/60|0,"0",2)+ka(e%60,"0",2)}function Uq(t,e){return ka(t.getUTCDate(),e,2)}function gXe(t,e){return ka(t.getUTCHours(),e,2)}function xXe(t,e){return ka(t.getUTCHours()%12||12,e,2)}function vXe(t,e){return ka(1+e3.count(jA(t),t),e,3)}function jle(t,e){return ka(t.getUTCMilliseconds(),e,3)}function yXe(t,e){return jle(t,e)+"000"}function bXe(t,e){return ka(t.getUTCMonth()+1,e,2)}function wXe(t,e){return ka(t.getUTCMinutes(),e,2)}function NXe(t,e){return ka(t.getUTCSeconds(),e,2)}function CXe(t){var e=t.getUTCDay();return e===0?7:e}function _Xe(t,e){return ka(r3.count(jA(t)-1,t),e,2)}function Ile(t){var e=t.getUTCDay();return e>=4||e===0?Zv(t):Zv.ceil(t)}function EXe(t,e){return t=Ile(t),ka(Zv.count(jA(t),t)+(jA(t).getUTCDay()===4),e,2)}function SXe(t){return t.getUTCDay()}function jXe(t,e){return ka(Hj.count(jA(t)-1,t),e,2)}function IXe(t,e){return ka(t.getUTCFullYear()%100,e,2)}function PXe(t,e){return t=Ile(t),ka(t.getUTCFullYear()%100,e,2)}function TXe(t,e){return ka(t.getUTCFullYear()%1e4,e,4)}function BXe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Zv(t):Zv.ceil(t),ka(t.getUTCFullYear()%1e4,e,4)}function kXe(){return"+0000"}function Qq(){return"%"}function Vq(t){return+t}function Hq(t){return Math.floor(+t/1e3)}var wx,Ple,Tle;FXe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function FXe(t){return wx=FWe(t),Ple=wx.format,wx.parse,Tle=wx.utcFormat,wx.utcParse,wx}function OXe(t){return new Date(t)}function DXe(t){return t instanceof Date?+t:+new Date(+t)}function HM(t,e,r,n,a,s,o,l,c,u){var d=IM(),f=d.invert,A=d.domain,h=u(".%L"),m=u(":%S"),p=u("%I:%M"),x=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),w=u("%Y");function I(j){return(c(j)<j?h:l(j)<j?m:o(j)<j?p:s(j)<j?x:n(j)<j?a(j)<j?v:y:r(j)<j?b:w)(j)}return d.invert=function(j){return new Date(f(j))},d.domain=function(j){return arguments.length?A(Array.from(j,DXe)):A().map(OXe)},d.ticks=function(j){var C=A();return t(C[0],C[C.length-1],j??10)},d.tickFormat=function(j,C){return C==null?I:u(C)},d.nice=function(j){var C=A();return(!j||typeof j.range!="function")&&(j=e(C[0],C[C.length-1],j??10)),j?A(gle(C,j)):d},d.copy=function(){return iN(d,HM(t,e,r,n,a,s,o,l,c,u))},d}function RXe(){return Hd.apply(HM(BWe,kWe,SA,QM,t3,oN,LM,RM,Op,Ple).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MXe(){return Hd.apply(HM(PWe,TWe,jA,VM,r3,e3,UM,MM,Op,Tle).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function n3(){var t=0,e=1,r,n,a,s,o=Pc,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,r=s(t=+t),n=s(e=+e),a=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(A){var h,m;return arguments.length?([h,m]=A,o=f(h,m),u):[o(0),o(1)]}}return u.range=d(I1),u.rangeRound=d(jM),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(t),n=f(e),a=r===n?0:1/(n-r),u}}function zm(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Ble(){var t=qm(n3()(Pc));return t.copy=function(){return zm(t,Ble())},HA.apply(t,arguments)}function kle(){var t=BM(n3()).domain([1,10]);return t.copy=function(){return zm(t,kle()).base(t.base())},HA.apply(t,arguments)}function Fle(){var t=kM(n3());return t.copy=function(){return zm(t,Fle()).constant(t.constant())},HA.apply(t,arguments)}function $M(){var t=FM(n3());return t.copy=function(){return zm(t,$M()).exponent(t.exponent())},HA.apply(t,arguments)}function LXe(){return $M.apply(null,arguments).exponent(.5)}function Ole(){var t=[],e=Pc;function r(n){if(n!=null&&!isNaN(n=+n))return e((aN(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(xm),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>Cze(t,s/n))},r.copy=function(){return Ole(e).domain(t)},HA.apply(r,arguments)}function a3(){var t=0,e=.5,r=1,n=1,a,s,o,l,c,u=Pc,d,f=!1,A;function h(p){return isNaN(p=+p)?A:(p=.5+((p=+d(p))-s)*(n*p<n*s?l:c),u(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([t,e,r]=p,a=d(t=+t),s=d(e=+e),o=d(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h):[t,e,r]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(u=p,h):u};function m(p){return function(x){var v,y,b;return arguments.length?([v,y,b]=x,u=Yze(p,[v,y,b]),h):[u(0),u(.5),u(1)]}}return h.range=m(I1),h.rangeRound=m(jM),h.unknown=function(p){return arguments.length?(A=p,h):A},function(p){return d=p,a=p(t),s=p(e),o=p(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h}}function Dle(){var t=qm(a3()(Pc));return t.copy=function(){return zm(t,Dle())},HA.apply(t,arguments)}function Rle(){var t=BM(a3()).domain([.1,1,10]);return t.copy=function(){return zm(t,Rle()).base(t.base())},HA.apply(t,arguments)}function Mle(){var t=kM(a3());return t.copy=function(){return zm(t,Mle()).constant(t.constant())},HA.apply(t,arguments)}function GM(){var t=FM(a3());return t.copy=function(){return zm(t,GM()).exponent(t.exponent())},HA.apply(t,arguments)}function UXe(){return GM.apply(null,arguments).exponent(.5)}const ob=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:_M,scaleDiverging:Dle,scaleDivergingLog:Rle,scaleDivergingPow:GM,scaleDivergingSqrt:UXe,scaleDivergingSymlog:Mle,scaleIdentity:ple,scaleImplicit:iO,scaleLinear:mle,scaleLog:xle,scaleOrdinal:CM,scalePoint:Sze,scalePow:OM,scaleQuantile:ble,scaleQuantize:wle,scaleRadial:yle,scaleSequential:Ble,scaleSequentialLog:kle,scaleSequentialPow:$M,scaleSequentialQuantile:Ole,scaleSequentialSqrt:LXe,scaleSequentialSymlog:Fle,scaleSqrt:yWe,scaleSymlog:vle,scaleThreshold:Nle,scaleTime:RXe,scaleUtc:MXe,tickFormat:Ale},Symbol.toStringTag,{value:"Module"}));var $A=t=>t.chartData,s3=tr([$A],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),Lle=(t,e,r,n)=>n?s3(t):$A(t),QXe=(t,e,r)=>r?s3(t):$A(t);function Om(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(pi(e)&&pi(r))return!0}return!1}function $q(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function Ule(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,s;if(pi(r))a=r;else if(typeof r=="function")return;if(pi(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(Om(o))return o}}function VXe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Om(n))return $q(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,s]=t,o,l;if(a==="auto")e!=null&&(o=Math.min(...e));else if(Cn(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e==null?void 0:e[0]))}catch{}else if(typeof a=="string"&&oK.test(a)){var c=oK.exec(a);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e==null?void 0:e[0];if(s==="auto")e!=null&&(l=Math.max(...e));else if(Cn(s))l=s;else if(typeof s=="function")try{e!=null&&(l=s(e==null?void 0:e[1]))}catch{}else if(typeof s=="string"&&lK.test(s)){var d=lK.exec(s);if(d==null||d[1]==null||e==null)l=void 0;else{var f=+d[1];l=e[1]+f}}else l=e==null?void 0:e[1];var A=[o,l];if(Om(A))return e==null?A:$q(A,e,r)}}}var P1=1e9,HXe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},qM,Ws=!0,Ld="[DecimalError] ",Jp=Ld+"Invalid argument: ",KM=Ld+"Exponent out of range: ",T1=Math.floor,xp=Math.pow,$Xe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ku,Yo=1e7,Bs=7,Qle=9007199254740991,$j=T1(Qle/Bs),on={};on.absoluteValue=on.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};on.comparedTo=on.cmp=function(t){var e,r,n,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(n=s.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};on.decimalPlaces=on.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*Bs;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};on.dividedBy=on.div=function(t){return fA(this,new this.constructor(t))};on.dividedToIntegerBy=on.idiv=function(t){var e=this,r=e.constructor;return ps(fA(e,new r(t),0,1),r.precision)};on.equals=on.eq=function(t){return!this.cmp(t)};on.exponent=function(){return fo(this)};on.greaterThan=on.gt=function(t){return this.cmp(t)>0};on.greaterThanOrEqualTo=on.gte=function(t){return this.cmp(t)>=0};on.isInteger=on.isint=function(){return this.e>this.d.length-2};on.isNegative=on.isneg=function(){return this.s<0};on.isPositive=on.ispos=function(){return this.s>0};on.isZero=function(){return this.s===0};on.lessThan=on.lt=function(t){return this.cmp(t)<0};on.lessThanOrEqualTo=on.lte=function(t){return this.cmp(t)<1};on.logarithm=on.log=function(t){var e,r=this,n=r.constructor,a=n.precision,s=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(ku))throw Error(Ld+"NaN");if(r.s<1)throw Error(Ld+(r.s?"NaN":"-Infinity"));return r.eq(ku)?new n(0):(Ws=!1,e=fA(dw(r,s),dw(t,s),s),Ws=!0,ps(e,a))};on.minus=on.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?$le(e,t):Vle(e,(t.s=-t.s,t))};on.modulo=on.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(Ld+"NaN");return r.s?(Ws=!1,e=fA(r,t,0,1).times(t),Ws=!0,r.minus(e)):ps(new n(r),a)};on.naturalExponential=on.exp=function(){return Hle(this)};on.naturalLogarithm=on.ln=function(){return dw(this)};on.negated=on.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};on.plus=on.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Vle(e,t):$le(e,(t.s=-t.s,t))};on.precision=on.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Jp+t);if(e=fo(a)+1,n=a.d.length-1,r=n*Bs+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};on.squareRoot=on.sqrt=function(){var t,e,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ld+"NaN")}for(t=fo(l),Ws=!1,a=Math.sqrt(+l),a==0||a==1/0?(e=nh(l.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=T1((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(fA(l,s,o+2)).times(.5),nh(s.d).slice(0,o)===(e=nh(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(ps(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(e!="9999")break;o+=4}return Ws=!0,ps(n,r)};on.times=on.mul=function(t){var e,r,n,a,s,o,l,c,u,d=this,f=d.constructor,A=d.d,h=(t=new f(t)).d;if(!d.s||!t.s)return new f(0);for(t.s*=d.s,r=d.e+t.e,c=A.length,u=h.length,c<u&&(s=A,A=h,h=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(e=0,a=c+n;a>n;)l=s[a]+h[n]*A[a-n-1]+e,s[a--]=l%Yo|0,e=l/Yo|0;s[a]=(s[a]+e)%Yo|0}for(;!s[--o];)s.pop();return e?++r:s.shift(),t.d=s,t.e=r,Ws?ps(t,f.precision):t};on.toDecimalPlaces=on.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Ah(t,0,P1),e===void 0?e=n.rounding:Ah(e,0,8),ps(r,t+fo(r)+1,e))};on.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=jg(n,!0):(Ah(t,0,P1),e===void 0?e=a.rounding:Ah(e,0,8),n=ps(new a(n),t+1,e),r=jg(n,!0,t+1)),r};on.toFixed=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?jg(a):(Ah(t,0,P1),e===void 0?e=s.rounding:Ah(e,0,8),n=ps(new s(a),t+fo(a)+1,e),r=jg(n.abs(),!1,t+fo(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};on.toInteger=on.toint=function(){var t=this,e=t.constructor;return ps(new e(t),fo(t)+1,e.rounding)};on.toNumber=function(){return+this};on.toPower=on.pow=function(t){var e,r,n,a,s,o,l=this,c=l.constructor,u=12,d=+(t=new c(t));if(!t.s)return new c(ku);if(l=new c(l),!l.s){if(t.s<1)throw Error(Ld+"Infinity");return l}if(l.eq(ku))return l;if(n=c.precision,t.eq(ku))return ps(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,s=l.s,o){if((r=d<0?-d:d)<=Qle){for(a=new c(ku),e=Math.ceil(n/Bs+4),Ws=!1;r%2&&(a=a.times(l),Kq(a.d,e)),r=T1(r/2),r!==0;)l=l.times(l),Kq(l.d,e);return Ws=!0,t.s<0?new c(ku).div(a):ps(a,n)}}else if(s<0)throw Error(Ld+"NaN");return s=s<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,Ws=!1,a=t.times(dw(l,n+u)),Ws=!0,a=Hle(a),a.s=s,a};on.toPrecision=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?(r=fo(a),n=jg(a,r<=s.toExpNeg||r>=s.toExpPos)):(Ah(t,1,P1),e===void 0?e=s.rounding:Ah(e,0,8),a=ps(new s(a),t,e),r=fo(a),n=jg(a,t<=r||r<=s.toExpNeg,t)),n};on.toSignificantDigits=on.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Ah(t,1,P1),e===void 0?e=n.rounding:Ah(e,0,8)),ps(new n(r),t,e)};on.toString=on.valueOf=on.val=on.toJSON=on[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=fo(t),r=t.constructor;return jg(t,e<=r.toExpNeg||e>=r.toExpPos)};function Vle(t,e){var r,n,a,s,o,l,c,u,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),Ws?ps(e,f):e;if(c=t.d,u=e.d,o=t.e,a=e.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,a=o,l=c.length),o=Math.ceil(f/Bs),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Yo|0,c[s]%=Yo;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=a,Ws?ps(e,f):e}function Ah(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Jp+t)}function nh(t){var e,r,n,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,e=1;e<a;e++)n=t[e]+"",r=Bs-n.length,r&&(s+=B0(r)),s+=n;o=t[e],n=o+"",r=Bs-n.length,r&&(s+=B0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var fA=function(){function t(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%Yo|0,o=s/Yo|0;return o&&n.unshift(o),n}function e(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*Yo+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,I,j,C,S,E=n.constructor,B=n.s==a.s?1:-1,k=n.d,T=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(Ld+"Division by zero");for(c=n.e-a.e,C=T.length,I=k.length,h=new E(B),m=h.d=[],u=0;T[u]==(k[u]||0);)++u;if(T[u]>(k[u]||0)&&--c,s==null?y=s=E.precision:o?y=s+(fo(n)-fo(a))+1:y=s,y<0)return new E(0);if(y=y/Bs+2|0,u=0,C==1)for(d=0,T=T[0],y++;(u<I||d)&&y--;u++)b=d*Yo+(k[u]||0),m[u]=b/T|0,d=b%T|0;else{for(d=Yo/(T[0]+1)|0,d>1&&(T=t(T,d),k=t(k,d),C=T.length,I=k.length),w=C,p=k.slice(0,C),x=p.length;x<C;)p[x++]=0;S=T.slice(),S.unshift(0),j=T[0],T[1]>=Yo/2&&++j;do d=0,l=e(T,p,C,x),l<0?(v=p[0],C!=x&&(v=v*Yo+(p[1]||0)),d=v/j|0,d>1?(d>=Yo&&(d=Yo-1),f=t(T,d),A=f.length,x=p.length,l=e(f,p,A,x),l==1&&(d--,r(f,C<A?S:T,A))):(d==0&&(l=d=1),f=T.slice()),A=f.length,A<x&&f.unshift(0),r(p,f,x),l==-1&&(x=p.length,l=e(T,p,C,x),l<1&&(d++,r(p,C<x?S:T,x))),x=p.length):l===0&&(d++,p=[0]),m[u++]=d,l&&p[0]?p[x++]=k[w]||0:(p=[k[w]],x=1);while((w++<I||p[0]!==void 0)&&y--)}return m[0]||m.shift(),h.e=c,ps(h,o?s+fo(h)+1:s)}}();function Hle(t,e){var r,n,a,s,o,l,c=0,u=0,d=t.constructor,f=d.precision;if(fo(t)>16)throw Error(KM+fo(t));if(!t.s)return new d(ku);for(Ws=!1,l=f,o=new d(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(xp(2,u))/Math.LN10*2+5|0,l+=n,r=a=s=new d(ku),d.precision=l;;){if(a=ps(a.times(t),l),r=r.times(++c),o=s.plus(fA(a,r,l)),nh(o.d).slice(0,l)===nh(s.d).slice(0,l)){for(;u--;)s=ps(s.times(s),l);return d.precision=f,e==null?(Ws=!0,ps(s,f)):s}s=o}}function fo(t){for(var e=t.e*Bs,r=t.d[0];r>=10;r/=10)e++;return e}function PT(t,e,r){if(e>t.LN10.sd())throw Ws=!0,r&&(t.precision=r),Error(Ld+"LN10 precision limit exceeded");return ps(new t(t.LN10),e)}function B0(t){for(var e="";t--;)e+="0";return e}function dw(t,e){var r,n,a,s,o,l,c,u,d,f=1,A=10,h=t,m=h.d,p=h.constructor,x=p.precision;if(h.s<1)throw Error(Ld+(h.s?"NaN":"-Infinity"));if(h.eq(ku))return new p(0);if(e==null?(Ws=!1,u=x):u=e,h.eq(10))return e==null&&(Ws=!0),PT(p,u);if(u+=A,p.precision=u,r=nh(m),n=r.charAt(0),s=fo(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(t),r=nh(h.d),n=r.charAt(0),f++;s=fo(h),n>1?(h=new p("0."+r),s++):h=new p(n+"."+r.slice(1))}else return c=PT(p,u+2,x).times(s+""),h=dw(new p(n+"."+r.slice(1)),u-A).plus(c),p.precision=x,e==null?(Ws=!0,ps(h,x)):h;for(l=o=h=fA(h.minus(ku),h.plus(ku),u),d=ps(h.times(h),u),a=3;;){if(o=ps(o.times(d),u),c=l.plus(fA(o,new p(a),u)),nh(c.d).slice(0,u)===nh(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(PT(p,u+2,x).times(s+""))),l=fA(l,new p(f),u),p.precision=x,e==null?(Ws=!0,ps(l,x)):l;l=c,a+=2}}function Gq(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=T1(r/Bs),t.d=[],n=(r+1)%Bs,r<0&&(n+=Bs),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=Bs;n<a;)t.d.push(+e.slice(n,n+=Bs));e=e.slice(n),n=Bs-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),Ws&&(t.e>$j||t.e<-$j))throw Error(KM+r)}else t.s=0,t.e=0,t.d=[0];return t}function ps(t,e,r){var n,a,s,o,l,c,u,d,f=t.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=e-o,n<0)n+=Bs,a=e,u=f[d=0];else{if(d=Math.ceil((n+1)/Bs),s=f.length,d>=s)return t;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=Bs,a=n-Bs+o}if(r!==void 0&&(s=xp(10,o-a-1),l=u/s%10|0,c=e<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/xp(10,o-a):0:f[d-1])%10&1||r==(t.s<0?8:7))),e<1||!f[0])return c?(s=fo(t),f.length=1,e=e-s-1,f[0]=xp(10,(Bs-e%Bs)%Bs),t.e=T1(-e/Bs)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=xp(10,Bs-n),f[d]=a>0?(u/xp(10,o-a)%xp(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Yo&&(f[0]=1,++t.e);break}else{if(f[d]+=s,f[d]!=Yo)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(Ws&&(t.e>$j||t.e<-$j))throw Error(KM+fo(t));return t}function $le(t,e){var r,n,a,s,o,l,c,u,d,f,A=t.constructor,h=A.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new A(t),Ws?ps(e,h):e;if(c=t.d,f=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(h/Bs),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}o=0}for(d&&(r=c,c=f,f=r,e.s=-e.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Yo-1;--c[s],c[a]+=Yo}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Ws?ps(e,h):e):new A(0)}function jg(t,e,r){var n,a=fo(t),s=nh(t.d),o=s.length;return e?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+B0(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+B0(-a-1)+s,r&&(n=r-o)>0&&(s+=B0(n))):a>=o?(s+=B0(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+B0(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=B0(n))),t.s<0?"-"+s:s}function Kq(t,e){if(t.length>e)return t.length=e,!0}function Gle(t){var e,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Jp+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Gq(o,s.toString())}else if(typeof s!="string")throw Error(Jp+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,$Xe.test(s))Gq(o,s);else throw Error(Jp+s)}if(a.prototype=on,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Gle,a.config=a.set=GXe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function GXe(t){if(!t||typeof t!="object")throw Error(Ld+"Object expected");var e,r,n,a=["precision",1,P1,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(T1(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(Jp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Jp+r+": "+n);return this}var qM=Gle(HXe);ku=new qM(1);const es=qM;var KXe=t=>t,Kle={},qle=t=>t===Kle,qq=t=>function e(){return arguments.length===0||arguments.length===1&&qle(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},zle=(t,e)=>t===1?e:qq(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(o=>o!==Kle).length;return s>=t?e(...n):zle(t-s,qq(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=n.map(d=>qle(d)?l.shift():d);return e(...u,...l)}))}),qXe=t=>zle(t.length,t),uO=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},zXe=qXe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),WXe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return KXe;var a=r.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}};function Wle(t){var e;return t===0?e=1:e=Math.floor(new es(t).abs().log(10).toNumber())+1,e}function Xle(t,e,r){for(var n=new es(t),a=0,s=[];n.lt(e)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var Yle=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},Jle=(t,e,r)=>{if(t.lte(0))return new es(0);var n=Wle(t.toNumber()),a=new es(10).pow(n),s=t.div(a),o=n!==1?.05:.1,l=new es(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return e?new es(c.toNumber()):new es(Math.ceil(c.toNumber()))},XXe=(t,e,r)=>{var n=new es(1),a=new es(t);if(!a.isint()&&r){var s=Math.abs(t);s<1?(n=new es(10).pow(Wle(t)-1),a=new es(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new es(Math.floor(t)))}else t===0?a=new es(Math.floor((e-1)/2)):r||(a=new es(Math.floor(t)));var o=Math.floor((e-1)/2),l=WXe(zXe(c=>a.add(new es(c-o).mul(n)).toNumber()),uO);return l(0,e)},Zle=function(e,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new es(0),tickMin:new es(0),tickMax:new es(0)};var o=Jle(new es(r).sub(e).div(n-1),a,s),l;e<=0&&r>=0?l=new es(0):(l=new es(e).add(r).div(2),l=l.sub(new es(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new es(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?Zle(e,r,n,a,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new es(c).mul(o)),tickMax:l.add(new es(u).mul(o))})},YXe=function(e){var[r,n]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=Yle([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...uO(0,a-1).map(()=>1/0)]:[...uO(0,a-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(l===c)return XXe(l,a,s);var{step:d,tickMin:f,tickMax:A}=Zle(l,c,o,s,0),h=Xle(f,A.add(new es(.1).mul(d)),d);return r>n?h.reverse():h},JXe=function(e,r){var[n,a]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=Yle([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),u=Jle(new es(l).sub(o).div(c-1),s,0),d=[...Xle(new es(o),new es(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},ece=t=>t.rootProps.maxBarSize,ZXe=t=>t.rootProps.barGap,tce=t=>t.rootProps.barCategoryGap,eYe=t=>t.rootProps.barSize,lN=t=>t.rootProps.stackOffset,rce=t=>t.rootProps.reverseStackOrder,zM=t=>t.options.chartName,WM=t=>t.rootProps.syncId,nce=t=>t.rootProps.syncMethod,XM=t=>t.options.eventEmitter,oc={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},$h={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ju={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},i3=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},tYe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:$h.angleAxisId,includeHidden:!1,name:void 0,reversed:$h.reversed,scale:$h.scale,tick:$h.tick,tickCount:void 0,ticks:void 0,type:$h.type,unit:void 0},rYe={allowDataOverflow:ju.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ju.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ju.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ju.scale,tick:ju.tick,tickCount:ju.tickCount,ticks:void 0,type:ju.type,unit:void 0},nYe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:$h.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$h.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$h.scale,tick:$h.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},aYe={allowDataOverflow:ju.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ju.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ju.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ju.scale,tick:ju.tick,tickCount:ju.tickCount,ticks:void 0,type:"category",unit:void 0},YM=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?nYe:tYe,JM=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?aYe:rYe,o3=t=>t.polarOptions,ZM=tr([QA,VA,Mo],Joe),ace=tr([o3,ZM],(t,e)=>{if(t!=null)return cc(t.innerRadius,e,0)}),sce=tr([o3,ZM],(t,e)=>{if(t!=null)return cc(t.outerRadius,e,e*.8)}),sYe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},ice=tr([o3],sYe);tr([YM,ice],i3);var oce=tr([ZM,ace,sce],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});tr([JM,oce],i3);var lce=tr([Fa,o3,ace,sce,QA,VA],(t,e,r,n,a,s)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:cc(o,a,a/2),cy:cc(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Js=(t,e)=>e,cN=(t,e,r)=>r;function e8(t){return t==null?void 0:t.id}function cce(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=e8(l);u.forEach((f,A)=>{var h=s==null||a?A:String(Ds(f,s,null)),m=Ds(f,l.dataKey,0),p;o.has(h)?p=o.get(h):p={},Object.assign(p,{[d]:m}),o.set(h,p)})}}),Array.from(o.values())}function l3(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var c3=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function u3(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function iYe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Uo=t=>{var e=Fa(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},B1=t=>t.tooltip.settings.axisId;function zq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Gj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zq(Object(r),!0).forEach(function(n){oYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oYe(t,e,r){return(e=lYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lYe(t){var e=cYe(t,"string");return typeof e=="symbol"?e:e+""}function cYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dO=[0,"auto"],Ko={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},uce=(t,e)=>t.cartesianAxis.xAxis[e],GA=(t,e)=>{var r=uce(t,e);return r??Ko},qo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:dO,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:tN},dce=(t,e)=>t.cartesianAxis.yAxis[e],KA=(t,e)=>{var r=dce(t,e);return r??qo},uYe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},t8=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??uYe},gi=(t,e,r)=>{switch(e){case"xAxis":return GA(t,r);case"yAxis":return KA(t,r);case"zAxis":return t8(t,r);case"angleAxis":return YM(t,r);case"radiusAxis":return JM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},dYe=(t,e,r)=>{switch(e){case"xAxis":return GA(t,r);case"yAxis":return KA(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},uN=(t,e,r)=>{switch(e){case"xAxis":return GA(t,r);case"yAxis":return KA(t,r);case"angleAxis":return YM(t,r);case"radiusAxis":return JM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},fce=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function r8(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var n8=t=>t.graphicalItems.cartesianItems,fYe=tr([Js,cN],r8),a8=(t,e,r)=>t.filter(r).filter(n=>(e==null?void 0:e.includeHidden)===!0?!0:!n.hide),dN=tr([n8,gi,fYe],a8,{memoizeOptions:{resultEqualityCheck:u3}}),hce=tr([dN],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(l3)),Ace=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),hYe=tr([dN],Ace),s8=t=>t.map(e=>e.data).filter(Boolean).flat(1),AYe=tr([dN],s8,{memoizeOptions:{resultEqualityCheck:u3}}),i8=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},o8=tr([AYe,Lle],i8),l8=(t,e,r)=>(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:Ds(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:Ds(a,n)}))):t.map(n=>({value:n})),d3=tr([o8,gi,dN],l8);function mce(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function SE(t){if(hh(t)||t instanceof Date){var e=Number(t);if(pi(e))return e}}function Wq(t){if(Array.isArray(t)){var e=[SE(t[0]),SE(t[1])];return Om(e)?e:void 0}var r=SE(t);if(r!=null)return[r,r]}function IA(t){return t.map(SE).filter(NHe)}function mYe(t,e,r){return!r||typeof e!="number"||fh(e)?[]:r.length?IA(r.flatMap(n=>{var a=Ds(t,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!pi(s)||!pi(o)))return[e-s,e+o]})):[]}var Qo=t=>{var e=Uo(t),r=B1(t);return uN(t,e,r)},fN=tr([Qo],t=>t==null?void 0:t.dataKey),pYe=tr([hce,Lle,Qo],cce),pce=(t,e,r,n)=>{var a={},s=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(e8);return[l,{stackedData:QGe(t,d,r),graphicalItems:u}]}))},fO=tr([pYe,hce,lN,rce],pce),gce=(t,e,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=e;if(n==null&&r!=="zAxis"){var o=KGe(t,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},gYe=tr([gi],t=>t.allowDataOverflow),c8=t=>{var e;if(t==null||!("domain"in t))return dO;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=IA(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:dO},u8=tr([gi],c8),d8=tr([u8,gYe],Ule),xYe=tr([fO,$A,Js,d8],gce,{memoizeOptions:{resultEqualityCheck:c3}}),f3=t=>t.errorBars,vYe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>mce(r,n)),Kj=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},f8=(t,e,r,n,a)=>{var s,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(v=>mce(a,v)),A=Ds(l,(d=e.dataKey)!==null&&d!==void 0?d:c.dataKey),h=mYe(l,A,f);if(h.length>=2){var m=Math.min(...h),p=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||p>o)&&(o=p)}var x=Wq(A);x!=null&&(s=s==null?x[0]:Math.min(s,x[0]),o=o==null?x[1]:Math.max(o,x[1]))})}),(e==null?void 0:e.dataKey)!=null&&t.forEach(l=>{var c=Wq(Ds(l,e.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),pi(s)&&pi(o))return[s,o]},yYe=tr([o8,gi,hYe,f3,Js],f8,{memoizeOptions:{resultEqualityCheck:c3}});function bYe(t){var{value:e}=t;if(hh(e)||e instanceof Date)return e}var wYe=(t,e,r)=>{var n=t.map(bYe).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&mie(n))?sle(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},xce=t=>t.referenceElements.dots,k1=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),NYe=tr([xce,Js,cN],k1),vce=t=>t.referenceElements.areas,CYe=tr([vce,Js,cN],k1),yce=t=>t.referenceElements.lines,_Ye=tr([yce,Js,cN],k1),bce=(t,e)=>{if(t!=null){var r=IA(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},EYe=tr(NYe,Js,bce),wce=(t,e)=>{if(t!=null){var r=IA(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},SYe=tr([CYe,Js],wce);function jYe(t){var e;if(t.x!=null)return IA([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:IA(r)}function IYe(t){var e;if(t.y!=null)return IA([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:IA(r)}var Nce=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?jYe(n):IYe(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},PYe=tr([_Ye,Js],Nce),TYe=tr(EYe,PYe,SYe,(t,e,r)=>Kj(t,r,e)),h8=(t,e,r,n,a,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?Kj(n,s,a):Kj(s,a);return VXe(e,u,t.allowDataOverflow)},BYe=tr([gi,u8,d8,xYe,yYe,TYe,Fa,Js],h8,{memoizeOptions:{resultEqualityCheck:c3}}),kYe=[0,1],A8=(t,e,r,n,a,s,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=qg(e,s);if(u&&l==null){var d;return sle(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?wYe(n,t,u):a==="expand"?kYe:o}},m8=tr([gi,Fa,o8,d3,lN,Js,BYe],A8),Cce=(t,e,r,n,a)=>{if(t!=null){var{scale:s,type:o}=t;if(s==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(Xw(s));return l in ob?l:"point"}}},F1=tr([gi,Fa,fce,zM,Js],Cce);function FYe(t){if(t!=null){if(t in ob)return ob[t]();var e="scale".concat(Xw(t));if(e in ob)return ob[e]()}}function p8(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=FYe(e);if(a!=null){var s=a.domain(r).range(n);return DGe(s),s}}}var g8=(t,e,r)=>{var n=c8(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Om(t))return YXe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Om(t))return JXe(t,e.tickCount,e.allowDecimals)}},x8=tr([m8,uN,F1],g8),v8=(t,e,r,n)=>{if(n!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&Om(e)&&Array.isArray(r)&&r.length>0){var a=e[0],s=r[0],o=e[1],l=r[r.length-1];return[Math.min(a,s),Math.max(o,l)]}return e},OYe=tr([gi,m8,x8,Js],v8),DYe=tr(d3,gi,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(IA(t.map(f=>f.value))).sort((f,A)=>f-A),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),_ce=tr(DYe,Fa,tce,Mo,(t,e,r,n,a)=>a,(t,e,r,n,a)=>{if(!pi(t))return 0;var s=e==="vertical"?n.height:n.width;if(a==="gap")return t*s/2;if(a==="no-gap"){var o=cc(r,t*s),l=t*s/2;return l-o-(l-o)/s*o}return 0}),RYe=(t,e,r)=>{var n=GA(t,e);return n==null||typeof n.padding!="string"?0:_ce(t,"xAxis",e,r,n.padding)},MYe=(t,e,r)=>{var n=KA(t,e);return n==null||typeof n.padding!="string"?0:_ce(t,"yAxis",e,r,n.padding)},LYe=tr(GA,RYe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),UYe=tr(KA,MYe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),QYe=tr([Mo,LYe,$P,HP,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[t.left+e.left,t.left+t.width-e.right]}),VYe=tr([Mo,Fa,UYe,$P,HP,(t,e,r)=>r],(t,e,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),hN=(t,e,r,n)=>{var a;switch(e){case"xAxis":return QYe(t,r,n);case"yAxis":return VYe(t,r,n);case"zAxis":return(a=t8(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return ice(t);case"radiusAxis":return oce(t,r);default:return}},Ece=tr([gi,hN],i3),h3=tr([gi,F1,OYe,Ece],p8);tr([dN,f3,Js],vYe);function Sce(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var A3=(t,e)=>e,m3=(t,e,r)=>r,HYe=tr(QP,A3,m3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(Sce)),$Ye=tr(VP,A3,m3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(Sce)),jce=(t,e)=>({width:t.width,height:e.height}),GYe=(t,e)=>{var r=typeof e.width=="number"?e.width:tN;return{width:r,height:t.height}},Ice=tr(Mo,GA,jce),KYe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},qYe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},zYe=tr(VA,Mo,HYe,A3,m3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=jce(e,l);o==null&&(o=KYe(e,n,t));var u=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),WYe=tr(QA,Mo,$Ye,A3,m3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=GYe(e,l);o==null&&(o=qYe(e,n,t));var u=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),XYe=(t,e)=>{var r=GA(t,e);if(r!=null)return zYe(t,r.orientation,r.mirror)},YYe=tr([Mo,GA,XYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),JYe=(t,e)=>{var r=KA(t,e);if(r!=null)return WYe(t,r.orientation,r.mirror)},ZYe=tr([Mo,KA,JYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),Pce=tr(Mo,KA,(t,e)=>{var r=typeof e.width=="number"?e.width:tN;return{width:r,height:t.height}}),Xq=(t,e,r)=>{switch(e){case"xAxis":return Ice(t,r).width;case"yAxis":return Pce(t,r).height;default:return}},Tce=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=qg(t,n),c=e.map(u=>u.value);if(o&&l&&s==="category"&&a&&mie(c))return c}},y8=tr([Fa,d3,gi,Js],Tce),Bce=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=qg(t,n);if(o&&(a==="number"||s!=="auto"))return e.map(l=>l.value)}},b8=tr([Fa,d3,uN,Js],Bce);tr([Fa,dYe,F1,h3,y8,b8,hN,x8,Js],(t,e,r,n,a,s,o,l,c)=>{if(e!=null){var u=qg(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var eJe=(t,e,r,n,a,s,o,l,c)=>{if(!(e==null||n==null)){var u=qg(t,c),{type:d,ticks:f,tickCount:A}=e,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Bl(s[0]-s[1])*2*m:m;var p=f||a;if(p){var x=p.map((v,y)=>{var b=o?o.indexOf(v):v;return{index:y,coordinate:n(b)+m,value:v,offset:m}});return x.filter(v=>pi(v.coordinate))}return u&&l?l.map((v,y)=>({coordinate:n(v)+m,value:v,index:y,offset:m})).filter(v=>pi(v.coordinate)):n.ticks?n.ticks(A).map(v=>({coordinate:n(v)+m,value:v,offset:m})):n.domain().map((v,y)=>({coordinate:n(v)+m,value:o?o[v]:v,index:y,offset:m}))}},kce=tr([Fa,uN,F1,h3,x8,hN,y8,b8,Js],eJe),tJe=(t,e,r,n,a,s,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=qg(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Bl(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},e1=tr([Fa,uN,h3,hN,y8,b8,Js],tJe),t1=tr(gi,h3,(t,e)=>{if(!(t==null||e==null))return Gj(Gj({},t),{},{scale:e})}),rJe=tr([gi,F1,m8,Ece],p8);tr((t,e,r)=>t8(t,r),rJe,(t,e)=>{if(!(t==null||e==null))return Gj(Gj({},t),{},{scale:e})});var nJe=tr([Fa,QP,VP],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Fce=t=>t.options.defaultTooltipEventType,Oce=t=>t.options.validateTooltipEventTypes;function Dce(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function w8(t,e){var r=Fce(t),n=Oce(t);return Dce(e,r,n)}function aJe(t){return vn(e=>w8(e,t))}var Rce=(t,e)=>{var r,n=Number(e);if(!(fh(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},sJe=t=>t.tooltip.settings,$0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},iJe={itemInteraction:{click:$0,hover:$0},axisInteraction:{click:$0,hover:$0},keyboardInteraction:$0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Mce=fu({name:"tooltip",initialState:iJe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:Vs()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,a=wf(t).tooltipItemPayloads.indexOf(r);a>-1&&(t.tooltipItemPayloads[a]=n)},prepare:Vs()},removeTooltipEntrySettings:{reducer(t,e){var r=wf(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Vs()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:oJe,replaceTooltipEntrySettings:lJe,removeTooltipEntrySettings:cJe,setTooltipSettingsState:uJe,setActiveMouseOverItemIndex:Lce,mouseLeaveItem:dJe,mouseLeaveChart:Uce,setActiveClickItemIndex:fJe,setMouseOverAxisIndex:Qce,setMouseClickAxisIndex:hJe,setSyncInteraction:hO,setKeyboardInteraction:AO}=Mce.actions,AJe=Mce.reducer;function Yq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function P_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yq(Object(r),!0).forEach(function(n){mJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mJe(t,e,r){return(e=pJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pJe(t){var e=gJe(t,"string");return typeof e=="symbol"?e:e+""}function gJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xJe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function vJe(t){return t.index!=null}var Vce=(t,e,r,n)=>{if(e==null)return $0;var a=xJe(t,e,r);if(a==null)return $0;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var s=t.settings.active===!0;if(vJe(a)){if(s)return P_(P_({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return P_(P_({},$0),{},{coordinate:a.coordinate})};function yJe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function bJe(t,e){var r=yJe(t),n=e[0],a=e[1];if(r===void 0)return!1;var s=Math.min(n,a),o=Math.max(n,a);return r>=s&&r<=o}function wJe(t,e,r){if(r==null||e==null)return!0;var n=Ds(t,e);return n==null||!Om(r)?!0:bJe(n,r)}var N8=(t,e,r,n)=>{var a=t==null?void 0:t.index;if(a==null)return null;var s=Number(a);if(!pi(s))return a;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(s,l)),u=e[c];return u==null||wJe(u,r,n)?String(c):null},Hce=(t,e,r,n,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,s);if(u!=null)return u;var d=a==null?void 0:a[Number(s)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:d.coordinate}}}},$ce=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=t.itemInteraction.hover.graphicalItemId:a=t.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=t.tooltipItemPayloads[0];return s!=null?[s]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},AN=t=>t.options.tooltipPayloadSearcher,O1=t=>t.tooltip;function Jq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Zq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jq(Object(r),!0).forEach(function(n){NJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NJe(t,e,r){return(e=CJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CJe(t){var e=_Je(t,"string");return typeof e=="symbol"?e:e+""}function _Je(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EJe(t,e){return t??e}var Gce=(t,e,r,n,a,s,o)=>{if(!(e==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return t.reduce((A,h)=>{var m,{dataDefinedOnItem:p,settings:x}=h,v=EJe(p,l),y=Array.isArray(v)?Noe(v,u,d):v,b=(m=x==null?void 0:x.dataKey)!==null&&m!==void 0?m:n,w=x==null?void 0:x.nameKey,I;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?I=wHe(y,n,a):I=s(y,e,c,w),Array.isArray(I))I.forEach(C=>{var S=Zq(Zq({},x),{},{name:C.name,unit:C.unit,color:void 0,fill:void 0});A.push(cK({tooltipEntrySettings:S,dataKey:C.dataKey,payload:C.payload,value:Ds(C.payload,C.dataKey),name:C.name}))});else{var j;A.push(cK({tooltipEntrySettings:x,dataKey:b,payload:I,value:Ds(I,b),name:(j=Ds(I,w))!==null&&j!==void 0?j:x==null?void 0:x.name}))}return A},f)}},C8=tr([Qo,Fa,fce,zM,Uo],Cce),SJe=tr([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),jJe=tr([Uo,B1],r8),D1=tr([SJe,Qo,jJe],a8,{memoizeOptions:{resultEqualityCheck:u3}}),IJe=tr([D1],t=>t.filter(l3)),PJe=tr([D1],s8,{memoizeOptions:{resultEqualityCheck:u3}}),R1=tr([PJe,$A],i8),TJe=tr([IJe,$A,Qo],cce),_8=tr([R1,Qo,D1],l8),Kce=tr([Qo],c8),BJe=tr([Qo],t=>t.allowDataOverflow),qce=tr([Kce,BJe],Ule),kJe=tr([D1],t=>t.filter(l3)),FJe=tr([TJe,kJe,lN,rce],pce),OJe=tr([FJe,$A,Uo,qce],gce),DJe=tr([D1],Ace),RJe=tr([R1,Qo,DJe,f3,Uo],f8,{memoizeOptions:{resultEqualityCheck:c3}}),MJe=tr([xce,Uo,B1],k1),LJe=tr([MJe,Uo],bce),UJe=tr([vce,Uo,B1],k1),QJe=tr([UJe,Uo],wce),VJe=tr([yce,Uo,B1],k1),HJe=tr([VJe,Uo],Nce),$Je=tr([LJe,HJe,QJe],Kj),GJe=tr([Qo,Kce,qce,OJe,RJe,$Je,Fa,Uo],h8),mN=tr([Qo,Fa,R1,_8,lN,Uo,GJe],A8),KJe=tr([mN,Qo,C8],g8),qJe=tr([Qo,mN,KJe,Uo],v8),zce=t=>{var e=Uo(t),r=B1(t),n=!1;return hN(t,e,r,n)},Wce=tr([Qo,zce],i3),Xce=tr([Qo,C8,qJe,Wce],p8),zJe=tr([Fa,_8,Qo,Uo],Tce),WJe=tr([Fa,_8,Qo,Uo],Bce),XJe=(t,e,r,n,a,s,o,l)=>{if(e){var{type:c}=e,u=qg(t,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Bl(a[0]-a[1])*2*f:f,u&&o?o.map((A,h)=>({coordinate:n(A)+f,value:A,index:h,offset:f})):n.domain().map((A,h)=>({coordinate:n(A)+f,value:s?s[A]:A,index:h,offset:f}))}}},qA=tr([Fa,Qo,C8,Xce,zce,zJe,WJe,Uo],XJe),E8=tr([Fce,Oce,sJe],(t,e,r)=>Dce(r.shared,t,e)),Yce=t=>t.tooltip.settings.trigger,S8=t=>t.tooltip.settings.defaultIndex,pN=tr([O1,E8,Yce,S8],Vce),Ig=tr([pN,R1,fN,mN],N8),Jce=tr([qA,Ig],Rce),j8=tr([pN],t=>{if(t)return t.dataKey}),YJe=tr([pN],t=>{if(t)return t.graphicalItemId}),Zce=tr([O1,E8,Yce,S8],$ce),JJe=tr([QA,VA,Fa,Mo,qA,S8,Zce,AN],Hce),ZJe=tr([pN,JJe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),eZe=tr([pN],t=>{var e;return(e=t==null?void 0:t.active)!==null&&e!==void 0?e:!1}),tZe=tr([Zce,Ig,$A,fN,Jce,AN,E8],Gce);tr([tZe],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function ez(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ez(Object(r),!0).forEach(function(n){rZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ez(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rZe(t,e,r){return(e=nZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nZe(t){var e=aZe(t,"string");return typeof e=="symbol"?e:e+""}function aZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sZe=()=>vn(Qo),iZe=()=>{var t=sZe(),e=vn(qA),r=vn(Xce);return _j(!t||!r?void 0:tz(tz({},t),{},{scale:r}),e)};function rz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Nx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rz(Object(r),!0).forEach(function(n){oZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oZe(t,e,r){return(e=lZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lZe(t){var e=cZe(t,"string");return typeof e=="symbol"?e:e+""}function cZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uZe=(t,e,r,n)=>{var a=e.find(s=>s&&s.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},dZe=(t,e,r,n)=>{var a=e.find(u=>u&&u.index===r);if(a){if(t==="centric"){var s=a.coordinate,{radius:o}=n;return Nx(Nx(Nx({},n),uo(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return Nx(Nx(Nx({},n),uo(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function fZe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var eue=(t,e,r,n,a)=>{var s,o=(s=e==null?void 0:e.length)!==null&&s!==void 0?s:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,A,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,p=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(A=r[l+1])===null||A===void 0?void 0:A.coordinate,x=void 0;if(!(h==null||m==null||p==null))if(Bl(m-h)!==Bl(p-m)){var v=[];if(Bl(p-m)===Bl(a[1]-a[0])){x=p;var y=m+a[1]-a[0];v[0]=Math.min(y,(y+h)/2),v[1]=Math.max(y,(y+h)/2)}else{x=h;var b=p+a[1]-a[0];v[0]=Math.min(m,(b+m)/2),v[1]=Math.max(m,(b+m)/2)}var w=[Math.min(m,(x+m)/2),Math.max(m,(x+m)/2)];if(t>w[0]&&t<=w[1]||t>=v[0]&&t<=v[1]){var I;return(I=r[l])===null||I===void 0?void 0:I.index}}else{var j=Math.min(h,p),C=Math.max(h,p);if(t>(j+m)/2&&t<=(C+m)/2){var S;return(S=r[l])===null||S===void 0?void 0:S.index}}}else if(e)for(var E=0;E<o;E++){var B=e[E];if(B!=null){var k=e[E+1],T=e[E-1];if(E===0&&k!=null&&t<=(B.coordinate+k.coordinate)/2||E===o-1&&T!=null&&t>(B.coordinate+T.coordinate)/2||E>0&&E<o-1&&T!=null&&k!=null&&t>(B.coordinate+T.coordinate)/2&&t<=(B.coordinate+k.coordinate)/2)return B.index}}return-1},hZe=()=>vn(zM),I8=(t,e)=>e,tue=(t,e,r)=>r,P8=(t,e,r,n)=>n,AZe=tr(qA,t=>PP(t,e=>e.coordinate)),T8=tr([O1,I8,tue,P8],Vce),B8=tr([T8,R1,fN,mN],N8),mZe=(t,e,r)=>{if(e!=null){var n=O1(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},rue=tr([O1,I8,tue,P8],$ce),qj=tr([QA,VA,Fa,Mo,qA,P8,rue,AN],Hce),pZe=tr([T8,qj],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),nue=tr([qA,B8],Rce),gZe=tr([rue,B8,$A,fN,nue,AN,I8],Gce),xZe=tr([T8,B8],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),vZe=(t,e,r,n,a,s,o)=>{if(!(!t||!r||!n||!a)&&fZe(t,o)){var l=qGe(t,e),c=eue(l,s,a,r,n),u=uZe(e,a,c,t);return{activeIndex:String(c),activeCoordinate:u}}},yZe=(t,e,r,n,a,s,o)=>{if(!(!t||!n||!a||!s||!r)){var l=oze(t,r);if(l){var c=zGe(l,e),u=eue(c,o,s,n,a),d=dZe(e,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},bZe=(t,e,r,n,a,s,o,l)=>{if(!(!t||!e||!n||!a||!s))return e==="horizontal"||e==="vertical"?vZe(t,e,n,a,s,o,l):yZe(t,e,r,n,a,s,o)},wZe=tr(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),NZe=tr(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(oc)),r=Array.from(new Set(e));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:iYe}});function nz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function az(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nz(Object(r),!0).forEach(function(n){CZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CZe(t,e,r){return(e=_Ze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ze(t){var e=EZe(t,"string");return typeof e=="symbol"?e:e+""}function EZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SZe={},jZe={zIndexMap:Object.values(oc).reduce((t,e)=>az(az({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),SZe)},IZe=new Set(Object.values(oc));function PZe(t){return IZe.has(t)}var aue=fu({name:"zIndex",initialState:jZe,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Vs()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!PZe(r)&&delete t.zIndexMap[r])},prepare:Vs()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:a}=e.payload;t.zIndexMap[r]?a?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Vs()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:Vs()}}}),{registerZIndexPortal:TZe,unregisterZIndexPortal:BZe,registerZIndexPortalElement:kZe,unregisterZIndexPortalElement:FZe}=aue.actions,OZe=aue.reducer;function bh(t){var{zIndex:e,children:r}=t,n=wKe(),a=n&&e!==void 0&&e!==0,s=zu(),o=Es();g.useLayoutEffect(()=>a?(o(TZe({zIndex:e})),()=>{o(BZe({zIndex:e}))}):Yw,[o,e,a]);var l=vn(c=>wZe(c,e,s));return a?l?Lu.createPortal(r,l):null:r}function mO(){return mO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mO.apply(null,arguments)}function sz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function T_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sz(Object(r),!0).forEach(function(n){DZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function DZe(t,e,r){return(e=RZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RZe(t){var e=MZe(t,"string");return typeof e=="symbol"?e:e+""}function MZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LZe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return g.isValidElement(e)?g.cloneElement(e,n):g.createElement(r,n)}function UZe(t){var e,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=t,f=r,A=n,h=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,p,x;if(d==="ScatterChart")m=f,p=bqe,x=oc.cursorLine;else if(d==="BarChart")m=wqe(l,f,s,o),p=Yoe,x=oc.cursorRectangle;else if(l==="radial"&&gie(f)){var{cx:v,cy:y,radius:b,startAngle:w,endAngle:I}=Zoe(f);m={cx:v,cy:y,startAngle:w,endAngle:I,innerRadius:b,outerRadius:b},p=tle,x=oc.cursorLine}else m={points:dze(l,f,s)},p=wM,x=oc.cursorLine;var j=typeof c=="object"&&"className"in c?c.className:void 0,C=T_(T_(T_(T_({stroke:"#ccc",pointerEvents:"none"},s),m),J2(c)),{},{payload:A,payloadIndex:h,className:ss("recharts-tooltip-cursor",j)});return g.createElement(bh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:x},g.createElement(LZe,{cursor:c,cursorComp:p,cursorProps:C}))}function QZe(t){var e=iZe(),r=yKe(),n=rN(),a=hZe();return e==null||r==null||n==null||a==null?null:g.createElement(UZe,mO({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var sue=g.createContext(null),VZe=()=>g.useContext(sue),iue={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,A){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||c,A),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var A=0,h=f.length,m=new Array(h);A<h;A++)m[A]=f[A].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,A,h,m){var p=r?r+u:u;if(!this._events[p])return!1;var x=this._events[p],v=arguments.length,y,b;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),v){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,d),!0;case 3:return x.fn.call(x.context,d,f),!0;case 4:return x.fn.call(x.context,d,f,A),!0;case 5:return x.fn.call(x.context,d,f,A,h),!0;case 6:return x.fn.call(x.context,d,f,A,h,m),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];x.fn.apply(x.context,y)}else{var w=x.length,I;for(b=0;b<w;b++)switch(x[b].once&&this.removeListener(u,x[b].fn,void 0,!0),v){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,d);break;case 3:x[b].fn.call(x[b].context,d,f);break;case 4:x[b].fn.call(x[b].context,d,f,A);break;default:if(!y)for(I=1,y=new Array(v-1);I<v;I++)y[I-1]=arguments[I];x[b].fn.apply(x[b].context,y)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,A){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===d&&(!A||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var p=0,x=[],v=m.length;p<v;p++)(m[p].fn!==d||A&&!m[p].once||f&&m[p].context!==f)&&x.push(m[p]);x.length?this._events[h]=x.length===1?x[0]:x:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(iue);var HZe=iue.exports;const $Ze=TA(HZe);var fw=new $Ze,pO="recharts.syncEvent.tooltip",iz="recharts.syncEvent.brush";function oue(t,e){if(e){var r=Number.parseInt(e,10);if(!fh(r))return t==null?void 0:t[r]}}var GZe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},lue=fu({name:"options",initialState:GZe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),KZe=lue.reducer,{createEventEmitter:qZe}=lue.actions;function zZe(t){return t.tooltip.syncInteraction}var WZe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},cue=fu({name:"chartData",initialState:WZe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:oz,setDataStartEndIndexes:XZe,setComputedData:not}=cue.actions,YZe=cue.reducer,JZe=["x","y"];function lz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Cx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lz(Object(r),!0).forEach(function(n){ZZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZZe(t,e,r){return(e=eet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eet(t){var e=tet(t,"string");return typeof e=="symbol"?e:e+""}function tet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ret(t,e){if(t==null)return{};var r,n,a=net(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function net(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function aet(){var t=vn(WM),e=vn(XM),r=Es(),n=vn(nce),a=vn(qA),s=rN(),o=GP(),l=vn(c=>c.rootProps.className);g.useEffect(()=>{if(t==null)return Yw;var c=(u,d,f)=>{if(e!==f&&t===u){if(n==="index"){var A;if(o&&d!==null&&d!==void 0&&(A=d.payload)!==null&&A!==void 0&&A.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:m,y:p}=h,x=ret(h,JZe),{x:v,y,width:b,height:w}=d.payload.sourceViewBox,I=Cx(Cx({},x),{},{x:o.x+(b?(m-v)/b:0)*o.width,y:o.y+(w?(p-y)/w:0)*o.height});r(Cx(Cx({},d),{},{payload:Cx(Cx({},d.payload),{},{coordinate:I})}))}else r(d);return}if(a!=null){var j;if(typeof n=="function"){var C={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},S=n(a,C);j=a[S]}else n==="value"&&(j=a.find(ue=>String(ue.value)===d.payload.label));var{coordinate:E}=d.payload;if(j==null||d.payload.active===!1||E==null||o==null){r(hO({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:k}=E,T=Math.min(B,o.x+o.width),P=Math.min(k,o.y+o.height),G={x:s==="horizontal"?j.coordinate:T,y:s==="horizontal"?P:j.coordinate},ce=hO({active:d.payload.active,coordinate:G,dataKey:d.payload.dataKey,index:String(j.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(ce)}}};return fw.on(pO,c),()=>{fw.off(pO,c)}},[l,r,e,t,n,a,s,o])}function set(){var t=vn(WM),e=vn(XM),r=Es();g.useEffect(()=>{if(t==null)return Yw;var n=(a,s,o)=>{e!==o&&t===a&&r(XZe(s))};return fw.on(iz,n),()=>{fw.off(iz,n)}},[r,e,t])}function iet(){var t=Es();g.useEffect(()=>{t(qZe())},[t]),aet(),set()}function oet(t,e,r,n,a,s){var o=vn(h=>mZe(h,t,e)),l=vn(XM),c=vn(WM),u=vn(nce),d=vn(zZe),f=d==null?void 0:d.active,A=GP();g.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=hO({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:A,graphicalItemId:void 0});fw.emit(pO,c,h,l)}},[f,r,o,a,n,l,c,u,s,A])}function cz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function uz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cz(Object(r),!0).forEach(function(n){cet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cet(t,e,r){return(e=uet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uet(t){var e=det(t,"string");return typeof e=="symbol"?e:e+""}function det(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fet(t){return t.dataKey}function het(t,e){return g.isValidElement(t)?g.cloneElement(t,e):typeof t=="function"?g.createElement(t,e):g.createElement(eqe,e)}var dz=[],Aet={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function fz(t){var e,r,n=Ol(t,Aet),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:A,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:y,trigger:b,defaultIndex:w,portal:I,axisId:j}=n,C=Es(),S=typeof w=="number"?String(w):w;g.useEffect(()=>{C(uJe({shared:y,trigger:b,axisId:j,active:a,defaultIndex:S}))},[C,y,b,j,a,S]);var E=GP(),B=Koe(),k=aJe(y),{activeIndex:T,isActive:P}=(e=vn(Y=>xZe(Y,k,b,S)))!==null&&e!==void 0?e:{},G=vn(Y=>gZe(Y,k,b,S)),ce=vn(Y=>nue(Y,k,b,S)),ue=vn(Y=>pZe(Y,k,b,S)),le=G,Ae=VZe(),ae=(r=a??P)!==null&&r!==void 0?r:!1,[_e,De]=qie([le,ae]),O=k==="axis"?ce:void 0;oet(k,b,ue,O,T,ae);var H=I??Ae;if(H==null||E==null||k==null)return null;var K=le??dz;ae||(K=dz),u&&K.length&&(K=Oie(K.filter(Y=>Y.value!=null&&(Y.hide!==!0||n.includeHidden)),A,fet));var R=K.length>0,X=g.createElement(oqe,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:ae,coordinate:ue,hasPayload:R,offset:f,position:h,reverseDirection:m,useTranslate3d:p,viewBox:E,wrapperStyle:x,lastBoundingBox:_e,innerRef:De,hasPortalFromProps:!!I},het(c,uz(uz({},n),{},{payload:K,label:O,active:ae,activeIndex:T,coordinate:ue,accessibilityLayer:B})));return g.createElement(g.Fragment,null,Lu.createPortal(X,H),ae&&g.createElement(QZe,{cursor:v,tooltipEventType:k,coordinate:ue,payload:K,index:T}))}var gN=t=>null;gN.displayName="Cell";function met(t,e,r){return(e=pet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pet(t){var e=get(t,"string");return typeof e=="symbol"?e:e+""}function get(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xet{constructor(e){met(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function hz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function vet(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hz(Object(r),!0).forEach(function(n){yet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yet(t,e,r){return(e=bet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bet(t){var e=wet(t,"string");return typeof e=="symbol"?e:e+""}function wet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Net={cacheSize:2e3,enableCache:!0},uue=vet({},Net),Az=new xet(uue.cacheSize),Cet={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},mz="recharts_measurement_span";function _et(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",s=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var pz=(t,e)=>{try{var r=document.getElementById(mz);r||(r=document.createElement("span"),r.setAttribute("id",mz),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Cet,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Kb=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||XP.isSsr)return{width:0,height:0};if(!uue.enableCache)return pz(e,r);var n=_et(e,r),a=Az.get(n);if(a)return a;var s=pz(e,r);return Az.set(n,s),s},due;function Eet(t,e,r){return(e=jet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jet(t){var e=Iet(t,"string");return typeof e=="symbol"?e:e+""}function Iet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,xz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Pet=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Tet=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Bet={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},ket=["cm","mm","pt","pc","in","Q","px"];function Fet(t){return ket.includes(t)}var nv="NaN";function Oet(t,e){return t*Bet[e]}class Nl{static parse(e){var r,[,n,a]=(r=Tet.exec(e))!==null&&r!==void 0?r:[];return n==null?Nl.NaN:new Nl(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,fh(e)&&(this.unit=""),r!==""&&!Pet.test(r)&&(this.num=NaN,this.unit=""),Fet(r)&&(this.num=Oet(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new Nl(NaN,""):new Nl(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new Nl(NaN,""):new Nl(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Nl(NaN,""):new Nl(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Nl(NaN,""):new Nl(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return fh(this.num)}}due=Nl;Eet(Nl,"NaN",new due(NaN,""));function fue(t){if(t==null||t.includes(nv))return nv;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,s]=(r=gz.exec(e))!==null&&r!==void 0?r:[],o=Nl.parse(n??""),l=Nl.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return nv;e=e.replace(gz,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,d,f,A]=(u=xz.exec(e))!==null&&u!==void 0?u:[],h=Nl.parse(d??""),m=Nl.parse(A??""),p=f==="+"?h.add(m):h.subtract(m);if(p.isNaN())return nv;e=e.replace(xz,p.toString())}return e}var vz=/\(([^()]*)\)/;function Det(t){for(var e=t,r;(r=vz.exec(e))!=null;){var[,n]=r;e=e.replace(vz,fue(n))}return e}function Ret(t){var e=t.replace(/\s+/g,"");return e=Det(e),e=fue(e),e}function Met(t){try{return Ret(t)}catch{return nv}}function TT(t){var e=Met(t.slice(5,-1));return e===nv?"":e}var Let=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],Uet=["dx","dy","angle","className","breakAll"];function gO(){return gO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gO.apply(null,arguments)}function yz(t,e){if(t==null)return{};var r,n,a=Qet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Qet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var hue=/[ \f\n\r\t\v\u2028\u2029]+/,Aue=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];il(e)||(r?a=e.toString().split(""):a=e.toString().split(hue));var s=a.map(l=>({word:l,width:Kb(l,n).width})),o=r?0:Kb("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function Vet(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var mue=(t,e,r,n)=>t.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};a.push(u)}return a},[]),pue=t=>t.reduce((e,r)=>e.width>r.width?e:r),Het="",bz=(t,e,r,n,a,s,o,l)=>{var c=t.slice(0,e),u=Aue({breakAll:r,style:n,children:c+Het});if(!u)return[!1,[]];var d=mue(u.wordsWithComputedWidth,s,o,l),f=d.length>a||pue(d).width>Number(s);return[f,d]},$et=(t,e,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=t,u=Cn(s),d=String(o),f=mue(e,n,r,a);if(!u||a)return f;var A=f.length>s||pue(f).width>Number(n);if(!A)return f;for(var h=0,m=d.length-1,p=0,x;h<=m&&p<=d.length-1;){var v=Math.floor((h+m)/2),y=v-1,[b,w]=bz(d,y,c,l,s,n,r,a),[I]=bz(d,v,c,l,s,n,r,a);if(!b&&!I&&(h=v+1),b&&I&&(m=v-1),!b&&I){x=w;break}p++}return x||f},wz=t=>{var e=il(t)?[]:t.toString().split(hue);return[{words:e,width:void 0}]},Get=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=t;if((e||r)&&!XP.isSsr){var l,c,u=Aue({breakAll:s,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return wz(n);return $et({breakAll:s,children:n,maxLines:o,style:a},l,c,e,!!r)}return wz(n)},gue="#808080",Ket={angle:0,breakAll:!1,capHeight:"0.71em",fill:gue,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},p3=g.forwardRef((t,e)=>{var r=Ol(t,Ket),{x:n,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=yz(r,Let),A=g.useMemo(()=>Get({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:p,className:x,breakAll:v}=f,y=yz(f,Uet);if(!hh(n)||!hh(a)||A.length===0)return null;var b=Number(n)+(Cn(h)?h:0),w=Number(a)+(Cn(m)?m:0);if(!pi(b)||!pi(w))return null;var I;switch(d){case"start":I=TT("calc(".concat(o,")"));break;case"middle":I=TT("calc(".concat((A.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:I=TT("calc(".concat(A.length-1," * -").concat(s,")"));break}var j=[];if(c){var C=A[0].width,{width:S}=f;j.push("scale(".concat(Cn(S)&&Cn(C)?S/C:1,")"))}return p&&j.push("rotate(".concat(p,", ").concat(b,", ").concat(w,")")),j.length&&(y.transform=j.join(" ")),g.createElement("text",gO({},Rd(y),{ref:e,x:b,y:w,className:ss("recharts-text",x),textAnchor:u,fill:l.includes("url")?gue:l}),A.map((E,B)=>{var k=E.words.join(v?"":" ");return g.createElement("tspan",{x:b,dy:B===0?I:s,key:"".concat(k,"-").concat(B)},k)}))});p3.displayName="Text";var qet=["labelRef"],zet=["content"];function Nz(t,e){if(t==null)return{};var r,n,a=Wet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Wet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Cz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ui(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cz(Object(r),!0).forEach(function(n){Xet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xet(t,e,r){return(e=Yet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yet(t){var e=Jet(t,"string");return typeof e=="symbol"?e:e+""}function Jet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gh(){return Gh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gh.apply(null,arguments)}var xue=g.createContext(null),Zet=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o,children:l}=t,c=g.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o}),[e,r,n,a,s,o]);return g.createElement(xue.Provider,{value:c},l)},vue=()=>{var t=g.useContext(xue),e=GP();return t||koe(e)},ett=g.createContext(null),ttt=()=>{var t=g.useContext(ett),e=vn(lce);return t||e},rtt=t=>{var{value:e,formatter:r}=t,n=il(t.children)?e:t.children;return typeof r=="function"?r(n):n},k8=t=>t!=null&&typeof t=="function",ntt=(t,e)=>{var r=Bl(e-t),n=Math.min(Math.abs(e-t),360);return r*n},att=(t,e,r,n,a)=>{var{offset:s,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:A,clockWise:h}=a,m=(u+d)/2,p=ntt(f,A),x=p>=0?1:-1,v,y;switch(e){case"insideStart":v=f+x*s,y=h;break;case"insideEnd":v=A-x*s,y=!h;break;case"end":v=A+x*s,y=h;break;default:throw new Error("Unsupported position ".concat(e))}y=p<=0?y:!y;var b=uo(l,c,m,v),w=uo(l,c,m,v+(y?1:-1)*359),I="M".concat(b.x,",").concat(b.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),j=il(t.id)?Z2("recharts-radial-line-"):t.id;return g.createElement("text",Gh({},n,{dominantBaseline:"central",className:ss("recharts-radial-bar-label",o)}),g.createElement("defs",null,g.createElement("path",{id:j,d:I})),g.createElement("textPath",{xlinkHref:"#".concat(j)},r))},stt=(t,e,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=uo(n,a,o+e,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var A=(s+o)/2,{x:h,y:m}=uo(n,a,A,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},xO=t=>"cx"in t&&Cn(t.cx),itt=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,s;r!=null&&!xO(r)&&(s=r);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:d}=e,f=o,A=o+(c-u)/2,h=(f+A)/2,m=(c+u)/2,p=f+c/2,x=d>=0?1:-1,v=x*n,y=x>0?"end":"start",b=x>0?"start":"end",w=c>=0?1:-1,I=w*n,j=w>0?"end":"start",C=w>0?"start":"end";if(a==="top"){var S={x:f+c/2,y:l-v,textAnchor:"middle",verticalAnchor:y};return Ui(Ui({},S),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var E={x:A+u/2,y:l+d+v,textAnchor:"middle",verticalAnchor:b};return Ui(Ui({},E),s?{height:Math.max(s.y+s.height-(l+d),0),width:u}:{})}if(a==="left"){var B={x:h-I,y:l+d/2,textAnchor:j,verticalAnchor:"middle"};return Ui(Ui({},B),s?{width:Math.max(B.x-s.x,0),height:d}:{})}if(a==="right"){var k={x:h+m+I,y:l+d/2,textAnchor:C,verticalAnchor:"middle"};return Ui(Ui({},k),s?{width:Math.max(s.x+s.width-k.x,0),height:d}:{})}var T=s?{width:m,height:d}:{};return a==="insideLeft"?Ui({x:h+I,y:l+d/2,textAnchor:C,verticalAnchor:"middle"},T):a==="insideRight"?Ui({x:h+m-I,y:l+d/2,textAnchor:j,verticalAnchor:"middle"},T):a==="insideTop"?Ui({x:f+c/2,y:l+v,textAnchor:"middle",verticalAnchor:b},T):a==="insideBottom"?Ui({x:A+u/2,y:l+d-v,textAnchor:"middle",verticalAnchor:y},T):a==="insideTopLeft"?Ui({x:f+I,y:l+v,textAnchor:C,verticalAnchor:b},T):a==="insideTopRight"?Ui({x:f+c-I,y:l+v,textAnchor:j,verticalAnchor:b},T):a==="insideBottomLeft"?Ui({x:A+I,y:l+d-v,textAnchor:C,verticalAnchor:y},T):a==="insideBottomRight"?Ui({x:A+u-I,y:l+d-v,textAnchor:j,verticalAnchor:y},T):a&&typeof a=="object"&&(Cn(a.x)||CA(a.x))&&(Cn(a.y)||CA(a.y))?Ui({x:o+cc(a.x,m),y:l+cc(a.y,d),textAnchor:"end",verticalAnchor:"end"},T):Ui({x:p,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},T)},ott={angle:0,offset:5,zIndex:oc.label,position:"middle",textBreakAll:!1};function k0(t){var e=Ol(t,ott),{viewBox:r,position:n,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:u}=e,d=ttt(),f=vue(),A=n==="center"?f:d??f,h,m,p;if(r==null?h=A:xO(r)?h=r:h=koe(r),!h||il(a)&&il(s)&&!g.isValidElement(o)&&typeof o!="function")return null;var x=Ui(Ui({},e),{},{viewBox:h});if(g.isValidElement(o)){var{labelRef:v}=x,y=Nz(x,qet);return g.cloneElement(o,y)}if(typeof o=="function"){var{content:b}=x,w=Nz(x,zet);if(m=g.createElement(o,w),g.isValidElement(m))return m}else m=rtt(e);var I=Rd(e);if(xO(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return att(e,n,m,I,h);p=stt(h,e.offset,e.position)}else p=itt(e,h);return g.createElement(bh,{zIndex:e.zIndex},g.createElement(p3,Gh({ref:u,className:ss("recharts-label",l)},I,p,{textAnchor:Vet(I.textAnchor)?I.textAnchor:p.textAnchor,breakAll:c}),m))}k0.displayName="Label";var ltt=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?g.createElement(k0,Gh({key:"label-implicit"},n)):hh(t)?g.createElement(k0,Gh({key:"label-implicit",value:t},n)):g.isValidElement(t)?t.type===k0?g.cloneElement(t,Ui({key:"label-implicit"},n)):g.createElement(k0,Gh({key:"label-implicit",content:t},n)):k8(t)?g.createElement(k0,Gh({key:"label-implicit",content:t},n)):t&&typeof t=="object"?g.createElement(k0,Gh({},t,{key:"label-implicit"},n)):null};function ctt(t){var{label:e,labelRef:r}=t,n=vue();return ltt(e,n,r)||null}var yue={},bue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(bue);var wue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(wue);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=bue,r=wue,n=jP;function a(s){if(n.isArrayLike(s))return e.last(r.toArray(s))}t.last=a})(yue);var utt=yue.last;const dtt=TA(utt);var ftt=["valueAccessor"],htt=["dataKey","clockWise","id","textBreakAll","zIndex"];function zj(){return zj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zj.apply(null,arguments)}function _z(t,e){if(t==null)return{};var r,n,a=Att(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Att(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var mtt=t=>Array.isArray(t.value)?dtt(t.value):t.value,Nue=g.createContext(void 0),ptt=Nue.Provider,Cue=g.createContext(void 0),gtt=Cue.Provider;function xtt(){return g.useContext(Nue)}function vtt(){return g.useContext(Cue)}function jE(t){var{valueAccessor:e=mtt}=t,r=_z(t,ftt),{dataKey:n,clockWise:a,id:s,textBreakAll:o,zIndex:l}=r,c=_z(r,htt),u=xtt(),d=vtt(),f=u||d;return!f||!f.length?null:g.createElement(bh,{zIndex:l??oc.label},g.createElement(Fc,{className:"recharts-label-list"},f.map((A,h)=>{var m,p=il(n)?e(A,h):Ds(A&&A.payload,n),x=il(s)?{}:{id:"".concat(s,"-").concat(h)};return g.createElement(k0,zj({key:"label-".concat(h)},Rd(A),c,x,{fill:(m=r.fill)!==null&&m!==void 0?m:A.fill,parentViewBox:A.parentViewBox,value:p,textBreakAll:o,viewBox:A.viewBox,index:h,zIndex:0}))})))}jE.displayName="LabelList";function _ue(t){var{label:e}=t;return e?e===!0?g.createElement(jE,{key:"labelList-implicit"}):g.isValidElement(e)||k8(e)?g.createElement(jE,{key:"labelList-implicit",content:e}):typeof e=="object"?g.createElement(jE,zj({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var Eue=t=>t.graphicalItems.polarItems,ytt=tr([Js,cN],r8),g3=tr([Eue,gi,ytt],a8),btt=tr([g3],s8),x3=tr([btt,s3],i8),wtt=tr([x3,gi,g3],l8);tr([x3,gi,g3],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var s,o=Ds(n,(s=e.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:Ds(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var Ez=()=>{},Ntt=tr([x3,gi,g3,f3,Js],f8),Ctt=tr([gi,u8,d8,Ez,Ntt,Ez,Fa,Js],h8),Sue=tr([gi,Fa,x3,wtt,lN,Js,Ctt],A8),_tt=tr([Sue,gi,F1],g8);tr([gi,Sue,_tt,Js],v8);var Ett={radiusAxis:{},angleAxis:{}},jue=fu({name:"polarAxis",initialState:Ett,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:aot,removeRadiusAxis:sot,addAngleAxis:iot,removeAngleAxis:oot}=jue.actions,Stt=jue.reducer;function Sz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function jz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sz(Object(r),!0).forEach(function(n){jtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jtt(t,e,r){return(e=Itt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Itt(t){var e=Ptt(t,"string");return typeof e=="symbol"?e:e+""}function Ptt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ttt=(t,e)=>e,F8=tr([Eue,Ttt],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),Btt=[],O8=(t,e,r)=>(r==null?void 0:r.length)===0?Btt:r,Iue=tr([s3,F8,O8],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if((e==null?void 0:e.data)!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>jz(jz({},e.presentationProps),s.props))),a!=null)return a}}),ktt=tr([Iue,F8,O8],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var s,o=Ds(n,e.nameKey,e.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:UP(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),Ftt=tr([Iue,F8,O8,Mo],(t,e,r,n)=>{if(!(e==null||t==null))return Drt({offset:n,pieSettings:e,displayedData:t,cells:r})}),Pue={exports:{}},xs={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D8=Symbol.for("react.transitional.element"),R8=Symbol.for("react.portal"),v3=Symbol.for("react.fragment"),y3=Symbol.for("react.strict_mode"),b3=Symbol.for("react.profiler"),w3=Symbol.for("react.consumer"),N3=Symbol.for("react.context"),C3=Symbol.for("react.forward_ref"),_3=Symbol.for("react.suspense"),E3=Symbol.for("react.suspense_list"),S3=Symbol.for("react.memo"),j3=Symbol.for("react.lazy"),Ott=Symbol.for("react.view_transition"),Dtt=Symbol.for("react.client.reference");function $d(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case D8:switch(t=t.type,t){case v3:case b3:case y3:case _3:case E3:case Ott:return t;default:switch(t=t&&t.$$typeof,t){case N3:case C3:case j3:case S3:return t;case w3:return t;default:return e}}case R8:return e}}}xs.ContextConsumer=w3;xs.ContextProvider=N3;xs.Element=D8;xs.ForwardRef=C3;xs.Fragment=v3;xs.Lazy=j3;xs.Memo=S3;xs.Portal=R8;xs.Profiler=b3;xs.StrictMode=y3;xs.Suspense=_3;xs.SuspenseList=E3;xs.isContextConsumer=function(t){return $d(t)===w3};xs.isContextProvider=function(t){return $d(t)===N3};xs.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===D8};xs.isForwardRef=function(t){return $d(t)===C3};xs.isFragment=function(t){return $d(t)===v3};xs.isLazy=function(t){return $d(t)===j3};xs.isMemo=function(t){return $d(t)===S3};xs.isPortal=function(t){return $d(t)===R8};xs.isProfiler=function(t){return $d(t)===b3};xs.isStrictMode=function(t){return $d(t)===y3};xs.isSuspense=function(t){return $d(t)===_3};xs.isSuspenseList=function(t){return $d(t)===E3};xs.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===v3||t===b3||t===y3||t===_3||t===E3||typeof t=="object"&&t!==null&&(t.$$typeof===j3||t.$$typeof===S3||t.$$typeof===N3||t.$$typeof===w3||t.$$typeof===C3||t.$$typeof===Dtt||t.getModuleId!==void 0)};xs.typeOf=$d;Pue.exports=xs;var Rtt=Pue.exports,Iz=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",Pz=null,BT=null,Tue=t=>{if(t===Pz&&Array.isArray(BT))return BT;var e=[];return g.Children.forEach(t,r=>{il(r)||(Rtt.isFragment(r)?e=e.concat(Tue(r.props.children)):e.push(r))}),BT=e,Pz=t,e};function M8(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>Iz(a)):n=[Iz(e)],Tue(t).forEach(a=>{var s=Cg(a,"type.displayName")||Cg(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var Bue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(Bue);var Mtt=Bue.isPlainObject;const Ltt=TA(Mtt);var Tz,Bz,kz,Fz,Oz;function Dz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Rz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dz(Object(r),!0).forEach(function(n){Utt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Utt(t,e,r){return(e=Qtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qtt(t){var e=Vtt(t,"string");return typeof e=="symbol"?e:e+""}function Vtt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wj(){return Wj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wj.apply(null,arguments)}function Oy(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Mz=(t,e,r,n,a)=>{var s=r-n,o;return o=_i(Tz||(Tz=Oy(["M ",",",""])),t,e),o+=_i(Bz||(Bz=Oy(["L ",",",""])),t+r,e),o+=_i(kz||(kz=Oy(["L ",",",""])),t+r-s/2,e+a),o+=_i(Fz||(Fz=Oy(["L ",",",""])),t+r-s/2-n,e+a),o+=_i(Oz||(Oz=Oy(["L ",","," Z"])),t,e),o},Htt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},$tt=t=>{var e=Ol(t,Htt),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=e,A=g.useRef(null),[h,m]=g.useState(-1),p=g.useRef(a),x=g.useRef(s),v=g.useRef(o),y=g.useRef(r),b=g.useRef(n),w=JP(t,"trapezoid-");if(g.useEffect(()=>{if(A.current&&A.current.getTotalLength)try{var G=A.current.getTotalLength();G&&m(G)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var I=ss("recharts-trapezoid",l);if(!f)return g.createElement("g",null,g.createElement("path",Wj({},Rd(e),{className:I,d:Mz(r,n,a,s,o)})));var j=p.current,C=x.current,S=v.current,E=y.current,B=b.current,k="0px ".concat(h===-1?1:h,"px"),T="".concat(h,"px 0px"),P=qoe(["strokeDasharray"],u,c);return g.createElement(YP,{animationId:w,key:w,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},G=>{var ce=So(j,a,G),ue=So(C,s,G),le=So(S,o,G),Ae=So(E,r,G),ae=So(B,n,G);A.current&&(p.current=ce,x.current=ue,v.current=le,y.current=Ae,b.current=ae);var _e=G>0?{transition:P,strokeDasharray:T}:{strokeDasharray:k};return g.createElement("path",Wj({},Rd(e),{className:I,d:Mz(Ae,ae,ce,ue,le),ref:A,style:Rz(Rz({},_e),e.style)}))})},Gtt=["option","shapeType","activeClassName"];function Ktt(t,e){if(t==null)return{};var r,n,a=qtt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function qtt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Lz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Xj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lz(Object(r),!0).forEach(function(n){ztt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ztt(t,e,r){return(e=Wtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wtt(t){var e=Xtt(t,"string");return typeof e=="symbol"?e:e+""}function Xtt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ytt(t,e){return Xj(Xj({},e),t)}function Jtt(t,e){return t==="symbols"}function Uz(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return g.createElement(Yoe,r);case"trapezoid":return g.createElement($tt,r);case"sector":return g.createElement(tle,r);case"symbols":if(Jtt(e))return g.createElement(ZR,r);break;case"curve":return g.createElement(wM,r);default:return null}}function Ztt(t){return g.isValidElement(t)?t.props:t}function kue(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,a=Ktt(t,Gtt),s;if(g.isValidElement(e))s=g.cloneElement(e,Xj(Xj({},a),Ztt(e)));else if(typeof e=="function")s=e(a,a.index);else if(Ltt(e)&&typeof e!="boolean"){var o=Ytt(e,a);s=g.createElement(Uz,{shapeType:r,elementProps:o})}else{var l=a;s=g.createElement(Uz,{shapeType:r,elementProps:l})}return a.isActive?g.createElement(Fc,{className:n},s):s}var L8=(t,e,r)=>{var n=Es();return(a,s)=>o=>{t==null||t(a,s,o),n(Lce({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},U8=t=>{var e=Es();return(r,n)=>a=>{t==null||t(r,n,a),e(dJe())}},Q8=(t,e,r)=>{var n=Es();return(a,s)=>o=>{t==null||t(a,s,o),n(fJe({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function Fue(t){var{tooltipEntrySettings:e}=t,r=Es(),n=zu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(oJe(e)):a.current!==e&&r(lJe({prev:a.current,next:e})),a.current=e)},[e,r,n]),g.useLayoutEffect(()=>()=>{a.current&&(r(cJe(a.current)),a.current=null)},[r]),null}function ert(t){var{legendPayload:e}=t,r=Es(),n=zu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(Hoe(e)):a.current!==e&&r($oe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Goe(a.current)),a.current=null)},[r]),null}function trt(t){var{legendPayload:e}=t,r=Es(),n=vn(Fa),a=g.useRef(null);return g.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(Hoe(e)):a.current!==e&&r($oe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Goe(a.current)),a.current=null)},[r]),null}var kT,rrt=()=>{var[t]=g.useState(()=>Z2("uid-"));return t},nrt=(kT=xfe.useId)!==null&&kT!==void 0?kT:rrt;function art(t,e){var r=nrt();return e||(t?"".concat(t,"-").concat(r):r)}var srt=g.createContext(void 0),Oue=t=>{var{id:e,type:r,children:n}=t,a=art("recharts-".concat(r),e);return g.createElement(srt.Provider,{value:a},n(a))},irt={cartesianItems:[],polarItems:[]},Due=fu({name:"graphicalItems",initialState:irt,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:Vs()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,a=wf(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},prepare:Vs()},removeCartesianGraphicalItem:{reducer(t,e){var r=wf(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Vs()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:Vs()},removePolarGraphicalItem:{reducer(t,e){var r=wf(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Vs()}}}),{addCartesianGraphicalItem:ort,replaceCartesianGraphicalItem:lrt,removeCartesianGraphicalItem:crt,addPolarGraphicalItem:urt,removePolarGraphicalItem:drt}=Due.actions,frt=Due.reducer,hrt=t=>{var e=Es(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(ort(t)):r.current!==t&&e(lrt({prev:r.current,next:t})),r.current=t},[e,t]),g.useLayoutEffect(()=>()=>{r.current&&(e(crt(r.current)),r.current=null)},[e]),null},Art=g.memo(hrt);function mrt(t){var e=Es();return g.useLayoutEffect(()=>(e(urt(t)),()=>{e(drt(t))}),[e,t]),null}var prt=["key"],grt=["onMouseEnter","onClick","onMouseLeave"],xrt=["id"],vrt=["id"];function Qz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ji(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qz(Object(r),!0).forEach(function(n){yrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yrt(t,e,r){return(e=brt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function brt(t){var e=wrt(t,"string");return typeof e=="symbol"?e:e+""}function wrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dm(){return Dm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Dm.apply(null,arguments)}function I3(t,e){if(t==null)return{};var r,n,a=Nrt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Nrt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Crt(t){var e=g.useMemo(()=>M8(t.children,gN),[t.children]),r=vn(n=>ktt(n,t.id,e));return r==null?null:g.createElement(trt,{legendPayload:r})}var _rt=g.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=t,f={dataDefinedOnItem:n.map(A=>A.tooltipPayload),positions:n.map(A=>A.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:e,nameKey:r,name:UP(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return g.createElement(Fue,{tooltipEntrySettings:f})}),Ert=(t,e)=>t>e?"start":t<e?"end":"middle",Srt=(t,e,r)=>cc(typeof e=="function"?e(t):e,r,r*.8),jrt=(t,e,r)=>{var{top:n,left:a,width:s,height:o}=e,l=Joe(s,o),c=a+cc(t.cx,s,s/2),u=n+cc(t.cy,o,o/2),d=cc(t.innerRadius,l,0),f=Srt(r,t.outerRadius,l),A=t.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:A}},Irt=(t,e)=>{var r=Bl(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function Prt(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var Trt=(t,e)=>{if(g.isValidElement(t))return g.cloneElement(t,e);if(typeof t=="function")return t(e);var r=ss("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,a=I3(e,prt);return g.createElement(wM,Dm({},a,{type:"linear",className:r}))},Brt=(t,e,r)=>{if(g.isValidElement(t))return g.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),g.isValidElement(n)))return n;var a=ss("recharts-pie-label-text",Prt(t));return g.createElement(p3,Dm({},e,{alignmentBaseline:"middle",className:a}),n)};function krt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!e)return null;var l=dh(r),c=J2(a),u=J2(s),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=e.map((A,h)=>{var m=(A.startAngle+A.endAngle)/2,p=uo(A.cx,A.cy,A.outerRadius+d,m),x=ji(ji(ji(ji({},l),A),{},{stroke:"none"},c),{},{index:h,textAnchor:Ert(p.x,A.cx)},p),v=ji(ji(ji(ji({},l),A),{},{fill:"none",stroke:A.fill},u),{},{index:h,points:[uo(A.cx,A.cy,A.outerRadius,m),p],key:"line"});return g.createElement(bh,{zIndex:oc.label,key:"label-".concat(A.startAngle,"-").concat(A.endAngle,"-").concat(A.midAngle,"-").concat(h)},g.createElement(Fc,null,s&&Trt(s,v),Brt(a,x,Ds(A,o))))});return g.createElement(Fc,{className:"recharts-pie-labels"},f)}function Frt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?g.createElement(_ue,{label:a}):g.createElement(krt,{sectors:e,props:r,showLabels:n})}function Ort(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:o}=t,l=vn(Ig),c=vn(j8),u=vn(YJe),{onMouseEnter:d,onClick:f,onMouseLeave:A}=a,h=I3(a,grt),m=L8(d,a.dataKey,o),p=U8(A),x=Q8(f,a.dataKey,o);return e==null||e.length===0?null:g.createElement(g.Fragment,null,e.map((v,y)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&e.length!==1)return null;var b=u==null||u===o,w=String(y)===l&&(c==null||a.dataKey===c)&&b,I=l?n:null,j=r&&w?r:I,C=ji(ji({},v),{},{stroke:v.stroke,tabIndex:-1,[_oe]:y,[Eoe]:o});return g.createElement(Fc,Dm({key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(y),tabIndex:-1,className:"recharts-pie-sector"},Jw(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),g.createElement(kue,Dm({option:s??j,index:y,shapeType:"sector",isActive:w},C)))}))}function Drt(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:s}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,A=Math.abs(r.minAngle),h=Irt(l,c),m=Math.abs(h),p=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,x=n.filter(j=>Ds(j,u,0)!==0).length,v=(m>=360?x:x-1)*p,y=m-x*A-v,b=n.reduce((j,C)=>{var S=Ds(C,u,0);return j+(Cn(S)?S:0)},0),w;if(b>0){var I;w=n.map((j,C)=>{var S=Ds(j,u,0),E=Ds(j,d,C),B=jrt(r,s,j),k=(Cn(S)?S:0)/b,T,P=ji(ji({},j),a&&a[C]&&a[C].props);C?T=I.endAngle+Bl(h)*p*(S!==0?1:0):T=l;var G=T+Bl(h)*((S!==0?A:0)+k*y),ce=(T+G)/2,ue=(B.innerRadius+B.outerRadius)/2,le=[{name:E,value:S,payload:P,dataKey:u,type:f,graphicalItemId:r.id}],Ae=uo(B.cx,B.cy,ue,ce);return I=ji(ji(ji(ji({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:E,tooltipPayload:le,midAngle:ce,middleRadius:ue,tooltipPosition:Ae},P),B),{},{value:S,dataKey:u,startAngle:T,endAngle:G,payload:P,paddingAngle:Bl(h)*p}),I})}return w}function Rrt(t){var{showLabels:e,sectors:r,children:n}=t,a=g.useMemo(()=>!e||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,e]);return g.createElement(gtt,{value:e?a:void 0},n)}function Mrt(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:A}=e,h=JP(e,"recharts-pie-"),m=r.current,[p,x]=g.useState(!1),v=g.useCallback(()=>{typeof A=="function"&&A(),x(!1)},[A]),y=g.useCallback(()=>{typeof f=="function"&&f(),x(!0)},[f]);return g.createElement(Rrt,{showLabels:!p,sectors:a},g.createElement(YP,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:y,onAnimationEnd:v,key:h},b=>{var w=[],I=a&&a[0],j=I==null?void 0:I.startAngle;return a==null||a.forEach((C,S)=>{var E=m&&m[S],B=S>0?Cg(C,"paddingAngle",0):0;if(E){var k=So(E.endAngle-E.startAngle,C.endAngle-C.startAngle,b),T=ji(ji({},C),{},{startAngle:j+B,endAngle:j+k+B});w.push(T),j=T.endAngle}else{var{endAngle:P,startAngle:G}=C,ce=So(0,P-G,b),ue=ji(ji({},C),{},{startAngle:j+B,endAngle:j+ce+B});w.push(ue),j=ue.endAngle}}),r.current=w,g.createElement(Fc,null,g.createElement(Ort,{sectors:w,activeShape:u,inactiveShape:d,allOtherPieProps:e,shape:e.shape,id:n}))}),g.createElement(Frt,{showLabels:!p,sectors:a,props:e}),e.children)}var Lrt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:oc.area};function Urt(t){var{id:e}=t,r=I3(t,xrt),{hide:n,className:a,rootTabIndex:s}=t,o=g.useMemo(()=>M8(t.children,gN),[t.children]),l=vn(d=>Ftt(d,e,o)),c=g.useRef(null),u=ss("recharts-pie",a);return n||l==null?(c.current=null,g.createElement(Fc,{tabIndex:s,className:u})):g.createElement(bh,{zIndex:t.zIndex},g.createElement(_rt,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),g.createElement(Fc,{tabIndex:s,className:u},g.createElement(Mrt,{props:ji(ji({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function Rue(t){var e=Ol(t,Lrt),{id:r}=e,n=I3(e,vrt),a=dh(n);return g.createElement(Oue,{id:r,type:"pie"},s=>g.createElement(g.Fragment,null,g.createElement(mrt,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),g.createElement(Crt,Dm({},n,{id:s})),g.createElement(Urt,Dm({},n,{id:s}))))}Rue.displayName="Pie";function Vz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Hz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vz(Object(r),!0).forEach(function(n){Qrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Qrt(t,e,r){return(e=Vrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vrt(t){var e=Hrt(t,"string");return typeof e=="symbol"?e:e+""}function Hrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mue=0,$rt={xAxis:{},yAxis:{},zAxis:{}},Lue=fu({name:"cartesianAxis",initialState:$rt,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:Vs()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:Vs()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:Vs()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:Vs()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:Vs()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:Vs()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:Vs()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:Vs()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:Vs()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,a=t.yAxis[r];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-s[0])<=1)return;var o=[...s,n].slice(-3);t.yAxis[r]=Hz(Hz({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:Grt,replaceXAxis:Krt,removeXAxis:qrt,addYAxis:zrt,replaceYAxis:Wrt,removeYAxis:Xrt,addZAxis:lot,replaceZAxis:cot,removeZAxis:uot,updateYAxisWidth:Yrt}=Lue.actions,Jrt=Lue.reducer,Zrt=tr([Mo],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),ent=tr([Zrt,QA,VA],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),Uue=()=>vn(ent),$z=(t,e,r)=>{var n=r??t;if(!il(n))return cc(n,e,0)},tnt=(t,e,r)=>{var n={},a=t.filter(l3),s=t.filter(u=>u.stackId==null),o=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),l=Object.entries(o).map(u=>{var[d,f]=u,A=f.map(m=>m.dataKey),h=$z(e,r,f[0].barSize);return{stackId:d,dataKeys:A,barSize:h}}),c=s.map(u=>{var d=[u.dataKey].filter(A=>A!=null),f=$z(e,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function Gz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function B_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gz(Object(r),!0).forEach(function(n){rnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rnt(t,e,r){return(e=nnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nnt(t){var e=ant(t,"string");return typeof e=="symbol"?e:e+""}function ant(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function snt(t,e,r,n,a){var s=n.length;if(!(s<1)){var o=cc(t,r,0,!0),l,c=[];if(pi(n[0].barSize)){var u=!1,d=r/s,f=n.reduce((v,y)=>v+(y.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&d>0&&(u=!0,d*=.9,f=s*d);var A=(r-f)/2>>0,h={offset:A-o,size:0};l=n.reduce((v,y)=>{var b,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h.offset+h.size+o,size:u?d:(b=y.barSize)!==null&&b!==void 0?b:0}},I=[...v,w];return h=I[I.length-1].position,I},c)}else{var m=cc(e,r,0,!0);r-2*m-(s-1)*o<=0&&(o=0);var p=(r-2*m-(s-1)*o)/s;p>1&&(p>>=0);var x=pi(a)?Math.min(p,a):p;l=n.reduce((v,y,b)=>[...v,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m+(p+o)*b+(p-x)/2,size:x}}],c)}return l}}var int=(t,e,r,n,a,s,o)=>{var l=il(o)?e:o,c=snt(r,n,a!==s?a:s,t,l);return a!==s&&c!=null&&(c=c.map(u=>B_(B_({},u),{},{position:B_(B_({},u.position),{},{offset:u.position.offset-a/2})}))),c},ont=(t,e)=>{var r=e8(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}};function lnt(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&pi(t.zIndex)?t.zIndex:e}var Que=t=>{var{chartData:e}=t,r=Es(),n=zu();return g.useEffect(()=>n?()=>{}:(r(oz(e)),()=>{r(oz(void 0))}),[e,r,n]),null},Kz={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Vue=fu({name:"brush",initialState:Kz,reducers:{setBrushSettings(t,e){return e.payload==null?Kz:e.payload}}}),{setBrushSettings:dot}=Vue.actions,cnt=Vue.reducer;function unt(t,e,r){return(e=dnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dnt(t){var e=fnt(t,"string");return typeof e=="symbol"?e:e+""}function fnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V8{static create(e){return new V8(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}unt(V8,"EPS",1e-4);function hnt(t){return(t%180+180)%180}var Ant=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=hnt(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},mnt={dots:[],areas:[],lines:[]},Hue=fu({name:"referenceElements",initialState:mnt,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=wf(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=wf(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=wf(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:fot,removeDot:hot,addArea:Aot,removeArea:mot,addLine:pot,removeLine:got}=Hue.actions,pnt=Hue.reducer,gnt=g.createContext(void 0),xnt=t=>{var{children:e}=t,[r]=g.useState("".concat(Z2("recharts"),"-clip")),n=Uue();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return g.createElement(gnt.Provider,{value:r},g.createElement("defs",null,g.createElement("clipPath",{id:r},g.createElement("rect",{x:a,y:s,height:l,width:o}))),e)};function $ue(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var a=t[n];a!==void 0&&r.push(a)}return r}function vnt(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return Ant(n,r)}function ynt(t,e,r){var n=r==="width",{x:a,y:s,width:o,height:l}=t;return e===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function hw(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var s=r();return t*(e-t*s/2-n)>=0&&t*(e+t*s/2-a)<=0}function bnt(t,e){return $ue(t,e+1)}function wnt(t,e,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:$ue(n,u)};var p=c,x,v=()=>(x===void 0&&(x=r(m,p)),x),y=m.coordinate,b=c===0||hw(t,y,v,d,l);b||(c=0,d=o,u+=1),b&&(d=y+t*(v()/2+a),c+=u)},A;u<=s.length;)if(A=f(),A)return A.v;return[]}function Nnt(t,e,r,n,a){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,A=!0,h=function(){var y=n[m],b=m,w,I=()=>(w===void 0&&(w=r(y,b)),w),j=y.coordinate,C=m===d||hw(t,j,I,f,c);if(!C)return A=!1,1;C&&(f=j+t*(I()/2+a))},m=d;m<o&&!h();m+=u);if(A){for(var p=[],x=d;x<o;x+=u)p.push(n[x]);return p}}return[]}function qz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Zl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qz(Object(r),!0).forEach(function(n){Cnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Cnt(t,e,r){return(e=_nt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _nt(t){var e=Ent(t,"string");return typeof e=="symbol"?e:e+""}function Ent(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Snt(t,e,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=e,{end:c}=e,u=function(A){var h=s[A],m,p=()=>(m===void 0&&(m=r(h,A)),m);if(A===o-1){var x=t*(h.coordinate+t*p()/2-c);s[A]=h=Zl(Zl({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate})}else s[A]=h=Zl(Zl({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var v=hw(t,h.tickCoord,p,l,c);v&&(c=h.tickCoord-t*(p()/2+a),s[A]=Zl(Zl({},h),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function jnt(t,e,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(s){var d=n[l-1],f=r(d,l-1),A=t*(d.coordinate+t*f/2-u);if(o[l-1]=d=Zl(Zl({},d),{},{tickCoord:A>0?d.coordinate-A*t:d.coordinate}),d.tickCoord!=null){var h=hw(t,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-t*(f/2+a),o[l-1]=Zl(Zl({},d),{},{isShow:!0}))}}for(var m=s?l-1:l,p=function(y){var b=o[y],w,I=()=>(w===void 0&&(w=r(b,y)),w);if(y===0){var j=t*(b.coordinate-t*I()/2-c);o[y]=b=Zl(Zl({},b),{},{tickCoord:j<0?b.coordinate-j*t:b.coordinate})}else o[y]=b=Zl(Zl({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var C=hw(t,b.tickCoord,I,c,u);C&&(c=b.tickCoord+t*(I()/2+a),o[y]=Zl(Zl({},b),{},{isShow:!0}))}},x=0;x<m;x++)p(x);return o}function Int(t,e,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=t;if(!a||!a.length||!n)return[];if(Cn(c)||XP.isSsr){var A;return(A=bnt(a,Cn(c)?c:0))!==null&&A!==void 0?A:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",p=d&&m==="width"?Kb(d,{fontSize:e,letterSpacing:r}):{width:0,height:0},x=(b,w)=>{var I=typeof u=="function"?u(b.value,w):b.value;return m==="width"?vnt(Kb(I,{fontSize:e,letterSpacing:r}),p,f):Kb(I,{fontSize:e,letterSpacing:r})[m]},v=a.length>=2?Bl(a[1].coordinate-a[0].coordinate):1,y=ynt(s,v,m);return c==="equidistantPreserveStart"?wnt(v,y,x,a,o):c==="equidistantPreserveEnd"?Nnt(v,y,x,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=jnt(v,y,x,a,o,c==="preserveStartEnd"):h=Snt(v,y,x,a,o),h.filter(b=>b.isShow))}var Pnt=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=t,o=0;if(e){Array.from(e).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},Tnt=["axisLine","width","height","className","hide","ticks","axisType"];function Bnt(t,e){if(t==null)return{};var r,n,a=knt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function knt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Pg(){return Pg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pg.apply(null,arguments)}function zz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function io(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zz(Object(r),!0).forEach(function(n){Fnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Fnt(t,e,r){return(e=Ont(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ont(t){var e=Dnt(t,"string");return typeof e=="symbol"?e:e+""}function Dnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Zp={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:oc.axis};function Rnt(t){var{x:e,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=io(io(io({},c),dh(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=io(io({},u),{},{x1:e,y1:r+d*a,x2:e+n,y2:r+d*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=io(io({},u),{},{x1:e+f*n,y1:r,x2:e+f*n,y2:r+a})}return g.createElement("line",Pg({},u,{className:ss("recharts-cartesian-axis-line",Cg(l,"className"))}))}function Mnt(t,e,r,n,a,s,o,l,c){var u,d,f,A,h,m,p=l?-1:1,x=t.tickSize||o,v=Cn(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":u=d=t.coordinate,A=r+ +!l*a,f=A-p*x,m=f-p*c,h=v;break;case"left":f=A=t.coordinate,d=e+ +!l*n,u=d-p*x,h=u-p*c,m=v;break;case"right":f=A=t.coordinate,d=e+ +l*n,u=d+p*x,h=u+p*c,m=v;break;default:u=d=t.coordinate,A=r+ +l*a,f=A+p*x,m=f+p*c,h=v;break}return{line:{x1:u,y1:f,x2:d,y2:A},tick:{x:h,y:m}}}function Lnt(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function Unt(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function Qnt(t){var{option:e,tickProps:r,value:n}=t,a,s=ss(r.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(e))a=g.cloneElement(e,io(io({},r),{},{className:s}));else if(typeof e=="function")a=e(io(io({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=ss(o,e==null?void 0:e.className)),a=g.createElement(p3,Pg({},r,{className:o}),n)}return a}var Vnt=g.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:A,y:h,width:m,height:p,tickSize:x,tickMargin:v,fontSize:y,letterSpacing:b,getTicksConfig:w,events:I,axisType:j}=t,C=Int(io(io({},w),{},{ticks:r}),y,b),S=Lnt(d,f),E=Unt(d,f),B=dh(w),k=J2(n),T={};typeof a=="object"&&(T=a);var P=io(io({},B),{},{fill:"none"},T),G=C.map(le=>io({entry:le},Mnt(le,A,h,m,p,d,x,f,v))),ce=G.map(le=>{var{entry:Ae,line:ae}=le;return g.createElement(Fc,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Ae.value,"-").concat(Ae.coordinate,"-").concat(Ae.tickCoord)},a&&g.createElement("line",Pg({},P,ae,{className:ss("recharts-cartesian-axis-tick-line",Cg(a,"className"))})))}),ue=G.map((le,Ae)=>{var{entry:ae,tick:_e}=le,De=io(io(io(io({textAnchor:S,verticalAnchor:E},B),{},{stroke:"none",fill:s},k),_e),{},{index:Ae,payload:ae,visibleTicksCount:C.length,tickFormatter:o,padding:c},u);return g.createElement(Fc,Pg({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},Jw(I,ae,Ae)),n&&g.createElement(Qnt,{option:n,tickProps:De,value:"".concat(typeof o=="function"?o(ae.value,Ae):ae.value).concat(l||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(j,"-ticks")},ue.length>0&&g.createElement(bh,{zIndex:oc.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(j,"-tick-labels"),ref:e},ue)),ce.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(j,"-tick-lines")},ce))}),Hnt=g.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l,axisType:c}=t,u=Bnt(t,Tnt),[d,f]=g.useState(""),[A,h]=g.useState(""),m=g.useRef(null);g.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var x;return Pnt({ticks:m.current,label:(x=t.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var p=g.useCallback(x=>{if(x){var v=x.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=v;var y=v[0];if(y){var b=window.getComputedStyle(y),w=b.fontSize,I=b.letterSpacing;(w!==d||I!==A)&&(f(w),h(I))}}},[d,A]);return o||n!=null&&n<=0||a!=null&&a<=0?null:g.createElement(bh,{zIndex:t.zIndex},g.createElement(Fc,{className:ss("recharts-cartesian-axis",s)},g.createElement(Rnt,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:dh(t)}),g.createElement(Vnt,{ref:p,axisType:c,events:u,fontSize:d,getTicksConfig:t,height:t.height,letterSpacing:A,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),g.createElement(Zet,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},g.createElement(ctt,{label:t.label,labelRef:t.labelRef}),t.children)))}),H8=g.forwardRef((t,e)=>{var r=Ol(t,Zp);return g.createElement(Hnt,Pg({},r,{ref:e}))});H8.displayName="CartesianAxis";var $nt={},Gue=fu({name:"errorBars",initialState:$nt,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:xot,replaceErrorBar:vot,removeErrorBar:yot}=Gue.actions,Gnt=Gue.reducer,Knt=["children"];function qnt(t,e){if(t==null)return{};var r,n,a=znt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function znt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Wnt={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Xnt=g.createContext(Wnt);function Ynt(t){var{children:e}=t,r=qnt(t,Knt);return g.createElement(Xnt.Provider,{value:r},e)}function Kue(t,e){var r,n,a=vn(u=>GA(u,t)),s=vn(u=>KA(u,e)),o=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Ko.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:qo.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function Jnt(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=Uue(),{needClipX:s,needClipY:o,needClip:l}=Kue(e,r);if(!l||!a)return null;var{x:c,y:u,width:d,height:f}=a;return g.createElement("clipPath",{id:"clipPath-".concat(n)},g.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var Znt={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xN=g;function eat(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tat=typeof Object.is=="function"?Object.is:eat,rat=xN.useSyncExternalStore,nat=xN.useRef,aat=xN.useEffect,sat=xN.useMemo,iat=xN.useDebugValue;Znt.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=nat(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=sat(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,tat(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=rat(t,s[0],s[1]);return aat(function(){o.hasValue=!0,o.value=l},[l]),iat(l),l};function oat(t){t()}function lat(){let t=null,e=null;return{clear(){t=null,e=null},notify(){oat(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var Wz={notify(){},get:()=>[]};function cat(t,e){let r,n=Wz,a=0,s=!1;function o(p){d();const x=n.subscribe(p);let v=!1;return()=>{v||(v=!0,x(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){a++,r||(r=t.subscribe(c),n=lat())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Wz)}function A(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:A,tryUnsubscribe:h,getListeners:()=>n};return m}var uat=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dat=uat(),fat=()=>typeof navigator<"u"&&navigator.product==="ReactNative",hat=fat(),Aat=()=>dat||hat?g.useLayoutEffect:g.useEffect,mat=Aat();function Xz(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function pat(t,e){if(Xz(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(e,r[a])||!Xz(t[r[a]],e[r[a]]))return!1;return!0}var FT=Symbol.for("react-redux-context"),OT=typeof globalThis<"u"?globalThis:{};function gat(){if(!g.createContext)return{};const t=OT[FT]??(OT[FT]=new Map);let e=t.get(g.createContext);return e||(e=g.createContext(null),t.set(g.createContext,e)),e}var xat=gat();function vat(t){const{children:e,context:r,serverState:n,store:a}=t,s=g.useMemo(()=>{const c=cat(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=g.useMemo(()=>a.getState(),[a]);mat(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||xat;return g.createElement(l.Provider,{value:s},e)}var yat=vat,bat=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function wat(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function $8(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(bat.has(n)){if(t[n]==null&&e[n]==null)continue;if(!pat(t[n],e[n]))return!1}else if(!wat(t[n],e[n]))return!1;return!0}function Xg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:Mue}function Yg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:Mue}var Nat="Invariant failed";function Cat(t,e){throw new Error(Nat)}function vO(){return vO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vO.apply(null,arguments)}function Yj(t){return g.createElement(kue,vO({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var _at=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Cn(e))return e;var s=Cn(n)||il(n);return s?e(n,a):(s||Cat(),r)}},Eat=(t,e,r)=>r,Sat=(t,e)=>e,vN=tr([n8,Sat],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),jat=tr([vN],t=>t==null?void 0:t.maxBarSize),Iat=(t,e,r,n)=>n,Pat=tr([Fa,n8,Xg,Yg,Eat],(t,e,r,n,a)=>e.filter(s=>t==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),Tat=(t,e,r)=>{var n=Fa(t),a=Xg(t,e),s=Yg(t,e);if(!(a==null||s==null))return n==="horizontal"?fO(t,"yAxis",s,r):fO(t,"xAxis",a,r)},Bat=(t,e)=>{var r=Fa(t),n=Xg(t,e),a=Yg(t,e);if(!(n==null||a==null))return r==="horizontal"?Xq(t,"xAxis",n):Xq(t,"yAxis",a)},kat=tr([Pat,eYe,Bat],tnt),Fat=(t,e,r)=>{var n,a,s=vN(t,e);if(s!=null){var o=Xg(t,e),l=Yg(t,e);if(!(o==null||l==null)){var c=Fa(t),u=ece(t),{maxBarSize:d}=s,f=il(d)?u:d,A,h;return c==="horizontal"?(A=t1(t,"xAxis",o,r),h=e1(t,"xAxis",o,r)):(A=t1(t,"yAxis",l,r),h=e1(t,"yAxis",l,r)),(n=(a=_j(A,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0}}},que=(t,e,r)=>{var n=Fa(t),a=Xg(t,e),s=Yg(t,e);if(!(a==null||s==null)){var o,l;return n==="horizontal"?(o=t1(t,"xAxis",a,r),l=e1(t,"xAxis",a,r)):(o=t1(t,"yAxis",s,r),l=e1(t,"yAxis",s,r)),_j(o,l)}},Oat=tr([kat,ece,ZXe,tce,Fat,que,jat],int),Dat=(t,e,r)=>{var n=Xg(t,e);if(n!=null)return t1(t,"xAxis",n,r)},Rat=(t,e,r)=>{var n=Yg(t,e);if(n!=null)return t1(t,"yAxis",n,r)},Mat=(t,e,r)=>{var n=Xg(t,e);if(n!=null)return e1(t,"xAxis",n,r)},Lat=(t,e,r)=>{var n=Yg(t,e);if(n!=null)return e1(t,"yAxis",n,r)},Uat=tr([Oat,vN],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),Qat=tr([Tat,vN],ont),Vat=tr([Mo,xM,Dat,Rat,Mat,Lat,Uat,Fa,QXe,que,Qat,vN,Iat],(t,e,r,n,a,s,o,l,c,u,d,f,A)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:p}=c;if(!(f==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||u==null)){var{data:x}=f,v;if(x!=null&&x.length>0?v=x:v=h==null?void 0:h.slice(m,p+1),v!=null)return gst({layout:l,barSettings:f,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:v,offset:t,cells:A,dataStartIndex:m})}}),Hat=["index"];function yO(){return yO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yO.apply(null,arguments)}function $at(t,e){if(t==null)return{};var r,n,a=Gat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Gat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var zue=g.createContext(void 0),Kat=t=>{var e=g.useContext(zue);if(e!=null)return e.stackId;if(t!=null)return VGe(t)},qat=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),zat=t=>{var e=g.useContext(zue);if(e!=null){var{stackId:r}=e;return"url(#".concat(qat(r,t),")")}},Wat=t=>{var{index:e}=t,r=$at(t,Hat),n=zat(e);return g.createElement(Fc,yO({className:"recharts-bar-stack-layer",clipPath:n},r))},Xat=["onMouseEnter","onMouseLeave","onClick"],Yat=["value","background","tooltipPosition"],Jat=["id"],Zat=["onMouseEnter","onClick","onMouseLeave"];function PA(){return PA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},PA.apply(null,arguments)}function Yz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Sc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yz(Object(r),!0).forEach(function(n){est(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function est(t,e,r){return(e=tst(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tst(t){var e=rst(t,"string");return typeof e=="symbol"?e:e+""}function rst(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jj(t,e){if(t==null)return{};var r,n,a=nst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function nst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var ast=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:s}=t;return[{inactive:s,dataKey:e,type:a,color:n,value:UP(r,e),payload:t}]},sst=g.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l,tooltipType:c,id:u}=t,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:UP(s,e),hide:o,type:c,color:a,unit:l,graphicalItemId:u}};return g.createElement(Fue,{tooltipEntrySettings:d})});function ist(t){var e=vn(Ig),{data:r,dataKey:n,background:a,allOtherBarProps:s}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=Jj(s,Xat),d=L8(o,n,s.id),f=U8(l),A=Q8(c,n,s.id);if(!a||r==null)return null;var h=J2(a);return g.createElement(bh,{zIndex:lnt(a,oc.barBackground)},r.map((m,p)=>{var{value:x,background:v,tooltipPosition:y}=m,b=Jj(m,Yat);if(!v)return null;var w=d(m,p),I=f(m,p),j=A(m,p),C=Sc(Sc(Sc(Sc(Sc({option:a,isActive:String(p)===e},b),{},{fill:"#eee"},v),h),Jw(u,m,p)),{},{onMouseEnter:w,onMouseLeave:I,onClick:j,dataKey:n,index:p,className:"recharts-bar-background-rectangle"});return g.createElement(Yj,PA({key:"background-bar-".concat(p)},C))}))}function ost(t){var{showLabels:e,children:r,rects:n}=t,a=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Sc(Sc({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return g.createElement(ptt,{value:e?a:void 0},r)}function lst(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=t,l=vn(Ig),c=vn(j8),u=r&&String(s)===l&&(c==null||o===c),d=u?r:e;return u?g.createElement(bh,{zIndex:oc.activeBar},g.createElement(Yj,PA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))):g.createElement(Yj,PA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))}function cst(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:s}=t;return g.createElement(Yj,PA({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:a,dataKey:s}))}function ust(t){var e,{data:r,props:n}=t,a=(e=dh(n))!==null&&e!==void 0?e:{},{id:s}=a,o=Jj(a,Jat),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:A}=n,h=Jj(n,Zat),m=L8(d,c,s),p=U8(A),x=Q8(f,c,s);return r?g.createElement(g.Fragment,null,r.map((v,y)=>g.createElement(Wat,PA({index:y,key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(y),className:"recharts-bar-rectangle"},Jw(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),u?g.createElement(lst,{shape:l,activeBar:u,baseProps:o,entry:v,index:y,dataKey:c}):g.createElement(cst,{shape:l,baseProps:o,entry:v,index:y,dataKey:c})))):null}function dst(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=e,f=r.current,A=JP(e,"recharts-bar-"),[h,m]=g.useState(!1),p=!h,x=g.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),v=g.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return g.createElement(ost,{showLabels:p,rects:n},g.createElement(YP,{animationId:A,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:x,onAnimationStart:v,key:A},y=>{var b=y===1?n:n==null?void 0:n.map((w,I)=>{var j=f&&f[I];if(j)return Sc(Sc({},w),{},{x:So(j.x,w.x,y),y:So(j.y,w.y,y),width:So(j.width,w.width,y),height:So(j.height,w.height,y)});if(a==="horizontal"){var C=So(0,w.height,y),S=So(w.stackedBarStart,w.y,y);return Sc(Sc({},w),{},{y:S,height:C})}var E=So(0,w.width,y),B=So(w.stackedBarStart,w.x,y);return Sc(Sc({},w),{},{width:E,x:B})});return y>0&&(r.current=b??null),b==null?null:g.createElement(Fc,null,g.createElement(ust,{props:e,data:b}))}),g.createElement(_ue,{label:e.label}),e.children)}function fst(t){var e=g.useRef(null);return g.createElement(dst,{previousRectanglesRef:e,props:t})}var Wue=0,hst=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:Ds(t,e)}};class Ast extends g.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var d=ss("recharts-bar",a),f=u;return g.createElement(Fc,{className:d,id:u},l&&g.createElement("defs",null,g.createElement(Jnt,{clipPathId:f,xAxisId:s,yAxisId:o})),g.createElement(Fc,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},g.createElement(ist,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),g.createElement(fst,this.props)))}}var mst={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:Wue,xAxisId:0,yAxisId:0,zIndex:oc.bar};function pst(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=t,{needClip:f}=Kue(e,r),A=rN(),h=zu(),m=M8(t.children,gN),p=vn(y=>Vat(y,t.id,h,m));if(A!=="vertical"&&A!=="horizontal")return null;var x,v=p==null?void 0:p[0];return v==null||v.height==null||v.width==null?x=0:x=A==="vertical"?v.height/2:v.width/2,g.createElement(Ynt,{xAxisId:e,yAxisId:r,data:p,dataPointFormatter:hst,errorBarOffset:x},g.createElement(Ast,PA({},t,{layout:A,needClip:f,data:p,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function gst(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:A,cells:h,parentViewBox:m,dataStartIndex:p}=t,x=e==="horizontal"?l:o,v=d?x.scale.domain():null,y=HGe({numericAxis:x}),b=x.scale(y);return f.map((w,I)=>{var j,C,S,E,B,k;if(d){var T=d[I+p];if(T==null)return null;j=RGe(T,v)}else j=Ds(w,r),Array.isArray(j)||(j=[y,j]);var P=_at(n,Wue)(j[1],I);if(e==="horizontal"){var G,[ce,ue]=[l.scale(j[0]),l.scale(j[1])];C=iK({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:w,index:I}),S=(G=ue??ce)!==null&&G!==void 0?G:void 0,E=a.size;var le=ce-ue;if(B=fh(le)?0:le,k={x:C,y:A.top,width:E,height:A.height},Math.abs(P)>0&&Math.abs(B)<Math.abs(P)){var Ae=Bl(B||P)*(Math.abs(P)-Math.abs(B));S-=Ae,B+=Ae}}else{var[ae,_e]=[o.scale(j[0]),o.scale(j[1])];if(C=ae,S=iK({axis:l,ticks:u,bandSize:s,offset:a.offset,entry:w,index:I}),E=_e-ae,B=a.size,k={x:A.left,y:S,width:A.width,height:B},Math.abs(P)>0&&Math.abs(E)<Math.abs(P)){var De=Bl(E||P)*(Math.abs(P)-Math.abs(E));E+=De}}if(C==null||S==null||E==null||B==null)return null;var O=Sc(Sc({},w),{},{stackedBarStart:b,x:C,y:S,width:E,height:B,value:d?j:j[1],payload:w,background:k,tooltipPosition:{x:C+E/2,y:S+B/2},parentViewBox:m},h&&h[I]&&h[I].props);return O}).filter(Boolean)}function xst(t){var e=Ol(t,mst),r=Kat(e.stackId),n=zu();return g.createElement(Oue,{id:e.id,type:"bar"},a=>g.createElement(g.Fragment,null,g.createElement(ert,{legendPayload:ast(e)}),g.createElement(sst,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:a}),g.createElement(Art,{type:"bar",id:a,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),g.createElement(bh,{zIndex:e.zIndex},g.createElement(pst,PA({},e,{id:a})))))}var bO=g.memo(xst,$8);bO.displayName="Bar";var vst=["domain","range"],yst=["domain","range"];function Jz(t,e){if(t==null)return{};var r,n,a=bst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function bst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Zz(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function Xue(t,e){if(t===e)return!0;var{domain:r,range:n}=t,a=Jz(t,vst),{domain:s,range:o}=e,l=Jz(e,yst);return!Zz(r,s)||!Zz(n,o)?!1:$8(a,l)}var wst=["dangerouslySetInnerHTML","ticks","scale"],Nst=["id","scale"];function wO(){return wO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wO.apply(null,arguments)}function eW(t,e){if(t==null)return{};var r,n,a=Cst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Cst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function _st(t){var e=Es(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Grt(t)):r.current!==t&&e(Krt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(qrt(r.current)),r.current=null)},[e]),null}var Est=t=>{var{xAxisId:e,className:r}=t,n=vn(xM),a=zu(),s="xAxis",o=vn(v=>kce(v,s,e,a)),l=vn(v=>Ice(v,e)),c=vn(v=>YYe(v,e)),u=vn(v=>uce(v,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:A}=t,h=eW(t,wst),{id:m,scale:p}=u,x=eW(u,Nst);return g.createElement(H8,wO({},h,x,{x:c.x,y:c.y,width:l.width,height:l.height,className:ss("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},Sst={allowDataOverflow:Ko.allowDataOverflow,allowDecimals:Ko.allowDecimals,allowDuplicatedCategory:Ko.allowDuplicatedCategory,angle:Ko.angle,axisLine:Zp.axisLine,height:Ko.height,hide:!1,includeHidden:Ko.includeHidden,interval:Ko.interval,minTickGap:Ko.minTickGap,mirror:Ko.mirror,orientation:Ko.orientation,padding:Ko.padding,reversed:Ko.reversed,scale:Ko.scale,tick:Ko.tick,tickCount:Ko.tickCount,tickLine:Zp.tickLine,tickSize:Zp.tickSize,type:Ko.type,xAxisId:0},jst=t=>{var e=Ol(t,Sst);return g.createElement(g.Fragment,null,g.createElement(_st,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),g.createElement(Est,e))},Yue=g.memo(jst,Xue);Yue.displayName="XAxis";var Ist=["dangerouslySetInnerHTML","ticks","scale"],Pst=["id","scale"];function NO(){return NO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NO.apply(null,arguments)}function tW(t,e){if(t==null)return{};var r,n,a=Tst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Tst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Bst(t){var e=Es(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(zrt(t)):r.current!==t&&e(Wrt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(Xrt(r.current)),r.current=null)},[e]),null}var kst=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,s=g.useRef(null),o=g.useRef(null),l=vn(xM),c=zu(),u=Es(),d="yAxis",f=vn(j=>Pce(j,e)),A=vn(j=>ZYe(j,e)),h=vn(j=>kce(j,d,e,c)),m=vn(j=>dce(j,e));if(g.useLayoutEffect(()=>{if(!(n!=="auto"||!f||k8(a)||g.isValidElement(a)||m==null)){var j=s.current;if(j){var C=j.getCalculatedWidth();Math.round(f.width)!==Math.round(C)&&u(Yrt({id:e,width:C}))}}},[h,f,u,a,e,n,m]),f==null||A==null||m==null)return null;var{dangerouslySetInnerHTML:p,ticks:x,scale:v}=t,y=tW(t,Ist),{id:b,scale:w}=m,I=tW(m,Pst);return g.createElement(H8,NO({},y,I,{ref:s,labelRef:o,x:A.x,y:A.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:ss("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:h,axisType:d}))},Fst={allowDataOverflow:qo.allowDataOverflow,allowDecimals:qo.allowDecimals,allowDuplicatedCategory:qo.allowDuplicatedCategory,angle:qo.angle,axisLine:Zp.axisLine,hide:!1,includeHidden:qo.includeHidden,interval:qo.interval,minTickGap:qo.minTickGap,mirror:qo.mirror,orientation:qo.orientation,padding:qo.padding,reversed:qo.reversed,scale:qo.scale,tick:qo.tick,tickCount:qo.tickCount,tickLine:Zp.tickLine,tickSize:Zp.tickSize,type:qo.type,width:qo.width,yAxisId:0},Ost=t=>{var e=Ol(t,Fst);return g.createElement(g.Fragment,null,g.createElement(Bst,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),g.createElement(kst,e))},Jue=g.memo(Ost,Xue);Jue.displayName="YAxis";var Dst=(t,e)=>e,G8=tr([Dst,Fa,lce,Uo,Wce,qA,AZe,Mo],bZe),K8=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Zue=Md("mouseClick"),ede=eN();ede.startListening({actionCreator:Zue,effect:(t,e)=>{var r=t.payload,n=G8(e.getState(),K8(r));(n==null?void 0:n.activeIndex)!=null&&e.dispatch(hJe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var CO=Md("mouseMove"),tde=eN(),k_=null;tde.startListening({actionCreator:CO,effect:(t,e)=>{var r=t.payload;k_!==null&&cancelAnimationFrame(k_);var n=K8(r);k_=requestAnimationFrame(()=>{var a=e.getState(),s=w8(a,a.tooltip.settings.shared);if(s==="axis"){var o=G8(a,n);(o==null?void 0:o.activeIndex)!=null?e.dispatch(Qce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(Uce())}k_=null})}});function Rst(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var rW={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},rde=fu({name:"rootProps",initialState:rW,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:rW.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),Mst=rde.reducer,{updateOptions:Lst}=rde.actions,nde=fu({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:Ust}=nde.actions,Qst=nde.reducer,ade=Md("keyDown"),sde=Md("focus"),q8=eN();q8.startListening({actionCreator:ade,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=t.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=N8(a,R1(r),fN(r),mN(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=qA(r);if(s==="Enter"){var u=qj(r,"axis","hover",String(a.index));e.dispatch(AO({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=nJe(r),f=d==="left-to-right"?1:-1,A=s==="ArrowRight"?1:-1,h=l+A*f;if(!(c==null||h>=c.length||h<0)){var m=qj(r,"axis","hover",String(h));e.dispatch(AO({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});q8.startListening({actionCreator:sde,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=qj(r,"axis","hover",String(s));e.dispatch(AO({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var hd=Md("externalEvent"),ide=eN(),DT=new Map;ide.startListening({actionCreator:hd,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var a=n.type,s=DT.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:ZJe(l),activeDataKey:j8(l),activeIndex:Ig(l),activeLabel:Jce(l),activeTooltipIndex:Ig(l),isTooltipActive:eZe(l)};r(c,n)}finally{DT.delete(a)}});DT.set(a,o)}}});var Vst=tr([O1],t=>t.tooltipItemPayloads),Hst=tr([Vst,AN,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(l=>l.settings.graphicalItemId===n);if(a!=null){var{positions:s}=a;if(s!=null){var o=e(s,r);return o}}}),ode=Md("touchMove"),lde=eN();lde.startListening({actionCreator:ode,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),a=w8(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var o=G8(n,K8({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&e.dispatch(Qce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(_oe),f=(l=u.getAttribute(Eoe))!==null&&l!==void 0?l:void 0,A=D1(n).find(p=>p.id===f);if(d==null||A==null||f==null)return;var{dataKey:h}=A,m=Hst(n,d,f);e.dispatch(Lce({activeDataKey:h,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var $st=Wie({brush:cnt,cartesianAxis:Jrt,chartData:YZe,errorBars:Gnt,graphicalItems:frt,layout:TGe,legend:DKe,options:KZe,polarAxis:Stt,polarOptions:Qst,referenceElements:pnt,rootProps:Mst,tooltip:AJe,zIndex:OZe}),Gst=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return rGe({reducer:$st,preloadedState:e,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([ede.middleware,tde.middleware,q8.middleware,ide.middleware,lde.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(uoe({type:"raf"}))},devTools:{serialize:{replacer:Rst},name:"recharts-".concat(r)}})};function cde(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=zu(),s=g.useRef(null);if(a)return r;s.current==null&&(s.current=Gst(e,n));var o=cM;return g.createElement(yat,{context:o,store:s.current},r)}function Kst(t){var{layout:e,margin:r}=t,n=Es(),a=zu();return g.useEffect(()=>{a||(n(jGe(e)),n(SGe(r)))},[n,a,e,r]),null}var ude=g.memo(Kst,$8);function dde(t){var e=Es();return g.useEffect(()=>{e(Lst(t))},[e,t]),null}function nW(t){var{zIndex:e,isPanorama:r}=t,n=g.useRef(null),a=Es();return g.useLayoutEffect(()=>(n.current&&a(kZe({zIndex:e,element:n.current,isPanorama:r})),()=>{a(FZe({zIndex:e,isPanorama:r}))}),[a,e,r]),g.createElement("g",{tabIndex:-1,ref:n})}function aW(t){var{children:e,isPanorama:r}=t,n=vn(NZe);if(!n||n.length===0)return e;var a=n.filter(o=>o<0),s=n.filter(o=>o>0);return g.createElement(g.Fragment,null,a.map(o=>g.createElement(nW,{key:o,zIndex:o,isPanorama:r})),e,s.map(o=>g.createElement(nW,{key:o,zIndex:o,isPanorama:r})))}var qst=["children"];function zst(t,e){if(t==null)return{};var r,n,a=Wst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Wst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Zj(){return Zj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zj.apply(null,arguments)}var Xst={width:"100%",height:"100%",display:"block"},Yst=g.forwardRef((t,e)=>{var r=Foe(),n=Ooe(),a=Koe();if(!Fm(r)||!Fm(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=t,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0),g.createElement(zR,Zj({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:Xst,ref:e}),s)}),Jst=t=>{var{children:e}=t,r=vn($P);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return g.createElement(zR,{width:n,height:a,x:o,y:s},e)},sW=g.forwardRef((t,e)=>{var{children:r}=t,n=zst(t,qst),a=zu();return a?g.createElement(Jst,null,g.createElement(aW,{isPanorama:!0},r)):g.createElement(Yst,Zj({ref:e},n),g.createElement(aW,{isPanorama:!1},r))});function Zst(){var t=Es(),[e,r]=g.useState(null),n=vn(WGe);return g.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),s=a.width/e.offsetWidth;pi(s)&&s!==n&&t(PGe(s))}},[e,t,n]),r}function iW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function eit(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iW(Object(r),!0).forEach(function(n){tit(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tit(t,e,r){return(e=rit(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rit(t){var e=nit(t,"string");return typeof e=="symbol"?e:e+""}function nit(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tg(){return Tg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Tg.apply(null,arguments)}var ait=()=>(iet(),null);function eI(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var sit=g.forwardRef((t,e)=>{var r,n,a=g.useRef(null),[s,o]=g.useState({containerWidth:eI((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:eI((n=t.style)===null||n===void 0?void 0:n.height)}),l=g.useCallback((u,d)=>{o(f=>{var A=Math.round(u),h=Math.round(d);return f.containerWidth===A&&f.containerHeight===h?f:{containerWidth:A,containerHeight:h}})},[]),c=g.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var A=m=>{var{width:p,height:x}=m[0].contentRect;l(p,x)},h=new ResizeObserver(A);h.observe(u),a.current=h}},[e,l]);return g.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[l]),g.createElement(g.Fragment,null,g.createElement(KP,{width:s.containerWidth,height:s.containerHeight}),g.createElement("div",Tg({ref:c},t)))}),iit=g.forwardRef((t,e)=>{var{width:r,height:n}=t,[a,s]=g.useState({containerWidth:eI(r),containerHeight:eI(n)}),o=g.useCallback((c,u)=>{s(d=>{var f=Math.round(c),A=Math.round(u);return d.containerWidth===f&&d.containerHeight===A?d:{containerWidth:f,containerHeight:A}})},[]),l=g.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[e,o]);return g.createElement(g.Fragment,null,g.createElement(KP,{width:a.containerWidth,height:a.containerHeight}),g.createElement("div",Tg({ref:l},t)))}),oit=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return g.createElement(g.Fragment,null,g.createElement(KP,{width:r,height:n}),g.createElement("div",Tg({ref:e},t)))}),lit=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return CA(r)||CA(n)?g.createElement(iit,Tg({},t,{ref:e})):g.createElement(oit,Tg({},t,{ref:e}))});function cit(t){return t===!0?sit:lit}var uit=g.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:A,onTouchEnd:h,onTouchMove:m,onTouchStart:p,style:x,width:v,responsive:y,dispatchTouchEvents:b=!0}=t,w=g.useRef(null),I=Es(),[j,C]=g.useState(null),[S,E]=g.useState(null),B=Zst(),k=vM(),T=(k==null?void 0:k.width)>0?k.width:v,P=(k==null?void 0:k.height)>0?k.height:a,G=g.useCallback(Q=>{B(Q),typeof e=="function"&&e(Q),C(Q),E(Q),Q!=null&&(w.current=Q)},[B,e,C,E]),ce=g.useCallback(Q=>{I(Zue(Q)),I(hd({handler:s,reactEvent:Q}))},[I,s]),ue=g.useCallback(Q=>{I(CO(Q)),I(hd({handler:u,reactEvent:Q}))},[I,u]),le=g.useCallback(Q=>{I(Uce()),I(hd({handler:d,reactEvent:Q}))},[I,d]),Ae=g.useCallback(Q=>{I(CO(Q)),I(hd({handler:f,reactEvent:Q}))},[I,f]),ae=g.useCallback(()=>{I(sde())},[I]),_e=g.useCallback(Q=>{I(ade(Q.key))},[I]),De=g.useCallback(Q=>{I(hd({handler:o,reactEvent:Q}))},[I,o]),O=g.useCallback(Q=>{I(hd({handler:l,reactEvent:Q}))},[I,l]),H=g.useCallback(Q=>{I(hd({handler:c,reactEvent:Q}))},[I,c]),K=g.useCallback(Q=>{I(hd({handler:A,reactEvent:Q}))},[I,A]),R=g.useCallback(Q=>{I(hd({handler:p,reactEvent:Q}))},[I,p]),X=g.useCallback(Q=>{b&&I(ode(Q)),I(hd({handler:m,reactEvent:Q}))},[I,b,m]),Y=g.useCallback(Q=>{I(hd({handler:h,reactEvent:Q}))},[I,h]),D=cit(y);return g.createElement(sue.Provider,{value:j},g.createElement(Xse.Provider,{value:S},g.createElement(D,{width:T??(x==null?void 0:x.width),height:P??(x==null?void 0:x.height),className:ss("recharts-wrapper",n),style:eit({position:"relative",cursor:"default",width:T,height:P},x),onClick:ce,onContextMenu:De,onDoubleClick:O,onFocus:ae,onKeyDown:_e,onMouseDown:H,onMouseEnter:ue,onMouseLeave:le,onMouseMove:Ae,onMouseUp:K,onTouchEnd:Y,onTouchMove:X,onTouchStart:R,ref:G},g.createElement(ait,null),r)))}),dit=["width","height","responsive","children","className","style","compact","title","desc"];function fit(t,e){if(t==null)return{};var r,n,a=hit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function hit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var fde=g.forwardRef((t,e)=>{var{width:r,height:n,responsive:a,children:s,className:o,style:l,compact:c,title:u,desc:d}=t,f=fit(t,dit),A=dh(f);return c?g.createElement(g.Fragment,null,g.createElement(KP,{width:r,height:n}),g.createElement(sW,{otherAttributes:A,title:u,desc:d},s)):g.createElement(uit,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},g.createElement(sW,{otherAttributes:A,title:u,desc:d,ref:e},g.createElement(xnt,null,s)))});function _O(){return _O=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_O.apply(null,arguments)}var Ait={top:5,right:5,bottom:5,left:5},mit={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:Ait,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},pit=g.forwardRef(function(e,r){var n,a=Ol(e.categoricalChartProps,mit),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return g.createElement(cde,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},g.createElement(Que,{chartData:u.data}),g.createElement(ude,{layout:a.layout,margin:a.margin}),g.createElement(dde,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(fde,_O({},a,{ref:r})))}),git=["axis","item"],xit=g.forwardRef((t,e)=>g.createElement(pit,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:git,tooltipPayloadSearcher:oue,categoricalChartProps:t,ref:e}));function vit(t){var e=Es();return g.useEffect(()=>{e(Ust(t))},[e,t]),null}var yit=["layout"];function EO(){return EO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EO.apply(null,arguments)}function bit(t,e){if(t==null)return{};var r,n,a=wit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function wit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Nit={top:5,right:5,bottom:5,left:5},hde={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Nit,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Cit=g.forwardRef(function(e,r){var n,a=Ol(e.categoricalChartProps,hde),{layout:s}=a,o=bit(a,yit),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return g.createElement(cde,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},g.createElement(Que,{chartData:a.data}),g.createElement(ude,{layout:s,margin:a.margin}),g.createElement(dde,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(vit,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),g.createElement(fde,EO({},o,{ref:r})))});function oW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function lW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oW(Object(r),!0).forEach(function(n){_it(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _it(t,e,r){return(e=Eit(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eit(t){var e=Sit(t,"string");return typeof e=="symbol"?e:e+""}function Sit(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jit=["item"],Iit=lW(lW({},hde),{},{layout:"centric",startAngle:0,endAngle:360}),Pit=g.forwardRef((t,e)=>{var r=Ol(t,Iit);return g.createElement(Cit,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:jit,tooltipPayloadSearcher:oue,categoricalChartProps:r,ref:e})});const Tit="sellers_candies",F_="cash_deliveries_candies";function Ma(t){const e=typeof t=="number"?t:parseFloat(String(t??"").replace(/,/g,""));return Number.isFinite(e)?e:0}function Ri(t){return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function O_(t,e){return t*e/100}function D_(t,e,r){return t-e-r}function cW(t){return t?Lr(t.toDate(),"yyyy-MM-dd"):""}function R_(t){if(!t)return yr.fromDate(new Date);const[e,r,n]=t.split("-").map(s=>parseInt(s,10)),a=new Date(e,(r||1)-1,n||1,0,0,0,0);return yr.fromDate(a)}function Bit(){const t=new Date,[e,r]=g.useState(Lr(Qd(t),"yyyy-MM-dd")),[n,a]=g.useState(Lr(Ud(t),"yyyy-MM-dd")),[s,o]=g.useState([]),l=g.useMemo(()=>{const D=new Map;return s.forEach(Q=>D.set(Q.id,Q)),D},[s]),[c,u]=g.useState([]),[d,f]=g.useState(!0),[A,h]=g.useState(()=>Lr(new Date,"yyyy-MM-dd")),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState("0"),[w,I]=g.useState(""),[j,C]=g.useState(null),[S,E]=g.useState({}),B=g.useRef(null);g.useEffect(()=>{const D=sr(Ct(Ce,Tit),Sn("name","asc")),Q=Pd(D,te=>{const be=te.docs.map(U=>{const Xe=U.data();return{id:U.id,name:String((Xe==null?void 0:Xe.name)??""),branch:Xe!=null&&Xe.branch?String(Xe.branch):"",commissionPercent:Ma((Xe==null?void 0:Xe.commissionPercent)??0)}});o(be)},()=>o([]));return()=>Q()},[]),g.useEffect(()=>{f(!0);const D=R_(e),Q=new Date(R_(n).toDate().getTime());Q.setDate(Q.getDate()+1);const te=yr.fromDate(Q),be=sr(Ct(Ce,F_),cr("date",">=",D),cr("date","<",te),Sn("date","desc")),U=Pd(be,Xe=>{const se=Xe.docs.map(ee=>{const Fe=ee.data();return{id:ee.id,date:Fe==null?void 0:Fe.date,sellerId:String((Fe==null?void 0:Fe.sellerId)??""),sellerName:String((Fe==null?void 0:Fe.sellerName)??""),amountDelivered:Ma(Fe==null?void 0:Fe.amountDelivered),commissionPercent:Ma(Fe==null?void 0:Fe.commissionPercent),commissionPaid:Ma(Fe==null?void 0:Fe.commissionPaid),extraExpenses:Ma(Fe==null?void 0:Fe.extraExpenses),totalFinal:Ma(Fe==null?void 0:Fe.totalFinal),comment:String((Fe==null?void 0:Fe.comment)??""),createdAt:Fe==null?void 0:Fe.createdAt,updatedAt:Fe==null?void 0:Fe.updatedAt}});u(se),f(!1)},Xe=>{console.error("Firestore deliveries query error:",Xe),u([]),f(!1),alert("Firestore query fall. Revis consola (probable ndice).")});return()=>U()},[e,n]);const k=g.useMemo(()=>m?l.get(m):void 0,[m,l]),T=Ma((k==null?void 0:k.commissionPercent)??0),P=Ma(x),G=Ma(y),ce=O_(P,T),ue=D_(P,ce,G),le=g.useMemo(()=>{var Q;const D=new Map;for(const te of c){const be=te.sellerId||te.sellerName||"UNKNOWN",U=D.get(be)??{sellerId:te.sellerId,sellerName:te.sellerName||((Q=l.get(te.sellerId))==null?void 0:Q.name)||"Sin nombre",delivered:0,commission:0,totalFinal:0};U.delivered+=Ma(te.amountDelivered),U.commission+=Ma(te.commissionPaid),U.totalFinal+=Ma(te.totalFinal),D.set(be,U)}return Array.from(D.values()).sort((te,be)=>te.sellerName.localeCompare(be.sellerName))},[c,l]),Ae=g.useMemo(()=>{let D=0,Q=0,te=0,be=0;for(const U of c)D+=Ma(U.amountDelivered),Q+=Ma(U.commissionPaid),te+=Ma(U.extraExpenses),be+=Ma(U.totalFinal);return{delivered:D,commission:Q,expenses:te,totalFinal:be}},[c]),ae=g.useMemo(()=>le.map(D=>({name:D.sellerName,Entregado:Number(D.delivered.toFixed(2)),Comision:Number(D.commission.toFixed(2))})),[le]),_e=g.useMemo(()=>[{name:"Total Entregado (Bruto)",value:Number(Ae.delivered.toFixed(2))},{name:"Total Comisin",value:Number(Ae.commission.toFixed(2))},{name:"Total Gastos",value:Number(Ae.expenses.toFixed(2))}].filter(D=>D.value>0),[Ae]),De=["#3B82F6","#F59E0B","#EF4444"];async function O(){if(!m)return alert("Seleccion un vendedor.");if(P<=0)return alert("Ingres un Monto entregado vlido (> 0).");const D=l.get(m),Q=(D==null?void 0:D.name)??"Sin nombre",te=Ma((D==null?void 0:D.commissionPercent)??0),be=O_(P,te),U=D_(P,be,G);await Gn(Ct(Ce,F_),{date:R_(A),sellerId:m,sellerName:Q,amountDelivered:P,commissionPercent:te,commissionPaid:be,extraExpenses:G,totalFinal:U,comment:w??"",createdAt:yr.now()}),v(""),b("0"),I("")}function H(D){C(D.id),E({...D,dateInput:cW(D.date)})}function K(){C(null),E({})}async function R(D){const Q=S,te=String(Q.sellerId??""),be=l.get(te),U=String(Q.sellerName??(be==null?void 0:be.name)??"Sin nombre"),Xe=Ma(Q.amountDelivered),se=Ma(Q.extraExpenses),ee=Ma(Q.commissionPercent??(be==null?void 0:be.commissionPercent)??0),Fe=O_(Xe,ee),je=D_(Xe,Fe,se),Se=R_(String(Q.dateInput??cW(Q.date)));await kn(Yt(Ce,F_,D),{date:Se,sellerId:te,sellerName:U,amountDelivered:Xe,commissionPercent:ee,commissionPaid:Fe,extraExpenses:se,totalFinal:je,comment:String(Q.comment??""),updatedAt:yr.now()}),K()}async function X(D){confirm("Eliminar este registro?")&&await Wn(Yt(Ce,F_,D))}async function Y(){if(!B.current)return;const D=await Hm(B.current,{scale:2,useCORS:!0,backgroundColor:"#ffffff",scrollX:0,scrollY:-window.scrollY}),Q=D.toDataURL("image/png"),te=new rn("p","mm","a4"),be=te.internal.pageSize.getWidth(),U=te.internal.pageSize.getHeight(),Xe=be,se=D.height*Xe/D.width;let ee=se,Fe=0;for(te.addImage(Q,"PNG",0,Fe,Xe,se),ee-=U;ee>0;)te.addPage(),Fe=-(se-ee),te.addImage(Q,"PNG",0,Fe,Xe,se),ee-=U;te.save(`Entregas_Dulces_${e}_a_${n}.pdf`)}return i.jsxs("div",{className:"p-3 md:p-6 max-w-7xl mx-auto space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-2xl font-black text-gray-900",children:"Control Contable - Entregas de Vendedores (Dulces)"}),i.jsxs("p",{className:"text-xs md:text-sm text-gray-600",children:["Periodo: ",i.jsx("span",{className:"font-bold",children:e})," "," ",i.jsx("span",{className:"font-bold",children:n})]})]}),i.jsx("button",{onClick:Y,className:"h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Exportar a PDF"})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Filtros de periodo"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:e,onChange:D=>r(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:n,onChange:D=>a(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]})]}),i.jsxs("div",{ref:B,className:"space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"KPIs Consolidados"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Entradas (Neto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.totalFinal)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Entregado - Comisin - Gastos"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Comisiones"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.commission)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de comisin pagada"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Gastos extras"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.expenses)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de gastos registrados"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"Total entregado (Bruto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.delivered)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Sin restar nada"})]})]}),i.jsx("div",{className:"font-black text-sm text-gray-900 mt-4 mb-2",children:"KPI Vendedores (sumatoria del periodo)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[520px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"})]})}),i.jsx("tbody",{children:le.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-2 text-gray-500",colSpan:4,children:"Sin datos en el periodo seleccionado."})}):le.map(D=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.delivered)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.commission)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ri(D.totalFinal)]})]},D.sellerId||D.sellerName))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Entregas y Comisin por vendedor (Barras)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(AK,{children:i.jsxs(xit,{data:ae,children:[i.jsx(Yue,{dataKey:"name",interval:0,angle:-12,height:70}),i.jsx(Jue,{}),i.jsx(fz,{}),i.jsx(XF,{}),i.jsx(bO,{dataKey:"Entregado"}),i.jsx(bO,{dataKey:"Comision"})]})})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Distribucin (Pastel)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(AK,{children:i.jsxs(Pit,{children:[i.jsx(Rue,{data:_e,dataKey:"value",nameKey:"name",outerRadius:110,label:!0,children:_e.map((D,Q)=>i.jsx(gN,{fill:De[Q%De.length]},Q))}),i.jsx(fz,{}),i.jsx(XF,{})]})})})]})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Agregar movimiento"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:A,onChange:D=>h(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:m,onChange:D=>p(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10 bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",inputMode:"decimal",value:x,onChange:D=>v(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin configurada"}),i.jsx("input",{value:`${T}%`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin pagada"}),i.jsx("input",{value:`$ ${Ri(ce)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",inputMode:"decimal",value:y,onChange:D=>b(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Total final"}),i.jsx("input",{value:`$ ${Ri(ue)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-900 font-extrabold"})]}),i.jsxs("label",{className:"space-y-1 md:col-span-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{value:w,onChange:D=>I(D.target.value),placeholder:"Opcional...",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:O,className:"w-full md:w-auto h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Guardar movimiento"})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Registro detallado"}),d?i.jsx("div",{className:"text-sm text-gray-500",children:"Cargando..."}):c.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay registros en el periodo."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Monto entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin %"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin pagada"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Comentario"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Acciones"})]})}),i.jsx("tbody",{children:c.map(D=>{if(!(j===D.id))return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Lr(D.date.toDate(),"yyyy-MM-dd")}),i.jsx("td",{className:"p-2 font-semibold",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.amountDelivered)]}),i.jsxs("td",{className:"p-2 text-right",children:[Ri(D.commissionPercent),"%"]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.commissionPaid)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.extraExpenses)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ri(D.totalFinal)]}),i.jsx("td",{className:"p-2",children:D.comment}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>X(D.id),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},D.id);const te=Ma(S.amountDelivered??D.amountDelivered),be=Ma(S.commissionPercent??D.commissionPercent),U=Ma(S.extraExpenses??D.extraExpenses),Xe=O_(te,be),se=D_(te,Xe,U);return i.jsxs("tr",{className:"border-t bg-yellow-50/40",children:[i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:ee=>E(Fe=>({...Fe,dateInput:ee.target.value})),className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("select",{value:String(S.sellerId??D.sellerId),onChange:ee=>{const Fe=ee.target.value,je=l.get(Fe);E(Se=>({...Se,sellerId:Fe,sellerName:(je==null?void 0:je.name)??"",commissionPercent:Ma((je==null?void 0:je.commissionPercent)??0)}))},className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(ee=>i.jsxs("option",{value:ee.id,children:[ee.name," ",ee.branch?`(${ee.branch})`:""]},ee.id))]})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(te),onChange:ee=>E(Fe=>({...Fe,amountDelivered:Ma(ee.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(be),onChange:ee=>E(Fe=>({...Fe,commissionPercent:Ma(ee.target.value)})),className:"h-9 w-24 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-semibold",children:["$ ",Ri(Xe)]}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(U),onChange:ee=>E(Fe=>({...Fe,extraExpenses:Ma(ee.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ri(se)]}),i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"text",value:String(S.comment??D.comment),onChange:ee=>E(Fe=>({...Fe,comment:ee.target.value})),className:"h-9 w-full px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>R(D.id),className:"h-8 px-3 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:K,className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})})]},D.id)})})]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[c.map(D=>i.jsxs("div",{className:"rounded-2xl border border-gray-100 p-3 bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-black text-gray-900",children:D.sellerName}),i.jsx("div",{className:"text-xs font-extrabold bg-gray-100 rounded-full px-3 py-1",children:Lr(D.date.toDate(),"yyyy-MM-dd")})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Monto entregado"}),i.jsxs("div",{className:"font-extrabold",children:["$ ",Ri(D.amountDelivered)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin %"}),i.jsxs("div",{className:"font-semibold",children:[Ri(D.commissionPercent),"%"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin pagada"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Ri(D.commissionPaid)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Gastos"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Ri(D.extraExpenses)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Total final"}),i.jsxs("div",{className:"text-base font-black",children:["$ ",Ri(D.totalFinal)]})]}),D.comment?i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comentario"}),i.jsx("div",{className:"text-sm text-gray-800",children:D.comment})]}):null]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>X(D.id),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})]},D.id)),j?i.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-3",children:[i.jsx("div",{className:"font-black text-gray-900 mb-3",children:"Editando registro"}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:D=>E(Q=>({...Q,dateInput:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:String(S.sellerId??""),onChange:D=>{const Q=D.target.value,te=l.get(Q);E(be=>({...be,sellerId:Q,sellerName:(te==null?void 0:te.name)??"",commissionPercent:Ma((te==null?void 0:te.commissionPercent)??0)}))},className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",value:String(S.amountDelivered??""),onChange:D=>E(Q=>({...Q,amountDelivered:Ma(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",value:String(S.extraExpenses??""),onChange:D=>E(Q=>({...Q,extraExpenses:Ma(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin %"}),i.jsx("input",{type:"number",value:String(S.commissionPercent??""),onChange:D=>E(Q=>({...Q,commissionPercent:Ma(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{type:"text",value:String(S.comment??""),onChange:D=>E(Q=>({...Q,comment:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>R(j),className:"flex-1 h-10 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:K,className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})]})]}):null]})]})]})]})]})}const lp=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function kit(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function uW(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Fit(t){const e=String(t||"").trim();if(!e)return 0;const r=Date.parse(e);return Number.isFinite(r)?r:0}function Oit({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new z2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function Dit(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState("ANY"),[y,b]=g.useState(!1),[w,I]=g.useState({});g.useEffect(()=>{(async()=>{n(!0),s("");try{const de=await Ht(sr(Ct(Ce,"candy_main_orders"))),Me=new Map;de.forEach(we=>{var ke,Ne,pe;const pt=we.data(),vt=Fit(pt.date),bt=((Ne=(ke=pt==null?void 0:pt.createdAt)==null?void 0:ke.toMillis)==null?void 0:Ne.call(ke))||((pe=pt==null?void 0:pt.createdAt)!=null&&pe.seconds?pt.createdAt.seconds*1e3:0)||0,kt=Math.max(vt,bt),Vt=Array.isArray(pt.items)?pt.items:[];for(const Le of Vt){const ft=String((Le==null?void 0:Le.id)||(Le==null?void 0:Le.productId)||"").trim();if(!ft)continue;const At=String((Le==null?void 0:Le.name)||(Le==null?void 0:Le.productName)||"").trim(),ct=String((Le==null?void 0:Le.category)||"").trim(),W=Number((Le==null?void 0:Le.unitPriceIsla)||0),z=Number((Le==null?void 0:Le.unitPriceRivas)||0),re=Number((Le==null?void 0:Le.unitsPerPackage)||(Le==null?void 0:Le.unitsPerPack)||1),V=Me.get(ft);(!V||kt>=V._sortKey)&&Me.set(ft,{productId:ft,category:ct,productName:At,priceIsla:W,priceRivas:z,unitsPerPackage:re,_sortKey:kt})}});const me=Array.from(Me.values()).sort((we,pt)=>we.productName.localeCompare(pt.productName,"es"));l(me)}catch(de){console.error(de),s(" Error cargando precios desde rdenes maestras."),l([])}finally{n(!1)}})()},[t]),g.useEffect(()=>{const de=Ct(Ce,"products_candies"),Me=sr(de),me=Pd(Me,we=>{const pt={},vt={},bt={},kt={};we.forEach(Vt=>{const ke=Vt.data();pt[Vt.id]=Number((ke==null?void 0:ke.providerPrice)||(ke==null?void 0:ke.providerPricePerUnit)||0),bt[Vt.id]=Number((ke==null?void 0:ke.unitsPerPackage)||(ke==null?void 0:ke.unitsPerPack)||1)||1;const Ne=String((ke==null?void 0:ke.barcode)||"").trim();Ne&&(vt[Vt.id]=Ne);const pe=String((ke==null?void 0:ke.packaging)||(ke==null?void 0:ke.empaque)||"").trim();pe&&(kt[Vt.id]=pe)});try{const Vt=S.current||{};let ke=!1;for(const ft of Object.keys(vt))if((vt[ft]||"")!==(Vt[ft]||"")){ke=!0;break}const Ne=B.current||{};let pe=!1;for(const ft of Object.keys(bt))if((bt[ft]||0)!==(Ne[ft]||0)){pe=!0;break}G(pt),ue(bt);const Le={...vt,...Vt};C(Le),S.current=Le,B.current={...bt},_e(kt),l(ft=>ft.map(At=>({...At,unitsPerPackage:bt[At.productId]??At.unitsPerPackage}))),!E.current&&ke&&(s(" Cdigo actualizado."),setTimeout(()=>s(""),3e3)),!E.current&&pe&&(s(" Unidades x paquete actualizadas."),setTimeout(()=>s(""),3e3)),E.current=!1}catch{G(pt),ue(bt),C(ke=>({...vt,...ke})),B.current={...bt},_e(kt),l(ke=>ke.map(Ne=>({...Ne,unitsPerPackage:bt[Ne.productId]??Ne.unitsPerPackage})))}},we=>console.error(we));return()=>me()},[]);const[j,C]=g.useState({}),S=g.useRef({}),E=g.useRef(!0),B=g.useRef({}),k=g.useRef({}),T=g.useRef(!0),[P,G]=g.useState({}),[ce,ue]=g.useState({}),[le,Ae]=g.useState({}),[ae,_e]=g.useState({}),[De,O]=g.useState("");g.useEffect(()=>{const de=Ct(Ce,"inventory_candies"),Me=sr(de),me=Pd(Me,we=>{try{const pt={};we.forEach(bt=>{var Le,ft,At;const kt=bt.data(),Vt=String(kt.productId||"").trim();if(!Vt)return;const ke=Number(kt.unitsPerPackage||kt.unitsPerPack||0)||0,Ne=((ft=(Le=kt==null?void 0:kt.createdAt)==null?void 0:Le.toMillis)==null?void 0:ft.call(Le))||((At=kt==null?void 0:kt.createdAt)!=null&&At.seconds?kt.createdAt.seconds*1e3:0)||0,pe=pt[Vt];(!pe||Ne>=pe.ts)&&(pt[Vt]={val:ke||0,ts:Ne})});const vt={};for(const bt of Object.keys(pt))vt[bt]=pt[bt].val||0;Ae(vt);try{const bt=k.current||{};let kt=!1;for(const Vt of Object.keys(vt))if((vt[Vt]||0)!==(bt[Vt]||0)){kt=!0;break}k.current={...vt},!T.current&&kt&&(s(" Inventario: unidades por paquete actualizadas."),setTimeout(()=>s(""),3e3)),T.current=!1}catch{}l(bt=>bt.map(kt=>({...kt,unitsPerPackage:vt[kt.productId]??ce[kt.productId]??kt.unitsPerPackage})))}catch(pt){console.error("inventory_candies snapshot error:",pt)}},we=>console.error(we));return()=>me()},[ce]),g.useEffect(()=>{l(de=>de.map(Me=>({...Me,unitsPerPackage:le[Me.productId]??ce[Me.productId]??Me.unitsPerPackage})))},[ce,le]);const H=g.useMemo(()=>{const de=kit(c),Me=String(d||"").trim(),me=String(De||"").trim().toLowerCase(),we=A.trim()===""?null:uW(A,NaN),pt=m.trim()===""?null:uW(m,NaN);return o.filter(vt=>{const bt=String(ae[vt.productId]||"").trim().toLowerCase();if(me)return bt===me;if(de&&!`${vt.category} ${vt.productName}`.toLowerCase().includes(de))return!1;if(Me){const Ne=String(vt.productId||""),pe=String(j[vt.productId]||"");if(!Ne.includes(Me)&&!pe.includes(Me))return!1}const kt=x==="ISLA"?[vt.priceIsla]:x==="RIVAS"?[vt.priceRivas]:[vt.priceIsla,vt.priceRivas],Vt=we==null||!Number.isFinite(we)?!0:kt.some(Ne=>Ne>=we),ke=pt==null||!Number.isFinite(pt)?!0:kt.some(Ne=>Ne<=pt);return Vt&&ke})},[o,c,A,m,x,j,De,ae]),K=g.useMemo(()=>{const de=new Map;for(const Me of H){const me=(Me.category||"Sin categora").trim()||"Sin categora",we=de.get(me)||[];we.push(Me),de.set(me,we)}return Array.from(de.entries()).sort(([Me],[me])=>Me.localeCompare(me,"es"))},[H]),R=5,[X,Y]=g.useState(1),D=Math.max(1,Math.ceil(K.length/R)),Q=g.useMemo(()=>{const de=(X-1)*R;return K.slice(de,de+R)},[K,X]);g.useEffect(()=>{Y(1)},[c,d,A,m,x,De]),g.useEffect(()=>{Y(de=>Math.min(de,D))},[D]);const te=()=>Y(1),be=()=>Y(de=>Math.max(1,de-1)),U=()=>Y(de=>Math.min(D,de+1)),Xe=()=>Y(D),se=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:te,disabled:X===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:be,disabled:X===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",X," de ",D]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:U,disabled:X===D,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Xe,disabled:X===D,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[K.length," categora(s)"]})]}),ee=de=>{I(Me=>({...Me,[de]:!Me[de]}))},Fe=()=>{u(""),h(""),p(""),v("ANY"),O("")},[je,Se]=g.useState(!1),[Ze,ut]=g.useState("search"),[Et,St]=g.useState(null),[Ft,Qt]=g.useState(0),[Ut,Tt]=g.useState(0),[Re,Te]=g.useState(null),[Ye,ht]=g.useState(""),[Oe,Ie]=g.useState(""),We=g.useMemo(()=>c.trim()!==""||A.trim()!==""||m.trim()!==""||x!=="ANY"||De.trim()!=="",[c,A,m,x,De]),[Z,Qe]=g.useState(!1);g.useEffect(()=>{var me;const de=window.matchMedia("(max-width: 900px)"),Me=()=>Qe(de.matches);return Me(),(me=de.addEventListener)==null||me.call(de,"change",Me),()=>{var we;return(we=de.removeEventListener)==null?void 0:we.call(de,"change",Me)}},[]);const[at,Ge]=g.useState(!1);g.useEffect(()=>{const de=bI(ic,async Me=>{if(!Me)return Ge(!1);try{const me=await gs(Yt(Ce,"users",Me.uid)),we=me.exists()?me.data():null,pt=we?Array.isArray(we.roles)?we.roles:we.role?[we.role]:[]:[];Ge(En(pt,"admin"))}catch(me){console.error(me),Ge(!1)}});return()=>de()},[]);const ie=async de=>{var Me;if(Ze==="search"){f(de);const me=Object.keys(j).find(vt=>(j[vt]||"")===de),we=(Me=o.find(vt=>String(vt.productId||"").includes(de)))==null?void 0:Me.productId,pt=me||we||null;pt&&(Te(pt),b(!1)),Se(!1);return}if(Ze==="edit"&&Et)try{const me=Ct(Ce,"products_candies"),we=Yt(me,Et);await kn(we,{barcode:de}),C(pt=>({...pt,[Et]:de})),ht(de),Se(!1),ut("search"),s(" Producto guardado.")}catch(me){console.error(me),s(" Error guardando el cdigo.")}},xe=async de=>{l(Me=>Me.map(me=>me.productId===de?{...me,priceIsla:Number(Ft||0),priceRivas:Number(Ut||0)}:me));try{const Me=String(Oe||"").trim();await kn(Yt(Ct(Ce,"products_candies"),de),{packaging:Me||""}),_e(me=>({...me,[de]:Me||""}))}catch(Me){console.error("Error updating packaging:",Me),s(" Error guardando empaque.")}St(null),s(Z?" Producto guardado.":"")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Precio Ventas"}),i.jsx("div",{className:"flex gap-2",children:i.jsx(Mc,{onClick:e,loading:r})})]}),i.jsxs("div",{className:"md:hidden mb-3",children:[i.jsxs("button",{type:"button",onClick:()=>b(de=>!de),className:`w-full px-3 py-3 rounded-xl border shadow-sm flex items-center justify-between ${We?"bg-yellow-50 border-yellow-200":"bg-white"}`,children:[i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Filtros"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[We?"Activos":"Ninguno","  ","Mostrando ",i.jsx("b",{children:H.length})]})]}),i.jsx("div",{className:"text-sm font-semibold",children:y?"Cerrar":"Abrir"})]}),y&&i.jsx("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:c,onChange:de=>u(de.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:De,onChange:de=>O(de.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por EAN"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:d,onChange:de=>f(de.target.value),placeholder:"Cdigo EAN"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ut("search"),Se(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Fe(),f("")},children:"Limpiar filtros"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>b(!1),children:"Aplicar"})]})]})})]}),i.jsxs("div",{className:"hidden md:block bg-white p-3 rounded shadow border mb-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Filtrar por producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:de=>u(de.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:De,onChange:de=>O(de.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:A,onChange:de=>h(de.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:m,onChange:de=>p(de.target.value),placeholder:"0"})]}),i.jsx("div",{className:"text-right",children:i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Fe,children:"Limpiar"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Fuente: ",i.jsx("b",{children:"candy_main_orders.items[]"}),"  Muestra el"," ",i.jsx("b",{children:"ltimo precio"})," registrado por producto."]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Mostrando:"})," ",i.jsx("b",{children:H.length})]})]})]}),i.jsxs("div",{className:"md:hidden",children:[r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):H.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):i.jsx("div",{className:"space-y-2",children:Q.map(([de,Me])=>{const me=!!w[de];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>ee(de),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:de}),i.jsxs("div",{className:"text-[10px] text-gray-600 truncate",children:[Me.length," ",Me.length===1?"producto":"productos"]})]}),i.jsx("div",{className:"text-sm font-semibold",children:me?"":"+"})]}),me&&i.jsx("div",{className:"px-3 pb-3 border-t space-y-2",children:Me.map(we=>{const pt=Re===we.productId,vt=Et===we.productId,bt=P[we.productId]||0,kt=we.priceIsla-bt,Vt=kt*.25;return i.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Te(ke=>ke===we.productId?null:we.productId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:we.productName}),i.jsx("div",{className:"text-[10px] text-gray-600 truncate",children:we.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"P. Paquete"}),i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:lp(we.priceIsla)})]})]}),pt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Categora"}),i.jsx("div",{className:"text-sm",children:we.category}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Unidades x paquete"}),i.jsx("div",{className:"text-sm",children:String(we.unitsPerPackage||1)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Unidad"}),i.jsx("div",{className:"text-sm tabular-nums",children:lp(we.priceIsla/(we.unitsPerPackage||1))})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Paquete"}),vt?i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:String(Ft),onChange:ke=>Qt(Number(ke.target.value||0))}):i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:lp(we.priceIsla)})]})]}),i.jsxs("div",{children:[at&&i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-sm tabular-nums",children:lp(kt)})]}),i.jsxs("div",{className:"mt-1",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Comisin"}),i.jsx("div",{className:"text-sm tabular-nums",children:lp(Vt)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Cdigo EAN"}),vt?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:Ye,readOnly:!0}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>{ut("edit"),Se(!0)},type:"button",children:"Escanear"})]}):i.jsx("div",{children:j[we.productId]||""})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Tipo Empaque"}),vt?i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:Oe,onChange:ke=>Ie(ke.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"text-sm",children:ae[we.productId]||""})]})]})]}),i.jsx("div",{className:"flex gap-2",children:vt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white",onClick:()=>{xe(we.productId),Te(null)},type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ut("edit"),Se(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200",onClick:()=>St(null),type:"button",children:"Cancelar"})]}):at&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-yellow-400",onClick:()=>{St(we.productId),Qt(we.priceIsla||0),Tt(we.priceRivas||0),ht(j[we.productId]||""),Ie(ae[we.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white",onClick:()=>l(ke=>ke.filter(Ne=>Ne.productId!==we.productId)),type:"button",children:"Borrar"})]})})]})})]},we.productId)})})]},de)})}),!r&&K.length>0&&se(),a&&i.jsx("p",{className:"mt-2 text-sm",children:a})]}),i.jsx(Oit,{open:je,onClose:()=>Se(!1),onDetected:ie}),i.jsx("div",{className:"hidden md:block bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin resultados."})}):H.map(de=>i.jsxs("tr",{children:[i.jsx("td",{className:"p-2 border",children:de.category}),i.jsx("td",{className:"p-2 border",children:de.productName}),i.jsx("td",{className:"p-2 border",children:Et===de.productId?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Oe,onChange:Me=>Ie(Me.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):ae[de.productId]||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Et===de.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Ft),onChange:Me=>Qt(Number(Me.target.value||0))}):lp(de.priceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Et===de.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Ut),onChange:Me=>Tt(Number(Me.target.value||0))}):lp(de.priceRivas)}),i.jsx("td",{className:"p-2 border text-right",children:Et===de.productId?i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white text-sm",onClick:()=>xe(de.productId),type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 text-sm",onClick:()=>St(null),type:"button",children:"Cancelar"})]}):at&&i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-sm",onClick:()=>{St(de.productId),Qt(de.priceIsla||0),Tt(de.priceRivas||0),ht(j[de.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white text-sm",onClick:()=>{St(de.productId),ut("edit"),Se(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white text-sm",onClick:()=>l(Me=>Me.filter(me=>me.productId!==de.productId)),type:"button",children:"Borrar"})]})})]},de.productId))})]})}),a&&i.jsx("p",{className:"hidden md:block mt-2 text-sm",children:a})]})}const M_=["Cuaderno","Block","Lapicero","Lpiz","Tajador","Borrador","Corrector","Cartucheras"],dW=["Lider","Scribe","Smarty","Pointer","Paper Mate","Otro"],RT=["Hombre","Mujer","Variado","NA"],Rit=["Universitario Cocido","5 Materia","2 Materia","Doble Raya","Rayado","Cuadriculado","Subrayado","Sublineado","Liso"],Xl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function No(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Nc(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function IE(t,e=1){const r=Math.floor(Nc(t,e));return r>0?r:e}function Ade(t){return!Number.isFinite(t)||t<=0?0:t}function MT(t){const e=String(t??"").trim();return e||""}function nf(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(No(a),a));for(const a of e){const s=n.get(No(a));if(s!=null)return t[s]}}function Mit(t){return Object.values(t||{}).every(r=>No(r)==="")}function _x(t){const e=Math.max(0,Nc(t.providerPrice,0)),r=Math.max(1,IE(t.quantity,1)),n=Ade(Nc(t.margin,0)),a=Math.max(0,Nc(t.salePrice,0)),s=n>0?e/n:e,o=a>0?a:s,l=o>0?e/o:n,c=e*r,u=(o-e)*r,d=o*r;return{providerPrice:e,quantity:r,margin:l,salePrice:o,facturado:c,gain:u,totalEsperado:d}}function Lit(){const{refreshKey:t,refresh:e}=Lc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(!1),[w,I]=g.useState(null),[j,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState(M_[0]),[T,P]=g.useState(dW[0]),[G,ce]=g.useState(""),[ue,le]=g.useState(0),[Ae,ae]=g.useState(1),[_e,De]=g.useState(.7),[O,H]=g.useState(0),[K,R]=g.useState("NA"),[X,Y]=g.useState(""),[D,Q]=g.useState(""),[te,be]=g.useState(!1),[U,Xe]=g.useState(""),[se,ee]=g.useState([]),[Fe,je]=g.useState([]),[Se,Ze]=g.useState(!1);g.useEffect(()=>{(async()=>{n(!0),s("");try{const ie=await Ht(sr(Ct(Ce,"products_stationery"))),xe=[];ie.forEach(de=>{const Me=de.data();xe.push({id:de.id,category:Me.category||"",brand:Me.brand||"",name:Me.name||"",providerPrice:Number(Me.providerPrice||0),quantity:Number(Me.quantity||1),facturado:Number(Me.facturado||0),margin:Number(Me.margin||0),salePrice:Number(Me.salePrice||0),gain:Number(Me.gain||0),gender:Me.gender||"NA",typeProduct:Me.typeProduct||"",code:Me.code??"",createdAt:Me.createdAt,updatedAt:Me.updatedAt,totalEsperado:Number(Me.totalEsperado||Number(Me.salePrice||0)*Number(Me.quantity||1))})}),l(xe)}catch(ie){console.error(ie),s(" Error cargando productos (papelera).")}finally{n(!1)}})()},[t]);const ut=g.useMemo(()=>{const ie=No(d),xe=No(A),de=m.trim()===""?null:Nc(m,NaN),Me=x.trim()===""?null:Nc(x,NaN);return o.filter(me=>!(ie&&!`${me.category} ${me.name}`.toLowerCase().includes(ie)||xe&&!String(me.code||"").toLowerCase().includes(xe)||de!=null&&Number.isFinite(de)&&me.salePrice<de||Me!=null&&Number.isFinite(Me)&&me.salePrice>Me))},[o,d,A,m,x]),Et=g.useMemo(()=>d.trim()!==""||A.trim()!==""||m.trim()!==""||x.trim()!=="",[d,A,m,x]),St=g.useMemo(()=>{const ie=o.length,xe=o.reduce((me,we)=>me+(we.facturado||0),0),de=o.reduce((me,we)=>me+Number(we.totalEsperado||Number(we.salePrice||0)*Number(we.quantity||1)),0),Me=o.reduce((me,we)=>me+(we.gain||0),0);return{count:ie,sumFact:xe,sumEsperado:de,sumGain:Me}},[o]),Ft=()=>{k(M_[0]),ce(""),le(0),ae(1),De(.7),H(0),R("NA"),Y(""),Q(""),I(null)},Qt=()=>{Ft(),b(!0)},Ut=ie=>{I(ie),k(ie.category||M_[0]),P(ie.brand||dW[0]),ce(ie.name||""),le(Number(ie.providerPrice||0)),ae(Number(ie.quantity||1)),De(Number(ie.margin||.7)),H(Number(ie.salePrice||0)),R(ie.gender||"NA"),Y(ie.typeProduct||""),Q(String(ie.code||"")),b(!0)},Tt=async()=>{s("");const ie=String(B||"").trim(),xe=String(T||"").trim(),de=String(G||"").trim(),{providerPrice:Me,quantity:me,margin:we,salePrice:pt,facturado:vt,totalEsperado:bt,gain:kt}=_x({providerPrice:ue,quantity:Ae,margin:_e,salePrice:O});if(!ie)return s(" Categora requerida.");if(!de)return s(" Producto requerido.");if(Me<=0)return s(" Precio proveedor debe ser > 0.");if(me<=0)return s(" Cantidad debe ser > 0.");if(pt<=0)return s(" Precio venta invlido.");if(we<=0)return s(" Margen invlido.");const Vt={category:ie,brand:xe,name:de,providerPrice:Me,quantity:me,facturado:vt,margin:we,salePrice:pt,gain:kt,gender:K||"NA",typeProduct:String(X||"").trim(),code:MT(D)||null,updatedAt:yr.now(),totalEsperado:bt};try{n(!0),w?(await kn(Yt(Ce,"products_stationery",w.id),Vt),s(" Producto actualizado.")):(await Gn(Ct(Ce,"products_stationery"),{...Vt,createdAt:yr.now()}),s(" Producto creado.")),b(!1),I(null),Ft(),e()}catch(ke){console.error(ke),s(" Error guardando producto.")}finally{n(!1)}},Re=async()=>{var ie;try{const xe=new z2,de=await z2.listVideoInputDevices(),Me=(ie=de[de.length-1])==null?void 0:ie.deviceId;if(!Me)return null;const me=document.createElement("div");me.className="fixed inset-0 z-[9999] bg-black/70 flex items-center justify-center p-3";const we=document.createElement("div");we.className="bg-white w-full max-w-md rounded-xl overflow-hidden shadow-xl";const pt=document.createElement("div");pt.className="p-3 flex items-center justify-between border-b",pt.innerHTML="<div style='font-weight:700'>Escanear cdigo</div>";const vt=document.createElement("button");vt.textContent="Cerrar",vt.className="px-3 py-1 rounded bg-gray-200";const bt=document.createElement("div");bt.className="p-3";const kt=document.createElement("video");return kt.style.width="100%",kt.style.borderRadius="12px",bt.appendChild(kt),pt.appendChild(vt),we.appendChild(pt),we.appendChild(bt),me.appendChild(we),document.body.appendChild(me),await new Promise(async Vt=>{const ke=()=>{me.remove(),Vt(null)};vt.onclick=ke;const Ne=await xe.decodeFromVideoDevice(Me,kt,pe=>{if(pe){const Le=pe.getText();try{Ne.stop()}catch{}me.remove(),Vt(Le)}})})}catch(xe){return console.error(xe),null}},Te=async()=>{const ie=await Re();ie&&Q(ie)},Ye=async()=>{const ie=await Re();if(!ie)return;const xe=o.find(de=>String(de.code||"")===String(ie));xe?(E(xe),C(!0),s("")):(E(null),C(!0),s(""))},ht=(ie,xe)=>{const de=ie.map(we=>({Id:we.id,Categoria:we.category,brand:we.brand,Producto:we.name,PrecioProveedor:we.providerPrice,Cantidad:we.quantity,Facturado:we.facturado,TotalEsperado:we.totalEsperado||we.salePrice*we.quantity,Margen:we.margin,PrecioVenta:we.salePrice,Ganancia:we.gain,Genero:we.gender,TipoProducto:we.typeProduct,Codigo:we.code||""})),Me=ha.json_to_sheet(de),me=ha.book_new();ha.book_append_sheet(me,Me,"Productos"),K2(me,xe)},Oe=()=>{const ie=[{Id:"",Categoria:"Cuaderno",brand:"Lider",Producto:"Cuaderno Norma 100 hojas",PrecioProveedor:120,Cantidad:12,Margen:.7,PrecioVenta:"",Genero:"NA",TipoProducto:"Universitario Cocido",Codigo:"1234567890123"}],xe=ha.json_to_sheet(ie),de=ha.book_new();ha.book_append_sheet(de,xe,"Productos");const Me=E1(de,{type:"array",bookType:"xlsx"}),me=new Blob([Me],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),we=URL.createObjectURL(me),pt=document.createElement("a");pt.href=we,pt.download="template_products_stationery.xlsx",document.body.appendChild(pt),pt.click(),pt.remove(),URL.revokeObjectURL(we)},Ie=ie=>{const xe=[],de=[];ie.forEach((me,we)=>{if(!me||typeof me!="object"||Mit(me))return;const pt=we+2,vt=String(nf(me,["Id","ID","docId","DocId"])??"").trim(),bt=String(nf(me,["Categoria","Categora","Category","category"])??"").trim(),kt=String(nf(me,["Brand","Marca","brand","marca"])??"").trim(),Vt=String(nf(me,["Producto","Product","Nombre","Name","name"])??"").trim(),ke=nf(me,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Costo","providerPrice"]),Ne=nf(me,["Cantidad","Qty","quantity","cantidad"]),pe=nf(me,["Margen","Margin","margen","margin"]),Le=nf(me,["PrecioVenta","Precio Venta","SalePrice","salePrice"]),ft=String(nf(me,["Genero","Gnero","Gender","gender"])??"NA").trim(),At=String(nf(me,["TipoProducto","Tipo","TypeProduct","typeProduct","Tipo producto"])??"").trim(),ct=nf(me,["Codigo","Cdigo","Code","Barcode","code"]),W=MT(ct),z=Math.max(0,Nc(ke,0)),re=Math.max(1,IE(Ne,1)),V=Ade(Nc(pe,0)),L=Math.max(0,Nc(Le,0));bt||de.push(`Fila ${pt}: falta Categoria.`),Vt||de.push(`Fila ${pt}: falta Producto.`),z<=0&&de.push(`Fila ${pt}: PrecioProveedor debe ser > 0.`),re<=0&&de.push(`Fila ${pt}: Cantidad debe ser > 0.`),V<=0&&L<=0&&de.push(`Fila ${pt}: Margen debe ser > 0 (o enviar PrecioVenta).`);const Be=RT.includes(ft||"NA")?ft:"NA";bt&&Vt&&z>0&&re>0&&(V>0||L>0)&&xe.push({id:vt||void 0,category:bt,brand:kt,name:Vt,providerPrice:z,quantity:re,margin:V>0?V:.7,salePrice:L>0?L:void 0,gender:Be,typeProduct:At,code:W||"",_raw:me})});const Me=new Map;for(const me of xe){const we=me.id?`id::${me.id}`:`${No(me.category)}::${No(me.name)}`;Me.set(we,me)}return{rows:Array.from(Me.values()),errors:de}},We=async ie=>{if(s(""),je([]),ee([]),Xe((ie==null?void 0:ie.name)||""),!ie)return;const xe=ie.name.toLowerCase(),de=xe.endsWith(".xlsx")||xe.endsWith(".xls"),Me=xe.endsWith(".csv");if(!de&&!Me){je(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ze(!0);const me=new FileReader,we=await new Promise((Ne,pe)=>{me.onerror=()=>pe(new Error("No se pudo leer el archivo.")),me.onload=()=>Ne(me.result),me.readAsArrayBuffer(ie)}),pt=Gv(new Uint8Array(we),{type:"array"}),vt=pt.SheetNames[0],bt=pt.Sheets[vt],kt=ha.sheet_to_json(bt,{defval:""}),{rows:Vt,errors:ke}=Ie(kt);ee(Vt),je(ke),Vt.length===0&&ke.length===0&&je(["No se encontraron filas vlidas para importar."])}catch(me){console.error(me),je(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ze(!1)}},Z=(ie,xe)=>{ee(de=>{const Me=[...de],me=Me[ie];return me?(Me[ie]={...me,...xe},Me):de})},Qe=g.useMemo(()=>{const ie=new Set(o.map(me=>me.id)),xe=new Set(o.map(me=>`${No(me.category)}::${No(me.name)}`));let de=0,Me=0;for(const me of se){if(me.id&&ie.has(me.id)){de+=1;continue}const we=`${No(me.category)}::${No(me.name)}`;xe.has(we)?de+=1:Me+=1}return{total:se.length,willCreate:Me,willUpdate:de}},[se,o]),at=async()=>{if(s(""),Fe.length>0){s(" Correg los errores antes de importar.");return}if(se.length===0){s(" No hay filas para importar.");return}try{Ze(!0);const ie={},xe={};o.forEach(we=>{ie[we.id]=we,xe[`${No(we.category)}::${No(we.name)}`]=we});const de=Ic(Ce);let Me=0,me=0;for(const we of se){const pt=String(we.category||"").trim(),vt=String(we.name||"").trim(),{providerPrice:bt,quantity:kt,margin:Vt,salePrice:ke,facturado:Ne,totalEsperado:pe,gain:Le}=_x({providerPrice:we.providerPrice,quantity:we.quantity,margin:we.margin,salePrice:we.salePrice});if(!pt||!vt||bt<=0||kt<=0||ke<=0||Vt<=0)continue;const ft={category:pt,name:vt,providerPrice:bt,quantity:kt,facturado:Ne,totalEsperado:pe,margin:Vt,salePrice:ke,gain:Le,gender:we.gender||"NA",typeProduct:String(we.typeProduct||"").trim(),code:MT(we.code)||null,updatedAt:yr.now()};let At;if(we.id&&ie[we.id])At=ie[we.id];else{const ct=`${No(pt)}::${No(vt)}`;At=xe[ct]}if(At)de.update(Yt(Ce,"products_stationery",At.id),ft),me+=1;else{const ct=Yt(Ct(Ce,"products_stationery"));de.set(ct,{...ft,createdAt:yr.now()}),Me+=1}}await de.commit(),s(` Importacin lista. Creados: ${Me}, Actualizados: ${me}`),be(!1),ee([]),je([]),Xe(""),e()}catch(ie){console.error(ie),s(" Error importando productos a Firestore.")}finally{Ze(!1)}},Ge=()=>{f(""),h(""),p(""),v("")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Papelera"}),i.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-900 text-white hover:bg-black",onClick:Ye,type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:Qt,type:"button",children:"+ Nuevo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{be(!0),ee([]),je([]),Xe("")},type:"button",children:"Importar (.xlsx)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ht(o,"products_stationery_todo.xlsx"),type:"button",children:"Exportar (todo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ht(ut,"products_stationery_filtrado.xlsx"),type:"button",children:"Exportar (filtrado)"}),i.jsx(Mc,{onClick:e,loading:r||Se})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[i.jsx(L_,{label:"Productos",value:St.count}),i.jsx(L_,{label:"Facturado",value:Xl(St.sumFact)}),i.jsx(L_,{label:"Esperado",value:Xl(St.sumEsperado)}),i.jsx(L_,{label:"Ganancia",value:Xl(St.sumGain)})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{className:`w-full md:w-auto px-3 py-2 rounded border bg-white hover:bg-gray-50 ${Et?"border-yellow-300 bg-yellow-50":""}`,type:"button",onClick:()=>u(ie=>!ie),children:[c?"Cerrar filtros":"Abrir filtros"," ",Et?"(activos)":""]}),c&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:d,onChange:ie=>f(ie.target.value),placeholder:"Ej: Cuaderno Norma"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:A,onChange:ie=>h(ie.target.value),placeholder:"Barcode"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:m,onChange:ie=>p(ie.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:x,onChange:ie=>v(ie.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"md:col-span-4 flex gap-2 justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Ge,children:"Limpiar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>u(!1),children:"Aplicar"})]})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-600",children:[i.jsxs("div",{children:["Mostrando: ",i.jsx("b",{children:ut.length})]}),i.jsxs("div",{children:["Coleccin: ",i.jsx("b",{children:"products_stationery"})]})]})]})]}),i.jsx("div",{className:"md:hidden space-y-2",children:r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):ut.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):ut.map(ie=>i.jsxs("div",{className:"bg-white border rounded-xl p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:ie.category}),i.jsx("div",{className:"text-base font-bold leading-tight",children:ie.name}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Xl(ie.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Esperado:"," ",i.jsx("b",{children:Xl(ie.totalEsperado||ie.salePrice*ie.quantity)})]}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Xl(ie.gain)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Cdigo: ",i.jsx("b",{children:ie.code||""})]}),i.jsx("div",{className:"mt-2 flex gap-2",children:i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Ut(ie),children:"Editar"})})]},ie.id))}),i.jsx("div",{className:"hidden md:block bg-white border rounded overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"Venta"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Cargando"})}):ut.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Sin resultados."})}):ut.map(ie=>i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:ie.category}),i.jsx("td",{className:"p-2 border",children:ie.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Xl(ie.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ie.quantity}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Xl(ie.facturado)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Xl(ie.totalEsperado||ie.salePrice*ie.quantity)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Number(ie.margin||0).toFixed(2)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Xl(ie.salePrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Xl(ie.gain)}),i.jsx("td",{className:"p-2 border",children:ie.gender}),i.jsx("td",{className:"p-2 border",children:ie.typeProduct}),i.jsx("td",{className:"p-2 border",children:ie.code||""}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Ut(ie),children:"Editar"})})]},ie.id))})]})}),a&&i.jsx("p",{className:"mt-2 text-sm",children:a}),y&&i.jsxs(fW,{onClose:()=>b(!1),title:w?"Editar producto":"Nuevo producto",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:B,onChange:ie=>k(ie.target.value),children:M_.map(ie=>i.jsx("option",{value:ie,children:ie},ie))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:G,onChange:ie=>ce(ie.target.value),placeholder:"Ej: Cuaderno Norma..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(ue)?"":ue,onChange:ie=>le(Math.max(0,Nc(ie.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cantidad"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-2 text-right",value:Ae,onChange:ie=>ae(IE(ie.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Facturado (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:Xl(_x({providerPrice:ue,quantity:Ae,margin:_e,salePrice:O}).facturado)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Margen"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(_e)?"":_e,onChange:ie=>De(Math.max(0,Nc(ie.target.value,0)))}),i.jsx("div",{className:"text-[11px] text-gray-600 mt-1",children:"Ej: 0.70 / 0.80"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(_x({providerPrice:ue,quantity:Ae,margin:_e,salePrice:O}).salePrice)?"":_x({providerPrice:ue,quantity:Ae,margin:_e,salePrice:O}).salePrice,onChange:ie=>{H(Math.max(0,Nc(ie.target.value,0)))}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Ganancia (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:Xl(_x({providerPrice:ue,quantity:Ae,margin:_e,salePrice:O}).gain)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:K,onChange:ie=>R(ie.target.value),children:RT.map(ie=>i.jsx("option",{value:ie,children:ie},ie))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo producto"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:X,onChange:ie=>Y(ie.target.value),children:[i.jsx("option",{value:"",children:""}),Rit.map(ie=>i.jsx("option",{value:ie,children:ie},ie))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:D,onChange:ie=>Q(ie.target.value),placeholder:"Escane o peg el cdigo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Te,children:"Escanear"})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:()=>{b(!1),I(null)},children:"Cancelar"}),i.jsx("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:Tt,disabled:r,children:"Guardar"})]})]}),j&&i.jsx(fW,{onClose:()=>C(!1),title:"Resultado de escaneo",children:S?i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:S.category}),i.jsx("div",{className:"text-lg font-bold",children:S.name}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Precio venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Xl(S.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Xl(S.gain)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Proveedor"}),i.jsx("div",{className:"font-semibold tabular-nums",children:Xl(S.providerPrice)})]}),i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cantidad"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.quantity})]}),i.jsxs("div",{className:"rounded-lg border p-2 col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cdigo"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.code||""})]})]}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsx("button",{className:"px-4 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>{C(!1),Ut(S)},children:"Editar"})})]}):i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-semibold",children:"No encontrado"}),i.jsxs("div",{className:"text-gray-600 mt-1",children:["Ese cdigo no existe en ",i.jsx("b",{children:"products_stationery"}),"."]})]})}),te&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar papelera (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>be(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas: Id (opcional), Categoria, Producto, PrecioProveedor, Cantidad, Margen (o PrecioVenta), Genero, TipoProducto, Codigo."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Oe,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:ie=>{var xe;return We(((xe=ie.target.files)==null?void 0:xe[0])||null)}}),U&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:U})]}),Se&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),Fe.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:Fe.slice(0,60).map((ie,xe)=>i.jsx("li",{children:ie},xe))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",Qe.total," filas (Crear:"," ",Qe.willCreate," / Actualizar:"," ",Qe.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:at,disabled:Se||se.length===0||Fe.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1500px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"PrecioVenta"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:se.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):se.slice(0,300).map((ie,xe)=>{const de=ie.id?o.some(we=>we.id===ie.id):!1,Me=o.some(we=>`${No(we.category)}::${No(we.name)}`==`${No(ie.category)}::${No(ie.name)}`),me=de||Me;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ie.id||"",onChange:we=>Z(xe,{id:we.target.value.trim()||void 0}),placeholder:"docId (update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:ie.category,onChange:we=>Z(xe,{category:we.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:ie.name,onChange:we=>Z(xe,{name:we.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:ie.providerPrice,onChange:we=>Z(xe,{providerPrice:Math.max(0,Nc(we.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:ie.quantity,onChange:we=>Z(xe,{quantity:IE(we.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-24 border rounded px-2 py-1 text-right",value:ie.margin,onChange:we=>Z(xe,{margin:Math.max(0,Nc(we.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:ie.salePrice??"",onChange:we=>Z(xe,{salePrice:Math.max(0,Nc(we.target.value,0))||void 0}),placeholder:"Opcional"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("select",{className:"w-28 border rounded px-2 py-1",value:ie.gender,onChange:we=>Z(xe,{gender:we.target.value}),children:RT.map(we=>i.jsx("option",{value:we,children:we},we))})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ie.typeProduct,onChange:we=>Z(xe,{typeProduct:we.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ie.code||"",onChange:we=>Z(xe,{code:we.target.value})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${me?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:me?"ACTUALIZA":"CREA"})})]},`${ie.id||""}-${xe}`)})})]}),se.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",se.length," filas (importa todas)."]})]})]})]})})]})}function L_({label:t,value:e}){return i.jsxs("div",{className:"bg-white border rounded p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-extrabold",children:e})]})}function fW({title:t,children:e,onClose:r}){return i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-3xl p-4 relative",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:t}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),e]})})}const cd=t=>`C$ ${(Number(t)||0).toFixed(2)}`,_0=t=>Number(t||0).toFixed(3),LT=(t,e)=>{var a,s,o,l;const r=t._raw||{},n=t.customerName||r.customerName||((a=r.customer)==null?void 0:a.name)||r.clientName||((s=r.client)==null?void 0:s.name)||"";return t.type==="CONTADO"&&n?n:(t.customerId?e[t.customerId]:"")||t.customerName||r.customerName||((o=r.customer)==null?void 0:o.name)||r.clientName||((l=r.client)==null?void 0:l.name)||"Nombre cliente"},hW=t=>{const e=t._raw||{},r=pde(e)||t.date,n=av(r);return isFinite(n)?n:NaN},UT=t=>String((t==null?void 0:t.status)||"").toUpperCase()==="PROCESADA"||t!=null&&t.closureId||t!=null&&t.closureDate||t!=null&&t.processedDate?"PROCESADA":"FLOTANTE",Uit=t=>String(t??"").toLowerCase().trim(),AW=t=>["lb","lbs","libra","libras"].includes(Uit(t)),mW=t=>Number((t==null?void 0:t.qty)??(t==null?void 0:t.quantity)??0)||0,Qit=t=>t?Array.isArray(t.items)&&t.items.length>0?t.items.reduce((e,r)=>AW((r==null?void 0:r.measurement)??(t==null?void 0:t.measurement))?e+mW(r):e,0):AW(t==null?void 0:t.measurement)?mW(t):0:0;function mde(t){if(!t)return"";if(t!=null&&t.toDate)return Lr(t.toDate(),"yyyy-MM-dd");const e=String(t).trim();if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const r=["dd/MM/yyyy","d/M/yyyy","MM/dd/yyyy","M/d/yyyy","yyyy/MM/dd","yyyy-M-d","yyyy/M/d","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSSX"];for(const a of r){const s=NS(e,a,new Date);if(D6(s))return Lr(s,"yyyy-MM-dd")}const n=new Date(e);return isNaN(n.getTime())?"":Lr(n,"yyyy-MM-dd")}function av(t){const e=mde(t);if(!e)return NaN;const r=NS(e,"yyyy-MM-dd",new Date);return D6(r)?r.getTime():NaN}function pde(t){var n,a;const e=mde(t==null?void 0:t.date),r=(n=t==null?void 0:t.createdAt)!=null&&n.toDate?t.createdAt.toDate():null;if(e&&r){const s=av(e),o=r.getTime();if(Math.abs(o-s)/(1e3*60*60*24)>30)return Lr(r,"yyyy-MM-dd")}return e||((a=t==null?void 0:t.timestamp)!=null&&a.toDate?Lr(t.timestamp.toDate(),"yyyy-MM-dd"):r?Lr(r,"yyyy-MM-dd"):"")}function Vit(t,e){var s,o,l,c;const r=pde(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((u,d)=>u+(Number(d.qty??d.quantity??d.lbs??0)||0),0),a=Number(t.amount??t.total??0)||0):(n=Number(t.quantity??t.lbs??t.weight??0)||0,a=Number(t.amount??t.total??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||((s=t.customer)==null?void 0:s.id)||((o=t.customer)==null?void 0:o.customerId)||t.clientId||void 0,customerName:t.customerName||((l=t.customer)==null?void 0:l.name)||t.clientName||((c=t.client)==null?void 0:c.name)||void 0,_raw:t}}async function Hit(t){const e=sr(Ct(Ce,"ar_movements"),cr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Wn(Yt(Ce,"ar_movements",n.id))))}function $it({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=En(n,"vendedor_pollo"),s=En(n,"admin");if(!(En(n,"admin")||En(n,"vendedor_pollo")||En(n,"supervisor_pollo")||En(n,"contador")))return i.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center text-red-600",children:"Acceso restringido  Solo administradores, vendedores y supervisores de pollo."});const o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async Oe=>{c(!0),d(!0),A(Oe),m([]);try{const Ie=await gs(Yt(Ce,"salesV2",Oe)),We=Ie.exists()?Ie.data():null;if(!We){m([]);return}let Z=[];if(Array.isArray(We.items)&&We.items.length>0)Z=We.items;else if(We.items&&typeof We.items=="object")try{Z=Object.values(We.items)}catch{Z=[]}else We.item?Z=[We.item]:Array.isArray(We.products)&&We.products.length>0?Z=We.products:Array.isArray(We.lines)&&We.lines.length>0?Z=We.lines:Array.isArray(We.detalles)&&We.detalles.length>0?Z=We.detalles:(We.productName||We.product)&&(Z=[{productName:We.productName||We.product||"",qty:We.qty??We.quantity??We.lbs??0,unitPrice:We.unitPrice??We.price??0,discount:We.discount??0,total:We.total??We.amount??0}]);const Qe=xe=>{if(xe==null)return NaN;if(typeof xe=="number")return xe;let de=String(xe).trim();if(!de)return NaN;if(de=de.replace(/[^0-9.,-]/g,""),!de)return NaN;de.indexOf(".")>-1&&de.indexOf(",")>-1?de=de.replace(/,/g,""):de.indexOf(",")>-1&&de.indexOf(".")===-1&&(de=de.replace(/,/g,"."));const Me=Number(de);return isNaN(Me)?NaN:Me},at=new Set;for(const xe of Z)if(Array.isArray(xe==null?void 0:xe.allocations))for(const de of xe.allocations){const Me=String((de==null?void 0:de.batchId)||"").trim();Me&&at.add(Me)}else if(xe!=null&&xe.allocations&&typeof xe.allocations=="object")try{for(const de of Object.values(xe.allocations)){const Me=String((de==null?void 0:de.batchId)||"").trim();Me&&at.add(Me)}}catch{}if(Array.isArray(We==null?void 0:We.allocations))for(const xe of We.allocations){const de=String((xe==null?void 0:xe.batchId)||"").trim();de&&at.add(de)}const Ge={};at.size>0&&await Promise.all(Array.from(at).map(async xe=>{try{const de=await gs(Yt(Ce,"inventory_batches",xe));if(de.exists()){const Me=de.data();Ge[xe]=Number(Me.salePrice??Me.sale_price??Me.price??0)}}catch{}}));const ie=Z.map(xe=>{const de=String(xe.productName||xe.product||xe.name||"(sin nombre)"),Me=Number(xe.qty??xe.quantity??xe.lbs??xe.weight??0)||0,me=Qe(xe.total??xe.lineFinal??xe.amount??xe.monto??xe.line_total)||0;let we=0;const pt=[xe.unitPrice,xe.unitPricePackage,xe.salePrice,xe.sale_price,xe.price,xe.unit_price,xe.pricePerUnit,xe.price_per_unit];for(const kt of pt){const Vt=Qe(kt);if(!isNaN(Vt)&&Vt!==0){we=Vt;break}}if(!we){const kt=(We==null?void 0:We.salePrice)??(We==null?void 0:We.sale_price)??(We==null?void 0:We.unitPrice)??(We==null?void 0:We.unit_price)??(We==null?void 0:We.price)??(We==null?void 0:We.pricePerUnit),Vt=Qe(kt);!isNaN(Vt)&&Vt!==0&&(we=Vt)}if(!we){const kt=Array.isArray(xe.allocations)?xe.allocations[0]:xe.allocations&&typeof xe.allocations=="object"?Object.values(xe.allocations)[0]:null,Vt=kt?String(kt.batchId||"").trim():"";Vt&&Ge[Vt]&&(we=Ge[Vt]||0)}!we&&xe.productId&&(we=productPriceMap[String(xe.productId)]||0),(!we||we===0)&&me>0&&Me>0&&(we=me/Me);const vt=Qe(xe.discount??xe.desc??0)||0;let bt=me;return(!bt||bt===0)&&(bt=Number(we*Me||0)),bt=Number(bt)||0,{productName:de,qty:Me,unitPrice:we,discount:vt,total:bt}});m(ie)}catch(Ie){console.error(Ie)}finally{d(!1)}},[x,v]=g.useState(Lr(new Date,"yyyy-MM-01")),[y,b]=g.useState(Lr(new Date,"yyyy-MM-dd")),[w,I]=g.useState([]),[j,C]=g.useState([]),[S,E]=g.useState([]),[B,k]=g.useState(!0),[T,P]=g.useState(""),{refreshKey:G,refresh:ce}=Lc(),[ue,le]=g.useState(""),[Ae,ae]=g.useState(""),[_e,De]=g.useState("ALL"),[O,H]=g.useState(""),[K,R]=g.useState(null),X=15,[Y,D]=g.useState(1),Q=g.useMemo(()=>{const Oe={};return w.forEach(Ie=>Oe[Ie.id]=Ie.name),Oe},[w]);g.useEffect(()=>{_e!=="ALL"&&!S.includes(_e)&&De("ALL")},[S,_e]),g.useEffect(()=>{(async()=>{k(!0),P("");try{const Oe=[];if(a&&e){const me=sr(Ct(Ce,"customers_pollo"),cr("vendorId","==",e),Sn("createdAt","desc"));(await Ht(me)).forEach(pt=>Oe.push({id:pt.id,name:pt.data().name||""}))}else(await Ht(sr(Ct(Ce,"customers_pollo"),Sn("createdAt","desc")))).forEach(we=>Oe.push({id:we.id,name:we.data().name||""}));I(Oe);const Ie={};Oe.forEach(me=>{Ie[me.id]=me.name});const[We,Z,Qe]=await Promise.all([Ht(sr(Ct(Ce,"salesV2"),Sn("timestamp","desc"))),Ht(sr(Ct(Ce,"daily_closures"),Sn("createdAt","desc"))),Ht(sr(Ct(Ce,"ar_movements_pollo"),cr("date",">=",x),cr("date","<=",y)))]),at=new Map;Qe.forEach(me=>{var bt;const we=me.data(),pt=String(((bt=we==null?void 0:we.ref)==null?void 0:bt.saleId)||"").trim(),vt=String((we==null?void 0:we.customerId)||"").trim();pt&&vt&&at.set(pt,vt)});const Ge=new Map;Z.forEach(me=>{const we=me.data(),pt=Array.isArray(we==null?void 0:we.salesV2)?we.salesV2:[];for(const vt of pt){const bt=String((vt==null?void 0:vt.id)||"").trim();if(!bt)continue;const kt=bt.split("#")[0];(String((vt==null?void 0:vt.status)||"").toUpperCase()==="PROCESADA"||vt!=null&&vt.closureDate||vt!=null&&vt.processedDate)&&Ge.set(kt,{closureDate:vt==null?void 0:vt.closureDate,processedDate:vt==null?void 0:vt.processedDate})}});const ie=[];We.forEach(me=>{const we=me.data(),pt=Ge.get(me.id),vt=at.get(me.id);!we.customerId&&vt&&(we.customerId=vt),!we.customerName&&vt&&(we.customerName=Ie[vt]||""),pt&&(we.status="PROCESADA",!we.closureDate&&pt.closureDate&&(we.closureDate=pt.closureDate),!we.processedDate&&pt.processedDate&&(we.processedDate=pt.processedDate));const bt=Vit(we,me.id);bt&&ie.push(bt)});const xe=ie.sort((me,we)=>we.date.localeCompare(me.date));C(xe);const de=av(x),Me=av(y);E(Array.from(new Set(xe.filter(me=>{const we=hW(me);return!(!isFinite(we)||isFinite(de)&&we<de||isFinite(Me)&&we>Me)}).map(me=>{var we,pt,vt,bt;return((we=me._raw)==null?void 0:we.productName)||((bt=(vt=(pt=me._raw)==null?void 0:pt.items)==null?void 0:vt[0])==null?void 0:bt.productName)||"(sin producto)"}))).sort()),D(1)}catch(Oe){console.error(Oe),P(" Error cargando transacciones.")}finally{k(!1)}})()},[x,y,G]);const te=g.useMemo(()=>{const Oe=av(x),Ie=av(y);return j.filter(We=>{const Z=hW(We);return!(!isFinite(Z)||isFinite(Oe)&&Z<Oe||isFinite(Ie)&&Z>Ie)})},[j,x,y]),be=g.useMemo(()=>te.filter(Oe=>{var Ie,We,Z,Qe;if(ue&&Oe.customerId!==ue||Ae&&Oe.type!==Ae)return!1;if(_e&&_e!=="ALL"){const at=((Ie=Oe._raw)==null?void 0:Ie.productName)||((Qe=(Z=(We=Oe._raw)==null?void 0:We.items)==null?void 0:Z[0])==null?void 0:Qe.productName)||"";if(!at||at!==_e)return!1}return!(O&&UT(Oe._raw)!==O)}),[te,ue,Ae,_e,O]),U=g.useMemo(()=>{let Oe=0,Ie=0,We=0,Z=0;for(const Ge of be){const ie=Qit(Ge._raw);Ge.type==="CONTADO"?(Oe+=ie,We+=Ge.total):(Ie+=ie,Z+=Ge.total)}const Qe=Oe+Ie,at=We+Z;return{packsCash:Oe,packsCredito:Ie,packsTotal:Qe,montoCash:We,montoCredito:Z,montoTotal:at}},[be]),Xe=g.useMemo(()=>{let Oe=0,Ie=0;for(const Z of be)Z.type==="CONTADO"?Oe+=Z.quantity:Ie+=Z.quantity;const We=Oe+Ie;return{unidadesCash:Oe,unidadesCredito:Ie,unidadesTotal:We}},[be]),se=Math.max(1,Math.ceil(be.length/X)),ee=g.useMemo(()=>{const Oe=(Y-1)*X;return be.slice(Oe,Oe+X)},[be,Y]),[Fe,je]=g.useState(!1),[Se,Ze]=g.useState(!1),[ut,Et]=g.useState(!1),St=g.useMemo(()=>{const Oe=new Map;return ee.forEach(Ie=>{var Qe,at,Ge,ie;const We=((Qe=Ie._raw)==null?void 0:Qe.productName)||((ie=(Ge=(at=Ie._raw)==null?void 0:at.items)==null?void 0:Ge[0])==null?void 0:ie.productName)||"(sin producto)";Oe.has(We)||Oe.set(We,{cash:[],credit:[]});const Z=Oe.get(We);Ie.type==="CONTADO"?Z.cash.push(Ie):Z.credit.push(Ie)}),Array.from(Oe.entries()).sort((Ie,We)=>Ie[0].localeCompare(We[0]))},[ee]);g.useMemo(()=>f&&j.find(Oe=>Oe.id===f)||null,[f,j]);const Ft=async Oe=>{if(s&&(R(null),!!window.confirm("Eliminar esta venta? Se restaurar el inventario asociado.")))try{k(!0),await zre(Oe.id),await Hit(Oe.id),C(Ie=>Ie.filter(We=>We.id!==Oe.id)),P(" Venta eliminada")}catch(Ie){console.error(Ie),P(" No se pudo eliminar la venta.")}finally{k(!1)}},Qt=()=>{const Oe=`Ventas del dia  ${x} a ${y}`,Ie=at=>(at||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),We=be.map(at=>{var ie,xe,de,Me;const Ge=LT(at,Q);return(ie=at._raw)!=null&&ie.productName||(Me=(de=(xe=at._raw)==null?void 0:xe.items)==null?void 0:de[0])!=null&&Me.productName,`<tr>
          <td>${at.date}</td>
          <td>${Ie(Ge)}</td>
          <td>${at.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${at.quantity}</td>
          <td style="text-align:right">${cd(at.total)}</td>
        </tr>`}).join(""),Z=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Ie(Oe)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Ie(Oe)}</h1>
      <div class="kpis">

      
        <div><b>Unidades Cash:</b> ${_0(Xe.unidadesCash)}</div>
        <div><b>Unidades Crdito:</b> ${_0(Xe.unidadesCredito)}</div>
        <div><b>Total Unidades:</b> ${_0(Xe.unidadesTotal)}</div>
      </div>

      <div class="kpis">
        <div><b>Libras Cash:</b> ${U.packsCash}</div>
        <div><b>Libras Crdito:</b> ${U.packsCredito}</div>
        <div><b>Ventas Cash:</b> ${cd(U.montoCash)}</div>
        <div><b>Ventas Crdito:</b> ${cd(U.montoCredito)}</div>
      </div>

      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Libras</th><th>Ventas</th>
      </tr></thead><tbody>
      ${We||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Qe=window.open("","_blank");Qe&&(Qe.document.open(),Qe.document.write(Z),Qe.document.close())},Ut=()=>D(1),Tt=()=>D(Oe=>Math.max(1,Oe-1)),Re=()=>D(Oe=>Math.min(se,Oe+1)),Te=()=>D(se),Ye=()=>{const Oe=[];if(se<=7)for(let We=1;We<=se;We++)Oe.push(We);else{const We=Math.max(1,Y-2),Z=Math.min(se,Y+2);Oe.push(1),We>2&&Oe.push(-1);for(let Qe=We;Qe<=Z;Qe++)Qe!==1&&Qe!==se&&Oe.push(Qe);Z<se-1&&Oe.push(-2),Oe.push(se)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ut,disabled:Y===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Tt,disabled:Y===1,children:" Anterior"}),Oe.map((We,Z)=>typeof We=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${We===Y?"bg-blue-600 text-white":""}`,onClick:()=>D(We),children:We},Z):i.jsx("span",{className:"px-2",children:""},Z)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Re,disabled:Y===se,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Te,disabled:Y===se,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Y," de ",se,"  ",be.length," transaccin(es)"]})]})},ht=Oe=>{var Qe,at,Ge,ie,xe;const Ie=LT(Oe,Q);let We="(sin producto)";Array.isArray((Qe=Oe._raw)==null?void 0:Qe.items)&&Oe._raw.items.length>0?We=Oe._raw.items.map(de=>de.productName||de.product||de.name||"(sin nombre)").join(", "):(at=Oe._raw)!=null&&at.productName?We=Oe._raw.productName:(xe=(ie=(Ge=Oe._raw)==null?void 0:Ge.items)==null?void 0:ie[0])!=null&&xe.productName&&(We=Oe._raw.items[0].productName);const Z=UT(Oe._raw);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Ie}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:Oe.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:`px-2 py-1 rounded-full border ${Z==="PROCESADA"?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700"}`,children:Z}),i.jsx("span",{className:`px-2 py-1 rounded-full border ${Oe.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:Oe.type==="CREDITO"?"Crdito":"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Libras:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:de=>{de.preventDefault(),p(Oe.id)},title:"Ver detalle",children:_0(Oe.quantity)})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",cd(Oe.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Ie})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Producto"}),i.jsx("span",{className:"font-medium text-right",children:We})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:Oe.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Estado"}),i.jsx("span",{className:"font-medium",children:Z})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:Oe.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Libras"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(Oe.id),title:"Ver detalle",children:_0(Oe.quantity)})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:cd(Oe.total)})]}),i.jsx("div",{className:"flex items-center justify-between",children:s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2 w-full",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>R(de=>de===Oe.id?null:Oe.id),children:" Acciones"}),K===Oe.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Ft(Oe),children:"Eliminar"})]})})]})})]})},Oe.id)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>je(Oe=>!Oe),"aria-expanded":Fe,children:[i.jsx("span",{children:"Filtros de bsqueda"}),i.jsx("span",{className:`transition-transform ${Fe?"rotate-180":""}`,children:""})]}),Fe&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-7 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:Oe=>{v(Oe.target.value),D(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:Oe=>{b(Oe.target.value),D(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ue,onChange:Oe=>{le(Oe.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(Oe=>i.jsx("option",{value:Oe.id,children:Oe.name},Oe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Ae,onChange:Oe=>{ae(Oe.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:_e,onChange:Oe=>{De(Oe.target.value),D(1)},children:[i.jsx("option",{value:"ALL",children:"Todos"}),S.map(Oe=>i.jsx("option",{value:Oe,children:Oe},Oe))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:O,onChange:Oe=>{H(Oe.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"FLOTANTE",children:"FLOTANTE"}),i.jsx("option",{value:"PROCESADA",children:"PROCESADA"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Qt,children:"Exportar PDF"}),i.jsx("div",{className:"sm:col-span-2 lg:col-span-1 flex",children:i.jsx(Mc,{onClick:ce,loading:B,className:"w-full justify-center"})})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ze(Oe=>!Oe),"aria-expanded":Se,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${Se?"rotate-180":""}`,children:""})]}),Se&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:_0(U.packsCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:_0(U.packsCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:cd(U.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:cd(U.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Total"}),i.jsx("div",{className:"text-xl font-semibold",children:cd(U.montoTotal)})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Et(Oe=>!Oe),"aria-expanded":ut,children:[i.jsx("span",{children:"Transacciones"}),i.jsx("span",{className:`transition-transform ${ut?"rotate-180":""}`,children:""})]}),ut&&i.jsxs("div",{className:"p-3 border-t space-y-4",children:[i.jsxs("div",{className:"block md:hidden space-y-3",children:[B?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):ee.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):St.map(([Oe,Ie])=>i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"font-semibold",children:["Categora: ",Oe]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ie.cash.length+Ie.credit.length," transaccin(es)"]})]}),i.jsxs("div",{className:"p-3 pt-0 space-y-3",children:[i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Cash"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ie.cash.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:Ie.cash.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):Ie.cash.map(ht)})]})}),i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Crdito"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ie.credit.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:Ie.credit.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):Ie.credit.map(ht)})]})})]})]})},Oe)),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:Ye()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):ee.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):ee.map(Oe=>{var Qe,at,Ge,ie,xe;const Ie=LT(Oe,Q);let We="(sin producto)";Array.isArray((Qe=Oe._raw)==null?void 0:Qe.items)&&Oe._raw.items.length>0?We=Oe._raw.items.map(de=>de.productName||de.product||de.name||"(sin nombre)").join(", "):(at=Oe._raw)!=null&&at.productName?We=Oe._raw.productName:(xe=(ie=(Ge=Oe._raw)==null?void 0:Ge.items)==null?void 0:ie[0])!=null&&xe.productName&&(We=Oe._raw.items[0].productName);const Z=UT(Oe._raw);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Oe.date}),i.jsx("td",{className:"p-2 border",children:Z}),i.jsx("td",{className:"p-2 border",children:Ie}),i.jsx("td",{className:"p-2 border",children:We}),i.jsx("td",{className:"p-2 border",children:Oe.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(Oe.id),children:_0(Oe.quantity)})}),i.jsx("td",{className:"p-2 border",children:cd(Oe.total)}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>R(de=>de===Oe.id?null:Oe.id),title:"Acciones",children:""}),K===Oe.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Ft(Oe),children:"Eliminar"})})]})]},Oe.id)})})]}),Ye()]})]})]}),T&&i.jsx("p",{className:"mt-2 text-sm",children:T}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{children:i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," ",f?` #${f}`:""]})}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Libras"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((Oe,Ie)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Oe.productName}),i.jsx("td",{className:"p-2 border text-right",children:Oe.qty}),i.jsx("td",{className:"p-2 border text-right",children:cd(Oe.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:cd(Oe.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:cd(Oe.total)})]},Ie))})]})})]})})]})}function Git(){const[t,e]=g.useState(!1);return g.useEffect(()=>{var a;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(a=r.addEventListener)==null||a.call(r,"change",n),()=>{var s;return(s=r.removeEventListener)==null?void 0:s.call(r,"change",n)}},[]),t}function Kit(){const[t,e]=g.useState(null),[r,n]=g.useState(""),[a,s]=g.useState([]),[o,l]=g.useState(""),[c,u]=g.useState(!0),d=Git(),f=g.useMemo(()=>d?i.jsx(dbe,{role:r,roles:a}):i.jsx(ube,{role:r,roles:a}),[d,r,a]),A=(t==null?void 0:t.email)||"";if(g.useEffect(()=>{const m=bI(ic,async p=>{if(u(!0),p){e(p);try{const x=Yt(Ce,"users",p.uid),v=await gs(x);if(v.exists()){const y=v.data(),b=Array.isArray(y.roles)?y.roles:y.role?[y.role]:[],w=y.sellerCandyId||"";s(b),n(b[0]||""),l(w||"")}else n(""),s([]),l("")}catch{n(""),l("")}}else e(null),n(""),l("");u(!1)});return()=>m()},[]),c)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const h=()=>{const m=a&&a.length?a:r;return En(m,"admin")?i.jsx(Mh,{to:"financialDashboard",replace:!0}):En(m,"vendedor_pollo")?i.jsx(Mh,{to:"salesV2",replace:!0}):En(m,"supervisor_pollo")?i.jsx(Mh,{to:"batches",replace:!0}):En(m,"contador")?i.jsx(Mh,{to:"batches",replace:!0}):En(m,"vendedor_ropa")?i.jsx(Mh,{to:"salesClothes",replace:!0}):En(m,"vendedor_dulces")?i.jsx(Mh,{to:"salesCandies",replace:!0}):i.jsx(Mh,{to:"/",replace:!0})};return i.jsx(H0e,{children:i.jsxs(y0e,{children:[i.jsx(Mn,{path:"/",element:i.jsx(ibe,{})}),i.jsxs(Mn,{path:"/admin",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"],children:f}),children:[i.jsx(Mn,{index:!0,element:i.jsx(h,{})}),i.jsx(Mn,{path:"bills",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(RPe,{role:r,roles:a})})}),i.jsx(Mn,{path:"salesV2",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(rH,{user:t})})}),i.jsx(Mn,{path:"financialDashboard",element:i.jsx(qn,{allowedRoles:["admin","contador","supervisor_pollo"],children:i.jsx(O3e,{})})}),i.jsx(Mn,{path:"expenses",element:i.jsx(qn,{allowedRoles:["admin","contador"],children:i.jsx(R3e,{})})}),i.jsx(Mn,{path:"polloCashAudits",element:i.jsx(qn,{allowedRoles:["admin","contador"],children:i.jsx(Z8e,{})})}),i.jsx(Mn,{path:"transactionsPollo",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx($it,{role:r,roles:a})})}),i.jsx(Mn,{path:"batches",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(B3e,{role:r,roles:a})})}),i.jsx(Mn,{path:"paidBatches",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx($3e,{})})}),i.jsx(Mn,{path:"fix",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(U3e,{})})}),i.jsx(Mn,{path:"billing",element:i.jsx(qn,{allowedRoles:["admin","contador"],children:i.jsx(tLe,{})})}),i.jsx(Mn,{path:"transactionclose",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(k3e,{})})}),i.jsx(Mn,{path:"billhistoric",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(MPe,{})})}),i.jsx(Mn,{path:"users",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(LPe,{})})}),i.jsx(Mn,{path:"products",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(UPe,{})})}),i.jsx(Mn,{path:"customersPollo",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(kLe,{role:r,roles:a,currentUserEmail:A,sellerPolloId:o})})}),i.jsx(Mn,{path:"datacenter",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(IVe,{})})}),i.jsx(Mn,{path:"productsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(IQe,{})})}),i.jsx(Mn,{path:"mainordersCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(fVe,{})})}),i.jsx(Mn,{path:"productsPricesCandies",element:i.jsx(qn,{roles:a,allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Dit,{})})}),i.jsx(Mn,{path:"inventoryMainOrderCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(hVe,{})})}),i.jsx(Mn,{path:"inventoryCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(DQe,{})})}),i.jsx(Mn,{path:"billingsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(NVe,{})})}),i.jsx(Mn,{path:"cashDeliveries",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(Bit,{})})}),i.jsx(Mn,{path:"customersCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(RQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"salesCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(HQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"expensesCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx($Qe,{})})}),i.jsx(Mn,{path:"dashboardCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(ZQe,{})})}),i.jsx(Mn,{path:"transactionCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(zQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"vendorsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(eVe,{})})}),i.jsx(Mn,{path:"productsVendorsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(oVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"cierreVentasCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(pVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"reporteCierresCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(_Ve,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"consolidatedVendors",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(bVe,{})})}),i.jsx(Mn,{path:"salesClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(bLe,{})})}),i.jsx(Mn,{path:"notebooksInventory",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Lit,{})})}),i.jsx(Mn,{path:"TransactionsReportClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(TLe,{})})}),i.jsx(Mn,{path:"financialDashboardClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(CLe,{})})}),i.jsx(Mn,{path:"ExpensesClothes",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(_Le,{})})}),i.jsx(Mn,{path:"inventoryClothesBatches",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(sLe,{})})}),i.jsx(Mn,{path:"productsClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(pLe,{})})}),i.jsx(Mn,{path:"CustomersClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(xLe,{})})})]}),i.jsx(Mn,{path:"/salesV2",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","contador"],children:i.jsx(rH,{user:t})})}),i.jsx(Mn,{path:"*",element:i.jsx(Mh,{to:"/"})})]})})}sbe.then(t=>{console.info("Auth persistence mode:",t)}).catch(()=>{}).finally(()=>{QT.createRoot(document.getElementById("root")).render(i.jsx(oi.StrictMode,{children:i.jsx(Kit,{})}))});export{ts as _,zit as c,TA as g};
