var X7=Object.defineProperty;var Y7=(t,e,r)=>e in t?X7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var bn=(t,e,r)=>Y7(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var V1e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I3={exports:{}},Oy={},F3={exports:{}},Jr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ax=Symbol.for("react.element"),eV=Symbol.for("react.portal"),tV=Symbol.for("react.fragment"),rV=Symbol.for("react.strict_mode"),nV=Symbol.for("react.profiler"),sV=Symbol.for("react.provider"),aV=Symbol.for("react.context"),iV=Symbol.for("react.forward_ref"),oV=Symbol.for("react.suspense"),lV=Symbol.for("react.memo"),cV=Symbol.for("react.lazy"),B5=Symbol.iterator;function AV(t){return t===null||typeof t!="object"?null:(t=B5&&t[B5]||t["@@iterator"],typeof t=="function"?t:null)}var k3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T3=Object.assign,j3={};function q0(t,e,r){this.props=t,this.context=e,this.refs=j3,this.updater=r||k3}q0.prototype.isReactComponent={};q0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};q0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function P3(){}P3.prototype=q0.prototype;function OE(t,e,r){this.props=t,this.context=e,this.refs=j3,this.updater=r||k3}var ME=OE.prototype=new P3;ME.constructor=OE;T3(ME,q0.prototype);ME.isPureReactComponent=!0;var S5=Array.isArray,R3=Object.prototype.hasOwnProperty,QE={current:null},D3={key:!0,ref:!0,__self:!0,__source:!0};function L3(t,e,r){var n,s={},a=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)R3.call(e,n)&&!D3.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),A=0;A<l;A++)c[A]=arguments[A+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Ax,type:t,key:a,ref:o,props:s,_owner:QE.current}}function uV(t,e){return{$$typeof:Ax,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function VE(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ax}function dV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var I5=/\/+/g;function gb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dV(""+t.key):e.toString(36)}function M1(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ax:case eV:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+gb(o,0):n,S5(s)?(r="",t!=null&&(r=t.replace(I5,"$&/")+"/"),M1(s,e,r,"",function(A){return A})):s!=null&&(VE(s)&&(s=uV(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(I5,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",S5(t))for(var l=0;l<t.length;l++){a=t[l];var c=n+gb(a,l);o+=M1(a,e,r,c,s)}else if(c=AV(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=n+gb(a,l++),o+=M1(a,e,r,c,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Av(t,e,r){if(t==null)return t;var n=[],s=0;return M1(t,n,"","",function(a){return e.call(r,a,s++)}),n}function hV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ri={current:null},Q1={transition:null},fV={ReactCurrentDispatcher:Ri,ReactCurrentBatchConfig:Q1,ReactCurrentOwner:QE};function U3(){throw Error("act(...) is not supported in production builds of React.")}Jr.Children={map:Av,forEach:function(t,e,r){Av(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Av(t,function(){e++}),e},toArray:function(t){return Av(t,function(e){return e})||[]},only:function(t){if(!VE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Jr.Component=q0;Jr.Fragment=tV;Jr.Profiler=nV;Jr.PureComponent=OE;Jr.StrictMode=rV;Jr.Suspense=oV;Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fV;Jr.act=U3;Jr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=T3({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=QE.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)R3.call(e,c)&&!D3.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var A=0;A<c;A++)l[A]=arguments[A+2];n.children=l}return{$$typeof:Ax,type:t.type,key:s,ref:a,props:n,_owner:o}};Jr.createContext=function(t){return t={$$typeof:aV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sV,_context:t},t.Consumer=t};Jr.createElement=L3;Jr.createFactory=function(t){var e=L3.bind(null,t);return e.type=t,e};Jr.createRef=function(){return{current:null}};Jr.forwardRef=function(t){return{$$typeof:iV,render:t}};Jr.isValidElement=VE;Jr.lazy=function(t){return{$$typeof:cV,_payload:{_status:-1,_result:t},_init:hV}};Jr.memo=function(t,e){return{$$typeof:lV,type:t,compare:e===void 0?null:e}};Jr.startTransition=function(t){var e=Q1.transition;Q1.transition={};try{t()}finally{Q1.transition=e}};Jr.unstable_act=U3;Jr.useCallback=function(t,e){return Ri.current.useCallback(t,e)};Jr.useContext=function(t){return Ri.current.useContext(t)};Jr.useDebugValue=function(){};Jr.useDeferredValue=function(t){return Ri.current.useDeferredValue(t)};Jr.useEffect=function(t,e){return Ri.current.useEffect(t,e)};Jr.useId=function(){return Ri.current.useId()};Jr.useImperativeHandle=function(t,e,r){return Ri.current.useImperativeHandle(t,e,r)};Jr.useInsertionEffect=function(t,e){return Ri.current.useInsertionEffect(t,e)};Jr.useLayoutEffect=function(t,e){return Ri.current.useLayoutEffect(t,e)};Jr.useMemo=function(t,e){return Ri.current.useMemo(t,e)};Jr.useReducer=function(t,e,r){return Ri.current.useReducer(t,e,r)};Jr.useRef=function(t){return Ri.current.useRef(t)};Jr.useState=function(t){return Ri.current.useState(t)};Jr.useSyncExternalStore=function(t,e,r){return Ri.current.useSyncExternalStore(t,e,r)};Jr.useTransition=function(){return Ri.current.useTransition()};Jr.version="18.3.1";F3.exports=Jr;var N=F3.exports;const ci=Z7(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mV=N,pV=Symbol.for("react.element"),gV=Symbol.for("react.fragment"),xV=Object.prototype.hasOwnProperty,vV=mV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wV={key:!0,ref:!0,__self:!0,__source:!0};function O3(t,e,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)xV.call(e,n)&&!wV.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:pV,type:t,key:a,ref:o,props:s,_owner:vV.current}}Oy.Fragment=gV;Oy.jsx=O3;Oy.jsxs=O3;I3.exports=Oy;var i=I3.exports,wC={},M3={exports:{}},jo={},Q3={exports:{}},V3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(de,re){var xe=de.length;de.push(re);e:for(;0<xe;){var Ce=xe-1>>>1,S=de[Ce];if(0<s(S,re))de[Ce]=re,de[xe]=S,xe=Ce;else break e}}function r(de){return de.length===0?null:de[0]}function n(de){if(de.length===0)return null;var re=de[0],xe=de.pop();if(xe!==re){de[0]=xe;e:for(var Ce=0,S=de.length,I=S>>>1;Ce<I;){var V=2*(Ce+1)-1,j=de[V],O=V+1,W=de[O];if(0>s(j,xe))O<S&&0>s(W,j)?(de[Ce]=W,de[O]=xe,Ce=O):(de[Ce]=j,de[V]=xe,Ce=V);else if(O<S&&0>s(W,xe))de[Ce]=W,de[O]=xe,Ce=O;else break e}}return re}function s(de,re){var xe=de.sortIndex-re.sortIndex;return xe!==0?xe:de.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],A=[],u=1,d=null,f=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(de){for(var re=r(A);re!==null;){if(re.callback===null)n(A);else if(re.startTime<=de)n(A),re.sortIndex=re.expirationTime,e(c,re);else break;re=r(A)}}function F(de){if(p=!1,b(de),!m)if(r(c)!==null)m=!0,ae(P);else{var re=r(A);re!==null&&he(F,re.startTime-de)}}function P(de,re){m=!1,p&&(p=!1,g(B),B=-1),h=!0;var xe=f;try{for(b(re),d=r(c);d!==null&&(!(d.expirationTime>re)||de&&!k());){var Ce=d.callback;if(typeof Ce=="function"){d.callback=null,f=d.priorityLevel;var S=Ce(d.expirationTime<=re);re=t.unstable_now(),typeof S=="function"?d.callback=S:d===r(c)&&n(c),b(re)}else n(c);d=r(c)}if(d!==null)var I=!0;else{var V=r(A);V!==null&&he(F,V.startTime-re),I=!1}return I}finally{d=null,f=xe,h=!1}}var R=!1,_=null,B=-1,E=5,M=-1;function k(){return!(t.unstable_now()-M<E)}function T(){if(_!==null){var de=t.unstable_now();M=de;var re=!0;try{re=_(!0,de)}finally{re?U():(R=!1,_=null)}}else R=!1}var U;if(typeof y=="function")U=function(){y(T)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,pe=Z.port2;Z.port1.onmessage=T,U=function(){pe.postMessage(null)}}else U=function(){x(T,0)};function ae(de){_=de,R||(R=!0,U())}function he(de,re){B=x(function(){de(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(de){de.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ae(P))},t.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<de?Math.floor(1e3/de):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(de){switch(f){case 1:case 2:case 3:var re=3;break;default:re=f}var xe=f;f=re;try{return de()}finally{f=xe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(de,re){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var xe=f;f=de;try{return re()}finally{f=xe}},t.unstable_scheduleCallback=function(de,re,xe){var Ce=t.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?Ce+xe:Ce):xe=Ce,de){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=xe+S,de={id:u++,callback:re,priorityLevel:de,startTime:xe,expirationTime:S,sortIndex:-1},xe>Ce?(de.sortIndex=xe,e(A,de),r(c)===null&&de===r(A)&&(p?(g(B),B=-1):p=!0,he(F,xe-Ce))):(de.sortIndex=S,e(c,de),m||h||(m=!0,ae(P))),de},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(de){var re=f;return function(){var xe=f;f=re;try{return de.apply(this,arguments)}finally{f=xe}}}})(V3);Q3.exports=V3;var yV=Q3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bV=N,Io=yV;function Qt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var H3=new Set,lg={};function Uh(t,e){N0(t,e),N0(t+"Capture",e)}function N0(t,e){for(lg[t]=e,t=0;t<e.length;t++)H3.add(e[t])}var vA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yC=Object.prototype.hasOwnProperty,NV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,F5={},k5={};function CV(t){return yC.call(k5,t)?!0:yC.call(F5,t)?!1:NV.test(t)?k5[t]=!0:(F5[t]=!0,!1)}function _V(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function EV(t,e,r,n){if(e===null||typeof e>"u"||_V(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Di(t,e,r,n,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var za={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){za[t]=new Di(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];za[e]=new Di(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){za[t]=new Di(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){za[t]=new Di(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){za[t]=new Di(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){za[t]=new Di(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){za[t]=new Di(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){za[t]=new Di(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){za[t]=new Di(t,5,!1,t.toLowerCase(),null,!1,!1)});var HE=/[\-:]([a-z])/g;function KE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(HE,KE);za[e]=new Di(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(HE,KE);za[e]=new Di(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(HE,KE);za[e]=new Di(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){za[t]=new Di(t,1,!1,t.toLowerCase(),null,!1,!1)});za.xlinkHref=new Di("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){za[t]=new Di(t,1,!1,t.toLowerCase(),null,!0,!0)});function qE(t,e,r,n){var s=za.hasOwnProperty(e)?za[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EV(e,r,s,n)&&(r=null),n||s===null?CV(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var IA=bV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uv=Symbol.for("react.element"),$f=Symbol.for("react.portal"),zf=Symbol.for("react.fragment"),GE=Symbol.for("react.strict_mode"),bC=Symbol.for("react.profiler"),K3=Symbol.for("react.provider"),q3=Symbol.for("react.context"),$E=Symbol.for("react.forward_ref"),NC=Symbol.for("react.suspense"),CC=Symbol.for("react.suspense_list"),zE=Symbol.for("react.memo"),hu=Symbol.for("react.lazy"),G3=Symbol.for("react.offscreen"),T5=Symbol.iterator;function Tm(t){return t===null||typeof t!="object"?null:(t=T5&&t[T5]||t["@@iterator"],typeof t=="function"?t:null)}var bs=Object.assign,xb;function ap(t){if(xb===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);xb=e&&e[1]||""}return`
`+xb+t}var vb=!1;function wb(t,e){if(!t||vb)return"";vb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(A){var n=A}Reflect.construct(t,[],e)}else{try{e.call()}catch(A){n=A}t.call(e.prototype)}else{try{throw Error()}catch(A){n=A}t()}}catch(A){if(A&&n&&typeof A.stack=="string"){for(var s=A.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{vb=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ap(t):""}function BV(t){switch(t.tag){case 5:return ap(t.type);case 16:return ap("Lazy");case 13:return ap("Suspense");case 19:return ap("SuspenseList");case 0:case 2:case 15:return t=wb(t.type,!1),t;case 11:return t=wb(t.type.render,!1),t;case 1:return t=wb(t.type,!0),t;default:return""}}function _C(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zf:return"Fragment";case $f:return"Portal";case bC:return"Profiler";case GE:return"StrictMode";case NC:return"Suspense";case CC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case q3:return(t.displayName||"Context")+".Consumer";case K3:return(t._context.displayName||"Context")+".Provider";case $E:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zE:return e=t.displayName||null,e!==null?e:_C(t.type)||"Memo";case hu:e=t._payload,t=t._init;try{return _C(t(e))}catch{}}return null}function SV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _C(e);case 8:return e===GE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ju(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function $3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function IV(t){var e=$3(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function dv(t){t._valueTracker||(t._valueTracker=IV(t))}function z3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=$3(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function vw(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function EC(t,e){var r=e.checked;return bs({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function j5(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ju(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function W3(t,e){e=e.checked,e!=null&&qE(t,"checked",e,!1)}function BC(t,e){W3(t,e);var r=Ju(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?SC(t,e.type,r):e.hasOwnProperty("defaultValue")&&SC(t,e.type,Ju(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function P5(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function SC(t,e,r){(e!=="number"||vw(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ip=Array.isArray;function l0(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ju(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function IC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Qt(91));return bs({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function R5(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Qt(92));if(ip(r)){if(1<r.length)throw Error(Qt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ju(r)}}function J3(t,e){var r=Ju(e.value),n=Ju(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function D5(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function X3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function FC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?X3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var hv,Y3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(hv=hv||document.createElement("div"),hv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function cg(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ep={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FV=["Webkit","ms","Moz","O"];Object.keys(Ep).forEach(function(t){FV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ep[e]=Ep[t]})});function Z3(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ep.hasOwnProperty(t)&&Ep[t]?(""+e).trim():e+"px"}function eR(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Z3(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var kV=bs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kC(t,e){if(e){if(kV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Qt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Qt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Qt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Qt(62))}}function TC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jC=null;function WE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var PC=null,c0=null,A0=null;function L5(t){if(t=hx(t)){if(typeof PC!="function")throw Error(Qt(280));var e=t.stateNode;e&&(e=Ky(e),PC(t.stateNode,t.type,e))}}function tR(t){c0?A0?A0.push(t):A0=[t]:c0=t}function rR(){if(c0){var t=c0,e=A0;if(A0=c0=null,L5(t),e)for(t=0;t<e.length;t++)L5(e[t])}}function nR(t,e){return t(e)}function sR(){}var yb=!1;function aR(t,e,r){if(yb)return t(e,r);yb=!0;try{return nR(t,e,r)}finally{yb=!1,(c0!==null||A0!==null)&&(sR(),rR())}}function Ag(t,e){var r=t.stateNode;if(r===null)return null;var n=Ky(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Qt(231,e,typeof r));return r}var RC=!1;if(vA)try{var jm={};Object.defineProperty(jm,"passive",{get:function(){RC=!0}}),window.addEventListener("test",jm,jm),window.removeEventListener("test",jm,jm)}catch{RC=!1}function TV(t,e,r,n,s,a,o,l,c){var A=Array.prototype.slice.call(arguments,3);try{e.apply(r,A)}catch(u){this.onError(u)}}var Bp=!1,ww=null,yw=!1,DC=null,jV={onError:function(t){Bp=!0,ww=t}};function PV(t,e,r,n,s,a,o,l,c){Bp=!1,ww=null,TV.apply(jV,arguments)}function RV(t,e,r,n,s,a,o,l,c){if(PV.apply(this,arguments),Bp){if(Bp){var A=ww;Bp=!1,ww=null}else throw Error(Qt(198));yw||(yw=!0,DC=A)}}function Oh(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function iR(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function U5(t){if(Oh(t)!==t)throw Error(Qt(188))}function DV(t){var e=t.alternate;if(!e){if(e=Oh(t),e===null)throw Error(Qt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return U5(s),t;if(a===n)return U5(s),e;a=a.sibling}throw Error(Qt(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(Qt(189))}}if(r.alternate!==n)throw Error(Qt(190))}if(r.tag!==3)throw Error(Qt(188));return r.stateNode.current===r?t:e}function oR(t){return t=DV(t),t!==null?lR(t):null}function lR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lR(t);if(e!==null)return e;t=t.sibling}return null}var cR=Io.unstable_scheduleCallback,O5=Io.unstable_cancelCallback,LV=Io.unstable_shouldYield,UV=Io.unstable_requestPaint,Ms=Io.unstable_now,OV=Io.unstable_getCurrentPriorityLevel,JE=Io.unstable_ImmediatePriority,AR=Io.unstable_UserBlockingPriority,bw=Io.unstable_NormalPriority,MV=Io.unstable_LowPriority,uR=Io.unstable_IdlePriority,My=null,vc=null;function QV(t){if(vc&&typeof vc.onCommitFiberRoot=="function")try{vc.onCommitFiberRoot(My,t,void 0,(t.current.flags&128)===128)}catch{}}var Rl=Math.clz32?Math.clz32:KV,VV=Math.log,HV=Math.LN2;function KV(t){return t>>>=0,t===0?32:31-(VV(t)/HV|0)|0}var fv=64,mv=4194304;function op(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nw(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=op(l):(a&=o,a!==0&&(n=op(a)))}else o=r&~s,o!==0?n=op(o):a!==0&&(n=op(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Rl(e),s=1<<r,n|=t[r],e&=~s;return n}function qV(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GV(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-Rl(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=qV(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function LC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function dR(){var t=fv;return fv<<=1,!(fv&4194240)&&(fv=64),t}function bb(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ux(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rl(e),t[e]=r}function $V(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Rl(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function XE(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Rl(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var kn=0;function hR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var fR,YE,mR,pR,gR,UC=!1,pv=[],Pu=null,Ru=null,Du=null,ug=new Map,dg=new Map,pu=[],zV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M5(t,e){switch(t){case"focusin":case"focusout":Pu=null;break;case"dragenter":case"dragleave":Ru=null;break;case"mouseover":case"mouseout":Du=null;break;case"pointerover":case"pointerout":ug.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":dg.delete(e.pointerId)}}function Pm(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=hx(e),e!==null&&YE(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function WV(t,e,r,n,s){switch(e){case"focusin":return Pu=Pm(Pu,t,e,r,n,s),!0;case"dragenter":return Ru=Pm(Ru,t,e,r,n,s),!0;case"mouseover":return Du=Pm(Du,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return ug.set(a,Pm(ug.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,dg.set(a,Pm(dg.get(a)||null,t,e,r,n,s)),!0}return!1}function xR(t){var e=Jd(t.target);if(e!==null){var r=Oh(e);if(r!==null){if(e=r.tag,e===13){if(e=iR(r),e!==null){t.blockedOn=e,gR(t.priority,function(){mR(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function V1(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=OC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);jC=n,r.target.dispatchEvent(n),jC=null}else return e=hx(r),e!==null&&YE(e),t.blockedOn=r,!1;e.shift()}return!0}function Q5(t,e,r){V1(t)&&r.delete(e)}function JV(){UC=!1,Pu!==null&&V1(Pu)&&(Pu=null),Ru!==null&&V1(Ru)&&(Ru=null),Du!==null&&V1(Du)&&(Du=null),ug.forEach(Q5),dg.forEach(Q5)}function Rm(t,e){t.blockedOn===e&&(t.blockedOn=null,UC||(UC=!0,Io.unstable_scheduleCallback(Io.unstable_NormalPriority,JV)))}function hg(t){function e(s){return Rm(s,t)}if(0<pv.length){Rm(pv[0],t);for(var r=1;r<pv.length;r++){var n=pv[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Pu!==null&&Rm(Pu,t),Ru!==null&&Rm(Ru,t),Du!==null&&Rm(Du,t),ug.forEach(e),dg.forEach(e),r=0;r<pu.length;r++)n=pu[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<pu.length&&(r=pu[0],r.blockedOn===null);)xR(r),r.blockedOn===null&&pu.shift()}var u0=IA.ReactCurrentBatchConfig,Cw=!0;function XV(t,e,r,n){var s=kn,a=u0.transition;u0.transition=null;try{kn=1,ZE(t,e,r,n)}finally{kn=s,u0.transition=a}}function YV(t,e,r,n){var s=kn,a=u0.transition;u0.transition=null;try{kn=4,ZE(t,e,r,n)}finally{kn=s,u0.transition=a}}function ZE(t,e,r,n){if(Cw){var s=OC(t,e,r,n);if(s===null)Tb(t,e,n,_w,r),M5(t,n);else if(WV(s,t,e,r,n))n.stopPropagation();else if(M5(t,n),e&4&&-1<zV.indexOf(t)){for(;s!==null;){var a=hx(s);if(a!==null&&fR(a),a=OC(t,e,r,n),a===null&&Tb(t,e,n,_w,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Tb(t,e,n,null,r)}}var _w=null;function OC(t,e,r,n){if(_w=null,t=WE(n),t=Jd(t),t!==null)if(e=Oh(t),e===null)t=null;else if(r=e.tag,r===13){if(t=iR(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _w=t,null}function vR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OV()){case JE:return 1;case AR:return 4;case bw:case MV:return 16;case uR:return 536870912;default:return 16}default:return 16}}var _u=null,eB=null,H1=null;function wR(){if(H1)return H1;var t,e=eB,r=e.length,n,s="value"in _u?_u.value:_u.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[a-n];n++);return H1=s.slice(t,1<n?1-n:void 0)}function K1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gv(){return!0}function V5(){return!1}function Po(t){function e(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?gv:V5,this.isPropagationStopped=V5,this}return bs(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=gv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=gv)},persist:function(){},isPersistent:gv}),e}var G0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tB=Po(G0),dx=bs({},G0,{view:0,detail:0}),ZV=Po(dx),Nb,Cb,Dm,Qy=bs({},dx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rB,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Dm&&(Dm&&t.type==="mousemove"?(Nb=t.screenX-Dm.screenX,Cb=t.screenY-Dm.screenY):Cb=Nb=0,Dm=t),Nb)},movementY:function(t){return"movementY"in t?t.movementY:Cb}}),H5=Po(Qy),e9=bs({},Qy,{dataTransfer:0}),t9=Po(e9),r9=bs({},dx,{relatedTarget:0}),_b=Po(r9),n9=bs({},G0,{animationName:0,elapsedTime:0,pseudoElement:0}),s9=Po(n9),a9=bs({},G0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),i9=Po(a9),o9=bs({},G0,{data:0}),K5=Po(o9),l9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},c9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=A9[t])?!!e[t]:!1}function rB(){return u9}var d9=bs({},dx,{key:function(t){if(t.key){var e=l9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=K1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?c9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rB,charCode:function(t){return t.type==="keypress"?K1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?K1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),h9=Po(d9),f9=bs({},Qy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),q5=Po(f9),m9=bs({},dx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rB}),p9=Po(m9),g9=bs({},G0,{propertyName:0,elapsedTime:0,pseudoElement:0}),x9=Po(g9),v9=bs({},Qy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),w9=Po(v9),y9=[9,13,27,32],nB=vA&&"CompositionEvent"in window,Sp=null;vA&&"documentMode"in document&&(Sp=document.documentMode);var b9=vA&&"TextEvent"in window&&!Sp,yR=vA&&(!nB||Sp&&8<Sp&&11>=Sp),G5=" ",$5=!1;function bR(t,e){switch(t){case"keyup":return y9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function NR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wf=!1;function N9(t,e){switch(t){case"compositionend":return NR(e);case"keypress":return e.which!==32?null:($5=!0,G5);case"textInput":return t=e.data,t===G5&&$5?null:t;default:return null}}function C9(t,e){if(Wf)return t==="compositionend"||!nB&&bR(t,e)?(t=wR(),H1=eB=_u=null,Wf=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return yR&&e.locale!=="ko"?null:e.data;default:return null}}var _9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function z5(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_9[t.type]:e==="textarea"}function CR(t,e,r,n){tR(n),e=Ew(e,"onChange"),0<e.length&&(r=new tB("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ip=null,fg=null;function E9(t){RR(t,0)}function Vy(t){var e=Yf(t);if(z3(e))return t}function B9(t,e){if(t==="change")return e}var _R=!1;if(vA){var Eb;if(vA){var Bb="oninput"in document;if(!Bb){var W5=document.createElement("div");W5.setAttribute("oninput","return;"),Bb=typeof W5.oninput=="function"}Eb=Bb}else Eb=!1;_R=Eb&&(!document.documentMode||9<document.documentMode)}function J5(){Ip&&(Ip.detachEvent("onpropertychange",ER),fg=Ip=null)}function ER(t){if(t.propertyName==="value"&&Vy(fg)){var e=[];CR(e,fg,t,WE(t)),aR(E9,e)}}function S9(t,e,r){t==="focusin"?(J5(),Ip=e,fg=r,Ip.attachEvent("onpropertychange",ER)):t==="focusout"&&J5()}function I9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vy(fg)}function F9(t,e){if(t==="click")return Vy(e)}function k9(t,e){if(t==="input"||t==="change")return Vy(e)}function T9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ml=typeof Object.is=="function"?Object.is:T9;function mg(t,e){if(Ml(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!yC.call(e,s)||!Ml(t[s],e[s]))return!1}return!0}function X5(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Y5(t,e){var r=X5(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=X5(r)}}function BR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?BR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function SR(){for(var t=window,e=vw();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=vw(t.document)}return e}function sB(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function j9(t){var e=SR(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&BR(r.ownerDocument.documentElement,r)){if(n!==null&&sB(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=Y5(r,a);var o=Y5(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var P9=vA&&"documentMode"in document&&11>=document.documentMode,Jf=null,MC=null,Fp=null,QC=!1;function Z5(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;QC||Jf==null||Jf!==vw(n)||(n=Jf,"selectionStart"in n&&sB(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fp&&mg(Fp,n)||(Fp=n,n=Ew(MC,"onSelect"),0<n.length&&(e=new tB("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Jf)))}function xv(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Xf={animationend:xv("Animation","AnimationEnd"),animationiteration:xv("Animation","AnimationIteration"),animationstart:xv("Animation","AnimationStart"),transitionend:xv("Transition","TransitionEnd")},Sb={},IR={};vA&&(IR=document.createElement("div").style,"AnimationEvent"in window||(delete Xf.animationend.animation,delete Xf.animationiteration.animation,delete Xf.animationstart.animation),"TransitionEvent"in window||delete Xf.transitionend.transition);function Hy(t){if(Sb[t])return Sb[t];if(!Xf[t])return t;var e=Xf[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in IR)return Sb[t]=e[r];return t}var FR=Hy("animationend"),kR=Hy("animationiteration"),TR=Hy("animationstart"),jR=Hy("transitionend"),PR=new Map,e4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ad(t,e){PR.set(t,e),Uh(e,[t])}for(var Ib=0;Ib<e4.length;Ib++){var Fb=e4[Ib],R9=Fb.toLowerCase(),D9=Fb[0].toUpperCase()+Fb.slice(1);Ad(R9,"on"+D9)}Ad(FR,"onAnimationEnd");Ad(kR,"onAnimationIteration");Ad(TR,"onAnimationStart");Ad("dblclick","onDoubleClick");Ad("focusin","onFocus");Ad("focusout","onBlur");Ad(jR,"onTransitionEnd");N0("onMouseEnter",["mouseout","mouseover"]);N0("onMouseLeave",["mouseout","mouseover"]);N0("onPointerEnter",["pointerout","pointerover"]);N0("onPointerLeave",["pointerout","pointerover"]);Uh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),L9=new Set("cancel close invalid load scroll toggle".split(" ").concat(lp));function t4(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,RV(n,e,void 0,t),t.currentTarget=null}function RR(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,A=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;t4(s,l,A),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,A=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;t4(s,l,A),a=c}}}if(yw)throw t=DC,yw=!1,DC=null,t}function Jn(t,e){var r=e[GC];r===void 0&&(r=e[GC]=new Set);var n=t+"__bubble";r.has(n)||(DR(e,t,2,!1),r.add(n))}function kb(t,e,r){var n=0;e&&(n|=4),DR(r,t,n,e)}var vv="_reactListening"+Math.random().toString(36).slice(2);function pg(t){if(!t[vv]){t[vv]=!0,H3.forEach(function(r){r!=="selectionchange"&&(L9.has(r)||kb(r,!1,t),kb(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[vv]||(e[vv]=!0,kb("selectionchange",!1,e))}}function DR(t,e,r,n){switch(vR(e)){case 1:var s=XV;break;case 4:s=YV;break;default:s=ZE}r=s.bind(null,e,r,t),s=void 0,!RC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Tb(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Jd(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}aR(function(){var A=a,u=WE(r),d=[];e:{var f=PR.get(t);if(f!==void 0){var h=tB,m=t;switch(t){case"keypress":if(K1(r)===0)break e;case"keydown":case"keyup":h=h9;break;case"focusin":m="focus",h=_b;break;case"focusout":m="blur",h=_b;break;case"beforeblur":case"afterblur":h=_b;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=H5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=t9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=p9;break;case FR:case kR:case TR:h=s9;break;case jR:h=x9;break;case"scroll":h=ZV;break;case"wheel":h=w9;break;case"copy":case"cut":case"paste":h=i9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=q5}var p=(e&4)!==0,x=!p&&t==="scroll",g=p?f!==null?f+"Capture":null:f;p=[];for(var y=A,b;y!==null;){b=y;var F=b.stateNode;if(b.tag===5&&F!==null&&(b=F,g!==null&&(F=Ag(y,g),F!=null&&p.push(gg(y,F,b)))),x)break;y=y.return}0<p.length&&(f=new h(f,m,null,r,u),d.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&r!==jC&&(m=r.relatedTarget||r.fromElement)&&(Jd(m)||m[wA]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=A,m=m?Jd(m):null,m!==null&&(x=Oh(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=A),h!==m)){if(p=H5,F="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=q5,F="onPointerLeave",g="onPointerEnter",y="pointer"),x=h==null?f:Yf(h),b=m==null?f:Yf(m),f=new p(F,y+"leave",h,r,u),f.target=x,f.relatedTarget=b,F=null,Jd(u)===A&&(p=new p(g,y+"enter",m,r,u),p.target=b,p.relatedTarget=x,F=p),x=F,h&&m)t:{for(p=h,g=m,y=0,b=p;b;b=ff(b))y++;for(b=0,F=g;F;F=ff(F))b++;for(;0<y-b;)p=ff(p),y--;for(;0<b-y;)g=ff(g),b--;for(;y--;){if(p===g||g!==null&&p===g.alternate)break t;p=ff(p),g=ff(g)}p=null}else p=null;h!==null&&r4(d,f,h,p,!1),m!==null&&x!==null&&r4(d,x,m,p,!0)}}e:{if(f=A?Yf(A):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var P=B9;else if(z5(f))if(_R)P=k9;else{P=I9;var R=S9}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=F9);if(P&&(P=P(t,A))){CR(d,P,r,u);break e}R&&R(t,f,A),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&SC(f,"number",f.value)}switch(R=A?Yf(A):window,t){case"focusin":(z5(R)||R.contentEditable==="true")&&(Jf=R,MC=A,Fp=null);break;case"focusout":Fp=MC=Jf=null;break;case"mousedown":QC=!0;break;case"contextmenu":case"mouseup":case"dragend":QC=!1,Z5(d,r,u);break;case"selectionchange":if(P9)break;case"keydown":case"keyup":Z5(d,r,u)}var _;if(nB)e:{switch(t){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else Wf?bR(t,r)&&(B="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(B="onCompositionStart");B&&(yR&&r.locale!=="ko"&&(Wf||B!=="onCompositionStart"?B==="onCompositionEnd"&&Wf&&(_=wR()):(_u=u,eB="value"in _u?_u.value:_u.textContent,Wf=!0)),R=Ew(A,B),0<R.length&&(B=new K5(B,t,null,r,u),d.push({event:B,listeners:R}),_?B.data=_:(_=NR(r),_!==null&&(B.data=_)))),(_=b9?N9(t,r):C9(t,r))&&(A=Ew(A,"onBeforeInput"),0<A.length&&(u=new K5("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:A}),u.data=_))}RR(d,e)})}function gg(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Ew(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Ag(t,r),a!=null&&n.unshift(gg(t,a,s)),a=Ag(t,e),a!=null&&n.push(gg(t,a,s))),t=t.return}return n}function ff(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function r4(t,e,r,n,s){for(var a=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,A=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&A!==null&&(l=A,s?(c=Ag(r,a),c!=null&&o.unshift(gg(r,c,l))):s||(c=Ag(r,a),c!=null&&o.push(gg(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var U9=/\r\n?/g,O9=/\u0000|\uFFFD/g;function n4(t){return(typeof t=="string"?t:""+t).replace(U9,`
`).replace(O9,"")}function wv(t,e,r){if(e=n4(e),n4(t)!==e&&r)throw Error(Qt(425))}function Bw(){}var VC=null,HC=null;function KC(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var qC=typeof setTimeout=="function"?setTimeout:void 0,M9=typeof clearTimeout=="function"?clearTimeout:void 0,s4=typeof Promise=="function"?Promise:void 0,Q9=typeof queueMicrotask=="function"?queueMicrotask:typeof s4<"u"?function(t){return s4.resolve(null).then(t).catch(V9)}:qC;function V9(t){setTimeout(function(){throw t})}function jb(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),hg(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);hg(e)}function Lu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function a4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var $0=Math.random().toString(36).slice(2),hc="__reactFiber$"+$0,xg="__reactProps$"+$0,wA="__reactContainer$"+$0,GC="__reactEvents$"+$0,H9="__reactListeners$"+$0,K9="__reactHandles$"+$0;function Jd(t){var e=t[hc];if(e)return e;for(var r=t.parentNode;r;){if(e=r[wA]||r[hc]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=a4(t);t!==null;){if(r=t[hc])return r;t=a4(t)}return e}t=r,r=t.parentNode}return null}function hx(t){return t=t[hc]||t[wA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qt(33))}function Ky(t){return t[xg]||null}var $C=[],Zf=-1;function ud(t){return{current:t}}function Zn(t){0>Zf||(t.current=$C[Zf],$C[Zf]=null,Zf--)}function $n(t,e){Zf++,$C[Zf]=t.current,t.current=e}var Xu={},pi=ud(Xu),Xi=ud(!1),ph=Xu;function C0(t,e){var r=t.type.contextTypes;if(!r)return Xu;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Yi(t){return t=t.childContextTypes,t!=null}function Sw(){Zn(Xi),Zn(pi)}function i4(t,e,r){if(pi.current!==Xu)throw Error(Qt(168));$n(pi,e),$n(Xi,r)}function LR(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Qt(108,SV(t)||"Unknown",s));return bs({},r,n)}function Iw(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xu,ph=pi.current,$n(pi,t),$n(Xi,Xi.current),!0}function o4(t,e,r){var n=t.stateNode;if(!n)throw Error(Qt(169));r?(t=LR(t,e,ph),n.__reactInternalMemoizedMergedChildContext=t,Zn(Xi),Zn(pi),$n(pi,t)):Zn(Xi),$n(Xi,r)}var eA=null,qy=!1,Pb=!1;function UR(t){eA===null?eA=[t]:eA.push(t)}function q9(t){qy=!0,UR(t)}function dd(){if(!Pb&&eA!==null){Pb=!0;var t=0,e=kn;try{var r=eA;for(kn=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}eA=null,qy=!1}catch(s){throw eA!==null&&(eA=eA.slice(t+1)),cR(JE,dd),s}finally{kn=e,Pb=!1}}return null}var e0=[],t0=0,Fw=null,kw=0,rl=[],nl=0,gh=null,rA=1,nA="";function Ld(t,e){e0[t0++]=kw,e0[t0++]=Fw,Fw=t,kw=e}function OR(t,e,r){rl[nl++]=rA,rl[nl++]=nA,rl[nl++]=gh,gh=t;var n=rA;t=nA;var s=32-Rl(n)-1;n&=~(1<<s),r+=1;var a=32-Rl(e)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,rA=1<<32-Rl(e)+s|r<<s|n,nA=a+t}else rA=1<<a|r<<s|n,nA=t}function aB(t){t.return!==null&&(Ld(t,1),OR(t,1,0))}function iB(t){for(;t===Fw;)Fw=e0[--t0],e0[t0]=null,kw=e0[--t0],e0[t0]=null;for(;t===gh;)gh=rl[--nl],rl[nl]=null,nA=rl[--nl],rl[nl]=null,rA=rl[--nl],rl[nl]=null}var So=null,_o=null,is=!1,Tl=null;function MR(t,e){var r=al(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function l4(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,So=t,_o=Lu(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,So=t,_o=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=gh!==null?{id:rA,overflow:nA}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=al(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,So=t,_o=null,!0):!1;default:return!1}}function zC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function WC(t){if(is){var e=_o;if(e){var r=e;if(!l4(t,e)){if(zC(t))throw Error(Qt(418));e=Lu(r.nextSibling);var n=So;e&&l4(t,e)?MR(n,r):(t.flags=t.flags&-4097|2,is=!1,So=t)}}else{if(zC(t))throw Error(Qt(418));t.flags=t.flags&-4097|2,is=!1,So=t}}}function c4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;So=t}function yv(t){if(t!==So)return!1;if(!is)return c4(t),is=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!KC(t.type,t.memoizedProps)),e&&(e=_o)){if(zC(t))throw QR(),Error(Qt(418));for(;e;)MR(t,e),e=Lu(e.nextSibling)}if(c4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){_o=Lu(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}_o=null}}else _o=So?Lu(t.stateNode.nextSibling):null;return!0}function QR(){for(var t=_o;t;)t=Lu(t.nextSibling)}function _0(){_o=So=null,is=!1}function oB(t){Tl===null?Tl=[t]:Tl.push(t)}var G9=IA.ReactCurrentBatchConfig;function Lm(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Qt(309));var n=r.stateNode}if(!n)throw Error(Qt(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(Qt(284));if(!r._owner)throw Error(Qt(290,t))}return t}function bv(t,e){throw t=Object.prototype.toString.call(e),Error(Qt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function A4(t){var e=t._init;return e(t._payload)}function VR(t){function e(g,y){if(t){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function r(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function s(g,y){return g=Qu(g,y),g.index=0,g.sibling=null,g}function a(g,y,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=2,y):b):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,y,b,F){return y===null||y.tag!==6?(y=Qb(b,g.mode,F),y.return=g,y):(y=s(y,b),y.return=g,y)}function c(g,y,b,F){var P=b.type;return P===zf?u(g,y,b.props.children,F,b.key):y!==null&&(y.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===hu&&A4(P)===y.type)?(F=s(y,b.props),F.ref=Lm(g,y,b),F.return=g,F):(F=X1(b.type,b.key,b.props,null,g.mode,F),F.ref=Lm(g,y,b),F.return=g,F)}function A(g,y,b,F){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Vb(b,g.mode,F),y.return=g,y):(y=s(y,b.children||[]),y.return=g,y)}function u(g,y,b,F,P){return y===null||y.tag!==7?(y=sh(b,g.mode,F,P),y.return=g,y):(y=s(y,b),y.return=g,y)}function d(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Qb(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case uv:return b=X1(y.type,y.key,y.props,null,g.mode,b),b.ref=Lm(g,null,y),b.return=g,b;case $f:return y=Vb(y,g.mode,b),y.return=g,y;case hu:var F=y._init;return d(g,F(y._payload),b)}if(ip(y)||Tm(y))return y=sh(y,g.mode,b,null),y.return=g,y;bv(g,y)}return null}function f(g,y,b,F){var P=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return P!==null?null:l(g,y,""+b,F);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case uv:return b.key===P?c(g,y,b,F):null;case $f:return b.key===P?A(g,y,b,F):null;case hu:return P=b._init,f(g,y,P(b._payload),F)}if(ip(b)||Tm(b))return P!==null?null:u(g,y,b,F,null);bv(g,b)}return null}function h(g,y,b,F,P){if(typeof F=="string"&&F!==""||typeof F=="number")return g=g.get(b)||null,l(y,g,""+F,P);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case uv:return g=g.get(F.key===null?b:F.key)||null,c(y,g,F,P);case $f:return g=g.get(F.key===null?b:F.key)||null,A(y,g,F,P);case hu:var R=F._init;return h(g,y,b,R(F._payload),P)}if(ip(F)||Tm(F))return g=g.get(b)||null,u(y,g,F,P,null);bv(y,F)}return null}function m(g,y,b,F){for(var P=null,R=null,_=y,B=y=0,E=null;_!==null&&B<b.length;B++){_.index>B?(E=_,_=null):E=_.sibling;var M=f(g,_,b[B],F);if(M===null){_===null&&(_=E);break}t&&_&&M.alternate===null&&e(g,_),y=a(M,y,B),R===null?P=M:R.sibling=M,R=M,_=E}if(B===b.length)return r(g,_),is&&Ld(g,B),P;if(_===null){for(;B<b.length;B++)_=d(g,b[B],F),_!==null&&(y=a(_,y,B),R===null?P=_:R.sibling=_,R=_);return is&&Ld(g,B),P}for(_=n(g,_);B<b.length;B++)E=h(_,g,B,b[B],F),E!==null&&(t&&E.alternate!==null&&_.delete(E.key===null?B:E.key),y=a(E,y,B),R===null?P=E:R.sibling=E,R=E);return t&&_.forEach(function(k){return e(g,k)}),is&&Ld(g,B),P}function p(g,y,b,F){var P=Tm(b);if(typeof P!="function")throw Error(Qt(150));if(b=P.call(b),b==null)throw Error(Qt(151));for(var R=P=null,_=y,B=y=0,E=null,M=b.next();_!==null&&!M.done;B++,M=b.next()){_.index>B?(E=_,_=null):E=_.sibling;var k=f(g,_,M.value,F);if(k===null){_===null&&(_=E);break}t&&_&&k.alternate===null&&e(g,_),y=a(k,y,B),R===null?P=k:R.sibling=k,R=k,_=E}if(M.done)return r(g,_),is&&Ld(g,B),P;if(_===null){for(;!M.done;B++,M=b.next())M=d(g,M.value,F),M!==null&&(y=a(M,y,B),R===null?P=M:R.sibling=M,R=M);return is&&Ld(g,B),P}for(_=n(g,_);!M.done;B++,M=b.next())M=h(_,g,B,M.value,F),M!==null&&(t&&M.alternate!==null&&_.delete(M.key===null?B:M.key),y=a(M,y,B),R===null?P=M:R.sibling=M,R=M);return t&&_.forEach(function(T){return e(g,T)}),is&&Ld(g,B),P}function x(g,y,b,F){if(typeof b=="object"&&b!==null&&b.type===zf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case uv:e:{for(var P=b.key,R=y;R!==null;){if(R.key===P){if(P=b.type,P===zf){if(R.tag===7){r(g,R.sibling),y=s(R,b.props.children),y.return=g,g=y;break e}}else if(R.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===hu&&A4(P)===R.type){r(g,R.sibling),y=s(R,b.props),y.ref=Lm(g,R,b),y.return=g,g=y;break e}r(g,R);break}else e(g,R);R=R.sibling}b.type===zf?(y=sh(b.props.children,g.mode,F,b.key),y.return=g,g=y):(F=X1(b.type,b.key,b.props,null,g.mode,F),F.ref=Lm(g,y,b),F.return=g,g=F)}return o(g);case $f:e:{for(R=b.key;y!==null;){if(y.key===R)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(g,y.sibling),y=s(y,b.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else e(g,y);y=y.sibling}y=Vb(b,g.mode,F),y.return=g,g=y}return o(g);case hu:return R=b._init,x(g,y,R(b._payload),F)}if(ip(b))return m(g,y,b,F);if(Tm(b))return p(g,y,b,F);bv(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(g,y.sibling),y=s(y,b),y.return=g,g=y):(r(g,y),y=Qb(b,g.mode,F),y.return=g,g=y),o(g)):r(g,y)}return x}var E0=VR(!0),HR=VR(!1),Tw=ud(null),jw=null,r0=null,lB=null;function cB(){lB=r0=jw=null}function AB(t){var e=Tw.current;Zn(Tw),t._currentValue=e}function JC(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function d0(t,e){jw=t,lB=r0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wi=!0),t.firstContext=null)}function dl(t){var e=t._currentValue;if(lB!==t)if(t={context:t,memoizedValue:e,next:null},r0===null){if(jw===null)throw Error(Qt(308));r0=t,jw.dependencies={lanes:0,firstContext:t}}else r0=r0.next=t;return e}var Xd=null;function uB(t){Xd===null?Xd=[t]:Xd.push(t)}function KR(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,uB(e)):(r.next=s.next,s.next=r),e.interleaved=r,yA(t,n)}function yA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var fu=!1;function dB(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function cA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Uu(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,cn&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,yA(t,r)}return s=n.interleaved,s===null?(e.next=e,uB(n)):(e.next=s.next,s.next=e),n.interleaved=e,yA(t,r)}function q1(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,XE(t,r)}}function u4(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Pw(t,e,r,n){var s=t.updateQueue;fu=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,A=c.next;c.next=null,o===null?a=A:o.next=A,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=A:l.next=A,u.lastBaseUpdate=c))}if(a!==null){var d=s.baseState;o=0,u=A=c=null,l=a;do{var f=l.lane,h=l.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(f=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(h,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(h,d,f):m,f==null)break e;d=bs({},d,f);break e;case 2:fu=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(A=u=h,c=d):u=u.next=h,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(c=d),s.baseState=c,s.firstBaseUpdate=A,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);vh|=o,t.lanes=o,t.memoizedState=d}}function d4(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Qt(191,s));s.call(n)}}}var fx={},wc=ud(fx),vg=ud(fx),wg=ud(fx);function Yd(t){if(t===fx)throw Error(Qt(174));return t}function hB(t,e){switch($n(wg,e),$n(vg,t),$n(wc,fx),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:FC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=FC(e,t)}Zn(wc),$n(wc,e)}function B0(){Zn(wc),Zn(vg),Zn(wg)}function GR(t){Yd(wg.current);var e=Yd(wc.current),r=FC(e,t.type);e!==r&&($n(vg,t),$n(wc,r))}function fB(t){vg.current===t&&(Zn(wc),Zn(vg))}var xs=ud(0);function Rw(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rb=[];function mB(){for(var t=0;t<Rb.length;t++)Rb[t]._workInProgressVersionPrimary=null;Rb.length=0}var G1=IA.ReactCurrentDispatcher,Db=IA.ReactCurrentBatchConfig,xh=0,ys=null,la=null,Ca=null,Dw=!1,kp=!1,yg=0,$9=0;function Ya(){throw Error(Qt(321))}function pB(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ml(t[r],e[r]))return!1;return!0}function gB(t,e,r,n,s,a){if(xh=a,ys=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,G1.current=t===null||t.memoizedState===null?X9:Y9,t=r(n,s),kp){a=0;do{if(kp=!1,yg=0,25<=a)throw Error(Qt(301));a+=1,Ca=la=null,e.updateQueue=null,G1.current=Z9,t=r(n,s)}while(kp)}if(G1.current=Lw,e=la!==null&&la.next!==null,xh=0,Ca=la=ys=null,Dw=!1,e)throw Error(Qt(300));return t}function xB(){var t=yg!==0;return yg=0,t}function dc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ca===null?ys.memoizedState=Ca=t:Ca=Ca.next=t,Ca}function hl(){if(la===null){var t=ys.alternate;t=t!==null?t.memoizedState:null}else t=la.next;var e=Ca===null?ys.memoizedState:Ca.next;if(e!==null)Ca=e,la=t;else{if(t===null)throw Error(Qt(310));la=t,t={memoizedState:la.memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},Ca===null?ys.memoizedState=Ca=t:Ca=Ca.next=t}return Ca}function bg(t,e){return typeof e=="function"?e(t):e}function Lb(t){var e=hl(),r=e.queue;if(r===null)throw Error(Qt(311));r.lastRenderedReducer=t;var n=la,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,A=a;do{var u=A.lane;if((xh&u)===u)c!==null&&(c=c.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),n=A.hasEagerState?A.eagerState:t(n,A.action);else{var d={lane:u,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};c===null?(l=c=d,o=n):c=c.next=d,ys.lanes|=u,vh|=u}A=A.next}while(A!==null&&A!==a);c===null?o=n:c.next=l,Ml(n,e.memoizedState)||(Wi=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,ys.lanes|=a,vh|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Ub(t){var e=hl(),r=e.queue;if(r===null)throw Error(Qt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);Ml(a,e.memoizedState)||(Wi=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function $R(){}function zR(t,e){var r=ys,n=hl(),s=e(),a=!Ml(n.memoizedState,s);if(a&&(n.memoizedState=s,Wi=!0),n=n.queue,vB(XR.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||Ca!==null&&Ca.memoizedState.tag&1){if(r.flags|=2048,Ng(9,JR.bind(null,r,n,s,e),void 0,null),Ba===null)throw Error(Qt(349));xh&30||WR(r,e,s)}return s}function WR(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ys.updateQueue,e===null?(e={lastEffect:null,stores:null},ys.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function JR(t,e,r,n){e.value=r,e.getSnapshot=n,YR(e)&&ZR(t)}function XR(t,e,r){return r(function(){YR(e)&&ZR(t)})}function YR(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ml(t,r)}catch{return!0}}function ZR(t){var e=yA(t,1);e!==null&&Dl(e,t,1,-1)}function h4(t){var e=dc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bg,lastRenderedState:t},e.queue=t,t=t.dispatch=J9.bind(null,ys,t),[e.memoizedState,t]}function Ng(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ys.updateQueue,e===null?(e={lastEffect:null,stores:null},ys.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function eD(){return hl().memoizedState}function $1(t,e,r,n){var s=dc();ys.flags|=t,s.memoizedState=Ng(1|e,r,void 0,n===void 0?null:n)}function Gy(t,e,r,n){var s=hl();n=n===void 0?null:n;var a=void 0;if(la!==null){var o=la.memoizedState;if(a=o.destroy,n!==null&&pB(n,o.deps)){s.memoizedState=Ng(e,r,a,n);return}}ys.flags|=t,s.memoizedState=Ng(1|e,r,a,n)}function f4(t,e){return $1(8390656,8,t,e)}function vB(t,e){return Gy(2048,8,t,e)}function tD(t,e){return Gy(4,2,t,e)}function rD(t,e){return Gy(4,4,t,e)}function nD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sD(t,e,r){return r=r!=null?r.concat([t]):null,Gy(4,4,nD.bind(null,e,t),r)}function wB(){}function aD(t,e){var r=hl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&pB(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function iD(t,e){var r=hl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&pB(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function oD(t,e,r){return xh&21?(Ml(r,e)||(r=dR(),ys.lanes|=r,vh|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wi=!0),t.memoizedState=r)}function z9(t,e){var r=kn;kn=r!==0&&4>r?r:4,t(!0);var n=Db.transition;Db.transition={};try{t(!1),e()}finally{kn=r,Db.transition=n}}function lD(){return hl().memoizedState}function W9(t,e,r){var n=Mu(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},cD(t))AD(e,r);else if(r=KR(t,e,r,n),r!==null){var s=Ti();Dl(r,t,n,s),uD(r,e,n)}}function J9(t,e,r){var n=Mu(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(cD(t))AD(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,Ml(l,o)){var c=e.interleaved;c===null?(s.next=s,uB(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=KR(t,e,s,n),r!==null&&(s=Ti(),Dl(r,t,n,s),uD(r,e,n))}}function cD(t){var e=t.alternate;return t===ys||e!==null&&e===ys}function AD(t,e){kp=Dw=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function uD(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,XE(t,r)}}var Lw={readContext:dl,useCallback:Ya,useContext:Ya,useEffect:Ya,useImperativeHandle:Ya,useInsertionEffect:Ya,useLayoutEffect:Ya,useMemo:Ya,useReducer:Ya,useRef:Ya,useState:Ya,useDebugValue:Ya,useDeferredValue:Ya,useTransition:Ya,useMutableSource:Ya,useSyncExternalStore:Ya,useId:Ya,unstable_isNewReconciler:!1},X9={readContext:dl,useCallback:function(t,e){return dc().memoizedState=[t,e===void 0?null:e],t},useContext:dl,useEffect:f4,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,$1(4194308,4,nD.bind(null,e,t),r)},useLayoutEffect:function(t,e){return $1(4194308,4,t,e)},useInsertionEffect:function(t,e){return $1(4,2,t,e)},useMemo:function(t,e){var r=dc();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=dc();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=W9.bind(null,ys,t),[n.memoizedState,t]},useRef:function(t){var e=dc();return t={current:t},e.memoizedState=t},useState:h4,useDebugValue:wB,useDeferredValue:function(t){return dc().memoizedState=t},useTransition:function(){var t=h4(!1),e=t[0];return t=z9.bind(null,t[1]),dc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ys,s=dc();if(is){if(r===void 0)throw Error(Qt(407));r=r()}else{if(r=e(),Ba===null)throw Error(Qt(349));xh&30||WR(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,f4(XR.bind(null,n,a,t),[t]),n.flags|=2048,Ng(9,JR.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=dc(),e=Ba.identifierPrefix;if(is){var r=nA,n=rA;r=(n&~(1<<32-Rl(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=yg++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=$9++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Y9={readContext:dl,useCallback:aD,useContext:dl,useEffect:vB,useImperativeHandle:sD,useInsertionEffect:tD,useLayoutEffect:rD,useMemo:iD,useReducer:Lb,useRef:eD,useState:function(){return Lb(bg)},useDebugValue:wB,useDeferredValue:function(t){var e=hl();return oD(e,la.memoizedState,t)},useTransition:function(){var t=Lb(bg)[0],e=hl().memoizedState;return[t,e]},useMutableSource:$R,useSyncExternalStore:zR,useId:lD,unstable_isNewReconciler:!1},Z9={readContext:dl,useCallback:aD,useContext:dl,useEffect:vB,useImperativeHandle:sD,useInsertionEffect:tD,useLayoutEffect:rD,useMemo:iD,useReducer:Ub,useRef:eD,useState:function(){return Ub(bg)},useDebugValue:wB,useDeferredValue:function(t){var e=hl();return la===null?e.memoizedState=t:oD(e,la.memoizedState,t)},useTransition:function(){var t=Ub(bg)[0],e=hl().memoizedState;return[t,e]},useMutableSource:$R,useSyncExternalStore:zR,useId:lD,unstable_isNewReconciler:!1};function Fl(t,e){if(t&&t.defaultProps){e=bs({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function XC(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:bs({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var $y={isMounted:function(t){return(t=t._reactInternals)?Oh(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ti(),s=Mu(t),a=cA(n,s);a.payload=e,r!=null&&(a.callback=r),e=Uu(t,a,s),e!==null&&(Dl(e,t,s,n),q1(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ti(),s=Mu(t),a=cA(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Uu(t,a,s),e!==null&&(Dl(e,t,s,n),q1(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ti(),n=Mu(t),s=cA(r,n);s.tag=2,e!=null&&(s.callback=e),e=Uu(t,s,n),e!==null&&(Dl(e,t,n,r),q1(e,t,n))}};function m4(t,e,r,n,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,o):e.prototype&&e.prototype.isPureReactComponent?!mg(r,n)||!mg(s,a):!0}function dD(t,e,r){var n=!1,s=Xu,a=e.contextType;return typeof a=="object"&&a!==null?a=dl(a):(s=Yi(e)?ph:pi.current,n=e.contextTypes,a=(n=n!=null)?C0(t,s):Xu),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$y,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function p4(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&$y.enqueueReplaceState(e,e.state,null)}function YC(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},dB(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=dl(a):(a=Yi(e)?ph:pi.current,s.context=C0(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(XC(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&$y.enqueueReplaceState(s,s.state,null),Pw(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function S0(t,e){try{var r="",n=e;do r+=BV(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function Ob(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function ZC(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var eH=typeof WeakMap=="function"?WeakMap:Map;function hD(t,e,r){r=cA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ow||(Ow=!0,c_=n),ZC(t,e)},r}function fD(t,e,r){r=cA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){ZC(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){ZC(t,e),typeof n!="function"&&(Ou===null?Ou=new Set([this]):Ou.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function g4(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new eH;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=fH.bind(null,t,e,r),e.then(t,t))}function x4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function v4(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=cA(-1,1),e.tag=2,Uu(r,e,1))),r.lanes|=1),t)}var tH=IA.ReactCurrentOwner,Wi=!1;function Si(t,e,r,n){e.child=t===null?HR(e,null,r,n):E0(e,t.child,r,n)}function w4(t,e,r,n,s){r=r.render;var a=e.ref;return d0(e,s),n=gB(t,e,r,n,a,s),r=xB(),t!==null&&!Wi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bA(t,e,s)):(is&&r&&aB(e),e.flags|=1,Si(t,e,n,s),e.child)}function y4(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!SB(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,mD(t,e,a,n,s)):(t=X1(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:mg,r(o,n)&&t.ref===e.ref)return bA(t,e,s)}return e.flags|=1,t=Qu(a,n),t.ref=e.ref,t.return=e,e.child=t}function mD(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(mg(a,n)&&t.ref===e.ref)if(Wi=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Wi=!0);else return e.lanes=t.lanes,bA(t,e,s)}return e_(t,e,r,n,s)}function pD(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$n(s0,wo),wo|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,$n(s0,wo),wo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,$n(s0,wo),wo|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,$n(s0,wo),wo|=n;return Si(t,e,s,r),e.child}function gD(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function e_(t,e,r,n,s){var a=Yi(r)?ph:pi.current;return a=C0(e,a),d0(e,s),r=gB(t,e,r,n,a,s),n=xB(),t!==null&&!Wi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bA(t,e,s)):(is&&n&&aB(e),e.flags|=1,Si(t,e,r,s),e.child)}function b4(t,e,r,n,s){if(Yi(r)){var a=!0;Iw(e)}else a=!1;if(d0(e,s),e.stateNode===null)z1(t,e),dD(e,r,n),YC(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,A=r.contextType;typeof A=="object"&&A!==null?A=dl(A):(A=Yi(r)?ph:pi.current,A=C0(e,A));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==A)&&p4(e,o,n,A),fu=!1;var f=e.memoizedState;o.state=f,Pw(e,n,o,s),c=e.memoizedState,l!==n||f!==c||Xi.current||fu?(typeof u=="function"&&(XC(e,r,u,n),c=e.memoizedState),(l=fu||m4(e,r,l,n,f,c,A))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=A,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,qR(t,e),l=e.memoizedProps,A=e.type===e.elementType?l:Fl(e.type,l),o.props=A,d=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=dl(c):(c=Yi(r)?ph:pi.current,c=C0(e,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==c)&&p4(e,o,n,c),fu=!1,f=e.memoizedState,o.state=f,Pw(e,n,o,s);var m=e.memoizedState;l!==d||f!==m||Xi.current||fu?(typeof h=="function"&&(XC(e,r,h,n),m=e.memoizedState),(A=fu||m4(e,r,A,n,f,m,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=A):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return t_(t,e,r,n,a,s)}function t_(t,e,r,n,s,a){gD(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&o4(e,r,!1),bA(t,e,a);n=e.stateNode,tH.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=E0(e,t.child,null,a),e.child=E0(e,null,l,a)):Si(t,e,l,a),e.memoizedState=n.state,s&&o4(e,r,!0),e.child}function xD(t){var e=t.stateNode;e.pendingContext?i4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&i4(t,e.context,!1),hB(t,e.containerInfo)}function N4(t,e,r,n,s){return _0(),oB(s),e.flags|=256,Si(t,e,r,n),e.child}var r_={dehydrated:null,treeContext:null,retryLane:0};function n_(t){return{baseLanes:t,cachePool:null,transitions:null}}function vD(t,e,r){var n=e.pendingProps,s=xs.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),$n(xs,s&1),t===null)return WC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,a?(n=e.mode,a=e.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Jy(o,n,0,null),t=sh(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=n_(r),e.memoizedState=r_,t):yB(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return rH(t,e,o,n,l,s,r);if(a){a=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Qu(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=Qu(l,a):(a=sh(a,o,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,o=t.child.memoizedState,o=o===null?n_(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~r,e.memoizedState=r_,n}return a=t.child,t=a.sibling,n=Qu(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function yB(t,e){return e=Jy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Nv(t,e,r,n){return n!==null&&oB(n),E0(e,t.child,null,r),t=yB(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rH(t,e,r,n,s,a,o){if(r)return e.flags&256?(e.flags&=-257,n=Ob(Error(Qt(422))),Nv(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=Jy({mode:"visible",children:n.children},s,0,null),a=sh(a,s,o,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&E0(e,t.child,null,o),e.child.memoizedState=n_(o),e.memoizedState=r_,a);if(!(e.mode&1))return Nv(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(Qt(419)),n=Ob(a,n,void 0),Nv(t,e,o,n)}if(l=(o&t.childLanes)!==0,Wi||l){if(n=Ba,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,yA(t,s),Dl(n,t,s,-1))}return BB(),n=Ob(Error(Qt(421))),Nv(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=mH.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,_o=Lu(s.nextSibling),So=e,is=!0,Tl=null,t!==null&&(rl[nl++]=rA,rl[nl++]=nA,rl[nl++]=gh,rA=t.id,nA=t.overflow,gh=e),e=yB(e,n.children),e.flags|=4096,e)}function C4(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),JC(t.return,e,r)}function Mb(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function wD(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Si(t,e,n.children,r),n=xs.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&C4(t,r,e);else if(t.tag===19)C4(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if($n(xs,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Rw(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Mb(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Rw(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Mb(e,!0,r,null,a);break;case"together":Mb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function z1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),vh|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Qt(153));if(e.child!==null){for(t=e.child,r=Qu(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Qu(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function nH(t,e,r){switch(e.tag){case 3:xD(e),_0();break;case 5:GR(e);break;case 1:Yi(e.type)&&Iw(e);break;case 4:hB(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;$n(Tw,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?($n(xs,xs.current&1),e.flags|=128,null):r&e.child.childLanes?vD(t,e,r):($n(xs,xs.current&1),t=bA(t,e,r),t!==null?t.sibling:null);$n(xs,xs.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return wD(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),$n(xs,xs.current),n)break;return null;case 22:case 23:return e.lanes=0,pD(t,e,r)}return bA(t,e,r)}var yD,s_,bD,ND;yD=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};s_=function(){};bD=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Yd(wc.current);var a=null;switch(r){case"input":s=EC(t,s),n=EC(t,n),a=[];break;case"select":s=bs({},s,{value:void 0}),n=bs({},n,{value:void 0}),a=[];break;case"textarea":s=IC(t,s),n=IC(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Bw)}kC(r,n);var o;r=null;for(A in s)if(!n.hasOwnProperty(A)&&s.hasOwnProperty(A)&&s[A]!=null)if(A==="style"){var l=s[A];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(lg.hasOwnProperty(A)?a||(a=[]):(a=a||[]).push(A,null));for(A in n){var c=n[A];if(l=s!=null?s[A]:void 0,n.hasOwnProperty(A)&&c!==l&&(c!=null||l!=null))if(A==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(A,r)),r=c;else A==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(A,c)):A==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(A,""+c):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(lg.hasOwnProperty(A)?(c!=null&&A==="onScroll"&&Jn("scroll",t),a||l===c||(a=[])):(a=a||[]).push(A,c))}r&&(a=a||[]).push("style",r);var A=a;(e.updateQueue=A)&&(e.flags|=4)}};ND=function(t,e,r,n){r!==n&&(e.flags|=4)};function Um(t,e){if(!is)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Za(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function sH(t,e,r){var n=e.pendingProps;switch(iB(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Za(e),null;case 1:return Yi(e.type)&&Sw(),Za(e),null;case 3:return n=e.stateNode,B0(),Zn(Xi),Zn(pi),mB(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(yv(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tl!==null&&(d_(Tl),Tl=null))),s_(t,e),Za(e),null;case 5:fB(e);var s=Yd(wg.current);if(r=e.type,t!==null&&e.stateNode!=null)bD(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Qt(166));return Za(e),null}if(t=Yd(wc.current),yv(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[hc]=e,n[xg]=a,t=(e.mode&1)!==0,r){case"dialog":Jn("cancel",n),Jn("close",n);break;case"iframe":case"object":case"embed":Jn("load",n);break;case"video":case"audio":for(s=0;s<lp.length;s++)Jn(lp[s],n);break;case"source":Jn("error",n);break;case"img":case"image":case"link":Jn("error",n),Jn("load",n);break;case"details":Jn("toggle",n);break;case"input":j5(n,a),Jn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Jn("invalid",n);break;case"textarea":R5(n,a),Jn("invalid",n)}kC(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&wv(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&wv(n.textContent,l,t),s=["children",""+l]):lg.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Jn("scroll",n)}switch(r){case"input":dv(n),P5(n,a,!0);break;case"textarea":dv(n),D5(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Bw)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=X3(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[hc]=e,t[xg]=n,yD(t,e,!1,!1),e.stateNode=t;e:{switch(o=TC(r,n),r){case"dialog":Jn("cancel",t),Jn("close",t),s=n;break;case"iframe":case"object":case"embed":Jn("load",t),s=n;break;case"video":case"audio":for(s=0;s<lp.length;s++)Jn(lp[s],t);s=n;break;case"source":Jn("error",t),s=n;break;case"img":case"image":case"link":Jn("error",t),Jn("load",t),s=n;break;case"details":Jn("toggle",t),s=n;break;case"input":j5(t,n),s=EC(t,n),Jn("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=bs({},n,{value:void 0}),Jn("invalid",t);break;case"textarea":R5(t,n),s=IC(t,n),Jn("invalid",t);break;default:s=n}kC(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?eR(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Y3(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&cg(t,c):typeof c=="number"&&cg(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(lg.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Jn("scroll",t):c!=null&&qE(t,a,c,o))}switch(r){case"input":dv(t),P5(t,n,!1);break;case"textarea":dv(t),D5(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ju(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?l0(t,!!n.multiple,a,!1):n.defaultValue!=null&&l0(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Bw)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Za(e),null;case 6:if(t&&e.stateNode!=null)ND(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Qt(166));if(r=Yd(wg.current),Yd(wc.current),yv(e)){if(n=e.stateNode,r=e.memoizedProps,n[hc]=e,(a=n.nodeValue!==r)&&(t=So,t!==null))switch(t.tag){case 3:wv(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wv(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[hc]=e,e.stateNode=n}return Za(e),null;case 13:if(Zn(xs),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(is&&_o!==null&&e.mode&1&&!(e.flags&128))QR(),_0(),e.flags|=98560,a=!1;else if(a=yv(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(Qt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Qt(317));a[hc]=e}else _0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Za(e),a=!1}else Tl!==null&&(d_(Tl),Tl=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||xs.current&1?da===0&&(da=3):BB())),e.updateQueue!==null&&(e.flags|=4),Za(e),null);case 4:return B0(),s_(t,e),t===null&&pg(e.stateNode.containerInfo),Za(e),null;case 10:return AB(e.type._context),Za(e),null;case 17:return Yi(e.type)&&Sw(),Za(e),null;case 19:if(Zn(xs),a=e.memoizedState,a===null)return Za(e),null;if(n=(e.flags&128)!==0,o=a.rendering,o===null)if(n)Um(a,!1);else{if(da!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Rw(t),o!==null){for(e.flags|=128,Um(a,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return $n(xs,xs.current&1|2),e.child}t=t.sibling}a.tail!==null&&Ms()>I0&&(e.flags|=128,n=!0,Um(a,!1),e.lanes=4194304)}else{if(!n)if(t=Rw(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Um(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!is)return Za(e),null}else 2*Ms()-a.renderingStartTime>I0&&r!==1073741824&&(e.flags|=128,n=!0,Um(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(r=a.last,r!==null?r.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Ms(),e.sibling=null,r=xs.current,$n(xs,n?r&1|2:r&1),e):(Za(e),null);case 22:case 23:return EB(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?wo&1073741824&&(Za(e),e.subtreeFlags&6&&(e.flags|=8192)):Za(e),null;case 24:return null;case 25:return null}throw Error(Qt(156,e.tag))}function aH(t,e){switch(iB(e),e.tag){case 1:return Yi(e.type)&&Sw(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return B0(),Zn(Xi),Zn(pi),mB(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return fB(e),null;case 13:if(Zn(xs),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Qt(340));_0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Zn(xs),null;case 4:return B0(),null;case 10:return AB(e.type._context),null;case 22:case 23:return EB(),null;case 24:return null;default:return null}}var Cv=!1,di=!1,iH=typeof WeakSet=="function"?WeakSet:Set,ar=null;function n0(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ss(t,e,n)}else r.current=null}function a_(t,e,r){try{r()}catch(n){Ss(t,e,n)}}var _4=!1;function oH(t,e){if(VC=Cw,t=SR(),sB(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,A=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==r||s!==0&&d.nodeType!==3||(l=o+s),d!==a||n!==0&&d.nodeType!==3||(c=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===r&&++A===s&&(l=o),f===a&&++u===n&&(c=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(HC={focusedElem:t,selectionRange:r},Cw=!1,ar=e;ar!==null;)if(e=ar,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ar=t;else for(;ar!==null;){e=ar;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:Fl(e.type,p),x);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qt(163))}}catch(F){Ss(e,e.return,F)}if(t=e.sibling,t!==null){t.return=e.return,ar=t;break}ar=e.return}return m=_4,_4=!1,m}function Tp(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&a_(e,r,a)}s=s.next}while(s!==n)}}function zy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function i_(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function CD(t){var e=t.alternate;e!==null&&(t.alternate=null,CD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[hc],delete e[xg],delete e[GC],delete e[H9],delete e[K9])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function _D(t){return t.tag===5||t.tag===3||t.tag===4}function E4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||_D(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function o_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Bw));else if(n!==4&&(t=t.child,t!==null))for(o_(t,e,r),t=t.sibling;t!==null;)o_(t,e,r),t=t.sibling}function l_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(l_(t,e,r),t=t.sibling;t!==null;)l_(t,e,r),t=t.sibling}var Ua=null,kl=!1;function eu(t,e,r){for(r=r.child;r!==null;)ED(t,e,r),r=r.sibling}function ED(t,e,r){if(vc&&typeof vc.onCommitFiberUnmount=="function")try{vc.onCommitFiberUnmount(My,r)}catch{}switch(r.tag){case 5:di||n0(r,e);case 6:var n=Ua,s=kl;Ua=null,eu(t,e,r),Ua=n,kl=s,Ua!==null&&(kl?(t=Ua,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Ua.removeChild(r.stateNode));break;case 18:Ua!==null&&(kl?(t=Ua,r=r.stateNode,t.nodeType===8?jb(t.parentNode,r):t.nodeType===1&&jb(t,r),hg(t)):jb(Ua,r.stateNode));break;case 4:n=Ua,s=kl,Ua=r.stateNode.containerInfo,kl=!0,eu(t,e,r),Ua=n,kl=s;break;case 0:case 11:case 14:case 15:if(!di&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&a_(r,e,o),s=s.next}while(s!==n)}eu(t,e,r);break;case 1:if(!di&&(n0(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ss(r,e,l)}eu(t,e,r);break;case 21:eu(t,e,r);break;case 22:r.mode&1?(di=(n=di)||r.memoizedState!==null,eu(t,e,r),di=n):eu(t,e,r);break;default:eu(t,e,r)}}function B4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new iH),e.forEach(function(n){var s=pH.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Nl(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ua=l.stateNode,kl=!1;break e;case 3:Ua=l.stateNode.containerInfo,kl=!0;break e;case 4:Ua=l.stateNode.containerInfo,kl=!0;break e}l=l.return}if(Ua===null)throw Error(Qt(160));ED(a,o,s),Ua=null,kl=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(A){Ss(s,e,A)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BD(e,t),e=e.sibling}function BD(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Nl(e,t),sc(t),n&4){try{Tp(3,t,t.return),zy(3,t)}catch(p){Ss(t,t.return,p)}try{Tp(5,t,t.return)}catch(p){Ss(t,t.return,p)}}break;case 1:Nl(e,t),sc(t),n&512&&r!==null&&n0(r,r.return);break;case 5:if(Nl(e,t),sc(t),n&512&&r!==null&&n0(r,r.return),t.flags&32){var s=t.stateNode;try{cg(s,"")}catch(p){Ss(t,t.return,p)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=r!==null?r.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&W3(s,a),TC(l,o);var A=TC(l,a);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?eR(s,d):u==="dangerouslySetInnerHTML"?Y3(s,d):u==="children"?cg(s,d):qE(s,u,d,A)}switch(l){case"input":BC(s,a);break;case"textarea":J3(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?l0(s,!!a.multiple,h,!1):f!==!!a.multiple&&(a.defaultValue!=null?l0(s,!!a.multiple,a.defaultValue,!0):l0(s,!!a.multiple,a.multiple?[]:"",!1))}s[xg]=a}catch(p){Ss(t,t.return,p)}}break;case 6:if(Nl(e,t),sc(t),n&4){if(t.stateNode===null)throw Error(Qt(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(p){Ss(t,t.return,p)}}break;case 3:if(Nl(e,t),sc(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{hg(e.containerInfo)}catch(p){Ss(t,t.return,p)}break;case 4:Nl(e,t),sc(t);break;case 13:Nl(e,t),sc(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(CB=Ms())),n&4&&B4(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(di=(A=di)||u,Nl(e,t),di=A):Nl(e,t),sc(t),n&8192){if(A=t.memoizedState!==null,(t.stateNode.isHidden=A)&&!u&&t.mode&1)for(ar=t,u=t.child;u!==null;){for(d=ar=u;ar!==null;){switch(f=ar,h=f.child,f.tag){case 0:case 11:case 14:case 15:Tp(4,f,f.return);break;case 1:n0(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Ss(n,r,p)}}break;case 5:n0(f,f.return);break;case 22:if(f.memoizedState!==null){I4(d);continue}}h!==null?(h.return=f,ar=h):I4(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,A?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Z3("display",o))}catch(p){Ss(t,t.return,p)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=A?"":d.memoizedProps}catch(p){Ss(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Nl(e,t),sc(t),n&4&&B4(t);break;case 21:break;default:Nl(e,t),sc(t)}}function sc(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(_D(r)){var n=r;break e}r=r.return}throw Error(Qt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(cg(s,""),n.flags&=-33);var a=E4(t);l_(t,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=E4(t);o_(t,l,o);break;default:throw Error(Qt(161))}}catch(c){Ss(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function lH(t,e,r){ar=t,SD(t)}function SD(t,e,r){for(var n=(t.mode&1)!==0;ar!==null;){var s=ar,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Cv;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||di;l=Cv;var A=di;if(Cv=o,(di=c)&&!A)for(ar=s;ar!==null;)o=ar,c=o.child,o.tag===22&&o.memoizedState!==null?F4(s):c!==null?(c.return=o,ar=c):F4(s);for(;a!==null;)ar=a,SD(a),a=a.sibling;ar=s,Cv=l,di=A}S4(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,ar=a):S4(t)}}function S4(t){for(;ar!==null;){var e=ar;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:di||zy(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!di)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Fl(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&d4(e,a,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}d4(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var A=e.alternate;if(A!==null){var u=A.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&hg(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qt(163))}di||e.flags&512&&i_(e)}catch(f){Ss(e,e.return,f)}}if(e===t){ar=null;break}if(r=e.sibling,r!==null){r.return=e.return,ar=r;break}ar=e.return}}function I4(t){for(;ar!==null;){var e=ar;if(e===t){ar=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ar=r;break}ar=e.return}}function F4(t){for(;ar!==null;){var e=ar;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{zy(4,e)}catch(c){Ss(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Ss(e,s,c)}}var a=e.return;try{i_(e)}catch(c){Ss(e,a,c)}break;case 5:var o=e.return;try{i_(e)}catch(c){Ss(e,o,c)}}}catch(c){Ss(e,e.return,c)}if(e===t){ar=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ar=l;break}ar=e.return}}var cH=Math.ceil,Uw=IA.ReactCurrentDispatcher,bB=IA.ReactCurrentOwner,cl=IA.ReactCurrentBatchConfig,cn=0,Ba=null,Zs=null,$a=0,wo=0,s0=ud(0),da=0,Cg=null,vh=0,Wy=0,NB=0,jp=null,zi=null,CB=0,I0=1/0,Zc=null,Ow=!1,c_=null,Ou=null,_v=!1,Eu=null,Mw=0,Pp=0,A_=null,W1=-1,J1=0;function Ti(){return cn&6?Ms():W1!==-1?W1:W1=Ms()}function Mu(t){return t.mode&1?cn&2&&$a!==0?$a&-$a:G9.transition!==null?(J1===0&&(J1=dR()),J1):(t=kn,t!==0||(t=window.event,t=t===void 0?16:vR(t.type)),t):1}function Dl(t,e,r,n){if(50<Pp)throw Pp=0,A_=null,Error(Qt(185));ux(t,r,n),(!(cn&2)||t!==Ba)&&(t===Ba&&(!(cn&2)&&(Wy|=r),da===4&&gu(t,$a)),Zi(t,n),r===1&&cn===0&&!(e.mode&1)&&(I0=Ms()+500,qy&&dd()))}function Zi(t,e){var r=t.callbackNode;GV(t,e);var n=Nw(t,t===Ba?$a:0);if(n===0)r!==null&&O5(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&O5(r),e===1)t.tag===0?q9(k4.bind(null,t)):UR(k4.bind(null,t)),Q9(function(){!(cn&6)&&dd()}),r=null;else{switch(hR(n)){case 1:r=JE;break;case 4:r=AR;break;case 16:r=bw;break;case 536870912:r=uR;break;default:r=bw}r=DD(r,ID.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function ID(t,e){if(W1=-1,J1=0,cn&6)throw Error(Qt(327));var r=t.callbackNode;if(h0()&&t.callbackNode!==r)return null;var n=Nw(t,t===Ba?$a:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Qw(t,n);else{e=n;var s=cn;cn|=2;var a=kD();(Ba!==t||$a!==e)&&(Zc=null,I0=Ms()+500,nh(t,e));do try{dH();break}catch(l){FD(t,l)}while(!0);cB(),Uw.current=a,cn=s,Zs!==null?e=0:(Ba=null,$a=0,e=da)}if(e!==0){if(e===2&&(s=LC(t),s!==0&&(n=s,e=u_(t,s))),e===1)throw r=Cg,nh(t,0),gu(t,n),Zi(t,Ms()),r;if(e===6)gu(t,n);else{if(s=t.current.alternate,!(n&30)&&!AH(s)&&(e=Qw(t,n),e===2&&(a=LC(t),a!==0&&(n=a,e=u_(t,a))),e===1))throw r=Cg,nh(t,0),gu(t,n),Zi(t,Ms()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Qt(345));case 2:Ud(t,zi,Zc);break;case 3:if(gu(t,n),(n&130023424)===n&&(e=CB+500-Ms(),10<e)){if(Nw(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Ti(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=qC(Ud.bind(null,t,zi,Zc),e);break}Ud(t,zi,Zc);break;case 4:if(gu(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-Rl(n);a=1<<o,o=e[o],o>s&&(s=o),n&=~a}if(n=s,n=Ms()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*cH(n/1960))-n,10<n){t.timeoutHandle=qC(Ud.bind(null,t,zi,Zc),n);break}Ud(t,zi,Zc);break;case 5:Ud(t,zi,Zc);break;default:throw Error(Qt(329))}}}return Zi(t,Ms()),t.callbackNode===r?ID.bind(null,t):null}function u_(t,e){var r=jp;return t.current.memoizedState.isDehydrated&&(nh(t,e).flags|=256),t=Qw(t,e),t!==2&&(e=zi,zi=r,e!==null&&d_(e)),t}function d_(t){zi===null?zi=t:zi.push.apply(zi,t)}function AH(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Ml(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gu(t,e){for(e&=~NB,e&=~Wy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Rl(e),n=1<<r;t[r]=-1,e&=~n}}function k4(t){if(cn&6)throw Error(Qt(327));h0();var e=Nw(t,0);if(!(e&1))return Zi(t,Ms()),null;var r=Qw(t,e);if(t.tag!==0&&r===2){var n=LC(t);n!==0&&(e=n,r=u_(t,n))}if(r===1)throw r=Cg,nh(t,0),gu(t,e),Zi(t,Ms()),r;if(r===6)throw Error(Qt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ud(t,zi,Zc),Zi(t,Ms()),null}function _B(t,e){var r=cn;cn|=1;try{return t(e)}finally{cn=r,cn===0&&(I0=Ms()+500,qy&&dd())}}function wh(t){Eu!==null&&Eu.tag===0&&!(cn&6)&&h0();var e=cn;cn|=1;var r=cl.transition,n=kn;try{if(cl.transition=null,kn=1,t)return t()}finally{kn=n,cl.transition=r,cn=e,!(cn&6)&&dd()}}function EB(){wo=s0.current,Zn(s0)}function nh(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,M9(r)),Zs!==null)for(r=Zs.return;r!==null;){var n=r;switch(iB(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Sw();break;case 3:B0(),Zn(Xi),Zn(pi),mB();break;case 5:fB(n);break;case 4:B0();break;case 13:Zn(xs);break;case 19:Zn(xs);break;case 10:AB(n.type._context);break;case 22:case 23:EB()}r=r.return}if(Ba=t,Zs=t=Qu(t.current,null),$a=wo=e,da=0,Cg=null,NB=Wy=vh=0,zi=jp=null,Xd!==null){for(e=0;e<Xd.length;e++)if(r=Xd[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}Xd=null}return t}function FD(t,e){do{var r=Zs;try{if(cB(),G1.current=Lw,Dw){for(var n=ys.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Dw=!1}if(xh=0,Ca=la=ys=null,kp=!1,yg=0,bB.current=null,r===null||r.return===null){da=1,Cg=e,Zs=null;break}e:{var a=t,o=r.return,l=r,c=e;if(e=$a,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var A=c,u=l,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=x4(o);if(h!==null){h.flags&=-257,v4(h,o,l,a,e),h.mode&1&&g4(a,A,e),e=h,c=A;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){g4(a,A,e),BB();break e}c=Error(Qt(426))}}else if(is&&l.mode&1){var x=x4(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),v4(x,o,l,a,e),oB(S0(c,l));break e}}a=c=S0(c,l),da!==4&&(da=2),jp===null?jp=[a]:jp.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var g=hD(a,c,e);u4(a,g);break e;case 1:l=c;var y=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ou===null||!Ou.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e;var F=fD(a,l,e);u4(a,F);break e}}a=a.return}while(a!==null)}jD(r)}catch(P){e=P,Zs===r&&r!==null&&(Zs=r=r.return);continue}break}while(!0)}function kD(){var t=Uw.current;return Uw.current=Lw,t===null?Lw:t}function BB(){(da===0||da===3||da===2)&&(da=4),Ba===null||!(vh&268435455)&&!(Wy&268435455)||gu(Ba,$a)}function Qw(t,e){var r=cn;cn|=2;var n=kD();(Ba!==t||$a!==e)&&(Zc=null,nh(t,e));do try{uH();break}catch(s){FD(t,s)}while(!0);if(cB(),cn=r,Uw.current=n,Zs!==null)throw Error(Qt(261));return Ba=null,$a=0,da}function uH(){for(;Zs!==null;)TD(Zs)}function dH(){for(;Zs!==null&&!LV();)TD(Zs)}function TD(t){var e=RD(t.alternate,t,wo);t.memoizedProps=t.pendingProps,e===null?jD(t):Zs=e,bB.current=null}function jD(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=aH(r,e),r!==null){r.flags&=32767,Zs=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{da=6,Zs=null;return}}else if(r=sH(r,e,wo),r!==null){Zs=r;return}if(e=e.sibling,e!==null){Zs=e;return}Zs=e=t}while(e!==null);da===0&&(da=5)}function Ud(t,e,r){var n=kn,s=cl.transition;try{cl.transition=null,kn=1,hH(t,e,r,n)}finally{cl.transition=s,kn=n}return null}function hH(t,e,r,n){do h0();while(Eu!==null);if(cn&6)throw Error(Qt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Qt(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if($V(t,a),t===Ba&&(Zs=Ba=null,$a=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||_v||(_v=!0,DD(bw,function(){return h0(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=cl.transition,cl.transition=null;var o=kn;kn=1;var l=cn;cn|=4,bB.current=null,oH(t,r),BD(r,t),j9(HC),Cw=!!VC,HC=VC=null,t.current=r,lH(r),UV(),cn=l,kn=o,cl.transition=a}else t.current=r;if(_v&&(_v=!1,Eu=t,Mw=s),a=t.pendingLanes,a===0&&(Ou=null),QV(r.stateNode),Zi(t,Ms()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ow)throw Ow=!1,t=c_,c_=null,t;return Mw&1&&t.tag!==0&&h0(),a=t.pendingLanes,a&1?t===A_?Pp++:(Pp=0,A_=t):Pp=0,dd(),null}function h0(){if(Eu!==null){var t=hR(Mw),e=cl.transition,r=kn;try{if(cl.transition=null,kn=16>t?16:t,Eu===null)var n=!1;else{if(t=Eu,Eu=null,Mw=0,cn&6)throw Error(Qt(331));var s=cn;for(cn|=4,ar=t.current;ar!==null;){var a=ar,o=a.child;if(ar.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var A=l[c];for(ar=A;ar!==null;){var u=ar;switch(u.tag){case 0:case 11:case 15:Tp(8,u,a)}var d=u.child;if(d!==null)d.return=u,ar=d;else for(;ar!==null;){u=ar;var f=u.sibling,h=u.return;if(CD(u),u===A){ar=null;break}if(f!==null){f.return=h,ar=f;break}ar=h}}}var m=a.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}ar=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,ar=o;else e:for(;ar!==null;){if(a=ar,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Tp(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,ar=g;break e}ar=a.return}}var y=t.current;for(ar=y;ar!==null;){o=ar;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ar=b;else e:for(o=y;ar!==null;){if(l=ar,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zy(9,l)}}catch(P){Ss(l,l.return,P)}if(l===o){ar=null;break e}var F=l.sibling;if(F!==null){F.return=l.return,ar=F;break e}ar=l.return}}if(cn=s,dd(),vc&&typeof vc.onPostCommitFiberRoot=="function")try{vc.onPostCommitFiberRoot(My,t)}catch{}n=!0}return n}finally{kn=r,cl.transition=e}}return!1}function T4(t,e,r){e=S0(r,e),e=hD(t,e,1),t=Uu(t,e,1),e=Ti(),t!==null&&(ux(t,1,e),Zi(t,e))}function Ss(t,e,r){if(t.tag===3)T4(t,t,r);else for(;e!==null;){if(e.tag===3){T4(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ou===null||!Ou.has(n))){t=S0(r,t),t=fD(e,t,1),e=Uu(e,t,1),t=Ti(),e!==null&&(ux(e,1,t),Zi(e,t));break}}e=e.return}}function fH(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ti(),t.pingedLanes|=t.suspendedLanes&r,Ba===t&&($a&r)===r&&(da===4||da===3&&($a&130023424)===$a&&500>Ms()-CB?nh(t,0):NB|=r),Zi(t,e)}function PD(t,e){e===0&&(t.mode&1?(e=mv,mv<<=1,!(mv&130023424)&&(mv=4194304)):e=1);var r=Ti();t=yA(t,e),t!==null&&(ux(t,e,r),Zi(t,r))}function mH(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),PD(t,r)}function pH(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Qt(314))}n!==null&&n.delete(e),PD(t,r)}var RD;RD=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xi.current)Wi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Wi=!1,nH(t,e,r);Wi=!!(t.flags&131072)}else Wi=!1,is&&e.flags&1048576&&OR(e,kw,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;z1(t,e),t=e.pendingProps;var s=C0(e,pi.current);d0(e,r),s=gB(null,e,n,t,s,r);var a=xB();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yi(n)?(a=!0,Iw(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,dB(e),s.updater=$y,e.stateNode=s,s._reactInternals=e,YC(e,n,t,r),e=t_(null,e,n,!0,a,r)):(e.tag=0,is&&a&&aB(e),Si(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(z1(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=xH(n),t=Fl(n,t),s){case 0:e=e_(null,e,n,t,r);break e;case 1:e=b4(null,e,n,t,r);break e;case 11:e=w4(null,e,n,t,r);break e;case 14:e=y4(null,e,n,Fl(n.type,t),r);break e}throw Error(Qt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fl(n,s),e_(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fl(n,s),b4(t,e,n,s,r);case 3:e:{if(xD(e),t===null)throw Error(Qt(387));n=e.pendingProps,a=e.memoizedState,s=a.element,qR(t,e),Pw(e,n,null,r);var o=e.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=S0(Error(Qt(423)),e),e=N4(t,e,n,r,s);break e}else if(n!==s){s=S0(Error(Qt(424)),e),e=N4(t,e,n,r,s);break e}else for(_o=Lu(e.stateNode.containerInfo.firstChild),So=e,is=!0,Tl=null,r=HR(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_0(),n===s){e=bA(t,e,r);break e}Si(t,e,n,r)}e=e.child}return e;case 5:return GR(e),t===null&&WC(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,KC(n,s)?o=null:a!==null&&KC(n,a)&&(e.flags|=32),gD(t,e),Si(t,e,o,r),e.child;case 6:return t===null&&WC(e),null;case 13:return vD(t,e,r);case 4:return hB(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=E0(e,null,n,r):Si(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fl(n,s),w4(t,e,n,s,r);case 7:return Si(t,e,e.pendingProps,r),e.child;case 8:return Si(t,e,e.pendingProps.children,r),e.child;case 12:return Si(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,$n(Tw,n._currentValue),n._currentValue=o,a!==null)if(Ml(a.value,o)){if(a.children===s.children&&!Xi.current){e=bA(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=cA(-1,r&-r),c.tag=2;var A=a.updateQueue;if(A!==null){A=A.shared;var u=A.pending;u===null?c.next=c:(c.next=u.next,u.next=c),A.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),JC(a.return,r,e),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Qt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),JC(o,r,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Si(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,d0(e,r),s=dl(s),n=n(s),e.flags|=1,Si(t,e,n,r),e.child;case 14:return n=e.type,s=Fl(n,e.pendingProps),s=Fl(n.type,s),y4(t,e,n,s,r);case 15:return mD(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fl(n,s),z1(t,e),e.tag=1,Yi(n)?(t=!0,Iw(e)):t=!1,d0(e,r),dD(e,n,s),YC(e,n,s,r),t_(null,e,n,!0,t,r);case 19:return wD(t,e,r);case 22:return pD(t,e,r)}throw Error(Qt(156,e.tag))};function DD(t,e){return cR(t,e)}function gH(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function al(t,e,r,n){return new gH(t,e,r,n)}function SB(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xH(t){if(typeof t=="function")return SB(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$E)return 11;if(t===zE)return 14}return 2}function Qu(t,e){var r=t.alternate;return r===null?(r=al(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function X1(t,e,r,n,s,a){var o=2;if(n=t,typeof t=="function")SB(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case zf:return sh(r.children,s,a,e);case GE:o=8,s|=8;break;case bC:return t=al(12,r,e,s|2),t.elementType=bC,t.lanes=a,t;case NC:return t=al(13,r,e,s),t.elementType=NC,t.lanes=a,t;case CC:return t=al(19,r,e,s),t.elementType=CC,t.lanes=a,t;case G3:return Jy(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case K3:o=10;break e;case q3:o=9;break e;case $E:o=11;break e;case zE:o=14;break e;case hu:o=16,n=null;break e}throw Error(Qt(130,t==null?t:typeof t,""))}return e=al(o,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function sh(t,e,r,n){return t=al(7,t,n,e),t.lanes=r,t}function Jy(t,e,r,n){return t=al(22,t,n,e),t.elementType=G3,t.lanes=r,t.stateNode={isHidden:!1},t}function Qb(t,e,r){return t=al(6,t,null,e),t.lanes=r,t}function Vb(t,e,r){return e=al(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function vH(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bb(0),this.expirationTimes=bb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bb(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function IB(t,e,r,n,s,a,o,l,c){return t=new vH(t,e,r,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=al(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},dB(a),t}function wH(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$f,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function LD(t){if(!t)return Xu;t=t._reactInternals;e:{if(Oh(t)!==t||t.tag!==1)throw Error(Qt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Qt(171))}if(t.tag===1){var r=t.type;if(Yi(r))return LR(t,r,e)}return e}function UD(t,e,r,n,s,a,o,l,c){return t=IB(r,n,!0,t,s,a,o,l,c),t.context=LD(null),r=t.current,n=Ti(),s=Mu(r),a=cA(n,s),a.callback=e??null,Uu(r,a,s),t.current.lanes=s,ux(t,s,n),Zi(t,n),t}function Xy(t,e,r,n){var s=e.current,a=Ti(),o=Mu(s);return r=LD(r),e.context===null?e.context=r:e.pendingContext=r,e=cA(a,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Uu(s,e,o),t!==null&&(Dl(t,s,o,a),q1(t,s,o)),o}function Vw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function j4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function FB(t,e){j4(t,e),(t=t.alternate)&&j4(t,e)}function yH(){return null}var OD=typeof reportError=="function"?reportError:function(t){console.error(t)};function kB(t){this._internalRoot=t}Yy.prototype.render=kB.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Qt(409));Xy(t,e,null,null)};Yy.prototype.unmount=kB.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wh(function(){Xy(null,t,null,null)}),e[wA]=null}};function Yy(t){this._internalRoot=t}Yy.prototype.unstable_scheduleHydration=function(t){if(t){var e=pR();t={blockedOn:null,target:t,priority:e};for(var r=0;r<pu.length&&e!==0&&e<pu[r].priority;r++);pu.splice(r,0,t),r===0&&xR(t)}};function TB(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Zy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function P4(){}function bH(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var A=Vw(o);a.call(A)}}var o=UD(e,n,t,0,null,!1,!1,"",P4);return t._reactRootContainer=o,t[wA]=o.current,pg(t.nodeType===8?t.parentNode:t),wh(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var A=Vw(c);l.call(A)}}var c=IB(t,0,!1,null,null,!1,!1,"",P4);return t._reactRootContainer=c,t[wA]=c.current,pg(t.nodeType===8?t.parentNode:t),wh(function(){Xy(e,c,r,n)}),c}function e2(t,e,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=Vw(o);l.call(c)}}Xy(e,o,t,s)}else o=bH(r,e,t,s,n);return Vw(o)}fR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=op(e.pendingLanes);r!==0&&(XE(e,r|1),Zi(e,Ms()),!(cn&6)&&(I0=Ms()+500,dd()))}break;case 13:wh(function(){var n=yA(t,1);if(n!==null){var s=Ti();Dl(n,t,1,s)}}),FB(t,1)}};YE=function(t){if(t.tag===13){var e=yA(t,134217728);if(e!==null){var r=Ti();Dl(e,t,134217728,r)}FB(t,134217728)}};mR=function(t){if(t.tag===13){var e=Mu(t),r=yA(t,e);if(r!==null){var n=Ti();Dl(r,t,e,n)}FB(t,e)}};pR=function(){return kn};gR=function(t,e){var r=kn;try{return kn=t,e()}finally{kn=r}};PC=function(t,e,r){switch(e){case"input":if(BC(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Ky(n);if(!s)throw Error(Qt(90));z3(n),BC(n,s)}}}break;case"textarea":J3(t,r);break;case"select":e=r.value,e!=null&&l0(t,!!r.multiple,e,!1)}};nR=_B;sR=wh;var NH={usingClientEntryPoint:!1,Events:[hx,Yf,Ky,tR,rR,_B]},Om={findFiberByHostInstance:Jd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CH={bundleType:Om.bundleType,version:Om.version,rendererPackageName:Om.rendererPackageName,rendererConfig:Om.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:IA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=oR(t),t===null?null:t.stateNode},findFiberByHostInstance:Om.findFiberByHostInstance||yH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ev=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ev.isDisabled&&Ev.supportsFiber)try{My=Ev.inject(CH),vc=Ev}catch{}}jo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NH;jo.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!TB(e))throw Error(Qt(200));return wH(t,e,null,r)};jo.createRoot=function(t,e){if(!TB(t))throw Error(Qt(299));var r=!1,n="",s=OD;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=IB(t,1,!1,null,null,r,!1,n,s),t[wA]=e.current,pg(t.nodeType===8?t.parentNode:t),new kB(e)};jo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Qt(188)):(t=Object.keys(t).join(","),Error(Qt(268,t)));return t=oR(e),t=t===null?null:t.stateNode,t};jo.flushSync=function(t){return wh(t)};jo.hydrate=function(t,e,r){if(!Zy(e))throw Error(Qt(200));return e2(null,t,e,!0,r)};jo.hydrateRoot=function(t,e,r){if(!TB(t))throw Error(Qt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=OD;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=UD(e,null,t,1,r??null,s,!1,a,o),t[wA]=e.current,pg(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Yy(e)};jo.render=function(t,e,r){if(!Zy(e))throw Error(Qt(200));return e2(null,t,e,!1,r)};jo.unmountComponentAtNode=function(t){if(!Zy(t))throw Error(Qt(40));return t._reactRootContainer?(wh(function(){e2(null,null,t,!1,function(){t._reactRootContainer=null,t[wA]=null})}),!0):!1};jo.unstable_batchedUpdates=_B;jo.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Zy(r))throw Error(Qt(200));if(t==null||t._reactInternals===void 0)throw Error(Qt(38));return e2(t,e,r,!1,n)};jo.version="18.3.1-next-f1338f8080-20240426";function MD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(MD)}catch(t){console.error(t)}}MD(),M3.exports=jo;var Vu=M3.exports,R4=Vu;wC.createRoot=R4.createRoot,wC.hydrateRoot=R4.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var D4="popstate";function _H(t={}){function e(n,s){let{pathname:a,search:o,hash:l}=n.location;return h_("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:_g(s)}return BH(e,r,null,t)}function As(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ql(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function EH(){return Math.random().toString(36).substring(2,10)}function L4(t,e){return{usr:t.state,key:t.key,idx:e}}function h_(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?z0(e):e,state:r,key:e&&e.key||n||EH()}}function _g({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function z0(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function BH(t,e,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",c=null,A=u();A==null&&(A=0,o.replaceState({...o.state,idx:A},""));function u(){return(o.state||{idx:null}).idx}function d(){l="POP";let x=u(),g=x==null?null:x-A;A=x,c&&c({action:l,location:p.location,delta:g})}function f(x,g){l="PUSH";let y=h_(p.location,x,g);A=u()+1;let b=L4(y,A),F=p.createHref(y);try{o.pushState(b,"",F)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(F)}a&&c&&c({action:l,location:p.location,delta:1})}function h(x,g){l="REPLACE";let y=h_(p.location,x,g);A=u();let b=L4(y,A),F=p.createHref(y);o.replaceState(b,"",F),a&&c&&c({action:l,location:p.location,delta:0})}function m(x){return SH(x)}let p={get action(){return l},get location(){return t(s,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(D4,d),c=x,()=>{s.removeEventListener(D4,d),c=null}},createHref(x){return e(s,x)},createURL:m,encodeLocation(x){let g=m(x);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(x){return o.go(x)}};return p}function SH(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),As(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:_g(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function QD(t,e,r="/"){return IH(t,e,r,!1)}function IH(t,e,r,n){let s=typeof e=="string"?z0(e):e,a=NA(s.pathname||"/",r);if(a==null)return null;let o=VD(t);FH(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let A=QH(a);l=OH(o[c],A,n)}return l}function VD(t,e=[],r=[],n="",s=!1){let a=(o,l,c=s,A)=>{let u={relativePath:A===void 0?o.path||"":A,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&c)return;As(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let d=AA([n,u.relativePath]),f=r.concat(u);o.children&&o.children.length>0&&(As(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),VD(o.children,e,f,d,c)),!(o.path==null&&!o.index)&&e.push({path:d,score:LH(d,o.index),routesMeta:f})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let A of HD(o.path))a(o,l,!0,A)}),e}function HD(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=HD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function FH(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:UH(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var kH=/^:[\w-]+$/,TH=3,jH=2,PH=1,RH=10,DH=-2,U4=t=>t==="*";function LH(t,e){let r=t.split("/"),n=r.length;return r.some(U4)&&(n+=DH),e&&(n+=jH),r.filter(s=>!U4(s)).reduce((s,a)=>s+(kH.test(a)?TH:a===""?PH:RH),n)}function UH(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function OH(t,e,r=!1){let{routesMeta:n}=t,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],A=l===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",d=Hw({path:c.relativePath,caseSensitive:c.caseSensitive,end:A},u),f=c.route;if(!d&&A&&r&&!n[n.length-1].route.index&&(d=Hw({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:AA([a,d.pathname]),pathnameBase:qH(AA([a,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(a=AA([a,d.pathnameBase]))}return o}function Hw(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=MH(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((A,{paramName:u,isOptional:d},f)=>{if(u==="*"){let m=l[f]||"";o=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[f];return d&&!h?A[u]=void 0:A[u]=(h||"").replace(/%2F/g,"/"),A},{}),pathname:a,pathnameBase:o,pattern:t}}function MH(t,e=!1,r=!0){Ql(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function QH(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ql(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function NA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function VH(t,e="/"){let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?z0(t):t;return{pathname:r?r.startsWith("/")?r:HH(r,e):e,search:GH(n),hash:$H(s)}}function HH(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Hb(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function KH(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function jB(t){let e=KH(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function PB(t,e,r,n=!1){let s;typeof t=="string"?s=z0(t):(s={...t},As(!s.pathname||!s.pathname.includes("?"),Hb("?","pathname","search",s)),As(!s.pathname||!s.pathname.includes("#"),Hb("#","pathname","hash",s)),As(!s.search||!s.search.includes("#"),Hb("#","search","hash",s)));let a=t===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let d=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}l=d>=0?e[d]:"/"}let c=VH(s,l),A=o&&o!=="/"&&o.endsWith("/"),u=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(A||u)&&(c.pathname+="/"),c}var AA=t=>t.join("/").replace(/\/\/+/g,"/"),qH=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GH=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$H=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function zH(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var KD=["POST","PUT","PATCH","DELETE"];new Set(KD);var WH=["GET",...KD];new Set(WH);var W0=N.createContext(null);W0.displayName="DataRouter";var t2=N.createContext(null);t2.displayName="DataRouterState";N.createContext(!1);var qD=N.createContext({isTransitioning:!1});qD.displayName="ViewTransition";var JH=N.createContext(new Map);JH.displayName="Fetchers";var XH=N.createContext(null);XH.displayName="Await";var ql=N.createContext(null);ql.displayName="Navigation";var mx=N.createContext(null);mx.displayName="Location";var Gl=N.createContext({outlet:null,matches:[],isDataRoute:!1});Gl.displayName="Route";var RB=N.createContext(null);RB.displayName="RouteError";function YH(t,{relative:e}={}){As(J0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=N.useContext(ql),{hash:s,pathname:a,search:o}=gx(t,{relative:e}),l=a;return r!=="/"&&(l=a==="/"?r:AA([r,a])),n.createHref({pathname:l,search:o,hash:s})}function J0(){return N.useContext(mx)!=null}function hd(){return As(J0(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(mx).location}var GD="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $D(t){N.useContext(ql).static||N.useLayoutEffect(t)}function px(){let{isDataRoute:t}=N.useContext(Gl);return t?hK():ZH()}function ZH(){As(J0(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(W0),{basename:e,navigator:r}=N.useContext(ql),{matches:n}=N.useContext(Gl),{pathname:s}=hd(),a=JSON.stringify(jB(n)),o=N.useRef(!1);return $D(()=>{o.current=!0}),N.useCallback((c,A={})=>{if(Ql(o.current,GD),!o.current)return;if(typeof c=="number"){r.go(c);return}let u=PB(c,JSON.parse(a),s,A.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:AA([e,u.pathname])),(A.replace?r.replace:r.push)(u,A.state,A)},[e,r,a,s,t])}var eK=N.createContext(null);function tK(t){let e=N.useContext(Gl).outlet;return e&&N.createElement(eK.Provider,{value:t},e)}function gx(t,{relative:e}={}){let{matches:r}=N.useContext(Gl),{pathname:n}=hd(),s=JSON.stringify(jB(r));return N.useMemo(()=>PB(t,JSON.parse(s),n,e==="path"),[t,s,n,e])}function rK(t,e){return zD(t,e)}function zD(t,e,r,n){var g;As(J0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=N.useContext(ql),{matches:a}=N.useContext(Gl),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",A=o?o.pathnameBase:"/",u=o&&o.route;{let y=u&&u.path||"";WD(c,!u||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let d=hd(),f;if(e){let y=typeof e=="string"?z0(e):e;As(A==="/"||((g=y.pathname)==null?void 0:g.startsWith(A)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${y.pathname}" was given in the \`location\` prop.`),f=y}else f=d;let h=f.pathname||"/",m=h;if(A!=="/"){let y=A.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=QD(t,{pathname:m});Ql(u||p!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Ql(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=oK(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:AA([A,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?A:AA([A,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,r,n);return e&&x?N.createElement(mx.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},x):x}function nK(){let t=dK(),e=zH(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:a},"ErrorBoundary")," or"," ",N.createElement("code",{style:a},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),r?N.createElement("pre",{style:s},r):null,o)}var sK=N.createElement(nK,null),aK=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?N.createElement(Gl.Provider,{value:this.props.routeContext},N.createElement(RB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function iK({routeContext:t,match:e,children:r}){let n=N.useContext(W0);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Gl.Provider,{value:t},r)}function oK(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,a=r==null?void 0:r.errors;if(a!=null){let c=s.findIndex(A=>A.route.id&&(a==null?void 0:a[A.route.id])!==void 0);As(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let A=s[c];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(l=c),A.route.id){let{loaderData:u,errors:d}=r,f=A.route.loader&&!u.hasOwnProperty(A.route.id)&&(!d||d[A.route.id]===void 0);if(A.route.lazy||f){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,A,u)=>{let d,f=!1,h=null,m=null;r&&(d=a&&A.route.id?a[A.route.id]:void 0,h=A.route.errorElement||sK,o&&(l<0&&u===0?(WD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):l===u&&(f=!0,m=A.route.hydrateFallbackElement||null)));let p=e.concat(s.slice(0,u+1)),x=()=>{let g;return d?g=h:f?g=m:A.route.Component?g=N.createElement(A.route.Component,null):A.route.element?g=A.route.element:g=c,N.createElement(iK,{match:A,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:g})};return r&&(A.route.ErrorBoundary||A.route.errorElement||u===0)?N.createElement(aK,{location:r.location,revalidation:r.revalidation,component:h,error:d,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function DB(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lK(t){let e=N.useContext(W0);return As(e,DB(t)),e}function cK(t){let e=N.useContext(t2);return As(e,DB(t)),e}function AK(t){let e=N.useContext(Gl);return As(e,DB(t)),e}function LB(t){let e=AK(t),r=e.matches[e.matches.length-1];return As(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function uK(){return LB("useRouteId")}function dK(){var n;let t=N.useContext(RB),e=cK("useRouteError"),r=LB("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function hK(){let{router:t}=lK("useNavigate"),e=LB("useNavigate"),r=N.useRef(!1);return $D(()=>{r.current=!0}),N.useCallback(async(s,a={})=>{Ql(r.current,GD),r.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...a}))},[t,e])}var O4={};function WD(t,e,r){!e&&!O4[t]&&(O4[t]=!0,Ql(!1,r))}N.memo(fK);function fK({routes:t,future:e,state:r}){return zD(t,void 0,r,e)}function Od({to:t,replace:e,state:r,relative:n}){As(J0(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=N.useContext(ql);Ql(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=N.useContext(Gl),{pathname:o}=hd(),l=px(),c=PB(t,jB(a),o,n==="path"),A=JSON.stringify(c);return N.useEffect(()=>{l(JSON.parse(A),{replace:e,state:r,relative:n})},[l,A,n,e,r]),null}function JD(t){return tK(t.context)}function Or(t){As(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mK({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:s,static:a=!1}){As(!J0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof r=="string"&&(r=z0(r));let{pathname:c="/",search:A="",hash:u="",state:d=null,key:f="default"}=r,h=N.useMemo(()=>{let m=NA(c,o);return m==null?null:{location:{pathname:m,search:A,hash:u,state:d,key:f},navigationType:n}},[o,c,A,u,d,f,n]);return Ql(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${A}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:N.createElement(ql.Provider,{value:l},N.createElement(mx.Provider,{children:e,value:h}))}function pK({children:t,location:e}){return rK(f_(t),e)}function f_(t,e=[]){let r=[];return N.Children.forEach(t,(n,s)=>{if(!N.isValidElement(n))return;let a=[...e,s];if(n.type===N.Fragment){r.push.apply(r,f_(n.props.children,a));return}As(n.type===Or,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),As(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=f_(n.props.children,a)),r.push(o)}),r}var Y1="get",Z1="application/x-www-form-urlencoded";function r2(t){return t!=null&&typeof t.tagName=="string"}function gK(t){return r2(t)&&t.tagName.toLowerCase()==="button"}function xK(t){return r2(t)&&t.tagName.toLowerCase()==="form"}function vK(t){return r2(t)&&t.tagName.toLowerCase()==="input"}function wK(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yK(t,e){return t.button===0&&(!e||e==="_self")&&!wK(t)}var Bv=null;function bK(){if(Bv===null)try{new FormData(document.createElement("form"),0),Bv=!1}catch{Bv=!0}return Bv}var NK=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kb(t){return t!=null&&!NK.has(t)?(Ql(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Z1}"`),null):t}function CK(t,e){let r,n,s,a,o;if(xK(t)){let l=t.getAttribute("action");n=l?NA(l,e):null,r=t.getAttribute("method")||Y1,s=Kb(t.getAttribute("enctype"))||Z1,a=new FormData(t)}else if(gK(t)||vK(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?NA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||Y1,s=Kb(t.getAttribute("formenctype"))||Kb(l.getAttribute("enctype"))||Z1,a=new FormData(l,t),!bK()){let{name:A,type:u,value:d}=t;if(u==="image"){let f=A?`${A}.`:"";a.append(`${f}x`,"0"),a.append(`${f}y`,"0")}else A&&a.append(A,d)}}else{if(r2(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Y1,n=null,s=Z1,o=t}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function UB(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function _K(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&NA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function EK(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function BK(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function SK(t,e,r){let n=await Promise.all(t.map(async s=>{let a=e.routes[s.route.id];if(a){let o=await EK(a,r);return o.links?o.links():[]}return[]}));return TK(n.flat(1).filter(BK).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function M4(t,e,r,n,s,a){let o=(c,A)=>r[A]?c.route.id!==r[A].route.id:!0,l=(c,A)=>{var u;return r[A].pathname!==c.pathname||((u=r[A].route.path)==null?void 0:u.endsWith("*"))&&r[A].params["*"]!==c.params["*"]};return a==="assets"?e.filter((c,A)=>o(c,A)||l(c,A)):a==="data"?e.filter((c,A)=>{var d;let u=n.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,A)||l(c,A))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((d=r[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function IK(t,e,{includeHydrateFallback:r}={}){return FK(t.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function FK(t){return[...new Set(t)]}function kK(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function TK(t,e){let r=new Set;return new Set(e),t.reduce((n,s)=>{let a=JSON.stringify(kK(s));return r.has(a)||(r.add(a),n.push({key:a,link:s})),n},[])}function XD(){let t=N.useContext(W0);return UB(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function jK(){let t=N.useContext(t2);return UB(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var OB=N.createContext(void 0);OB.displayName="FrameworkContext";function YD(){let t=N.useContext(OB);return UB(t,"You must render this element inside a <HydratedRouter> element"),t}function PK(t,e){let r=N.useContext(OB),[n,s]=N.useState(!1),[a,o]=N.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:A,onMouseLeave:u,onTouchStart:d}=e,f=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=g=>{g.forEach(y=>{o(y.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return f.current&&x.observe(f.current),()=>{x.disconnect()}}},[t]),N.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{s(!0)},m=()=>{s(!1),o(!1)};return r?t!=="intent"?[a,f,{}]:[a,f,{onFocus:Mm(l,h),onBlur:Mm(c,m),onMouseEnter:Mm(A,h),onMouseLeave:Mm(u,m),onTouchStart:Mm(d,h)}]:[!1,f,{}]}function Mm(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function RK({page:t,...e}){let{router:r}=XD(),n=N.useMemo(()=>QD(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?N.createElement(LK,{page:t,matches:n,...e}):null}function DK(t){let{manifest:e,routeModules:r}=YD(),[n,s]=N.useState([]);return N.useEffect(()=>{let a=!1;return SK(t,e,r).then(o=>{a||s(o)}),()=>{a=!0}},[t,e,r]),n}function LK({page:t,matches:e,...r}){let n=hd(),{manifest:s,routeModules:a}=YD(),{basename:o}=XD(),{loaderData:l,matches:c}=jK(),A=N.useMemo(()=>M4(t,e,c,s,n,"data"),[t,e,c,s,n]),u=N.useMemo(()=>M4(t,e,c,s,n,"assets"),[t,e,c,s,n]),d=N.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(g=>{var b;let y=s.routes[g.route.id];!y||!y.hasLoader||(!A.some(F=>F.route.id===g.route.id)&&g.route.id in l&&((b=a[g.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(g.route.id))}),m.size===0)return[];let x=_K(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(g=>m.has(g.route.id)).map(g=>g.route.id).join(",")),[x.pathname+x.search]},[o,l,n,s,A,e,t,a]),f=N.useMemo(()=>IK(u,s),[u,s]),h=DK(u);return N.createElement(N.Fragment,null,d.map(m=>N.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),f.map(m=>N.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>N.createElement("link",{key:m,nonce:r.nonce,...p})))}function UK(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var ZD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ZD&&(window.__reactRouterVersion="7.8.1")}catch{}function OK({basename:t,children:e,window:r}){let n=N.useRef();n.current==null&&(n.current=_H({window:r,v5Compat:!0}));let s=n.current,[a,o]=N.useState({action:s.action,location:s.location}),l=N.useCallback(c=>{N.startTransition(()=>o(c))},[o]);return N.useLayoutEffect(()=>s.listen(l),[s,l]),N.createElement(mK,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:s})}var eL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tL=N.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:c,to:A,preventScrollReset:u,viewTransition:d,...f},h){let{basename:m}=N.useContext(ql),p=typeof A=="string"&&eL.test(A),x,g=!1;if(typeof A=="string"&&p&&(x=A,ZD))try{let E=new URL(window.location.href),M=A.startsWith("//")?new URL(E.protocol+A):new URL(A),k=NA(M.pathname,m);M.origin===E.origin&&k!=null?A=k+M.search+M.hash:g=!0}catch{Ql(!1,`<Link to="${A}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=YH(A,{relative:s}),[b,F,P]=PK(n,f),R=VK(A,{replace:o,state:l,target:c,preventScrollReset:u,relative:s,viewTransition:d});function _(E){e&&e(E),E.defaultPrevented||R(E)}let B=N.createElement("a",{...f,...P,href:x||y,onClick:g||a?e:_,ref:UK(h,F),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?N.createElement(N.Fragment,null,B,N.createElement(RK,{page:y})):B});tL.displayName="Link";var _r=N.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:c,...A},u){let d=gx(o,{relative:A.relative}),f=hd(),h=N.useContext(t2),{navigator:m,basename:p}=N.useContext(ql),x=h!=null&&$K(d)&&l===!0,g=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,y=f.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,g=g.toLowerCase()),b&&p&&(b=NA(b,p)||b);const F=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let P=y===g||!s&&y.startsWith(g)&&y.charAt(F)==="/",R=b!=null&&(b===g||!s&&b.startsWith(g)&&b.charAt(g.length)==="/"),_={isActive:P,isPending:R,isTransitioning:x},B=P?e:void 0,E;typeof n=="function"?E=n(_):E=[n,P?"active":null,R?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(_):a;return N.createElement(tL,{...A,"aria-current":B,className:E,ref:u,style:M,to:o,viewTransition:l},typeof c=="function"?c(_):c)});_r.displayName="NavLink";var MK=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:s,state:a,method:o=Y1,action:l,onSubmit:c,relative:A,preventScrollReset:u,viewTransition:d,...f},h)=>{let m=qK(),p=GK(l,{relative:A}),x=o.toLowerCase()==="get"?"get":"post",g=typeof l=="string"&&eL.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let F=b.nativeEvent.submitter,P=(F==null?void 0:F.getAttribute("formmethod"))||o;m(F||b.currentTarget,{fetcherKey:e,method:P,navigate:r,replace:s,state:a,relative:A,preventScrollReset:u,viewTransition:d})};return N.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:y,...f,"data-discover":!g&&t==="render"?"true":void 0})});MK.displayName="Form";function QK(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rL(t){let e=N.useContext(W0);return As(e,QK(t)),e}function VK(t,{target:e,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}={}){let l=px(),c=hd(),A=gx(t,{relative:a});return N.useCallback(u=>{if(yK(u,e)){u.preventDefault();let d=r!==void 0?r:_g(c)===_g(A);l(t,{replace:d,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,A,r,n,e,t,s,a,o])}var HK=0,KK=()=>`__${String(++HK)}__`;function qK(){let{router:t}=rL("useSubmit"),{basename:e}=N.useContext(ql),r=uK();return N.useCallback(async(n,s={})=>{let{action:a,method:o,encType:l,formData:c,body:A}=CK(n,e);if(s.navigate===!1){let u=s.fetcherKey||KK();await t.fetch(u,r,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,r])}function GK(t,{relative:e}={}){let{basename:r}=N.useContext(ql),n=N.useContext(Gl);As(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...gx(t||".",{relative:e})},o=hd();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(u=>u==="")){l.delete("index"),c.filter(d=>d).forEach(d=>l.append("index",d));let u=l.toString();a.search=u?`?${u}`:""}}return(!t||t===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:AA([r,a.pathname])),_g(a)}function $K(t,{relative:e}={}){let r=N.useContext(qD);As(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=rL("useViewTransitionState"),s=gx(t,{relative:e});if(!r.isTransitioning)return!1;let a=NA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=NA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Hw(s.pathname,o)!=null||Hw(s.pathname,a)!=null}var Q4={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nL=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},zK=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],o=t[r++],l=t[r++],c=((s&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},sL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,A=c?t[s+2]:0,u=a>>2,d=(a&3)<<4|l>>4;let f=(l&15)<<2|A>>6,h=A&63;c||(h=64,o||(f=64)),n.push(r[u],r[d],r[f],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(nL(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):zK(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const A=s<t.length?r[t.charAt(s)]:64;++s;const d=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||l==null||A==null||d==null)throw new WK;const f=a<<2|l>>4;if(n.push(f),A!==64){const h=l<<4&240|A>>2;if(n.push(h),d!==64){const m=A<<6&192|d;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WK extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JK=function(t){const e=nL(t);return sL.encodeByteArray(e,!0)},Kw=function(t){return JK(t).replace(/\./g,"")},aL=function(t){try{return sL.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XK(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YK=()=>XK().__FIREBASE_DEFAULTS__,ZK=()=>{if(typeof process>"u"||typeof Q4>"u")return;const t=Q4.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},eq=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&aL(t[1]);return e&&JSON.parse(e)},n2=()=>{try{return YK()||ZK()||eq()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},iL=t=>{var e,r;return(r=(e=n2())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},tq=t=>{const e=iL(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},oL=()=>{var t;return(t=n2())===null||t===void 0?void 0:t.config},lL=t=>{var e;return(e=n2())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nq(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Kw(JSON.stringify(r)),Kw(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sq(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fa())}function aq(){var t;const e=(t=n2())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iq(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oq(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function lq(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cq(){const t=fa();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function cL(){return!aq()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function AL(){try{return typeof indexedDB=="object"}catch{return!1}}function Aq(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uq="FirebaseError";class FA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=uq,Object.setPrototypeOf(this,FA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xx.prototype.create)}}class xx{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?dq(a,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new FA(s,l,n)}}function dq(t,e){return t.replace(hq,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const hq=/\{\$([^}]+)}/g;function fq(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qw(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],o=e[s];if(V4(a)&&V4(o)){if(!qw(a,o))return!1}else if(a!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function V4(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function cp(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function Ap(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function mq(t,e){const r=new pq(t,e);return r.subscribe.bind(r)}class pq{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");gq(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=qb),s.error===void 0&&(s.error=qb),s.complete===void 0&&(s.complete=qb);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gq(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function qb(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(t){return t&&t._delegate?t._delegate:t}class yh{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xq{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new rq;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wq(e))try{this.getOrInitializeService({instanceIdentifier:Md})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=Md){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Md){return this.instances.has(e)}getOptions(e=Md){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(s,a);const o=this.instances.get(s);return o&&e(o,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:vq(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Md){return this.component?this.component.multipleInstances?e:Md:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vq(t){return t===Md?void 0:t}function wq(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yq{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new xq(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(tn||(tn={}));const bq={debug:tn.DEBUG,verbose:tn.VERBOSE,info:tn.INFO,warn:tn.WARN,error:tn.ERROR,silent:tn.SILENT},Nq=tn.INFO,Cq={[tn.DEBUG]:"log",[tn.VERBOSE]:"log",[tn.INFO]:"info",[tn.WARN]:"warn",[tn.ERROR]:"error"},_q=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=Cq[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let MB=class{constructor(e){this.name=e,this._logLevel=Nq,this._logHandler=_q,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tn.DEBUG,...e),this._logHandler(this,tn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tn.VERBOSE,...e),this._logHandler(this,tn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tn.INFO,...e),this._logHandler(this,tn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tn.WARN,...e),this._logHandler(this,tn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tn.ERROR,...e),this._logHandler(this,tn.ERROR,...e)}};const Eq=(t,e)=>e.some(r=>t instanceof r);let H4,K4;function Bq(){return H4||(H4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Sq(){return K4||(K4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const uL=new WeakMap,m_=new WeakMap,dL=new WeakMap,Gb=new WeakMap,QB=new WeakMap;function Iq(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(Hu(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&uL.set(r,t)}).catch(()=>{}),QB.set(e,t),e}function Fq(t){if(m_.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});m_.set(t,e)}let p_={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return m_.get(t);if(e==="objectStoreNames")return t.objectStoreNames||dL.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Hu(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function kq(t){p_=t(p_)}function Tq(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call($b(this),e,...r);return dL.set(n,e.sort?e.sort():[e]),Hu(n)}:Sq().includes(t)?function(...e){return t.apply($b(this),e),Hu(uL.get(this))}:function(...e){return Hu(t.apply($b(this),e))}}function jq(t){return typeof t=="function"?Tq(t):(t instanceof IDBTransaction&&Fq(t),Eq(t,Bq())?new Proxy(t,p_):t)}function Hu(t){if(t instanceof IDBRequest)return Iq(t);if(Gb.has(t))return Gb.get(t);const e=jq(t);return e!==t&&(Gb.set(t,e),QB.set(e,t)),e}const $b=t=>QB.get(t);function Pq(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),l=Hu(o);return n&&o.addEventListener("upgradeneeded",c=>{n(Hu(o.result),c.oldVersion,c.newVersion,Hu(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",A=>s(A.oldVersion,A.newVersion,A))}).catch(()=>{}),l}const Rq=["get","getKey","getAll","getAllKeys","count"],Dq=["put","add","delete","clear"],zb=new Map;function q4(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(zb.get(e))return zb.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=Dq.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Rq.includes(r)))return;const a=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let A=c.store;return n&&(A=A.index(l.shift())),(await Promise.all([A[r](...l),s&&c.done]))[0]};return zb.set(e,a),a}kq(t=>({...t,get:(e,r,n)=>q4(e,r)||t.get(e,r,n),has:(e,r)=>!!q4(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lq{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Uq(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Uq(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const g_="@firebase/app",G4="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=new MB("@firebase/app"),Oq="@firebase/app-compat",Mq="@firebase/analytics-compat",Qq="@firebase/analytics",Vq="@firebase/app-check-compat",Hq="@firebase/app-check",Kq="@firebase/auth",qq="@firebase/auth-compat",Gq="@firebase/database",$q="@firebase/data-connect",zq="@firebase/database-compat",Wq="@firebase/functions",Jq="@firebase/functions-compat",Xq="@firebase/installations",Yq="@firebase/installations-compat",Zq="@firebase/messaging",eG="@firebase/messaging-compat",tG="@firebase/performance",rG="@firebase/performance-compat",nG="@firebase/remote-config",sG="@firebase/remote-config-compat",aG="@firebase/storage",iG="@firebase/storage-compat",oG="@firebase/firestore",lG="@firebase/vertexai-preview",cG="@firebase/firestore-compat",AG="firebase",uG="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="[DEFAULT]",dG={[g_]:"fire-core",[Oq]:"fire-core-compat",[Qq]:"fire-analytics",[Mq]:"fire-analytics-compat",[Hq]:"fire-app-check",[Vq]:"fire-app-check-compat",[Kq]:"fire-auth",[qq]:"fire-auth-compat",[Gq]:"fire-rtdb",[$q]:"fire-data-connect",[zq]:"fire-rtdb-compat",[Wq]:"fire-fn",[Jq]:"fire-fn-compat",[Xq]:"fire-iid",[Yq]:"fire-iid-compat",[Zq]:"fire-fcm",[eG]:"fire-fcm-compat",[tG]:"fire-perf",[rG]:"fire-perf-compat",[nG]:"fire-rc",[sG]:"fire-rc-compat",[aG]:"fire-gcs",[iG]:"fire-gcs-compat",[oG]:"fire-fst",[cG]:"fire-fst-compat",[lG]:"fire-vertex","fire-js":"fire-js",[AG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0=new Map,v_=new Map,w_=new Map;function $4(t,e){try{t.container.addComponent(e)}catch(r){CA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function k0(t){const e=t.name;if(w_.has(e))return CA.debug(`There were multiple attempts to register component ${e}.`),!1;w_.set(e,t);for(const r of F0.values())$4(r,t);for(const r of v_.values())$4(r,t);return!0}function VB(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function fc(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ku=new xx("app","Firebase",hG);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fG{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new yh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ku.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0=uG;function HB(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:x_,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Ku.create("bad-app-name",{appName:String(s)});if(r||(r=oL()),!r)throw Ku.create("no-options");const a=F0.get(s);if(a){if(qw(r,a.options)&&qw(n,a.config))return a;throw Ku.create("duplicate-app",{appName:s})}const o=new yq(s);for(const c of w_.values())o.addComponent(c);const l=new fG(r,n,o);return F0.set(s,l),l}function KB(t=x_){const e=F0.get(t);if(!e&&t===x_&&oL())return HB();if(!e)throw Ku.create("no-app",{appName:t});return e}async function mG(t){let e=!1;const r=t.name;F0.has(r)?(e=!0,F0.delete(r)):v_.has(r)&&t.decRefCount()<=0&&(v_.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function qu(t,e,r){var n;let s=(n=dG[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const a=s.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${s}" with version "${e}":`];a&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),CA.warn(l.join(" "));return}k0(new yh(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pG="firebase-heartbeat-database",gG=1,Eg="firebase-heartbeat-store";let Wb=null;function hL(){return Wb||(Wb=Pq(pG,gG,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Eg)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ku.create("idb-open",{originalErrorMessage:t.message})})),Wb}async function xG(t){try{const r=(await hL()).transaction(Eg),n=await r.objectStore(Eg).get(fL(t));return await r.done,n}catch(e){if(e instanceof FA)CA.warn(e.message);else{const r=Ku.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});CA.warn(r.message)}}}async function z4(t,e){try{const n=(await hL()).transaction(Eg,"readwrite");await n.objectStore(Eg).put(e,fL(t)),await n.done}catch(r){if(r instanceof FA)CA.warn(r.message);else{const n=Ku.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});CA.warn(n.message)}}}function fL(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vG=1024,wG=30*24*60*60*1e3;class yG{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new NG(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=W4();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=wG}),this._storage.overwrite(this._heartbeatsCache))}catch(n){CA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=W4(),{heartbeatsToSend:n,unsentEntries:s}=bG(this._heartbeatsCache.heartbeats),a=Kw(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return CA.warn(r),""}}}function W4(){return new Date().toISOString().substring(0,10)}function bG(t,e=vG){const r=[];let n=t.slice();for(const s of t){const a=r.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),J4(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),J4(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class NG{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return AL()?Aq().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await xG(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return z4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return z4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function J4(t){return Kw(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CG(t){k0(new yh("platform-logger",e=>new Lq(e),"PRIVATE")),k0(new yh("heartbeat",e=>new yG(e),"PRIVATE")),qu(g_,G4,t),qu(g_,G4,"esm2017"),qu("fire-js","")}CG("");function qB(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function mL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _G=mL,pL=new xx("auth","Firebase",mL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw=new MB("@firebase/auth");function EG(t,...e){Gw.logLevel<=tn.WARN&&Gw.warn(`Auth (${X0}): ${t}`,...e)}function ew(t,...e){Gw.logLevel<=tn.ERROR&&Gw.error(`Auth (${X0}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(t,...e){throw GB(t,...e)}function yc(t,...e){return GB(t,...e)}function gL(t,e,r){const n=Object.assign(Object.assign({},_G()),{[e]:r});return new xx("auth","Firebase",n).create(e,{appName:t.name})}function uA(t){return gL(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function GB(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return pL.create(t,...e)}function Br(t,e,...r){if(!t)throw GB(e,...r)}function sA(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ew(e),new Error(e)}function _A(t,e){t||sA(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function BG(){return X4()==="http:"||X4()==="https:"}function X4(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BG()||oq()||"connection"in navigator)?navigator.onLine:!0}function IG(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e,r){this.shortDelay=e,this.longDelay=r,_A(r>e,"Short delay should be less than long delay!"),this.isMobile=sq()||lq()}get(){return SG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $B(t,e){_A(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;sA("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;sA("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;sA("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kG=new wx(3e4,6e4);function fd(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function md(t,e,r,n,s={}){return vL(t,s,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const l=vx(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const A=Object.assign({method:e,headers:c},a);return iq()||(A.referrerPolicy="no-referrer"),xL.fetch()(wL(t,t.config.apiHost,r,l),A)})}async function vL(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},FG),e);try{const s=new jG(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Sv(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const l=a.ok?o.errorMessage:o.error.message,[c,A]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sv(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Sv(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Sv(t,"user-disabled",o);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(A)throw gL(t,u,A);Vl(t,u)}}catch(s){if(s instanceof FA)throw s;Vl(t,"network-request-failed",{message:String(s)})}}async function yx(t,e,r,n,s={}){const a=await md(t,e,r,n,s);return"mfaPendingCredential"in a&&Vl(t,"multi-factor-auth-required",{_serverResponse:a}),a}function wL(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?$B(t.config,s):`${t.config.apiScheme}://${s}`}function TG(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jG{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(yc(this.auth,"network-request-failed")),kG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Sv(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=yc(t,e,n);return s.customData._tokenResponse=r,s}function Y4(t){return t!==void 0&&t.enterprise!==void 0}class PG{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return TG(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function RG(t,e){return md(t,"GET","/v2/recaptchaConfig",fd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DG(t,e){return md(t,"POST","/v1/accounts:delete",e)}async function yL(t,e){return md(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LG(t,e=!1){const r=ks(t),n=await r.getIdToken(e),s=zB(n);Br(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:Rp(Jb(s.auth_time)),issuedAtTime:Rp(Jb(s.iat)),expirationTime:Rp(Jb(s.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Jb(t){return Number(t)*1e3}function zB(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ew("JWT malformed, contained fewer than 3 sections"),null;try{const s=aL(r);return s?JSON.parse(s):(ew("Failed to decode base64 JWT payload"),null)}catch(s){return ew("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Z4(t){const e=zB(t);return Br(e,"internal-error"),Br(typeof e.exp<"u","internal-error"),Br(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bg(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof FA&&UG(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function UG({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OG{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rp(this.lastLoginAt),this.creationTime=Rp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $w(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Bg(t,yL(r,{idToken:n}));Br(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?bL(a.providerUserInfo):[],l=QG(t.providerData,o),c=t.isAnonymous,A=!(t.email&&a.passwordHash)&&!(l!=null&&l.length),u=c?A:!1,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new b_(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function MG(t){const e=ks(t);await $w(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QG(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function bL(t){return t.map(e=>{var{providerId:r}=e,n=qB(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VG(t,e){const r=await vL(t,{},async()=>{const n=vx({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,o=wL(t,s,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",xL.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function HG(t,e){return md(t,"POST","/v2/accounts:revokeToken",fd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Br(e.idToken,"internal-error"),Br(typeof e.idToken<"u","internal-error"),Br(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Z4(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Br(e.length!==0,"internal-error");const r=Z4(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Br(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await VG(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,o=new f0;return n&&(Br(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(Br(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),a&&(Br(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new f0,this.toJSON())}_performRefresh(){return sA("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t,e){Br(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class aA{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,a=qB(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new OG(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new b_(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Bg(this,this.stsTokenManager.getToken(this.auth,e));return Br(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return LG(this,e)}reload(){return MG(this)}_assign(e){this!==e&&(Br(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new aA(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Br(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await $w(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fc(this.auth.app))return Promise.reject(uA(this.auth));const e=await this.getIdToken();return await Bg(this,DG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,a,o,l,c,A,u;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,f=(s=r.email)!==null&&s!==void 0?s:void 0,h=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,g=(A=r.createdAt)!==null&&A!==void 0?A:void 0,y=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:F,isAnonymous:P,providerData:R,stsTokenManager:_}=r;Br(b&&_,e,"internal-error");const B=f0.fromJSON(this.name,_);Br(typeof b=="string",e,"internal-error"),tu(d,e.name),tu(f,e.name),Br(typeof F=="boolean",e,"internal-error"),Br(typeof P=="boolean",e,"internal-error"),tu(h,e.name),tu(m,e.name),tu(p,e.name),tu(x,e.name),tu(g,e.name),tu(y,e.name);const E=new aA({uid:b,auth:e,email:f,emailVerified:F,displayName:d,isAnonymous:P,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:B,createdAt:g,lastLoginAt:y});return R&&Array.isArray(R)&&(E.providerData=R.map(M=>Object.assign({},M))),x&&(E._redirectEventId=x),E}static async _fromIdTokenResponse(e,r,n=!1){const s=new f0;s.updateFromServerResponse(r);const a=new aA({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await $w(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Br(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?bL(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),l=new f0;l.updateFromIdToken(n);const c=new aA({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),A={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new b_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(c,A),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF=new Map;function iA(t){_A(t instanceof Function,"Expected a class definition");let e=eF.get(t);return e?(_A(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eF.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}NL.type="NONE";const tF=NL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(t,e,r){return`firebase:${t}:${e}:${r}`}class m0{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=tw(this.userKey,s.apiKey,a),this.fullPersistenceKey=tw("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?aA._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new m0(iA(tF),e,n);const s=(await Promise.all(r.map(async A=>{if(await A._isAvailable())return A}))).filter(A=>A);let a=s[0]||iA(tF);const o=tw(n,e.config.apiKey,e.name);let l=null;for(const A of r)try{const u=await A._get(o);if(u){const d=aA._fromJSON(e,u);A!==a&&(l=d),a=A;break}}catch{}const c=s.filter(A=>A._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new m0(a,e,n):(a=c[0],l&&await a._set(o,l.toJSON()),await Promise.all(r.map(async A=>{if(A!==a)try{await A._remove(o)}catch{}})),new m0(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rF(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(BL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IL(e))return"Blackberry";if(FL(e))return"Webos";if(_L(e))return"Safari";if((e.includes("chrome/")||EL(e))&&!e.includes("edge/"))return"Chrome";if(SL(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function CL(t=fa()){return/firefox\//i.test(t)}function _L(t=fa()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function EL(t=fa()){return/crios\//i.test(t)}function BL(t=fa()){return/iemobile/i.test(t)}function SL(t=fa()){return/android/i.test(t)}function IL(t=fa()){return/blackberry/i.test(t)}function FL(t=fa()){return/webos/i.test(t)}function WB(t=fa()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function KG(t=fa()){var e;return WB(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qG(){return cq()&&document.documentMode===10}function kL(t=fa()){return WB(t)||SL(t)||FL(t)||IL(t)||/windows phone/i.test(t)||BL(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(t,e=[]){let r;switch(t){case"Browser":r=rF(fa());break;case"Worker":r=`${rF(fa())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${X0}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,l)=>{try{const c=e(a);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $G(t,e={}){return md(t,"GET","/v2/passwordPolicy",fd(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zG=6;class WG{constructor(e){var r,n,s,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:zG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,a,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsUppercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JG{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nF(this),this.idTokenSubscription=new nF(this),this.beforeStateQueue=new GG(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=iA(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await m0.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await yL(this,{idToken:e}),n=await aA._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(fc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Br(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await $w(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fc(this.app))return Promise.reject(uA(this));const r=e?ks(e):null;return r&&Br(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Br(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fc(this.app)?Promise.reject(uA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fc(this.app)?Promise.reject(uA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(iA(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $G(this),r=new WG(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xx("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await HG(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&iA(e)||this._popupRedirectResolver;Br(r,this,"argument-error"),this.redirectPersistenceManager=await m0.create(this,[iA(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Br(l,this,"internal-error"),l.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Br(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&EG(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Mh(t){return ks(t)}class nF{constructor(e){this.auth=e,this.observer=null,this.addObserver=mq(r=>this.observer=r)}get next(){return Br(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function XG(t){s2=t}function jL(t){return s2.loadJS(t)}function YG(){return s2.recaptchaEnterpriseScript}function ZG(){return s2.gapiScript}function e$(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const t$="recaptcha-enterprise",r$="NO_RECAPTCHA";class n${constructor(e){this.type=t$,this.auth=Mh(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,l)=>{RG(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const A=new PG(c);return a.tenantId==null?a._agentRecaptchaConfig=A:a._tenantRecaptchaConfigs[a.tenantId]=A,o(A.siteKey)}}).catch(c=>{l(c)})})}function s(a,o,l){const c=window.grecaptcha;Y4(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(A=>{o(A)}).catch(()=>{o(r$)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,o)=>{n(this.auth).then(l=>{if(!r&&Y4(window.grecaptcha))s(l,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=YG();c.length!==0&&(c+=l),jL(c).then(()=>{s(l,a,o)}).catch(A=>{o(A)})}}).catch(l=>{o(l)})})}}async function sF(t,e,r,n=!1){const s=new n$(t);let a;try{a=await s.verify(r)}catch{a=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function N_(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await sF(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await sF(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s$(t,e){const r=VB(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(qw(a,e??{}))return s;Vl(s,"already-initialized")}return r.initialize({options:e})}function a$(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(iA);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function i$(t,e,r){const n=Mh(t);Br(n._canInitEmulator,n,"emulator-config-failed"),Br(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=PL(e),{host:o,port:l}=o$(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${a}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),l$()}function PL(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function o$(t){const e=PL(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:aF(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:aF(o)}}}function aF(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function l$(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JB{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return sA("not implemented")}_getIdTokenResponse(e){return sA("not implemented")}_linkToIdToken(e,r){return sA("not implemented")}_getReauthenticationResolver(e){return sA("not implemented")}}async function c$(t,e){return md(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A$(t,e){return yx(t,"POST","/v1/accounts:signInWithPassword",fd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u$(t,e){return yx(t,"POST","/v1/accounts:signInWithEmailLink",fd(t,e))}async function d$(t,e){return yx(t,"POST","/v1/accounts:signInWithEmailLink",fd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg extends JB{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Sg(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Sg(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return N_(e,r,"signInWithPassword",A$);case"emailLink":return u$(e,{email:this._email,oobCode:this._password});default:Vl(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return N_(e,n,"signUpPassword",c$);case"emailLink":return d$(e,{idToken:r,email:this._email,oobCode:this._password});default:Vl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p0(t,e){return yx(t,"POST","/v1/accounts:signInWithIdp",fd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h$="http://localhost";class bh extends JB{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new bh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Vl("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,a=qB(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new bh(n,s);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return p0(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,p0(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,p0(e,r)}buildRequest(){const e={requestUri:h$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=vx(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f$(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function m$(t){const e=cp(Ap(t)).link,r=e?cp(Ap(e)).deep_link_id:null,n=cp(Ap(t)).deep_link_id;return(n?cp(Ap(n)).link:null)||n||r||e||t}class XB{constructor(e){var r,n,s,a,o,l;const c=cp(Ap(e)),A=(r=c.apiKey)!==null&&r!==void 0?r:null,u=(n=c.oobCode)!==null&&n!==void 0?n:null,d=f$((s=c.mode)!==null&&s!==void 0?s:null);Br(A&&u&&d,"argument-error"),this.apiKey=A,this.operation=d,this.code=u,this.continueUrl=(a=c.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=m$(e);try{return new XB(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(){this.providerId=Y0.PROVIDER_ID}static credential(e,r){return Sg._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=XB.parseLink(r);return Br(n,"argument-error"),Sg._fromEmailAndCode(e,n.code,n.tenantId)}}Y0.PROVIDER_ID="password";Y0.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Y0.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx extends RL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu extends bx{constructor(){super("facebook.com")}static credential(e){return bh._fromParams({providerId:xu.PROVIDER_ID,signInMethod:xu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xu.credentialFromTaggedObject(e)}static credentialFromError(e){return xu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xu.credential(e.oauthAccessToken)}catch{return null}}}xu.FACEBOOK_SIGN_IN_METHOD="facebook.com";xu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu extends bx{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return bh._fromParams({providerId:vu.PROVIDER_ID,signInMethod:vu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return vu.credentialFromTaggedObject(e)}static credentialFromError(e){return vu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return vu.credential(r,n)}catch{return null}}}vu.GOOGLE_SIGN_IN_METHOD="google.com";vu.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends bx{constructor(){super("github.com")}static credential(e){return bh._fromParams({providerId:wu.PROVIDER_ID,signInMethod:wu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wu.credentialFromTaggedObject(e)}static credentialFromError(e){return wu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wu.credential(e.oauthAccessToken)}catch{return null}}}wu.GITHUB_SIGN_IN_METHOD="github.com";wu.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends bx{constructor(){super("twitter.com")}static credential(e,r){return bh._fromParams({providerId:yu.PROVIDER_ID,signInMethod:yu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return yu.credentialFromTaggedObject(e)}static credentialFromError(e){return yu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return yu.credential(r,n)}catch{return null}}}yu.TWITTER_SIGN_IN_METHOD="twitter.com";yu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p$(t,e){return yx(t,"POST","/v1/accounts:signUp",fd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await aA._fromIdTokenResponse(e,n,s),o=iF(n);return new Nh({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=iF(n);return new Nh({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function iF(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw extends FA{constructor(e,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,zw.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new zw(e,r,n,s)}}function DL(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?zw._fromErrorAndOperation(t,a,e,n):a})}async function g$(t,e,r=!1){const n=await Bg(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Nh._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x$(t,e,r=!1){const{auth:n}=t;if(fc(n.app))return Promise.reject(uA(n));const s="reauthenticate";try{const a=await Bg(t,DL(n,s,e,t),r);Br(a.idToken,n,"internal-error");const o=zB(a.idToken);Br(o,n,"internal-error");const{sub:l}=o;return Br(t.uid===l,n,"user-mismatch"),Nh._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Vl(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(t,e,r=!1){if(fc(t.app))return Promise.reject(uA(t));const n="signIn",s=await DL(t,n,e),a=await Nh._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function v$(t,e){return LL(Mh(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UL(t){const e=Mh(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function w$(t,e,r){if(fc(t.app))return Promise.reject(uA(t));const n=Mh(t),o=await N_(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",p$).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&UL(t),c}),l=await Nh._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function y$(t,e,r){return fc(t.app)?Promise.reject(uA(t)):v$(ks(t),Y0.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&UL(t),n})}function b$(t,e,r,n){return ks(t).onIdTokenChanged(e,r,n)}function N$(t,e,r){return ks(t).beforeAuthStateChanged(e,r)}function OL(t,e,r,n){return ks(t).onAuthStateChanged(e,r,n)}function YB(t){return ks(t).signOut()}const Ww="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Ww,"1"),this.storage.removeItem(Ww),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$=1e3,_$=10;class QL extends ML{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);qG()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,_$):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},C$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}QL.type="LOCAL";const E$=QL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL extends ML{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}VL.type="SESSION";const HL=VL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new a2(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async A=>A(r.origin,a)),c=await B$(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}a2.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZB(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,o;return new Promise((l,c)=>{const A=ZB("",20);s.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(d){const f=d;if(f.data.eventId===A)switch(f.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(f.data.response);break;default:clearTimeout(u),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:A,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(){return window}function I$(t){bc().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(){return typeof bc().WorkerGlobalScope<"u"&&typeof bc().importScripts=="function"}async function F$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function k$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function T$(){return KL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="firebaseLocalStorageDb",j$=1,Jw="firebaseLocalStorage",GL="fbase_key";class Nx{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function i2(t,e){return t.transaction([Jw],e?"readwrite":"readonly").objectStore(Jw)}function P$(){const t=indexedDB.deleteDatabase(qL);return new Nx(t).toPromise()}function C_(){const t=indexedDB.open(qL,j$);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Jw,{keyPath:GL})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Jw)?e(n):(n.close(),await P$(),e(await C_()))})})}async function oF(t,e,r){const n=i2(t,!0).put({[GL]:e,value:r});return new Nx(n).toPromise()}async function R$(t,e){const r=i2(t,!1).get(e),n=await new Nx(r).toPromise();return n===void 0?null:n.value}function lF(t,e){const r=i2(t,!0).delete(e);return new Nx(r).toPromise()}const D$=800,L$=3;class $L{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await C_(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>L$)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=a2._getInstance(T$()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await F$(),!this.activeServiceWorker)return;this.sender=new S$(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||k$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await C_();return await oF(e,Ww,"1"),await lF(e,Ww),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>oF(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>R$(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>lF(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=i2(s,!1).getAll();return new Nx(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),D$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$L.type="LOCAL";const U$=$L;new wx(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O$(t,e){return e?iA(e):(Br(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS extends JB{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return p0(e,this._buildIdpRequest())}_linkToIdToken(e,r){return p0(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return p0(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function M$(t){return LL(t.auth,new eS(t),t.bypassAuthState)}function Q$(t){const{auth:e,user:r}=t;return Br(r,e,"internal-error"),x$(r,new eS(t),t.bypassAuthState)}async function V$(t){const{auth:e,user:r}=t;return Br(r,e,"internal-error"),g$(r,new eS(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(A){this.reject(A)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return M$;case"linkViaPopup":case"linkViaRedirect":return V$;case"reauthViaPopup":case"reauthViaRedirect":return Q$;default:Vl(this.auth,"internal-error")}}resolve(e){_A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$=new wx(2e3,1e4);class a0 extends zL{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,a0.currentPopupAction&&a0.currentPopupAction.cancel(),a0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Br(e,this.auth,"internal-error"),e}async onExecution(){_A(this.filter.length===1,"Popup operations only handle one event");const e=ZB();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(yc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(yc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,a0.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,H$.get())};e()}}a0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K$="pendingRedirect",rw=new Map;class q$ extends zL{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=rw.get(this.auth._key());if(!e){try{const n=await G$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}rw.set(this.auth._key(),e)}return this.bypassAuthState||rw.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function G$(t,e){const r=W$(e),n=z$(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function $$(t,e){rw.set(t._key(),e)}function z$(t){return iA(t._redirectPersistence)}function W$(t){return tw(K$,t.config.apiKey,t.name)}async function J$(t,e,r=!1){if(fc(t.app))return Promise.reject(uA(t));const n=Mh(t),s=O$(n,e),o=await new q$(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$=10*60*1e3;class Y${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Z$(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!WL(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(yc(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=X$&&this.cachedEventUids.clear(),this.cachedEventUids.has(cF(e))}saveEventToCache(e){this.cachedEventUids.add(cF(e)),this.lastProcessedEventTime=Date.now()}}function cF(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function WL({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Z$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WL(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ez(t,e={}){return md(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rz=/^https?/;async function nz(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ez(t);for(const r of e)try{if(sz(r))return}catch{}Vl(t,"unauthorized-domain")}function sz(t){const e=y_(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!rz.test(r))return!1;if(tz.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const az=new wx(3e4,6e4);function AF(){const t=bc().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function iz(t){return new Promise((e,r)=>{var n,s,a;function o(){AF(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{AF(),r(yc(t,"network-request-failed"))},timeout:az.get()})}if(!((s=(n=bc().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=bc().gapi)===null||a===void 0)&&a.load)o();else{const l=e$("iframefcb");return bc()[l]=()=>{gapi.load?o():r(yc(t,"network-request-failed"))},jL(`${ZG()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw nw=null,e})}let nw=null;function oz(t){return nw=nw||iz(t),nw}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz=new wx(5e3,15e3),cz="__/auth/iframe",Az="emulator/auth/iframe",uz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hz(t){const e=t.config;Br(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?$B(e,Az):`https://${t.config.authDomain}/${cz}`,n={apiKey:e.apiKey,appName:t.name,v:X0},s=dz.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${vx(n).slice(1)}`}async function fz(t){const e=await oz(t),r=bc().gapi;return Br(r,t,"internal-error"),e.open({where:document.body,url:hz(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:uz,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const o=yc(t,"network-request-failed"),l=bc().setTimeout(()=>{a(o)},lz.get());function c(){bc().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pz=500,gz=600,xz="_blank",vz="http://localhost";class uF{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wz(t,e,r,n=pz,s=gz){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},mz),{width:n.toString(),height:s.toString(),top:a,left:o}),A=fa().toLowerCase();r&&(l=EL(A)?xz:r),CL(A)&&(e=e||vz,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[h,m])=>`${f}${h}=${m},`,"");if(KG(A)&&l!=="_self")return yz(e||"",l),new uF(null);const d=window.open(e||"",l,u);Br(d,t,"popup-blocked");try{d.focus()}catch{}return new uF(d)}function yz(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bz="__/auth/handler",Nz="emulator/auth/handler",Cz=encodeURIComponent("fac");async function dF(t,e,r,n,s,a){Br(t.config.authDomain,t,"auth-domain-config-required"),Br(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:X0,eventId:s};if(e instanceof RL){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",fq(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof bx){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await t._getAppCheckToken(),A=c?`#${Cz}=${encodeURIComponent(c)}`:"";return`${_z(t)}?${vx(l).slice(1)}${A}`}function _z({config:t}){return t.emulator?$B(t,Nz):`https://${t.authDomain}/${bz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="webStorageSupport";class Ez{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=HL,this._completeRedirectFn=J$,this._overrideRedirectResult=$$}async _openPopup(e,r,n,s){var a;_A((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await dF(e,r,n,y_(),s);return wz(e,o,ZB())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await dF(e,r,n,y_(),s);return I$(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(_A(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await fz(e),n=new Y$(e);return r.register("authEvent",s=>(Br(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Xb,{type:Xb},s=>{var a;const o=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[Xb];o!==void 0&&r(!!o),Vl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=nz(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return kL()||_L()||WB()}}const Bz=Ez;var hF="@firebase/auth",fF="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Br(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Fz(t){k0(new yh("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Br(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TL(t)},A=new JG(n,s,a,c);return a$(A,r),A},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),k0(new yh("auth-internal",e=>{const r=Mh(e.getProvider("auth").getImmediate());return(n=>new Sz(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),qu(hF,fF,Iz(t)),qu(hF,fF,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz=5*60,Tz=lL("authIdTokenMaxAge")||kz;let mF=null;const jz=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Tz)return;const s=r==null?void 0:r.token;mF!==s&&(mF=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function JL(t=KB()){const e=VB(t,"auth");if(e.isInitialized())return e.getImmediate();const r=s$(t,{popupRedirectResolver:Bz,persistence:[U$,E$,HL]}),n=lL("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=jz(a.toString());N$(r,o,()=>o(r.currentUser)),b$(r,l=>o(l))}}const s=iL("auth");return s&&i$(r,`http://${s}`),r}function Pz(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}XG({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=yc("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",Pz().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Fz("Browser");var Rz="firebase",Dz="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qu(Rz,Dz,"app");var pF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ah,XL;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,B){function E(){}E.prototype=B.prototype,_.D=B.prototype,_.prototype=new E,_.prototype.constructor=_,_.C=function(M,k,T){for(var U=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)U[Z-2]=arguments[Z];return B.prototype[k].apply(M,U)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,B,E){E||(E=0);var M=Array(16);if(typeof B=="string")for(var k=0;16>k;++k)M[k]=B.charCodeAt(E++)|B.charCodeAt(E++)<<8|B.charCodeAt(E++)<<16|B.charCodeAt(E++)<<24;else for(k=0;16>k;++k)M[k]=B[E++]|B[E++]<<8|B[E++]<<16|B[E++]<<24;B=_.g[0],E=_.g[1],k=_.g[2];var T=_.g[3],U=B+(T^E&(k^T))+M[0]+3614090360&4294967295;B=E+(U<<7&4294967295|U>>>25),U=T+(k^B&(E^k))+M[1]+3905402710&4294967295,T=B+(U<<12&4294967295|U>>>20),U=k+(E^T&(B^E))+M[2]+606105819&4294967295,k=T+(U<<17&4294967295|U>>>15),U=E+(B^k&(T^B))+M[3]+3250441966&4294967295,E=k+(U<<22&4294967295|U>>>10),U=B+(T^E&(k^T))+M[4]+4118548399&4294967295,B=E+(U<<7&4294967295|U>>>25),U=T+(k^B&(E^k))+M[5]+1200080426&4294967295,T=B+(U<<12&4294967295|U>>>20),U=k+(E^T&(B^E))+M[6]+2821735955&4294967295,k=T+(U<<17&4294967295|U>>>15),U=E+(B^k&(T^B))+M[7]+4249261313&4294967295,E=k+(U<<22&4294967295|U>>>10),U=B+(T^E&(k^T))+M[8]+1770035416&4294967295,B=E+(U<<7&4294967295|U>>>25),U=T+(k^B&(E^k))+M[9]+2336552879&4294967295,T=B+(U<<12&4294967295|U>>>20),U=k+(E^T&(B^E))+M[10]+4294925233&4294967295,k=T+(U<<17&4294967295|U>>>15),U=E+(B^k&(T^B))+M[11]+2304563134&4294967295,E=k+(U<<22&4294967295|U>>>10),U=B+(T^E&(k^T))+M[12]+1804603682&4294967295,B=E+(U<<7&4294967295|U>>>25),U=T+(k^B&(E^k))+M[13]+4254626195&4294967295,T=B+(U<<12&4294967295|U>>>20),U=k+(E^T&(B^E))+M[14]+2792965006&4294967295,k=T+(U<<17&4294967295|U>>>15),U=E+(B^k&(T^B))+M[15]+1236535329&4294967295,E=k+(U<<22&4294967295|U>>>10),U=B+(k^T&(E^k))+M[1]+4129170786&4294967295,B=E+(U<<5&4294967295|U>>>27),U=T+(E^k&(B^E))+M[6]+3225465664&4294967295,T=B+(U<<9&4294967295|U>>>23),U=k+(B^E&(T^B))+M[11]+643717713&4294967295,k=T+(U<<14&4294967295|U>>>18),U=E+(T^B&(k^T))+M[0]+3921069994&4294967295,E=k+(U<<20&4294967295|U>>>12),U=B+(k^T&(E^k))+M[5]+3593408605&4294967295,B=E+(U<<5&4294967295|U>>>27),U=T+(E^k&(B^E))+M[10]+38016083&4294967295,T=B+(U<<9&4294967295|U>>>23),U=k+(B^E&(T^B))+M[15]+3634488961&4294967295,k=T+(U<<14&4294967295|U>>>18),U=E+(T^B&(k^T))+M[4]+3889429448&4294967295,E=k+(U<<20&4294967295|U>>>12),U=B+(k^T&(E^k))+M[9]+568446438&4294967295,B=E+(U<<5&4294967295|U>>>27),U=T+(E^k&(B^E))+M[14]+3275163606&4294967295,T=B+(U<<9&4294967295|U>>>23),U=k+(B^E&(T^B))+M[3]+4107603335&4294967295,k=T+(U<<14&4294967295|U>>>18),U=E+(T^B&(k^T))+M[8]+1163531501&4294967295,E=k+(U<<20&4294967295|U>>>12),U=B+(k^T&(E^k))+M[13]+2850285829&4294967295,B=E+(U<<5&4294967295|U>>>27),U=T+(E^k&(B^E))+M[2]+4243563512&4294967295,T=B+(U<<9&4294967295|U>>>23),U=k+(B^E&(T^B))+M[7]+1735328473&4294967295,k=T+(U<<14&4294967295|U>>>18),U=E+(T^B&(k^T))+M[12]+2368359562&4294967295,E=k+(U<<20&4294967295|U>>>12),U=B+(E^k^T)+M[5]+4294588738&4294967295,B=E+(U<<4&4294967295|U>>>28),U=T+(B^E^k)+M[8]+2272392833&4294967295,T=B+(U<<11&4294967295|U>>>21),U=k+(T^B^E)+M[11]+1839030562&4294967295,k=T+(U<<16&4294967295|U>>>16),U=E+(k^T^B)+M[14]+4259657740&4294967295,E=k+(U<<23&4294967295|U>>>9),U=B+(E^k^T)+M[1]+2763975236&4294967295,B=E+(U<<4&4294967295|U>>>28),U=T+(B^E^k)+M[4]+1272893353&4294967295,T=B+(U<<11&4294967295|U>>>21),U=k+(T^B^E)+M[7]+4139469664&4294967295,k=T+(U<<16&4294967295|U>>>16),U=E+(k^T^B)+M[10]+3200236656&4294967295,E=k+(U<<23&4294967295|U>>>9),U=B+(E^k^T)+M[13]+681279174&4294967295,B=E+(U<<4&4294967295|U>>>28),U=T+(B^E^k)+M[0]+3936430074&4294967295,T=B+(U<<11&4294967295|U>>>21),U=k+(T^B^E)+M[3]+3572445317&4294967295,k=T+(U<<16&4294967295|U>>>16),U=E+(k^T^B)+M[6]+76029189&4294967295,E=k+(U<<23&4294967295|U>>>9),U=B+(E^k^T)+M[9]+3654602809&4294967295,B=E+(U<<4&4294967295|U>>>28),U=T+(B^E^k)+M[12]+3873151461&4294967295,T=B+(U<<11&4294967295|U>>>21),U=k+(T^B^E)+M[15]+530742520&4294967295,k=T+(U<<16&4294967295|U>>>16),U=E+(k^T^B)+M[2]+3299628645&4294967295,E=k+(U<<23&4294967295|U>>>9),U=B+(k^(E|~T))+M[0]+4096336452&4294967295,B=E+(U<<6&4294967295|U>>>26),U=T+(E^(B|~k))+M[7]+1126891415&4294967295,T=B+(U<<10&4294967295|U>>>22),U=k+(B^(T|~E))+M[14]+2878612391&4294967295,k=T+(U<<15&4294967295|U>>>17),U=E+(T^(k|~B))+M[5]+4237533241&4294967295,E=k+(U<<21&4294967295|U>>>11),U=B+(k^(E|~T))+M[12]+1700485571&4294967295,B=E+(U<<6&4294967295|U>>>26),U=T+(E^(B|~k))+M[3]+2399980690&4294967295,T=B+(U<<10&4294967295|U>>>22),U=k+(B^(T|~E))+M[10]+4293915773&4294967295,k=T+(U<<15&4294967295|U>>>17),U=E+(T^(k|~B))+M[1]+2240044497&4294967295,E=k+(U<<21&4294967295|U>>>11),U=B+(k^(E|~T))+M[8]+1873313359&4294967295,B=E+(U<<6&4294967295|U>>>26),U=T+(E^(B|~k))+M[15]+4264355552&4294967295,T=B+(U<<10&4294967295|U>>>22),U=k+(B^(T|~E))+M[6]+2734768916&4294967295,k=T+(U<<15&4294967295|U>>>17),U=E+(T^(k|~B))+M[13]+1309151649&4294967295,E=k+(U<<21&4294967295|U>>>11),U=B+(k^(E|~T))+M[4]+4149444226&4294967295,B=E+(U<<6&4294967295|U>>>26),U=T+(E^(B|~k))+M[11]+3174756917&4294967295,T=B+(U<<10&4294967295|U>>>22),U=k+(B^(T|~E))+M[2]+718787259&4294967295,k=T+(U<<15&4294967295|U>>>17),U=E+(T^(k|~B))+M[9]+3951481745&4294967295,_.g[0]=_.g[0]+B&4294967295,_.g[1]=_.g[1]+(k+(U<<21&4294967295|U>>>11))&4294967295,_.g[2]=_.g[2]+k&4294967295,_.g[3]=_.g[3]+T&4294967295}n.prototype.u=function(_,B){B===void 0&&(B=_.length);for(var E=B-this.blockSize,M=this.B,k=this.h,T=0;T<B;){if(k==0)for(;T<=E;)s(this,_,T),T+=this.blockSize;if(typeof _=="string"){for(;T<B;)if(M[k++]=_.charCodeAt(T++),k==this.blockSize){s(this,M),k=0;break}}else for(;T<B;)if(M[k++]=_[T++],k==this.blockSize){s(this,M),k=0;break}}this.h=k,this.o+=B},n.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var B=1;B<_.length-8;++B)_[B]=0;var E=8*this.o;for(B=_.length-8;B<_.length;++B)_[B]=E&255,E/=256;for(this.u(_),_=Array(16),B=E=0;4>B;++B)for(var M=0;32>M;M+=8)_[E++]=this.g[B]>>>M&255;return _};function a(_,B){var E=l;return Object.prototype.hasOwnProperty.call(E,_)?E[_]:E[_]=B(_)}function o(_,B){this.h=B;for(var E=[],M=!0,k=_.length-1;0<=k;k--){var T=_[k]|0;M&&T==B||(E[k]=T,M=!1)}this.g=E}var l={};function c(_){return-128<=_&&128>_?a(_,function(B){return new o([B|0],0>B?-1:0)}):new o([_|0],0>_?-1:0)}function A(_){if(isNaN(_)||!isFinite(_))return d;if(0>_)return x(A(-_));for(var B=[],E=1,M=0;_>=E;M++)B[M]=_/E|0,E*=4294967296;return new o(B,0)}function u(_,B){if(_.length==0)throw Error("number format error: empty string");if(B=B||10,2>B||36<B)throw Error("radix out of range: "+B);if(_.charAt(0)=="-")return x(u(_.substring(1),B));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=A(Math.pow(B,8)),M=d,k=0;k<_.length;k+=8){var T=Math.min(8,_.length-k),U=parseInt(_.substring(k,k+T),B);8>T?(T=A(Math.pow(B,T)),M=M.j(T).add(A(U))):(M=M.j(E),M=M.add(A(U)))}return M}var d=c(0),f=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var _=0,B=1,E=0;E<this.g.length;E++){var M=this.i(E);_+=(0<=M?M:4294967296+M)*B,B*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(m(this))return"0";if(p(this))return"-"+x(this).toString(_);for(var B=A(Math.pow(_,6)),E=this,M="";;){var k=F(E,B).g;E=g(E,k.j(B));var T=((0<E.g.length?E.g[0]:E.h)>>>0).toString(_);if(E=k,m(E))return T+M;for(;6>T.length;)T="0"+T;M=T+M}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function m(_){if(_.h!=0)return!1;for(var B=0;B<_.g.length;B++)if(_.g[B]!=0)return!1;return!0}function p(_){return _.h==-1}t.l=function(_){return _=g(this,_),p(_)?-1:m(_)?0:1};function x(_){for(var B=_.g.length,E=[],M=0;M<B;M++)E[M]=~_.g[M];return new o(E,~_.h).add(f)}t.abs=function(){return p(this)?x(this):this},t.add=function(_){for(var B=Math.max(this.g.length,_.g.length),E=[],M=0,k=0;k<=B;k++){var T=M+(this.i(k)&65535)+(_.i(k)&65535),U=(T>>>16)+(this.i(k)>>>16)+(_.i(k)>>>16);M=U>>>16,T&=65535,U&=65535,E[k]=U<<16|T}return new o(E,E[E.length-1]&-2147483648?-1:0)};function g(_,B){return _.add(x(B))}t.j=function(_){if(m(this)||m(_))return d;if(p(this))return p(_)?x(this).j(x(_)):x(x(this).j(_));if(p(_))return x(this.j(x(_)));if(0>this.l(h)&&0>_.l(h))return A(this.m()*_.m());for(var B=this.g.length+_.g.length,E=[],M=0;M<2*B;M++)E[M]=0;for(M=0;M<this.g.length;M++)for(var k=0;k<_.g.length;k++){var T=this.i(M)>>>16,U=this.i(M)&65535,Z=_.i(k)>>>16,pe=_.i(k)&65535;E[2*M+2*k]+=U*pe,y(E,2*M+2*k),E[2*M+2*k+1]+=T*pe,y(E,2*M+2*k+1),E[2*M+2*k+1]+=U*Z,y(E,2*M+2*k+1),E[2*M+2*k+2]+=T*Z,y(E,2*M+2*k+2)}for(M=0;M<B;M++)E[M]=E[2*M+1]<<16|E[2*M];for(M=B;M<2*B;M++)E[M]=0;return new o(E,0)};function y(_,B){for(;(_[B]&65535)!=_[B];)_[B+1]+=_[B]>>>16,_[B]&=65535,B++}function b(_,B){this.g=_,this.h=B}function F(_,B){if(m(B))throw Error("division by zero");if(m(_))return new b(d,d);if(p(_))return B=F(x(_),B),new b(x(B.g),x(B.h));if(p(B))return B=F(_,x(B)),new b(x(B.g),B.h);if(30<_.g.length){if(p(_)||p(B))throw Error("slowDivide_ only works with positive integers.");for(var E=f,M=B;0>=M.l(_);)E=P(E),M=P(M);var k=R(E,1),T=R(M,1);for(M=R(M,2),E=R(E,2);!m(M);){var U=T.add(M);0>=U.l(_)&&(k=k.add(E),T=U),M=R(M,1),E=R(E,1)}return B=g(_,k.j(B)),new b(k,B)}for(k=d;0<=_.l(B);){for(E=Math.max(1,Math.floor(_.m()/B.m())),M=Math.ceil(Math.log(E)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),T=A(E),U=T.j(B);p(U)||0<U.l(_);)E-=M,T=A(E),U=T.j(B);m(T)&&(T=f),k=k.add(T),_=g(_,U)}return new b(k,_)}t.A=function(_){return F(this,_).h},t.and=function(_){for(var B=Math.max(this.g.length,_.g.length),E=[],M=0;M<B;M++)E[M]=this.i(M)&_.i(M);return new o(E,this.h&_.h)},t.or=function(_){for(var B=Math.max(this.g.length,_.g.length),E=[],M=0;M<B;M++)E[M]=this.i(M)|_.i(M);return new o(E,this.h|_.h)},t.xor=function(_){for(var B=Math.max(this.g.length,_.g.length),E=[],M=0;M<B;M++)E[M]=this.i(M)^_.i(M);return new o(E,this.h^_.h)};function P(_){for(var B=_.g.length+1,E=[],M=0;M<B;M++)E[M]=_.i(M)<<1|_.i(M-1)>>>31;return new o(E,_.h)}function R(_,B){var E=B>>5;B%=32;for(var M=_.g.length-E,k=[],T=0;T<M;T++)k[T]=0<B?_.i(T+E)>>>B|_.i(T+E+1)<<32-B:_.i(T+E);return new o(k,_.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,XL=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=A,o.fromString=u,ah=o}).apply(typeof pF<"u"?pF:typeof self<"u"?self:typeof window<"u"?window:{});var Iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var YL,up,ZL,sw,__,eU,tU,rU;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,H,ee){return w==Array.prototype||w==Object.prototype||(w[H]=ee.value),w};function r(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof Iv=="object"&&Iv];for(var H=0;H<w.length;++H){var ee=w[H];if(ee&&ee.Math==Math)return ee}throw Error("Cannot find global object")}var n=r(this);function s(w,H){if(H)e:{var ee=n;w=w.split(".");for(var ke=0;ke<w.length-1;ke++){var ht=w[ke];if(!(ht in ee))break e;ee=ee[ht]}w=w[w.length-1],ke=ee[w],H=H(ke),H!=ke&&H!=null&&e(ee,w,{configurable:!0,writable:!0,value:H})}}function a(w,H){w instanceof String&&(w+="");var ee=0,ke=!1,ht={next:function(){if(!ke&&ee<w.length){var yt=ee++;return{value:H(yt,w[yt]),done:!1}}return ke=!0,{done:!0,value:void 0}}};return ht[Symbol.iterator]=function(){return ht},ht}s("Array.prototype.values",function(w){return w||function(){return a(this,function(H,ee){return ee})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(w){var H=typeof w;return H=H!="object"?H:w?Array.isArray(w)?"array":H:"null",H=="array"||H=="object"&&typeof w.length=="number"}function A(w){var H=typeof w;return H=="object"&&w!=null||H=="function"}function u(w,H,ee){return w.call.apply(w.bind,arguments)}function d(w,H,ee){if(!w)throw Error();if(2<arguments.length){var ke=Array.prototype.slice.call(arguments,2);return function(){var ht=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ht,ke),w.apply(H,ht)}}return function(){return w.apply(H,arguments)}}function f(w,H,ee){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,f.apply(null,arguments)}function h(w,H){var ee=Array.prototype.slice.call(arguments,1);return function(){var ke=ee.slice();return ke.push.apply(ke,arguments),w.apply(this,ke)}}function m(w,H){function ee(){}ee.prototype=H.prototype,w.aa=H.prototype,w.prototype=new ee,w.prototype.constructor=w,w.Qb=function(ke,ht,yt){for(var Gt=Array(arguments.length-2),nn=2;nn<arguments.length;nn++)Gt[nn-2]=arguments[nn];return H.prototype[ht].apply(ke,Gt)}}function p(w){const H=w.length;if(0<H){const ee=Array(H);for(let ke=0;ke<H;ke++)ee[ke]=w[ke];return ee}return[]}function x(w,H){for(let ee=1;ee<arguments.length;ee++){const ke=arguments[ee];if(c(ke)){const ht=w.length||0,yt=ke.length||0;w.length=ht+yt;for(let Gt=0;Gt<yt;Gt++)w[ht+Gt]=ke[Gt]}else w.push(ke)}}class g{constructor(H,ee){this.i=H,this.j=ee,this.h=0,this.g=null}get(){let H;return 0<this.h?(this.h--,H=this.g,this.g=H.next,H.next=null):H=this.i(),H}}function y(w){return/^[\s\xa0]*$/.test(w)}function b(){var w=l.navigator;return w&&(w=w.userAgent)?w:""}function F(w){return F[" "](w),w}F[" "]=function(){};var P=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function R(w,H,ee){for(const ke in w)H.call(ee,w[ke],ke,w)}function _(w,H){for(const ee in w)H.call(void 0,w[ee],ee,w)}function B(w){const H={};for(const ee in w)H[ee]=w[ee];return H}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(w,H){let ee,ke;for(let ht=1;ht<arguments.length;ht++){ke=arguments[ht];for(ee in ke)w[ee]=ke[ee];for(let yt=0;yt<E.length;yt++)ee=E[yt],Object.prototype.hasOwnProperty.call(ke,ee)&&(w[ee]=ke[ee])}}function k(w){var H=1;w=w.split(":");const ee=[];for(;0<H&&w.length;)ee.push(w.shift()),H--;return w.length&&ee.push(w.join(":")),ee}function T(w){l.setTimeout(()=>{throw w},0)}function U(){var w=re;let H=null;return w.g&&(H=w.g,w.g=w.g.next,w.g||(w.h=null),H.next=null),H}class Z{constructor(){this.h=this.g=null}add(H,ee){const ke=pe.get();ke.set(H,ee),this.h?this.h.next=ke:this.g=ke,this.h=ke}}var pe=new g(()=>new ae,w=>w.reset());class ae{constructor(){this.next=this.g=this.h=null}set(H,ee){this.h=H,this.g=ee,this.next=null}reset(){this.next=this.g=this.h=null}}let he,de=!1,re=new Z,xe=()=>{const w=l.Promise.resolve(void 0);he=()=>{w.then(Ce)}};var Ce=()=>{for(var w;w=U();){try{w.h.call(w.g)}catch(ee){T(ee)}var H=pe;H.j(w),100>H.h&&(H.h++,w.next=H.g,H.g=w)}de=!1};function S(){this.s=this.s,this.C=this.C}S.prototype.s=!1,S.prototype.ma=function(){this.s||(this.s=!0,this.N())},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(w,H){this.type=w,this.g=this.target=H,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var w=!1,H=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const ee=()=>{};l.addEventListener("test",ee,H),l.removeEventListener("test",ee,H)}catch{}return w}();function j(w,H){if(I.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var ee=this.type=w.type,ke=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=H,H=w.relatedTarget){if(P){e:{try{F(H.nodeName);var ht=!0;break e}catch{}ht=!1}ht||(H=null)}}else ee=="mouseover"?H=w.fromElement:ee=="mouseout"&&(H=w.toElement);this.relatedTarget=H,ke?(this.clientX=ke.clientX!==void 0?ke.clientX:ke.pageX,this.clientY=ke.clientY!==void 0?ke.clientY:ke.pageY,this.screenX=ke.screenX||0,this.screenY=ke.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:O[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&j.aa.h.call(this)}}m(j,I);var O={2:"touch",3:"pen",4:"mouse"};j.prototype.h=function(){j.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),D=0;function Y(w,H,ee,ke,ht){this.listener=w,this.proxy=null,this.src=H,this.type=ee,this.capture=!!ke,this.ha=ht,this.key=++D,this.da=this.fa=!1}function se(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function ve(w){this.src=w,this.g={},this.h=0}ve.prototype.add=function(w,H,ee,ke,ht){var yt=w.toString();w=this.g[yt],w||(w=this.g[yt]=[],this.h++);var Gt=Oe(w,H,ke,ht);return-1<Gt?(H=w[Gt],ee||(H.fa=!1)):(H=new Y(H,this.src,yt,!!ke,ht),H.fa=ee,w.push(H)),H};function z(w,H){var ee=H.type;if(ee in w.g){var ke=w.g[ee],ht=Array.prototype.indexOf.call(ke,H,void 0),yt;(yt=0<=ht)&&Array.prototype.splice.call(ke,ht,1),yt&&(se(H),w.g[ee].length==0&&(delete w.g[ee],w.h--))}}function Oe(w,H,ee,ke){for(var ht=0;ht<w.length;++ht){var yt=w[ht];if(!yt.da&&yt.listener==H&&yt.capture==!!ee&&yt.ha==ke)return ht}return-1}var te="closure_lm_"+(1e6*Math.random()|0),J={};function q(w,H,ee,ke,ht){if(Array.isArray(H)){for(var yt=0;yt<H.length;yt++)q(w,H[yt],ee,ke,ht);return null}return ee=ft(ee),w&&w[W]?w.K(H,ee,A(ke)?!!ke.capture:!1,ht):ie(w,H,ee,!1,ke,ht)}function ie(w,H,ee,ke,ht,yt){if(!H)throw Error("Invalid event type");var Gt=A(ht)?!!ht.capture:!!ht,nn=ct(w);if(nn||(w[te]=nn=new ve(w)),ee=nn.add(H,ee,ke,Gt,yt),ee.proxy)return ee;if(ke=fe(),ee.proxy=ke,ke.src=w,ke.listener=ee,w.addEventListener)V||(ht=Gt),ht===void 0&&(ht=!1),w.addEventListener(H.toString(),ke,ht);else if(w.attachEvent)w.attachEvent(ze(H.toString()),ke);else if(w.addListener&&w.removeListener)w.addListener(ke);else throw Error("addEventListener and attachEvent are unavailable.");return ee}function fe(){function w(ee){return H.call(w.src,w.listener,ee)}const H=Ye;return w}function Ie(w,H,ee,ke,ht){if(Array.isArray(H))for(var yt=0;yt<H.length;yt++)Ie(w,H[yt],ee,ke,ht);else ke=A(ke)?!!ke.capture:!!ke,ee=ft(ee),w&&w[W]?(w=w.i,H=String(H).toString(),H in w.g&&(yt=w.g[H],ee=Oe(yt,ee,ke,ht),-1<ee&&(se(yt[ee]),Array.prototype.splice.call(yt,ee,1),yt.length==0&&(delete w.g[H],w.h--)))):w&&(w=ct(w))&&(H=w.g[H.toString()],w=-1,H&&(w=Oe(H,ee,ke,ht)),(ee=-1<w?H[w]:null)&&Ve(ee))}function Ve(w){if(typeof w!="number"&&w&&!w.da){var H=w.src;if(H&&H[W])z(H.i,w);else{var ee=w.type,ke=w.proxy;H.removeEventListener?H.removeEventListener(ee,ke,w.capture):H.detachEvent?H.detachEvent(ze(ee),ke):H.addListener&&H.removeListener&&H.removeListener(ke),(ee=ct(H))?(z(ee,w),ee.h==0&&(ee.src=null,H[te]=null)):se(w)}}}function ze(w){return w in J?J[w]:J[w]="on"+w}function Ye(w,H){if(w.da)w=!0;else{H=new j(H,this);var ee=w.listener,ke=w.ha||w.src;w.fa&&Ve(w),w=ee.call(ke,H)}return w}function ct(w){return w=w[te],w instanceof ve?w:null}var st="__closure_events_fn_"+(1e9*Math.random()>>>0);function ft(w){return typeof w=="function"?w:(w[st]||(w[st]=function(H){return w.handleEvent(H)}),w[st])}function nt(){S.call(this),this.i=new ve(this),this.M=this,this.F=null}m(nt,S),nt.prototype[W]=!0,nt.prototype.removeEventListener=function(w,H,ee,ke){Ie(this,w,H,ee,ke)};function De(w,H){var ee,ke=w.F;if(ke)for(ee=[];ke;ke=ke.F)ee.push(ke);if(w=w.M,ke=H.type||H,typeof H=="string")H=new I(H,w);else if(H instanceof I)H.target=H.target||w;else{var ht=H;H=new I(ke,w),M(H,ht)}if(ht=!0,ee)for(var yt=ee.length-1;0<=yt;yt--){var Gt=H.g=ee[yt];ht=Fe(Gt,ke,!0,H)&&ht}if(Gt=H.g=w,ht=Fe(Gt,ke,!0,H)&&ht,ht=Fe(Gt,ke,!1,H)&&ht,ee)for(yt=0;yt<ee.length;yt++)Gt=H.g=ee[yt],ht=Fe(Gt,ke,!1,H)&&ht}nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var w=this.i,H;for(H in w.g){for(var ee=w.g[H],ke=0;ke<ee.length;ke++)se(ee[ke]);delete w.g[H],w.h--}}this.F=null},nt.prototype.K=function(w,H,ee,ke){return this.i.add(String(w),H,!1,ee,ke)},nt.prototype.L=function(w,H,ee,ke){return this.i.add(String(w),H,!0,ee,ke)};function Fe(w,H,ee,ke){if(H=w.i.g[String(H)],!H)return!0;H=H.concat();for(var ht=!0,yt=0;yt<H.length;++yt){var Gt=H[yt];if(Gt&&!Gt.da&&Gt.capture==ee){var nn=Gt.listener,ps=Gt.ha||Gt.src;Gt.fa&&z(w.i,Gt),ht=nn.call(ps,ke)!==!1&&ht}}return ht&&!ke.defaultPrevented}function Ge(w,H,ee){if(typeof w=="function")ee&&(w=f(w,ee));else if(w&&typeof w.handleEvent=="function")w=f(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(H)?-1:l.setTimeout(w,H||0)}function _e(w){w.g=Ge(()=>{w.g=null,w.i&&(w.i=!1,_e(w))},w.l);const H=w.h;w.h=null,w.m.apply(null,H)}class G extends S{constructor(H,ee){super(),this.m=H,this.l=ee,this.h=null,this.i=!1,this.g=null}j(H){this.h=arguments,this.g?this.i=!0:_e(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ne(w){S.call(this),this.h=w,this.g={}}m(Ne,S);var Ue=[];function $e(w){R(w.g,function(H,ee){this.g.hasOwnProperty(ee)&&Ve(H)},w),w.g={}}Ne.prototype.N=function(){Ne.aa.N.call(this),$e(this)},Ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ge=l.JSON.stringify,Be=l.JSON.parse,Qe=class{stringify(w){return l.JSON.stringify(w,void 0)}parse(w){return l.JSON.parse(w,void 0)}};function Te(){}Te.prototype.h=null;function We(w){return w.h||(w.h=w.i())}function at(){}var bt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ot(){I.call(this,"d")}m(ot,I);function wt(){I.call(this,"c")}m(wt,I);var Lt={},Ar=null;function ir(){return Ar=Ar||new nt}Lt.La="serverreachability";function xr(w){I.call(this,Lt.La,w)}m(xr,I);function er(w){const H=ir();De(H,new xr(H))}Lt.STAT_EVENT="statevent";function et(w,H){I.call(this,Lt.STAT_EVENT,w),this.stat=H}m(et,I);function gt(w){const H=ir();De(H,new et(H,w))}Lt.Ma="timingevent";function Pt(w,H){I.call(this,Lt.Ma,w),this.size=H}m(Pt,I);function Ft(w,H){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){w()},H)}function Tt(){this.g=!0}Tt.prototype.xa=function(){this.g=!1};function Xt(w,H,ee,ke,ht,yt){w.info(function(){if(w.g)if(yt)for(var Gt="",nn=yt.split("&"),ps=0;ps<nn.length;ps++){var qr=nn[ps].split("=");if(1<qr.length){var hn=qr[0];qr=qr[1];var Hn=hn.split("_");Gt=2<=Hn.length&&Hn[1]=="type"?Gt+(hn+"="+qr+"&"):Gt+(hn+"=redacted&")}}else Gt=null;else Gt=yt;return"XMLHTTP REQ ("+ke+") [attempt "+ht+"]: "+H+`
`+ee+`
`+Gt})}function Vt(w,H,ee,ke,ht,yt,Gt){w.info(function(){return"XMLHTTP RESP ("+ke+") [ attempt "+ht+"]: "+H+`
`+ee+`
`+yt+" "+Gt})}function oe(w,H,ee,ke){w.info(function(){return"XMLHTTP TEXT ("+H+"): "+ue(w,ee)+(ke?" "+ke:"")})}function ne(w,H){w.info(function(){return"TIMEOUT: "+H})}Tt.prototype.info=function(){};function ue(w,H){if(!w.g)return H;if(!H)return null;try{var ee=JSON.parse(H);if(ee){for(w=0;w<ee.length;w++)if(Array.isArray(ee[w])){var ke=ee[w];if(!(2>ke.length)){var ht=ke[1];if(Array.isArray(ht)&&!(1>ht.length)){var yt=ht[0];if(yt!="noop"&&yt!="stop"&&yt!="close")for(var Gt=1;Gt<ht.length;Gt++)ht[Gt]=""}}}}return ge(ee)}catch{return H}}var K={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},le={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},me;function Re(){}m(Re,Te),Re.prototype.g=function(){return new XMLHttpRequest},Re.prototype.i=function(){return{}},me=new Re;function Ee(w,H,ee,ke){this.j=w,this.i=H,this.l=ee,this.R=ke||1,this.U=new Ne(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ye}function ye(){this.i=null,this.g="",this.h=!1}var Me={},Le={};function Je(w,H,ee){w.L=1,w.v=Rc(ea(H)),w.m=ee,w.P=!0,tt(w,null)}function tt(w,H){w.F=Date.now(),ut(w),w.A=ea(w.v);var ee=w.A,ke=w.R;Array.isArray(ke)||(ke=[String(ke)]),lf(ee.i,"t",ke),w.C=0,ee=w.j.J,w.h=new ye,w.g=Ns(w.j,ee?H:null,!w.m),0<w.O&&(w.M=new G(f(w.Y,w,w.g),w.O)),H=w.U,ee=w.g,ke=w.ca;var ht="readystatechange";Array.isArray(ht)||(ht&&(Ue[0]=ht.toString()),ht=Ue);for(var yt=0;yt<ht.length;yt++){var Gt=q(ee,ht[yt],ke||H.handleEvent,!1,H.h||H);if(!Gt)break;H.g[Gt.key]=Gt}H=w.H?B(w.H):{},w.m?(w.u||(w.u="POST"),H["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,H)):(w.u="GET",w.g.ea(w.A,w.u,null,H)),er(),Xt(w.i,w.u,w.A,w.l,w.R,w.m)}Ee.prototype.ca=function(w){w=w.target;const H=this.M;H&&wi(w)==3?H.j():this.Y(w)},Ee.prototype.Y=function(w){try{if(w==this.g)e:{const Hn=wi(this.g);var H=this.g.Ba();const ao=this.g.Z();if(!(3>Hn)&&(Hn!=3||this.g&&(this.h.h||this.g.oa()||_d(this.g)))){this.J||Hn!=4||H==7||(H==8||0>=ao?er(3):er(2)),wr(this);var ee=this.g.Z();this.X=ee;t:if(Xe(this)){var ke=_d(this.g);w="";var ht=ke.length,yt=wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Kr(this),ur(this);var Gt="";break t}this.h.i=new l.TextDecoder}for(H=0;H<ht;H++)this.h.h=!0,w+=this.h.i.decode(ke[H],{stream:!(yt&&H==ht-1)});ke.length=0,this.h.g+=w,this.C=0,Gt=this.h.g}else Gt=this.g.oa();if(this.o=ee==200,Vt(this.i,this.u,this.A,this.l,this.R,Hn,ee),this.o){if(this.T&&!this.K){t:{if(this.g){var nn,ps=this.g;if((nn=ps.g?ps.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(nn)){var qr=nn;break t}}qr=null}if(ee=qr)oe(this.i,this.l,ee,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$s(this,ee);else{this.o=!1,this.s=3,gt(12),Kr(this),ur(this);break e}}if(this.P){ee=!0;let Ja;for(;!this.J&&this.C<Gt.length;)if(Ja=Ze(this,Gt),Ja==Le){Hn==4&&(this.s=4,gt(14),ee=!1),oe(this.i,this.l,null,"[Incomplete Response]");break}else if(Ja==Me){this.s=4,gt(15),oe(this.i,this.l,Gt,"[Invalid Chunk]"),ee=!1;break}else oe(this.i,this.l,Ja,null),$s(this,Ja);if(Xe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Hn!=4||Gt.length!=0||this.h.h||(this.s=1,gt(16),ee=!1),this.o=this.o&&ee,!ee)oe(this.i,this.l,Gt,"[Invalid Chunked Response]"),Kr(this),ur(this);else if(0<Gt.length&&!this.W){this.W=!0;var hn=this.j;hn.g==this&&hn.ba&&!hn.M&&(hn.j.info("Great, no buffering proxy detected. Bytes received: "+Gt.length),nr(hn),hn.M=!0,gt(11))}}else oe(this.i,this.l,Gt,null),$s(this,Gt);Hn==4&&Kr(this),this.o&&!this.J&&(Hn==4?Fr(this.j,this):(this.o=!1,ut(this)))}else Af(this.g),ee==400&&0<Gt.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),Kr(this),ur(this)}}}catch{}finally{}};function Xe(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function Ze(w,H){var ee=w.C,ke=H.indexOf(`
`,ee);return ke==-1?Le:(ee=Number(H.substring(ee,ke)),isNaN(ee)?Me:(ke+=1,ke+ee>H.length?Le:(H=H.slice(ke,ke+ee),w.C=ke+ee,H)))}Ee.prototype.cancel=function(){this.J=!0,Kr(this)};function ut(w){w.S=Date.now()+w.I,Ht(w,w.I)}function Ht(w,H){if(w.B!=null)throw Error("WatchDog timer not null");w.B=Ft(f(w.ba,w),H)}function wr(w){w.B&&(l.clearTimeout(w.B),w.B=null)}Ee.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(ne(this.i,this.A),this.L!=2&&(er(),gt(17)),Kr(this),this.s=2,ur(this)):Ht(this,this.S-w)};function ur(w){w.j.G==0||w.J||Fr(w.j,w)}function Kr(w){wr(w);var H=w.M;H&&typeof H.ma=="function"&&H.ma(),w.M=null,$e(w.U),w.g&&(H=w.g,w.g=null,H.abort(),H.ma())}function $s(w,H){try{var ee=w.j;if(ee.G!=0&&(ee.g==w||Dn(ee.h,w))){if(!w.K&&Dn(ee.h,w)&&ee.G==3){try{var ke=ee.Da.g.parse(H)}catch{ke=null}if(Array.isArray(ke)&&ke.length==3){var ht=ke;if(ht[0]==0){e:if(!ee.u){if(ee.g)if(ee.g.F+3e3<w.F)br(ee),Qo(ee);else break e;jt(ee),gt(18)}}else ee.za=ht[1],0<ee.za-ee.T&&37500>ht[2]&&ee.F&&ee.v==0&&!ee.C&&(ee.C=Ft(f(ee.Za,ee),6e3));if(1>=no(ee.h)&&ee.ca){try{ee.ca()}catch{}ee.ca=void 0}}else pn(ee,11)}else if((w.K||ee.g==w)&&br(ee),!y(H))for(ht=ee.Da.g.parse(H),H=0;H<ht.length;H++){let qr=ht[H];if(ee.T=qr[0],qr=qr[1],ee.G==2)if(qr[0]=="c"){ee.K=qr[1],ee.ia=qr[2];const hn=qr[3];hn!=null&&(ee.la=hn,ee.j.info("VER="+ee.la));const Hn=qr[4];Hn!=null&&(ee.Aa=Hn,ee.j.info("SVER="+ee.Aa));const ao=qr[5];ao!=null&&typeof ao=="number"&&0<ao&&(ke=1.5*ao,ee.L=ke,ee.j.info("backChannelRequestTimeoutMs_="+ke)),ke=ee;const Ja=w.g;if(Ja){const Ta=Ja.g?Ja.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ta){var yt=ke.h;yt.g||Ta.indexOf("spdy")==-1&&Ta.indexOf("quic")==-1&&Ta.indexOf("h2")==-1||(yt.j=yt.l,yt.g=new Set,yt.h&&(Oi(yt,yt.h),yt.h=null))}if(ke.D){const vl=Ja.g?Ja.g.getResponseHeader("X-HTTP-Session-Id"):null;vl&&(ke.ya=vl,Xr(ke.I,ke.D,vl))}}ee.G=3,ee.l&&ee.l.ua(),ee.ba&&(ee.R=Date.now()-w.F,ee.j.info("Handshake RTT: "+ee.R+"ms")),ke=ee;var Gt=w;if(ke.qa=vn(ke,ke.J?ke.ia:null,ke.W),Gt.K){rf(ke.h,Gt);var nn=Gt,ps=ke.L;ps&&(nn.I=ps),nn.B&&(wr(nn),ut(nn)),ke.g=Gt}else Bt(ke);0<ee.i.length&&L(ee)}else qr[0]!="stop"&&qr[0]!="close"||pn(ee,7);else ee.G==3&&(qr[0]=="stop"||qr[0]=="close"?qr[0]=="stop"?pn(ee,7):MA(ee):qr[0]!="noop"&&ee.l&&ee.l.ta(qr),ee.v=0)}}er(4)}catch{}}var vi=class{constructor(w,H){this.g=w,this.map=H}};function Ui(w){this.l=w||10,l.PerformanceNavigationTiming?(w=l.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ga(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function no(w){return w.h?1:w.g?w.g.size:0}function Dn(w,H){return w.h?w.h==H:w.g?w.g.has(H):!1}function Oi(w,H){w.g?w.g.add(H):w.h=H}function rf(w,H){w.h&&w.h==H?w.h=null:w.g&&w.g.has(H)&&w.g.delete(H)}Ui.prototype.cancel=function(){if(this.i=ds(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function ds(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let H=w.i;for(const ee of w.g.values())H=H.concat(ee.D);return H}return p(w.i)}function nf(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map<"u"&&w instanceof Map||typeof Set<"u"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(c(w)){for(var H=[],ee=w.length,ke=0;ke<ee;ke++)H.push(w[ke]);return H}H=[],ee=0;for(ke in w)H[ee++]=w[ke];return H}function Ro(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map<"u"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set<"u"&&w instanceof Set)){if(c(w)||typeof w=="string"){var H=[];w=w.length;for(var ee=0;ee<w;ee++)H.push(ee);return H}H=[],ee=0;for(const ke in w)H[ee++]=ke;return H}}}function jc(w,H){if(w.forEach&&typeof w.forEach=="function")w.forEach(H,void 0);else if(c(w)||typeof w=="string")Array.prototype.forEach.call(w,H,void 0);else for(var ee=Ro(w),ke=nf(w),ht=ke.length,yt=0;yt<ht;yt++)H.call(void 0,ke[yt],ee&&ee[yt],w)}var yd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mi(w,H){if(w){w=w.split("&");for(var ee=0;ee<w.length;ee++){var ke=w[ee].indexOf("="),ht=null;if(0<=ke){var yt=w[ee].substring(0,ke);ht=w[ee].substring(ke+1)}else yt=w[ee];H(yt,ht?decodeURIComponent(ht.replace(/\+/g," ")):"")}}}function Ln(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof Ln){this.h=w.h,Pc(this,w.j),this.o=w.o,this.g=w.g,RA(this,w.s),this.l=w.l;var H=w.i,ee=new ka;ee.i=H.i,H.g&&(ee.g=new Map(H.g),ee.h=H.h),sf(this,ee),this.m=w.m}else w&&(H=String(w).match(yd))?(this.h=!1,Pc(this,H[1]||"",!0),this.o=Xl(H[2]||""),this.g=Xl(H[3]||"",!0),RA(this,H[4]),this.l=Xl(H[5]||"",!0),sf(this,H[6]||"",!0),this.m=Xl(H[7]||"")):(this.h=!1,this.i=new ka(null,this.h))}Ln.prototype.toString=function(){var w=[],H=this.j;H&&w.push(Do(H,af,!0),":");var ee=this.g;return(ee||H=="file")&&(w.push("//"),(H=this.o)&&w.push(Do(H,af,!0),"@"),w.push(encodeURIComponent(String(ee)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ee=this.s,ee!=null&&w.push(":",String(ee))),(ee=this.l)&&(this.g&&ee.charAt(0)!="/"&&w.push("/"),w.push(Do(ee,ee.charAt(0)=="/"?hm:dm,!0))),(ee=this.i.toString())&&w.push("?",ee),(ee=this.m)&&w.push("#",Do(ee,of)),w.join("")};function ea(w){return new Ln(w)}function Pc(w,H,ee){w.j=ee?Xl(H,!0):H,w.j&&(w.j=w.j.replace(/:$/,""))}function RA(w,H){if(H){if(H=Number(H),isNaN(H)||0>H)throw Error("Bad port number "+H);w.s=H}else w.s=null}function sf(w,H,ee){H instanceof ka?(w.i=H,fm(w.i,w.h)):(ee||(H=Do(H,bd)),w.i=new ka(H,w.h))}function Xr(w,H,ee){w.i.set(H,ee)}function Rc(w){return Xr(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function Xl(w,H){return w?H?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Do(w,H,ee){return typeof w=="string"?(w=encodeURI(w).replace(H,Dc),ee&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function Dc(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var af=/[#\/\?@]/g,dm=/[#\?:]/g,hm=/[#\?]/g,bd=/[#\?@]/g,of=/#/g;function ka(w,H){this.h=this.g=null,this.i=w||null,this.j=!!H}function Lo(w){w.g||(w.g=new Map,w.h=0,w.i&&Mi(w.i,function(H,ee){w.add(decodeURIComponent(H.replace(/\+/g," ")),ee)}))}t=ka.prototype,t.add=function(w,H){Lo(this),this.i=null,w=yr(this,w);var ee=this.g.get(w);return ee||this.g.set(w,ee=[]),ee.push(H),this.h+=1,this};function Yl(w,H){Lo(w),H=yr(w,H),w.g.has(H)&&(w.i=null,w.h-=w.g.get(H).length,w.g.delete(H))}function DA(w,H){return Lo(w),H=yr(w,H),w.g.has(H)}t.forEach=function(w,H){Lo(this),this.g.forEach(function(ee,ke){ee.forEach(function(ht){w.call(H,ht,ke,this)},this)},this)},t.na=function(){Lo(this);const w=Array.from(this.g.values()),H=Array.from(this.g.keys()),ee=[];for(let ke=0;ke<H.length;ke++){const ht=w[ke];for(let yt=0;yt<ht.length;yt++)ee.push(H[ke])}return ee},t.V=function(w){Lo(this);let H=[];if(typeof w=="string")DA(this,w)&&(H=H.concat(this.g.get(yr(this,w))));else{w=Array.from(this.g.values());for(let ee=0;ee<w.length;ee++)H=H.concat(w[ee])}return H},t.set=function(w,H){return Lo(this),this.i=null,w=yr(this,w),DA(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[H]),this.h+=1,this},t.get=function(w,H){return w?(w=this.V(w),0<w.length?String(w[0]):H):H};function lf(w,H,ee){Yl(w,H),0<ee.length&&(w.i=null,w.g.set(yr(w,H),p(ee)),w.h+=ee.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],H=Array.from(this.g.keys());for(var ee=0;ee<H.length;ee++){var ke=H[ee];const yt=encodeURIComponent(String(ke)),Gt=this.V(ke);for(ke=0;ke<Gt.length;ke++){var ht=yt;Gt[ke]!==""&&(ht+="="+encodeURIComponent(String(Gt[ke]))),w.push(ht)}}return this.i=w.join("&")};function yr(w,H){return H=String(H),w.j&&(H=H.toLowerCase()),H}function fm(w,H){H&&!w.j&&(Lo(w),w.i=null,w.g.forEach(function(ee,ke){var ht=ke.toLowerCase();ke!=ht&&(Yl(this,ke),lf(this,ht,ee))},w)),w.j=H}function mm(w,H){const ee=new Tt;if(l.Image){const ke=new Image;ke.onload=h(xa,ee,"TestLoadImage: loaded",!0,H,ke),ke.onerror=h(xa,ee,"TestLoadImage: error",!1,H,ke),ke.onabort=h(xa,ee,"TestLoadImage: abort",!1,H,ke),ke.ontimeout=h(xa,ee,"TestLoadImage: timeout",!1,H,ke),l.setTimeout(function(){ke.ontimeout&&ke.ontimeout()},1e4),ke.src=w}else H(!1)}function pm(w,H){const ee=new Tt,ke=new AbortController,ht=setTimeout(()=>{ke.abort(),xa(ee,"TestPingServer: timeout",!1,H)},1e4);fetch(w,{signal:ke.signal}).then(yt=>{clearTimeout(ht),yt.ok?xa(ee,"TestPingServer: ok",!0,H):xa(ee,"TestPingServer: server error",!1,H)}).catch(()=>{clearTimeout(ht),xa(ee,"TestPingServer: error",!1,H)})}function xa(w,H,ee,ke,ht){try{ht&&(ht.onload=null,ht.onerror=null,ht.onabort=null,ht.ontimeout=null),ke(ee)}catch{}}function gl(){this.g=new Qe}function gm(w,H,ee){const ke=ee||"";try{jc(w,function(ht,yt){let Gt=ht;A(ht)&&(Gt=ge(ht)),H.push(ke+yt+"="+encodeURIComponent(Gt))})}catch(ht){throw H.push(ke+"type="+encodeURIComponent("_badmap")),ht}}function LA(w){this.l=w.Ub||null,this.j=w.eb||!1}m(LA,Te),LA.prototype.g=function(){return new xl(this.l,this.j)},LA.prototype.i=function(w){return function(){return w}}({});function xl(w,H){nt.call(this),this.D=w,this.o=H,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(xl,nt),t=xl.prototype,t.open=function(w,H){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=H,this.readyState=1,Lc(this)},t.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const H={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(H.body=w),(this.D||l).fetch(new Request(this.A,H)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},t.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,Lc(this)),this.g&&(this.readyState=3,Lc(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;UA(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function UA(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}t.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var H=w.value?w.value:new Uint8Array(0);(H=this.v.decode(H,{stream:!w.done}))&&(this.response=this.responseText+=H)}w.done?so(this):Lc(this),this.readyState==3&&UA(this)}},t.Ra=function(w){this.g&&(this.response=this.responseText=w,so(this))},t.Qa=function(w){this.g&&(this.response=w,so(this))},t.ga=function(){this.g&&so(this)};function so(w){w.readyState=4,w.l=null,w.j=null,w.v=null,Lc(w)}t.setRequestHeader=function(w,H){this.u.append(w,H)},t.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],H=this.h.entries();for(var ee=H.next();!ee.done;)ee=ee.value,w.push(ee[0]+": "+ee[1]),ee=H.next();return w.join(`\r
`)};function Lc(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(xl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function Uo(w){let H="";return R(w,function(ee,ke){H+=ke,H+=":",H+=ee,H+=`\r
`}),H}function Nd(w,H,ee){e:{for(ke in ee){var ke=!1;break e}ke=!0}ke||(ee=Uo(ee),typeof w=="string"?ee!=null&&encodeURIComponent(String(ee)):Xr(w,H,ee))}function Tn(w){nt.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(Tn,nt);var Cd=/^https?$/i,cf=["POST","PUT"];t=Tn.prototype,t.Ha=function(w){this.J=w},t.ea=function(w,H,ee,ke){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);H=H?H.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():me.g(),this.v=this.o?We(this.o):We(me),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(H,String(w),!0),this.B=!1}catch(yt){Oo(this,yt);return}if(w=ee||"",ee=new Map(this.headers),ke)if(Object.getPrototypeOf(ke)===Object.prototype)for(var ht in ke)ee.set(ht,ke[ht]);else if(typeof ke.keys=="function"&&typeof ke.get=="function")for(const yt of ke.keys())ee.set(yt,ke.get(yt));else throw Error("Unknown input type for opt_headers: "+String(ke));ke=Array.from(ee.keys()).find(yt=>yt.toLowerCase()=="content-type"),ht=l.FormData&&w instanceof l.FormData,!(0<=Array.prototype.indexOf.call(cf,H,void 0))||ke||ht||ee.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[yt,Gt]of ee)this.g.setRequestHeader(yt,Gt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ec(this),this.u=!0,this.g.send(w),this.u=!1}catch(yt){Oo(this,yt)}};function Oo(w,H){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=H,w.m=5,OA(w),Zl(w)}function OA(w){w.A||(w.A=!0,De(w,"complete"),De(w,"error"))}t.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,De(this,"complete"),De(this,"abort"),Zl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zl(this,!0)),Tn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Uc(this):this.bb())},t.bb=function(){Uc(this)};function Uc(w){if(w.h&&typeof o<"u"&&(!w.v[1]||wi(w)!=4||w.Z()!=2)){if(w.u&&wi(w)==4)Ge(w.Ea,0,w);else if(De(w,"readystatechange"),wi(w)==4){w.h=!1;try{const Gt=w.Z();e:switch(Gt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var H=!0;break e;default:H=!1}var ee;if(!(ee=H)){var ke;if(ke=Gt===0){var ht=String(w.D).match(yd)[1]||null;!ht&&l.self&&l.self.location&&(ht=l.self.location.protocol.slice(0,-1)),ke=!Cd.test(ht?ht.toLowerCase():"")}ee=ke}if(ee)De(w,"complete"),De(w,"success");else{w.m=6;try{var yt=2<wi(w)?w.g.statusText:""}catch{yt=""}w.l=yt+" ["+w.Z()+"]",OA(w)}}finally{Zl(w)}}}}function Zl(w,H){if(w.g){ec(w);const ee=w.g,ke=w.v[0]?()=>{}:null;w.g=null,w.v=null,H||De(w,"ready");try{ee.onreadystatechange=ke}catch{}}}function ec(w){w.I&&(l.clearTimeout(w.I),w.I=null)}t.isActive=function(){return!!this.g};function wi(w){return w.g?w.g.readyState:0}t.Z=function(){try{return 2<wi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(w){if(this.g){var H=this.g.responseText;return w&&H.indexOf(w)==0&&(H=H.substring(w.length)),Be(H)}};function _d(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function Af(w){const H={};w=(w.g&&2<=wi(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let ke=0;ke<w.length;ke++){if(y(w[ke]))continue;var ee=k(w[ke]);const ht=ee[0];if(ee=ee[1],typeof ee!="string")continue;ee=ee.trim();const yt=H[ht]||[];H[ht]=yt,yt.push(ee)}_(H,function(ke){return ke.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function yi(w,H,ee){return ee&&ee.internalChannelParams&&ee.internalChannelParams[w]||H}function Mo(w){this.Aa=0,this.i=[],this.j=new Tt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=yi("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=yi("baseRetryDelayMs",5e3,w),this.cb=yi("retryDelaySeedMs",1e4,w),this.Wa=yi("forwardChannelMaxRetries",2,w),this.wa=yi("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new Ui(w&&w.concurrentRequestLimit),this.Da=new gl,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Mo.prototype,t.la=8,t.G=1,t.connect=function(w,H,ee,ke){gt(0),this.W=w,this.H=H||{},ee&&ke!==void 0&&(this.H.OSID=ee,this.H.OAID=ke),this.F=this.X,this.I=vn(this,null,this.W),L(this)};function MA(w){if(Ed(w),w.G==3){var H=w.U++,ee=ea(w.I);if(Xr(ee,"SID",w.K),Xr(ee,"RID",H),Xr(ee,"TYPE","terminate"),rt(w,ee),H=new Ee(w,w.j,H),H.L=2,H.v=Rc(ea(ee)),ee=!1,l.navigator&&l.navigator.sendBeacon)try{ee=l.navigator.sendBeacon(H.v.toString(),"")}catch{}!ee&&l.Image&&(new Image().src=H.v,ee=!0),ee||(H.g=Ns(H.j,null),H.g.ea(H.v)),H.F=Date.now(),ut(H)}hs(w)}function Qo(w){w.g&&(nr(w),w.g.cancel(),w.g=null)}function Ed(w){Qo(w),w.u&&(l.clearTimeout(w.u),w.u=null),br(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&l.clearTimeout(w.s),w.s=null)}function L(w){if(!ga(w.h)&&!w.s){w.s=!0;var H=w.Ga;he||xe(),de||(he(),de=!0),re.add(H,w),w.B=0}}function ce(w,H){return no(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=H.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=Ft(f(w.Ga,w,H),Yr(w,w.B)),w.B++,!0)}t.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const ht=new Ee(this,this.j,w);let yt=this.o;if(this.S&&(yt?(yt=B(yt),M(yt,this.S)):yt=this.S),this.m!==null||this.O||(ht.H=yt,yt=null),this.P)e:{for(var H=0,ee=0;ee<this.i.length;ee++){t:{var ke=this.i[ee];if("__data__"in ke.map&&(ke=ke.map.__data__,typeof ke=="string")){ke=ke.length;break t}ke=void 0}if(ke===void 0)break;if(H+=ke,4096<H){H=ee;break e}if(H===4096||ee===this.i.length-1){H=ee+1;break e}}H=1e3}else H=1e3;H=dt(this,ht,H),ee=ea(this.I),Xr(ee,"RID",w),Xr(ee,"CVER",22),this.D&&Xr(ee,"X-HTTP-Session-Id",this.D),rt(this,ee),yt&&(this.O?H="headers="+encodeURIComponent(String(Uo(yt)))+"&"+H:this.m&&Nd(ee,this.m,yt)),Oi(this.h,ht),this.Ua&&Xr(ee,"TYPE","init"),this.P?(Xr(ee,"$req",H),Xr(ee,"SID","null"),ht.T=!0,Je(ht,ee,null)):Je(ht,ee,H),this.G=2}}else this.G==3&&(w?He(this,w):this.i.length==0||ga(this.h)||He(this))};function He(w,H){var ee;H?ee=H.l:ee=w.U++;const ke=ea(w.I);Xr(ke,"SID",w.K),Xr(ke,"RID",ee),Xr(ke,"AID",w.T),rt(w,ke),w.m&&w.o&&Nd(ke,w.m,w.o),ee=new Ee(w,w.j,ee,w.B+1),w.m===null&&(ee.H=w.o),H&&(w.i=H.D.concat(w.i)),H=dt(w,ee,1e3),ee.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),Oi(w.h,ee),Je(ee,ke,H)}function rt(w,H){w.H&&R(w.H,function(ee,ke){Xr(H,ke,ee)}),w.l&&jc({},function(ee,ke){Xr(H,ke,ee)})}function dt(w,H,ee){ee=Math.min(w.i.length,ee);var ke=w.l?f(w.l.Na,w.l,w):null;e:{var ht=w.i;let yt=-1;for(;;){const Gt=["count="+ee];yt==-1?0<ee?(yt=ht[0].g,Gt.push("ofs="+yt)):yt=0:Gt.push("ofs="+yt);let nn=!0;for(let ps=0;ps<ee;ps++){let qr=ht[ps].g;const hn=ht[ps].map;if(qr-=yt,0>qr)yt=Math.max(0,ht[ps].g-100),nn=!1;else try{gm(hn,Gt,"req"+qr+"_")}catch{ke&&ke(hn)}}if(nn){ke=Gt.join("&");break e}}}return w=w.i.splice(0,ee),H.D=w,ke}function Bt(w){if(!w.g&&!w.u){w.Y=1;var H=w.Fa;he||xe(),de||(he(),de=!0),re.add(H,w),w.v=0}}function jt(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=Ft(f(w.Fa,w),Yr(w,w.v)),w.v++,!0)}t.Fa=function(){if(this.u=null,dr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=Ft(f(this.ab,this),w)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),Qo(this),dr(this))};function nr(w){w.A!=null&&(l.clearTimeout(w.A),w.A=null)}function dr(w){w.g=new Ee(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var H=ea(w.qa);Xr(H,"RID","rpc"),Xr(H,"SID",w.K),Xr(H,"AID",w.T),Xr(H,"CI",w.F?"0":"1"),!w.F&&w.ja&&Xr(H,"TO",w.ja),Xr(H,"TYPE","xmlhttp"),rt(w,H),w.m&&w.o&&Nd(H,w.m,w.o),w.L&&(w.g.I=w.L);var ee=w.g;w=w.ia,ee.L=1,ee.v=Rc(ea(H)),ee.m=null,ee.P=!0,tt(ee,w)}t.Za=function(){this.C!=null&&(this.C=null,Qo(this),jt(this),gt(19))};function br(w){w.C!=null&&(l.clearTimeout(w.C),w.C=null)}function Fr(w,H){var ee=null;if(w.g==H){br(w),nr(w),w.g=null;var ke=2}else if(Dn(w.h,H))ee=H.D,rf(w.h,H),ke=1;else return;if(w.G!=0){if(H.o)if(ke==1){ee=H.m?H.m.length:0,H=Date.now()-H.F;var ht=w.B;ke=ir(),De(ke,new Pt(ke,ee)),L(w)}else Bt(w);else if(ht=H.s,ht==3||ht==0&&0<H.X||!(ke==1&&ce(w,H)||ke==2&&jt(w)))switch(ee&&0<ee.length&&(H=w.h,H.i=H.i.concat(ee)),ht){case 1:pn(w,5);break;case 4:pn(w,10);break;case 3:pn(w,6);break;default:pn(w,2)}}}function Yr(w,H){let ee=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(ee*=2),ee*H}function pn(w,H){if(w.j.info("Error code "+H),H==2){var ee=f(w.fb,w),ke=w.Xa;const ht=!ke;ke=new Ln(ke||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Pc(ke,"https"),Rc(ke),ht?mm(ke.toString(),ee):pm(ke.toString(),ee)}else gt(2);w.G=0,w.l&&w.l.sa(H),hs(w),Ed(w)}t.fb=function(w){w?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function hs(w){if(w.G=0,w.ka=[],w.l){const H=ds(w.h);(H.length!=0||w.i.length!=0)&&(x(w.ka,H),x(w.ka,w.i),w.h.i.length=0,p(w.i),w.i.length=0),w.l.ra()}}function vn(w,H,ee){var ke=ee instanceof Ln?ea(ee):new Ln(ee);if(ke.g!="")H&&(ke.g=H+"."+ke.g),RA(ke,ke.s);else{var ht=l.location;ke=ht.protocol,H=H?H+"."+ht.hostname:ht.hostname,ht=+ht.port;var yt=new Ln(null);ke&&Pc(yt,ke),H&&(yt.g=H),ht&&RA(yt,ht),ee&&(yt.l=ee),ke=yt}return ee=w.D,H=w.ya,ee&&H&&Xr(ke,ee,H),Xr(ke,"VER",w.la),rt(w,ke),ke}function Ns(w,H,ee){if(H&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return H=w.Ca&&!w.pa?new Tn(new LA({eb:ee})):new Tn(w.pa),H.Ha(w.J),H}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function fs(){}t=fs.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Cs(){}Cs.prototype.g=function(w,H){return new ms(w,H)};function ms(w,H){nt.call(this),this.g=new Mo(H),this.l=w,this.h=H&&H.messageUrlParams||null,w=H&&H.messageHeaders||null,H&&H.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=H&&H.initMessageHeaders||null,H&&H.messageContentType&&(w?w["X-WebChannel-Content-Type"]=H.messageContentType:w={"X-WebChannel-Content-Type":H.messageContentType}),H&&H.va&&(w?w["X-WebChannel-Client-Profile"]=H.va:w={"X-WebChannel-Client-Profile":H.va}),this.g.S=w,(w=H&&H.Sb)&&!y(w)&&(this.g.m=w),this.v=H&&H.supportsCrossDomainXhr||!1,this.u=H&&H.sendRawJson||!1,(H=H&&H.httpSessionIdParam)&&!y(H)&&(this.g.D=H,w=this.h,w!==null&&H in w&&(w=this.h,H in w&&delete w[H])),this.j=new Ho(this)}m(ms,nt),ms.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ms.prototype.close=function(){MA(this.g)},ms.prototype.o=function(w){var H=this.g;if(typeof w=="string"){var ee={};ee.__data__=w,w=ee}else this.u&&(ee={},ee.__data__=ge(w),w=ee);H.i.push(new vi(H.Ya++,w)),H.G==3&&L(H)},ms.prototype.N=function(){this.g.l=null,delete this.j,MA(this.g),delete this.g,ms.aa.N.call(this)};function Qi(w){ot.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var H=w.__sm__;if(H){e:{for(const ee in H){w=ee;break e}w=void 0}(this.i=w)&&(w=this.i,H=H!==null&&w in H?H[w]:void 0),this.data=H}else this.data=w}m(Qi,ot);function Vo(){wt.call(this),this.status=1}m(Vo,wt);function Ho(w){this.g=w}m(Ho,fs),Ho.prototype.ua=function(){De(this.g,"a")},Ho.prototype.ta=function(w){De(this.g,new Qi(w))},Ho.prototype.sa=function(w){De(this.g,new Vo)},Ho.prototype.ra=function(){De(this.g,"b")},Cs.prototype.createWebChannel=Cs.prototype.g,ms.prototype.send=ms.prototype.o,ms.prototype.open=ms.prototype.m,ms.prototype.close=ms.prototype.close,rU=function(){return new Cs},tU=function(){return ir()},eU=Lt,__={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},K.NO_ERROR=0,K.TIMEOUT=8,K.HTTP_ERROR=6,sw=K,le.COMPLETE="complete",ZL=le,at.EventType=bt,bt.OPEN="a",bt.CLOSE="b",bt.ERROR="c",bt.MESSAGE="d",nt.prototype.listen=nt.prototype.K,up=at,Tn.prototype.listenOnce=Tn.prototype.L,Tn.prototype.getLastError=Tn.prototype.Ka,Tn.prototype.getLastErrorCode=Tn.prototype.Ba,Tn.prototype.getStatus=Tn.prototype.Z,Tn.prototype.getResponseJson=Tn.prototype.Oa,Tn.prototype.getResponseText=Tn.prototype.oa,Tn.prototype.send=Tn.prototype.ea,Tn.prototype.setWithCredentials=Tn.prototype.Ha,YL=Tn}).apply(typeof Iv<"u"?Iv:typeof self<"u"?self:typeof window<"u"?window:{});const gF="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ma.UNAUTHENTICATED=new Ma(null),Ma.GOOGLE_CREDENTIALS=new Ma("google-credentials-uid"),Ma.FIRST_PARTY=new Ma("first-party-uid"),Ma.MOCK_USER=new Ma("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch=new MB("@firebase/firestore");function Lf(){return Ch.logLevel}function Mt(t,...e){if(Ch.logLevel<=tn.DEBUG){const r=e.map(tS);Ch.debug(`Firestore (${Z0}): ${t}`,...r)}}function ki(t,...e){if(Ch.logLevel<=tn.ERROR){const r=e.map(tS);Ch.error(`Firestore (${Z0}): ${t}`,...r)}}function Yu(t,...e){if(Ch.logLevel<=tn.WARN){const r=e.map(tS);Ch.warn(`Firestore (${Z0}): ${t}`,...r)}}function tS(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t="Unexpected state"){const e=`FIRESTORE (${Z0}) INTERNAL ASSERTION FAILED: `+t;throw ki(e),new Error(e)}function mr(t,e){t||cr()}function Ir(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $t extends FA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ma.UNAUTHENTICATED))}shutdown(){}}class Lz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Uz{constructor(e){this.t=e,this.currentUser=Ma.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){mr(this.o===void 0);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Ll;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ll,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Mt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Mt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ll)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Mt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mr(typeof n.accessToken=="string"),new nU(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mr(e===null||typeof e=="string"),new Ma(e)}}class Oz{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Ma.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Mz{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Oz(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Ma.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vz{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){mr(this.o===void 0);const n=a=>{a.error!=null&&Mt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,Mt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{Mt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):Mt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(mr(typeof r.token=="string"),this.R=r.token,new Qz(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=Hz(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%e.length))}return n}}function Pr(t,e){return t<e?-1:t>e?1:0}function T0(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}function aU(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $t(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $t(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new $t(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $t(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Kt.fromMillis(Date.now())}static fromDate(e){return Kt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Kt(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pr(this.nanoseconds,e.nanoseconds):Pr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.timestamp=e}static fromTimestamp(e){return new gr(e)}static min(){return new gr(new Kt(0,0))}static max(){return new gr(new Kt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,r,n){r===void 0?r=0:r>e.length&&cr(),n===void 0?n=e.length-r:n>e.length-r&&cr(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ig.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ig?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=e.get(s),o=r.get(s);if(a<o)return-1;if(a>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class mn extends Ig{construct(e,r,n){return new mn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $t(Et.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new mn(r)}static emptyPath(){return new mn([])}}const Kz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ls extends Ig{construct(e,r,n){return new ls(e,r,n)}static isValidIdentifier(e){return Kz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ls.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ls(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new $t(Et.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new $t(Et.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new $t(Et.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(a(),s++)}if(a(),o)throw new $t(Et.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ls(r)}static emptyPath(){return new ls([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.path=e}static fromPath(e){return new Yt(mn.fromString(e))}static fromName(e){return new Yt(mn.fromString(e).popFirst(5))}static empty(){return new Yt(mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return mn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Yt(new mn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e,r,n,s){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=s}}function E_(t){return t.fields.find(e=>e.kind===2)}function Qd(t){return t.fields.filter(e=>e.kind!==2)}Xw.UNKNOWN_ID=-1;class aw{constructor(e,r){this.fieldPath=e,this.kind=r}}class Fg{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new Fg(0,Fo.min())}}function qz(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=gr.fromTimestamp(n===1e9?new Kt(r+1,0):new Kt(r,n));return new Fo(s,Yt.empty(),e)}function iU(t){return new Fo(t.readTime,t.key,-1)}class Fo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Fo(gr.min(),Yt.empty(),-1)}static max(){return new Fo(gr.max(),Yt.empty(),-1)}}function nS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Yt.comparator(t.documentKey,e.documentKey),r!==0?r:Pr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lU{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qh(t){if(t.code!==Et.FAILED_PRECONDITION||t.message!==oU)throw t;Mt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&cr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new vt((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof vt?r:vt.resolve(r)}catch(r){return vt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):vt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):vt.reject(r)}static resolve(e){return new vt((r,n)=>{r(e)})}static reject(e){return new vt((r,n)=>{n(e)})}static waitFor(e){return new vt((r,n)=>{let s=0,a=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++a,o&&a===s&&r()},c=>n(c))}),o=!0,a===s&&r()})}static or(e){let r=vt.resolve(!1);for(const n of e)r=r.next(s=>s?vt.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new vt((n,s)=>{const a=e.length,o=new Array(a);let l=0;for(let c=0;c<a;c++){const A=c;r(e[A]).next(u=>{o[A]=u,++l,l===a&&n(o)},u=>s(u))}})}static doWhile(e,r){return new vt((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new Ll,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new Dp(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const s=sS(n.target.error);this.V.reject(new Dp(e,s))}}static open(e,r,n,s){try{return new o2(r,e.transaction(s,n))}catch(a){throw new Dp(r,a)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Mt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new $z(r)}}class Gu{constructor(e,r,n){this.name=e,this.version=r,this.p=n,Gu.S(fa())===12.2&&ki("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Mt("SimpleDb","Removing database:",e),Kd(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!AL())return!1;if(Gu.v())return!0;const e=fa(),r=Gu.S(e),n=0<r&&r<10,s=cU(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Mt("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const o=a.target.result;r(o)},s.onblocked=()=>{n(new Dp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const o=a.target.error;o.name==="VersionError"?n(new $t(Et.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new $t(Et.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new Dp(e,o))},s.onupgradeneeded=a=>{Mt("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.p.O(o,s.transaction,a.oldVersion,this.version).next(()=>{Mt("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,s){const a=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=o2.open(this.db,e,a?"readonly":"readwrite",n),c=s(l).next(A=>(l.g(),A)).catch(A=>(l.abort(A),vt.reject(A))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,A=c.name!=="FirebaseError"&&o<3;if(Mt("SimpleDb","Transaction failed with error:",c.message,"Retrying:",A),this.close(),!A)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cU(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Gz{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Kd(this.B.delete())}}class Dp extends $t{constructor(e,r){super(Et.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function pd(t){return t.name==="IndexedDbTransactionError"}class $z{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Mt("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Mt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Kd(n)}add(e){return Mt("SimpleDb","ADD",this.store.name,e,e),Kd(this.store.add(e))}get(e){return Kd(this.store.get(e)).next(r=>(r===void 0&&(r=null),Mt("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Mt("SimpleDb","DELETE",this.store.name,e),Kd(this.store.delete(e))}count(){return Mt("SimpleDb","COUNT",this.store.name),Kd(this.store.count())}U(e,r){const n=this.options(e,r),s=n.index?this.store.index(n.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(n.range);return new vt((o,l)=>{a.onerror=c=>{l(c.target.error)},a.onsuccess=c=>{o(c.target.result)}})}{const a=this.cursor(n),o=[];return this.W(a,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new vt((s,a)=>{n.onerror=o=>{a(o.target.error)},n.onsuccess=o=>{s(o.target.result)}})}j(e,r){Mt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const s=this.cursor(n);return this.W(s,(a,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const s=this.cursor(n);return this.W(s,r)}Y(e){const r=this.cursor({});return new vt((n,s)=>{r.onerror=a=>{const o=sS(a.target.error);s(o)},r.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new vt((s,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new Gz(l),A=r(l.primaryKey,l.value,c);if(A instanceof vt){const u=A.catch(d=>(c.done(),vt.reject(d)));n.push(u)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>vt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function Kd(t){return new vt((e,r)=>{t.onsuccess=n=>{const s=n.target.result;e(s)},t.onerror=n=>{const s=sS(n.target.error);r(s)}})}let xF=!1;function sS(t){const e=Gu.S(fa());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new $t("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return xF||(xF=!0,setTimeout(()=>{throw n},0)),n}}return t}class zz{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Mt("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Mt("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){pd(r)?Mt("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Qh(r)}await this.X(6e4)})}}class Wz{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let s=r,a=!0;return vt.doWhile(()=>a===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Mt("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(l=>{s-=l,n.add(o)});a=!1})).next(()=>r-s)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(s=>this.localStore.localDocuments.getNextDocuments(e,r,s,n).next(a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,a)).next(l=>(Mt("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((s,a)=>{const o=iU(a);nS(o,n)>0&&(n=o)}),new Fo(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}il.oe=-1;function Cx(t){return t==null}function kg(t){return t===0&&1/t==-1/0}function Jz(t){return typeof t=="number"&&Number.isInteger(t)&&!kg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=vF(e)),e=Xz(t.get(r),e);return vF(e)}function Xz(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case"":r+="";break;default:r+=a}}return r}function vF(t){return t+""}function mc(t){const e=t.length;if(mr(e>=2),e===2)return mr(t.charAt(0)===""&&t.charAt(1)===""),mn.emptyPath();const r=e-2,n=[];let s="";for(let a=0;a<e;){const o=t.indexOf("",a);switch((o<0||o>r)&&cr(),t.charAt(o+1)){case"":const l=t.substring(a,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),n.push(c);break;case"":s+=t.substring(a,o),s+="\0";break;case"":s+=t.substring(a,o+1);break;default:cr()}a=o+2}return new mn(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(t,e){return[t,ji(e)]}function AU(t,e,r){return[t,ji(e),r]}const Yz={},Zz=["prefixPath","collectionGroup","readTime","documentId"],eW=["prefixPath","collectionGroup","documentId"],tW=["collectionGroup","readTime","prefixPath","documentId"],rW=["canonicalId","targetId"],nW=["targetId","path"],sW=["path","targetId"],aW=["collectionId","parent"],iW=["indexId","uid"],oW=["uid","sequenceNumber"],lW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],cW=["indexId","uid","orderedDocumentKey"],AW=["userId","collectionPath","documentId"],uW=["userId","collectionPath","largestBatchId"],dW=["userId","collectionGroup","largestBatchId"],uU=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],hW=[...uU,"documentOverlays"],dU=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],hU=dU,aS=[...hU,"indexConfiguration","indexState","indexEntries"],fW=aS,mW=[...aS,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_ extends lU{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function pa(t,e){const r=Ir(t);return Gu.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Vh(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function fU(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,r){this.comparator=e,this.root=r||Qa.EMPTY}insert(e,r){return new us(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Qa.BLACK,null,null))}remove(e){return new us(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qa.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fv(this.root,e,this.comparator,!0)}}class Fv{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qa{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??Qa.RED,this.left=s??Qa.EMPTY,this.right=a??Qa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new Qa(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Qa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Qa.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw cr();const e=this.left.check();if(e!==this.right.check())throw cr();return e+(this.isRed()?0:1)}}Qa.EMPTY=null,Qa.RED=!0,Qa.BLACK=!1;Qa.EMPTY=new class{constructor(){this.size=0}get key(){throw cr()}get value(){throw cr()}get color(){throw cr()}get left(){throw cr()}get right(){throw cr()}copy(e,r,n,s,a){return this}insert(e,r,n){return new Qa(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.comparator=e,this.data=new us(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new bF(this.data.getIterator())}getIteratorFrom(e){return new bF(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Rn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Rn(this.comparator);return r.data=e,r}}class bF{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function mf(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.fields=e,e.sort(ls.comparator)}static empty(){return new Ji([])}unionWith(e){let r=new Rn(ls.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ji(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return T0(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new mU("Invalid base64 string: "+a):a}}(e);return new qs(r)}static fromUint8Array(e){const r=function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a}(e);return new qs(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qs.EMPTY_BYTE_STRING=new qs("");const pW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function EA(t){if(mr(!!t),typeof t=="string"){let e=0;const r=pW.exec(t);if(mr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:as(t.seconds),nanos:as(t.nanos)}}function as(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zu(t){return typeof t=="string"?qs.fromBase64String(t):qs.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function oS(t){const e=t.mapValue.fields.__previous_value__;return iS(e)?oS(e):e}function Tg(t){const e=EA(t.mapValue.fields.__local_write_time__.timestampValue);return new Kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gW{constructor(e,r,n,s,a,o,l,c,A){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=A}}class ed{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new ed("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ed&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ow={nullValue:"NULL_VALUE"};function _h(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?iS(t)?4:pU(t)?9007199254740991:l2(t)?10:11:cr()}function Nc(t,e){if(t===e)return!0;const r=_h(t);if(r!==_h(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Tg(t).isEqual(Tg(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=EA(s.timestampValue),l=EA(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Zu(s.bytesValue).isEqual(Zu(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return as(s.geoPointValue.latitude)===as(a.geoPointValue.latitude)&&as(s.geoPointValue.longitude)===as(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return as(s.integerValue)===as(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=as(s.doubleValue),l=as(a.doubleValue);return o===l?kg(o)===kg(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return T0(t.arrayValue.values||[],e.arrayValue.values||[],Nc);case 10:case 11:return function(s,a){const o=s.mapValue.fields||{},l=a.mapValue.fields||{};if(yF(o)!==yF(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Nc(o[c],l[c])))return!1;return!0}(t,e);default:return cr()}}function jg(t,e){return(t.values||[]).find(r=>Nc(r,e))!==void 0}function td(t,e){if(t===e)return 0;const r=_h(t),n=_h(e);if(r!==n)return Pr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Pr(t.booleanValue,e.booleanValue);case 2:return function(a,o){const l=as(a.integerValue||a.doubleValue),c=as(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return NF(t.timestampValue,e.timestampValue);case 4:return NF(Tg(t),Tg(e));case 5:return Pr(t.stringValue,e.stringValue);case 6:return function(a,o){const l=Zu(a),c=Zu(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const l=a.split("/"),c=o.split("/");for(let A=0;A<l.length&&A<c.length;A++){const u=Pr(l[A],c[A]);if(u!==0)return u}return Pr(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const l=Pr(as(a.latitude),as(o.latitude));return l!==0?l:Pr(as(a.longitude),as(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return CF(t.arrayValue,e.arrayValue);case 10:return function(a,o){var l,c,A,u;const d=a.fields||{},f=o.fields||{},h=(l=d.value)===null||l===void 0?void 0:l.arrayValue,m=(c=f.value)===null||c===void 0?void 0:c.arrayValue,p=Pr(((A=h==null?void 0:h.values)===null||A===void 0?void 0:A.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:CF(h,m)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===Bu.mapValue&&o===Bu.mapValue)return 0;if(a===Bu.mapValue)return 1;if(o===Bu.mapValue)return-1;const l=a.fields||{},c=Object.keys(l),A=o.fields||{},u=Object.keys(A);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const f=Pr(c[d],u[d]);if(f!==0)return f;const h=td(l[c[d]],A[u[d]]);if(h!==0)return h}return Pr(c.length,u.length)}(t.mapValue,e.mapValue);default:throw cr()}}function NF(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Pr(t,e);const r=EA(t),n=EA(e),s=Pr(r.seconds,n.seconds);return s!==0?s:Pr(r.nanos,n.nanos)}function CF(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=td(r[s],n[s]);if(a)return a}return Pr(r.length,n.length)}function j0(t){return S_(t)}function S_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=EA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Zu(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Yt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=S_(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const o of n)a?a=!1:s+=",",s+=`${o}:${S_(r.fields[o])}`;return s+"}"}(t.mapValue):cr()}function Pg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function I_(t){return!!t&&"integerValue"in t}function Rg(t){return!!t&&"arrayValue"in t}function _F(t){return!!t&&"nullValue"in t}function EF(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lw(t){return!!t&&"mapValue"in t}function l2(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Lp(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Vh(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Lp(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Lp(t.arrayValue.values[r]);return e}return Object.assign({},t)}function pU(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const gU={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function xW(t){return"nullValue"in t?ow:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Pg(ed.empty(),Yt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?l2(t)?gU:{mapValue:{}}:cr()}function vW(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Pg(ed.empty(),Yt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gU:"mapValue"in t?l2(t)?{mapValue:{}}:Bu:cr()}function BF(t,e){const r=td(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function SF(t,e){const r=td(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e){this.value=e}static empty(){return new Ka({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!lw(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lp(r)}setAll(e){let r=ls.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=Lp(o):s.push(l.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());lw(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Nc(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];lw(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Vh(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new Ka(Lp(this.value))}}function xU(t){const e=[];return Vh(t.fields,(r,n)=>{const s=new ls([r]);if(lw(n)){const a=xU(n.mapValue).fields;if(a.length===0)e.push(s);else for(const o of a)e.push(s.child(o))}else e.push(s)}),new Ji(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,r,n,s,a,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new os(e,0,gr.min(),gr.min(),gr.min(),Ka.empty(),0)}static newFoundDocument(e,r,n,s){return new os(e,1,r,gr.min(),n,s,0)}static newNoDocument(e,r){return new os(e,2,r,gr.min(),gr.min(),Ka.empty(),0)}static newUnknownDocument(e,r){return new os(e,3,r,gr.min(),gr.min(),Ka.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(gr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ka.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ka.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof os&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new os(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,r){this.position=e,this.inclusive=r}}function IF(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],o=t.position[s];if(a.field.isKeyField()?n=Yt.comparator(Yt.fromName(o.referenceValue),r.key):n=td(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function FF(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Nc(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e,r="asc"){this.field=e,this.dir=r}}function wW(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{}class rn extends vU{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new yW(e,r,n):r==="array-contains"?new CW(e,n):r==="in"?new _U(e,n):r==="not-in"?new _W(e,n):r==="array-contains-any"?new EW(e,n):new rn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new bW(e,n):new NW(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(td(r,this.value)):r!==null&&_h(this.value)===_h(r)&&this.matchesComparison(td(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return cr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends vU{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new In(e,r)}matches(e){return R0(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function R0(t){return t.op==="and"}function F_(t){return t.op==="or"}function lS(t){return wU(t)&&R0(t)}function wU(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function k_(t){if(t instanceof rn)return t.field.canonicalString()+t.op.toString()+j0(t.value);if(lS(t))return t.filters.map(e=>k_(e)).join(",");{const e=t.filters.map(r=>k_(r)).join(",");return`${t.op}(${e})`}}function yU(t,e){return t instanceof rn?function(n,s){return s instanceof rn&&n.op===s.op&&n.field.isEqual(s.field)&&Nc(n.value,s.value)}(t,e):t instanceof In?function(n,s){return s instanceof In&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,o,l)=>a&&yU(o,s.filters[l]),!0):!1}(t,e):void cr()}function bU(t,e){const r=t.filters.concat(e);return In.create(r,t.op)}function NU(t){return t instanceof rn?function(r){return`${r.field.canonicalString()} ${r.op} ${j0(r.value)}`}(t):t instanceof In?function(r){return r.op.toString()+" {"+r.getFilters().map(NU).join(" ,")+"}"}(t):"Filter"}class yW extends rn{constructor(e,r,n){super(e,r,n),this.key=Yt.fromName(n.referenceValue)}matches(e){const r=Yt.comparator(e.key,this.key);return this.matchesComparison(r)}}class bW extends rn{constructor(e,r){super(e,"in",r),this.keys=CU("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class NW extends rn{constructor(e,r){super(e,"not-in",r),this.keys=CU("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function CU(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Yt.fromName(n.referenceValue))}class CW extends rn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Rg(r)&&jg(r.arrayValue,this.value)}}class _U extends rn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&jg(this.value.arrayValue,r)}}class _W extends rn{constructor(e,r){super(e,"not-in",r)}matches(e){if(jg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!jg(this.value.arrayValue,r)}}class EW extends rn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Rg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>jg(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BW{constructor(e,r=null,n=[],s=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=o,this.endAt=l,this.ue=null}}function T_(t,e=null,r=[],n=[],s=null,a=null,o=null){return new BW(t,e,r,n,s,a,o)}function Eh(t){const e=Ir(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>k_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Cx(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>j0(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>j0(n)).join(",")),e.ue=r}return e.ue}function _x(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!wW(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!yU(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!FF(t.startAt,e.startAt)&&FF(t.endAt,e.endAt)}function Yw(t){return Yt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Zw(t,e){return t.filters.filter(r=>r instanceof rn&&r.field.isEqual(e))}function kF(t,e,r){let n=ow,s=!0;for(const a of Zw(t,e)){let o=ow,l=!0;switch(a.op){case"<":case"<=":o=xW(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,l=!1;break;case"!=":case"not-in":o=ow}BF({value:n,inclusive:s},{value:o,inclusive:l})<0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];BF({value:n,inclusive:s},{value:o,inclusive:r.inclusive})<0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}function TF(t,e,r){let n=Bu,s=!0;for(const a of Zw(t,e)){let o=Bu,l=!0;switch(a.op){case">=":case">":o=vW(a.value),l=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,l=!1;break;case"!=":case"not-in":o=Bu}SF({value:n,inclusive:s},{value:o,inclusive:l})>0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];SF({value:n,inclusive:s},{value:o,inclusive:r.inclusive})>0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,r=null,n=[],s=[],a=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function SW(t,e,r,n,s,a,o,l){return new em(t,e,r,n,s,a,o,l)}function Ex(t){return new em(t)}function jF(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function EU(t){return t.collectionGroup!==null}function Up(t){const e=Ir(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Rn(ls.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(A=>{A.isInequality()&&(l=l.add(A.field))})}),l})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new Dg(a,n))}),r.has(ls.keyField().canonicalString())||e.ce.push(new Dg(ls.keyField(),n))}return e.ce}function Al(t){const e=Ir(t);return e.le||(e.le=IW(e,Up(t))),e.le}function IW(t,e){if(t.limitType==="F")return T_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Dg(s.field,a)});const r=t.endAt?new P0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new P0(t.startAt.position,t.startAt.inclusive):null;return T_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function j_(t,e){const r=t.filters.concat([e]);return new em(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function ey(t,e,r){return new em(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function c2(t,e){return _x(Al(t),Al(e))&&t.limitType===e.limitType}function BU(t){return`${Eh(Al(t))}|lt:${t.limitType}`}function Uf(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>NU(s)).join(", ")}]`),Cx(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>j0(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>j0(s)).join(",")),`Target(${n})`}(Al(t))}; limitType=${t.limitType})`}function Bx(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Yt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of Up(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,c){const A=IF(o,l,c);return o.inclusive?A<=0:A<0}(n.startAt,Up(n),s)||n.endAt&&!function(o,l,c){const A=IF(o,l,c);return o.inclusive?A>=0:A>0}(n.endAt,Up(n),s))}(t,e)}function FW(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function SU(t){return(e,r)=>{let n=!1;for(const s of Up(t)){const a=kW(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function kW(t,e,r){const n=t.field.isKeyField()?Yt.comparator(e.key,r.key):function(a,o,l){const c=o.data.field(a),A=l.data.field(a);return c!==null&&A!==null?td(c,A):cr()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return cr()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Vh(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return fU(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW=new us(Yt.comparator);function Eo(){return TW}const IU=new us(Yt.comparator);function dp(...t){let e=IU;for(const r of t)e=e.insert(r.key,r);return e}function FU(t){let e=IU;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function pc(){return Op()}function kU(){return Op()}function Op(){return new gd(t=>t.toString(),(t,e)=>t.isEqual(e))}const jW=new us(Yt.comparator),PW=new Rn(Yt.comparator);function Hr(...t){let e=PW;for(const r of t)e=e.add(r);return e}const RW=new Rn(Pr);function DW(){return RW}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kg(e)?"-0":e}}function TU(t){return{integerValue:""+t}}function LW(t,e){return Jz(e)?TU(e):cS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(){this._=void 0}}function UW(t,e,r){return t instanceof Lg?function(s,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&iS(a)&&(a=oS(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(r,e):t instanceof D0?PU(t,e):t instanceof L0?RU(t,e):function(s,a){const o=jU(s,a),l=PF(o)+PF(s.Pe);return I_(o)&&I_(s.Pe)?TU(l):cS(s.serializer,l)}(t,e)}function OW(t,e,r){return t instanceof D0?PU(t,e):t instanceof L0?RU(t,e):r}function jU(t,e){return t instanceof Ug?function(n){return I_(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Lg extends A2{}class D0 extends A2{constructor(e){super(),this.elements=e}}function PU(t,e){const r=DU(e);for(const n of t.elements)r.some(s=>Nc(s,n))||r.push(n);return{arrayValue:{values:r}}}class L0 extends A2{constructor(e){super(),this.elements=e}}function RU(t,e){let r=DU(e);for(const n of t.elements)r=r.filter(s=>!Nc(s,n));return{arrayValue:{values:r}}}class Ug extends A2{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function PF(t){return as(t.integerValue||t.doubleValue)}function DU(t){return Rg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MW{constructor(e,r){this.field=e,this.transform=r}}function QW(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof D0&&s instanceof D0||n instanceof L0&&s instanceof L0?T0(n.elements,s.elements,Nc):n instanceof Ug&&s instanceof Ug?Nc(n.Pe,s.Pe):n instanceof Lg&&s instanceof Lg}(t.transform,e.transform)}class VW{constructor(e,r){this.version=e,this.transformResults=r}}class cs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new cs}static exists(e){return new cs(void 0,e)}static updateTime(e){return new cs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cw(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class u2{}function LU(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new rm(t.key,cs.none()):new tm(t.key,t.data,cs.none());{const r=t.data,n=Ka.empty();let s=new Rn(ls.comparator);for(let a of e.fields)if(!s.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),s=s.add(a)}return new kA(t.key,n,new Ji(s.toArray()),cs.none())}}function HW(t,e,r){t instanceof tm?function(s,a,o){const l=s.value.clone(),c=DF(s.fieldTransforms,a,o.transformResults);l.setAll(c),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof kA?function(s,a,o){if(!cw(s.precondition,a))return void a.convertToUnknownDocument(o.version);const l=DF(s.fieldTransforms,a,o.transformResults),c=a.data;c.setAll(UU(s)),c.setAll(l),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function Mp(t,e,r,n){return t instanceof tm?function(a,o,l,c){if(!cw(a.precondition,o))return l;const A=a.value.clone(),u=LF(a.fieldTransforms,c,o);return A.setAll(u),o.convertToFoundDocument(o.version,A).setHasLocalMutations(),null}(t,e,r,n):t instanceof kA?function(a,o,l,c){if(!cw(a.precondition,o))return l;const A=LF(a.fieldTransforms,c,o),u=o.data;return u.setAll(UU(a)),u.setAll(A),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(a,o,l){return cw(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function KW(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=jU(n.transform,s||null);a!=null&&(r===null&&(r=Ka.empty()),r.set(n.field,a))}return r||null}function RF(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&T0(n,s,(a,o)=>QW(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class tm extends u2{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class kA extends u2{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function UU(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function DF(t,e,r){const n=new Map;mr(t.length===r.length);for(let s=0;s<r.length;s++){const a=t[s],o=a.transform,l=e.data.field(a.field);n.set(a.field,OW(o,l,r[s]))}return n}function LF(t,e,r){const n=new Map;for(const s of t){const a=s.transform,o=r.data.field(s.field);n.set(s.field,UW(a,o,e))}return n}class rm extends u2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AS extends u2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&HW(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Mp(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Mp(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=kU();return this.mutations.forEach(s=>{const a=e.get(s.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=r.has(s.key)?null:l;const c=LU(o,l);c!==null&&n.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(gr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Hr())}isEqual(e){return this.batchId===e.batchId&&T0(this.mutations,e.mutations,(r,n)=>RF(r,n))&&T0(this.baseMutations,e.baseMutations,(r,n)=>RF(r,n))}}class dS{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){mr(e.mutations.length===n.length);let s=function(){return jW}();const a=e.mutations;for(let o=0;o<a.length;o++)s=s.insert(a[o].key,n[o].version);return new dS(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qW{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ws,on;function OU(t){switch(t){default:return cr();case Et.CANCELLED:case Et.UNKNOWN:case Et.DEADLINE_EXCEEDED:case Et.RESOURCE_EXHAUSTED:case Et.INTERNAL:case Et.UNAVAILABLE:case Et.UNAUTHENTICATED:return!1;case Et.INVALID_ARGUMENT:case Et.NOT_FOUND:case Et.ALREADY_EXISTS:case Et.PERMISSION_DENIED:case Et.FAILED_PRECONDITION:case Et.ABORTED:case Et.OUT_OF_RANGE:case Et.UNIMPLEMENTED:case Et.DATA_LOSS:return!0}}function MU(t){if(t===void 0)return ki("GRPC error has no .code"),Et.UNKNOWN;switch(t){case Ws.OK:return Et.OK;case Ws.CANCELLED:return Et.CANCELLED;case Ws.UNKNOWN:return Et.UNKNOWN;case Ws.DEADLINE_EXCEEDED:return Et.DEADLINE_EXCEEDED;case Ws.RESOURCE_EXHAUSTED:return Et.RESOURCE_EXHAUSTED;case Ws.INTERNAL:return Et.INTERNAL;case Ws.UNAVAILABLE:return Et.UNAVAILABLE;case Ws.UNAUTHENTICATED:return Et.UNAUTHENTICATED;case Ws.INVALID_ARGUMENT:return Et.INVALID_ARGUMENT;case Ws.NOT_FOUND:return Et.NOT_FOUND;case Ws.ALREADY_EXISTS:return Et.ALREADY_EXISTS;case Ws.PERMISSION_DENIED:return Et.PERMISSION_DENIED;case Ws.FAILED_PRECONDITION:return Et.FAILED_PRECONDITION;case Ws.ABORTED:return Et.ABORTED;case Ws.OUT_OF_RANGE:return Et.OUT_OF_RANGE;case Ws.UNIMPLEMENTED:return Et.UNIMPLEMENTED;case Ws.DATA_LOSS:return Et.DATA_LOSS;default:return cr()}}(on=Ws||(Ws={}))[on.OK=0]="OK",on[on.CANCELLED=1]="CANCELLED",on[on.UNKNOWN=2]="UNKNOWN",on[on.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",on[on.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",on[on.NOT_FOUND=5]="NOT_FOUND",on[on.ALREADY_EXISTS=6]="ALREADY_EXISTS",on[on.PERMISSION_DENIED=7]="PERMISSION_DENIED",on[on.UNAUTHENTICATED=16]="UNAUTHENTICATED",on[on.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",on[on.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",on[on.ABORTED=10]="ABORTED",on[on.OUT_OF_RANGE=11]="OUT_OF_RANGE",on[on.UNIMPLEMENTED=12]="UNIMPLEMENTED",on[on.INTERNAL=13]="INTERNAL",on[on.UNAVAILABLE=14]="UNAVAILABLE",on[on.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GW(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=new ah([4294967295,4294967295],0);function UF(t){const e=GW().encode(t),r=new XL;return r.update(e),new Uint8Array(r.digest())}function OF(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ah([r,n],0),new ah([s,a],0)]}class fS{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new hp(`Invalid padding: ${r}`);if(n<0)throw new hp(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new hp(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new hp(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=ah.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(ah.fromNumber(n)));return s.compare($W)===1&&(s=new ah([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=UF(e),[n,s]=OF(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,s,a);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new fS(a,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=UF(e),[n,s]=OF(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,s,a);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class hp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Sx.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new d2(gr.min(),s,new us(Pr),Eo(),Hr())}}class Sx{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Sx(n,r,Hr(),Hr(),Hr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class QU{constructor(e,r){this.targetId=e,this.me=r}}class VU{constructor(e,r,n=qs.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class MF{constructor(){this.fe=0,this.ge=VF(),this.pe=qs.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Hr(),r=Hr(),n=Hr();return this.ge.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:cr()}}),new Sx(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=VF()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class zW{constructor(e){this.Le=e,this.Be=new Map,this.ke=Eo(),this.qe=QF(),this.Qe=new us(Pr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:cr()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const a=s.target;if(Yw(a))if(n===0){const o=new Yt(a.path);this.Ue(r,o,os.newNoDocument(o,gr.min()))}else mr(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const A=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,A)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let o,l;try{o=Zu(n).toUint8Array()}catch(c){if(c instanceof mU)return Yu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new fS(o,s,a)}catch(c){return Yu(c instanceof hp?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,a,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((a,o)=>{const l=this.Je(o);if(l){if(a.current&&Yw(l.target)){const c=new Yt(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,os.newNoDocument(c,e))}a.be&&(r.set(o,a.ve()),a.Ce())}});let n=Hr();this.qe.forEach((a,o)=>{let l=!0;o.forEachWhile(c=>{const A=this.Je(c);return!A||A.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const s=new d2(e,r,this.Qe,this.ke,n);return this.ke=Eo(),this.qe=QF(),this.Qe=new us(Pr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new MF,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Rn(Pr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Mt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new MF),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function QF(){return new us(Yt.comparator)}function VF(){return new us(Yt.comparator)}const WW={asc:"ASCENDING",desc:"DESCENDING"},JW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XW={and:"AND",or:"OR"};class YW{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function P_(t,e){return t.useProto3Json||Cx(e)?e:{value:e}}function U0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function HU(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ZW(t,e){return U0(t,e.toTimestamp())}function Sa(t){return mr(!!t),gr.fromTimestamp(function(r){const n=EA(r);return new Kt(n.seconds,n.nanos)}(t))}function mS(t,e){return R_(t,e).canonicalString()}function R_(t,e){const r=function(s){return new mn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function KU(t){const e=mn.fromString(t);return mr(ZU(e)),e}function Og(t,e){return mS(t.databaseId,e.path)}function dA(t,e){const r=KU(e);if(r.get(1)!==t.databaseId.projectId)throw new $t(Et.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $t(Et.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Yt($U(r))}function qU(t,e){return mS(t.databaseId,e)}function GU(t){const e=KU(t);return e.length===4?mn.emptyPath():$U(e)}function D_(t){return new mn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $U(t){return mr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function HF(t,e,r){return{name:Og(t,e),fields:r.value.mapValue.fields}}function eJ(t,e,r){const n=dA(t,e.name),s=Sa(e.updateTime),a=e.createTime?Sa(e.createTime):gr.min(),o=new Ka({mapValue:{fields:e.fields}}),l=os.newFoundDocument(n,s,a,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function tJ(t,e){return"found"in e?function(n,s){mr(!!s.found),s.found.name,s.found.updateTime;const a=dA(n,s.found.name),o=Sa(s.found.updateTime),l=s.found.createTime?Sa(s.found.createTime):gr.min(),c=new Ka({mapValue:{fields:s.found.fields}});return os.newFoundDocument(a,o,l,c)}(t,e):"missing"in e?function(n,s){mr(!!s.missing),mr(!!s.readTime);const a=dA(n,s.missing),o=Sa(s.readTime);return os.newNoDocument(a,o)}(t,e):cr()}function rJ(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(A){return A==="NO_CHANGE"?0:A==="ADD"?1:A==="REMOVE"?2:A==="CURRENT"?3:A==="RESET"?4:cr()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(A,u){return A.useProto3Json?(mr(u===void 0||typeof u=="string"),qs.fromBase64String(u||"")):(mr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),qs.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(A){const u=A.code===void 0?Et.UNKNOWN:MU(A.code);return new $t(u,A.message||"")}(o);r=new VU(n,s,a,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=dA(t,n.document.name),a=Sa(n.document.updateTime),o=n.document.createTime?Sa(n.document.createTime):gr.min(),l=new Ka({mapValue:{fields:n.document.fields}}),c=os.newFoundDocument(s,a,o,l),A=n.targetIds||[],u=n.removedTargetIds||[];r=new Aw(A,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=dA(t,n.document),a=n.readTime?Sa(n.readTime):gr.min(),o=os.newNoDocument(s,a),l=n.removedTargetIds||[];r=new Aw([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=dA(t,n.document),a=n.removedTargetIds||[];r=new Aw([],a,s,null)}else{if(!("filter"in e))return cr();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,o=new qW(s,a),l=n.targetId;r=new QU(l,o)}}return r}function Mg(t,e){let r;if(e instanceof tm)r={update:HF(t,e.key,e.value)};else if(e instanceof rm)r={delete:Og(t,e.key)};else if(e instanceof kA)r={update:HF(t,e.key,e.data),updateMask:lJ(e.fieldMask)};else{if(!(e instanceof AS))return cr();r={verify:Og(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const l=o.transform;if(l instanceof Lg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof D0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof L0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ug)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw cr()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:ZW(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:cr()}(t,e.precondition)),r}function L_(t,e){const r=e.currentDocument?function(a){return a.updateTime!==void 0?cs.updateTime(Sa(a.updateTime)):a.exists!==void 0?cs.exists(a.exists):cs.none()}(e.currentDocument):cs.none(),n=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)mr(l.setToServerValue==="REQUEST_TIME"),c=new Lg;else if("appendMissingElements"in l){const u=l.appendMissingElements.values||[];c=new D0(u)}else if("removeAllFromArray"in l){const u=l.removeAllFromArray.values||[];c=new L0(u)}else"increment"in l?c=new Ug(o,l.increment):cr();const A=ls.fromServerFormat(l.fieldPath);return new MW(A,c)}(t,s)):[];if(e.update){e.update.name;const s=dA(t,e.update.name),a=new Ka({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const A=c.fieldPaths||[];return new Ji(A.map(u=>ls.fromServerFormat(u)))}(e.updateMask);return new kA(s,a,o,r,n)}return new tm(s,a,r,n)}if(e.delete){const s=dA(t,e.delete);return new rm(s,r)}if(e.verify){const s=dA(t,e.verify);return new AS(s,r)}return cr()}function nJ(t,e){return t&&t.length>0?(mr(e!==void 0),t.map(r=>function(s,a){let o=s.updateTime?Sa(s.updateTime):Sa(a);return o.isEqual(gr.min())&&(o=Sa(a)),new VW(o,s.transformResults||[])}(r,e))):[]}function zU(t,e){return{documents:[qU(t,e.path)]}}function WU(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=qU(t,s);const a=function(A){if(A.length!==0)return YU(In.create(A,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(A){if(A.length!==0)return A.map(u=>function(f){return{field:Of(f.field),direction:aJ(f.dir)}}(u))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=P_(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(A){return{before:A.inclusive,values:A.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(A){return{before:!A.inclusive,values:A.position}}(e.endAt)),{_t:r,parent:s}}function JU(t){let e=GU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){mr(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(d){const f=XU(d);return f instanceof In&&lS(f)?f.getFilters():[f]}(r.where));let o=[];r.orderBy&&(o=function(d){return d.map(f=>function(m){return new Dg(Mf(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(r.orderBy));let l=null;r.limit&&(l=function(d){let f;return f=typeof d=="object"?d.value:d,Cx(f)?null:f}(r.limit));let c=null;r.startAt&&(c=function(d){const f=!!d.before,h=d.values||[];return new P0(h,f)}(r.startAt));let A=null;return r.endAt&&(A=function(d){const f=!d.before,h=d.values||[];return new P0(h,f)}(r.endAt)),SW(e,s,o,a,l,"F",c,A)}function sJ(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cr()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function XU(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Mf(r.unaryFilter.field);return rn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Mf(r.unaryFilter.field);return rn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Mf(r.unaryFilter.field);return rn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mf(r.unaryFilter.field);return rn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return cr()}}(t):t.fieldFilter!==void 0?function(r){return rn.create(Mf(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return cr()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return In.create(r.compositeFilter.filters.map(n=>XU(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return cr()}}(r.compositeFilter.op))}(t):cr()}function aJ(t){return WW[t]}function iJ(t){return JW[t]}function oJ(t){return XW[t]}function Of(t){return{fieldPath:t.canonicalString()}}function Mf(t){return ls.fromServerFormat(t.fieldPath)}function YU(t){return t instanceof rn?function(r){if(r.op==="=="){if(EF(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NAN"}};if(_F(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(EF(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NOT_NAN"}};if(_F(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Of(r.field),op:iJ(r.op),value:r.value}}}(t):t instanceof In?function(r){const n=r.getFilters().map(s=>YU(s));return n.length===1?n[0]:{compositeFilter:{op:oJ(r.op),filters:n}}}(t):cr()}function lJ(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function ZU(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,r,n,s,a=gr.min(),o=gr.min(),l=qs.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new oA(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new oA(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new oA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new oA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e){this.ct=e}}function cJ(t,e){let r;if(e.document)r=eJ(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Yt.fromSegments(e.noDocument.path),s=Sh(e.noDocument.readTime);r=os.newNoDocument(n,s),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return cr();{const n=Yt.fromSegments(e.unknownDocument.path),s=Sh(e.unknownDocument.version);r=os.newUnknownDocument(n,s)}}return e.readTime&&r.setReadTime(function(s){const a=new Kt(s[0],s[1]);return gr.fromTimestamp(a)}(e.readTime)),r}function KF(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:ty(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,o){return{name:Og(a,o.key),fields:o.data.value.mapValue.fields,updateTime:U0(a,o.version.toTimestamp()),createTime:U0(a,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:Bh(e.version)};else{if(!e.isUnknownDocument())return cr();n.unknownDocument={path:r.path.toArray(),version:Bh(e.version)}}return n}function ty(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Bh(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sh(t){const e=new Kt(t.seconds,t.nanoseconds);return gr.fromTimestamp(e)}function qd(t,e){const r=(e.baseMutations||[]).map(a=>L_(t.ct,a));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const l=e.mutations[a+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>L_(t.ct,a)),s=Kt.fromMillis(e.localWriteTimeMs);return new uS(e.batchId,s,r,n)}function fp(t){const e=Sh(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?Sh(t.lastLimboFreeSnapshotVersion):gr.min();let n;return n=function(a){return a.documents!==void 0}(t.query)?function(a){return mr(a.documents.length===1),Al(Ex(GU(a.documents[0])))}(t.query):function(a){return Al(JU(a))}(t.query),new oA(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,qs.fromBase64String(t.resumeToken))}function t6(t,e){const r=Bh(e.snapshotVersion),n=Bh(e.lastLimboFreeSnapshotVersion);let s;s=Yw(e.target)?zU(t.ct,e.target):WU(t.ct,e.target)._t;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Eh(e.target),readTime:r,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:s}}function r6(t){const e=JU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ey(e,e.limit,"L"):e}function Yb(t,e){return new hS(e.largestBatchId,L_(t.ct,e.overlayMutation))}function qF(t,e){const r=e.path.lastSegment();return[t,ji(e.path.popLast()),r]}function GF(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:Bh(n.readTime),documentKey:ji(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AJ{getBundleMetadata(e,r){return $F(e).get(r).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:Sh(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,r){return $F(e).put(function(s){return{bundleId:s.id,createTime:Bh(Sa(s.createTime)),version:s.version}}(r))}getNamedQuery(e,r){return zF(e).get(r).next(n=>{if(n)return function(a){return{name:a.name,query:r6(a.bundledQuery),readTime:Sh(a.readTime)}}(n)})}saveNamedQuery(e,r){return zF(e).put(function(s){return{name:s.name,readTime:Bh(Sa(s.readTime)),bundledQuery:s.bundledQuery}}(r))}}function $F(t){return pa(t,"bundles")}function zF(t){return pa(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new h2(e,n)}getOverlay(e,r){return Qm(e).get(qF(this.userId,r)).next(n=>n?Yb(this.serializer,n):null)}getOverlays(e,r){const n=pc();return vt.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){const s=[];return n.forEach((a,o)=>{const l=new hS(r,o);s.push(this.ht(e,l))}),vt.waitFor(s)}removeOverlaysForBatchId(e,r,n){const s=new Set;r.forEach(o=>s.add(ji(o.getCollectionPath())));const a=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);a.push(Qm(e).j("collectionPathOverlayIndex",l))}),vt.waitFor(a)}getOverlaysForCollection(e,r,n){const s=pc(),a=ji(r),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Qm(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const A=Yb(this.serializer,c);s.set(A.getKey(),A)}return s})}getOverlaysForCollectionGroup(e,r,n,s){const a=pc();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return Qm(e).J({index:"collectionGroupOverlayIndex",range:l},(c,A,u)=>{const d=Yb(this.serializer,A);a.size()<s||d.largestBatchId===o?(a.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>a)}ht(e,r){return Qm(e).put(function(s,a,o){const[l,c,A]=qF(a,o.mutation.key);return{userId:a,collectionPath:c,documentId:A,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Mg(s.ct,o.mutation)}}(this.serializer,this.userId,r))}}function Qm(t){return pa(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uJ{Pt(e){return pa(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?qs.fromUint8Array(n):qs.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(as(e.integerValue));else if("doubleValue"in e){const n=as(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),kg(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=EA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(Zu(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?pU(e)?this.dt(r,Number.MAX_SAFE_INTEGER):l2(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):cr()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const s of Object.keys(n))this.Vt(s,r),this.Tt(n[s],r)}wt(e,r){var n,s;const a=e.fields||{};this.dt(r,53);const o="value",l=((s=(n=a[o].arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.length)||0;this.dt(r,15),r.At(as(l)),this.Vt(o,r),this.Tt(a[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const s of n)this.Tt(s,r)}yt(e,r){this.dt(r,37),Yt.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}Gd.vt=new Gd;function dJ(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function WF(t){const e=64-function(n){let s=0;for(let a=0;a<8;++a){const o=dJ(255&n[a]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class hJ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const s=r.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const s=r.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const r=this.qt(e),n=WF(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=255&r[s]}Kt(e){const r=this.qt(e),n=WF(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=~(255&r[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let s=1;s<r.length;++s)r[s]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const s=new Uint8Array(n);s.set(this.buffer),this.buffer=s}}class fJ{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class mJ{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Vm{constructor(){this.jt=new hJ,this.Ht=new fJ(this.jt),this.Jt=new mJ(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,r,n,s){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=s}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new $d(this.indexId,this.documentKey,this.arrayValue,n)}}function ru(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=JF(t.arrayValue,e.arrayValue),r!==0?r:(r=JF(t.directionalValue,e.directionalValue),r!==0?r:Yt.comparator(t.documentKey,e.documentKey)))}function JF(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e){this.Xt=new Rn((r,n)=>ls.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(mr(e.collectionGroup===this.collectionId),this.nn)return!1;const r=E_(e);if(r!==void 0&&!this.sn(r))return!1;const n=Qd(e);let s=new Set,a=0,o=0;for(;a<n.length&&this.sn(n[a]);++a)s=s.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=n[a];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++a}for(;a<n.length;++a){const l=n[a];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Rn(ls.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new aw(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new aw(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new aw(n.field,n.dir==="asc"?0:1)));return new Xw(Xw.UNKNOWN_ID,this.collectionId,r,Fg.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){var e,r;if(mr(t instanceof rn||t instanceof In),t instanceof rn){if(t instanceof _U){const s=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(a=>rn.create(t.field,"==",a)))||[];return In.create(s,"or")}return t}const n=t.filters.map(s=>n6(s));return In.create(n,t.op)}function pJ(t){if(t.getFilters().length===0)return[];const e=M_(n6(t));return mr(s6(e)),U_(e)||O_(e)?[e]:e.getFilters()}function U_(t){return t instanceof rn}function O_(t){return t instanceof In&&lS(t)}function s6(t){return U_(t)||O_(t)||function(r){if(r instanceof In&&F_(r)){for(const n of r.getFilters())if(!U_(n)&&!O_(n))return!1;return!0}return!1}(t)}function M_(t){if(mr(t instanceof rn||t instanceof In),t instanceof rn)return t;if(t.filters.length===1)return M_(t.filters[0]);const e=t.filters.map(n=>M_(n));let r=In.create(e,t.op);return r=ry(r),s6(r)?r:(mr(r instanceof In),mr(R0(r)),mr(r.filters.length>1),r.filters.reduce((n,s)=>pS(n,s)))}function pS(t,e){let r;return mr(t instanceof rn||t instanceof In),mr(e instanceof rn||e instanceof In),r=t instanceof rn?e instanceof rn?function(s,a){return In.create([s,a],"and")}(t,e):YF(t,e):e instanceof rn?YF(e,t):function(s,a){if(mr(s.filters.length>0&&a.filters.length>0),R0(s)&&R0(a))return bU(s,a.getFilters());const o=F_(s)?s:a,l=F_(s)?a:s,c=o.filters.map(A=>pS(A,l));return In.create(c,"or")}(t,e),ry(r)}function YF(t,e){if(R0(e))return bU(e,t.getFilters());{const r=e.filters.map(n=>pS(t,n));return In.create(r,"or")}}function ry(t){if(mr(t instanceof rn||t instanceof In),t instanceof rn)return t;const e=t.getFilters();if(e.length===1)return ry(e[0]);if(wU(t))return t;const r=e.map(s=>ry(s)),n=[];return r.forEach(s=>{s instanceof rn?n.push(s):s instanceof In&&(s.op===t.op?n.push(...s.filters):n.push(s))}),n.length===1?n[0]:In.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gJ{constructor(){this.un=new gS}addToCollectionParentIndex(e,r){return this.un.add(r),vt.resolve()}getCollectionParents(e,r){return vt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return vt.resolve()}deleteFieldIndex(e,r){return vt.resolve()}deleteAllFieldIndexes(e){return vt.resolve()}createTargetIndexes(e,r){return vt.resolve()}getDocumentsMatchingTarget(e,r){return vt.resolve(null)}getIndexType(e,r){return vt.resolve(0)}getFieldIndexes(e,r){return vt.resolve([])}getNextCollectionGroupToUpdate(e){return vt.resolve(null)}getMinOffset(e,r){return vt.resolve(Fo.min())}getMinOffsetFromCollectionGroup(e,r){return vt.resolve(Fo.min())}updateCollectionGroup(e,r,n){return vt.resolve()}updateIndexEntries(e,r){return vt.resolve()}}class gS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Rn(mn.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Rn(mn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kv=new Uint8Array(0);class xJ{constructor(e,r){this.databaseId=r,this.cn=new gS,this.ln=new gd(n=>Eh(n),(n,s)=>_x(n,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),s=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const a={collectionId:n,parent:ji(s)};return ZF(e).put(a)}return vt.resolve()}getCollectionParents(e,r){const n=[],s=IDBKeyRange.bound([r,""],[aU(r),""],!1,!0);return ZF(e).U(s).next(a=>{for(const o of a){if(o.collectionId!==r)break;n.push(mc(o.parent))}return n})}addFieldIndex(e,r){const n=Hm(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete s.indexId;const a=n.add(s);if(r.indexState){const o=gf(e);return a.next(l=>{o.put(GF(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return a.next()}deleteFieldIndex(e,r){const n=Hm(e),s=gf(e),a=pf(e);return n.delete(r.indexId).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=Hm(e),n=pf(e),s=gf(e);return r.j().next(()=>n.j()).next(()=>s.j())}createTargetIndexes(e,r){return vt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(s=>{if(s===0||s===1){const a=new XF(n).an();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,r){const n=pf(e);let s=!0;const a=new Map;return vt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{s&&(s=!!l),a.set(o,l)})).next(()=>{if(s){let o=Hr();const l=[];return vt.forEach(a,(c,A)=>{Mt("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`}(c)} to execute ${Eh(r)}`);const u=function(b,F){const P=E_(F);if(P===void 0)return null;for(const R of Zw(b,P.fieldPath))switch(R.op){case"array-contains-any":return R.value.arrayValue.values||[];case"array-contains":return[R.value]}return null}(A,c),d=function(b,F){const P=new Map;for(const R of Qd(F))for(const _ of Zw(b,R.fieldPath))switch(_.op){case"==":case"in":P.set(R.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return P.set(R.fieldPath.canonicalString(),_.value),Array.from(P.values())}return null}(A,c),f=function(b,F){const P=[];let R=!0;for(const _ of Qd(F)){const B=_.kind===0?kF(b,_.fieldPath,b.startAt):TF(b,_.fieldPath,b.startAt);P.push(B.value),R&&(R=B.inclusive)}return new P0(P,R)}(A,c),h=function(b,F){const P=[];let R=!0;for(const _ of Qd(F)){const B=_.kind===0?TF(b,_.fieldPath,b.endAt):kF(b,_.fieldPath,b.endAt);P.push(B.value),R&&(R=B.inclusive)}return new P0(P,R)}(A,c),m=this.In(c,A,f),p=this.In(c,A,h),x=this.Tn(c,A,d),g=this.En(c.indexId,u,m,f.inclusive,p,h.inclusive,x);return vt.forEach(g,y=>n.G(y,r.limit).next(b=>{b.forEach(F=>{const P=Yt.fromSegments(F.documentKey);o.has(P)||(o=o.add(P),l.push(P))})}))}).next(()=>l)}return vt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=pJ(In.create(e.filters,"and")).map(n=>T_(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,s,a,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,a.length),A=c/(r!=null?r.length:1),u=[];for(let d=0;d<c;++d){const f=r?this.dn(r[d/A]):kv,h=this.An(e,f,n[d%A],s),m=this.Rn(e,f,a[d%A],o),p=l.map(x=>this.An(e,f,x,!0));u.push(...this.createRange(h,m,p))}return u}An(e,r,n,s){const a=new $d(e,Yt.empty(),r,n);return s?a:a.Zt()}Rn(e,r,n,s){const a=new $d(e,Yt.empty(),r,n);return s?a.Zt():a}Pn(e,r){const n=new XF(r),s=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,s).next(a=>{let o=null;for(const l of a)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const s=this.hn(r);return vt.forEach(s,a=>this.Pn(e,a).next(o=>{o?n!==0&&o.fields.length<function(c){let A=new Rn(ls.comparator),u=!1;for(const d of c.filters)for(const f of d.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:A=A.add(f.field));for(const d of c.orderBy)d.field.isKeyField()||(A=A.add(d.field));return A.size+(u?1:0)}(a)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&s.length>1&&n===2?1:n)}Vn(e,r){const n=new Vm;for(const s of Qd(e)){const a=r.data.field(s.fieldPath);if(a==null)return null;const o=n.Yt(s.kind);Gd.vt.It(a,o)}return n.zt()}dn(e){const r=new Vm;return Gd.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new Vm;return Gd.vt.It(Pg(this.databaseId,r),n.Yt(function(a){const o=Qd(a);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let s=[];s.push(new Vm);let a=0;for(const o of Qd(e)){const l=n[a++];for(const c of s)if(this.fn(r,o.fieldPath)&&Rg(l))s=this.gn(s,o,l);else{const A=c.Yt(o.kind);Gd.vt.It(l,A)}}return this.pn(s)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const s=[...e],a=[];for(const o of n.arrayValue.values||[])for(const l of s){const c=new Vm;c.seed(l.zt()),Gd.vt.It(o,c.Yt(r.kind)),a.push(c)}return a}fn(e,r){return!!e.filters.find(n=>n instanceof rn&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=Hm(e),s=gf(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(a=>{const o=[];return vt.forEach(a,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(u,d){const f=d?new Fg(d.sequenceNumber,new Fo(Sh(d.readTime),new Yt(mc(d.documentKey)),d.largestBatchId)):Fg.empty(),h=u.fields.map(([m,p])=>new aw(ls.fromServerFormat(m),p));return new Xw(u.indexId,u.collectionGroup,h,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,s)=>{const a=n.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:Pr(n.collectionGroup,s.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const s=Hm(e),a=gf(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>vt.forEach(l,c=>a.put(GF(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return vt.forEach(r,(s,a)=>{const o=n.get(s.collectionGroup);return(o?vt.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(n.set(s.collectionGroup,l),vt.forEach(l,c=>this.wn(e,s,c).next(A=>{const u=this.Sn(a,c);return A.isEqual(u)?vt.resolve():this.bn(e,a,c,A,u)}))))})}Dn(e,r,n,s){return pf(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,s){return pf(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const s=pf(e);let a=new Rn(ru);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{a=a.add(new $d(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>a)}Sn(e,r){let n=new Rn(ru);const s=this.Vn(r,e);if(s==null)return n;const a=E_(r);if(a!=null){const o=e.data.field(a.fieldPath);if(Rg(o))for(const l of o.arrayValue.values||[])n=n.add(new $d(r.indexId,e.key,this.dn(l),s))}else n=n.add(new $d(r.indexId,e.key,kv,s));return n}bn(e,r,n,s,a){Mt("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,A,u,d,f){const h=c.getIterator(),m=A.getIterator();let p=mf(h),x=mf(m);for(;p||x;){let g=!1,y=!1;if(p&&x){const b=u(p,x);b<0?y=!0:b>0&&(g=!0)}else p!=null?y=!0:g=!0;g?(d(x),x=mf(m)):y?(f(p),p=mf(h)):(p=mf(h),x=mf(m))}}(s,a,ru,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),vt.waitFor(o)}yn(e){let r=1;return gf(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,s,a)=>{a.done(),r=s.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>ru(o,l)).filter((o,l,c)=>!l||ru(o,c[l-1])!==0);const s=[];s.push(e);for(const o of n){const l=ru(o,e),c=ru(o,r);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(r);const a=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const l=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,kv,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,kv,[]];a.push(IDBKeyRange.bound(l,c))}return a}Cn(e,r){return ru(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(ek)}getMinOffset(e,r){return vt.mapArray(this.hn(r),n=>this.Pn(e,n).next(s=>s||cr())).next(ek)}}function ZF(t){return pa(t,"collectionParents")}function pf(t){return pa(t,"indexEntries")}function Hm(t){return pa(t,"indexConfiguration")}function gf(t){return pa(t,"indexState")}function ek(t){mr(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const s=t[n].indexState.offset;nS(s,e)<0&&(e=s),r<s.largestBatchId&&(r=s.largestBatchId)}return new Fo(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Gi{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Gi(e,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a6(t,e,r){const n=t.store("mutations"),s=t.store("documentMutations"),a=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(u,d,f)=>(l++,f.delete()));a.push(c.next(()=>{mr(l===1)}));const A=[];for(const u of r.mutations){const d=AU(e,u.key.path,r.batchId);a.push(s.delete(d)),A.push(u.key)}return vt.waitFor(a).next(()=>A)}function ny(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw cr();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gi.DEFAULT_COLLECTION_PERCENTILE=10,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gi.DEFAULT=new Gi(41943040,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gi.DISABLED=new Gi(-1,0,0);class f2{constructor(e,r,n,s){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=s,this.Fn={}}static lt(e,r,n,s){mr(e.uid!=="");const a=e.isAuthenticated()?e.uid:"";return new f2(a,r,n,s)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return nu(e).J({index:"userMutationsIndex",range:n},(s,a,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,s){const a=Qf(e),o=nu(e);return o.add({}).next(l=>{mr(typeof l=="number");const c=new uS(l,r,n,s),A=function(h,m,p){const x=p.baseMutations.map(y=>Mg(h.ct,y)),g=p.mutations.map(y=>Mg(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:g}}(this.serializer,this.userId,c),u=[];let d=new Rn((f,h)=>Pr(f.canonicalString(),h.canonicalString()));for(const f of s){const h=AU(this.userId,f.key.path,l);d=d.add(f.key.path.popLast()),u.push(o.put(A)),u.push(a.put(h,Yz))}return d.forEach(f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),vt.waitFor(u).next(()=>c)})}lookupMutationBatch(e,r){return nu(e).get(r).next(n=>n?(mr(n.userId===this.userId),qd(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?vt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const s=n.keys();return this.Fn[r]=s,s}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return nu(e).J({index:"userMutationsIndex",range:s},(o,l,c)=>{l.userId===this.userId&&(mr(l.batchId>=n),a=qd(this.serializer,l)),c.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return nu(e).J({index:"userMutationsIndex",range:r,reverse:!0},(s,a,o)=>{n=a.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return nu(e).U("userMutationsIndex",r).next(n=>n.map(s=>qd(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=iw(this.userId,r.path),s=IDBKeyRange.lowerBound(n),a=[];return Qf(e).J({range:s},(o,l,c)=>{const[A,u,d]=o,f=mc(u);if(A===this.userId&&r.path.isEqual(f))return nu(e).get(d).next(h=>{if(!h)throw cr();mr(h.userId===this.userId),a.push(qd(this.serializer,h))});c.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Rn(Pr);const s=[];return r.forEach(a=>{const o=iw(this.userId,a.path),l=IDBKeyRange.lowerBound(o),c=Qf(e).J({range:l},(A,u,d)=>{const[f,h,m]=A,p=mc(h);f===this.userId&&a.path.isEqual(p)?n=n.add(m):d.done()});s.push(c)}),vt.waitFor(s).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1,a=iw(this.userId,n),o=IDBKeyRange.lowerBound(a);let l=new Rn(Pr);return Qf(e).J({range:o},(c,A,u)=>{const[d,f,h]=c,m=mc(f);d===this.userId&&n.isPrefixOf(m)?m.length===s&&(l=l.add(h)):u.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],s=[];return r.forEach(a=>{s.push(nu(e).get(a).next(o=>{if(o===null)throw cr();mr(o.userId===this.userId),n.push(qd(this.serializer,o))}))}),vt.waitFor(s).next(()=>n)}removeMutationBatch(e,r){return a6(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),vt.forEach(n,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return vt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Qf(e).J({range:n},(a,o,l)=>{if(a[0]===this.userId){const c=mc(a[1]);s.push(c)}else l.done()}).next(()=>{mr(s.length===0)})})}containsKey(e,r){return i6(e,this.userId,r)}Nn(e){return o6(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function i6(t,e,r){const n=iw(e,r.path),s=n[1],a=IDBKeyRange.lowerBound(n);let o=!1;return Qf(t).J({range:a,H:!0},(l,c,A)=>{const[u,d,f]=l;u===e&&d===s&&(o=!0),A.done()}).next(()=>o)}function nu(t){return pa(t,"mutations")}function Qf(t){return pa(t,"documentMutations")}function o6(t){return pa(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ih(0)}static kn(){return new Ih(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new Ih(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>gr.fromTimestamp(new Kt(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(s=>(s.highestListenSequenceNumber=r,n&&(s.lastRemoteSnapshotVersion=n.toTimestamp()),r>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=r),this.Qn(e,s)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>xf(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(mr(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let s=0;const a=[];return xf(e).J((o,l)=>{const c=fp(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(s++,a.push(this.removeTargetData(e,c)))}).next(()=>vt.waitFor(a)).next(()=>s)}forEachTarget(e,r){return xf(e).J((n,s)=>{const a=fp(s);r(a)})}qn(e){return rk(e).get("targetGlobalKey").next(r=>(mr(r!==null),r))}Qn(e,r){return rk(e).put("targetGlobalKey",r)}Kn(e,r){return xf(e).put(t6(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=Eh(r),s=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return xf(e).J({range:s,index:"queryTargetsIndex"},(o,l,c)=>{const A=fp(l);_x(r,A.target)&&(a=A,c.done())}).next(()=>a)}addMatchingKeys(e,r,n){const s=[],a=bu(e);return r.forEach(o=>{const l=ji(o.path);s.push(a.put({targetId:n,path:l})),s.push(this.referenceDelegate.addReference(e,n,o))}),vt.waitFor(s)}removeMatchingKeys(e,r,n){const s=bu(e);return vt.forEach(r,a=>{const o=ji(a.path);return vt.waitFor([s.delete([n,o]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,r){const n=bu(e),s=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(s)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),s=bu(e);let a=Hr();return s.J({range:n,H:!0},(o,l,c)=>{const A=mc(o[1]),u=new Yt(A);a=a.add(u)}).next(()=>a)}containsKey(e,r){const n=ji(r.path),s=IDBKeyRange.bound([n],[aU(n)],!1,!0);let a=0;return bu(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,l],c,A)=>{o!==0&&(a++,A.done())}).next(()=>a>0)}ot(e,r){return xf(e).get(r).next(n=>n?fp(n):null)}}function xf(t){return pa(t,"targets")}function rk(t){return pa(t,"targetGlobal")}function bu(t){return pa(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk([t,e],[r,n]){const s=Pr(t,r);return s===0?Pr(e,n):s}class wJ{constructor(e){this.Un=e,this.buffer=new Rn(nk),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();nk(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class yJ{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Mt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){pd(r)?Mt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Qh(r)}await this.Hn(3e5)})}}class bJ{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return vt.resolve(il.oe);const n=new wJ(r);return this.Jn.forEachTarget(e,s=>n.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>n.zn(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Mt("LruGarbageCollector","Garbage collection skipped; disabled"),vt.resolve(tk)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Mt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tk):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,s,a,o,l,c,A;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(Mt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(e,s))).next(d=>(n=d,l=Date.now(),this.removeTargets(e,n,r))).next(d=>(a=d,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(A=Date.now(),Lf()<=tn.DEBUG&&Mt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${a} targets in `+(c-l)+`ms
	Removed ${d} documents in `+(A-c)+`ms
Total Duration: ${A-u}ms`),vt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:d})))}}function NJ(t,e){return new bJ(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CJ{constructor(e,r){this.db=e,this.garbageCollector=NJ(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,s)=>r(s))}addReference(e,r,n){return Tv(e,n)}removeReference(e,r,n){return Tv(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return Tv(e,r)}nr(e,r){return function(s,a){let o=!1;return o6(s).Y(l=>i6(s,l,a).next(c=>(c&&(o=!0),vt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(A=>{if(!A)return a++,n.getEntry(e,o).next(()=>(n.removeEntry(o,gr.min()),bu(e).delete(function(d){return[0,ji(d.path)]}(o))))});s.push(c)}}).next(()=>vt.waitFor(s)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return Tv(e,r)}tr(e,r){const n=bu(e);let s,a=il.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:A})=>{o===0?(a!==il.oe&&r(new Yt(mc(s)),a),a=A,s=c):a=il.oe}).next(()=>{a!==il.oe&&r(new Yt(mc(s)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tv(t,e){return bu(t).put(function(n,s){return{targetId:0,path:ji(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(){this.changes=new gd(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,os.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?vt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _J{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return kd(e).put(n)}removeEntry(e,r,n){return kd(e).delete(function(a,o){const l=a.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],ty(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=os.newInvalidDocument(r);return kd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Km(r))},(s,a)=>{n=this.ir(r,a)}).next(()=>n)}sr(e,r){let n={size:0,document:os.newInvalidDocument(r)};return kd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Km(r))},(s,a)=>{n={document:this.ir(r,a),size:ny(a)}}).next(()=>n)}getEntries(e,r){let n=Eo();return this._r(e,r,(s,a)=>{const o=this.ir(s,a);n=n.insert(s,o)}).next(()=>n)}ar(e,r){let n=Eo(),s=new us(Yt.comparator);return this._r(e,r,(a,o)=>{const l=this.ir(a,o);n=n.insert(a,l),s=s.insert(a,ny(o))}).next(()=>({documents:n,ur:s}))}_r(e,r,n){if(r.isEmpty())return vt.resolve();let s=new Rn(ik);r.forEach(c=>s=s.add(c));const a=IDBKeyRange.bound(Km(s.first()),Km(s.last())),o=s.getIterator();let l=o.getNext();return kd(e).J({index:"documentKeyIndex",range:a},(c,A,u)=>{const d=Yt.fromSegments([...A.prefixPath,A.collectionGroup,A.documentId]);for(;l&&ik(l,d)<0;)n(l,null),l=o.getNext();l&&l.isEqual(d)&&(n(l,A),l=o.hasNext()?o.getNext():null),l?u.$(Km(l)):u.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,s,a){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),ty(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return kd(e).U(IDBKeyRange.bound(l,c,!0)).next(A=>{a==null||a.incrementDocumentReadCount(A.length);let u=Eo();for(const d of A){const f=this.ir(Yt.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);f.isFoundDocument()&&(Bx(r,f)||s.has(f.key))&&(u=u.insert(f.key,f))}return u})}getAllFromCollectionGroup(e,r,n,s){let a=Eo();const o=ak(r,n),l=ak(r,Fo.max());return kd(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,A,u)=>{const d=this.ir(Yt.fromSegments(A.prefixPath.concat(A.collectionGroup,A.documentId)),A);a=a.insert(d.key,d),a.size===s&&u.done()}).next(()=>a)}newChangeBuffer(e){return new EJ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return sk(e).get("remoteDocumentGlobalKey").next(r=>(mr(!!r),r))}rr(e,r){return sk(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=cJ(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(gr.min())))return n}return os.newInvalidDocument(e)}}function c6(t){return new _J(t)}class EJ extends l6{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new gd(n=>n.toString(),(n,s)=>n.isEqual(s))}applyChanges(e){const r=[];let n=0,s=new Rn((a,o)=>Pr(a.canonicalString(),o.canonicalString()));return this.changes.forEach((a,o)=>{const l=this.lr.get(a);if(r.push(this.cr.removeEntry(e,a,l.readTime)),o.isValidDocument()){const c=KF(this.cr.serializer,o);s=s.add(a.path.popLast());const A=ny(c);n+=A-l.size,r.push(this.cr.addEntry(e,a,c))}else if(n-=l.size,this.trackRemovals){const c=KF(this.cr.serializer,o.convertToNoDocument(gr.min()));r.push(this.cr.addEntry(e,a,c))}}),s.forEach(a=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,a))}),r.push(this.cr.updateMetadata(e,n)),vt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:s})=>(s.forEach((a,o)=>{this.lr.set(a,{size:o,readTime:n.get(a).readTime})}),n))}}function sk(t){return pa(t,"remoteDocumentGlobal")}function kd(t){return pa(t,"remoteDocumentsV14")}function Km(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ak(t,e){const r=e.documentKey.path.toArray();return[t,ty(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function ik(t,e){const r=t.path.toArray(),n=e.path.toArray();let s=0;for(let a=0;a<r.length-2&&a<n.length-2;++a)if(s=Pr(r[a],n[a]),s)return s;return s=Pr(r.length,n.length),s||(s=Pr(r[r.length-2],n[n.length-2]),s||Pr(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BJ{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Mp(n.mutation,s,Ji.empty(),Kt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Hr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Hr()){const s=pc();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let o=dp();return a.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=pc();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Hr()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let a=Eo();const o=Op(),l=function(){return Op()}();return r.forEach((c,A)=>{const u=n.get(A.key);s.has(A.key)&&(u===void 0||u.mutation instanceof kA)?a=a.insert(A.key,A):u!==void 0?(o.set(A.key,u.mutation.getFieldMask()),Mp(u.mutation,A,u.mutation.getFieldMask(),Kt.now())):o.set(A.key,Ji.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((A,u)=>o.set(A,u)),r.forEach((A,u)=>{var d;return l.set(A,new BJ(u,(d=o.get(A))!==null&&d!==void 0?d:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Op();let s=new us((o,l)=>o-l),a=Hr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const A=r.get(c);if(A===null)return;let u=n.get(c)||Ji.empty();u=l.applyToLocalView(A,u),n.set(c,u);const d=(s.get(l.batchId)||Hr()).add(c);s=s.insert(l.batchId,d)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),A=c.key,u=c.value,d=kU();u.forEach(f=>{if(!a.has(f)){const h=LU(r.get(f),n.get(f));h!==null&&d.set(f,h),a=a.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,A,d))}return vt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return Yt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):EU(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):vt.resolve(pc());let l=-1,c=a;return o.next(A=>vt.forEach(A,(u,d)=>(l<d.largestBatchId&&(l=d.largestBatchId),a.get(u)?vt.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(e,A,a)).next(()=>this.computeViews(e,c,A,Hr())).next(u=>({batchId:l,changes:FU(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Yt(r)).next(n=>{let s=dp();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let o=dp();return this.indexManager.getCollectionParents(e,a).next(l=>vt.forEach(l,c=>{const A=function(d,f){return new em(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,A,n,s).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(o=>{a.forEach((c,A)=>{const u=A.getKey();o.get(u)===null&&(o=o.insert(u,os.newInvalidDocument(u)))});let l=dp();return o.forEach((c,A)=>{const u=a.get(c);u!==void 0&&Mp(u.mutation,A,Ji.empty(),Kt.now()),Bx(r,A)&&(l=l.insert(c,A))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SJ{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return vt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Sa(s.createTime)}}(r)),vt.resolve()}getNamedQuery(e,r){return vt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:r6(s.bundledQuery),readTime:Sa(s.readTime)}}(r)),vt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(){this.overlays=new us(Yt.comparator),this.Ir=new Map}getOverlay(e,r){return vt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=pc();return vt.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.ht(e,r,a)}),vt.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),vt.resolve()}getOverlaysForCollection(e,r,n){const s=pc(),a=r.length+1,o=new Yt(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,A=c.getKey();if(!r.isPrefixOf(A.path))break;A.path.length===a&&c.largestBatchId>n&&s.set(c.getKey(),c)}return vt.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new us((A,u)=>A-u);const o=this.overlays.getIterator();for(;o.hasNext();){const A=o.getNext().value;if(A.getKey().getCollectionGroup()===r&&A.largestBatchId>n){let u=a.get(A.largestBatchId);u===null&&(u=pc(),a=a.insert(A.largestBatchId,u)),u.set(A.getKey(),A)}}const l=pc(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((A,u)=>l.set(A,u)),!(l.size()>=s)););return vt.resolve(l)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new hS(r,n));let a=this.Ir.get(r);a===void 0&&(a=Hr(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FJ{constructor(){this.sessionToken=qs.EMPTY_BYTE_STRING}getSessionToken(e){return vt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,vt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(){this.Tr=new Rn(ba.Er),this.dr=new Rn(ba.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new ba(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new ba(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Yt(new mn([])),n=new ba(r,e),s=new ba(r,e+1),a=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),a.push(o.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Yt(new mn([])),n=new ba(r,e),s=new ba(r,e+1);let a=Hr();return this.dr.forEachInRange([n,s],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new ba(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ba{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Yt.comparator(e.key,r.key)||Pr(e.wr,r.wr)}static Ar(e,r){return Pr(e.wr,r.wr)||Yt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kJ{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Rn(ba.Er)}checkEmpty(e){return vt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new uS(a,r,n,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new ba(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return vt.resolve(o)}lookupMutationBatch(e,r){return vt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return vt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return vt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return vt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ba(r,0),s=new ba(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],o=>{const l=this.Dr(o.wr);a.push(l)}),vt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Rn(Pr);return r.forEach(s=>{const a=new ba(s,0),o=new ba(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,o],l=>{n=n.add(l.wr)})}),vt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;Yt.isDocumentKey(a)||(a=a.child(""));const o=new ba(new Yt(a),0);let l=new Rn(Pr);return this.br.forEachWhile(c=>{const A=c.key.path;return!!n.isPrefixOf(A)&&(A.length===s&&(l=l.add(c.wr)),!0)},o),vt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){mr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return vt.forEach(r.mutations,s=>{const a=new ba(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new ba(r,0),s=this.br.firstAfterOrEqual(n);return vt.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,vt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e){this.Mr=e,this.docs=function(){return new us(Yt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return vt.resolve(n?n.document.mutableCopy():os.newInvalidDocument(r))}getEntries(e,r){let n=Eo();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():os.newInvalidDocument(s))}),vt.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=Eo();const o=r.path,l=new Yt(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:A,value:{document:u}}=c.getNext();if(!o.isPrefixOf(A.path))break;A.path.length>o.length+1||nS(iU(u),n)<=0||(s.has(u.key)||Bx(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return vt.resolve(a)}getAllFromCollectionGroup(e,r,n,s){cr()}Or(e,r){return vt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new jJ(this)}getSize(e){return vt.resolve(this.size)}}class jJ extends l6{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),vt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PJ{constructor(e){this.persistence=e,this.Nr=new gd(r=>Eh(r),_x),this.lastRemoteSnapshotVersion=gr.min(),this.highestTargetId=0,this.Lr=0,this.Br=new xS,this.targetCount=0,this.kr=Ih.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),vt.resolve()}getLastRemoteSnapshotVersion(e){return vt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return vt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),vt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),vt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ih(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,vt.resolve()}updateTargetData(e,r){return this.Kn(r),vt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,vt.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),vt.waitFor(a).next(()=>s)}getTargetCount(e){return vt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return vt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),vt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(o=>{a.push(s.markPotentiallyOrphaned(e,o))}),vt.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),vt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return vt.resolve(n)}containsKey(e,r){return vt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,r){this.qr={},this.overlays={},this.Qr=new il(0),this.Kr=!1,this.Kr=!0,this.$r=new FJ,this.referenceDelegate=e(this),this.Ur=new PJ(this),this.indexManager=new gJ,this.remoteDocumentCache=function(s){return new TJ(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new e6(r),this.Gr=new SJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new IJ,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new kJ(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Mt("MemoryPersistence","Starting transaction:",e);const s=new RJ(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(e,r){return vt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class RJ extends lU{constructor(e){super(),this.currentSequenceNumber=e}}class m2{constructor(e){this.persistence=e,this.Jr=new xS,this.Yr=null}static Zr(e){return new m2(e)}get Xr(){if(this.Yr)return this.Yr;throw cr()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),vt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),vt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),vt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return vt.forEach(this.Xr,n=>{const s=Yt.fromPath(n);return this.ei(e,s).next(a=>{a||r.removeEntry(s,gr.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return vt.or([()=>vt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DJ{constructor(e){this.serializer=e}O(e,r,n,s){const a=new o2("createOrUpgrade",r);n<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wF,{unique:!0}),c.createObjectStore("documentMutations")}(e),ok(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=vt.resolve();return n<3&&s>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),ok(e)),o=o.next(()=>function(c){const A=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:gr.min().toTimestamp(),targetCount:0};return A.put("targetGlobalKey",u)}(a))),n<4&&s>=4&&(n!==0&&(o=o.next(()=>function(c,A){return A.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wF,{unique:!0});const d=A.store("mutations"),f=u.map(h=>d.put(h));return vt.waitFor(f)})}(e,a))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&s>=5&&(o=o.next(()=>this.ni(a))),n<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(a)))),n<7&&s>=7&&(o=o.next(()=>this.ii(a))),n<8&&s>=8&&(o=o.next(()=>this.si(e,a))),n<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&s>=10&&(o=o.next(()=>this.oi(a))),n<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&s>=12&&(o=o.next(()=>{(function(c){const A=c.createObjectStore("documentOverlays",{keyPath:AW});A.createIndex("collectionPathOverlayIndex",uW,{unique:!1}),A.createIndex("collectionGroupOverlayIndex",dW,{unique:!1})})(e)})),n<13&&s>=13&&(o=o.next(()=>function(c){const A=c.createObjectStore("remoteDocumentsV14",{keyPath:Zz});A.createIndex("documentKeyIndex",eW),A.createIndex("collectionGroupIndex",tW)}(e)).next(()=>this._i(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&s>=14&&(o=o.next(()=>this.ai(e,a))),n<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:iW}).createIndex("sequenceNumberIndex",oW,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:lW}).createIndex("documentKeyIndex",cW,{unique:!1})}(e))),n<16&&s>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,s)=>{r+=ny(s)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(s=>vt.forEach(s,a=>{const o=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>vt.forEach(l,c=>{mr(c.userId===a.userId);const A=qd(this.serializer,c);return a6(e,a.userId,A).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const a=[];return n.J((o,l)=>{const c=new mn(o),A=function(d){return[0,ji(d)]}(c);a.push(r.get(A).next(u=>u?vt.resolve():(d=>r.put({targetId:0,path:ji(d),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>vt.waitFor(a))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:aW});const n=r.store("collectionParents"),s=new gS,a=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:ji(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new mn(o);return a(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],A)=>{const u=mc(l);return a(u.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,s)=>{const a=fp(s),o=t6(this.serializer,a);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),s=[];return n.J((a,o)=>{const l=r.store("remoteDocumentsV14"),c=function(d){return d.document?new Yt(mn.fromString(d.document.name).popFirst(5)):d.noDocument?Yt.fromSegments(d.noDocument.path):d.unknownDocument?Yt.fromSegments(d.unknownDocument.path):cr()}(o).path.toArray(),A={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(A))}).next(()=>vt.waitFor(s))}ai(e,r){const n=r.store("mutations"),s=c6(this.serializer),a=new u6(m2.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var A;let u=(A=l.get(c.userId))!==null&&A!==void 0?A:Hr();qd(this.serializer,c).keys().forEach(d=>u=u.add(d)),l.set(c.userId,u)}),vt.forEach(l,(c,A)=>{const u=new Ma(A),d=h2.lt(this.serializer,u),f=a.getIndexManager(u),h=f2.lt(u,this.serializer,f,a.referenceDelegate);return new A6(s,h,d,f).recalculateAndSaveOverlaysForDocumentKeys(new B_(r,il.oe),c).next()})})}}function ok(t){t.createObjectStore("targetDocuments",{keyPath:nW}).createIndex("documentTargetsIndex",sW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",rW,{unique:!0}),t.createObjectStore("targetGlobal")}const Zb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class vS{constructor(e,r,n,s,a,o,l,c,A,u,d=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=a,this.window=o,this.document=l,this.ci=A,this.li=u,this.hi=d,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!vS.D())throw new $t(Et.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new CJ(this,s),this.Ai=r+"main",this.serializer=new e6(c),this.Ri=new Gu(this.Ai,this.hi,new DJ(this.serializer)),this.$r=new uJ,this.Ur=new vJ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=c6(this.serializer),this.Gr=new AJ,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&ki("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new $t(Et.FAILED_PRECONDITION,Zb);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new il(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jv(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(pd(e))return Mt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Mt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return qm(e).get("owner").next(r=>vt.resolve(this.vi(r)))}Ci(e){return jv(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=pa(r,"clientMetadata");return n.U().next(s=>{const a=this.xi(s,18e5),o=s.filter(l=>a.indexOf(l)===-1);return vt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?vt.resolve(!0):qm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new $t(Et.FAILED_PRECONDITION,Zb);return!1}}return!(!this.networkEnabled||!this.inForeground)||jv(e).U().next(n=>this.xi(n,5e3).find(s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(a||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Mt("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new B_(e,il.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>jv(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return f2.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xJ(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return h2.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Mt("IndexedDbPersistence","Starting transaction:",e);const s=r==="readonly"?"readonly":"readwrite",a=function(c){return c===17?mW:c===16?fW:c===15?aS:c===14?hU:c===13?dU:c===12?hW:c===11?uU:void cr()}(this.hi);let o;return this.Ri.runTransaction(e,s,a,l=>(o=new B_(l,this.Qr?this.Qr.next():il.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw ki(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new $t(Et.FAILED_PRECONDITION,oU);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return qm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new $t(Et.FAILED_PRECONDITION,Zb)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qm(e).put("owner",r)}static D(){return Gu.D()}bi(e){const r=qm(e);return r.get("owner").next(n=>this.vi(n)?(Mt("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):vt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(ki(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;cL()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Mt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return ki("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ki("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function qm(t){return pa(t,"owner")}function jv(t){return pa(t,"clientMetadata")}function LJ(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Hr(),s=Hr();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new wS(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return cL()?8:cU(fa())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.Yi(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Zi(e,r,s,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new UJ;return this.Xi(e,r,o).next(l=>{if(a.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>a.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(Lf()<=tn.DEBUG&&Mt("QueryEngine","SDK will not create cache indexes for query:",Uf(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),vt.resolve()):(Lf()<=tn.DEBUG&&Mt("QueryEngine","Query:",Uf(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Lf()<=tn.DEBUG&&Mt("QueryEngine","The SDK decides to create cache indexes for query:",Uf(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Al(r))):vt.resolve())}Yi(e,r){if(jF(r))return vt.resolve(null);let n=Al(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=ey(r,null,"F"),n=Al(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=Hr(...a);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const A=this.ts(r,l);return this.ns(r,A,o,c.readTime)?this.Yi(e,ey(r,null,"F")):this.rs(e,A,r,c)}))})))}Zi(e,r,n,s){return jF(r)||s.isEqual(gr.min())?vt.resolve(null):this.Ji.getDocuments(e,n).next(a=>{const o=this.ts(r,a);return this.ns(r,o,n,s)?vt.resolve(null):(Lf()<=tn.DEBUG&&Mt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Uf(r)),this.rs(e,o,r,qz(s,-1)).next(l=>l))})}ts(e,r){let n=new Rn(SU(e));return r.forEach((s,a)=>{Bx(e,a)&&(n=n.add(a))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(e,r,n){return Lf()<=tn.DEBUG&&Mt("QueryEngine","Using full collection scan to execute query:",Uf(r)),this.Ji.getDocumentsMatchingQuery(e,r,Fo.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OJ{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new us(Pr),this._s=new gd(a=>Eh(a),_x),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new A6(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function h6(t,e,r,n){return new OJ(t,e,r,n)}async function f6(t,e){const r=Ir(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],l=[];let c=Hr();for(const A of s){o.push(A.batchId);for(const u of A.mutations)c=c.add(u.key)}for(const A of a){l.push(A.batchId);for(const u of A.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(A=>({hs:A,removedBatchIds:o,addedBatchIds:l}))})})}function MJ(t,e){const r=Ir(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,A,u){const d=A.batch,f=d.keys();let h=vt.resolve();return f.forEach(m=>{h=h.next(()=>u.getEntry(c,m)).next(p=>{const x=A.docVersions.get(m);mr(x!==null),p.version.compareTo(x)<0&&(d.applyToRemoteDocument(p,A),p.isValidDocument()&&(p.setReadTime(A.commitVersion),u.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,d))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Hr();for(let A=0;A<l.mutationResults.length;++A)l.mutationResults[A].transformResults.length>0&&(c=c.add(l.batch.mutations[A].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function m6(t){const e=Ir(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function QJ(t,e){const r=Ir(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const l=[];e.targetChanges.forEach((u,d)=>{const f=s.get(d);if(!f)return;l.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,d)));let h=f.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(d)!==null?h=h.withResumeToken(qs.EMPTY_BYTE_STRING,gr.min()).withLastLimboFreeSnapshotVersion(gr.min()):u.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(u.resumeToken,n)),s=s.insert(d,h),function(p,x,g){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(f,h,u)&&l.push(r.Ur.updateTargetData(a,h))});let c=Eo(),A=Hr();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),l.push(VJ(a,o,e.documentUpdates).next(u=>{c=u.Ps,A=u.Is})),!n.isEqual(gr.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(d=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));l.push(u)}return vt.waitFor(l).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,A)).next(()=>c)}).then(a=>(r.os=s,a))}function VJ(t,e,r){let n=Hr(),s=Hr();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=Eo();return r.forEach((l,c)=>{const A=a.get(l);c.isFoundDocument()!==A.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(gr.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!A.isValidDocument()||c.version.compareTo(A.version)>0||c.version.compareTo(A.version)===0&&A.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Mt("LocalStore","Ignoring outdated watch update for ",l,". Current version:",A.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function HJ(t,e){const r=Ir(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function KJ(t,e){const r=Ir(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(a=>a?(s=a,vt.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new oA(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Q_(t,e,r){const n=Ir(t),s=n.os.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!pd(o))throw o;Mt("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function lk(t,e,r){const n=Ir(t);let s=gr.min(),a=Hr();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,A,u){const d=Ir(c),f=d._s.get(u);return f!==void 0?vt.resolve(d.os.get(f)):d.Ur.getTargetData(A,u)}(n,o,Al(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{a=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:gr.min(),r?a:Hr())).next(l=>(qJ(n,FW(e),l),{documents:l,Ts:a})))}function qJ(t,e,r){let n=t.us.get(e)||gr.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.us.set(e,n)}class ck{constructor(){this.activeTargetIds=DW()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class p6{constructor(){this.so=new ck,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ck,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GJ{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Mt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Mt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pv=null;function eN(){return Pv===null?Pv=function(){return 268435456+Math.round(2147483648*Math.random())}():Pv++,"0x"+Pv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $J={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zJ{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="WebChannelConnection";class WJ extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,o){const l=eN(),c=this.xo(r,n.toUriEncodedString());Mt("RestConnection",`Sending RPC '${r}' ${l}:`,c,s);const A={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(A,a,o),this.No(r,c,A,s).then(u=>(Mt("RestConnection",`Received RPC '${r}' ${l}: `,u),u),u=>{throw Yu("RestConnection",`RPC '${r}' ${l} failed with error: `,u,"url: ",c,"request:",s),u})}Lo(r,n,s,a,o,l){return this.Mo(r,n,s,a,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Z0}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>r[o]=a),s&&s.headers.forEach((a,o)=>r[o]=a)}xo(r,n){const s=$J[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const a=eN();return new Promise((o,l)=>{const c=new YL;c.setWithCredentials(!0),c.listenOnce(ZL.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case sw.NO_ERROR:const u=c.getResponseJson();Mt(ei,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(u)),o(u);break;case sw.TIMEOUT:Mt(ei,`RPC '${e}' ${a} timed out`),l(new $t(Et.DEADLINE_EXCEEDED,"Request time out"));break;case sw.HTTP_ERROR:const d=c.getStatus();if(Mt(ei,`RPC '${e}' ${a} failed with status:`,d,"response text:",c.getResponseText()),d>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(x){const g=x.toLowerCase().replace(/_/g,"-");return Object.values(Et).indexOf(g)>=0?g:Et.UNKNOWN}(h.status);l(new $t(m,h.message))}else l(new $t(Et.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new $t(Et.UNAVAILABLE,"Connection failed."));break;default:cr()}}finally{Mt(ei,`RPC '${e}' ${a} completed.`)}});const A=JSON.stringify(s);Mt(ei,`RPC '${e}' ${a} sending request:`,s),c.send(r,"POST",A,n,15)})}Bo(e,r,n){const s=eN(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=rU(),l=tU(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},A=this.longPollingOptions.timeoutSeconds;A!==void 0&&(c.longPollingTimeout=Math.round(1e3*A)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=a.join("");Mt(ei,`Creating RPC '${e}' stream ${s}: ${u}`,c);const d=o.createWebChannel(u,c);let f=!1,h=!1;const m=new zJ({Io:x=>{h?Mt(ei,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(f||(Mt(ei,`Opening RPC '${e}' stream ${s} transport.`),d.open(),f=!0),Mt(ei,`RPC '${e}' stream ${s} sending:`,x),d.send(x))},To:()=>d.close()}),p=(x,g,y)=>{x.listen(g,b=>{try{y(b)}catch(F){setTimeout(()=>{throw F},0)}})};return p(d,up.EventType.OPEN,()=>{h||(Mt(ei,`RPC '${e}' stream ${s} transport opened.`),m.yo())}),p(d,up.EventType.CLOSE,()=>{h||(h=!0,Mt(ei,`RPC '${e}' stream ${s} transport closed`),m.So())}),p(d,up.EventType.ERROR,x=>{h||(h=!0,Yu(ei,`RPC '${e}' stream ${s} transport errored:`,x),m.So(new $t(Et.UNAVAILABLE,"The operation could not be completed")))}),p(d,up.EventType.MESSAGE,x=>{var g;if(!h){const y=x.data[0];mr(!!y);const b=y,F=b.error||((g=b[0])===null||g===void 0?void 0:g.error);if(F){Mt(ei,`RPC '${e}' stream ${s} received error:`,F);const P=F.status;let R=function(E){const M=Ws[E];if(M!==void 0)return MU(M)}(P),_=F.message;R===void 0&&(R=Et.INTERNAL,_="Unknown error status: "+P+" with message "+F.message),h=!0,m.So(new $t(R,_)),d.close()}else Mt(ei,`RPC '${e}' stream ${s} received:`,y),m.bo(y)}}),p(l,eU.STAT_EVENT,x=>{x.stat===__.PROXY?Mt(ei,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===__.NOPROXY&&Mt(ei,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JJ(){return typeof window<"u"?window:null}function uw(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(t){return new YW(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,r,n=1e3,s=1.5,a=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Mt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,r,n,s,a,o,l,c){this.ui=e,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new yS(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Et.RESOURCE_EXHAUSTED?(ki(r.toString()),ki("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Et.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new $t(Et.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Mt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Mt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class XJ extends g6{constructor(e,r,n,s,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=rJ(this.serializer,e),n=function(a){if(!("targetChange"in a))return gr.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?gr.min():o.readTime?Sa(o.readTime):gr.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=D_(this.serializer),r.addTarget=function(a,o){let l;const c=o.target;if(l=Yw(c)?{documents:zU(a,c)}:{query:WU(a,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=HU(a,o.resumeToken);const A=P_(a,o.expectedCount);A!==null&&(l.expectedCount=A)}else if(o.snapshotVersion.compareTo(gr.min())>0){l.readTime=U0(a,o.snapshotVersion.toTimestamp());const A=P_(a,o.expectedCount);A!==null&&(l.expectedCount=A)}return l}(this.serializer,e);const n=sJ(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=D_(this.serializer),r.removeTarget=e,this.a_(r)}}class YJ extends g6{constructor(e,r,n,s,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return mr(!!e.streamToken),this.lastStreamToken=e.streamToken,mr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=nJ(e.writeResults,e.commitTime),n=Sa(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=D_(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>Mg(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJ extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new $t(Et.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,R_(r,n),s,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new $t(Et.UNKNOWN,a.toString())})}Lo(e,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,R_(r,n),s,o,l,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $t(Et.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class eX{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ki(r),this.D_=!1):Mt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tX{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(o=>{n.enqueueAndForget(async()=>{Hh(this)&&(Mt("RemoteStore","Restarting streams for network reachability change."),await async function(c){const A=Ir(c);A.L_.add(4),await Ix(A),A.q_.set("Unknown"),A.L_.delete(4),await g2(A)}(this))})}),this.q_=new eX(n,s)}}async function g2(t){if(Hh(t))for(const e of t.B_)await e(!0)}async function Ix(t){for(const e of t.B_)await e(!1)}function x6(t,e){const r=Ir(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),_S(r)?CS(r):nm(r).r_()&&NS(r,e))}function bS(t,e){const r=Ir(t),n=nm(r);r.N_.delete(e),n.r_()&&v6(r,e),r.N_.size===0&&(n.r_()?n.o_():Hh(r)&&r.q_.set("Unknown"))}function NS(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}nm(t).A_(e)}function v6(t,e){t.Q_.xe(e),nm(t).R_(e)}function CS(t){t.Q_=new zW({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),nm(t).start(),t.q_.v_()}function _S(t){return Hh(t)&&!nm(t).n_()&&t.N_.size>0}function Hh(t){return Ir(t).L_.size===0}function w6(t){t.Q_=void 0}async function rX(t){t.q_.set("Online")}async function nX(t){t.N_.forEach((e,r)=>{NS(t,e)})}async function sX(t,e){w6(t),_S(t)?(t.q_.M_(e),CS(t)):t.q_.set("Unknown")}async function aX(t,e,r){if(t.q_.set("Online"),e instanceof VU&&e.state===2&&e.cause)try{await async function(s,a){const o=a.cause;for(const l of a.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(n){Mt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await sy(t,n)}else if(e instanceof Aw?t.Q_.Ke(e):e instanceof QU?t.Q_.He(e):t.Q_.We(e),!r.isEqual(gr.min()))try{const n=await m6(t.localStore);r.compareTo(n)>=0&&await function(a,o){const l=a.Q_.rt(o);return l.targetChanges.forEach((c,A)=>{if(c.resumeToken.approximateByteSize()>0){const u=a.N_.get(A);u&&a.N_.set(A,u.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,A)=>{const u=a.N_.get(c);if(!u)return;a.N_.set(c,u.withResumeToken(qs.EMPTY_BYTE_STRING,u.snapshotVersion)),v6(a,c);const d=new oA(u.target,c,A,u.sequenceNumber);NS(a,d)}),a.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Mt("RemoteStore","Failed to raise snapshot:",n),await sy(t,n)}}async function sy(t,e,r){if(!pd(e))throw e;t.L_.add(1),await Ix(t),t.q_.set("Offline"),r||(r=()=>m6(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Mt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await g2(t)})}function y6(t,e){return e().catch(r=>sy(t,r,e))}async function Fx(t){const e=Ir(t),r=rd(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;iX(e);)try{const s=await HJ(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,oX(e,s)}catch(s){await sy(e,s)}b6(e)&&N6(e)}function iX(t){return Hh(t)&&t.O_.length<10}function oX(t,e){t.O_.push(e);const r=rd(t);r.r_()&&r.V_&&r.m_(e.mutations)}function b6(t){return Hh(t)&&!rd(t).n_()&&t.O_.length>0}function N6(t){rd(t).start()}async function lX(t){rd(t).p_()}async function cX(t){const e=rd(t);for(const r of t.O_)e.m_(r.mutations)}async function AX(t,e,r){const n=t.O_.shift(),s=dS.from(n,e,r);await y6(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Fx(t)}async function uX(t,e){e&&rd(t).V_&&await async function(n,s){if(function(o){return OU(o)&&o!==Et.ABORTED}(s.code)){const a=n.O_.shift();rd(n).s_(),await y6(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Fx(n)}}(t,e),b6(t)&&N6(t)}async function uk(t,e){const r=Ir(t);r.asyncQueue.verifyOperationInProgress(),Mt("RemoteStore","RemoteStore received new credentials");const n=Hh(r);r.L_.add(3),await Ix(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await g2(r)}async function dX(t,e){const r=Ir(t);e?(r.L_.delete(2),await g2(r)):e||(r.L_.add(2),await Ix(r),r.q_.set("Unknown"))}function nm(t){return t.K_||(t.K_=function(r,n,s){const a=Ir(r);return a.w_(),new XJ(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:rX.bind(null,t),Ro:nX.bind(null,t),mo:sX.bind(null,t),d_:aX.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),_S(t)?CS(t):t.q_.set("Unknown")):(await t.K_.stop(),w6(t))})),t.K_}function rd(t){return t.U_||(t.U_=function(r,n,s){const a=Ir(r);return a.w_(),new YJ(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:lX.bind(null,t),mo:uX.bind(null,t),f_:cX.bind(null,t),g_:AX.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Fx(t)):(await t.U_.stop(),t.O_.length>0&&(Mt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const o=Date.now()+n,l=new ES(e,r,o,s,a);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $t(Et.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function BS(t,e){if(ki("AsyncQueue",`${e}: ${t}`),pd(t))return new $t(Et.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Yt.comparator(r.key,n.key):(r,n)=>Yt.comparator(r.key,n.key),this.keyedMap=dp(),this.sortedSet=new us(this.comparator)}static emptySet(e){return new g0(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof g0)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new g0;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(){this.W_=new us(Yt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):cr():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class O0{constructor(e,r,n,s,a,o,l,c,A){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=A}static fromInitialDocuments(e,r,n,s,a){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new O0(e,r,g0.emptySet(r),o,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&c2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hX{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class fX{constructor(){this.queries=hk(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Ir(r),a=s.queries;s.queries=hk(),a.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new $t(Et.ABORTED,"Firestore shutting down"))}}function hk(){return new gd(t=>BU(t),c2)}async function SS(t,e){const r=Ir(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.H_()&&e.J_()&&(n=2):(a=new hX,n=e.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=BS(o,`Initialization of query '${Uf(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,a),a.j_.push(e),e.Z_(r.onlineState),a.z_&&e.X_(a.z_)&&FS(r)}async function IS(t,e){const r=Ir(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const o=a.j_.indexOf(e);o>=0&&(a.j_.splice(o,1),a.j_.length===0?s=e.J_()?0:1:!a.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function mX(t,e){const r=Ir(t);let n=!1;for(const s of e){const a=s.query,o=r.queries.get(a);if(o){for(const l of o.j_)l.X_(s)&&(n=!0);o.z_=s}}n&&FS(r)}function pX(t,e,r){const n=Ir(t),s=n.queries.get(e);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(e)}function FS(t){t.Y_.forEach(e=>{e.next()})}var V_,fk;(fk=V_||(V_={})).ea="default",fk.Cache="cache";class kS{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new O0(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=O0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==V_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.key=e}}class _6{constructor(e){this.key=e}}class gX{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Hr(),this.mutatedKeys=Hr(),this.Aa=SU(e),this.Ra=new g0(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new dk,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,A=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,d)=>{const f=s.get(u),h=Bx(this.query,d)?d:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(f,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||A&&this.Aa(h,A)<0)&&(l=!0)):!f&&h?(n.track({type:0,doc:h}),x=!0):f&&!h&&(n.track({type:1,doc:f}),x=!0,(c||A)&&(l=!0)),x&&(h?(o=o.add(h),a=p?a.add(u):a.delete(u)):(o=o.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:o,fa:n,ns:l,mutatedKeys:a}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,d)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cr()}};return p(h)-p(m)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(n),s=s!=null&&s;const l=r&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,A=c!==this.Ea;return this.Ea=c,o.length!==0||A?{snapshot:new O0(this.query,e.Ra,a,o,e.mutatedKeys,c===0,A,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new dk,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Hr(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new _6(n))}),this.da.forEach(n=>{e.has(n)||r.push(new C6(n))}),r}ba(e){this.Ta=e.Ts,this.da=Hr();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return O0.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class xX{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class vX{constructor(e){this.key=e,this.va=!1}}class wX{constructor(e,r,n,s,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new gd(l=>BU(l),c2),this.Ma=new Map,this.xa=new Set,this.Oa=new us(Yt.comparator),this.Na=new Map,this.La=new xS,this.Ba={},this.ka=new Map,this.qa=Ih.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function yX(t,e,r=!0){const n=k6(t);let s;const a=n.Fa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await E6(n,e,r,!0),s}async function bX(t,e){const r=k6(t);await E6(r,e,!0,!1)}async function E6(t,e,r,n){const s=await KJ(t.localStore,Al(e)),a=s.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let l;return n&&(l=await NX(t,e,a,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&x6(t.remoteStore,s),l}async function NX(t,e,r,n,s){t.Ka=(d,f,h)=>async function(p,x,g,y){let b=x.view.ma(g);b.ns&&(b=await lk(p.localStore,x.query,!1).then(({documents:_})=>x.view.ma(_,b)));const F=y&&y.targetChanges.get(x.targetId),P=y&&y.targetMismatches.get(x.targetId)!=null,R=x.view.applyChanges(b,p.isPrimaryClient,F,P);return pk(p,x.targetId,R.wa),R.snapshot}(t,d,f,h);const a=await lk(t.localStore,e,!0),o=new gX(e,a.Ts),l=o.ma(a.documents),c=Sx.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),A=o.applyChanges(l,t.isPrimaryClient,c);pk(t,r,A.wa);const u=new xX(e,r,o);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),A.snapshot}async function CX(t,e,r){const n=Ir(t),s=n.Fa.get(e),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(o=>!c2(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Q_(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&bS(n.remoteStore,s.targetId),H_(n,s.targetId)}).catch(Qh)):(H_(n,s.targetId),await Q_(n.localStore,s.targetId,!0))}async function _X(t,e){const r=Ir(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),bS(r.remoteStore,n.targetId))}async function EX(t,e,r){const n=T6(t);try{const s=await function(o,l){const c=Ir(o),A=Kt.now(),u=l.reduce((h,m)=>h.add(m.key),Hr());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Eo(),p=Hr();return c.cs.getEntries(h,u).next(x=>{m=x,m.forEach((g,y)=>{y.isValidDocument()||(p=p.add(g))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{d=x;const g=[];for(const y of l){const b=KW(y,d.get(y.key).overlayedDocument);b!=null&&g.push(new kA(y.key,b,xU(b.value.mapValue),cs.exists(!0)))}return c.mutationQueue.addMutationBatch(h,A,g,l)}).next(x=>{f=x;const g=x.applyToLocalDocumentSet(d,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,g)})}).then(()=>({batchId:f.batchId,changes:FU(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let A=o.Ba[o.currentUser.toKey()];A||(A=new us(Pr)),A=A.insert(l,c),o.Ba[o.currentUser.toKey()]=A}(n,s.batchId,r),await kx(n,s.changes),await Fx(n.remoteStore)}catch(s){const a=BS(s,"Failed to persist write");r.reject(a)}}async function B6(t,e){const r=Ir(t);try{const n=await QJ(r.localStore,e);e.targetChanges.forEach((s,a)=>{const o=r.Na.get(a);o&&(mr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?mr(o.va):s.removedDocuments.size>0&&(mr(o.va),o.va=!1))}),await kx(r,n,e)}catch(n){await Qh(n)}}function mk(t,e,r){const n=Ir(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Ir(o);c.onlineState=l;let A=!1;c.queries.forEach((u,d)=>{for(const f of d.j_)f.Z_(l)&&(A=!0)}),A&&FS(c)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function BX(t,e,r){const n=Ir(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),a=s&&s.key;if(a){let o=new us(Yt.comparator);o=o.insert(a,os.newNoDocument(a,gr.min()));const l=Hr().add(a),c=new d2(gr.min(),new Map,new us(Pr),o,l);await B6(n,c),n.Oa=n.Oa.remove(a),n.Na.delete(e),TS(n)}else await Q_(n.localStore,e,!1).then(()=>H_(n,e,r)).catch(Qh)}async function SX(t,e){const r=Ir(t),n=e.batch.batchId;try{const s=await MJ(r.localStore,e);I6(r,n,null),S6(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await kx(r,s)}catch(s){await Qh(s)}}async function IX(t,e,r){const n=Ir(t);try{const s=await function(o,l){const c=Ir(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",A=>{let u;return c.mutationQueue.lookupMutationBatch(A,l).next(d=>(mr(d!==null),u=d.keys(),c.mutationQueue.removeMutationBatch(A,d))).next(()=>c.mutationQueue.performConsistencyCheck(A)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(A,u,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(A,u)).next(()=>c.localDocuments.getDocuments(A,u))})}(n.localStore,e);I6(n,e,r),S6(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await kx(n,s)}catch(s){await Qh(s)}}function S6(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function I6(t,e,r){const n=Ir(t);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function H_(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||F6(t,n)})}function F6(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(bS(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),TS(t))}function pk(t,e,r){for(const n of r)n instanceof C6?(t.La.addReference(n.key,e),FX(t,n)):n instanceof _6?(Mt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||F6(t,n.key)):cr()}function FX(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Mt("SyncEngine","New document in limbo: "+r),t.xa.add(n),TS(t))}function TS(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Yt(mn.fromString(e)),n=t.qa.next();t.Na.set(n,new vX(r)),t.Oa=t.Oa.insert(r,n),x6(t.remoteStore,new oA(Al(Ex(r.path)),n,"TargetPurposeLimboResolution",il.oe))}}async function kx(t,e,r){const n=Ir(t),s=[],a=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(A=>{var u;if((A||r)&&n.isPrimaryClient){const d=A?!A.fromCache:(u=r==null?void 0:r.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(A){s.push(A);const d=wS.Wi(c.targetId,A);a.push(d)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(c,A){const u=Ir(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>vt.forEach(A,f=>vt.forEach(f.$i,h=>u.persistence.referenceDelegate.addReference(d,f.targetId,h)).next(()=>vt.forEach(f.Ui,h=>u.persistence.referenceDelegate.removeReference(d,f.targetId,h)))))}catch(d){if(!pd(d))throw d;Mt("LocalStore","Failed to update sequence numbers: "+d)}for(const d of A){const f=d.targetId;if(!d.fromCache){const h=u.os.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);u.os=u.os.insert(f,p)}}}(n.localStore,a))}async function kX(t,e){const r=Ir(t);if(!r.currentUser.isEqual(e)){Mt("SyncEngine","User change. New user:",e.toKey());const n=await f6(r.localStore,e);r.currentUser=e,function(a,o){a.ka.forEach(l=>{l.forEach(c=>{c.reject(new $t(Et.CANCELLED,o))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await kx(r,n.hs)}}function TX(t,e){const r=Ir(t),n=r.Na.get(e);if(n&&n.va)return Hr().add(n.key);{let s=Hr();const a=r.Ma.get(e);if(!a)return s;for(const o of a){const l=r.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function k6(t){const e=Ir(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=B6.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TX.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BX.bind(null,e),e.Ca.d_=mX.bind(null,e.eventManager),e.Ca.$a=pX.bind(null,e.eventManager),e}function T6(t){const e=Ir(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SX.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IX.bind(null,e),e}class Qg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=p2(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return h6(this.persistence,new d6,e.initialUser,this.serializer)}Ga(e){return new u6(m2.Zr,this.serializer)}Wa(e){return new p6}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qg.provider={build:()=>new Qg};class jX extends Qg{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await T6(this.Ja.syncEngine),await Fx(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return h6(this.persistence,new d6,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new yJ(n,e.asyncQueue,r)}Ha(e,r){const n=new Wz(r,this.persistence);return new zz(e.asyncQueue,n)}Ga(e){const r=LJ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Gi.withCacheSize(this.cacheSizeBytes):Gi.DEFAULT;return new vS(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,JJ(),uw(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new p6}}class ay{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>mk(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=kX.bind(null,this.syncEngine),await dX(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new fX}()}createDatastore(e){const r=p2(e.databaseInfo.databaseId),n=function(a){return new WJ(a)}(e.databaseInfo);return function(a,o,l,c){return new ZJ(a,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,o,l){return new tX(n,s,a,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>mk(this.syncEngine,r,0),function(){return Ak.D()?new Ak:new GJ}())}createSyncEngine(e,r){return function(s,a,o,l,c,A,u){const d=new wX(s,a,o,l,c,A);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=Ir(s);Mt("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Ix(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}ay.provider={build:()=>new ay};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ki("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PX{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new $t(Et.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(s,a){const o=Ir(s),l={documents:a.map(d=>Og(o.serializer,d))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,mn.emptyPath(),l,a.length),A=new Map;c.forEach(d=>{const f=tJ(o.serializer,d);A.set(f.key.toString(),f)});const u=[];return a.forEach(d=>{const f=A.get(d.toString());mr(!!f),u.push(f)}),u}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new rm(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const s=Yt.fromPath(n);this.mutations.push(new AS(s,this.precondition(s)))}),await async function(n,s){const a=Ir(n),o={writes:s.map(l=>Mg(a.serializer,l))};await a.Mo("Commit",a.serializer.databaseId,mn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw cr();r=gr.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new $t(Et.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(gr.min())?cs.exists(!1):cs.updateTime(r):cs.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(gr.min()))throw new $t(Et.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return cs.updateTime(r)}return cs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RX{constructor(e,r,n,s,a){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=s,this.deferred=a,this._u=n.maxAttempts,this.t_=new yS(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new PX(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(s=>{this.lu(s)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Cx(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!OU(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DX{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Ma.UNAUTHENTICATED,this.clientId=rS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{Mt("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Mt("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=BS(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function tN(t,e){t.asyncQueue.verifyOperationInProgress(),Mt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await f6(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function gk(t,e){t.asyncQueue.verifyOperationInProgress();const r=await LX(t);Mt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>uk(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>uk(e.remoteStore,s)),t._onlineComponents=e}async function LX(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Mt("FirestoreClient","Using user provided OfflineComponentProvider");try{await tN(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===Et.FAILED_PRECONDITION||s.code===Et.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Yu("Error using user provided cache. Falling back to memory cache: "+r),await tN(t,new Qg)}}else Mt("FirestoreClient","Using default OfflineComponentProvider"),await tN(t,new Qg);return t._offlineComponents}async function PS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Mt("FirestoreClient","Using user provided OnlineComponentProvider"),await gk(t,t._uninitializedComponentsProvider._online)):(Mt("FirestoreClient","Using default OnlineComponentProvider"),await gk(t,new ay))),t._onlineComponents}function UX(t){return PS(t).then(e=>e.syncEngine)}function OX(t){return PS(t).then(e=>e.datastore)}async function iy(t){const e=await PS(t),r=e.eventManager;return r.onListen=yX.bind(null,e.syncEngine),r.onUnlisten=CX.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=bX.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=_X.bind(null,e.syncEngine),r}function MX(t,e,r={}){const n=new Ll;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,c,A){const u=new jS({next:f=>{u.Za(),o.enqueueAndForget(()=>IS(a,d));const h=f.docs.has(l);!h&&f.fromCache?A.reject(new $t(Et.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&c&&c.source==="server"?A.reject(new $t(Et.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):A.resolve(f)},error:f=>A.reject(f)}),d=new kS(Ex(l.path),u,{includeMetadataChanges:!0,_a:!0});return SS(a,d)}(await iy(t),t.asyncQueue,e,r,n)),n.promise}function QX(t,e,r={}){const n=new Ll;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,c,A){const u=new jS({next:f=>{u.Za(),o.enqueueAndForget(()=>IS(a,d)),f.fromCache&&c.source==="server"?A.reject(new $t(Et.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):A.resolve(f)},error:f=>A.reject(f)}),d=new kS(l,u,{includeMetadataChanges:!0,_a:!0});return SS(a,d)}(await iy(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j6(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xk=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P6(t,e,r){if(!r)throw new $t(Et.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function R6(t,e,r,n){if(e===!0&&n===!0)throw new $t(Et.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function vk(t){if(!Yt.isDocumentKey(t))throw new $t(Et.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function wk(t){if(Yt.isDocumentKey(t))throw new $t(Et.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function x2(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":cr()}function Ia(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $t(Et.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=x2(t);throw new $t(Et.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new $t(Et.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $t(Et.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}R6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=j6((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new $t(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new $t(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new $t(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class v2{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yk({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $t(Et.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $t(Et.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yk(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new sU;switch(n.type){case"firstParty":return new Mz(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $t(Et.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=xk.get(r);n&&(Mt("ComponentProvider","Removing Datastore"),xk.delete(r),n.terminate())}(this),Promise.resolve()}}function D6(t,e,r,n={}){var s;const a=(t=Ia(t,v2))._getSettings(),o=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&Yu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Ma.MOCK_USER;else{l=nq(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const A=n.mockUserToken.sub||n.mockUserToken.user_id;if(!A)throw new $t(Et.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ma(A)}t._authCredentials=new Lz(new nU(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cc(this.firestore,e,this._query)}}class Fa{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fa(this.firestore,e,this._key)}}class hA extends Cc{constructor(e,r,n){super(e,r,Ex(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fa(this.firestore,null,new Yt(e))}withConverter(e){return new hA(this.firestore,e,this._path)}}function At(t,e,...r){if(t=ks(t),P6("collection","path",e),t instanceof v2){const n=mn.fromString(e,...r);return wk(n),new hA(t,null,n)}{if(!(t instanceof Fa||t instanceof hA))throw new $t(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(mn.fromString(e,...r));return wk(n),new hA(t.firestore,null,n)}}function kt(t,e,...r){if(t=ks(t),arguments.length===1&&(e=rS.newId()),P6("doc","path",e),t instanceof v2){const n=mn.fromString(e,...r);return vk(n),new Fa(t,null,new Yt(n))}{if(!(t instanceof Fa||t instanceof hA))throw new $t(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(mn.fromString(e,...r));return vk(n),new Fa(t.firestore,t instanceof hA?t.converter:null,new Yt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new yS(this,"async_queue_retry"),this.Vu=()=>{const n=uw();n&&Mt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=uw();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=uw();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ll;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!pd(e))throw e;Mt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw ki("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=ES.createAndSchedule(this,e,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&cr()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function Nk(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class ko extends v2{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new bk,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bk(e),this._firestoreClient=void 0,await e}}}function L6(t,e){const r=typeof t=="object"?t:KB(),n=typeof t=="string"?t:"(default)",s=VB(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=tq("firestore");a&&D6(s,...a)}return s}function Kh(t){if(t._terminated)throw new $t(Et.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||U6(t),t._firestoreClient}function U6(t){var e,r,n;const s=t._freezeSettings(),a=function(l,c,A,u){return new gW(l,c,A,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,j6(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new DX(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function O6(t,e){Yu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return VX(t,ay.provider,{build:n=>new jX(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function VX(t,e,r){if((t=Ia(t,ko))._firestoreClient||t._terminated)throw new $t(Et.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new $t(Et.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},U6(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nd(qs.fromBase64String(e))}catch(r){throw new $t(Et.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new nd(qs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $t(Et.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ls(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $t(Et.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $t(Et.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pr(this._lat,e._lat)||Pr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HX=/^__.*__$/;class KX{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new kA(e,this.data,this.fieldMask,r,this.fieldTransforms):new tm(e,this.data,r,this.fieldTransforms)}}class M6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new kA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Q6(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cr()}}class RS{constructor(e,r,n,s,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new RS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return oy(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Q6(this.Cu)&&HX.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class qX{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||p2(e)}Qu(e,r,n,s=!1){return new RS({Cu:e,methodName:r,qu:n,path:ls.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sm(t){const e=t._freezeSettings(),r=p2(t._databaseId);return new qX(t._databaseId,!!e.ignoreUndefinedProperties,r)}function N2(t,e,r,n,s,a={}){const o=t.Qu(a.merge||a.mergeFields?2:0,e,r,s);US("Data must be an object, but it was:",o,n);const l=V6(n,o);let c,A;if(a.merge)c=new Ji(o.fieldMask),A=o.fieldTransforms;else if(a.mergeFields){const u=[];for(const d of a.mergeFields){const f=K_(e,d,r);if(!o.contains(f))throw new $t(Et.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);K6(u,f)||u.push(f)}c=new Ji(u),A=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,A=o.fieldTransforms;return new KX(new Ka(l),c,A)}class C2 extends w2{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof C2}}function DS(t,e,r,n){const s=t.Qu(1,e,r);US("Data must be an object, but it was:",s,n);const a=[],o=Ka.empty();Vh(n,(c,A)=>{const u=OS(e,c,r);A=ks(A);const d=s.Nu(u);if(A instanceof C2)a.push(u);else{const f=Tx(A,d);f!=null&&(a.push(u),o.set(u,f))}});const l=new Ji(a);return new M6(o,l,s.fieldTransforms)}function LS(t,e,r,n,s,a){const o=t.Qu(1,e,r),l=[K_(e,n,r)],c=[s];if(a.length%2!=0)throw new $t(Et.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<a.length;f+=2)l.push(K_(e,a[f])),c.push(a[f+1]);const A=[],u=Ka.empty();for(let f=l.length-1;f>=0;--f)if(!K6(A,l[f])){const h=l[f];let m=c[f];m=ks(m);const p=o.Nu(h);if(m instanceof C2)A.push(h);else{const x=Tx(m,p);x!=null&&(A.push(h),u.set(h,x))}}const d=new Ji(A);return new M6(u,d,o.fieldTransforms)}function GX(t,e,r,n=!1){return Tx(r,t.Qu(n?4:3,e))}function Tx(t,e){if(H6(t=ks(t)))return US("Unsupported field value:",e,t),V6(t,e);if(t instanceof w2)return function(n,s){if(!Q6(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const a=[];let o=0;for(const l of n){let c=Tx(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=ks(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return LW(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Kt.fromDate(n);return{timestampValue:U0(s.serializer,a)}}if(n instanceof Kt){const a=new Kt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:U0(s.serializer,a)}}if(n instanceof y2)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof nd)return{bytesValue:HU(s.serializer,n._byteString)};if(n instanceof Fa){const a=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:mS(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof b2)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return cS(l.serializer,c)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${x2(n)}`)}(t,e)}function V6(t,e){const r={};return fU(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vh(t,(n,s)=>{const a=Tx(s,e.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function H6(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Kt||t instanceof y2||t instanceof nd||t instanceof Fa||t instanceof w2||t instanceof b2)}function US(t,e,r){if(!H6(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=x2(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function K_(t,e,r){if((e=ks(e))instanceof qh)return e._internalPath;if(typeof e=="string")return OS(t,e);throw oy("Field path arguments must be of type string or ",t,!1,void 0,r)}const $X=new RegExp("[~\\*/\\[\\]]");function OS(t,e,r){if(e.search($X)>=0)throw oy(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new qh(...e.split("."))._internalPath}catch{throw oy(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function oy(t,e,r,n,s){const a=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(a||o)&&(c+=" (found",a&&(c+=` in field ${n}`),o&&(c+=` in document ${s}`),c+=")"),new $t(Et.INVALID_ARGUMENT,l+t+c)}function K6(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Fa(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(_2("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class zX extends ly{data(){return super.data()}}function _2(t,e){return typeof e=="string"?OS(t,e):e instanceof qh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $t(Et.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class MS{}class E2 extends MS{}function Ut(t,e,...r){let n=[];e instanceof MS&&n.push(e),n=n.concat(r),function(a){const o=a.filter(c=>c instanceof B2).length,l=a.filter(c=>c instanceof jx).length;if(o>1||o>0&&l>0)throw new $t(Et.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class jx extends E2{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new jx(e,r,n)}_apply(e){const r=this._parse(e);return $6(e._query,r),new Cc(e.firestore,e.converter,j_(e._query,r))}_parse(e){const r=sm(e.firestore);return function(a,o,l,c,A,u,d){let f;if(A.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new $t(Et.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){_k(d,u);const h=[];for(const m of d)h.push(Ck(c,a,m));f={arrayValue:{values:h}}}else f=Ck(c,a,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||_k(d,u),f=GX(l,o,d,u==="in"||u==="not-in");return rn.create(A,u,f)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function qt(t,e,r){const n=e,s=_2("where",t);return jx._create(s,n,r)}class B2 extends MS{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new B2(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:In.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let o=s;const l=a.getFlattenedFilters();for(const c of l)$6(o,c),o=j_(o,c)}(e._query,r),new Cc(e.firestore,e.converter,j_(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class S2 extends E2{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new S2(e,r)}_apply(e){const r=function(s,a,o){if(s.startAt!==null)throw new $t(Et.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new $t(Et.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Dg(a,o)}(e._query,this._field,this._direction);return new Cc(e.firestore,e.converter,function(s,a){const o=s.explicitOrderBy.concat([a]);return new em(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Rr(t,e="asc"){const r=e,n=_2("orderBy",t);return S2._create(n,r)}class I2 extends E2{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new I2(e,r,n)}_apply(e){return new Cc(e.firestore,e.converter,ey(e._query,this._limit,this._limitType))}}function G6(t){return I2._create("limit",t,"F")}function Ck(t,e,r){if(typeof(r=ks(r))=="string"){if(r==="")throw new $t(Et.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!EU(e)&&r.indexOf("/")!==-1)throw new $t(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(mn.fromString(r));if(!Yt.isDocumentKey(n))throw new $t(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Pg(t,new Yt(n))}if(r instanceof Fa)return Pg(t,r._key);throw new $t(Et.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${x2(r)}.`)}function _k(t,e){if(!Array.isArray(t)||t.length===0)throw new $t(Et.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function $6(t,e){const r=function(s,a){for(const o of s)for(const l of o.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new $t(Et.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $t(Et.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class QS{convertValue(e,r="none"){switch(_h(e)){case 0:return null;case 1:return e.booleanValue;case 2:return as(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Zu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw cr()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Vh(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,s;const a=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>as(o.doubleValue));return new b2(a)}convertGeoPoint(e){return new y2(as(e.latitude),as(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=oS(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Tg(e));default:return null}}convertTimestamp(e){const r=EA(e);return new Kt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=mn.fromString(e);mr(ZU(n));const s=new ed(n.get(1),n.get(3)),a=new Yt(n.popFirst(5));return s.isEqual(r)||ki(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class WX extends QS{constructor(e){super(),this.firestore=e}convertBytes(e){return new nd(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Fa(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class k2 extends ly{constructor(e,r,n,s,a,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Qp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(_2("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Qp extends k2{data(e={}){return super.data(e)}}class VS{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Zd(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Qp(this._firestore,this._userDataWriter,n.key,n,new Zd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $t(Et.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Qp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Zd(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>a||l.type!==3).map(l=>{const c=new Qp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Zd(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let A=-1,u=-1;return l.type!==0&&(A=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),u=o.indexOf(l.doc.key)),{type:JX(l.type),doc:c,oldIndex:A,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function JX(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cr()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(t){t=Ia(t,Fa);const e=Ia(t.firestore,ko);return MX(Kh(e),t._key).then(r=>W6(e,t,r))}class T2 extends QS{constructor(e){super(),this.firestore=e}convertBytes(e){return new nd(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Fa(this.firestore,null,r)}}function Nt(t){t=Ia(t,Cc);const e=Ia(t.firestore,ko),r=Kh(e),n=new T2(e);return q6(t._query),QX(r,t._query).then(s=>new VS(e,n,t,s))}function z6(t,e,r){t=Ia(t,Fa);const n=Ia(t.firestore,ko),s=F2(t.converter,e,r);return am(n,[N2(sm(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,cs.none())])}function kr(t,e,r,...n){t=Ia(t,Fa);const s=Ia(t.firestore,ko),a=sm(s);let o;return o=typeof(e=ks(e))=="string"||e instanceof qh?LS(a,"updateDoc",t._key,e,r,n):DS(a,"updateDoc",t._key,e),am(s,[o.toMutation(t._key,cs.exists(!0))])}function un(t){return am(Ia(t.firestore,ko),[new rm(t._key,cs.none())])}function Wr(t,e){const r=Ia(t.firestore,ko),n=kt(t),s=F2(t.converter,e);return am(r,[N2(sm(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,cs.exists(!1))]).then(()=>n)}function M0(t,...e){var r,n,s;t=ks(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Nk(e[o])||(a=e[o],o++);const l={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Nk(e[o])){const d=e[o];e[o]=(r=d.next)===null||r===void 0?void 0:r.bind(d),e[o+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),e[o+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let c,A,u;if(t instanceof Fa)A=Ia(t.firestore,ko),u=Ex(t._key.path),c={next:d=>{e[o]&&e[o](W6(A,t,d))},error:e[o+1],complete:e[o+2]};else{const d=Ia(t,Cc);A=Ia(d.firestore,ko),u=d._query;const f=new T2(A);c={next:h=>{e[o]&&e[o](new VS(A,f,d,h))},error:e[o+1],complete:e[o+2]},q6(t._query)}return function(f,h,m,p){const x=new jS(p),g=new kS(h,x,m);return f.asyncQueue.enqueueAndForget(async()=>SS(await iy(f),g)),()=>{x.Za(),f.asyncQueue.enqueueAndForget(async()=>IS(await iy(f),g))}}(Kh(A),u,l,c)}function am(t,e){return function(n,s){const a=new Ll;return n.asyncQueue.enqueueAndForget(async()=>EX(await UX(n),s,a)),a.promise}(Kh(t),e)}function W6(t,e,r){const n=r.docs.get(e._key),s=new T2(t);return new k2(t,s,e._key,n,new Zd(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XX={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=sm(e)}set(e,r,n){this._verifyNotCommitted();const s=Nu(e,this._firestore),a=F2(s.converter,r,n),o=N2(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,cs.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const a=Nu(e,this._firestore);let o;return o=typeof(r=ks(r))=="string"||r instanceof qh?LS(this._dataReader,"WriteBatch.update",a._key,r,n,s):DS(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(o.toMutation(a._key,cs.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Nu(e,this._firestore);return this._mutations=this._mutations.concat(new rm(r._key,cs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $t(Et.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Nu(t,e){if((t=ks(t)).firestore!==e)throw new $t(Et.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6 extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=sm(r)}get(r){const n=Nu(r,this._firestore),s=new WX(this._firestore);return this._transaction.lookup([n._key]).then(a=>{if(!a||a.length!==1)return cr();const o=a[0];if(o.isFoundDocument())return new ly(this._firestore,s,o.key,o,n.converter);if(o.isNoDocument())return new ly(this._firestore,s,n._key,null,n.converter);throw cr()})}set(r,n,s){const a=Nu(r,this._firestore),o=F2(a.converter,n,s),l=N2(this._dataReader,"Transaction.set",a._key,o,a.converter!==null,s);return this._transaction.set(a._key,l),this}update(r,n,s,...a){const o=Nu(r,this._firestore);let l;return l=typeof(n=ks(n))=="string"||n instanceof qh?LS(this._dataReader,"Transaction.update",o._key,n,s,a):DS(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=Nu(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=Nu(e,this._firestore),n=new T2(this._firestore);return super.get(e).then(s=>new k2(this._firestore,n,r._key,s._document,new Zd(!1,!1),r.converter))}}function ha(t,e,r){t=Ia(t,ko);const n=Object.assign(Object.assign({},XX),r);return function(a){if(a.maxAttempts<1)throw new $t(Et.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(a,o,l){const c=new Ll;return a.asyncQueue.enqueueAndForget(async()=>{const A=await OX(a);new RX(a.asyncQueue,A,l,o,c).au()}),c.promise}(Kh(t),s=>e(new X6(t,s)),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(t){return Kh(t=Ia(t,ko)),new J6(t,e=>am(t,e))}(function(e,r=!0){(function(s){Z0=s})(X0),k0(new yh("firestore",(n,{instanceIdentifier:s,options:a})=>{const o=n.getProvider("app").getImmediate(),l=new ko(new Uz(n.getProvider("auth-internal")),new Vz(n.getProvider("app-check-internal")),function(A,u){if(!Object.prototype.hasOwnProperty.apply(A.options,["projectId"]))throw new $t(Et.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ed(A.options.projectId,u)}(o,s),o);return a=Object.assign({useFetchStreams:r},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),qu(gF,"4.7.3",e),qu(gF,"4.7.3","esm2017")})();const YX=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:QS,Bytes:nd,CollectionReference:hA,DocumentReference:Fa,DocumentSnapshot:k2,FieldPath:qh,FieldValue:w2,Firestore:ko,FirestoreError:$t,GeoPoint:y2,Query:Cc,QueryCompositeFilterConstraint:B2,QueryConstraint:E2,QueryDocumentSnapshot:Qp,QueryFieldFilterConstraint:jx,QueryLimitConstraint:I2,QueryOrderByConstraint:S2,QuerySnapshot:VS,SnapshotMetadata:Zd,Timestamp:Kt,Transaction:X6,VectorValue:b2,WriteBatch:J6,_AutoId:rS,_ByteString:qs,_DatabaseId:ed,_DocumentKey:Yt,_EmptyAuthCredentialsProvider:sU,_FieldPath:ls,_cast:Ia,_logWarn:Yu,_validateIsNotUsedTogether:R6,addDoc:Wr,collection:At,connectFirestoreEmulator:D6,deleteDoc:un,doc:kt,enableIndexedDbPersistence:O6,ensureFirestoreConfigured:Kh,executeWrite:am,getDoc:Wa,getDocs:Nt,getFirestore:L6,limit:G6,onSnapshot:M0,orderBy:Rr,query:Ut,runTransaction:ha,setDoc:z6,updateDoc:kr,where:qt,writeBatch:Gh},Symbol.toStringTag,{value:"Module"})),ZX={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},Y6=HB(ZX),je=L6(Y6),Px=JL(Y6);O6(je).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function eY(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,a]=N.useState(!1),[o,l]=N.useState(""),[c,A]=N.useState(!1),u=px(),d=h=>{if(localStorage.setItem("role",h),h==="admin")return u("/admin");if(h==="vendedor_pollo")return u("/admin/salesV2");if(h==="vendedor_ropa")return u("/admin/salesClothes");if(h==="vendedor_dulces")return u("/admin/salesCandies")},f=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{A(!0);const m=await y$(Px,t,r),p=m.user.uid,x=await Wa(kt(je,"users",p));if(!x.exists()){l("Tu usuario no tiene perfil en la base de datos.");return}const g=x.data(),y=g.role||"",b=g.name||"";if(!["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].includes(y)){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),b&&localStorage.setItem("user_name",b),d(y)}catch(m){const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas.":p==="auth/user-not-found"?"Usuario no encontrado.":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde.":(m==null?void 0:m.message)||"Error al iniciar sesin.")}finally{A(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:f,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:s?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>a(h=>!h),children:s?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function zr({children:t,allowedRoles:e}){const[r,n]=N.useState(!0),[s,a]=N.useState(!1);return N.useEffect(()=>{const o=OL(Px,async l=>{if(l){const c=kt(je,"users",l.uid),A=await Wa(c);if(A.exists()){const u=A.data().role;a(e.includes(u))}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):s?t:i.jsx(Od,{to:"/"})}function tY({role:t}){const e="/admin",r=({isActive:W})=>`block rounded px-3 py-2 text-sm ${W?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,n=px(),[s,a]=N.useState(!1),[o,l]=N.useState(!1),[c,A]=N.useState(!1),[u,d]=N.useState(!1),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[x,g]=N.useState(!1),[y,b]=N.useState(!1),[F,P]=N.useState(!1),[R,_]=N.useState(!1),[B,E]=N.useState(!1),[M,k]=N.useState(!1),[T,U]=N.useState(!1),[Z,pe]=N.useState(!1),[ae,he]=N.useState(!1),[de,re]=N.useState(!1),xe=async()=>{await YB(Px),n("/")},Ce=({open:W,onClick:D,children:Y})=>i.jsxs("button",{type:"button",onClick:D,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:Y}),i.jsx("span",{className:"text-xs",children:W?"":""})]}),S=({open:W,onClick:D,title:Y})=>i.jsxs("button",{type:"button",onClick:D,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:Y}),i.jsx("span",{className:"text-xs",children:W?"":""})]}),I=t==="admin",V=t==="vendedor_pollo"||t==="vendedor",j=t==="vendedor_ropa",O=t==="vendedor_dulces";return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>a(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[I&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ce,{open:o,onClick:()=>l(W=>!W),children:"Pollos Bea"}),o&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:c,onClick:()=>A(W=>!W),title:"Inventarios"}),c&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(_r,{to:`${e}/batches`,className:r,children:"Inventario Pollo"}),i.jsx(_r,{to:`${e}/paidBatches`,className:r,children:"Inventarios Pagados"})]}),i.jsx(S,{open:u,onClick:()=>d(W=>!W),title:"Finanzas"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(_r,{to:`${e}/financialDashboard`,className:r,children:"Dashboard"}),i.jsx(_r,{to:`${e}/billing`,className:r,children:"Facturacion"}),i.jsx(_r,{to:`${e}/expenses`,className:r,children:"Gastos"}),i.jsx(_r,{to:`${e}/salesV2`,className:r,children:"Venta"}),i.jsx(_r,{to:`${e}/bills`,className:r,children:"Cierre"}),i.jsx(_r,{to:`${e}/billhistoric`,className:r,children:"Historial de Cierres"})]}),i.jsx(S,{open:f,onClick:()=>h(W=>!W),title:"Productos"}),f&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/products`,className:r,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ce,{open:m,onClick:()=>p(W=>!W),children:"Chiqui Look"}),m&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:x,onClick:()=>g(W=>!W),title:"Inventario"}),x&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/InventoryClothesBatches`,className:r,children:"Inventario Ropa"})}),i.jsx(S,{open:y,onClick:()=>b(W=>!W),title:"Productos"}),y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),i.jsx(S,{open:F,onClick:()=>P(W=>!W),title:"Clientes"}),F&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})}),i.jsx(S,{open:R,onClick:()=>_(W=>!W),title:"Finanzas"}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"})}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/financialDashboardClothes`,className:r,children:"Dashboard Financiero"})}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/ExpensesClothes`,className:r,children:"Gastos Ropa"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ce,{open:M,onClick:()=>k(W=>!W),children:"CandyShop"}),M&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:Z,onClick:()=>pe(W=>!W),title:"Vendedores"}),Z&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),Z&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/productsVendorsCandies`,className:r,children:"Sub ordenes"})}),i.jsx(S,{open:T,onClick:()=>U(W=>!W),title:"Inventario"}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/mainordersCandies`,className:r,children:"Ordenes Maestras"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/inventoryMainOrderCandies`,className:r,children:"Lista de Ordenes"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/inventoryCandies`,className:r,children:"Lista Productos"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/productsCandies`,className:r,children:"Productos"})}),i.jsx(S,{open:ae,onClick:()=>he(W=>!W),title:"Finanzas"}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/datacenter`,className:r,children:"Data Center"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/transactionCandies`,className:r,children:"Transacciones"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/reporteCierresCandies`,className:r,children:"Reporte Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/billingsCandies`,className:r,children:"Facturas"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/consolidatedVendors`,className:r,children:"Consolidado Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/dashboardCandies`,className:r,children:"Dashboard"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/customersCandies`,className:r,children:"Clientes"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/vendorsCandies`,className:r,children:"Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/expensesCandies`,className:r,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ce,{open:de,onClick:()=>re(W=>!W),children:"Operaciones Otras"}),de&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(_r,{to:`${e}/users`,className:r,children:"Usuarios"}),i.jsx(_r,{to:`${e}/fix`,className:r,children:"Fix de lotes"}),i.jsx(_r,{to:`${e}/transactionclose`,className:r,children:"Liquidaciones"})]})]})]}),V&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Ce,{open:u,onClick:()=>d(W=>!W),children:"Finanzas (Pollo)"}),u&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(_r,{to:`${e}/salesV2`,className:r,children:"Venta"}),i.jsx(_r,{to:`${e}/bills`,className:r,children:"Cierre"})]})]}),O&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/transactionCandies`,className:r,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/productsVendorsCandies`,className:r,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/customersCandies`,className:r,children:"Clientes"})})]}),j&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Ce,{open:m,onClick:()=>p(W=>!W),children:"Operaciones Ropa"}),m&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:R,onClick:()=>_(W=>!W),title:"Ventas"}),R&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(_r,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"}),i.jsx(_r,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})]}),i.jsx(S,{open:y,onClick:()=>b(W=>!W),title:"Productos"}),y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),i.jsx(S,{open:F,onClick:()=>P(W=>!W),title:"Clientes"}),F&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(_r,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:xe,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(JD,{})})]})}function rN(...t){return t.filter(Boolean).join(" ")}function rY({role:t}){const e=px(),r="/admin",n=t==="admin",s=t==="vendedor_pollo",a=t==="vendedor_dulces",[o,l]=N.useState(()=>s?"POLLO":a?"DULCES":"POLLO"),c=N.useMemo(()=>n?o==="POLLO"?[{key:"dash",label:"Dashboard",to:`${r}/financialDashboard`},{key:"inv",label:"Inventario",to:`${r}/batches`},{key:"cierre",label:"Cierre",to:`${r}/bills`},{key:"hist",label:"Historial",to:`${r}/billhistoric`}]:[{key:"dc",label:"Data",to:`${r}/datacenter`},{key:"ord",label:"rdenes",to:`${r}/productsVendorsCandies`},{key:"maes",label:"Maestras",to:`${r}/mainordersCandies`},{key:"cli",label:"Clientes",to:`${r}/customersCandies`},{key:"cier",label:"Cierres",to:`${r}/cierreVentasCandies`}]:s?[{key:"venta",label:"Venta",to:`${r}/salesV2`},{key:"inv",label:"Inventario",to:`${r}/batches`},{key:"cierre",label:"Cierre",to:`${r}/bills`}]:a?[{key:"venta",label:"Venta",to:`${r}/salesCandies`},{key:"ped",label:"Pedidos",to:`${r}/productsVendorsCandies`},{key:"cli",label:"Clientes",to:`${r}/customersCandies`},{key:"cier",label:"Cierre",to:`${r}/cierreVentasCandies`}]:[{key:"home",label:"Inicio",to:`${r}`}],[n,s,a,o]);N.useEffect(()=>{n&&c.length&&e(c[0].to,{replace:!0})},[o]);const A=async()=>{await YB(Px),e("/")},u=({isActive:d})=>rN("flex-1 text-center text-xs py-2 rounded-xl",d?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7]",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[n?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>l("POLLO"),className:rN("px-3 py-2 rounded-2xl text-sm font-semibold",o==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Pollos Bea"}),i.jsx("button",{type:"button",onClick:()=>l("DULCES"),className:rN("px-3 py-2 rounded-2xl text-sm font-semibold",o==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"CandyShop"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:s?"Pollos Bea":a?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto",children:i.jsx("button",{onClick:A,className:"px-3 py-2 rounded-2xl bg-red-500 text-white text-sm font-semibold shadow hover:bg-red-600",children:"Cerrar"})})]})}),i.jsx("main",{className:"px-3 pt-3 pb-24",children:i.jsx(JD,{})}),i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-2 flex gap-2",children:c.map(d=>i.jsx(_r,{to:d.to,className:u,children:d.label},d.key))})})]})}const Z6=6048e5,nY=864e5,Ek=Symbol.for("constructDateFrom");function Hl(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Ek in t?t[Ek](e):t instanceof Date?new t.constructor(e):new Date(e)}function Li(t,e){return Hl(e||t,t)}function sY(t,e,r){const n=Li(t,r==null?void 0:r.in);return isNaN(e)?Hl(t,NaN):(n.setDate(n.getDate()+e),n)}function aY(t,e,r){const n=Li(t,r==null?void 0:r.in);if(isNaN(e))return Hl(t,NaN);const s=n.getDate(),a=Hl(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const o=a.getDate();return s>=o?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}let iY={};function j2(){return iY}function Vg(t,e){var l,c,A,u;const r=j2(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(A=r.locale)==null?void 0:A.options)==null?void 0:u.weekStartsOn)??0,s=Li(t,e==null?void 0:e.in),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function cy(t,e){return Vg(t,{...e,weekStartsOn:1})}function eO(t,e){const r=Li(t,e==null?void 0:e.in),n=r.getFullYear(),s=Hl(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=cy(s),o=Hl(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=cy(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function Bk(t){const e=Li(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function oY(t,...e){const r=Hl.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function Sk(t,e){const r=Li(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function lY(t,e,r){const[n,s]=oY(r==null?void 0:r.in,t,e),a=Sk(n),o=Sk(s),l=+a-Bk(a),c=+o-Bk(o);return Math.round((l-c)/nY)}function cY(t,e){const r=eO(t,e),n=Hl(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),cy(n)}function AY(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function uY(t){return!(!AY(t)&&typeof t!="number"||isNaN(+Li(t)))}function _c(t,e){const r=Li(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Ec(t,e){const r=Li(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function dY(t,e){const r=Li(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const hY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fY=(t,e,r)=>{let n;const s=hY[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function nN(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const mY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},pY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},gY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xY={date:nN({formats:mY,defaultWidth:"full"}),time:nN({formats:pY,defaultWidth:"full"}),dateTime:nN({formats:gY,defaultWidth:"full"})},vY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},wY=(t,e,r,n)=>vY[t];function Gm(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return s[a]}}const yY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},NY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},CY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_Y={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},EY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},BY=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},SY={ordinalNumber:BY,era:Gm({values:yY,defaultWidth:"wide"}),quarter:Gm({values:bY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Gm({values:NY,defaultWidth:"wide"}),day:Gm({values:CY,defaultWidth:"wide"}),dayPeriod:Gm({values:_Y,defaultWidth:"wide",formattingValues:EY,defaultFormattingWidth:"wide"})};function $m(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?FY(l,d=>d.test(o)):IY(l,d=>d.test(o));let A;A=t.valueCallback?t.valueCallback(c):c,A=r.valueCallback?r.valueCallback(A):A;const u=e.slice(o.length);return{value:A,rest:u}}}function IY(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function FY(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function kY(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const TY=/^(\d+)(th|st|nd|rd)?/i,jY=/\d+/i,PY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},RY={any:[/^b/i,/^(a|c)/i]},DY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},LY={any:[/1/i,/2/i,/3/i,/4/i]},UY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},OY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},MY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},QY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},VY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},HY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},KY={ordinalNumber:kY({matchPattern:TY,parsePattern:jY,valueCallback:t=>parseInt(t,10)}),era:$m({matchPatterns:PY,defaultMatchWidth:"wide",parsePatterns:RY,defaultParseWidth:"any"}),quarter:$m({matchPatterns:DY,defaultMatchWidth:"wide",parsePatterns:LY,defaultParseWidth:"any",valueCallback:t=>t+1}),month:$m({matchPatterns:UY,defaultMatchWidth:"wide",parsePatterns:OY,defaultParseWidth:"any"}),day:$m({matchPatterns:MY,defaultMatchWidth:"wide",parsePatterns:QY,defaultParseWidth:"any"}),dayPeriod:$m({matchPatterns:VY,defaultMatchWidth:"any",parsePatterns:HY,defaultParseWidth:"any"})},qY={code:"en-US",formatDistance:fY,formatLong:xY,formatRelative:wY,localize:SY,match:KY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function GY(t,e){const r=Li(t,e==null?void 0:e.in);return lY(r,dY(r))+1}function $Y(t,e){const r=Li(t,e==null?void 0:e.in),n=+cy(r)-+cY(r);return Math.round(n/Z6)+1}function tO(t,e){var u,d,f,h;const r=Li(t,e==null?void 0:e.in),n=r.getFullYear(),s=j2(),a=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(f=s.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,o=Hl((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Vg(o,e),c=Hl((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const A=Vg(c,e);return+r>=+l?n+1:+r>=+A?n:n-1}function zY(t,e){var l,c,A,u;const r=j2(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(A=r.locale)==null?void 0:A.options)==null?void 0:u.firstWeekContainsDate)??1,s=tO(t,e),a=Hl((e==null?void 0:e.in)||t,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),Vg(a,e)}function WY(t,e){const r=Li(t,e==null?void 0:e.in),n=+Vg(r,e)-+zY(r,e);return Math.round(n/Z6)+1}function En(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const su={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return En(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):En(r+1,2)},d(t,e){return En(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return En(t.getHours()%12||12,e.length)},H(t,e){return En(t.getHours(),e.length)},m(t,e){return En(t.getMinutes(),e.length)},s(t,e){return En(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return En(s,e.length)}},vf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ik={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return su.y(t,e)},Y:function(t,e,r,n){const s=tO(t,n),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return En(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):En(a,e.length)},R:function(t,e){const r=eO(t);return En(r,e.length)},u:function(t,e){const r=t.getFullYear();return En(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return En(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return En(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return su.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return En(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=WY(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):En(s,e.length)},I:function(t,e,r){const n=$Y(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):En(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):su.d(t,e)},D:function(t,e,r){const n=GY(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):En(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return En(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return En(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return En(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=vf.noon:n===0?s=vf.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=vf.evening:n>=12?s=vf.afternoon:n>=4?s=vf.morning:s=vf.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return su.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):su.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):En(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):En(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):su.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):su.s(t,e)},S:function(t,e){return su.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return kk(n);case"XXXX":case"XX":return Vd(n);case"XXXXX":case"XXX":default:return Vd(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return kk(n);case"xxxx":case"xx":return Vd(n);case"xxxxx":case"xxx":default:return Vd(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Fk(n,":");case"OOOO":default:return"GMT"+Vd(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Fk(n,":");case"zzzz":default:return"GMT"+Vd(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return En(n,e.length)},T:function(t,e,r){return En(+t,e.length)}};function Fk(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+e+En(a,2)}function kk(t,e){return t%60===0?(t>0?"-":"+")+En(Math.abs(t)/60,2):Vd(t,e)}function Vd(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=En(Math.trunc(n/60),2),a=En(n%60,2);return r+s+e+a}const Tk=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},rO=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},JY=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Tk(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",Tk(n,e)).replace("{{time}}",rO(s,e))},XY={p:rO,P:JY},YY=/^D+$/,ZY=/^Y+$/,eZ=["D","DD","YY","YYYY"];function tZ(t){return YY.test(t)}function rZ(t){return ZY.test(t)}function nZ(t,e,r){const n=sZ(t,e,r);if(console.warn(n),eZ.includes(t))throw new RangeError(n)}function sZ(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const aZ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,iZ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,oZ=/^'([^]*?)'?$/,lZ=/''/g,cZ=/[a-zA-Z]/;function rr(t,e,r){var u,d,f,h;const n=j2(),s=n.locale??qY,a=n.firstWeekContainsDate??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??0,l=Li(t,r==null?void 0:r.in);if(!uY(l))throw new RangeError("Invalid time value");let c=e.match(iZ).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=XY[p];return x(m,s.formatLong)}return m}).join("").match(aZ).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:AZ(m)};if(Ik[p])return{isToken:!0,value:m};if(p.match(cZ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const A={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(rZ(p)||tZ(p))&&nZ(p,e,String(t));const x=Ik[p[0]];return x(l,p,s.localize,A)}).join("")}function AZ(t){const e=t.match(oZ);return e?e[1].replace(lZ,"'"):t}function nO(t,e,r){return sY(t,-14,r)}function uZ(t,e,r){return aY(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var q_=function(t,e){return q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},q_(t,e)};function $l(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");q_(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var G_=function(){return G_=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},G_.apply(this,arguments)};function Bi(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{A(n.next(u))}catch(d){o(d)}}function c(u){try{A(n.throw(u))}catch(d){o(d)}}function A(u){u.done?a(u.value):s(u.value).then(l,c)}A((n=n.apply(t,[])).next())})}function oi(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(A){return function(u){return c([A,u])}}function c(A){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(a=A[0]&2?s.return:A[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,A[1])).done)return a;switch(s=0,a&&(A=[A[0]&2,a.value]),A[0]){case 0:case 1:a=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,s=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!a||A[1]>a[0]&&A[1]<a[3])){r.label=A[1];break}if(A[0]===6&&r.label<a[1]){r.label=a[1],a=A;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(A);break}a[2]&&r.ops.pop(),r.trys.pop();continue}A=e.call(t,r)}catch(u){A=[6,u],s=0}finally{n=a=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Rv(t,e,r){if(arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||e)}var BA=function(){function t(e,r,n,s){this.left=e,this.top=r,this.width=n,this.height=s}return t.prototype.add=function(e,r,n,s){return new t(this.left+e,this.top+r,this.width+n,this.height+s)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(s){return s.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),P2=function(t,e){return BA.fromClientRect(t,e.getBoundingClientRect())},dZ=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),s=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new BA(0,0,n,s)},R2=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=t.charCodeAt(r++);(a&64512)===56320?e.push(((s&1023)<<10)+(a&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},Os=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},jk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Dv=0;Dv<jk.length;Dv++)hZ[jk.charCodeAt(Dv)]=Dv;var Pk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mp=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Lv=0;Lv<Pk.length;Lv++)mp[Pk.charCodeAt(Lv)]=Lv;var fZ=function(t){var e=t.length*.75,r=t.length,n,s=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=mp[t.charCodeAt(n)],o=mp[t.charCodeAt(n+1)],l=mp[t.charCodeAt(n+2)],c=mp[t.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},mZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},pZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},ih=5,HS=11,sN=2,gZ=HS-ih,sO=65536>>ih,xZ=1<<ih,aN=xZ-1,vZ=1024>>ih,wZ=sO+vZ,yZ=wZ,bZ=32,NZ=yZ+bZ,CZ=65536>>HS,_Z=1<<gZ,EZ=_Z-1,Rk=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},BZ=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},SZ=function(t,e){var r=fZ(t),n=Array.isArray(r)?pZ(r):new Uint32Array(r),s=Array.isArray(r)?mZ(r):new Uint16Array(r),a=24,o=Rk(s,a/2,n[4]/2),l=n[5]===2?Rk(s,(a+n[4])/2):BZ(n,Math.ceil((a+n[4])/4));return new IZ(n[0],n[1],n[2],n[3],o,l)},IZ=function(){function t(e,r,n,s,a,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>ih],r=(r<<sN)+(e&aN),this.data[r];if(e<=65535)return r=this.index[sO+(e-55296>>ih)],r=(r<<sN)+(e&aN),this.data[r];if(e<this.highStart)return r=NZ-CZ+(e>>HS),r=this.index[r],r+=e>>ih&EZ,r=this.index[r],r=(r<<sN)+(e&aN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),Dk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",FZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Uv=0;Uv<Dk.length;Uv++)FZ[Dk.charCodeAt(Uv)]=Uv;var kZ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Lk=50,TZ=1,aO=2,iO=3,jZ=4,PZ=5,Uk=7,oO=8,Ok=9,Su=10,$_=11,Mk=12,z_=13,RZ=14,pp=15,W_=16,Ov=17,zm=18,DZ=19,Qk=20,J_=21,Wm=22,iN=23,wf=24,vo=25,gp=26,xp=27,yf=28,LZ=29,zd=30,UZ=31,Mv=32,Qv=33,X_=34,Y_=35,Z_=36,Hg=37,eE=38,dw=39,hw=40,oN=41,lO=42,OZ=43,MZ=[9001,65288],cO="!",en="",Vv="",tE=SZ(kZ),Kc=[zd,Z_],rE=[TZ,aO,iO,PZ],AO=[Su,oO],Vk=[xp,gp],QZ=rE.concat(AO),Hk=[eE,dw,hw,X_,Y_],VZ=[pp,z_],HZ=function(t,e){e===void 0&&(e="strict");var r=[],n=[],s=[];return t.forEach(function(a,o){var l=tE.get(a);if(l>Lk?(s.push(!0),l-=Lk):s.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(a)!==-1)return n.push(o),r.push(W_);if(l===jZ||l===$_){if(o===0)return n.push(o),r.push(zd);var c=r[o-1];return QZ.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(zd))}if(n.push(o),l===UZ)return r.push(e==="strict"?J_:Hg);if(l===lO||l===LZ)return r.push(zd);if(l===OZ)return a>=131072&&a<=196605||a>=196608&&a<=262141?r.push(Hg):r.push(zd);r.push(l)}),[n,r,s]},lN=function(t,e,r,n){var s=n[r];if(Array.isArray(t)?t.indexOf(s)!==-1:t===s)for(var a=r;a<=n.length;){a++;var o=n[a];if(o===e)return!0;if(o!==Su)break}if(s===Su)for(var a=r;a>0;){a--;var l=n[a];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==Su)break}if(l!==Su)break}return!1},Kk=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===Su)r--;else return n}return 0},KZ=function(t,e,r,n,s){if(r[n]===0)return en;var a=n-1;if(Array.isArray(s)&&s[a]===!0)return en;var o=a-1,l=a+1,c=e[a],A=o>=0?e[o]:0,u=e[l];if(c===aO&&u===iO)return en;if(rE.indexOf(c)!==-1)return cO;if(rE.indexOf(u)!==-1||AO.indexOf(u)!==-1)return en;if(Kk(a,e)===oO)return Vv;if(tE.get(t[a])===$_||(c===Mv||c===Qv)&&tE.get(t[l])===$_||c===Uk||u===Uk||c===Ok||[Su,z_,pp].indexOf(c)===-1&&u===Ok||[Ov,zm,DZ,wf,yf].indexOf(u)!==-1||Kk(a,e)===Wm||lN(iN,Wm,a,e)||lN([Ov,zm],J_,a,e)||lN(Mk,Mk,a,e))return en;if(c===Su)return Vv;if(c===iN||u===iN)return en;if(u===W_||c===W_)return Vv;if([z_,pp,J_].indexOf(u)!==-1||c===RZ||A===Z_&&VZ.indexOf(c)!==-1||c===yf&&u===Z_||u===Qk||Kc.indexOf(u)!==-1&&c===vo||Kc.indexOf(c)!==-1&&u===vo||c===xp&&[Hg,Mv,Qv].indexOf(u)!==-1||[Hg,Mv,Qv].indexOf(c)!==-1&&u===gp||Kc.indexOf(c)!==-1&&Vk.indexOf(u)!==-1||Vk.indexOf(c)!==-1&&Kc.indexOf(u)!==-1||[xp,gp].indexOf(c)!==-1&&(u===vo||[Wm,pp].indexOf(u)!==-1&&e[l+1]===vo)||[Wm,pp].indexOf(c)!==-1&&u===vo||c===vo&&[vo,yf,wf].indexOf(u)!==-1)return en;if([vo,yf,wf,Ov,zm].indexOf(u)!==-1)for(var d=a;d>=0;){var f=e[d];if(f===vo)return en;if([yf,wf].indexOf(f)!==-1)d--;else break}if([xp,gp].indexOf(u)!==-1)for(var d=[Ov,zm].indexOf(c)!==-1?o:a;d>=0;){var f=e[d];if(f===vo)return en;if([yf,wf].indexOf(f)!==-1)d--;else break}if(eE===c&&[eE,dw,X_,Y_].indexOf(u)!==-1||[dw,X_].indexOf(c)!==-1&&[dw,hw].indexOf(u)!==-1||[hw,Y_].indexOf(c)!==-1&&u===hw||Hk.indexOf(c)!==-1&&[Qk,gp].indexOf(u)!==-1||Hk.indexOf(u)!==-1&&c===xp||Kc.indexOf(c)!==-1&&Kc.indexOf(u)!==-1||c===wf&&Kc.indexOf(u)!==-1||Kc.concat(vo).indexOf(c)!==-1&&u===Wm&&MZ.indexOf(t[l])===-1||Kc.concat(vo).indexOf(u)!==-1&&c===zm)return en;if(c===oN&&u===oN){for(var h=r[a],m=1;h>0&&(h--,e[h]===oN);)m++;if(m%2!==0)return en}return c===Mv&&u===Qv?en:Vv},qZ=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=HZ(t,e.lineBreak),n=r[0],s=r[1],a=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(s=s.map(function(l){return[vo,zd,lO].indexOf(l)!==-1?Hg:l}));var o=e.wordBreak==="keep-all"?a.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,s,o]},GZ=function(){function t(e,r,n,s){this.codePoints=e,this.required=r===cO,this.start=n,this.end=s}return t.prototype.slice=function(){return Os.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),$Z=function(t,e){var r=R2(t),n=qZ(r,e),s=n[0],a=n[1],o=n[2],l=r.length,c=0,A=0;return{next:function(){if(A>=l)return{done:!0,value:null};for(var u=en;A<l&&(u=KZ(r,a,s,++A,o))===en;);if(u!==en||A===l){var d=new GZ(r,u,c,A);return c=A,{value:d,done:!1}}return{done:!0,value:null}}}},zZ=1,WZ=2,Rx=4,qk=8,Ay=10,Gk=47,Vp=92,JZ=9,XZ=32,Hv=34,Jm=61,YZ=35,ZZ=36,eee=37,Kv=39,qv=40,Xm=41,tee=95,$i=45,ree=33,nee=60,see=62,aee=64,iee=91,oee=93,lee=61,cee=123,Gv=63,Aee=125,$k=124,uee=126,dee=128,zk=65533,cN=42,eh=43,hee=44,fee=58,mee=59,Kg=46,pee=0,gee=8,xee=11,vee=14,wee=31,yee=127,ac=-1,uO=48,dO=97,hO=101,bee=102,Nee=117,Cee=122,fO=65,mO=69,pO=70,_ee=85,Eee=90,Ai=function(t){return t>=uO&&t<=57},Bee=function(t){return t>=55296&&t<=57343},bf=function(t){return Ai(t)||t>=fO&&t<=pO||t>=dO&&t<=bee},See=function(t){return t>=dO&&t<=Cee},Iee=function(t){return t>=fO&&t<=Eee},Fee=function(t){return See(t)||Iee(t)},kee=function(t){return t>=dee},$v=function(t){return t===Ay||t===JZ||t===XZ},uy=function(t){return Fee(t)||kee(t)||t===tee},Wk=function(t){return uy(t)||Ai(t)||t===$i},Tee=function(t){return t>=pee&&t<=gee||t===xee||t>=vee&&t<=wee||t===yee},mu=function(t,e){return t!==Vp?!1:e!==Ay},zv=function(t,e,r){return t===$i?uy(e)||mu(e,r):uy(t)?!0:!!(t===Vp&&mu(t,e))},AN=function(t,e,r){return t===eh||t===$i?Ai(e)?!0:e===Kg&&Ai(r):Ai(t===Kg?e:t)},jee=function(t){var e=0,r=1;(t[e]===eh||t[e]===$i)&&(t[e]===$i&&(r=-1),e++);for(var n=[];Ai(t[e]);)n.push(t[e++]);var s=n.length?parseInt(Os.apply(void 0,n),10):0;t[e]===Kg&&e++;for(var a=[];Ai(t[e]);)a.push(t[e++]);var o=a.length,l=o?parseInt(Os.apply(void 0,a),10):0;(t[e]===mO||t[e]===hO)&&e++;var c=1;(t[e]===eh||t[e]===$i)&&(t[e]===$i&&(c=-1),e++);for(var A=[];Ai(t[e]);)A.push(t[e++]);var u=A.length?parseInt(Os.apply(void 0,A),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*u)},Pee={type:2},Ree={type:3},Dee={type:4},Lee={type:13},Uee={type:8},Oee={type:21},Mee={type:9},Qee={type:10},Vee={type:11},Hee={type:12},Kee={type:14},Wv={type:23},qee={type:1},Gee={type:25},$ee={type:24},zee={type:26},Wee={type:27},Jee={type:28},Xee={type:29},Yee={type:31},nE={type:32},gO=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(R2(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==nE;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Hv:return this.consumeStringToken(Hv);case YZ:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(Wk(r)||mu(n,s)){var a=zv(r,n,s)?WZ:zZ,o=this.consumeName();return{type:5,value:o,flags:a}}break;case ZZ:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Lee;break;case Kv:return this.consumeStringToken(Kv);case qv:return Pee;case Xm:return Ree;case cN:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Kee;break;case eh:if(AN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case hee:return Dee;case $i:var l=e,c=this.peekCodePoint(0),A=this.peekCodePoint(1);if(AN(l,c,A))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(zv(l,c,A))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===$i&&A===see)return this.consumeCodePoint(),this.consumeCodePoint(),$ee;break;case Kg:if(AN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case Gk:if(this.peekCodePoint(0)===cN)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===cN&&(u=this.consumeCodePoint(),u===Gk))return this.consumeToken();if(u===ac)return this.consumeToken()}break;case fee:return zee;case mee:return Wee;case nee:if(this.peekCodePoint(0)===ree&&this.peekCodePoint(1)===$i&&this.peekCodePoint(2)===$i)return this.consumeCodePoint(),this.consumeCodePoint(),Gee;break;case aee:var d=this.peekCodePoint(0),f=this.peekCodePoint(1),h=this.peekCodePoint(2);if(zv(d,f,h)){var o=this.consumeName();return{type:7,value:o}}break;case iee:return Jee;case Vp:if(mu(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case oee:return Xee;case lee:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Uee;break;case cee:return Vee;case Aee:return Hee;case Nee:case _ee:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===eh&&(bf(p)||p===Gv)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case $k:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Mee;if(this.peekCodePoint(0)===$k)return this.consumeCodePoint(),Oee;break;case uee:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Qee;break;case ac:return nE}return $v(e)?(this.consumeWhiteSpace(),Yee):Ai(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):uy(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Os(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();bf(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===Gv&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(Os.apply(void 0,e.map(function(c){return c===Gv?uO:c})),16),a=parseInt(Os.apply(void 0,e.map(function(c){return c===Gv?pO:c})),16);return{type:30,start:s,end:a}}var o=parseInt(Os.apply(void 0,e),16);if(this.peekCodePoint(0)===$i&&bf(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];bf(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var a=parseInt(Os.apply(void 0,l),16);return{type:30,start:o,end:a}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===qv?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===qv?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ac)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Kv||r===Hv){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ac||this.peekCodePoint(0)===Xm)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),Wv)}for(;;){var s=this.consumeCodePoint();if(s===ac||s===Xm)return{type:22,value:Os.apply(void 0,e)};if($v(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ac||this.peekCodePoint(0)===Xm?(this.consumeCodePoint(),{type:22,value:Os.apply(void 0,e)}):(this.consumeBadUrlRemnants(),Wv);if(s===Hv||s===Kv||s===qv||Tee(s))return this.consumeBadUrlRemnants(),Wv;if(s===Vp)if(mu(s,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Wv;else e.push(s)}},t.prototype.consumeWhiteSpace=function(){for(;$v(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===Xm||e===ac)return;mu(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var s=Math.min(r,e);n+=Os.apply(void 0,this._value.splice(0,s)),e-=s}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var s=this._value[n];if(s===ac||s===void 0||s===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(s===Ay)return this._value.splice(0,n),qee;if(s===Vp){var a=this._value[n+1];a!==ac&&a!==void 0&&(a===Ay?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):mu(s,a)&&(r+=this.consumeStringSlice(n),r+=Os(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Rx,n=this.peekCodePoint(0);for((n===eh||n===$i)&&e.push(this.consumeCodePoint());Ai(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===Kg&&Ai(s))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=qk;Ai(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var a=this.peekCodePoint(2);if((n===mO||n===hO)&&((s===eh||s===$i)&&Ai(a)||Ai(s)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=qk;Ai(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[jee(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],s=this.peekCodePoint(0),a=this.peekCodePoint(1),o=this.peekCodePoint(2);if(zv(s,a,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return s===eee?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(bf(e)){for(var r=Os(e);bf(this.peekCodePoint(0))&&r.length<6;)r+=Os(this.consumeCodePoint());$v(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||Bee(n)||n>1114111?zk:n}return e===ac?zk:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(Wk(r))e+=Os(r);else if(mu(r,this.peekCodePoint(0)))e+=Os(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),xO=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new gO;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||ete(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?nE:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Dx=function(t){return t.type===15},im=function(t){return t.type===17},jn=function(t){return t.type===20},Zee=function(t){return t.type===0},sE=function(t,e){return jn(t)&&t.value===e},vO=function(t){return t.type!==31},Q0=function(t){return t.type!==31&&t.type!==4},Bc=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},ete=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},sd=function(t){return t.type===17||t.type===15},Ys=function(t){return t.type===16||sd(t)},wO=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Ga={type:17,number:0,flags:Rx},KS={type:16,number:50,flags:Rx},Iu={type:16,number:100,flags:Rx},vp=function(t,e,r){var n=t[0],s=t[1];return[Gn(n,e),Gn(typeof s<"u"?s:n,r)]},Gn=function(t,e){if(t.type===16)return t.number/100*e;if(Dx(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},yO="deg",bO="grad",NO="rad",CO="turn",D2={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case yO:return Math.PI*e.number/180;case bO:return Math.PI/200*e.number;case NO:return e.number;case CO:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},_O=function(t){return t.type===15&&(t.unit===yO||t.unit===bO||t.unit===NO||t.unit===CO)},EO=function(t){var e=t.filter(jn).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Ga,Ga];case"to top":case"bottom":return ol(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Ga,Iu];case"to right":case"left":return ol(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Iu,Iu];case"to bottom":case"top":return ol(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Iu,Ga];case"to left":case"right":return ol(270)}return 0},ol=function(t){return Math.PI*t/180},$u={name:"color",parse:function(t,e){if(e.type===18){var r=tte[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),s=e.value.substring(1,2),a=e.value.substring(2,3);return Fu(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),s=e.value.substring(1,2),a=e.value.substring(2,3),o=e.value.substring(3,4);return Fu(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),s=e.value.substring(2,4),a=e.value.substring(4,6);return Fu(parseInt(n,16),parseInt(s,16),parseInt(a,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),s=e.value.substring(2,4),a=e.value.substring(4,6),o=e.value.substring(6,8);return Fu(parseInt(n,16),parseInt(s,16),parseInt(a,16),parseInt(o,16)/255)}}if(e.type===20){var l=fA[e.value.toUpperCase()];if(typeof l<"u")return l}return fA.TRANSPARENT}},zu=function(t){return(255&t)===0},ya=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,s=255&t>>24;return e<255?"rgba("+s+","+n+","+r+","+e/255+")":"rgb("+s+","+n+","+r+")"},Fu=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},Jk=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},Xk=function(t,e){var r=e.filter(Q0);if(r.length===3){var n=r.map(Jk),s=n[0],a=n[1],o=n[2];return Fu(s,a,o,1)}if(r.length===4){var l=r.map(Jk),s=l[0],a=l[1],o=l[2],c=l[3];return Fu(s,a,o,c)}return 0};function uN(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var Yk=function(t,e){var r=e.filter(Q0),n=r[0],s=r[1],a=r[2],o=r[3],l=(n.type===17?ol(n.number):D2.parse(t,n))/(Math.PI*2),c=Ys(s)?s.number/100:0,A=Ys(a)?a.number/100:0,u=typeof o<"u"&&Ys(o)?Gn(o,1):1;if(c===0)return Fu(A*255,A*255,A*255,1);var d=A<=.5?A*(c+1):A+c-A*c,f=A*2-d,h=uN(f,d,l+1/3),m=uN(f,d,l),p=uN(f,d,l-1/3);return Fu(h*255,m*255,p*255,u)},tte={hsl:Yk,hsla:Yk,rgb:Xk,rgba:Xk},Hp=function(t,e){return $u.parse(t,xO.create(e).parseComponentValue())},fA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},rte={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(jn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},nte={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},L2=function(t,e){var r=$u.parse(t,e[0]),n=e[1];return n&&Ys(n)?{color:r,stop:n}:{color:r,stop:null}},Zk=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=Ga),n.stop===null&&(n.stop=Iu);for(var s=[],a=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=Gn(l,e);c>a?s.push(c):s.push(a),a=c}else s.push(null)}for(var A=null,o=0;o<s.length;o++){var u=s[o];if(u===null)A===null&&(A=o);else if(A!==null){for(var d=o-A,f=s[A-1],h=(u-f)/(d+1),m=1;m<=d;m++)s[A+m-1]=h*m;A=null}}return t.map(function(p,x){var g=p.color;return{color:g,stop:Math.max(Math.min(1,s[x]/e),0)}})},ste=function(t,e,r){var n=e/2,s=r/2,a=Gn(t[0],e)-n,o=s-Gn(t[1],r);return(Math.atan2(o,a)+Math.PI*2)%(Math.PI*2)},ate=function(t,e,r){var n=typeof t=="number"?t:ste(t,e,r),s=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),a=e/2,o=r/2,l=s/2,c=Math.sin(n-Math.PI/2)*l,A=Math.cos(n-Math.PI/2)*l;return[s,a-A,a+A,o-c,o+c]},Il=function(t,e){return Math.sqrt(t*t+e*e)},eT=function(t,e,r,n,s){var a=[[0,0],[0,e],[t,0],[t,e]];return a.reduce(function(o,l){var c=l[0],A=l[1],u=Il(r-c,n-A);return(s?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:l,optimumDistance:u}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},ite=function(t,e,r,n,s){var a=0,o=0;switch(t.size){case 0:t.shape===0?a=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(a=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(t.shape===0)a=o=Math.min(Il(e,r),Il(e,r-s),Il(e-n,r),Il(e-n,r-s));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(e),Math.abs(e-n)),c=eT(n,s,e,r,!0),A=c[0],u=c[1];a=Il(A-e,(u-r)/l),o=l*a}break;case 1:t.shape===0?a=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(a=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(t.shape===0)a=o=Math.max(Il(e,r),Il(e,r-s),Il(e-n,r),Il(e-n,r-s));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(e),Math.abs(e-n)),d=eT(n,s,e,r,!1),A=d[0],u=d[1];a=Il(A-e,(u-r)/l),o=l*a}break}return Array.isArray(t.size)&&(a=Gn(t.size[0],n),o=t.size.length===2?Gn(t.size[1],s):a),[a,o]},ote=function(t,e){var r=ol(180),n=[];return Bc(e).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&o.value==="to"){r=EO(s);return}else if(_O(o)){r=D2.parse(t,o);return}}var l=L2(t,s);n.push(l)}),{angle:r,stops:n,type:1}},Jv=function(t,e){var r=ol(180),n=[];return Bc(e).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=EO(s);return}else if(_O(o)){r=(D2.parse(t,o)+ol(270))%ol(360);return}}var l=L2(t,s);n.push(l)}),{angle:r,stops:n,type:1}},lte=function(t,e){var r=ol(180),n=[],s=1,a=0,o=3,l=[];return Bc(e).forEach(function(c,A){var u=c[0];if(A===0){if(jn(u)&&u.value==="linear"){s=1;return}else if(jn(u)&&u.value==="radial"){s=2;return}}if(u.type===18){if(u.name==="from"){var d=$u.parse(t,u.values[0]);n.push({stop:Ga,color:d})}else if(u.name==="to"){var d=$u.parse(t,u.values[0]);n.push({stop:Iu,color:d})}else if(u.name==="color-stop"){var f=u.values.filter(Q0);if(f.length===2){var d=$u.parse(t,f[1]),h=f[0];im(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:d})}}}}),s===1?{angle:(r+ol(180))%ol(360),stops:n,type:s}:{size:o,shape:a,stops:n,position:l,type:s}},BO="closest-side",SO="farthest-side",IO="closest-corner",FO="farthest-corner",kO="circle",TO="ellipse",jO="cover",PO="contain",cte=function(t,e){var r=0,n=3,s=[],a=[];return Bc(e).forEach(function(o,l){var c=!0;if(l===0){var A=!1;c=o.reduce(function(d,f){if(A)if(jn(f))switch(f.value){case"center":return a.push(KS),d;case"top":case"left":return a.push(Ga),d;case"right":case"bottom":return a.push(Iu),d}else(Ys(f)||sd(f))&&a.push(f);else if(jn(f))switch(f.value){case kO:return r=0,!1;case TO:return r=1,!1;case"at":return A=!0,!1;case BO:return n=0,!1;case jO:case SO:return n=1,!1;case PO:case IO:return n=2,!1;case FO:return n=3,!1}else if(sd(f)||Ys(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)}if(c){var u=L2(t,o);s.push(u)}}),{size:n,shape:r,stops:s,position:a,type:2}},Xv=function(t,e){var r=0,n=3,s=[],a=[];return Bc(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(u,d){if(jn(d))switch(d.value){case"center":return a.push(KS),!1;case"top":case"left":return a.push(Ga),!1;case"right":case"bottom":return a.push(Iu),!1}else if(Ys(d)||sd(d))return a.push(d),!1;return u},c):l===1&&(c=o.reduce(function(u,d){if(jn(d))switch(d.value){case kO:return r=0,!1;case TO:return r=1,!1;case PO:case BO:return n=0,!1;case SO:return n=1,!1;case IO:return n=2,!1;case jO:case FO:return n=3,!1}else if(sd(d)||Ys(d))return Array.isArray(n)||(n=[]),n.push(d),!1;return u},c)),c){var A=L2(t,o);s.push(A)}}),{size:n,shape:r,stops:s,position:a,type:2}},Ate=function(t){return t.type===1},ute=function(t){return t.type===2},qS={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=RO[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function dte(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!RO[t.name])}var RO={"linear-gradient":ote,"-moz-linear-gradient":Jv,"-ms-linear-gradient":Jv,"-o-linear-gradient":Jv,"-webkit-linear-gradient":Jv,"radial-gradient":cte,"-moz-radial-gradient":Xv,"-ms-radial-gradient":Xv,"-o-radial-gradient":Xv,"-webkit-radial-gradient":Xv,"-webkit-gradient":lte},hte={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Q0(n)&&dte(n)}).map(function(n){return qS.parse(t,n)})}},fte={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(jn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},mte={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Bc(e).map(function(r){return r.filter(Ys)}).map(wO)}},pte={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Bc(e).map(function(r){return r.filter(jn).map(function(n){return n.value}).join(" ")}).map(gte)}},gte=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},x0;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(x0||(x0={}));var xte={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Bc(e).map(function(r){return r.filter(vte)})}},vte=function(t){return jn(t)||Ys(t)},U2=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},wte=U2("top"),yte=U2("right"),bte=U2("bottom"),Nte=U2("left"),O2=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return wO(r.filter(Ys))}}},Cte=O2("top-left"),_te=O2("top-right"),Ete=O2("bottom-right"),Bte=O2("bottom-left"),M2=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Ste=M2("top"),Ite=M2("right"),Fte=M2("bottom"),kte=M2("left"),Q2=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Dx(r)?r.number:0}}},Tte=Q2("top"),jte=Q2("right"),Pte=Q2("bottom"),Rte=Q2("left"),Dte={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Lte={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Ute={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(jn).reduce(function(r,n){return r|Ote(n.value)},0)}},Ote=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Mte={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Qte={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},dy;(function(t){t.NORMAL="normal",t.STRICT="strict"})(dy||(dy={}));var Vte={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return dy.STRICT;case"normal":default:return dy.NORMAL}}},Hte={name:"line-height",initialValue:"normal",prefix:!1,type:4},tT=function(t,e){return jn(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:Ys(t)?Gn(t,e):e},Kte={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:qS.parse(t,e)}},qte={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},aE={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},V2=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},Gte=V2("top"),$te=V2("right"),zte=V2("bottom"),Wte=V2("left"),Jte={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(jn).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Xte={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},H2=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Yte=H2("top"),Zte=H2("right"),ere=H2("bottom"),tre=H2("left"),rre={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},nre={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},sre={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&sE(e[0],"none")?[]:Bc(e).map(function(r){for(var n={color:fA.TRANSPARENT,offsetX:Ga,offsetY:Ga,blur:Ga},s=0,a=0;a<r.length;a++){var o=r[a];sd(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:n.blur=o,s++):n.color=$u.parse(t,o)}return n})}},are={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},ire={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=cre[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},ore=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},lre=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var s=e[4],a=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,s,a,o,l]:null},cre={matrix:ore,matrix3d:lre},rT={type:16,number:50,flags:Rx},Are=[rT,rT],ure={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(Ys);return r.length!==2?Are:[r[0],r[1]]}},dre={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Kp;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Kp||(Kp={}));var hre={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Kp.BREAK_ALL;case"keep-all":return Kp.KEEP_ALL;case"normal":default:return Kp.NORMAL}}},fre={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(im(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},DO={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},mre={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return im(e)?e.number:1}},pre={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},gre={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(jn).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},xre={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},vre={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},wre={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(im(e))return e.number;if(jn(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},yre={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(jn).map(function(r){return r.value})}},bre={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Aa=function(t,e){return(t&e)!==0},Nre={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},Cre={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],s=e.filter(vO),a=0;a<s.length;a++){var o=s[a],l=s[a+1];if(o.type===20){var c=l&&im(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},_re={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(vO),s=0;s<n.length;s++){var a=n[s],o=n[s+1];if(jn(a)&&a.value!=="none"){var l=o&&im(o)?o.number:0;r.push({counter:a.value,reset:l})}}return r}},Ere={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Dx).map(function(r){return DO.parse(t,r)})}},Bre={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],s=e.filter(Zee);if(s.length%2!==0)return null;for(var a=0;a<s.length;a+=2){var o=s[a].value,l=s[a+1].value;n.push({open:o,close:l})}return n}},nT=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},Sre={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&sE(e[0],"none")?[]:Bc(e).map(function(r){for(var n={color:255,offsetX:Ga,offsetY:Ga,blur:Ga,spread:Ga,inset:!1},s=0,a=0;a<r.length;a++){var o=r[a];sE(o,"inset")?n.inset=!0:sd(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:s===2?n.blur=o:n.spread=o,s++):n.color=$u.parse(t,o)}return n})}},Ire={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(jn).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},Fre={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},kre={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Dx(e)?e.number:0}},Tre=function(){function t(e,r){var n,s;this.animationDuration=tr(e,Ere,r.animationDuration),this.backgroundClip=tr(e,rte,r.backgroundClip),this.backgroundColor=tr(e,nte,r.backgroundColor),this.backgroundImage=tr(e,hte,r.backgroundImage),this.backgroundOrigin=tr(e,fte,r.backgroundOrigin),this.backgroundPosition=tr(e,mte,r.backgroundPosition),this.backgroundRepeat=tr(e,pte,r.backgroundRepeat),this.backgroundSize=tr(e,xte,r.backgroundSize),this.borderTopColor=tr(e,wte,r.borderTopColor),this.borderRightColor=tr(e,yte,r.borderRightColor),this.borderBottomColor=tr(e,bte,r.borderBottomColor),this.borderLeftColor=tr(e,Nte,r.borderLeftColor),this.borderTopLeftRadius=tr(e,Cte,r.borderTopLeftRadius),this.borderTopRightRadius=tr(e,_te,r.borderTopRightRadius),this.borderBottomRightRadius=tr(e,Ete,r.borderBottomRightRadius),this.borderBottomLeftRadius=tr(e,Bte,r.borderBottomLeftRadius),this.borderTopStyle=tr(e,Ste,r.borderTopStyle),this.borderRightStyle=tr(e,Ite,r.borderRightStyle),this.borderBottomStyle=tr(e,Fte,r.borderBottomStyle),this.borderLeftStyle=tr(e,kte,r.borderLeftStyle),this.borderTopWidth=tr(e,Tte,r.borderTopWidth),this.borderRightWidth=tr(e,jte,r.borderRightWidth),this.borderBottomWidth=tr(e,Pte,r.borderBottomWidth),this.borderLeftWidth=tr(e,Rte,r.borderLeftWidth),this.boxShadow=tr(e,Sre,r.boxShadow),this.color=tr(e,Dte,r.color),this.direction=tr(e,Lte,r.direction),this.display=tr(e,Ute,r.display),this.float=tr(e,Mte,r.cssFloat),this.fontFamily=tr(e,xre,r.fontFamily),this.fontSize=tr(e,vre,r.fontSize),this.fontStyle=tr(e,bre,r.fontStyle),this.fontVariant=tr(e,yre,r.fontVariant),this.fontWeight=tr(e,wre,r.fontWeight),this.letterSpacing=tr(e,Qte,r.letterSpacing),this.lineBreak=tr(e,Vte,r.lineBreak),this.lineHeight=tr(e,Hte,r.lineHeight),this.listStyleImage=tr(e,Kte,r.listStyleImage),this.listStylePosition=tr(e,qte,r.listStylePosition),this.listStyleType=tr(e,aE,r.listStyleType),this.marginTop=tr(e,Gte,r.marginTop),this.marginRight=tr(e,$te,r.marginRight),this.marginBottom=tr(e,zte,r.marginBottom),this.marginLeft=tr(e,Wte,r.marginLeft),this.opacity=tr(e,mre,r.opacity);var a=tr(e,Jte,r.overflow);this.overflowX=a[0],this.overflowY=a[a.length>1?1:0],this.overflowWrap=tr(e,Xte,r.overflowWrap),this.paddingTop=tr(e,Yte,r.paddingTop),this.paddingRight=tr(e,Zte,r.paddingRight),this.paddingBottom=tr(e,ere,r.paddingBottom),this.paddingLeft=tr(e,tre,r.paddingLeft),this.paintOrder=tr(e,Ire,r.paintOrder),this.position=tr(e,nre,r.position),this.textAlign=tr(e,rre,r.textAlign),this.textDecorationColor=tr(e,pre,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=tr(e,gre,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=tr(e,sre,r.textShadow),this.textTransform=tr(e,are,r.textTransform),this.transform=tr(e,ire,r.transform),this.transformOrigin=tr(e,ure,r.transformOrigin),this.visibility=tr(e,dre,r.visibility),this.webkitTextStrokeColor=tr(e,Fre,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=tr(e,kre,r.webkitTextStrokeWidth),this.wordBreak=tr(e,hre,r.wordBreak),this.zIndex=tr(e,fre,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return zu(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return Aa(this.display,4)||Aa(this.display,33554432)||Aa(this.display,268435456)||Aa(this.display,536870912)||Aa(this.display,67108864)||Aa(this.display,134217728)},t}(),jre=function(){function t(e,r){this.content=tr(e,Nre,r.content),this.quotes=tr(e,Bre,r.quotes)}return t}(),sT=function(){function t(e,r){this.counterIncrement=tr(e,Cre,r.counterIncrement),this.counterReset=tr(e,_re,r.counterReset)}return t}(),tr=function(t,e,r){var n=new gO,s=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(s);var a=new xO(n.read());switch(e.type){case 2:var o=a.parseComponentValue();return e.parse(t,jn(o)?o.value:e.initialValue);case 0:return e.parse(t,a.parseComponentValue());case 1:return e.parse(t,a.parseComponentValues());case 4:return a.parseComponentValue();case 3:switch(e.format){case"angle":return D2.parse(t,a.parseComponentValue());case"color":return $u.parse(t,a.parseComponentValue());case"image":return qS.parse(t,a.parseComponentValue());case"length":var l=a.parseComponentValue();return sd(l)?l:Ga;case"length-percentage":var c=a.parseComponentValue();return Ys(c)?c:Ga;case"time":return DO.parse(t,a.parseComponentValue())}break}},Pre="data-html2canvas-debug",Rre=function(t){var e=t.getAttribute(Pre);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},iE=function(t,e){var r=Rre(t);return r===1||e===r},Sc=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,iE(r,3))debugger;this.styles=new Tre(e,window.getComputedStyle(r,null)),cE(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=P2(this.context,r),iE(r,4)&&(this.flags|=16)}return t}(),Dre="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",aT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wp=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Yv=0;Yv<aT.length;Yv++)wp[aT.charCodeAt(Yv)]=Yv;var Lre=function(t){var e=t.length*.75,r=t.length,n,s=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=wp[t.charCodeAt(n)],o=wp[t.charCodeAt(n+1)],l=wp[t.charCodeAt(n+2)],c=wp[t.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},Ure=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},Ore=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},oh=5,GS=11,dN=2,Mre=GS-oh,LO=65536>>oh,Qre=1<<oh,hN=Qre-1,Vre=1024>>oh,Hre=LO+Vre,Kre=Hre,qre=32,Gre=Kre+qre,$re=65536>>GS,zre=1<<Mre,Wre=zre-1,iT=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Jre=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},Xre=function(t,e){var r=Lre(t),n=Array.isArray(r)?Ore(r):new Uint32Array(r),s=Array.isArray(r)?Ure(r):new Uint16Array(r),a=24,o=iT(s,a/2,n[4]/2),l=n[5]===2?iT(s,(a+n[4])/2):Jre(n,Math.ceil((a+n[4])/4));return new Yre(n[0],n[1],n[2],n[3],o,l)},Yre=function(){function t(e,r,n,s,a,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>oh],r=(r<<dN)+(e&hN),this.data[r];if(e<=65535)return r=this.index[LO+(e-55296>>oh)],r=(r<<dN)+(e&hN),this.data[r];if(e<this.highStart)return r=Gre-$re+(e>>GS),r=this.index[r],r+=e>>oh&Wre,r=this.index[r],r=(r<<dN)+(e&hN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),oT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zre=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Zv=0;Zv<oT.length;Zv++)Zre[oT.charCodeAt(Zv)]=Zv;var ene=1,fN=2,mN=3,lT=4,cT=5,tne=7,AT=8,pN=9,gN=10,uT=11,dT=12,hT=13,fT=14,xN=15,rne=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=t.charCodeAt(r++);(a&64512)===56320?e.push(((s&1023)<<10)+(a&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},nne=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},sne=Xre(Dre),Zo="",vN="",ane=function(t){return sne.get(t)},ine=function(t,e,r){var n=r-2,s=e[n],a=e[r-1],o=e[r];if(a===fN&&o===mN)return Zo;if(a===fN||a===mN||a===lT||o===fN||o===mN||o===lT)return vN;if(a===AT&&[AT,pN,uT,dT].indexOf(o)!==-1||(a===uT||a===pN)&&(o===pN||o===gN)||(a===dT||a===gN)&&o===gN||o===hT||o===cT||o===tne||a===ene)return Zo;if(a===hT&&o===fT){for(;s===cT;)s=e[--n];if(s===fT)return Zo}if(a===xN&&o===xN){for(var l=0;s===xN;)l++,s=e[--n];if(l%2===0)return Zo}return vN},one=function(t){var e=rne(t),r=e.length,n=0,s=0,a=e.map(ane);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=Zo;n<r&&(o=ine(e,a,++n))===Zo;);if(o!==Zo||n===r){var l=nne.apply(null,e.slice(s,n));return s=n,{value:l,done:!1}}return{done:!0,value:null}}}},lne=function(t){for(var e=one(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},cne=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),a=Math.round(s.height);if(t.body.removeChild(n),a===e)return!0}}return!1},Ane=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,s=R2(n.data).map(function(c){return Os(c)}),a=0,o={},l=s.every(function(c,A){r.setStart(n,a),r.setEnd(n,a+c.length);var u=r.getBoundingClientRect();a+=c.length;var d=u.x>o.x||u.y>o.y;return o=u,A===0?!0:d});return t.body.removeChild(e),l},une=function(){return typeof new Image().crossOrigin<"u"},dne=function(){return typeof new XMLHttpRequest().responseType=="string"},hne=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},mT=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},fne=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,a=e.toDataURL();s.src=a;var o=oE(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),pT(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var A=t.createElement("div");return A.style.backgroundImage="url("+a+")",A.style.height=r+"px",mT(c)?pT(oE(r,r,0,0,A)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),mT(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},oE=function(t,e,r,n,s){var a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"svg"),l=document.createElementNS(a,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},pT=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Oa={get SUPPORT_RANGE_BOUNDS(){var t=cne(document);return Object.defineProperty(Oa,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Oa.SUPPORT_RANGE_BOUNDS&&Ane(document);return Object.defineProperty(Oa,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=hne(document);return Object.defineProperty(Oa,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?fne(document):Promise.resolve(!1);return Object.defineProperty(Oa,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=une();return Object.defineProperty(Oa,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=dne();return Object.defineProperty(Oa,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Oa,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Oa,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},qp=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),mne=function(t,e,r,n){var s=xne(e,r),a=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Oa.SUPPORT_RANGE_BOUNDS){var c=gT(n,o,l.length).getClientRects();if(c.length>1){var A=$S(l),u=0;A.forEach(function(f){a.push(new qp(f,BA.fromDOMRectList(t,gT(n,u+o,f.length).getClientRects()))),u+=f.length})}else a.push(new qp(l,BA.fromDOMRectList(t,c)))}else{var d=n.splitText(l.length);a.push(new qp(l,pne(t,n))),n=d}else Oa.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),a},pne=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var s=e.parentNode;if(s){s.replaceChild(n,e);var a=P2(t,n);return n.firstChild&&s.replaceChild(n.firstChild,n),a}}return BA.EMPTY},gT=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(t,e),s.setEnd(t,e+r),s},$S=function(t){if(Oa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return lne(t)},gne=function(t,e){if(Oa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return wne(t,e)},xne=function(t,e){return e.letterSpacing!==0?$S(t):gne(t,e)},vne=[32,160,4961,65792,65793,4153,4241],wne=function(t,e){for(var r=$Z(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],s,a=function(){if(s.value){var o=s.value.slice(),l=R2(o),c="";l.forEach(function(A){vne.indexOf(A)===-1?c+=Os(A):(c.length&&n.push(c),n.push(Os(A)),c="")}),c.length&&n.push(c)}};!(s=r.next()).done;)a();return n},yne=function(){function t(e,r,n){this.text=bne(r.data,n.textTransform),this.textBounds=mne(e,this.text,n,r)}return t}(),bne=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(Nne,Cne);case 2:return t.toUpperCase();default:return t}},Nne=/(^|\s|:|-|\(|\))([a-z])/g,Cne=function(t,e,r){return t.length>0?e+r.toUpperCase():t},UO=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return e}(Sc),OO=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return e}(Sc),MO=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this,a=new XMLSerializer,o=P2(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(a.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return e}(Sc),QO=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Sc),lE=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return e}(Sc),_ne=[{type:15,flags:0,unit:"px",number:3}],Ene=[{type:16,flags:0,number:50}],Bne=function(t){return t.width>t.height?new BA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new BA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},Sne=function(t){var e=t.type===Ine?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},hy="checkbox",fy="radio",Ine="password",xT=707406591,zS=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=Sne(n),(s.type===hy||s.type===fy)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=Bne(s.bounds)),s.type){case hy:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=_ne;break;case fy:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=Ene;break}return s}return e}(Sc),VO=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this,a=n.options[n.selectedIndex||0];return s.value=a&&a.text||"",s}return e}(Sc),HO=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Sc),KO=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=GO(r,n.contentWindow.document.documentElement);var a=n.contentWindow.document.documentElement?Hp(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):fA.TRANSPARENT,o=n.contentWindow.document.body?Hp(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):fA.TRANSPARENT;s.backgroundColor=zu(a)?zu(o)?s.styles.backgroundColor:o:a}}catch{}return s}return e}(Sc),Fne=["OL","UL","MENU"],fw=function(t,e,r,n){for(var s=e.firstChild,a=void 0;s;s=a)if(a=s.nextSibling,$O(s)&&s.data.trim().length>0)r.textNodes.push(new yne(t,s,r.styles));else if(i0(s))if(XO(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return fw(t,l,r,n)});else{var o=qO(t,s);o.styles.isVisible()&&(kne(s,o,n)?o.flags|=4:Tne(o.styles)&&(o.flags|=2),Fne.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?fw(t,s.shadowRoot,o,n):!my(s)&&!zO(s)&&!py(s)&&fw(t,s,o,n))}},qO=function(t,e){return AE(e)?new UO(t,e):WO(e)?new OO(t,e):zO(e)?new MO(t,e):jne(e)?new QO(t,e):Pne(e)?new lE(t,e):Rne(e)?new zS(t,e):py(e)?new VO(t,e):my(e)?new HO(t,e):JO(e)?new KO(t,e):new Sc(t,e)},GO=function(t,e){var r=qO(t,e);return r.flags|=4,fw(t,e,r,r),r},kne=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||WS(t)&&r.styles.isTransparent()},Tne=function(t){return t.isPositioned()||t.isFloating()},$O=function(t){return t.nodeType===Node.TEXT_NODE},i0=function(t){return t.nodeType===Node.ELEMENT_NODE},cE=function(t){return i0(t)&&typeof t.style<"u"&&!mw(t)},mw=function(t){return typeof t.className=="object"},jne=function(t){return t.tagName==="LI"},Pne=function(t){return t.tagName==="OL"},Rne=function(t){return t.tagName==="INPUT"},Dne=function(t){return t.tagName==="HTML"},zO=function(t){return t.tagName==="svg"},WS=function(t){return t.tagName==="BODY"},WO=function(t){return t.tagName==="CANVAS"},vT=function(t){return t.tagName==="VIDEO"},AE=function(t){return t.tagName==="IMG"},JO=function(t){return t.tagName==="IFRAME"},wT=function(t){return t.tagName==="STYLE"},Lne=function(t){return t.tagName==="SCRIPT"},my=function(t){return t.tagName==="TEXTAREA"},py=function(t){return t.tagName==="SELECT"},XO=function(t){return t.tagName==="SLOT"},yT=function(t){return t.tagName.indexOf("-")>0},Une=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,s=e.counterReset,a=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(a=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return a&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),bT={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},NT={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},One={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Mne={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Nf=function(t,e,r,n,s,a){return t<e||t>r?qg(t,s,a.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+a},YO=function(t,e,r,n){var s="";do r||t--,s=n(t)+s,t/=e;while(t*e>=e);return s},Ls=function(t,e,r,n,s){var a=r-e+1;return(t<0?"-":"")+(YO(Math.abs(t),a,n,function(o){return Os(Math.floor(o%a)+e)})+s)},Td=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return YO(Math.abs(t),n,!1,function(s){return e[Math.floor(s%n)]})+r},Vf=1,Au=2,uu=4,yp=8,qc=function(t,e,r,n,s,a){if(t<-9999||t>9999)return qg(t,4,s.length>0);var o=Math.abs(t),l=s;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var A=o%10;A===0&&Aa(a,Vf)&&l!==""?l=e[A]+l:A>1||A===1&&c===0||A===1&&c===1&&Aa(a,Au)||A===1&&c===1&&Aa(a,uu)&&t>100||A===1&&c>1&&Aa(a,yp)?l=e[A]+(c>0?r[c-1]:"")+l:A===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},CT="",_T="",ET="",wN="",qg=function(t,e,r){var n=r?". ":"",s=r?"":"",a=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Ls(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Td(t,"",s);case 6:return Nf(t,1,3999,bT,3,n).toLowerCase();case 7:return Nf(t,1,3999,bT,3,n);case 8:return Ls(t,945,969,!1,n);case 9:return Ls(t,97,122,!1,n);case 10:return Ls(t,65,90,!1,n);case 11:return Ls(t,1632,1641,!0,n);case 12:case 49:return Nf(t,1,9999,NT,3,n);case 35:return Nf(t,1,9999,NT,3,n).toLowerCase();case 13:return Ls(t,2534,2543,!0,n);case 14:case 30:return Ls(t,6112,6121,!0,n);case 15:return Td(t,"",s);case 16:return Td(t,"",s);case 17:case 48:return qc(t,"",CT,"",s,Au|uu|yp);case 47:return qc(t,"",_T,"",s,Vf|Au|uu|yp);case 42:return qc(t,"",CT,"",s,Au|uu|yp);case 41:return qc(t,"",_T,"",s,Vf|Au|uu|yp);case 26:return qc(t,"","",ET,s,0);case 25:return qc(t,"","",ET,s,Vf|Au|uu);case 31:return qc(t,"","",wN,a,Vf|Au|uu);case 33:return qc(t,"","",wN,a,0);case 32:return qc(t,"","",wN,a,Vf|Au|uu);case 18:return Ls(t,2406,2415,!0,n);case 20:return Nf(t,1,19999,Mne,3,n);case 21:return Ls(t,2790,2799,!0,n);case 22:return Ls(t,2662,2671,!0,n);case 22:return Nf(t,1,10999,One,3,n);case 23:return Td(t,"");case 24:return Td(t,"");case 27:return Ls(t,3302,3311,!0,n);case 28:return Td(t,"",s);case 29:return Td(t,"",s);case 34:return Ls(t,3792,3801,!0,n);case 37:return Ls(t,6160,6169,!0,n);case 38:return Ls(t,4160,4169,!0,n);case 39:return Ls(t,2918,2927,!0,n);case 40:return Ls(t,1776,1785,!0,n);case 43:return Ls(t,3046,3055,!0,n);case 44:return Ls(t,3174,3183,!0,n);case 45:return Ls(t,3664,3673,!0,n);case 46:return Ls(t,3872,3881,!0,n);case 3:default:return Ls(t,48,57,!0,n)}},ZO="data-html2canvas-ignore",BT=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new Une,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,s=Qne(e,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var a=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=s.contentWindow,c=l.document,A=Kne(s).then(function(){return Bi(n,void 0,void 0,function(){var u,d;return oi(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(zne),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),u=this.options.onclone,d=this.clonedReferenceElement,typeof d>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Hne(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,d)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(Gne(document.doctype)+"<html></html>"),$ne(this.referenceElement.ownerDocument,a,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),A},t.prototype.createElementClone=function(e){if(iE(e,2))debugger;if(WO(e))return this.createCanvasClone(e);if(vT(e))return this.createVideoClone(e);if(wT(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return AE(r)&&(AE(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),yT(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return yN(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(a,o){return o&&typeof o.cssText=="string"?a+o.cssText:a},""),s=e.cloneNode(!1);return s.textContent=n,s}}catch(a){if(this.context.logger.error("Unable to access cssRules property",a),a.name!=="SecurityError")throw a}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var s=e.cloneNode(!1);try{s.width=e.width,s.height=e.height;var a=e.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&a)o.putImageData(a.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return s},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var s=e.ownerDocument.createElement("canvas");return s.width=e.offsetWidth,s.height=e.offsetHeight,s},t.prototype.appendChildNode=function(e,r,n){(!i0(r)||!Lne(r)&&!r.hasAttribute(ZO)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!i0(r)||!wT(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var s=this,a=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;a;a=a.nextSibling)if(i0(a)&&XO(a)&&typeof a.assignedNodes=="function"){var o=a.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,n)})}else this.appendChildNode(r,a,n)},t.prototype.cloneNode=function(e,r){if($O(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&i0(e)&&(cE(e)||mw(e))){var s=this.createElementClone(e);s.style.transitionProperty="none";var a=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&cE(s)&&(this.clonedReferenceElement=s),WS(s)&&Xne(s);var c=this.counters.parse(new sT(this.context,a)),A=this.resolvePseudoContent(e,s,o,Gp.BEFORE);yT(e)&&(r=!0),vT(e)||this.cloneChildNodes(e,s,r),A&&s.insertBefore(A,s.firstChild);var u=this.resolvePseudoContent(e,s,l,Gp.AFTER);return u&&s.appendChild(u),this.counters.pop(c),(a&&(this.options.copyStyles||mw(e))&&!JO(e)||r)&&yN(a,s),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([s,e.scrollLeft,e.scrollTop]),(my(e)||py(e))&&(my(s)||py(s))&&(s.value=e.value),s}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,s){var a=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new sT(this.context,n));var c=new jre(this.context,n),A=l.createElement("html2canvaspseudoelement");yN(n,A),c.content.forEach(function(d){if(d.type===0)A.appendChild(l.createTextNode(d.value));else if(d.type===22){var f=l.createElement("img");f.src=d.value,f.style.opacity="1",A.appendChild(f)}else if(d.type===18){if(d.name==="attr"){var h=d.values.filter(jn);h.length&&A.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(d.name==="counter"){var m=d.values.filter(Q0),p=m[0],x=m[1];if(p&&jn(p)){var g=a.counters.getCounterValue(p.value),y=x&&jn(x)?aE.parse(a.context,x.value):3;A.appendChild(l.createTextNode(qg(g,y,!1)))}}else if(d.name==="counters"){var b=d.values.filter(Q0),p=b[0],F=b[1],x=b[2];if(p&&jn(p)){var P=a.counters.getCounterValues(p.value),R=x&&jn(x)?aE.parse(a.context,x.value):3,_=F&&F.type===0?F.value:"",B=P.map(function(k){return qg(k,R,!1)}).join(_);A.appendChild(l.createTextNode(B))}}}else if(d.type===20)switch(d.value){case"open-quote":A.appendChild(l.createTextNode(nT(c.quotes,a.quoteDepth++,!0)));break;case"close-quote":A.appendChild(l.createTextNode(nT(c.quotes,--a.quoteDepth,!1)));break;default:A.appendChild(l.createTextNode(d.value))}}),A.className=uE+" "+dE;var u=s===Gp.BEFORE?" "+uE:" "+dE;return mw(r)?r.className.baseValue+=u:r.className+=u,A}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),Gp;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Gp||(Gp={}));var Qne=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(ZO,"true"),t.body.appendChild(r),r},Vne=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},Hne=function(t){return Promise.all([].slice.call(t.images,0).map(Vne))},Kne=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var a=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(a),e(t))},50)}})},qne=["all","d","content"],yN=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);qne.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},Gne=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},$ne=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},zne=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},Wne=":before",Jne=":after",uE="___html2canvas___pseudoelement_before",dE="___html2canvas___pseudoelement_after",ST=`{
    content: "" !important;
    display: none !important;
}`,Xne=function(t){Yne(t,"."+uE+Wne+ST+`
         .`+dE+Jne+ST)},Yne=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},eM=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),Zne=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(NN(e)||nse(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return Bi(this,void 0,void 0,function(){var r,n,s,a,o=this;return oi(this,function(l){switch(l.label){case 0:return r=eM.isSameOrigin(e),n=!bN(e)&&this._options.useCORS===!0&&Oa.SUPPORT_CORS_IMAGES&&!r,s=!bN(e)&&!r&&!NN(e)&&typeof this._options.proxy=="string"&&Oa.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!bN(e)&&!NN(e)&&!s&&!n?[2]:(a=e,s?[4,this.proxy(a)]:[3,2]);case 1:a=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,A){var u=new Image;u.onload=function(){return c(u)},u.onerror=A,(sse(a)||n)&&(u.crossOrigin="anonymous"),u.src=a,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return A("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=e.substring(0,256);return new Promise(function(a,o){var l=Oa.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")a(c.response);else{var d=new FileReader;d.addEventListener("load",function(){return a(d.result)},!1),d.addEventListener("error",function(f){return o(f)},!1),d.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var A=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+A+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var u=r._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+s)}}c.send()})},t}(),ese=/^data:image\/svg\+xml/i,tse=/^data:image\/.*;base64,/i,rse=/^data:image\/.*/i,nse=function(t){return Oa.SUPPORT_SVG_DRAWING||!ase(t)},bN=function(t){return rse.test(t)},sse=function(t){return tse.test(t)},NN=function(t){return t.substr(0,4)==="blob"},ase=function(t){return t.substr(-3).toLowerCase()==="svg"||ese.test(t)},Zt=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),Cf=function(t,e,r){return new Zt(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},e1=function(){function t(e,r,n,s){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=s}return t.prototype.subdivide=function(e,r){var n=Cf(this.start,this.startControl,e),s=Cf(this.startControl,this.endControl,e),a=Cf(this.endControl,this.end,e),o=Cf(n,s,e),l=Cf(s,a,e),c=Cf(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,a,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),sl=function(t){return t.type===1},ise=function(){function t(e){var r=e.styles,n=e.bounds,s=vp(r.borderTopLeftRadius,n.width,n.height),a=s[0],o=s[1],l=vp(r.borderTopRightRadius,n.width,n.height),c=l[0],A=l[1],u=vp(r.borderBottomRightRadius,n.width,n.height),d=u[0],f=u[1],h=vp(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((a+c)/n.width),x.push((m+d)/n.width),x.push((o+p)/n.height),x.push((A+f)/n.height);var g=Math.max.apply(Math,x);g>1&&(a/=g,o/=g,c/=g,A/=g,d/=g,f/=g,m/=g,p/=g);var y=n.width-c,b=n.height-f,F=n.width-d,P=n.height-p,R=r.borderTopWidth,_=r.borderRightWidth,B=r.borderBottomWidth,E=r.borderLeftWidth,M=Gn(r.paddingTop,e.bounds.width),k=Gn(r.paddingRight,e.bounds.width),T=Gn(r.paddingBottom,e.bounds.width),U=Gn(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=a>0||o>0?rs(n.left+E/3,n.top+R/3,a-E/3,o-R/3,xn.TOP_LEFT):new Zt(n.left+E/3,n.top+R/3),this.topRightBorderDoubleOuterBox=a>0||o>0?rs(n.left+y,n.top+R/3,c-_/3,A-R/3,xn.TOP_RIGHT):new Zt(n.left+n.width-_/3,n.top+R/3),this.bottomRightBorderDoubleOuterBox=d>0||f>0?rs(n.left+F,n.top+b,d-_/3,f-B/3,xn.BOTTOM_RIGHT):new Zt(n.left+n.width-_/3,n.top+n.height-B/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?rs(n.left+E/3,n.top+P,m-E/3,p-B/3,xn.BOTTOM_LEFT):new Zt(n.left+E/3,n.top+n.height-B/3),this.topLeftBorderDoubleInnerBox=a>0||o>0?rs(n.left+E*2/3,n.top+R*2/3,a-E*2/3,o-R*2/3,xn.TOP_LEFT):new Zt(n.left+E*2/3,n.top+R*2/3),this.topRightBorderDoubleInnerBox=a>0||o>0?rs(n.left+y,n.top+R*2/3,c-_*2/3,A-R*2/3,xn.TOP_RIGHT):new Zt(n.left+n.width-_*2/3,n.top+R*2/3),this.bottomRightBorderDoubleInnerBox=d>0||f>0?rs(n.left+F,n.top+b,d-_*2/3,f-B*2/3,xn.BOTTOM_RIGHT):new Zt(n.left+n.width-_*2/3,n.top+n.height-B*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?rs(n.left+E*2/3,n.top+P,m-E*2/3,p-B*2/3,xn.BOTTOM_LEFT):new Zt(n.left+E*2/3,n.top+n.height-B*2/3),this.topLeftBorderStroke=a>0||o>0?rs(n.left+E/2,n.top+R/2,a-E/2,o-R/2,xn.TOP_LEFT):new Zt(n.left+E/2,n.top+R/2),this.topRightBorderStroke=a>0||o>0?rs(n.left+y,n.top+R/2,c-_/2,A-R/2,xn.TOP_RIGHT):new Zt(n.left+n.width-_/2,n.top+R/2),this.bottomRightBorderStroke=d>0||f>0?rs(n.left+F,n.top+b,d-_/2,f-B/2,xn.BOTTOM_RIGHT):new Zt(n.left+n.width-_/2,n.top+n.height-B/2),this.bottomLeftBorderStroke=m>0||p>0?rs(n.left+E/2,n.top+P,m-E/2,p-B/2,xn.BOTTOM_LEFT):new Zt(n.left+E/2,n.top+n.height-B/2),this.topLeftBorderBox=a>0||o>0?rs(n.left,n.top,a,o,xn.TOP_LEFT):new Zt(n.left,n.top),this.topRightBorderBox=c>0||A>0?rs(n.left+y,n.top,c,A,xn.TOP_RIGHT):new Zt(n.left+n.width,n.top),this.bottomRightBorderBox=d>0||f>0?rs(n.left+F,n.top+b,d,f,xn.BOTTOM_RIGHT):new Zt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?rs(n.left,n.top+P,m,p,xn.BOTTOM_LEFT):new Zt(n.left,n.top+n.height),this.topLeftPaddingBox=a>0||o>0?rs(n.left+E,n.top+R,Math.max(0,a-E),Math.max(0,o-R),xn.TOP_LEFT):new Zt(n.left+E,n.top+R),this.topRightPaddingBox=c>0||A>0?rs(n.left+Math.min(y,n.width-_),n.top+R,y>n.width+_?0:Math.max(0,c-_),Math.max(0,A-R),xn.TOP_RIGHT):new Zt(n.left+n.width-_,n.top+R),this.bottomRightPaddingBox=d>0||f>0?rs(n.left+Math.min(F,n.width-E),n.top+Math.min(b,n.height-B),Math.max(0,d-_),Math.max(0,f-B),xn.BOTTOM_RIGHT):new Zt(n.left+n.width-_,n.top+n.height-B),this.bottomLeftPaddingBox=m>0||p>0?rs(n.left+E,n.top+Math.min(P,n.height-B),Math.max(0,m-E),Math.max(0,p-B),xn.BOTTOM_LEFT):new Zt(n.left+E,n.top+n.height-B),this.topLeftContentBox=a>0||o>0?rs(n.left+E+U,n.top+R+M,Math.max(0,a-(E+U)),Math.max(0,o-(R+M)),xn.TOP_LEFT):new Zt(n.left+E+U,n.top+R+M),this.topRightContentBox=c>0||A>0?rs(n.left+Math.min(y,n.width+E+U),n.top+R+M,y>n.width+E+U?0:c-E+U,A-(R+M),xn.TOP_RIGHT):new Zt(n.left+n.width-(_+k),n.top+R+M),this.bottomRightContentBox=d>0||f>0?rs(n.left+Math.min(F,n.width-(E+U)),n.top+Math.min(b,n.height+R+M),Math.max(0,d-(_+k)),f-(B+T),xn.BOTTOM_RIGHT):new Zt(n.left+n.width-(_+k),n.top+n.height-(B+T)),this.bottomLeftContentBox=m>0||p>0?rs(n.left+E+U,n.top+P,Math.max(0,m-(E+U)),p-(B+T),xn.BOTTOM_LEFT):new Zt(n.left+E+U,n.top+n.height-(B+T))}return t}(),xn;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(xn||(xn={}));var rs=function(t,e,r,n,s){var a=4*((Math.sqrt(2)-1)/3),o=r*a,l=n*a,c=t+r,A=e+n;switch(s){case xn.TOP_LEFT:return new e1(new Zt(t,A),new Zt(t,A-l),new Zt(c-o,e),new Zt(c,e));case xn.TOP_RIGHT:return new e1(new Zt(t,e),new Zt(t+o,e),new Zt(c,A-l),new Zt(c,A));case xn.BOTTOM_RIGHT:return new e1(new Zt(c,e),new Zt(c,e+l),new Zt(t+o,A),new Zt(t,A));case xn.BOTTOM_LEFT:default:return new e1(new Zt(c,A),new Zt(c-o,A),new Zt(t,e+l),new Zt(t,e))}},gy=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},ose=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},xy=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},lse=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),t1=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),cse=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),Ase=function(t){return t.type===0},tM=function(t){return t.type===1},use=function(t){return t.type===2},IT=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},dse=function(t,e,r,n,s){return t.map(function(a,o){switch(o){case 0:return a.add(e,r);case 1:return a.add(e+n,r);case 2:return a.add(e+n,r+s);case 3:return a.add(e,r+s)}return a})},rM=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),nM=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new ise(this.container),this.container.styles.opacity<1&&this.effects.push(new cse(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,a=this.container.styles.transform;this.effects.push(new lse(n,s,a))}if(this.container.styles.overflowX!==0){var o=gy(this.curves),l=xy(this.curves);IT(o,l)?this.effects.push(new t1(o,6)):(this.effects.push(new t1(o,2)),this.effects.push(new t1(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var a=n.effects.filter(function(c){return!tM(c)});if(r||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,a),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=gy(n.curves),l=xy(n.curves);IT(o,l)||s.unshift(new t1(l,6))}}else s.unshift.apply(s,a);n=n.parent}return s.filter(function(c){return Aa(c.target,e)})},t}(),hE=function(t,e,r,n){t.container.elements.forEach(function(s){var a=Aa(s.flags,4),o=Aa(s.flags,2),l=new nM(s,t);Aa(s.styles.display,2048)&&n.push(l);var c=Aa(s.flags,8)?[]:n;if(a||o){var A=a||s.styles.isPositioned()?r:e,u=new rM(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var d=s.styles.zIndex.order;if(d<0){var f=0;A.negativeZIndex.some(function(m,p){return d>m.element.container.styles.zIndex.order?(f=p,!1):f>0}),A.negativeZIndex.splice(f,0,u)}else if(d>0){var h=0;A.positiveZIndex.some(function(m,p){return d>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),A.positiveZIndex.splice(h,0,u)}else A.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else s.styles.isFloating()?A.nonPositionedFloats.push(u):A.nonPositionedInlineLevel.push(u);hE(l,u,a?u:r,c)}else s.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),hE(l,e,r,c);Aa(s.flags,8)&&sM(s,c)})},sM=function(t,e){for(var r=t instanceof lE?t.start:1,n=t instanceof lE?t.reversed:!1,s=0;s<e.length;s++){var a=e[s];a.container instanceof QO&&typeof a.container.value=="number"&&a.container.value!==0&&(r=a.container.value),a.listValue=qg(r,a.container.styles.listStyleType,!0),r+=n?-1:1}},hse=function(t){var e=new nM(t,null),r=new rM(e),n=[];return hE(e,r,r,n),sM(e.container,n),r},FT=function(t,e){switch(e){case 0:return ll(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return ll(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return ll(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return ll(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},fse=function(t,e){switch(e){case 0:return ll(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return ll(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return ll(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return ll(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},mse=function(t,e){switch(e){case 0:return ll(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return ll(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return ll(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return ll(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},pse=function(t,e){switch(e){case 0:return r1(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return r1(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return r1(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return r1(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},r1=function(t,e){var r=[];return sl(t)?r.push(t.subdivide(.5,!1)):r.push(t),sl(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},ll=function(t,e,r,n){var s=[];return sl(t)?s.push(t.subdivide(.5,!1)):s.push(t),sl(r)?s.push(r.subdivide(.5,!0)):s.push(r),sl(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),sl(e)?s.push(e.subdivide(.5,!1).reverse()):s.push(e),s},aM=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},vy=function(t){var e=t.styles,r=t.bounds,n=Gn(e.paddingLeft,r.width),s=Gn(e.paddingRight,r.width),a=Gn(e.paddingTop,r.width),o=Gn(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,a+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+s),-(e.borderTopWidth+e.borderBottomWidth+a+o))},gse=function(t,e){return t===0?e.bounds:t===2?vy(e):aM(e)},xse=function(t,e){return t===0?e.bounds:t===2?vy(e):aM(e)},CN=function(t,e,r){var n=gse(Hf(t.styles.backgroundOrigin,e),t),s=xse(Hf(t.styles.backgroundClip,e),t),a=vse(Hf(t.styles.backgroundSize,e),r,n),o=a[0],l=a[1],c=vp(Hf(t.styles.backgroundPosition,e),n.width-o,n.height-l),A=wse(Hf(t.styles.backgroundRepeat,e),c,a,n,s),u=Math.round(n.left+c[0]),d=Math.round(n.top+c[1]);return[A,u,d,o,l]},_f=function(t){return jn(t)&&t.value===x0.AUTO},n1=function(t){return typeof t=="number"},vse=function(t,e,r){var n=e[0],s=e[1],a=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(Ys(o)&&l&&Ys(l))return[Gn(o,r.width),Gn(l,r.height)];var c=n1(a);if(jn(o)&&(o.value===x0.CONTAIN||o.value===x0.COVER)){if(n1(a)){var A=r.width/r.height;return A<a!=(o.value===x0.COVER)?[r.width,r.width/a]:[r.height*a,r.height]}return[r.width,r.height]}var u=n1(n),d=n1(s),f=u||d;if(_f(o)&&(!l||_f(l))){if(u&&d)return[n,s];if(!c&&!f)return[r.width,r.height];if(f&&c){var h=u?n:s*a,m=d?s:n/a;return[h,m]}var p=u?n:r.width,x=d?s:r.height;return[p,x]}if(c){var g=0,y=0;return Ys(o)?g=Gn(o,r.width):Ys(l)&&(y=Gn(l,r.height)),_f(o)?g=y*a:(!l||_f(l))&&(y=g/a),[g,y]}var b=null,F=null;if(Ys(o)?b=Gn(o,r.width):l&&Ys(l)&&(F=Gn(l,r.height)),b!==null&&(!l||_f(l))&&(F=u&&d?b/n*s:r.height),F!==null&&_f(o)&&(b=u&&d?F/s*n:r.width),b!==null&&F!==null)return[b,F];throw new Error("Unable to calculate background-size for element")},Hf=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},wse=function(t,e,r,n,s){var a=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new Zt(Math.round(n.left),Math.round(n.top+o)),new Zt(Math.round(n.left+n.width),Math.round(n.top+o)),new Zt(Math.round(n.left+n.width),Math.round(c+n.top+o)),new Zt(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new Zt(Math.round(n.left+a),Math.round(n.top)),new Zt(Math.round(n.left+a+l),Math.round(n.top)),new Zt(Math.round(n.left+a+l),Math.round(n.height+n.top)),new Zt(Math.round(n.left+a),Math.round(n.height+n.top))];case 1:return[new Zt(Math.round(n.left+a),Math.round(n.top+o)),new Zt(Math.round(n.left+a+l),Math.round(n.top+o)),new Zt(Math.round(n.left+a+l),Math.round(n.top+o+c)),new Zt(Math.round(n.left+a),Math.round(n.top+o+c))];default:return[new Zt(Math.round(s.left),Math.round(s.top)),new Zt(Math.round(s.left+s.width),Math.round(s.top)),new Zt(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Zt(Math.round(s.left),Math.round(s.height+s.top))]}},yse="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",kT="Hidden Text",bse=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),s=this._document.createElement("img"),a=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),s.src=yse,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",a.style.fontFamily=e,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.appendChild(this._document.createTextNode(kT)),n.appendChild(a),n.appendChild(s);var l=s.offsetTop-a.offsetTop+2;n.removeChild(a),n.appendChild(this._document.createTextNode(kT)),n.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),iM=function(){function t(e,r){this.context=e,this.options=r}return t}(),Nse=1e4,Cse=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new bse(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return n.applyEffect(s)})},e.prototype.applyEffect=function(r){this.ctx.save(),use(r)&&(this.ctx.globalAlpha=r.opacity),Ase(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),tM(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return Bi(this,void 0,void 0,function(){var n;return oi(this,function(s){switch(s.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return Bi(this,void 0,void 0,function(){return oi(this,function(n){switch(n.label){case 0:if(Aa(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,s){var a=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=$S(r.text);o.reduce(function(l,c){return a.ctx.fillText(c,l,r.bounds.top+s),l+a.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=Ise(r.fontFamily).join(", "),a=Dx(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,a,s].join(" "),s,a]},e.prototype.renderTextNode=function(r,n){return Bi(this,void 0,void 0,function(){var s,a,o,l,c,A,u,d,f=this;return oi(this,function(h){return s=this.createFontStyle(n),a=s[0],o=s[1],l=s[2],this.ctx.font=a,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),A=c.baseline,u=c.middle,d=n.paintOrder,r.textBounds.forEach(function(m){d.forEach(function(p){switch(p){case 0:f.ctx.fillStyle=ya(n.color),f.renderTextWithLetterSpacing(m,n.letterSpacing,A);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(g){f.ctx.shadowColor=ya(g.color),f.ctx.shadowOffsetX=g.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=g.offsetY.number*f.options.scale,f.ctx.shadowBlur=g.blur.number,f.renderTextWithLetterSpacing(m,n.letterSpacing,A)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),n.textDecorationLine.length&&(f.ctx.fillStyle=ya(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(g){switch(g){case 1:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+A),m.bounds.width,1);break;case 2:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:f.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+u),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(f.ctx.strokeStyle=ya(n.webkitTextStrokeColor),f.ctx.lineWidth=n.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+A)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var a=vy(r),o=xy(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,a.left,a.top,a.width,a.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return Bi(this,void 0,void 0,function(){var n,s,a,o,l,c,y,y,A,u,d,f,F,h,m,P,p,x,g,y,b,F,P;return oi(this,function(R){switch(R.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,s=r.curves,a=n.styles,o=0,l=n.textNodes,R.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,a)]):[3,4];case 2:R.sent(),R.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof UO))return[3,8];R.label=5;case 5:return R.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=R.sent(),this.renderReplacedElement(n,s,y),[3,8];case 7:return R.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof OO&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof MO))return[3,12];R.label=9;case 9:return R.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=R.sent(),this.renderReplacedElement(n,s,y),[3,12];case 11:return R.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof KO&&n.tree?(A=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,A.render(n.tree)]):[3,14];case 13:u=R.sent(),n.width&&n.height&&this.ctx.drawImage(u,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),R.label=14;case 14:if(n instanceof zS&&(d=Math.min(n.bounds.width,n.bounds.height),n.type===hy?n.checked&&(this.ctx.save(),this.path([new Zt(n.bounds.left+d*.39363,n.bounds.top+d*.79),new Zt(n.bounds.left+d*.16,n.bounds.top+d*.5549),new Zt(n.bounds.left+d*.27347,n.bounds.top+d*.44071),new Zt(n.bounds.left+d*.39694,n.bounds.top+d*.5649),new Zt(n.bounds.left+d*.72983,n.bounds.top+d*.23),new Zt(n.bounds.left+d*.84,n.bounds.top+d*.34085),new Zt(n.bounds.left+d*.39363,n.bounds.top+d*.79)]),this.ctx.fillStyle=ya(xT),this.ctx.fill(),this.ctx.restore()):n.type===fy&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+d/2,n.bounds.top+d/2,d/4,0,Math.PI*2,!0),this.ctx.fillStyle=ya(xT),this.ctx.fill(),this.ctx.restore())),_se(n)&&n.value.length){switch(f=this.createFontStyle(a),F=f[0],h=f[1],m=this.fontMetrics.getMetrics(F,h).baseline,this.ctx.font=F,this.ctx.fillStyle=ya(a.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Bse(n.styles.textAlign),P=vy(n),p=0,n.styles.textAlign){case 1:p+=P.width/2;break;case 2:p+=P.width;break}x=P.add(p,0,0,-P.height/2+1),this.ctx.save(),this.path([new Zt(P.left,P.top),new Zt(P.left+P.width,P.top),new Zt(P.left+P.width,P.top+P.height),new Zt(P.left,P.top+P.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new qp(n.value,x),a.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Aa(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(g=n.styles.listStyleImage,g.type!==0)return[3,18];y=void 0,b=g.url,R.label=15;case 15:return R.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=R.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return R.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(F=this.createFontStyle(a)[0],this.ctx.font=F,this.ctx.fillStyle=ya(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",P=new BA(n.bounds.left,n.bounds.top+Gn(n.styles.paddingTop,n.bounds.width),n.bounds.width,tT(a.lineHeight,a.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new qp(r.listValue,P),a.letterSpacing,tT(a.lineHeight,a.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),R.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return Bi(this,void 0,void 0,function(){var n,s,g,a,o,g,l,c,g,A,u,g,d,f,g,h,m,g,p,x,g;return oi(this,function(y){switch(y.label){case 0:if(Aa(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,s=r.negativeZIndex,y.label=2;case 2:return n<s.length?(g=s[n],[4,this.renderStack(g)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),a=0,o=r.nonInlineLevel,y.label=7;case 7:return a<o.length?(g=o[a],[4,this.renderNode(g)]):[3,10];case 8:y.sent(),y.label=9;case 9:return a++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(g=c[l],[4,this.renderStack(g)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:A=0,u=r.nonPositionedInlineLevel,y.label=15;case 15:return A<u.length?(g=u[A],[4,this.renderStack(g)]):[3,18];case 16:y.sent(),y.label=17;case 17:return A++,[3,15];case 18:d=0,f=r.inlineLevel,y.label=19;case 19:return d<f.length?(g=f[d],[4,this.renderNode(g)]):[3,22];case 20:y.sent(),y.label=21;case 21:return d++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(g=m[h],[4,this.renderStack(g)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,y.label=27;case 27:return p<x.length?(g=x[p],[4,this.renderStack(g)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(s,a){var o=sl(s)?s.start:s;a===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),sl(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},e.prototype.renderRepeat=function(r,n,s,a){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(s,a),this.ctx.fill(),this.ctx.translate(-s,-a)},e.prototype.resizeImage=function(r,n,s){var a;if(r.width===n&&r.height===s)return r;var o=(a=this.canvas.ownerDocument)!==null&&a!==void 0?a:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,s),l},e.prototype.renderBackgroundImage=function(r){return Bi(this,void 0,void 0,function(){var n,s,a,o,l,c;return oi(this,function(A){switch(A.label){case 0:n=r.styles.backgroundImage.length-1,s=function(u){var d,f,h,M,ae,he,U,Z,B,m,M,ae,he,U,Z,p,x,g,y,b,F,P,R,_,B,E,M,k,T,U,Z,pe,ae,he,de,re,xe,Ce,S,I,V,j;return oi(this,function(O){switch(O.label){case 0:if(u.type!==0)return[3,5];d=void 0,f=u.url,O.label=1;case 1:return O.trys.push([1,3,,4]),[4,a.context.cache.match(f)];case 2:return d=O.sent(),[3,4];case 3:return O.sent(),a.context.logger.error("Error loading background-image "+f),[3,4];case 4:return d&&(h=CN(r,n,[d.width,d.height,d.width/d.height]),M=h[0],ae=h[1],he=h[2],U=h[3],Z=h[4],B=a.ctx.createPattern(a.resizeImage(d,U,Z),"repeat"),a.renderRepeat(M,B,ae,he)),[3,6];case 5:Ate(u)?(m=CN(r,n,[null,null,null]),M=m[0],ae=m[1],he=m[2],U=m[3],Z=m[4],p=ate(u.angle,U,Z),x=p[0],g=p[1],y=p[2],b=p[3],F=p[4],P=document.createElement("canvas"),P.width=U,P.height=Z,R=P.getContext("2d"),_=R.createLinearGradient(g,b,y,F),Zk(u.stops,x).forEach(function(W){return _.addColorStop(W.stop,ya(W.color))}),R.fillStyle=_,R.fillRect(0,0,U,Z),U>0&&Z>0&&(B=a.ctx.createPattern(P,"repeat"),a.renderRepeat(M,B,ae,he))):ute(u)&&(E=CN(r,n,[null,null,null]),M=E[0],k=E[1],T=E[2],U=E[3],Z=E[4],pe=u.position.length===0?[KS]:u.position,ae=Gn(pe[0],U),he=Gn(pe[pe.length-1],Z),de=ite(u,ae,he,U,Z),re=de[0],xe=de[1],re>0&&xe>0&&(Ce=a.ctx.createRadialGradient(k+ae,T+he,0,k+ae,T+he,re),Zk(u.stops,re*2).forEach(function(W){return Ce.addColorStop(W.stop,ya(W.color))}),a.path(M),a.ctx.fillStyle=Ce,re!==xe?(S=r.bounds.left+.5*r.bounds.width,I=r.bounds.top+.5*r.bounds.height,V=xe/re,j=1/V,a.ctx.save(),a.ctx.translate(S,I),a.ctx.transform(1,0,0,V,0,0),a.ctx.translate(-S,-I),a.ctx.fillRect(k,j*(T-I)+I,U,Z*j),a.ctx.restore()):a.ctx.fill())),O.label=6;case 6:return n--,[2]}})},a=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:A.sent(),A.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,s){return Bi(this,void 0,void 0,function(){return oi(this,function(a){return this.path(FT(s,n)),this.ctx.fillStyle=ya(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,s,a){return Bi(this,void 0,void 0,function(){var o,l;return oi(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,s,a)]:[3,2];case 1:return c.sent(),[2];case 2:return o=fse(a,s),this.path(o),this.ctx.fillStyle=ya(r),this.ctx.fill(),l=mse(a,s),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return Bi(this,void 0,void 0,function(){var n,s,a,o,l,c,A,u,d=this;return oi(this,function(f){switch(f.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,s=!zu(n.backgroundColor)||n.backgroundImage.length,a=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=Ese(Hf(n.backgroundClip,0),r.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),zu(n.backgroundColor)||(this.ctx.fillStyle=ya(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){d.ctx.save();var m=gy(r.curves),p=h.inset?0:Nse,x=dse(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(d.path(m),d.ctx.clip(),d.mask(x)):(d.mask(m),d.ctx.clip(),d.path(x)),d.ctx.shadowOffsetX=h.offsetX.number+p,d.ctx.shadowOffsetY=h.offsetY.number,d.ctx.shadowColor=ya(h.color),d.ctx.shadowBlur=h.blur.number,d.ctx.fillStyle=h.inset?ya(h.color):"rgba(0,0,0,1)",d.ctx.fill(),d.ctx.restore()}),f.label=2;case 2:l=0,c=0,A=a,f.label=3;case 3:return c<A.length?(u=A[c],u.style!==0&&!zu(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,3)];case 6:return f.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,l,r.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,l,r.curves)];case 10:f.sent(),f.label=11;case 11:l++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,s,a,o){return Bi(this,void 0,void 0,function(){var l,c,A,u,d,f,h,m,p,x,g,y,b,F,P,R,P,R;return oi(this,function(_){return this.ctx.save(),l=pse(a,s),c=FT(a,s),o===2&&(this.path(c),this.ctx.clip()),sl(c[0])?(A=c[0].start.x,u=c[0].start.y):(A=c[0].x,u=c[0].y),sl(c[1])?(d=c[1].end.x,f=c[1].end.y):(d=c[1].x,f=c[1].y),s===0||s===2?h=Math.abs(A-d):h=Math.abs(u-f),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(g=h/(2*m+p),m*=g,p*=g):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),F=(h-(y+1)*m)/y,p=F<=0||Math.abs(p-b)<Math.abs(p-F)?b:F),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=ya(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(sl(c[0])&&(P=c[3],R=c[0],this.ctx.beginPath(),this.formatPath([new Zt(P.end.x,P.end.y),new Zt(R.start.x,R.start.y)]),this.ctx.stroke()),sl(c[1])&&(P=c[1],R=c[2],this.ctx.beginPath(),this.formatPath([new Zt(P.end.x,P.end.y),new Zt(R.start.x,R.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return Bi(this,void 0,void 0,function(){var n;return oi(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ya(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=hse(r),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(iM),_se=function(t){return t instanceof HO||t instanceof VO?!0:t instanceof zS&&t.type!==fy&&t.type!==hy},Ese=function(t,e){switch(t){case 0:return gy(e);case 2:return ose(e);case 1:default:return xy(e)}},Bse=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Sse=["-apple-system","system-ui"],Ise=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return Sse.indexOf(e)===-1}):t},Fse=function(t){$l(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return e.prototype.render=function(r){return Bi(this,void 0,void 0,function(){var n,s;return oi(this,function(a){switch(a.label){case 0:return n=oE(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,kse(n)];case 1:return s=a.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ya(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(iM),kse=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Tse=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Rv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Rv([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Rv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Rv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),jse=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new Tse({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new Zne(this,e)}return t.instanceCount=1,t}(),$h=function(t,e){return e===void 0&&(e={}),Pse(t,e)};typeof window<"u"&&eM.setContext(window);var Pse=function(t,e){return Bi(void 0,void 0,void 0,function(){var r,n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b,F,P,_,R,_,B,E,M,k,T,U,Z,pe,ae,he,de,re,xe,Ce,S,I,V;return oi(this,function(j){switch(j.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(B=e.allowTaint)!==null&&B!==void 0?B:!1,imageTimeout:(E=e.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:e.proxy,useCORS:(M=e.useCORS)!==null&&M!==void 0?M:!1},a=G_({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},s),o={windowWidth:(T=e.windowWidth)!==null&&T!==void 0?T:n.innerWidth,windowHeight:(U=e.windowHeight)!==null&&U!==void 0?U:n.innerHeight,scrollX:(Z=e.scrollX)!==null&&Z!==void 0?Z:n.pageXOffset,scrollY:(pe=e.scrollY)!==null&&pe!==void 0?pe:n.pageYOffset},l=new BA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new jse(a,l),A=(ae=e.foreignObjectRendering)!==null&&ae!==void 0?ae:!1,u={allowTaint:(he=e.allowTaint)!==null&&he!==void 0?he:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:A,copyStyles:A},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),d=new BT(c,t,u),f=d.clonedReferenceElement,f?[4,d.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=j.sent(),m=WS(f)||Dne(f)?dZ(f.ownerDocument):P2(c,f),p=m.width,x=m.height,g=m.left,y=m.top,b=Rse(c,f,e.backgroundColor),F={canvas:e.canvas,backgroundColor:b,scale:(re=(de=e.scale)!==null&&de!==void 0?de:n.devicePixelRatio)!==null&&re!==void 0?re:1,x:((xe=e.x)!==null&&xe!==void 0?xe:0)+g,y:((Ce=e.y)!==null&&Ce!==void 0?Ce:0)+y,width:(S=e.width)!==null&&S!==void 0?S:Math.ceil(p),height:(I=e.height)!==null&&I!==void 0?I:Math.ceil(x)},A?(c.logger.debug("Document cloned, using foreign object rendering"),_=new Fse(c,F),[4,_.render(f)]):[3,3];case 2:return P=j.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+g+","+y+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),R=GO(c,f),b===R.styles.backgroundColor&&(R.styles.backgroundColor=fA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+F.x+","+F.y+" with size "+F.width+"x"+F.height),_=new Cse(c,F),[4,_.render(R)];case 4:P=j.sent(),j.label=5;case 5:return(!((V=e.removeContainer)!==null&&V!==void 0)||V)&&(BT.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,P]}})})},Rse=function(t,e,r){var n=e.ownerDocument,s=n.documentElement?Hp(t,getComputedStyle(n.documentElement).backgroundColor):fA.TRANSPARENT,a=n.body?Hp(t,getComputedStyle(n.body).backgroundColor):fA.TRANSPARENT,o=typeof r=="string"?Hp(t,r):r===null?fA.TRANSPARENT:4294967295;return e===n.documentElement?zu(s)?zu(a)?o:a:s:o};const JS=Object.freeze(Object.defineProperty({__proto__:null,default:$h},Symbol.toStringTag,{value:"Module"})),Dse="modulepreload",Lse=function(t){return"/"+t},TT={},mA=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Lse(c),c in TT)return;TT[c]=!0;const A=c.endsWith(".css"),u=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=A?"stylesheet":Dse,A||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),A)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Sn(t){"@babel/helpers - typeof";return Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(t)}var Kl=Uint8Array,Bo=Uint16Array,XS=Int32Array,YS=new Kl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ZS=new Kl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jT=new Kl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),oM=function(t,e){for(var r=new Bo(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new XS(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},lM=oM(YS,2),Use=lM.b,fE=lM.r;Use[28]=258,fE[258]=28;var Ose=oM(ZS,0),PT=Ose.r,mE=new Bo(32768);for(var Yn=0;Yn<32768;++Yn){var au=(Yn&43690)>>1|(Yn&21845)<<1;au=(au&52428)>>2|(au&13107)<<2,au=(au&61680)>>4|(au&3855)<<4,mE[Yn]=((au&65280)>>8|(au&255)<<8)>>1}var $p=function(t,e,r){for(var n=t.length,s=0,a=new Bo(e);s<n;++s)t[s]&&++a[t[s]-1];var o=new Bo(e);for(s=1;s<e;++s)o[s]=o[s-1]+a[s-1]<<1;var l;if(r){l=new Bo(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var A=s<<4|t[s],u=e-t[s],d=o[t[s]-1]++<<u,f=d|(1<<u)-1;d<=f;++d)l[mE[d]>>c]=A}else for(l=new Bo(n),s=0;s<n;++s)t[s]&&(l[s]=mE[o[t[s]-1]++]>>15-t[s]);return l},Fh=new Kl(288);for(var Yn=0;Yn<144;++Yn)Fh[Yn]=8;for(var Yn=144;Yn<256;++Yn)Fh[Yn]=9;for(var Yn=256;Yn<280;++Yn)Fh[Yn]=7;for(var Yn=280;Yn<288;++Yn)Fh[Yn]=8;var wy=new Kl(32);for(var Yn=0;Yn<32;++Yn)wy[Yn]=5;var Mse=$p(Fh,9,0),Qse=$p(wy,5,0),cM=function(t){return(t+7)/8|0},Vse=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Kl(t.subarray(e,r))},Gc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Ym=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},_N=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,a=r.slice();if(!s)return{t:uM,l:0};if(s==1){var o=new Kl(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(P,R){return P.f-R.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],A=0,u=1,d=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=r[r[A].f<r[d].f?A++:d++],c=r[A!=u&&r[A].f<r[d].f?A++:d++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var f=a[0].s,n=1;n<s;++n)a[n].s>f&&(f=a[n].s);var h=new Bo(f+1),m=pE(r[u-1],h,0);if(m>e){var n=0,p=0,x=m-e,g=1<<x;for(a.sort(function(R,_){return h[_.s]-h[R.s]||R.f-_.f});n<s;++n){var y=a[n].s;if(h[y]>e)p+=g-(1<<m-h[y]),h[y]=e;else break}for(p>>=x;p>0;){var b=a[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var F=a[n].s;h[F]==e&&(--h[F],++p)}m=e}return{t:new Kl(h),l:m}},pE=function(t,e,r){return t.s==-1?Math.max(pE(t.l,e,r+1),pE(t.r,e,r+1)):e[t.s]=r},RT=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Bo(++e),n=0,s=t[0],a=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=t[l]}return{c:r.subarray(0,n),n:e}},Zm=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},AM=function(t,e,r){var n=r.length,s=cM(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var a=0;a<n;++a)t[s+a+4]=r[a];return(s+4+n)*8},DT=function(t,e,r,n,s,a,o,l,c,A,u){Gc(e,u++,r),++s[256];for(var d=_N(s,15),f=d.t,h=d.l,m=_N(a,15),p=m.t,x=m.l,g=RT(f),y=g.c,b=g.n,F=RT(p),P=F.c,R=F.n,_=new Bo(19),B=0;B<y.length;++B)++_[y[B]&31];for(var B=0;B<P.length;++B)++_[P[B]&31];for(var E=_N(_,7),M=E.t,k=E.l,T=19;T>4&&!M[jT[T-1]];--T);var U=A+5<<3,Z=Zm(s,Fh)+Zm(a,wy)+o,pe=Zm(s,f)+Zm(a,p)+o+14+3*T+Zm(_,M)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&U<=Z&&U<=pe)return AM(e,u,t.subarray(c,c+A));var ae,he,de,re;if(Gc(e,u,1+(pe<Z)),u+=2,pe<Z){ae=$p(f,h,0),he=f,de=$p(p,x,0),re=p;var xe=$p(M,k,0);Gc(e,u,b-257),Gc(e,u+5,R-1),Gc(e,u+10,T-4),u+=14;for(var B=0;B<T;++B)Gc(e,u+3*B,M[jT[B]]);u+=3*T;for(var Ce=[y,P],S=0;S<2;++S)for(var I=Ce[S],B=0;B<I.length;++B){var V=I[B]&31;Gc(e,u,xe[V]),u+=M[V],V>15&&(Gc(e,u,I[B]>>5&127),u+=I[B]>>12)}}else ae=Mse,he=Fh,de=Qse,re=wy;for(var B=0;B<l;++B){var j=n[B];if(j>255){var V=j>>18&31;Ym(e,u,ae[V+257]),u+=he[V+257],V>7&&(Gc(e,u,j>>23&31),u+=YS[V]);var O=j&31;Ym(e,u,de[O]),u+=re[O],O>3&&(Ym(e,u,j>>5&8191),u+=ZS[O])}else Ym(e,u,ae[j]),u+=he[j]}return Ym(e,u,ae[256]),u+he[256]},Hse=new XS([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),uM=new Kl(0),Kse=function(t,e,r,n,s,a){var o=a.z||t.length,l=new Kl(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),A=a.l,u=(a.r||0)&7;if(e){u&&(c[0]=a.r>>3);for(var d=Hse[e-1],f=d>>13,h=d&8191,m=(1<<r)-1,p=a.p||new Bo(32768),x=a.h||new Bo(m+1),g=Math.ceil(r/3),y=2*g,b=function(te){return(t[te]^t[te+1]<<g^t[te+2]<<y)&m},F=new XS(25e3),P=new Bo(288),R=new Bo(32),_=0,B=0,E=a.i||0,M=0,k=a.w||0,T=0;E+2<o;++E){var U=b(E),Z=E&32767,pe=x[U];if(p[Z]=pe,x[U]=Z,k<=E){var ae=o-E;if((_>7e3||M>24576)&&(ae>423||!A)){u=DT(t,c,0,F,P,R,B,M,T,E-T,u),M=_=B=0,T=E;for(var he=0;he<286;++he)P[he]=0;for(var he=0;he<30;++he)R[he]=0}var de=2,re=0,xe=h,Ce=Z-pe&32767;if(ae>2&&U==b(E-Ce))for(var S=Math.min(f,ae)-1,I=Math.min(32767,E),V=Math.min(258,ae);Ce<=I&&--xe&&Z!=pe;){if(t[E+de]==t[E+de-Ce]){for(var j=0;j<V&&t[E+j]==t[E+j-Ce];++j);if(j>de){if(de=j,re=Ce,j>S)break;for(var O=Math.min(Ce,j-2),W=0,he=0;he<O;++he){var D=E-Ce+he&32767,Y=p[D],se=D-Y&32767;se>W&&(W=se,pe=D)}}}Z=pe,pe=p[Z],Ce+=Z-pe&32767}if(re){F[M++]=268435456|fE[de]<<18|PT[re];var ve=fE[de]&31,z=PT[re]&31;B+=YS[ve]+ZS[z],++P[257+ve],++R[z],k=E+de,++_}else F[M++]=t[E],++P[t[E]]}}for(E=Math.max(E,k);E<o;++E)F[M++]=t[E],++P[t[E]];u=DT(t,c,A,F,P,R,B,M,T,E-T,u),A||(a.r=u&7|c[u/8|0]<<3,u-=7,a.h=x,a.p=p,a.i=E,a.w=k)}else{for(var E=a.w||0;E<o+A;E+=65535){var Oe=E+65535;Oe>=o&&(c[u/8|0]=A,Oe=o),u=AM(c,u+1,t.subarray(E,Oe))}a.i=o}return Vse(l,0,n+cM(u)+s)},dM=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,a=r.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},qse=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new Kl(a.length+t.length);o.set(a),o.set(t,a.length),t=o,s.w=a.length}return Kse(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},hM=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Gse=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=dM();s.p(e.dictionary),hM(t,2,s.d())}};function gE(t,e){e||(e={});var r=dM();r.p(t);var n=qse(t,e,e.dictionary?6:2,4);return Gse(n,e),hM(n,n.length-4,r.d()),n}var $se=typeof TextDecoder<"u"&&new TextDecoder,zse=0;try{$se.decode(uM,{stream:!0}),zse=1}catch{}function Wse(t){if(Array.isArray(t))return t}function Jse(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,a,o,l=[],c=!0,A=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(u){A=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(A)throw s}}return l}}function LT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Xse(t,e){if(t){if(typeof t=="string")return LT(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?LT(t,e):void 0}}function Yse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UT(t,e){return Wse(t)||Jse(t,e)||Xse(t,e)||Yse()}function OT(t,e="utf8"){return new TextDecoder(e).decode(t)}const Zse=new TextEncoder;function eae(t){return Zse.encode(t)}const tae=1024*8,rae=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),EN={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class eI{constructor(e=tae,r={}){bn(this,"buffer");bn(this,"byteLength");bn(this,"byteOffset");bn(this,"length");bn(this,"offset");bn(this,"lastWrittenByte");bn(this,"littleEndian");bn(this,"_data");bn(this,"_mark");bn(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=r.offset?r.offset>>>0:0,a=e.byteLength-s;let o=s;(ArrayBuffer.isView(e)||e instanceof eI)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=EN[r].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===rae&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new EN[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new EN[r](a);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return OT(this.readBytes(e))}decodeText(e=1,r="utf8"){return OT(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(eae(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function om(t){let e=t.length;for(;--e>=0;)t[e]=0}const nae=3,sae=258,fM=29,aae=256,iae=aae+1+fM,mM=30,oae=512,lae=new Array((iae+2)*2);om(lae);const cae=new Array(mM*2);om(cae);const Aae=new Array(oae);om(Aae);const uae=new Array(sae-nae+1);om(uae);const dae=new Array(fM);om(dae);const hae=new Array(mM);om(hae);const fae=(t,e,r,n)=>{let s=t&65535|0,a=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,a=a+s|0;while(--o);s%=65521,a%=65521}return s|a<<16|0};var xE=fae;const mae=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},pae=new Uint32Array(mae()),gae=(t,e,r,n)=>{const s=pae,a=n+r;t^=-1;for(let o=n;o<a;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var ic=gae,vE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},pM={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const xae=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var vae=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)xae(r,n)&&(t[n]=r[n])}}return t},wae=t=>{let e=0;for(let n=0,s=t.length;n<s;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,s=0,a=t.length;n<a;n++){let o=t[n];r.set(o,s),s+=o.length}return r},gM={assign:vae,flattenChunks:wae};let xM=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{xM=!1}const Gg=new Uint8Array(256);for(let t=0;t<256;t++)Gg[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Gg[254]=Gg[254]=1;var yae=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,s,a,o=t.length,l=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),a=0,s=0;a<l;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const bae=(t,e)=>{if(e<65534&&t.subarray&&xM)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var Nae=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let o=t[n++];if(o<128){a[s++]=o;continue}let l=Gg[o];if(l>4){a[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){a[s++]=65533;continue}o<65536?a[s++]=o:(o-=65536,a[s++]=55296|o>>10&1023,a[s++]=56320|o&1023)}return bae(a,s)},Cae=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Gg[t[r]]>e?r:e},wE={string2buf:yae,buf2string:Nae,utf8border:Cae};function _ae(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Eae=_ae;const s1=16209,Bae=16191;var Sae=function(e,r){let n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b,F,P,R,_,B,E,M;const k=e.state;n=e.next_in,E=e.input,s=n+(e.avail_in-5),a=e.next_out,M=e.output,o=a-(r-e.avail_out),l=a+(e.avail_out-257),c=k.dmax,A=k.wsize,u=k.whave,d=k.wnext,f=k.window,h=k.hold,m=k.bits,p=k.lencode,x=k.distcode,g=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=p[h&g];t:for(;;){if(F=b>>>24,h>>>=F,m-=F,F=b>>>16&255,F===0)M[a++]=b&65535;else if(F&16){P=b&65535,F&=15,F&&(m<F&&(h+=E[n++]<<m,m+=8),P+=h&(1<<F)-1,h>>>=F,m-=F),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=x[h&y];r:for(;;){if(F=b>>>24,h>>>=F,m-=F,F=b>>>16&255,F&16){if(R=b&65535,F&=15,m<F&&(h+=E[n++]<<m,m+=8,m<F&&(h+=E[n++]<<m,m+=8)),R+=h&(1<<F)-1,R>c){e.msg="invalid distance too far back",k.mode=s1;break e}if(h>>>=F,m-=F,F=a-o,R>F){if(F=R-F,F>u&&k.sane){e.msg="invalid distance too far back",k.mode=s1;break e}if(_=0,B=f,d===0){if(_+=A-F,F<P){P-=F;do M[a++]=f[_++];while(--F);_=a-R,B=M}}else if(d<F){if(_+=A+d-F,F-=d,F<P){P-=F;do M[a++]=f[_++];while(--F);if(_=0,d<P){F=d,P-=F;do M[a++]=f[_++];while(--F);_=a-R,B=M}}}else if(_+=d-F,F<P){P-=F;do M[a++]=f[_++];while(--F);_=a-R,B=M}for(;P>2;)M[a++]=B[_++],M[a++]=B[_++],M[a++]=B[_++],P-=3;P&&(M[a++]=B[_++],P>1&&(M[a++]=B[_++]))}else{_=a-R;do M[a++]=M[_++],M[a++]=M[_++],M[a++]=M[_++],P-=3;while(P>2);P&&(M[a++]=M[_++],P>1&&(M[a++]=M[_++]))}}else if(F&64){e.msg="invalid distance code",k.mode=s1;break e}else{b=x[(b&65535)+(h&(1<<F)-1)];continue r}break}}else if(F&64)if(F&32){k.mode=Bae;break e}else{e.msg="invalid literal/length code",k.mode=s1;break e}else{b=p[(b&65535)+(h&(1<<F)-1)];continue t}break}}while(n<s&&a<l);P=m>>3,n-=P,m-=P<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=a,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=a<l?257+(l-a):257-(a-l),k.hold=h,k.bits=m};const Ef=15,MT=852,QT=592,VT=0,BN=1,HT=2,Iae=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Fae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),kae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Tae=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),jae=(t,e,r,n,s,a,o,l)=>{const c=l.bits;let A=0,u=0,d=0,f=0,h=0,m=0,p=0,x=0,g=0,y=0,b,F,P,R,_,B=null,E;const M=new Uint16Array(Ef+1),k=new Uint16Array(Ef+1);let T=null,U,Z,pe;for(A=0;A<=Ef;A++)M[A]=0;for(u=0;u<n;u++)M[e[r+u]]++;for(h=c,f=Ef;f>=1&&M[f]===0;f--);if(h>f&&(h=f),f===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<f&&M[d]===0;d++);for(h<d&&(h=d),x=1,A=1;A<=Ef;A++)if(x<<=1,x-=M[A],x<0)return-1;if(x>0&&(t===VT||f!==1))return-1;for(k[1]=0,A=1;A<Ef;A++)k[A+1]=k[A]+M[A];for(u=0;u<n;u++)e[r+u]!==0&&(o[k[e[r+u]]++]=u);if(t===VT?(B=T=o,E=20):t===BN?(B=Iae,T=Fae,E=257):(B=kae,T=Tae,E=0),y=0,u=0,A=d,_=a,m=h,p=0,P=-1,g=1<<h,R=g-1,t===BN&&g>MT||t===HT&&g>QT)return 1;for(;;){U=A-p,o[u]+1<E?(Z=0,pe=o[u]):o[u]>=E?(Z=T[o[u]-E],pe=B[o[u]-E]):(Z=96,pe=0),b=1<<A-p,F=1<<m,d=F;do F-=b,s[_+(y>>p)+F]=U<<24|Z<<16|pe|0;while(F!==0);for(b=1<<A-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,u++,--M[A]===0){if(A===f)break;A=e[r+o[u]]}if(A>h&&(y&R)!==P){for(p===0&&(p=h),_+=d,m=A-p,x=1<<m;m+p<f&&(x-=M[m+p],!(x<=0));)m++,x<<=1;if(g+=1<<m,t===BN&&g>MT||t===HT&&g>QT)return 1;P=y&R,s[P]=h<<24|m<<16|_-a|0}}return y!==0&&(s[_+y]=A-p<<24|64<<16|0),l.bits=h,0};var zp=jae;const Pae=0,vM=1,wM=2,{Z_FINISH:KT,Z_BLOCK:Rae,Z_TREES:a1,Z_OK:kh,Z_STREAM_END:Dae,Z_NEED_DICT:Lae,Z_STREAM_ERROR:fl,Z_DATA_ERROR:yM,Z_MEM_ERROR:bM,Z_BUF_ERROR:Uae,Z_DEFLATED:qT}=pM,K2=16180,GT=16181,$T=16182,zT=16183,WT=16184,JT=16185,XT=16186,YT=16187,ZT=16188,ej=16189,yy=16190,$c=16191,SN=16192,tj=16193,IN=16194,rj=16195,nj=16196,sj=16197,aj=16198,i1=16199,o1=16200,ij=16201,oj=16202,lj=16203,cj=16204,Aj=16205,FN=16206,uj=16207,dj=16208,ns=16209,NM=16210,CM=16211,Oae=852,Mae=592,Qae=15,Vae=Qae,hj=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Hae(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const zh=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<K2||e.mode>CM?1:0},_M=t=>{if(zh(t))return fl;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=K2,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Oae),e.distcode=e.distdyn=new Int32Array(Mae),e.sane=1,e.back=-1,kh},EM=t=>{if(zh(t))return fl;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,_M(t)},BM=(t,e)=>{let r;if(zh(t))return fl;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?fl:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,EM(t))},SM=(t,e)=>{if(!t)return fl;const r=new Hae;t.state=r,r.strm=t,r.window=null,r.mode=K2;const n=BM(t,e);return n!==kh&&(t.state=null),n},Kae=t=>SM(t,Vae);let fj=!0,kN,TN;const qae=t=>{if(fj){kN=new Int32Array(512),TN=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(zp(vM,t.lens,0,288,kN,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;zp(wM,t.lens,0,32,TN,0,t.work,{bits:5}),fj=!1}t.lencode=kN,t.lenbits=9,t.distcode=TN,t.distbits=5},IM=(t,e,r,n)=>{let s;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(e.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},Gae=(t,e)=>{let r,n,s,a,o,l,c,A,u,d,f,h,m,p,x=0,g,y,b,F,P,R,_,B;const E=new Uint8Array(4);let M,k;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(zh(t)||!t.output||!t.input&&t.avail_in!==0)return fl;r=t.state,r.mode===$c&&(r.mode=SN),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,A=r.hold,u=r.bits,d=l,f=c,B=kh;e:for(;;)switch(r.mode){case K2:if(r.wrap===0){r.mode=SN;break}for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&2&&A===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=A&255,E[1]=A>>>8&255,r.check=ic(r.check,E,2,0),A=0,u=0,r.mode=GT;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((A&255)<<8)+(A>>8))%31){t.msg="incorrect header check",r.mode=ns;break}if((A&15)!==qT){t.msg="unknown compression method",r.mode=ns;break}if(A>>>=4,u-=4,_=(A&15)+8,r.wbits===0&&(r.wbits=_),_>15||_>r.wbits){t.msg="invalid window size",r.mode=ns;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=A&512?ej:$c,A=0,u=0;break;case GT:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.flags=A,(r.flags&255)!==qT){t.msg="unknown compression method",r.mode=ns;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=ns;break}r.head&&(r.head.text=A>>8&1),r.flags&512&&r.wrap&4&&(E[0]=A&255,E[1]=A>>>8&255,r.check=ic(r.check,E,2,0)),A=0,u=0,r.mode=$T;case $T:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.time=A),r.flags&512&&r.wrap&4&&(E[0]=A&255,E[1]=A>>>8&255,E[2]=A>>>16&255,E[3]=A>>>24&255,r.check=ic(r.check,E,4,0)),A=0,u=0,r.mode=zT;case zT:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=A&255,r.head.os=A>>8),r.flags&512&&r.wrap&4&&(E[0]=A&255,E[1]=A>>>8&255,r.check=ic(r.check,E,2,0)),A=0,u=0,r.mode=WT;case WT:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length=A,r.head&&(r.head.extra_len=A),r.flags&512&&r.wrap&4&&(E[0]=A&255,E[1]=A>>>8&255,r.check=ic(r.check,E,2,0)),A=0,u=0}else r.head&&(r.head.extra=null);r.mode=JT;case JT:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+h),_)),r.flags&512&&r.wrap&4&&(r.check=ic(r.check,n,h,a)),l-=h,a+=h,r.length-=h),r.length))break e;r.length=0,r.mode=XT;case XT:if(r.flags&2048){if(l===0)break e;h=0;do _=n[a+h++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=ic(r.check,n,h,a)),l-=h,a+=h,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=YT;case YT:if(r.flags&4096){if(l===0)break e;h=0;do _=n[a+h++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=ic(r.check,n,h,a)),l-=h,a+=h,_)break e}else r.head&&(r.head.comment=null);r.mode=ZT;case ZT:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.check&65535)){t.msg="header crc mismatch",r.mode=ns;break}A=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=$c;break;case ej:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}t.adler=r.check=hj(A),A=0,u=0,r.mode=yy;case yy:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,Lae;t.adler=r.check=1,r.mode=$c;case $c:if(e===Rae||e===a1)break e;case SN:if(r.last){A>>>=u&7,u-=u&7,r.mode=FN;break}for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}switch(r.last=A&1,A>>>=1,u-=1,A&3){case 0:r.mode=tj;break;case 1:if(qae(r),r.mode=i1,e===a1){A>>>=2,u-=2;break e}break;case 2:r.mode=nj;break;case 3:t.msg="invalid block type",r.mode=ns}A>>>=2,u-=2;break;case tj:for(A>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if((A&65535)!==(A>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ns;break}if(r.length=A&65535,A=0,u=0,r.mode=IN,e===a1)break e;case IN:r.mode=rj;case rj:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;s.set(n.subarray(a,a+h),o),l-=h,a+=h,c-=h,o+=h,r.length-=h;break}r.mode=$c;break;case nj:for(;u<14;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.nlen=(A&31)+257,A>>>=5,u-=5,r.ndist=(A&31)+1,A>>>=5,u-=5,r.ncode=(A&15)+4,A>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ns;break}r.have=0,r.mode=sj;case sj:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.lens[T[r.have++]]=A&7,A>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,M={bits:r.lenbits},B=zp(Pae,r.lens,0,19,r.lencode,0,r.work,M),r.lenbits=M.bits,B){t.msg="invalid code lengths set",r.mode=ns;break}r.have=0,r.mode=aj;case aj:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[A&(1<<r.lenbits)-1],g=x>>>24,y=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(b<16)A>>>=g,u-=g,r.lens[r.have++]=b;else{if(b===16){for(k=g+2;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(A>>>=g,u-=g,r.have===0){t.msg="invalid bit length repeat",r.mode=ns;break}_=r.lens[r.have-1],h=3+(A&3),A>>>=2,u-=2}else if(b===17){for(k=g+3;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=g,u-=g,_=0,h=3+(A&7),A>>>=3,u-=3}else{for(k=g+7;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=g,u-=g,_=0,h=11+(A&127),A>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ns;break}for(;h--;)r.lens[r.have++]=_}}if(r.mode===ns)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=ns;break}if(r.lenbits=9,M={bits:r.lenbits},B=zp(vM,r.lens,0,r.nlen,r.lencode,0,r.work,M),r.lenbits=M.bits,B){t.msg="invalid literal/lengths set",r.mode=ns;break}if(r.distbits=6,r.distcode=r.distdyn,M={bits:r.distbits},B=zp(wM,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M),r.distbits=M.bits,B){t.msg="invalid distances set",r.mode=ns;break}if(r.mode=i1,e===a1)break e;case i1:r.mode=o1;case o1:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,Sae(t,f),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,A=r.hold,u=r.bits,r.mode===$c&&(r.back=-1);break}for(r.back=0;x=r.lencode[A&(1<<r.lenbits)-1],g=x>>>24,y=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(y&&!(y&240)){for(F=g,P=y,R=b;x=r.lencode[R+((A&(1<<F+P)-1)>>F)],g=x>>>24,y=x>>>16&255,b=x&65535,!(F+g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=F,u-=F,r.back+=F}if(A>>>=g,u-=g,r.back+=g,r.length=b,y===0){r.mode=Aj;break}if(y&32){r.back=-1,r.mode=$c;break}if(y&64){t.msg="invalid literal/length code",r.mode=ns;break}r.extra=y&15,r.mode=ij;case ij:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=oj;case oj:for(;x=r.distcode[A&(1<<r.distbits)-1],g=x>>>24,y=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(!(y&240)){for(F=g,P=y,R=b;x=r.distcode[R+((A&(1<<F+P)-1)>>F)],g=x>>>24,y=x>>>16&255,b=x&65535,!(F+g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=F,u-=F,r.back+=F}if(A>>>=g,u-=g,r.back+=g,y&64){t.msg="invalid distance code",r.mode=ns;break}r.offset=b,r.extra=y&15,r.mode=lj;case lj:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.offset+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ns;break}r.mode=cj;case cj:if(c===0)break e;if(h=f-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ns;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=s,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do s[o++]=p[m++];while(--h);r.length===0&&(r.mode=o1);break;case Aj:if(c===0)break e;s[o++]=r.length,c--,r.mode=o1;break;case FN:if(r.wrap){for(;u<32;){if(l===0)break e;l--,A|=n[a++]<<u,u+=8}if(f-=c,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?ic(r.check,s,f,o-f):xE(r.check,s,f,o-f)),f=c,r.wrap&4&&(r.flags?A:hj(A))!==r.check){t.msg="incorrect data check",r.mode=ns;break}A=0,u=0}r.mode=uj;case uj:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=ns;break}A=0,u=0}r.mode=dj;case dj:B=Dae;break e;case ns:B=yM;break e;case NM:return bM;case CM:default:return fl}return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,(r.wsize||f!==t.avail_out&&r.mode<ns&&(r.mode<FN||e!==KT))&&IM(t,t.output,t.next_out,f-t.avail_out),d-=t.avail_in,f-=t.avail_out,t.total_in+=d,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?ic(r.check,s,f,t.next_out-f):xE(r.check,s,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===$c?128:0)+(r.mode===i1||r.mode===IN?256:0),(d===0&&f===0||e===KT)&&B===kh&&(B=Uae),B},$ae=t=>{if(zh(t))return fl;let e=t.state;return e.window&&(e.window=null),t.state=null,kh},zae=(t,e)=>{if(zh(t))return fl;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,kh):fl},Wae=(t,e)=>{const r=e.length;let n,s,a;return zh(t)||(n=t.state,n.wrap!==0&&n.mode!==yy)?fl:n.mode===yy&&(s=1,s=xE(s,e,r,0),s!==n.check)?yM:(a=IM(t,e,r,r),a?(n.mode=NM,bM):(n.havedict=1,kh))};var Jae=EM,Xae=BM,Yae=_M,Zae=Kae,eie=SM,tie=Gae,rie=$ae,nie=zae,sie=Wae,aie="pako inflate (from Nodeca project)",tA={inflateReset:Jae,inflateReset2:Xae,inflateResetKeep:Yae,inflateInit:Zae,inflateInit2:eie,inflate:tie,inflateEnd:rie,inflateGetHeader:nie,inflateSetDictionary:sie,inflateInfo:aie};function iie(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var oie=iie;const FM=Object.prototype.toString,{Z_NO_FLUSH:lie,Z_FINISH:cie,Z_OK:$g,Z_STREAM_END:jN,Z_NEED_DICT:PN,Z_STREAM_ERROR:Aie,Z_DATA_ERROR:mj,Z_MEM_ERROR:uie}=pM;function Lx(t){this.options=gM.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Eae,this.strm.avail_out=0;let r=tA.inflateInit2(this.strm,e.windowBits);if(r!==$g)throw new Error(vE[r]);if(this.header=new oie,tA.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=wE.string2buf(e.dictionary):FM.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=tA.inflateSetDictionary(this.strm,e.dictionary),r!==$g)))throw new Error(vE[r])}Lx.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?cie:lie,FM.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=tA.inflate(r,o),a===PN&&s&&(a=tA.inflateSetDictionary(r,s),a===$g?a=tA.inflate(r,o):a===mj&&(a=PN));r.avail_in>0&&a===jN&&r.state.wrap>0&&t[r.next_in]!==0;)tA.inflateReset(r),a=tA.inflate(r,o);switch(a){case Aie:case mj:case PN:case uie:return this.onEnd(a),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||a===jN))if(this.options.to==="string"){let c=wE.utf8border(r.output,r.next_out),A=r.next_out-c,u=wE.buf2string(r.output,c);r.next_out=A,r.avail_out=n-A,A&&r.output.set(r.output.subarray(c,c+A),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===$g&&l===0)){if(a===jN)return a=tA.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Lx.prototype.onData=function(t){this.chunks.push(t)};Lx.prototype.onEnd=function(t){t===$g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=gM.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function die(t,e){const r=new Lx(e);if(r.push(t),r.err)throw r.msg||vE[r.err];return r.result}var hie=Lx,fie=die,mie={Inflate:hie,inflate:fie};const{Inflate:pie,inflate:gie}=mie;var pj=pie,xie=gie;const kM=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;kM[t]=e}const gj=4294967295;function vie(t,e,r){let n=t;for(let s=0;s<r;s++)n=kM[(n^e[s])&255]^n>>>8;return n}function wie(t,e){return(vie(gj,t,e)^gj)>>>0}function xj(t,e,r){const n=t.readUint32(),s=wie(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function TM(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function jM(t,e,r,n){let s=0;for(;s<n;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-n]&255}function PM(t,e,r,n){let s=0;if(r.length===0)for(;s<n;s++)e[s]=t[s];else for(;s<n;s++)e[s]=t[s]+r[s]&255}function RM(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-s]>>1)&255}else{for(;a<s;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-s]+r[a]>>1)&255}}function DM(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-s]&255}else{for(;a<s;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+yie(e[a-s],r[a],r[a-s])&255}}function yie(t,e,r){const n=t+e-r,s=Math.abs(n-t),a=Math.abs(n-e),o=Math.abs(n-r);return s<=a&&s<=o?t:a<=o?e:r}function bie(t,e,r,n,s,a){switch(t){case 0:TM(e,r,s);break;case 1:jM(e,r,s,a);break;case 2:PM(e,r,n,s);break;case 3:RM(e,r,n,s,a);break;case 4:DM(e,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Nie=new Uint16Array([255]),Cie=new Uint8Array(Nie.buffer),_ie=Cie[0]===255;function Eie(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*s,c=new Uint8Array(n*r*l);let A=0;for(let u=0;u<7;u++){const d=o[u],f=Math.ceil((r-d.x)/d.xStep),h=Math.ceil((n-d.y)/d.yStep);if(f<=0||h<=0)continue;const m=f*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const g=e[A++],y=e.subarray(A,A+m);A+=m;const b=new Uint8Array(m);bie(g,y,b,p,m,l),p.set(b);for(let F=0;F<f;F++){const P=d.x+F*d.xStep,R=d.y+x*d.yStep;if(!(P>=r||R>=n))for(let _=0;_<l;_++)c[(R*r+P)*l+_]=b[F*l+_]}}}if(a===16){const u=new Uint16Array(c.buffer);if(_ie)for(let d=0;d<u.length;d++)u[d]=Bie(u[d]);return u}else return c}function Bie(t){return(t&255)<<8|t>>8&255}const Sie=new Uint16Array([255]),Iie=new Uint8Array(Sie.buffer),Fie=Iie[0]===255,kie=new Uint8Array(0);function vj(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=Math.ceil(a/8)*s,l=Math.ceil(a/8*s*r),c=new Uint8Array(n*l);let A=kie,u=0,d,f;for(let h=0;h<n;h++){switch(d=e.subarray(u+1,u+1+l),f=c.subarray(h*l,(h+1)*l),e[u]){case 0:TM(d,f,l);break;case 1:jM(d,f,l,o);break;case 2:PM(d,f,A,l);break;case 3:RM(d,f,A,l,o);break;case 4:DM(d,f,A,l,o);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}A=f,u+=l+1}if(a===16){const h=new Uint16Array(c.buffer);if(Fie)for(let m=0;m<h.length;m++)h[m]=Tie(h[m]);return h}else return c}function Tie(t){return(t&255)<<8|t>>8&255}const pw=Uint8Array.of(137,80,78,71,13,10,26,10);function wj(t){if(!jie(t.readBytes(pw.length)))throw new Error("wrong PNG signature")}function jie(t){if(t.length<pw.length)return!1;for(let e=0;e<pw.length;e++)if(t[e]!==pw[e])return!1;return!0}const Pie="tEXt",Rie=0,LM=new TextDecoder("latin1");function Die(t){if(Uie(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Lie=/^[\u0000-\u00FF]*$/;function Uie(t){if(!Lie.test(t))throw new Error("invalid latin1 text")}function Oie(t,e,r){const n=UM(e);t[n]=Mie(e,r-n.length-1)}function UM(t){for(t.mark();t.readByte()!==Rie;);const e=t.offset;t.reset();const r=LM.decode(t.readBytes(e-t.offset-1));return t.skip(1),Die(r),r}function Mie(t,e){return LM.decode(t.readBytes(e))}const mo={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},RN={UNKNOWN:-1,DEFLATE:0},yj={UNKNOWN:-1,ADAPTIVE:0},DN={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},l1={NONE:0,BACKGROUND:1,PREVIOUS:2},LN={SOURCE:0,OVER:1};class Qie extends eI{constructor(r,n={}){super(r);bn(this,"_checkCrc");bn(this,"_inflator");bn(this,"_png");bn(this,"_apng");bn(this,"_end");bn(this,"_hasPalette");bn(this,"_palette");bn(this,"_hasTransparency");bn(this,"_transparency");bn(this,"_compressionMethod");bn(this,"_filterMethod");bn(this,"_interlaceMethod");bn(this,"_colorType");bn(this,"_isAnimated");bn(this,"_numberOfFrames");bn(this,"_numberOfPlays");bn(this,"_frames");bn(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new pj,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=RN.UNKNOWN,this._filterMethod=yj.UNKNOWN,this._interlaceMethod=DN.UNKNOWN,this._colorType=mo.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(wj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(wj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Pie:Oie(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?xj(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?xj(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Vie(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case mo.GREYSCALE:s=1;break;case mo.TRUECOLOUR:s=3;break;case mo.INDEXED_COLOUR:s=1;break;case mo.GREYSCALE_ALPHA:s=2;break;case mo.TRUECOLOUR_ALPHA:s=4;break;case mo.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==RN.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let a=0;a<n;a++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case mo.GREYSCALE:case mo.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case mo.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case mo.UNKNOWN:case mo.GREYSCALE_ALPHA:case mo.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=UM(this),s=this.readUint8();if(s!==RN.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:xie(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=vj({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(s,a,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case l1.NONE:break;case l1.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let o=0;o<this._png.width;o++){const l=(a*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case l1.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,a=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,A=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:A}};switch(n.blendOp){case LN.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[A+u]}break;case LN.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++){const d=n.data[A+this._png.channels-1]/s,f=u%(this._png.channels-1)===0?1:n.data[A+u],h=Math.floor(d*f+(1-d)*r.data[c+u]);r.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==yj.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===DN.NO_INTERLACE)this._png.data=vj({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===DN.ADAM7)this._png.data=Eie({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:l1.NONE,blendOp:LN.SOURCE,data:r}),this._inflator=new pj,this._writingDataChunks=!1}}function Vie(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var bj;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(bj||(bj={}));function Hie(t,e){return new Qie(t,e).decode()}var Sr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function UN(){Sr.console&&typeof Sr.console.log=="function"&&Sr.console.log.apply(Sr.console,arguments)}var Vn={log:UN,warn:function(t){Sr.console&&(typeof Sr.console.warn=="function"?Sr.console.warn.apply(Sr.console,arguments):UN.call(null,arguments))},error:function(t){Sr.console&&(typeof Sr.console.error=="function"?Sr.console.error.apply(Sr.console,arguments):UN(t))}};function ON(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Hd(n.response,e,r)},n.onerror=function(){Vn.error("could not download file")},n.send()}function Nj(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function c1(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Hd=Sr.saveAs||((typeof window>"u"?"undefined":Sn(window))!=="object"||window!==Sr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Sr.URL||Sr.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?Nj(s.href)?ON(t,e,r):c1(s,s.target="_blank"):c1(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){c1(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(Nj(t))ON(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){c1(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:Sn(a)!=="object"&&(Vn.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return ON(t,e,r);var s=t.type==="application/octet-stream",a=/constructor/i.test(Sr.HTMLElement)||Sr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&a)&&(typeof FileReader>"u"?"undefined":Sn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(t)}else{var c=Sr.URL||Sr.webkitURL,A=c.createObjectURL(t);n?n.location=A:location.href=A,n=null,setTimeout(function(){c.revokeObjectURL(A)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function OM(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,o=s.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),A=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),A.length==1&&(A="0"+A),"#"+l+c+A}}var gw=Sr.atob.bind(Sr),Cj=Sr.btoa.bind(Sr);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function MN(t,e){var r=t[0],n=t[1],s=t[2],a=t[3];r=ti(r,n,s,a,e[0],7,-680876936),a=ti(a,r,n,s,e[1],12,-389564586),s=ti(s,a,r,n,e[2],17,606105819),n=ti(n,s,a,r,e[3],22,-1044525330),r=ti(r,n,s,a,e[4],7,-176418897),a=ti(a,r,n,s,e[5],12,1200080426),s=ti(s,a,r,n,e[6],17,-1473231341),n=ti(n,s,a,r,e[7],22,-45705983),r=ti(r,n,s,a,e[8],7,1770035416),a=ti(a,r,n,s,e[9],12,-1958414417),s=ti(s,a,r,n,e[10],17,-42063),n=ti(n,s,a,r,e[11],22,-1990404162),r=ti(r,n,s,a,e[12],7,1804603682),a=ti(a,r,n,s,e[13],12,-40341101),s=ti(s,a,r,n,e[14],17,-1502002290),r=ri(r,n=ti(n,s,a,r,e[15],22,1236535329),s,a,e[1],5,-165796510),a=ri(a,r,n,s,e[6],9,-1069501632),s=ri(s,a,r,n,e[11],14,643717713),n=ri(n,s,a,r,e[0],20,-373897302),r=ri(r,n,s,a,e[5],5,-701558691),a=ri(a,r,n,s,e[10],9,38016083),s=ri(s,a,r,n,e[15],14,-660478335),n=ri(n,s,a,r,e[4],20,-405537848),r=ri(r,n,s,a,e[9],5,568446438),a=ri(a,r,n,s,e[14],9,-1019803690),s=ri(s,a,r,n,e[3],14,-187363961),n=ri(n,s,a,r,e[8],20,1163531501),r=ri(r,n,s,a,e[13],5,-1444681467),a=ri(a,r,n,s,e[2],9,-51403784),s=ri(s,a,r,n,e[7],14,1735328473),r=ni(r,n=ri(n,s,a,r,e[12],20,-1926607734),s,a,e[5],4,-378558),a=ni(a,r,n,s,e[8],11,-2022574463),s=ni(s,a,r,n,e[11],16,1839030562),n=ni(n,s,a,r,e[14],23,-35309556),r=ni(r,n,s,a,e[1],4,-1530992060),a=ni(a,r,n,s,e[4],11,1272893353),s=ni(s,a,r,n,e[7],16,-155497632),n=ni(n,s,a,r,e[10],23,-1094730640),r=ni(r,n,s,a,e[13],4,681279174),a=ni(a,r,n,s,e[0],11,-358537222),s=ni(s,a,r,n,e[3],16,-722521979),n=ni(n,s,a,r,e[6],23,76029189),r=ni(r,n,s,a,e[9],4,-640364487),a=ni(a,r,n,s,e[12],11,-421815835),s=ni(s,a,r,n,e[15],16,530742520),r=si(r,n=ni(n,s,a,r,e[2],23,-995338651),s,a,e[0],6,-198630844),a=si(a,r,n,s,e[7],10,1126891415),s=si(s,a,r,n,e[14],15,-1416354905),n=si(n,s,a,r,e[5],21,-57434055),r=si(r,n,s,a,e[12],6,1700485571),a=si(a,r,n,s,e[3],10,-1894986606),s=si(s,a,r,n,e[10],15,-1051523),n=si(n,s,a,r,e[1],21,-2054922799),r=si(r,n,s,a,e[8],6,1873313359),a=si(a,r,n,s,e[15],10,-30611744),s=si(s,a,r,n,e[6],15,-1560198380),n=si(n,s,a,r,e[13],21,1309151649),r=si(r,n,s,a,e[4],6,-145523070),a=si(a,r,n,s,e[11],10,-1120210379),s=si(s,a,r,n,e[2],15,718787259),n=si(n,s,a,r,e[9],21,-343485551),t[0]=ku(r,t[0]),t[1]=ku(n,t[1]),t[2]=ku(s,t[2]),t[3]=ku(a,t[3])}function q2(t,e,r,n,s,a){return e=ku(ku(e,t),ku(n,a)),ku(e<<s|e>>>32-s,r)}function ti(t,e,r,n,s,a,o){return q2(e&r|~e&n,t,e,s,a,o)}function ri(t,e,r,n,s,a,o){return q2(e&n|r&~n,t,e,s,a,o)}function ni(t,e,r,n,s,a,o){return q2(e^r^n,t,e,s,a,o)}function si(t,e,r,n,s,a,o){return q2(r^(e|~n),t,e,s,a,o)}function MM(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)MN(n,Kie(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(MN(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,MN(n,s),n}function Kie(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var _j="0123456789abcdef".split("");function qie(t){for(var e="",r=0;r<4;r++)e+=_j[t>>8*r+4&15]+_j[t>>8*r&15];return e}function Gie(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function yE(t){return MM(t).map(Gie).join("")}var $ie=function(t){for(var e=0;e<t.length;e++)t[e]=qie(t[e]);return t.join("")}(MM("hello"))!="5d41402abc4b2a76b9719d911017c592";function ku(t,e){if($ie){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function bE(t,e){var r,n,s,a;if(t!==r){for(var o=(s=t,a=1+(256/t.length|0),new Array(a+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var A=0;for(c=0;c<256;c++){var u=l[c];A=(A+u+o.charCodeAt(c))%256,l[c]=l[A],l[A]=u}r=t,n=l}else l=n;var d=e.length,f=0,h=0,m="";for(c=0;c<d;c++)h=(h+(u=l[f=(f+1)%256]))%256,l[f]=l[h],l[h]=u,o=l[(l[f]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Ej={print:4,modify:8,copy:16,"annot-forms":32};function Kf(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(Ej.perm!==void 0)throw new Error("Invalid permission: "+l);s+=Ej[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^s)),this.encryptionKey=yE(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=bE(this.encryptionKey,this.padding)}function qf(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):t[n]}return e}function Bj(t){if(Sn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in e[r]){var o=e[r][a];try{o[0].apply(t,n)}catch(l){Sr.console&&Vn.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function zg(t){if(!(this instanceof zg))return new zg(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function QM(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Cu(t,e,r,n,s){if(!(this instanceof Cu))return new Cu(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,QM.call(this,n,s)}function th(t,e,r,n,s){if(!(this instanceof th))return new th(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,QM.call(this,n,s)}function sr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],o=[],l=1,c=16,A="S",u=null;Sn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,a=t.compress||t.compressPdf||a,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),A=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var d=t.putOnlyUsedFonts||!1,f={},h={internal:{},__private__:{}};h.__private__.PubSub=Bj;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(L){m=L};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var g=h.__private__.getPageFormat=function(L){return x[L]};s=s||"a4";var y="compat",b="advanced",F=y;function P(){this.saveGraphicsState(),J(new et(_e,0,0,-_e,0,Qo()*_e).toString()+" cm"),this.setFontSize(this.getFontSize()/_e),A="n",F=b}function R(){this.restoreGraphicsState(),A="S",F=y}var _=h.__private__.combineFontStyleAndFontWeight=function(L,ce){if(L=="bold"&&ce=="normal"||L=="bold"&&ce==400||L=="normal"&&ce=="italic"||L=="bold"&&ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ce&&(L=ce==400||ce==="normal"?L==="italic"?"italic":"normal":ce!=700&&ce!=="bold"||L!=="normal"?(ce==700?"bold":ce)+""+L:"bold"),L};h.advancedAPI=function(L){var ce=F===y;return ce&&P.call(this),typeof L!="function"||(L(this),ce&&R.call(this)),this},h.compatAPI=function(L){var ce=F===b;return ce&&R.call(this),typeof L!="function"||(L(this),ce&&P.call(this)),this},h.isAdvancedAPI=function(){return F===b};var B,E=function(L){if(F!==b)throw new Error(L+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},M=h.roundToPrecision=h.__private__.roundToPrecision=function(L,ce){var He=e||ce;if(isNaN(L)||isNaN(He))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return L.toFixed(He).replace(/0+$/,"")};B=h.hpf=h.__private__.hpf=typeof c=="number"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return M(L,c)}:c==="smart"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return M(L,L>-1&&L<1?16:5)}:function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return M(L,16)};var k=h.f2=h.__private__.f2=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f2");return M(L,2)},T=h.__private__.f3=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f3");return M(L,3)},U=h.scale=h.__private__.scale=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.scale");return F===y?L*_e:F===b?L:void 0},Z=function(L){return U(function(ce){return F===y?Qo()-ce:F===b?ce:void 0}(L))};h.__private__.setPrecision=h.setPrecision=function(L){typeof parseInt(L,10)=="number"&&(e=parseInt(L,10))};var pe,ae="00000000000000000000000000000000",he=h.__private__.getFileId=function(){return ae},de=h.__private__.setFileId=function(L){return ae=L!==void 0&&/^[a-fA-F0-9]{32}$/.test(L)?L.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Ln=new Kf(u.userPermissions,u.userPassword,u.ownerPassword,ae)),ae};h.setFileId=function(L){return de(L),this},h.getFileId=function(){return he()};var re=h.__private__.convertDateToPDFDate=function(L){var ce=L.getTimezoneOffset(),He=ce<0?"+":"-",rt=Math.floor(Math.abs(ce/60)),dt=Math.abs(ce%60),Bt=[He,V(rt),"'",V(dt),"'"].join("");return["D:",L.getFullYear(),V(L.getMonth()+1),V(L.getDate()),V(L.getHours()),V(L.getMinutes()),V(L.getSeconds()),Bt].join("")},xe=h.__private__.convertPDFDateToDate=function(L){var ce=parseInt(L.substr(2,4),10),He=parseInt(L.substr(6,2),10)-1,rt=parseInt(L.substr(8,2),10),dt=parseInt(L.substr(10,2),10),Bt=parseInt(L.substr(12,2),10),jt=parseInt(L.substr(14,2),10);return new Date(ce,He,rt,dt,Bt,jt,0)},Ce=h.__private__.setCreationDate=function(L){var ce;if(L===void 0&&(L=new Date),L instanceof Date)ce=re(L);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(L))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ce=L}return pe=ce},S=h.__private__.getCreationDate=function(L){var ce=pe;return L==="jsDate"&&(ce=xe(pe)),ce};h.setCreationDate=function(L){return Ce(L),this},h.getCreationDate=function(L){return S(L)};var I,V=h.__private__.padd2=function(L){return("0"+parseInt(L)).slice(-2)},j=h.__private__.padd2Hex=function(L){return("00"+(L=L.toString())).substr(L.length)},O=0,W=[],D=[],Y=0,se=[],ve=[],z=!1,Oe=D;h.__private__.setCustomOutputDestination=function(L){z=!0,Oe=L};var te=function(L){z||(Oe=L)};h.__private__.resetCustomOutputDestination=function(){z=!1,Oe=D};var J=h.__private__.out=function(L){return L=L.toString(),Y+=L.length+1,Oe.push(L),Oe},q=h.__private__.write=function(L){return J(arguments.length===1?L.toString():Array.prototype.join.call(arguments," "))},ie=h.__private__.getArrayBuffer=function(L){for(var ce=L.length,He=new ArrayBuffer(ce),rt=new Uint8Array(He);ce--;)rt[ce]=L.charCodeAt(ce);return He},fe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return fe};var Ie=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(L){return Ie=F===b?L/_e:L,this};var Ve,ze=h.__private__.getFontSize=h.getFontSize=function(){return F===y?Ie:Ie*_e},Ye=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(L){return Ye=L,this},h.__private__.getR2L=h.getR2L=function(){return Ye};var ct,st=h.__private__.setZoomMode=function(L){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(L))Ve=L;else if(isNaN(L)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(L)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+L+'" is not recognized.');Ve=L}else Ve=parseInt(L,10)};h.__private__.getZoomMode=function(){return Ve};var ft,nt=h.__private__.setPageMode=function(L){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(L)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+L+'" is not recognized.');ct=L};h.__private__.getPageMode=function(){return ct};var De=h.__private__.setLayoutMode=function(L){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(L)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+L+'" is not recognized.');ft=L};h.__private__.getLayoutMode=function(){return ft},h.__private__.setDisplayMode=h.setDisplayMode=function(L,ce,He){return st(L),De(ce),nt(He),this};var Fe={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(L){if(Object.keys(Fe).indexOf(L)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Fe[L]},h.__private__.getDocumentProperties=function(){return Fe},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(L){for(var ce in Fe)Fe.hasOwnProperty(ce)&&L[ce]&&(Fe[ce]=L[ce]);return this},h.__private__.setDocumentProperty=function(L,ce){if(Object.keys(Fe).indexOf(L)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Fe[L]=ce};var Ge,_e,G,Ne,Ue,$e={},ge={},Be=[],Qe={},Te={},We={},at={},bt=null,ot=0,wt=[],Lt=new Bj(h),Ar=t.hotfixes||[],ir={},xr={},er=[],et=function L(ce,He,rt,dt,Bt,jt){if(!(this instanceof L))return new L(ce,He,rt,dt,Bt,jt);isNaN(ce)&&(ce=1),isNaN(He)&&(He=0),isNaN(rt)&&(rt=0),isNaN(dt)&&(dt=1),isNaN(Bt)&&(Bt=0),isNaN(jt)&&(jt=0),this._matrix=[ce,He,rt,dt,Bt,jt]};Object.defineProperty(et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(et.prototype,"a",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(et.prototype,"b",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(et.prototype,"c",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(et.prototype,"d",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(et.prototype,"e",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(et.prototype,"f",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),et.prototype.join=function(L){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(L)},et.prototype.multiply=function(L){var ce=L.sx*this.sx+L.shy*this.shx,He=L.sx*this.shy+L.shy*this.sy,rt=L.shx*this.sx+L.sy*this.shx,dt=L.shx*this.shy+L.sy*this.sy,Bt=L.tx*this.sx+L.ty*this.shx+this.tx,jt=L.tx*this.shy+L.ty*this.sy+this.ty;return new et(ce,He,rt,dt,Bt,jt)},et.prototype.decompose=function(){var L=this.sx,ce=this.shy,He=this.shx,rt=this.sy,dt=this.tx,Bt=this.ty,jt=Math.sqrt(L*L+ce*ce),nr=(L/=jt)*He+(ce/=jt)*rt;He-=L*nr,rt-=ce*nr;var dr=Math.sqrt(He*He+rt*rt);return nr/=dr,L*(rt/=dr)<ce*(He/=dr)&&(L=-L,ce=-ce,nr=-nr,jt=-jt),{scale:new et(jt,0,0,dr,0,0),translate:new et(1,0,0,1,dt,Bt),rotate:new et(L,ce,-ce,L,0,0),skew:new et(1,0,nr,1,0,0)}},et.prototype.toString=function(L){return this.join(" ")},et.prototype.inversed=function(){var L=this.sx,ce=this.shy,He=this.shx,rt=this.sy,dt=this.tx,Bt=this.ty,jt=1/(L*rt-ce*He),nr=rt*jt,dr=-ce*jt,br=-He*jt,Fr=L*jt;return new et(nr,dr,br,Fr,-nr*dt-br*Bt,-dr*dt-Fr*Bt)},et.prototype.applyToPoint=function(L){var ce=L.x*this.sx+L.y*this.shx+this.tx,He=L.x*this.shy+L.y*this.sy+this.ty;return new Oo(ce,He)},et.prototype.applyToRectangle=function(L){var ce=this.applyToPoint(L),He=this.applyToPoint(new Oo(L.x+L.w,L.y+L.h));return new OA(ce.x,ce.y,He.x-ce.x,He.y-ce.y)},et.prototype.clone=function(){var L=this.sx,ce=this.shy,He=this.shx,rt=this.sy,dt=this.tx,Bt=this.ty;return new et(L,ce,He,rt,dt,Bt)},h.Matrix=et;var gt=h.matrixMult=function(L,ce){return ce.multiply(L)},Pt=new et(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Pt;var Ft=function(L,ce){if(!Te[L]){var He=(ce instanceof Cu?"Sh":"P")+(Object.keys(Qe).length+1).toString(10);ce.id=He,Te[L]=He,Qe[He]=ce,Lt.publish("addPattern",ce)}};h.ShadingPattern=Cu,h.TilingPattern=th,h.addShadingPattern=function(L,ce){return E("addShadingPattern()"),Ft(L,ce),this},h.beginTilingPattern=function(L){E("beginTilingPattern()"),Zl(L.boundingBox[0],L.boundingBox[1],L.boundingBox[2]-L.boundingBox[0],L.boundingBox[3]-L.boundingBox[1],L.matrix)},h.endTilingPattern=function(L,ce){E("endTilingPattern()"),ce.stream=ve[I].join(`
`),Ft(L,ce),Lt.publish("endTilingPattern",ce),er.pop().restore()};var Tt,Xt=h.__private__.newObject=function(){var L=Vt();return oe(L,!0),L},Vt=h.__private__.newObjectDeferred=function(){return O++,W[O]=function(){return Y},O},oe=function(L,ce){return ce=typeof ce=="boolean"&&ce,W[L]=Y,ce&&J(L+" 0 obj"),L},ne=h.__private__.newAdditionalObject=function(){var L={objId:Vt(),content:""};return se.push(L),L},ue=Vt(),K=Vt(),le=h.__private__.decodeColorString=function(L){var ce=L.split(" ");if(ce.length!==2||ce[1]!=="g"&&ce[1]!=="G")ce.length!==5||ce[4]!=="k"&&ce[4]!=="K"||(ce=[(1-ce[0])*(1-ce[3]),(1-ce[1])*(1-ce[3]),(1-ce[2])*(1-ce[3]),"r"]);else{var He=parseFloat(ce[0]);ce=[He,He,He,"r"]}for(var rt="#",dt=0;dt<3;dt++)rt+=("0"+Math.floor(255*parseFloat(ce[dt])).toString(16)).slice(-2);return rt},me=h.__private__.encodeColorString=function(L){var ce;typeof L=="string"&&(L={ch1:L});var He=L.ch1,rt=L.ch2,dt=L.ch3,Bt=L.ch4,jt=L.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof He=="string"&&He.charAt(0)!=="#"){var nr=new OM(He);if(nr.ok)He=nr.toHex();else if(!/^\d*\.?\d*$/.test(He))throw new Error('Invalid color "'+He+'" passed to jsPDF.encodeColorString.')}if(typeof He=="string"&&/^#[0-9A-Fa-f]{3}$/.test(He)&&(He="#"+He[1]+He[1]+He[2]+He[2]+He[3]+He[3]),typeof He=="string"&&/^#[0-9A-Fa-f]{6}$/.test(He)){var dr=parseInt(He.substr(1),16);He=dr>>16&255,rt=dr>>8&255,dt=255&dr}if(rt===void 0||Bt===void 0&&He===rt&&rt===dt)ce=typeof He=="string"?He+" "+jt[0]:L.precision===2?k(He/255)+" "+jt[0]:T(He/255)+" "+jt[0];else if(Bt===void 0||Sn(Bt)==="object"){if(Bt&&!isNaN(Bt.a)&&Bt.a===0)return["1.","1.","1.",jt[1]].join(" ");ce=typeof He=="string"?[He,rt,dt,jt[1]].join(" "):L.precision===2?[k(He/255),k(rt/255),k(dt/255),jt[1]].join(" "):[T(He/255),T(rt/255),T(dt/255),jt[1]].join(" ")}else ce=typeof He=="string"?[He,rt,dt,Bt,jt[2]].join(" "):L.precision===2?[k(He),k(rt),k(dt),k(Bt),jt[2]].join(" "):[T(He),T(rt),T(dt),T(Bt),jt[2]].join(" ");return ce},Re=h.__private__.getFilters=function(){return o},Ee=h.__private__.putStream=function(L){var ce=(L=L||{}).data||"",He=L.filters||Re(),rt=L.alreadyAppliedFilters||[],dt=L.addLength1||!1,Bt=ce.length,jt=L.objectId,nr=function(Ns){return Ns};if(u!==null&&jt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(nr=Ln.encryptor(jt,0));var dr={};He===!0&&(He=["FlateEncode"]);var br=L.additionalKeyValues||[],Fr=(dr=sr.API.processDataByFilters!==void 0?sr.API.processDataByFilters(ce,He):{data:ce,reverseChain:[]}).reverseChain+(Array.isArray(rt)?rt.join(" "):rt.toString());if(dr.data.length!==0&&(br.push({key:"Length",value:dr.data.length}),dt===!0&&br.push({key:"Length1",value:Bt})),Fr.length!=0)if(Fr.split("/").length-1==1)br.push({key:"Filter",value:Fr});else{br.push({key:"Filter",value:"["+Fr+"]"});for(var Yr=0;Yr<br.length;Yr+=1)if(br[Yr].key==="DecodeParms"){for(var pn=[],hs=0;hs<dr.reverseChain.split("/").length-1;hs+=1)pn.push("null");pn.push(br[Yr].value),br[Yr].value="["+pn.join(" ")+"]"}}J("<<");for(var vn=0;vn<br.length;vn++)J("/"+br[vn].key+" "+br[vn].value);J(">>"),dr.data.length!==0&&(J("stream"),J(nr(dr.data)),J("endstream"))},ye=h.__private__.putPage=function(L){var ce=L.number,He=L.data,rt=L.objId,dt=L.contentsObjId;oe(rt,!0),J("<</Type /Page"),J("/Parent "+L.rootDictionaryObjId+" 0 R"),J("/Resources "+L.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(B(L.mediaBox.bottomLeftX))+" "+parseFloat(B(L.mediaBox.bottomLeftY))+" "+B(L.mediaBox.topRightX)+" "+B(L.mediaBox.topRightY)+"]"),L.cropBox!==null&&J("/CropBox ["+B(L.cropBox.bottomLeftX)+" "+B(L.cropBox.bottomLeftY)+" "+B(L.cropBox.topRightX)+" "+B(L.cropBox.topRightY)+"]"),L.bleedBox!==null&&J("/BleedBox ["+B(L.bleedBox.bottomLeftX)+" "+B(L.bleedBox.bottomLeftY)+" "+B(L.bleedBox.topRightX)+" "+B(L.bleedBox.topRightY)+"]"),L.trimBox!==null&&J("/TrimBox ["+B(L.trimBox.bottomLeftX)+" "+B(L.trimBox.bottomLeftY)+" "+B(L.trimBox.topRightX)+" "+B(L.trimBox.topRightY)+"]"),L.artBox!==null&&J("/ArtBox ["+B(L.artBox.bottomLeftX)+" "+B(L.artBox.bottomLeftY)+" "+B(L.artBox.topRightX)+" "+B(L.artBox.topRightY)+"]"),typeof L.userUnit=="number"&&L.userUnit!==1&&J("/UserUnit "+L.userUnit),Lt.publish("putPage",{objId:rt,pageContext:wt[ce],pageNumber:ce,page:He}),J("/Contents "+dt+" 0 R"),J(">>"),J("endobj");var Bt=He.join(`
`);return F===b&&(Bt+=`
Q`),oe(dt,!0),Ee({data:Bt,filters:Re(),objectId:dt}),J("endobj"),rt},Me=h.__private__.putPages=function(){var L,ce,He=[];for(L=1;L<=ot;L++)wt[L].objId=Vt(),wt[L].contentsObjId=Vt();for(L=1;L<=ot;L++)He.push(ye({number:L,data:ve[L],objId:wt[L].objId,contentsObjId:wt[L].contentsObjId,mediaBox:wt[L].mediaBox,cropBox:wt[L].cropBox,bleedBox:wt[L].bleedBox,trimBox:wt[L].trimBox,artBox:wt[L].artBox,userUnit:wt[L].userUnit,rootDictionaryObjId:ue,resourceDictionaryObjId:K}));oe(ue,!0),J("<</Type /Pages");var rt="/Kids [";for(ce=0;ce<ot;ce++)rt+=He[ce]+" 0 R ";J(rt+"]"),J("/Count "+ot),J(">>"),J("endobj"),Lt.publish("postPutPages")},Le=function(L){Lt.publish("putFont",{font:L,out:J,newObject:Xt,putStream:Ee}),L.isAlreadyPutted!==!0&&(L.objectNumber=Xt(),J("<<"),J("/Type /Font"),J("/BaseFont /"+qf(L.postScriptName)),J("/Subtype /Type1"),typeof L.encoding=="string"&&J("/Encoding /"+L.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},Je=function(L){L.objectNumber=Xt();var ce=[];ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Form"}),ce.push({key:"BBox",value:"["+[B(L.x),B(L.y),B(L.x+L.width),B(L.y+L.height)].join(" ")+"]"}),ce.push({key:"Matrix",value:"["+L.matrix.toString()+"]"});var He=L.pages[1].join(`
`);Ee({data:He,additionalKeyValues:ce,objectId:L.objectNumber}),J("endobj")},tt=function(L,ce){ce||(ce=21);var He=Xt(),rt=function(jt,nr){var dr,br=[],Fr=1/(nr-1);for(dr=0;dr<1;dr+=Fr)br.push(dr);if(br.push(1),jt[0].offset!=0){var Yr={offset:0,color:jt[0].color};jt.unshift(Yr)}if(jt[jt.length-1].offset!=1){var pn={offset:1,color:jt[jt.length-1].color};jt.push(pn)}for(var hs="",vn=0,Ns=0;Ns<br.length;Ns++){for(dr=br[Ns];dr>jt[vn+1].offset;)vn++;var fs=jt[vn].offset,Cs=(dr-fs)/(jt[vn+1].offset-fs),ms=jt[vn].color,Qi=jt[vn+1].color;hs+=j(Math.round((1-Cs)*ms[0]+Cs*Qi[0]).toString(16))+j(Math.round((1-Cs)*ms[1]+Cs*Qi[1]).toString(16))+j(Math.round((1-Cs)*ms[2]+Cs*Qi[2]).toString(16))}return hs.trim()}(L.colors,ce),dt=[];dt.push({key:"FunctionType",value:"0"}),dt.push({key:"Domain",value:"[0.0 1.0]"}),dt.push({key:"Size",value:"["+ce+"]"}),dt.push({key:"BitsPerSample",value:"8"}),dt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),dt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ee({data:rt,additionalKeyValues:dt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:He}),J("endobj"),L.objectNumber=Xt(),J("<< /ShadingType "+L.type),J("/ColorSpace /DeviceRGB");var Bt="/Coords ["+B(parseFloat(L.coords[0]))+" "+B(parseFloat(L.coords[1]))+" ";L.type===2?Bt+=B(parseFloat(L.coords[2]))+" "+B(parseFloat(L.coords[3])):Bt+=B(parseFloat(L.coords[2]))+" "+B(parseFloat(L.coords[3]))+" "+B(parseFloat(L.coords[4]))+" "+B(parseFloat(L.coords[5])),J(Bt+="]"),L.matrix&&J("/Matrix ["+L.matrix.toString()+"]"),J("/Function "+He+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},Xe=function(L,ce){var He=Vt(),rt=Xt();ce.push({resourcesOid:He,objectOid:rt}),L.objectNumber=rt;var dt=[];dt.push({key:"Type",value:"/Pattern"}),dt.push({key:"PatternType",value:"1"}),dt.push({key:"PaintType",value:"1"}),dt.push({key:"TilingType",value:"1"}),dt.push({key:"BBox",value:"["+L.boundingBox.map(B).join(" ")+"]"}),dt.push({key:"XStep",value:B(L.xStep)}),dt.push({key:"YStep",value:B(L.yStep)}),dt.push({key:"Resources",value:He+" 0 R"}),L.matrix&&dt.push({key:"Matrix",value:"["+L.matrix.toString()+"]"}),Ee({data:L.stream,additionalKeyValues:dt,objectId:L.objectNumber}),J("endobj")},Ze=function(L){for(var ce in L.objectNumber=Xt(),J("<<"),L)switch(ce){case"opacity":J("/ca "+k(L[ce]));break;case"stroke-opacity":J("/CA "+k(L[ce]))}J(">>"),J("endobj")},ut=function(L){oe(L.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ce in J("/Font <<"),$e)$e.hasOwnProperty(ce)&&(d===!1||d===!0&&f.hasOwnProperty(ce))&&J("/"+ce+" "+$e[ce].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(Qe).length>0){for(var ce in J("/Shading <<"),Qe)Qe.hasOwnProperty(ce)&&Qe[ce]instanceof Cu&&Qe[ce].objectNumber>=0&&J("/"+ce+" "+Qe[ce].objectNumber+" 0 R");Lt.publish("putShadingPatternDict"),J(">>")}}(),function(ce){if(Object.keys(Qe).length>0){for(var He in J("/Pattern <<"),Qe)Qe.hasOwnProperty(He)&&Qe[He]instanceof h.TilingPattern&&Qe[He].objectNumber>=0&&Qe[He].objectNumber<ce&&J("/"+He+" "+Qe[He].objectNumber+" 0 R");Lt.publish("putTilingPatternDict"),J(">>")}}(L.objectOid),function(){if(Object.keys(We).length>0){var ce;for(ce in J("/ExtGState <<"),We)We.hasOwnProperty(ce)&&We[ce].objectNumber>=0&&J("/"+ce+" "+We[ce].objectNumber+" 0 R");Lt.publish("putGStateDict"),J(">>")}}(),function(){for(var ce in J("/XObject <<"),ir)ir.hasOwnProperty(ce)&&ir[ce].objectNumber>=0&&J("/"+ce+" "+ir[ce].objectNumber+" 0 R");Lt.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},Ht=function(L){ge[L.fontName]=ge[L.fontName]||{},ge[L.fontName][L.fontStyle]=L.id},wr=function(L,ce,He,rt,dt){var Bt={id:"F"+(Object.keys($e).length+1).toString(10),postScriptName:L,fontName:ce,fontStyle:He,encoding:rt,isStandardFont:dt||!1,metadata:{}};return Lt.publish("addFont",{font:Bt,instance:this}),$e[Bt.id]=Bt,Ht(Bt),Bt.id},ur=h.__private__.pdfEscape=h.pdfEscape=function(L,ce){return function(He,rt){var dt,Bt,jt,nr,dr,br,Fr,Yr,pn;if(jt=(rt=rt||{}).sourceEncoding||"Unicode",dr=rt.outputEncoding,(rt.autoencode||dr)&&$e[Ge].metadata&&$e[Ge].metadata[jt]&&$e[Ge].metadata[jt].encoding&&(nr=$e[Ge].metadata[jt].encoding,!dr&&$e[Ge].encoding&&(dr=$e[Ge].encoding),!dr&&nr.codePages&&(dr=nr.codePages[0]),typeof dr=="string"&&(dr=nr[dr]),dr)){for(Fr=!1,br=[],dt=0,Bt=He.length;dt<Bt;dt++)(Yr=dr[He.charCodeAt(dt)])?br.push(String.fromCharCode(Yr)):br.push(He[dt]),br[dt].charCodeAt(0)>>8&&(Fr=!0);He=br.join("")}for(dt=He.length;Fr===void 0&&dt!==0;)He.charCodeAt(dt-1)>>8&&(Fr=!0),dt--;if(!Fr)return He;for(br=rt.noBOM?[]:[254,255],dt=0,Bt=He.length;dt<Bt;dt++){if((pn=(Yr=He.charCodeAt(dt))>>8)>>8)throw new Error("Character at position "+dt+" of string '"+He+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");br.push(pn),br.push(Yr-(pn<<8))}return String.fromCharCode.apply(void 0,br)}(L,ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kr=h.__private__.beginPage=function(L){ve[++ot]=[],wt[ot]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(L[0]),topRightY:Number(L[1])}},Ui(ot),te(ve[I])},$s=function(L,ce){var He,rt,dt;switch(r=ce||r,typeof L=="string"&&(He=g(L.toLowerCase()),Array.isArray(He)&&(rt=He[0],dt=He[1])),Array.isArray(L)&&(rt=L[0]*_e,dt=L[1]*_e),isNaN(rt)&&(rt=s[0],dt=s[1]),(rt>14400||dt>14400)&&(Vn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),rt=Math.min(14400,rt),dt=Math.min(14400,dt)),s=[rt,dt],r.substr(0,1)){case"l":dt>rt&&(s=[dt,rt]);break;case"p":rt>dt&&(s=[dt,rt])}Kr(s),yr(DA),J(xl),Tn!==0&&J(Tn+" J"),Cd!==0&&J(Cd+" j"),Lt.publish("addPage",{pageNumber:ot})},vi=function(L){L>0&&L<=ot&&(ve.splice(L,1),wt.splice(L,1),ot--,I>ot&&(I=ot),this.setPage(I))},Ui=function(L){L>0&&L<=ot&&(I=L)},ga=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ve.length-1},no=function(L,ce,He){var rt,dt=void 0;return He=He||{},L=L!==void 0?L:$e[Ge].fontName,ce=ce!==void 0?ce:$e[Ge].fontStyle,rt=L.toLowerCase(),ge[rt]!==void 0&&ge[rt][ce]!==void 0?dt=ge[rt][ce]:ge[L]!==void 0&&ge[L][ce]!==void 0?dt=ge[L][ce]:He.disableWarning===!1&&Vn.warn("Unable to look up font label for font '"+L+"', '"+ce+"'. Refer to getFontList() for available fonts."),dt||He.noFallback||(dt=ge.times[ce])==null&&(dt=ge.times.normal),dt},Dn=h.__private__.putInfo=function(){var L=Xt(),ce=function(rt){return rt};for(var He in u!==null&&(ce=Ln.encryptor(L,0)),J("<<"),J("/Producer ("+ur(ce("jsPDF "+sr.version))+")"),Fe)Fe.hasOwnProperty(He)&&Fe[He]&&J("/"+He.substr(0,1).toUpperCase()+He.substr(1)+" ("+ur(ce(Fe[He]))+")");J("/CreationDate ("+ur(ce(pe))+")"),J(">>"),J("endobj")},Oi=h.__private__.putCatalog=function(L){var ce=(L=L||{}).rootDictionaryObjId||ue;switch(Xt(),J("<<"),J("/Type /Catalog"),J("/Pages "+ce+" 0 R"),Ve||(Ve="fullwidth"),Ve){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var He=""+Ve;He.substr(He.length-1)==="%"&&(Ve=parseInt(Ve)/100),typeof Ve=="number"&&J("/OpenAction [3 0 R /XYZ null null "+k(Ve)+"]")}switch(ft||(ft="continuous"),ft){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}ct&&J("/PageMode /"+ct),Lt.publish("putCatalog"),J(">>"),J("endobj")},rf=h.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(O+1)),J("/Root "+O+" 0 R"),J("/Info "+(O-1)+" 0 R"),u!==null&&J("/Encrypt "+Ln.oid+" 0 R"),J("/ID [ <"+ae+"> <"+ae+"> ]"),J(">>")},ds=h.__private__.putHeader=function(){J("%PDF-"+m),J("%")},nf=h.__private__.putXRef=function(){var L="0000000000";J("xref"),J("0 "+(O+1)),J("0000000000 65535 f ");for(var ce=1;ce<=O;ce++)typeof W[ce]=="function"?J((L+W[ce]()).slice(-10)+" 00000 n "):W[ce]!==void 0?J((L+W[ce]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},Ro=h.__private__.buildDocument=function(){var L;O=0,Y=0,D=[],W=[],se=[],ue=Vt(),K=Vt(),te(D),Lt.publish("buildDocument"),ds(),Me(),function(){Lt.publish("putAdditionalObjects");for(var He=0;He<se.length;He++){var rt=se[He];oe(rt.objId,!0),J(rt.content),J("endobj")}Lt.publish("postPutAdditionalObjects")}(),L=[],function(){for(var He in $e)$e.hasOwnProperty(He)&&(d===!1||d===!0&&f.hasOwnProperty(He))&&Le($e[He])}(),function(){var He;for(He in We)We.hasOwnProperty(He)&&Ze(We[He])}(),function(){for(var He in ir)ir.hasOwnProperty(He)&&Je(ir[He])}(),function(He){var rt;for(rt in Qe)Qe.hasOwnProperty(rt)&&(Qe[rt]instanceof Cu?tt(Qe[rt]):Qe[rt]instanceof th&&Xe(Qe[rt],He))}(L),Lt.publish("putResources"),L.forEach(ut),ut({resourcesOid:K,objectOid:Number.MAX_SAFE_INTEGER}),Lt.publish("postPutResources"),u!==null&&(Ln.oid=Xt(),J("<<"),J("/Filter /Standard"),J("/V "+Ln.v),J("/R "+Ln.r),J("/U <"+Ln.toHexString(Ln.U)+">"),J("/O <"+Ln.toHexString(Ln.O)+">"),J("/P "+Ln.P),J(">>"),J("endobj")),Dn(),Oi();var ce=Y;return nf(),rf(),J("startxref"),J(""+ce),J("%%EOF"),te(ve[I]),D.join(`
`)},jc=h.__private__.getBlob=function(L){return new Blob([ie(L)],{type:"application/pdf"})},yd=h.output=h.__private__.output=(Tt=function(L,ce){switch(typeof(ce=ce||{})=="string"?ce={filename:ce}:ce.filename=ce.filename||"generated.pdf",L){case void 0:return Ro();case"save":h.save(ce.filename);break;case"arraybuffer":return ie(Ro());case"blob":return jc(Ro());case"bloburi":case"bloburl":if(Sr.URL!==void 0&&typeof Sr.URL.createObjectURL=="function")return Sr.URL&&Sr.URL.createObjectURL(jc(Ro()))||void 0;Vn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var He="",rt=Ro();try{He=Cj(rt)}catch{He=Cj(unescape(encodeURIComponent(rt)))}return"data:application/pdf;filename="+ce.filename+";base64,"+He;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Sr)==="[object Window]"){var dt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Bt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ce.pdfObjectUrl&&(dt=ce.pdfObjectUrl,Bt="");var jt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+dt+'"'+Bt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ce)+");<\/script></body></html>",nr=Sr.open();return nr!==null&&nr.document.write(jt),nr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Sr)==="[object Window]"){var dr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ce.filename+'" width="500px" height="400px" /></body></html>',br=Sr.open();if(br!==null){br.document.write(dr);var Fr=this;br.document.documentElement.querySelector("#pdfViewer").onload=function(){br.document.title=ce.filename,br.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Fr.output("bloburl"))}}return br}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Sr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Yr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ce)+'"></iframe></body></html>',pn=Sr.open();if(pn!==null&&(pn.document.write(Yr),pn.document.title=ce.filename),pn||typeof safari>"u")return pn;break;case"datauri":case"dataurl":return Sr.document.location.href=this.output("datauristring",ce);default:return null}},Tt.foo=function(){try{return Tt.apply(this,arguments)}catch(He){var L=He.stack||"";~L.indexOf(" at ")&&(L=L.split(" at ")[1]);var ce="Error in function "+L.split(`
`)[0].split("<")[0]+": "+He.message;if(!Sr.console)throw new Error(ce);Sr.console.error(ce,He),Sr.alert&&alert(ce)}},Tt.foo.bar=Tt,Tt.foo),Mi=function(L){return Array.isArray(Ar)===!0&&Ar.indexOf(L)>-1};switch(n){case"pt":_e=1;break;case"mm":_e=72/25.4;break;case"cm":_e=72/2.54;break;case"in":_e=72;break;case"px":_e=Mi("px_scaling")==1?.75:96/72;break;case"pc":case"em":_e=12;break;case"ex":_e=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);_e=n}var Ln=null;Ce(),de();var ea=h.__private__.getPageInfo=h.getPageInfo=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:wt[L].objId,pageNumber:L,pageContext:wt[L]}},Pc=h.__private__.getPageInfoByObjId=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ce in wt)if(wt[ce].objId===L)break;return ea(ce)},RA=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:wt[I].objId,pageNumber:I,pageContext:wt[I]}};h.addPage=function(){return $s.apply(this,arguments),this},h.setPage=function(){return Ui.apply(this,arguments),te.call(this,ve[I]),this},h.insertPage=function(L){return this.addPage(),this.movePage(I,L),this},h.movePage=function(L,ce){var He,rt;if(L>ce){He=ve[L],rt=wt[L];for(var dt=L;dt>ce;dt--)ve[dt]=ve[dt-1],wt[dt]=wt[dt-1];ve[ce]=He,wt[ce]=rt,this.setPage(ce)}else if(L<ce){He=ve[L],rt=wt[L];for(var Bt=L;Bt<ce;Bt++)ve[Bt]=ve[Bt+1],wt[Bt]=wt[Bt+1];ve[ce]=He,wt[ce]=rt,this.setPage(ce)}return this},h.deletePage=function(){return vi.apply(this,arguments),this},h.__private__.text=h.text=function(L,ce,He,rt,dt){var Bt,jt,nr,dr,br,Fr,Yr,pn,hs,vn=(rt=rt||{}).scope||this;if(typeof L=="number"&&typeof ce=="number"&&(typeof He=="string"||Array.isArray(He))){var Ns=He;He=ce,ce=L,L=Ns}if(arguments[3]instanceof et==0?(nr=arguments[4],dr=arguments[5],Sn(Yr=arguments[3])==="object"&&Yr!==null||(typeof nr=="string"&&(dr=nr,nr=null),typeof Yr=="string"&&(dr=Yr,Yr=null),typeof Yr=="number"&&(nr=Yr,Yr=null),rt={flags:Yr,angle:nr,align:dr})):(E("The transform parameter of text() with a Matrix value"),hs=dt),isNaN(ce)||isNaN(He)||L==null)throw new Error("Invalid arguments passed to jsPDF.text");if(L.length===0)return vn;var fs,Cs="",ms=typeof rt.lineHeightFactor=="number"?rt.lineHeightFactor:Yl,Qi=vn.internal.scaleFactor;function Vo(gn){return gn=gn.split("	").join(Array(rt.TabLen||9).join(" ")),ur(gn,Yr)}function Ho(gn){for(var Un,Ps=gn.concat(),ta=[],Mc=Ps.length;Mc--;)typeof(Un=Ps.shift())=="string"?ta.push(Un):Array.isArray(gn)&&(Un.length===1||Un[1]===void 0&&Un[2]===void 0)?ta.push(Un[0]):ta.push([Un[0],Un[1],Un[2]]);return ta}function w(gn,Un){var Ps;if(typeof gn=="string")Ps=Un(gn)[0];else if(Array.isArray(gn)){for(var ta,Mc,_m=gn.concat(),df=[],$x=_m.length;$x--;)typeof(ta=_m.shift())=="string"?df.push(Un(ta)[0]):Array.isArray(ta)&&typeof ta[0]=="string"&&(Mc=Un(ta[0],ta[1],ta[2]),df.push([Mc[0],Mc[1],Mc[2]]));Ps=df}return Ps}var H=!1,ee=!0;if(typeof L=="string")H=!0;else if(Array.isArray(L)){var ke=L.concat();jt=[];for(var ht,yt=ke.length;yt--;)(typeof(ht=ke.shift())!="string"||Array.isArray(ht)&&typeof ht[0]!="string")&&(ee=!1);H=ee}if(H===!1)throw new Error('Type of text must be string or Array. "'+L+'" is not recognized.');typeof L=="string"&&(L=L.match(/[\r?\n]/)?L.split(/\r\n|\r|\n/g):[L]);var Gt=Ie/vn.internal.scaleFactor,nn=Gt*(ms-1);switch(rt.baseline){case"bottom":He-=nn;break;case"top":He+=Gt-nn;break;case"hanging":He+=Gt-2*nn;break;case"middle":He+=Gt/2-nn}if((Fr=rt.maxWidth||0)>0&&(typeof L=="string"?L=vn.splitTextToSize(L,Fr):Object.prototype.toString.call(L)==="[object Array]"&&(L=L.reduce(function(gn,Un){return gn.concat(vn.splitTextToSize(Un,Fr))},[]))),Bt={text:L,x:ce,y:He,options:rt,mutex:{pdfEscape:ur,activeFontKey:Ge,fonts:$e,activeFontSize:Ie}},Lt.publish("preProcessText",Bt),L=Bt.text,nr=(rt=Bt.options).angle,hs instanceof et==0&&nr&&typeof nr=="number"){nr*=Math.PI/180,rt.rotationDirection===0&&(nr=-nr),F===b&&(nr=-nr);var ps=Math.cos(nr),qr=Math.sin(nr);hs=new et(ps,qr,-qr,ps,0,0)}else nr&&nr instanceof et&&(hs=nr);F!==b||hs||(hs=Pt),(br=rt.charSpace||Uo)!==void 0&&(Cs+=B(U(br))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(pn=rt.horizontalScale)!==void 0&&(Cs+=B(100*pn)+` Tz
`),rt.lang;var hn=-1,Hn=rt.renderingMode!==void 0?rt.renderingMode:rt.stroke,ao=vn.internal.getCurrentPageInfo().pageContext;switch(Hn){case 0:case!1:case"fill":hn=0;break;case 1:case!0:case"stroke":hn=1;break;case 2:case"fillThenStroke":hn=2;break;case 3:case"invisible":hn=3;break;case 4:case"fillAndAddForClipping":hn=4;break;case 5:case"strokeAndAddPathForClipping":hn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":hn=6;break;case 7:case"addToPathForClipping":hn=7}var Ja=ao.usedRenderingMode!==void 0?ao.usedRenderingMode:-1;hn!==-1?Cs+=hn+` Tr
`:Ja!==-1&&(Cs+=`0 Tr
`),hn!==-1&&(ao.usedRenderingMode=hn),dr=rt.align||"left";var Ta,vl=Ie*ms,xm=vn.internal.pageSize.getWidth(),vm=$e[Ge];br=rt.charSpace||Uo,Fr=rt.maxWidth||0,Yr=Object.assign({autoencode:!0,noBOM:!0},rt.flags);var QA=[],Bd=function(gn){return vn.getStringUnitWidth(gn,{font:vm,charSpace:br,fontSize:Ie,doKerning:!1})*Ie/Qi};if(Object.prototype.toString.call(L)==="[object Array]"){var io;jt=Ho(L),dr!=="left"&&(Ta=jt.map(Bd));var oo,VA=0;if(dr==="right"){ce-=Ta[0],L=[],yt=jt.length;for(var Oc=0;Oc<yt;Oc++)Oc===0?(oo=xa(ce),io=gl(He)):(oo=U(VA-Ta[Oc]),io=-vl),L.push([jt[Oc],oo,io]),VA=Ta[Oc]}else if(dr==="center"){ce-=Ta[0]/2,L=[],yt=jt.length;for(var HA=0;HA<yt;HA++)HA===0?(oo=xa(ce),io=gl(He)):(oo=U((VA-Ta[HA])/2),io=-vl),L.push([jt[HA],oo,io]),VA=Ta[HA]}else if(dr==="left"){L=[],yt=jt.length;for(var wm=0;wm<yt;wm++)L.push(jt[wm])}else if(dr==="justify"&&vm.encoding==="Identity-H"){L=[],yt=jt.length,Fr=Fr!==0?Fr:xm;for(var uf=0,js=0;js<yt;js++)if(io=js===0?gl(He):-vl,oo=js===0?xa(ce):uf,js<yt-1){var Gx=U((Fr-Ta[js])/(jt[js].split(" ").length-1)),tc=jt[js].split(" ");L.push([tc[0]+" ",oo,io]),uf=0;for(var rc=1;rc<tc.length;rc++){var ym=(Bd(tc[rc-1]+" "+tc[rc])-Bd(tc[rc]))*Qi+Gx;rc==tc.length-1?L.push([tc[rc],ym,0]):L.push([tc[rc]+" ",ym,0]),uf-=ym}}else L.push([jt[js],oo,io]);L.push(["",uf,0])}else{if(dr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(L=[],yt=jt.length,Fr=Fr!==0?Fr:xm,js=0;js<yt;js++){io=js===0?gl(He):-vl,oo=js===0?xa(ce):0;var bm=jt[js].split(" ").length-1,Nm=bm>0?(Fr-Ta[js])/bm:0;js<yt-1?QA.push(B(U(Nm))):QA.push(0),L.push([jt[js],oo,io])}}}(typeof rt.R2L=="boolean"?rt.R2L:Ye)===!0&&(L=w(L,function(gn,Un,Ps){return[gn.split("").reverse().join(""),Un,Ps]})),Bt={text:L,x:ce,y:He,options:rt,mutex:{pdfEscape:ur,activeFontKey:Ge,fonts:$e,activeFontSize:Ie}},Lt.publish("postProcessText",Bt),L=Bt.text,fs=Bt.mutex.isHex||!1;var Cm=$e[Ge].encoding;Cm!=="WinAnsiEncoding"&&Cm!=="StandardEncoding"||(L=w(L,function(gn,Un,Ps){return[Vo(gn),Un,Ps]})),jt=Ho(L),L=[];for(var KA,qA,GA,Sd=Array.isArray(jt[0])?1:0,$A="",Id=function(gn,Un,Ps){var ta="";return Ps instanceof et?(Ps=typeof rt.angle=="number"?gt(Ps,new et(1,0,0,1,gn,Un)):gt(new et(1,0,0,1,gn,Un),Ps),F===b&&(Ps=gt(new et(1,0,0,-1,0,0),Ps)),ta=Ps.join(" ")+` Tm
`):ta=B(gn)+" "+B(Un)+` Td
`,ta},Ko=0;Ko<jt.length;Ko++){switch($A="",Sd){case 1:GA=(fs?"<":"(")+jt[Ko][0]+(fs?">":")"),KA=parseFloat(jt[Ko][1]),qA=parseFloat(jt[Ko][2]);break;case 0:GA=(fs?"<":"(")+jt[Ko]+(fs?">":")"),KA=xa(ce),qA=gl(He)}QA!==void 0&&QA[Ko]!==void 0&&($A=QA[Ko]+` Tw
`),Ko===0?L.push($A+Id(KA,qA,hs)+GA):Sd===0?L.push($A+GA):Sd===1&&L.push($A+Id(KA,qA,hs)+GA)}L=Sd===0?L.join(` Tj
T* `):L.join(` Tj
`),L+=` Tj
`;var nc=`BT
/`;return nc+=Ge+" "+Ie+` Tf
`,nc+=B(Ie*ms)+` TL
`,nc+=so+`
`,nc+=Cs,nc+=L,J(nc+="ET"),f[Ge]=!0,vn};var sf=h.__private__.clip=h.clip=function(L){return J(L==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return sf("evenodd")},h.__private__.discardPath=h.discardPath=function(){return J("n"),this};var Xr=h.__private__.isValidStyle=function(L){var ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(L)!==-1&&(ce=!0),ce};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(L){return Xr(L)&&(A=L),this};var Rc=h.__private__.getStyle=h.getStyle=function(L){var ce=A;switch(L){case"D":case"S":ce="S";break;case"F":ce="f";break;case"FD":case"DF":ce="B";break;case"f":case"f*":case"B":case"B*":ce=L}return ce},Xl=h.close=function(){return J("h"),this};h.stroke=function(){return J("S"),this},h.fill=function(L){return Do("f",L),this},h.fillEvenOdd=function(L){return Do("f*",L),this},h.fillStroke=function(L){return Do("B",L),this},h.fillStrokeEvenOdd=function(L){return Do("B*",L),this};var Do=function(L,ce){Sn(ce)==="object"?dm(ce,L):J(L)},Dc=function(L){L===null||F===b&&L===void 0||(L=Rc(L),J(L))};function af(L,ce,He,rt,dt){var Bt=new th(ce||this.boundingBox,He||this.xStep,rt||this.yStep,this.gState,dt||this.matrix);Bt.stream=this.stream;var jt=L+"$$"+this.cloneIndex+++"$$";return Ft(jt,Bt),Bt}var dm=function(L,ce){var He=Te[L.key],rt=Qe[He];if(rt instanceof Cu)J("q"),J(hm(ce)),rt.gState&&h.setGState(rt.gState),J(L.matrix.toString()+" cm"),J("/"+He+" sh"),J("Q");else if(rt instanceof th){var dt=new et(1,0,0,-1,0,Qo());L.matrix&&(dt=dt.multiply(L.matrix||Pt),He=af.call(rt,L.key,L.boundingBox,L.xStep,L.yStep,dt).id),J("q"),J("/Pattern cs"),J("/"+He+" scn"),rt.gState&&h.setGState(rt.gState),J(ce),J("Q")}},hm=function(L){switch(L){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},bd=h.moveTo=function(L,ce){return J(B(U(L))+" "+B(Z(ce))+" m"),this},of=h.lineTo=function(L,ce){return J(B(U(L))+" "+B(Z(ce))+" l"),this},ka=h.curveTo=function(L,ce,He,rt,dt,Bt){return J([B(U(L)),B(Z(ce)),B(U(He)),B(Z(rt)),B(U(dt)),B(Z(Bt)),"c"].join(" ")),this};h.__private__.line=h.line=function(L,ce,He,rt,dt){if(isNaN(L)||isNaN(ce)||isNaN(He)||isNaN(rt)||!Xr(dt))throw new Error("Invalid arguments passed to jsPDF.line");return F===y?this.lines([[He-L,rt-ce]],L,ce,[1,1],dt||"S"):this.lines([[He-L,rt-ce]],L,ce,[1,1]).stroke()},h.__private__.lines=h.lines=function(L,ce,He,rt,dt,Bt){var jt,nr,dr,br,Fr,Yr,pn,hs,vn,Ns,fs,Cs;if(typeof L=="number"&&(Cs=He,He=ce,ce=L,L=Cs),rt=rt||[1,1],Bt=Bt||!1,isNaN(ce)||isNaN(He)||!Array.isArray(L)||!Array.isArray(rt)||!Xr(dt)||typeof Bt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(bd(ce,He),jt=rt[0],nr=rt[1],br=L.length,Ns=ce,fs=He,dr=0;dr<br;dr++)(Fr=L[dr]).length===2?(Ns=Fr[0]*jt+Ns,fs=Fr[1]*nr+fs,of(Ns,fs)):(Yr=Fr[0]*jt+Ns,pn=Fr[1]*nr+fs,hs=Fr[2]*jt+Ns,vn=Fr[3]*nr+fs,Ns=Fr[4]*jt+Ns,fs=Fr[5]*nr+fs,ka(Yr,pn,hs,vn,Ns,fs));return Bt&&Xl(),Dc(dt),this},h.path=function(L){for(var ce=0;ce<L.length;ce++){var He=L[ce],rt=He.c;switch(He.op){case"m":bd(rt[0],rt[1]);break;case"l":of(rt[0],rt[1]);break;case"c":ka.apply(this,rt);break;case"h":Xl()}}return this},h.__private__.rect=h.rect=function(L,ce,He,rt,dt){if(isNaN(L)||isNaN(ce)||isNaN(He)||isNaN(rt)||!Xr(dt))throw new Error("Invalid arguments passed to jsPDF.rect");return F===y&&(rt=-rt),J([B(U(L)),B(Z(ce)),B(U(He)),B(U(rt)),"re"].join(" ")),Dc(dt),this},h.__private__.triangle=h.triangle=function(L,ce,He,rt,dt,Bt,jt){if(isNaN(L)||isNaN(ce)||isNaN(He)||isNaN(rt)||isNaN(dt)||isNaN(Bt)||!Xr(jt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[He-L,rt-ce],[dt-He,Bt-rt],[L-dt,ce-Bt]],L,ce,[1,1],jt,!0),this},h.__private__.roundedRect=h.roundedRect=function(L,ce,He,rt,dt,Bt,jt){if(isNaN(L)||isNaN(ce)||isNaN(He)||isNaN(rt)||isNaN(dt)||isNaN(Bt)||!Xr(jt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var nr=4/3*(Math.SQRT2-1);return dt=Math.min(dt,.5*He),Bt=Math.min(Bt,.5*rt),this.lines([[He-2*dt,0],[dt*nr,0,dt,Bt-Bt*nr,dt,Bt],[0,rt-2*Bt],[0,Bt*nr,-dt*nr,Bt,-dt,Bt],[2*dt-He,0],[-dt*nr,0,-dt,-Bt*nr,-dt,-Bt],[0,2*Bt-rt],[0,-Bt*nr,dt*nr,-Bt,dt,-Bt]],L+dt,ce,[1,1],jt,!0),this},h.__private__.ellipse=h.ellipse=function(L,ce,He,rt,dt){if(isNaN(L)||isNaN(ce)||isNaN(He)||isNaN(rt)||!Xr(dt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Bt=4/3*(Math.SQRT2-1)*He,jt=4/3*(Math.SQRT2-1)*rt;return bd(L+He,ce),ka(L+He,ce-jt,L+Bt,ce-rt,L,ce-rt),ka(L-Bt,ce-rt,L-He,ce-jt,L-He,ce),ka(L-He,ce+jt,L-Bt,ce+rt,L,ce+rt),ka(L+Bt,ce+rt,L+He,ce+jt,L+He,ce),Dc(dt),this},h.__private__.circle=h.circle=function(L,ce,He,rt){if(isNaN(L)||isNaN(ce)||isNaN(He)||!Xr(rt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(L,ce,He,He,rt)},h.setFont=function(L,ce,He){return He&&(ce=_(ce,He)),Ge=no(L,ce,{disableWarning:!1}),this};var Lo=h.__private__.getFont=h.getFont=function(){return $e[no.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var L,ce,He={};for(L in ge)if(ge.hasOwnProperty(L))for(ce in He[L]=[],ge[L])ge[L].hasOwnProperty(ce)&&He[L].push(ce);return He},h.addFont=function(L,ce,He,rt,dt){var Bt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Bt.indexOf(arguments[3])!==-1?dt=arguments[3]:arguments[3]&&Bt.indexOf(arguments[3])==-1&&(He=_(He,rt)),wr.call(this,L,ce,He,dt=dt||"Identity-H")};var Yl,DA=t.lineWidth||.200025,lf=h.__private__.getLineWidth=h.getLineWidth=function(){return DA},yr=h.__private__.setLineWidth=h.setLineWidth=function(L){return DA=L,J(B(U(L))+" w"),this};h.__private__.setLineDash=sr.API.setLineDash=sr.API.setLineDashPattern=function(L,ce){if(L=L||[],ce=ce||0,isNaN(ce)||!Array.isArray(L))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return L=L.map(function(He){return B(U(He))}).join(" "),ce=B(U(ce)),J("["+L+"] "+ce+" d"),this};var fm=h.__private__.getLineHeight=h.getLineHeight=function(){return Ie*Yl};h.__private__.getLineHeight=h.getLineHeight=function(){return Ie*Yl};var mm=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(L){return typeof(L=L||1.15)=="number"&&(Yl=L),this},pm=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Yl};mm(t.lineHeight);var xa=h.__private__.getHorizontalCoordinate=function(L){return U(L)},gl=h.__private__.getVerticalCoordinate=function(L){return F===b?L:wt[I].mediaBox.topRightY-wt[I].mediaBox.bottomLeftY-U(L)},gm=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(L){return B(xa(L))},LA=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(L){return B(gl(L))},xl=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return le(xl)},h.__private__.setStrokeColor=h.setDrawColor=function(L,ce,He,rt){return xl=me({ch1:L,ch2:ce,ch3:He,ch4:rt,pdfColorType:"draw",precision:2}),J(xl),this};var UA=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return le(UA)},h.__private__.setFillColor=h.setFillColor=function(L,ce,He,rt){return UA=me({ch1:L,ch2:ce,ch3:He,ch4:rt,pdfColorType:"fill",precision:2}),J(UA),this};var so=t.textColor||"0 g",Lc=h.__private__.getTextColor=h.getTextColor=function(){return le(so)};h.__private__.setTextColor=h.setTextColor=function(L,ce,He,rt){return so=me({ch1:L,ch2:ce,ch3:He,ch4:rt,pdfColorType:"text",precision:3}),this};var Uo=t.charSpace,Nd=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Uo||0)};h.__private__.setCharSpace=h.setCharSpace=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Uo=L,this};var Tn=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(L){var ce=h.CapJoinStyles[L];if(ce===void 0)throw new Error("Line cap style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tn=ce,J(ce+" J"),this};var Cd=0;h.__private__.setLineJoin=h.setLineJoin=function(L){var ce=h.CapJoinStyles[L];if(ce===void 0)throw new Error("Line join style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Cd=ce,J(ce+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(L){if(L=L||0,isNaN(L))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(B(U(L))+" M"),this},h.GState=zg,h.setGState=function(L){(L=typeof L=="string"?We[at[L]]:cf(null,L)).equals(bt)||(J("/"+L.id+" gs"),bt=L)};var cf=function(L,ce){if(!L||!at[L]){var He=!1;for(var rt in We)if(We.hasOwnProperty(rt)&&We[rt].equals(ce)){He=!0;break}if(He)ce=We[rt];else{var dt="GS"+(Object.keys(We).length+1).toString(10);We[dt]=ce,ce.id=dt}return L&&(at[L]=ce.id),Lt.publish("addGState",ce),ce}};h.addGState=function(L,ce){return cf(L,ce),this},h.saveGraphicsState=function(){return J("q"),Be.push({key:Ge,size:Ie,color:so}),this},h.restoreGraphicsState=function(){J("Q");var L=Be.pop();return Ge=L.key,Ie=L.size,so=L.color,bt=null,this},h.setCurrentTransformationMatrix=function(L){return J(L.toString()+" cm"),this},h.comment=function(L){return J("#"+L),this};var Oo=function(L,ce){var He=L||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return He},set:function(Bt){isNaN(Bt)||(He=parseFloat(Bt))}});var rt=ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return rt},set:function(Bt){isNaN(Bt)||(rt=parseFloat(Bt))}});var dt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return dt},set:function(Bt){dt=Bt.toString()}}),this},OA=function(L,ce,He,rt){Oo.call(this,L,ce),this.type="rect";var dt=He||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return dt},set:function(jt){isNaN(jt)||(dt=parseFloat(jt))}});var Bt=rt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Bt},set:function(jt){isNaN(jt)||(Bt=parseFloat(jt))}}),this},Uc=function(){this.page=ot,this.currentPage=I,this.pages=ve.slice(0),this.pagesContext=wt.slice(0),this.x=G,this.y=Ne,this.matrix=Ue,this.width=wi(I),this.height=Af(I),this.outputDestination=Oe,this.id="",this.objectNumber=-1};Uc.prototype.restore=function(){ot=this.page,I=this.currentPage,wt=this.pagesContext,ve=this.pages,G=this.x,Ne=this.y,Ue=this.matrix,_d(I,this.width),yi(I,this.height),Oe=this.outputDestination};var Zl=function(L,ce,He,rt,dt){er.push(new Uc),ot=I=0,ve=[],G=L,Ne=ce,Ue=dt,Kr([He,rt])};for(var ec in h.beginFormObject=function(L,ce,He,rt,dt){return Zl(L,ce,He,rt,dt),this},h.endFormObject=function(L){return function(ce){if(xr[ce])er.pop().restore();else{var He=new Uc,rt="Xo"+(Object.keys(ir).length+1).toString(10);He.id=rt,xr[ce]=rt,ir[rt]=He,Lt.publish("addFormObject",He),er.pop().restore()}}(L),this},h.doFormObject=function(L,ce){var He=ir[xr[L]];return J("q"),J(ce.toString()+" cm"),J("/"+He.id+" Do"),J("Q"),this},h.getFormObject=function(L){var ce=ir[xr[L]];return{x:ce.x,y:ce.y,width:ce.width,height:ce.height,matrix:ce.matrix}},h.save=function(L,ce){return L=L||"generated.pdf",(ce=ce||{}).returnPromise=ce.returnPromise||!1,ce.returnPromise===!1?(Hd(jc(Ro()),L),typeof Hd.unload=="function"&&Sr.setTimeout&&setTimeout(Hd.unload,911),this):new Promise(function(He,rt){try{var dt=Hd(jc(Ro()),L);typeof Hd.unload=="function"&&Sr.setTimeout&&setTimeout(Hd.unload,911),He(dt)}catch(Bt){rt(Bt.message)}})},sr.API)sr.API.hasOwnProperty(ec)&&(ec==="events"&&sr.API.events.length?function(L,ce){var He,rt,dt;for(dt=ce.length-1;dt!==-1;dt--)He=ce[dt][0],rt=ce[dt][1],L.subscribe.apply(L,[He].concat(typeof rt=="function"?[rt]:rt))}(Lt,sr.API.events):h[ec]=sr.API[ec]);function wi(L){return wt[L].mediaBox.topRightX-wt[L].mediaBox.bottomLeftX}function _d(L,ce){wt[L].mediaBox.topRightX=ce+wt[L].mediaBox.bottomLeftX}function Af(L){return wt[L].mediaBox.topRightY-wt[L].mediaBox.bottomLeftY}function yi(L,ce){wt[L].mediaBox.topRightY=ce+wt[L].mediaBox.bottomLeftY}var Mo=h.getPageWidth=function(L){return wi(L=L||I)/_e},MA=h.setPageWidth=function(L,ce){_d(L,ce*_e)},Qo=h.getPageHeight=function(L){return Af(L=L||I)/_e},Ed=h.setPageHeight=function(L,ce){yi(L,ce*_e)};return h.internal={pdfEscape:ur,getStyle:Rc,getFont:Lo,getFontSize:ze,getCharSpace:Nd,getTextColor:Lc,getLineHeight:fm,getLineHeightFactor:pm,getLineWidth:lf,write:q,getHorizontalCoordinate:xa,getVerticalCoordinate:gl,getCoordinateString:gm,getVerticalCoordinateString:LA,collections:{},newObject:Xt,newAdditionalObject:ne,newObjectDeferred:Vt,newObjectDeferredBegin:oe,getFilters:Re,putStream:Ee,events:Lt,scaleFactor:_e,pageSize:{getWidth:function(){return Mo(I)},setWidth:function(L){MA(I,L)},getHeight:function(){return Qo(I)},setHeight:function(L){Ed(I,L)}},encryptionOptions:u,encryption:Ln,getEncryptor:function(L){return u!==null?Ln.encryptor(L,0):function(ce){return ce}},output:yd,getNumberOfPages:ga,get pages(){return ve},out:J,f2:k,f3:T,getPageInfo:ea,getPageInfoByObjId:Pc,getCurrentPageInfo:RA,getPDFVersion:p,Point:Oo,Rectangle:OA,Matrix:et,hasHotfix:Mi},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Mo(I)},set:function(L){MA(I,L)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Qo(I)},set:function(L){Ed(I,L)},enumerable:!0,configurable:!0}),(function(L){for(var ce=0,He=fe.length;ce<He;ce++){var rt=wr.call(this,L[ce][0],L[ce][1],L[ce][2],fe[ce][3],!0);d===!1&&(f[rt]=!0);var dt=L[ce][0].split("-");Ht({id:rt,fontName:dt[0],fontStyle:dt[1]||""})}Lt.publish("addFonts",{fonts:$e,dictionary:ge})}).call(h,fe),Ge="F1",$s(s,r),Lt.publish("initialized"),h}Kf.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Kf.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Kf.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Kf.prototype.processOwnerPassword=function(t,e){return bE(yE(e).substr(0,5),t)},Kf.prototype.encryptor=function(t,e){var r=yE(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return bE(r,n)}},zg.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Sn(t)!==Sn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},sr.API={events:[]},sr.version="3.0.4";var Bs=sr.API,tI=1,Wh=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Bf=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Tr=function(t){return t.toFixed(2)},iu=function(t){return t.toFixed(5)};Bs.__acroform__={};var ro=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Sj=function(t){return t*tI},cc=function(t){var e=new HM,r=lr.internal.getHeight(t)||0,n=lr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Tr(n)),Number(Tr(r))],e},zie=Bs.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Wie=Bs.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Jie=Bs.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Qs=Bs.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Jie(t,e-1)},Vs=Bs.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return zie(t,e-1)},Hs=Bs.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Wie(t,e-1)},Xie=Bs.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(a)||0,[Number(Tr(c.lowerLeft_X)),Number(Tr(c.lowerLeft_Y)),Number(Tr(c.upperRight_X)),Number(Tr(c.upperRight_Y))]},Yie=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=NE(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+Tr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=cc(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},NE=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(k){return k.split(`
`)}):s.map(function(k){return[k]});var a=r,o=lr.internal.getHeight(t)||0;o=o<0?-o:o;var l=lr.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,T,U){if(k+1<s.length){var Z=T+" "+s[k+1][0];return A1(Z,t,U).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var A,u,d=A1("3",t,a).height,f=t.multiline?o-a:(o-d)/2,h=f+=2,m=0,p=0,x=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+A1(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var g="",y=0,b=0;b<s.length;b++)if(s.hasOwnProperty(b)){var F=!1;if(s[b].length!==1&&x!==s[b].length-1){if((d+2)*(y+2)+2>o)continue e;g+=s[b][x],F=!0,p=b,b--}else{g=(g+=s[b][x]+" ").substr(g.length-1)==" "?g.substr(0,g.length-1):g;var P=parseInt(b),R=c(P,g,a),_=b>=s.length-1;if(R&&!_){g+=" ",x=0;continue}if(R||_){if(_)p=P;else if(t.multiline&&(d+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(d+2)*(y+2)+2>o)continue e;p=P}}for(var B="",E=m;E<=p;E++){var M=s[E];if(t.multiline){if(E===p){B+=M[x]+" ",x=(x+1)%M.length;continue}if(E===m){B+=M[M.length-1]+" ";continue}}B+=M[0]+" "}switch(B=B.substr(B.length-1)==" "?B.substr(0,B.length-1):B,u=A1(B,t,a).width,t.textAlign){case"right":A=l-u-2;break;case"center":A=(l-u)/2;break;default:A=2}e+=Tr(A)+" "+Tr(h)+` Td
`,e+="("+Wh(B)+`) Tj
`,e+=-Tr(A)+` 0 Td
`,h=-(a+2),u=0,m=F?p:p+1,y++,g=""}break}return n.text=e,n.fontSize=a,n},A1=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},Zie={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},eoe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},toe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(zl.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Zie)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");tI=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new KM,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&eoe(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],A=l.Rect;if(l.Rect&&(l.Rect=Xie(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=lr.createDefaultAppearanceStream(l),Sn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=A,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=Yie(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var d="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var h=l.appearanceStreamContent[f];if(d+="/"+f+" ",d+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(s,l)),d+="/"+o+" "+m+" ",s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(s,l)),d+="/"+o+" "+m,s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}a&&function(p,x){for(var g in p)if(p.hasOwnProperty(g)){var y=g,b=p[g];x.internal.newObjectDeferredBegin(b.objId,!0),Sn(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},VM=Bs.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var s="[",a=0;a<t.length;a++)switch(a!==0&&(s+=" "),Sn(t[a])){case"boolean":case"number":case"object":s+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+Wh(n(t[a].toString()))+")"):s+=t[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},QN=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Wh(n(t))+")"},gc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};gc.prototype.toString=function(){return this.objId+" 0 R"},gc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},gc.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:VM(s,this.objId,this.scope)}):s instanceof gc?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var HM=function(){gc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};ro(HM,gc);var KM=function(){gc.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Wh(r(t))+")"}},set:function(r){t=r}})};ro(KM,gc);var zl=function t(){gc.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute F supplied.');e=g}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Qs(e,3)},set:function(g){g?this.F=Vs(e,3):this.F=Hs(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute Ff supplied.');r=g}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(g){n=g!==void 0?g:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(g){n[0]=g}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(g){n[1]=g}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(g){n[2]=g}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(g){n[3]=g}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(g){switch(g){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=g;break;default:throw new Error('Invalid value "'+g+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof by)return;a="FieldObject"+t.FieldNum++}var g=function(y){return y};return this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),"("+Wh(g(a))+")"},set:function(g){a=g.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(g){a=g}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(g){o=g}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(g){l=g}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(g){c=g}});var A=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return A===void 0?50/tI:A},set:function(g){A=g}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(g){u=g}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof by||this instanceof Wu))return QN(d,this.objId,this.scope)},set:function(g){g=g.toString(),d=g}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ca==0?QN(f,this.objId,this.scope):f},set:function(g){g=g.toString(),f=this instanceof ca==0?g.substr(0,1)==="("?Bf(g.substr(1,g.length-2)):Bf(g):g}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ca==1?Bf(f.substr(1,f.length-1)):f},set:function(g){g=g.toString(),f=this instanceof ca==1?"/"+g:g}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(g){this.V=g}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ca==0?QN(h,this.objId,this.scope):h},set:function(g){g=g.toString(),h=this instanceof ca==0?g.substr(0,1)==="("?Bf(g.substr(1,g.length-2)):Bf(g):g}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ca==1?Bf(h.substr(1,h.length-1)):h},set:function(g){g=g.toString(),h=this instanceof ca==1?"/"+g:g}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(g){g=!!g,p=g}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(g){m=g}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,1)},set:function(g){g?this.Ff=Vs(this.Ff,1):this.Ff=Hs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,2)},set:function(g){g?this.Ff=Vs(this.Ff,2):this.Ff=Hs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,3)},set:function(g){g?this.Ff=Vs(this.Ff,3):this.Ff=Hs(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(g){if([0,1,2].indexOf(g)===-1)throw new Error('Invalid value "'+g+'" for attribute Q supplied.');x=g}}),Object.defineProperty(this,"textAlign",{get:function(){var g;switch(x){case 0:default:g="left";break;case 1:g="center";break;case 2:g="right"}return g},configurable:!0,enumerable:!0,set:function(g){switch(g){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};ro(zl,gc);var lh=function(){zl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return VM(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,o,l){l||(l=1);for(var c,A=[];c=o.exec(a);)A.push(c[l]);return A}(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,18)},set:function(r){r?this.Ff=Vs(this.Ff,18):this.Ff=Hs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Vs(this.Ff,19):this.Ff=Hs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,20)},set:function(r){r?(this.Ff=Vs(this.Ff,20),e.sort()):this.Ff=Hs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,22)},set:function(r){r?this.Ff=Vs(this.Ff,22):this.Ff=Hs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,23)},set:function(r){r?this.Ff=Vs(this.Ff,23):this.Ff=Hs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,27)},set:function(r){r?this.Ff=Vs(this.Ff,27):this.Ff=Hs(this.Ff,27)}}),this.hasAppearanceStream=!1};ro(lh,zl);var ch=function(){lh.call(this),this.fontName="helvetica",this.combo=!1};ro(ch,lh);var Ah=function(){ch.call(this),this.combo=!0};ro(Ah,ch);var Wp=function(){Ah.call(this),this.edit=!0};ro(Wp,Ah);var ca=function(){zl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,15)},set:function(r){r?this.Ff=Vs(this.Ff,15):this.Ff=Hs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,16)},set:function(r){r?this.Ff=Vs(this.Ff,16):this.Ff=Hs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,17)},set:function(r){r?this.Ff=Vs(this.Ff,17):this.Ff=Hs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,26)},set:function(r){r?this.Ff=Vs(this.Ff,26):this.Ff=Hs(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+Wh(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Sn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};ro(ca,zl);var Jp=function(){ca.call(this),this.pushButton=!0};ro(Jp,ca);var uh=function(){ca.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};ro(uh,ca);var by=function(){var t,e;zl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+Wh(s(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Sn(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=lr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ro(by,zl),uh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},uh.prototype.createOption=function(t){var e=new by;return e.Parent=this,e.optionName=t,this.Kids.push(e),roe.call(this.scope,e),e};var Xp=function(){ca.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=lr.CheckBox.createAppearanceStream()};ro(Xp,ca);var Wu=function(){zl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,13)},set:function(e){e?this.Ff=Vs(this.Ff,13):this.Ff=Hs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,21)},set:function(e){e?this.Ff=Vs(this.Ff,21):this.Ff=Hs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,23)},set:function(e){e?this.Ff=Vs(this.Ff,23):this.Ff=Hs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,24)},set:function(e){e?this.Ff=Vs(this.Ff,24):this.Ff=Hs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,25)},set:function(e){e?this.Ff=Vs(this.Ff,25):this.Ff=Hs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,26)},set:function(e){e?this.Ff=Vs(this.Ff,26):this.Ff=Hs(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ro(Wu,zl);var Yp=function(){Wu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Qs(this.Ff,14)},set:function(t){t?this.Ff=Vs(this.Ff,14):this.Ff=Hs(this.Ff,14)}}),this.password=!0};ro(Yp,Wu);var lr={CheckBox:{createAppearanceStream:function(){return{N:{On:lr.CheckBox.YesNormal},D:{On:lr.CheckBox.YesPushDown,Off:lr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),a=NE(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Tr(lr.internal.getWidth(t))+" "+Tr(lr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Tr(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=cc(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],a=lr.internal.getHeight(t),o=lr.internal.getWidth(t),l=NE(t,t.caption);return s.push("1 g"),s.push("0 0 "+Tr(o)+" "+Tr(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Tr(o-1)+" "+Tr(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Tr(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tr(lr.internal.getWidth(t))+" "+Tr(lr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:lr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=lr.RadioButton.Circle.YesNormal,e.D[t]=lr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=lr.internal.getWidth(t)<=lr.internal.getHeight(t)?lr.internal.getWidth(t)/4:lr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=lr.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+iu(lr.internal.getWidth(t)/2)+" "+iu(lr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=lr.internal.getWidth(t)<=lr.internal.getHeight(t)?lr.internal.getWidth(t)/4:lr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*lr.internal.Bezier_C).toFixed(5)),o=Number((n*lr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+iu(lr.internal.getWidth(t)/2)+" "+iu(lr.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+iu(lr.internal.getWidth(t)/2)+" "+iu(lr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=lr.internal.getWidth(t)<=lr.internal.getHeight(t)?lr.internal.getWidth(t)/4:lr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*lr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+iu(lr.internal.getWidth(t)/2)+" "+iu(lr.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:lr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=lr.RadioButton.Cross.YesNormal,e.D[t]=lr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=lr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Tr(lr.internal.getWidth(t)-2)+" "+Tr(lr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Tr(n.x1.x)+" "+Tr(n.x1.y)+" m"),r.push(Tr(n.x2.x)+" "+Tr(n.x2.y)+" l"),r.push(Tr(n.x4.x)+" "+Tr(n.x4.y)+" m"),r.push(Tr(n.x3.x)+" "+Tr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=lr.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Tr(lr.internal.getWidth(t))+" "+Tr(lr.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Tr(lr.internal.getWidth(t)-2)+" "+Tr(lr.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Tr(r.x1.x)+" "+Tr(r.x1.y)+" m"),n.push(Tr(r.x2.x)+" "+Tr(r.x2.y)+" l"),n.push(Tr(r.x4.x)+" "+Tr(r.x4.y)+" m"),n.push(Tr(r.x3.x)+" "+Tr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tr(lr.internal.getWidth(t))+" "+Tr(lr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};lr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=lr.internal.getWidth(t),r=lr.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},lr.internal.getWidth=function(t){var e=0;return Sn(t)==="object"&&(e=Sj(t.Rect[2])),e},lr.internal.getHeight=function(t){var e=0;return Sn(t)==="object"&&(e=Sj(t.Rect[3])),e};var roe=Bs.addField=function(t){if(toe(this,t),!(t instanceof zl))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Bs.AcroFormChoiceField=lh,Bs.AcroFormListBox=ch,Bs.AcroFormComboBox=Ah,Bs.AcroFormEditBox=Wp,Bs.AcroFormButton=ca,Bs.AcroFormPushButton=Jp,Bs.AcroFormRadioButton=uh,Bs.AcroFormCheckBox=Xp,Bs.AcroFormTextField=Wu,Bs.AcroFormPasswordField=Yp,Bs.AcroFormAppearance=lr,Bs.AcroForm={ChoiceField:lh,ListBox:ch,ComboBox:Ah,EditBox:Wp,Button:ca,PushButton:Jp,RadioButton:uh,CheckBox:Xp,TextField:Wu,PasswordField:Yp,Appearance:lr},sr.AcroForm={ChoiceField:lh,ListBox:ch,ComboBox:Ah,EditBox:Wp,Button:ca,PushButton:Jp,RadioButton:uh,CheckBox:Xp,TextField:Wu,PasswordField:Yp,Appearance:lr};var noe=sr.AcroForm;function qM(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(k,T){var U,Z,pe,ae,he,de=r;if((T=T||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(R(k))for(he in n)for(pe=n[he],U=0;U<pe.length;U+=1){for(ae=!0,Z=0;Z<pe[U].length;Z+=1)if(pe[U][Z]!==void 0&&pe[U][Z]!==k[Z]){ae=!1;break}if(ae===!0){de=he;break}}else for(he in n)for(pe=n[he],U=0;U<pe.length;U+=1){for(ae=!0,Z=0;Z<pe[U].length;Z+=1)if(pe[U][Z]!==void 0&&pe[U][Z]!==k.charCodeAt(Z)){ae=!1;break}if(ae===!0){de=he;break}}return de===r&&T!==r&&(de=T),de},a=function k(T){for(var U=this.internal.write,Z=this.internal.putStream,pe=(0,this.internal.getFilters)();pe.indexOf("FlateEncode")!==-1;)pe.splice(pe.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:T.width}),ae.push({key:"Height",value:T.height}),T.colorSpace===g.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===g.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var he="",de=0,re=T.transparency.length;de<re;de++)he+=T.transparency[de]+" "+T.transparency[de]+" ";ae.push({key:"Mask",value:"["+he+"]"})}T.sMask!==void 0&&ae.push({key:"SMask",value:T.objectId+1+" 0 R"});var xe=T.filter!==void 0?["/"+T.filter]:void 0;if(Z({data:T.data,additionalKeyValues:ae,alreadyAppliedFilters:xe,objectId:T.objectId}),U("endobj"),"sMask"in T&&T.sMask!==void 0){var Ce,S=(Ce=T.sMaskBitsPerComponent)!==null&&Ce!==void 0?Ce:T.bitsPerComponent,I={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:S,data:T.sMask};"filter"in T&&(I.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(S," /Columns ").concat(T.width),I.filter=T.filter),k.call(this,I)}if(T.colorSpace===g.INDEXED){var V=this.internal.newObject();Z({data:B(new Uint8Array(T.palette)),objectId:V}),U("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var T in k)a.call(this,k[T])},l=function(){var k,T=this.internal.collections[e+"images"],U=this.internal.write;for(var Z in T)U("/I"+(k=T[Z]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},A=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(k){return typeof t["process"+k.toUpperCase()]=="function"},f=function(k){return Sn(k)==="object"&&k.nodeType===1},h=function(k,T){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var U=""+k.getAttribute("src");if(U.indexOf("data:image/")===0)return gw(unescape(U).split("base64,").pop());var Z=t.loadFile(U,!0);if(Z!==void 0)return Z}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var pe;switch(T){case"PNG":pe="image/png";break;case"WEBP":pe="image/webp";break;default:pe="image/jpeg"}return gw(k.toDataURL(pe,1).split("base64,").pop())}},m=function(k){var T=this.internal.collections[e+"images"];if(T){for(var U in T)if(k===T[U].alias)return T[U]}},p=function(k,T,U){return k||T||(k=-96,T=-96),k<0&&(k=-1*U.width*72/k/this.internal.scaleFactor),T<0&&(T=-1*U.height*72/T/this.internal.scaleFactor),k===0&&(k=T*U.width/U.height),T===0&&(T=k*U.height/U.width),[k,T]},x=function(k,T,U,Z,pe,ae){var he=p.call(this,U,Z,pe),de=this.internal.getCoordinateString,re=this.internal.getVerticalCoordinateString,xe=A.call(this);if(U=he[0],Z=he[1],xe[pe.index]=pe,ae){ae*=Math.PI/180;var Ce=Math.cos(ae),S=Math.sin(ae),I=function(j){return j.toFixed(4)},V=[I(Ce),I(S),I(-1*S),I(Ce),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,de(k),re(T+Z),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([de(U),"0","0",de(Z),"0","0","cm"].join(" "))):this.internal.write([de(U),"0","0",de(Z),de(k),re(T+Z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+pe.index+" Do"),this.internal.write("Q")},g=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(k){var T,U,Z=0;if(typeof k=="string")for(U=k.length,T=0;T<U;T++)Z=(Z<<5)-Z+k.charCodeAt(T),Z|=0;else if(R(k))for(U=k.byteLength/2,T=0;T<U;T++)Z=(Z<<5)-Z+k[T],Z|=0;return Z},F=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var T=!0;return k.length===0&&(T=!1),k.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(T=!1),T},P=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var T=k.indexOf(",");return T<0?null:k.substring(0,T).trim().endsWith("base64")?k.substring(T+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var R=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},_=t.__addimage__.binaryStringToUint8Array=function(k){for(var T=k.length,U=new Uint8Array(T),Z=0;Z<T;Z++)U[Z]=k.charCodeAt(Z);return U},B=t.__addimage__.arrayBufferToBinaryString=function(k){for(var T="",U=R(k)?k:new Uint8Array(k),Z=0;Z<U.length;Z+=8192)T+=String.fromCharCode.apply(null,U.subarray(Z,Z+8192));return T};t.addImage=function(){var k,T,U,Z,pe,ae,he,de,re;if(typeof arguments[1]=="number"?(T=r,U=arguments[1],Z=arguments[2],pe=arguments[3],ae=arguments[4],he=arguments[5],de=arguments[6],re=arguments[7]):(T=arguments[1],U=arguments[2],Z=arguments[3],pe=arguments[4],ae=arguments[5],he=arguments[6],de=arguments[7],re=arguments[8]),Sn(k=arguments[0])==="object"&&!f(k)&&"imageData"in k){var xe=k;k=xe.imageData,T=xe.format||T||r,U=xe.x||U||0,Z=xe.y||Z||0,pe=xe.w||xe.width||pe,ae=xe.h||xe.height||ae,he=xe.alias||he,de=xe.compression||de,re=xe.rotation||xe.angle||re}var Ce=this.internal.getFilters();if(de===void 0&&Ce.indexOf("FlateEncode")!==-1&&(de="SLOW"),isNaN(U)||isNaN(Z))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var S=E.call(this,k,T,he,de);return x.call(this,U,Z,pe,ae,S,re),this};var E=function(k,T,U,Z){var pe,ae,he;if(typeof k=="string"&&s(k)===r){k=unescape(k);var de=M(k,!1);(de!==""||(de=t.loadFile(k,!0))!==void 0)&&(k=de)}if(f(k)&&(k=h(k,T)),T=s(k,T),!d(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((he=U)==null||he.length===0)&&(U=function(re){return typeof re=="string"||R(re)?b(re):R(re.data)?b(re.data):null}(k)),(pe=m.call(this,U))||(k instanceof Uint8Array||T==="RGBA"||(ae=k,k=_(k)),pe=this["process"+T.toUpperCase()](k,u.call(this),U,function(re){return re&&typeof re=="string"&&(re=re.toUpperCase()),re in t.image_compression?re:y.NONE}(Z),ae)),!pe)throw new Error("An unknown error occurred whilst processing the image.");return pe},M=t.__addimage__.convertBase64ToBinaryString=function(k,T){T=typeof T!="boolean"||T;var U,Z="";if(typeof k=="string"){var pe;U=(pe=P(k))!==null&&pe!==void 0?pe:k;try{Z=gw(U)}catch(ae){if(T)throw F(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Z};t.getImageProperties=function(k){var T,U,Z="";if(f(k)&&(k=h(k)),typeof k=="string"&&s(k)===r&&((Z=M(k,!1))===""&&(Z=t.loadFile(k)||""),k=Z),U=s(k),!d(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(k instanceof Uint8Array||(k=_(k)),!(T=this["process"+U.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=U,T}})(sr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};sr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),A=r.pageContext.annotations,u=!1,d=0;d<A.length&&!u;d++)switch((n=A[d]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var f=0;f<A.length;f++){n=A[f];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(p.objId),y=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(g(n.contents))+")",a+=" /Popup "+x.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+h(g(y))+") >>",p.content=a;var b=p.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",x.content=a,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var F=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(m(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var P=this.annotations._nameMap[n.options.name];n.options.pageNumber=P.page,n.options.top=P.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var R=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+R+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:A(n),w:c(r+s),h:A(n+a)},options:o,type:"link"})},t.textWithLink=function(r,n,s,a){var o,l,c=this.getTextWidth(r),A=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(A*u)}else l=c,o=A;return this.text(r,n,s,a),s+=.2*A,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-A,l,o,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(sr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&s.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=1};var A=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length==4},d=t.__arabicParser__.resolveLigatures=function(p){var x=0,g=r,y="",b=0;for(x=0;x<p.length;x+=1)g[p.charCodeAt(x)]!==void 0?(b++,typeof(g=g[p.charCodeAt(x)])=="number"&&(y+=String.fromCharCode(g),g=r,b=0),x===p.length-1&&(g=r,y+=p.charAt(x-(b-1)),x-=b-1,b=0)):(g=r,y+=p.charAt(x-b),x-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var f=t.__arabicParser__.getCorrectForm=function(p,x,g){return o(p)?a(p)===!1?-1:!A(p)||!o(x)&&!o(g)||!o(g)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:u(p)&&o(x)&&!l(x)&&o(g)&&A(g)?3:l(p)||!o(g)?1:2:-1},h=function(p){var x=0,g=0,y=0,b="",F="",P="",R=(p=p||"").split("\\s+"),_=[];for(x=0;x<R.length;x+=1){for(_.push(""),g=0;g<R[x].length;g+=1)b=R[x][g],F=R[x][g-1],P=R[x][g+1],o(b)?(y=f(b,F,P),_[x]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):_[x]+=b;_[x]=d(_[x])}return _.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,g=[];if(Array.isArray(x)){var y=0;for(g=[],y=0;y<x.length;y+=1)Array.isArray(x[y])?g.push([h(x[y][0]),x[y][1],x[y][2]]):g.push([h(x[y])]);p=g}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(sr.API),sr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(sr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var A=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,A){n.call(this);var u=(A=A||{}).fontSize||this.getFontSize(),d=A.font||this.getFont(),f=A.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var g=A.maxWidth;g>0?typeof c=="string"?c=this.splitTextToSize(c,g):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,F){return b.concat(x.splitTextToSize(F,g))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:d})*u)&&(h=p);return h!==0&&(m=c.length),{w:h/=f,h:Math.max((m*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/f,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var A=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,f=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return A.lineNumber!==void 0&&(A.lineNumber===c.lineNumber?(c.x=(A.x||0)+(A.width||0),c.y=A.y||0):A.y+A.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,h&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=A.y+A.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,A,u,d,f){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,m,p,x,g=[],y=[],b=[],F={},P={},R=[],_=[],B=(f=f||{}).autoSize||!1,E=f.printHeaders!==!1,M=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,k=f.margins||Object.assign({width:this.getPageWidth()},e),T=typeof f.padding=="number"?f.padding:3,U=f.headerBackgroundColor||"#c8c8c8",Z=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=Z,this.setFontSize(M),d==null)y=g=Object.keys(u[0]),b=g.map(function(){return"left"});else if(Array.isArray(d)&&Sn(d[0])==="object")for(g=d.map(function(xe){return xe.name}),y=d.map(function(xe){return xe.prompt||xe.name||""}),b=d.map(function(xe){return xe.align||"left"}),h=0;h<d.length;h+=1)P[d[h].name]=.7499990551181103*d[h].width;else Array.isArray(d)&&typeof d[0]=="string"&&(y=g=d,b=g.map(function(){return"left"}));if(B||Array.isArray(d)&&typeof d[0]=="string")for(h=0;h<g.length;h+=1){for(F[x=g[h]]=u.map(function(xe){return xe[x]}),this.setFont(void 0,"bold"),R.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=F[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)R.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[x]=Math.max.apply(null,R)+T+T,R=[]}if(E){var pe={};for(h=0;h<g.length;h+=1)pe[g[h]]={},pe[g[h]].text=y[h],pe[g[h]].align=b[h];var ae=l.call(this,pe,P);_=g.map(function(xe){return new a(c,A,P[xe],ae,pe[xe].text,void 0,pe[xe].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var he=d.reduce(function(xe,Ce){return xe[Ce.name]=Ce.align,xe},{});for(h=0;h<u.length;h+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:h,data:u[h]},this);var de=l.call(this,u[h],P);for(p=0;p<g.length;p+=1){var re=u[h][g[p]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:h,col:p,data:re},this),o.call(this,new a(c,A,P[g[p]],de,re,h+2,he[g[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=A,this};var l=function(c,A){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,A[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*d/f+u+u},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,A){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),A&&(u.y=this.internal.__cell__.margins.top||0,f.push(u)),u.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(m)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(sr.API);var GM={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$M=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],CE=qM($M),zM=[100,200,300,400,500,600,700,800,900],soe=qM(zM);function VN(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return GM[a=a||"normal"]?a:"normal"}(t.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(t.weight),s=function(a){return typeof CE[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function Ij(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var aoe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Fj={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function kj(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Tj(t){return t.trimLeft()}function ioe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function ooe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var u1,jj,Pj,Sf,d1,Rj,Dj,Lj,HN=["times"];function Uj(t,e,r,n,s){var a=4,o=Mj;switch(s){case sr.API.image_compression.FAST:a=1,o=Oj;break;case sr.API.image_compression.MEDIUM:a=6,o=Qj;break;case sr.API.image_compression.SLOW:a=9,o=Vj}t=function(c,A,u,d){for(var f,h=c.length/A,m=new Uint8Array(c.length+h),p=[loe,Oj,Mj,Qj,Vj],x=0;x<h;x+=1){var g=x*A,y=c.subarray(g,g+A);if(d)m.set(d(y,u,f),g+x);else{for(var b=p.length,F=[],P=0;P<b;P+=1)F[P]=p[P](y,u,f);var R=Aoe(F.concat());m.set(F[R],g+x)}f=y}return m}(t,e,Math.ceil(r*n/8),o);var l=gE(t,{level:a});return sr.API.__addimage__.arrayBufferToBinaryString(l)}function loe(t){var e=Array.apply([],t);return e.unshift(0),e}function Oj(t,e){var r=t.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=t[s-e]||0;n[s+1]=t[s]-a+256&255}return n}function Mj(t,e,r){var n=t.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var o=r&&r[a]||0;s[a+1]=t[a]-o+256&255}return s}function Qj(t,e,r){var n=t.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var o=t[a-e]||0,l=r&&r[a]||0;s[a+1]=t[a]+256-(o+l>>>1)&255}return s}function Vj(t,e,r){var n=t.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var o=coe(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);s[a+1]=t[a]-o+256&255}return s}function coe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),s=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=s&&n<=a?t:s<=a?e:r}function Aoe(t){var e=t.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function KN(t,e,r){var n=e*r,s=Math.floor(n/8),a=16-(n-8*s+r),o=(1<<r)-1;return WM(t,s)>>a&o}function Hj(t,e,r,n){var s=r*n,a=Math.floor(s/8),o=16-(s-8*a+n),l=(1<<n)-1,c=(e&l)<<o;(function(A,u,d){if(u+1<A.byteLength)A.setUint16(u,d,!1);else{var f=d>>8&255;A.setUint8(u,f)}})(t,a,WM(t,a)&~(l<<o)&65535|c)}function WM(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function uoe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],a=s>>7,o=1<<1+(7&s);t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var A=!0,u=[],d=0,f=null,h=0,m=null;for(this.width=r,this.height=n;A&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];d=t[e++]|t[e++]<<8,f=t[e++],1&p||(f=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,F=t[e++],P=F>>6&1,R=1<<1+(7&F),_=l,B=c,E=!1;F>>7&&(E=!0,_=e,B=R,e+=3*R);var M=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}u.push({x,y:g,width:y,height:b,has_local_palette:E,palette_offset:_,palette_size:B,data_offset:M,data_length:e-M,transparent_index:f,interlaced:!!P,delay:d,disposal:h});break;case 59:A=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,U){var Z=this.frameInfo(T),pe=Z.width*Z.height,ae=new Uint8Array(pe);Kj(t,Z.data_offset,ae,pe);var he=Z.palette_offset,de=Z.transparent_index;de===null&&(de=256);var re=Z.width,xe=r-re,Ce=re,S=4*(Z.y*r+Z.x),I=4*((Z.y+Z.height)*r+Z.x),V=S,j=4*xe;Z.interlaced===!0&&(j+=4*r*7);for(var O=8,W=0,D=ae.length;W<D;++W){var Y=ae[W];if(Ce===0&&(Ce=re,(V+=j)>=I&&(j=4*xe+4*r*(O-1),V=S+(re+xe)*(O<<1),O>>=1)),Y===de)V+=4;else{var se=t[he+3*Y],ve=t[he+3*Y+1],z=t[he+3*Y+2];U[V++]=z,U[V++]=ve,U[V++]=se,U[V++]=255}--Ce}},this.decodeAndBlitFrameRGBA=function(T,U){var Z=this.frameInfo(T),pe=Z.width*Z.height,ae=new Uint8Array(pe);Kj(t,Z.data_offset,ae,pe);var he=Z.palette_offset,de=Z.transparent_index;de===null&&(de=256);var re=Z.width,xe=r-re,Ce=re,S=4*(Z.y*r+Z.x),I=4*((Z.y+Z.height)*r+Z.x),V=S,j=4*xe;Z.interlaced===!0&&(j+=4*r*7);for(var O=8,W=0,D=ae.length;W<D;++W){var Y=ae[W];if(Ce===0&&(Ce=re,(V+=j)>=I&&(j=4*xe+4*r*(O-1),V=S+(re+xe)*(O<<1),O>>=1)),Y===de)V+=4;else{var se=t[he+3*Y],ve=t[he+3*Y+1],z=t[he+3*Y+2];U[V++]=se,U[V++]=ve,U[V++]=z,U[V++]=255}--Ce}}}function Kj(t,e,r,n){for(var s=t[e++],a=1<<s,o=a+1,l=o+1,c=s+1,A=(1<<c)-1,u=0,d=0,f=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;u<16&&h!==0;)d|=t[e++]<<u,u+=8,h===1?h=t[e++]:--h;if(u<c)break;var x=d&A;if(d>>=c,u-=c,x!==a){if(x===o)break;for(var g=x<l?x:p,y=0,b=g;b>a;)b=m[b]>>8,++y;var F=b;if(f+y+(g!==x?1:0)>n)return void Vn.log("Warning, gif stream longer than expected.");r[f++]=F;var P=f+=y;for(g!==x&&(r[f++]=F),b=g;y--;)b=m[b],r[--P]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|F,l>=A+1&&c<12&&(++c,A=A<<1|1)),p=x}else l=o+1,A=(1<<(c=s+1))-1,p=null}return f!==n&&Vn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function qN(t){var e,r,n,s,a,o=Math.floor,l=new Array(64),c=new Array(64),A=new Array(64),u=new Array(64),d=new Array(65535),f=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,g=7,y=new Array(64),b=new Array(64),F=new Array(64),P=new Array(256),R=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],B=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],Z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],pe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(S,I){for(var V=0,j=0,O=new Array,W=1;W<=16;W++){for(var D=1;D<=S[W];D++)O[I[j]]=[],O[I[j]][0]=V,O[I[j]][1]=W,j++,V++;V*=2}return O}function he(S){for(var I=S[0],V=S[1]-1;V>=0;)I&1<<V&&(x|=1<<g),V--,--g<0&&(x==255?(de(255),de(0)):de(x),g=7,x=0)}function de(S){p.push(S)}function re(S){de(S>>8&255),de(255&S)}function xe(S,I,V,j,O){for(var W,D=O[0],Y=O[240],se=function(Ie,Ve){var ze,Ye,ct,st,ft,nt,De,Fe,Ge,_e,G=0;for(Ge=0;Ge<8;++Ge){ze=Ie[G],Ye=Ie[G+1],ct=Ie[G+2],st=Ie[G+3],ft=Ie[G+4],nt=Ie[G+5],De=Ie[G+6];var Ne=ze+(Fe=Ie[G+7]),Ue=ze-Fe,$e=Ye+De,ge=Ye-De,Be=ct+nt,Qe=ct-nt,Te=st+ft,We=st-ft,at=Ne+Te,bt=Ne-Te,ot=$e+Be,wt=$e-Be;Ie[G]=at+ot,Ie[G+4]=at-ot;var Lt=.707106781*(wt+bt);Ie[G+2]=bt+Lt,Ie[G+6]=bt-Lt;var Ar=.382683433*((at=We+Qe)-(wt=ge+Ue)),ir=.5411961*at+Ar,xr=1.306562965*wt+Ar,er=.707106781*(ot=Qe+ge),et=Ue+er,gt=Ue-er;Ie[G+5]=gt+ir,Ie[G+3]=gt-ir,Ie[G+1]=et+xr,Ie[G+7]=et-xr,G+=8}for(G=0,Ge=0;Ge<8;++Ge){ze=Ie[G],Ye=Ie[G+8],ct=Ie[G+16],st=Ie[G+24],ft=Ie[G+32],nt=Ie[G+40],De=Ie[G+48];var Pt=ze+(Fe=Ie[G+56]),Ft=ze-Fe,Tt=Ye+De,Xt=Ye-De,Vt=ct+nt,oe=ct-nt,ne=st+ft,ue=st-ft,K=Pt+ne,le=Pt-ne,me=Tt+Vt,Re=Tt-Vt;Ie[G]=K+me,Ie[G+32]=K-me;var Ee=.707106781*(Re+le);Ie[G+16]=le+Ee,Ie[G+48]=le-Ee;var ye=.382683433*((K=ue+oe)-(Re=Xt+Ft)),Me=.5411961*K+ye,Le=1.306562965*Re+ye,Je=.707106781*(me=oe+Xt),tt=Ft+Je,Xe=Ft-Je;Ie[G+40]=Xe+Me,Ie[G+24]=Xe-Me,Ie[G+8]=tt+Le,Ie[G+56]=tt-Le,G++}for(Ge=0;Ge<64;++Ge)_e=Ie[Ge]*Ve[Ge],h[Ge]=_e>0?_e+.5|0:_e-.5|0;return h}(S,I),ve=0;ve<64;++ve)m[_[ve]]=se[ve];var z=m[0]-V;V=m[0],z==0?he(j[0]):(he(j[f[W=32767+z]]),he(d[W]));for(var Oe=63;Oe>0&&m[Oe]==0;)Oe--;if(Oe==0)return he(D),V;for(var te,J=1;J<=Oe;){for(var q=J;m[J]==0&&J<=Oe;)++J;var ie=J-q;if(ie>=16){te=ie>>4;for(var fe=1;fe<=te;++fe)he(Y);ie&=15}W=32767+m[J],he(O[(ie<<4)+f[W]]),he(d[W]),J++}return Oe!=63&&he(D),V}function Ce(S){S=Math.min(Math.max(S,1),100),a!=S&&(function(I){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],j=0;j<64;j++){var O=o((V[j]*I+50)/100);O=Math.min(Math.max(O,1),255),l[_[j]]=O}for(var W=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],D=0;D<64;D++){var Y=o((W[D]*I+50)/100);Y=Math.min(Math.max(Y,1),255),c[_[D]]=Y}for(var se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ve=0,z=0;z<8;z++)for(var Oe=0;Oe<8;Oe++)A[ve]=1/(l[_[ve]]*se[z]*se[Oe]*8),u[ve]=1/(c[_[ve]]*se[z]*se[Oe]*8),ve++}(S<50?Math.floor(5e3/S):Math.floor(200-2*S)),a=S)}this.encode=function(S,I){I&&Ce(I),p=new Array,x=0,g=7,re(65496),re(65504),re(16),de(74),de(70),de(73),de(70),de(0),de(1),de(1),de(0),re(1),re(1),de(0),de(0),function(){re(65499),re(132),de(0);for(var Ye=0;Ye<64;Ye++)de(l[Ye]);de(1);for(var ct=0;ct<64;ct++)de(c[ct])}(),function(Ye,ct){re(65472),re(17),de(8),re(ct),re(Ye),de(3),de(1),de(17),de(0),de(2),de(17),de(1),de(3),de(17),de(1)}(S.width,S.height),function(){re(65476),re(418),de(0);for(var Ye=0;Ye<16;Ye++)de(B[Ye+1]);for(var ct=0;ct<=11;ct++)de(E[ct]);de(16);for(var st=0;st<16;st++)de(M[st+1]);for(var ft=0;ft<=161;ft++)de(k[ft]);de(1);for(var nt=0;nt<16;nt++)de(T[nt+1]);for(var De=0;De<=11;De++)de(U[De]);de(17);for(var Fe=0;Fe<16;Fe++)de(Z[Fe+1]);for(var Ge=0;Ge<=161;Ge++)de(pe[Ge])}(),re(65498),re(12),de(3),de(1),de(0),de(2),de(17),de(3),de(17),de(0),de(63),de(0);var V=0,j=0,O=0;x=0,g=7,this.encode.displayName="_encode_";for(var W,D,Y,se,ve,z,Oe,te,J,q=S.data,ie=S.width,fe=S.height,Ie=4*ie,Ve=0;Ve<fe;){for(W=0;W<Ie;){for(ve=Ie*Ve+W,Oe=-1,te=0,J=0;J<64;J++)z=ve+(te=J>>3)*Ie+(Oe=4*(7&J)),Ve+te>=fe&&(z-=Ie*(Ve+1+te-fe)),W+Oe>=Ie&&(z-=W+Oe-Ie+4),D=q[z++],Y=q[z++],se=q[z++],y[J]=(R[D]+R[Y+256|0]+R[se+512|0]>>16)-128,b[J]=(R[D+768|0]+R[Y+1024|0]+R[se+1280|0]>>16)-128,F[J]=(R[D+1280|0]+R[Y+1536|0]+R[se+1792|0]>>16)-128;V=xe(y,A,V,e,n),j=xe(b,u,j,r,s),O=xe(F,u,O,r,s),W+=32}Ve+=8}if(g>=0){var ze=[];ze[1]=g+1,ze[0]=(1<<g+1)-1,he(ze)}return re(65497),new Uint8Array(p)},t=t||50,function(){for(var S=String.fromCharCode,I=0;I<256;I++)P[I]=S(I)}(),e=ae(B,E),r=ae(T,U),n=ae(M,k),s=ae(Z,pe),function(){for(var S=1,I=2,V=1;V<=15;V++){for(var j=S;j<I;j++)f[32767+j]=V,d[32767+j]=[],d[32767+j][1]=V,d[32767+j][0]=j;for(var O=-(I-1);O<=-S;O++)f[32767+O]=V,d[32767+O]=[],d[32767+O][1]=V,d[32767+O][0]=I-1+O;S<<=1,I<<=1}}(),function(){for(var S=0;S<256;S++)R[S]=19595*S,R[S+256|0]=38470*S,R[S+512|0]=7471*S+32768,R[S+768|0]=-11059*S,R[S+1024|0]=-21709*S,R[S+1280|0]=32768*S+8421375,R[S+1536|0]=-27439*S,R[S+1792|0]=-5329*S}(),Ce(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Cl(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function qj(t){function e(E){if(!E)throw Error("assert :P")}function r(E,M,k){for(var T=0;4>T;T++)if(E[M+T]!=k.charCodeAt(T))return!0;return!1}function n(E,M,k,T,U){for(var Z=0;Z<U;Z++)E[M+Z]=k[T+Z]}function s(E,M,k,T){for(var U=0;U<T;U++)E[M+U]=k}function a(E){return new Int32Array(E)}function o(E,M){for(var k=[],T=0;T<E;T++)k.push(new M);return k}function l(E,M){var k=[];return function T(U,Z,pe){for(var ae=pe[Z],he=0;he<ae&&(U.push(pe.length>Z+1?[]:new M),!(pe.length<Z+1));he++)T(U[he],Z+1,pe)}(k,0,E),k}var c=function(){var E=this;function M(v,C){for(var Q=1<<C-1>>>0;v&Q;)Q>>>=1;return Q?(v&Q-1)+Q:v}function k(v,C,Q,X,Ae){e(!(X%Q));do v[C+(X-=Q)]=Ae;while(0<X)}function T(v,C,Q,X,Ae){if(e(2328>=Ae),512>=Ae)var we=a(512);else if((we=a(Ae))==null)return 0;return function(be,Se,Pe,Ke,it,xt){var qe,lt,mt=Se,_t=1<<Pe,pt=a(16),St=a(16);for(e(it!=0),e(Ke!=null),e(be!=null),e(0<Pe),lt=0;lt<it;++lt){if(15<Ke[lt])return 0;++pt[Ke[lt]]}if(pt[0]==it)return 0;for(St[1]=0,qe=1;15>qe;++qe){if(pt[qe]>1<<qe)return 0;St[qe+1]=St[qe]+pt[qe]}for(lt=0;lt<it;++lt)qe=Ke[lt],0<Ke[lt]&&(xt[St[qe]++]=lt);if(St[15]==1)return(Ke=new U).g=0,Ke.value=xt[0],k(be,mt,1,_t,Ke),_t;var It,Ot=-1,Dt=_t-1,pr=0,or=1,Lr=1,hr=1<<Pe;for(lt=0,qe=1,it=2;qe<=Pe;++qe,it<<=1){if(or+=Lr<<=1,0>(Lr-=pt[qe]))return 0;for(;0<pt[qe];--pt[qe])(Ke=new U).g=qe,Ke.value=xt[lt++],k(be,mt+pr,it,hr,Ke),pr=M(pr,qe)}for(qe=Pe+1,it=2;15>=qe;++qe,it<<=1){if(or+=Lr<<=1,0>(Lr-=pt[qe]))return 0;for(;0<pt[qe];--pt[qe]){if(Ke=new U,(pr&Dt)!=Ot){for(mt+=hr,It=1<<(Ot=qe)-Pe;15>Ot&&!(0>=(It-=pt[Ot]));)++Ot,It<<=1;_t+=hr=1<<(It=Ot-Pe),be[Se+(Ot=pr&Dt)].g=It+Pe,be[Se+Ot].value=mt-Se-Ot}Ke.g=qe-Pe,Ke.value=xt[lt++],k(be,mt+(pr>>Pe),it,hr,Ke),pr=M(pr,qe)}}return or!=2*St[15]-1?0:_t}(v,C,Q,X,Ae,we)}function U(){this.value=this.g=0}function Z(){this.value=this.g=0}function pe(){this.G=o(5,U),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Bd,Z)}function ae(v,C,Q,X){e(v!=null),e(C!=null),e(2147483648>X),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=C,v.pa=Q,v.Jd=C,v.Yc=Q+X,v.Zc=4<=X?Q+X-4+1:Q,D(v)}function he(v,C){for(var Q=0;0<C--;)Q|=se(v,128)<<C;return Q}function de(v,C){var Q=he(v,C);return Y(v)?-Q:Q}function re(v,C,Q,X){var Ae,we=0;for(e(v!=null),e(C!=null),e(4294967288>X),v.Sb=X,v.Ra=0,v.u=0,v.h=0,4<X&&(X=4),Ae=0;Ae<X;++Ae)we+=C[Q+Ae]<<8*Ae;v.Ra=we,v.bb=X,v.oa=C,v.pa=Q}function xe(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<VA-8>>>0,++v.bb,v.u-=8;j(v)&&(v.h=1,v.u=0)}function Ce(v,C){if(e(0<=C),!v.h&&C<=oo){var Q=V(v)&io[C];return v.u+=C,xe(v),Q}return v.h=1,v.u=0}function S(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function I(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(v){return v.Ra>>>(v.u&VA-1)>>>0}function j(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>VA}function O(v,C){v.u=C,v.h=j(v)}function W(v){v.u>=Oc&&(e(v.u>=Oc),xe(v))}function D(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function Y(v){return he(v,1)}function se(v,C){var Q=v.Ca;0>v.b&&D(v);var X=v.b,Ae=Q*C>>>8,we=(v.I>>>X>Ae)+0;for(we?(Q-=Ae,v.I-=Ae+1<<X>>>0):Q=Ae+1,X=Q,Ae=0;256<=X;)Ae+=8,X>>=8;return X=7^Ae+HA[X],v.b-=X,v.Ca=(Q<<X)-1,we}function ve(v,C,Q){v[C+0]=Q>>24&255,v[C+1]=Q>>16&255,v[C+2]=Q>>8&255,v[C+3]=255&Q}function z(v,C){return v[C+0]|v[C+1]<<8}function Oe(v,C){return z(v,C)|v[C+2]<<16}function te(v,C){return z(v,C)|z(v,C+2)<<16}function J(v,C){var Q=1<<C;return e(v!=null),e(0<C),v.X=a(Q),v.X==null?0:(v.Mb=32-C,v.Xa=C,1)}function q(v,C){e(v!=null),e(C!=null),e(v.Xa==C.Xa),n(C.X,0,v.X,0,1<<C.Xa)}function ie(){this.X=[],this.Xa=this.Mb=0}function fe(v,C,Q,X){e(Q!=null),e(X!=null);var Ae=Q[0],we=X[0];return Ae==0&&(Ae=(v*we+C/2)/C),we==0&&(we=(C*Ae+v/2)/v),0>=Ae||0>=we?0:(Q[0]=Ae,X[0]=we,1)}function Ie(v,C){return v+(1<<C)-1>>>C}function Ve(v,C){return((4278255360&v)+(4278255360&C)>>>0&4278255360)+((16711935&v)+(16711935&C)>>>0&16711935)>>>0}function ze(v,C){E[C]=function(Q,X,Ae,we,be,Se,Pe){var Ke;for(Ke=0;Ke<be;++Ke){var it=E[v](Se[Pe+Ke-1],Ae,we+Ke);Se[Pe+Ke]=Ve(Q[X+Ke],it)}}}function Ye(){this.ud=this.hd=this.jd=0}function ct(v,C){return((4278124286&(v^C))>>>1)+(v&C)>>>0}function st(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function ft(v,C){return st(v+(v-C+.5>>1))}function nt(v,C,Q){return Math.abs(C-Q)-Math.abs(v-Q)}function De(v,C,Q,X,Ae,we,be){for(X=we[be-1],Q=0;Q<Ae;++Q)we[be+Q]=X=Ve(v[C+Q],X)}function Fe(v,C,Q,X,Ae){var we;for(we=0;we<Q;++we){var be=v[C+we],Se=be>>8&255,Pe=16711935&(Pe=(Pe=16711935&be)+((Se<<16)+Se));X[Ae+we]=(4278255360&be)+Pe>>>0}}function Ge(v,C){C.jd=255&v,C.hd=v>>8&255,C.ud=v>>16&255}function _e(v,C,Q,X,Ae,we){var be;for(be=0;be<X;++be){var Se=C[Q+be],Pe=Se>>>8,Ke=Se,it=255&(it=(it=Se>>>16)+((v.jd<<24>>24)*(Pe<<24>>24)>>>5));Ke=255&(Ke=(Ke+=(v.hd<<24>>24)*(Pe<<24>>24)>>>5)+((v.ud<<24>>24)*(it<<24>>24)>>>5)),Ae[we+be]=(4278255360&Se)+(it<<16)+Ke}}function G(v,C,Q,X,Ae){E[C]=function(we,be,Se,Pe,Ke,it,xt,qe,lt){for(Pe=xt;Pe<qe;++Pe)for(xt=0;xt<lt;++xt)Ke[it++]=Ae(Se[X(we[be++])])},E[v]=function(we,be,Se,Pe,Ke,it,xt){var qe=8>>we.b,lt=we.Ea,mt=we.K[0],_t=we.w;if(8>qe)for(we=(1<<we.b)-1,_t=(1<<qe)-1;be<Se;++be){var pt,St=0;for(pt=0;pt<lt;++pt)pt&we||(St=X(Pe[Ke++])),it[xt++]=Ae(mt[St&_t]),St>>=qe}else E["VP8LMapColor"+Q](Pe,Ke,mt,_t,it,xt,be,Se,lt)}}function Ne(v,C,Q,X,Ae){for(Q=C+Q;C<Q;){var we=v[C++];X[Ae++]=we>>16&255,X[Ae++]=we>>8&255,X[Ae++]=255&we}}function Ue(v,C,Q,X,Ae){for(Q=C+Q;C<Q;){var we=v[C++];X[Ae++]=we>>16&255,X[Ae++]=we>>8&255,X[Ae++]=255&we,X[Ae++]=we>>24&255}}function $e(v,C,Q,X,Ae){for(Q=C+Q;C<Q;){var we=(be=v[C++])>>16&240|be>>12&15,be=240&be|be>>28&15;X[Ae++]=we,X[Ae++]=be}}function ge(v,C,Q,X,Ae){for(Q=C+Q;C<Q;){var we=(be=v[C++])>>16&248|be>>13&7,be=be>>5&224|be>>3&31;X[Ae++]=we,X[Ae++]=be}}function Be(v,C,Q,X,Ae){for(Q=C+Q;C<Q;){var we=v[C++];X[Ae++]=255&we,X[Ae++]=we>>8&255,X[Ae++]=we>>16&255}}function Qe(v,C,Q,X,Ae,we){if(we==0)for(Q=C+Q;C<Q;)ve(X,((we=v[C++])[0]>>24|we[1]>>8&65280|we[2]<<8&16711680|we[3]<<24)>>>0),Ae+=32;else n(X,Ae,v,C,Q)}function Te(v,C){E[C][0]=E[v+"0"],E[C][1]=E[v+"1"],E[C][2]=E[v+"2"],E[C][3]=E[v+"3"],E[C][4]=E[v+"4"],E[C][5]=E[v+"5"],E[C][6]=E[v+"6"],E[C][7]=E[v+"7"],E[C][8]=E[v+"8"],E[C][9]=E[v+"9"],E[C][10]=E[v+"10"],E[C][11]=E[v+"11"],E[C][12]=E[v+"12"],E[C][13]=E[v+"13"],E[C][14]=E[v+"0"],E[C][15]=E[v+"0"]}function We(v){return v==nb||v==sb||v==Zx||v==ab}function at(){this.eb=[],this.size=this.A=this.fb=0}function bt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ot(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new at,this.f.kb=new bt,this.sd=null}function wt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ar(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function ir(v,C){var Q=v.T,X=C.ba.f.RGBA,Ae=X.eb,we=X.fb+v.ka*X.A,be=Go[C.ba.S],Se=v.y,Pe=v.O,Ke=v.f,it=v.N,xt=v.ea,qe=v.W,lt=C.cc,mt=C.dc,_t=C.Mc,pt=C.Nc,St=v.ka,It=v.ka+v.T,Ot=v.U,Dt=Ot+1>>1;for(St==0?be(Se,Pe,null,null,Ke,it,xt,qe,Ke,it,xt,qe,Ae,we,null,null,Ot):(be(C.ec,C.fc,Se,Pe,lt,mt,_t,pt,Ke,it,xt,qe,Ae,we-X.A,Ae,we,Ot),++Q);St+2<It;St+=2)lt=Ke,mt=it,_t=xt,pt=qe,it+=v.Rc,qe+=v.Rc,we+=2*X.A,be(Se,(Pe+=2*v.fa)-v.fa,Se,Pe,lt,mt,_t,pt,Ke,it,xt,qe,Ae,we-X.A,Ae,we,Ot);return Pe+=v.fa,v.j+It<v.o?(n(C.ec,C.fc,Se,Pe,Ot),n(C.cc,C.dc,Ke,it,Dt),n(C.Mc,C.Nc,xt,qe,Dt),Q--):1&It||be(Se,Pe,null,null,Ke,it,xt,qe,Ke,it,xt,qe,Ae,we+X.A,null,null,Ot),Q}function xr(v,C,Q){var X=v.F,Ae=[v.J];if(X!=null){var we=v.U,be=C.ba.S,Se=be==Yx||be==Zx;C=C.ba.f.RGBA;var Pe=[0],Ke=v.ka;Pe[0]=v.T,v.Kb&&(Ke==0?--Pe[0]:(--Ke,Ae[0]-=v.width),v.j+v.ka+v.T==v.o&&(Pe[0]=v.o-v.j-Ke));var it=C.eb;Ke=C.fb+Ke*C.A,v=XI(X,Ae[0],v.width,we,Pe,it,Ke+(Se?0:3),C.A),e(Q==Pe),v&&We(be)&&Em(it,Ke,Se,we,Pe,C.A)}return 0}function er(v){var C=v.ma,Q=C.ba.S,X=11>Q,Ae=Q==Jx||Q==Xx||Q==Yx||Q==rb||Q==12||We(Q);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!xm(C.Oa,v,Ae?11:12))return 0;if(Ae&&We(Q)&&Ho(),v.da)alert("todo:use_scaling");else{if(X){if(C.Ib=Ar,v.Kb){if(Q=v.U+1>>1,C.memory=a(v.U+2*Q),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+v.U,C.Mc=C.cc,C.Nc=C.dc+Q,C.Ib=ir,Ho()}}else alert("todo:EmitYUV");Ae&&(C.Jb=xr,X&&Qi())}if(X&&!h5){for(v=0;256>v;++v)T7[v]=89858*(v-128)+tv>>ev,R7[v]=-22014*(v-128)+tv,P7[v]=-45773*(v-128),j7[v]=113618*(v-128)+tv>>ev;for(v=Sm;v<lb;++v)C=76283*(v-16)+tv>>ev,D7[v-Sm]=Dn(C,255),L7[v-Sm]=Dn(C+8>>4,15);h5=1}return 1}function et(v){var C=v.ma,Q=v.U,X=v.T;return e(!(1&v.ka)),0>=Q||0>=X?0:(Q=C.Ib(v,C),C.Jb!=null&&C.Jb(v,C,Q),C.Dc+=Q,1)}function gt(v){v.ma.memory=null}function Pt(v,C,Q,X){return Ce(v,8)!=47?0:(C[0]=Ce(v,14)+1,Q[0]=Ce(v,14)+1,X[0]=Ce(v,1),Ce(v,3)!=0?0:!v.h)}function Ft(v,C){if(4>v)return v+1;var Q=v-2>>1;return(2+(1&v)<<Q)+Ce(C,Q)+1}function Tt(v,C){return 120<C?C-120:1<=(Q=((Q=x7[C-1])>>4)*v+(8-(15&Q)))?Q:1;var Q}function Xt(v,C,Q){var X=V(Q),Ae=v[C+=255&X].g-8;return 0<Ae&&(O(Q,Q.u+8),X=V(Q),C+=v[C].value,C+=X&(1<<Ae)-1),O(Q,Q.u+v[C].g),v[C].value}function Vt(v,C,Q){return Q.g+=v.g,Q.value+=v.value<<C>>>0,e(8>=Q.g),v.g}function oe(v,C,Q){var X=v.xc;return e((C=X==0?0:v.vc[v.md*(Q>>X)+(C>>X)])<v.Wb),v.Ya[C]}function ne(v,C,Q,X){var Ae=v.ab,we=v.c*C,be=v.C;C=be+C;var Se=Q,Pe=X;for(X=v.Ta,Q=v.Ua;0<Ae--;){var Ke=v.gc[Ae],it=be,xt=C,qe=Se,lt=Pe,mt=(Pe=X,Se=Q,Ke.Ea);switch(e(it<xt),e(xt<=Ke.nc),Ke.hc){case 2:js(qe,lt,(xt-it)*mt,Pe,Se);break;case 0:var _t=it,pt=xt,St=Pe,It=Se,Ot=(hr=Ke).Ea;_t==0&&(wm(qe,lt,null,null,1,St,It),De(qe,lt+1,0,0,Ot-1,St,It+1),lt+=Ot,It+=Ot,++_t);for(var Dt=1<<hr.b,pr=Dt-1,or=Ie(Ot,hr.b),Lr=hr.K,hr=hr.w+(_t>>hr.b)*or;_t<pt;){var sn=Lr,ra=hr,Ur=1;for(uf(qe,lt,St,It-Ot,1,St,It);Ur<Ot;){var fr=(Ur&~pr)+Dt;fr>Ot&&(fr=Ot),(0,bm[sn[ra++]>>8&15])(qe,lt+ +Ur,St,It+Ur-Ot,fr-Ur,St,It+Ur),Ur=fr}lt+=Ot,It+=Ot,++_t&pr||(hr+=or)}xt!=Ke.nc&&n(Pe,Se-mt,Pe,Se+(xt-it-1)*mt,mt);break;case 1:for(mt=qe,pt=lt,Ot=(qe=Ke.Ea)-(It=qe&~(St=(lt=1<<Ke.b)-1)),_t=Ie(qe,Ke.b),Dt=Ke.K,Ke=Ke.w+(it>>Ke.b)*_t;it<xt;){for(pr=Dt,or=Ke,Lr=new Ye,hr=pt+It,sn=pt+qe;pt<hr;)Ge(pr[or++],Lr),Nm(Lr,mt,pt,lt,Pe,Se),pt+=lt,Se+=lt;pt<sn&&(Ge(pr[or++],Lr),Nm(Lr,mt,pt,Ot,Pe,Se),pt+=Ot,Se+=Ot),++it&St||(Ke+=_t)}break;case 3:if(qe==Pe&&lt==Se&&0<Ke.b){for(pt=Pe,qe=mt=Se+(xt-it)*mt-(It=(xt-it)*Ie(Ke.Ea,Ke.b)),lt=Pe,St=Se,_t=[],It=(Ot=It)-1;0<=It;--It)_t[It]=lt[St+It];for(It=Ot-1;0<=It;--It)pt[qe+It]=_t[It];Gx(Ke,it,xt,Pe,mt,Pe,Se)}else Gx(Ke,it,xt,qe,lt,Pe,Se)}Se=X,Pe=Q}Pe!=Q&&n(X,Q,Se,Pe,we)}function ue(v,C){var Q=v.V,X=v.Ba+v.c*v.C,Ae=C-v.C;if(e(C<=v.l.o),e(16>=Ae),0<Ae){var we=v.l,be=v.Ta,Se=v.Ua,Pe=we.width;if(ne(v,Ae,Q,X),Ae=Se=[Se],e((Q=v.C)<(X=C)),e(we.v<we.va),X>we.o&&(X=we.o),Q<we.j){var Ke=we.j-Q;Q=we.j,Ae[0]+=Ke*Pe}if(Q>=X?Q=0:(Ae[0]+=4*we.v,we.ka=Q-we.j,we.U=we.va-we.v,we.T=X-Q,Q=1),Q){if(Se=Se[0],11>(Q=v.ca).S){var it=Q.f.RGBA,xt=(X=Q.S,Ae=we.U,we=we.T,Ke=it.eb,it.A),qe=we;for(it=it.fb+v.Ma*it.A;0<qe--;){var lt=be,mt=Se,_t=Ae,pt=Ke,St=it;switch(X){case Wx:Cm(lt,mt,_t,pt,St);break;case Jx:KA(lt,mt,_t,pt,St);break;case nb:KA(lt,mt,_t,pt,St),Em(pt,St,0,_t,1,0);break;case s5:Sd(lt,mt,_t,pt,St);break;case Xx:Qe(lt,mt,_t,pt,St,1);break;case sb:Qe(lt,mt,_t,pt,St,1),Em(pt,St,0,_t,1,0);break;case Yx:Qe(lt,mt,_t,pt,St,0);break;case Zx:Qe(lt,mt,_t,pt,St,0),Em(pt,St,1,_t,1,0);break;case rb:qA(lt,mt,_t,pt,St);break;case ab:qA(lt,mt,_t,pt,St),JI(pt,St,_t,1,0);break;case a5:GA(lt,mt,_t,pt,St);break;default:e(0)}Se+=Pe,it+=xt}v.Ma+=we}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=Q.height)}}v.C=C,e(v.C<=v.i)}function K(v){var C;if(0<v.ua)return 0;for(C=0;C<v.Wb;++C){var Q=v.Ya[C].G,X=v.Ya[C].H;if(0<Q[1][X[1]+0].g||0<Q[2][X[2]+0].g||0<Q[3][X[3]+0].g)return 0}return 1}function le(v,C,Q,X,Ae,we){if(v.Z!=0){var be=v.qd,Se=v.rd;for(e(WA[v.Z]!=null);C<Q;++C)WA[v.Z](be,Se,X,Ae,X,Ae,we),be=X,Se=Ae,Ae+=we;v.qd=be,v.rd=Se}}function me(v,C){var Q=v.l.ma,X=Q.Z==0||Q.Z==1?v.l.j:v.C;if(X=v.C<X?X:v.C,e(C<=v.l.o),C>X){var Ae=v.l.width,we=Q.ca,be=Q.tb+Ae*X,Se=v.V,Pe=v.Ba+v.c*X,Ke=v.gc;e(v.ab==1),e(Ke[0].hc==3),rc(Ke[0],X,C,Se,Pe,we,be),le(Q,X,C,we,be,Ae)}v.C=v.Ma=C}function Re(v,C,Q,X,Ae,we,be){var Se=v.$/X,Pe=v.$%X,Ke=v.m,it=v.s,xt=Q+v.$,qe=xt;Ae=Q+X*Ae;var lt=Q+X*we,mt=280+it.ua,_t=v.Pb?Se:16777216,pt=0<it.ua?it.Wa:null,St=it.wc,It=xt<lt?oe(it,Pe,Se):null;e(v.C<we),e(lt<=Ae);var Ot=!1;e:for(;;){for(;Ot||xt<lt;){var Dt=0;if(Se>=_t){var pr=xt-Q;e((_t=v).Pb),_t.wd=_t.m,_t.xd=pr,0<_t.s.ua&&q(_t.s.Wa,_t.s.vb),_t=Se+w7}if(Pe&St||(It=oe(it,Pe,Se)),e(It!=null),It.Qb&&(C[xt]=It.qb,Ot=!0),!Ot)if(W(Ke),It.jc){Dt=Ke,pr=C;var or=xt,Lr=It.pd[V(Dt)&Bd-1];e(It.jc),256>Lr.g?(O(Dt,Dt.u+Lr.g),pr[or]=Lr.value,Dt=0):(O(Dt,Dt.u+Lr.g-256),e(256<=Lr.value),Dt=Lr.value),Dt==0&&(Ot=!0)}else Dt=Xt(It.G[0],It.H[0],Ke);if(Ke.h)break;if(Ot||256>Dt){if(!Ot)if(It.nd)C[xt]=(It.qb|Dt<<8)>>>0;else{if(W(Ke),Ot=Xt(It.G[1],It.H[1],Ke),W(Ke),pr=Xt(It.G[2],It.H[2],Ke),or=Xt(It.G[3],It.H[3],Ke),Ke.h)break;C[xt]=(or<<24|Ot<<16|Dt<<8|pr)>>>0}if(Ot=!1,++xt,++Pe>=X&&(Pe=0,++Se,be!=null&&Se<=we&&!(Se%16)&&be(v,Se),pt!=null))for(;qe<xt;)Dt=C[qe++],pt.X[(506832829*Dt&4294967295)>>>pt.Mb]=Dt}else if(280>Dt){if(Dt=Ft(Dt-256,Ke),pr=Xt(It.G[4],It.H[4],Ke),W(Ke),pr=Tt(X,pr=Ft(pr,Ke)),Ke.h)break;if(xt-Q<pr||Ae-xt<Dt)break e;for(or=0;or<Dt;++or)C[xt+or]=C[xt+or-pr];for(xt+=Dt,Pe+=Dt;Pe>=X;)Pe-=X,++Se,be!=null&&Se<=we&&!(Se%16)&&be(v,Se);if(e(xt<=Ae),Pe&St&&(It=oe(it,Pe,Se)),pt!=null)for(;qe<xt;)Dt=C[qe++],pt.X[(506832829*Dt&4294967295)>>>pt.Mb]=Dt}else{if(!(Dt<mt))break e;for(Ot=Dt-280,e(pt!=null);qe<xt;)Dt=C[qe++],pt.X[(506832829*Dt&4294967295)>>>pt.Mb]=Dt;Dt=xt,e(!(Ot>>>(pr=pt).Xa)),C[Dt]=pr.X[Ot],Ot=!0}Ot||e(Ke.h==j(Ke))}if(v.Pb&&Ke.h&&xt<Ae)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&q(v.s.vb,v.s.Wa);else{if(Ke.h)break e;be!=null&&be(v,Se>we?we:Se),v.a=0,v.$=xt-Q}return 1}return v.a=3,0}function Ee(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var C=v.Wa;C!=null&&(C.X=null),v.vb=null,e(v!=null)}function ye(){var v=new br;return v==null?null:(v.a=0,v.xb=l5,Te("Predictor","VP8LPredictors"),Te("Predictor","VP8LPredictors_C"),Te("PredictorAdd","VP8LPredictorsAdd"),Te("PredictorAdd","VP8LPredictorsAdd_C"),js=Fe,Nm=_e,Cm=Ne,KA=Ue,qA=$e,GA=ge,Sd=Be,E.VP8LMapColor32b=tc,E.VP8LMapColor8b=ym,v)}function Me(v,C,Q,X,Ae){var we=1,be=[v],Se=[C],Pe=X.m,Ke=X.s,it=null,xt=0;e:for(;;){if(Q)for(;we&&Ce(Pe,1);){var qe=be,lt=Se,mt=X,_t=1,pt=mt.m,St=mt.gc[mt.ab],It=Ce(pt,2);if(mt.Oc&1<<It)we=0;else{switch(mt.Oc|=1<<It,St.hc=It,St.Ea=qe[0],St.nc=lt[0],St.K=[null],++mt.ab,e(4>=mt.ab),It){case 0:case 1:St.b=Ce(pt,3)+2,_t=Me(Ie(St.Ea,St.b),Ie(St.nc,St.b),0,mt,St.K),St.K=St.K[0];break;case 3:var Ot,Dt=Ce(pt,8)+1,pr=16<Dt?0:4<Dt?1:2<Dt?2:3;if(qe[0]=Ie(St.Ea,pr),St.b=pr,Ot=_t=Me(Dt,1,0,mt,St.K)){var or,Lr=Dt,hr=St,sn=1<<(8>>hr.b),ra=a(sn);if(ra==null)Ot=0;else{var Ur=hr.K[0],fr=hr.w;for(ra[0]=hr.K[0][0],or=1;or<1*Lr;++or)ra[or]=Ve(Ur[fr+or],ra[or-1]);for(;or<4*sn;++or)ra[or]=0;hr.K[0]=null,hr.K[0]=ra,Ot=1}}_t=Ot;break;case 2:break;default:e(0)}we=_t}}if(be=be[0],Se=Se[0],we&&Ce(Pe,1)&&!(we=1<=(xt=Ce(Pe,4))&&11>=xt)){X.a=3;break e}var Jt;if(Jt=we)t:{var Rs,jr,an,zn=X,ja=be,bi=Se,_s=xt,Xa=Q,Ni=zn.m,na=zn.s,ln=[null],wn=1,Es=0,yn=v7[_s];r:for(;;){if(Xa&&Ce(Ni,1)){var Pa=Ce(Ni,3)+2,yl=Ie(ja,Pa),Ds=Ie(bi,Pa),Vi=yl*Ds;if(!Me(yl,Ds,0,zn,ln))break r;for(ln=ln[0],na.xc=Pa,Rs=0;Rs<Vi;++Rs){var On=ln[Rs]>>8&65535;ln[Rs]=On,On>=wn&&(wn=On+1)}}if(Ni.h)break r;for(jr=0;5>jr;++jr){var sa=i5[jr];!jr&&0<_s&&(sa+=1<<_s),Es<sa&&(Es=sa)}var co=o(wn*yn,U),Ci=wn,Ao=o(Ci,pe);if(Ao==null)var uo=null;else e(65536>=Ci),uo=Ao;var Hi=a(Es);if(uo==null||Hi==null||co==null){zn.a=1;break r}var ho=co;for(Rs=an=0;Rs<wn;++Rs){var Kn=uo[Rs],fo=Kn.G,bl=Kn.H,Fd=0,Vc=1,Ra=0;for(jr=0;5>jr;++jr){sa=i5[jr],fo[jr]=ho,bl[jr]=an,!jr&&0<_s&&(sa+=1<<_s);s:{var nv,cb=sa,sv=zn,Im=Hi,M7=ho,Q7=an,Ab=0,JA=sv.m,V7=Ce(JA,1);if(s(Im,0,0,cb),V7){var H7=Ce(JA,1)+1,K7=Ce(JA,1),p5=Ce(JA,K7==0?1:8);Im[p5]=1,H7==2&&(Im[p5=Ce(JA,8)]=1);var av=1}else{var g5=a(19),x5=Ce(JA,4)+4;if(19<x5){sv.a=3;var iv=0;break s}for(nv=0;nv<x5;++nv)g5[g7[nv]]=Ce(JA,3);var ub=void 0,Fm=void 0,v5=sv,q7=g5,ov=cb,w5=Im,db=0,XA=v5.m,y5=8,b5=o(128,U);n:for(;T(b5,0,7,q7,19);){if(Ce(XA,1)){var G7=2+2*Ce(XA,3);if((ub=2+Ce(XA,G7))>ov)break n}else ub=ov;for(Fm=0;Fm<ov&&ub--;){W(XA);var N5=b5[0+(127&V(XA))];O(XA,XA.u+N5.g);var hf=N5.value;if(16>hf)w5[Fm++]=hf,hf!=0&&(y5=hf);else{var $7=hf==16,C5=hf-16,z7=m7[C5],_5=Ce(XA,f7[C5])+z7;if(Fm+_5>ov)break n;for(var W7=$7?y5:0;0<_5--;)w5[Fm++]=W7}}db=1;break n}db||(v5.a=3),av=db}(av=av&&!JA.h)&&(Ab=T(M7,Q7,8,Im,cb)),av&&Ab!=0?iv=Ab:(sv.a=3,iv=0)}if(iv==0)break r;if(Vc&&p7[jr]==1&&(Vc=ho[an].g==0),Fd+=ho[an].g,an+=iv,3>=jr){var km,hb=Hi[0];for(km=1;km<sa;++km)Hi[km]>hb&&(hb=Hi[km]);Ra+=hb}}if(Kn.nd=Vc,Kn.Qb=0,Vc&&(Kn.qb=(fo[3][bl[3]+0].value<<24|fo[1][bl[1]+0].value<<16|fo[2][bl[2]+0].value)>>>0,Fd==0&&256>fo[0][bl[0]+0].value&&(Kn.Qb=1,Kn.qb+=fo[0][bl[0]+0].value<<8)),Kn.jc=!Kn.Qb&&6>Ra,Kn.jc){var lv,Hc=Kn;for(lv=0;lv<Bd;++lv){var YA=lv,ZA=Hc.pd[YA],cv=Hc.G[0][Hc.H[0]+YA];256<=cv.value?(ZA.g=cv.g+256,ZA.value=cv.value):(ZA.g=0,ZA.value=0,YA>>=Vt(cv,8,ZA),YA>>=Vt(Hc.G[1][Hc.H[1]+YA],16,ZA),YA>>=Vt(Hc.G[2][Hc.H[2]+YA],0,ZA),Vt(Hc.G[3][Hc.H[3]+YA],24,ZA))}}}na.vc=ln,na.Wb=wn,na.Ya=uo,na.yc=co,Jt=1;break t}Jt=0}if(!(we=Jt)){X.a=3;break e}if(0<xt){if(Ke.ua=1<<xt,!J(Ke.Wa,xt)){X.a=1,we=0;break e}}else Ke.ua=0;var fb=X,E5=be,J7=Se,mb=fb.s,pb=mb.xc;if(fb.c=E5,fb.i=J7,mb.md=Ie(E5,pb),mb.wc=pb==0?-1:(1<<pb)-1,Q){X.xb=B7;break e}if((it=a(be*Se))==null){X.a=1,we=0;break e}we=(we=Re(X,it,0,be,Se,Se,null))&&!Pe.h;break e}return we?(Ae!=null?Ae[0]=it:(e(it==null),e(Q)),X.$=0,Q||Ee(Ke)):Ee(Ke),we}function Le(v,C){var Q=v.c*v.i,X=Q+C+16*C;return e(v.c<=C),v.V=a(X),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+Q+C,1)}function Je(v,C){var Q=v.C,X=C-Q,Ae=v.V,we=v.Ba+v.c*Q;for(e(C<=v.l.o);0<X;){var be=16<X?16:X,Se=v.l.ma,Pe=v.l.width,Ke=Pe*be,it=Se.ca,xt=Se.tb+Pe*Q,qe=v.Ta,lt=v.Ua;ne(v,be,Ae,we),YI(qe,lt,it,xt,Ke),le(Se,Q,Q+be,it,xt,Pe),X-=be,Ae+=be*v.c,Q+=be}e(Q==C),v.C=v.Ma=C}function tt(){this.ub=this.yd=this.td=this.Rb=0}function Xe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ze(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function ut(){this.Yb=function(){var v=[];return function C(Q,X,Ae){for(var we=Ae[X],be=0;be<we&&(Q.push(Ae.length>X+1?[]:0),!(Ae.length<X+1));be++)C(Q[be],X+1,Ae)}(v,0,[3,11]),v}()}function Ht(){this.jb=a(3),this.Wc=l([4,8],ut),this.Xc=l([4,17],ut)}function wr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function ur(){this.ld=this.La=this.dd=this.tc=0}function Kr(){this.Na=this.la=0}function $s(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function vi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ui(){this.uc=this.M=this.Nb=0,this.wa=Array(new ur),this.Y=0,this.ya=Array(new vi),this.aa=0,this.l=new Oi}function ga(){this.y=a(16),this.f=a(8),this.ea=a(8)}function no(){this.cb=this.a=0,this.sc="",this.m=new S,this.Od=new tt,this.Kc=new Xe,this.ed=new wr,this.Qa=new Ze,this.Ic=this.$c=this.Aa=0,this.D=new Ui,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,S),this.ia=0,this.pb=o(4,$s),this.Pa=new Ht,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ga),this.Hd=0,this.rb=Array(new Kr),this.sb=0,this.wa=Array(new ur),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new vi),this.L=this.aa=0,this.gd=l([4,2],ur),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Dn(v,C){return 0>v?0:v>C?C:v}function Oi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function rf(){var v=new no;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Bm||(Bm=jc)),v}function ds(v,C,Q){return v.a==0&&(v.a=C,v.sc=Q,v.cb=0),0}function nf(v,C,Q){return 3<=Q&&v[C+0]==157&&v[C+1]==1&&v[C+2]==42}function Ro(v,C){if(v==null)return 0;if(v.a=0,v.sc="OK",C==null)return ds(v,2,"null VP8Io passed to VP8GetHeaders()");var Q=C.data,X=C.w,Ae=C.ha;if(4>Ae)return ds(v,7,"Truncated header.");var we=Q[X+0]|Q[X+1]<<8|Q[X+2]<<16,be=v.Od;if(be.Rb=!(1&we),be.td=we>>1&7,be.yd=we>>4&1,be.ub=we>>5,3<be.td)return ds(v,3,"Incorrect keyframe parameters.");if(!be.yd)return ds(v,4,"Frame not displayable.");X+=3,Ae-=3;var Se=v.Kc;if(be.Rb){if(7>Ae)return ds(v,7,"cannot parse picture header");if(!nf(Q,X,Ae))return ds(v,3,"Bad code word");Se.c=16383&(Q[X+4]<<8|Q[X+3]),Se.Td=Q[X+4]>>6,Se.i=16383&(Q[X+6]<<8|Q[X+5]),Se.Ud=Q[X+6]>>6,X+=7,Ae-=7,v.za=Se.c+15>>4,v.Ub=Se.i+15>>4,C.width=Se.c,C.height=Se.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,s((we=v.Pa).jb,0,255,we.jb.length),e((we=v.Qa)!=null),we.Cb=0,we.Bb=0,we.Fb=1,s(we.Zb,0,0,we.Zb.length),s(we.Lb,0,0,we.Lb)}if(be.ub>Ae)return ds(v,7,"bad partition length");ae(we=v.m,Q,X,be.ub),X+=be.ub,Ae-=be.ub,be.Rb&&(Se.Ld=Y(we),Se.Kd=Y(we)),Se=v.Qa;var Pe,Ke=v.Pa;if(e(we!=null),e(Se!=null),Se.Cb=Y(we),Se.Cb){if(Se.Bb=Y(we),Y(we)){for(Se.Fb=Y(we),Pe=0;4>Pe;++Pe)Se.Zb[Pe]=Y(we)?de(we,7):0;for(Pe=0;4>Pe;++Pe)Se.Lb[Pe]=Y(we)?de(we,6):0}if(Se.Bb)for(Pe=0;3>Pe;++Pe)Ke.jb[Pe]=Y(we)?he(we,8):255}else Se.Bb=0;if(we.Ka)return ds(v,3,"cannot parse segment header");if((Se=v.ed).zd=Y(we),Se.Tb=he(we,6),Se.wb=he(we,3),Se.Pc=Y(we),Se.Pc&&Y(we)){for(Ke=0;4>Ke;++Ke)Y(we)&&(Se.vd[Ke]=de(we,6));for(Ke=0;4>Ke;++Ke)Y(we)&&(Se.od[Ke]=de(we,6))}if(v.L=Se.Tb==0?0:Se.zd?1:2,we.Ka)return ds(v,3,"cannot parse filter header");var it=Ae;if(Ae=Pe=X,X=Pe+it,Se=it,v.Xb=(1<<he(v.m,2))-1,it<3*(Ke=v.Xb))Q=7;else{for(Pe+=3*Ke,Se-=3*Ke,it=0;it<Ke;++it){var xt=Q[Ae+0]|Q[Ae+1]<<8|Q[Ae+2]<<16;xt>Se&&(xt=Se),ae(v.Jc[+it],Q,Pe,xt),Pe+=xt,Se-=xt,Ae+=3}ae(v.Jc[+Ke],Q,Pe,Se),Q=Pe<X?0:5}if(Q!=0)return ds(v,Q,"cannot parse partitions");for(Q=he(Pe=v.m,7),Ae=Y(Pe)?de(Pe,4):0,X=Y(Pe)?de(Pe,4):0,Se=Y(Pe)?de(Pe,4):0,Ke=Y(Pe)?de(Pe,4):0,Pe=Y(Pe)?de(Pe,4):0,it=v.Qa,xt=0;4>xt;++xt){if(it.Cb){var qe=it.Zb[xt];it.Fb||(qe+=Q)}else{if(0<xt){v.pb[xt]=v.pb[0];continue}qe=Q}var lt=v.pb[xt];lt.Sc[0]=ib[Dn(qe+Ae,127)],lt.Sc[1]=ob[Dn(qe+0,127)],lt.Eb[0]=2*ib[Dn(qe+X,127)],lt.Eb[1]=101581*ob[Dn(qe+Se,127)]>>16,8>lt.Eb[1]&&(lt.Eb[1]=8),lt.Qc[0]=ib[Dn(qe+Ke,117)],lt.Qc[1]=ob[Dn(qe+Pe,127)],lt.lc=qe+Pe}if(!be.Rb)return ds(v,4,"Not a key frame.");for(Y(we),be=v.Pa,Q=0;4>Q;++Q){for(Ae=0;8>Ae;++Ae)for(X=0;3>X;++X)for(Se=0;11>Se;++Se)Ke=se(we,_7[Q][Ae][X][Se])?he(we,8):N7[Q][Ae][X][Se],be.Wc[Q][Ae].Yb[X][Se]=Ke;for(Ae=0;17>Ae;++Ae)be.Xc[Q][Ae]=be.Wc[Q][E7[Ae]]}return v.kc=Y(we),v.kc&&(v.Bd=he(we,8)),v.cb=1}function jc(v,C,Q,X,Ae,we,be){var Se=C[Ae].Yb[Q];for(Q=0;16>Ae;++Ae){if(!se(v,Se[Q+0]))return Ae;for(;!se(v,Se[Q+1]);)if(Se=C[++Ae].Yb[0],Q=0,Ae==16)return 16;var Pe=C[Ae+1].Yb;if(se(v,Se[Q+2])){var Ke=v,it=0;if(se(Ke,(qe=Se)[(xt=Q)+3]))if(se(Ke,qe[xt+6])){for(Se=0,xt=2*(it=se(Ke,qe[xt+8]))+(qe=se(Ke,qe[xt+9+it])),it=0,qe=y7[xt];qe[Se];++Se)it+=it+se(Ke,qe[Se]);it+=3+(8<<xt)}else se(Ke,qe[xt+7])?(it=7+2*se(Ke,165),it+=se(Ke,145)):it=5+se(Ke,159);else it=se(Ke,qe[xt+4])?3+se(Ke,qe[xt+5]):2;Se=Pe[2]}else it=1,Se=Pe[1];Pe=be+b7[Ae],0>(Ke=v).b&&D(Ke);var xt,qe=Ke.b,lt=(xt=Ke.Ca>>1)-(Ke.I>>qe)>>31;--Ke.b,Ke.Ca+=lt,Ke.Ca|=1,Ke.I-=(xt+1&lt)<<qe,we[Pe]=((it^lt)-lt)*X[(0<Ae)+0]}return 16}function yd(v){var C=v.rb[v.sb-1];C.la=0,C.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function Mi(v,C,Q,X,Ae){Ae=v[C+Q+32*X]+(Ae>>3),v[C+Q+32*X]=-256&Ae?0>Ae?0:255:Ae}function Ln(v,C,Q,X,Ae,we){Mi(v,C,0,Q,X+Ae),Mi(v,C,1,Q,X+we),Mi(v,C,2,Q,X-we),Mi(v,C,3,Q,X-Ae)}function ea(v){return(20091*v>>16)+v}function Pc(v,C,Q,X){var Ae,we=0,be=a(16);for(Ae=0;4>Ae;++Ae){var Se=v[C+0]+v[C+8],Pe=v[C+0]-v[C+8],Ke=(35468*v[C+4]>>16)-ea(v[C+12]),it=ea(v[C+4])+(35468*v[C+12]>>16);be[we+0]=Se+it,be[we+1]=Pe+Ke,be[we+2]=Pe-Ke,be[we+3]=Se-it,we+=4,C++}for(Ae=we=0;4>Ae;++Ae)Se=(v=be[we+0]+4)+be[we+8],Pe=v-be[we+8],Ke=(35468*be[we+4]>>16)-ea(be[we+12]),Mi(Q,X,0,0,Se+(it=ea(be[we+4])+(35468*be[we+12]>>16))),Mi(Q,X,1,0,Pe+Ke),Mi(Q,X,2,0,Pe-Ke),Mi(Q,X,3,0,Se-it),we++,X+=32}function RA(v,C,Q,X){var Ae=v[C+0]+4,we=35468*v[C+4]>>16,be=ea(v[C+4]),Se=35468*v[C+1]>>16;Ln(Q,X,0,Ae+be,v=ea(v[C+1]),Se),Ln(Q,X,1,Ae+we,v,Se),Ln(Q,X,2,Ae-we,v,Se),Ln(Q,X,3,Ae-be,v,Se)}function sf(v,C,Q,X,Ae){Pc(v,C,Q,X),Ae&&Pc(v,C+16,Q,X+4)}function Xr(v,C,Q,X){Id(v,C+0,Q,X,1),Id(v,C+32,Q,X+128,1)}function Rc(v,C,Q,X){var Ae;for(v=v[C+0]+4,Ae=0;4>Ae;++Ae)for(C=0;4>C;++C)Mi(Q,X,C,Ae,v)}function Xl(v,C,Q,X){v[C+0]&&gn(v,C+0,Q,X),v[C+16]&&gn(v,C+16,Q,X+4),v[C+32]&&gn(v,C+32,Q,X+128),v[C+48]&&gn(v,C+48,Q,X+128+4)}function Do(v,C,Q,X){var Ae,we=a(16);for(Ae=0;4>Ae;++Ae){var be=v[C+0+Ae]+v[C+12+Ae],Se=v[C+4+Ae]+v[C+8+Ae],Pe=v[C+4+Ae]-v[C+8+Ae],Ke=v[C+0+Ae]-v[C+12+Ae];we[0+Ae]=be+Se,we[8+Ae]=be-Se,we[4+Ae]=Ke+Pe,we[12+Ae]=Ke-Pe}for(Ae=0;4>Ae;++Ae)be=(v=we[0+4*Ae]+3)+we[3+4*Ae],Se=we[1+4*Ae]+we[2+4*Ae],Pe=we[1+4*Ae]-we[2+4*Ae],Ke=v-we[3+4*Ae],Q[X+0]=be+Se>>3,Q[X+16]=Ke+Pe>>3,Q[X+32]=be-Se>>3,Q[X+48]=Ke-Pe>>3,X+=64}function Dc(v,C,Q){var X,Ae=C-32,we=lo,be=255-v[Ae-1];for(X=0;X<Q;++X){var Se,Pe=we,Ke=be+v[C-1];for(Se=0;Se<Q;++Se)v[C+Se]=Pe[Ke+v[Ae+Se]];C+=32}}function af(v,C){Dc(v,C,4)}function dm(v,C){Dc(v,C,8)}function hm(v,C){Dc(v,C,16)}function bd(v,C){var Q;for(Q=0;16>Q;++Q)n(v,C+32*Q,v,C-32,16)}function of(v,C){var Q;for(Q=16;0<Q;--Q)s(v,C,v[C-1],16),C+=32}function ka(v,C,Q){var X;for(X=0;16>X;++X)s(C,Q+32*X,v,16)}function Lo(v,C){var Q,X=16;for(Q=0;16>Q;++Q)X+=v[C-1+32*Q]+v[C+Q-32];ka(X>>5,v,C)}function Yl(v,C){var Q,X=8;for(Q=0;16>Q;++Q)X+=v[C-1+32*Q];ka(X>>4,v,C)}function DA(v,C){var Q,X=8;for(Q=0;16>Q;++Q)X+=v[C+Q-32];ka(X>>4,v,C)}function lf(v,C){ka(128,v,C)}function yr(v,C,Q){return v+2*C+Q+2>>2}function fm(v,C){var Q,X=C-32;for(X=new Uint8Array([yr(v[X-1],v[X+0],v[X+1]),yr(v[X+0],v[X+1],v[X+2]),yr(v[X+1],v[X+2],v[X+3]),yr(v[X+2],v[X+3],v[X+4])]),Q=0;4>Q;++Q)n(v,C+32*Q,X,0,X.length)}function mm(v,C){var Q=v[C-1],X=v[C-1+32],Ae=v[C-1+64],we=v[C-1+96];ve(v,C+0,16843009*yr(v[C-1-32],Q,X)),ve(v,C+32,16843009*yr(Q,X,Ae)),ve(v,C+64,16843009*yr(X,Ae,we)),ve(v,C+96,16843009*yr(Ae,we,we))}function pm(v,C){var Q,X=4;for(Q=0;4>Q;++Q)X+=v[C+Q-32]+v[C-1+32*Q];for(X>>=3,Q=0;4>Q;++Q)s(v,C+32*Q,X,4)}function xa(v,C){var Q=v[C-1+0],X=v[C-1+32],Ae=v[C-1+64],we=v[C-1-32],be=v[C+0-32],Se=v[C+1-32],Pe=v[C+2-32],Ke=v[C+3-32];v[C+0+96]=yr(X,Ae,v[C-1+96]),v[C+1+96]=v[C+0+64]=yr(Q,X,Ae),v[C+2+96]=v[C+1+64]=v[C+0+32]=yr(we,Q,X),v[C+3+96]=v[C+2+64]=v[C+1+32]=v[C+0+0]=yr(be,we,Q),v[C+3+64]=v[C+2+32]=v[C+1+0]=yr(Se,be,we),v[C+3+32]=v[C+2+0]=yr(Pe,Se,be),v[C+3+0]=yr(Ke,Pe,Se)}function gl(v,C){var Q=v[C+1-32],X=v[C+2-32],Ae=v[C+3-32],we=v[C+4-32],be=v[C+5-32],Se=v[C+6-32],Pe=v[C+7-32];v[C+0+0]=yr(v[C+0-32],Q,X),v[C+1+0]=v[C+0+32]=yr(Q,X,Ae),v[C+2+0]=v[C+1+32]=v[C+0+64]=yr(X,Ae,we),v[C+3+0]=v[C+2+32]=v[C+1+64]=v[C+0+96]=yr(Ae,we,be),v[C+3+32]=v[C+2+64]=v[C+1+96]=yr(we,be,Se),v[C+3+64]=v[C+2+96]=yr(be,Se,Pe),v[C+3+96]=yr(Se,Pe,Pe)}function gm(v,C){var Q=v[C-1+0],X=v[C-1+32],Ae=v[C-1+64],we=v[C-1-32],be=v[C+0-32],Se=v[C+1-32],Pe=v[C+2-32],Ke=v[C+3-32];v[C+0+0]=v[C+1+64]=we+be+1>>1,v[C+1+0]=v[C+2+64]=be+Se+1>>1,v[C+2+0]=v[C+3+64]=Se+Pe+1>>1,v[C+3+0]=Pe+Ke+1>>1,v[C+0+96]=yr(Ae,X,Q),v[C+0+64]=yr(X,Q,we),v[C+0+32]=v[C+1+96]=yr(Q,we,be),v[C+1+32]=v[C+2+96]=yr(we,be,Se),v[C+2+32]=v[C+3+96]=yr(be,Se,Pe),v[C+3+32]=yr(Se,Pe,Ke)}function LA(v,C){var Q=v[C+0-32],X=v[C+1-32],Ae=v[C+2-32],we=v[C+3-32],be=v[C+4-32],Se=v[C+5-32],Pe=v[C+6-32],Ke=v[C+7-32];v[C+0+0]=Q+X+1>>1,v[C+1+0]=v[C+0+64]=X+Ae+1>>1,v[C+2+0]=v[C+1+64]=Ae+we+1>>1,v[C+3+0]=v[C+2+64]=we+be+1>>1,v[C+0+32]=yr(Q,X,Ae),v[C+1+32]=v[C+0+96]=yr(X,Ae,we),v[C+2+32]=v[C+1+96]=yr(Ae,we,be),v[C+3+32]=v[C+2+96]=yr(we,be,Se),v[C+3+64]=yr(be,Se,Pe),v[C+3+96]=yr(Se,Pe,Ke)}function xl(v,C){var Q=v[C-1+0],X=v[C-1+32],Ae=v[C-1+64],we=v[C-1+96];v[C+0+0]=Q+X+1>>1,v[C+2+0]=v[C+0+32]=X+Ae+1>>1,v[C+2+32]=v[C+0+64]=Ae+we+1>>1,v[C+1+0]=yr(Q,X,Ae),v[C+3+0]=v[C+1+32]=yr(X,Ae,we),v[C+3+32]=v[C+1+64]=yr(Ae,we,we),v[C+3+64]=v[C+2+64]=v[C+0+96]=v[C+1+96]=v[C+2+96]=v[C+3+96]=we}function UA(v,C){var Q=v[C-1+0],X=v[C-1+32],Ae=v[C-1+64],we=v[C-1+96],be=v[C-1-32],Se=v[C+0-32],Pe=v[C+1-32],Ke=v[C+2-32];v[C+0+0]=v[C+2+32]=Q+be+1>>1,v[C+0+32]=v[C+2+64]=X+Q+1>>1,v[C+0+64]=v[C+2+96]=Ae+X+1>>1,v[C+0+96]=we+Ae+1>>1,v[C+3+0]=yr(Se,Pe,Ke),v[C+2+0]=yr(be,Se,Pe),v[C+1+0]=v[C+3+32]=yr(Q,be,Se),v[C+1+32]=v[C+3+64]=yr(X,Q,be),v[C+1+64]=v[C+3+96]=yr(Ae,X,Q),v[C+1+96]=yr(we,Ae,X)}function so(v,C){var Q;for(Q=0;8>Q;++Q)n(v,C+32*Q,v,C-32,8)}function Lc(v,C){var Q;for(Q=0;8>Q;++Q)s(v,C,v[C-1],8),C+=32}function Uo(v,C,Q){var X;for(X=0;8>X;++X)s(C,Q+32*X,v,8)}function Nd(v,C){var Q,X=8;for(Q=0;8>Q;++Q)X+=v[C+Q-32]+v[C-1+32*Q];Uo(X>>4,v,C)}function Tn(v,C){var Q,X=4;for(Q=0;8>Q;++Q)X+=v[C+Q-32];Uo(X>>3,v,C)}function Cd(v,C){var Q,X=4;for(Q=0;8>Q;++Q)X+=v[C-1+32*Q];Uo(X>>3,v,C)}function cf(v,C){Uo(128,v,C)}function Oo(v,C,Q){var X=v[C-Q],Ae=v[C+0],we=3*(Ae-X)+tb[1020+v[C-2*Q]-v[C+Q]],be=zx[112+(we+4>>3)];v[C-Q]=lo[255+X+zx[112+(we+3>>3)]],v[C+0]=lo[255+Ae-be]}function OA(v,C,Q,X){var Ae=v[C+0],we=v[C+Q];return qo[255+v[C-2*Q]-v[C-Q]]>X||qo[255+we-Ae]>X}function Uc(v,C,Q,X){return 4*qo[255+v[C-Q]-v[C+0]]+qo[255+v[C-2*Q]-v[C+Q]]<=X}function Zl(v,C,Q,X,Ae){var we=v[C-3*Q],be=v[C-2*Q],Se=v[C-Q],Pe=v[C+0],Ke=v[C+Q],it=v[C+2*Q],xt=v[C+3*Q];return 4*qo[255+Se-Pe]+qo[255+be-Ke]>X?0:qo[255+v[C-4*Q]-we]<=Ae&&qo[255+we-be]<=Ae&&qo[255+be-Se]<=Ae&&qo[255+xt-it]<=Ae&&qo[255+it-Ke]<=Ae&&qo[255+Ke-Pe]<=Ae}function ec(v,C,Q,X){var Ae=2*X+1;for(X=0;16>X;++X)Uc(v,C+X,Q,Ae)&&Oo(v,C+X,Q)}function wi(v,C,Q,X){var Ae=2*X+1;for(X=0;16>X;++X)Uc(v,C+X*Q,1,Ae)&&Oo(v,C+X*Q,1)}function _d(v,C,Q,X){var Ae;for(Ae=3;0<Ae;--Ae)ec(v,C+=4*Q,Q,X)}function Af(v,C,Q,X){var Ae;for(Ae=3;0<Ae;--Ae)wi(v,C+=4,Q,X)}function yi(v,C,Q,X,Ae,we,be,Se){for(we=2*we+1;0<Ae--;){if(Zl(v,C,Q,we,be))if(OA(v,C,Q,Se))Oo(v,C,Q);else{var Pe=v,Ke=C,it=Q,xt=Pe[Ke-2*it],qe=Pe[Ke-it],lt=Pe[Ke+0],mt=Pe[Ke+it],_t=Pe[Ke+2*it],pt=27*(It=tb[1020+3*(lt-qe)+tb[1020+xt-mt]])+63>>7,St=18*It+63>>7,It=9*It+63>>7;Pe[Ke-3*it]=lo[255+Pe[Ke-3*it]+It],Pe[Ke-2*it]=lo[255+xt+St],Pe[Ke-it]=lo[255+qe+pt],Pe[Ke+0]=lo[255+lt-pt],Pe[Ke+it]=lo[255+mt-St],Pe[Ke+2*it]=lo[255+_t-It]}C+=X}}function Mo(v,C,Q,X,Ae,we,be,Se){for(we=2*we+1;0<Ae--;){if(Zl(v,C,Q,we,be))if(OA(v,C,Q,Se))Oo(v,C,Q);else{var Pe=v,Ke=C,it=Q,xt=Pe[Ke-it],qe=Pe[Ke+0],lt=Pe[Ke+it],mt=zx[112+(4+(_t=3*(qe-xt))>>3)],_t=zx[112+(_t+3>>3)],pt=mt+1>>1;Pe[Ke-2*it]=lo[255+Pe[Ke-2*it]+pt],Pe[Ke-it]=lo[255+xt+_t],Pe[Ke+0]=lo[255+qe-mt],Pe[Ke+it]=lo[255+lt-pt]}C+=X}}function MA(v,C,Q,X,Ae,we){yi(v,C,Q,1,16,X,Ae,we)}function Qo(v,C,Q,X,Ae,we){yi(v,C,1,Q,16,X,Ae,we)}function Ed(v,C,Q,X,Ae,we){var be;for(be=3;0<be;--be)Mo(v,C+=4*Q,Q,1,16,X,Ae,we)}function L(v,C,Q,X,Ae,we){var be;for(be=3;0<be;--be)Mo(v,C+=4,1,Q,16,X,Ae,we)}function ce(v,C,Q,X,Ae,we,be,Se){yi(v,C,Ae,1,8,we,be,Se),yi(Q,X,Ae,1,8,we,be,Se)}function He(v,C,Q,X,Ae,we,be,Se){yi(v,C,1,Ae,8,we,be,Se),yi(Q,X,1,Ae,8,we,be,Se)}function rt(v,C,Q,X,Ae,we,be,Se){Mo(v,C+4*Ae,Ae,1,8,we,be,Se),Mo(Q,X+4*Ae,Ae,1,8,we,be,Se)}function dt(v,C,Q,X,Ae,we,be,Se){Mo(v,C+4,1,Ae,8,we,be,Se),Mo(Q,X+4,1,Ae,8,we,be,Se)}function Bt(){this.ba=new ot,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function jt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function nr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function dr(){this.ua=0,this.Wa=new ie,this.vb=new ie,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new pe,this.yc=new U}function br(){this.xb=this.a=0,this.l=new Oi,this.ca=new ot,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new I,this.Pb=0,this.wd=new I,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new dr,this.ab=0,this.gc=o(4,nr),this.Oc=0}function Fr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Oi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Yr(v,C,Q,X,Ae,we,be){for(v=v==null?0:v[C+0],C=0;C<be;++C)Ae[we+C]=v+Q[X+C]&255,v=Ae[we+C]}function pn(v,C,Q,X,Ae,we,be){var Se;if(v==null)Yr(null,null,Q,X,Ae,we,be);else for(Se=0;Se<be;++Se)Ae[we+Se]=v[C+Se]+Q[X+Se]&255}function hs(v,C,Q,X,Ae,we,be){if(v==null)Yr(null,null,Q,X,Ae,we,be);else{var Se,Pe=v[C+0],Ke=Pe,it=Pe;for(Se=0;Se<be;++Se)Ke=it+(Pe=v[C+Se])-Ke,it=Q[X+Se]+(-256&Ke?0>Ke?0:255:Ke)&255,Ke=Pe,Ae[we+Se]=it}}function vn(v,C,Q,X){var Ae=C.width,we=C.o;if(e(v!=null&&C!=null),0>Q||0>=X||Q+X>we)return null;if(!v.Cc){if(v.ga==null){var be;if(v.ga=new Fr,(be=v.ga==null)||(be=C.width*C.o,e(v.Gb.length==0),v.Gb=a(be),v.Uc=0,v.Gb==null?be=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,be=1),be=!be),!be){be=v.ga;var Se=v.Fa,Pe=v.P,Ke=v.qc,it=v.mb,xt=v.nb,qe=Pe+1,lt=Ke-1,mt=be.l;if(e(Se!=null&&it!=null&&C!=null),WA[0]=null,WA[1]=Yr,WA[2]=pn,WA[3]=hs,be.ca=it,be.tb=xt,be.c=C.width,be.i=C.height,e(0<be.c&&0<be.i),1>=Ke)C=0;else if(be.$a=3&Se[Pe+0],be.Z=Se[Pe+0]>>2&3,be.Lc=Se[Pe+0]>>4&3,Pe=Se[Pe+0]>>6&3,0>be.$a||1<be.$a||4<=be.Z||1<be.Lc||Pe)C=0;else if(mt.put=et,mt.ac=er,mt.bc=gt,mt.ma=be,mt.width=C.width,mt.height=C.height,mt.Da=C.Da,mt.v=C.v,mt.va=C.va,mt.j=C.j,mt.o=C.o,be.$a)e:{e(be.$a==1),C=ye();t:for(;;){if(C==null){C=0;break e}if(e(be!=null),be.mc=C,C.c=be.c,C.i=be.i,C.l=be.l,C.l.ma=be,C.l.width=be.c,C.l.height=be.i,C.a=0,re(C.m,Se,qe,lt),!Me(be.c,be.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&K(C.s)?(be.ic=1,Se=C.c*C.i,C.Ta=null,C.Ua=0,C.V=a(Se),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(be.ic=0,C=Le(C,be.c)),!C))break t;C=1;break e}be.mc=null,C=0}else C=lt>=be.c*be.i;be=!C}if(be)return null;v.ga.Lc!=1?v.Ga=0:X=we-Q}e(v.ga!=null),e(Q+X<=we);e:{if(C=(Se=v.ga).c,we=Se.l.o,Se.$a==0){if(qe=v.rc,lt=v.Vc,mt=v.Fa,Pe=v.P+1+Q*C,Ke=v.mb,it=v.nb+Q*C,e(Pe<=v.P+v.qc),Se.Z!=0)for(e(WA[Se.Z]!=null),be=0;be<X;++be)WA[Se.Z](qe,lt,mt,Pe,Ke,it,C),qe=Ke,lt=it,it+=C,Pe+=C;else for(be=0;be<X;++be)n(Ke,it,mt,Pe,C),qe=Ke,lt=it,it+=C,Pe+=C;v.rc=qe,v.Vc=lt}else{if(e(Se.mc!=null),C=Q+X,e((be=Se.mc)!=null),e(C<=be.i),be.C>=C)C=1;else if(Se.ic||Qi(),Se.ic){Se=be.V,qe=be.Ba,lt=be.c;var _t=be.i,pt=(mt=1,Pe=be.$/lt,Ke=be.$%lt,it=be.m,xt=be.s,be.$),St=lt*_t,It=lt*C,Ot=xt.wc,Dt=pt<It?oe(xt,Ke,Pe):null;e(pt<=St),e(C<=_t),e(K(xt));t:for(;;){for(;!it.h&&pt<It;){if(Ke&Ot||(Dt=oe(xt,Ke,Pe)),e(Dt!=null),W(it),256>(_t=Xt(Dt.G[0],Dt.H[0],it)))Se[qe+pt]=_t,++pt,++Ke>=lt&&(Ke=0,++Pe<=C&&!(Pe%16)&&me(be,Pe));else{if(!(280>_t)){mt=0;break t}_t=Ft(_t-256,it);var pr,or=Xt(Dt.G[4],Dt.H[4],it);if(W(it),!(pt>=(or=Tt(lt,or=Ft(or,it)))&&St-pt>=_t)){mt=0;break t}for(pr=0;pr<_t;++pr)Se[qe+pt+pr]=Se[qe+pt+pr-or];for(pt+=_t,Ke+=_t;Ke>=lt;)Ke-=lt,++Pe<=C&&!(Pe%16)&&me(be,Pe);pt<It&&Ke&Ot&&(Dt=oe(xt,Ke,Pe))}e(it.h==j(it))}me(be,Pe>C?C:Pe);break t}!mt||it.h&&pt<St?(mt=0,be.a=it.h?5:3):be.$=pt,C=mt}else C=Re(be,be.V,be.Ba,be.c,be.i,C,Je);if(!C){X=0;break e}}Q+X>=we&&(v.Cc=1),X=1}if(!X)return null;if(v.Cc&&((X=v.ga)!=null&&(X.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+Q*Ae}function Ns(v,C,Q,X,Ae,we){for(;0<Ae--;){var be,Se=v,Pe=C+(Q?1:0),Ke=v,it=C+(Q?0:3);for(be=0;be<X;++be){var xt=Ke[it+4*be];xt!=255&&(xt*=32897,Se[Pe+4*be+0]=Se[Pe+4*be+0]*xt>>23,Se[Pe+4*be+1]=Se[Pe+4*be+1]*xt>>23,Se[Pe+4*be+2]=Se[Pe+4*be+2]*xt>>23)}C+=we}}function fs(v,C,Q,X,Ae){for(;0<X--;){var we;for(we=0;we<Q;++we){var be=v[C+2*we+0],Se=15&(Ke=v[C+2*we+1]),Pe=4369*Se,Ke=(240&Ke|Ke>>4)*Pe>>16;v[C+2*we+0]=(240&be|be>>4)*Pe>>16&240|(15&be|be<<4)*Pe>>16>>4&15,v[C+2*we+1]=240&Ke|Se}C+=Ae}}function Cs(v,C,Q,X,Ae,we,be,Se){var Pe,Ke,it=255;for(Ke=0;Ke<Ae;++Ke){for(Pe=0;Pe<X;++Pe){var xt=v[C+Pe];we[be+4*Pe]=xt,it&=xt}C+=Q,be+=Se}return it!=255}function ms(v,C,Q,X,Ae){var we;for(we=0;we<Ae;++we)Q[X+we]=v[C+we]>>8}function Qi(){Em=Ns,JI=fs,XI=Cs,YI=ms}function Vo(v,C,Q){E[v]=function(X,Ae,we,be,Se,Pe,Ke,it,xt,qe,lt,mt,_t,pt,St,It,Ot){var Dt,pr=Ot-1>>1,or=Se[Pe+0]|Ke[it+0]<<16,Lr=xt[qe+0]|lt[mt+0]<<16;e(X!=null);var hr=3*or+Lr+131074>>2;for(C(X[Ae+0],255&hr,hr>>16,_t,pt),we!=null&&(hr=3*Lr+or+131074>>2,C(we[be+0],255&hr,hr>>16,St,It)),Dt=1;Dt<=pr;++Dt){var sn=Se[Pe+Dt]|Ke[it+Dt]<<16,ra=xt[qe+Dt]|lt[mt+Dt]<<16,Ur=or+sn+Lr+ra+524296,fr=Ur+2*(sn+Lr)>>3;hr=fr+or>>1,or=(Ur=Ur+2*(or+ra)>>3)+sn>>1,C(X[Ae+2*Dt-1],255&hr,hr>>16,_t,pt+(2*Dt-1)*Q),C(X[Ae+2*Dt-0],255&or,or>>16,_t,pt+(2*Dt-0)*Q),we!=null&&(hr=Ur+Lr>>1,or=fr+ra>>1,C(we[be+2*Dt-1],255&hr,hr>>16,St,It+(2*Dt-1)*Q),C(we[be+2*Dt+0],255&or,or>>16,St,It+(2*Dt+0)*Q)),or=sn,Lr=ra}1&Ot||(hr=3*or+Lr+131074>>2,C(X[Ae+Ot-1],255&hr,hr>>16,_t,pt+(Ot-1)*Q),we!=null&&(hr=3*Lr+or+131074>>2,C(we[be+Ot-1],255&hr,hr>>16,St,It+(Ot-1)*Q)))}}function Ho(){Go[Wx]=S7,Go[Jx]=c5,Go[s5]=I7,Go[Xx]=A5,Go[Yx]=u5,Go[rb]=d5,Go[a5]=F7,Go[nb]=c5,Go[sb]=A5,Go[Zx]=u5,Go[ab]=d5}function w(v){return v&-16384?0>v?0:255:v>>k7}function H(v,C){return w((19077*v>>8)+(26149*C>>8)-14234)}function ee(v,C,Q){return w((19077*v>>8)-(6419*C>>8)-(13320*Q>>8)+8708)}function ke(v,C){return w((19077*v>>8)+(33050*C>>8)-17685)}function ht(v,C,Q,X,Ae){X[Ae+0]=H(v,Q),X[Ae+1]=ee(v,C,Q),X[Ae+2]=ke(v,C)}function yt(v,C,Q,X,Ae){X[Ae+0]=ke(v,C),X[Ae+1]=ee(v,C,Q),X[Ae+2]=H(v,Q)}function Gt(v,C,Q,X,Ae){var we=ee(v,C,Q);C=we<<3&224|ke(v,C)>>3,X[Ae+0]=248&H(v,Q)|we>>5,X[Ae+1]=C}function nn(v,C,Q,X,Ae){var we=240&ke(v,C)|15;X[Ae+0]=240&H(v,Q)|ee(v,C,Q)>>4,X[Ae+1]=we}function ps(v,C,Q,X,Ae){X[Ae+0]=255,ht(v,C,Q,X,Ae+1)}function qr(v,C,Q,X,Ae){yt(v,C,Q,X,Ae),X[Ae+3]=255}function hn(v,C,Q,X,Ae){ht(v,C,Q,X,Ae),X[Ae+3]=255}function Hn(v,C,Q){E[v]=function(X,Ae,we,be,Se,Pe,Ke,it,xt){for(var qe=it+(-2&xt)*Q;it!=qe;)C(X[Ae+0],we[be+0],Se[Pe+0],Ke,it),C(X[Ae+1],we[be+0],Se[Pe+0],Ke,it+Q),Ae+=2,++be,++Pe,it+=2*Q;1&xt&&C(X[Ae+0],we[be+0],Se[Pe+0],Ke,it)}}function ao(v,C,Q){return Q==0?v==0?C==0?6:5:C==0?4:0:Q}function Ja(v,C,Q,X,Ae){switch(v>>>30){case 3:Id(C,Q,X,Ae,0);break;case 2:Ko(C,Q,X,Ae);break;case 1:gn(C,Q,X,Ae)}}function Ta(v,C){var Q,X,Ae=C.M,we=C.Nb,be=v.oc,Se=v.pc+40,Pe=v.oc,Ke=v.pc+584,it=v.oc,xt=v.pc+600;for(Q=0;16>Q;++Q)be[Se+32*Q-1]=129;for(Q=0;8>Q;++Q)Pe[Ke+32*Q-1]=129,it[xt+32*Q-1]=129;for(0<Ae?be[Se-1-32]=Pe[Ke-1-32]=it[xt-1-32]=129:(s(be,Se-32-1,127,21),s(Pe,Ke-32-1,127,9),s(it,xt-32-1,127,9)),X=0;X<v.za;++X){var qe=C.ya[C.aa+X];if(0<X){for(Q=-1;16>Q;++Q)n(be,Se+32*Q-4,be,Se+32*Q+12,4);for(Q=-1;8>Q;++Q)n(Pe,Ke+32*Q-4,Pe,Ke+32*Q+4,4),n(it,xt+32*Q-4,it,xt+32*Q+4,4)}var lt=v.Gd,mt=v.Hd+X,_t=qe.ad,pt=qe.Hc;if(0<Ae&&(n(be,Se-32,lt[mt].y,0,16),n(Pe,Ke-32,lt[mt].f,0,8),n(it,xt-32,lt[mt].ea,0,8)),qe.Za){var St=be,It=Se-32+16;for(0<Ae&&(X>=v.za-1?s(St,It,lt[mt].y[15],4):n(St,It,lt[mt+1].y,0,4)),Q=0;4>Q;Q++)St[It+128+Q]=St[It+256+Q]=St[It+384+Q]=St[It+0+Q];for(Q=0;16>Q;++Q,pt<<=2)St=be,It=Se+f5[Q],wl[qe.Ob[Q]](St,It),Ja(pt,_t,16*+Q,St,It)}else if(St=ao(X,Ae,qe.Ob[0]),zA[St](be,Se),pt!=0)for(Q=0;16>Q;++Q,pt<<=2)Ja(pt,_t,16*+Q,be,Se+f5[Q]);for(Q=qe.Gc,St=ao(X,Ae,qe.Dd),Qc[St](Pe,Ke),Qc[St](it,xt),pt=_t,St=Pe,It=Ke,255&(qe=0|Q)&&(170&qe?nc(pt,256,St,It):Un(pt,256,St,It)),qe=it,pt=xt,255&(Q>>=8)&&(170&Q?nc(_t,320,qe,pt):Un(_t,320,qe,pt)),Ae<v.Ub-1&&(n(lt[mt].y,0,be,Se+480,16),n(lt[mt].f,0,Pe,Ke+224,8),n(lt[mt].ea,0,it,xt+224,8)),Q=8*we*v.B,lt=v.sa,mt=v.ta+16*X+16*we*v.R,_t=v.qa,qe=v.ra+8*X+Q,pt=v.Ha,St=v.Ia+8*X+Q,Q=0;16>Q;++Q)n(lt,mt+Q*v.R,be,Se+32*Q,16);for(Q=0;8>Q;++Q)n(_t,qe+Q*v.B,Pe,Ke+32*Q,8),n(pt,St+Q*v.B,it,xt+32*Q,8)}}function vl(v,C,Q,X,Ae,we,be,Se,Pe){var Ke=[0],it=[0],xt=0,qe=Pe!=null?Pe.kd:0,lt=Pe??new jt;if(v==null||12>Q)return 7;lt.data=v,lt.w=C,lt.ha=Q,C=[C],Q=[Q],lt.gb=[lt.gb];e:{var mt=C,_t=Q,pt=lt.gb;if(e(v!=null),e(_t!=null),e(pt!=null),pt[0]=0,12<=_t[0]&&!r(v,mt[0],"RIFF")){if(r(v,mt[0]+8,"WEBP")){pt=3;break e}var St=te(v,mt[0]+4);if(12>St||4294967286<St){pt=3;break e}if(qe&&St>_t[0]-8){pt=7;break e}pt[0]=St,mt[0]+=12,_t[0]-=12}pt=0}if(pt!=0)return pt;for(St=0<lt.gb[0],Q=Q[0];;){e:{var It=v;_t=C,pt=Q;var Ot=Ke,Dt=it,pr=mt=[0];if((hr=xt=[xt])[0]=0,8>pt[0])pt=7;else{if(!r(It,_t[0],"VP8X")){if(te(It,_t[0]+4)!=10){pt=3;break e}if(18>pt[0]){pt=7;break e}var or=te(It,_t[0]+8),Lr=1+Oe(It,_t[0]+12);if(2147483648<=Lr*(It=1+Oe(It,_t[0]+15))){pt=3;break e}pr!=null&&(pr[0]=or),Ot!=null&&(Ot[0]=Lr),Dt!=null&&(Dt[0]=It),_t[0]+=18,pt[0]-=18,hr[0]=1}pt=0}}if(xt=xt[0],mt=mt[0],pt!=0)return pt;if(_t=!!(2&mt),!St&&xt)return 3;if(we!=null&&(we[0]=!!(16&mt)),be!=null&&(be[0]=_t),Se!=null&&(Se[0]=0),be=Ke[0],mt=it[0],xt&&_t&&Pe==null){pt=0;break}if(4>Q){pt=7;break}if(St&&xt||!St&&!xt&&!r(v,C[0],"ALPH")){Q=[Q],lt.na=[lt.na],lt.P=[lt.P],lt.Sa=[lt.Sa];e:{or=v,pt=C,St=Q;var hr=lt.gb;Ot=lt.na,Dt=lt.P,pr=lt.Sa,Lr=22,e(or!=null),e(St!=null),It=pt[0];var sn=St[0];for(e(Ot!=null),e(pr!=null),Ot[0]=null,Dt[0]=null,pr[0]=0;;){if(pt[0]=It,St[0]=sn,8>sn){pt=7;break e}var ra=te(or,It+4);if(4294967286<ra){pt=3;break e}var Ur=8+ra+1&-2;if(Lr+=Ur,0<hr&&Lr>hr){pt=3;break e}if(!r(or,It,"VP8 ")||!r(or,It,"VP8L")){pt=0;break e}if(sn[0]<Ur){pt=7;break e}r(or,It,"ALPH")||(Ot[0]=or,Dt[0]=It+8,pr[0]=ra),It+=Ur,sn-=Ur}}if(Q=Q[0],lt.na=lt.na[0],lt.P=lt.P[0],lt.Sa=lt.Sa[0],pt!=0)break}Q=[Q],lt.Ja=[lt.Ja],lt.xa=[lt.xa];e:if(hr=v,pt=C,St=Q,Ot=lt.gb[0],Dt=lt.Ja,pr=lt.xa,or=pt[0],It=!r(hr,or,"VP8 "),Lr=!r(hr,or,"VP8L"),e(hr!=null),e(St!=null),e(Dt!=null),e(pr!=null),8>St[0])pt=7;else{if(It||Lr){if(hr=te(hr,or+4),12<=Ot&&hr>Ot-12){pt=3;break e}if(qe&&hr>St[0]-8){pt=7;break e}Dt[0]=hr,pt[0]+=8,St[0]-=8,pr[0]=Lr}else pr[0]=5<=St[0]&&hr[or+0]==47&&!(hr[or+4]>>5),Dt[0]=St[0];pt=0}if(Q=Q[0],lt.Ja=lt.Ja[0],lt.xa=lt.xa[0],C=C[0],pt!=0)break;if(4294967286<lt.Ja)return 3;if(Se==null||_t||(Se[0]=lt.xa?2:1),be=[be],mt=[mt],lt.xa){if(5>Q){pt=7;break}Se=be,qe=mt,_t=we,v==null||5>Q?v=0:5<=Q&&v[C+0]==47&&!(v[C+4]>>5)?(St=[0],hr=[0],Ot=[0],re(Dt=new I,v,C,Q),Pt(Dt,St,hr,Ot)?(Se!=null&&(Se[0]=St[0]),qe!=null&&(qe[0]=hr[0]),_t!=null&&(_t[0]=Ot[0]),v=1):v=0):v=0}else{if(10>Q){pt=7;break}Se=mt,v==null||10>Q||!nf(v,C+3,Q-3)?v=0:(qe=v[C+0]|v[C+1]<<8|v[C+2]<<16,_t=16383&(v[C+7]<<8|v[C+6]),v=16383&(v[C+9]<<8|v[C+8]),1&qe||3<(qe>>1&7)||!(qe>>4&1)||qe>>5>=lt.Ja||!_t||!v?v=0:(be&&(be[0]=_t),Se&&(Se[0]=v),v=1))}if(!v||(be=be[0],mt=mt[0],xt&&(Ke[0]!=be||it[0]!=mt)))return 3;Pe!=null&&(Pe[0]=lt,Pe.offset=C-Pe.w,e(4294967286>C-Pe.w),e(Pe.offset==Pe.ha-Q));break}return pt==0||pt==7&&xt&&Pe==null?(we!=null&&(we[0]|=lt.na!=null&&0<lt.na.length),X!=null&&(X[0]=be),Ae!=null&&(Ae[0]=mt),0):pt}function xm(v,C,Q){var X=C.width,Ae=C.height,we=0,be=0,Se=X,Pe=Ae;if(C.Da=v!=null&&0<v.Da,C.Da&&(Se=v.cd,Pe=v.bd,we=v.v,be=v.j,11>Q||(we&=-2,be&=-2),0>we||0>be||0>=Se||0>=Pe||we+Se>X||be+Pe>Ae))return 0;if(C.v=we,C.j=be,C.va=we+Se,C.o=be+Pe,C.U=Se,C.T=Pe,C.da=v!=null&&0<v.da,C.da){if(!fe(Se,Pe,Q=[v.ib],we=[v.hb]))return 0;C.ib=Q[0],C.hb=we[0]}return C.ob=v!=null&&v.ob,C.Kb=v==null||!v.Sd,C.da&&(C.ob=C.ib<3*X/4&&C.hb<3*Ae/4,C.Kb=0),1}function vm(v){if(v==null)return 2;if(11>v.S){var C=v.f.RGBA;C.fb+=(v.height-1)*C.A,C.A=-C.A}else C=v.f.kb,v=v.height,C.O+=(v-1)*C.fa,C.fa=-C.fa,C.N+=(v-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(v-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(v-1)*C.lb,C.lb=-C.lb);return 0}function QA(v,C,Q,X){if(X==null||0>=v||0>=C)return 2;if(Q!=null){if(Q.Da){var Ae=Q.cd,we=Q.bd,be=-2&Q.v,Se=-2&Q.j;if(0>be||0>Se||0>=Ae||0>=we||be+Ae>v||Se+we>C)return 2;v=Ae,C=we}if(Q.da){if(!fe(v,C,Ae=[Q.ib],we=[Q.hb]))return 2;v=Ae[0],C=we[0]}}X.width=v,X.height=C;e:{var Pe=X.width,Ke=X.height;if(v=X.S,0>=Pe||0>=Ke||!(v>=Wx&&13>v))v=2;else{if(0>=X.Rd&&X.sd==null){be=we=Ae=C=0;var it=(Se=Pe*m5[v])*Ke;if(11>v||(we=(Ke+1)/2*(C=(Pe+1)/2),v==12&&(be=(Ae=Pe)*Ke)),(Ke=a(it+2*we+be))==null){v=1;break e}X.sd=Ke,11>v?((Pe=X.f.RGBA).eb=Ke,Pe.fb=0,Pe.A=Se,Pe.size=it):((Pe=X.f.kb).y=Ke,Pe.O=0,Pe.fa=Se,Pe.Fd=it,Pe.f=Ke,Pe.N=0+it,Pe.Ab=C,Pe.Cd=we,Pe.ea=Ke,Pe.W=0+it+we,Pe.Db=C,Pe.Ed=we,v==12&&(Pe.F=Ke,Pe.J=0+it+2*we),Pe.Tc=be,Pe.lb=Ae)}if(C=1,Ae=X.S,we=X.width,be=X.height,Ae>=Wx&&13>Ae)if(11>Ae)v=X.f.RGBA,C&=(Se=Math.abs(v.A))*(be-1)+we<=v.size,C&=Se>=we*m5[Ae],C&=v.eb!=null;else{v=X.f.kb,Se=(we+1)/2,it=(be+1)/2,Pe=Math.abs(v.fa),Ke=Math.abs(v.Ab);var xt=Math.abs(v.Db),qe=Math.abs(v.lb),lt=qe*(be-1)+we;C&=Pe*(be-1)+we<=v.Fd,C&=Ke*(it-1)+Se<=v.Cd,C=(C&=xt*(it-1)+Se<=v.Ed)&Pe>=we&Ke>=Se&xt>=Se,C&=v.y!=null,C&=v.f!=null,C&=v.ea!=null,Ae==12&&(C&=qe>=we,C&=lt<=v.Tc,C&=v.F!=null)}else C=0;v=C?0:2}}return v!=0||Q!=null&&Q.fd&&(v=vm(X)),v}var Bd=64,io=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],oo=24,VA=32,Oc=8,HA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ze("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(v){return v},E.Predictor2=function(v,C,Q){return C[Q+0]},E.Predictor3=function(v,C,Q){return C[Q+1]},E.Predictor4=function(v,C,Q){return C[Q-1]},E.Predictor5=function(v,C,Q){return ct(ct(v,C[Q+1]),C[Q+0])},E.Predictor6=function(v,C,Q){return ct(v,C[Q-1])},E.Predictor7=function(v,C,Q){return ct(v,C[Q+0])},E.Predictor8=function(v,C,Q){return ct(C[Q-1],C[Q+0])},E.Predictor9=function(v,C,Q){return ct(C[Q+0],C[Q+1])},E.Predictor10=function(v,C,Q){return ct(ct(v,C[Q-1]),ct(C[Q+0],C[Q+1]))},E.Predictor11=function(v,C,Q){var X=C[Q+0];return 0>=nt(X>>24&255,v>>24&255,(C=C[Q-1])>>24&255)+nt(X>>16&255,v>>16&255,C>>16&255)+nt(X>>8&255,v>>8&255,C>>8&255)+nt(255&X,255&v,255&C)?X:v},E.Predictor12=function(v,C,Q){var X=C[Q+0];return(st((v>>24&255)+(X>>24&255)-((C=C[Q-1])>>24&255))<<24|st((v>>16&255)+(X>>16&255)-(C>>16&255))<<16|st((v>>8&255)+(X>>8&255)-(C>>8&255))<<8|st((255&v)+(255&X)-(255&C)))>>>0},E.Predictor13=function(v,C,Q){var X=C[Q-1];return(ft((v=ct(v,C[Q+0]))>>24&255,X>>24&255)<<24|ft(v>>16&255,X>>16&255)<<16|ft(v>>8&255,X>>8&255)<<8|ft(255&v,255&X))>>>0};var wm=E.PredictorAdd0;E.PredictorAdd1=De,ze("Predictor2","PredictorAdd2"),ze("Predictor3","PredictorAdd3"),ze("Predictor4","PredictorAdd4"),ze("Predictor5","PredictorAdd5"),ze("Predictor6","PredictorAdd6"),ze("Predictor7","PredictorAdd7"),ze("Predictor8","PredictorAdd8"),ze("Predictor9","PredictorAdd9"),ze("Predictor10","PredictorAdd10"),ze("Predictor11","PredictorAdd11"),ze("Predictor12","PredictorAdd12"),ze("Predictor13","PredictorAdd13");var uf=E.PredictorAdd2;G("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),G("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var js,Gx=E.ColorIndexInverseTransform,tc=E.MapARGB,rc=E.VP8LColorIndexInverseTransformAlpha,ym=E.MapAlpha,bm=E.VP8LPredictorsAdd=[];bm.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var Nm,Cm,KA,qA,GA,Sd,$A,Id,Ko,nc,gn,Un,Ps,ta,Mc,_m,df,$x,KI,qI,GI,$I,zI,WI,Em,JI,XI,YI,ZI=a(511),e5=a(2041),t5=a(225),r5=a(767),n5=0,tb=e5,zx=t5,lo=r5,qo=ZI,Wx=0,Jx=1,s5=2,Xx=3,Yx=4,rb=5,a5=6,nb=7,sb=8,Zx=9,ab=10,f7=[2,3,7],m7=[3,3,11],i5=[280,256,256,256,40],p7=[0,1,1,1,0],g7=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],x7=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],v7=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],w7=8,ib=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ob=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Bm=null,y7=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],b7=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],o5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],N7=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],C7=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],_7=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],E7=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],zA=[],wl=[],Qc=[],B7=1,l5=2,WA=[],Go=[];Vo("UpsampleRgbLinePair",ht,3),Vo("UpsampleBgrLinePair",yt,3),Vo("UpsampleRgbaLinePair",hn,4),Vo("UpsampleBgraLinePair",qr,4),Vo("UpsampleArgbLinePair",ps,4),Vo("UpsampleRgba4444LinePair",nn,2),Vo("UpsampleRgb565LinePair",Gt,2);var S7=E.UpsampleRgbLinePair,I7=E.UpsampleBgrLinePair,c5=E.UpsampleRgbaLinePair,A5=E.UpsampleBgraLinePair,u5=E.UpsampleArgbLinePair,d5=E.UpsampleRgba4444LinePair,F7=E.UpsampleRgb565LinePair,ev=16,tv=1<<ev-1,Sm=-227,lb=482,k7=6,h5=0,T7=a(256),j7=a(256),P7=a(256),R7=a(256),D7=a(lb-Sm),L7=a(lb-Sm);Hn("YuvToRgbRow",ht,3),Hn("YuvToBgrRow",yt,3),Hn("YuvToRgbaRow",hn,4),Hn("YuvToBgraRow",qr,4),Hn("YuvToArgbRow",ps,4),Hn("YuvToRgba4444Row",nn,2),Hn("YuvToRgb565Row",Gt,2);var f5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],rv=[0,2,8],U7=[8,7,6,4,4,2,2,2,1,1,1,1],O7=1;this.WebPDecodeRGBA=function(v,C,Q,X,Ae){var we=Jx,be=new Bt,Se=new ot;be.ba=Se,Se.S=we,Se.width=[Se.width],Se.height=[Se.height];var Pe=Se.width,Ke=Se.height,it=new wt;if(it==null||v==null)var xt=2;else e(it!=null),xt=vl(v,C,Q,it.width,it.height,it.Pd,it.Qd,it.format,null);if(xt!=0?Pe=0:(Pe!=null&&(Pe[0]=it.width[0]),Ke!=null&&(Ke[0]=it.height[0]),Pe=1),Pe){Se.width=Se.width[0],Se.height=Se.height[0],X!=null&&(X[0]=Se.width),Ae!=null&&(Ae[0]=Se.height);e:{if(X=new Oi,(Ae=new jt).data=v,Ae.w=C,Ae.ha=Q,Ae.kd=1,C=[0],e(Ae!=null),((v=vl(Ae.data,Ae.w,Ae.ha,null,null,null,C,null,Ae))==0||v==7)&&C[0]&&(v=4),(C=v)==0){if(e(be!=null),X.data=Ae.data,X.w=Ae.w+Ae.offset,X.ha=Ae.ha-Ae.offset,X.put=et,X.ac=er,X.bc=gt,X.ma=be,Ae.xa){if((v=ye())==null){be=1;break e}if(function(qe,lt){var mt=[0],_t=[0],pt=[0];t:for(;;){if(qe==null)return 0;if(lt==null)return qe.a=2,0;if(qe.l=lt,qe.a=0,re(qe.m,lt.data,lt.w,lt.ha),!Pt(qe.m,mt,_t,pt)){qe.a=3;break t}if(qe.xb=l5,lt.width=mt[0],lt.height=_t[0],!Me(mt[0],_t[0],1,qe,null))break t;return 1}return e(qe.a!=0),0}(v,X)){if(X=(C=QA(X.width,X.height,be.Oa,be.ba))==0){t:{X=v;r:for(;;){if(X==null){X=0;break t}if(e(X.s.yc!=null),e(X.s.Ya!=null),e(0<X.s.Wb),e((Q=X.l)!=null),e((Ae=Q.ma)!=null),X.xb!=0){if(X.ca=Ae.ba,X.tb=Ae.tb,e(X.ca!=null),!xm(Ae.Oa,Q,Xx)){X.a=2;break r}if(!Le(X,Q.width)||Q.da)break r;if((Q.da||We(X.ca.S))&&Qi(),11>X.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),X.ca.f.kb.F!=null&&Qi()),X.Pb&&0<X.s.ua&&X.s.vb.X==null&&!J(X.s.vb,X.s.Wa.Xa)){X.a=1;break r}X.xb=0}if(!Re(X,X.V,X.Ba,X.c,X.i,Q.o,ue))break r;Ae.Dc=X.Ma,X=1;break t}e(X.a!=0),X=0}X=!X}X&&(C=v.a)}else C=v.a}else{if((v=new rf)==null){be=1;break e}if(v.Fa=Ae.na,v.P=Ae.P,v.qc=Ae.Sa,Ro(v,X)){if((C=QA(X.width,X.height,be.Oa,be.ba))==0){if(v.Aa=0,Q=be.Oa,e((Ae=v)!=null),Q!=null){if(0<(Pe=0>(Pe=Q.Md)?0:100<Pe?255:255*Pe/100)){for(Ke=it=0;4>Ke;++Ke)12>(xt=Ae.pb[Ke]).lc&&(xt.ia=Pe*U7[0>xt.lc?0:xt.lc]>>3),it|=xt.ia;it&&(alert("todo:VP8InitRandom"),Ae.ia=1)}Ae.Ga=Q.Id,100<Ae.Ga?Ae.Ga=100:0>Ae.Ga&&(Ae.Ga=0)}(function(qe,lt){if(qe==null)return 0;if(lt==null)return ds(qe,2,"NULL VP8Io parameter in VP8Decode().");if(!qe.cb&&!Ro(qe,lt))return 0;if(e(qe.cb),lt.ac==null||lt.ac(lt)){lt.ob&&(qe.L=0);var mt=rv[qe.L];if(qe.L==2?(qe.yb=0,qe.zb=0):(qe.yb=lt.v-mt>>4,qe.zb=lt.j-mt>>4,0>qe.yb&&(qe.yb=0),0>qe.zb&&(qe.zb=0)),qe.Va=lt.o+15+mt>>4,qe.Hb=lt.va+15+mt>>4,qe.Hb>qe.za&&(qe.Hb=qe.za),qe.Va>qe.Ub&&(qe.Va=qe.Ub),0<qe.L){var _t=qe.ed;for(mt=0;4>mt;++mt){var pt;if(qe.Qa.Cb){var St=qe.Qa.Lb[mt];qe.Qa.Fb||(St+=_t.Tb)}else St=_t.Tb;for(pt=0;1>=pt;++pt){var It=qe.gd[mt][pt],Ot=St;if(_t.Pc&&(Ot+=_t.vd[0],pt&&(Ot+=_t.od[0])),0<(Ot=0>Ot?0:63<Ot?63:Ot)){var Dt=Ot;0<_t.wb&&(Dt=4<_t.wb?Dt>>2:Dt>>1)>9-_t.wb&&(Dt=9-_t.wb),1>Dt&&(Dt=1),It.dd=Dt,It.tc=2*Ot+Dt,It.ld=40<=Ot?2:15<=Ot?1:0}else It.tc=0;It.La=pt}}}mt=0}else ds(qe,6,"Frame setup failed"),mt=qe.a;if(mt=mt==0){if(mt){qe.$c=0,0<qe.Aa||(qe.Ic=O7);t:{mt=qe.Ic,_t=4*(Dt=qe.za);var pr=32*Dt,or=Dt+1,Lr=0<qe.L?Dt*(0<qe.Aa?2:1):0,hr=(qe.Aa==2?2:1)*Dt;if((It=_t+832+(pt=3*(16*mt+rv[qe.L])/2*pr)+(St=qe.Fa!=null&&0<qe.Fa.length?qe.Kc.c*qe.Kc.i:0))!=It)mt=0;else{if(It>qe.Vb){if(qe.Vb=0,qe.Ec=a(It),qe.Fc=0,qe.Ec==null){mt=ds(qe,1,"no memory during frame initialization.");break t}qe.Vb=It}It=qe.Ec,Ot=qe.Fc,qe.Ac=It,qe.Bc=Ot,Ot+=_t,qe.Gd=o(pr,ga),qe.Hd=0,qe.rb=o(or+1,Kr),qe.sb=1,qe.wa=Lr?o(Lr,ur):null,qe.Y=0,qe.D.Nb=0,qe.D.wa=qe.wa,qe.D.Y=qe.Y,0<qe.Aa&&(qe.D.Y+=Dt),e(!0),qe.oc=It,qe.pc=Ot,Ot+=832,qe.ya=o(hr,vi),qe.aa=0,qe.D.ya=qe.ya,qe.D.aa=qe.aa,qe.Aa==2&&(qe.D.aa+=Dt),qe.R=16*Dt,qe.B=8*Dt,Dt=(pr=rv[qe.L])*qe.R,pr=pr/2*qe.B,qe.sa=It,qe.ta=Ot+Dt,qe.qa=qe.sa,qe.ra=qe.ta+16*mt*qe.R+pr,qe.Ha=qe.qa,qe.Ia=qe.ra+8*mt*qe.B+pr,qe.$c=0,Ot+=pt,qe.mb=St?It:null,qe.nb=St?Ot:null,e(Ot+St<=qe.Fc+qe.Vb),yd(qe),s(qe.Ac,qe.Bc,0,_t),mt=1}}if(mt){if(lt.ka=0,lt.y=qe.sa,lt.O=qe.ta,lt.f=qe.qa,lt.N=qe.ra,lt.ea=qe.Ha,lt.Vd=qe.Ia,lt.fa=qe.R,lt.Rc=qe.B,lt.F=null,lt.J=0,!n5){for(mt=-255;255>=mt;++mt)ZI[255+mt]=0>mt?-mt:mt;for(mt=-1020;1020>=mt;++mt)e5[1020+mt]=-128>mt?-128:127<mt?127:mt;for(mt=-112;112>=mt;++mt)t5[112+mt]=-16>mt?-16:15<mt?15:mt;for(mt=-255;510>=mt;++mt)r5[255+mt]=0>mt?0:255<mt?255:mt;n5=1}$A=Do,Id=sf,nc=Xr,gn=Rc,Un=Xl,Ko=RA,Ps=MA,ta=Qo,Mc=ce,_m=He,df=Ed,$x=L,KI=rt,qI=dt,GI=ec,$I=wi,zI=_d,WI=Af,wl[0]=pm,wl[1]=af,wl[2]=fm,wl[3]=mm,wl[4]=xa,wl[5]=gm,wl[6]=gl,wl[7]=LA,wl[8]=UA,wl[9]=xl,zA[0]=Lo,zA[1]=hm,zA[2]=bd,zA[3]=of,zA[4]=Yl,zA[5]=DA,zA[6]=lf,Qc[0]=Nd,Qc[1]=dm,Qc[2]=so,Qc[3]=Lc,Qc[4]=Cd,Qc[5]=Tn,Qc[6]=cf,mt=1}else mt=0}mt&&(mt=function(sn,ra){for(sn.M=0;sn.M<sn.Va;++sn.M){var Ur,fr=sn.Jc[sn.M&sn.Xb],Jt=sn.m,Rs=sn;for(Ur=0;Ur<Rs.za;++Ur){var jr=Jt,an=Rs,zn=an.Ac,ja=an.Bc+4*Ur,bi=an.zc,_s=an.ya[an.aa+Ur];if(an.Qa.Bb?_s.$b=se(jr,an.Pa.jb[0])?2+se(jr,an.Pa.jb[2]):se(jr,an.Pa.jb[1]):_s.$b=0,an.kc&&(_s.Ad=se(jr,an.Bd)),_s.Za=!se(jr,145)+0,_s.Za){var Xa=_s.Ob,Ni=0;for(an=0;4>an;++an){var na,ln=bi[0+an];for(na=0;4>na;++na){ln=C7[zn[ja+na]][ln];for(var wn=o5[se(jr,ln[0])];0<wn;)wn=o5[2*wn+se(jr,ln[wn])];ln=-wn,zn[ja+na]=ln}n(Xa,Ni,zn,ja,4),Ni+=4,bi[0+an]=ln}}else ln=se(jr,156)?se(jr,128)?1:3:se(jr,163)?2:0,_s.Ob[0]=ln,s(zn,ja,ln,4),s(bi,0,ln,4);_s.Dd=se(jr,142)?se(jr,114)?se(jr,183)?1:3:2:0}if(Rs.m.Ka)return ds(sn,7,"Premature end-of-partition0 encountered.");for(;sn.ja<sn.za;++sn.ja){if(Rs=fr,jr=(Jt=sn).rb[Jt.sb-1],zn=Jt.rb[Jt.sb+Jt.ja],Ur=Jt.ya[Jt.aa+Jt.ja],ja=Jt.kc?Ur.Ad:0)jr.la=zn.la=0,Ur.Za||(jr.Na=zn.Na=0),Ur.Hc=0,Ur.Gc=0,Ur.ia=0;else{var Es,yn;if(jr=zn,zn=Rs,ja=Jt.Pa.Xc,bi=Jt.ya[Jt.aa+Jt.ja],_s=Jt.pb[bi.$b],an=bi.ad,Xa=0,Ni=Jt.rb[Jt.sb-1],ln=na=0,s(an,Xa,0,384),bi.Za)var Pa=0,yl=ja[3];else{wn=a(16);var Ds=jr.Na+Ni.Na;if(Ds=Bm(zn,ja[1],Ds,_s.Eb,0,wn,0),jr.Na=Ni.Na=(0<Ds)+0,1<Ds)$A(wn,0,an,Xa);else{var Vi=wn[0]+3>>3;for(wn=0;256>wn;wn+=16)an[Xa+wn]=Vi}Pa=1,yl=ja[0]}var On=15&jr.la,sa=15&Ni.la;for(wn=0;4>wn;++wn){var co=1&sa;for(Vi=yn=0;4>Vi;++Vi)On=On>>1|(co=(Ds=Bm(zn,yl,Ds=co+(1&On),_s.Sc,Pa,an,Xa))>Pa)<<7,yn=yn<<2|(3<Ds?3:1<Ds?2:an[Xa+0]!=0),Xa+=16;On>>=4,sa=sa>>1|co<<7,na=(na<<8|yn)>>>0}for(yl=On,Pa=sa>>4,Es=0;4>Es;Es+=2){for(yn=0,On=jr.la>>4+Es,sa=Ni.la>>4+Es,wn=0;2>wn;++wn){for(co=1&sa,Vi=0;2>Vi;++Vi)Ds=co+(1&On),On=On>>1|(co=0<(Ds=Bm(zn,ja[2],Ds,_s.Qc,0,an,Xa)))<<3,yn=yn<<2|(3<Ds?3:1<Ds?2:an[Xa+0]!=0),Xa+=16;On>>=2,sa=sa>>1|co<<5}ln|=yn<<4*Es,yl|=On<<4<<Es,Pa|=(240&sa)<<Es}jr.la=yl,Ni.la=Pa,bi.Hc=na,bi.Gc=ln,bi.ia=43690&ln?0:_s.ia,ja=!(na|ln)}if(0<Jt.L&&(Jt.wa[Jt.Y+Jt.ja]=Jt.gd[Ur.$b][Ur.Za],Jt.wa[Jt.Y+Jt.ja].La|=!ja),Rs.Ka)return ds(sn,7,"Premature end-of-file encountered.")}if(yd(sn),Jt=ra,Rs=1,Ur=(fr=sn).D,jr=0<fr.L&&fr.M>=fr.zb&&fr.M<=fr.Va,fr.Aa==0)t:{if(Ur.M=fr.M,Ur.uc=jr,Ta(fr,Ur),Rs=1,Ur=(yn=fr.D).Nb,jr=(ln=rv[fr.L])*fr.R,zn=ln/2*fr.B,wn=16*Ur*fr.R,Vi=8*Ur*fr.B,ja=fr.sa,bi=fr.ta-jr+wn,_s=fr.qa,an=fr.ra-zn+Vi,Xa=fr.Ha,Ni=fr.Ia-zn+Vi,sa=(On=yn.M)==0,na=On>=fr.Va-1,fr.Aa==2&&Ta(fr,yn),yn.uc)for(co=(Ds=fr).D.M,e(Ds.D.uc),yn=Ds.yb;yn<Ds.Hb;++yn){Pa=yn,yl=co;var Ci=(Ao=(Ra=Ds).D).Nb;Es=Ra.R;var Ao=Ao.wa[Ao.Y+Pa],uo=Ra.sa,Hi=Ra.ta+16*Ci*Es+16*Pa,ho=Ao.dd,Kn=Ao.tc;if(Kn!=0)if(e(3<=Kn),Ra.L==1)0<Pa&&$I(uo,Hi,Es,Kn+4),Ao.La&&WI(uo,Hi,Es,Kn),0<yl&&GI(uo,Hi,Es,Kn+4),Ao.La&&zI(uo,Hi,Es,Kn);else{var fo=Ra.B,bl=Ra.qa,Fd=Ra.ra+8*Ci*fo+8*Pa,Vc=Ra.Ha,Ra=Ra.Ia+8*Ci*fo+8*Pa;Ci=Ao.ld,0<Pa&&(ta(uo,Hi,Es,Kn+4,ho,Ci),_m(bl,Fd,Vc,Ra,fo,Kn+4,ho,Ci)),Ao.La&&($x(uo,Hi,Es,Kn,ho,Ci),qI(bl,Fd,Vc,Ra,fo,Kn,ho,Ci)),0<yl&&(Ps(uo,Hi,Es,Kn+4,ho,Ci),Mc(bl,Fd,Vc,Ra,fo,Kn+4,ho,Ci)),Ao.La&&(df(uo,Hi,Es,Kn,ho,Ci),KI(bl,Fd,Vc,Ra,fo,Kn,ho,Ci))}}if(fr.ia&&alert("todo:DitherRow"),Jt.put!=null){if(yn=16*On,On=16*(On+1),sa?(Jt.y=fr.sa,Jt.O=fr.ta+wn,Jt.f=fr.qa,Jt.N=fr.ra+Vi,Jt.ea=fr.Ha,Jt.W=fr.Ia+Vi):(yn-=ln,Jt.y=ja,Jt.O=bi,Jt.f=_s,Jt.N=an,Jt.ea=Xa,Jt.W=Ni),na||(On-=ln),On>Jt.o&&(On=Jt.o),Jt.F=null,Jt.J=null,fr.Fa!=null&&0<fr.Fa.length&&yn<On&&(Jt.J=vn(fr,Jt,yn,On-yn),Jt.F=fr.mb,Jt.F==null&&Jt.F.length==0)){Rs=ds(fr,3,"Could not decode alpha data.");break t}yn<Jt.j&&(ln=Jt.j-yn,yn=Jt.j,e(!(1&ln)),Jt.O+=fr.R*ln,Jt.N+=fr.B*(ln>>1),Jt.W+=fr.B*(ln>>1),Jt.F!=null&&(Jt.J+=Jt.width*ln)),yn<On&&(Jt.O+=Jt.v,Jt.N+=Jt.v>>1,Jt.W+=Jt.v>>1,Jt.F!=null&&(Jt.J+=Jt.v),Jt.ka=yn-Jt.j,Jt.U=Jt.va-Jt.v,Jt.T=On-yn,Rs=Jt.put(Jt))}Ur+1!=fr.Ic||na||(n(fr.sa,fr.ta-jr,ja,bi+16*fr.R,jr),n(fr.qa,fr.ra-zn,_s,an+8*fr.B,zn),n(fr.Ha,fr.Ia-zn,Xa,Ni+8*fr.B,zn))}if(!Rs)return ds(sn,6,"Output aborted.")}return 1}(qe,lt)),lt.bc!=null&&lt.bc(lt),mt&=1}return mt?(qe.cb=0,mt):0})(v,X)||(C=v.a)}}else C=v.a}C==0&&be.Oa!=null&&be.Oa.fd&&(C=vm(be.ba))}be=C}we=be!=0?null:11>we?Se.f.RGBA.eb:Se.f.kb.y}else we=null;return we};var m5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function A(E,M){for(var k="",T=0;T<4;T++)k+=String.fromCharCode(E[M++]);return k}function u(E,M){return E[M+0]|E[M+1]<<8}function d(E,M){return(E[M+0]|E[M+1]<<8|E[M+2]<<16)>>>0}function f(E,M){return(E[M+0]|E[M+1]<<8|E[M+2]<<16|E[M+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,g=t,y=function(E,M){var k={},T=0,U=!1,Z=0,pe=0;if(k.frames=[],!function(S,I){for(var V=0;V<4;V++)if(S[I+V]!="RIFF".charCodeAt(V))return!0;return!1}(E,M)){for(f(E,M+=4),M+=8;M<E.length;){var ae=A(E,M),he=f(E,M+=4);M+=4;var de=he+(1&he);switch(ae){case"VP8 ":case"VP8L":k.frames[T]===void 0&&(k.frames[T]={}),(Ce=k.frames[T]).src_off=U?pe:M-8,Ce.src_size=Z+he+8,T++,U&&(U=!1,Z=0,pe=0);break;case"VP8X":(Ce=k.header={}).feature_flags=E[M];var re=M+4;Ce.canvas_width=1+d(E,re),re+=3,Ce.canvas_height=1+d(E,re),re+=3;break;case"ALPH":U=!0,Z=de+8,pe=M-8;break;case"ANIM":(Ce=k.header).bgcolor=f(E,M),re=M+4,Ce.loop_count=u(E,re),re+=2;break;case"ANMF":var xe,Ce;(Ce=k.frames[T]={}).offset_x=2*d(E,M),M+=3,Ce.offset_y=2*d(E,M),M+=3,Ce.width=1+d(E,M),M+=3,Ce.height=1+d(E,M),M+=3,Ce.duration=d(E,M),M+=3,xe=E[M++],Ce.dispose=1&xe,Ce.blend=xe>>1&1}ae!="ANMF"&&(M+=de)}return k}}(g,0);y.response=g,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,F=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var P=0;P<F.length&&F[P].blend!=0;P++);}var R=F[0],_=x.WebPDecodeRGBA(g,R.src_off,R.src_size,m,h);R.rgba=_,R.imgwidth=m[0],R.imgheight=h[0];for(var B=0;B<m[0]*h[0]*4;B++)p[B]=_[B];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,s,a,o,l,c,A,u=function(S){return S=S||{},this.isStrokeTransparent=S.isStrokeTransparent||!1,this.strokeOpacity=S.strokeOpacity||1,this.strokeStyle=S.strokeStyle||"#000000",this.fillStyle=S.fillStyle||"#000000",this.isFillTransparent=S.isFillTransparent||!1,this.fillOpacity=S.fillOpacity||1,this.font=S.font||"10px sans-serif",this.textBaseline=S.textBaseline||"alphabetic",this.textAlign=S.textAlign||"left",this.lineWidth=S.lineWidth||1,this.lineJoin=S.lineJoin||"miter",this.lineCap=S.lineCap||"butt",this.path=S.path||[],this.transform=S.transform!==void 0?S.transform.clone():new c,this.globalCompositeOperation=S.globalCompositeOperation||"normal",this.globalAlpha=S.globalAlpha||1,this.clip_path=S.clip_path||[],this.currentPoint=S.currentPoint||new o,this.miterLimit=S.miterLimit||10,this.lastPoint=S.lastPoint||new o,this.lineDashOffset=S.lineDashOffset||0,this.lineDash=S.lineDash||[],this.margin=S.margin||[0,0,0,0],this.prevPageLastElemOffset=S.prevPageLastElemOffset||0,this.ignoreClearRect=typeof S.ignoreClearRect!="boolean"||S.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,A=new u}]);var d=function(S){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=S;Object.defineProperty(this,"pdf",{get:function(){return I}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(J){V=!!J}});var j=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return j},set:function(J){j=!!J}});var O=0;Object.defineProperty(this,"posX",{get:function(){return O},set:function(J){isNaN(J)||(O=J)}});var W=0;Object.defineProperty(this,"posY",{get:function(){return W},set:function(J){isNaN(J)||(W=J)}}),Object.defineProperty(this,"margin",{get:function(){return A.margin},set:function(J){var q;typeof J=="number"?q=[J,J,J,J]:((q=new Array(4))[0]=J[0],q[1]=J.length>=2?J[1]:q[0],q[2]=J.length>=3?J[2]:q[0],q[3]=J.length>=4?J[3]:q[1]),A.margin=q}});var D=!1;Object.defineProperty(this,"autoPaging",{get:function(){return D},set:function(J){D=J}});var Y=0;Object.defineProperty(this,"lastBreak",{get:function(){return Y},set:function(J){Y=J}});var se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return se},set:function(J){se=J}}),Object.defineProperty(this,"ctx",{get:function(){return A},set:function(J){J instanceof u&&(A=J)}}),Object.defineProperty(this,"path",{get:function(){return A.path},set:function(J){A.path=J}});var ve=[];Object.defineProperty(this,"ctxStack",{get:function(){return ve},set:function(J){ve=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var q;q=f(J),this.ctx.fillStyle=q.style,this.ctx.isFillTransparent=q.a===0,this.ctx.fillOpacity=q.a,this.pdf.setFillColor(q.r,q.g,q.b,{a:q.a}),this.pdf.setTextColor(q.r,q.g,q.b,{a:q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var q=f(J);this.ctx.strokeStyle=q.style,this.ctx.isStrokeTransparent=q.a===0,this.ctx.strokeOpacity=q.a,q.a===0?this.pdf.setDrawColor(255,255,255):(q.a,this.pdf.setDrawColor(q.r,q.g,q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var z=null,Oe=null,te=null;Object.defineProperty(this,"fontFaces",{get:function(){return te},set:function(J){z=null,Oe=null,te=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var q;if(this.ctx.font=J,(q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var ie=q[1];q[2];var fe=q[3],Ie=q[4];q[5];var Ve=q[6],ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ie)[2];Ie=Math.floor(ze==="px"?parseFloat(Ie)*this.pdf.internal.scaleFactor:ze==="em"?parseFloat(Ie)*this.pdf.getFontSize():parseFloat(Ie)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ie);var Ye=function(G){var Ne,Ue,$e=[],ge=G.trim();if(ge==="")return HN;if(ge in Fj)return[Fj[ge]];for(;ge!=="";){switch(Ue=null,Ne=(ge=Tj(ge)).charAt(0)){case'"':case"'":Ue=ioe(ge.substring(1),Ne);break;default:Ue=ooe(ge)}if(Ue===null||($e.push(Ue[0]),(ge=Tj(Ue[1]))!==""&&ge.charAt(0)!==","))return HN;ge=ge.replace(/^,/,"")}return $e}(Ve);if(this.fontFaces){var ct=function(G,Ne){var Ue=G.getFontList(),$e=JSON.stringify(Ue);if(z===null||Oe!==$e){var ge=function(Be){var Qe=[];return Object.keys(Be).forEach(function(Te){Be[Te].forEach(function(We){var at=null;switch(We){case"bold":at={family:Te,weight:"bold"};break;case"italic":at={family:Te,style:"italic"};break;case"bolditalic":at={family:Te,weight:"bold",style:"italic"};break;case"":case"normal":at={family:Te}}at!==null&&(at.ref={name:Te,style:We},Qe.push(at))})}),Qe}(Ue);z=function(Be){for(var Qe={},Te=0;Te<Be.length;++Te){var We=VN(Be[Te]),at=We.family,bt=We.stretch,ot=We.style,wt=We.weight;Qe[at]=Qe[at]||{},Qe[at][bt]=Qe[at][bt]||{},Qe[at][bt][ot]=Qe[at][bt][ot]||{},Qe[at][bt][ot][wt]=We}return Qe}(ge.concat(Ne)),Oe=$e}return z}(this.pdf,this.fontFaces),st=Ye.map(function(G){return{family:G,stretch:"normal",weight:fe,style:ie}}),ft=function(G,Ne,Ue){for(var $e=(Ue=Ue||{}).defaultFontFamily||"times",ge=Object.assign({},aoe,Ue.genericFontFamilies||{}),Be=null,Qe=null,Te=0;Te<Ne.length;++Te)if(ge[(Be=VN(Ne[Te])).family]&&(Be.family=ge[Be.family]),G.hasOwnProperty(Be.family)){Qe=G[Be.family];break}if(!(Qe=Qe||G[$e]))throw new Error("Could not find a font-family for the rule '"+kj(Be)+"' and default family '"+$e+"'.");if(Qe=function(We,at){if(at[We])return at[We];var bt=CE[We],ot=bt<=CE.normal?-1:1,wt=Ij(at,$M,bt,ot);if(!wt)throw new Error("Could not find a matching font-stretch value for "+We);return wt}(Be.stretch,Qe),Qe=function(We,at){if(at[We])return at[We];for(var bt=GM[We],ot=0;ot<bt.length;++ot)if(at[bt[ot]])return at[bt[ot]];throw new Error("Could not find a matching font-style for "+We)}(Be.style,Qe),!(Qe=function(We,at){if(at[We])return at[We];if(We===400&&at[500])return at[500];if(We===500&&at[400])return at[400];var bt=soe[We],ot=Ij(at,zM,bt,We<400?-1:1);if(!ot)throw new Error("Could not find a matching font-weight for value "+We);return ot}(Be.weight,Qe)))throw new Error("Failed to resolve a font for the rule '"+kj(Be)+"'.");return Qe}(ct,st);this.pdf.setFont(ft.ref.name,ft.ref.style)}else{var nt="";(fe==="bold"||parseInt(fe,10)>=700||ie==="bold")&&(nt="bold"),ie==="italic"&&(nt+="italic"),nt.length===0&&(nt="normal");for(var De="",Fe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ge=0;Ge<Ye.length;Ge++){if(this.pdf.internal.getFont(Ye[Ge],nt,{noFallback:!0,disableWarning:!0})!==void 0){De=Ye[Ge];break}if(nt==="bolditalic"&&this.pdf.internal.getFont(Ye[Ge],"bold",{noFallback:!0,disableWarning:!0})!==void 0)De=Ye[Ge],nt="bold";else if(this.pdf.internal.getFont(Ye[Ge],"normal",{noFallback:!0,disableWarning:!0})!==void 0){De=Ye[Ge],nt="normal";break}}if(De===""){for(var _e=0;_e<Ye.length;_e++)if(Fe[Ye[_e]]){De=Fe[Ye[_e]];break}}De=De===""?"Times":De,this.pdf.setFont(De,nt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,Ce.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,Ce.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};d.prototype.setLineDash=function(S){this.lineDash=S},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){F.call(this,"fill",!1)},d.prototype.stroke=function(){F.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new o(S,I));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(S,I)},d.prototype.closePath=function(){var S=new o(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&Sn(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){S=new o(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(S.x,S.y)},d.prototype.lineTo=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new o(S,I));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},d.prototype.quadraticCurveTo=function(S,I,V,j){if(isNaN(V)||isNaN(j)||isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var O=this.ctx.transform.applyToPoint(new o(V,j)),W=this.ctx.transform.applyToPoint(new o(S,I));this.path.push({type:"qct",x1:W.x,y1:W.y,x:O.x,y:O.y}),this.ctx.lastPoint=new o(O.x,O.y)},d.prototype.bezierCurveTo=function(S,I,V,j,O,W){if(isNaN(O)||isNaN(W)||isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var D=this.ctx.transform.applyToPoint(new o(O,W)),Y=this.ctx.transform.applyToPoint(new o(S,I)),se=this.ctx.transform.applyToPoint(new o(V,j));this.path.push({type:"bct",x1:Y.x,y1:Y.y,x2:se.x,y2:se.y,x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},d.prototype.arc=function(S,I,V,j,O,W){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j)||isNaN(O))throw Vn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(W=!!W,!this.ctx.transform.isIdentity){var D=this.ctx.transform.applyToPoint(new o(S,I));S=D.x,I=D.y;var Y=this.ctx.transform.applyToPoint(new o(0,V)),se=this.ctx.transform.applyToPoint(new o(0,0));V=Math.sqrt(Math.pow(Y.x-se.x,2)+Math.pow(Y.y-se.y,2))}Math.abs(O-j)>=2*Math.PI&&(j=0,O=2*Math.PI),this.path.push({type:"arc",x:S,y:I,radius:V,startAngle:j,endAngle:O,counterclockwise:W})},d.prototype.arcTo=function(S,I,V,j,O){throw new Error("arcTo not implemented.")},d.prototype.rect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(S,I),this.lineTo(S+V,I),this.lineTo(S+V,I+j),this.lineTo(S,I+j),this.lineTo(S,I),this.lineTo(S+V,I),this.lineTo(S,I)},d.prototype.fillRect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var O={};this.lineCap!=="butt"&&(O.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(O.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(S,I,V,j),this.fill(),O.hasOwnProperty("lineCap")&&(this.lineCap=O.lineCap),O.hasOwnProperty("lineJoin")&&(this.lineJoin=O.lineJoin)}},d.prototype.strokeRect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(S,I,V,j),this.stroke())},d.prototype.clearRect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(S,I,V,j))},d.prototype.save=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),S){this.ctx.fontSize=this.pdf.internal.getFontSize();var j=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=j}},d.prototype.restore=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(I),S&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(S){var I,V,j,O;if(S.isCanvasGradient===!0&&(S=S.getColor()),!S)return{r:0,g:0,b:0,a:0,style:S};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(S))I=0,V=0,j=0,O=0;else{var W=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(S);if(W!==null)I=parseInt(W[1]),V=parseInt(W[2]),j=parseInt(W[3]),O=1;else if((W=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(S))!==null)I=parseInt(W[1]),V=parseInt(W[2]),j=parseInt(W[3]),O=parseFloat(W[4]);else{if(O=1,typeof S=="string"&&S.charAt(0)!=="#"){var D=new OM(S);S=D.ok?D.toHex():"#000000"}S.length===4?(I=S.substring(1,2),I+=I,V=S.substring(2,3),V+=V,j=S.substring(3,4),j+=j):(I=S.substring(1,3),V=S.substring(3,5),j=S.substring(5,7)),I=parseInt(I,16),V=parseInt(V,16),j=parseInt(j,16)}}return{r:I,g:V,b:j,a:O,style:S}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(S,I,V,j){if(isNaN(I)||isNaN(V)||typeof S!="string")throw Vn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(j=isNaN(j)?void 0:j,!h.call(this)){var O=de(this.ctx.transform.rotation),W=this.ctx.transform.scaleX;T.call(this,{text:S,x:I,y:V,scale:W,angle:O,align:this.textAlign,maxWidth:j})}},d.prototype.strokeText=function(S,I,V,j){if(isNaN(I)||isNaN(V)||typeof S!="string")throw Vn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){j=isNaN(j)?void 0:j;var O=de(this.ctx.transform.rotation),W=this.ctx.transform.scaleX;T.call(this,{text:S,x:I,y:V,scale:W,renderingMode:"stroke",angle:O,align:this.textAlign,maxWidth:j})}},d.prototype.measureText=function(S){if(typeof S!="string")throw Vn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,V=this.pdf.internal.scaleFactor,j=I.internal.getFontSize(),O=I.getStringUnitWidth(S)*j/I.internal.scaleFactor;return new function(W){var D=(W=W||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this}({width:O*=Math.round(96*V/72*1e4)/1e4})},d.prototype.scale=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(S,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},d.prototype.rotate=function(S){if(isNaN(S))throw Vn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new c(Math.cos(S),Math.sin(S),-Math.sin(S),Math.cos(S),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},d.prototype.translate=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,S,I);this.ctx.transform=this.ctx.transform.multiply(V)},d.prototype.transform=function(S,I,V,j,O,W){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j)||isNaN(O)||isNaN(W))throw Vn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var D=new c(S,I,V,j,O,W);this.ctx.transform=this.ctx.transform.multiply(D)},d.prototype.setTransform=function(S,I,V,j,O,W){S=isNaN(S)?1:S,I=isNaN(I)?0:I,V=isNaN(V)?0:V,j=isNaN(j)?1:j,O=isNaN(O)?0:O,W=isNaN(W)?0:W,this.ctx.transform=new c(S,I,V,j,O,W)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(S,I,V,j,O,W,D,Y,se){var ve=this.pdf.getImageProperties(S),z=1,Oe=1,te=1,J=1;j!==void 0&&Y!==void 0&&(te=Y/j,J=se/O,z=ve.width/j*Y/j,Oe=ve.height/O*se/O),W===void 0&&(W=I,D=V,I=0,V=0),j!==void 0&&Y===void 0&&(Y=j,se=O),j===void 0&&Y===void 0&&(Y=ve.width,se=ve.height);var q=this.ctx.transform.decompose(),ie=de(q.rotate.shx),fe=new c,Ie=(fe=(fe=(fe=fe.multiply(q.translate)).multiply(q.skew)).multiply(q.scale)).applyToRectangle(new l(W-I*te,D-V*J,j*z,O*Oe));if(this.autoPaging){for(var Ve,ze=x.call(this,Ie),Ye=[],ct=0;ct<ze.length;ct+=1)Ye.indexOf(ze[ct])===-1&&Ye.push(ze[ct]);b(Ye);for(var st=Ye[0],ft=Ye[Ye.length-1],nt=st;nt<ft+1;nt++){this.pdf.setPage(nt);var De=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fe=nt===1?this.posY+this.margin[0]:this.margin[0],Ge=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],G=nt===1?0:Ge+(nt-2)*_e;if(this.ctx.clip_path.length!==0){var Ne=this.path;Ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Ve,this.posX+this.margin[3],-G+Fe+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=Ne}var Ue=JSON.parse(JSON.stringify(Ie));Ue=y([Ue],this.posX+this.margin[3],-G+Fe+this.ctx.prevPageLastElemOffset)[0];var $e=(nt>st||nt<ft)&&p.call(this);$e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],De,_e,null).clip().discardPath()),this.pdf.addImage(S,"JPEG",Ue.x,Ue.y,Ue.w,Ue.h,null,null,ie),$e&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(S,"JPEG",Ie.x,Ie.y,Ie.w,Ie.h,null,null,ie)};var x=function(S,I,V){var j=[];I=I||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var O=this.posY+this.ctx.prevPageLastElemOffset;switch(S.type){default:case"mt":case"lt":j.push(Math.floor((S.y+O)/V)+1);break;case"arc":j.push(Math.floor((S.y+O-S.radius)/V)+1),j.push(Math.floor((S.y+O+S.radius)/V)+1);break;case"qct":var W=re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x,S.y);j.push(Math.floor((W.y+O)/V)+1),j.push(Math.floor((W.y+W.h+O)/V)+1);break;case"bct":var D=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x2,S.y2,S.x,S.y);j.push(Math.floor((D.y+O)/V)+1),j.push(Math.floor((D.y+D.h+O)/V)+1);break;case"rect":j.push(Math.floor((S.y+O)/V)+1),j.push(Math.floor((S.y+S.h+O)/V)+1)}for(var Y=0;Y<j.length;Y+=1)for(;this.pdf.internal.getNumberOfPages()<j[Y];)g.call(this);return j},g=function(){var S=this.fillStyle,I=this.strokeStyle,V=this.font,j=this.lineCap,O=this.lineWidth,W=this.lineJoin;this.pdf.addPage(),this.fillStyle=S,this.strokeStyle=I,this.font=V,this.lineCap=j,this.lineWidth=O,this.lineJoin=W},y=function(S,I,V){for(var j=0;j<S.length;j++)switch(S[j].type){case"bct":S[j].x2+=I,S[j].y2+=V;case"qct":S[j].x1+=I,S[j].y1+=V;default:S[j].x+=I,S[j].y+=V}return S},b=function(S){return S.sort(function(I,V){return I-V})},F=function(S,I){var V=this.fillStyle,j=this.strokeStyle,O=this.lineCap,W=this.lineWidth,D=Math.abs(W*this.ctx.transform.scaleX),Y=this.lineJoin;if(this.autoPaging){for(var se,ve,z=JSON.parse(JSON.stringify(this.path)),Oe=JSON.parse(JSON.stringify(this.path)),te=[],J=0;J<Oe.length;J++)if(Oe[J].x!==void 0)for(var q=x.call(this,Oe[J]),ie=0;ie<q.length;ie+=1)te.indexOf(q[ie])===-1&&te.push(q[ie]);for(var fe=0;fe<te.length;fe++)for(;this.pdf.internal.getNumberOfPages()<te[fe];)g.call(this);b(te);for(var Ie=te[0],Ve=te[te.length-1],ze=Ie;ze<Ve+1;ze++){this.pdf.setPage(ze),this.fillStyle=V,this.strokeStyle=j,this.lineCap=O,this.lineWidth=D,this.lineJoin=Y;var Ye=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ct=ze===1?this.posY+this.margin[0]:this.margin[0],st=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],nt=ze===1?0:st+(ze-2)*ft;if(this.ctx.clip_path.length!==0){var De=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(se,this.posX+this.margin[3],-nt+ct+this.ctx.prevPageLastElemOffset),P.call(this,S,!0),this.path=De}if(ve=JSON.parse(JSON.stringify(z)),this.path=y(ve,this.posX+this.margin[3],-nt+ct+this.ctx.prevPageLastElemOffset),I===!1||ze===0){var Fe=(ze>Ie||ze<Ve)&&p.call(this);Fe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ye,ft,null).clip().discardPath()),P.call(this,S,I),Fe&&this.pdf.restoreGraphicsState()}this.lineWidth=W}this.path=z}else this.lineWidth=D,P.call(this,S,I),this.lineWidth=W},P=function(S,I){if((S!=="stroke"||I||!m.call(this))&&(S==="stroke"||I||!h.call(this))){for(var V,j,O=[],W=this.path,D=0;D<W.length;D++){var Y=W[D];switch(Y.type){case"begin":O.push({begin:!0});break;case"close":O.push({close:!0});break;case"mt":O.push({start:Y,deltas:[],abs:[]});break;case"lt":var se=O.length;if(W[D-1]&&!isNaN(W[D-1].x)&&(V=[Y.x-W[D-1].x,Y.y-W[D-1].y],se>0)){for(;se>=0;se--)if(O[se-1].close!==!0&&O[se-1].begin!==!0){O[se-1].deltas.push(V),O[se-1].abs.push(Y);break}}break;case"bct":V=[Y.x1-W[D-1].x,Y.y1-W[D-1].y,Y.x2-W[D-1].x,Y.y2-W[D-1].y,Y.x-W[D-1].x,Y.y-W[D-1].y],O[O.length-1].deltas.push(V);break;case"qct":var ve=W[D-1].x+2/3*(Y.x1-W[D-1].x),z=W[D-1].y+2/3*(Y.y1-W[D-1].y),Oe=Y.x+2/3*(Y.x1-Y.x),te=Y.y+2/3*(Y.y1-Y.y),J=Y.x,q=Y.y;V=[ve-W[D-1].x,z-W[D-1].y,Oe-W[D-1].x,te-W[D-1].y,J-W[D-1].x,q-W[D-1].y],O[O.length-1].deltas.push(V);break;case"arc":O.push({deltas:[],abs:[],arc:!0}),Array.isArray(O[O.length-1].abs)&&O[O.length-1].abs.push(Y)}}j=I?null:S==="stroke"?"stroke":"fill";for(var ie=!1,fe=0;fe<O.length;fe++)if(O[fe].arc)for(var Ie=O[fe].abs,Ve=0;Ve<Ie.length;Ve++){var ze=Ie[Ve];ze.type==="arc"?B.call(this,ze.x,ze.y,ze.radius,ze.startAngle,ze.endAngle,ze.counterclockwise,void 0,I,!ie):U.call(this,ze.x,ze.y),ie=!0}else if(O[fe].close===!0)this.pdf.internal.out("h"),ie=!1;else if(O[fe].begin!==!0){var Ye=O[fe].start.x,ct=O[fe].start.y;Z.call(this,O[fe].deltas,Ye,ct),ie=!0}j&&E.call(this,j),I&&M.call(this)}},R=function(S){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return S-V;case"top":return S+I-V;case"hanging":return S+I-2*V;case"middle":return S+I/2-V;default:return S}},_=function(S){return S+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var S=function(){};return S.colorStops=[],S.addColorStop=function(I,V){this.colorStops.push([I,V])},S.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},S.isCanvasGradient=!0,S},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var B=function(S,I,V,j,O,W,D,Y,se){for(var ve=ae.call(this,V,j,O,W),z=0;z<ve.length;z++){var Oe=ve[z];z===0&&(se?k.call(this,Oe.x1+S,Oe.y1+I):U.call(this,Oe.x1+S,Oe.y1+I)),pe.call(this,S,I,Oe.x2,Oe.y2,Oe.x3,Oe.y3,Oe.x4,Oe.y4)}Y?M.call(this):E.call(this,D)},E=function(S){switch(S){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(S,I){this.pdf.internal.out(r(S)+" "+n(I)+" m")},T=function(S){var I;switch(S.align){case"right":case"end":I="right";break;case"center":I="center";break;default:I="left"}var V,j,O,W=this.pdf.getTextDimensions(S.text),D=R.call(this,S.y),Y=_.call(this,D)-W.h,se=this.ctx.transform.applyToPoint(new o(S.x,D));if(this.autoPaging){var ve=this.ctx.transform.decompose(),z=new c;z=(z=(z=z.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var Oe=this.ctx.transform.applyToRectangle(new l(S.x,D,W.w,W.h)),te=z.applyToRectangle(new l(S.x,Y,W.w,W.h)),J=x.call(this,te),q=[],ie=0;ie<J.length;ie+=1)q.indexOf(J[ie])===-1&&q.push(J[ie]);b(q);for(var fe=q[0],Ie=q[q.length-1],Ve=fe;Ve<Ie+1;Ve++){this.pdf.setPage(Ve);var ze=Ve===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[2],st=ct-this.margin[0],ft=this.pdf.internal.pageSize.width-this.margin[1],nt=ft-this.margin[3],De=Ve===1?0:Ye+(Ve-2)*st;if(this.ctx.clip_path.length!==0){var Fe=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(V,this.posX+this.margin[3],-1*De+ze),P.call(this,"fill",!0),this.path=Fe}var Ge=y([JSON.parse(JSON.stringify(te))],this.posX+this.margin[3],-De+ze+this.ctx.prevPageLastElemOffset)[0];S.scale>=.01&&(j=this.pdf.internal.getFontSize(),this.pdf.setFontSize(j*S.scale),O=this.lineWidth,this.lineWidth=O*S.scale);var _e=this.autoPaging!=="text";if(_e||Ge.y+Ge.h<=ct){if(_e||Ge.y>=ze&&Ge.x<=ft){var G=_e?S.text:this.pdf.splitTextToSize(S.text,S.maxWidth||ft-Ge.x)[0],Ne=y([JSON.parse(JSON.stringify(Oe))],this.posX+this.margin[3],-De+ze+this.ctx.prevPageLastElemOffset)[0],Ue=_e&&(Ve>fe||Ve<Ie)&&p.call(this);Ue&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],nt,st,null).clip().discardPath()),this.pdf.text(G,Ne.x,Ne.y,{angle:S.angle,align:I,renderingMode:S.renderingMode}),Ue&&this.pdf.restoreGraphicsState()}}else Ge.y<ct&&(this.ctx.prevPageLastElemOffset+=ct-Ge.y);S.scale>=.01&&(this.pdf.setFontSize(j),this.lineWidth=O)}}else S.scale>=.01&&(j=this.pdf.internal.getFontSize(),this.pdf.setFontSize(j*S.scale),O=this.lineWidth,this.lineWidth=O*S.scale),this.pdf.text(S.text,se.x+this.posX,se.y+this.posY,{angle:S.angle,align:I,renderingMode:S.renderingMode,maxWidth:S.maxWidth}),S.scale>=.01&&(this.pdf.setFontSize(j),this.lineWidth=O)},U=function(S,I,V,j){V=V||0,j=j||0,this.pdf.internal.out(r(S+V)+" "+n(I+j)+" l")},Z=function(S,I,V){return this.pdf.lines(S,I,V,null,null)},pe=function(S,I,V,j,O,W,D,Y){this.pdf.internal.out([e(s(V+S)),e(a(j+I)),e(s(O+S)),e(a(W+I)),e(s(D+S)),e(a(Y+I)),"c"].join(" "))},ae=function(S,I,V,j){for(var O=2*Math.PI,W=Math.PI/2;I>V;)I-=O;var D=Math.abs(V-I);D<O&&j&&(D=O-D);for(var Y=[],se=j?-1:1,ve=I;D>1e-5;){var z=ve+se*Math.min(D,W);Y.push(he.call(this,S,ve,z)),D-=Math.abs(z-ve),ve=z}return Y},he=function(S,I,V){var j=(V-I)/2,O=S*Math.cos(j),W=S*Math.sin(j),D=O,Y=-W,se=D*D+Y*Y,ve=se+D*O+Y*W,z=4/3*(Math.sqrt(2*se*ve)-ve)/(D*W-Y*O),Oe=D-z*Y,te=Y+z*D,J=Oe,q=-te,ie=j+I,fe=Math.cos(ie),Ie=Math.sin(ie);return{x1:S*Math.cos(I),y1:S*Math.sin(I),x2:Oe*fe-te*Ie,y2:Oe*Ie+te*fe,x3:J*fe-q*Ie,y3:J*Ie+q*fe,x4:S*Math.cos(V),y4:S*Math.sin(V)}},de=function(S){return 180*S/Math.PI},re=function(S,I,V,j,O,W){var D=S+.5*(V-S),Y=I+.5*(j-I),se=O+.5*(V-O),ve=W+.5*(j-W),z=Math.min(S,O,D,se),Oe=Math.max(S,O,D,se),te=Math.min(I,W,Y,ve),J=Math.max(I,W,Y,ve);return new l(z,te,Oe-z,J-te)},xe=function(S,I,V,j,O,W,D,Y){var se,ve,z,Oe,te,J,q,ie,fe,Ie,Ve,ze,Ye,ct,st=V-S,ft=j-I,nt=O-V,De=W-j,Fe=D-O,Ge=Y-W;for(ve=0;ve<41;ve++)fe=(q=(z=S+(se=ve/40)*st)+se*((te=V+se*nt)-z))+se*(te+se*(O+se*Fe-te)-q),Ie=(ie=(Oe=I+se*ft)+se*((J=j+se*De)-Oe))+se*(J+se*(W+se*Ge-J)-ie),ve==0?(Ve=fe,ze=Ie,Ye=fe,ct=Ie):(Ve=Math.min(Ve,fe),ze=Math.min(ze,Ie),Ye=Math.max(Ye,fe),ct=Math.max(ct,Ie));return new l(Math.round(Ve),Math.round(ze),Math.round(Ye-Ve),Math.round(ct-ze))},Ce=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var S,I,V=(S=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:S,lineDashOffset:I}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(sr.API),function(t){var e=function(o){var l,c,A,u,d,f,h,m,p,x;for(c=[],A=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>A;A+=4)(d=(o.charCodeAt(A)<<24)+(o.charCodeAt(A+1)<<16)+(o.charCodeAt(A+2)<<8)+o.charCodeAt(A+3))!==0?(f=(d=((d=((d=((d=(d-(x=d%85))/85)-(p=d%85))/85)-(m=d%85))/85)-(h=d%85))/85)%85,c.push(f+33,h+33,m+33,p+33,x+33)):c.push(122);return function(g,y){for(var b=y;b>0;b--)g.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,A,u,d,f=String,h="length",m=255,p="charCodeAt",x="slice",g="replace";for(o[x](-2),o=o[x](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),A=[],u=0,d=(o+=l="uuuuu"[x](o[h]%5||5))[h];d>u;u+=5)c=52200625*(o[p](u)-33)+614125*(o[p](u+1)-33)+7225*(o[p](u+2)-33)+85*(o[p](u+3)-33)+(o[p](u+4)-33),A.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var F=b;F>0;F--)y.pop()}(A,l[h]),f.fromCharCode.apply(f,A)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",A=0;A<o.length;A+=2)c+=String.fromCharCode("0x"+(o[A]+o[A+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=gE(l)).reduce(function(A,u){return A+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,l){var c=0,A=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":A=r(A),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=e(A),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=s(A),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=n(A),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=a(A),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:A,reverseChain:u.reverse().join(" ")}}}(sr.API),function(t){t.loadFile=function(e,r,n){return function(s,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,A,u){var d=new XMLHttpRequest,f=0,h=function(m){var p=m.length,x=[],g=String.fromCharCode;for(f=0;f<p;f+=1)x.push(g(255&m.charCodeAt(f)));return x.join("")};if(d.open("GET",c,!A),d.overrideMimeType("text/plain; charset=x-user-defined"),A===!1&&(d.onload=function(){d.status===200?u(h(this.responseText)):u(void 0)}),d.send(null),A&&d.status===200)return h(d.responseText)}(s,a,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(sr.API),function(t){function e(){return(Sr.html2canvas?Promise.resolve(Sr.html2canvas):mA(()=>Promise.resolve().then(()=>JS),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Sr.DOMPurify?Promise.resolve(Sr.DOMPurify):mA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Sn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var A=document.createElement(l);for(var u in c.className&&(A.className=c.className),c.innerHTML&&c.dompurify&&(A.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)A.style[u]=c.style[u];return A},a=function l(c,A){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)A!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||u.appendChild(l(d,A));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var A=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),A);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(A){switch(n(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(A){return this.set({src:s("div",{innerHTML:l,dompurify:A})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,c(this.prop.container,A)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var A=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var m=u[h],p=m.src.find(function(x){return x.format==="truetype"});p&&A.addFont(p.url,m.ref.name,m.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,A.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(A){if(A in o.template.prop)return function(){this.prop[A]=l[A]};switch(A){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[A]=l[A]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var A=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(A):A})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(A,u){return Math.floor(A*u/72*96)}return this.then(function(){(l=l||sr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,A,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),A!=null&&(this.progress.n=A),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,A,u){return this.setProgress(l?this.progress.val+l:null,c||null,A?this.progress.n+A:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var A=this;return this.thenCore(l,c,function(u,d){return A.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(f){return A.updateProgress(null,u),f}).then(u,d).then(function(f){return A.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,A){A=A||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),f=A.call(d,l,c);return o.convert(f,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(A){c=c.thenCore(A)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,sr.getPageSize=function(l,c,A){if(Sn(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,A=u.format||A}c=c||"mm",A=A||"a4",l=(""+(l||"P")).toLowerCase();var d,f=(""+A).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(f))p=h[f][1]/d,x=h[f][0]/d;else try{p=A[1],x=A[0]}catch{throw new Error("Invalid format: "+A)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:d,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(VN):null;var A=new o(c);return c.worker?A:A.from(l).doCallback()}}(sr.API),sr.API.addJS=function(t){return Pj=t,this.internal.events.subscribe("postPutResources",function(){u1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(u1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),jj=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Pj+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){u1!==void 0&&jj!==void 0&&this.internal.out("/Names <</JavaScript "+u1+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var o=s[a],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var A=this.internal.pages.length,u=[];for(a=0;a<A;a++){var d=r.internal.newObject();u.push(d);var f=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<u.length;a++)r.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var o={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var A=0;A<n.children.length;A++)this.renderItems(n.children[A])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(sr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,a,o,l){var c,A=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(d){for(var f,h=256*d.charCodeAt(4)+d.charCodeAt(5),m=d.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(d.charCodeAt(x+1))!==-1){f=256*d.charCodeAt(x+5)+d.charCodeAt(x+6),p={width:256*d.charCodeAt(x+7)+d.charCodeAt(x+8),height:f,numcomponents:d.charCodeAt(x+9)};break}h=256*d.charCodeAt(x+2)+d.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:A,index:n,alias:s}}return u}}(sr.API),sr.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var s,a=Hie(t,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,A=a.palette,u=a.depth;s=A&&c===1?function(B){for(var E=B.width,M=B.height,k=B.data,T=B.palette,U=B.depth,Z=!1,pe=[],ae=[],he=void 0,de=!1,re=0,xe=0;xe<T.length;xe++){var Ce=UT(T[xe],4),S=Ce[0],I=Ce[1],V=Ce[2],j=Ce[3];pe.push(S,I,V),j!=null&&(j===0?(re++,ae.length<1&&ae.push(xe)):j<255&&(de=!0))}if(de||re>1){Z=!0,ae=void 0;var O=E*M;he=new Uint8Array(O);for(var W=new DataView(k.buffer),D=0;D<O;D++){var Y=KN(W,D,U),se=UT(T[Y],4)[3];he[D]=se}}else re===0&&(ae=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Z?8:void 0,colorBytes:k,alphaBytes:he,needSMask:Z,palette:pe,mask:ae}}(a):c===2||c===4?function(B){for(var E=B.data,M=B.width,k=B.height,T=B.channels,U=B.depth,Z=T===2?"DeviceGray":"DeviceRGB",pe=T-1,ae=M*k,he=pe,de=ae*he,re=1*ae,xe=Math.ceil(de*U/8),Ce=Math.ceil(re*U/8),S=new Uint8Array(xe),I=new Uint8Array(Ce),V=new DataView(E.buffer),j=new DataView(S.buffer),O=new DataView(I.buffer),W=!1,D=0;D<ae;D++){for(var Y=D*T,se=0;se<he;se++)Hj(j,KN(V,Y+se,U),D*he+se,U);var ve=KN(V,Y+he,U);ve<(1<<U)-1&&(W=!0),Hj(O,ve,1*D,U)}return{colorSpace:Z,colorsPerPixel:pe,sMaskBitsPerComponent:W?U:void 0,colorBytes:S,alphaBytes:I,needSMask:W}}(a):function(B){var E=B.data,M=B.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:M,colorsPerPixel:M==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(k){for(var T=k.length,U=new Uint8Array(2*T),Z=new DataView(U.buffer,U.byteOffset,U.byteLength),pe=0;pe<T;pe++)Z.setUint16(2*pe,k[pe],!1);return U}(E):E,needSMask:!1}}(a);var d,f,h,m=s,p=m.colorSpace,x=m.colorsPerPixel,g=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,F=m.needSMask,P=m.palette,R=m.mask,_=null;return n!==sr.API.image_compression.NONE&&typeof gE=="function"?(_=function(B){var E;switch(B){case sr.API.image_compression.FAST:E=11;break;case sr.API.image_compression.MEDIUM:E=13;break;case sr.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),d=this.decode.FLATE_DECODE,f="/Predictor ".concat(_," /Colors ").concat(x," /BitsPerComponent ").concat(u," /Columns ").concat(o),t=Uj(y,Math.ceil(o*x*u/8),x,u,n),F&&(h=Uj(b,Math.ceil(o*g/8),1,g,n))):(d=void 0,f=void 0,t=y,F&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:d,decodeParameters:f,transparency:R,palette:P,sMask:h,predictor:_,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:g,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,s){var a=new uoe(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var A={data:c,width:o,height:l},u=new qN(100).encode(A,100);return t.processJPEG.call(this,u,r,n,s)},t.processGIF87A=t.processGIF89A}(sr.API),Cl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Cl.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Vn.log("bit decode error:"+r)}},Cl.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Cl.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=a>>4,c=15&a,A=this.palette[l];if(this.data[o]=A.blue,this.data[o+1]=A.green,this.data[o+2]=A.red,this.data[o+3]=255,2*s+1>=this.width)break;A=this.palette[c],this.data[o+4]=A.blue,this.data[o+4+1]=A.green,this.data[o+4+2]=A.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Cl.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Cl.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,A=a>>15?255:0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=A}this.pos+=t}},Cl.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,A=(o>>11)/e*255|0,u=s*this.width*4+4*a;this.data[u]=A,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},Cl.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Cl.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},Cl.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,s){var a=new Cl(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new qN(100).encode(c,100);return t.processJPEG.call(this,A,r,n,s)}}(sr.API),qj.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,s){var a=new qj(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new qN(100).encode(c,100);return t.processJPEG.call(this,A,r,n,s)}}(sr.API),sr.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,a=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,A=0;A<s;A+=4){var u=n[A],d=n[A+1],f=n[A+2],h=n[A+3];a[l++]=u,a[l++]=d,a[l++]=f,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},sr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Sf=sr.API,d1=Sf.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,A=e.kerning?e.kerning:s.metadata.Unicode.kerning,u=A.fof?A.fof:1,d=e.doKerning!==!1,f=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?x.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(f=d&&Sn(A[n])==="object"&&!isNaN(parseInt(A[n][m],10))?A[n][m]/u:0,x.push((l[n]||p)/c+f)),m=n;return x},Rj=Sf.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Sf.processArabic&&(t=Sf.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:d1.apply(this,arguments).reduce(function(a,o){return a+o},0)},Dj=function(t,e,r,n){for(var s=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<r;)l+=e[a],a++;s.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>n&&(s.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&s.push(t.slice(c,a)),s},Lj=function(t,e,r){r||(r={});var n,s,a,o,l,c,A,u=[],d=[u],f=r.textIndent||0,h=0,m=0,p=t.split(" "),x=d1.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var g=Array(c).join(" "),y=[];p.map(function(F){(F=F.split(/\s*\n/)).length>1?y=y.concat(F.map(function(P,R){return(R&&P.length?`
`:"")+P})):y.push(F[0])}),p=y,c=Rj.apply(this,[g,r])}for(a=0,o=p.length;a<o;a++){var b=0;if(n=p[a],c&&n[0]==`
`&&(n=n.substr(1),b=1),f+h+(m=(s=d1.apply(this,[n,r])).reduce(function(F,P){return F+P},0))>e||b){if(m>e){for(l=Dj.apply(this,[n,s,e-(f+h),e]),u.push(l.shift()),u=[l.pop()];l.length;)d.push([l.shift()]);m=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(F,P){return F+P},0)}else u=[n];d.push(u),f=m+c,h=x}else u.push(n),f+=h+m,h=x}return A=c?function(F,P){return(P?g:"")+F.join(" ")}:function(F){return F.join(" ")},d.map(A)},Sf.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle),f="Unicode";return d.metadata[f]?{widths:d.metadata[f].widths||{0:1},kerning:d.metadata[f].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var l,c,A=[];for(l=0,c=n.length;l<c;l++)A=A.concat(Lj.apply(this,[n[l],o,a]));return A},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=e[a],s[e[a]]=r[a];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=t.__fontmetrics__.compress=function(f){var h,m,p,x,g=["{"];for(var y in f){if(h=f[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+s[p.slice(-1)];else{if(Sn(h)!=="object")throw new Error("Don't know what to do with value type "+Sn(h)+".");p=l(h)}g.push(m+p)}return g.push("}"),g.join("")},c=t.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,g={},y=1,b=g,F=[],P="",R="",_=f.length-1,B=1;B<_;B+=1)(x=f[B])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(F.push([b,p]),b={},p=void 0):x=="}"?((m=F.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?y=-1:p===void 0?n.hasOwnProperty(x)?(P+=n[x],p=parseInt(P,16)*y,y=1,P=""):P+=x:n.hasOwnProperty(x)?(R+=n[x],b[p]=parseInt(R,16)*y,y=1,p=void 0,R=""):R+=x;return g},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(f){var h=f.font,m=d.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=u.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(sr.API),function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(gw(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(sr),sr.API.addSvgAsImage=function(t,e,r,n,s,a,o,l){if(isNaN(e)||isNaN(r))throw Vn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Vn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var A=c.getContext("2d");A.fillStyle="#fff",A.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(Sr.canvg?Promise.resolve(Sr.canvg):mA(()=>import("./index.es-BEIZPzle.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(A,t,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(u)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),e,r,n,s,o,l)})},sr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},sr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],A=0,u=0,d=0;function f(m,p){var x,g=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(g=!0);return g}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(d=0;d<h;d+=1)r[l[d]].value=r[l[d]].defaultValue,r[l[d]].explicitSet=!1}if(Sn(t)==="object"){for(s in t)if(a=t[s],f(l,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&f(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(A=0;A<a.length;A+=1)if(n=!0,a[A].length===1&&typeof a[A][0]=="number")c.push(String(a[A]-1));else if(a[A].length>1){for(u=0;u<a[A].length;u+=1)typeof a[A][u]!="number"&&(n=!1);n===!0&&c.push([a[A][0]-1,a[A][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),A=a.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+A+" >>"),this.internal.write("stream"),this.internal.write(s+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(sr.API),function(t){var e=t.API,r=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,A=["","0","00","000","0000"],u=[""],d=0,f=a.length;d<f;++d){if(l=o.metadata.characterToGlyph(a.charCodeAt(d)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(d),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(A[4-l.length],l)}return u.join("")},n=function(a){var o,l,c,A,u,d,f;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,f=(l=Object.keys(a).sort(function(h,m){return h-m})).length;d<f;d++)o=l[d],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(A=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+A+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var d=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<f.length;m++)h+=String.fromCharCode(f[m]);var p=A();u({data:h,addLength1:!0,objectId:p}),c("endobj");var x=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var g=A();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+qf(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=A();c("<<"),c("/Type /Font"),c("/BaseFont /"+qf(l.fontName)),c("/FontDescriptor "+g+" 0 R"),c("/W "+t.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=A(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+qf(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var d=l.metadata.rawData,f="",h=0;h<d.length;h++)f+=String.fromCharCode(d[h]);var m=A();u({data:f,addLength1:!0,objectId:m}),c("endobj");var p=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=A();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+qf(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=A();for(var g=0;g<l.metadata.hmtx.widths.length;g++)l.metadata.hmtx.widths[g]=parseInt(l.metadata.hmtx.widths[g]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+qf(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var s=function(a){var o,l=a.text||"",c=a.x,A=a.y,u=a.options||{},d=a.mutex||{},f=d.pdfEscape,h=d.activeFontKey,m=d.fonts,p=h,x="",g=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:A,options:u,mutex:d};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),g=0;g<y.length;g+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[g].charCodeAt(0)]),o||y[g].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=y[g]:x+="";var F="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?F=f(x,p).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(F=r(x,m[p])),d.isHex=!0,{text:F,x:c,y:A,options:u,mutex:d}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var A=0;for(A=0;A<o.length;A+=1)Array.isArray(o[A])&&o[A].length===3?l.push([s(Object.assign({},c,{text:o[A][0]})).text,o[A][1],o[A][2]]):l.push(s(Object.assign({},c,{text:o[A]})).text);a.text=l}else a.text=s(Object.assign({},c,{text:o})).text}])}(sr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(sr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,a,o,l,c,A,u,d=e,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var F=function(k){var T=k.charCodeAt(),U=T>>8,Z=p[U];return Z!==void 0?d[256*Z+(255&T)]:U===252||U===253?"AL":g.test(U)?"L":U===8?"R":"N"},P=function(k){for(var T,U=0;U<k.length;U++){if((T=F(k.charAt(U)))==="L")return!1;if(T==="R")return!0}return!1},R=function(k,T,U,Z){var pe,ae,he,de,re=T[Z];switch(re){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(re="AN");break;case"AL":y=!0,re="R";break;case"WS":case"BN":re="N";break;case"CS":Z<1||Z+1>=T.length||(pe=U[Z-1])!=="EN"&&pe!=="AN"||(ae=T[Z+1])!=="EN"&&ae!=="AN"?re="N":y&&(ae="AN"),re=ae===pe?ae:"N";break;case"ES":re=(pe=Z>0?U[Z-1]:"B")==="EN"&&Z+1<T.length&&T[Z+1]==="EN"?"EN":"N";break;case"ET":if(Z>0&&U[Z-1]==="EN"){re="EN";break}if(y){re="N";break}for(he=Z+1,de=T.length;he<de&&T[he]==="ET";)he++;re=he<de&&T[he]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(de=T.length,he=Z+1;he<de&&T[he]==="NSM";)he++;if(he<de){var xe=k[Z],Ce=xe>=1425&&xe<=2303||xe===64286;if(pe=T[he],Ce&&(pe==="R"||pe==="AL")){re="R";break}}}re=Z<1||(pe=T[Z-1])==="B"?"N":U[Z-1];break;case"B":y=!1,s=!0,re=b;break;case"S":a=!0,re="N"}return re},_=function(k,T,U){var Z=k.split("");return U&&B(Z,U,{hiLevel:b}),Z.reverse(),T&&T.reverse(),Z.join("")},B=function(k,T,U){var Z,pe,ae,he,de,re=-1,xe=k.length,Ce=0,S=[],I=b?h:f,V=[];for(y=!1,s=!1,a=!1,pe=0;pe<xe;pe++)V[pe]=F(k[pe]);for(ae=0;ae<xe;ae++){if(de=Ce,S[ae]=R(k,V,S,ae),Z=240&(Ce=I[de][m[S[ae]]]),Ce&=15,T[ae]=he=I[Ce][5],Z>0)if(Z===16){for(pe=re;pe<ae;pe++)T[pe]=1;re=-1}else re=-1;if(I[Ce][6])re===-1&&(re=ae);else if(re>-1){for(pe=re;pe<ae;pe++)T[pe]=he;re=-1}V[ae]==="B"&&(T[ae]=0),U.hiLevel|=he}a&&function(j,O,W){for(var D=0;D<W;D++)if(j[D]==="S"){O[D]=b;for(var Y=D-1;Y>=0&&j[Y]==="WS";Y--)O[Y]=b}}(V,T,xe)},E=function(k,T,U,Z,pe){if(!(pe.hiLevel<k)){if(k===1&&b===1&&!s)return T.reverse(),void(U&&U.reverse());for(var ae,he,de,re,xe=T.length,Ce=0;Ce<xe;){if(Z[Ce]>=k){for(de=Ce+1;de<xe&&Z[de]>=k;)de++;for(re=Ce,he=de-1;re<he;re++,he--)ae=T[re],T[re]=T[he],T[he]=ae,U&&(ae=U[re],U[re]=U[he],U[he]=ae);Ce=de}Ce++}}},M=function(k,T,U){var Z=k.split(""),pe={hiLevel:b};return U||(U=[]),B(Z,U,pe),function(ae,he,de){if(de.hiLevel!==0&&u)for(var re,xe=0;xe<ae.length;xe++)he[xe]===1&&(re=x.indexOf(ae[xe]))>=0&&(ae[xe]=x[re+1])}(Z,U,pe),E(2,Z,T,U,pe),E(1,Z,T,U,pe),Z.join("")};return this.__bidiEngine__.doBidiReorder=function(k,T,U){if(function(pe,ae){if(ae)for(var he=0;he<pe.length;he++)ae[he]=he;l===void 0&&(l=P(pe)),A===void 0&&(A=P(pe))}(k,T),o||!c||A)if(o&&c&&l^A)b=l?1:0,k=_(k,T,U);else if(!o&&c&&A)b=l?1:0,k=M(k,T,U),k=_(k,T);else if(!o||l||c||A){if(o&&!c&&l^A)k=_(k,T),l?(b=0,k=M(k,T,U)):(b=1,k=M(k,T,U),k=_(k,T));else if(o&&l&&!c&&A)b=1,k=M(k,T,U),k=_(k,T);else if(!o&&!c&&l^A){var Z=u;l?(b=1,k=M(k,T,U),b=0,u=!1,k=M(k,T,U),u=Z):(b=0,k=M(k,T,U),k=_(k,T),b=1,u=!1,k=M(k,T,U),u=Z,k=_(k,T))}}else b=0,k=M(k,T,U);else b=l?1:0,k=M(k,T,U);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,A=k.isOutputRtl,u=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(sr),sr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new ad(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Eoe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new doe(this.contents),this.head=new foe(this),this.name=new voe(this),this.cmap=new JM(this),this.toUnicode={},this.hhea=new moe(this),this.maxp=new woe(this),this.hmtx=new yoe(this),this.post=new goe(this),this.os2=new poe(this),this.loca=new _oe(this),this.glyf=new boe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,A;for(A=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],A.push(Math.round(e*this.scaleFactor));return A}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)s=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Wl,ad=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,a,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,a;for(a=[],n=0,s=e.length;n<s;n++)r=e[n],a.push(this.writeByte(r));return a},t}(),doe=function(){var t;function e(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,a,o,l,c,A,u,d,f,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),d=16*Math.floor(Math.log(h)/c),o=Math.floor(d/c),u=16*h-d,(s=new ad).writeInt(this.scalarType),s.writeShort(h),s.writeShort(d),s.writeShort(o),s.writeShort(u),a=16*h,A=s.pos+a,l=null,m=[],r)for(f=r[p],s.writeString(p),s.writeInt(t(f)),s.writeInt(A),s.writeInt(f.length),m=m.concat(f),p==="head"&&(l=A),A+=f.length;A%4;)m.push(0),A++;return s.write(m),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,a,o;for(r=XM.call(r);r.length%4;)r.push(0);for(a=new ad(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=a.readUInt32();return 4294967295&s},e}(),hoe={}.hasOwnProperty,Ic=function(t,e){for(var r in e)hoe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Wl=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var foe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new ad).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),Gj=function(){function t(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),f=h/2,e.pos+=6,a=function(){var F,P;for(P=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)P.push(e.readUInt16());return P}(),e.pos+=2,p=function(){var F,P;for(P=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)P.push(e.readUInt16());return P}(),A=function(){var F,P;for(P=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)P.push(e.readUInt16());return P}(),u=function(){var F,P;for(P=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)P.push(e.readUInt16());return P}(),s=(this.length-e.pos+this.offset)/2,l=function(){var F,P;for(P=[],c=F=0;0<=s?F<s:F>s;c=0<=s?++F:--F)P.push(e.readUInt16());return P}(),c=g=0,b=a.length;g<b;c=++g)for(x=a[c],n=y=m=p[c];m<=x?y<=x:y>=x;n=m<=x?++y:--y)u[c]===0?o=n+A[c]:(o=l[u[c]/2+(n-m)-(f-c)]||0)!==0&&(o+=A[c]),this.codeMap[n]=65535&o}e.pos=d}return t.encode=function(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b,F,P,R,_,B,E,M,k,T,U,Z,pe,ae,he,de,re,xe,Ce,S,I,V,j,O,W,D,Y,se,ve,z;switch(Z=new ad,o=Object.keys(e).sort(function(Oe,te){return Oe-te}),r){case"macroman":for(p=0,x=function(){var Oe=[];for(m=0;m<256;++m)Oe.push(0);return Oe}(),y={0:0},a={},pe=0,re=o.length;pe<re;pe++)y[Y=e[s=o[pe]]]==null&&(y[Y]=++p),a[s]={old:e[s],new:y[e[s]]},x[s]=y[e[s]];return Z.writeUInt16(1),Z.writeUInt16(0),Z.writeUInt32(12),Z.writeUInt16(0),Z.writeUInt16(262),Z.writeUInt16(0),Z.write(x),{charMap:a,subtable:Z.data,maxGlyphID:p+1};case"unicode":for(T=[],d=[],b=0,y={},n={},g=A=null,ae=0,xe=o.length;ae<xe;ae++)y[P=e[s=o[ae]]]==null&&(y[P]=++b),n[s]={old:P,new:y[P]},l=y[P]-s,g!=null&&l===A||(g&&d.push(g),T.push(s),A=l),g=s;for(g&&d.push(g),d.push(65535),T.push(65535),M=2*(E=T.length),B=2*Math.pow(Math.log(E)/Math.LN2,2),f=Math.log(B/2)/Math.LN2,_=2*E-B,c=[],R=[],h=[],m=he=0,Ce=T.length;he<Ce;m=++he){if(k=T[m],u=d[m],k===65535){c.push(0),R.push(0);break}if(k-(U=n[k].new)>=32768)for(c.push(0),R.push(2*(h.length+E-m)),s=de=k;k<=u?de<=u:de>=u;s=k<=u?++de:--de)h.push(n[s].new);else c.push(U-k),R.push(0)}for(Z.writeUInt16(3),Z.writeUInt16(1),Z.writeUInt32(12),Z.writeUInt16(4),Z.writeUInt16(16+8*E+2*h.length),Z.writeUInt16(0),Z.writeUInt16(M),Z.writeUInt16(B),Z.writeUInt16(f),Z.writeUInt16(_),W=0,S=d.length;W<S;W++)s=d[W],Z.writeUInt16(s);for(Z.writeUInt16(0),D=0,I=T.length;D<I;D++)s=T[D],Z.writeUInt16(s);for(se=0,V=c.length;se<V;se++)l=c[se],Z.writeUInt16(l);for(ve=0,j=R.length;ve<j;ve++)F=R[ve],Z.writeUInt16(F);for(z=0,O=h.length;z<O;z++)p=h[z],Z.writeUInt16(p);return{charMap:n,subtable:Z.data,maxGlyphID:b+1}}},t}(),JM=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new Gj(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,s;return r==null&&(r="macroman"),n=Gj.encode(e,r),(s=new ad).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t}(),moe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),poe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),goe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)r=e.readByte(),s.push(this.names.push(e.readString(r)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),xoe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},voe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,s,a,o,l,c,A,u,d,f;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},a=u=0,d=n.length;u<d;a=++u)s=n[a],e.pos=s.offset,A=e.readString(s.length),o=new xoe(A,s),c[f=s.nameID]==null&&(c[f]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),woe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),yoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,s,a,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var A,u;for(u=[],r=A=0;0<=s?A<s:A>s;r=0<=s?++A:--A)u.push(e.readInt16());return u}(),this.widths=(function(){var A,u,d,f;for(f=[],A=0,u=(d=this.metrics).length;A<u;A++)a=d[A],f.push(a.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),XM=[].slice,boe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,s,a,o,l,c,A,u,d;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new ad(r.read(s))).readShort(),A=l.readShort(),d=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[e]=o===-1?new Coe(l,A,d,c,u):new Noe(l,o,A,d,c,u),this.cache[e]))},t.prototype.encode=function(e,r,n){var s,a,o,l,c;for(o=[],a=[],l=0,c=r.length;l<c;l++)s=e[r[l]],a.push(o.length),s&&(o=o.concat(s.encode(n)));return a.push(o.length),{table:o,offsets:a}},t}(),Noe=function(){function t(e,r,n,s,a,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),Coe=function(){function t(e,r,n,s,a){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new ad(XM.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),_oe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,Wl),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<n.length;++o)if(n[o]=s,a<r.length&&r[a]==o){++a,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var A=new Array(4*n.length),u=0;u<n.length;++u)A[4*u+3]=255&n[u],A[4*u+2]=(65280&n[u])>>8,A[4*u+1]=(16711680&n[u])>>16,A[4*u]=(4278190080&n[u])>>24;return A},t}(),Eoe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,a,o,l,c;for(s={},o=0,l=e.length;o<l;o++)s[a=e[o]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},t.prototype.encode=function(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g;for(s in n=JM.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},g=n.charMap)h[(c=g[s]).old]=c.new;for(m in f=n.maxGlyphID,o)m in h||(h[m]=f++);return u=function(y){var b,F;for(b in F={},y)F[y[b]]=b;return F}(h),d=Object.keys(u).sort(function(y,b){return y-b}),p=function(){var y,b,F;for(F=[],y=0,b=d.length;y<b;y++)l=d[y],F.push(u[l]);return F}(),a=this.font.glyf.encode(o,p,h),A=this.font.loca.encode(a.offsets,p),x={cmap:this.font.cmap.raw(),glyf:a.table,loca:A,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();sr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,a,o;if(Array.isArray(r))return"["+function(){var l,c,A;for(A=[],l=0,c=r.length;l<c;l++)n=r[l],A.push(e.convert(n));return A}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)o=r[s],a.push("/"+s+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+r},e}();const _E=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:noe,AcroFormAppearance:lr,AcroFormButton:ca,AcroFormCheckBox:Xp,AcroFormChoiceField:lh,AcroFormComboBox:Ah,AcroFormEditBox:Wp,AcroFormListBox:ch,AcroFormPasswordField:Yp,AcroFormPushButton:Jp,AcroFormRadioButton:uh,AcroFormTextField:Wu,GState:zg,ShadingPattern:Cu,TilingPattern:th,default:sr,jsPDF:sr},Symbol.toStringTag,{value:"Module"}));async function $j(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:Kt.now()};return Wr(At(je,"inventory_batches"),e)}async function YM(t,e){await kr(kt(je,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:Kt.now()})}async function Boe(t,e){const r=Ut(At(je,"batch_allocations"),qt("saleDate",">=",t),qt("saleDate","<=",e)),n=await Nt(r),s={};return n.forEach(a=>{const o=a.data(),l=o.batchId;s[l]||(s[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),s[l].quantity+=Number(o.quantity||0),s[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(s)}async function Soe(t){const e=kt(je,"salesV2",t),r=await Wa(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const A=String((c==null?void 0:c.batchId)||"").trim(),u=Number((c==null?void 0:c.qty)||0);A&&u&&s.push({batchId:A,qty:u})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),A=Number((l==null?void 0:l.qty)||0);c&&A&&s.push({batchId:c,qty:A})}if(s.length===0)return await ha(je,async l=>{l.delete(e)}),{restored:0};const a=new Map;for(const l of s)a.set(l.batchId,Number((a.get(l.batchId)||0)+l.qty));let o=0;return await ha(je,async l=>{const c=Array.from(a.entries()),A=c.map(([d])=>kt(je,"inventory_batches",d)),u=await Promise.all(A.map(d=>l.get(d)));c.forEach(([d,f],h)=>{const m=u[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),g=Number((x+Number(f||0)).toFixed(3));l.update(A[h],{remaining:g}),o+=Number(f||0)}),l.delete(e)}),{restored:o}}function Jl(){const[t,e]=N.useState(0),r=N.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const Wo=t=>Math.round((Number(t)||0)*100)/100,h1=t=>Math.round((Number(t)||0)*1e3)/1e3,ep=t=>Number(t??0).toFixed(2),GN=t=>Number(t??0).toFixed(3),zj=(t,e)=>{var n;const r=t.date??((n=t.timestamp)!=null&&n.toDate?rr(t.timestamp.toDate(),"yyyy-MM-dd"):"");return r?Array.isArray(t.items)&&t.items.length>0?t.items.map((s,a)=>{const o=Number((s==null?void 0:s.qty)??0),l=Number((s==null?void 0:s.lineFinal)??0)||Math.max(0,Number((s==null?void 0:s.unitPrice)||0)*o-Number((s==null?void 0:s.discount)||0));return{id:`${e}#${a}`,productName:String((s==null?void 0:s.productName)??"(sin nombre)"),quantity:o,amount:Wo(l),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(s==null?void 0:s.allocations)?s.allocations:t.allocations,avgUnitCost:Number((s==null?void 0:s.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((s==null?void 0:s.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]:[]};function Ioe({role:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[a,o]=N.useState(null),[l,c]=N.useState(!0),[A,u]=N.useState(""),[d,f]=N.useState("ALL"),[h,m]=N.useState(null),[p,x]=N.useState(0),[g,y]=N.useState(0),[b,F]=N.useState(""),[P,R]=N.useState(0),[_,B]=N.useState("0"),E=rr(new Date,"yyyy-MM-dd"),M=N.useRef(null),{refreshKey:k}=Jl();N.useEffect(()=>{const O=Ut(At(je,"salesV2"),qt("date","==",E)),W=M0(O,D=>{const Y=[];D.forEach(se=>{const ve=zj(se.data(),se.id);Y.push(...ve)}),r(Y),c(!1)});return()=>W()},[E,k]),N.useEffect(()=>{const O=Ut(At(je,"salesV2"),qt("status","==","FLOTANTE")),W=M0(O,D=>{const Y=[];D.forEach(se=>{const ve=zj(se.data(),se.id);Y.push(...ve)}),s(Y)});return()=>W()},[k]),N.useEffect(()=>{(async()=>{const W=Ut(At(je,"daily_closures"),qt("date","==",E)),D=await Nt(W);if(D.empty)o(null);else{const Y=D.docs[0];o({id:Y.id,...Y.data()})}})()},[E,k]);const T=ci.useMemo(()=>{if(d==="FLOTANTE"){const O=[...e,...n],W=new Map;for(const D of O)D.status==="FLOTANTE"&&W.set(D.id,D);return Array.from(W.values())}if(d==="ALL"){const O=[...e,...n],W=new Map;for(const D of O)W.set(D.id,D);return Array.from(W.values())}return e.filter(O=>O.status==="PROCESADA")},[d,e,n]);Wo(T.reduce((O,W)=>O+(W.amountSuggested||0),0));const U=Wo(T.reduce((O,W)=>O+(W.amount||0),0)),Z=h1(T.reduce((O,W)=>O+(W.quantity||0),0)),pe=Wo(T.reduce((O,W)=>O+Number(W.cogsAmount??0),0)),ae=Wo(U-pe),he={};T.forEach(O=>{const W=O.productName||"(sin nombre)";he[W]||(he[W]={totalQuantity:0,totalAmount:0}),he[W].totalQuantity=h1(he[W].totalQuantity+(O.quantity||0)),he[W].totalAmount=Wo(he[W].totalAmount+(O.amount||0))});const de=Object.entries(he).map(([O,W])=>({productName:O,totalQuantity:W.totalQuantity,totalAmount:W.totalAmount})),re=async()=>{try{const O=T.filter(Oe=>Oe.status==="FLOTANTE"),W=O.length>0?O:e.filter(Oe=>Oe.status!=="PROCESADA");if(W.length===0){u("No hay ventas para procesar.");return}const D={totalCharged:Wo(W.reduce((Oe,te)=>Oe+(te.amount||0),0)),totalSuggested:Wo(W.reduce((Oe,te)=>Oe+(te.amountSuggested||0),0)),totalUnits:h1(W.reduce((Oe,te)=>Oe+(te.quantity||0),0)),totalCOGS:Wo(W.reduce((Oe,te)=>Oe+Number(te.cogsAmount??0),0))},Y=Wo(D.totalCharged-D.totalSuggested),se=Wo(D.totalCharged-D.totalCOGS),ve=await Wr(At(je,"daily_closures"),{date:E,createdAt:Kt.now(),totalCharged:D.totalCharged,totalSuggested:D.totalSuggested,totalDifference:Y,totalUnits:D.totalUnits,totalCOGS:D.totalCOGS,grossProfit:se,products:W.map(Oe=>({productName:Oe.productName,quantity:Oe.quantity,amount:Oe.amount})),salesV2:W.map(Oe=>({id:Oe.id,productName:Oe.productName,quantity:Oe.quantity,amount:Oe.amount,amountSuggested:Oe.amountSuggested,userEmail:Oe.userEmail,clientName:Oe.clientName,amountReceived:Oe.amountReceived,change:Oe.change,status:Oe.status,cogsAmount:Oe.cogsAmount??0,avgUnitCost:Oe.avgUnitCost??null,allocations:Oe.allocations??[],date:Oe.date})),productSummary:Object.entries(W.reduce((Oe,te)=>{const J=te.productName||"(sin nombre)";return Oe[J]||(Oe[J]={totalQuantity:0,totalAmount:0}),Oe[J].totalQuantity=h1(Oe[J].totalQuantity+(te.quantity||0)),Oe[J].totalAmount=Wo(Oe[J].totalAmount+(te.amount||0)),Oe},{})).map(([Oe,te])=>({productName:Oe,totalQuantity:te.totalQuantity,totalAmount:te.totalAmount}))}),z=Gh(je);W.forEach(Oe=>{z.update(kt(je,"salesV2",Oe.id.split("#")[0]),{status:"PROCESADA",closureId:ve.id,closureDate:E})}),await z.commit(),u(` Cierre guardado. Ventas procesadas: ${W.length}.`)}catch(O){console.error(O),u(" Error al guardar el cierre.")}},xe=async O=>{if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await kr(kt(je,"salesV2",O.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),u(" Venta revertida a FLOTANTE.")}catch(W){console.error(W),u(" No se pudo revertir la venta.")}},Ce=O=>{m(O),x(O.quantity),y(O.amount),F(O.clientName),R(O.amountReceived),B(O.change)},S=async()=>{if(h)try{await kr(kt(je,"salesV2",h.id.split("#")[0]),{quantity:p,amount:g,amountCharged:g,clientName:b,amountReceived:P,change:_}),m(null),u(" Venta actualizada.")}catch(O){console.error(O),u(" No se pudo actualizar la venta.")}},I=async O=>{if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:W}=await Soe(O.split("#")[0]);u(` Venta eliminada. Stock restaurado: ${Number(W).toFixed(2)}.`)}catch(W){console.error(W),u(" No se pudo eliminar la venta.")}},V=async()=>{if(M.current){M.current.classList.add("force-pdf-colors");try{const W=(await $h(M.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),D=new sr;D.addImage(W,"PNG",10,10,190,0),D.save(`cierre_${E}.pdf`)}finally{M.current.classList.remove("force-pdf-colors")}}},j=!t||t==="admin";return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas - ",E]}),i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:d,onChange:O=>f(O.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),l?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:M,children:[i.jsxs("table",{className:"min-w-full border text-sm mb-4  shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[T.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${O.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:O.status})}),i.jsx("td",{className:"border p-1",children:O.productName}),i.jsx("td",{className:"border p-1",children:GN(O.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ep(O.amount)]}),i.jsx("td",{className:"border p-1",children:O.date}),i.jsx("td",{className:"border p-1",children:O.userEmail}),i.jsx("td",{className:"border p-1",children:O.status==="FLOTANTE"?i.jsxs("div",{className:"flex gap-2 justify-center",children:[j&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(O),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>I(O.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}),!j&&i.jsx("span",{className:"text-gray-400 text-xs",children:""})]}):O.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:j?i.jsx("button",{onClick:()=>xe(O.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},O.id)),T.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm mb-2",children:[i.jsxs("div",{children:[" ","Total Libras/Unidades: ",i.jsx("strong",{children:GN(Z)})]}),i.jsxs("div",{children:[" ","Total cobrado: ",i.jsxs("strong",{children:["C$",ep(U)]})]})]}),(pe>0||ae!==U)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:[" ","Calculo a Precio compra:"," ",i.jsxs("strong",{children:["C$",ep(pe)]})]}),i.jsxs("div",{children:[" ","Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",ep(ae)]})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[de.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:O.productName}),i.jsx("td",{className:"border p-1",children:GN(O.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ep(O.totalAmount)]})]},O.productName)),de.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:re,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:V,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),h&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[h.productName,"  ",h.userEmail]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:p,onChange:O=>x(parseFloat(O.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:g,onChange:O=>y(parseFloat(O.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:b,onChange:O=>F(O.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:P,onChange:O=>R(parseFloat(O.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:_,onChange:O=>B(O.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>m(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:S,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const $o=t=>Number(t??0).toFixed(2),If=t=>Number(t??0).toFixed(3);function Foe(){var y,b,F,P;const t=async R=>{if(!window.confirm(`Eliminar el cierre del ${R.date}?`))return;const _=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(_){const B=await Nt(Ut(At(je,"salesV2"),qt("closureId","==",R.id)));if(!B.empty){const E=Gh(je);B.forEach(M=>{E.update(kt(je,"salesV2",M.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await E.commit()}}await un(kt(je,"daily_closures",R.id)),(A==null?void 0:A.id)===R.id&&u(null),await m(),f(` Cierre eliminado${_?" y ventas reabiertas.":"."}`)}catch(B){console.error(B),f(" No se pudo eliminar el cierre.")}},[e,r]=N.useState(rr(nO(new Date),"yyyy-MM-dd")),[n,s]=N.useState(rr(new Date,"yyyy-MM-dd")),[a,o]=N.useState(!0),[l,c]=N.useState([]),[A,u]=N.useState(null),[d,f]=N.useState(""),h=N.useRef(null),m=async()=>{try{o(!0);const R=Ut(At(je,"daily_closures"),qt("date",">=",e),qt("date","<=",n)),_=await Nt(R),B=[];_.forEach(E=>B.push({id:E.id,...E.data()})),B.sort((E,M)=>E.date<M.date?1:E.date>M.date?-1:0),c(B)}catch(R){console.error(R),f(" Error cargando el historial.")}finally{o(!1)}};N.useEffect(()=>{m()},[]);const p=async R=>{R.preventDefault(),m()},x=N.useMemo(()=>{if(!A)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const R=Number(A.totalUnits??0),_=Number(A.totalSuggested??0),B=Number(A.totalCharged??0),E=Number(A.totalDifference??(isFinite(B-_)?B-_:0)),M=Number(A.totalCOGS??0),k=Number(A.grossProfit??(isFinite(B-M)?B-M:0));return{units:R,sug:_,chg:B,diff:E,cogs:M,profit:k}},[A]),g=async()=>{if(!h.current||!A)return;const R=h.current;R.classList.add("force-pdf-colors");try{const[{default:_},{jsPDF:B}]=await Promise.all([mA(()=>Promise.resolve().then(()=>JS),void 0),mA(()=>Promise.resolve().then(()=>_E),void 0)]),M=(await _(R,{backgroundColor:"#ffffff",onclone:U=>{const Z=U.defaultView;U.body.querySelectorAll("*").forEach(ae=>{const he=Z.getComputedStyle(ae);he.color&&(ae.style.color=he.color),he.backgroundColor&&he.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ae.style.backgroundColor=he.backgroundColor),he.borderColor&&(ae.style.borderColor=he.borderColor)})}})).toDataURL("image/png"),{jsPDF:k}=await mA(async()=>{const{jsPDF:U}=await Promise.resolve().then(()=>_E);return{jsPDF:U}},void 0),T=new k;T.addImage(M,"PNG",10,10,190,0),T.save(`cierre_${A.date}.pdf`)}finally{R.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:R=>r(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:R=>s(R.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),a?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(R=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.date}),i.jsx("td",{className:"border p-1",children:If(R.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.grossProfit??Number(R.totalCharged??0)-Number(R.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>u(R),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(R),children:"Eliminar"})]})})]},R.id))})]}),A&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",A.date]}),i.jsx("button",{onClick:()=>u(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:g,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:If(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",$o(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",$o(x.profit)]})]})]}),(y=A.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:A.salesV2.map((R,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:If(R.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:R.date??""}),i.jsx("td",{className:"border p-1",children:R.userEmail??""})]},_))})]})]}):(b=A.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:A.sales.map((R,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:If(R.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.amount)]}),i.jsx("td",{className:"border p-1",children:R.userEmail??""}),i.jsx("td",{className:"border p-1",children:R.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof R.change=="number"?$o(R.change):R.change??"0"})]},_))})]})]}):(F=A.products)!=null&&F.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:A.products.map((R,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName}),i.jsx("td",{className:"border p-1",children:If(R.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.amount)]})]},_))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(P=A.productSummary)!=null&&P.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:A.productSummary.map((R,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName}),i.jsx("td",{className:"border p-1",children:If(R.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(R.totalAmount)]})]},_))})]})]}):null]})]}),d&&i.jsx("p",{className:"mt-3 text-sm",children:d})]})}function koe(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,a]=N.useState(""),[o,l]=N.useState(!1),[c,A]=N.useState("vendedor_pollo"),[u,d]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState([]),[x,g]=N.useState(!0),[y,b]=N.useState(null),[F,P]=N.useState("vendedor_pollo"),[R,_]=N.useState(""),[B,E]=N.useState(!1),[M,k]=N.useState([]),T=I=>!I||I==="vendedor"?"vendedor_pollo":I==="admin"||I==="vendedor_pollo"||I==="vendedor_ropa"||I==="vendedor_dulces"?I:"vendedor_pollo",U=async()=>{g(!0);const I=await Nt(At(je,"users")),V=[];I.forEach(j=>{const O=j.data();V.push({id:j.id,email:O.email??"",name:O.name??"",role:T(O.role),sellerCandyId:O.sellerCandyId??""})}),p(V),g(!1)},Z=async()=>{try{const I=await Nt(At(je,"sellers_candies")),V=[];I.forEach(j=>{const O=j.data();V.push({id:j.id,name:O.name??"(sin nombre)",branchLabel:O.branch??"",commissionPercent:Number(O.commissionPercent??0)})}),k(V)}catch(I){console.error("Error cargando sellers_candies:",I)}};N.useEffect(()=>{U(),Z()},[]);const pe=()=>{e(""),n(""),a(""),A("vendedor_pollo"),h("")},ae=async I=>{if(I.preventDefault(),d(""),s.length<4){d(" La contrasea debe tener al menos 4 caracteres.");return}if(!t.trim()){d(" El nombre es obligatorio.");return}try{const V=KB(),j=HB(V.options,"Secondary"),O=JL(j),W=await w$(O,r,s),D=T(c),Y=D==="vendedor_dulces"&&f||"";await z6(kt(At(je,"users"),W.user.uid),{email:r,name:t.trim(),role:D,sellerCandyId:Y}),await YB(O),await mG(j),p(se=>[{id:W.user.uid,email:r,name:t.trim(),role:D,sellerCandyId:Y},...se]),d(" Usuario creado correctamente."),pe(),E(!1)}catch(V){console.error(V),d(" Error al crear el usuario: "+V.message)}},he=I=>{b(I.id),P(T(I.role)),_(I.sellerCandyId||"")},de=()=>{b(null),P("vendedor_pollo"),_("")},re=async()=>{if(!y)return;const I=kt(je,"users",y),V=T(F),j=V==="vendedor_dulces"&&R||"";await kr(I,{role:V,sellerCandyId:j}),p(O=>O.map(W=>W.id===y?{...W,role:V,sellerCandyId:j}:W)),de()},xe=async I=>{confirm("Eliminar este usuario del listado?")&&(await un(kt(je,"users",I)),p(j=>j.filter(O=>O.id!==I)))},Ce=I=>{const V=I==="admin"?"admin":I==="vendedor_ropa"?"vendedor_ropa":I==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",j=V==="admin"?"bg-blue-100 text-blue-700":V==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":V==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${j}`,children:V})},S=I=>`${I.name}  ${I.branchLabel||"Sin sucursal"}  ${I.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>E(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(I=>{const V=y===I.id,j=(V?F:I.role)==="vendedor_dulces";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:I.name||""}),i.jsx("td",{className:"p-2 border",children:I.email}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("select",{className:"w-full border p-1 rounded",value:F,onChange:O=>P(O.target.value),children:[i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),i.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),i.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]}),F==="vendedor_dulces"&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:R,onChange:O=>_(O.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),M.map(O=>i.jsx("option",{value:O.id,children:S(O)},O.id))]})]}):i.jsxs(i.Fragment,{children:[Ce(I.role),j&&I.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:V?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:re,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:de,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>he(I),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>xe(I.id),children:"Eliminar"})]})})]},I.id)})})]})}),u&&i.jsx("p",{className:"text-sm mt-2",children:u}),B&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>E(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>E(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:I=>e(I.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:I=>n(I.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:s,onChange:I=>a(I.target.value),required:!0}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(I=>!I),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Rol"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:I=>A(I.target.value),children:[i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),i.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),i.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]})]}),c==="vendedor_dulces"&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:f,onChange:I=>h(I.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),M.map(I=>i.jsx("option",{value:I.id,children:S(I)},I.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>E(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Crear usuario"})]})]}),u&&i.jsx("p",{className:"text-sm mt-2",children:u})]})]})]})}const Toe=t=>`C$${(Number(t)||0).toFixed(2)}`;function joe(){const[t,e]=N.useState(""),[r,n]=N.useState(0),[s,a]=N.useState(""),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState([]),[f,h]=N.useState(!0),[m,p]=N.useState(!1),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,P]=N.useState(""),[R,_]=N.useState(""),[B,E]=N.useState(0),[M,k]=N.useState(!1),T=async()=>{h(!0);const xe=await Nt(At(je,"products")),Ce=[];xe.forEach(S=>{const I=S.data();Ce.push({id:S.id,name:I.name??"",price:Number(I.price??0),category:I.category??"",measurement:I.measurement??"",active:I.active!==!1})}),d(Ce),h(!1)};N.useEffect(()=>{T()},[]);const U=async xe=>{if(xe.preventDefault(),a(""),!t||r<=0||!c){a(" Completa nombre, precio vlido y unidad de medida");return}try{const Ce={name:t,price:parseFloat(r.toFixed(2)),category:o,measurement:c,active:!0},S=await Wr(At(je,"products"),Ce);d(I=>[{id:S.id,...Ce},...I]),a(" Producto registrado con exito."),e(""),n(0),A(""),l(""),k(!1)}catch(Ce){a(" Error: "+Ce.message)}},Z=xe=>{g(xe.id),b(xe.name),P(xe.category),_(xe.measurement),E(xe.price)},pe=()=>{g(null),b(""),P(""),_(""),E(0)},ae=async()=>{if(!x)return;const xe=kt(je,"products",x);await kr(xe,{name:y,category:F,measurement:R,price:parseFloat((B||0).toFixed(2))}),d(Ce=>Ce.map(S=>S.id===x?{...S,name:y,category:F,measurement:R,price:parseFloat((B||0).toFixed(2))}:S)),pe()},he=async xe=>{const Ce=kt(je,"products",xe.id),S=xe.active===!1;await kr(Ce,{active:S}),d(I=>I.map(V=>V.id===xe.id?{...V,active:S}:V))},de=async xe=>{const Ce=Ut(At(je,"inventory_batches"),qt("productId","==",xe),G6(1));if(!(await Nt(Ce)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await un(kt(je,"products",xe)),d(V=>V.filter(j=>j.id!==xe)))},re=m?u:u.filter(xe=>xe.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{a(""),k(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),M&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>k(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>k(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:U,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:o,onChange:xe=>l(xe.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:xe=>e(xe.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:c,onChange:xe=>A(xe.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:xe=>n(parseFloat(xe.target.value)),onFocus:xe=>xe.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),s&&i.jsx("p",{className:"text-sm mt-2",children:s})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:m,onChange:xe=>p(xe.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:f?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):re.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):re.map(xe=>{const Ce=x===xe.id,S=xe.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{className:"w-full border p-1 rounded",value:y,onChange:I=>b(I.target.value)}):xe.name}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("select",{className:"w-full border p-1 rounded",value:F,onChange:I=>P(I.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):xe.category}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("select",{className:"w-full border p-1 rounded",value:R,onChange:I=>_(I.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):xe.measurement}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(B)?"":B,onChange:I=>E(parseFloat(I.target.value))}):Toe(xe.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${S?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:S?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:Ce?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ae,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:pe,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Z(xe),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${S?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>he(xe),children:S?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>de(xe.id),children:"Eliminar"})]})})]},xe.id)})})]})})]})}const Da=[];for(let t=0;t<256;++t)Da.push((t+256).toString(16).slice(1));function Poe(t,e=0){return(Da[t[e+0]]+Da[t[e+1]]+Da[t[e+2]]+Da[t[e+3]]+"-"+Da[t[e+4]]+Da[t[e+5]]+"-"+Da[t[e+6]]+Da[t[e+7]]+"-"+Da[t[e+8]]+Da[t[e+9]]+"-"+Da[t[e+10]]+Da[t[e+11]]+Da[t[e+12]]+Da[t[e+13]]+Da[t[e+14]]+Da[t[e+15]]).toLowerCase()}let $N;const Roe=new Uint8Array(16);function Doe(){if(!$N){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");$N=crypto.getRandomValues.bind(crypto)}return $N(Roe)}const Loe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Wj={randomUUID:Loe};function Uoe(t,e,r){var s;if(Wj.randomUUID&&!t)return Wj.randomUUID();t=t||{};const n=t.random??((s=t.rng)==null?void 0:s.call(t))??Doe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Poe(n)}async function Ooe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const s=At(t,"inventory_batches"),a=Ut(s,qt("productName","==",e)),c=(await Nt(a)).docs.map(A=>({id:A.id,data:A.data()})).sort((A,u)=>{var p,x;const d=A.data.date??"",f=u.data.date??"";if(d!==f)return d<f?-1:1;const h=((p=A.data.createdAt)==null?void 0:p.seconds)??0,m=((x=u.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(A=>kt(t,"inventory_batches",A.id));return ha(t,async A=>{let u=Number(r);const d=[],f=await Promise.all(c.map(x=>A.get(x)));for(let x=0;x<c.length&&u>0;x++){const g=c[x],y=f[x];if(!y.exists())continue;const b=y.data(),F=Number(b.quantity??0),P=Number(b.remaining??F??0),R=Number(b.purchasePrice??0);if(P<=0)continue;const _=Math.min(P,u),B=Number((P-_).toFixed(3));A.update(g,{remaining:B}),d.push({batchId:g.id,qty:_,unitCost:R,lineCost:Number((_*R).toFixed(2))}),u=Number((u-_).toFixed(3))}if(u>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${u} unidades.`);const h=Number(d.reduce((x,g)=>x+g.lineCost,0).toFixed(2)),m=d.reduce((x,g)=>x+g.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:d,avgUnitCost:p,cogsAmount:h}})}const ZM=3,Moe=.5*10**-ZM;function gs(t){const e=Number(t??0);return Number(e.toFixed(ZM))}function zN(t,e){return gs((t??0)+(e??0))}function f1(t,e){return gs(t)+Moe>=gs(e)}async function Qoe(t,e){const r=await Nt(At(je,"inventory_batches")),n=t.trim().toLowerCase();let s=0;for(const a of r.docs){const o=a.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await kr(kt(je,"inventory_batches",a.id),{productId:e}),s++)}return s}function Jj({user:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[a,o]=N.useState(""),[l,c]=N.useState(rr(new Date,"yyyy-MM-dd")),[A,u]=N.useState(""),[d,f]=N.useState([]),[h,m]=N.useState(0),[p,x]=N.useState(0),[g,y]=N.useState("0"),[b,F]=N.useState(""),[P,R]=N.useState(!1),[_,B]=N.useState({}),E=j=>Math.round(j*100)/100,M=j=>gs(j).toFixed(3),k=j=>{const O=Number(j.specialPrice||0);return O>0?O:Number(j.price||0)},T=async j=>{if(!j)return 0;const O=Ut(At(je,"inventory_batches"),qt("productId","==",j)),W=await Nt(O);let D=0;return W.forEach(Y=>{const se=Y.data();D=zN(D,Number(se.remaining||0))}),gs(D)},U=async j=>{if(!j)return 0;const O=await Nt(At(je,"inventory_batches"));let W=0;return O.forEach(D=>{const Y=D.data();(Y.productName||"").trim().toLowerCase()===j.trim().toLowerCase()&&(W=zN(W,Number(Y.remaining||0)))}),gs(W)};N.useEffect(()=>{(async()=>{const j=await Nt(At(je,"products")),O=[];j.forEach(W=>{const D=W.data();(D==null?void 0:D.active)!==!1&&O.push({id:W.id,productName:D.name??D.productName??"(sin nombre)",price:Number(D.price??0),measurement:D.measurement??"(sin unidad)",category:D.category??"(sin categora)"})}),r(O)})()},[]),N.useEffect(()=>{(async()=>{const j=await Nt(At(je,"inventory_batches")),O={};j.forEach(W=>{const D=W.data(),Y=D.productId,se=Number(D.remaining||0);Y&&(O[Y]=zN(O[Y]||0,se))}),Object.keys(O).forEach(W=>O[W]=gs(O[W])),B(O)})()},[]),N.useEffect(()=>{(async()=>{const j=await Nt(At(je,"users")),O=[];j.forEach(W=>{const D=W.data();O.push({id:W.id,email:D.email??"(sin email)",role:D.role??"USER"})}),s(O)})()},[]);const Z=async()=>{if(!a)return;const j=e.find(W=>W.id===a);if(!j)return;if(d.some(W=>W.productId===j.id)){o("");return}const O=await T(j.id);f(W=>[...W,{productId:j.id,productName:j.productName,measurement:j.measurement,price:Number(j.price||0),specialPrice:0,stock:O,qty:0,discount:0}]),o("")},pe=j=>{f(O=>O.filter(W=>W.productId!==j))},ae=async(j,O)=>{f(W=>W.map(D=>{if(D.productId!==j)return D;const Y=(D.measurement||"").toLowerCase()!=="lb",se=O===""?0:Number(O),ve=Y?Math.max(0,Math.round(se)):gs(se);return{...D,qty:ve}}))},he=(j,O)=>{f(W=>W.map(D=>{if(D.productId!==j)return D;const Y=(O||"").replace(",","."),se=Y.trim()===""?0:Number(Y),ve=Number.isFinite(se)?Math.max(0,E(se)):0;return{...D,specialPrice:ve}}))},de=(j,O)=>{f(W=>W.map(D=>{if(D.productId!==j)return D;const Y=Math.max(0,Math.floor(Number(O||0)));return{...D,discount:Y}}))},re=N.useMemo(()=>{let j=0;for(const O of d){const W=k(O),D=Number(W||0)*Number(O.qty||0),Y=Math.max(0,D-Math.max(0,Number(O.discount||0)));j+=Y}return E(j)},[d]);N.useEffect(()=>{m(re)},[re]),N.useEffect(()=>{const j=Number(p)||0,O=Number(h)||0;y((j-O).toFixed(2))},[p,h]);const xe=j=>{j.key===","&&(j.preventDefault(),j.target.value+=".")},Ce=async()=>{if(d.length===0)return"Agrega al menos un producto.";for(const j of d){if(!j.qty||j.qty<=0)return`Cantidad invlida para "${j.productName}".`;const O=await T(j.productId);if(!f1(O,j.qty)){const W=await U(j.productName);if(f1(W,0)&&!f1(O,0)){const D=await Qoe(j.productName,j.productId),Y=await T(j.productId);if(!f1(Y,j.qty))return`Stock insuficiente tras corregir ${D} lote(s) para "${j.productName}".`}else return`Stock insuficiente para "${j.productName}". Disponible: ${O}`}}return null},S=async j=>{var W,D;j.preventDefault(),F("");const O=await Ce();if(O){F(" "+O);return}try{R(!0);const Y=[];for(const z of d){const Oe=z.qty,{allocations:te,avgUnitCost:J,cogsAmount:q}=await Ooe(je,z.productName,Oe,!1),ie=k(z),fe=Number(ie||0)*Number(Oe||0),Ie=Math.max(0,Number(z.discount||0)),Ve=Math.max(0,fe-Ie);Y.push({productId:z.productId,productName:z.productName,measurement:z.measurement,unitPrice:Number(ie||0),regularPrice:Number(z.price||0),specialPrice:Number(z.specialPrice||0)>0?Number(z.specialPrice):null,qty:Oe,discount:Ie,lineTotal:E(fe),lineFinal:E(Ve),allocations:te,avgUnitCost:J,cogsAmount:q})}const se=Y.reduce((z,Oe)=>z+Oe.lineFinal,0),ve=Y.reduce((z,Oe)=>z+Number(Oe.qty||0),0);await Wr(At(je,"salesV2"),{id:Uoe(),quantity:ve,amount:se,amountCharged:se,amountReceived:Number(p)||0,change:g,clientName:A.trim(),timestamp:Kt.now(),date:l,userEmail:((W=n[0])==null?void 0:W.email)??"sin usuario",vendor:((D=n[0])==null?void 0:D.role)??"sin usuario",status:"FLOTANTE",items:Y,itemsTotal:se}),F(" Venta registrada y asignada a inventario (FIFO)."),f([]),o(""),m(0),x(0),y("0"),u(""),c(rr(new Date,"yyyy-MM-dd"))}catch(Y){console.error(Y),F(` ${(Y==null?void 0:Y.message)||"Error al registrar la venta."}`)}finally{R(!1)}},I=N.useMemo(()=>new Set(d.map(j=>j.productId)),[d]),V=N.useMemo(()=>e.filter(j=>(_[j.id]||0)>0),[e,_]);return i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:S,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl
                 p-4 sm:p-6 md:p-8
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:a,onChange:j=>o(j.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),V.map(j=>i.jsxs("option",{value:j.id,disabled:I.has(j.id),title:I.has(j.id)?"Ya est en la lista":`Disponible: ${M(_[j.id]||0)}`,children:[j.productName,"  ",j.measurement,"  C$ ",j.price," (disp:"," ",M(_[j.id]||0),")"]},j.id))]}),i.jsx("button",{type:"button",onClick:Z,disabled:!a||I.has(a),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:j=>c(j.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:A,onChange:j=>u(j.target.value),placeholder:"Opcional"})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:d.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):d.map(j=>{const O=k(j),W=Number(O||0)*Number(j.qty||0),D=Math.max(0,W-Math.max(0,Number(j.discount||0))),Y=(j.measurement||"").toLowerCase()!=="lb",se=gs(Number(j.stock)-Number(j.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[j.productName,"  ",j.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",E(j.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:j.specialPrice===0?"":j.specialPrice,onKeyDown:xe,onChange:ve=>he(j.productId,ve.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",E(O).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:se.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:Y?1:.01,inputMode:Y?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:j.qty===0?"":j.qty,onKeyDown:xe,onChange:ve=>ae(j.productId,ve.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:j.discount===0?"":j.discount,onChange:ve=>de(j.productId,ve.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",E(D).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>pe(j.productId),title:"Quitar",children:""})})]},j.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${h.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:p===0?"":p,onChange:j=>x(Number(j.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${g}`,readOnly:!0})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:d.length===0||P,children:P?"Guardando...":"Guardar venta"}),b&&i.jsx("p",{className:`text-sm mt-2 ${b.startsWith("")?"text-green-600":b.startsWith("")?"text-yellow-600":"text-red-600"}`,children:b})]}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}var e8={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Xj=ci.createContext&&ci.createContext(e8),Voe=["attr","size","title"];function Hoe(t,e){if(t==null)return{};var r=Koe(t,e),n,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Koe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Ny(){return Ny=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ny.apply(this,arguments)}function Yj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Cy(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yj(Object(r),!0).forEach(function(n){qoe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qoe(t,e,r){return e=Goe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Goe(t){var e=$oe(t,"string");return typeof e=="symbol"?e:e+""}function $oe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t8(t){return t&&t.map((e,r)=>ci.createElement(e.tag,Cy({key:r},e.attr),t8(e.child)))}function zoe(t){return e=>ci.createElement(Woe,Ny({attr:Cy({},t.attr)},e),t8(t.child))}function Woe(t){var e=r=>{var{attr:n,size:s,title:a}=t,o=Hoe(t,Voe),l=s||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),ci.createElement("svg",Ny({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:Cy(Cy({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&ci.createElement("title",null,a),t.children)};return Xj!==void 0?ci.createElement(Xj.Consumer,null,r=>e(r)):e(e8)}function Joe(t){return zoe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Fc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(Joe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}const _i=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function WN(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function Xoe({role:t="",sellerCandyId:e="",currentUserEmail:r}){{const[n,s]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState(!0),[A,u]=N.useState(""),{refreshKey:d,refresh:f}=Jl(),h=t==="admin",[m,p]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[x,g]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[y,b]=N.useState(""),[F,P]=N.useState(!1),[R,_]=N.useState(""),[B,E]=N.useState(rr(new Date,"yyyy-MM-dd")),[M,k]=N.useState("lb"),[T,U]=N.useState(""),[Z,pe]=N.useState(0),[ae,he]=N.useState(0),[de,re]=N.useState(0),[xe,Ce]=N.useState([]),[S,I]=N.useState(null),[V,j]=N.useState([]),[O,W]=N.useState(!1),[D,Y]=N.useState(null),[se,ve]=N.useState(!1),[z,Oe]=N.useState(null),te=G=>{const Ne=(G||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(Ne)||Ne==="lb"};N.useEffect(()=>{(async()=>{c(!0),u("");const G=await Nt(At(je,"products")),Ne=[];G.forEach(Be=>{const Qe=Be.data();Qe.active===!0&&Ne.push({id:Be.id,name:Qe.name??Qe.productName??"(sin nombre)",category:Qe.category??"(sin categora)",measurement:Qe.measurement??"lb",price:Number(Qe.price??0)})}),s(Ne);const Ue=Ut(At(je,"inventory_batches"),Rr("date","desc")),$e=await Nt(Ue),ge=[];$e.forEach(Be=>{const Qe=Be.data(),Te=gs(Number(Qe.quantity||0)),We=Number(Qe.purchasePrice||0),at=Number(Qe.salePrice||0),bt=Number((Te*We).toFixed(2)),ot=Number((Te*at).toFixed(2));ge.push({id:Be.id,productId:Qe.productId,productName:Qe.productName,category:Qe.category,unit:Qe.unit,quantity:Te,remaining:gs(Number(Qe.remaining||0)),purchasePrice:We,salePrice:at,invoiceTotal:Qe.invoiceTotal!=null?Number(Qe.invoiceTotal):bt,expectedTotal:Qe.expectedTotal!=null?Number(Qe.expectedTotal):ot,date:Qe.date,createdAt:Qe.createdAt,status:Qe.status,notes:Qe.notes,paidAmount:Number(Qe.paidAmount||0),paidAt:Qe.paidAt,batchGroupId:Qe.batchGroupId,orderName:Qe.orderName})}),o(ge),c(!1)})()},[d]);const J=N.useMemo(()=>a.filter(G=>!(m&&G.date<m||x&&G.date>x||y&&G.productId!==y)),[a,m,x,y]),q=N.useMemo(()=>{const G=J.reduce((We,at)=>We+Number(at.invoiceTotal||0),0),Ne=J.reduce((We,at)=>We+Number(at.expectedTotal||0),0);let Ue=0,$e=0,ge=0,Be=0;for(const We of J)te(We.unit)?(Ue+=We.quantity,$e+=We.remaining):(ge+=We.quantity,Be+=We.remaining);const Qe=J.reduce((We,at)=>We+at.quantity,0),Te=J.reduce((We,at)=>We+at.remaining,0);return{lbsIng:Ue,lbsRem:$e,udsIng:ge,udsRem:Be,qty:Qe,rem:Te,totalFacturado:G,totalEsperado:Ne}},[J]),ie=N.useMemo(()=>{var Ue,$e;const G=new Map;for(const ge of J){const Be=ge.batchGroupId&&String(ge.batchGroupId).trim()||ge.id;G.has(Be)||G.set(Be,[]),G.get(Be).push(ge)}const Ne=[];for(const[ge,Be]of G.entries()){const Qe=[...Be].sort((er,et)=>{var Ft,Tt;const gt=((Ft=er.createdAt)==null?void 0:Ft.seconds)??0;return(((Tt=et.createdAt)==null?void 0:Tt.seconds)??0)-gt}),Te=((Ue=Qe[0])==null?void 0:Ue.date)||"",We=String((($e=Qe[0])==null?void 0:$e.orderName)||"").trim()||`Pedido ${Te||""}`.trim()||"Pedido",at=new Set(Qe.map(er=>String(er.category||"").trim()).filter(Boolean)),bt=at.size===1?Array.from(at)[0].toUpperCase():"MIXTO",ot=Qe.some(er=>er.status==="PENDIENTE")?"PENDIENTE":"PAGADO",wt=gs(Qe.reduce((er,et)=>er+(te(et.unit)?Number(et.quantity||0):0),0)),Lt=gs(Qe.reduce((er,et)=>er+(te(et.unit)?Number(et.remaining||0):0),0)),Ar=Number(Qe.reduce((er,et)=>er+Number(et.invoiceTotal||0),0).toFixed(2)),ir=Number(Qe.reduce((er,et)=>er+Number(et.expectedTotal||0),0).toFixed(2)),xr=Number((ir-Ar).toFixed(2));Ne.push({groupId:ge,orderName:We,date:Te,typeLabel:bt,status:ot,lbsIn:wt,lbsRem:Lt,totalFacturado:Ar,totalEsperado:ir,utilidadBruta:xr,items:Qe})}return Ne.sort((ge,Be)=>ge.date===Be.date?ge.groupId<Be.groupId?1:-1:ge.date<Be.date?1:-1),Ne},[J]),fe=N.useMemo(()=>{const G=String(M||"").toLowerCase().trim();return n.filter(Ue=>String(Ue.measurement||"").toLowerCase().trim()===G).sort((Ue,$e)=>Ue.name.localeCompare($e.name,"es"))},[n,M]);N.useEffect(()=>{const G=n.find(Ne=>Ne.id===T);G&&re(Number(G.price||0))},[T,n,d]);const Ie=()=>{u("");const G=n.find(Te=>Te.id===T);if(!G){u("Selecciona un producto.");return}if(Z<=0||ae<=0){u("Completa libras a ingresar y precio proveedor.");return}const Ne=gs(Z),Ue=G.measurement,$e=Number((Ne*Number(ae||0)).toFixed(2)),ge=Number((Ne*Number(de||0)).toFixed(2)),Be=Number((ge-$e).toFixed(2)),Qe=xe.findIndex(Te=>Te.productId===G.id);if(Qe>=0)Ce(Te=>Te.map((We,at)=>at!==Qe?We:{...We,quantity:Ne,remaining:Ne,purchasePrice:Number(ae||0),salePrice:Number(de||0),invoiceTotal:$e,expectedTotal:ge,utilidadBruta:Be}));else{const Te={tempId:WN("IT"),productId:G.id,productName:G.name,category:G.category,unit:Ue,quantity:Ne,remaining:Ne,purchasePrice:Number(ae||0),salePrice:Number(de||0),invoiceTotal:$e,expectedTotal:ge,utilidadBruta:Be};Ce(We=>[...We,Te])}U(""),pe(0),he(0),re(0)},Ve=G=>{Ce(Ne=>Ne.filter(Ue=>Ue.tempId!==G))},ze=(G,Ne,Ue)=>{Ce($e=>$e.map(ge=>{if(ge.tempId!==G)return ge;const Be={...ge};return Ne==="quantity"&&(Be.quantity=gs(Math.max(0,Ue)),Be.remaining=Be.quantity),Ne==="purchasePrice"&&(Be.purchasePrice=Math.max(0,Number(Ue||0))),Ne==="salePrice"&&(Be.salePrice=Math.max(0,Number(Ue||0))),Be.invoiceTotal=Number((Be.quantity*Be.purchasePrice).toFixed(2)),Be.expectedTotal=Number((Be.quantity*Be.salePrice).toFixed(2)),Be.utilidadBruta=Number((Be.expectedTotal-Be.invoiceTotal).toFixed(2)),Be}))},Ye=N.useMemo(()=>{const G=gs(xe.reduce((Be,Qe)=>Be+(te(Qe.unit)?Number(Qe.quantity||0):0),0)),Ne=gs(xe.reduce((Be,Qe)=>Be+(te(Qe.unit)?Number(Qe.remaining||0):0),0)),Ue=Number(xe.reduce((Be,Qe)=>Be+Number(Qe.invoiceTotal||0),0).toFixed(2)),$e=Number(xe.reduce((Be,Qe)=>Be+Number(Qe.expectedTotal||0),0).toFixed(2)),ge=Number(($e-Ue).toFixed(2));return{lbsIn:G,lbsRem:Ne,totalFacturado:Ue,totalEsperado:$e,utilidadBruta:ge}},[xe]),ct=()=>{I(null),j([]),_(""),E(rr(new Date,"yyyy-MM-dd")),k("lb"),U(""),pe(0),he(0),re(0),Ce([])},st=async()=>{if(u(""),!xe.length){u("Agrega al menos un producto al pedido.");return}const G=B||rr(new Date,"yyyy-MM-dd"),Ne=String(R||"").trim()||`Pedido ${G}`,Ue=S||WN("BATCH");try{if(!S){for(const Qe of xe)await $j({productId:Qe.productId,productName:Qe.productName,category:Qe.category,unit:Qe.unit,quantity:gs(Qe.quantity),purchasePrice:Number(Qe.purchasePrice||0),salePrice:Number(Qe.salePrice||0),invoiceTotal:Number(Qe.invoiceTotal||0),expectedTotal:Number(Qe.expectedTotal||0),date:G,notes:"",batchGroupId:Ue,orderName:Ne});u(" Pedido creado"),P(!1),ct(),f();return}const $e=V,ge=new Map;for(const Qe of $e)ge.set(Qe.productId,Qe);const Be=new Set(xe.map(Qe=>Qe.productId));for(const Qe of xe){const Te=ge.get(Qe.productId),We=gs(Qe.quantity);if(Te){const at=gs(Te.quantity-Te.remaining),bt=Math.max(0,gs(We-at));await kr(kt(je,"inventory_batches",Te.id),{date:G,orderName:Ne,batchGroupId:Ue,quantity:We,purchasePrice:Number(Qe.purchasePrice||0),salePrice:Number(Qe.salePrice||0),invoiceTotal:Number(Qe.invoiceTotal||0),expectedTotal:Number(Qe.expectedTotal||0),remaining:bt})}else await $j({productId:Qe.productId,productName:Qe.productName,category:Qe.category,unit:Qe.unit,quantity:We,purchasePrice:Number(Qe.purchasePrice||0),salePrice:Number(Qe.salePrice||0),invoiceTotal:Number(Qe.invoiceTotal||0),expectedTotal:Number(Qe.expectedTotal||0),date:G,notes:"",batchGroupId:Ue,orderName:Ne})}for(const Qe of $e)Be.has(Qe.productId)||await un(kt(je,"inventory_batches",Qe.id));u(" Pedido actualizado"),P(!1),ct(),f()}catch($e){console.error($e),u(" Error al guardar pedido")}},ft=G=>{Y(G),W(!0)},nt=G=>{I(G.groupId),j(G.items),_(G.orderName),E(G.date||rr(new Date,"yyyy-MM-dd"));const Ne=G.items.map(Ue=>{const $e=Number(Ue.invoiceTotal||0),ge=Number(Ue.expectedTotal||0);return{tempId:WN("IT"),productId:Ue.productId,productName:Ue.productName,category:Ue.category,unit:Ue.unit,quantity:gs(Ue.quantity),remaining:gs(Ue.remaining),purchasePrice:Number(Ue.purchasePrice||0),salePrice:Number(Ue.salePrice||0),invoiceTotal:$e,expectedTotal:ge,utilidadBruta:Number((ge-$e).toFixed(2))}});Ce(Ne),P(!0)},De=async G=>{if(confirm(`Eliminar el pedido "${G.orderName}" del ${G.date}?`))try{for(const Ue of G.items)await un(kt(je,"inventory_batches",Ue.id));u(" Pedido eliminado"),f()}catch(Ue){console.error(Ue),u(" Error al eliminar pedido")}},Fe=G=>{Oe(G),ve(!0)},Ge=async()=>{if(z)try{for(const G of z.items){if(G.status!=="PENDIENTE")continue;await YM(G.id),await kr(kt(je,"inventory_batches",G.id),{remaining:0});const Ne={date:G.date,productName:G.productName,quantity:G.quantity,amount:Number((G.expectedTotal??G.salePrice*G.quantity).toFixed(2)),allocations:[{batchId:G.id,qty:G.quantity,unitCost:G.purchasePrice,lineCost:Number((G.purchasePrice*G.quantity).toFixed(2))}],avgUnitCost:G.purchasePrice,measurement:G.unit,createdAt:Kt.now(),autoGeneratedFromInventory:!0};await Wr(At(je,"salesV2"),Ne)}u(" Pedido pagado y reflejado como venta"),f()}catch(G){console.error(G),u(" Error al pagar pedido")}finally{ve(!1),Oe(null)}},_e=()=>{ve(!1),Oe(null)};return i.jsxs("div",{className:"max-w-6xl mx-auto shadows-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),h&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{ct(),P(!0)},children:"Crear Lote"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:G=>p(G.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:G=>g(G.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:y,onChange:G=>b(G.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),n.map(G=>i.jsxs("option",{value:G.id,children:[G.name,"  ",G.category]},G.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{p(""),g(""),b("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(Fc,{onClick:()=>f(),loading:l})})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",q.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",q.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",q.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",q.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",q.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",q.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(q.totalEsperado-q.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",J.length.toLocaleString()]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):ie.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin lotes"})}):ie.map(G=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>ft(G),title:G.orderName,children:G.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:G.orderName})]}),i.jsx("td",{className:"p-2 border",children:G.typeLabel}),i.jsx("td",{className:"p-2 border",children:G.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:G.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:_i(G.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:_i(G.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:_i(G.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${G.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:G.status})}),i.jsx("td",{className:"p-2 border",children:h?i.jsxs("div",{className:"flex gap-2 justify-center",children:[G.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>Fe(G),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nt(G),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>De(G),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},G.groupId))})]})}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),F&&Vu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>P(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:S?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>P(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:R,onChange:G=>_(G.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:G=>E(G.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:M,onChange:G=>{k(G.target.value),U(""),pe(0),he(0),re(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:T,onChange:G=>U(G.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),fe.map(G=>i.jsxs("option",{value:G.id,children:[G.name,"  ",G.category,"  ",G.measurement]},G.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Z===0?"":Z,onChange:G=>{const Ne=G.target.value.replace(",","."),Ue=parseFloat(Ne),$e=Number.isFinite(Ue)?parseFloat(Ue.toFixed(3)):0;pe(Math.max(0,$e))},disabled:!T})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:G=>{const Ne=G.target.value.replace(",","."),Ue=parseFloat(Ne),$e=Number.isFinite(Ue)?parseFloat(Ue.toFixed(2)):0;he(Math.max(0,$e))},disabled:!T})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:de===0?"":de,onChange:G=>{const Ne=G.target.value.replace(",","."),Ue=parseFloat(Ne),$e=Number.isFinite(Ue)?parseFloat(Ue.toFixed(2)):0;re(Math.max(0,$e))},disabled:!T})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:Ie,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:xe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):xe.map(G=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[G.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[G.category,"  ",G.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:G.quantity,onChange:Ne=>{const Ue=Ne.target.value.replace(",","."),$e=parseFloat(Ue),ge=Number.isFinite($e)?parseFloat($e.toFixed(3)):0;ze(G.tempId,"quantity",ge)}})}),i.jsx("td",{className:"p-2 border",children:Number(G.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:G.purchasePrice,onChange:Ne=>{const Ue=Ne.target.value.replace(",","."),$e=parseFloat(Ue),ge=Number.isFinite($e)?parseFloat($e.toFixed(2)):0;ze(G.tempId,"purchasePrice",ge)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:G.salePrice,onChange:Ne=>{const Ue=Ne.target.value.replace(",","."),$e=parseFloat(Ue),ge=Number.isFinite($e)?parseFloat($e.toFixed(2)):0;ze(G.tempId,"salePrice",ge)}})}),i.jsx("td",{className:"p-2 border",children:_i(G.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:_i(G.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:_i(G.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Ve(G.tempId),children:"Quitar"})})]},G.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:Ye.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:Ye.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:_i(Ye.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:_i(Ye.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:_i(Ye.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>P(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:st,disabled:xe.length===0,children:S?"Editar pedido":"Crear pedido"})]})]})]}),document.body),O&&D&&Vu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{W(!1),Y(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:D.orderName})," "," ",D.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{W(!1),Y(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:D.items.map(G=>{const Ne=Number(G.invoiceTotal||0),Ue=Number(G.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:G.productName}),i.jsx("td",{className:"p-2 border",children:(G.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:G.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:G.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:_i(G.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:_i(G.salePrice)}),i.jsx("td",{className:"p-2 border",children:_i(Ne)}),i.jsx("td",{className:"p-2 border",children:_i(Ue)}),i.jsx("td",{className:"p-2 border",children:_i(Ue-Ne)}),i.jsx("td",{className:"p-2 border",children:G.status})]},G.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:D.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:D.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:_i(D.utilidadBruta)})]})]})]})]}),document.body),se&&z&&Vu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:_e}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:z.orderName})," "," ",z.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:Ge,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:_e,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}}const zc=t=>`C$${(Number(t)||0).toFixed(2)}`;function Yoe(){const t=uZ(new Date),[e,r]=N.useState(rr(t,"yyyy-MM")),[n,s]=N.useState([]),[a,o]=N.useState(!1),[l,c]=N.useState(""),A=N.useRef(null),u=N.useMemo(()=>{const[x,g]=e.split("-").map(F=>parseInt(F,10)),y=rr(Ec(new Date(x,g-1,1)),"yyyy-MM-dd"),b=rr(_c(new Date(x,g-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),d=async()=>{o(!0);try{const x=await Boe(u.from,u.to),g=[];for(const y of x){const b=kt(je,"inventory_batches",y.batchId),F=await Wa(b);if(!F.exists())continue;const P=F.data();g.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:P.status??"PENDIENTE",purchasePrice:Number(P.purchasePrice||0),salePrice:Number(P.salePrice||0),supplier:P.supplier})}s(g)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};N.useEffect(()=>{d()},[e]);const f=async x=>{confirm("Marcar este lote como PAGADO?")&&(await YM(x),s(y=>y.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=N.useMemo(()=>{const x=n.reduce((F,P)=>F+P.soldQty,0),g=n.reduce((F,P)=>F+P.soldAmount,0),y=n.reduce((F,P)=>F+P.soldQty*P.purchasePrice,0),b=g-y;return{q:x,amt:g,cogs:y,profit:b}},[n]),m=N.useMemo(()=>{const x=new Map;for(const g of n){const y=g.productName||"(sin nombre)";x.has(y)||x.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(y);b.qty+=g.soldQty,b.revenue+=g.soldAmount;const F=g.soldQty*g.purchasePrice;b.cogs+=F,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((g,y)=>g.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!A.current)return;const x=A.current;x.classList.add("force-pdf-colors");try{const[{default:g},{jsPDF:y}]=await Promise.all([mA(()=>Promise.resolve().then(()=>JS),void 0),mA(()=>Promise.resolve().then(()=>_E),void 0)]),F=(await g(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),P=new y("p","mm","a4"),R=190,_=P.getImageProperties(F),B=R,E=_.height*B/_.width;P.addImage(F,"PNG",10,10,B,E),P.save(`liquidaciones_${e}.pdf`)}catch(g){console.error(g),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:d,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:A,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",zc(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",zc(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",zc(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const g=x.soldQty*x.purchasePrice,y=x.soldAmount-g;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:zc(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:zc(g)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:zc(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>f(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:zc(x.revenue)}),i.jsx("td",{className:"p-2 border",children:zc(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:zc(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Wc=t=>`C$${Number(t??0).toFixed(2)}`,Zoe=()=>rr(new Date,"yyyy-MM-dd"),m1=t=>Number(t||0).toFixed(3);function ele(){const[t,e]=N.useState(()=>{const P=new Date,R=new Date(P.getFullYear(),P.getMonth(),1);return rr(R,"yyyy-MM-dd")}),[r,n]=N.useState(Zoe()),[s,a]=N.useState(!0),[o,l]=N.useState([]),[c,A]=N.useState([]),{refreshKey:u,refresh:d}=Jl();N.useEffect(()=>{(async()=>{a(!0);const R=Ut(At(je,"salesV2"),qt("date",">=",t),qt("date","<=",r)),_=await Nt(R),B=[];_.forEach(T=>{const U=T.data(),Z=U.date??"";if(Array.isArray(U.items)&&U.items.length>0){U.items.forEach((pe,ae)=>{const he=String(pe.productName??"(sin nombre)"),de=Number(pe.qty??0),re=Number(pe.lineFinal??0)||Math.max(0,Number(pe.unitPrice||0)*de-Number(pe.discount||0));B.push({id:`${T.id}#${ae}`,date:Z,productName:he,quantity:de,amount:re,allocations:Array.isArray(pe.allocations)?pe.allocations:U.allocations,avgUnitCost:Number(pe.avgUnitCost??U.avgUnitCost??0),measurement:pe.measurement??U.measurement??""})});return}B.push({id:T.id,date:Z,productName:U.productName??"(sin nombre)",quantity:Number(U.quantity??0),amount:Number(U.amount??U.amountCharged??0),allocations:Array.isArray(U.allocations)?U.allocations:[],avgUnitCost:Number(U.avgUnitCost??0),measurement:U.measurement??""})}),l(B);const E=Ut(At(je,"expenses"),qt("date",">=",t),qt("date","<=",r)),M=await Nt(E),k=[];M.forEach(T=>{const U=T.data();k.push({id:T.id,date:U.date??"",category:U.category??"(sin categora)",description:U.description??"",amount:Number(U.amount??0),status:U.status??"PAGADO",createdAt:U.createdAt})}),A(k),a(!1)})()},[t,r,u]);const f=N.useMemo(()=>{const P=o.reduce((M,k)=>M+(k.amount||0),0);let R=0;o.forEach(M=>{var k;(k=M.allocations)!=null&&k.length?R+=M.allocations.reduce((T,U)=>T+Number(U.lineCost||0),0):M.avgUnitCost&&M.quantity&&(R+=Number(M.avgUnitCost)*Number(M.quantity))});const _=P-R,B=c.reduce((M,k)=>M+(k.amount||0),0),E=_-B;return{revenue:P,cogsReal:R,grossProfit:_,expensesSum:B,netProfit:E}},[o,c]),h=P=>String(P??"").toLowerCase().trim(),m=P=>Number(P.qty??P.quantity??0),p=P=>["lb","lbs","libra","libras"].includes(h(P)),x=P=>["unidad","unidades","ud","uds","pieza","piezas"].includes(h(P)),g=N.useMemo(()=>o.reduce((P,R)=>p(R.measurement)?P+m(R):P,0),[o]),y=N.useMemo(()=>o.reduce((P,R)=>x(R.measurement)?P+m(R):P,0),[o]),b=N.useMemo(()=>{var R;const P=new Map;for(const _ of o){const B=_.productName||"(sin nombre)";P.has(B)||P.set(B,{productName:B,units:0,revenue:0,cogs:0,profit:0,firstDate:_.date||"",lastDate:_.date||""});const E=P.get(B);E.units+=Number(_.quantity||0),E.revenue+=Number(_.amount||0),(!E.firstDate||_.date<(E.firstDate||_.date))&&(E.firstDate=_.date),(!E.lastDate||_.date>(E.lastDate||_.date))&&(E.lastDate=_.date);let M=0;(R=_.allocations)!=null&&R.length?M=_.allocations.reduce((k,T)=>k+Number(T.lineCost||0),0):_.avgUnitCost&&(M=Number(_.avgUnitCost)*Number(_.quantity||0)),E.cogs+=M,E.profit=E.revenue-E.cogs}return Array.from(P.values()).sort((_,B)=>_.productName.localeCompare(B.productName))},[o]),F=N.useMemo(()=>[...b].sort((P,R)=>R.units-P.units).slice(0,3).map((P,R)=>({idx:R+1,name:P.productName,units:P.units})),[b]);return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl ",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas: Ingresos y Egresos"}),i.jsx(Fc,{onClick:d,loading:s})]}),i.jsxs("div",{className:"flex flex-wrap items-end gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:t,onChange:P=>e(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:r,onChange:P=>n(P.target.value)})]})]}),s?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-3 rounded-2xl shadow-lg p-4 bg-gray-50",children:[i.jsx(tp,{title:"Ventas",value:Wc(f.revenue)}),i.jsx(tp,{title:"Costo",value:Wc(f.cogsReal)}),i.jsx(tp,{title:"Ganancia Bruta",value:Wc(f.grossProfit),positive:!0}),i.jsx(tp,{title:"Gastos",value:Wc(f.expensesSum)}),i.jsx(tp,{title:"Ganancia Neta",value:Wc(f.netProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-4 bg-gray-50",children:[i.jsx(Zj,{title:"Libras Vendidas",value:m1(g)}),i.jsx(Zj,{title:"Unidades Vendidas",value:m1(y)}),i.jsx(tle,{title:"Productos ms vendidos",items:F.map(P=>({key:`${P.idx}`,label:`${P.idx}. ${P.name}`,value:`(${m1(P.units)})`}))})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Fechas"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Ingreso"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[b.map(P=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:P.productName}),i.jsx("td",{className:"border p-1",children:P.firstDate&&P.lastDate?P.firstDate===P.lastDate?P.firstDate:`${P.firstDate}  ${P.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:m1(P.units)}),i.jsx("td",{className:"border p-1",children:Wc(P.revenue)}),i.jsx("td",{className:"border p-1",children:Wc(P.cogs)}),i.jsx("td",{className:`border p-1 ${P.profit>=0?"text-green-700":"text-red-700"}`,children:Wc(P.profit)})]},P.productName)),b.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(P=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:P.date}),i.jsx("td",{className:"border p-1",children:P.category}),i.jsx("td",{className:"border p-1",children:P.description}),i.jsx("td",{className:"border p-1",children:Wc(P.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:P.status})})]},P.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})]})]})}function tp({title:t,value:e,positive:r}){return i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"text-[17px] text-gray-500",children:t}),i.jsx("div",{className:`text-[30px] font-bold ${r?"text-green-700":""}`,children:e})]})}function Zj({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("div",{className:"text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[20px] font-semibold",children:e})]})}function tle({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}const eP=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],p1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function rle(){const[t,e]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[r,n]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[s,a]=N.useState(rr(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,P]=N.useState(""),[R,_]=N.useState(null),[B,E]=N.useState(""),[M,k]=N.useState(""),[T,U]=N.useState(""),[Z,pe]=N.useState(0),[ae,he]=N.useState("PENDIENTE"),[de,re]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const D=Ut(At(je,"expenses"),Rr("date","desc")),Y=await Nt(D),se=[];Y.forEach(ve=>{const z=ve.data();se.push({id:ve.id,date:z.date||rr(new Date,"yyyy-MM-dd"),category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||"PENDIENTE",notes:z.notes||"",createdAt:z.createdAt??Kt.now()})}),g(se)}catch(D){console.error(D),P(" Error al cargar gastos")}finally{b(!1)}})()},[]);const xe=N.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Ce=N.useMemo(()=>{const D=xe.reduce((ve,z)=>ve+(z.amount||0),0),Y=xe.filter(ve=>ve.status==="PAGADO").reduce((ve,z)=>ve+(z.amount||0),0),se=D-Y;return{total:D,pagado:Y,pendiente:se}},[xe]),S=()=>{a(rr(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},I=async D=>{if(D.preventDefault(),P(""),!o){P("Selecciona una categora.");return}if(!c.trim()){P("Ingresa una descripcin.");return}if(!u||u<=0){P("Ingresa un monto vlido.");return}try{const Y=await Wr(At(je,"expenses"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Kt.now()});g(se=>[{id:Y.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Kt.now()},...se]),S(),P(" Gasto registrado")}catch(Y){console.error(Y),P(" Error al guardar gasto")}},V=D=>{_(D.id),E(D.date),k(D.category||""),U(D.description||""),pe(Number(D.amount||0)),he(D.status||"PENDIENTE"),re(D.notes||"")},j=()=>{_(null),E(""),k(""),U(""),pe(0),he("PENDIENTE"),re("")},O=async()=>{if(R){if(!M){P("Selecciona una categora.");return}if(!T.trim()){P("Ingresa una descripcin.");return}if(!Z||Z<=0){P("Ingresa un monto vlido.");return}try{await kr(kt(je,"expenses",R),{date:B,category:M,description:T.trim(),amount:Number(Z.toFixed(2)),status:ae,notes:de||""}),g(D=>D.map(Y=>Y.id===R?{...Y,date:B,category:M,description:T.trim(),amount:Number(Z.toFixed(2)),status:ae,notes:de||""}:Y)),j(),P(" Gasto actualizado")}catch(D){console.error(D),P(" Error al actualizar gasto")}}},W=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await un(kt(je,"expenses",D.id)),g(se=>se.filter(ve=>ve.id!==D.id)),P(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Pollo)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",p1(Ce.total)]}),i.jsxs("div",{children:["Pagado: ",p1(Ce.pagado)]}),i.jsxs("div",{children:["Pendiente: ",p1(Ce.pendiente)]})]})]}),i.jsxs("form",{onSubmit:I,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:D=>a(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),eP.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>A(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:D=>d(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):xe.slice().sort((D,Y)=>D.date.localeCompare(Y.date)).map(D=>{const Y=R===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:se=>E(se.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Y?i.jsxs("select",{className:"w-full border p-1 rounded",value:M,onChange:se=>k(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),eP.map(se=>i.jsx("option",{value:se,children:se},se))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>U(se.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Z)?"":Z,onChange:se=>pe(Math.max(0,Number(se.target.value||0)))}):p1(D.amount)}),i.jsx("td",{className:"p-2 border",children:Y?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>he(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:de,onChange:se=>re(se.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Y?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:O,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:j,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>V(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>W(D),children:"Borrar"})]})})})]},D.id)})})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F})]})}function _y(t){return(t||"").trim().toLowerCase()}async function r8(){const t=await Nt(At(je,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),s=_y(n.name??n.productName);s&&e.set(s,r.id)}),e}async function nle(t=!1){const e=await r8(),r=await Nt(At(je,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const s of r.docs){n.checked++;const a=s.data(),o=_y(a.productName);if(!o){n.missingName++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,status:"withoutMatch"});continue}if(a.productId===l){n.alreadyOk++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,newProductId:l,status:"alreadyOk"});continue}t||await kr(kt(je,"inventory_batches",s.id),{productId:l}),n.fixed++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function sle(t,e=!1){const r=_y(t),s=(await r8()).get(r);if(!s)throw new Error(`No existe un producto activo con nombre "${t}".`);const a=await Nt(At(je,"inventory_batches"));let o=0;for(const l of a.docs){const c=l.data();_y(c.productName)===r&&c.productId!==s&&(e||await kr(kt(je,"inventory_batches",l.id),{productId:s}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function ale(){const[t,e]=N.useState(!1),[r,n]=N.useState(""),s=async()=>{try{e(!0),n("");const c=await nle(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[a,o]=N.useState(""),l=async()=>{if(!a.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await sle(a.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${a}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:s,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:a,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const Wn=t=>`C$ ${Number(t??0).toFixed(2)}`,jd=t=>Number(t??0).toFixed(3);async function ile(t){const e=new Set;for(const n of t)for(const s of n.batches||[]){const a=(s.batchId||s.id||"").trim();if(!a)continue;(s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)&&e.add(a)}if(e.size===0)return t;const r=new Map;return await Promise.all(Array.from(e).map(async n=>{try{const s=await Wa(kt(je,"inventory_batches",n));if(s.exists()){const a=s.data();r.set(n,Number(a.purchasePrice||0))}}catch{}})),t.map(n=>({...n,batches:(n.batches||[]).map(s=>{if((s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)){const a=(s.batchId||s.id||"").trim(),o=a?r.get(a):void 0;if(o!==void 0)return{...s,purchasePrice:o}}return s})}))}function JN(t){var p,x;const e=t.batches||[],r=t.expenses||[],n=t.adjustments||[],s=Number(((p=t.totals)==null?void 0:p.lbs)??t.totalLbs??0),a=Number(((x=t.totals)==null?void 0:x.units)??t.totalUnits??0);let o=0,l=0;for(const g of e){const y=Number(g.quantity??0);let b=g.expectedTotal!==void 0&&g.expectedTotal!==null?Number(g.expectedTotal):y*Number(g.salePrice??0);isFinite(b)||(b=0);let F=y*Number(g.purchasePrice??Number.NaN);isFinite(F)||(F=g.invoiceTotal!==void 0&&g.invoiceTotal!==null?Number(g.invoiceTotal):0),o+=b,l+=F}const c=r.reduce((g,y)=>g+Number(y.amount||0),0),A=n.filter(g=>g.type==="DEBITO").reduce((g,y)=>g+Number(y.amount||0),0),u=n.filter(g=>g.type==="CREDITO").reduce((g,y)=>g+Number(y.amount||0),0),d=t.totalDebits!==void 0?Number(t.totalDebits):A,f=t.totalCredits!==void 0?Number(t.totalCredits):u,h=o-l,m=o-c-d+f;return{lbs:s,units:a,expectedSum:o,invoicedSum:l,expenses:c,debits:d,credits:f,grossProfit:h,finalAmount:m}}function ole(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(null),o=N.useRef(null);N.useEffect(()=>{(async()=>{n(!0);const u=Ut(At(je,"invoices"),Rr("date","desc")),d=await Nt(u),f=[];d.forEach(m=>{const p=m.data();f.push({id:m.id,...p,batches:p.batches||[],expenses:p.expenses||[],adjustments:p.adjustments||[],totals:p.totals||{lbs:p.totalLbs||0,units:p.totalUnits||0,amount:p.totalAmount||0,expenses:p.totalExpenses||0,finalAmount:p.finalAmount||0,invoiceTotal:p.invoiceTotal||0},totalDebits:p.totalDebits||0,totalCredits:p.totalCredits||0})});const h=await ile(f);e(h),n(!1)})()},[]);const l=async u=>{const d=u.status==="PAGADA"?"PENDIENTE":"PAGADA";await kr(kt(je,"invoices",u.id),{status:d}),e(f=>f.map(h=>h.id===u.id?{...h,status:d}:h)),(s==null?void 0:s.id)===u.id&&a({...u,status:d})},c=async u=>{if(window.confirm(`Eliminar factura del ${u.date}?`))try{const d=kt(je,"invoices",u.id),f=await Wa(d),h=f.exists()?f.data():null,m=Gh(je),p=(h==null?void 0:h.batches)||[];for(const x of p){const g=x.batchId||x.id;if(!g)continue;const y=kt(je,"inventory_batches",g);m.update(y,{invoiceId:null,invoiceNumber:null,invoiceTotal:null})}m.delete(d),await m.commit(),e(x=>x.filter(g=>g.id!==u.id)),(s==null?void 0:s.id)===u.id&&a(null)}catch(d){console.error(d),alert("No se pudo eliminar la factura por completo.")}},A=async()=>{if(!o.current||!s)return;const u=o.current,d=await $h(u,{backgroundColor:"#ffffff",onclone:x=>{const g=x.body;g.style.background="#ffffff",g.querySelectorAll("*").forEach(y=>{const b=x.defaultView.getComputedStyle(y);b.boxShadow&&b.boxShadow!=="none"&&(y.style.boxShadow="none")})},scale:2}),f=d.toDataURL("image/png"),h=new sr("p","mm","a4"),m=h.internal.pageSize.getWidth(),p=d.height*m/d.width;h.addImage(f,"PNG",0,0,m,p),h.save(`factura_${s.number||s.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Facturacin"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4",children:i.jsxs("table",{className:"min-w-full w-full- text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"N factura"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Unidades"}),i.jsx("th",{className:"p-2 border",children:"Facturado"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),i.jsx("th",{className:"p-2 border",children:"Gastos"}),i.jsx("th",{className:"p-2 border",children:"Dbitos"}),i.jsx("th",{className:"p-2 border",children:"Crditos"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Sin facturas"})}):t.map(u=>{const d=JN(u);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.date}),i.jsx("td",{className:"p-2 border",children:u.number||""}),i.jsx("td",{className:"p-2 border",children:u.description||""}),i.jsx("td",{className:"p-2 border",children:jd(d.lbs)}),i.jsx("td",{className:"p-2 border",children:jd(d.units)}),i.jsx("td",{className:"p-2 border",children:Wn(d.invoicedSum)}),i.jsx("td",{className:"p-2 border",children:Wn(d.expectedSum)}),i.jsx("td",{className:"p-2 border",children:Wn(d.expenses)}),i.jsx("td",{className:"p-2 border",children:Wn(d.debits)}),i.jsx("td",{className:"p-2 border",children:Wn(d.credits)}),i.jsx("td",{className:"p-2 border",children:Wn(d.finalAmount)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:u.status})}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>a(u),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>l(u),children:u.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>c(u),children:"Eliminar"})]})})]},u.id)})})]})}),s&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>a(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const u=JN(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras:"})," ",jd(u.lbs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades:"})," ",jd(u.units)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Facturado:"})," ",Wn(u.invoicedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Ventas (Esperado):"})," ",Wn(u.expectedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia Bruta:"})," ",Wn(u.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Wn(u.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Wn(u.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Wn(u.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Lotes"}),i.jsxs("table",{className:"min-w-full text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:(s.batches||[]).map((u,d)=>{const f=Number(u.quantity??0),h=u.expectedTotal!==void 0&&u.expectedTotal!==null?Number(u.expectedTotal):f*Number(u.salePrice??0);let m=f*Number(u.purchasePrice??Number.NaN);isFinite(m)||(m=u.invoiceTotal!==void 0&&u.invoiceTotal!==null?Number(u.invoiceTotal):0);const p=h-m;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.productName||"(sin nombre)"}),i.jsx("td",{className:"p-2 border",children:(u.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:jd(u.quantity)}),i.jsx("td",{className:"p-2 border",children:Wn(u.salePrice)}),i.jsx("td",{className:"p-2 border",children:Wn(m)}),i.jsx("td",{className:"p-2 border",children:Wn(h)}),i.jsx("td",{className:"p-2 border",children:Wn(p)})]},d)})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((u,d)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.date}),i.jsx("td",{className:"p-2 border",children:u.description}),i.jsx("td",{className:"p-2 border",children:Wn(u.amount)})]},d)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin gastos"})})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Fecha"})]})}),i.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((u,d)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.description}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:u.type})}),i.jsx("td",{className:"p-2 border",children:Wn(u.amount)}),i.jsx("td",{className:"p-2 border",children:s.date})]},d)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin cargos extras"})})})]}),(()=>{const u=JN(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:jd(u.lbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:jd(u.units)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:Wn(u.invoicedSum)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:Wn(u.expectedSum)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:Wn(u.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Wn(u.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Wn(u.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Wn(u.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Monto final (esperado  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Wn(u.finalAmount)})]})})]})})()]})]})}const po=t=>`C$${Number(t||0).toFixed(2)}`,Ff=t=>Number(t||0).toFixed(3),lle=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),XN=()=>{const t=new Date;return rr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},g1=()=>rr(new Date,"yyyy-MM-dd");function cle({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,a]=N.useState(XN()),[o,l]=N.useState(g1()),[c,A]=N.useState(""),u=N.useMemo(()=>{const _e=new Map;return n.forEach(G=>_e.set(G.productId,{id:G.productId,name:G.productName})),Array.from(_e.values()).sort((G,Ne)=>G.name.localeCompare(Ne.name))},[n]),d=N.useMemo(()=>n.filter(_e=>!(s&&_e.date<s||o&&_e.date>o||c&&_e.productId!==c)),[n,s,o,c]),[f,h]=N.useState(g1()),[m,p]=N.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,g]=N.useState(""),[y,b]=N.useState(()=>d.map(_e=>_e.id));N.useEffect(()=>{b(_e=>_e.filter(G=>d.some(Ne=>Ne.id===G)))},[d]);const[F,P]=N.useState([]),[R,_]=N.useState([]),[B,E]=N.useState(!1),[M,k]=N.useState(XN()),[T,U]=N.useState(g1());N.useEffect(()=>{(async()=>{try{E(!0);const _e=Ut(At(je,"expenses"),Rr("date","desc")),G=await Nt(_e),Ne=[];G.forEach(Ue=>{const $e=Ue.data();Ne.push({id:Ue.id,date:$e.date,description:$e.description,amount:Number($e.amount||0)})}),P(Ne)}catch(_e){console.error(_e)}finally{E(!1)}})()},[]);const Z=N.useMemo(()=>F.filter(_e=>!(!_e.date||M&&_e.date<M||T&&_e.date>T)),[F,M,T]),[pe,ae]=N.useState([]),[he,de]=N.useState(!1),[re,xe]=N.useState(""),[Ce,S]=N.useState("DEBITO"),[I,V]=N.useState(""),j=()=>{const _e=Number(I);!re.trim()||!isFinite(_e)||_e<=0||(ae(G=>[...G,{id:`${Date.now()}_${G.length+1}`,description:re.trim(),type:Ce,amount:Number(_e.toFixed(2))}]),xe(""),V(""))},[O,W]=N.useState(null),[D,Y]=N.useState(""),[se,ve]=N.useState("DEBITO"),[z,Oe]=N.useState(""),te=_e=>{W(_e.id),Y(_e.description),ve(_e.type),Oe(_e.amount.toFixed(2))},J=()=>{W(null),Y(""),ve("DEBITO"),Oe("")},q=()=>{if(!O)return;const _e=Number(z);!isFinite(_e)||_e<=0||(ae(G=>G.map(Ne=>Ne.id===O?{...Ne,description:D.trim(),type:se,amount:Number(_e.toFixed(2))}:Ne)),J())},ie=_e=>{ae(G=>G.filter(Ne=>Ne.id!==_e)),O===_e&&J()},fe=(_e,G)=>{b(Ne=>G?[...new Set([...Ne,_e])]:Ne.filter(Ue=>Ue!==_e))},Ie=_e=>{b(_e?d.map(G=>G.id):[])},Ve=(_e,G)=>{_(Ne=>G?[...new Set([...Ne,_e])]:Ne.filter(Ue=>Ue!==_e))},ze=N.useMemo(()=>d.filter(_e=>y.includes(_e.id)),[d,y]),Ye=N.useMemo(()=>pe.filter(_e=>_e.type==="DEBITO").reduce((_e,G)=>_e+G.amount,0),[pe]),ct=N.useMemo(()=>pe.filter(_e=>_e.type==="CREDITO").reduce((_e,G)=>_e+G.amount,0),[pe]),st=N.useMemo(()=>{let _e=0,G=0,Ne=0,Ue=0;for(const Be of ze){lle(Be.unit)?_e+=Number(Be.quantity||0):G+=Number(Be.quantity||0);const Qe=Be.expectedTotal??Number((Number(Be.quantity||0)*Number(Be.salePrice||0)).toFixed(2)),Te=Be.invoiceTotal!==void 0&&Be.invoiceTotal!==null?Number(Be.invoiceTotal):Number((Number(Be.quantity||0)*Number(Be.purchasePrice||0)).toFixed(2));Ne+=Number(Qe||0),Ue+=Number(Te||0)}const $e=Z.filter(Be=>R.includes(Be.id)).reduce((Be,Qe)=>Be+Number(Qe.amount||0),0),ge=Ne-$e-Ye+ct;return{totalLbs:_e,totalUnits:G,totalExpected:Number(Ne.toFixed(2)),totalInvoiced:Number(Ue.toFixed(2)),totalGastos:Number($e.toFixed(2)),debits:Number(Ye.toFixed(2)),credits:Number(ct.toFixed(2)),finalAmount:Number(ge.toFixed(2)),grossProfit:Number((Ne-Ue).toFixed(2))}},[ze,Z,R,Ye,ct]),[ft,nt]=N.useState(!1),[De,Fe]=N.useState(""),Ge=async()=>{if(Fe(""),ze.length===0){Fe("Selecciona al menos 1 lote pagado.");return}try{nt(!0);const _e={number:m.trim(),date:f,description:x.trim(),status:"PENDIENTE",createdAt:Kt.now(),totalLbs:Number(Ff(st.totalLbs)),totalUnits:Number(Ff(st.totalUnits)),totalAmount:st.totalExpected,invoiceTotal:st.totalInvoiced,totalExpenses:st.totalGastos,totalDebits:st.debits,totalCredits:st.credits,finalAmount:st.finalAmount,batches:ze.map(G=>{var Ne;return{id:G.id,productId:G.productId,productName:G.productName,unit:G.unit,quantity:Number(Ff(G.quantity)),salePrice:Number(Number(G.salePrice||0).toFixed(2)),purchasePrice:Number(Number(G.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(G.quantity||0)*Number(G.salePrice||0)).toFixed(2)),invoiceTotal:G.invoiceTotal!==void 0&&G.invoiceTotal!==null?Number(G.invoiceTotal):Number((Number(G.quantity||0)*Number(G.purchasePrice||0)).toFixed(2)),batchDate:G.date,paidAt:(Ne=G.paidAt)!=null&&Ne.toDate?rr(G.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:Z.filter(G=>R.includes(G.id)).map(G=>({id:G.id,date:G.date||null,description:G.description||"",amount:Number(Number(G.amount||0).toFixed(2))})),adjustments:pe.map(G=>({id:G.id,description:G.description,type:G.type,amount:Number(G.amount.toFixed(2))}))};await Wr(At(je,"invoices"),_e),Fe(" Factura creada."),r()}catch(_e){console.error(_e),Fe(` Error al crear factura: ${(_e==null?void 0:_e.message)||"desconocido"}`)}finally{nt(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:f,onChange:_e=>h(_e.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:_e=>p(_e.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:_e=>g(_e.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:_e=>a(_e.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:_e=>l(_e.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:_e=>A(_e.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),u.map(_e=>i.jsx("option",{value:_e.id,children:_e.name},_e.id))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{a(XN()),l(g1()),A("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:d.length>0&&y.length===d.length,onChange:_e=>Ie(_e.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),d.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha lote"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),i.jsx("tbody",{children:d.map(_e=>{var ge;const G=y.includes(_e.id),Ne=_e.expectedTotal??Number((Number(_e.quantity||0)*Number(_e.salePrice||0)).toFixed(2)),Ue=_e.invoiceTotal!==void 0&&_e.invoiceTotal!==null?Number(_e.invoiceTotal):Number((Number(_e.quantity||0)*Number(_e.purchasePrice||0)).toFixed(2)),$e=Ne-Ue;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:G,onChange:Be=>fe(_e.id,Be.target.checked)})}),i.jsx("td",{className:"p-2 border",children:_e.date}),i.jsx("td",{className:"p-2 border",children:_e.productName}),i.jsx("td",{className:"p-2 border",children:(_e.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Ff(_e.quantity)}),i.jsx("td",{className:"p-2 border",children:po(_e.salePrice)}),i.jsx("td",{className:"p-2 border",children:po(Ue)}),i.jsx("td",{className:"p-2 border",children:po(Ne)}),i.jsx("td",{className:"p-2 border",children:po($e)}),i.jsx("td",{className:"p-2 border",children:(ge=_e.paidAt)!=null&&ge.toDate?rr(_e.paidAt.toDate(),"yyyy-MM-dd"):""})]},_e.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),B&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:M,onChange:_e=>k(_e.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:T,onChange:_e=>U(_e.target.value)})]})]})]}),Z.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:Z.map(_e=>{const G=R.includes(_e.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:G,onChange:Ne=>Ve(_e.id,Ne.target.checked)})}),i.jsx("td",{className:"p-2 border",children:_e.date||""}),i.jsx("td",{className:"p-2 border",children:_e.description||""}),i.jsx("td",{className:"p-2 border",children:po(Number(_e.amount||0))})]},_e.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>de(!0),children:"Crear Cargo"})]}),pe.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:pe.map(_e=>{const G=O===_e.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:G?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:D,onChange:Ne=>Y(Ne.target.value)}):i.jsx("span",{title:_e.description,children:_e.description.length>60?`${_e.description.slice(0,60)}`:_e.description})}),i.jsx("td",{className:"p-2 border",children:G?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:se,onChange:Ne=>ve(Ne.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${_e.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:_e.type})}),i.jsx("td",{className:"p-2 border",children:G?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:z,onChange:Ne=>Oe(Ne.target.value)}):po(_e.amount)}),i.jsx("td",{className:"p-2 border",children:G?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:q,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:J,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(_e.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>te(_e),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(_e.id),children:"Eliminar"})]})})]},_e.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:Ff(st.totalLbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:Ff(st.totalUnits)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:po(st.totalInvoiced)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:po(st.totalExpected)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:po(st.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:po(st.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:po(st.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:po(st.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:po(st.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:ft,onClick:Ge,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:ft?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),De&&i.jsx("span",{className:"text-sm ml-2",children:De})]}),ft&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),he&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>de(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:re,onChange:_e=>xe(_e.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Ce,onChange:_e=>S(_e.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:I,onChange:_e=>V(_e.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:j,children:"Agregar"})})]})]})})]})}const Pd=t=>`C$ ${Number(t||0).toFixed(2)}`,kf=t=>Number(t||0).toFixed(3),Ale=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function ule(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(!1),[o,l]=N.useState(null),[c,A]=N.useState(rr(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[u,d]=N.useState(rr(new Date,"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(!1),{refreshKey:x,refresh:g}=Jl();N.useEffect(()=>{(async()=>{n(!0);const _=Ut(At(je,"inventory_batches"),qt("status","==","PAGADO"),Rr("date","desc")),B=await Nt(_),E=[];B.forEach(M=>{const k=M.data(),T=Number(k.quantity||0),U=Number(k.remaining||0),Z=Number(k.purchasePrice||0),pe=Number(k.salePrice||0),ae=Number((T*Z).toFixed(2)),he=Number((T*pe).toFixed(2));E.push({id:M.id,productId:k.productId,productName:k.productName,category:k.category,unit:k.unit,quantity:T,remaining:U,purchasePrice:Z,salePrice:pe,invoiceTotal:k.invoiceTotal!=null?Number(k.invoiceTotal):ae,expectedTotal:k.expectedTotal!=null?Number(k.expectedTotal):he,date:k.date,status:k.status,paidAt:k.paidAt})}),e(E),n(!1)})()},[x]);const y=N.useMemo(()=>t.filter(_=>!(c&&_.date<c||u&&_.date>u||f&&_.productId!==f)),[t,c,u,f]),b=N.useMemo(()=>{let _=0,B=0,E=0,M=0,k=0,T=0;for(const U of y)Ale(U.unit)?(_+=U.quantity,B+=U.remaining):(E+=U.quantity,M+=U.remaining),k+=Number(U.expectedTotal||0),T+=Number(U.invoiceTotal||0);return{lbsIng:_,lbsRem:B,udsIng:E,udsRem:M,totalEsperado:k,totalFact:T,gross:k-T}},[y]),F=_=>{l(_),a(!0)},P=async()=>{if(o)try{const _=kt(je,"inventory_batches",o.id);await kr(_,{status:"PENDIENTE",remaining:o.quantity});const B=At(je,"salesV2"),E=await Nt(Ut(B,qt("batchId","==",o.id))),M=await Nt(Ut(B,qt("productName","==",o.productName),qt("date","==",o.date))),k=[...E.docs,...M.docs];for(const T of k)await un(kt(je,"salesV2",T.id));e(T=>T.map(U=>U.id===o.id?{...U,status:"PENDIENTE",remaining:o.quantity}:U)),a(!1),l(null),g()}catch(_){console.error("Error al marcar pendiente:",_)}},R=N.useMemo(()=>{const _=new Map;return t.forEach(B=>_.set(B.productId,{id:B.productId,name:B.productName})),Array.from(_.values())},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(Fc,{onClick:g,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:_=>A(_.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:_=>d(_.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:_=>h(_.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),R.map(_=>i.jsx("option",{value:_.id,children:_.name},_.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",kf(b.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",kf(b.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Pd(b.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",kf(b.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",kf(b.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Pd(b.totalFact)]}),i.jsxs("div",{className:"col-span-3",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Pd(b.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",y.length.toLocaleString()]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):y.map(_=>{var B;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:_.date}),i.jsx("td",{className:"p-2 border",children:(_.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:_.productName}),i.jsx("td",{className:"p-2 border",children:(_.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:kf(_.quantity)}),i.jsx("td",{className:"p-2 border",children:kf(_.remaining)}),i.jsx("td",{className:"p-2 border",children:Pd(_.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:Pd(_.salePrice)}),i.jsx("td",{className:"p-2 border",children:Pd(_.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:Pd(_.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(B=_.paidAt)!=null&&B.toDate?rr(_.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>F(_),children:"Marcar PENDIENTE"})})]},_.id)})})]})}),m&&i.jsx(cle,{paidBatches:y,onClose:()=>p(!1),onCreated:()=>p(!1)}),s&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-[90%] max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas del dashboard."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded",children:"Cancelar"}),i.jsx("button",{onClick:P,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded",children:"Confirmar"})]})]})})]})}const va=t=>`C$ ${(Number(t)||0).toFixed(2)}`,dle=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function x1(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function hle(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function fle(t){const e="ROP",r=x1(t.subcat).slice(0,3)||"GEN",n=hle(t.gender),s=x1(t.color).slice(0,3)||"COL",a=x1(t.size)||"TLL",o=x1(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${s}-${a}-${o}-${l}`}const rp=/^[A-Za-z0-9._-]{0,32}$/;function mle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[u,d]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(rr(new Date,"yyyy-MM-dd")),[y,b]=N.useState(0),[F,P]=N.useState(0),[R,_]=N.useState(0),[B,E]=N.useState(0),[M,k]=N.useState(0),[T,U]=N.useState(""),[Z,pe]=N.useState(""),[ae,he]=N.useState(""),[de,re]=N.useState(""),[xe,Ce]=N.useState(""),[S,I]=N.useState(""),[V,j]=N.useState(""),[O,W]=N.useState(!1),[D,Y]=N.useState(""),[se,ve]=N.useState("Camisa"),[z,Oe]=N.useState(null),[te,J]=N.useState(""),[q,ie]=N.useState(0),[fe,Ie]=N.useState(0),[Ve,ze]=N.useState(0),[Ye,ct]=N.useState(0),[st,ft]=N.useState(0),[nt,De]=N.useState(""),[Fe,Ge]=N.useState(""),[_e,G]=N.useState(""),[Ne,Ue]=N.useState(""),[$e,ge]=N.useState(""),[Be,Qe]=N.useState(""),[Te,We]=N.useState(""),[at,bt]=N.useState(null),[ot,wt]=N.useState({x:0,y:0}),[Lt,Ar]=N.useState(!1);N.useEffect(()=>{const ne=()=>bt(null),ue=K=>K.key==="Escape"&&bt(null);return document.addEventListener("click",ne),document.addEventListener("keydown",ue),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",ue)}},[]);const ir=(ne,ue,K=192,le=160)=>{let Re=ne;ne+K+8>window.innerWidth&&(Re=ne-K),Re=Math.max(8,Math.min(Re,window.innerWidth-K-8));let Ee=ue;return ue+le+8>window.innerHeight&&(Ee=window.innerHeight-le-8),Ee=Math.max(8,Math.min(Ee,window.innerHeight-le-8)),{x:Re,y:Ee}},xr=(ne,ue)=>{ne.stopPropagation();const K=ne.currentTarget.getBoundingClientRect(),le=K.right,me=K.bottom,Re=ir(le,me);wt(Re),bt(Ee=>Ee===ue?null:ue)};N.useEffect(()=>{const ne=()=>bt(null),ue=K=>{K.key==="Escape"&&bt(null)};return document.addEventListener("click",ne),document.addEventListener("keydown",ue),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",ue)}},[]),N.useEffect(()=>{if(!at)return;const ne=()=>bt(null);return window.addEventListener("scroll",ne,!0),window.addEventListener("resize",ne),()=>{window.removeEventListener("scroll",ne,!0),window.removeEventListener("resize",ne)}},[at]),N.useEffect(()=>{(async()=>{const ne=await Nt(At(je,"products_clothes")),ue=[];ne.forEach(Re=>{const Ee=Re.data();ue.push({id:Re.id,name:Ee.name??"(sin nombre)",category:Ee.category??"(sin categora)",measurement:Ee.measurement??"unidad",price:Number(Ee.price??0),sku:Ee.sku||"",size:Ee.size||"",color:Ee.color||"",gender:Ee.gender||"",brand:Ee.brand||""})}),e(ue);const K=Ut(At(je,"inventory_clothes_batches"),Rr("date","desc")),le=await Nt(K),me=[];le.forEach(Re=>{const Ee=Re.data();me.push({id:Re.id,productId:Ee.productId,productName:Ee.productName,category:Ee.category,unit:Ee.unit,quantity:Number(Ee.quantity||0),remaining:Number(Ee.remaining??Ee.quantity??0),purchasePrice:Number(Ee.purchasePrice||0),salePrice:Number(Ee.salePrice||0),invoiceTotal:Number(Ee.invoiceTotal??Number(Ee.quantity||0)*Number(Ee.purchasePrice||0)),expectedTotal:Number(Ee.expectedTotal??Number(Ee.quantity||0)*Number(Ee.salePrice||0)),date:Ee.date,createdAt:Ee.createdAt,status:Ee.status,notes:Ee.notes||"",sku:Ee.sku||"",size:Ee.size||"",color:Ee.color||"",gender:Ee.gender||"",brand:Ee.brand||"",clientCode:Ee.clientCode||""})}),n(me),a(!1)})()},[]),N.useEffect(()=>{const ne=t.find(ue=>ue.id===m);ne&&(_(Number(ne.price||0)),ne.sku&&pe(ne.sku),ne.size&&he(ue=>ue||ne.size),ne.color&&re(ue=>ue||ne.color),ne.gender&&Ce(ue=>ue||ne.gender),ne.brand&&I(ue=>ue||ne.brand))},[m,t]),N.useEffect(()=>{E(Math.floor(y*F*100)/100)},[y,F]),N.useEffect(()=>{k(Math.floor(y*R*100)/100)},[y,R]),N.useEffect(()=>{const ne=t.find(le=>le.id===m);if(ne!=null&&ne.sku){pe(ne.sku);return}const ue=O&&se?se:(ne==null?void 0:ne.category)||"";if(!ue&&!xe&&!de&&!ae&&!S){pe("");return}const K=fle({subcat:ue,gender:xe||"",color:de||"",size:ae||"",brand:S||""});pe(K)},[O,se,m,xe,de,ae,S,t]);const er=N.useMemo(()=>r.filter(ne=>!(c&&ne.date<c||u&&ne.date>u||f&&ne.productId!==f)),[r,c,u,f]),et=N.useMemo(()=>{const ne=er.reduce((me,Re)=>me+(Re.invoiceTotal||0),0),ue=er.reduce((me,Re)=>me+(Re.expectedTotal||0),0),K=er.reduce((me,Re)=>me+Re.quantity,0),le=er.reduce((me,Re)=>me+Re.remaining,0);return{udsIng:K,udsRem:le,totalFacturado:ne,totalEsperado:ue}},[er]),gt=async ne=>{ne.preventDefault(),l("");const ue=!!m&&!O,K=t.find(Ee=>Ee.id===m),le=ue?(K==null?void 0:K.name)||"":D||"",me=ue?(K==null?void 0:K.category)||"":se||"General",Re=ue&&(K==null?void 0:K.measurement)||"unidad";if(!le||y<=0||F<=0){l("Completa nombre/cantidad/costo.");return}if(V&&!rp.test(V)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const Ee=await Wr(At(je,"inventory_clothes_batches"),{productId:ue?K.id:"",productName:le,category:me,unit:Re,quantity:y,remaining:y,purchasePrice:F,salePrice:R,invoiceTotal:B,expectedTotal:M,date:x,createdAt:Kt.now(),status:"PENDIENTE",notes:T||"",sku:Z||"",size:ae||"",color:de||"",gender:xe||"",brand:S||"",clientCode:V||""});n(ye=>[{id:Ee.id,productId:ue?K.id:"",productName:le,category:me,unit:Re,quantity:y,remaining:y,purchasePrice:F,salePrice:R,invoiceTotal:B,expectedTotal:M,date:x,createdAt:Kt.now(),status:"PENDIENTE",notes:T||"",sku:Z||"",size:ae||"",color:de||"",gender:xe||"",brand:S||"",clientCode:V||""},...ye]),l(" Lote de ropa creado"),p(""),g(rr(new Date,"yyyy-MM-dd")),b(0),P(0),_(0),E(0),k(0),U(""),pe(""),he(""),re(""),Ce(""),I(""),j(""),W(!1),Y(""),ve("Camisa")}catch(Ee){console.error(Ee),l(" Error al crear lote")}},Pt=async ne=>{confirm(`Marcar PAGADO el lote del ${ne.date} (${ne.productName})?`)&&(await kr(kt(je,"inventory_clothes_batches",ne.id),{status:"PAGADO"}),n(K=>K.map(le=>le.id===ne.id?{...le,status:"PAGADO"}:le)))},Ft=ne=>{Oe(ne.id),J(ne.date),ie(ne.quantity),Ie(ne.purchasePrice),ze(ne.salePrice),ct(Number((ne.quantity*ne.purchasePrice).toFixed(2))),ft(Number((ne.quantity*ne.salePrice).toFixed(2))),De(ne.notes||""),Ge(ne.sku||""),G(ne.size||""),Ue(ne.color||""),ge(ne.gender||""),Qe(ne.brand||""),We(ne.clientCode||"")},Tt=()=>{Oe(null),J(""),ie(0),Ie(0),ze(0),ct(0),ft(0),De(""),Ge(""),G(""),Ue(""),ge(""),Qe(""),We("")};N.useEffect(()=>{z&&ct(Math.floor(q*fe*100)/100)},[z,q,fe]),N.useEffect(()=>{z&&ft(Math.floor(q*Ve*100)/100)},[z,q,Ve]);const Xt=async()=>{if(!z)return;const ne=r.find(me=>me.id===z);if(!ne)return;const ue=Math.max(0,ne.quantity-ne.remaining),K=Math.max(0,q-ue);if(Te&&!rp.test(Te)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const le=kt(je,"inventory_clothes_batches",z);await kr(le,{date:te,quantity:q,purchasePrice:fe,salePrice:Ve,invoiceTotal:Ye,expectedTotal:st,notes:nt,remaining:K,sku:Fe,size:_e,color:Ne,gender:$e||"",brand:Be||"",clientCode:Te||""}),n(me=>me.map(Re=>Re.id===z?{...Re,date:te,quantity:q,purchasePrice:fe,salePrice:Ve,invoiceTotal:Ye,expectedTotal:st,notes:nt,remaining:K,sku:Fe,size:_e,color:Ne,gender:$e||"",brand:Be||"",clientCode:Te||""}:Re)),Tt(),l(" Lote actualizado")},Vt=async ne=>{confirm(`Eliminar el lote del ${ne.date} (${ne.productName})?`)&&(await un(kt(je,"inventory_clothes_batches",ne.id)),n(K=>K.filter(le=>le.id!==ne.id)),l(" Lote eliminado"))},oe=()=>{const ne=(c?`Desde ${c}`:"Desde inicio")+"  "+(u?`Hasta ${u}`:"Hasta hoy"),ue=Re=>(Re||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),K=er.map(Re=>`
      <tr>
        <td>${Re.date}</td>
        <td>${(Re.category||"").toUpperCase()}</td>
        <td>${ue(Re.productName)}</td>
        <td>${ue(Re.sku||"")}</td>
        <td>${ue(Re.size||"")}</td>
        <td>${ue(Re.color||"")}</td>
        <td>${ue(Re.clientCode||"")}</td>
        <td>${ue(Re.gender||"")}</td>
        <td>${(Re.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${Re.quantity.toFixed(0)}</td>
        <td style="text-align:right">${Re.remaining.toFixed(0)}</td>
        <td style="text-align:right">${va(Re.purchasePrice)}</td>
        <td style="text-align:right">${va(Re.salePrice)}</td>
        <td style="text-align:right">${va(Re.invoiceTotal||0)}</td>
        <td style="text-align:right">${va(Re.expectedTotal||0)}</td>
        <td>${ue((Re.notes||"").slice(0,120))}</td>
        <td>${Re.status}</td>
      </tr>`).join(""),le=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${ne}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${et.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${et.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${va(et.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${va(et.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${va(Number((et.totalEsperado-et.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${K||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,me=window.open("","_blank");me&&(me.document.open(),me.document.write(le),me.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Ar(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:ne=>A(ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:ne=>d(ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:ne=>h(ne.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(ne=>i.jsxs("option",{value:ne.id,children:[ne.name,"  ",ne.category]},ne.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:oe,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",et.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",et.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",va(et.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",va(et.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",va(Number((et.totalEsperado-et.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):er.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):er.map(ne=>{const ue=z===ne.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:ue?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:te,onChange:K=>J(K.target.value)}):ne.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(ne.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:ne.productName,children:ne.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:Fe,onChange:K=>Ge(K.target.value)}):i.jsx("span",{className:"block truncate",title:ne.sku||"",children:ne.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:_e,onChange:K=>G(K.target.value)}):ne.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:Ne,onChange:K=>Ue(K.target.value)}):ne.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:Te,onChange:K=>{const le=K.target.value;rp.test(le)&&We(le)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:ne.clientCode||"",children:ne.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:ue?i.jsx("select",{className:"w-full border p-1 rounded",value:$e,onChange:K=>ge(K.target.value),children:dle.map(K=>i.jsx("option",{value:K,children:K||""},K))}):ne.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(ne.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ue?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(q)?"":q,onChange:K=>ie(Math.max(0,parseInt(K.target.value||"0",10)))}):ne.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ue?ne.remaining:ne.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ue?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(fe)?"":fe,onChange:K=>Ie(Math.max(0,parseFloat(K.target.value||"0")))}):va(ne.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ue?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(Ve)?"":Ve,onChange:K=>ze(Math.max(0,parseFloat(K.target.value||"0")))}):va(ne.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:va(ue?Ye:ne.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:va(ue?st:ne.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:ue?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:nt,onChange:K=>De(K.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:ne.notes||"",children:ne.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${ne.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ne.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:ue?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Xt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Tt,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:K=>xr(K,ne.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},ne.id)})})]})})}),at&&Vu.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>bt(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:ot.x,top:ot.y},onClick:ne=>ne.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const ne=er.find(ue=>ue.id===at);return(ne==null?void 0:ne.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{bt(null),Pt(ne)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const ne=er.find(ue=>ue.id===at);ne&&(bt(null),Ft(ne))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const ne=er.find(ue=>ue.id===at);ne&&(bt(null),Vt(ne))},children:" Borrar"})]})})]}),document.body),Lt&&Vu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ar(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ar(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:gt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ne=>p(ne.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(ne=>i.jsxs("option",{value:ne.id,children:[ne.name,"  ",ne.category,"  ",ne.sku?`SKU: ${ne.sku}`:""]},ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:ne=>g(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:ne=>b(Math.max(0,parseInt(ne.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:F===0?"":F,onChange:ne=>P(Math.max(0,parseFloat(ne.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:R===0?"":R,onChange:ne=>_(Math.max(0,parseFloat(ne.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Z,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ae,readOnly:!0,onChange:ne=>he(ne.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:de,readOnly:!0,onChange:ne=>re(ne.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:xe,readOnly:!0,onChange:ne=>Ce(ne.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:S,onChange:ne=>I(ne.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:V,onChange:ne=>{const ue=ne.target.value;rp.test(ue)&&j(ue)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!rp.test(V)&&V.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:T,onChange:ne=>U(ne.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[T.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:va(B),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:va(M),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ar(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const ple=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],gle=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],xle=["XS","S","M","L","XL","2XL"],vle=["2","4","6","8","10","12","14"],wle=["26","28","30","32","34","36","38"],yle=["Shein","Usado","Otro"],ble=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function v1(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function Nle(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function Cle(t){const e="ROP",r=v1(t.subcat).slice(0,3)||"GEN",n=Nle(t.gender),s=v1(t.color).slice(0,3)||"COL",a=v1(t.size)||"TLL",o=v1(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${s}-${a}-${o}`}const _le=/^[A-Za-z0-9._-]{0,32}$/;function Ele(){const[t,e]=N.useState(""),[r,n]=N.useState("Camisa"),[s,a]=N.useState(""),[o,l]=N.useState(""),[c,A]=N.useState("Shein"),[u,d]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(""),[y,b]=N.useState(""),[F,P]=N.useState("0"),[R,_]=N.useState(""),[B,E]=N.useState(""),M=N.useMemo(()=>{const j=Number(F||0),O=Number(y||0);return Math.floor(j*O*100)/100},[F,y]),[k,T]=N.useState([]),[U,Z]=N.useState(!0),[pe,ae]=N.useState(""),{refreshKey:he,refresh:de}=Jl(),[re,xe]=N.useState(!1),Ce=N.useMemo(()=>r.toLowerCase()==="jean"?wle:u==="NINO"||u==="NINA"?vle:xle,[r,u]);N.useEffect(()=>{p(Cle({subcat:r,gender:u,color:o,size:s,brand:c}))},[r,u,o,s,c]),N.useEffect(()=>{(async()=>{Z(!0);const j=Ut(At(je,"products_clothes"),Rr("createdAt","desc")),O=await Nt(j),W=[];O.forEach(D=>{const Y=D.data();W.push({id:D.id,name:Y.name??"(sin nombre)",category:Y.category??"",measurement:Y.measurement??"unidad",sku:Y.sku??"",size:Y.size||"",color:Y.color||"",brand:Y.brand||"",gender:Y.gender||"",clientCode:Y.clientCode||"",notes:Y.notes||"",createdAt:Y.createdAt??Kt.now()})}),T(W),Z(!1)})()},[he]);const S=()=>{e(""),n("Camisa"),a(""),l(""),A("Shein"),d(""),h(""),g(""),b(""),P("0"),_(""),E("")},I=async j=>{if(j.preventDefault(),ae(""),!t.trim()){ae("Ingresa el nombre del producto.");return}if(f&&!_le.test(f)){ae("Cdigo del cliente invlido");return}const O=Number(F||0),W=Number(y||0);if(O<0){ae("La cantidad de piezas debe ser 0 o mayor.");return}if(W<0){ae("El precio de venta no puede ser negativo.");return}try{const D=await Wr(At(je,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:u||"",clientCode:f||"",notes:x||"",createdAt:Kt.now(),price:W||0});if(T(Y=>[{id:D.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:u||"",clientCode:f||"",notes:x||"",createdAt:Kt.now()},...Y]),O>0){const Y=new Date().toISOString().slice(0,10),se=R||Y;await Wr(At(je,"inventory_clothes_batches"),{productId:D.id,productName:t.trim(),category:r,unit:"unidad",quantity:O,remaining:O,purchasePrice:0,salePrice:W||0,invoiceTotal:0,expectedTotal:M||0,date:se,createdAt:Kt.now(),status:"PENDIENTE",notes:B||"",sku:m||"",size:s||"",color:o||"",gender:u||"",brand:c||"",clientCode:f||""})}ae(O>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),S()}catch(D){console.error(D),ae(" Error al crear producto")}},V=async j=>{confirm(`Eliminar el producto "${j.name}"?`)&&(await un(kt(je,"products_clothes",j.id)),T(W=>W.filter(D=>D.id!==j.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:de,loading:U}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{xe(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),re&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:I,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:j=>e(j.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:j=>n(j.target.value),children:ple.map(j=>i.jsx("option",{value:j,children:j},j))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:u,onChange:j=>d(j.target.value),children:ble.map(j=>i.jsx("option",{value:j,children:j||""},j))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:s,onChange:j=>a(j.target.value),children:[i.jsx("option",{value:"",children:""}),Ce.map(j=>i.jsx("option",{value:j,children:j},j))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:j=>l(j.target.value),children:[i.jsx("option",{value:"",children:""}),gle.map(j=>i.jsx("option",{value:j,children:j},j))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:j=>A(j.target.value),children:yle.map(j=>i.jsx("option",{value:j,children:j},j))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:j=>h(j.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:j=>b(j.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:F,onChange:j=>P(j.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:R,onChange:j=>_(j.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(M)?"":M.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:S,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>xe(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:U?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):k.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):k.map(j=>{var O;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(O=j.createdAt)!=null&&O.toDate?j.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:j.category}),i.jsx("td",{className:"p-2 border",children:j.name}),i.jsx("td",{className:"p-2 border",children:j.sku}),i.jsx("td",{className:"p-2 border",children:j.size||""}),i.jsx("td",{className:"p-2 border",children:j.color||""}),i.jsx("td",{className:"p-2 border",children:j.brand||""}),i.jsx("td",{className:"p-2 border",children:j.gender||""}),i.jsx("td",{className:"p-2 border",children:j.clientCode||""}),i.jsx("td",{className:"p-2 border",children:j.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>V(j),children:"Borrar"})})]},j.id)})})]})}),pe&&i.jsx("p",{className:"mt-2 text-sm",children:pe})]})}async function Ble(t){const{productId:e,quantity:r,saleDate:n,saleId:s}=t,a=Math.max(0,Math.floor(Number(r||0)));if(!e||a<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=Ut(At(je,"inventory_clothes_batches"),qt("productId","==",e)),A=(await Nt(o)).docs.map(d=>({id:d.id,data:d.data()})).sort((d,f)=>{var g,y;const h=String(d.data.date||""),m=String(f.data.date||"");if(h!==m)return h<m?-1:1;const p=((g=d.data.createdAt)==null?void 0:g.seconds)??0,x=((y=f.data.createdAt)==null?void 0:y.seconds)??0;return p-x}).map(d=>kt(je,"inventory_clothes_batches",d.id)),u=[];return await ha(je,async d=>{const f=await Promise.all(A.map(m=>d.get(m)));let h=a;for(let m=0;m<A.length&&h>0;m++){const p=A[m],x=f[m];if(!x.exists())continue;const g=x.data(),y=Math.max(0,Math.floor(Number(g.quantity||0))),b=Number.isFinite(Number(g.remaining))?Math.max(0,Math.floor(Number(g.remaining||0))):y;if(b<=0)continue;const F=Math.min(b,h),P=Math.max(0,b-F);d.update(p,{remaining:P}),u.push({batchId:p.id,qty:F,batchDate:String(g.date||""),productName:String(g.productName||"")}),h-=F}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(s)for(const m of u)await Wr(At(je,"batch_clothes_allocations"),{saleId:s,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:Kt.now()})}),{allocations:u}}async function EE(t){const e=kt(je,"sales_clothes",t),r=await Wa(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const A=n.allocationsByItem[c],u=String((A==null?void 0:A.productId)||c||"");if(!u)continue;const d=Array.isArray(A==null?void 0:A.allocations)?A.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const A=String((c==null?void 0:c.productId)||"");if(!A)continue;const u=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[A]=u.map(d=>({batchId:String(d.batchId),qty:Math.max(0,Math.floor(Number(d.qty||d.quantity||0)))}))}for(const c of n.items){const A=String((c==null?void 0:c.productId)||"");if(!A)continue;const u=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),d=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):l[A]||[];s.push({productId:A,productName:String((c==null?void 0:c.productName)||""),qty:u,allocations:d.length?d:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),A=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),u=Array.isArray(n.allocations)?n.allocations.map(d=>({batchId:String(d.batchId),qty:Math.max(0,Math.floor(Number(d.qty||d.quantity||0)))})):[];c&&A>0&&s.push({productId:c,productName:String(l.productName||n.productName||""),qty:A,allocations:u.length?u:void 0})}return s.length===0?(await ha(je,async l=>{l.delete(e)}),{restored:0}):s.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await ha(je,async c=>{const A=[];for(const d of s)for(const f of d.allocations||[])A.push({ref:kt(je,"inventory_clothes_batches",f.batchId),addBack:Math.max(0,Math.floor(Number(f.qty||0)))});const u=await Promise.all(A.map(d=>c.get(d.ref)));for(let d=0;d<A.length;d++){const f=u[d];if(!f.exists())continue;const h=f.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(A[d].ref,{remaining:m+A[d].addBack})}c.delete(e)}),{restored:s.reduce((c,A)=>c+(A.allocations||[]).reduce((u,d)=>u+d.qty,0),0)}):(await ha(je,async l=>{const c={};for(const h of s){if(!h.productId||h.qty<=0)continue;const m=Ut(At(je,"inventory_clothes_batches"),qt("productId","==",h.productId)),x=(await Nt(m)).docs.map(g=>{const y=g.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),F=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:g.id,date:String(y.date||""),quantity:b,remaining:F}}).sort((g,y)=>g.date.localeCompare(y.date));c[h.productId]=x}const A=[];for(const h of s){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)A.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const g=Math.max(0,x.quantity-x.remaining);if(g<=0)continue;const y=Math.min(g,p);A.push({id:x.id,addBack:y}),p-=y}for(const x of m){if(p<=0)break;const g=Math.min(p,h.qty);A.push({id:x.id,addBack:g}),p-=g}}const u={};for(const h of A)u[h.id]=(u[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const d=Object.keys(u).map(h=>kt(je,"inventory_clothes_batches",h)),f=await Promise.all(d.map(h=>l.get(h)));for(let h=0;h<d.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),g=Math.max(0,Math.floor(Number(u[d[h].id]||0)));l.update(d[h],{remaining:x+g})}l.delete(e)}),{restored:s.reduce((l,c)=>l+c.qty,0)})}const tP=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Jc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function w1(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function rP(t){const e=Ut(At(je,"ar_movements"),qt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(je,"ar_movements",n.id))))}function Sle(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,a]=N.useState(null),[o,l]=N.useState([]),c=async et=>{e(!0),n(!0),a(et),l([]);try{const Pt=(await Nt(Ut(At(je,"sales_clothes"),qt("__name__","==",et)))).docs[0],Ft=Pt==null?void 0:Pt.data(),Xt=(Array.isArray(Ft==null?void 0:Ft.items)?Ft.items:Ft!=null&&Ft.item?[Ft.item]:[]).map(Vt=>({productName:String(Vt.productName||""),qty:Number(Vt.qty||0),unitPrice:Number(Vt.unitPrice||0),discount:Number(Vt.discount||0),total:Number(Vt.total||0)}));l(Xt)}catch(gt){console.error(gt)}finally{n(!1)}},[A,u]=N.useState(""),[d,f]=N.useState("+505 "),[h,m]=N.useState(""),[p,x]=N.useState(""),[g,y]=N.useState("ACTIVO"),[b,F]=N.useState(0),[P,R]=N.useState([]),[_,B]=N.useState(!0),[E,M]=N.useState(""),[k,T]=N.useState(null),[U,Z]=N.useState(""),[pe,ae]=N.useState("+505 "),[he,de]=N.useState(""),[re,xe]=N.useState(""),[Ce,S]=N.useState("ACTIVO"),[I,V]=N.useState(0),[j,O]=N.useState(!1),[W,D]=N.useState(null),[Y,se]=N.useState(!1),[ve,z]=N.useState([]),[Oe,te]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[J,q]=N.useState(!1),[ie,fe]=N.useState(0),[Ie,Ve]=N.useState(new Date().toISOString().slice(0,10)),[ze,Ye]=N.useState(""),[ct,st]=N.useState(!1),[ft,nt]=N.useState(null),[De,Fe]=N.useState(""),[Ge,_e]=N.useState(0),[G,Ne]=N.useState(""),[Ue,$e]=N.useState(!1);N.useEffect(()=>{(async()=>{const et=Ut(At(je,"customers_clothes"),Rr("createdAt","desc")),gt=await Nt(et),Pt=[];gt.forEach(Ft=>{const Tt=Ft.data();Pt.push({id:Ft.id,name:Tt.name??"",phone:Tt.phone??"+505 ",place:Tt.place??"",notes:Tt.notes??"",status:Tt.status??"ACTIVO",creditLimit:Number(Tt.creditLimit??0),createdAt:Tt.createdAt??Kt.now(),balance:0})});for(const Ft of Pt)try{const Tt=Ut(At(je,"ar_movements"),qt("customerId","==",Ft.id)),Xt=await Nt(Tt);let Vt=0;Xt.forEach(oe=>Vt+=Number(oe.data().amount||0)),Ft.balance=Vt}catch{Ft.balance=0}R(Pt),B(!1)})()},[]);const ge=()=>{u(""),f("+505 "),m(""),x(""),y("ACTIVO"),F(0)},Be=async et=>{if(et.preventDefault(),M(""),!A.trim()){M("Ingresa el nombre.");return}const gt=w1(d);if(gt.length<6){M("Telfono incompleto.");return}try{const Pt=await Wr(At(je,"customers_clothes"),{name:A.trim(),phone:gt,place:h||"",notes:p||"",status:g,creditLimit:Number(b||0),createdAt:Kt.now()});R(Ft=>[{id:Pt.id,name:A.trim(),phone:gt,place:h||"",notes:p||"",status:g,creditLimit:Number(b||0),createdAt:Kt.now(),balance:0},...Ft]),ge(),$e(!1),M(" Cliente creado")}catch(Pt){console.error(Pt),M(" Error al crear cliente")}},Qe=et=>{T(et.id),Z(et.name),ae(et.phone||"+505 "),de(et.place||""),xe(et.notes||""),S(et.status||"ACTIVO"),V(Number(et.creditLimit||0))},Te=()=>{T(null),Z(""),ae("+505 "),de(""),xe(""),S("ACTIVO"),V(0)},We=async()=>{if(!k)return;const et=w1(pe);if(!U.trim()){M("Ingresa el nombre.");return}try{await kr(kt(je,"customers_clothes",k),{name:U.trim(),phone:et,place:he||"",notes:re||"",status:Ce,creditLimit:Number(I||0)}),R(gt=>gt.map(Pt=>Pt.id===k?{...Pt,name:U.trim(),phone:et,place:he||"",notes:re||"",status:Ce,creditLimit:Number(I||0)}:Pt)),Te(),M(" Cliente actualizado")}catch(gt){console.error(gt),M(" Error al actualizar")}},at=async et=>{if(confirm(`Eliminar al cliente "${et.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{B(!0);const Pt=Ut(At(je,"sales_clothes"),qt("customerId","==",et.id)),Ft=await Nt(Pt);for(const Vt of Ft.docs){const oe=Vt.id;try{await EE(oe)}catch(ne){console.warn("restoreSaleAndDeleteClothes error",ne);try{await un(kt(je,"sales_clothes",oe))}catch{}}await rP(oe)}const Tt=Ut(At(je,"ar_movements"),qt("customerId","==",et.id)),Xt=await Nt(Tt);await Promise.all(Xt.docs.map(Vt=>un(kt(je,"ar_movements",Vt.id)))),await un(kt(je,"customers_clothes",et.id)),R(Vt=>Vt.filter(oe=>oe.id!==et.id)),M(" Cliente eliminado y prendas devueltas al inventario")}catch(Pt){console.error(Pt),M(" No se pudo eliminar el cliente.")}finally{B(!1)}},bt=async et=>{D(et),z([]),te({saldoActual:0,totalAbonado:0,totalCargos:0}),O(!0),q(!1),fe(0),Ve(new Date().toISOString().slice(0,10)),Ye(""),nt(null),se(!0);try{const gt=Ut(At(je,"ar_movements"),qt("customerId","==",et.id)),Pt=await Nt(gt),Ft=[];Pt.forEach(Tt=>{var Vt,oe;const Xt=Tt.data();Ft.push({id:Tt.id,date:Xt.date??((oe=(Vt=Xt.createdAt)==null?void 0:Vt.toDate)!=null&&oe.call(Vt)?Xt.createdAt.toDate().toISOString().slice(0,10):""),type:Xt.type??"CARGO",amount:Number(Xt.amount||0),ref:Xt.ref||{},comment:Xt.comment||"",createdAt:Xt.createdAt})}),Ft.sort((Tt,Xt)=>{var ne,ue;if(Tt.date!==Xt.date)return Tt.date.localeCompare(Xt.date);const Vt=((ne=Tt.createdAt)==null?void 0:ne.seconds)||0,oe=((ue=Xt.createdAt)==null?void 0:ue.seconds)||0;return Vt-oe}),z(Ft),ot(Ft)}catch(gt){console.error(gt),M(" No se pudo cargar el estado de cuenta")}finally{se(!1)}},ot=et=>{const gt=et.reduce((Tt,Xt)=>Tt+(Number(Xt.amount)||0),0),Pt=et.filter(Tt=>Number(Tt.amount)<0).reduce((Tt,Xt)=>Tt+Math.abs(Number(Xt.amount)||0),0),Ft=et.filter(Tt=>Number(Tt.amount)>0).reduce((Tt,Xt)=>Tt+Number(Xt.amount)||0,0);te({saldoActual:gt,totalAbonado:Pt,totalCargos:Ft})},wt=async()=>{if(!W)return;M("");const et=Number(ie||0);if(!(et>0)){M("Ingresa un monto de abono mayor a 0.");return}const gt=parseFloat(et.toFixed(2));if(!Ie){M("Selecciona la fecha del abono.");return}try{st(!0);const Pt={customerId:W.id,type:"ABONO",amount:-gt,date:Ie,comment:ze||"",createdAt:Kt.now()},Tt={id:(await Wr(At(je,"ar_movements"),Pt)).id,date:Ie,type:"ABONO",amount:-gt,comment:ze||"",createdAt:Kt.now()},Xt=[...ve,Tt].sort((Vt,oe)=>{var K,le;if(Vt.date!==oe.date)return Vt.date.localeCompare(oe.date);const ne=((K=Vt.createdAt)==null?void 0:K.seconds)||0,ue=((le=oe.createdAt)==null?void 0:le.seconds)||0;return ne-ue});z(Xt),ot(Xt),R(Vt=>Vt.map(oe=>oe.id===W.id?{...oe,balance:(oe.balance||0)-gt}:oe)),D(Vt=>Vt&&{...Vt,balance:(Vt.balance||0)-gt}),fe(0),Ye(""),Ve(new Date().toISOString().slice(0,10)),q(!1),M(" Abono registrado")}catch(Pt){console.error(Pt),M(" Error al registrar el abono")}finally{st(!1)}},Lt=et=>{nt(et.id),Fe(et.date||new Date().toISOString().slice(0,10)),_e(Math.abs(Number(et.amount||0))),Ne(et.comment||"")},Ar=()=>{nt(null),Fe(""),_e(0),Ne("")},ir=async()=>{if(!ft)return;const et=ve.findIndex(Tt=>Tt.id===ft);if(et===-1)return;const gt=ve[et],Pt=Number(Ge||0);if(!(Pt>0)){M("El monto debe ser mayor a 0.");return}const Ft=gt.type==="ABONO"?-parseFloat(Pt.toFixed(2)):+parseFloat(Pt.toFixed(2));try{await kr(kt(je,"ar_movements",ft),{date:De,amount:Ft,comment:G||""});const Tt=[...ve];Tt[et]={...gt,date:De,amount:Ft,comment:G||""},Tt.sort((Vt,oe)=>{var K,le;if(Vt.date!==oe.date)return Vt.date.localeCompare(oe.date);const ne=((K=Vt.createdAt)==null?void 0:K.seconds)||0,ue=((le=oe.createdAt)==null?void 0:le.seconds)||0;return ne-ue}),z(Tt),ot(Tt);const Xt=Tt.reduce((Vt,oe)=>Vt+(Number(oe.amount)||0),0);R(Vt=>Vt.map(oe=>oe.id===(W==null?void 0:W.id)?{...oe,balance:Xt}:oe)),D(Vt=>Vt&&{...Vt,balance:Xt}),Ar(),M(" Movimiento actualizado")}catch(Tt){console.error(Tt),M(" Error al actualizar movimiento")}},xr=async et=>{var Pt,Ft;if(confirm(`Eliminar este movimiento (${et.type==="ABONO"?"Abono":"Compra"}) del ${et.date}?${et.type==="CARGO"&&((Pt=et.ref)!=null&&Pt.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(B(!0),et.type==="CARGO"&&((Ft=et.ref)!=null&&Ft.saleId)){try{await EE(et.ref.saleId)}catch(Vt){console.warn("restoreSaleAndDeleteClothes error",Vt),B(!1),M(" No se pudo devolver inventario de la venta.");return}await rP(et.ref.saleId)}else await un(kt(je,"ar_movements",et.id));const Tt=ve.filter(Vt=>{var oe,ne;return et.type==="CARGO"&&((oe=et.ref)!=null&&oe.saleId)?((ne=Vt.ref)==null?void 0:ne.saleId)!==et.ref.saleId:Vt.id!==et.id});z(Tt),ot(Tt);const Xt=Tt.reduce((Vt,oe)=>Vt+(Number(oe.amount)||0),0);R(Vt=>Vt.map(oe=>oe.id===(W==null?void 0:W.id)?{...oe,balance:Xt}:oe)),D(Vt=>Vt&&{...Vt,balance:Xt}),M(" Movimiento eliminado")}catch(Tt){console.error(Tt),M(" Error al eliminar movimiento")}finally{B(!1)}},er=N.useMemo(()=>[...P].sort((et,gt)=>{var Pt,Ft;return et.status!==gt.status?et.status==="BLOQUEADO"?1:-1:(((Pt=gt.createdAt)==null?void 0:Pt.seconds)||0)-(((Ft=et.createdAt)==null?void 0:Ft.seconds)||0)}),[P]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>$e(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:_?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):er.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):er.map(et=>{var Pt;const gt=k===et.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Pt=et.createdAt)!=null&&Pt.toDate?et.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{className:"w-full border p-1 rounded",value:U,onChange:Ft=>Z(Ft.target.value)}):et.name}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{className:"w-full border p-1 rounded",value:pe,onChange:Ft=>ae(w1(Ft.target.value))}):et.phone}),i.jsx("td",{className:"p-2 border",children:gt?i.jsxs("select",{className:"w-full border p-1 rounded",value:he,onChange:Ft=>de(Ft.target.value),children:[i.jsx("option",{value:"",children:""}),tP.map(Ft=>i.jsx("option",{value:Ft,children:Ft},Ft))]}):et.place||""}),i.jsx("td",{className:"p-2 border",children:gt?i.jsxs("select",{className:"w-full border p-1 rounded",value:Ce,onChange:Ft=>S(Ft.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${et.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:et.status})}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(I)?"":I,onChange:Ft=>V(Math.max(0,Number(Ft.target.value||0)))}):Jc(et.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Jc(et.balance||0)}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:re,onChange:Ft=>xe(Ft.target.value),maxLength:500}):i.jsx("span",{title:et.notes||"",children:(et.notes||"").length>40?(et.notes||"").slice(0,40)+"":et.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:gt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:We,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Te,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Qe(et),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>at(et),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>bt(et),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},et.id)})})]})}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),Ue&&Vu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>$e(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>$e(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Be,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:A,onChange:et=>u(et.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:et=>f(w1(et.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:et=>m(et.target.value),children:[i.jsx("option",{value:"",children:""}),tP.map(et=>i.jsx("option",{value:et,children:et},et))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:g,onChange:et=>y(et.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:et=>F(Math.max(0,Number(et.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:et=>x(et.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>$e(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(W==null?void 0:W.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{fe(0),Ve(new Date().toISOString().slice(0,10)),Ye(""),q(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>O(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Jc(Oe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Jc(Oe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Jc(Oe.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Y?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):ve.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):ve.map(et=>{var Pt,Ft;const gt=ft===et.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:De,onChange:Tt=>Fe(Tt.target.value)}):et.date||""}),i.jsx("td",{className:"p-2 border",children:et.amount>=0?(Pt=et.ref)!=null&&Pt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(et.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Ft=et.ref)!=null&&Ft.saleId?`Venta #${et.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{className:"w-full border p-1 rounded",value:G,onChange:Tt=>Ne(Tt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:et.comment||"",children:(et.comment||"").length>40?(et.comment||"").slice(0,40)+"":et.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:gt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ge)?"":Ge,onChange:Tt=>{const Xt=Number(Tt.target.value||0),Vt=Number.isFinite(Xt)?Math.max(0,parseFloat(Xt.toFixed(2))):0;_e(Vt)},placeholder:"0.00",title:et.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Jc(et.amount)}),i.jsx("td",{className:"p-2 border",children:gt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ir,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ar,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Lt(et),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>xr(et),children:"Borrar"})]})})]},et.id)})})]})})]})}),J&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(W==null?void 0:W.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ie,onChange:et=>Ve(et.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ie===0?"":ie,onChange:et=>{const gt=Number(et.target.value||0),Pt=Number.isFinite(gt)?Math.max(0,parseFloat(gt.toFixed(2))):0;fe(Pt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:ze,onChange:et=>Ye(et.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ze.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>q(!1),disabled:ct,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:wt,disabled:ct,children:ct?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((et,gt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:et.productName}),i.jsx("td",{className:"p-2 border text-right",children:et.qty}),i.jsx("td",{className:"p-2 border text-right",children:Jc(et.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Jc(et.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Jc(et.total)})]},gt))})]})})]})})]})}const Tf=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Ile=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function Fle(t){if(!t)return 0;const e=Ut(At(je,"inventory_clothes_batches"),qt("productId","==",t)),r=await Nt(e);let n="0000-00-00",s=-1,a=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),A=Number(l.salePrice||0),u=l.createdAt,d=((u==null?void 0:u.seconds)??0)*1e3+((u==null?void 0:u.nanoseconds)??0)/1e6;c>n?(n=c,s=d,a=A):c===n&&d>s&&(s=d,a=A)}),Number(a||0)}async function nP(t){if(!t)return 0;const e=Ut(At(je,"inventory_clothes_batches"),qt("productId","==",t)),r=await Nt(e);let n=0;return r.forEach(s=>n+=Number(s.data().remaining||0)),n}function sP(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function kle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState({}),[o,l]=N.useState("CONTADO"),[c,A]=N.useState(""),[u,d]=N.useState(""),[f,h]=N.useState(new Date().toISOString().slice(0,10)),[m,p]=N.useState(""),[x,g]=N.useState([]),y=N.useMemo(()=>x.reduce((te,J)=>te+(J.qty||0),0),[x]),b=N.useMemo(()=>{const te=x.reduce((J,q)=>{const ie=Math.max(0,(Number(q.unitPrice)||0)*(q.qty||0)-(Number(q.discount)||0));return J+ie},0);return Math.floor(te*100)/100},[x]),[F,P]=N.useState(0),[R,_]=N.useState(""),[B,E]=N.useState(!1),[M,k]=N.useState(!1),[T,U]=N.useState(""),[Z,pe]=N.useState("+505 "),[ae,he]=N.useState(""),[de,re]=N.useState(""),[xe,Ce]=N.useState("ACTIVO"),[S,I]=N.useState(0),V=()=>{U(""),pe("+505 "),he(""),re(""),Ce("ACTIVO"),I(0)};N.useEffect(()=>{(async()=>{const te=Ut(At(je,"customers_clothes"),Rr("createdAt","desc")),J=await Nt(te),q=[];J.forEach(ct=>{const st=ct.data();q.push({id:ct.id,name:st.name??"",phone:st.phone??"+505 ",place:st.place??"",status:st.status??"ACTIVO",creditLimit:Number(st.creditLimit??0),balance:0})});for(const ct of q)try{const st=Ut(At(je,"ar_movements"),qt("customerId","==",ct.id)),ft=await Nt(st);let nt=0;ft.forEach(De=>nt+=Number(De.data().amount||0)),ct.balance=nt}catch{ct.balance=0}e(q);const ie=Ut(At(je,"products_clothes"),Rr("createdAt","desc")),fe=await Nt(ie),Ie=[];fe.forEach(ct=>{const st=ct.data();Ie.push({id:ct.id,name:st.name??"(sin nombre)",sku:st.sku??""})}),n(Ie);const Ve=Ut(At(je,"inventory_clothes_batches"),qt("remaining",">",0)),ze=await Nt(Ve),Ye={};ze.forEach(ct=>{const st=ct.data(),ft=st.productId||"",nt=Number(st.remaining||0);ft&&(Ye[ft]=(Ye[ft]||0)+nt)}),a(Ye)})()},[]);const j=N.useMemo(()=>t.find(te=>te.id===c),[t,c]),O=(j==null?void 0:j.balance)||0,W=o==="CREDITO"?O+Math.max(0,Number(b||0))-Math.max(0,Number(F||0)):0,D=async te=>{if(!te)return;if(x.some(Ie=>Ie.productId===te)){p("");return}const J=r.find(Ie=>Ie.id===te);if(!J){p("");return}let q=await Fle(te);q||(q=Number((J==null?void 0:J.price)||0));const ie=await nP(te),fe={productId:te,productName:J.name||"",sku:J.sku||"",unitPrice:Number(q)||0,available:Number(ie)||0,qty:0,discount:0};g(Ie=>[...Ie,fe]),p("")},Y=(te,J)=>{g(q=>q.map(ie=>{if(ie.productId!==te)return ie;if(J==="")return{...ie,qty:0};const fe=Math.max(0,Math.floor(Number(J)));return{...ie,qty:fe}}))},se=(te,J)=>{g(q=>q.map(ie=>{if(ie.productId!==te)return ie;if(J==="")return{...ie,discount:0};const fe=Math.max(0,Math.floor(Number(J)));return{...ie,discount:fe}}))},ve=te=>g(J=>J.filter(q=>q.productId!==te)),z=async()=>{if(!f)return"Selecciona la fecha.";if(x.length===0)return"Agrega al menos un producto.";const te=x.filter(J=>(J.qty||0)>0);if(te.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(b>0))return"El total debe ser mayor a cero.";if(o==="CONTADO"){if(!u.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!c)return"Selecciona un cliente (crdito).";if(F<0)return"El pago inicial no puede ser negativo.";if(F>b)return"El pago inicial no puede superar el total.";if((j==null?void 0:j.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const J of te){const q=await nP(J.productId);if(J.qty>q)return`Inventario insuficiente para "${J.productName}". Disponible: ${q} unidades.`;const ie=(Number(J.unitPrice)||0)*(J.qty||0),fe=Number(J.discount)||0;if(!Number.isInteger(fe)||fe<0)return`El descuento en "${J.productName}" debe ser entero y  0.`;if(fe>ie)return`El descuento en "${J.productName}" no puede exceder C$ ${ie.toFixed(2)}.`}return null},Oe=async te=>{te.preventDefault(),_("");const J=await z();if(J){_(" "+J);return}try{E(!0);const q=x.filter(Ve=>(Ve.qty||0)>0).map(Ve=>{const ze=(Number(Ve.unitPrice)||0)*(Ve.qty||0),Ye=Math.max(0,Math.floor(Number(Ve.discount)||0)),ct=Math.max(0,ze-Ye);return{productId:Ve.productId,productName:Ve.productName,sku:Ve.sku||"",qty:Ve.qty,unitPrice:Number(Ve.unitPrice)||0,discount:Ye,total:Math.floor(ct*100)/100}}),ie={type:o,date:f,createdAt:Kt.now(),itemsTotal:Number(b)||0,total:Number(b)||0,quantity:Number(y)||0,items:q};o==="CONTADO"?ie.customerName=u.trim():(ie.customerId=c,ie.downPayment=Number(F)||0);const fe=await Wr(At(je,"sales_clothes"),ie);if(o==="CREDITO"&&c){const Ve={customerId:c,date:f,createdAt:Kt.now(),ref:{saleId:fe.id}};await Wr(At(je,"ar_movements"),{...Ve,type:"CARGO",amount:Number(b)||0}),Number(F)>0&&await Wr(At(je,"ar_movements"),{...Ve,type:"ABONO",amount:-Number(F)})}const Ie={};for(const Ve of q)if(Ve.qty>0){const{allocations:ze}=await Ble({productId:Ve.productId,quantity:Ve.qty,saleDate:f,saleId:fe.id});Ie[Ve.productId]={productId:Ve.productId,allocations:ze}}await kr(kt(je,"sales_clothes",fe.id),{allocationsByItem:Ie}),l("CONTADO"),A(""),d(""),h(new Date().toISOString().slice(0,10)),g([]),P(0),o==="CREDITO"&&c&&e(Ve=>Ve.map(ze=>ze.id===c?{...ze,balance:(ze.balance||0)+(Number(b)||0)-(Number(F)||0)}:ze)),_(" Venta registrada"),(async()=>{const Ve=Ut(At(je,"inventory_clothes_batches"),qt("remaining",">",0)),ze=await Nt(Ve),Ye={};ze.forEach(ct=>{const st=ct.data(),ft=st.productId||"",nt=Number(st.remaining||0);ft&&(Ye[ft]=(Ye[ft]||0)+nt)}),a(Ye)})()}catch(q){console.error(q),_(" Error al guardar la venta")}finally{E(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:Oe,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:te=>l(te.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),o==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:u,onChange:te=>d(te.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:c,onChange:te=>A(te.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),t.map(te=>i.jsxs("option",{value:te.status==="ACTIVO"?te.id:"",disabled:te.status==="BLOQUEADO",children:[te.name," | ",te.phone," | Saldo: ",Tf(te.balance||0)]},te.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>k(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Tf(O)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:F===0?"":F,onChange:te=>P(Math.max(0,Number(te.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Tf(W)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:f,onChange:te=>h(te.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:async te=>{const J=te.target.value;p(J),await D(J)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),r.map(te=>{const J=x.some(fe=>fe.productId===te.id),q=s[te.id]||0,ie=J||q<=0;return i.jsxs("option",{value:ie?"":te.id,disabled:ie,children:[te.name," ",te.sku?` ${te.sku}`:""," ",q>0?`(disp: ${q})`:"(sin stock)",J?" (seleccionado)":""]},te.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),x.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):x.map(te=>{const J=Math.max(0,(te.available||0)-(te.qty||0)),q=(Number(te.unitPrice)||0)*(te.qty||0),ie=Math.max(0,q-(Number(te.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[te.productName,te.sku?`  ${te.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Tf(te.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:J}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(te.qty)||te.qty===0?"":te.qty,onChange:fe=>Y(te.productId,fe.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(te.discount)||te.discount===0?"":te.discount,onChange:fe=>se(te.productId,fe.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:Tf(ie)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>ve(te.productId),title:"Quitar producto",children:""})})]},te.productId)})]}),x.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:y})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Tf(b)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:B,children:B?"Guardando...":"Registrar venta"})})]}),R&&i.jsx("p",{className:"mt-2 text-sm",children:R}),M&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:T,onChange:te=>U(te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:Z,onChange:te=>pe(sP(te.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:te=>he(te.target.value),children:[i.jsx("option",{value:"",children:""}),Ile.map(te=>i.jsx("option",{value:te,children:te},te))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:xe,onChange:te=>Ce(te.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:S===0?"":S,onChange:te=>I(Math.max(0,Number(te.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:de,onChange:te=>re(te.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{V(),k(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(_(""),!T.trim()){_("Ingresa el nombre del nuevo cliente.");return}const te=sP(Z);try{const J=await Wr(At(je,"customers_clothes"),{name:T.trim(),phone:te,place:ae||"",notes:de||"",status:xe,creditLimit:Number(S||0),createdAt:Kt.now()}),q={id:J.id,name:T.trim(),phone:te,place:ae||"",status:xe,creditLimit:Number(S||0),balance:0};e(ie=>[q,...ie]),A(J.id),V(),k(!1),_(" Cliente creado")}catch(J){console.error(J),_(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),B&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const aa=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function xw(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?rr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function Tle(t,e){const r=xw(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},s=Number(t.quantity??n.qty??0),a=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??a??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:s,unitPrice:Number(n.unitPrice??(a&&s?a/s:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function jle(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,A)=>c.date.localeCompare(A.date));const a=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of a)for(const c of l.items||[]){const A=s[c.productId];if(!A)continue;let u=Number(c.qty||0);if(!(u<=0))for(const d of A.lots){if(u<=0)break;if(d.qtyLeft<=0)continue;const f=Math.min(d.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=f*d.cost),d.qtyLeft-=f,u-=f}}return o}function Ple(){const{refreshKey:t,refresh:e}=Jl(),[r,n]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[s,a]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,A]=N.useState([]),[u,d]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,P]=N.useState(""),[R,_]=N.useState(!1),[B,E]=N.useState(null),[M,k]=N.useState([]),[T,U]=N.useState(!1),[Z,pe]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});N.useEffect(()=>{(async()=>{b(!0),P("");try{const S=await Nt(At(je,"sales_clothes")),I=[],V=[];S.forEach(te=>{const J=te.data(),q=Tle(J,te.id);q&&(q.date<=s&&I.push(q),q.date>=r&&q.date<=s&&V.push(q))}),A(I),l(V);const j=await Nt(At(je,"inventory_clothes_batches")),O=[];j.forEach(te=>{const J=te.data(),q=xw(J);!q||q>s||O.push({id:te.id,productId:J.productId,productName:J.productName||"",date:q,quantity:Number(J.quantity||0),remaining:Number(J.remaining||0),purchasePrice:Number(J.purchasePrice||0)})}),d(O);const W=await Nt(At(je,"expenses_clothes")),D=[];W.forEach(te=>{const J=te.data(),q=xw(J);q&&q>=r&&q<=s&&D.push({id:te.id,date:q,category:J.category||"",description:J.description||"",amount:Number(J.amount||0),status:J.status||""})}),h(D);const Y=await Nt(At(je,"ar_movements")),se=[],ve={};Y.forEach(te=>{const J=te.data(),q=xw(J);if(!q)return;const ie=J.customerId,fe=Number(J.amount||0);ie&&(ve[ie]=(ve[ie]||0)+fe),J.type==="ABONO"&&q>=r&&q<=s&&se.push({id:te.id,customerId:ie,type:"ABONO",amount:fe,date:q})}),p(se);const z=await Nt(At(je,"customers_clothes")),Oe=[];z.forEach(te=>{const J=te.data();Oe.push({id:te.id,name:J.name||"",balance:ve[te.id]||0})}),g(Oe)}catch(S){console.error(S),P(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,s,t]);const ae=N.useMemo(()=>{try{return jle(u,c,r,s)}catch(S){return console.error(S),0}},[u,c,r,s]),he=N.useMemo(()=>{const S=o.reduce((ve,z)=>ve+(z.total||0),0),I=f.reduce((ve,z)=>ve+(z.amount||0),0),V=S-ae,j=V-I,O=m.reduce((ve,z)=>ve+Math.abs(z.amount||0),0),W=x.filter(ve=>(ve.balance||0)>0),D=W.reduce((ve,z)=>ve+(z.balance||0),0);let Y=0,se=0;for(const ve of o){const z=(ve.items||[]).reduce((Oe,te)=>Oe+(Number(te.qty)||0),0);ve.type==="CONTADO"?Y+=z:se+=z}return{ventasTotales:S,costoMercaderia:ae,gastosPeriodo:I,gananciaAntes:V,gananciaDespues:j,abonosRecibidos:O,saldosPendientes:D,clientesConSaldo:W.length,prendasCash:Y,prendasCredito:se}},[o,f,m,x,ae]),de=N.useMemo(()=>{const S={};for(const I of o){if(I.type!=="CREDITO"||!I.customerId)continue;const V=(I.items||[]).reduce((j,O)=>j+(Number(O.qty)||0),0);S[I.customerId]=(S[I.customerId]||0)+V}return x.filter(I=>(I.balance||0)>0).map(I=>({customerId:I.id,name:I.name,prendasCredito:S[I.id]||0,saldo:I.balance||0})).sort((I,V)=>V.saldo-I.saldo)},[x,o]),re=N.useMemo(()=>{const S={};return x.forEach(I=>S[I.id]=I.name),S},[x]),xe=N.useMemo(()=>[...o].sort((S,I)=>I.date.localeCompare(S.date)).map(S=>{var j;const I=(S.items||[]).reduce((O,W)=>O+(Number(W.qty)||0),0);let V="Cash";return S.type==="CREDITO"&&S.customerId?V=re[S.customerId]||"":S.type==="CONTADO"&&(V=((j=S.customerName)==null?void 0:j.trim())||"Cash"),{id:S.id,date:S.date,type:S.type==="CREDITO"?"Crdito":"Cash",customer:V,piezas:I,total:Number(S.total||0)}}),[o,re]),Ce=async S=>{_(!0),E({id:S.customerId,name:S.name}),k([]),U(!0),pe({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const I=[];let V=0,j=0,O=0;for(const se of o)if(!(se.type!=="CREDITO"||se.customerId!==S.customerId))for(const ve of se.items||[]){const z=Number(ve.qty||0),Oe=Number(ve.unitPrice||0),te=z*Oe,J=Math.max(0,Number(ve.discount||0)),q=Math.max(0,te-J);I.push({saleId:se.id,date:se.date,productName:ve.productName,sku:ve.sku||"",qty:z,unitPrice:Oe,lineTotal:te,discount:J,lineFinal:q}),V+=te,j+=J,O+=q}let W=0;for(const se of m)se.customerId===S.customerId&&(W+=Math.abs(se.amount||0));const D=x.find(se=>se.id===S.customerId),Y=(D==null?void 0:D.balance)||0;k(I),pe({totalBruto:V,totalDescuento:j,totalFiado:O,saldoActual:Y,abonadoPeriodo:W})}catch(I){console.error(I),P(" No se pudo cargar el detalle del cliente.")}finally{U(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(Fc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:S=>n(S.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:S=>a(S.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(he.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(he.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:aa(he.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(he.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:aa(he.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(he.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(he.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:he.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:he.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:he.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):de.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):de.map(S=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ce({customerId:S.customerId,name:S.name}),title:"Ver piezas fiadas del periodo",children:S.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:aa(S.saldo)})]},S.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):xe.map(S=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.date}),i.jsx("td",{className:"p-2 border",children:S.customer}),i.jsx("td",{className:"p-2 border",children:S.type}),i.jsx("td",{className:"p-2 border",children:S.piezas}),i.jsx("td",{className:"p-2 border",children:aa(S.total)})]},S.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((S,I)=>S.date.localeCompare(I.date)).map(S=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.date}),i.jsx("td",{className:"p-2 border",children:S.category||""}),i.jsx("td",{className:"p-2 border",children:S.description?i.jsx("span",{title:S.description,children:S.description.length>40?S.description.slice(0,40)+"":S.description}):""}),i.jsx("td",{className:"p-2 border",children:aa(S.amount)}),i.jsx("td",{className:"p-2 border",children:S.status||""})]},S.id))})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F}),R&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(B==null?void 0:B.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>_(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(Z.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(Z.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(Z.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(Z.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:aa(Z.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):M.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):M.sort((S,I)=>S.date.localeCompare(I.date)).map((S,I)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.date}),i.jsx("td",{className:"p-2 border",children:S.productName}),i.jsx("td",{className:"p-2 border",children:S.sku||""}),i.jsx("td",{className:"p-2 border",children:S.qty}),i.jsx("td",{className:"p-2 border",children:aa(S.unitPrice)}),i.jsx("td",{className:"p-2 border",children:aa(S.lineTotal)}),i.jsx("td",{className:"p-2 border",children:aa(S.discount)}),i.jsx("td",{className:"p-2 border",children:aa(S.lineFinal)})]},`${S.saleId}-${I}`))})]})})]})})]})}const aP=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],y1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Rle(){const[t,e]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[r,n]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[s,a]=N.useState(rr(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,P]=N.useState(""),[R,_]=N.useState(null),[B,E]=N.useState(""),[M,k]=N.useState(""),[T,U]=N.useState(""),[Z,pe]=N.useState(0),[ae,he]=N.useState("PENDIENTE"),[de,re]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const D=Ut(At(je,"expenses_clothes"),Rr("date","desc")),Y=await Nt(D),se=[];Y.forEach(ve=>{const z=ve.data();se.push({id:ve.id,date:z.date||rr(new Date,"yyyy-MM-dd"),category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||"PENDIENTE",notes:z.notes||"",createdAt:z.createdAt??Kt.now()})}),g(se)}catch(D){console.error(D),P(" Error al cargar gastos")}finally{b(!1)}})()},[]);const xe=N.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Ce=N.useMemo(()=>{const D=xe.reduce((ve,z)=>ve+(z.amount||0),0),Y=xe.filter(ve=>ve.status==="PAGADO").reduce((ve,z)=>ve+(z.amount||0),0),se=D-Y;return{total:D,pagado:Y,pendiente:se}},[xe]),S=()=>{a(rr(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},I=async D=>{if(D.preventDefault(),P(""),!o){P("Selecciona una categora.");return}if(!c.trim()){P("Ingresa una descripcin.");return}if(!u||u<=0){P("Ingresa un monto vlido.");return}try{const Y=await Wr(At(je,"expenses_clothes"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Kt.now()});g(se=>[{id:Y.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Kt.now()},...se]),S(),P(" Gasto registrado")}catch(Y){console.error(Y),P(" Error al guardar gasto")}},V=D=>{_(D.id),E(D.date),k(D.category||""),U(D.description||""),pe(Number(D.amount||0)),he(D.status||"PENDIENTE"),re(D.notes||"")},j=()=>{_(null),E(""),k(""),U(""),pe(0),he("PENDIENTE"),re("")},O=async()=>{if(R){if(!M){P("Selecciona una categora.");return}if(!T.trim()){P("Ingresa una descripcin.");return}if(!Z||Z<=0){P("Ingresa un monto vlido.");return}try{await kr(kt(je,"expenses_clothes",R),{date:B,category:M,description:T.trim(),amount:Number(Z.toFixed(2)),status:ae,notes:de||""}),g(D=>D.map(Y=>Y.id===R?{...Y,date:B,category:M,description:T.trim(),amount:Number(Z.toFixed(2)),status:ae,notes:de||""}:Y)),j(),P(" Gasto actualizado")}catch(D){console.error(D),P(" Error al actualizar gasto")}}},W=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await un(kt(je,"expenses_clothes",D.id)),g(se=>se.filter(ve=>ve.id!==D.id)),P(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",y1(Ce.total)]}),i.jsxs("div",{children:["Pagado: ",y1(Ce.pagado)]}),i.jsxs("div",{children:["Pendiente: ",y1(Ce.pendiente)]})]})]}),i.jsxs("form",{onSubmit:I,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:D=>a(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),aP.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>A(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:D=>d(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):xe.slice().sort((D,Y)=>D.date.localeCompare(Y.date)).map(D=>{const Y=R===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:se=>E(se.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Y?i.jsxs("select",{className:"w-full border p-1 rounded",value:M,onChange:se=>k(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),aP.map(se=>i.jsx("option",{value:se,children:se},se))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>U(se.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Z)?"":Z,onChange:se=>pe(Math.max(0,Number(se.target.value||0)))}):y1(D.amount)}),i.jsx("td",{className:"p-2 border",children:Y?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>he(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:de,onChange:se=>re(se.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Y?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:O,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:j,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>V(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>W(D),children:"Borrar"})]})})})]},D.id)})})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F})]})}const _l=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Dle(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?rr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function Lle(t,e){const r=Dle(t);if(!r)return null;const n=t.item||{},s=Number((n==null?void 0:n.qty)??t.quantity??0)||0,a=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(s>0?a/s:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||s||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:s,unitPrice:o,total:s*o}}}async function Ule(t,e){if(e<=0)return;const r=Ut(At(je,"inventory_clothes_batches"),qt("productId","==",t)),n=await Nt(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let a=e;for(const o of s){if(a<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,a);a-=l,await kr(kt(je,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}a>0&&console.warn("consumeFIFO: falt inventario",a)}async function Ole(t,e){if(e<=0)return;const r=Ut(At(je,"inventory_clothes_batches"),qt("productId","==",t)),n=await Nt(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let a=e;for(const o of s){if(a<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,a);a-=c,await kr(kt(je,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}a>0&&console.warn("restoreFIFO: no se devolvi todo",a)}async function n8(t){const e=Ut(At(je,"ar_movements"),qt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(je,"ar_movements",n.id))))}async function Mle(t,e,r){if(await n8(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:Kt.now(),ref:{saleId:t.id}},{addDoc:s}=await mA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>YX);return{addDoc:o}},void 0);await s(At(je,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const a=Math.max(0,Number(r??t.downPayment??0));a>0&&await s(At(je,"ar_movements"),{...n,type:"ABONO",amount:-a})}function Qle(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,a]=N.useState(null),[o,l]=N.useState([]),c=async te=>{e(!0),n(!0),a(te),l([]);try{const q=(await Nt(Ut(At(je,"sales_clothes"),qt("__name__","==",te)))).docs[0],ie=q==null?void 0:q.data(),Ie=(Array.isArray(ie==null?void 0:ie.items)?ie.items:ie!=null&&ie.item?[ie.item]:[]).map(Ve=>({productName:String(Ve.productName||""),qty:Number(Ve.qty||0),unitPrice:Number(Ve.unitPrice||0),discount:Number(Ve.discount||0),total:Number(Ve.total||0)}));l(Ie)}catch(J){console.error(J)}finally{n(!1)}},[A,u]=N.useState(rr(new Date,"yyyy-MM-01")),[d,f]=N.useState(rr(new Date,"yyyy-MM-dd")),[h,m]=N.useState([]),[p,x]=N.useState([]),[g,y]=N.useState(!0),[b,F]=N.useState(""),[P,R]=N.useState(""),[_,B]=N.useState(""),[E,M]=N.useState(null),[k,T]=N.useState(!1),[U,Z]=N.useState(null),[pe,ae]=N.useState(0),he=15,[de,re]=N.useState(1),xe=N.useMemo(()=>{const te={};return h.forEach(J=>te[J.id]=J.name),te},[h]);N.useEffect(()=>{(async()=>{y(!0),F("");try{const te=await Nt(At(je,"customers_clothes")),J=[];te.forEach(fe=>J.push({id:fe.id,name:fe.data().name||""})),m(J);const q=await Nt(Ut(At(je,"sales_clothes"),Rr("createdAt","desc"))),ie=[];q.forEach(fe=>{const Ie=Lle(fe.data(),fe.id);Ie&&Ie.date>=A&&Ie.date<=d&&ie.push(Ie)}),x(ie.sort((fe,Ie)=>Ie.date.localeCompare(fe.date))),re(1)}catch(te){console.error(te),F(" Error cargando transacciones.")}finally{y(!1)}})()},[A,d]);const Ce=N.useMemo(()=>p.filter(te=>!(P&&te.customerId!==P||_&&te.type!==_)),[p,P,_]),S=N.useMemo(()=>{let te=0,J=0,q=0,ie=0;for(const fe of Ce)fe.type==="CONTADO"?(te+=fe.item.qty,q+=fe.total):(J+=fe.item.qty,ie+=fe.total);return{piezasCash:te,piezasCredito:J,montoCash:q,montoCredito:ie}},[Ce]),I=Math.max(1,Math.ceil(Ce.length/he)),V=N.useMemo(()=>{const te=(de-1)*he;return Ce.slice(te,te+he)},[Ce,de]),j=te=>{M(null),Z(te),ae(te.item.qty||0),T(!0)},O=async te=>{if(M(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await EE(te.id),await n8(te.id),x(J=>J.filter(q=>q.id!==te.id)),F(" Venta eliminada")}catch(J){console.error(J),F(" No se pudo eliminar la venta.")}finally{y(!1)}},W=async()=>{if(!U)return;const te=Number(U.item.qty||0),J=Math.max(1,Math.floor(Number(pe)||0));if(J===te){T(!1);return}const q=Number(U.item.unitPrice||0),ie=Number((q*J).toFixed(2));try{y(!0);const fe=J-te;fe>0?await Ule(U.item.productId,fe):fe<0&&await Ole(U.item.productId,-fe);const Ie=kt(je,"sales_clothes",U.id);await kr(Ie,{quantity:J,total:ie,itemsTotal:ie,"item.qty":J,"item.total":ie,updatedAt:Kt.now()});const Ve=Math.min(Number(U.downPayment||0),ie);await Mle(U,ie,Ve),x(ze=>ze.map(Ye=>Ye.id===U.id?{...Ye,quantity:J,total:ie,item:{...Ye.item,qty:J,total:ie},downPayment:Ve}:Ye)),F(" Venta actualizada"),T(!1)}catch(fe){console.error(fe),F(" No se pudo actualizar la venta.")}finally{y(!1)}},D=()=>{const te=`Reporte de transacciones (Ropa)  ${A} a ${d}`,J=Ie=>(Ie||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),q=Ce.map(Ie=>{const Ve=Ie.customerName||(Ie.customerId?xe[Ie.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Ie.date}</td>
          <td>${J(Ve)}</td>
          <td>${Ie.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ie.item.qty}</td>
          <td style="text-align:right">${_l(Ie.total)}</td>
        </tr>`}).join(""),ie=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${J(te)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${J(te)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${S.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${S.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${_l(S.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${_l(S.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${q||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,fe=window.open("","_blank");fe&&(fe.document.open(),fe.document.write(ie),fe.document.close())},Y=()=>re(1),se=()=>re(te=>Math.max(1,te-1)),ve=()=>re(te=>Math.min(I,te+1)),z=()=>re(I),Oe=()=>{const te=[];if(I<=7)for(let q=1;q<=I;q++)te.push(q);else{const q=Math.max(1,de-2),ie=Math.min(I,de+2);te.push(1),q>2&&te.push(-1);for(let fe=q;fe<=ie;fe++)fe!==1&&fe!==I&&te.push(fe);ie<I-1&&te.push(-2),te.push(I)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Y,disabled:de===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:se,disabled:de===1,children:" Anterior"}),te.map((q,ie)=>typeof q=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${q===de?"bg-blue-600 text-white":""}`,onClick:()=>re(q),children:q},ie):i.jsx("span",{className:"px-2",children:""},ie)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ve,disabled:de===I,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:z,disabled:de===I,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",de," de ",I,"  ",Ce.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:te=>{u(te.target.value),re(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:te=>{f(te.target.value),re(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:P,onChange:te=>{R(te.target.value),re(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(te=>i.jsx("option",{value:te.id,children:te.name},te.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:_,onChange:te=>{B(te.target.value),re(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:S.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:S.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:_l(S.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:_l(S.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:g?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):V.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):V.map(te=>{const J=te.customerName||(te.customerId?xe[te.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:te.date}),i.jsx("td",{className:"p-2 border",children:J}),i.jsx("td",{className:"p-2 border",children:te.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(te.id),children:te.item.qty})}),i.jsx("td",{className:"p-2 border",children:_l(te.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>M(q=>q===te.id?null:te.id),title:"Acciones",children:""}),E===te.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>j(te),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>O(te),children:"Eliminar"})]})]})]},te.id)})})]}),Oe()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),k&&U&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[U.item.productName," ",U.item.sku?` ${U.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:pe,onChange:te=>ae(Math.max(1,Math.floor(Number(te.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:_l(U.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:_l(Number(U.item.unitPrice)*Number(pe||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{T(!1),Z(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:W,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((te,J)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:te.productName}),i.jsx("td",{className:"p-2 border text-right",children:te.qty}),i.jsx("td",{className:"p-2 border text-right",children:_l(te.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:_l(te.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:_l(te.total)})]},J))})]})})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ey={};Ey.version="0.18.5";var s8=1252,Vle=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rI={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},nI=function(t){Vle.indexOf(t)!=-1&&(s8=rI[0]=t)};function Hle(){nI(1252)}var jl=function(t){nI(t)};function sI(){jl(1200),Hle()}function iP(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Kle(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function a8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var bp=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Kle(t.slice(2)):e==254&&r==255?a8(t.slice(2)):e==65279?t.slice(1):t},b1=function(e){return String.fromCharCode(e)},oP=function(e){return String.fromCharCode(e)},Wg,Tu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jg(t){for(var e="",r=0,n=0,s=0,a=0,o=0,l=0,c=0,A=0;A<t.length;)r=t.charCodeAt(A++),a=r>>2,n=t.charCodeAt(A++),o=(r&3)<<4|n>>4,s=t.charCodeAt(A++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),e+=Tu.charAt(a)+Tu.charAt(o)+Tu.charAt(l)+Tu.charAt(c);return e}function To(t){var e="",r=0,n=0,s=0,a=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<t.length;)a=Tu.indexOf(t.charAt(A++)),o=Tu.indexOf(t.charAt(A++)),r=a<<2|o>>4,e+=String.fromCharCode(r),l=Tu.indexOf(t.charAt(A++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Tu.indexOf(t.charAt(A++)),s=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Vr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),TA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function id(t){return Vr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function lP(t){return Vr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var No=function(e){return Vr?TA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function G2(t){if(typeof ArrayBuffer>"u")return No(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function xd(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function qle(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function aI(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return aI(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var _a=Vr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:TA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Gle(t){for(var e=[],r=0,n=t.length+250,s=id(t.length+255),a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(e.push(s.slice(0,r)),r=0,s=id(65535),n=65530)}return e.push(s.slice(0,r)),_a(e)}var Pi=/\u0000/g,Np=/[\u0001-\u0006]/g;function v0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Pl(t,e){var r=""+t;return r.length>=e?r:Is("0",e-r.length)+r}function iI(t,e){var r=""+t;return r.length>=e?r:Is(" ",e-r.length)+r}function By(t,e){var r=""+t;return r.length>=e?r:r+Is(" ",e-r.length)}function $le(t,e){var r=""+Math.round(t);return r.length>=e?r:Is("0",e-r.length)+r}function zle(t,e){var r=""+t;return r.length>=e?r:Is("0",e-r.length)+r}var cP=Math.pow(2,32);function jf(t,e){if(t>cP||t<-cP)return $le(t,e);var r=Math.round(t);return zle(r,e)}function Sy(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var AP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],YN=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Wle(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Nr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},uP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Jle={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Iy(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,o=1,l=0,c=1,A=0,u=0,d=Math.floor(s);A<e&&(d=Math.floor(s),l=d*o+a,u=d*A+c,!(s-d<5e-8));)s=1/(s-d),a=o,o=l,c=A,A=u;if(u>e&&(A>e?(u=c,l=a):(u=A,l=o)),!r)return[0,n*l,u];var f=Math.floor(n*l/u);return[f,n*l-f*u,u]}function rh(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,o=[],l={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=rce(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var i8=new Date(1899,11,31,0,0,0),Xle=i8.getTime(),Yle=new Date(1900,2,1,0,0,0);function o8(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Yle&&(r+=24*60*60*1e3),(r-(Xle+(t.getTimezoneOffset()-i8.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function oI(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Zle(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ece(t){var e=t<0?12:11,r=oI(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function tce(t){var e=oI(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Xg(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ece(t):e===10?r=t.toFixed(10).substr(0,12):r=tce(t),oI(Zle(r.toUpperCase()))}function Th(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Xg(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ml(14,o8(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function rce(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function nce(t,e,r,n){var s="",a=0,o=0,l=r.y,c,A=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,A=2;break;default:c=l%1e4,A=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,A=e.length;break;case 3:return YN[r.m-1][1];case 5:return YN[r.m-1][0];default:return YN[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,A=e.length;break;case 3:return AP[r.q][0];default:return AP[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,A=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,A=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,A=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Pl(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(s=Pl(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}A=e.length===3?1:2;break;case 101:c=l,A=1;break}var u=A>0?Pl(c,A):"";return u}function ju(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var l8=/%/g;function sce(t,e,r){var n=e.replace(l8,""),s=e.length-n.length;return pA(t,n,r*Math.pow(10,2*s))+Is("%",s)}function ace(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function c8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+c8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var A8=/# (\?+)( ?)\/( ?)(\d+)/;function ice(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),o=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?Is(" ",t[1].length+1+t[4].length):iI(o,t[1].length)+t[2]+"/"+t[3]+Pl(l,t[4].length))}function oce(t,e,r){return r+(e===0?"":""+e)+Is(" ",t[1].length+2+t[4].length)}var u8=/^#*0*\.([0#]+)/,d8=/\).*[0#]/,h8=/\(###\) ###\\?-####/;function Ii(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function dP(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function hP(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function lce(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function cce(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Jo(t,e,r){if(t.charCodeAt(0)===40&&!e.match(d8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jo("n",n,r):"("+Jo("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ace(t,e,r);if(e.indexOf("%")!==-1)return sce(t,e,r);if(e.indexOf("E")!==-1)return c8(e,r);if(e.charCodeAt(0)===36)return"$"+Jo(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(e.match(/^00+$/))return A+jf(c,e.length);if(e.match(/^[#?]+$/))return s=jf(r,0),s==="0"&&(s=""),s.length>e.length?s:Ii(e.substr(0,e.length-s.length))+s;if(a=e.match(A8))return ice(a,c,A);if(e.match(/^#+0+$/))return A+jf(c,e.length-e.indexOf("0"));if(a=e.match(u8))return s=dP(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Ii(a[1])).replace(/\.$/,"."+Ii(a[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Is("0",Ii(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return A+dP(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return A+ju(jf(c,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jo(t,e,-r):ju(""+(Math.floor(r)+lce(r,a[1].length)))+"."+Pl(hP(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Jo(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=v0(Jo(t,e.replace(/[\\-]/g,""),r)),o=0,v0(v0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(h8))return s=Jo(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Iy(c,Math.pow(10,o)-1,!1),s=""+A,u=pA("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=By(l[2],o),u.length<a[4].length&&(u=Ii(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Iy(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?iI(l[1],o)+a[2]+"/"+a[3]+By(l[2],o):Is(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=jf(r,0),e.length<=s.length?s:Ii(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=e.indexOf(".")-o,f=e.length-s.length-d;return Ii(e.substr(0,d)+s+e.substr(e.length-f))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=hP(r,a[1].length),r<0?"-"+Jo(t,e,-r):ju(cce(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Pl(0,3-m.length):"")+m})+"."+Pl(o,a[1].length);switch(e){case"###,##0.00":return Jo(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ju(jf(c,0));return h!=="0"?A+h:"";case"###,###.00":return Jo(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Jo(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Ace(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uce(t,e,r){var n=e.replace(l8,""),s=e.length-n.length;return pA(t,n,r*Math.pow(10,2*s))+Is("%",s)}function f8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+f8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ac(t,e,r){if(t.charCodeAt(0)===40&&!e.match(d8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ac("n",n,r):"("+Ac("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Ace(t,e,r);if(e.indexOf("%")!==-1)return uce(t,e,r);if(e.indexOf("E")!==-1)return f8(e,r);if(e.charCodeAt(0)===36)return"$"+Ac(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(e.match(/^00+$/))return A+Pl(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Ii(e.substr(0,e.length-s.length))+s;if(a=e.match(A8))return oce(a,c,A);if(e.match(/^#+0+$/))return A+Pl(c,e.length-e.indexOf("0"));if(a=e.match(u8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Ii(a[1])).replace(/\.$/,"."+Ii(a[1])),s=s.replace(/\.(\d*)$/,function(m,p){return"."+p+Is("0",Ii(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return A+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return A+ju(""+c);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ac(t,e,-r):ju(""+r)+"."+Is("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Ac(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=v0(Ac(t,e.replace(/[\\-]/g,""),r)),o=0,v0(v0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(h8))return s=Ac(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Iy(c,Math.pow(10,o)-1,!1),s=""+A,u=pA("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=By(l[2],o),u.length<a[4].length&&(u=Ii(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Iy(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?iI(l[1],o)+a[2]+"/"+a[3]+By(l[2],o):Is(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Ii(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=e.indexOf(".")-o,f=e.length-s.length-d;return Ii(e.substr(0,d)+s+e.substr(e.length-f))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ac(t,e,-r):ju(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Pl(0,3-m.length):"")+m})+"."+Pl(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=ju(""+c);return h!=="0"?A+h:"";default:if(e.match(/\.[0#?]*$/))return Ac(t,e.slice(0,e.lastIndexOf(".")),r)+Ii(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function pA(t,e,r){return(r|0)===r?Ac(t,e,r):Jo(t,e,r)}function dce(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var m8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lm(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Sy(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(m8))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function hce(t,e,r,n){for(var s=[],a="",o=0,l="",c="t",A,u,d,f="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!Sy(t,o))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(d=t.charCodeAt(++o))!==34&&o<t.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";s[s.length]={t:m,v:h},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(A==null&&(A=rh(e,r,t.charAt(o+1)==="2"),A==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||A==null&&(A=rh(e,r),A==null))return"";for(a=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(A==null&&(A=rh(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(A!=null&&(p.v=A.H>=12?"P":"A"),p.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(A!=null&&(p.v=A.H>=12?"PM":"AM"),p.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="/"?(A!=null&&(p.v=A.H>=12?"":""),p.t="T",o+=5,f="h"):(p.t="t",++o),A==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(a=l;t.charAt(o++)!=="]"&&o<t.length;)a+=t.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(m8)){if(A==null&&(A=rh(e,r),A==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",lm(t)||(s[s.length]={t:"t",v:a}));break;case".":if(A!=null){for(a=l;++o<t.length&&(l=t.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;t.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)a+=t.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++o;break}var x=0,g=0,y;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=f,c="h",x<1&&(x=1);break;case"s":(y=s[o].v.match(/\.0+$/))&&(g=Math.max(g,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[o].v.match(/[Hh]/)&&(x=1),x<2&&s[o].v.match(/[Mm]/)&&(x=2),x<3&&s[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var b="",F;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=nce(s[o].t.charCodeAt(0),s[o].v,A,g),s[o].t="t";break;case"n":case"?":for(F=o+1;s[F]!=null&&((l=s[F].t)==="?"||l==="D"||(l===" "||l==="t")&&s[F+1]!=null&&(s[F+1].t==="?"||s[F+1].t==="t"&&s[F+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[F].v==="/"||s[F].v===" "&&s[F+1]!=null&&s[F+1].t=="?"));)s[o].v+=s[F].v,s[F]={v:"",t:";"},++F;b+=s[o].v,o=F-1;break;case"G":s[o].t="t",s[o].v=Th(e,r);break}var P="",R,_;if(b.length>0){b.charCodeAt(0)==40?(R=e<0&&b.charCodeAt(0)===45?-e:e,_=pA("n",b,R)):(R=e<0&&n>1?-e:e,_=pA("n",b,R),R<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),F=_.length-1;var B=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){B=o;break}var E=s.length;if(B===s.length&&_.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(F>=s[o].v.length-1?(F-=s[o].v.length,s[o].v=_.substr(F+1,s[o].v.length)):F<0?s[o].v="":(s[o].v=_.substr(0,F+1),F=-1),s[o].t="t",E=o);F>=0&&E<s.length&&(s[E].v=_.substr(0,F+1)+s[E].v)}else if(B!==s.length&&_.indexOf("E")===-1){for(F=_.indexOf(".")-1,o=B;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===B?s[o].v.indexOf(".")-1:s[o].v.length-1,P=s[o].v.substr(u+1);u>=0;--u)F>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(P=_.charAt(F--)+P);s[o].v=P,s[o].t="t",E=o}for(F>=0&&E<s.length&&(s[E].v=_.substr(0,F+1)+s[E].v),F=_.indexOf(".")+1,o=B;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==B)){for(u=s[o].v.indexOf(".")>-1&&o===B?s[o].v.indexOf(".")+1:0,P=s[o].v.substr(0,u);u<s[o].v.length;++u)F<_.length&&(P+=_.charAt(F++));s[o].v=P,s[o].t="t",E=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(R=n>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=pA(s[o].t,s[o].v,R),s[o].t="t");var M="";for(o=0;o!==s.length;++o)s[o]!=null&&(M+=s[o].v);return M}var fP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function mP(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function fce(t,e){var r=dce(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(fP),l=r[1].match(fP);return mP(e,o)?[n,r[0]]:mP(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function ml(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Nr)[t],n==null&&(n=r.table&&r.table[uP[t]]||Nr[uP[t]]),n==null&&(n=Jle[t]||"General");break}if(Sy(n,0))return Th(e,r);e instanceof Date&&(e=o8(e,r.date1904));var s=fce(n,e);if(Sy(s[1]))return Th(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return hce(s[1],e,r,s[0])}function gA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Nr[r]==null){e<0&&(e=r);continue}if(Nr[r]==t){e=r;break}}e<0&&(e=391)}return Nr[e]=t,e}function $2(t){for(var e=0;e!=392;++e)t[e]!==void 0&&gA(t[e],e)}function cm(){Nr=Wle()}var mce={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},p8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pce(t){var e=typeof t=="number"?Nr[t]:t;return e=e.replace(p8,"(\\d+)"),new RegExp("^"+e+"$")}function gce(t,e,r){var n=-1,s=-1,a=-1,o=-1,l=-1,c=-1;(e.match(p8)||[]).forEach(function(d,f){var h=parseInt(r[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var A=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?A:n==-1&&s==-1&&a==-1?u:A+"T"+u}var xce=function(){var t={};t.version="1.2.0";function e(){for(var _=0,B=new Array(256),E=0;E!=256;++E)_=E,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,B[E]=_;return typeof Int32Array<"u"?new Int32Array(B):B}var r=e();function n(_){var B=0,E=0,M=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)k[M]=_[M];for(M=0;M!=256;++M)for(E=_[M],B=256+M;B<4096;B+=256)E=k[B]=E>>>8^_[E&255];var T=[];for(M=1;M!=16;++M)T[M-1]=typeof Int32Array<"u"?k.subarray(M*256,M*256+256):k.slice(M*256,M*256+256);return T}var s=n(r),a=s[0],o=s[1],l=s[2],c=s[3],A=s[4],u=s[5],d=s[6],f=s[7],h=s[8],m=s[9],p=s[10],x=s[11],g=s[12],y=s[13],b=s[14];function F(_,B){for(var E=B^-1,M=0,k=_.length;M<k;)E=E>>>8^r[(E^_.charCodeAt(M++))&255];return~E}function P(_,B){for(var E=B^-1,M=_.length-15,k=0;k<M;)E=b[_[k++]^E&255]^y[_[k++]^E>>8&255]^g[_[k++]^E>>16&255]^x[_[k++]^E>>>24]^p[_[k++]]^m[_[k++]]^h[_[k++]]^f[_[k++]]^d[_[k++]]^u[_[k++]]^A[_[k++]]^c[_[k++]]^l[_[k++]]^o[_[k++]]^a[_[k++]]^r[_[k++]];for(M+=15;k<M;)E=E>>>8^r[(E^_[k++])&255];return~E}function R(_,B){for(var E=B^-1,M=0,k=_.length,T=0,U=0;M<k;)T=_.charCodeAt(M++),T<128?E=E>>>8^r[(E^T)&255]:T<2048?(E=E>>>8^r[(E^(192|T>>6&31))&255],E=E>>>8^r[(E^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,U=_.charCodeAt(M++)&1023,E=E>>>8^r[(E^(240|T>>8&7))&255],E=E>>>8^r[(E^(128|T>>2&63))&255],E=E>>>8^r[(E^(128|U>>6&15|(T&3)<<4))&255],E=E>>>8^r[(E^(128|U&63))&255]):(E=E>>>8^r[(E^(224|T>>12&15))&255],E=E>>>8^r[(E^(128|T>>6&63))&255],E=E>>>8^r[(E^(128|T&63))&255]);return~E}return t.table=r,t.bstr=F,t.buf=P,t.str=R,t}(),vr=function(){var e={};e.version="1.2.1";function r(oe,ne){for(var ue=oe.split("/"),K=ne.split("/"),le=0,me=0,Re=Math.min(ue.length,K.length);le<Re;++le){if(me=ue[le].length-K[le].length)return me;if(ue[le]!=K[le])return ue[le]<K[le]?-1:1}return ue.length-K.length}function n(oe){if(oe.charAt(oe.length-1)=="/")return oe.slice(0,-1).indexOf("/")===-1?oe:n(oe.slice(0,-1));var ne=oe.lastIndexOf("/");return ne===-1?oe:oe.slice(0,ne+1)}function s(oe){if(oe.charAt(oe.length-1)=="/")return s(oe.slice(0,-1));var ne=oe.lastIndexOf("/");return ne===-1?oe:oe.slice(ne+1)}function a(oe,ne){typeof ne=="string"&&(ne=new Date(ne));var ue=ne.getHours();ue=ue<<6|ne.getMinutes(),ue=ue<<5|ne.getSeconds()>>>1,oe.write_shift(2,ue);var K=ne.getFullYear()-1980;K=K<<4|ne.getMonth()+1,K=K<<5|ne.getDate(),oe.write_shift(2,K)}function o(oe){var ne=oe.read_shift(2)&65535,ue=oe.read_shift(2)&65535,K=new Date,le=ue&31;ue>>>=5;var me=ue&15;ue>>>=4,K.setMilliseconds(0),K.setFullYear(ue+1980),K.setMonth(me-1),K.setDate(le);var Re=ne&31;ne>>>=5;var Ee=ne&63;return ne>>>=6,K.setHours(ne),K.setMinutes(Ee),K.setSeconds(Re<<1),K}function l(oe){Ha(oe,0);for(var ne={},ue=0;oe.l<=oe.length-4;){var K=oe.read_shift(2),le=oe.read_shift(2),me=oe.l+le,Re={};switch(K){case 21589:ue=oe.read_shift(1),ue&1&&(Re.mtime=oe.read_shift(4)),le>5&&(ue&2&&(Re.atime=oe.read_shift(4)),ue&4&&(Re.ctime=oe.read_shift(4))),Re.mtime&&(Re.mt=new Date(Re.mtime*1e3));break}oe.l=me,ne[K]=Re}return ne}var c;function A(){return c||(c={})}function u(oe,ne){if(oe[0]==80&&oe[1]==75)return at(oe,ne);if((oe[0]|32)==109&&(oe[1]|32)==105)return et(oe,ne);if(oe.length<512)throw new Error("CFB file size "+oe.length+" < 512");var ue=3,K=512,le=0,me=0,Re=0,Ee=0,ye=0,Me=[],Le=oe.slice(0,512);Ha(Le,0);var Je=d(Le);switch(ue=Je[0],ue){case 3:K=512;break;case 4:K=4096;break;case 0:if(Je[1]==0)return at(oe,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}K!==512&&(Le=oe.slice(0,K),Ha(Le,28));var tt=oe.slice(0,K);f(Le,ue);var Xe=Le.read_shift(4,"i");if(ue===3&&Xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Xe);Le.l+=4,Re=Le.read_shift(4,"i"),Le.l+=4,Le.chk("00100000","Mini Stream Cutoff Size: "),Ee=Le.read_shift(4,"i"),le=Le.read_shift(4,"i"),ye=Le.read_shift(4,"i"),me=Le.read_shift(4,"i");for(var Ze=-1,ut=0;ut<109&&(Ze=Le.read_shift(4,"i"),!(Ze<0));++ut)Me[ut]=Ze;var Ht=h(oe,K);x(ye,me,Ht,K,Me);var wr=y(Ht,Re,Me,K);wr[Re].name="!Directory",le>0&&Ee!==U&&(wr[Ee].name="!MiniFAT"),wr[Me[0]].name="!FAT",wr.fat_addrs=Me,wr.ssz=K;var ur={},Kr=[],$s=[],vi=[];b(Re,wr,Ht,Kr,le,ur,$s,Ee),m($s,vi,Kr),Kr.shift();var Ui={FileIndex:$s,FullPaths:vi};return ne&&ne.raw&&(Ui.raw={header:tt,sectors:Ht}),Ui}function d(oe){if(oe[oe.l]==80&&oe[oe.l+1]==75)return[0,0];oe.chk(Z,"Header Signature: "),oe.l+=16;var ne=oe.read_shift(2,"u");return[oe.read_shift(2,"u"),ne]}function f(oe,ne){var ue=9;switch(oe.l+=2,ue=oe.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}oe.chk("0600","Mini Sector Shift: "),oe.chk("000000000000","Reserved: ")}function h(oe,ne){for(var ue=Math.ceil(oe.length/ne)-1,K=[],le=1;le<ue;++le)K[le-1]=oe.slice(le*ne,(le+1)*ne);return K[ue-1]=oe.slice(ue*ne),K}function m(oe,ne,ue){for(var K=0,le=0,me=0,Re=0,Ee=0,ye=ue.length,Me=[],Le=[];K<ye;++K)Me[K]=Le[K]=K,ne[K]=ue[K];for(;Ee<Le.length;++Ee)K=Le[Ee],le=oe[K].L,me=oe[K].R,Re=oe[K].C,Me[K]===K&&(le!==-1&&Me[le]!==le&&(Me[K]=Me[le]),me!==-1&&Me[me]!==me&&(Me[K]=Me[me])),Re!==-1&&(Me[Re]=K),le!==-1&&K!=Me[K]&&(Me[le]=Me[K],Le.lastIndexOf(le)<Ee&&Le.push(le)),me!==-1&&K!=Me[K]&&(Me[me]=Me[K],Le.lastIndexOf(me)<Ee&&Le.push(me));for(K=1;K<ye;++K)Me[K]===K&&(me!==-1&&Me[me]!==me?Me[K]=Me[me]:le!==-1&&Me[le]!==le&&(Me[K]=Me[le]));for(K=1;K<ye;++K)if(oe[K].type!==0){if(Ee=K,Ee!=Me[Ee])do Ee=Me[Ee],ne[K]=ne[Ee]+"/"+ne[K];while(Ee!==0&&Me[Ee]!==-1&&Ee!=Me[Ee]);Me[K]=-1}for(ne[0]+="/",K=1;K<ye;++K)oe[K].type!==2&&(ne[K]+="/")}function p(oe,ne,ue){for(var K=oe.start,le=oe.size,me=[],Re=K;ue&&le>0&&Re>=0;)me.push(ne.slice(Re*T,Re*T+T)),le-=T,Re=Wd(ue,Re*4);return me.length===0?Ct(0):_a(me).slice(0,oe.size)}function x(oe,ne,ue,K,le){var me=U;if(oe===U){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(oe!==-1){var Re=ue[oe],Ee=(K>>>2)-1;if(!Re)return;for(var ye=0;ye<Ee&&(me=Wd(Re,ye*4))!==U;++ye)le.push(me);x(Wd(Re,K-4),ne-1,ue,K,le)}}function g(oe,ne,ue,K,le){var me=[],Re=[];le||(le=[]);var Ee=K-1,ye=0,Me=0;for(ye=ne;ye>=0;){le[ye]=!0,me[me.length]=ye,Re.push(oe[ye]);var Le=ue[Math.floor(ye*4/K)];if(Me=ye*4&Ee,K<4+Me)throw new Error("FAT boundary crossed: "+ye+" 4 "+K);if(!oe[Le])break;ye=Wd(oe[Le],Me)}return{nodes:me,data:BP([Re])}}function y(oe,ne,ue,K){var le=oe.length,me=[],Re=[],Ee=[],ye=[],Me=K-1,Le=0,Je=0,tt=0,Xe=0;for(Le=0;Le<le;++Le)if(Ee=[],tt=Le+ne,tt>=le&&(tt-=le),!Re[tt]){ye=[];var Ze=[];for(Je=tt;Je>=0;){Ze[Je]=!0,Re[Je]=!0,Ee[Ee.length]=Je,ye.push(oe[Je]);var ut=ue[Math.floor(Je*4/K)];if(Xe=Je*4&Me,K<4+Xe)throw new Error("FAT boundary crossed: "+Je+" 4 "+K);if(!oe[ut]||(Je=Wd(oe[ut],Xe),Ze[Je]))break}me[tt]={nodes:Ee,data:BP([ye])}}return me}function b(oe,ne,ue,K,le,me,Re,Ee){for(var ye=0,Me=K.length?2:0,Le=ne[oe].data,Je=0,tt=0,Xe;Je<Le.length;Je+=128){var Ze=Le.slice(Je,Je+128);Ha(Ze,64),tt=Ze.read_shift(2),Xe=fI(Ze,0,tt-Me),K.push(Xe);var ut={name:Xe,type:Ze.read_shift(1),color:Ze.read_shift(1),L:Ze.read_shift(4,"i"),R:Ze.read_shift(4,"i"),C:Ze.read_shift(4,"i"),clsid:Ze.read_shift(16),state:Ze.read_shift(4,"i"),start:0,size:0},Ht=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);Ht!==0&&(ut.ct=F(Ze,Ze.l-8));var wr=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);wr!==0&&(ut.mt=F(Ze,Ze.l-8)),ut.start=Ze.read_shift(4,"i"),ut.size=Ze.read_shift(4,"i"),ut.size<0&&ut.start<0&&(ut.size=ut.type=0,ut.start=U,ut.name=""),ut.type===5?(ye=ut.start,le>0&&ye!==U&&(ne[ye].name="!StreamData")):ut.size>=4096?(ut.storage="fat",ne[ut.start]===void 0&&(ne[ut.start]=g(ue,ut.start,ne.fat_addrs,ne.ssz)),ne[ut.start].name=ut.name,ut.content=ne[ut.start].data.slice(0,ut.size)):(ut.storage="minifat",ut.size<0?ut.size=0:ye!==U&&ut.start!==U&&ne[ye]&&(ut.content=p(ut,ne[ye].data,(ne[Ee]||{}).data))),ut.content&&Ha(ut.content,0),me[Xe]=ut,Re.push(ut)}}function F(oe,ne){return new Date((bo(oe,ne+4)/1e7*Math.pow(2,32)+bo(oe,ne)/1e7-11644473600)*1e3)}function P(oe,ne){return A(),u(c.readFileSync(oe),ne)}function R(oe,ne){var ue=ne&&ne.type;switch(ue||Vr&&Buffer.isBuffer(oe)&&(ue="buffer"),ue||"base64"){case"file":return P(oe,ne);case"base64":return u(No(To(oe)),ne);case"binary":return u(No(oe),ne)}return u(oe,ne)}function _(oe,ne){var ue=ne||{},K=ue.root||"Root Entry";if(oe.FullPaths||(oe.FullPaths=[]),oe.FileIndex||(oe.FileIndex=[]),oe.FullPaths.length!==oe.FileIndex.length)throw new Error("inconsistent CFB structure");oe.FullPaths.length===0&&(oe.FullPaths[0]=K+"/",oe.FileIndex[0]={name:K,type:5}),ue.CLSID&&(oe.FileIndex[0].clsid=ue.CLSID),B(oe)}function B(oe){var ne="Sh33tJ5";if(!vr.find(oe,"/"+ne)){var ue=Ct(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,oe.FileIndex.push({name:ne,type:2,content:ue,size:4,L:69,R:69,C:69}),oe.FullPaths.push(oe.FullPaths[0]+ne),E(oe)}}function E(oe,ne){_(oe);for(var ue=!1,K=!1,le=oe.FullPaths.length-1;le>=0;--le){var me=oe.FileIndex[le];switch(me.type){case 0:K?ue=!0:(oe.FileIndex.pop(),oe.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(me.R*me.L*me.C)&&(ue=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(ue=!0);break;default:ue=!0;break}}if(!(!ue&&!ne)){var Re=new Date(1987,1,19),Ee=0,ye=Object.create?Object.create(null):{},Me=[];for(le=0;le<oe.FullPaths.length;++le)ye[oe.FullPaths[le]]=!0,oe.FileIndex[le].type!==0&&Me.push([oe.FullPaths[le],oe.FileIndex[le]]);for(le=0;le<Me.length;++le){var Le=n(Me[le][0]);K=ye[Le],K||(Me.push([Le,{name:s(Le).replace("/",""),type:1,clsid:ae,ct:Re,mt:Re,content:null}]),ye[Le]=!0)}for(Me.sort(function(Xe,Ze){return r(Xe[0],Ze[0])}),oe.FullPaths=[],oe.FileIndex=[],le=0;le<Me.length;++le)oe.FullPaths[le]=Me[le][0],oe.FileIndex[le]=Me[le][1];for(le=0;le<Me.length;++le){var Je=oe.FileIndex[le],tt=oe.FullPaths[le];if(Je.name=s(tt).replace("/",""),Je.L=Je.R=Je.C=-(Je.color=1),Je.size=Je.content?Je.content.length:0,Je.start=0,Je.clsid=Je.clsid||ae,le===0)Je.C=Me.length>1?1:-1,Je.size=0,Je.type=5;else if(tt.slice(-1)=="/"){for(Ee=le+1;Ee<Me.length&&n(oe.FullPaths[Ee])!=tt;++Ee);for(Je.C=Ee>=Me.length?-1:Ee,Ee=le+1;Ee<Me.length&&n(oe.FullPaths[Ee])!=n(tt);++Ee);Je.R=Ee>=Me.length?-1:Ee,Je.type=1}else n(oe.FullPaths[le+1]||"")==n(tt)&&(Je.R=le+1),Je.type=2}}}function M(oe,ne){var ue=ne||{};if(ue.fileType=="mad")return gt(oe,ue);switch(E(oe),ue.fileType){case"zip":return ot(oe,ue)}var K=function(Xe){for(var Ze=0,ut=0,Ht=0;Ht<Xe.FileIndex.length;++Ht){var wr=Xe.FileIndex[Ht];if(wr.content){var ur=wr.content.length;ur>0&&(ur<4096?Ze+=ur+63>>6:ut+=ur+511>>9)}}for(var Kr=Xe.FullPaths.length+3>>2,$s=Ze+7>>3,vi=Ze+127>>7,Ui=$s+ut+Kr+vi,ga=Ui+127>>7,no=ga<=109?0:Math.ceil((ga-109)/127);Ui+ga+no+127>>7>ga;)no=++ga<=109?0:Math.ceil((ga-109)/127);var Dn=[1,no,ga,vi,Kr,ut,Ze,0];return Xe.FileIndex[0].size=Ze<<6,Dn[7]=(Xe.FileIndex[0].start=Dn[0]+Dn[1]+Dn[2]+Dn[3]+Dn[4]+Dn[5])+(Dn[6]+7>>3),Dn}(oe),le=Ct(K[7]<<9),me=0,Re=0;{for(me=0;me<8;++me)le.write_shift(1,pe[me]);for(me=0;me<8;++me)le.write_shift(2,0);for(le.write_shift(2,62),le.write_shift(2,3),le.write_shift(2,65534),le.write_shift(2,9),le.write_shift(2,6),me=0;me<3;++me)le.write_shift(2,0);for(le.write_shift(4,0),le.write_shift(4,K[2]),le.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),le.write_shift(4,0),le.write_shift(4,4096),le.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:U),le.write_shift(4,K[3]),le.write_shift(-4,K[1]?K[0]-1:U),le.write_shift(4,K[1]),me=0;me<109;++me)le.write_shift(-4,me<K[2]?K[1]+me:-1)}if(K[1])for(Re=0;Re<K[1];++Re){for(;me<236+Re*127;++me)le.write_shift(-4,me<K[2]?K[1]+me:-1);le.write_shift(-4,Re===K[1]-1?U:Re+1)}var Ee=function(Xe){for(Re+=Xe;me<Re-1;++me)le.write_shift(-4,me+1);Xe&&(++me,le.write_shift(-4,U))};for(Re=me=0,Re+=K[1];me<Re;++me)le.write_shift(-4,he.DIFSECT);for(Re+=K[2];me<Re;++me)le.write_shift(-4,he.FATSECT);Ee(K[3]),Ee(K[4]);for(var ye=0,Me=0,Le=oe.FileIndex[0];ye<oe.FileIndex.length;++ye)Le=oe.FileIndex[ye],Le.content&&(Me=Le.content.length,!(Me<4096)&&(Le.start=Re,Ee(Me+511>>9)));for(Ee(K[6]+7>>3);le.l&511;)le.write_shift(-4,he.ENDOFCHAIN);for(Re=me=0,ye=0;ye<oe.FileIndex.length;++ye)Le=oe.FileIndex[ye],Le.content&&(Me=Le.content.length,!(!Me||Me>=4096)&&(Le.start=Re,Ee(Me+63>>6)));for(;le.l&511;)le.write_shift(-4,he.ENDOFCHAIN);for(me=0;me<K[4]<<2;++me){var Je=oe.FullPaths[me];if(!Je||Je.length===0){for(ye=0;ye<17;++ye)le.write_shift(4,0);for(ye=0;ye<3;++ye)le.write_shift(4,-1);for(ye=0;ye<12;++ye)le.write_shift(4,0);continue}Le=oe.FileIndex[me],me===0&&(Le.start=Le.size?Le.start-1:U);var tt=me===0&&ue.root||Le.name;if(Me=2*(tt.length+1),le.write_shift(64,tt,"utf16le"),le.write_shift(2,Me),le.write_shift(1,Le.type),le.write_shift(1,Le.color),le.write_shift(-4,Le.L),le.write_shift(-4,Le.R),le.write_shift(-4,Le.C),Le.clsid)le.write_shift(16,Le.clsid,"hex");else for(ye=0;ye<4;++ye)le.write_shift(4,0);le.write_shift(4,Le.state||0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,Le.start),le.write_shift(4,Le.size),le.write_shift(4,0)}for(me=1;me<oe.FileIndex.length;++me)if(Le=oe.FileIndex[me],Le.size>=4096)if(le.l=Le.start+1<<9,Vr&&Buffer.isBuffer(Le.content))Le.content.copy(le,le.l,0,Le.size),le.l+=Le.size+511&-512;else{for(ye=0;ye<Le.size;++ye)le.write_shift(1,Le.content[ye]);for(;ye&511;++ye)le.write_shift(1,0)}for(me=1;me<oe.FileIndex.length;++me)if(Le=oe.FileIndex[me],Le.size>0&&Le.size<4096)if(Vr&&Buffer.isBuffer(Le.content))Le.content.copy(le,le.l,0,Le.size),le.l+=Le.size+63&-64;else{for(ye=0;ye<Le.size;++ye)le.write_shift(1,Le.content[ye]);for(;ye&63;++ye)le.write_shift(1,0)}if(Vr)le.l=le.length;else for(;le.l<le.length;)le.write_shift(1,0);return le}function k(oe,ne){var ue=oe.FullPaths.map(function(ye){return ye.toUpperCase()}),K=ue.map(function(ye){var Me=ye.split("/");return Me[Me.length-(ye.slice(-1)=="/"?2:1)]}),le=!1;ne.charCodeAt(0)===47?(le=!0,ne=ue[0].slice(0,-1)+ne):le=ne.indexOf("/")!==-1;var me=ne.toUpperCase(),Re=le===!0?ue.indexOf(me):K.indexOf(me);if(Re!==-1)return oe.FileIndex[Re];var Ee=!me.match(Np);for(me=me.replace(Pi,""),Ee&&(me=me.replace(Np,"!")),Re=0;Re<ue.length;++Re)if((Ee?ue[Re].replace(Np,"!"):ue[Re]).replace(Pi,"")==me||(Ee?K[Re].replace(Np,"!"):K[Re]).replace(Pi,"")==me)return oe.FileIndex[Re];return null}var T=64,U=-2,Z="d0cf11e0a1b11ae1",pe=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:Z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function de(oe,ne,ue){A();var K=M(oe,ue);c.writeFileSync(ne,K)}function re(oe){for(var ne=new Array(oe.length),ue=0;ue<oe.length;++ue)ne[ue]=String.fromCharCode(oe[ue]);return ne.join("")}function xe(oe,ne){var ue=M(oe,ne);switch(ne&&ne.type||"buffer"){case"file":return A(),c.writeFileSync(ne.filename,ue),ue;case"binary":return typeof ue=="string"?ue:re(ue);case"base64":return Jg(typeof ue=="string"?ue:re(ue));case"buffer":if(Vr)return Buffer.isBuffer(ue)?ue:TA(ue);case"array":return typeof ue=="string"?No(ue):ue}return ue}var Ce;function S(oe){try{var ne=oe.InflateRaw,ue=new ne;if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),ue.bytesRead)Ce=oe;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function I(oe,ne){if(!Ce)return Te(oe,ne);var ue=Ce.InflateRaw,K=new ue,le=K._processChunk(oe.slice(oe.l),K._finishFlushFlag);return oe.l+=K.bytesRead,le}function V(oe){return Ce?Ce.deflateRawSync(oe):_e(oe)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(oe){var ne=(oe<<1|oe<<11)&139536|(oe<<5|oe<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var Y=typeof Uint8Array<"u",se=Y?new Uint8Array(256):[],ve=0;ve<256;++ve)se[ve]=D(ve);function z(oe,ne){var ue=se[oe&255];return ne<=8?ue>>>8-ne:(ue=ue<<8|se[oe>>8&255],ne<=16?ue>>>16-ne:(ue=ue<<8|se[oe>>16&255],ue>>>24-ne))}function Oe(oe,ne){var ue=ne&7,K=ne>>>3;return(oe[K]|(ue<=6?0:oe[K+1]<<8))>>>ue&3}function te(oe,ne){var ue=ne&7,K=ne>>>3;return(oe[K]|(ue<=5?0:oe[K+1]<<8))>>>ue&7}function J(oe,ne){var ue=ne&7,K=ne>>>3;return(oe[K]|(ue<=4?0:oe[K+1]<<8))>>>ue&15}function q(oe,ne){var ue=ne&7,K=ne>>>3;return(oe[K]|(ue<=3?0:oe[K+1]<<8))>>>ue&31}function ie(oe,ne){var ue=ne&7,K=ne>>>3;return(oe[K]|(ue<=1?0:oe[K+1]<<8))>>>ue&127}function fe(oe,ne,ue){var K=ne&7,le=ne>>>3,me=(1<<ue)-1,Re=oe[le]>>>K;return ue<8-K||(Re|=oe[le+1]<<8-K,ue<16-K)||(Re|=oe[le+2]<<16-K,ue<24-K)||(Re|=oe[le+3]<<24-K),Re&me}function Ie(oe,ne,ue){var K=ne&7,le=ne>>>3;return K<=5?oe[le]|=(ue&7)<<K:(oe[le]|=ue<<K&255,oe[le+1]=(ue&7)>>8-K),ne+3}function Ve(oe,ne,ue){var K=ne&7,le=ne>>>3;return ue=(ue&1)<<K,oe[le]|=ue,ne+1}function ze(oe,ne,ue){var K=ne&7,le=ne>>>3;return ue<<=K,oe[le]|=ue&255,ue>>>=8,oe[le+1]=ue,ne+8}function Ye(oe,ne,ue){var K=ne&7,le=ne>>>3;return ue<<=K,oe[le]|=ue&255,ue>>>=8,oe[le+1]=ue&255,oe[le+2]=ue>>>8,ne+16}function ct(oe,ne){var ue=oe.length,K=2*ue>ne?2*ue:ne+5,le=0;if(ue>=ne)return oe;if(Vr){var me=lP(K);if(oe.copy)oe.copy(me);else for(;le<oe.length;++le)me[le]=oe[le];return me}else if(Y){var Re=new Uint8Array(K);if(Re.set)Re.set(oe);else for(;le<ue;++le)Re[le]=oe[le];return Re}return oe.length=K,oe}function st(oe){for(var ne=new Array(oe),ue=0;ue<oe;++ue)ne[ue]=0;return ne}function ft(oe,ne,ue){var K=1,le=0,me=0,Re=0,Ee=0,ye=oe.length,Me=Y?new Uint16Array(32):st(32);for(me=0;me<32;++me)Me[me]=0;for(me=ye;me<ue;++me)oe[me]=0;ye=oe.length;var Le=Y?new Uint16Array(ye):st(ye);for(me=0;me<ye;++me)Me[le=oe[me]]++,K<le&&(K=le),Le[me]=0;for(Me[0]=0,me=1;me<=K;++me)Me[me+16]=Ee=Ee+Me[me-1]<<1;for(me=0;me<ye;++me)Ee=oe[me],Ee!=0&&(Le[me]=Me[Ee+16]++);var Je=0;for(me=0;me<ye;++me)if(Je=oe[me],Je!=0)for(Ee=z(Le[me],K)>>K-Je,Re=(1<<K+4-Je)-1;Re>=0;--Re)ne[Ee|Re<<Je]=Je&15|me<<4;return K}var nt=Y?new Uint16Array(512):st(512),De=Y?new Uint16Array(32):st(32);if(!Y){for(var Fe=0;Fe<512;++Fe)nt[Fe]=0;for(Fe=0;Fe<32;++Fe)De[Fe]=0}(function(){for(var oe=[],ne=0;ne<32;ne++)oe.push(5);ft(oe,De,32);var ue=[];for(ne=0;ne<=143;ne++)ue.push(8);for(;ne<=255;ne++)ue.push(9);for(;ne<=279;ne++)ue.push(7);for(;ne<=287;ne++)ue.push(8);ft(ue,nt,288)})();var Ge=function(){for(var ne=Y?new Uint8Array(32768):[],ue=0,K=0;ue<W.length-1;++ue)for(;K<W[ue+1];++K)ne[K]=ue;for(;K<32768;++K)ne[K]=29;var le=Y?new Uint8Array(259):[];for(ue=0,K=0;ue<O.length-1;++ue)for(;K<O[ue+1];++K)le[K]=ue;function me(Ee,ye){for(var Me=0;Me<Ee.length;){var Le=Math.min(65535,Ee.length-Me),Je=Me+Le==Ee.length;for(ye.write_shift(1,+Je),ye.write_shift(2,Le),ye.write_shift(2,~Le&65535);Le-- >0;)ye[ye.l++]=Ee[Me++]}return ye.l}function Re(Ee,ye){for(var Me=0,Le=0,Je=Y?new Uint16Array(32768):[];Le<Ee.length;){var tt=Math.min(65535,Ee.length-Le);if(tt<10){for(Me=Ie(ye,Me,+(Le+tt==Ee.length)),Me&7&&(Me+=8-(Me&7)),ye.l=Me/8|0,ye.write_shift(2,tt),ye.write_shift(2,~tt&65535);tt-- >0;)ye[ye.l++]=Ee[Le++];Me=ye.l*8;continue}Me=Ie(ye,Me,+(Le+tt==Ee.length)+2);for(var Xe=0;tt-- >0;){var Ze=Ee[Le];Xe=(Xe<<5^Ze)&32767;var ut=-1,Ht=0;if((ut=Je[Xe])&&(ut|=Le&-32768,ut>Le&&(ut-=32768),ut<Le))for(;Ee[ut+Ht]==Ee[Le+Ht]&&Ht<250;)++Ht;if(Ht>2){Ze=le[Ht],Ze<=22?Me=ze(ye,Me,se[Ze+1]>>1)-1:(ze(ye,Me,3),Me+=5,ze(ye,Me,se[Ze-23]>>5),Me+=3);var wr=Ze<8?0:Ze-4>>2;wr>0&&(Ye(ye,Me,Ht-O[Ze]),Me+=wr),Ze=ne[Le-ut],Me=ze(ye,Me,se[Ze]>>3),Me-=3;var ur=Ze<4?0:Ze-2>>1;ur>0&&(Ye(ye,Me,Le-ut-W[Ze]),Me+=ur);for(var Kr=0;Kr<Ht;++Kr)Je[Xe]=Le&32767,Xe=(Xe<<5^Ee[Le])&32767,++Le;tt-=Ht-1}else Ze<=143?Ze=Ze+48:Me=Ve(ye,Me,1),Me=ze(ye,Me,se[Ze]),Je[Xe]=Le&32767,++Le}Me=ze(ye,Me,0)-1}return ye.l=(Me+7)/8|0,ye.l}return function(ye,Me){return ye.length<8?me(ye,Me):Re(ye,Me)}}();function _e(oe){var ne=Ct(50+Math.floor(oe.length*1.1)),ue=Ge(oe,ne);return ne.slice(0,ue)}var G=Y?new Uint16Array(32768):st(32768),Ne=Y?new Uint16Array(32768):st(32768),Ue=Y?new Uint16Array(128):st(128),$e=1,ge=1;function Be(oe,ne){var ue=q(oe,ne)+257;ne+=5;var K=q(oe,ne)+1;ne+=5;var le=J(oe,ne)+4;ne+=4;for(var me=0,Re=Y?new Uint8Array(19):st(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,Me=Y?new Uint8Array(8):st(8),Le=Y?new Uint8Array(8):st(8),Je=Re.length,tt=0;tt<le;++tt)Re[j[tt]]=me=te(oe,ne),ye<me&&(ye=me),Me[me]++,ne+=3;var Xe=0;for(Me[0]=0,tt=1;tt<=ye;++tt)Le[tt]=Xe=Xe+Me[tt-1]<<1;for(tt=0;tt<Je;++tt)(Xe=Re[tt])!=0&&(Ee[tt]=Le[Xe]++);var Ze=0;for(tt=0;tt<Je;++tt)if(Ze=Re[tt],Ze!=0){Xe=se[Ee[tt]]>>8-Ze;for(var ut=(1<<7-Ze)-1;ut>=0;--ut)Ue[Xe|ut<<Ze]=Ze&7|tt<<3}var Ht=[];for(ye=1;Ht.length<ue+K;)switch(Xe=Ue[ie(oe,ne)],ne+=Xe&7,Xe>>>=3){case 16:for(me=3+Oe(oe,ne),ne+=2,Xe=Ht[Ht.length-1];me-- >0;)Ht.push(Xe);break;case 17:for(me=3+te(oe,ne),ne+=3;me-- >0;)Ht.push(0);break;case 18:for(me=11+ie(oe,ne),ne+=7;me-- >0;)Ht.push(0);break;default:Ht.push(Xe),ye<Xe&&(ye=Xe);break}var wr=Ht.slice(0,ue),ur=Ht.slice(ue);for(tt=ue;tt<286;++tt)wr[tt]=0;for(tt=K;tt<30;++tt)ur[tt]=0;return $e=ft(wr,G,286),ge=ft(ur,Ne,30),ne}function Qe(oe,ne){if(oe[0]==3&&!(oe[1]&3))return[id(ne),2];for(var ue=0,K=0,le=lP(ne||1<<18),me=0,Re=le.length>>>0,Ee=0,ye=0;!(K&1);){if(K=te(oe,ue),ue+=3,K>>>1)K>>1==1?(Ee=9,ye=5):(ue=Be(oe,ue),Ee=$e,ye=ge);else{ue&7&&(ue+=8-(ue&7));var Me=oe[ue>>>3]|oe[(ue>>>3)+1]<<8;if(ue+=32,Me>0)for(!ne&&Re<me+Me&&(le=ct(le,me+Me),Re=le.length);Me-- >0;)le[me++]=oe[ue>>>3],ue+=8;continue}for(;;){!ne&&Re<me+32767&&(le=ct(le,me+32767),Re=le.length);var Le=fe(oe,ue,Ee),Je=K>>>1==1?nt[Le]:G[Le];if(ue+=Je&15,Je>>>=4,!(Je>>>8&255))le[me++]=Je;else{if(Je==256)break;Je-=257;var tt=Je<8?0:Je-4>>2;tt>5&&(tt=0);var Xe=me+O[Je];tt>0&&(Xe+=fe(oe,ue,tt),ue+=tt),Le=fe(oe,ue,ye),Je=K>>>1==1?De[Le]:Ne[Le],ue+=Je&15,Je>>>=4;var Ze=Je<4?0:Je-2>>1,ut=W[Je];for(Ze>0&&(ut+=fe(oe,ue,Ze),ue+=Ze),!ne&&Re<Xe&&(le=ct(le,Xe+100),Re=le.length);me<Xe;)le[me]=le[me-ut],++me}}}return ne?[le,ue+7>>>3]:[le.slice(0,me),ue+7>>>3]}function Te(oe,ne){var ue=oe.slice(oe.l||0),K=Qe(ue,ne);return oe.l+=K[1],K[0]}function We(oe,ne){if(oe)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function at(oe,ne){var ue=oe;Ha(ue,0);var K=[],le=[],me={FileIndex:K,FullPaths:le};_(me,{root:ne.root});for(var Re=ue.length-4;(ue[Re]!=80||ue[Re+1]!=75||ue[Re+2]!=5||ue[Re+3]!=6)&&Re>=0;)--Re;ue.l=Re+4,ue.l+=4;var Ee=ue.read_shift(2);ue.l+=6;var ye=ue.read_shift(4);for(ue.l=ye,Re=0;Re<Ee;++Re){ue.l+=20;var Me=ue.read_shift(4),Le=ue.read_shift(4),Je=ue.read_shift(2),tt=ue.read_shift(2),Xe=ue.read_shift(2);ue.l+=8;var Ze=ue.read_shift(4),ut=l(ue.slice(ue.l+Je,ue.l+Je+tt));ue.l+=Je+tt+Xe;var Ht=ue.l;ue.l=Ze+4,bt(ue,Me,Le,me,ut),ue.l=Ht}return me}function bt(oe,ne,ue,K,le){oe.l+=2;var me=oe.read_shift(2),Re=oe.read_shift(2),Ee=o(oe);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var ye=oe.read_shift(4),Me=oe.read_shift(4),Le=oe.read_shift(4),Je=oe.read_shift(2),tt=oe.read_shift(2),Xe="",Ze=0;Ze<Je;++Ze)Xe+=String.fromCharCode(oe[oe.l++]);if(tt){var ut=l(oe.slice(oe.l,oe.l+tt));(ut[21589]||{}).mt&&(Ee=ut[21589].mt),((le||{})[21589]||{}).mt&&(Ee=le[21589].mt)}oe.l+=tt;var Ht=oe.slice(oe.l,oe.l+Me);switch(Re){case 8:Ht=I(oe,Le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Re)}var wr=!1;me&8&&(ye=oe.read_shift(4),ye==134695760&&(ye=oe.read_shift(4),wr=!0),Me=oe.read_shift(4),Le=oe.read_shift(4)),Me!=ne&&We(wr,"Bad compressed size: "+ne+" != "+Me),Le!=ue&&We(wr,"Bad uncompressed size: "+ue+" != "+Le),Ft(K,Xe,Ht,{unsafe:!0,mt:Ee})}function ot(oe,ne){var ue=ne||{},K=[],le=[],me=Ct(1),Re=ue.compression?8:0,Ee=0,ye=0,Me=0,Le=0,Je=0,tt=oe.FullPaths[0],Xe=tt,Ze=oe.FileIndex[0],ut=[],Ht=0;for(ye=1;ye<oe.FullPaths.length;++ye)if(Xe=oe.FullPaths[ye].slice(tt.length),Ze=oe.FileIndex[ye],!(!Ze.size||!Ze.content||Xe=="Sh33tJ5")){var wr=Le,ur=Ct(Xe.length);for(Me=0;Me<Xe.length;++Me)ur.write_shift(1,Xe.charCodeAt(Me)&127);ur=ur.slice(0,ur.l),ut[Je]=xce.buf(Ze.content,0);var Kr=Ze.content;Re==8&&(Kr=V(Kr)),me=Ct(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,Ee),me.write_shift(2,Re),Ze.mt?a(me,Ze.mt):me.write_shift(4,0),me.write_shift(-4,ut[Je]),me.write_shift(4,Kr.length),me.write_shift(4,Ze.content.length),me.write_shift(2,ur.length),me.write_shift(2,0),Le+=me.length,K.push(me),Le+=ur.length,K.push(ur),Le+=Kr.length,K.push(Kr),me=Ct(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,Ee),me.write_shift(2,Re),me.write_shift(4,0),me.write_shift(-4,ut[Je]),me.write_shift(4,Kr.length),me.write_shift(4,Ze.content.length),me.write_shift(2,ur.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,wr),Ht+=me.l,le.push(me),Ht+=ur.length,le.push(ur),++Je}return me=Ct(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,Je),me.write_shift(2,Je),me.write_shift(4,Ht),me.write_shift(4,Le),me.write_shift(2,0),_a([_a(K),_a(le),me])}var wt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lt(oe,ne){if(oe.ctype)return oe.ctype;var ue=oe.name||"",K=ue.match(/\.([^\.]+)$/);return K&&wt[K[1]]||ne&&(K=(ue=ne).match(/[\.\\]([^\.\\])+$/),K&&wt[K[1]])?wt[K[1]]:"application/octet-stream"}function Ar(oe){for(var ne=Jg(oe),ue=[],K=0;K<ne.length;K+=76)ue.push(ne.slice(K,K+76));return ue.join(`\r
`)+`\r
`}function ir(oe){var ne=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Me){var Le=Me.charCodeAt(0).toString(16).toUpperCase();return"="+(Le.length==1?"0"+Le:Le)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ue=[],K=ne.split(`\r
`),le=0;le<K.length;++le){var me=K[le];if(me.length==0){ue.push("");continue}for(var Re=0;Re<me.length;){var Ee=76,ye=me.slice(Re,Re+Ee);ye.charAt(Ee-1)=="="?Ee--:ye.charAt(Ee-2)=="="?Ee-=2:ye.charAt(Ee-3)=="="&&(Ee-=3),ye=me.slice(Re,Re+Ee),Re+=Ee,Re<me.length&&(ye+="="),ue.push(ye)}}return ue.join(`\r
`)}function xr(oe){for(var ne=[],ue=0;ue<oe.length;++ue){for(var K=oe[ue];ue<=oe.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+oe[++ue];ne.push(K)}for(var le=0;le<ne.length;++le)ne[le]=ne[le].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return No(ne.join(`\r
`))}function er(oe,ne,ue){for(var K="",le="",me="",Re,Ee=0;Ee<10;++Ee){var ye=ne[Ee];if(!ye||ye.match(/^\s*$/))break;var Me=ye.match(/^(.*?):\s*([^\s].*)$/);if(Me)switch(Me[1].toLowerCase()){case"content-location":K=Me[2].trim();break;case"content-type":me=Me[2].trim();break;case"content-transfer-encoding":le=Me[2].trim();break}}switch(++Ee,le.toLowerCase()){case"base64":Re=No(To(ne.slice(Ee).join("")));break;case"quoted-printable":Re=xr(ne.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+le)}var Le=Ft(oe,K.slice(ue.length),Re,{unsafe:!0});me&&(Le.ctype=me)}function et(oe,ne){if(re(oe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ue=ne&&ne.root||"",K=(Vr&&Buffer.isBuffer(oe)?oe.toString("binary"):re(oe)).split(`\r
`),le=0,me="";for(le=0;le<K.length;++le)if(me=K[le],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),ue||(ue=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=ue.slice(0,ue.length-1),ue=ue.slice(0,ue.lastIndexOf("/")+1),me.slice(0,ue.length)!=ue););var Re=(K[1]||"").match(/boundary="(.*?)"/);if(!Re)throw new Error("MAD cannot find boundary");var Ee="--"+(Re[1]||""),ye=[],Me=[],Le={FileIndex:ye,FullPaths:Me};_(Le);var Je,tt=0;for(le=0;le<K.length;++le){var Xe=K[le];Xe!==Ee&&Xe!==Ee+"--"||(tt++&&er(Le,K.slice(Je,le),ue),Je=le)}return Le}function gt(oe,ne){var ue=ne||{},K=ue.boundary||"SheetJS";K="------="+K;for(var le=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],me=oe.FullPaths[0],Re=me,Ee=oe.FileIndex[0],ye=1;ye<oe.FullPaths.length;++ye)if(Re=oe.FullPaths[ye].slice(me.length),Ee=oe.FileIndex[ye],!(!Ee.size||!Ee.content||Re=="Sh33tJ5")){Re=Re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ht){return"_x"+Ht.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ht){return"_u"+Ht.charCodeAt(0).toString(16)+"_"});for(var Me=Ee.content,Le=Vr&&Buffer.isBuffer(Me)?Me.toString("binary"):re(Me),Je=0,tt=Math.min(1024,Le.length),Xe=0,Ze=0;Ze<=tt;++Ze)(Xe=Le.charCodeAt(Ze))>=32&&Xe<128&&++Je;var ut=Je>=tt*4/5;le.push(K),le.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+Re),le.push("Content-Transfer-Encoding: "+(ut?"quoted-printable":"base64")),le.push("Content-Type: "+Lt(Ee,Re)),le.push(""),le.push(ut?ir(Le):Ar(Le))}return le.push(K+`--\r
`),le.join(`\r
`)}function Pt(oe){var ne={};return _(ne,oe),ne}function Ft(oe,ne,ue,K){var le=K&&K.unsafe;le||_(oe);var me=!le&&vr.find(oe,ne);if(!me){var Re=oe.FullPaths[0];ne.slice(0,Re.length)==Re?Re=ne:(Re.slice(-1)!="/"&&(Re+="/"),Re=(Re+ne).replace("//","/")),me={name:s(ne),type:2},oe.FileIndex.push(me),oe.FullPaths.push(Re),le||vr.utils.cfb_gc(oe)}return me.content=ue,me.size=ue?ue.length:0,K&&(K.CLSID&&(me.clsid=K.CLSID),K.mt&&(me.mt=K.mt),K.ct&&(me.ct=K.ct)),me}function Tt(oe,ne){_(oe);var ue=vr.find(oe,ne);if(ue){for(var K=0;K<oe.FileIndex.length;++K)if(oe.FileIndex[K]==ue)return oe.FileIndex.splice(K,1),oe.FullPaths.splice(K,1),!0}return!1}function Xt(oe,ne,ue){_(oe);var K=vr.find(oe,ne);if(K){for(var le=0;le<oe.FileIndex.length;++le)if(oe.FileIndex[le]==K)return oe.FileIndex[le].name=s(ue),oe.FullPaths[le]=ue,!0}return!1}function Vt(oe){E(oe,!0)}return e.find=k,e.read=R,e.parse=u,e.write=xe,e.writeFile=de,e.utils={cfb_new:Pt,cfb_add:Ft,cfb_del:Tt,cfb_mov:Xt,cfb_gc:Vt,ReadShift:Zp,CheckField:U8,prep_blob:Ha,bconcat:_a,use_zlib:S,_deflateRaw:_e,_inflateRaw:Te,consts:he},e}();function vce(t){return typeof t=="string"?G2(t):Array.isArray(t)?qle(t):t}function Ux(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=G2(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?xc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([vce(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=xd(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function wce(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ts(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function pP(t,e){for(var r=[],n=Ts(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function z2(t){for(var e=[],r=Ts(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function W2(t){for(var e=[],r=Ts(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function yce(t){for(var e=[],r=Ts(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Fy=new Date(1899,11,30,0,0,0);function ma(t,e){var r=t.getTime(),n=Fy.getTime()+(t.getTimezoneOffset()-Fy.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var g8=new Date,bce=Fy.getTime()+(g8.getTimezoneOffset()-Fy.getTimezoneOffset())*6e4,gP=g8.getTimezoneOffset();function J2(t){var e=new Date;return e.setTime(t*24*60*60*1e3+bce),e.getTimezoneOffset()!==gP&&e.setTime(e.getTime()+(e.getTimezoneOffset()-gP)*6e4),e}function Nce(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var xP=new Date("2017-02-19T19:06:09.000Z"),x8=isNaN(xP.getFullYear())?new Date("2/19/17"):xP,Cce=x8.getFullYear()==2017;function es(t,e){var r=new Date(t);if(Cce)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(x8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function jh(t,e){if(Vr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return xc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return xc(a8(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return xc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return xc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function ts(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ts(t[r]));return e}function Is(t,e){for(var r="";r.length<e;)r+=t;return r}function Ul(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var _ce=["january","february","march","april","may","june","july","august","september","october","november","december"];function V0(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&_ce.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Ece=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(s),o.push(a[l]);return o}}();function v8(t){return t?t.content&&t.type?jh(t.content,!0):t.data?bp(t.data):t.asNodeBuffer&&Vr?bp(t.asNodeBuffer().toString("binary")):t.asBinary?bp(t.asBinary()):t._data&&t._data.getContent?bp(jh(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function w8(t){if(!t)return null;if(t.data)return iP(t.data);if(t.asNodeBuffer&&Vr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?iP(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Bce(t){return t&&t.name.slice(-4)===".bin"?w8(t):v8(t)}function el(t,e){for(var r=t.FullPaths||Ts(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function lI(t,e){var r=el(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Js(t,e,r){if(!r)return Bce(lI(t,e));if(!e)return null;try{return Js(t,e)}catch{return null}}function Co(t,e,r){if(!r)return v8(lI(t,e));if(!e)return null;try{return Co(t,e)}catch{return null}}function Sce(t,e,r){return w8(lI(t,e))}function vP(t){for(var e=t.FullPaths||Ts(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Mr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Vr?n=TA(r):n=Gle(r),vr.utils.cfb_add(t,e,n)}vr.utils.cfb_add(t,e,r)}else t.file(e,r)}function cI(){return vr.utils.cfb_new()}function y8(t,e){switch(e.type){case"base64":return vr.read(t,{type:"base64"});case"binary":return vr.read(t,{type:"binary"});case"buffer":case"array":return vr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Cp(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Gs=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Ice=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Fce=/<[^>]*>/g,xi=Gs.match(wP)?wP:Fce,kce=/<\w*:/,Tce=/<(\/?)\w+:/;function Er(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var o=t.match(Ice),l=0,c="",A=0,u="",d="",f=1;if(o)for(A=0;A!=o.length;++A){for(d=o[A],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(u=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(f=(s=d.charCodeAt(a+1))==34||s==39?1:0,c=d.slice(a+1+f,d.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[h]&&u.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function kc(t){return t.replace(Tce,"<$1")}var b8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},AI=z2(b8),An=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(l,c){return b8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,o)+r(s.slice(o+3))}}(),uI=/[&<>'"]/g,jce=/[\u0000-\u0008\u000b-\u001f]/g;function Fn(t){var e=t+"";return e.replace(uI,function(r){return AI[r]}).replace(jce,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function yP(t){return Fn(t).replace(/ /g,"_x0020_")}var N8=/[\u0000-\u001f]/g;function dI(t){var e=t+"";return e.replace(uI,function(r){return AI[r]}).replace(/\n/g,"<br/>").replace(N8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Pce(t){var e=t+"";return e.replace(uI,function(r){return AI[r]}).replace(N8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var bP=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Rce(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Xn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ZN(t){for(var e="",r=0,n=0,s=0,a=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function NP(t){var e=id(2*t.length),r,n,s=1,a=0,o=0,l;for(n=0;n<t.length;n+=s)s=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function CP(t){return TA(t,"binary").toString("utf8")}var N1="foo bar baz",Pn=Vr&&(CP(N1)==ZN(N1)&&CP||NP(N1)==ZN(N1)&&NP)||ZN,xc=Vr?function(t){return TA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Yg=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),C8=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),Dce=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Lce=/<\/?(?:vt:)?variant>/g,Uce=/<(?:vt:)([^>]*)>([\s\S]*)</;function _P(t,e){var r=Er(t),n=t.match(Dce(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var o=a.replace(Lce,"").match(Uce);o&&s.push({v:Pn(o[2]),t:o[1]})}),s}var _8=/(^\s|\s$|\n)/;function qa(t,e){return"<"+t+(e.match(_8)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Zg(t){return Ts(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function zt(t,e,r){return"<"+t+(r!=null?Zg(r):"")+(e!=null?(e.match(_8)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function BE(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Oce(t,e){switch(typeof t){case"string":var r=zt("vt:lpwstr",Fn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return zt((t|0)==t?"vt:i4":"vt:r8",Fn(String(t)));case"boolean":return zt("vt:bool",t?"true":"false")}if(t instanceof Date)return zt("vt:filetime",BE(t));throw new Error("Unable to serialize "+t)}function hI(t){if(Vr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Pn(xd(aI(t)));throw new Error("Bad input format: expected Buffer or string")}var ex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ua={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Jh=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],yo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mce(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Qce(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,o=n?-e:e;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var l=0;l<=5;++l,a/=256)t[r+l]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var EP=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},BP=Vr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:TA(e)})):EP(t)}:EP,SP=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(lA(t,s)));return n.join("").replace(Pi,"")},fI=Vr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Pi,""):SP(t,e,r)}:SP,IP=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},E8=Vr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):IP(t,e,r)}:IP,FP=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Gf(t,s)));return n.join("")},Ox=Vr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):FP(e,r,n)}:FP,B8=function(t,e){var r=bo(t,e);return r>0?Ox(t,e+4,e+4+r-1):""},S8=B8,I8=function(t,e){var r=bo(t,e);return r>0?Ox(t,e+4,e+4+r-1):""},F8=I8,k8=function(t,e){var r=2*bo(t,e);return r>0?Ox(t,e+4,e+4+r-1):""},T8=k8,j8=function(e,r){var n=bo(e,r);return n>0?fI(e,r+4,r+4+n):""},P8=j8,R8=function(t,e){var r=bo(t,e);return r>0?Ox(t,e+4,e+4+r):""},D8=R8,L8=function(t,e){return Mce(t,e)},ky=L8,mI=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Vr&&(S8=function(e,r){if(!Buffer.isBuffer(e))return B8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},F8=function(e,r){if(!Buffer.isBuffer(e))return I8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},T8=function(e,r){if(!Buffer.isBuffer(e))return k8(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},P8=function(e,r){if(!Buffer.isBuffer(e))return j8(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},D8=function(e,r){if(!Buffer.isBuffer(e))return R8(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ky=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):L8(e,r)},mI=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Gf=function(t,e){return t[e]},lA=function(t,e){return t[e+1]*256+t[e]},Vce=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},bo=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Wd=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Hce=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Zp(t,e){var r="",n,s,a=[],o,l,c,A;switch(e){case"dbcs":if(A=this.l,Vr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(lA(this,A)),A+=2;t*=2;break;case"utf8":r=Ox(this,this.l,this.l+t);break;case"utf16le":t*=2,r=fI(this,this.l,this.l+t);break;case"wstr":return Zp.call(this,t,"dbcs");case"lpstr-ansi":r=S8(this,this.l),t=4+bo(this,this.l);break;case"lpstr-cp":r=F8(this,this.l),t=4+bo(this,this.l);break;case"lpwstr":r=T8(this,this.l),t=4+2*bo(this,this.l);break;case"lpp4":t=4+bo(this,this.l),r=P8(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+bo(this,this.l),r=D8(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Gf(this,this.l+t++))!==0;)a.push(b1(o));r=a.join("");break;case"_wstr":for(t=0,r="";(o=lA(this,this.l+t))!==0;)a.push(b1(o)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",A=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=Gf(this,A),this.l=A+1,l=Zp.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(b1(lA(this,A))),A+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",A=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=Gf(this,A),this.l=A+1,l=Zp.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(b1(Gf(this,A))),A+=1}r=a.join("");break;default:switch(t){case 1:return n=Gf(this,this.l),this.l++,n;case 2:return n=(e==="i"?Vce:lA)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Wd:Hce)(this,this.l),this.l+=4,n):(s=bo(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=ky(this,this.l):s=ky([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=E8(this,this.l,t);break}}return this.l+=t,r}var Kce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},qce=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Gce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function $ce(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)Gce(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Kce(this,e,this.l);break;case 8:if(n=8,r==="f"){Qce(this,e,this.l);break}case 16:break;case-4:n=4,qce(this,e,this.l);break}return this.l+=n,this}function U8(t,e){var r=E8(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Ha(t,e){t.l=e,t.read_shift=Zp,t.chk=U8,t.write_shift=$ce}function gi(t,e){t.l+=e}function Ct(t){var e=id(t);return Ha(e,0),e}function jA(t,e,r){if(t){var n,s,a;Ha(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var A=ix[l]||ix[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;c=t.l+a;var u=A.f&&A.f(t,a,r);if(t.l=c,e(u,A,l))return}}}function eo(){var t=[],e=Vr?256:2048,r=function(A){var u=Ct(A);return Ha(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(A){return n&&A<n.length-n.l?n:(s(),n=r(Math.max(A+1,e)))},o=function(){return s(),_a(t)},l=function(A){s(),n=A,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:l,end:o,_bufs:t}}function Rt(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=ix[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=t.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&mI(r)&&t.push(r)}}function eg(t,e,r){var n=ts(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function kP(t,e,r){var n=ts(t);return n.s=eg(n.s,e.s,r),n.e=eg(n.e,e.s,r),n}function tg(t,e){if(t.cRel&&t.c<0)for(t=ts(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ts(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Cr(t);return!t.cRel&&t.cRel!=null&&(r=Jce(r)),!t.rRel&&t.rRel!=null&&(r=zce(r)),r}function eC(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+vs(t.s.c)+":"+(t.e.cRel?"":"$")+vs(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ks(t.s.r)+":"+(t.e.rRel?"":"$")+Ks(t.e.r):tg(t.s,e.biff)+":"+tg(t.e,e.biff)}function pI(t){return parseInt(Wce(t),10)-1}function Ks(t){return""+(t+1)}function zce(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Wce(t){return t.replace(/\$(\d+)$/,"$1")}function gI(t){for(var e=Xce(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function vs(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Jce(t){return t.replace(/^([A-Z])/,"$$$1")}function Xce(t){return t.replace(/^\$([A-Z])/,"$1")}function Yce(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ws(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Cr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function to(t){var e=t.indexOf(":");return e==-1?{s:ws(t),e:ws(t)}:{s:ws(t.slice(0,e)),e:ws(t.slice(e+1))}}function Dr(t,e){return typeof e>"u"||typeof e=="number"?Dr(t.s,t.e):(typeof t!="string"&&(t=Cr(t)),typeof e!="string"&&(e=Cr(e)),t==e?t:t+":"+e)}function dn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function TP(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ml(t.z,r?ma(e):e)}catch{}try{return t.w=ml((t.XF||{}).numFmtId||(r?14:0),r?ma(e):e)}catch{return""+e}}function SA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?PA[t.v]||t.v:e==null?TP(t,t.v):TP(t,e))}function vd(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function O8(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ws(n.origin):n.origin;o=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=dn(a["!ref"]);A.s.c=u.s.c,A.s.r=u.s.r,A.e.c=Math.max(A.e.c,u.e.c),A.e.r=Math.max(A.e.r,u.e.r),o==-1&&(A.e.r=o=u.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[d].length;++f)if(!(typeof e[d][f]>"u")){var h={v:e[d][f]},m=o+d,p=l+f;if(A.s.r>m&&(A.s.r=m),A.s.c>p&&(A.s.c=p),A.e.r<m&&(A.e.r=m),A.e.c<p&&(A.e.c=p),e[d][f]&&typeof e[d][f]=="object"&&!Array.isArray(e[d][f])&&!(e[d][f]instanceof Date))h=e[d][f];else if(Array.isArray(h.v)&&(h.f=e[d][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Nr[14],n.cellDates?(h.t="d",h.w=ml(h.z,ma(h.v))):(h.t="n",h.v=ma(h.v),h.w=ml(h.z,h.v))):h.t="s";if(s)a[m]||(a[m]=[]),a[m][p]&&a[m][p].z&&(h.z=a[m][p].z),a[m][p]=h;else{var x=Cr({c:p,r:m});a[x]&&a[x].z&&(h.z=a[x].z),a[x]=h}}}return A.s.c<1e7&&(a["!ref"]=Dr(A)),a}function Am(t,e){return O8(null,t,e)}function Zce(t){return t.read_shift(4,"i")}function Ol(t,e){return e||(e=Ct(4)),e.write_shift(4,t),e}function mi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ea(t,e){var r=!1;return e==null&&(r=!0,e=Ct(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function eAe(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function tAe(t,e){return e||(e=Ct(4)),e.write_shift(2,0),e.write_shift(2,0),e}function xI(t,e){var r=t.l,n=t.read_shift(1),s=mi(t),a=[],o={t:s,h:s};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)a.push(eAe(t));o.r=a}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function rAe(t,e){var r=!1;return e==null&&(r=!0,e=Ct(15+4*t.t.length)),e.write_shift(1,0),Ea(t.t,e),r?e.slice(0,e.l):e}var nAe=xI;function sAe(t,e){var r=!1;return e==null&&(r=!0,e=Ct(23+4*t.t.length)),e.write_shift(1,1),Ea(t.t,e),e.write_shift(4,1),tAe({},e),r?e.slice(0,e.l):e}function pl(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Xh(t,e){return e==null&&(e=Ct(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Yh(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Zh(t,e){return e==null&&(e=Ct(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var aAe=mi,M8=Ea;function vI(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Ty(t,e){var r=!1;return e==null&&(r=!0,e=Ct(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var iAe=mi,SE=vI,wI=Ty;function yI(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?ky([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Wd(e,0)>>2;return r?s/100:s}function Q8(t,e){e==null&&(e=Ct(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function V8(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function oAe(t,e){return e||(e=Ct(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ef=V8,um=oAe;function fi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ph(t,e){return(e||Ct(8)).write_shift(8,t,"f")}function lAe(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var A=dh[s];A&&(e.rgb=rx(A));break;case 2:e.rgb=rx([o,l,c]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function jy(t,e){if(e||(e=Ct(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function cAe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function AAe(t,e){e||(e=Ct(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function H8(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function uAe(t){return H8(t,1)}function dAe(t){return H8(t,2)}var bI=2,qi=3,C1=11,jP=12,Py=19,_1=64,hAe=65,fAe=71,mAe=4108,pAe=4126,Na=80,K8=81,gAe=[Na,K8],IE={1:{n:"CodePage",t:bI},2:{n:"Category",t:Na},3:{n:"PresentationFormat",t:Na},4:{n:"ByteCount",t:qi},5:{n:"LineCount",t:qi},6:{n:"ParagraphCount",t:qi},7:{n:"SlideCount",t:qi},8:{n:"NoteCount",t:qi},9:{n:"HiddenCount",t:qi},10:{n:"MultimediaClipCount",t:qi},11:{n:"ScaleCrop",t:C1},12:{n:"HeadingPairs",t:mAe},13:{n:"TitlesOfParts",t:pAe},14:{n:"Manager",t:Na},15:{n:"Company",t:Na},16:{n:"LinksUpToDate",t:C1},17:{n:"CharacterCount",t:qi},19:{n:"SharedDoc",t:C1},22:{n:"HyperlinksChanged",t:C1},23:{n:"AppVersion",t:qi,p:"version"},24:{n:"DigSig",t:hAe},26:{n:"ContentType",t:Na},27:{n:"ContentStatus",t:Na},28:{n:"Language",t:Na},29:{n:"Version",t:Na},255:{},2147483648:{n:"Locale",t:Py},2147483651:{n:"Behavior",t:Py},1919054434:{}},FE={1:{n:"CodePage",t:bI},2:{n:"Title",t:Na},3:{n:"Subject",t:Na},4:{n:"Author",t:Na},5:{n:"Keywords",t:Na},6:{n:"Comments",t:Na},7:{n:"Template",t:Na},8:{n:"LastAuthor",t:Na},9:{n:"RevNumber",t:Na},10:{n:"EditTime",t:_1},11:{n:"LastPrinted",t:_1},12:{n:"CreatedDate",t:_1},13:{n:"ModifiedDate",t:_1},14:{n:"PageCount",t:qi},15:{n:"WordCount",t:qi},16:{n:"CharCount",t:qi},17:{n:"Thumbnail",t:fAe},18:{n:"Application",t:Na},19:{n:"DocSecurity",t:qi},255:{},2147483648:{n:"Locale",t:Py},2147483651:{n:"Behavior",t:Py},1919054434:{}},PP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xAe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vAe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var wAe=vAe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),dh=ts(wAe),PA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},q8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},kE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},E1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function NI(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yAe(t){var e=NI();if(!t||!t.match)return e;var r={};if((t.match(xi)||[]).forEach(function(n){var s=Er(n);switch(s[0].replace(kce,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[kE[s.ContentType]]!==void 0&&e[kE[s.ContentType]].push(s.PartName);break}}),e.xmlns!==ua.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function G8(t,e){var r=yce(kE),n=[],s;n[n.length]=Gs,n[n.length]=zt("Types",null,{xmlns:ua.CT,"xmlns:xsd":ua.xsd,"xmlns:xsi":ua.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return zt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(s=t[c][0],n[n.length]=zt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:E1[c][e.bookType]||E1[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(A){n[n.length]=zt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:E1[c][e.bookType]||E1[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(A){n[n.length]=zt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:r[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $r={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tx(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function rg(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(xi)||[]).forEach(function(s){var a=Er(s);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Cp(a.Target,e);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}function w0(t){var e=[Gs,zt("Relationships",null,{xmlns:ua.RELS})];return Ts(t["!id"]).forEach(function(r){e[e.length]=zt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Bn(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[$r.HLINK,$r.XPATH,$r.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var bAe="application/vnd.oasis.opendocument.spreadsheet";function NAe(t,e){for(var r=hI(t),n,s;n=ex.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Er(n[0],!1),s.path=="/"&&s.type!==bAe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function CAe(t){var e=[Gs];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function RP(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function _Ae(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function EAe(t){var e=[Gs];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(RP(t[r][0],t[r][1])),e.push(_Ae("",t[r][0]));return e.push(RP("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function $8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ey.version+"</meta:generator></office:meta></office:document-meta>"}var ul=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],BAe=function(){for(var t=new Array(ul.length),e=0;e<ul.length;++e){var r=ul[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function z8(t){var e={};t=Pn(t);for(var r=0;r<ul.length;++r){var n=ul[r],s=t.match(BAe[r]);s!=null&&s.length>0&&(e[n[1]]=An(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=es(e[n[1]]))}return e}function tC(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Fn(e),n[n.length]=r?zt(t,e,r):qa(t,e))}function W8(t,e){var r=e||{},n=[Gs,zt("cp:coreProperties",null,{"xmlns:cp":ua.CORE_PROPS,"xmlns:dc":ua.dc,"xmlns:dcterms":ua.dcterms,"xmlns:dcmitype":ua.dcmitype,"xmlns:xsi":ua.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&tC("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:BE(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&tC("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:BE(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=ul.length;++a){var o=ul[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&tC(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var hh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],J8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function X8(t,e,r,n){var s=[];if(typeof t=="string")s=_P(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(u){return{v:u}}));var o=typeof e=="string"?_P(e,n).map(function(u){return u.v}):e,l=0,c=0;if(o.length>0)for(var A=0;A!==s.length;A+=2){switch(c=+s[A+1].v,s[A].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function SAe(t,e,r){var n={};return e||(e={}),t=Pn(t),hh.forEach(function(s){var a=(t.match(Yg(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=An(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var o=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&X8(n.HeadingPairs,n.TitlesOfParts,e,r),e}function Y8(t){var e=[],r=zt;return t||(t={}),t.Application="SheetJS",e[e.length]=Gs,e[e.length]=zt("Properties",null,{xmlns:ua.EXT_PROPS,"xmlns:vt":ua.vt}),hh.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Fn(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Fn(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var IAe=/<[^>]+>[^<]*/g;function FAe(t,e){var r={},n="",s=t.match(IAe);if(s)for(var a=0;a!=s.length;++a){var o=s[a],l=Er(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=An(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),A=c[0].slice(4),u=c[1];switch(A){case"lpstr":case"bstr":case"lpwstr":r[n]=An(u);break;case"bool":r[n]=Xn(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=es(u);break;case"cy":case"error":r[n]=An(u);break;default:if(A.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,A,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function Z8(t){var e=[Gs,zt("Properties",null,{xmlns:ua.CUST_PROPS,"xmlns:vt":ua.vt})];if(!t)return e.join("");var r=1;return Ts(t).forEach(function(s){++r,e[e.length]=zt("property",Oce(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Fn(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var TE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rC;function kAe(t,e,r){rC||(rC=z2(TE)),e=rC[e]||e,t[e]=r}function TAe(t,e){var r=[];return Ts(TE).map(function(n){for(var s=0;s<ul.length;++s)if(ul[s][1]==n)return ul[s];for(s=0;s<hh.length;++s)if(hh[s][1]==n)return hh[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(qa(TE[n[1]]||n[1],s))}}),zt("DocumentProperties",r.join(""),{xmlns:yo.o})}function jAe(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&Ts(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var o=0;o<ul.length;++o)if(a==ul[o][1])return;for(o=0;o<hh.length;++o)if(a==hh[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=t[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(zt(yP(a),l,{"dt:dt":c}))}}),e&&Ts(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(zt(yP(a),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+yo.o+'">'+s.join("")+"</"+n+">"}function CI(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function PAe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=Ct(8);return o.write_shift(4,n),o.write_shift(4,s),o}function eQ(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function tQ(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function rQ(t,e,r){return e===31?tQ(t):eQ(t,e,r)}function jE(t,e,r){return rQ(t,e,r===!1?0:4)}function RAe(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return rQ(t,e,0)}function DAe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Pi,""),t.l-s&2&&(t.l+=2)}return r}function LAe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Pi,"");return r}function UAe(t){var e=t.l,r=Ry(t,K8);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Ry(t,qi);return[r,n]}function OAe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(UAe(t));return r}function DP(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),o=t.read_shift(4);n[a]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Pi,"").replace(Np,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function nQ(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function MAe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Ry(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==jP&&n!==e&&gAe.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===jP?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return eQ(t,n,4).replace(Pi,"");case 31:return tQ(t);case 64:return CI(t);case 65:return nQ(t);case 71:return MAe(t);case 80:return jE(t,n,!a.raw).replace(Pi,"");case 81:return RAe(t,n).replace(Pi,"");case 4108:return OAe(t);case 4126:case 4127:return n==4127?DAe(t):LAe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function LP(t,e){var r=Ct(4),n=Ct(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ct(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=PAe(e);break;case 31:case 80:for(n=Ct(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return _a([r,n])}function UP(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],o=0,l=0,c=-1,A={};for(o=0;o!=s;++o){var u=t.read_shift(4),d=t.read_shift(4);a[o]=[u,d+r]}a.sort(function(y,b){return y[1]-b[1]});var f={};for(o=0;o!=s;++o){if(t.l!==a[o][1]){var h=!0;if(o>0&&e)switch(e[a[o-1][0]].t){case 2:t.l+2===a[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=a[o][1]&&(t.l=a[o][1],h=!1);break;case 4108:t.l<=a[o][1]&&(t.l=a[o][1],h=!1);break}if((!e||o==0)&&t.l<=a[o][1]&&(h=!1,t.l=a[o][1]),h)throw new Error("Read Error: Expected address "+a[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[a[o][0]];if(f[m.n]=Ry(t,m.t,{raw:!0}),m.p==="version"&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(f[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:jl(l=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(a[o][0]===1){if(l=f.CodePage=Ry(t,bI),jl(l),c!==-1){var p=t.l;t.l=a[c][1],A=DP(t,l),t.l=p}}else if(a[o][0]===0){if(l===0){c=o,t.l=a[o+1][1];continue}A=DP(t,l)}else{var x=A[a[o][0]],g;switch(t[t.l]){case 65:t.l+=4,g=nQ(t);break;case 30:t.l+=4,g=jE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,g=jE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,g=t.read_shift(4,"i");break;case 19:t.l+=4,g=t.read_shift(4);break;case 5:t.l+=4,g=t.read_shift(8,"f");break;case 11:t.l+=4,g=Us(t,4);break;case 64:t.l+=4,g=es(CI(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[x]=g}}return t.l=r+n,f}var sQ=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function QAe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function OP(t,e,r){var n=Ct(8),s=[],a=[],o=8,l=0,c=Ct(8),A=Ct(8);if(c.write_shift(4,2),c.write_shift(4,1200),A.write_shift(4,1),a.push(c),s.push(A),o+=8+c.length,!e){A=Ct(8),A.write_shift(4,0),s.unshift(A);var u=[Ct(4)];for(u[0].write_shift(4,t.length),l=0;l<t.length;++l){var d=t[l][0];for(c=Ct(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=_a(u),a.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(sQ.indexOf(t[l][0])>-1||J8.indexOf(t[l][0])>-1)&&t[l][1]!=null){var f=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}c=LP(m.t,f)}else{var x=QAe(f);x==-1&&(x=31,f=String(f)),c=LP(x,f)}a.push(c),A=Ct(8),A.write_shift(4,e?h:2+l),s.push(A),o+=8+c.length}var g=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,g),g+=a[l].length;return n.write_shift(4,o),n.write_shift(4,a.length),_a([n].concat(s).concat(a))}function MP(t,e,r){var n=t.content;if(!n)return{};Ha(n,0);var s,a,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var A=n.read_shift(4),u=n.read_shift(16);if(u!==vr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var d=UP(n,e),f={SystemIdentifier:A};for(var h in d)f[h]=d[h];if(f.FMTID=a,s===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=UP(n,null)}catch{}for(h in m)f[h]=m[h];return f.FMTID=[a,o],f}function QP(t,e,r,n,s,a){var o=Ct(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,vr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var c=OP(t,r,n);if(l.push(c),s){var A=OP(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),l.push(A)}return _a(l)}function ou(t,e){return t.read_shift(e),null}function VAe(t,e){e||(e=Ct(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function HAe(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Us(t,e){return t.read_shift(e)===1}function Fi(t,e){return e||(e=Ct(2)),e.write_shift(2,+!!t),e}function Xs(t){return t.read_shift(2,"u")}function tl(t,e){return e||(e=Ct(2)),e.write_shift(2,t),e}function aQ(t,e){return HAe(t,e,Xs)}function KAe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function iQ(t,e,r){return r||(r=Ct(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Mx(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?t.read_shift(n,s):"";return o}function qAe(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),o=0,l,c={};s&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var A=a==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,A);return s&&(t.l+=4*o),n&&(t.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function GAe(t){var e=t.t||"",r=Ct(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ct(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return _a(s)}function Rh(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Qx(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Rh(t,n,r)}function tf(t,e,r){if(r.biff>5)return Qx(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function oQ(t,e,r){return r||(r=Ct(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function $Ae(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function zAe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Pi,"");return n&&(t.l+=24),s}function WAe(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(a>>1,"utf16le").replace(Pi,"");return r+o}function JAe(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return zAe(t);case"0303000000000000c000000000000046":return WAe(t);default:throw new Error("Unsupported Moniker "+r)}}function B1(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Pi,""):"";return r}function VP(t,e){e||(e=Ct(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function XAe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,o,l,c,A="",u,d;s&16&&(a=B1(t,r-t.l)),s&128&&(o=B1(t,r-t.l)),(s&257)===257&&(l=B1(t,r-t.l)),(s&257)===1&&(c=JAe(t,r-t.l)),s&8&&(A=B1(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(d=CI(t)),t.l=r;var f=o||l||c||"";f&&A&&(f+="#"+A),f||(f="#"+A),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),d&&(h.time=d),a&&(h.Tooltip=a),h}function YAe(t){var e=Ct(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(a==28)n=n.slice(1),VP(n,e);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),a&8&&VP(s>-1?n.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function lQ(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function cQ(t,e){var r=lQ(t);return r[3]=0,r}function Tc(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Dh(t,e,r,n){return n||(n=Ct(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function ZAe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function eue(t,e,r){return e===0?"":tf(t,e,r)}function tue(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[s,a,o]}function AQ(t){var e=t.read_shift(2),r=yI(t);return[e,r]}function rue(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Mx(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function X2(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function uQ(t,e){return e||(e=Ct(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function dQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var nue=dQ;function hQ(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function sue(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function aue(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function ai(t){t.l+=2,t.l+=t.read_shift(2)}var iue={0:ai,4:ai,5:ai,6:ai,7:aue,8:ai,9:ai,10:ai,11:ai,12:ai,13:sue,14:ai,15:ai,16:ai,17:ai,18:ai,19:ai,20:ai,21:hQ};function oue(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(iue[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function S1(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function _I(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Ct(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function lue(t,e){return e===0||t.read_shift(2),1200}function cue(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=tf(t,0,r);return t.read_shift(e+n-t.l),s}function Aue(t,e){var r=!e||e.biff==8,n=Ct(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function uue(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function due(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=Mx(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:a,name:o}}function hue(t,e){var r=!e||e.biff>=8?2:1,n=Ct(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function fue(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],o=0;o!=s&&t.l<r;++o)a.push(qAe(t));return a.Count=n,a.Unique=s,a}function mue(t,e){var r=Ct(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=GAe(t[s]);var a=_a([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function pue(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function gue(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function xue(t){var e=ZAe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function vue(t){return t.read_shift(2),t.read_shift(4)}function HP(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function wue(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),A=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:o,FirstTab:l,Selected:c,TabRatio:A}}function yue(){var t=Ct(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function bue(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function Nue(t){var e=Ct(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Cue(){}function _ue(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Mx(t,0,r),n}function Eue(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=Ct(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function Bue(t){var e=Tc(t);return e.isst=t.read_shift(4),e}function Sue(t,e,r,n){var s=Ct(10);return Dh(t,e,n,s),s.write_shift(4,r),s}function Iue(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Tc(t);r.biff==2&&t.l++;var a=Qx(t,n-t.l,r);return s.val=a,s}function Fue(t,e,r,n,s){var a=!s||s.biff==8,o=Ct(8+ +a+(1+a)*r.length);return Dh(t,e,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function kue(t,e,r){var n=t.read_shift(2),s=tf(t,0,r);return[n,s]}function Tue(t,e,r,n){var s=r&&r.biff==5;n||(n=Ct(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var jue=tf;function KP(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:a,c:l},e:{r:o,c}}}function Pue(t,e){var r=e.biff==8||!e.biff?4:2,n=Ct(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Rue(t){var e=t.read_shift(2),r=t.read_shift(2),n=AQ(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function Due(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(AQ(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(a.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:a}}function Lue(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(a.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:a}}function Uue(t,e,r,n){var s={},a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return s.patternType=xAe[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function Oue(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=Uue(t,e,n.fStyle,r),n}function qP(t,e,r,n){var s=r&&r.biff==5;n||(n=Ct(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Mue(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Que(t){var e=Ct(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function GP(t,e,r){var n=Tc(t);(r.biff==2||e==9)&&++t.l;var s=KAe(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Vue(t,e,r,n,s,a){var o=Ct(8);return Dh(t,e,n,o),iQ(r,a,o),o}function Hue(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Tc(t),s=fi(t);return n.val=s,n}function Kue(t,e,r,n){var s=Ct(14);return Dh(t,e,n,s),Ph(r,s),s}var $P=eue;function que(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Rh(t,a),l=[];n>t.l;)l.push(Qx(t));return[a,s,o,l]}function zP(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=rue(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var Gue=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function WP(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var A=Rh(t,o,r);s&32&&(A=Gue[A.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var d=n==t.l||l===0||!(u>0)?[]:ome(t,u,r,l);return{chKey:a,Name:A,itab:c,rgce:d}}function fQ(t,e,r){if(r.biff<8)return $ue(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(tue(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function $ue(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Mx(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function zue(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=Rh(t,n,r),o=Rh(t,s,r);return[a,o]}function Wue(t,e,r){var n=dQ(t);t.l++;var s=t.read_shift(1);return e-=8,[lme(t,e,r),s,n]}function JP(t,e,r){var n=nue(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,ame(t,e,r)]}function Jue(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Xue(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=tf(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},l,o,a]}}function Yue(t,e,r){return Xue(t,e,r)}function Zue(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(X2(t));return r}function ede(t){var e=Ct(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)uQ(t[r],e);return e}function tde(t,e,r){if(r&&r.biff<8)return nde(t,e,r);var n=hQ(t),s=oue(t,e-22,n[1]);return{cmo:n,ft:s}}var rde={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function nde(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((rde[n]||gi)(t,e,r)),{cmo:[s,n,a],ft:o}}function sde(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:o=$Ae(t,6,r);var l=t.read_shift(2);t.read_shift(2),Xs(t,2);var c=t.read_shift(2);t.l+=c;for(var A=1;A<t.lens.length-1;++A){if(t.l-n!=t.lens[A])throw new Error("TxO: bad continue record");var u=t[t.l],d=Rh(t,t.lens[A+1]-t.lens[A]-1);if(s+=d,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function ade(t,e){var r=X2(t);t.l+=16;var n=XAe(t,e-24);return[r,n]}function ide(t){var e=Ct(24),r=ws(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return _a([e,YAe(t[1])])}function ode(t,e){t.read_shift(2);var r=X2(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Pi,""),[r,n]}function lde(t){var e=t[1].Tooltip,r=Ct(10+2*(e.length+1));r.write_shift(2,2048);var n=ws(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function cde(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=PP[r]||r,r=t.read_shift(2),e[1]=PP[r]||r,e}function Ade(t){return t||(t=Ct(4)),t.write_shift(2,1),t.write_shift(2,1),t}function ude(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cQ(t));return r}function dde(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cQ(t));return r}function hde(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function mQ(t,e,r){if(!r.cellStyles)return gi(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var A={s,e:a,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(A.level=c>>8&7),A}function fde(t,e){var r=Ct(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function mde(t,e){var r={};return e<32||(t.l+=16,r.header=fi(t),r.footer=fi(t),t.l+=2),r}function pde(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function gde(t){for(var e=Ct(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var xde=Tc,vde=aQ,wde=Qx;function yde(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function bde(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Tc(t);++t.l;var s=tf(t,e-7,r);return n.t="str",n.val=s,n}function Nde(t){var e=Tc(t);++t.l;var r=fi(t);return e.t="n",e.val=r,e}function Cde(t,e,r){var n=Ct(15);return qx(n,t,e),n.write_shift(8,r,"f"),n}function _de(t){var e=Tc(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Ede(t,e,r){var n=Ct(9);return qx(n,t,e),n.write_shift(2,r),n}function Bde(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Sde(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function Ide(t,e,r){var n=t.l+e,s=Tc(t),a=t.read_shift(2),o=Rh(t,a,r);return t.l=n,s.t="str",s.val=o,s}var Fde=[2,3,48,49,131,139,140,245],PE=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=z2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var A=[],u=id(1);switch(c.type){case"base64":u=No(To(l));break;case"binary":u=No(l);break;case"buffer":case"array":u=l;break}Ha(u,0);var d=u.read_shift(1),f=!!(d&136),h=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,x=521;d==2&&(p=u.read_shift(2)),u.l+=3,d!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(x=u.read_shift(2));var g=u.read_shift(2),y=c.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=t[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var b=[],F={},P=Math.min(u.length,d==2?521:x-10-(h?264:0)),R=m?32:11;u.l<P&&u[u.l]!=13;)switch(F={},F.name=Wg.utils.decode(y,u.slice(u.l,u.l+R)).replace(/[\u0000\r\n].*$/g,""),u.l+=R,F.type=String.fromCharCode(u.read_shift(1)),d!=2&&!m&&(F.offset=u.read_shift(4)),F.len=u.read_shift(1),d==2&&(F.offset=u.read_shift(2)),F.dec=u.read_shift(1),F.name.length&&b.push(F),d!=2&&(u.l+=m?13:14),F.type){case"B":(!h||F.len!=8)&&c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var _=0,B=0;for(A[0]=[],B=0;B!=b.length;++B)A[0][B]=b[B].name;for(;p-- >0;){if(u[u.l]===42){u.l+=g;continue}for(++u.l,A[++_]=[],B=0,B=0;B!=b.length;++B){var E=u.slice(u.l,u.l+b[B].len);u.l+=b[B].len,Ha(E,0);var M=Wg.utils.decode(y,E);switch(b[B].type){case"C":M.trim().length&&(A[_][B]=M.replace(/\s+$/,""));break;case"D":M.length===8?A[_][B]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):A[_][B]=M;break;case"F":A[_][B]=parseFloat(M.trim());break;case"+":case"I":A[_][B]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":A[_][B]=!0;break;case"N":case"F":A[_][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));A[_][B]="##MEMO##"+(m?parseInt(M.trim(),10):E.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(A[_][B]=+M||0);break;case"@":A[_][B]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":A[_][B]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":A[_][B]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[_][B]=-E.read_shift(-8,"f");break;case"B":if(h&&b[B].len==8){A[_][B]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[B].len;break;case"0":if(b[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[B].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(A=A.slice(0,c.sheetRows)),c.DBF=b,A}function n(l,c){var A=c||{};A.dateNF||(A.dateNF="yyyymmdd");var u=Am(r(l,A),A);return u["!cols"]=A.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete A.DBF,u}function s(l,c){try{return vd(n(l,c),c)}catch(A){if(c&&c.WTF)throw A}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var A=c||{};if(+A.codepage>=0&&jl(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var u=eo(),d=Uy(l,{header:1,raw:!0,cellDates:!0}),f=d[0],h=d.slice(1),m=l["!cols"]||[],p=0,x=0,g=0,y=1;for(p=0;p<f.length;++p){if(((m[p]||{}).DBF||{}).name){f[p]=m[p].DBF.name,++g;continue}if(f[p]!=null){if(++g,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(x=0;x<1024;++x)if(f.indexOf(f[p]+"_"+x)==-1){f[p]+="_"+x;break}}}}var b=dn(l["!ref"]),F=[],P=[],R=[];for(p=0;p<=b.e.c-b.s.c;++p){var _="",B="",E=0,M=[];for(x=0;x<h.length;++x)h[x][p]!=null&&M.push(h[x][p]);if(M.length==0||f[p]==null){F[p]="?";continue}for(x=0;x<M.length;++x){switch(typeof M[x]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=M[x]instanceof Date?"D":"C";break;default:B="C"}E=Math.max(E,String(M[x]).length),_=_&&_!=B?"C":B}E>250&&(E=250),B=((m[p]||{}).DBF||{}).type,B=="C"&&m[p].DBF.len>E&&(E=m[p].DBF.len),_=="B"&&B=="N"&&(_="N",R[p]=m[p].DBF.dec,E=m[p].DBF.len),P[p]=_=="C"||B=="N"?E:a[_]||0,y+=P[p],F[p]=_}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*g),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[s8]||3)<<8),p=0,x=0;p<f.length;++p)if(f[p]!=null){var T=u.next(32),U=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,U,"sbcs"),T.write_shift(1,F[p]=="?"?"C":F[p],"sbcs"),T.write_shift(4,x),T.write_shift(1,P[p]||a[F[p]]||0),T.write_shift(1,R[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),x+=P[p]||a[F[p]]||0}var Z=u.next(264);for(Z.write_shift(4,13),p=0;p<65;++p)Z.write_shift(4,0);for(p=0;p<h.length;++p){var pe=u.next(y);for(pe.write_shift(1,0),x=0;x<f.length;++x)if(f[x]!=null)switch(F[x]){case"L":pe.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":pe.write_shift(8,h[p][x]||0,"f");break;case"N":var ae="0";for(typeof h[p][x]=="number"&&(ae=h[p][x].toFixed(R[x]||0)),g=0;g<P[x]-ae.length;++g)pe.write_shift(1,32);pe.write_shift(1,ae,"sbcs");break;case"D":h[p][x]?(pe.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),pe.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),pe.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):pe.write_shift(8,"00000000","sbcs");break;case"C":var he=String(h[p][x]!=null?h[p][x]:"").slice(0,P[x]);for(pe.write_shift(1,he,"sbcs"),g=0;g<P[x]-he.length;++g)pe.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),pQ=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ts(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var m=t[h];return typeof m=="number"?oP(m):m},n=function(f,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?f:oP(p)};t["|"]=254;function s(f,h){switch(h.type){case"base64":return a(To(f),h);case"binary":return a(f,h);case"buffer":return a(Vr&&Buffer.isBuffer(f)?f.toString("binary"):xd(f),h);case"array":return a(jh(f),h)}throw new Error("Unrecognized type "+h.type)}function a(f,h){var m=f.split(/[\n\r]+/),p=-1,x=-1,g=0,y=0,b=[],F=[],P=null,R={},_=[],B=[],E=[],M=0,k;for(+h.codepage>=0&&jl(+h.codepage);g!==m.length;++g){M=0;var T=m[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),U=T.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),Z=U[0],pe;if(T.length>0)switch(Z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&F.push(T.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,he=!1,de=!1,re=!1,xe=-1,Ce=-1;for(y=1;y<U.length;++y)switch(U[y].charAt(0)){case"A":break;case"X":x=parseInt(U[y].slice(1))-1,he=!0;break;case"Y":for(p=parseInt(U[y].slice(1))-1,he||(x=0),k=b.length;k<=p;++k)b[k]=[];break;case"K":pe=U[y].slice(1),pe.charAt(0)==='"'?pe=pe.slice(1,pe.length-1):pe==="TRUE"?pe=!0:pe==="FALSE"?pe=!1:isNaN(Ul(pe))?isNaN(V0(pe).getDate())||(pe=es(pe)):(pe=Ul(pe),P!==null&&lm(P)&&(pe=J2(pe))),ae=!0;break;case"E":re=!0;var S=y0(U[y].slice(1),{r:p,c:x});b[p][x]=[b[p][x],S];break;case"S":de=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":xe=parseInt(U[y].slice(1))-1;break;case"C":Ce=parseInt(U[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(ae&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=pe:b[p][x]=pe,P=null),de){if(re)throw new Error("SYLK shared formula cannot have own formula");var I=xe>-1&&b[xe][Ce];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=PQ(I[1],{r:p-xe,c:x-Ce})}break;case"F":var V=0;for(y=1;y<U.length;++y)switch(U[y].charAt(0)){case"X":x=parseInt(U[y].slice(1))-1,++V;break;case"Y":for(p=parseInt(U[y].slice(1))-1,k=b.length;k<=p;++k)b[k]=[];break;case"M":M=parseInt(U[y].slice(1))/20;break;case"F":break;case"G":break;case"P":P=F[parseInt(U[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=U[y].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)M=parseInt(E[2],10),B[k-1]=M===0?{hidden:!0}:{wch:M},od(B[k-1]);break;case"C":x=parseInt(U[y].slice(1))-1,B[x]||(B[x]={});break;case"R":p=parseInt(U[y].slice(1))-1,_[p]||(_[p]={}),M>0?(_[p].hpt=M,_[p].hpx=K0(M)):M===0&&(_[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}V<1&&(P=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return _.length>0&&(R["!rows"]=_),B.length>0&&(R["!cols"]=B),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,R]}function o(f,h){var m=s(f,h),p=m[0],x=m[1],g=Am(p,h);return Ts(x).forEach(function(y){g[y]=x[y]}),g}function l(f,h){return vd(o(f,h),h)}function c(f,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(f.t){case"n":x+=f.v||0,f.f&&!f.F&&(x+=";E"+kI(f.f,{r:m,c:p}));break;case"b":x+=f.v?"TRUE":"FALSE";break;case"e":x+=f.w||f.v;break;case"d":x+='"'+(f.w||f.v)+'"';break;case"s":x+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function A(f,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=nx(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=sx(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&f.push(x)})}function u(f,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*ax(m.hpx)+";"),x.length>2&&f.push(x+"R"+(p+1))})}function d(f,h){var m=["ID;PWXL;N;E"],p=[],x=dn(f["!ref"]),g,y=Array.isArray(f),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),f["!cols"]&&A(m,f["!cols"]),f["!rows"]&&u(m,f["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var F=x.s.r;F<=x.e.r;++F)for(var P=x.s.c;P<=x.e.c;++P){var R=Cr({r:F,c:P});g=y?(f[F]||[])[P]:f[R],!(!g||g.v==null&&(!g.f||g.F))&&p.push(c(g,f,F,P))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:d}}(),gQ=function(){function t(a,o){switch(o.type){case"base64":return e(To(a),o);case"binary":return e(a,o);case"buffer":return e(Vr&&Buffer.isBuffer(a)?a.toString("binary"):xd(a),o);case"array":return e(jh(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var l=a.split(`
`),c=-1,A=-1,u=0,d=[];u!==l.length;++u){if(l[u].trim()==="BOT"){d[++c]=[],A=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],m=f[1];++u;for(var p=l[u]||"";(p.match(/["]/g)||[]).length&1&&u<l.length-1;)p+=`
`+l[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){d[++c]=[],A=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[c][A]=!0:p==="FALSE"?d[c][A]=!1:isNaN(Ul(m))?isNaN(V0(m).getDate())?d[c][A]=m:d[c][A]=es(m):d[c][A]=Ul(m),++A;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[c][A++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function r(a,o){return Am(t(a,o),o)}function n(a,o){return vd(r(a,o),o)}var s=function(){var a=function(c,A,u,d,f){c.push(A),c.push(u+","+d),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,A,u,d){c.push(A+","+u),c.push(A==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var A=[],u=dn(c["!ref"]),d,f=Array.isArray(c);a(A,"TABLE",0,1,"sheetjs"),a(A,"VECTORS",0,u.e.r-u.s.r+1,""),a(A,"TUPLES",0,u.e.c-u.s.c+1,""),a(A,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(A,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=Cr({r:h,c:m});if(d=f?(c[h]||[])[m]:c[p],!d){o(A,1,0,"");continue}switch(d.t){case"n":var x=d.w;!x&&d.v!=null&&(x=d.v),x==null?d.f&&!d.F?o(A,1,0,"="+d.f):o(A,1,0,""):o(A,0,x,"V");break;case"b":o(A,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(A,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ml(d.z||Nr[14],ma(es(d.v)))),o(A,0,d.w,"V");break;default:o(A,1,0,"")}}}o(A,-1,0,"EOD");var g=`\r
`,y=A.join(g);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),xQ=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,f){for(var h=d.split(`
`),m=-1,p=-1,x=0,g=[];x!==h.length;++x){var y=h[x].trim().split(":");if(y[0]==="cell"){var b=ws(y[1]);if(g.length<=b.r)for(m=g.length;m<=b.r;++m)g[m]||(g[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":g[m][p]=t(y[3]);break;case"v":g[m][p]=+y[3];break;case"vtf":var F=y[y.length-1];case"vtc":switch(y[3]){case"nl":g[m][p]=!!+y[4];break;default:g[m][p]=+y[4];break}y[2]=="vtf"&&(g[m][p]=[g[m][p],F])}}}return f&&f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}function n(d,f){return Am(r(d,f),f)}function s(d,f){return vd(n(d,f),f)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function A(d){if(!d||!d["!ref"])return"";for(var f=[],h=[],m,p="",x=to(d["!ref"]),g=Array.isArray(d),y=x.s.r;y<=x.e.r;++y)for(var b=x.s.c;b<=x.e.c;++b)if(p=Cr({r:y,c:b}),m=g?(d[y]||[])[b]:d[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var F=ma(es(m.v));h[2]="vtc",h[3]="nd",h[4]=""+F,h[5]=m.w||ml(m.z||Nr[14],F);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(d){return[a,o,l,o,A(d),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),H0=function(){function t(u,d,f,h,m){m.raw?d[f][h]=u:u===""||(u==="TRUE"?d[f][h]=!0:u==="FALSE"?d[f][h]=!1:isNaN(Ul(u))?isNaN(V0(u).getDate())?d[f][h]=u:d[f][h]=es(u):d[f][h]=Ul(u))}function e(u,d){var f=d||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,g=0,y=0;y<=p;++y)g=m[y].indexOf(" "),g==-1?g=m[y].length:g++,x=Math.max(x,g);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,x).trim(),h,y,b,f),b=1;b<=(m[y].length-x)/10+1;++b)t(m[y].slice(x+(b-1)*10,x+b*10).trim(),h,y,b,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var d={},f=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?f=!f:!f&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h]);if(!m.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function a(u,d){var f=d||{},h="",m=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=s(u.slice(0,1024)):f&&f.FS?h=f.FS:h=s(u.slice(0,1024));var x=0,g=0,y=0,b=0,F=0,P=h.charCodeAt(0),R=!1,_=0,B=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var E=f.dateNF!=null?pce(f.dateNF):null;function M(){var k=u.slice(b,F),T={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)T.t="z";else if(f.raw)T.t="s",T.v=k;else if(k.trim().length===0)T.t="s",T.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(T.t="s",T.v=k.slice(2,-1).replace(/""/g,'"')):qfe(k)?(T.t="n",T.f=k.slice(1)):(T.t="s",T.v=k);else if(k=="TRUE")T.t="b",T.v=!0;else if(k=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=Ul(k)))T.t="n",f.cellText!==!1&&(T.w=k),T.v=y;else if(!isNaN(V0(k).getDate())||E&&k.match(E)){T.z=f.dateNF||Nr[14];var U=0;E&&k.match(E)&&(k=gce(k,f.dateNF,k.match(E)||[]),U=1),f.cellDates?(T.t="d",T.v=es(k,U)):(T.t="n",T.v=ma(es(k,U))),f.cellText!==!1&&(T.w=ml(T.z,T.v instanceof Date?ma(T.v):T.v)),f.cellNF||delete T.z}else T.t="s",T.v=k;if(T.t=="z"||(f.dense?(m[x]||(m[x]=[]),m[x][g]=T):m[Cr({c:g,r:x})]=T),b=F+1,B=u.charCodeAt(b),p.e.c<g&&(p.e.c=g),p.e.r<x&&(p.e.r=x),_==P)++g;else if(g=0,++x,f.sheetRows&&f.sheetRows<=x)return!0}e:for(;F<u.length;++F)switch(_=u.charCodeAt(F)){case 34:B===34&&(R=!R);break;case P:case 10:case 13:if(!R&&M())break e;break}return F-b>0&&M(),m["!ref"]=Dr(p),m}function o(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,d):Am(e(u,d),d)}function l(u,d){var f="",h=d.type=="string"?[0,0,0,0]:OI(u,d);switch(d.type){case"base64":f=To(u);break;case"binary":f=u;break;case"buffer":d.codepage==65001?f=u.toString("utf8"):d.codepage&&typeof Wg<"u"||(f=Vr&&Buffer.isBuffer(u)?u.toString("binary"):xd(u));break;case"array":f=jh(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Pn(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=Pn(f):d.type=="binary"&&typeof Wg<"u",f.slice(0,19)=="socialcalc:version:"?xQ.to_sheet(d.type=="string"?f:Pn(f),d):o(f,d)}function c(u,d){return vd(l(u,d),d)}function A(u){for(var d=[],f=dn(u["!ref"]),h,m=Array.isArray(u),p=f.s.r;p<=f.e.r;++p){for(var x=[],g=f.s.c;g<=f.e.c;++g){var y=Cr({r:p,c:g});if(h=m?(u[p]||[])[g]:u[y],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(SA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(g===0?" ":""))}d.push(x.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:A}}();function kde(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=pQ.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return H0.to_workbook(t,e)}}var fh=function(){function t(S,I,V){if(S){Ha(S,S.l||0);for(var j=V.Enum||xe;S.l<S.length;){var O=S.read_shift(2),W=j[O]||j[65535],D=S.read_shift(2),Y=S.l+D,se=W.f&&W.f(S,D,V);if(S.l=Y,I(se,W,O))return}}}function e(S,I){switch(I.type){case"base64":return r(No(To(S)),I);case"binary":return r(No(S),I);case"buffer":case"array":return r(S,I)}throw"Unsupported type "+I.type}function r(S,I){if(!S)return S;var V=I||{},j=V.dense?[]:{},O="Sheet1",W="",D=0,Y={},se=[],ve=[],z={s:{r:0,c:0},e:{r:0,c:0}},Oe=V.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)V.Enum=xe,t(S,function(ie,fe,Ie){switch(Ie){case 0:V.vers=ie,ie>=4096&&(V.qpro=!0);break;case 6:z=ie;break;case 204:ie&&(W=ie);break;case 222:W=ie;break;case 15:case 51:V.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:Ie==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=V.dateNF||Nr[14],V.cellDates&&(ie[1].t="d",ie[1].v=J2(ie[1].v))),V.qpro&&ie[3]>D&&(j["!ref"]=Dr(z),Y[O]=j,se.push(O),j=V.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},D=ie[3],O=W||"Sheet"+(D+1),W="");var Ve=V.dense?(j[ie[0].r]||[])[ie[0].c]:j[Cr(ie[0])];if(Ve){Ve.t=ie[1].t,Ve.v=ie[1].v,ie[1].z!=null&&(Ve.z=ie[1].z),ie[1].f!=null&&(Ve.f=ie[1].f);break}V.dense?(j[ie[0].r]||(j[ie[0].r]=[]),j[ie[0].r][ie[0].c]=ie[1]):j[Cr(ie[0])]=ie[1];break}},V);else if(S[2]==26||S[2]==14)V.Enum=Ce,S[2]==14&&(V.qpro=!0,S.l=0),t(S,function(ie,fe,Ie){switch(Ie){case 204:O=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>D&&(j["!ref"]=Dr(z),Y[O]=j,se.push(O),j=V.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},D=ie[3],O="Sheet"+(D+1)),Oe>0&&ie[0].r>=Oe)break;V.dense?(j[ie[0].r]||(j[ie[0].r]=[]),j[ie[0].r][ie[0].c]=ie[1]):j[Cr(ie[0])]=ie[1],z.e.c<ie[0].c&&(z.e.c=ie[0].c),z.e.r<ie[0].r&&(z.e.r=ie[0].r);break;case 27:ie[14e3]&&(ve[ie[14e3][0]]=ie[14e3][1]);break;case 1537:ve[ie[0]]=ie[1],ie[0]==D&&(O=ie[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(j["!ref"]=Dr(z),Y[W||O]=j,se.push(W||O),!ve.length)return{SheetNames:se,Sheets:Y};for(var te={},J=[],q=0;q<ve.length;++q)Y[se[q]]?(J.push(ve[q]||se[q]),te[ve[q]]=Y[ve[q]]||Y[se[q]]):(J.push(ve[q]),te[ve[q]]={"!ref":"A1"});return{SheetNames:J,Sheets:te}}function n(S,I){var V=I||{};if(+V.codepage>=0&&jl(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var j=eo(),O=dn(S["!ref"]),W=Array.isArray(S),D=[];Wt(j,0,a(1030)),Wt(j,6,c(O));for(var Y=Math.min(O.e.r,8191),se=O.s.r;se<=Y;++se)for(var ve=Ks(se),z=O.s.c;z<=O.e.c;++z){se===O.s.r&&(D[z]=vs(z));var Oe=D[z]+ve,te=W?(S[se]||[])[z]:S[Oe];if(!(!te||te.t=="z"))if(te.t=="n")(te.v|0)==te.v&&te.v>=-32768&&te.v<=32767?Wt(j,13,h(se,z,te.v)):Wt(j,14,p(se,z,te.v));else{var J=SA(te);Wt(j,15,d(se,z,J.slice(0,239)))}}return Wt(j,1),j.end()}function s(S,I){var V=I||{};if(+V.codepage>=0&&jl(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var j=eo();Wt(j,0,o(S));for(var O=0,W=0;O<S.SheetNames.length;++O)(S.Sheets[S.SheetNames[O]]||{})["!ref"]&&Wt(j,27,re(S.SheetNames[O],W++));var D=0;for(O=0;O<S.SheetNames.length;++O){var Y=S.Sheets[S.SheetNames[O]];if(!(!Y||!Y["!ref"])){for(var se=dn(Y["!ref"]),ve=Array.isArray(Y),z=[],Oe=Math.min(se.e.r,8191),te=se.s.r;te<=Oe;++te)for(var J=Ks(te),q=se.s.c;q<=se.e.c;++q){te===se.s.r&&(z[q]=vs(q));var ie=z[q]+J,fe=ve?(Y[te]||[])[q]:Y[ie];if(!(!fe||fe.t=="z"))if(fe.t=="n")Wt(j,23,M(te,q,D,fe.v));else{var Ie=SA(fe);Wt(j,22,_(te,q,D,Ie.slice(0,239)))}}++D}}return Wt(j,1),j.end()}function a(S){var I=Ct(2);return I.write_shift(2,S),I}function o(S){var I=Ct(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var V=0,j=0,O=0,W=0;W<S.SheetNames.length;++W){var D=S.SheetNames[W],Y=S.Sheets[D];if(!(!Y||!Y["!ref"])){++O;var se=to(Y["!ref"]);V<se.e.r&&(V=se.e.r),j<se.e.c&&(j=se.e.c)}}return V>8191&&(V=8191),I.write_shift(2,V),I.write_shift(1,O),I.write_shift(1,j),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function l(S,I,V){var j={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&V.qpro?(j.s.c=S.read_shift(1),S.l++,j.s.r=S.read_shift(2),j.e.c=S.read_shift(1),S.l++,j.e.r=S.read_shift(2),j):(j.s.c=S.read_shift(2),j.s.r=S.read_shift(2),I==12&&V.qpro&&(S.l+=2),j.e.c=S.read_shift(2),j.e.r=S.read_shift(2),I==12&&V.qpro&&(S.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function c(S){var I=Ct(8);return I.write_shift(2,S.s.c),I.write_shift(2,S.s.r),I.write_shift(2,S.e.c),I.write_shift(2,S.e.r),I}function A(S,I,V){var j=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(j[0].c=S.read_shift(1),j[3]=S.read_shift(1),j[0].r=S.read_shift(2),S.l+=2):(j[2]=S.read_shift(1),j[0].c=S.read_shift(2),j[0].r=S.read_shift(2)),j}function u(S,I,V){var j=S.l+I,O=A(S,I,V);if(O[1].t="s",V.vers==20768){S.l++;var W=S.read_shift(1);return O[1].v=S.read_shift(W,"utf8"),O}return V.qpro&&S.l++,O[1].v=S.read_shift(j-S.l,"cstr"),O}function d(S,I,V){var j=Ct(7+V.length);j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,S),j.write_shift(1,39);for(var O=0;O<j.length;++O){var W=V.charCodeAt(O);j.write_shift(1,W>=128?95:W)}return j.write_shift(1,0),j}function f(S,I,V){var j=A(S,I,V);return j[1].v=S.read_shift(2,"i"),j}function h(S,I,V){var j=Ct(7);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,S),j.write_shift(2,V,"i"),j}function m(S,I,V){var j=A(S,I,V);return j[1].v=S.read_shift(8,"f"),j}function p(S,I,V){var j=Ct(13);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,S),j.write_shift(8,V,"f"),j}function x(S,I,V){var j=S.l+I,O=A(S,I,V);if(O[1].v=S.read_shift(8,"f"),V.qpro)S.l=j;else{var W=S.read_shift(2);F(S.slice(S.l,S.l+W),O),S.l+=W}return O}function g(S,I,V){var j=I&32768;return I&=-32769,I=(j?S:0)+(I>=8192?I-16384:I),(j?"":"$")+(V?vs(I):Ks(I))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(S,I){Ha(S,0);for(var V=[],j=0,O="",W="",D="",Y="";S.l<S.length;){var se=S[S.l++];switch(se){case 0:V.push(S.read_shift(8,"f"));break;case 1:W=g(I[0].c,S.read_shift(2),!0),O=g(I[0].r,S.read_shift(2),!1),V.push(W+O);break;case 2:{var ve=g(I[0].c,S.read_shift(2),!0),z=g(I[0].r,S.read_shift(2),!1);W=g(I[0].c,S.read_shift(2),!0),O=g(I[0].r,S.read_shift(2),!1),V.push(ve+z+":"+W+O)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(S.read_shift(2));break;case 6:{for(var Oe="";se=S[S.l++];)Oe+=String.fromCharCode(se);V.push('"'+Oe.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Y=V.pop(),D=V.pop(),V.push(["AND","OR"][se-20]+"("+D+","+Y+")");break;default:if(se<32&&b[se])Y=V.pop(),D=V.pop(),V.push(D+b[se]+Y);else if(y[se]){if(j=y[se][1],j==69&&(j=S[S.l++]),j>V.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+V.join("|")+"|");return}var te=V.slice(-j);V.length-=j,V.push(y[se][0]+"("+te.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}V.length==1?I[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function P(S){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=S.read_shift(2),I[3]=S[S.l++],I[0].c=S[S.l++],I}function R(S,I){var V=P(S);return V[1].t="s",V[1].v=S.read_shift(I-4,"cstr"),V}function _(S,I,V,j){var O=Ct(6+j.length);O.write_shift(2,S),O.write_shift(1,V),O.write_shift(1,I),O.write_shift(1,39);for(var W=0;W<j.length;++W){var D=j.charCodeAt(W);O.write_shift(1,D>=128?95:D)}return O.write_shift(1,0),O}function B(S,I){var V=P(S);V[1].v=S.read_shift(2);var j=V[1].v>>1;if(V[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return V[1].v=j,V}function E(S,I){var V=P(S),j=S.read_shift(4),O=S.read_shift(4),W=S.read_shift(2);if(W==65535)return j===0&&O===3221225472?(V[1].t="e",V[1].v=15):j===0&&O===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var D=W&32768;return W=(W&32767)-16446,V[1].v=(1-D*2)*(O*Math.pow(2,W+32)+j*Math.pow(2,W)),V}function M(S,I,V,j){var O=Ct(14);if(O.write_shift(2,S),O.write_shift(1,V),O.write_shift(1,I),j==0)return O.write_shift(4,0),O.write_shift(4,0),O.write_shift(2,65535),O;var W=0,D=0,Y=0,se=0;return j<0&&(W=1,j=-j),D=Math.log2(j)|0,j/=Math.pow(2,D-31),se=j>>>0,se&2147483648||(j/=2,++D,se=j>>>0),j-=se,se|=2147483648,se>>>=0,j*=Math.pow(2,32),Y=j>>>0,O.write_shift(4,Y),O.write_shift(4,se),D+=16383+(W?32768:0),O.write_shift(2,D),O}function k(S,I){var V=E(S);return S.l+=I-14,V}function T(S,I){var V=P(S),j=S.read_shift(4);return V[1].v=j>>6,V}function U(S,I){var V=P(S),j=S.read_shift(8,"f");return V[1].v=j,V}function Z(S,I){var V=U(S);return S.l+=I-10,V}function pe(S,I){return S[S.l+I-1]==0?S.read_shift(I,"cstr"):""}function ae(S,I){var V=S[S.l++];V>I-1&&(V=I-1);for(var j="";j.length<V;)j+=String.fromCharCode(S[S.l++]);return j}function he(S,I,V){if(!(!V.qpro||I<21)){var j=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var O=S.read_shift(I-21,"cstr");return[j,O]}}function de(S,I){for(var V={},j=S.l+I;S.l<j;){var O=S.read_shift(2);if(O==14e3){for(V[O]=[0,""],V[O][0]=S.read_shift(2);S[S.l];)V[O][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return V}function re(S,I){var V=Ct(5+S.length);V.write_shift(2,14e3),V.write_shift(2,I);for(var j=0;j<S.length;++j){var O=S.charCodeAt(j);V[V.l++]=O>127?95:O}return V[V.l++]=0,V}var xe={0:{n:"BOF",f:Xs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:pe},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:de},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:Z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function Tde(t){var e={},r=t.match(xi),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Er(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=rI[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var jde=function(){var t=Yg("t"),e=Yg("rPr");function r(a){var o=a.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:An(o[1])},c=a.match(e);return c&&(l.s=Tde(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),Pde=function(){var e=/(\r\n|\n)/g;function r(s,a,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),o.push("</b>")),s.i&&(a.push("<i>"),o.push("</i>")),s.strike&&(a.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Rde=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Dde=/<(?:\w+:)?r>/,Lde=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function EI(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=An(Pn(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pn(t),r&&(n.h=dI(n.t))):t.match(Dde)&&(n.r=Pn(t),n.t=An(Pn((t.replace(Lde,"").match(Rde)||[]).join("").replace(xi,""))),r&&(n.h=Pde(jde(n.r)))),n):{t:""}}var Ude=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ode=/<(?:\w+:)?(?:si|sstItem)>/g,Mde=/<\/(?:\w+:)?(?:si|sstItem)>/;function Qde(t,e){var r=[],n="";if(!t)return r;var s=t.match(Ude);if(s){n=s[2].replace(Ode,"").split(Mde);for(var a=0;a!=n.length;++a){var o=EI(n[a].trim(),e);o!=null&&(r[r.length]=o)}s=Er(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Vde=/^\s|\s$|[\t\n\r]/;function vQ(t,e){if(!e.bookSST)return"";var r=[Gs];r[r.length]=zt("sst",null,{xmlns:Jh[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Vde)&&(a+=' xml:space="preserve"'),a+=">"+Fn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Hde(t){return[t.read_shift(4),t.read_shift(4)]}function Kde(t,e){var r=[],n=!1;return jA(t,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function qde(t,e){return e||(e=Ct(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Gde=rAe;function $de(t){var e=eo();Rt(e,159,qde(t));for(var r=0;r<t.length;++r)Rt(e,19,Gde(t[r]));return Rt(e,160),e.end()}function wQ(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function xA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function zde(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=xA(t,4),e.U=xA(t,4),e.W=xA(t,4),e}function Wde(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Jde(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Wde(t));return e}function Xde(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Yde(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=xA(t,4),e.U=xA(t,4),e.W=xA(t,4),e}function Zde(t){var e=Yde(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function yQ(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function bQ(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function ehe(t){var e=xA(t);switch(e.Minor){case 2:return[e.Minor,the(t)];case 3:return[e.Minor,rhe()];case 4:return[e.Minor,nhe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function the(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=yQ(t,r),s=bQ(t,t.length-t.l);return{t:"Std",h:n,v:s}}function rhe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function nhe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(xi,function(a){var o=Er(a);switch(kc(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function she(t,e){var r={},n=r.EncryptionVersionInfo=xA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=yQ(t,s),e-=s,r.EncryptionVerifier=bQ(t,e),r}function ahe(t){var e={},r=e.EncryptionVersionInfo=xA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function BI(t){var e=0,r,n=wQ(t),s=n.length+1,a,o,l,c,A;for(r=id(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],l=e&16384?1:0,c=e<<1&32767,A=l|c,e=A^o;return e^52811}var NQ=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},a=function(o){for(var l=e[o.length-1],c=104,A=o.length-1;A>=0;--A)for(var u=o[A],d=0;d!=7;++d)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=wQ(o),c=a(l),A=l.length,u=id(16),d=0;d!=16;++d)u[d]=0;var f,h,m;for((A&1)===1&&(f=c>>8,u[A]=s(t[0],f),--A,f=c&255,h=l[l.length-1],u[A]=s(h,f));A>0;)--A,f=c>>8,u[A]=s(l[A],f),--A,f=c&255,u[A]=s(l[A],f);for(A=15,m=15-l.length;m>0;)f=c>>8,u[A]=s(t[m],f),--A,--m,f=c&255,u[A]=s(l[A],f),--A,--m;return u}}(),ihe=function(t,e,r,n,s){s||(s=e),n||(n=NQ(t));var a,o;for(a=0;a!=e.length;++a)o=e[a],o^=n[r],o=(o>>5|o<<3)&255,s[a]=o,++r;return[s,r,n]},ohe=function(t){var e=0,r=NQ(t);return function(n){var s=ihe("",n,e,r);return e=s[1],s[0]}};function lhe(t,e,r,n){var s={key:Xs(t),verificationBytes:Xs(t)};return r.password&&(s.verifier=BI(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=ohe(r.password)),s}function che(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=ahe(t):n.Data=she(t,e),n}function Ahe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?che(t,e-2,n):lhe(t,r.biff>=8?e:e-2,r,n),n}var CQ=function(){function t(s,a){switch(a.type){case"base64":return e(To(s),a);case"binary":return e(s,a);case"buffer":return e(Vr&&Buffer.isBuffer(s)?s.toString("binary"):xd(s),a);case"array":return e(jh(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var o=a||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,d){Array.isArray(l)&&(l[d]=[]);for(var f=/\\\w+\b/g,h=0,m,p=-1;m=f.exec(u);){switch(m[0]){case"\\cell":var x=u.slice(h,f.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var g={v:x,t:"s"};Array.isArray(l)?l[d][p]=g:l[Cr({r:d,c:p})]=g}break}h=f.lastIndex}p>A.e.c&&(A.e.c=p)}),l["!ref"]=Dr(A),l}function r(s,a){return vd(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=dn(s["!ref"]),l,c=Array.isArray(s),A=o.s.r;A<=o.e.r;++A){a.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var d=Cr({r:A,c:u});l=c?(s[A]||[])[u]:s[d],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(SA(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function uhe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function rx(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function dhe(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),o=s-a;if(o===0)return[0,0,e];var l=0,c=0,A=s+a;switch(c=o/(A>1?2-A:A),s){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,A/2]}function hhe(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,o=[a,a,a],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var A=0;A!=3;++A)o[A]=Math.round(o[A]*255);return o}function Dy(t,e){if(e===0)return t;var r=dhe(uhe(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),rx(hhe(r))}var _Q=6,fhe=15,mhe=1,hi=_Q;function nx(t){return Math.floor((t+Math.round(128/hi)/256)*hi)}function sx(t){return Math.floor((t-5)/hi*100+.5)/100}function Ly(t){return Math.round((t*hi+5)/hi*256)/256}function nC(t){return Ly(sx(nx(t)))}function SI(t){var e=Math.abs(t-nC(t)),r=hi;if(e>.005)for(hi=mhe;hi<fhe;++hi)Math.abs(t-nC(t))<=e&&(e=Math.abs(t-nC(t)),r=hi);hi=r}function od(t){t.width?(t.wpx=nx(t.width),t.wch=sx(t.wpx),t.MDW=hi):t.wpx?(t.wch=sx(t.wpx),t.width=Ly(t.wch),t.MDW=hi):typeof t.wch=="number"&&(t.width=Ly(t.wch),t.wpx=nx(t.width),t.MDW=hi),t.customWidth&&delete t.customWidth}var phe=96,EQ=phe;function ax(t){return t*96/EQ}function K0(t){return t*EQ/96}var ghe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xhe(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(xi)||[]).forEach(function(o){var l=Er(o);switch(kc(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Xn(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Xn(l.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function vhe(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(xi)||[]).forEach(function(o){var l=Er(o);switch(kc(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function whe(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(xi)||[]).forEach(function(o){var l=Er(o);switch(kc(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Pn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Xn(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Xn(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Xn(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Xn(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Xn(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Xn(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Xn(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=rI[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Xn(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=dh[s.color.index];s.color.index==81&&(c=dh[1]),c||(c=dh[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Dy(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function yhe(t,e,r){e.NumberFmt=[];for(var n=Ts(Nr),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Nr[n[s]];var a=t[0].match(xi);if(a)for(s=0;s<a.length;++s){var o=Er(a[s]);switch(kc(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=An(Pn(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}gA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function bhe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=zt("numFmt",null,{numFmtId:n,formatCode:Fn(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=zt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var I1=["numFmtId","fillId","fontId","borderId","xfId"],F1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Nhe(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(xi)||[]).forEach(function(a){var o=Er(a),l=0;switch(kc(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<I1.length;++l)n[I1[l]]&&(n[I1[l]]=parseInt(n[I1[l]],10));for(l=0;l<F1.length;++l)n[F1[l]]&&(n[F1[l]]=Xn(n[F1[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Xn(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Che(t){var e=[];return e[e.length]=zt("cellXfs",null),t.forEach(function(r){e[e.length]=zt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=zt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var _he=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,A){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=l.match(e))&&yhe(d,u,A),(d=l.match(s))&&whe(d,u,c,A),(d=l.match(n))&&vhe(d,u,c,A),(d=l.match(a))&&xhe(d,u,c,A),(d=l.match(r))&&Nhe(d,u,A),u}}();function BQ(t,e){var r=[Gs,zt("styleSheet",null,{xmlns:Jh[0],"xmlns:vt":ua.vt})],n;return t.SSF&&(n=bhe(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Che(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ehe(t,e){var r=t.read_shift(2),n=mi(t);return[r,n]}function Bhe(t,e,r){r||(r=Ct(6+4*e.length)),r.write_shift(2,t),Ea(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function She(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=cAe(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=lAe(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=mi(t),n}function Ihe(t,e){e||(e=Ct(25+4*32)),e.write_shift(2,t.sz*20),AAe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),jy(t.color,e);var n=0;return n=2,e.write_shift(1,n),Ea(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Fhe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],sC,khe=gi;function XP(t,e){e||(e=Ct(4*3+8*7+16*1)),sC||(sC=z2(Fhe));var r=sC[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(jy({auto:1},e),jy({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function The(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function SQ(t,e,r){r||(r=Ct(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function np(t,e){return e||(e=Ct(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var jhe=gi;function Phe(t,e){return e||(e=Ct(51)),e.write_shift(1,0),np(null,e),np(null,e),np(null,e),np(null,e),np(null,e),e.length>e.l?e.slice(0,e.l):e}function Rhe(t,e){return e||(e=Ct(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Ty(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Dhe(t,e,r){var n=Ct(2052);return n.write_shift(4,t),Ty(e,n),Ty(r,n),n.length>n.l?n.slice(0,n.l):n}function Lhe(t,e,r){var n={};n.NumberFmt=[];for(var s in Nr)n.NumberFmt[s]=Nr[s];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return jA(t,function(c,A,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],gA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Dy(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(u),o=!0;break;case 38:a.pop(),o=!1;break;default:if(A.T>0)a.push(u);else if(A.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function Uhe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(Rt(t,615,Ol(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Rt(t,44,Bhe(s,e[s]))}),Rt(t,616))}}function Ohe(t){var e=1;Rt(t,611,Ol(e)),Rt(t,43,Ihe({sz:12,color:{theme:1},name:"Calibri",family:2})),Rt(t,612)}function Mhe(t){var e=2;Rt(t,603,Ol(e)),Rt(t,45,XP({patternType:"none"})),Rt(t,45,XP({patternType:"gray125"})),Rt(t,604)}function Qhe(t){var e=1;Rt(t,613,Ol(e)),Rt(t,46,Phe()),Rt(t,614)}function Vhe(t){var e=1;Rt(t,626,Ol(e)),Rt(t,47,SQ({numFmtId:0},65535)),Rt(t,627)}function Hhe(t,e){Rt(t,617,Ol(e.length)),e.forEach(function(r){Rt(t,47,SQ(r,0))}),Rt(t,618)}function Khe(t){var e=1;Rt(t,619,Ol(e)),Rt(t,48,Rhe({xfId:0,name:"Normal"})),Rt(t,620)}function qhe(t){var e=0;Rt(t,505,Ol(e)),Rt(t,506)}function Ghe(t){var e=0;Rt(t,508,Dhe(e,"TableStyleMedium9","PivotStyleMedium4")),Rt(t,509)}function $he(t,e){var r=eo();return Rt(r,278),Uhe(r,t.SSF),Ohe(r),Mhe(r),Qhe(r),Vhe(r),Hhe(r,e.cellXfs),Khe(r),qhe(r),Ghe(r),Rt(r,279),r.end()}var zhe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Whe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(xi)||[]).forEach(function(s){var a=Er(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[zhe.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Jhe(){}function Xhe(){}var Yhe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Zhe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,efe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tfe(t,e,r){e.themeElements={};var n;[["clrScheme",Yhe,Whe],["fontScheme",Zhe,Jhe],["fmtScheme",efe,Xhe]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var rfe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function IQ(t,e){(!t||t.length===0)&&(t=II());var r,n={};if(!(r=t.match(rfe)))throw new Error("themeElements not found in theme");return tfe(r[0],n,e),n.raw=t,n}function II(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Gs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function nfe(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var o;try{o=y8(a,{type:"array"})}catch{return}var l=Co(o,"theme/theme/theme1.xml",!0);if(l)return IQ(l,r)}}function sfe(t){return t.read_shift(4)}function afe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=ife(t,4);break;case 2:e.xclrValue=lQ(t);break;case 3:e.xclrValue=sfe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function ife(t,e){return gi(t,e)}function ofe(t,e){return gi(t,e)}function lfe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=afe(t);break;case 6:n[1]=ofe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function cfe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(lfe(t,r-t.l));return{ixfe:n,ext:a}}function Afe(t,e){e.forEach(function(r){switch(r[0]){}})}function ufe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:mi(t)}}function dfe(t){var e=Ct(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ea(t.name,e),e.slice(0,e.l)}function hfe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function ffe(t){var e=Ct(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function mfe(t,e){var r=Ct(8+2*e.length);return r.write_shift(4,t),Ea(e,r),r.slice(0,r.l)}function pfe(t){return t.l+=4,t.read_shift(4)!=0}function gfe(t,e){var r=Ct(8);return r.write_shift(4,t),r.write_shift(4,1),r}function xfe(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],o=!1,l=2;return jA(t,function(c,A,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){l==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):l==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(u),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!A.T){if(!o||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function vfe(){var t=eo();return Rt(t,332),Rt(t,334,Ol(1)),Rt(t,335,dfe({name:"XLDAPR",version:12e4,flags:3496657072})),Rt(t,336),Rt(t,339,mfe(1,"XLDAPR")),Rt(t,52),Rt(t,35,Ol(514)),Rt(t,4096,Ol(0)),Rt(t,4097,tl(1)),Rt(t,36),Rt(t,53),Rt(t,340),Rt(t,337,gfe(1)),Rt(t,51,ffe([[1,0]])),Rt(t,338),Rt(t,333),t.end()}function wfe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,o;return t.replace(xi,function(l){var c=Er(l);switch(kc(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<n.Types.length;++A)n.Types[A].name==c.name&&(o=n.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function FQ(){var t=[Gs];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function yfe(t){var e=[];if(!t)return e;var r=1;return(t.match(xi)||[]).forEach(function(n){var s=Er(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function bfe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Cr(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Nfe(t,e,r){var n=[];return jA(t,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Cfe(t,e,r,n){if(!t)return t;var s=n||{},a=!1;jA(t,function(l,c,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},s)}function _fe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var o0=1024;function kQ(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[zt("xml",null,{"xmlns:v":yo.v,"xmlns:o":yo.o,"xmlns:x":yo.x,"xmlns:mv":yo.mv}).replace(/\/>/,">"),zt("o:shapelayout",zt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),zt("v:shapetype",[zt("v:stroke",null,{joinstyle:"miter"}),zt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];o0<t*1e3;)o0+=1e3;return e.forEach(function(a){var o=ws(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?zt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,A=zt("v:fill",c,l),u={on:"t",obscured:"t"};++o0,s=s.concat(["<v:shape"+Zg({id:"_x0000_s"+o0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",A,zt("v:shadow",null,u),zt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qa("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),qa("x:AutoFill","False"),qa("x:Row",String(o.r)),qa("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function YP(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(o){var l=ws(o.ref);if(s?(t[l.r]||(t[l.r]=[]),a=t[l.r][l.c]):a=t[o.ref],!a){a={t:"z"},s?t[l.r][l.c]=a:t[o.ref]=a;var c=dn(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var A=Dr(c);A!==t["!ref"]&&(t["!ref"]=A)}a.c||(a.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}a.c.push(u)})}function Efe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Er(l[0]),A={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=ws(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var d=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&EI(d[1])||{r:"",t:"",h:""};A.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),A.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(A.h=f.h),n.push(A)}}}}),n}function TQ(t){var e=[Gs,zt("comments",null,{xmlns:Jh[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=Fn(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Fn(c.a))),a.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push(qa("t",Fn(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;e.push(qa("t",Fn(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Bfe(t,e){var r=[],n=!1,s={},a=0;return t.replace(xi,function(l,c){var A=Er(l);switch(kc(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=t.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return l}),r}function Sfe(t,e,r){var n=[Gs,zt("ThreadedComments",null,{xmlns:ua.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(zt("threadedComment",qa("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Ife(t,e){var r=[],n=!1;return t.replace(xi,function(a){var o=Er(a);switch(kc(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function Ffe(t){var e=[Gs,zt("personList",null,{xmlns:ua.TCMNT,"xmlns:x":Jh[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(zt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function kfe(t){var e={};e.iauthor=t.read_shift(4);var r=ef(t);return e.rfx=r.s,e.ref=Cr(r.s),t.l+=16,e}function Tfe(t,e){return e==null&&(e=Ct(36)),e.write_shift(4,t[1].iauthor),um(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var jfe=mi;function Pfe(t){return Ea(t.slice(0,54))}function Rfe(t,e){var r=[],n=[],s={},a=!1;return jA(t,function(l,c,A){switch(A){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),r}function Dfe(t){var e=eo(),r=[];return Rt(e,628),Rt(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Rt(e,632,Pfe(s.a)))})}),Rt(e,631),Rt(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:ws(n[0]),e:ws(n[0])};Rt(e,635,Tfe([a,s])),s.t&&s.t.length>0&&Rt(e,637,sAe(s)),Rt(e,636),delete s.iauthor})}),Rt(e,634),Rt(e,629),e.end()}var Lfe="application/vnd.ms-office.vbaProject";function Ufe(t){var e=vr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),vr.write(e)}function Ofe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&vr.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var jQ=["xlsb","xlsm","xlam","biff8","xla"];function Mfe(){return{"!type":"dialog"}}function Qfe(){return{"!type":"dialog"}}function Vfe(){return{"!type":"macro"}}function Hfe(){return{"!type":"macro"}}var y0=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,o){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var A=a.length>0?parseInt(a,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=e.c:--u,c?A+=e.r:--A,s+(l?"":"$")+vs(u)+(c?"":"$")+Ks(A)}return function(s,a){return e=a,s.replace(t,r)}}(),FI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,kI=function(){return function(e,r){return e.replace(FI,function(n,s,a,o,l,c){var A=gI(o)-(a?0:r.c),u=pI(c)-(l?0:r.r),d=u==0?"":l?u+1:"["+u+"]",f=A==0?"":a?A+1:"["+A+"]";return s+"R"+d+"C"+f})}}();function PQ(t,e){return t.replace(FI,function(r,n,s,a,o,l){return n+(s=="$"?s+a:vs(gI(a)+e.c))+(o=="$"?o+l:Ks(pI(l)+e.r))})}function Kfe(t,e,r){var n=to(e),s=n.s,a=ws(r),o={r:a.r-s.r,c:a.c-s.c};return PQ(t,o)}function qfe(t){return t.length!=1}function ZP(t){return t.replace(/_xlfn\./g,"")}function zs(t){t.l+=1}function ld(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function RQ(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return DQ(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),o=ld(t),l=ld(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function DQ(t){var e=ld(t),r=ld(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Gfe(t,e,r){if(r.biff<8)return DQ(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=ld(t),o=ld(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function LQ(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return $fe(t);var n=t.read_shift(r&&r.biff==12?4:2),s=ld(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function $fe(t){var e=ld(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function zfe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Wfe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Jfe(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function Jfe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Xfe(t,e,r){var n=(t[t.l++]&96)>>5,s=RQ(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Yfe(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var o=RQ(t,a,r);return[n,s,o]}function Zfe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function e0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function t0e(t,e,r){var n=(t[t.l++]&96)>>5,s=Gfe(t,e-1,r);return[n,s]}function r0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function e3(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function n0e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function s0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function a0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function i0e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function o0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function UQ(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function l0e(t){return t.read_shift(2),UQ(t)}function c0e(t){return t.read_shift(2),UQ(t)}function A0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=LQ(t,0,r);return[n,s]}function u0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Wfe(t,0,r);return[n,s]}function d0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=LQ(t,0,r);return[n,s,a]}function h0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[pme[s],QQ[s],n]}function f0e(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:m0e(t);return[s,(a[0]===0?QQ:mme)[a[1]]]}function m0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function p0e(t,e,r){t.l+=r&&r.biff==2?3:4}function g0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function x0e(t){return t.l++,PA[t.read_shift(1)]}function v0e(t){return t.l++,t.read_shift(2)}function w0e(t){return t.l++,t.read_shift(1)!==0}function y0e(t){return t.l++,fi(t)}function b0e(t,e,r){return t.l++,Mx(t,e-1,r)}function N0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Us(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=PA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=fi(t);break;case 2:r[1]=tf(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function C0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?ef:X2)(t));return s}function _0e(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=N0e(t,r.biff);return o}function E0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function B0e(t,e,r){if(r.biff==5)return S0e(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function S0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function I0e(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function F0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function k0e(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function T0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var j0e=gi,P0e=gi,R0e=gi;function Vx(t,e,r){return t.l+=2,[zfe(t)]}function TI(t){return t.l+=6,[]}var D0e=Vx,L0e=TI,U0e=TI,O0e=Vx;function OQ(t){return t.l+=2,[Xs(t),t.read_shift(2)&1]}var M0e=Vx,Q0e=OQ,V0e=TI,H0e=Vx,K0e=Vx,q0e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function G0e(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),o=q0e[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:s,C:a}}function $0e(t){return t.l+=2,[t.read_shift(4)]}function z0e(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function W0e(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function J0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function X0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Y0e(t){return t.l+=4,[0,0]}var t3={1:{n:"PtgExp",f:g0e},2:{n:"PtgTbl",f:R0e},3:{n:"PtgAdd",f:zs},4:{n:"PtgSub",f:zs},5:{n:"PtgMul",f:zs},6:{n:"PtgDiv",f:zs},7:{n:"PtgPower",f:zs},8:{n:"PtgConcat",f:zs},9:{n:"PtgLt",f:zs},10:{n:"PtgLe",f:zs},11:{n:"PtgEq",f:zs},12:{n:"PtgGe",f:zs},13:{n:"PtgGt",f:zs},14:{n:"PtgNe",f:zs},15:{n:"PtgIsect",f:zs},16:{n:"PtgUnion",f:zs},17:{n:"PtgRange",f:zs},18:{n:"PtgUplus",f:zs},19:{n:"PtgUminus",f:zs},20:{n:"PtgPercent",f:zs},21:{n:"PtgParen",f:zs},22:{n:"PtgMissArg",f:zs},23:{n:"PtgStr",f:b0e},26:{n:"PtgSheet",f:z0e},27:{n:"PtgEndSheet",f:W0e},28:{n:"PtgErr",f:x0e},29:{n:"PtgBool",f:w0e},30:{n:"PtgInt",f:v0e},31:{n:"PtgNum",f:y0e},32:{n:"PtgArray",f:r0e},33:{n:"PtgFunc",f:h0e},34:{n:"PtgFuncVar",f:f0e},35:{n:"PtgName",f:E0e},36:{n:"PtgRef",f:A0e},37:{n:"PtgArea",f:Xfe},38:{n:"PtgMemArea",f:I0e},39:{n:"PtgMemErr",f:j0e},40:{n:"PtgMemNoMem",f:P0e},41:{n:"PtgMemFunc",f:F0e},42:{n:"PtgRefErr",f:k0e},43:{n:"PtgAreaErr",f:Zfe},44:{n:"PtgRefN",f:u0e},45:{n:"PtgAreaN",f:t0e},46:{n:"PtgMemAreaN",f:J0e},47:{n:"PtgMemNoMemN",f:X0e},57:{n:"PtgNameX",f:B0e},58:{n:"PtgRef3d",f:d0e},59:{n:"PtgArea3d",f:Yfe},60:{n:"PtgRefErr3d",f:T0e},61:{n:"PtgAreaErr3d",f:e0e},255:{}},Z0e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},eme={1:{n:"PtgElfLel",f:OQ},2:{n:"PtgElfRw",f:H0e},3:{n:"PtgElfCol",f:D0e},6:{n:"PtgElfRwV",f:K0e},7:{n:"PtgElfColV",f:O0e},10:{n:"PtgElfRadical",f:M0e},11:{n:"PtgElfRadicalS",f:V0e},13:{n:"PtgElfColS",f:L0e},15:{n:"PtgElfColSV",f:U0e},16:{n:"PtgElfRadicalLel",f:Q0e},25:{n:"PtgList",f:G0e},29:{n:"PtgSxName",f:$0e},255:{}},tme={0:{n:"PtgAttrNoop",f:Y0e},1:{n:"PtgAttrSemi",f:o0e},2:{n:"PtgAttrIf",f:a0e},4:{n:"PtgAttrChoose",f:n0e},8:{n:"PtgAttrGoto",f:s0e},16:{n:"PtgAttrSum",f:p0e},32:{n:"PtgAttrBaxcel",f:e3},33:{n:"PtgAttrBaxcel",f:e3},64:{n:"PtgAttrSpace",f:l0e},65:{n:"PtgAttrSpaceSemi",f:c0e},128:{n:"PtgAttrIfError",f:i0e},255:{}};function Hx(t,e,r,n){if(n.biff<8)return gi(t,e);for(var s=t.l+e,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=_0e(t,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=C0e(t,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&a.push(gi(t,e)),a}function Kx(t,e,r){for(var n=t.l+e,s,a,o=[];n!=t.l;)e=n-t.l,a=t[t.l],s=t3[a]||t3[Z0e[a]],(a===24||a===25)&&(s=(a===24?eme:tme)[t[t.l+1]]),!s||!s.f?gi(t,e):o.push([s.n,s.f(t,e,r)]);return o}function rme(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var nme={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sme(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function MQ(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function r3(t,e,r){var n=MQ(t,e,r);return n=="#REF"?n:sme(n,r)}function ui(t,e,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,A,u,d=0,f=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",g=0,y=t[0].length;g<y;++g){var b=t[0][g];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),A=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=Is(" ",t[0][p][1][1]);break;case 1:x=Is("\r",t[0][p][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}A=A+x,p=-1}l.push(A+nme[b[0]]+c);break;case"PtgIsect":c=l.pop(),A=l.pop(),l.push(A+" "+c);break;case"PtgUnion":c=l.pop(),A=l.pop(),l.push(A+","+c);break;case"PtgRange":c=l.pop(),A=l.pop(),l.push(A+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=eg(b[1][1],o,s),l.push(tg(u,a));break;case"PtgRefN":u=r?eg(b[1][1],r,s):b[1][1],l.push(tg(u,a));break;case"PtgRef3d":d=b[1][1],u=eg(b[1][2],o,s),m=r3(n,d,s),l.push(m+"!"+tg(u,a));break;case"PtgFunc":case"PtgFuncVar":var F=b[1][0],P=b[1][1];F||(F=0),F&=127;var R=F==0?[]:l.slice(-F);l.length-=F,P==="User"&&(P=R.shift()),l.push(P+"("+R.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=kP(b[1][1],r?{s:r}:o,s),l.push(eC(h,s));break;case"PtgArea":h=kP(b[1][1],o,s),l.push(eC(h,s));break;case"PtgArea3d":d=b[1][1],h=b[1][2],m=r3(n,d,s),l.push(m+"!"+eC(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=b[1][2];var _=(n.names||[])[f-1]||(n[0]||[])[f],B=_?_.Name:"SH33TJSNAME"+String(f);B&&B.slice(0,6)=="_xlfn."&&!s.xlfn&&(B=B.slice(6)),l.push(B);break;case"PtgNameX":var E=b[1][1];f=b[1][2];var M;if(s.biff<=5)E<0&&(E=-E),n[E]&&(M=n[E][f]);else{var k="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][f]&&n[E][f].itab>0&&(k=n.SheetNames[n[E][f].itab-1]+"!"):k=n.SheetNames[f-1]+"!"),n[E]&&n[E][f])k+=n[E][f].Name;else if(n[0]&&n[0][f])k+=n[0][f].Name;else{var T=(MQ(n,E,s)||"").split(";;");T[f-1]?k=T[f-1]:k+="SH33TJSERRX"}l.push(k);break}M||(M={Name:"SH33TJSERRY"}),l.push(M.Name);break;case"PtgParen":var U="(",Z=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:U=Is(" ",t[0][p][1][1])+U;break;case 3:U=Is("\r",t[0][p][1][1])+U;break;case 4:Z=Is(" ",t[0][p][1][1])+Z;break;case 5:Z=Is("\r",t[0][p][1][1])+Z;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(U+l.pop()+Z);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var pe={c:r.c,r:r.r};if(n.sharedf[Cr(u)]){var ae=n.sharedf[Cr(u)];l.push(ui(ae,o,pe,n,s))}else{var he=!1;for(c=0;c!=n.arrayf.length;++c)if(A=n.arrayf[c],!(u.c<A[0].s.c||u.c>A[0].e.c)&&!(u.r<A[0].s.r||u.r>A[0].e.r)){l.push(ui(A[1],o,pe,n,s)),he=!0;break}he||l.push(b[1])}break;case"PtgArray":l.push("{"+rme(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&de.indexOf(t[0][g][0])==-1){b=t[0][p];var re=!0;switch(b[1][0]){case 4:re=!1;case 0:x=Is(" ",b[1][1]);break;case 5:re=!1;case 1:x=Is("\r",b[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((re?x:"")+l.pop()+(re?"":x)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function ame(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,o=t.read_shift(s);if(o==65535)return[[],gi(t,e-2)];var l=Kx(t,o,r);return e!==o+s&&(a=Hx(t,e-o-s,l,r)),t.l=n,[l,a]}function ime(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,o=t.read_shift(s);if(o==65535)return[[],gi(t,e-2)];var l=Kx(t,o,r);return e!==o+s&&(a=Hx(t,e-o-s,l,r)),t.l=n,[l,a]}function ome(t,e,r,n){var s=t.l+e,a=Kx(t,n,r),o;return s!==t.l&&(o=Hx(t,s-t.l,a,r)),[a,o]}function lme(t,e,r){var n=t.l+e,s,a=t.read_shift(2),o=Kx(t,a,r);return a==65535?[[],gi(t,e-2)]:(e!==a+2&&(s=Hx(t,n-a-2,o,r)),[o,s])}function cme(t){var e;if(lA(t,t.l+6)!==65535)return[fi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Ame(t){if(t==null){var e=Ct(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ph(t);return Ph(0)}function aC(t,e,r){var n=t.l+e,s=Tc(t);r.biff==2&&++t.l;var a=cme(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=ime(t,n-t.l,r);return{cell:s,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function ume(t,e,r,n,s){var a=Dh(e,r,s),o=Ame(t.v),l=Ct(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var A=Ct(t.bf.length),u=0;u<t.bf.length;++u)A[u]=t.bf[u];var d=_a([a,o,l,A]);return d}function Y2(t,e,r){var n=t.read_shift(4),s=Kx(t,n,r),a=t.read_shift(4),o=a>0?Hx(t,a,s,r):null;return[s,o]}var dme=Y2,Z2=Y2,hme=Y2,fme=Y2,mme={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},QQ={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},pme={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function n3(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function gme(t){var e="of:="+t.replace(FI,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function iC(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function xme(t){return t.replace(/\./,"!")}var ng={},b0={},sg=typeof Map<"u";function jI(t,e,r){var n=0,s=t.length;if(r){if(sg?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=sg?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(sg?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function eb(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(hi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=sx(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Ly(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function mh(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function wd(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){gA(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function VQ(t,e,r,n,s,a){try{n.cellNF&&(t.z=Nr[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=es(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Nr[e]==null&&gA(mce[e]||"General",e),t.t==="e")t.w=t.w||PA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xg(t.v);else if(t.t==="d"){var o=ma(t.v);(o|0)===o?t.w=o.toString(10):t.w=Xg(o)}else{if(t.v===void 0)return"";t.w=Th(t.v,b0)}else t.t==="d"?t.w=ml(e,ma(t.v),b0):t.w=ml(e,t.v,b0)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Dy(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Dy(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function vme(t,e,r){if(t&&t["!ref"]){var n=dn(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function wme(t,e){var r=dn(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Dr(r))}var yme=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,bme=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Nme=/<(?:\w:)?hyperlink [^>]*>/mg,Cme=/"(\w*:\w*)"/,_me=/<(?:\w:)?col\b[^>]*[\/]?>/g,Eme=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Bme=/<(?:\w:)?pageMargins[^>]*\/>/g,HQ=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Sme=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Ime=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Fme(t,e,r,n,s,a,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",u="",d=t.match(bme);d?(A=t.slice(0,d.index),u=t.slice(d.index+d[0].length)):A=u=t;var f=A.match(HQ);f?PI(f[0],l,s,r):(f=A.match(Sme))&&Tme(f[0],f[1]||"",l,s,r);var h=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=A.slice(h,h+50).match(Cme);m&&wme(l,m[1])}var p=A.match(Ime);p&&p[1]&&qme(p[1],s);var x=[];if(e.cellStyles){var g=A.match(_me);g&&Mme(x,g)}d&&zme(d[1],l,e,c,a,o);var y=u.match(Eme);y&&(l["!autofilter"]=Vme(y[0]));var b=[],F=u.match(yme);if(F)for(h=0;h!=F.length;++h)b[h]=dn(F[h].slice(F[h].indexOf('"')+1));var P=u.match(Nme);P&&Lme(l,P,n);var R=u.match(Bme);if(R&&(l["!margins"]=Ume(Er(R[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Dr(c)),e.sheetRows>0&&l["!ref"]){var _=dn(l["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Dr(_))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function kme(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Dr(t[r])+'"/>';return e+"</mergeCells>"}function PI(t,e,r,n){var s=Er(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=An(Pn(s.codeName)))}function Tme(t,e,r,n,s){PI(t.slice(0,t.indexOf(">")),r,n,s)}function jme(t,e,r,n,s){var a=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,o.codeName=xc(Fn(c))}if(t&&t["!outline"]){var A={summaryBelow:1,summaryRight:1};t["!outline"].above&&(A.summaryBelow=0),t["!outline"].left&&(A.summaryRight=0),l=(l||"")+zt("outlinePr",null,A)}!a&&!l||(s[s.length]=zt("sheetPr",l,o))}var Pme=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Rme=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Dme(t){var e={sheet:1};return Pme.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Rme.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=BI(t.password).toString(16).toUpperCase()),zt("sheetProtection",null,e)}function Lme(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Er(Pn(e[s]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+An(a.location))):(a.Target="#"+An(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=dn(a.ref),c=l.s.r;c<=l.e.r;++c)for(var A=l.s.c;A<=l.e.c;++A){var u=Cr({c:A,r:c});n?(t[c]||(t[c]=[]),t[c][A]||(t[c][A]={t:"z",v:void 0}),t[c][A].l=a):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=a)}}}function Ume(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Ome(t){return mh(t),zt("pageMargins",null,t)}function Mme(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Er(e[n],!0);s.hidden&&(s.hidden=Xn(s.hidden));var a=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,SI(s.width)),od(s);a<=o;)t[a++]=ts(s)}}function Qme(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=zt("col",null,eb(s,n)));return r[r.length]="</cols>",r.join("")}function Vme(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Hme(t,e,r,n){var s=typeof t.ref=="string"?t.ref:Dr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=to(s);o.s.r==o.e.r&&(o.e.r=to(e["!ref"]).e.r,s=Dr(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),zt("autoFilter",null,{ref:s})}var Kme=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function qme(t,e){e.Views||(e.Views=[{}]),(t.match(Kme)||[]).forEach(function(r,n){var s=Er(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Xn(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function Gme(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),zt("sheetViews",zt("sheetView",null,s),{})}function $me(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=PA[t.v];break;case"d":n&&n.cellDates?s=es(t.v,-1).toISOString():(t=ts(t),t.t="n",s=""+(t.v=ma(es(t.v)))),typeof t.z>"u"&&(t.z=Nr[14]);break;default:s=t.v;break}var l=qa("v",Fn(s)),c={r:e},A=wd(n.cellXfs,t,n);switch(A!==0&&(c.s=A),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=qa("v",""+jI(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=a&&(t.t=a,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=zt("f",Fn(t.f),u)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),zt("c",l,c)}var zme=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Yg("v"),o=Yg("f");return function(c,A,u,d,f,h){for(var m=0,p="",x=[],g=[],y=0,b=0,F=0,P="",R,_,B=0,E=0,M,k,T=0,U=0,Z=Array.isArray(h.CellXf),pe,ae=[],he=[],de=Array.isArray(A),re=[],xe={},Ce=!1,S=!!u.sheetStubs,I=c.split(e),V=0,j=I.length;V!=j;++V){p=I[V].trim();var O=p.length;if(O!==0){var W=0;e:for(m=0;m<O;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(_=Er(p.slice(W,m),!0),B=_.r!=null?parseInt(_.r,10):B+1,E=-1,u.sheetRows&&u.sheetRows<B)continue;xe={},Ce=!1,_.ht&&(Ce=!0,xe.hpt=parseFloat(_.ht),xe.hpx=K0(xe.hpt)),_.hidden=="1"&&(Ce=!0,xe.hidden=!0),_.outlineLevel!=null&&(Ce=!0,xe.level=+_.outlineLevel),Ce&&(re[B-1]=xe)}break;case"<":W=m;break}if(W>=m)break;if(_=Er(p.slice(W,m),!0),B=_.r!=null?parseInt(_.r,10):B+1,E=-1,!(u.sheetRows&&u.sheetRows<B)){d.s.r>B-1&&(d.s.r=B-1),d.e.r<B-1&&(d.e.r=B-1),u&&u.cellStyles&&(xe={},Ce=!1,_.ht&&(Ce=!0,xe.hpt=parseFloat(_.ht),xe.hpx=K0(xe.hpt)),_.hidden=="1"&&(Ce=!0,xe.hidden=!0),_.outlineLevel!=null&&(Ce=!0,xe.level=+_.outlineLevel),Ce&&(re[B-1]=xe)),x=p.slice(m).split(t);for(var D=0;D!=x.length&&x[D].trim().charAt(0)=="<";++D);for(x=x.slice(D),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(g=p.match(r),y=m,b=0,F=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,g!=null&&g.length===2){for(y=0,P=g[1],b=0;b!=P.length&&!((F=P.charCodeAt(b)-64)<1||F>26);++b)y=26*y+F;--y,E=y}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,_=Er(p.slice(0,b),!0),_.r||(_.r=Cr({r:B-1,c:E})),P=p.slice(b),R={t:""},(g=P.match(a))!=null&&g[1]!==""&&(R.v=An(g[1])),u.cellFormula){if((g=P.match(o))!=null&&g[1]!==""){if(R.f=An(Pn(g[1])).replace(/\r\n/g,`
`),u.xlfn||(R.f=ZP(R.f)),g[0].indexOf('t="array"')>-1)R.F=(P.match(s)||[])[1],R.F.indexOf(":")>-1&&ae.push([dn(R.F),R.F]);else if(g[0].indexOf('t="shared"')>-1){k=Er(g[0]);var Y=An(Pn(g[1]));u.xlfn||(Y=ZP(Y)),he[parseInt(k.si,10)]=[k,Y,_.r]}}else(g=P.match(/<f[^>]*\/>/))&&(k=Er(g[0]),he[k.si]&&(R.f=Kfe(he[k.si][1],he[k.si][2],_.r)));var se=ws(_.r);for(b=0;b<ae.length;++b)se.r>=ae[b][0].s.r&&se.r<=ae[b][0].e.r&&se.c>=ae[b][0].s.c&&se.c<=ae[b][0].e.c&&(R.F=ae[b][1])}if(_.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(S)R.t="z";else continue;else R.t=_.t||"n";switch(d.s.c>E&&(d.s.c=E),d.e.c<E&&(d.e.c=E),R.t){case"n":if(R.v==""||R.v==null){if(!S)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!S)continue;R.t="z"}else M=ng[parseInt(R.v,10)],R.v=M.t,R.r=M.r,u.cellHTML&&(R.h=M.h);break;case"str":R.t="s",R.v=R.v!=null?Pn(R.v):"",u.cellHTML&&(R.h=dI(R.v));break;case"inlineStr":g=P.match(n),R.t="s",g!=null&&(M=EI(g[1]))?(R.v=M.t,u.cellHTML&&(R.h=M.h)):R.v="";break;case"b":R.v=Xn(R.v);break;case"d":u.cellDates?R.v=es(R.v,1):(R.v=ma(es(R.v,1)),R.t="n");break;case"e":(!u||u.cellText!==!1)&&(R.w=R.v),R.v=q8[R.v];break}if(T=U=0,pe=null,Z&&_.s!==void 0&&(pe=h.CellXf[_.s],pe!=null&&(pe.numFmtId!=null&&(T=pe.numFmtId),u.cellStyles&&pe.fillId!=null&&(U=pe.fillId))),VQ(R,T,U,u,f,h),u.cellDates&&Z&&R.t=="n"&&lm(Nr[T])&&(R.t="d",R.v=J2(R.v)),_.cm&&u.xlmeta){var ve=(u.xlmeta.Cell||[])[+_.cm-1];ve&&ve.type=="XLDAPR"&&(R.D=!0)}if(de){var z=ws(_.r);A[z.r]||(A[z.r]=[]),A[z.r][z.c]=R}else A[_.r]=R}}}}re.length>0&&(A["!rows"]=re)}}();function Wme(t,e,r,n){var s=[],a=[],o=dn(t["!ref"]),l="",c,A="",u=[],d=0,f=0,h=t["!rows"],m=Array.isArray(t),p={r:A},x,g=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=vs(f);for(d=o.s.r;d<=o.e.r;++d){for(a=[],A=Ks(d),f=o.s.c;f<=o.e.c;++f){c=u[f]+A;var y=m?(t[d]||[])[f]:t[c];y!==void 0&&(l=$me(y,c,t,e))!=null&&a.push(l)}(a.length>0||h&&h[d])&&(p={r:A},h&&h[d]&&(x=h[d],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=ax(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),s[s.length]=zt("row",a.join(""),p))}if(h)for(;d<h.length;++d)h&&h[d]&&(p={r:d+1},x=h[d],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=ax(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level),s[s.length]=zt("row","",p));return s.join("")}function KQ(t,e,r,n){var s=[Gs,zt("worksheet",null,{xmlns:Jh[0],"xmlns:r":ua.r})],a=r.SheetNames[t],o=0,l="",c=r.Sheets[a];c==null&&(c={});var A=c["!ref"]||"A1",u=dn(A);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+A+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),A=Dr(u)}n||(n={}),c["!comments"]=[];var d=[];jme(c,r,t,e,s),s[s.length]=zt("dimension",null,{ref:A}),s[s.length]=Gme(c,e,t,r),e.sheetFormat&&(s[s.length]=zt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Qme(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Wme(c,e),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=Dme(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=Hme(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=kme(c["!merges"]));var f=-1,h,m=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Bn(n,-1,Fn(p[1].Target).replace(/#.*$/,""),$r.HLINK),h["r:id"]="rId"+m),(f=p[1].Target.indexOf("#"))>-1&&(h.location=Fn(p[1].Target.slice(f+1))),p[1].Tooltip&&(h.tooltip=Fn(p[1].Tooltip)),s[s.length]=zt("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Ome(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=qa("ignoredErrors",zt("ignoredError",null,{numberStoredAsText:1,sqref:A}))),d.length>0&&(m=Bn(n,-1,"../drawings/drawing"+(t+1)+".xml",$r.DRAW),s[s.length]=zt("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=d),c["!comments"].length>0&&(m=Bn(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",$r.VML),s[s.length]=zt("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Jme(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function Xme(t,e,r){var n=Ct(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=ax(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var A={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var d=-1,f=-1,h=u<<10;h<u+1<<10;++h){A.c=h;var m=Array.isArray(r)?(r[A.r]||[])[A.c]:r[Cr(A)];m&&(d<0&&(d=h),f=h)}d<0||(++l,n.write_shift(4,d),n.write_shift(4,f))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function Yme(t,e,r,n){var s=Xme(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&Rt(t,0,s)}var Zme=ef,epe=um;function tpe(){}function rpe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=aAe(t),r}function npe(t,e,r){r==null&&(r=Ct(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return jy({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),M8(t,r),r.slice(0,r.l)}function spe(t){var e=pl(t);return[e]}function ape(t,e,r){return r==null&&(r=Ct(8)),Xh(e,r)}function ipe(t){var e=Yh(t);return[e]}function ope(t,e,r){return r==null&&(r=Ct(4)),Zh(e,r)}function lpe(t){var e=pl(t),r=t.read_shift(1);return[e,r,"b"]}function cpe(t,e,r){return r==null&&(r=Ct(9)),Xh(e,r),r.write_shift(1,t.v?1:0),r}function Ape(t){var e=Yh(t),r=t.read_shift(1);return[e,r,"b"]}function upe(t,e,r){return r==null&&(r=Ct(5)),Zh(e,r),r.write_shift(1,t.v?1:0),r}function dpe(t){var e=pl(t),r=t.read_shift(1);return[e,r,"e"]}function hpe(t,e,r){return r==null&&(r=Ct(9)),Xh(e,r),r.write_shift(1,t.v),r}function fpe(t){var e=Yh(t),r=t.read_shift(1);return[e,r,"e"]}function mpe(t,e,r){return r==null&&(r=Ct(8)),Zh(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ppe(t){var e=pl(t),r=t.read_shift(4);return[e,r,"s"]}function gpe(t,e,r){return r==null&&(r=Ct(12)),Xh(e,r),r.write_shift(4,e.v),r}function xpe(t){var e=Yh(t),r=t.read_shift(4);return[e,r,"s"]}function vpe(t,e,r){return r==null&&(r=Ct(8)),Zh(e,r),r.write_shift(4,e.v),r}function wpe(t){var e=pl(t),r=fi(t);return[e,r,"n"]}function ype(t,e,r){return r==null&&(r=Ct(16)),Xh(e,r),Ph(t.v,r),r}function qQ(t){var e=Yh(t),r=fi(t);return[e,r,"n"]}function bpe(t,e,r){return r==null&&(r=Ct(12)),Zh(e,r),Ph(t.v,r),r}function Npe(t){var e=pl(t),r=yI(t);return[e,r,"n"]}function Cpe(t,e,r){return r==null&&(r=Ct(12)),Xh(e,r),Q8(t.v,r),r}function _pe(t){var e=Yh(t),r=yI(t);return[e,r,"n"]}function Epe(t,e,r){return r==null&&(r=Ct(8)),Zh(e,r),Q8(t.v,r),r}function Bpe(t){var e=pl(t),r=xI(t);return[e,r,"is"]}function Spe(t){var e=pl(t),r=mi(t);return[e,r,"str"]}function Ipe(t,e,r){return r==null&&(r=Ct(12+4*t.v.length)),Xh(e,r),Ea(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Fpe(t){var e=Yh(t),r=mi(t);return[e,r,"str"]}function kpe(t,e,r){return r==null&&(r=Ct(8+4*t.v.length)),Zh(e,r),Ea(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Tpe(t,e,r){var n=t.l+e,s=pl(t);s.r=r["!row"];var a=t.read_shift(1),o=[s,a,"b"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=ui(l,null,s,r.supbooks,r)}else t.l=n;return o}function jpe(t,e,r){var n=t.l+e,s=pl(t);s.r=r["!row"];var a=t.read_shift(1),o=[s,a,"e"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=ui(l,null,s,r.supbooks,r)}else t.l=n;return o}function Ppe(t,e,r){var n=t.l+e,s=pl(t);s.r=r["!row"];var a=fi(t),o=[s,a,"n"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=ui(l,null,s,r.supbooks,r)}else t.l=n;return o}function Rpe(t,e,r){var n=t.l+e,s=pl(t);s.r=r["!row"];var a=mi(t),o=[s,a,"str"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=ui(l,null,s,r.supbooks,r)}else t.l=n;return o}var Dpe=ef,Lpe=um;function Upe(t,e){return e==null&&(e=Ct(4)),e.write_shift(4,t),e}function Ope(t,e){var r=t.l+e,n=ef(t),s=vI(t),a=mi(t),o=mi(t),l=mi(t);t.l=r;var c={rfx:n,relId:s,loc:a,display:l};return o&&(c.Tooltip=o),c}function Mpe(t,e){var r=Ct(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));um({s:ws(t[0]),e:ws(t[0])},r),wI("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Ea(s||"",r),Ea(t[1].Tooltip||"",r),Ea("",r),r.slice(0,r.l)}function Qpe(){}function Vpe(t,e,r){var n=t.l+e,s=V8(t),a=t.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=dme(t,n-t.l,r);o[1]=l}else t.l=n;return o}function Hpe(t,e,r){var n=t.l+e,s=ef(t),a=[s];if(r.cellFormula){var o=fme(t,n-t.l,r);a[1]=o,t.l=n}else t.l=n;return a}function Kpe(t,e,r){r==null&&(r=Ct(18));var n=eb(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var GQ=["left","right","top","bottom","header","footer"];function qpe(t){var e={};return GQ.forEach(function(r){e[r]=fi(t)}),e}function Gpe(t,e){return e==null&&(e=Ct(6*8)),mh(t),GQ.forEach(function(r){Ph(t[r],e)}),e}function $pe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function zpe(t,e,r){r==null&&(r=Ct(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Wpe(t){var e=Ct(24);return e.write_shift(4,4),e.write_shift(4,1),um(t,e),e}function Jpe(t,e){return e==null&&(e=Ct(16*4+2)),e.write_shift(2,t.password?BI(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Xpe(){}function Ype(){}function Zpe(t,e,r,n,s,a,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},A,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,f=!1,h,m,p,x,g,y,b,F,P,R=[];l.biff=12,l["!row"]=0;var _=0,B=!1,E=[],M={},k=l.supbooks||s.supbooks||[[]];if(k.sharedf=M,k.arrayf=E,k.SheetNames=s.SheetNames||s.Sheets.map(function(de){return de.name}),!l.supbooks&&(l.supbooks=k,s.Names))for(var T=0;T<s.Names.length;++T)k[0][T+1]=s.Names[T];var U=[],Z=[],pe=!1;ix[16]={n:"BrtShortReal",f:qQ};var ae;if(jA(t,function(re,xe,Ce){if(!f)switch(Ce){case 148:A=re;break;case 0:h=re,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),F=Ks(x=h.r),l["!row"]=h.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=K0(re.hpt)),Z[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:re[2]},re[2]){case"n":m.v=re[1];break;case"s":b=ng[re[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!re[1];break;case"e":m.v=re[1],l.cellText!==!1&&(m.w=PA[m.v]);break;case"str":m.t="s",m.v=re[1];break;case"is":m.t="s",m.v=re[1].t;break}if((p=o.CellXf[re[0].iStyleRef])&&VQ(m,p.numFmtId,null,l,a,o),g=re[0].c==-1?g+1:re[0].c,l.dense?(c[x]||(c[x]=[]),c[x][g]=m):c[vs(g)+F]=m,l.cellFormula){for(B=!1,_=0;_<E.length;++_){var S=E[_];h.r>=S[0].s.r&&h.r<=S[0].e.r&&g>=S[0].s.c&&g<=S[0].e.c&&(m.F=Dr(S[0]),B=!0)}!B&&re.length>3&&(m.f=re[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),l.cellDates&&p&&m.t=="n"&&lm(Nr[p.numFmtId])){var I=rh(m.v);I&&(m.t="d",m.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 1:case 12:if(!l.sheetStubs||d)break;m={t:"z",v:void 0},g=re[0].c==-1?g+1:re[0].c,l.dense?(c[x]||(c[x]=[]),c[x][g]=m):c[vs(g)+F]=m,u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 176:R.push(re);break;case 49:ae=((l.xlmeta||{}).Cell||[])[re-1];break;case 494:var V=n["!id"][re.relId];for(V?(re.Target=V.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=V):re.relId==""&&(re.Target="#"+re.loc),x=re.rfx.s.r;x<=re.rfx.e.r;++x)for(g=re.rfx.s.c;g<=re.rfx.e.c;++g)l.dense?(c[x]||(c[x]=[]),c[x][g]||(c[x][g]={t:"z",v:void 0}),c[x][g].l=re):(y=Cr({c:g,r:x}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=re);break;case 426:if(!l.cellFormula)break;E.push(re),P=l.dense?c[x][g]:c[vs(g)+F],P.f=ui(re[1],u,{r:h.r,c:g},k,l),P.F=Dr(re[0]);break;case 427:if(!l.cellFormula)break;M[Cr(re[0].s)]=re[1],P=l.dense?c[x][g]:c[vs(g)+F],P.f=ui(re[1],u,{r:h.r,c:g},k,l);break;case 60:if(!l.cellStyles)break;for(;re.e>=re.s;)U[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},pe||(pe=!0,SI(re.w/256)),od(U[re.e+1]);break;case 161:c["!autofilter"]={ref:Dr(re)};break;case 476:c["!margins"]=re;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),re.name&&(s.Sheets[r].CodeName=re.name),(re.above||re.left)&&(c["!outline"]={above:re.above,left:re.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),re.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!xe.T){if(!d||l.WTF)throw new Error("Unexpected record 0x"+Ce.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(c["!ref"]=Dr(A||u)),l.sheetRows&&c["!ref"]){var he=dn(c["!ref"]);l.sheetRows<=+he.e.r&&(he.e.r=l.sheetRows-1,he.e.r>u.e.r&&(he.e.r=u.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>u.e.c&&(he.e.c=u.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Dr(he))}return R.length>0&&(c["!merges"]=R),U.length>0&&(c["!cols"]=U),Z.length>0&&(c["!rows"]=Z),c}function ege(t,e,r,n,s,a,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=ts(e),e.z=e.z||Nr[14],e.v=ma(es(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=wd(s.cellXfs,e,s),e.l&&a["!links"].push([Cr(c),e.l]),e.c&&a["!comments"].push([Cr(c),e.c]),e.t){case"s":case"str":return s.bookSST?(l=jI(s.Strings,e.v,s.revStrings),c.t="s",c.v=l,o?Rt(t,18,vpe(e,c)):Rt(t,7,gpe(e,c))):(c.t="str",o?Rt(t,17,kpe(e,c)):Rt(t,6,Ipe(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Rt(t,13,Epe(e,c)):Rt(t,2,Cpe(e,c)):o?Rt(t,16,bpe(e,c)):Rt(t,5,ype(e,c)),!0;case"b":return c.t="b",o?Rt(t,15,upe(e,c)):Rt(t,4,cpe(e,c)),!0;case"e":return c.t="e",o?Rt(t,14,mpe(e,c)):Rt(t,3,hpe(e,c)),!0}return o?Rt(t,12,ope(e,c)):Rt(t,1,ape(e,c)),!0}function tge(t,e,r,n){var s=dn(e["!ref"]||"A1"),a,o="",l=[];Rt(t,145);var c=Array.isArray(e),A=s.e.r;e["!rows"]&&(A=Math.max(s.e.r,e["!rows"].length-1));for(var u=s.s.r;u<=A;++u){o=Ks(u),Yme(t,e,s,u);var d=!1;if(u<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=vs(f)),a=l[f]+o;var h=c?(e[u]||[])[f]:e[a];if(!h){d=!1;continue}d=ege(t,h,u,f,n,e,d)}}Rt(t,146)}function rge(t,e){!e||!e["!merges"]||(Rt(t,177,Upe(e["!merges"].length)),e["!merges"].forEach(function(r){Rt(t,176,Lpe(r))}),Rt(t,178))}function nge(t,e){!e||!e["!cols"]||(Rt(t,390),e["!cols"].forEach(function(r,n){r&&Rt(t,60,Kpe(n,r))}),Rt(t,391))}function sge(t,e){!e||!e["!ref"]||(Rt(t,648),Rt(t,649,Wpe(dn(e["!ref"]))),Rt(t,650))}function age(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Bn(r,-1,n[1].Target.replace(/#.*$/,""),$r.HLINK);Rt(t,494,Mpe(n,s))}}),delete e["!links"]}function ige(t,e,r,n){if(e["!comments"].length>0){var s=Bn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$r.VML);Rt(t,551,wI("rId"+s)),e["!legacy"]=s}}function oge(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:Dr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=to(a);l.s.r==l.e.r&&(l.e.r=to(e["!ref"]).e.r,a=Dr(l));for(var c=0;c<o.length;++c){var A=o[c];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==n){A.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Rt(t,161,um(dn(a))),Rt(t,162)}}function lge(t,e,r){Rt(t,133),Rt(t,137,zpe(e,r)),Rt(t,138),Rt(t,134)}function cge(t,e){e["!protect"]&&Rt(t,535,Jpe(e["!protect"]))}function Age(t,e,r,n){var s=eo(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=dn(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Rt(s,129),(r.vbaraw||o["!outline"])&&Rt(s,147,npe(l,o["!outline"])),Rt(s,148,epe(c)),lge(s,o,r.Workbook),nge(s,o),tge(s,o,t,e),cge(s,o),oge(s,o,r,t),rge(s,o),age(s,o,n),o["!margins"]&&Rt(s,476,Gpe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&sge(s,o),ige(s,o,t,n),Rt(s,130),s.end()}function uge(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var s=An((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function dge(t,e,r,n,s,a){var o=a||{"!type":"chart"};if(!t)return a;var l=0,c=0,A="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=uge(d);u.s.r=u.s.c=0,u.e.c=l,A=vs(l),f[0].forEach(function(h,m){o[A+Ks(m)]={t:"n",v:h,z:f[1]},c=m}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Dr(u)),o}function hge(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(HQ);return l&&PI(l[0],a,s,r),(o=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function fge(t,e){t.l+=10;var r=mi(t);return{name:r}}function mge(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return jA(t,function(c,A,u){switch(u){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var RI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gge=[],xge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function s3(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Xn(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function a3(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Xn(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function $Q(t){a3(t.WBProps,RI),a3(t.CalcPr,xge),s3(t.WBView,pge),s3(t.Sheets,gge),b0.date1904=Xn(t.WBProps.date1904)}function vge(t){return!t.Workbook||!t.Workbook.WBProps?"false":Xn(t.Workbook.WBProps.date1904)?"true":"false"}var wge="][*?/\\".split("");function zQ(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return wge.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function yge(t,e,r){t.forEach(function(n,s){zQ(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[s]&&e[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function bge(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];yge(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)vme(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Nge=/<\w+:workbook/;function Cge(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},o=0;if(t.replace(xi,function(c,A){var u=Er(c);switch(kc(u[0])){case"<?xml":break;case"<workbook":c.match(Nge)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":RI.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Xn(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=Pn(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=An(Pn(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Pn(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Xn(u.hidden||"0")&&(a.Hidden=!0),o=A+c.length;break;case"</definedName>":a.Ref=An(Pn(t.slice(o,A))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Jh.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $Q(r),r}function WQ(t){var e=[Gs];e[e.length]=zt("workbook",null,{xmlns:Jh[0],"xmlns:r":ua.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(RI.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=zt("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var o={name:Fn(t.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=zt("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=zt("definedName",Fn(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function _ge(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=SE(t),r.name=mi(t),r}function Ege(t,e){return e||(e=Ct(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),wI(t.strRelID,e),Ea(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Bge(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?mi(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Sge(t,e){e||(e=Ct(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),M8(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Ige(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Fge(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=iAe(t),o=hme(t,0,r),l=vI(t);t.l=n;var c={Name:a,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function kge(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],ix[16]={n:"BrtFRTArchID$",f:Ige},jA(t,function(c,A,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=ui(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!A.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),$Q(r),r.Names=a,r.supbooks=o,r}function Tge(t,e){Rt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Rt(t,156,Ege(s))}Rt(t,144)}function jge(t,e){e||(e=Ct(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ea("SheetJS",e),Ea(Ey.version,e),Ea(Ey.version,e),Ea("7262",e),e.length>e.l?e.slice(0,e.l):e}function Pge(t,e){e||(e=Ct(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Rge(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Rt(t,135),Rt(t,158,Pge(s)),Rt(t,136))}}function Dge(t,e){var r=eo();return Rt(r,131),Rt(r,128,jge()),Rt(r,153,Sge(t.Workbook&&t.Workbook.WBProps||null)),Rge(r,t),Tge(r,t),Rt(r,132),r.end()}function Lge(t,e,r){return e.slice(-4)===".bin"?kge(t,r):Cge(t,r)}function Uge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Zpe(t,n,r,s,a,o,l):Fme(t,n,r,s,a,o,l)}function Oge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?mge(t,n,r,s,a):hge(t,n,r,s,a)}function Mge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Vfe():Hfe()}function Qge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Mfe():Qfe()}function Vge(t,e,r,n){return e.slice(-4)===".bin"?Lhe(t,r,n):_he(t,r,n)}function Hge(t,e,r){return IQ(t,r)}function Kge(t,e,r){return e.slice(-4)===".bin"?Kde(t,r):Qde(t,r)}function qge(t,e,r){return e.slice(-4)===".bin"?Rfe(t,r):Efe(t,r)}function Gge(t,e,r){return e.slice(-4)===".bin"?Nfe(t):yfe(t)}function $ge(t,e,r,n){return r.slice(-4)===".bin"?Cfe(t,e,r,n):void 0}function zge(t,e,r){return e.slice(-4)===".bin"?xfe(t,e,r):wfe(t,e,r)}function Wge(t,e,r){return(e.slice(-4)===".bin"?Dge:WQ)(t)}function Jge(t,e,r,n,s){return(e.slice(-4)===".bin"?Age:KQ)(t,r,n,s)}function Xge(t,e,r){return(e.slice(-4)===".bin"?$he:BQ)(t,r)}function Yge(t,e,r){return(e.slice(-4)===".bin"?$de:vQ)(t,r)}function Zge(t,e,r){return(e.slice(-4)===".bin"?Dfe:TQ)(t)}function exe(t){return(t.slice(-4)===".bin"?vfe:FQ)()}var JQ=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,XQ=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function El(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(JQ),a,o,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(XQ),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function txe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(JQ),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(XQ),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}var ag;function rxe(t,e){var r=ag[t]||An(t);return r==="General"?Th(e):ml(r,e)}function nxe(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Xn(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=es(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[An(e)]=s}function sxe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||PA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xg(t.v):t.w=Th(t.v):t.w=rxe(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=ag[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&lm(n)){var s=rh(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function axe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=ghe[n.Pattern]||n.Pattern)}t[e.ID]=e}function ixe(t,e,r,n,s,a,o,l,c,A){var u="General",d=n.StyleID,f={};A=A||{};var h=[],m=0;for(d===void 0&&l&&(d=l.StyleID),d===void 0&&o&&(d=o.StyleID);a[d]!==void 0&&(a[d].nf&&(u=a[d].nf),a[d].Interior&&h.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Xn(t);break;case"String":n.t="s",n.r=bP(An(t)),n.v=t.indexOf("<")>-1?An(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(es(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=An(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=q8[t],A.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=bP(e||t));break}if(sxe(n,u,A),A.cellFormula!==!1)if(n.Formula){var p=An(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=y0(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=y0("RC:RC",s):n.ArrayRange&&(n.F=y0(n.ArrayRange,s),c.push([dn(n.F),n.F]))}else for(m=0;m<c.length;++m)s.r>=c[m][0].s.r&&s.r<=c[m][0].e.r&&s.c>=c[m][0].s.c&&s.c<=c[m][0].e.c&&(n.F=c[m][1]);A.cellStyles&&(h.forEach(function(x){!f.patternType&&x.patternType&&(f.patternType=x.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function oxe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function oC(t,e){var r=e||{};cm();var n=bp(hI(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Pn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=ts(r);return o.type="string",H0.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(fe){s.indexOf("<"+fe)>=0&&(a=!0)}),a)return Gxe(n,r);ag={"General Number":"General","General Date":Nr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Nr[15],"Short Date":Nr[14],"Long Time":Nr[19],"Medium Time":Nr[18],"Short Time":Nr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Nr[2],Standard:Nr[4],Percent:Nr[10],Scientific:Nr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],A,u={},d=[],f=r.dense?[]:{},h="",m={},p={},x=El('<Data ss:Type="String">'),g=0,y=0,b=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},R={},_="",B=0,E=[],M={},k={},T=0,U=[],Z=[],pe={},ae=[],he,de=!1,re=[],xe=[],Ce={},S=0,I=0,V={Sheets:[],WBProps:{date1904:!1}},j={};ex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var O="";l=ex.exec(n);)switch(l[3]=(O=l[3]).toLowerCase()){case"data":if(O=="data"){if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?ixe(n.slice(g,l.index),_,x,c[c.length-1][0]=="comment"?pe:m,{c:y,r:b},P,ae[y],p,re,r):(_="",x=El(l[0]),g=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Z.length>0&&(m.c=Z),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(f[b]||(f[b]=[]),f[b][y]=m):f[vs(y)+Ks(b)]=m),m.HRef&&(m.l={Target:An(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(S=y+(parseInt(m.MergeAcross,10)|0),I=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:y,r:b},e:{c:S,r:I}})),!r.sheetStubs)m.MergeAcross?y=S+1:++y;else if(m.MergeAcross||m.MergeDown){for(var W=y;W<=S;++W)for(var D=b;D<=I;++D)(W>y||D>b)&&(r.dense?(f[D]||(f[D]=[]),f[D][W]={t:"z"}):f[vs(W)+Ks(D)]={t:"z"});y=S+1}else++y;else m=txe(l[0]),m.Index&&(y=+m.Index-1),y<F.s.c&&(F.s.c=y),y>F.e.c&&(F.e.c=y),l[0].slice(-2)==="/>"&&++y,Z=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<F.s.r&&(F.s.r=b),b>F.e.r&&(F.e.r=b),l[0].slice(-2)==="/>"&&(p=El(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=El(l[0]),p.Index&&(b=+p.Index-1),Ce={},(p.AutoFitHeight=="0"||p.Height)&&(Ce.hpx=parseInt(p.Height,10),Ce.hpt=ax(Ce.hpx),xe[b]=Ce),p.Hidden=="1"&&(Ce.hidden=!0,xe[b]=Ce));break;case"worksheet":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));d.push(h),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(f["!ref"]=Dr(F),r.sheetRows&&r.sheetRows<=F.e.r&&(f["!fullref"]=f["!ref"],F.e.r=r.sheetRows-1,f["!ref"]=Dr(F))),E.length&&(f["!merges"]=E),ae.length>0&&(f["!cols"]=ae),xe.length>0&&(f["!rows"]=xe),u[h]=f}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),A=El(l[0]),h=An(A.Name),f=r.dense?[]:{},E=[],re=[],xe=[],j={name:h,Hidden:0},V.Sheets.push(j);break;case"table":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ae=[],de=!1}break;case"style":l[1]==="/"?axe(P,R,r):R=El(l[0]);break;case"numberformat":R.nf=An(El(l[0]).Format||"General"),ag[R.nf]&&(R.nf=ag[R.nf]);for(var Y=0;Y!=392&&Nr[Y]!=R.nf;++Y);if(Y==392){for(Y=57;Y!=392;++Y)if(Nr[Y]==null){gA(R.nf,Y);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(he=El(l[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!de&&he.wpx>10){de=!0,hi=_Q;for(var se=0;se<ae.length;++se)ae[se]&&od(ae[se])}de&&od(he),ae[he.Index-1||ae.length]=he;for(var ve=0;ve<+he.Span;++ve)ae[ae.length]=ts(he);break;case"namedrange":if(l[1]==="/")break;V.Names||(V.Names=[]);var z=Er(l[0]),Oe={Name:z.Name,Ref:y0(z.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(Oe.Sheet=V.Sheets.length-1),V.Names.push(Oe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=n.slice(B,l.index):B=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=El(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?kAe(M,O,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));oxe(pe),Z.push(pe)}else c.push([l[3],!1]),A=El(l[0]),pe={a:A.Author};break;case"autofilter":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var te=El(l[0]);f["!autofilter"]={ref:y0(te.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return A3(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(l[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else T=l.index+l[0].length;break;case"header":f["!margins"]||mh(f["!margins"]={},"xlml"),isNaN(+Er(l[0]).Margin)||(f["!margins"].header=+Er(l[0]).Margin);break;case"footer":f["!margins"]||mh(f["!margins"]={},"xlml"),isNaN(+Er(l[0]).Margin)||(f["!margins"].footer=+Er(l[0]).Margin);break;case"pagemargins":var q=Er(l[0]);f["!margins"]||mh(f["!margins"]={},"xlml"),isNaN(+q.Top)||(f["!margins"].top=+q.Top),isNaN(+q.Left)||(f["!margins"].left=+q.Left),isNaN(+q.Right)||(f["!margins"].right=+q.Right),isNaN(+q.Bottom)||(f["!margins"].bottom=+q.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?nxe(k,O,U,n.slice(T,l.index)):(U=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ie={};return!r.bookSheets&&!r.bookProps&&(ie.Sheets=u),ie.SheetNames=d,ie.Workbook=V,ie.SSF=ts(Nr),ie.Props=M,ie.Custprops=k,ie}function RE(t,e){switch(LI(e=e||{}),e.type||"base64"){case"base64":return oC(To(t),e);case"binary":case"buffer":case"file":return oC(t,e);case"array":return oC(xd(t),e)}}function lxe(t,e){var r=[];return t.Props&&r.push(TAe(t.Props,e)),t.Custprops&&r.push(jAe(t.Props,t.Custprops)),r.join("")}function cxe(){return""}function Axe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push(zt("NumberFormat",null,{"ss:Format":Fn(Nr[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(zt("Style",a.join(""),o))}),zt("Styles",r.join(""))}function YQ(t){return zt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+kI(t.Ref,{r:0,c:0})})}function uxe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(YQ(s)))}return zt("Names",r.join(""))}function dxe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(YQ(l)))}return a.join("")}function hxe(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(zt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(zt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(zt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(zt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(qa("ProtectContents","True")),t["!protect"].objects&&s.push(qa("ProtectObjects","True")),t["!protect"].scenarios&&s.push(qa("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(qa("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(qa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":zt("WorksheetOptions",s.join(""),{xmlns:yo.x})}function fxe(t){return t.map(function(e){var r=Rce(e.t||""),n=zt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return zt("Comment",n,{"ss:Author":e.a})}).join("")}function mxe(t,e,r,n,s,a,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Fn(kI(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=ws(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Fn(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Fn(t.l.Tooltip))),r["!merges"])for(var A=r["!merges"],u=0;u!=A.length;++u)A[u].s.c!=o.c||A[u].s.r!=o.r||(A[u].e.c>A[u].s.c&&(l["ss:MergeAcross"]=A[u].e.c-A[u].s.c),A[u].e.r>A[u].s.r&&(l["ss:MergeDown"]=A[u].e.r-A[u].s.r));var d="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",f=String(t.v);break;case"b":d="Boolean",f=t.v?"1":"0";break;case"e":d="Error",f=PA[t.v];break;case"d":d="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Nr[14]);break;case"s":d="String",f=Pce(t.v||"");break}var h=wd(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?f:"",p=t.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=fxe(t.c)),zt("Cell",p,l)}function pxe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=K0(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gxe(t,e,r,n){if(!t["!ref"])return"";var s=dn(t["!ref"]),a=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,g){od(x);var y=!!x.width,b=eb(g,x),F={"ss:Index":g+1};y&&(F["ss:Width"]=nx(b.width)),x.hidden&&(F["ss:Hidden"]="1"),l.push(zt("Column",null,F))});for(var c=Array.isArray(t),A=s.s.r;A<=s.e.r;++A){for(var u=[pxe(A,(t["!rows"]||[])[A])],d=s.s.c;d<=s.e.c;++d){var f=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>d)&&!(a[o].s.r>A)&&!(a[o].e.c<d)&&!(a[o].e.r<A)){(a[o].s.c!=d||a[o].s.r!=A)&&(f=!0);break}if(!f){var h={r:A,c:d},m=Cr(h),p=c?(t[A]||[])[d]:t[m];u.push(mxe(p,m,t,e,r,n,h))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function xxe(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],o=a?dxe(a,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?gxe(a,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(hxe(a,e,t,r)),n.join("")}function vxe(t,e){e||(e={}),t.SSF||(t.SSF=ts(Nr)),t.SSF&&(cm(),$2(t.SSF),e.revssf=W2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],wd(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(lxe(t,e)),r.push(cxe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(zt("Worksheet",xxe(n,e,t),{"ss:Name":Fn(t.SheetNames[n])}));return r[2]=Axe(t,e),r[3]=uxe(t),Gs+zt("Workbook",r.join(""),{xmlns:yo.ss,"xmlns:o":yo.o,"xmlns:x":yo.x,"xmlns:ss":yo.ss,"xmlns:dt":yo.dt,"xmlns:html":yo.html})}function wxe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=uAe(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=dAe(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var yxe=[60,1084,2066,2165,2175];function bxe(t,e,r,n,s){var a=n,o=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=a;for(var c=lA(r,r.l),A=DE[c],u=0;A!=null&&yxe.indexOf(c)>-1;)a=lA(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+a),o.push(l),r.l+=4+a,A=DE[c=lA(r,r.l)];var d=_a(o);Ha(d,0);var f=0;d.lens=[];for(var h=0;h<o.length;++h)d.lens.push(f),f+=o[h].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,s)}function oc(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Nr[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||PA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xg(t.v):t.w=Th(t.v):t.w=ml(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&lm(Nr[n]||String(n))){var s=rh(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function k1(t,e,r){return{v:t,ixfe:e,t:r}}function Nxe(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},o={},l=null,c=[],A="",u={},d,f="",h,m,p,x,g={},y=[],b,F,P=[],R=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},E=function(_e){return _e<8?dh[_e]:_e<64&&R[_e-8]||dh[_e]},M=function(_e,G,Ne){var Ue=G.XF.data;if(!(!Ue||!Ue.patternType||!Ne||!Ne.cellStyles)){G.s={},G.s.patternType=Ue.patternType;var $e;($e=rx(E(Ue.icvFore)))&&(G.s.fgColor={rgb:$e}),($e=rx(E(Ue.icvBack)))&&(G.s.bgColor={rgb:$e})}},k=function(_e,G,Ne){if(!(Ce>1)&&!(Ne.sheetRows&&_e.r>=Ne.sheetRows)){if(Ne.cellStyles&&G.XF&&G.XF.data&&M(_e,G,Ne),delete G.ixfe,delete G.XF,d=_e,f=Cr(_e),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),_e.r<o.s.r&&(o.s.r=_e.r),_e.c<o.s.c&&(o.s.c=_e.c),_e.r+1>o.e.r&&(o.e.r=_e.r+1),_e.c+1>o.e.c&&(o.e.c=_e.c+1),Ne.cellFormula&&G.f){for(var Ue=0;Ue<y.length;++Ue)if(!(y[Ue][0].s.c>_e.c||y[Ue][0].s.r>_e.r)&&!(y[Ue][0].e.c<_e.c||y[Ue][0].e.r<_e.r)){G.F=Dr(y[Ue][0]),(y[Ue][0].s.c!=_e.c||y[Ue][0].s.r!=_e.r)&&delete G.f,G.f&&(G.f=""+ui(y[Ue][1],o,_e,re,T));break}}Ne.dense?(s[_e.r]||(s[_e.r]=[]),s[_e.r][_e.c]=G):s[f]=G}},T={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var U,Z=[],pe=[],ae=[],he=[],de=!1,re=[];re.SheetNames=T.snames,re.sharedf=T.sharedf,re.arrayf=T.arrayf,re.names=[],re.XTI=[];var xe=0,Ce=0,S=0,I=[],V=[],j;T.codepage=1200,jl(1200);for(var O=!1;t.l<t.length-1;){var W=t.l,D=t.read_shift(2);if(D===0&&xe===10)break;var Y=t.l===t.length?0:t.read_shift(2),se=DE[D];if(se&&se.f){if(e.bookSheets&&xe===133&&D!==133)break;if(xe=D,se.r===2||se.r==12){var ve=t.read_shift(2);if(Y-=2,!T.enc&&ve!==D&&((ve&255)<<8|ve>>8)!==D)throw new Error("rt mismatch: "+ve+"!="+D);se.r==12&&(t.l+=10,Y-=10)}var z={};if(D===10?z=se.f(t,Y,T):z=bxe(D,se,t,Y,T),Ce==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(D){case 34:r.opts.Date1904=_.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=z;break;case 66:var Oe=Number(z);switch(Oe){case 21010:Oe=1200;break;case 32768:Oe=1e4;break;case 32769:Oe=1252;break}jl(T.codepage=Oe),O=!0;break;case 317:T.rrtabid=z;break;case 25:T.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:T.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:P.push(z);break;case 430:re.push([z]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(z);break;case 24:case 536:j={Name:z.Name,Ref:ui(z.rgce,o,null,re,T)},z.itab>0&&(j.Sheet=z.itab-1),re.names.push(j),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(V[z.itab-1]={ref:Dr(z.rgce[0][0][1][2])});break;case 22:T.ExternCount=z;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(z),re.XTI=re.XTI.concat(z);break;case 2196:if(T.biff<8)break;j!=null&&(j.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&T.WTF&&console.error("Password verifier: "+z);break;case 133:a[z.pos]=z,T.snames.push(z.name);break;case 10:{if(--Ce)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Dr(o),e.sheetRows&&e.sheetRows<=o.e.r){var te=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Dr(o),o.e.r=te}o.e.r++,o.e.c++}Z.length>0&&(s["!merges"]=Z),pe.length>0&&(s["!objects"]=pe),ae.length>0&&(s["!cols"]=ae),he.length>0&&(s["!rows"]=he),_.Sheets.push(B)}A===""?u=s:n[A]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[D]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),T.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(T.biff=5,O=!0,jl(T.codepage=28591)),T.biff==8&&z.BIFFVer==0&&z.dt==16&&(T.biff=2),Ce++)break;if(s=e.dense?[]:{},T.biff<8&&!O&&(O=!0,jl(T.codepage=e.codepage||1252)),T.biff<5||z.BIFFVer==0&&z.dt==4096){A===""&&(A="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:t.l-Y,name:A};a[J.pos]=J,T.snames.push(A)}else A=(a[W]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),Z=[],pe=[],T.arrayf=y=[],ae=[],he=[],de=!1,B={Hidden:(a[W]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[z.r]||[])[z.c]:s[Cr({c:z.c,r:z.r})])&&++z.c,b={ixfe:z.ixfe,XF:P[z.ixfe]||{},v:z.val,t:"n"},S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:z.c,r:z.r},b,e);break;case 5:case 517:b={ixfe:z.ixfe,XF:P[z.ixfe],v:z.val,t:z.t},S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:z.c,r:z.r},b,e);break;case 638:b={ixfe:z.ixfe,XF:P[z.ixfe],v:z.rknum,t:"n"},S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:z.c,r:z.r},b,e);break;case 189:for(var q=z.c;q<=z.C;++q){var ie=z.rkrec[q-z.c][0];b={ixfe:ie,XF:P[ie],v:z.rkrec[q-z.c][1],t:"n"},S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:q,r:z.r},b,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){l=z;break}if(b=k1(z.val,z.cell.ixfe,z.tt),b.XF=P[b.ixfe],e.cellFormula){var fe=z.formula;if(fe&&fe[0]&&fe[0][0]&&fe[0][0][0]=="PtgExp"){var Ie=fe[0][0][1][0],Ve=fe[0][0][1][1],ze=Cr({r:Ie,c:Ve});g[ze]?b.f=""+ui(z.formula,o,z.cell,re,T):b.F=((e.dense?(s[Ie]||[])[Ve]:s[ze])||{}).F}else b.f=""+ui(z.formula,o,z.cell,re,T)}S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k(z.cell,b,e),l=z}break;case 7:case 519:if(l)l.val=z,b=k1(z,l.cell.ixfe,"s"),b.XF=P[b.ixfe],e.cellFormula&&(b.f=""+ui(l.formula,o,l.cell,re,T)),S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(z);var Ye=Cr(z[0].s);if(h=e.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[Ye],e.cellFormula&&h){if(!l||!Ye||!h)break;h.f=""+ui(z[1],o,z[0],re,T),h.F=Dr(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!l)break;g[Cr(l.cell)]=z[0],h=e.dense?(s[l.cell.r]||[])[l.cell.c]:s[Cr(l.cell)],(h||{}).f=""+ui(z[0],o,d,re,T)}}break;case 253:b=k1(c[z.isst].t,z.ixfe,"s"),c[z.isst].h&&(b.h=c[z.isst].h),b.XF=P[b.ixfe],S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:z.c,r:z.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:z.ixfe,XF:P[z.ixfe],t:"z"},S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:z.c,r:z.r},b,e));break;case 190:if(e.sheetStubs)for(var ct=z.c;ct<=z.C;++ct){var st=z.ixfe[ct-z.c];b={ixfe:st,XF:P[st],t:"z"},S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:ct,r:z.r},b,e)}break;case 214:case 516:case 4:b=k1(z.val,z.ixfe,"s"),b.XF=P[b.ixfe],S>0&&(b.z=I[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:z.c,r:z.r},b,e);break;case 0:case 512:Ce===1&&(o=z);break;case 252:c=z;break;case 1054:if(T.biff==4){I[S++]=z[1];for(var ft=0;ft<S+163&&Nr[ft]!=z[1];++ft);ft>=163&&gA(z[1],S+163)}else gA(z[1],z[0]);break;case 30:{I[S++]=z;for(var nt=0;nt<S+163&&Nr[nt]!=z;++nt);nt>=163&&gA(z,S+163)}break;case 229:Z=Z.concat(z);break;case 93:pe[z.cmo[0]]=T.lastobj=z;break;case 438:T.lastobj.TxO=z;break;case 127:T.lastobj.ImData=z;break;case 440:for(x=z[0].s.r;x<=z[0].e.r;++x)for(p=z[0].s.c;p<=z[0].e.c;++p)h=e.dense?(s[x]||[])[p]:s[Cr({c:p,r:x})],h&&(h.l=z[1]);break;case 2048:for(x=z[0].s.r;x<=z[0].e.r;++x)for(p=z[0].s.c;p<=z[0].e.c;++p)h=e.dense?(s[x]||[])[p]:s[Cr({c:p,r:x})],h&&h.l&&(h.l.Tooltip=z[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=e.dense?(s[z[0].r]||[])[z[0].c]:s[Cr(z[0])];var De=pe[z[2]];h||(e.dense?(s[z[0].r]||(s[z[0].r]=[]),h=s[z[0].r][z[0].c]={t:"z"}):h=s[Cr(z[0])]={t:"z"},o.e.r=Math.max(o.e.r,z[0].r),o.s.r=Math.min(o.s.r,z[0].r),o.e.c=Math.max(o.e.c,z[0].c),o.s.c=Math.min(o.s.c,z[0].c)),h.c||(h.c=[]),m={a:z[1],t:De.TxO.t},h.c.push(m)}break;case 2173:Afe(P[z.ixfe],z.ext);break;case 125:{if(!T.cellStyles)break;for(;z.e>=z.s;)ae[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},de||(de=!0,SI(z.w/256)),od(ae[z.e+1])}break;case 520:{var Fe={};z.level!=null&&(he[z.r]=Fe,Fe.level=z.level),z.hidden&&(he[z.r]=Fe,Fe.hidden=!0),z.hpt&&(he[z.r]=Fe,Fe.hpt=z.hpt,Fe.hpx=K0(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||mh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[D]]=z;break;case 161:s["!margins"]||mh(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(_.Views[0].RTL=!0);break;case 146:R=z;break;case 2198:U=z;break;case 140:F=z;break;case 442:A?B.CodeName=z||B.name:_.WBProps.CodeName=z||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+D.toString(16)),t.l+=Y}return r.SheetNames=Ts(a).sort(function(Ge,_e){return Number(Ge)-Number(_e)}).map(function(Ge){return a[Ge].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&V.forEach(function(Ge,_e){r.Sheets[r.SheetNames[_e]]["!autofilter"]=Ge}),r.Strings=c,r.SSF=ts(Nr),T.enc&&(r.Encryption=T.enc),U&&(r.Themes=U),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),re.names.length>0&&(_.Names=re.names),r.Workbook=_,r}var ig={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Cxe(t,e,r){var n=vr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=MP(n,IE,ig.DSI);for(var a in s)e[a]=s[a]}catch(A){if(r.WTF)throw A}var o=vr.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=MP(o,FE,ig.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(A){if(r.WTF)throw A}e.HeadingPairs&&e.TitlesOfParts&&(X8(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function _xe(t,e){var r=[],n=[],s=[],a=0,o,l=pP(IE,"n"),c=pP(FE,"n");if(t.Props)for(o=Ts(t.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],t.Props[o[a]]]);if(t.Custprops)for(o=Ts(t.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],t.Custprops[o[a]]]);var A=[];for(a=0;a<s.length;++a)sQ.indexOf(s[a][0])>-1||J8.indexOf(s[a][0])>-1||s[a][1]!=null&&A.push(s[a]);n.length&&vr.utils.cfb_add(e,"/SummaryInformation",QP(n,ig.SI,c,FE)),(r.length||A.length)&&vr.utils.cfb_add(e,"/DocumentSummaryInformation",QP(r,ig.DSI,l,IE,A.length?A:null,ig.UDI))}function ZQ(t,e){e||(e={}),LI(e),sI(),e.codepage&&nI(e.codepage);var r,n;if(t.FullPaths){if(vr.find(t,"/encryption"))throw new Error("File is password-protected");r=vr.find(t,"!CompObj"),n=vr.find(t,"/Workbook")||vr.find(t,"/Book")}else{switch(e.type){case"base64":t=No(To(t));break;case"binary":t=No(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Ha(t,0),n={content:t}}var s,a;if(r&&wxe(r),e.bookProps&&!e.bookSheets)s={};else{var o=Vr?"buffer":"array";if(n&&n.content)s=Nxe(n.content,e);else if((a=vr.find(t,"PerfectOffice_MAIN"))&&a.content)s=fh.to_workbook(a.content,(e.type=o,e));else if((a=vr.find(t,"NativeContent_MAIN"))&&a.content)s=fh.to_workbook(a.content,(e.type=o,e));else throw(a=vr.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&vr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Ufe(t))}var l={};return t.FullPaths&&Cxe(t,l,e),s.Props=s.Custprops=l,e.bookFiles&&(s.cfb=t),s}function Exe(t,e){var r=e||{},n=vr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return vr.utils.cfb_add(n,s,e7(t,r)),r.biff==8&&(t.Props||t.Custprops)&&_xe(t,n),r.biff==8&&t.vbaraw&&Ofe(n,vr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var ix={0:{f:Jme},1:{f:spe},2:{f:Npe},3:{f:dpe},4:{f:lpe},5:{f:wpe},6:{f:Spe},7:{f:ppe},8:{f:Rpe},9:{f:Ppe},10:{f:Tpe},11:{f:jpe},12:{f:ipe},13:{f:_pe},14:{f:fpe},15:{f:Ape},16:{f:qQ},17:{f:Fpe},18:{f:xpe},19:{f:xI},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Fge},40:{},42:{},43:{f:She},44:{f:Ehe},45:{f:khe},46:{f:jhe},47:{f:The},48:{},49:{f:Zce},50:{},51:{f:hfe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:mQ},62:{f:Bpe},63:{f:bfe},64:{f:Xpe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:gi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$pe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rpe},148:{f:Zme,p:16},151:{f:Qpe},152:{},153:{f:Bge},154:{},155:{},156:{f:_ge},157:{},158:{},159:{T:1,f:Hde},160:{T:-1},161:{T:1,f:ef},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Dpe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ufe},336:{T:-1},337:{f:pfe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:SE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fQ},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Vpe},427:{f:Hpe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:qpe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tpe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Ope},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:SE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jfe},633:{T:1},634:{T:-1},635:{T:1,f:kfe},636:{T:-1},637:{f:nAe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ype},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},DE={6:{f:aC},10:{f:ou},12:{f:Xs},13:{f:Xs},14:{f:Us},15:{f:Us},16:{f:fi},17:{f:Us},18:{f:Us},19:{f:Xs},20:{f:$P},21:{f:$P},23:{f:fQ},24:{f:WP},25:{f:Us},26:{},27:{},28:{f:Yue},29:{},34:{f:Us},35:{f:zP},38:{f:fi},39:{f:fi},40:{f:fi},41:{f:fi},42:{f:Us},43:{f:Us},47:{f:Ahe},49:{f:_ue},51:{f:Xs},60:{},61:{f:wue},64:{f:Us},65:{f:Cue},66:{f:Xs},77:{},80:{},81:{},82:{},85:{f:Xs},89:{},90:{},91:{},92:{f:cue},93:{f:tde},94:{},95:{f:Us},96:{},97:{},99:{f:Us},125:{f:mQ},128:{f:Mue},129:{f:uue},130:{f:Xs},131:{f:Us},132:{f:Us},133:{f:due},134:{},140:{f:cde},141:{f:Xs},144:{},146:{f:dde},151:{},152:{},153:{},154:{},155:{},156:{f:Xs},157:{},158:{},160:{f:vde},161:{f:mde},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Due},190:{f:Lue},193:{f:ou},197:{},198:{},199:{},200:{},201:{},202:{f:Us},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Xs},220:{},221:{f:Us},222:{},224:{f:Oue},225:{f:lue},226:{f:ou},227:{},229:{f:Zue},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:fue},253:{f:Bue},255:{f:pue},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:aQ},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Us},353:{f:ou},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:que},431:{f:Us},432:{},433:{},434:{},437:{},438:{f:sde},439:{f:Us},440:{f:ade},441:{},442:{f:Qx},443:{},444:{f:Xs},445:{},446:{},448:{f:ou},449:{f:vue,r:2},450:{f:ou},512:{f:KP},513:{f:xde},515:{f:Hue},516:{f:Iue},517:{f:GP},519:{f:wde},520:{f:gue},523:{},545:{f:JP},549:{f:HP},566:{},574:{f:bue},638:{f:Rue},659:{},1048:{},1054:{f:kue},1084:{},1212:{f:Wue},2048:{f:ode},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:S1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ou},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:hde,r:12},2173:{f:cfe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Us,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:zue,r:12},2197:{},2198:{f:nfe,r:12},2199:{},2200:{},2201:{},2202:{f:Jue,r:12},2203:{f:ou},2204:{},2205:{},2206:{},2207:{},2211:{f:xue},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Xs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:pde},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ude},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:KP},1:{},2:{f:_de},3:{f:Nde},4:{f:bde},5:{f:GP},7:{f:Bde},8:{},9:{f:S1},11:{},22:{f:Xs},30:{f:jue},31:{},32:{},33:{f:JP},36:{},37:{f:HP},50:{f:Sde},62:{},52:{},67:{},68:{f:Xs},69:{},86:{},126:{},127:{f:yde},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ide},223:{},234:{},354:{},421:{},518:{f:aC},521:{f:S1},536:{f:WP},547:{f:zP},561:{},579:{},1030:{f:aC},1033:{f:S1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wt(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&mI(r)&&t.push(r)}}function Bxe(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return Wt(t,e,r,s);var a=e;if(!isNaN(a)){for(var o=r.parts||[],l=0,c=0,A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;var u=t.next(4);for(u.write_shift(2,a),u.write_shift(2,A),t.push(r.slice(c,c+A)),c+=A;c<s;){for(u=t.next(4),u.write_shift(2,60),A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;u.write_shift(2,A),t.push(r.slice(c,c+A)),c+=A}}}function qx(t,e,r){return t||(t=Ct(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Sxe(t,e,r,n){var s=Ct(9);return qx(s,t,e),iQ(r,n||"b",s),s}function Ixe(t,e,r){var n=Ct(8+2*r.length);return qx(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Fxe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?ma(es(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Wt(t,2,Ede(r,n,s)):Wt(t,3,Cde(r,n,s));return;case"b":case"e":Wt(t,5,Sxe(r,n,e.v,e.t));return;case"s":case"str":Wt(t,4,Ixe(r,n,(e.v||"").slice(0,255)));return}Wt(t,1,qx(null,r,n))}function kxe(t,e,r,n){var s=Array.isArray(e),a=dn(e["!ref"]||"A1"),o,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Dr(a)}for(var A=a.s.r;A<=a.e.r;++A){l=Ks(A);for(var u=a.s.c;u<=a.e.c;++u){A===a.s.r&&(c[u]=vs(u)),o=c[u]+l;var d=s?(e[A]||[])[u]:e[o];d&&Fxe(t,d,A,u)}}}function Txe(t,e){for(var r=e||{},n=eo(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Wt(n,r.biff==4?1033:r.biff==3?521:9,_I(t,16,r)),kxe(n,t.Sheets[t.SheetNames[s]],s,r),Wt(n,10),n.end()}function jxe(t,e,r){Wt(t,49,Eue({sz:12,name:"Arial"},r))}function Pxe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Wt(t,1054,Tue(s,e[s],r))})}function Rxe(t,e){var r=Ct(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Wt(t,2151,r),r=Ct(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uQ(dn(e["!ref"]||"A1"),r),r.write_shift(4,4),Wt(t,2152,r)}function Dxe(t,e){for(var r=0;r<16;++r)Wt(t,224,qP({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Wt(t,224,qP(n,0,e))})}function Lxe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Wt(t,440,ide(n)),n[1].Tooltip&&Wt(t,2048,lde(n))}delete e["!links"]}function Uxe(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Wt(t,125,fde(eb(s,n),s))})}}function Oxe(t,e,r,n,s){var a=16+wd(s.cellXfs,e,s);if(e.v==null&&!e.bf){Wt(t,513,Dh(r,n,a));return}if(e.bf)Wt(t,6,ume(e,r,n,s,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?ma(es(e.v)):e.v;Wt(t,515,Kue(r,n,o,a));break;case"b":case"e":Wt(t,517,Vue(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var l=jI(s.Strings,e.v,s.revStrings);Wt(t,253,Sue(r,n,l,a))}else Wt(t,516,Fue(r,n,(e.v||"").slice(0,255),a,s));break;default:Wt(t,513,Dh(r,n,a))}}function Mxe(t,e,r){var n=eo(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(a),A=e.biff==8,u,d="",f=[],h=dn(a["!ref"]||"A1"),m=A?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Wt(n,2057,_I(r,16,e)),Wt(n,13,tl(1)),Wt(n,12,tl(100)),Wt(n,15,Fi(!0)),Wt(n,17,Fi(!1)),Wt(n,16,Ph(.001)),Wt(n,95,Fi(!0)),Wt(n,42,Fi(!1)),Wt(n,43,Fi(!1)),Wt(n,130,tl(1)),Wt(n,128,Que()),Wt(n,131,Fi(!1)),Wt(n,132,Fi(!1)),A&&Uxe(n,a["!cols"]),Wt(n,512,Pue(h,e)),A&&(a["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){d=Ks(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(f[x]=vs(x)),u=f[x]+d;var g=c?(a[p]||[])[x]:a[u];g&&(Oxe(n,g,p,x,e),A&&g.l&&a["!links"].push([u,g.l]))}}var y=l.CodeName||l.name||s;return A&&Wt(n,574,Nue((o.Views||[])[0])),A&&(a["!merges"]||[]).length&&Wt(n,229,ede(a["!merges"])),A&&Lxe(n,a),Wt(n,442,oQ(y)),A&&Rxe(n,a),Wt(n,10),n.end()}function Qxe(t,e,r){var n=eo(),s=(t||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Wt(n,2057,_I(t,5,r)),r.bookType=="xla"&&Wt(n,135),Wt(n,225,l?tl(1200):null),Wt(n,193,VAe(2)),c&&Wt(n,191),c&&Wt(n,192),Wt(n,226),Wt(n,92,Aue("SheetJS",r)),Wt(n,66,tl(l?1200:1252)),l&&Wt(n,353,tl(0)),l&&Wt(n,448),Wt(n,317,gde(t.SheetNames.length)),l&&t.vbaraw&&Wt(n,211),l&&t.vbaraw){var A=o.CodeName||"ThisWorkbook";Wt(n,442,oQ(A))}Wt(n,156,tl(17)),Wt(n,25,Fi(!1)),Wt(n,18,Fi(!1)),Wt(n,19,tl(0)),l&&Wt(n,431,Fi(!1)),l&&Wt(n,444,tl(0)),Wt(n,61,yue()),Wt(n,64,Fi(!1)),Wt(n,141,tl(0)),Wt(n,34,Fi(vge(t)=="true")),Wt(n,14,Fi(!0)),l&&Wt(n,439,Fi(!1)),Wt(n,218,tl(0)),jxe(n,t,r),Pxe(n,t.SSF,r),Dxe(n,r),l&&Wt(n,352,Fi(!1));var u=n.end(),d=eo();l&&Wt(d,140,Ade()),l&&r.Strings&&Bxe(d,252,mue(r.Strings)),Wt(d,10);var f=d.end(),h=eo(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=u.length+m+f.length;for(p=0;p<t.SheetNames.length;++p){var g=a[p]||{};Wt(h,133,hue({pos:x,hs:g.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return u.length&&b.push(u),y.length&&b.push(y),f.length&&b.push(f),_a(b)}function Vxe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=ts(Nr)),t&&t.SSF&&(cm(),$2(t.SSF),r.revssf=W2(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,UI(r),r.cellXfs=[],wd(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=Mxe(s,r,t);return n.unshift(Qxe(t,n,r)),_a(n)}function e7(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=to(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return Vxe(t,e);case 4:case 3:case 2:return Txe(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function i3(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),o=s.index,l=a&&a.index||t.length,c=Ece(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,u=0,d=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++A,r.sheetRows&&r.sheetRows<=A){--A;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var g=p.split(/<\/t[dh]>/i);for(l=0;l<g.length;++l){var y=g[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,F=0;b.charAt(0)=="<"&&(F=b.indexOf(">"))>-1;)b=b.slice(F+1);for(var P=0;P<m.length;++P){var R=m[P];R.s.c==u&&R.s.r<A&&A<=R.e.r&&(u=R.e.c+1,P=-1)}var _=Er(y.slice(0,y.indexOf(">")));f=_.colspan?+_.colspan:1,((d=+_.rowspan)>1||f>1)&&m.push({s:{r:A,c:u},e:{r:A+(d||1)-1,c:u+f-1}});var B=_.t||_["data-t"]||"";if(!b.length){u+=f;continue}if(b=C8(b),h.s.r>A&&(h.s.r=A),h.e.r<A&&(h.e.r=A),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!b.length){u+=f;continue}var E={t:"s",v:b};r.raw||!b.trim().length||B=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(Ul(b))?isNaN(V0(b).getDate())||(E={t:"d",v:es(b)},r.cellDates||(E={t:"n",v:ma(E.v)}),E.z=r.dateNF||Nr[14]):E={t:"n",v:Ul(b)}),r.dense?(n[A]||(n[A]=[]),n[A][u]=E):n[Cr({r:A,c:u})]=E,u+=f}}}}return n["!ref"]=Dr(h),m.length&&(n["!merges"]=m),n}function Hxe(t,e,r,n){for(var s=t["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,A=0;A<s.length;++A)if(!(s[A].s.r>r||s[A].s.c>o)&&!(s[A].e.r<r||s[A].e.c<o)){if(s[A].s.r<r||s[A].s.c<o){l=-1;break}l=s[A].e.r-s[A].s.r+1,c=s[A].e.c-s[A].s.c+1;break}if(!(l<0)){var u=Cr({r,c:o}),d=n.dense?(t[r]||[])[o]:t[u],f=d&&d.v!=null&&(d.h||dI(d.w||(SA(d),d.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),h.id=(n.id||"sjs")+"-"+u,a.push(zt("td",f,h))}}var m="<tr>";return m+a.join("")+"</tr>"}var Kxe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qxe="</body></html>";function Gxe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return vd(i3(r[0],e),e);var n=QI();return r.forEach(function(s,a){VI(n,i3(s,e),"Sheet"+(a+1))}),n}function $xe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function t7(t,e){var r=e||{},n=r.header!=null?r.header:Kxe,s=r.footer!=null?r.footer:qxe,a=[n],o=to(t["!ref"]);r.dense=Array.isArray(t),a.push($xe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(Hxe(t,o,l,r));return a.push("</table>"+s),a.join("")}function r7(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?ws(n.origin):n.origin;s=o.r,a=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),A={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var u=to(t["!ref"]);A.s.r=Math.min(A.s.r,u.s.r),A.s.c=Math.min(A.s.c,u.s.c),A.e.r=Math.max(A.e.r,u.e.r),A.e.c=Math.max(A.e.c,u.e.c),s==-1&&(A.e.r=s=u.e.r+1)}var d=[],f=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,g=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var F=l[m];if(o3(F)){if(n.display)continue;h[p]={hidden:!0}}var P=F.children;for(x=g=0;x<P.length;++x){var R=P[x];if(!(n.display&&o3(R))){var _=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):C8(R.innerHTML),B=R.getAttribute("data-z")||R.getAttribute("z");for(f=0;f<d.length;++f){var E=d[f];E.s.c==g+a&&E.s.r<p+s&&p+s<=E.e.r&&(g=E.e.c+1-a,f=-1)}b=+R.getAttribute("colspan")||1,((y=+R.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:p+s,c:g+a},e:{r:p+s+(y||1)-1,c:g+a+(b||1)-1}});var M={t:"s",v:_},k=R.getAttribute("data-t")||R.getAttribute("t")||"";_!=null&&(_.length==0?M.t=k||"z":n.raw||_.trim().length==0||k=="s"||(_==="TRUE"?M={t:"b",v:!0}:_==="FALSE"?M={t:"b",v:!1}:isNaN(Ul(_))?isNaN(V0(_).getDate())||(M={t:"d",v:es(_)},n.cellDates||(M={t:"n",v:ma(M.v)}),M.z=n.dateNF||Nr[14]):M={t:"n",v:Ul(_)})),M.z===void 0&&B!=null&&(M.z=B);var T="",U=R.getElementsByTagName("A");if(U&&U.length)for(var Z=0;Z<U.length&&!(U[Z].hasAttribute("href")&&(T=U[Z].getAttribute("href"),T.charAt(0)!="#"));++Z);T&&T.charAt(0)!="#"&&(M.l={Target:T}),n.dense?(t[p+s]||(t[p+s]=[]),t[p+s][g+a]=M):t[Cr({c:g+a,r:p+s})]=M,A.e.c<g+a&&(A.e.c=g+a),g+=b}}++p}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),A.e.r=Math.max(A.e.r,p-1+s),t["!ref"]=Dr(A),p>=c&&(t["!fullref"]=Dr((A.e.r=l.length-m+p-1+s,A))),t}function n7(t,e){var r=e||{},n=r.dense?[]:{};return r7(n,t,e)}function zxe(t,e){return vd(n7(t,e),e)}function o3(t){var e="",r=Wxe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Wxe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Jxe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=An(e.replace(/<[^>]*>/g,""));return[r]}var l3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function s7(t,e){var r=e||{},n=hI(t),s=[],a,o,l={name:""},c="",A=0,u,d,f={},h=[],m=r.dense?[]:{},p,x,g={value:""},y="",b=0,F=[],P=-1,R=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,E={},M=[],k={},T=0,U=0,Z=[],pe=1,ae=1,he=[],de={Names:[]},re={},xe=["",""],Ce=[],S={},I="",V=0,j=!1,O=!1,W=0;for(ex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=ex.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?m["!ref"]=Dr(_):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(m["!fullref"]=m["!ref"],_.e.r=r.sheetRows-1,m["!ref"]=Dr(_)),M.length&&(m["!merges"]=M),Z.length&&(m["!rows"]=Z),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=m,O=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Er(p[0],!1),P=R=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,m=r.dense?[]:{},M=[],Z=[],O=!0);break;case"table-row-group":p[1]==="/"?--B:++B;break;case"table-row":case"":if(p[1]==="/"){P+=pe,pe=1;break}if(d=Er(p[0],!1),d.?P=d.-1:P==-1&&(P=0),pe=+d["number-rows-repeated"]||1,pe<10)for(W=0;W<pe;++W)B>0&&(Z[P+W]={level:B});R=-1;break;case"covered-table-cell":p[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(m[P]||(m[P]=[]),m[P][R]={t:"z"}):m[Cr({r:P,c:R})]={t:"z"}),y="",F=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++R,g=Er(p[0],!1),ae=parseInt(g["number-columns-repeated"]||"1",10),x={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(x.f=n3(An(g.formula))),(g.||g["value-type"])=="string"&&(x.t="s",x.v=An(g["string-value"]||""),r.dense?(m[P]||(m[P]=[]),m[P][R]=x):m[Cr({r:P,c:R})]=x),R+=ae-1;else if(p[1]!=="/"){++R,y="",b=0,F=[],ae=1;var D=pe?P+pe-1:P;if(R>_.e.c&&(_.e.c=R),R<_.s.c&&(_.s.c=R),P<_.s.r&&(_.s.r=P),D>_.e.r&&(_.e.r=D),g=Er(p[0],!1),Ce=[],S={},x={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=An(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(T=parseInt(g["number-matrix-rows-spanned"],10)||0,U=parseInt(g["number-matrix-columns-spanned"],10)||0,k={s:{r:P,c:R},e:{r:P+T-1,c:R+U-1}},x.F=Dr(k),he.push([k,x.F])),g.formula)x.f=n3(g.formula);else for(W=0;W<he.length;++W)P>=he[W][0].s.r&&P<=he[W][0].e.r&&R>=he[W][0].s.c&&R<=he[W][0].e.c&&(x.F=he[W][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(T=parseInt(g["number-rows-spanned"],10)||0,U=parseInt(g["number-columns-spanned"],10)||0,k={s:{r:P,c:R},e:{r:P+T-1,c:R+U-1}},M.push(k)),g["number-columns-repeated"]&&(ae=parseInt(g["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Xn(g["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(g.value);break;case"percentage":x.t="n",x.v=parseFloat(g.value);break;case"currency":x.t="n",x.v=parseFloat(g.value);break;case"date":x.t="d",x.v=es(g["date-value"]),r.cellDates||(x.t="n",x.v=ma(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=Nce(g["time-value"])/86400,r.cellDates&&(x.t="d",x.v=J2(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(g.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",g["string-value"]!=null&&(y=An(g["string-value"]),F=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(j=!1,x.t==="s"&&(x.v=y||"",F.length&&(x.R=F),j=b==0),re.Target&&(x.l=re),Ce.length>0&&(x.c=Ce,Ce=[]),y&&r.cellText!==!1&&(x.w=y),j&&(x.t="z",delete x.v),(!j||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var Y=0;Y<pe;++Y){if(ae=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(m[P+Y]||(m[P+Y]=[]),m[P+Y][R]=Y==0?x:ts(x);--ae>0;)m[P+Y][R+ae]=ts(x);else for(m[Cr({r:P+Y,c:R})]=x;--ae>0;)m[Cr({r:P+Y,c:R+ae})]=ts(x);_.e.c<=R&&(_.e.c=R)}ae=parseInt(g["number-columns-repeated"]||"1",10),R+=ae-1,ae=0,x={},y="",F=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a;S.t=y,F.length&&(S.R=F),S.a=I,Ce.push(S)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);I="",V=0,y="",b=0,F=[];break;case"creator":p[1]==="/"?I=n.slice(V,p.index):V=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);y="",b=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Er(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Er(p[0],!1),c+=l3[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Er(p[0],!1),c+=l3[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(A,p.index);break}else A=p.index+p[0].length;break;case"named-range":o=Er(p[0],!1),xe=iC(o["cell-range-address"]);var se={Name:o.name,Ref:xe[0]+"!"+xe[1]};O&&(se.Sheet=h.length),de.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!g||!g["string-value"])){var ve=Jxe(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+ve[0]}else Er(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{xe=iC(Er(p[0])["target-range-address"]),f[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(re=Er(p[0],!1),!re.href)break;re.Target=An(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(xe=iC(re.Target.slice(1)),re.Target="#"+xe[0]+"!"+xe[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var z={Sheets:f,SheetNames:h,Workbook:de};return r.bookSheets&&delete z.Sheets,z}function c3(t,e){e=e||{},el(t,"META-INF/manifest.xml")&&NAe(Js(t,"META-INF/manifest.xml"),e);var r=Co(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=s7(Pn(r),e);return el(t,"meta.xml")&&(n.Props=z8(Js(t,"meta.xml"))),n}function A3(t,e){return s7(t,e)}var Xxe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Zg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Gs+e}}(),u3=function(){var t=function(a){return Fn(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,l){var c=[];c.push('      <table:table table:name="'+Fn(o.SheetNames[l])+`" table:style-name="ta1">
`);var A=0,u=0,d=to(a["!ref"]||"A1"),f=a["!merges"]||[],h=0,m=Array.isArray(a);if(a["!cols"])for(u=0;u<=d.e.c;++u)c.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=a["!rows"]||[];for(A=0;A<d.s.r;++A)p=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;A<=d.e.r;++A){for(p=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<d.s.c;++u)c.push(e);for(;u<=d.e.c;++u){var g=!1,y={},b="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>u)&&!(f[h].s.r>A)&&!(f[h].e.c<u)&&!(f[h].e.r<A)){(f[h].s.c!=u||f[h].s.r!=A)&&(g=!0),y["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,y["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(g){c.push(r);continue}var F=Cr({r:A,c:u}),P=m?(a[A]||[])[u]:a[F];if(P&&P.f&&(y["table:formula"]=Fn(gme(P.f)),P.F&&P.F.slice(0,F.length)==F)){var R=to(P.F);y["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,y["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!P){c.push(e);continue}switch(P.t){case"b":b=P.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=P.v?"true":"false";break;case"n":b=P.w||String(P.v||0),y["office:value-type"]="float",y["office:value"]=P.v||0;break;case"s":case"str":b=P.v==null?"":P.v,y["office:value-type"]="string";break;case"d":b=P.w||es(P.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=es(P.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var _=t(b);if(P.l&&P.l.Target){var B=P.l.Target;B=B.charAt(0)=="#"?"#"+xme(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),_=zt("text:a",_,{"xlink:href":B.replace(/&/g,"&amp;")})}c.push("          "+zt("table:table-cell",zt("text:p",_,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!cols"]){for(var u=0;u<A["!cols"].length;++u)if(A["!cols"][u]){var d=A["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;od(d),d.ods=l;var f=A["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!rows"]){for(var u=0;u<A["!rows"].length;++u)if(A["!rows"][u]){A["!rows"][u].ods=c;var d=A["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Gs],A=Zg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Zg({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+A+u+`>
`),c.push($8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+A+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=o.SheetNames.length;++d)c.push(n(o.Sheets[o.SheetNames[d]],o,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function a7(t,e){if(e.bookType=="fods")return u3(t,e);var r=cI(),n="",s=[],a=[];return n="mimetype",Mr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Mr(r,n,u3(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Mr(r,n,Xxe(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Mr(r,n,Gs+$8()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Mr(r,n,EAe(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Mr(r,n,CAe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Lh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function LE(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Pn(xd(t))}function Yxe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):No(xc(t))}function Zxe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function cd(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function d3(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function eve(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function tve(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function ox(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function _n(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Fs(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function fn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=ox(t,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ox(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var A={data:l,type:a};e[s]==null?e[s]=[A]:e[s].push(A)}return e}function La(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(_n(n*8+s.type)),s.type==2&&e.push(_n(s.data.length)),e.push(s.data))})}),cd(e)}function DI(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Xo(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=ox(t,n),a=fn(t.slice(n[0],n[0]+s));n[0]+=s;var o={id:Fs(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=fn(l.data),A=Fs(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+A)}),n[0]+=A}),(e=a[3])!=null&&e[0]&&(o.merge=Fs(a[3][0].data)>>>0>0),r.push(o)}return r}function Pf(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:_n(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:_n(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:_n(o.data.length)}],n[2].push({data:La(o.meta),type:2})});var a=La(n);e.push(_n(a.length)),e.push(a),s.forEach(function(o){return e.push(o)})}),cd(e)}function rve(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ox(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,A=0;if(a==1?(A=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(A=(e[r[0]++]>>2)+1,a==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[cd(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(A>=c)for(s.push(s[0].slice(-c)),A-=c;A>=s[s.length-1].length;)s.push(s[s.length-1]),A-=s[s.length-1].length;s.push(s[0].slice(-c,-c+A))}}var u=cd(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Yo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(rve(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return cd(e)}function Rf(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=_n(n),o=a.length;e.push(a),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return cd(e)}function nve(t,e,r,n){var s=Lh(t),a=s.getUint32(4,!0),o=(n>1?12:8)+d3(a&(n>1?3470:398))*4,l=-1,c=-1,A=NaN,u=new Date(2001,0,1);a&512&&(l=s.getUint32(o,!0),o+=4),o+=d3(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(o,!0),o+=4),a&32&&(A=s.getFloat64(o,!0),o+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:A};break;case 3:d={t:"s",v:e[c]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:A>0};break;case 7:d={t:"n",v:A/86400};break;case 8:d={t:"e",v:0};break;case 9:if(l>-1)d={t:"s",v:r[l]};else if(c>-1)d={t:"s",v:e[c]};else if(!isNaN(A))d={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function sve(t,e,r){var n=Lh(t),s=n.getUint32(8,!0),a=12,o=-1,l=-1,c=NaN,A=NaN,u=new Date(2001,0,1);s&1&&(c=eve(t,a),a+=16),s&2&&(A=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(o=n.getUint32(a,!0),a+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:A>0};break;case 7:d={t:"n",v:A/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return d}function lC(t,e){var r=new Uint8Array(32),n=Lh(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,tve(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function cC(t,e){var r=new Uint8Array(32),n=Lh(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function ave(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return nve(t,e,r,t[0]);case 5:return sve(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function li(t){var e=fn(t);return ox(e[1][0].data)}function h3(t,e){var r=fn(e.data),n=Fs(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(o){var l=fn(o.data),c=Fs(l[1][0].data)>>>0;switch(n){case 1:a[c]=LE(l[3][0].data);break;case 8:{var A=t[li(l[9][0].data)][0],u=fn(A.data),d=t[li(u[1][0].data)][0],f=Fs(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=fn(d.data);a[c]=h[3].map(function(m){return LE(m.data)}).join("")}break}}),a}function ive(t,e){var r,n,s,a,o,l,c,A,u,d,f,h,m,p,x=fn(t),g=Fs(x[1][0].data)>>>0,y=Fs(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Fs(x[8][0].data)>0||!1,F,P;if((a=(s=x[7])==null?void 0:s[0])!=null&&a.data&&e!=0)F=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,P=(A=(c=x[6])==null?void 0:c[0])==null?void 0:A.data;else if((d=(u=x[4])==null?void 0:u[0])!=null&&d.data&&e!=1)F=(h=(f=x[4])==null?void 0:f[0])==null?void 0:h.data,P=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var R=b?4:1,_=Lh(F),B=[],E=0;E<F.length/2;++E){var M=_.getUint16(E*2,!0);M<65535&&B.push([E,M])}if(B.length!=y)throw"Expected ".concat(y," cells, found ").concat(B.length);var k=[];for(E=0;E<B.length-1;++E)k[B[E][0]]=P.subarray(B[E][1]*R,B[E+1][1]*R);return B.length>=1&&(k[B[B.length-1][0]]=P.subarray(B[B.length-1][1]*R)),{R:g,cells:k}}function ove(t,e){var r,n=fn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Fs(n[7][0].data)>>>0>0?1:0:-1,a=DI(n[5],function(o){return ive(o,s)});return{nrows:Fs(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,A){if(o[l.R][A])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(A));o[l.R][A]=c}),o},[])}}function lve(t,e,r){var n,s=fn(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Fs(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Fs(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Dr(a);var o=fn(s[4][0].data),l=h3(t,t[li(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?h3(t,t[li(o[17][0].data)][0]):[],A=fn(o[3][0].data),u=0;A[1].forEach(function(d){var f=fn(d.data),h=t[li(f[2][0].data)][0],m=Fs(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=ove(t,h);p.data.forEach(function(x,g){x.forEach(function(y,b){var F=Cr({r:u+g,c:b}),P=ave(y,l,c);P&&(r[F]=P)})}),u+=p.nrows})}function cve(t,e){var r=fn(e.data),n={"!ref":"A1"},s=t[li(r[2][0].data)],a=Fs(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return lve(t,s[0],n),n}function Ave(t,e){var r,n=fn(e.data),s={name:(r=n[1])!=null&&r[0]?LE(n[1][0].data):"",sheets:[]},a=DI(n[2],li);return a.forEach(function(o){t[o].forEach(function(l){var c=Fs(l.meta[1][0].data);c==6e3&&s.sheets.push(cve(t,l))})}),s}function uve(t,e){var r=QI(),n=fn(e.data),s=DI(n[1],li);if(s.forEach(function(a){t[a].forEach(function(o){var l=Fs(o.meta[1][0].data);if(l==2){var c=Ave(t,o);c.sheets.forEach(function(A,u){VI(r,A,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function AC(t){var e,r,n,s,a={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var A;try{A=Yo(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var u;try{u=Xo(A)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){a[d.id]=d.messages,o.push(d.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Fs(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(c){a[c].forEach(function(A){var u=Fs(A.meta[1][0].data)>>>0;if(u==1)if(!l)l=A;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return uve(a,l)}function dve(t,e,r){var n,s,a,o;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=t[8])==null?void 0:a[0])==null?void 0:o.data)&&Fs(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,A=Lh(t[7][0].data),u=0,d=[],f=Lh(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){A.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}A.setUint16(p*2,u,!0),f.setUint16(p*2,h,!0);var x,g;switch(typeof e[p]){case"string":x=lC({t:"s",v:e[p]},r),g=cC({t:"s",v:e[p]},r);break;case"number":x=lC({t:"n",v:e[p]},r),g=cC({t:"n",v:e[p]},r);break;case"boolean":x=lC({t:"b",v:e[p]},r),g=cC({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}d.push(x),u+=x.length,m.push(g),h+=g.length,++c}for(t[2][0].data=_n(c);p<t[7][0].data.length/2;++p)A.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return t[6][0].data=cd(d),t[3][0].data=cd(m),c}function hve(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=to(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Dr(n)));var a=Uy(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(I){return I.forEach(function(V){typeof V=="string"&&o.push(V)})});var l={},c=[],A=vr.read(e.numbers,{type:"base64"});A.FileIndex.map(function(I,V){return[I,A.FullPaths[V]]}).forEach(function(I){var V=I[0],j=I[1];if(V.type==2&&V.name.match(/\.iwa/)){var O=V.content,W=Yo(O),D=Xo(W);D.forEach(function(Y){c.push(Y.id),l[Y.id]={deps:[],location:j,type:Fs(Y.messages[0].meta[1][0].data)}})}}),c.sort(function(I,V){return I-V});var u=c.filter(function(I){return I>1}).map(function(I){return[I,_n(I)]});A.FileIndex.map(function(I,V){return[I,A.FullPaths[V]]}).forEach(function(I){var V=I[0];if(I[1],!!V.name.match(/\.iwa/)){var j=Xo(Yo(V.content));j.forEach(function(O){O.messages.forEach(function(W){u.forEach(function(D){O.messages.some(function(Y){return Fs(Y.meta[1][0].data)!=11006&&Zxe(Y.data,D[1])})&&l[D[0]].deps.push(O.id)})})})}});for(var d=vr.find(A,l[1].location),f=Xo(Yo(d.content)),h,m=0;m<f.length;++m){var p=f[m];p.id==1&&(h=p)}var x=li(fn(h.messages[0].data)[1][0].data);for(d=vr.find(A,l[x].location),f=Xo(Yo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);for(x=li(fn(h.messages[0].data)[2][0].data),d=vr.find(A,l[x].location),f=Xo(Yo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);for(x=li(fn(h.messages[0].data)[2][0].data),d=vr.find(A,l[x].location),f=Xo(Yo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);var g=fn(h.messages[0].data);{g[6][0].data=_n(n.e.r+1),g[7][0].data=_n(n.e.c+1);var y=li(g[46][0].data),b=vr.find(A,l[y].location),F=Xo(Yo(b.content));{for(var P=0;P<F.length&&F[P].id!=y;++P);if(F[P].id!=y)throw"Bad ColumnRowUIDMapArchive";var R=fn(F[P].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var _=0;_<=n.e.c;++_){var B=[];B[1]=B[2]=[{type:0,data:_n(_+420690)}],R[1].push({type:2,data:La(B)}),R[2].push({type:0,data:_n(_)}),R[3].push({type:0,data:_n(_)})}R[4]=[],R[5]=[],R[6]=[];for(var E=0;E<=n.e.r;++E)B=[],B[1]=B[2]=[{type:0,data:_n(E+726270)}],R[4].push({type:2,data:La(B)}),R[5].push({type:0,data:_n(E)}),R[6].push({type:0,data:_n(E)});F[P].messages[0].data=La(R)}b.content=Rf(Pf(F)),b.size=b.content.length,delete g[46];var M=fn(g[4][0].data);{M[7][0].data=_n(n.e.r+1);var k=fn(M[1][0].data),T=li(k[2][0].data);b=vr.find(A,l[T].location),F=Xo(Yo(b.content));{if(F[0].id!=T)throw"Bad HeaderStorageBucket";var U=fn(F[0].messages[0].data);for(E=0;E<a.length;++E){var Z=fn(U[2][0].data);Z[1][0].data=_n(E),Z[4][0].data=_n(a[E].length),U[2][E]={type:U[2][0].type,data:La(Z)}}F[0].messages[0].data=La(U)}b.content=Rf(Pf(F)),b.size=b.content.length;var pe=li(M[2][0].data);b=vr.find(A,l[pe].location),F=Xo(Yo(b.content));{if(F[0].id!=pe)throw"Bad HeaderStorageBucket";for(U=fn(F[0].messages[0].data),_=0;_<=n.e.c;++_)Z=fn(U[2][0].data),Z[1][0].data=_n(_),Z[4][0].data=_n(n.e.r+1),U[2][_]={type:U[2][0].type,data:La(Z)};F[0].messages[0].data=La(U)}b.content=Rf(Pf(F)),b.size=b.content.length;var ae=li(M[4][0].data);(function(){for(var I=vr.find(A,l[ae].location),V=Xo(Yo(I.content)),j,O=0;O<V.length;++O){var W=V[O];W.id==ae&&(j=W)}var D=fn(j.messages[0].data);{D[3]=[];var Y=[];o.forEach(function(z,Oe){Y[1]=[{type:0,data:_n(Oe)}],Y[2]=[{type:0,data:_n(1)}],Y[3]=[{type:2,data:Yxe(z)}],D[3].push({type:2,data:La(Y)})})}j.messages[0].data=La(D);var se=Pf(V),ve=Rf(se);I.content=ve,I.size=I.content.length})();var he=fn(M[3][0].data);{var de=he[1][0];delete he[2];var re=fn(de.data);{var xe=li(re[2][0].data);(function(){for(var I=vr.find(A,l[xe].location),V=Xo(Yo(I.content)),j,O=0;O<V.length;++O){var W=V[O];W.id==xe&&(j=W)}var D=fn(j.messages[0].data);{delete D[6],delete he[7];var Y=new Uint8Array(D[5][0].data);D[5]=[];for(var se=0,ve=0;ve<=n.e.r;++ve){var z=fn(Y);se+=dve(z,a[ve],o),z[1][0].data=_n(ve),D[5].push({data:La(z),type:2})}D[1]=[{type:0,data:_n(n.e.c+1)}],D[2]=[{type:0,data:_n(n.e.r+1)}],D[3]=[{type:0,data:_n(se)}],D[4]=[{type:0,data:_n(n.e.r+1)}]}j.messages[0].data=La(D);var Oe=Pf(V),te=Rf(Oe);I.content=te,I.size=I.content.length})()}de.data=La(re)}M[3][0].data=La(he)}g[4][0].data=La(M)}h.messages[0].data=La(g);var Ce=Pf(f),S=Rf(Ce);return d.content=S,d.size=d.content.length,A}function i7(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function LI(t){i7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function UI(t){i7([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function fve(t){return $r.WS.indexOf(t)>-1?"sheet":t==$r.CS?"chart":t==$r.DS?"dialog":t==$r.MS?"macro":t&&t.length?t:"sheet"}function mve(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,fve(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function pve(t,e,r,n,s,a,o,l,c,A,u,d){try{a[n]=rg(Co(t,r,!0),e);var f=Js(t,e),h;switch(l){case"sheet":h=Uge(f,e,s,c,a[n],A,u,d);break;case"chart":if(h=Oge(f,e,s,c,a[n],A,u,d),!h||!h["!drawel"])break;var m=Cp(h["!drawel"].Target,e),p=tx(m),x=_fe(Co(t,m,!0),rg(Co(t,p,!0),m)),g=Cp(x,m),y=tx(g);h=dge(Co(t,g,!0),g,c,rg(Co(t,y,!0),g),A,h);break;case"macro":h=Mge(f,e,s,c,a[n],A,u,d);break;case"dialog":h=Qge(f,e,s,c,a[n],A,u,d);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];a&&a[n]&&Ts(a[n]).forEach(function(F){var P="";if(a[n][F].Type==$r.CMNT){P=Cp(a[n][F].Target,e);var R=qge(Js(t,P,!0),P,c);if(!R||!R.length)return;YP(h,R,!1)}a[n][F].Type==$r.TCMNT&&(P=Cp(a[n][F].Target,e),b=b.concat(Bfe(Js(t,P,!0),c)))}),b&&b.length&&YP(h,b,!0,c.people||[])}catch(F){if(c.WTF)throw F}}function zo(t){return t.charAt(0)=="/"?t.slice(1):t}function gve(t,e){if(cm(),e=e||{},LI(e),el(t,"META-INF/manifest.xml")||el(t,"objectdata.xml"))return c3(t,e);if(el(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof AC<"u"){if(t.FileIndex)return AC(t);var r=vr.utils.cfb_new();return vP(t).forEach(function(Z){Mr(r,Z,Sce(t,Z))}),AC(r)}throw new Error("Unsupported NUMBERS file")}if(!el(t,"[Content_Types].xml"))throw el(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):el(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=vP(t),s=yAe(Co(t,"[Content_Types].xml")),a=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Js(t,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Js(t,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},A={};if(!e.bookSheets&&!e.bookProps){if(ng=[],s.sst)try{ng=Kge(Js(t,zo(s.sst)),s.sst,e)}catch(Z){if(e.WTF)throw Z}e.cellStyles&&s.themes.length&&(c=Hge(Co(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(A=Vge(Js(t,zo(s.style)),s.style,c,e))}s.links.map(function(Z){try{var pe=rg(Co(t,tx(zo(Z))),Z);return $ge(Js(t,zo(Z)),pe,Z,e)}catch{}});var u=Lge(Js(t,zo(s.workbooks[0])),s.workbooks[0],e),d={},f="";s.coreprops.length&&(f=Js(t,zo(s.coreprops[0]),!0),f&&(d=z8(f)),s.extprops.length!==0&&(f=Js(t,zo(s.extprops[0]),!0),f&&SAe(f,d,e)));var h={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(f=Co(t,zo(s.custprops[0]),!0),f&&(h=FAe(f,e)));var m={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(pe){return pe.name}):d.Worksheets&&d.SheetNames.length>0&&(o=d.SheetNames),e.bookProps&&(m.Props=d,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&s.calcchain&&(p=Gge(Js(t,zo(s.calcchain)),s.calcchain));var x=0,g={},y,b;{var F=u.Sheets;d.Worksheets=F.length,d.SheetNames=[];for(var P=0;P!=F.length;++P)d.SheetNames[P]=F[P].name}var R=a?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),B=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");el(t,B)||(B="xl/_rels/workbook."+R+".rels");var E=rg(Co(t,B,!0),B.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=zge(Js(t,zo(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Ife(Js(t,zo(s.people[0])),e)),E&&(E=mve(E,u.Sheets));var M=Js(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=d.Worksheets;++x){var k="sheet";if(E&&E[x]?(y="xl/"+E[x][1].replace(/[\/]?xl\//,""),el(t,y)||(y=E[x][1]),el(t,y)||(y=B.replace(/_rels\/.*$/,"")+E[x][1]),k=E[x][2]):(y="xl/worksheets/sheet"+(x+1-M)+"."+R,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(d.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,U=0;U!=e.sheets.length;++U)typeof e.sheets[U]=="number"&&e.sheets[U]==x&&(T=1),typeof e.sheets[U]=="string"&&e.sheets[U].toLowerCase()==d.SheetNames[x].toLowerCase()&&(T=1);if(!T)continue e}}pve(t,y,b,d.SheetNames[x],x,g,o,k,e,u,c,A)}return m={Directory:s,Workbook:u,Props:d,Custprops:h,Deps:p,Sheets:o,SheetNames:d.SheetNames,Strings:ng,Styles:A,Themes:c,SSF:ts(Nr)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(Z,pe){Z=Z.replace(/^Root Entry[\/]/,""),m.keys.push(Z),m.files[Z]=t.FileIndex[pe]}))),e&&e.bookVBA&&(s.vba.length>0?m.vbaraw=Js(t,zo(s.vba[0]),!0):s.defaults&&s.defaults.bin===Lfe&&(m.vbaraw=Js(t,"xl/vbaProject.bin",!0))),m}function xve(t,e){var r=e||{},n="Workbook",s=vr.find(t,n);try{if(n="/!DataSpaces/Version",s=vr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(zde(s.content),n="/!DataSpaces/DataSpaceMap",s=vr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Jde(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=vr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Xde(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=vr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Zde(s.content)}catch{}if(n="/EncryptionInfo",s=vr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=ehe(s.content);if(n="/EncryptedPackage",s=vr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function vve(t,e){return e.bookType=="ods"?a7(t,e):e.bookType=="numbers"?hve(t,e):e.bookType=="xlsb"?wve(t,e):yve(t,e)}function wve(t,e){o0=1024,t&&!t.SSF&&(t.SSF=ts(Nr)),t&&t.SSF&&(cm(),$2(t.SSF),e.revssf=W2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,sg?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=jQ.indexOf(e.bookType)>-1,s=NI();UI(e=e||{});var a=cI(),o="",l=0;if(e.cellXfs=[],wd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Mr(a,o,W8(t.Props,e)),s.coreprops.push(o),Bn(e.rels,2,o,$r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],A=0;A<t.SheetNames.length;++A)(t.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(t.SheetNames[A]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Mr(a,o,Y8(t.Props)),s.extprops.push(o),Bn(e.rels,3,o,$r.EXT_PROPS),t.Custprops!==t.Props&&Ts(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Mr(a,o,Z8(t.Custprops)),s.custprops.push(o),Bn(e.rels,4,o,$r.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var u={"!id":{}},d=t.Sheets[t.SheetNames[l-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Mr(a,o,Jge(l-1,o,e,t,u)),s.sheets.push(o),Bn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$r.WS[0])}if(d){var h=d["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Mr(a,p,Zge(h,p)),s.comments.push(p),Bn(u,-1,"../comments"+l+"."+r,$r.CMNT),m=!0),d["!legacy"]&&m&&Mr(a,"xl/drawings/vmlDrawing"+l+".vml",kQ(l,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Mr(a,tx(o),w0(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Mr(a,o,Yge(e.Strings,o,e)),s.strs.push(o),Bn(e.wbrels,-1,"sharedStrings."+r,$r.SST)),o="xl/workbook."+r,Mr(a,o,Wge(t,o)),s.workbooks.push(o),Bn(e.rels,1,o,$r.WB),o="xl/theme/theme1.xml",Mr(a,o,II(t.Themes,e)),s.themes.push(o),Bn(e.wbrels,-1,"theme/theme1.xml",$r.THEME),o="xl/styles."+r,Mr(a,o,Xge(t,o,e)),s.styles.push(o),Bn(e.wbrels,-1,"styles."+r,$r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Mr(a,o,t.vbaraw),s.vba.push(o),Bn(e.wbrels,-1,"vbaProject.bin",$r.VBA)),o="xl/metadata."+r,Mr(a,o,exe(o)),s.metadata.push(o),Bn(e.wbrels,-1,"metadata."+r,$r.XLMETA),Mr(a,"[Content_Types].xml",G8(s,e)),Mr(a,"_rels/.rels",w0(e.rels)),Mr(a,"xl/_rels/workbook."+r+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,a}function yve(t,e){o0=1024,t&&!t.SSF&&(t.SSF=ts(Nr)),t&&t.SSF&&(cm(),$2(t.SSF),e.revssf=W2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,sg?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=jQ.indexOf(e.bookType)>-1,s=NI();UI(e=e||{});var a=cI(),o="",l=0;if(e.cellXfs=[],wd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Mr(a,o,W8(t.Props,e)),s.coreprops.push(o),Bn(e.rels,2,o,$r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],A=0;A<t.SheetNames.length;++A)(t.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(t.SheetNames[A]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Mr(a,o,Y8(t.Props)),s.extprops.push(o),Bn(e.rels,3,o,$r.EXT_PROPS),t.Custprops!==t.Props&&Ts(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Mr(a,o,Z8(t.Custprops)),s.custprops.push(o),Bn(e.rels,4,o,$r.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Mr(a,o,KQ(l-1,e,t,d)),s.sheets.push(o),Bn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$r.WS[0])}if(f){var m=f["!comments"],p=!1,x="";if(m&&m.length>0){var g=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(g=!0)})}),g&&(x="xl/threadedComments/threadedComment"+l+"."+r,Mr(a,x,Sfe(m,u,e)),s.threadedcomments.push(x),Bn(d,-1,"../threadedComments/threadedComment"+l+"."+r,$r.TCMNT)),x="xl/comments"+l+"."+r,Mr(a,x,TQ(m)),s.comments.push(x),Bn(d,-1,"../comments"+l+"."+r,$r.CMNT),p=!0}f["!legacy"]&&p&&Mr(a,"xl/drawings/vmlDrawing"+l+".vml",kQ(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Mr(a,tx(o),w0(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Mr(a,o,vQ(e.Strings,e)),s.strs.push(o),Bn(e.wbrels,-1,"sharedStrings."+r,$r.SST)),o="xl/workbook."+r,Mr(a,o,WQ(t)),s.workbooks.push(o),Bn(e.rels,1,o,$r.WB),o="xl/theme/theme1.xml",Mr(a,o,II(t.Themes,e)),s.themes.push(o),Bn(e.wbrels,-1,"theme/theme1.xml",$r.THEME),o="xl/styles."+r,Mr(a,o,BQ(t,e)),s.styles.push(o),Bn(e.wbrels,-1,"styles."+r,$r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Mr(a,o,t.vbaraw),s.vba.push(o),Bn(e.wbrels,-1,"vbaProject.bin",$r.VBA)),o="xl/metadata."+r,Mr(a,o,FQ()),s.metadata.push(o),Bn(e.wbrels,-1,"metadata."+r,$r.XLMETA),u.length>1&&(o="xl/persons/person.xml",Mr(a,o,Ffe(u)),s.people.push(o),Bn(e.wbrels,-1,"persons/person.xml",$r.PEOPLE)),Mr(a,"[Content_Types].xml",G8(s,e)),Mr(a,"_rels/.rels",w0(e.rels)),Mr(a,"xl/_rels/workbook."+r+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,a}function OI(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=To(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function bve(t,e){return vr.find(t,"EncryptedPackage")?xve(t,e):ZQ(t,e)}function Nve(t,e){var r,n=t,s=e||{};return s.type||(s.type=Vr&&Buffer.isBuffer(t)?"buffer":"base64"),r=y8(n,s),gve(r,s)}function o7(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return RE(t.slice(r),e);default:break e}return H0.to_workbook(t,e)}function Cve(t,e){var r="",n=OI(t,e);switch(e.type){case"base64":r=To(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=jh(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Pn(r)),e.type="binary",o7(r,e)}function _ve(t,e){var r=t;return e.type=="base64"&&(r=To(r)),r=Wg.utils.decode(1200,r.slice(2),"str"),e.type="binary",o7(r,e)}function Eve(t){return t.match(/[^\x00-\x7F]/)?xc(t):t}function uC(t,e,r,n){return n?(r.type="string",H0.to_workbook(t,r)):H0.to_workbook(e,r)}function UE(t,e){sI();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return UE(new Uint8Array(t),(r=ts(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),b0={},r.dateNF&&(b0.dateNF=r.dateNF),r.type||(r.type=Vr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Vr?"buffer":"binary",n=wce(t),typeof Uint8Array<"u"&&!Vr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Eve(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ts(r),r.type="array",UE(aI(n),r)}switch((s=OI(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return bve(vr.read(n,r),r);break;case 9:if(s[1]<=8)return ZQ(n,r);break;case 60:return RE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return kde(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return gQ.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Nve(n,r):uC(t,n,r,a);case 239:return s[3]===60?RE(n,r):uC(t,n,r,a);case 255:if(s[1]===254)return _ve(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return fh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return fh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return PE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return CQ.to_workbook(n,r);break;case 10:case 13:case 32:return Cve(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Fde.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?PE.to_workbook(n,r):uC(t,n,r,a)}function l7(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Ux(e.file,vr.write(t,{type:Vr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return vr.write(t,e)}function Bve(t,e){var r=ts(e||{}),n=vve(t,r);return Sve(n,r)}function Sve(t,e){var r={},n=Vr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?vr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(G2(s))}return e.password&&typeof encrypt_agile<"u"?l7(encrypt_agile(s,e.password),e):e.type==="file"?Ux(e.file,s):e.type=="string"?Pn(s):s}function Ive(t,e){var r=e||{},n=Exe(t,r);return l7(n,r)}function uc(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Jg(xc(n));case"binary":return xc(n);case"string":return t;case"file":return Ux(e.file,n,"utf8");case"buffer":return Vr?TA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):uc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Fve(t,e){switch(e.type){case"base64":return Jg(t);case"binary":return t;case"string":return t;case"file":return Ux(e.file,t,"binary");case"buffer":return Vr?TA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function T1(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Jg(r):e.type=="string"?Pn(r):r;case"file":return Ux(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function c7(t,e){sI(),bge(t);var r=ts(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=c7(t,r);return r.type="array",G2(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return uc(vxe(t,r),r);case"slk":case"sylk":return uc(pQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return uc(t7(t.Sheets[t.SheetNames[s]],r),r);case"txt":return Fve(A7(t.Sheets[t.SheetNames[s]],r),r);case"csv":return uc(MI(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return uc(gQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return T1(PE.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return uc(H0.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return uc(CQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return uc(xQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return uc(a7(t,r),r);case"wk1":return T1(fh.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return T1(fh.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),T1(e7(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Ive(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Bve(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kve(t,e,r,n,s,a,o,l){var c=Ks(r),A=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),d=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(A===void 0)continue;a[h]!=null&&(f[a[h]]=A);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[h]!=null){if(p==null)if(m.t=="e"&&p===null)f[a[h]]=null;else if(A!==void 0)f[a[h]]=A;else if(u&&p===null)f[a[h]]=null;else continue;else f[a[h]]=u&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:SA(m,p,l);p!=null&&(d=!1)}}return{row:f,isempty:d}}function Uy(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},A=e||{},u=A.range!=null?A.range:t["!ref"];switch(A.header===1?n=1:A.header==="A"?n=2:Array.isArray(A.header)?n=3:A.header==null&&(n=0),typeof u){case"string":c=dn(u);break;case"number":c=dn(t["!ref"]),c.s.r=u;break;default:c=u}n>0&&(s=0);var d=Ks(c.s.r),f=[],h=[],m=0,p=0,x=Array.isArray(t),g=c.s.r,y=0,b={};x&&!t[g]&&(t[g]=[]);var F=A.skipHidden&&t["!cols"]||[],P=A.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(F[y]||{}).hidden)switch(f[y]=vs(y),r=x?t[g][y]:t[f[y]+d],n){case 1:a[y]=y-c.s.c;break;case 2:a[y]=f[y];break;case 3:a[y]=A.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=SA(r,null,A),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}a[y]=l}for(g=c.s.r+s;g<=c.e.r;++g)if(!(P[g]||{}).hidden){var R=kve(t,c,g,f,n,a,x,A);(R.isempty===!1||(n===1?A.blankrows!==!1:A.blankrows))&&(h[m++]=R.row)}return h.length=m,h}var f3=/"/g;function Tve(t,e,r,n,s,a,o,l){for(var c=!0,A=[],u="",d=Ks(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var h=l.dense?(t[r]||[])[f]:t[n[f]+d];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:SA(h,null,l));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===s||p===a||p===34||l.forceQuotes){u='"'+u.replace(f3,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(f3,'""')+'"')):u="";A.push(u)}return l.blankrows===!1&&c?null:A.join(o)}function MI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=dn(t["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),A=new RegExp((a=="|"?"\\|":a)+"+$"),u="",d=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(f[m]||{}).hidden||(d[m]=vs(m));for(var p=0,x=s.s.r;x<=s.e.r;++x)(h[x]||{}).hidden||(u=Tve(t,s,x,d,o,c,a,n),u!=null&&(n.strip&&(u=u.replace(A,"")),(u||n.blankrows!==!1)&&r.push((p++?l:"")+u)));return delete n.dense,r.join("")}function A7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=MI(t,e);return r}function jve(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=dn(t["!ref"]),a="",o=[],l,c=[],A=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)o[l]=vs(l);for(var u=s.s.r;u<=s.e.r;++u)for(a=Ks(u),l=s.s.c;l<=s.e.c;++l)if(e=o[l]+a,r=A?(t[u]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function u7(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ws(n.origin):n.origin;o=c.r,l=c.c}var A,u={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(a["!ref"]){var d=dn(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+e.length-1+s)}else o==-1&&(o=0,u.e.r=e.length-1+s);var f=n.header||[],h=0;e.forEach(function(p,x){Ts(p).forEach(function(g){(h=f.indexOf(g))==-1&&(f[h=f.length]=g);var y=p[g],b="z",F="",P=Cr({c:l+h,r:o+x+s});A=lx(a,P),y&&typeof y=="object"&&!(y instanceof Date)?a[P]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=ma(y)),F=n.dateNF||Nr[14]):y===null&&n.nullError&&(b="e",y=0),A?(A.t=b,A.v=y,delete A.w,delete A.R,F&&(A.z=F)):a[P]=A={t:b,v:y},F&&(A.z=F))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var m=Ks(o);if(s)for(h=0;h<f.length;++h)a[vs(h+l)+m]={t:"s",v:f[h]};return a["!ref"]=Dr(u),a}function Pve(t,e){return u7(null,t,e)}function lx(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ws(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?lx(t,Cr(e)):lx(t,Cr({r:e,c:r||0}))}function Rve(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function QI(){return{SheetNames:[],Sheets:{}}}function VI(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(zQ(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Dve(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Rve(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Lve(t,e){return t.z=e,t}function d7(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Uve(t,e,r){return d7(t,"#"+e,r)}function Ove(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Mve(t,e,r,n){for(var s=typeof e!="string"?e:dn(e),a=typeof e=="string"?e:Dr(e),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=lx(t,o,l);c.t="n",c.F=a,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var j1={encode_col:vs,encode_row:Ks,encode_cell:Cr,encode_range:Dr,decode_col:gI,decode_row:pI,split_cell:Yce,decode_cell:ws,decode_range:to,format_cell:SA,sheet_add_aoa:O8,sheet_add_json:u7,sheet_add_dom:r7,aoa_to_sheet:Am,json_to_sheet:Pve,table_to_sheet:n7,table_to_book:zxe,sheet_to_csv:MI,sheet_to_txt:A7,sheet_to_json:Uy,sheet_to_html:t7,sheet_to_formulae:jve,sheet_to_row_object_array:Uy,sheet_get_cell:lx,book_new:QI,book_append_sheet:VI,book_set_sheet_visibility:Dve,cell_set_number_format:Lve,cell_set_hyperlink:d7,cell_set_internal_link:Uve,cell_add_comment:Ove,sheet_set_array_formula:Mve,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Qve=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function qn(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function du(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Rd(t,e=1){const r=Math.floor(du(t,e));return r>0?r:e}function Vve(t){return Object.values(t||{}).every(r=>qn(r)==="")}function sp(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(s=>n.set(qn(s),s));for(const s of e){const a=n.get(qn(s));if(a!=null)return t[a]}}function Hve(){const{refreshKey:t,refresh:e}=Jl(),[r,n]=N.useState(!0),[s,a]=N.useState(""),[o,l]=N.useState([]),[c,A]=N.useState(""),[u,d]=N.useState(""),[f,h]=N.useState(0),[m,p]=N.useState(1),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,P]=N.useState(""),[R,_]=N.useState(0),[B,E]=N.useState(1),[M,k]=N.useState(""),[T,U]=N.useState(!1),[Z,pe]=N.useState(""),[ae,he]=N.useState([]),[de,re]=N.useState([]),[xe,Ce]=N.useState(!1);N.useEffect(()=>{(async()=>{n(!0),a("");try{const q=await Nt(Ut(At(je,"products_candies"),Rr("name","asc"))),ie=[];q.forEach(fe=>{const Ie=fe.data();ie.push({id:fe.id,name:Ie.name||"",category:Ie.category||"",providerPrice:Number(Ie.providerPrice||0),unitsPerPackage:Number(Ie.unitsPerPackage||1),createdAt:Ie.createdAt})}),l(ie)}catch(q){console.error(q),a(" Error cargando catlogo de dulces.")}finally{n(!1)}})()},[t]);const S=N.useMemo(()=>{const q=qn(M);return q?o.filter(ie=>`${ie.category} ${ie.name}`.toLowerCase().includes(q)):o},[o,M]),I=N.useMemo(()=>{const q=new Set;return o.forEach(ie=>{const fe=String(ie.category||"").trim();fe&&q.add(fe)}),Array.from(q).sort((ie,fe)=>ie.localeCompare(fe,"es"))},[o]),V=()=>{A(""),d(""),h(0),p(1)},j=async q=>{q.preventDefault(),a("");const ie=String(c||"").trim(),fe=String(u||"").trim(),Ie=Math.max(0,du(f,0)),Ve=Rd(m,1);if(!ie)return a(" La categora es requerida.");if(!fe)return a(" El nombre del producto es requerido.");if(Ie<=0)return a(" El precio proveedor debe ser > 0.");if(Ve<=0)return a(" Und x paquete debe ser > 0.");if(o.some(Ye=>qn(Ye.category)===qn(ie)&&qn(Ye.name)===qn(fe)))return a(" Ya existe un producto con esa categora y nombre.");try{n(!0);const Ye={category:ie,name:fe,providerPrice:Ie,unitsPerPackage:Ve,createdAt:Kt.now()},ct=await Wr(At(je,"products_candies"),Ye);l(st=>[...st,{id:ct.id,...Ye}].sort((ft,nt)=>ft.name.localeCompare(nt.name,"es"))),a(" Producto creado."),V()}catch(Ye){console.error(Ye),a(" Error creando producto.")}finally{n(!1)}},O=q=>{g(q.id),b(q.category),P(q.name),_(q.providerPrice),E(q.unitsPerPackage||1),a("")},W=()=>{g(null),b(""),P(""),_(0),E(1)},D=async()=>{if(!x)return;a("");const q=String(y||"").trim(),ie=String(F||"").trim(),fe=Math.max(0,du(R,0)),Ie=Rd(B,1);if(!q)return a(" La categora es requerida.");if(!ie)return a(" El nombre del producto es requerido.");if(fe<=0)return a(" El precio proveedor debe ser > 0.");if(Ie<=0)return a(" Und x paquete debe ser > 0.");if(o.some(ze=>ze.id!==x&&qn(ze.category)===qn(q)&&qn(ze.name)===qn(ie)))return a(" Ya existe otro producto con esa categora y nombre.");try{n(!0),await kr(kt(je,"products_candies",x),{category:q,name:ie,providerPrice:fe,unitsPerPackage:Ie,updatedAt:Kt.now()}),l(ze=>ze.map(Ye=>Ye.id===x?{...Ye,category:q,name:ie,providerPrice:fe,unitsPerPackage:Ie}:Ye).sort((Ye,ct)=>Ye.name.localeCompare(ct.name,"es"))),a(" Producto actualizado."),W()}catch(ze){console.error(ze),a(" Error actualizando producto.")}finally{n(!1)}},Y=async q=>{if(confirm(`Eliminar "${q.name}" (${q.category}) del catlogo?`))try{n(!0),await un(kt(je,"products_candies",q.id)),l(fe=>fe.filter(Ie=>Ie.id!==q.id)),a(" Producto eliminado.")}catch(fe){console.error(fe),a(" Error eliminando producto.")}finally{n(!1)}},se=()=>{const q=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24}],ie=j1.json_to_sheet(q),fe=j1.book_new();j1.book_append_sheet(fe,ie,"Productos");const Ie=c7(fe,{type:"array",bookType:"xlsx"}),Ve=new Blob([Ie],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ze=URL.createObjectURL(Ve),Ye=document.createElement("a");Ye.href=ze,Ye.download="template_productos_dulces.xlsx",document.body.appendChild(Ye),Ye.click(),Ye.remove(),URL.revokeObjectURL(ze)},ve=q=>{const ie=[],fe=[];q.forEach((Ve,ze)=>{if(!Ve||typeof Ve!="object"||Vve(Ve))return;const Ye=String(sp(Ve,["Id","ID","productId","docId"])??"").trim(),ct=String(sp(Ve,["Categoria","Categora","Category","cat","category"])??"").trim(),st=String(sp(Ve,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),ft=sp(Ve,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),nt=sp(Ve,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),De=Math.max(0,du(ft,0)),Fe=Rd(nt,1),Ge=ze+2;ct||fe.push(`Fila ${Ge}: falta Categoria.`),st||fe.push(`Fila ${Ge}: falta Producto/Nombre.`),De<=0&&fe.push(`Fila ${Ge}: PrecioProveedor debe ser > 0.`),Fe<=0&&fe.push(`Fila ${Ge}: UnidadesPorPaquete debe ser > 0.`),ct&&st&&De>0&&Fe>0&&ie.push({id:Ye||void 0,category:ct,name:st,providerPrice:De,unitsPerPackage:Fe,_raw:Ve})});const Ie=new Map;for(const Ve of ie){const ze=Ve.id?`id::${Ve.id}`:`${qn(Ve.category)}::${qn(Ve.name)}`;Ie.set(ze,Ve)}return{rows:Array.from(Ie.values()),errors:fe}},z=async q=>{if(a(""),re([]),he([]),pe((q==null?void 0:q.name)||""),!q)return;const ie=q.name.toLowerCase(),fe=ie.endsWith(".xlsx")||ie.endsWith(".xls"),Ie=ie.endsWith(".csv");if(!fe&&!Ie){re(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ce(!0);const Ve=new FileReader,ze=await new Promise((Fe,Ge)=>{Ve.onerror=()=>Ge(new Error("No se pudo leer el archivo.")),Ve.onload=()=>Fe(Ve.result),Ve.readAsArrayBuffer(q)}),Ye=UE(new Uint8Array(ze),{type:"array"}),ct=Ye.SheetNames[0],st=Ye.Sheets[ct],ft=j1.sheet_to_json(st,{defval:""}),{rows:nt,errors:De}=ve(ft);he(nt),re(De),nt.length===0&&De.length===0&&re(["No se encontraron filas vlidas para importar."])}catch(Ve){console.error(Ve),re(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ce(!1)}},Oe=(q,ie)=>{he(fe=>{const Ie=[...fe],Ve=Ie[q];return Ve?(Ie[q]={...Ve,...ie},Ie):fe})},te=async()=>{if(a(""),de.length>0){a(" Correg los errores antes de importar.");return}if(ae.length===0){a(" No hay filas para importar.");return}try{Ce(!0);const q={},ie={};o.forEach(ze=>{q[ze.id]=ze,ie[`${qn(ze.category)}::${qn(ze.name)}`]=ze});const fe=Gh(je);let Ie=0,Ve=0;for(const ze of ae){const Ye=String(ze.category||"").trim(),ct=String(ze.name||"").trim(),st=Math.max(0,du(ze.providerPrice,0)),ft=Rd(ze.unitsPerPackage,1);if(!Ye||!ct||st<=0||ft<=0)continue;let nt;if(ze.id&&q[ze.id])nt=q[ze.id];else{const De=`${qn(Ye)}::${qn(ct)}`;nt=ie[De]}if(nt)fe.update(kt(je,"products_candies",nt.id),{category:Ye,name:ct,providerPrice:st,unitsPerPackage:ft,updatedAt:Kt.now()}),Ve+=1;else{const De=kt(At(je,"products_candies"));fe.set(De,{category:Ye,name:ct,providerPrice:st,unitsPerPackage:ft,createdAt:Kt.now()}),Ie+=1}}await fe.commit(),a(` Importacin lista. Creados: ${Ie}, Actualizados: ${Ve}`),U(!1),he([]),re([]),pe(""),e()}catch(q){console.error(q),a(" Error importando productos a Firestore.")}finally{Ce(!1)}},J=N.useMemo(()=>{const q=new Set(o.map(Ve=>Ve.id)),ie=new Set(o.map(Ve=>`${qn(Ve.category)}::${qn(Ve.name)}`));let fe=0,Ie=0;for(const Ve of ae){if(Ve.id&&q.has(Ve.id)){fe+=1;continue}const ze=`${qn(Ve.category)}::${qn(Ve.name)}`;ie.has(ze)?fe+=1:Ie+=1}return{willCreate:Ie,willUpdate:fe,total:ae.length}},[ae,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catlogo de Productos (Dulces)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:e,loading:r||xe}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{U(!0),he([]),re([]),pe("")},children:"Importar (.xlsx)"})]})]}),i.jsxs("form",{onSubmit:j,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-5 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:q=>A(q.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:u,onChange:q=>d(q.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(f)?"":f,onChange:q=>h(Math.max(0,du(q.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:q=>p(Rd(q.target.value,1))})]}),i.jsxs("div",{className:"md:col-span-5 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:V,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:M,onChange:q=>k(q.target.value),placeholder:"Buscar por categora o producto"})]}),i.jsxs("div",{className:"w-full md:w-1/2 text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:S.length})]})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin productos."})}):S.map(q=>{const ie=x===q.id;return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:ie?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:y,onChange:fe=>b(fe.target.value)}):q.category}),i.jsx("td",{className:"p-2 border",children:ie?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:F,onChange:fe=>P(fe.target.value)}):q.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ie?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(R)?"":R,onChange:fe=>_(Math.max(0,du(fe.target.value,0)))}):Qve(q.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ie?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:B,onChange:fe=>E(Rd(fe.target.value,1))}):q.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:ie?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:W,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>O(q),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Y(q),type:"button",children:"Borrar"})]})})]},q.id)})})]})}),s&&i.jsx("p",{className:"mt-2 text-sm",children:s}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>U(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:se,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:q=>{var ie;return z(((ie=q.target.files)==null?void 0:ie[0])||null)}}),Z&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:Z})]}),xe&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),de.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:de.slice(0,50).map((q,ie)=>i.jsx("li",{children:q},ie))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",J.total," filas (Crear:"," ",J.willCreate," / Actualizar:"," ",J.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:te,disabled:xe||ae.length===0||de.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1100px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):ae.slice(0,300).map((q,ie)=>{const fe=q.id?o.some(ze=>ze.id===q.id):!1,Ie=o.some(ze=>`${qn(ze.category)}::${qn(ze.name)}`==`${qn(q.category)}::${qn(q.name)}`),Ve=fe||Ie;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:q.id||"",onChange:ze=>Oe(ie,{id:ze.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:q.category,onChange:ze=>Oe(ie,{category:ze.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:q.name,onChange:ze=>Oe(ie,{name:ze.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(q.providerPrice)?"":q.providerPrice,onChange:ze=>Oe(ie,{providerPrice:Math.max(0,du(ze.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:q.unitsPerPackage,onChange:ze=>Oe(ie,{unitsPerPackage:Rd(ze.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${Ve?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:Ve?"ACTUALIZA":"CREA"})})]},`${q.id||""}-${ie}`)})})]}),i.jsx("datalist",{id:"categories-list",children:I.map(q=>i.jsx("option",{value:q},q))})]}),ae.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",ae.length," filas (el import importa todas)."]})]})]})})]})}function HI(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),s=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):s>0?Math.floor(s*e):0}function og(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):HI(t)}function Kve(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=HI(t);return r>0&&e>0?Math.floor(r/e):Math.max(0,Math.floor(Number(t.packages||0)))}function qve(t){if(typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages))return Math.max(0,Math.floor(Number(t.remainingPackages)));const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=og(t);return Math.max(0,Math.floor(r/e))}async function Gve(t){const e=kt(je,"candy_main_orders",t);if((await Wa(e)).exists())return e;const n=Ut(At(je,"candy_main_orders"),qt("orderId","==",t)),s=await Nt(n);return s.empty?null:kt(je,"candy_main_orders",s.docs[0].id)}async function dC(t){if(!t)return;const e=await Gve(t);if(!e)return;const r=Ut(At(je,"inventory_candies"),qt("orderId","==",t)),n=await Nt(r),s=new Map;n.forEach(l=>{const c=l.data(),A=String(c.productId||"");if(!A)return;const u=Kve(c),d=qve(c),f=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),g=h*u,y=m*u,b=p*u,F=x*u,P=y-g,R=b-g,_=F-g;s.has(A)||s.set(A,{productId:A,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:f,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const B=s.get(A);B.packages+=u,B.remainingPackages+=d,B.subtotal+=g,B.totalRivas+=y,B.totalSanJorge+=b,B.totalIsla+=F,B.gainRivas+=P,B.gainSanJorge+=R,B.gainIsla+=_,B.providerPrice=h,B.unitPriceRivas=m||B.unitPriceRivas,B.unitPriceSanJorge=p||B.unitPriceSanJorge,B.unitPriceIsla=x||B.unitPriceIsla,B.unitsPerPackage=f||B.unitsPerPackage,B.name=String(c.productName||B.name),B.category=String(c.category||B.category)});const a=Array.from(s.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=a.reduce((l,c)=>l+Number(c.packages||0),0);await kr(e,{totalPackages:o,items:a})}async function $ve(t){const{productId:e,saleDate:r,saleId:n}=t,s=t.quantityPacks,a=t.quantity;if(!e)throw new Error("Parmetros invlidos para allocateSaleFIFOCandy (sin producto)");const o=Ut(At(je,"inventory_candies"),qt("productId","==",e)),l=await Nt(o);if(l.empty)throw new Error("No hay inventario para este producto.");const c=l.docs.map(h=>({id:h.id,data:h.data()})).sort((h,m)=>{var b,F;const p=String(h.data.date||""),x=String(m.data.date||"");if(p!==x)return p<x?-1:1;const g=((b=h.data.createdAt)==null?void 0:b.seconds)??0,y=((F=m.data.createdAt)==null?void 0:F.seconds)??0;return g-y});let A=0;for(const h of c){const m=Number(h.data.unitsPerPackage??0);if(m>0){A=m;break}}if(!A)for(const h of c){const m=h.data,p=Number(m.totalUnits??0),x=Number(m.packages??0);if(p>0&&x>0){A=p/x;break}}A||(A=1);let u;if(s!=null&&!Number.isNaN(Number(s))){const h=Math.max(0,Math.floor(Number(s)));if(h<=0)throw new Error("La cantidad en paquetes debe ser mayor que cero.");u=h*A}else{const h=Math.max(0,Math.floor(Number(a||0)));if(h<=0)throw new Error("La cantidad debe ser mayor que cero.");u=h}const d=c.map(h=>kt(je,"inventory_candies",h.id)),f=[];return await ha(je,async h=>{const m=await Promise.all(d.map(x=>h.get(x)));let p=u;for(let x=0;x<d.length&&p>0;x++){const g=d[x],y=m[x];if(!y.exists())continue;const b=y.data(),F=og(b);if(F<=0)continue;const P=Math.min(F,p),R=Math.max(0,F-P),_=Math.max(1,Math.floor(Number(b.unitsPerPackage||1))),B=Math.floor(R/_);h.update(g,{remaining:R,remainingPackages:B,packages:B}),f.push({batchId:g.id,qty:P,batchDate:String(b.date||""),productName:String(b.productName||"")}),p-=P}if(p>0){const x=Math.ceil(p/A);throw new Error(`Inventario insuficiente. Faltan aproximadamente ${x} paquetes.`)}if(n)for(const x of f)await Wr(At(je,"batch_candies_allocations"),{saleId:n,saleDate:r,productId:e,productName:x.productName??"",batchId:x.batchId,batchDate:x.batchDate??"",quantity:x.qty,createdAt:Kt.now()})}),{allocations:f}}function zve(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const s=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const a of s){const o=String(a.inventorySellerId||""),l=Math.max(0,Math.floor(Number(a.units??a.qty??a.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const s=e[n],a=Array.isArray(s==null?void 0:s.allocations)?s.allocations:[];for(const o of a){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function cx(t){const e=t.split("#")[0],r=kt(je,"sales_candies",e),n=await Wa(r);if(!n.exists())throw new Error("La venta no existe.");const s=n.data(),a=zve(s);if(a&&a.allocations.length>0){let A=0;return await ha(je,async u=>{const d={};for(const p of a.allocations){const x=p.inventorySellerId,g=Math.max(0,Math.floor(Number(p.units||0)));!x||g<=0||(d[x]=(d[x]||0)+g,A+=g)}const h=Object.keys(d).map(p=>kt(je,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const g=x.data(),y=Number(g.remainingUnits??g.remaining??0),b=Math.max(0,Math.floor(Number(d[h[p].id]||0))),F=y+b,P=Math.max(1,Math.floor(Number(g.unitsPerPackage||1))),R=Math.floor(F/P);u.update(h[p],{remainingUnits:F,remainingPackages:R})}u.delete(r)}),{restored:A}}const o=[];if(Array.isArray(s.items)&&s.items.length>0){const A={};if(s.allocationsByItem&&typeof s.allocationsByItem=="object")for(const u of Object.keys(s.allocationsByItem)){const d=s.allocationsByItem[u],f=String((d==null?void 0:d.productId)||u||"");if(!f)continue;const h=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];A[f]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(s.allocationsByItem))for(const u of s.allocationsByItem){const d=String((u==null?void 0:u.productId)||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];A[d]=f.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const u of s.items){const d=String((u==null?void 0:u.productId)||"");if(!d)continue;const f=Math.max(0,Math.floor(Number((u==null?void 0:u.qty)||(u==null?void 0:u.quantity)||0))),h=Array.isArray(u==null?void 0:u.allocations)?u.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):A[d]||[];o.push({productId:d,productName:String((u==null?void 0:u.productName)||""),qty:f,allocations:h.length?h:void 0})}}else{const A=s.item||{},u=String(A.productId||s.productId||""),d=Math.max(0,Math.floor(Number(A.qty??s.quantity??0))),f=Array.isArray(s.allocations)?s.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];u&&d>0&&o.push({productId:u,productName:String(A.productName||s.productName||""),qty:d,allocations:f.length?f:void 0})}if(o.length===0)return await ha(je,async A=>{A.delete(r)}),{restored:0};if(o.every(A=>Array.isArray(A.allocations)&&A.allocations.length>0)){let A=0;return await ha(je,async u=>{const d=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));A+=p,d.push({ref:kt(je,"inventory_candies",m.batchId),addBack:p})}const f=await Promise.all(d.map(h=>u.get(h.ref)));for(let h=0;h<d.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),x=og(p),g=Math.max(0,Math.floor(Number(d[h].addBack||0))),y=x+g,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),F=Math.floor(y/b);u.update(d[h].ref,{remaining:y,remainingPackages:F,packages:F})}u.delete(r)}),{restored:A}}let c=0;return await ha(je,async A=>{const u={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=Ut(At(je,"inventory_candies"),qt("productId","==",p.productId)),y=(await Nt(x)).docs.map(b=>{const F=b.data(),P=HI(F),R=og(F);return{id:b.id,date:String(F.date||""),baseUnits:P,remaining:R}}).sort((b,F)=>b.date.localeCompare(F.date));u[p.productId]=y}const d=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,d.push({id:y.batchId,addBack:b})}continue}const x=u[p.productId]||[];let g=p.qty;for(const y of x){if(g<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const F=Math.min(b,g);d.push({id:y.id,addBack:F}),c+=F,g-=F}for(const y of x){if(g<=0)break;const b=Math.min(g,p.qty);d.push({id:y.id,addBack:b}),c+=b,g-=b}}const f={};for(const p of d)f[p.id]=(f[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(f).map(p=>kt(je,"inventory_candies",p)),m=await Promise.all(h.map(p=>A.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const g=x.data(),y=og(g),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),F=y+b,P=Math.max(1,Math.floor(Number(g.unitsPerPackage||1))),R=Math.floor(F/P);A.update(h[p],{remaining:F,remainingPackages:R,packages:R})}A.delete(r)}),{restored:c}}async function Wve(t){return cx(t)}const Ei=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function hC(t){return isFinite(t)?Math.round(t):0}function Bl(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function fC(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function Jve(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const s=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-s}function Xve(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[u,d]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,P]=N.useState(0),[R,_]=N.useState(!1),[B,E]=N.useState(""),[M,k]=N.useState(""),[T,U]=N.useState([]);N.useEffect(()=>{(async()=>{try{a(!0);const O=await Nt(At(je,"products_candies")),W=[];O.forEach(ve=>{const z=ve.data();W.push({id:ve.id,name:z.name??"(sin nombre)",category:z.category??"(sin categora)"})}),e(W);const D=Ut(At(je,"inventory_candies"),Rr("date","desc")),Y=await Nt(D),se=[];Y.forEach(ve=>{const z=ve.data(),Oe=Number(z.unitsPerPackage||0),te=Number(z.totalUnits??z.quantity??(z.packages||0)*(z.unitsPerPackage||0)),J=Number(z.remaining??z.totalUnits??te??0);se.push({id:ve.id,productId:z.productId,productName:z.productName,category:z.category,measurement:z.measurement??"unidad",packages:Number(z.packages||0),unitsPerPackage:Oe,totalUnits:te,remaining:J,remainingPackages:typeof z.remainingPackages=="number"?Number(z.remainingPackages):void 0,providerPrice:Number(z.providerPrice||0),subtotal:Number(z.subtotal||0),totalRivas:Number(z.totalRivas||0),totalSanJorge:Number(z.totalSanJorge||0),totalIsla:Number(z.totalIsla||0),gainRivas:Number(z.gainRivas||0),gainSanJorge:Number(z.gainSanJorge||0),gainIsla:Number(z.gainIsla||0),unitPriceRivas:Number(z.unitPriceRivas||0),unitPriceSanJorge:Number(z.unitPriceSanJorge||0),unitPriceIsla:Number(z.unitPriceIsla||0),date:z.date,createdAt:z.createdAt,status:z.status??"PENDIENTE",orderId:z.orderId??null})}),n(se)}catch(O){console.error(O),l(" Error cargando inventario.")}finally{a(!1)}})()},[]);const Z=N.useMemo(()=>r.filter(O=>!(c&&O.date<c||u&&O.date>u||f&&O.productId!==f||m&&String(O.category||"")!==m)),[r,c,u,f,m]),pe=N.useMemo(()=>{const O=new Set;for(const W of t)W.category&&O.add(W.category);return Array.from(O).sort((W,D)=>W.localeCompare(D))},[t]),ae=N.useMemo(()=>{const O=Z.reduce((z,Oe)=>z+Bl(Oe),0),W=Z.reduce((z,Oe)=>z+fC(Oe),0),D=Z.reduce((z,Oe)=>{const te=Bl(Oe);return z+Number(Oe.providerPrice||0)*te},0),Y=Z.reduce((z,Oe)=>{const te=Bl(Oe);return z+Number(Oe.unitPriceRivas||0)*te},0),se=Z.reduce((z,Oe)=>{const te=Bl(Oe);return z+Number(Oe.unitPriceSanJorge||0)*te},0),ve=Z.reduce((z,Oe)=>{const te=Bl(Oe);return z+Number(Oe.unitPriceIsla||0)*te},0);return{totalPaquetes:O,totalPaquetesRestantes:W,totalSubtotal:D,totalRivas:Y,totalSJ:se,totalIsla:ve}},[Z]),he=N.useMemo(()=>{let O=0,W=0;for(const D of Z)D.status==="PENDIENTE"&&(O+=1),D.status==="PAGADO"&&(W+=1);return{totalLotes:Z.length,pendientes:O,pagados:W}},[Z]),de=N.useMemo(()=>{const O=new Map;for(const D of Z){const Y=String(D.productId||"");Y&&(O.has(Y)||O.set(Y,{batches:[]}),O.get(Y).batches.push(D))}const W=[];for(const[D,Y]of O.entries()){const se=[...Y.batches].sort(Jve),ve=se[0],z=se.reduce((st,ft)=>st+Bl(ft),0),Oe=se.reduce((st,ft)=>st+fC(ft),0),te=Number((ve==null?void 0:ve.providerPrice)||0),J=Number((ve==null?void 0:ve.unitPriceRivas)||0),q=Number((ve==null?void 0:ve.unitPriceIsla)||0),ie=se.reduce((st,ft)=>{const nt=Bl(ft);return st+Number(ft.providerPrice||0)*nt},0),fe=se.reduce((st,ft)=>{const nt=Bl(ft);return st+Number(ft.unitPriceRivas||0)*nt},0),Ie=se.reduce((st,ft)=>{const nt=Bl(ft);return st+Number(ft.unitPriceIsla||0)*nt},0),Ve=fe-ie,ze=Ie-ie;let Ye="",ct;for(const st of se)(!Ye||String(st.date||"")>Ye)&&(Ye=String(st.date||""),ct=st.createdAt);W.push({productId:D,productName:(ve==null?void 0:ve.productName)||"",category:(ve==null?void 0:ve.category)||"",totalPackages:z,remainingPackages:Oe,providerPrice:te,unitPriceRivas:J,unitPriceIsla:q,subtotal:ie,totalRivas:fe,totalIsla:Ie,gainRivas:Ve,gainIsla:ze,lastDate:Ye,lastCreatedAt:ct,batchCount:se.length})}return W.sort((D,Y)=>String(Y.lastDate).localeCompare(String(D.lastDate))),W},[Z]),re=O=>{g(O.id),b(O.date),P(O.providerPrice),l("")},xe=()=>{g(null),b(""),P(0)},Ce=async()=>{if(!x)return;const O=r.find(Ie=>Ie.id===x);if(!O)return;if(F<0){l("El precio proveedor no puede ser negativo.");return}const W=Bl(O),D=F*W,Y=W>0?D/.8:0,se=W>0?D/.85:0,ve=W>0?D/.7:0,z=Y-D,Oe=se-D,te=ve-D,J=W>0?hC(Y/W):0,q=W>0?hC(se/W):0,ie=W>0?hC(ve/W):0,fe=kt(je,"inventory_candies",x);await kr(fe,{date:y,providerPrice:F,subtotal:D,totalRivas:Y,totalSanJorge:se,totalIsla:ve,gainRivas:z,gainSanJorge:Oe,gainIsla:te,unitPriceRivas:J,unitPriceSanJorge:q,unitPriceIsla:ie}),n(Ie=>Ie.map(Ve=>Ve.id===x?{...Ve,date:y,providerPrice:F,subtotal:D,totalRivas:Y,totalSanJorge:se,totalIsla:ve,gainRivas:z,gainSanJorge:Oe,gainIsla:te,unitPriceRivas:J,unitPriceSanJorge:q,unitPriceIsla:ie}:Ve)),O.orderId&&await dC(String(O.orderId)),l(" Lote de dulces actualizado"),xe()},S=async O=>{confirm(`Marcar PAGADO el lote del ${O.date} (${O.productName})?`)&&(await kr(kt(je,"inventory_candies",O.id),{status:"PAGADO"}),n(D=>D.map(Y=>Y.id===O.id?{...Y,status:"PAGADO"}:Y)),l(" Lote marcado como pagado"))},I=async O=>{confirm(`Eliminar el lote del ${O.date} (${O.productName})?`)&&(await un(kt(je,"inventory_candies",O.id)),n(D=>D.filter(Y=>Y.id!==O.id)),O.orderId&&await dC(String(O.orderId)),l(" Lote eliminado"))},V=async(O,W)=>{try{a(!0),l("");const D=Ut(At(je,"inventory_candies"),qt("productId","==",O),Rr("date","desc")),Y=await Nt(D),se=[];Y.forEach(ve=>{const z=ve.data(),Oe=Number(z.unitsPerPackage||0),te=Number(z.totalUnits??z.quantity??(z.packages||0)*(z.unitsPerPackage||0)),J=Number(z.remaining??z.totalUnits??te??0);se.push({id:ve.id,productId:z.productId,productName:z.productName,category:z.category,measurement:z.measurement??"unidad",packages:Number(z.packages||0),unitsPerPackage:Oe,totalUnits:te,remaining:J,remainingPackages:typeof z.remainingPackages=="number"?Number(z.remainingPackages):void 0,providerPrice:Number(z.providerPrice||0),subtotal:Number(z.subtotal||0),totalRivas:Number(z.totalRivas||0),totalSanJorge:Number(z.totalSanJorge||0),totalIsla:Number(z.totalIsla||0),gainRivas:Number(z.gainRivas||0),gainSanJorge:Number(z.gainSanJorge||0),gainIsla:Number(z.gainIsla||0),unitPriceRivas:Number(z.unitPriceRivas||0),unitPriceSanJorge:Number(z.unitPriceSanJorge||0),unitPriceIsla:Number(z.unitPriceIsla||0),date:z.date,createdAt:z.createdAt,status:z.status??"PENDIENTE",orderId:z.orderId??null})}),E(O),k(W),U(se),_(!0)}catch(D){console.error(D),l(" Error abriendo detalle del producto.")}finally{a(!1)}},j=async(O,W)=>{const D=r.filter(se=>se.productId===O);if(confirm(`Eliminar COMPLETAMENTE "${W}"?
Esto eliminar ${D.length} lote(s) de este producto.`))try{a(!0),l("");const se=Array.from(new Set(D.map(ve=>ve.orderId?String(ve.orderId):"").filter(Boolean)));for(const ve of D)await un(kt(je,"inventory_candies",ve.id));n(ve=>ve.filter(z=>z.productId!==O)),l(" Producto eliminado (todos sus lotes).");for(const ve of se)await dC(ve);R&&B===O&&(_(!1),U([]),E(""),k(""))}catch(se){console.error(se),l(" Error eliminando lotes del producto.")}finally{a(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:O=>A(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:O=>d(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:O=>p(O.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),pe.map(O=>i.jsx("option",{value:O,children:O},O))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:O=>h(O.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(O=>i.jsxs("option",{value:O.id,children:[O.name,"  ",O.category]},O.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",he.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",he.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",he.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ae.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ae.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",Ei(ae.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",Ei(ae.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",Ei(ae.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",Ei(ae.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):de.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):de.map(O=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:O.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:O.productName,children:O.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",O.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:O.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:O.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ei(O.gainIsla)}),i.jsx("td",{className:"p-2 border",children:O.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>V(O.productId,O.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>j(O.productId,O.productName),children:"Borrar"})]})})]},O.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),R&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",M||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",B]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{_(!1),U([]),E(""),k(""),xe()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):T.map(O=>{const W=x===O.id,D=Bl(O),Y=fC(O);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:W?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:se=>b(se.target.value)}):O.date}),i.jsx("td",{className:"p-2 border align-top",children:O.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:O.productName,children:O.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",O.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:D}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Y}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:O.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:W?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(F)?"":F,onChange:se=>P(Math.max(0,parseFloat(se.target.value||"0")))}):Ei(O.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Ei(O.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Ei(O.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:O.orderId?String(O.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${O.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:O.status})}),i.jsx("td",{className:"p-2 border align-top",children:W?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ce,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:xe,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[O.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>S(O),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>re(O),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>I(O),children:"Borrar"})]})})]},O.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>j(B,M),children:"Borrar producto (todos los lotes)"})})]})})]})}const m3=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],lc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function P1(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function p3(t){const e=Ut(At(je,"ar_movements"),qt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(je,"ar_movements",n.id))))}function Yve({role:t="",sellerCandyId:e="",currentUserEmail:r}){const n=String(t||"").trim().toLowerCase(),s=String(e||"").trim(),a=n==="vendedor_dulces",o=n==="admin",[l,c]=N.useState([]),[A,u]=N.useState(!1),[d,f]=N.useState(!1),[h,m]=N.useState(null),[p,x]=N.useState([]),g=async ye=>{u(!0),f(!0),m(ye),x([]);try{const Le=(await Nt(Ut(At(je,"sales_candies"),qt("__name__","==",ye)))).docs[0],Je=Le==null?void 0:Le.data(),Xe=(Array.isArray(Je==null?void 0:Je.items)?Je.items:Je!=null&&Je.item?[Je.item]:[]).map(Ze=>({productName:String(Ze.productName||""),qty:Number(Ze.qty||0),unitPrice:Number(Ze.unitPrice||0),discount:Number(Ze.discount||0),total:Number(Ze.total||0)}));x(Xe)}catch(Me){console.error(Me)}finally{f(!1)}},[y,b]=N.useState(""),[F,P]=N.useState("+505 "),[R,_]=N.useState(""),[B,E]=N.useState(""),[M,k]=N.useState("ACTIVO"),[T,U]=N.useState(0),[Z,pe]=N.useState(""),[ae,he]=N.useState(0),[de,re]=N.useState([]),[xe,Ce]=N.useState(!0),[S,I]=N.useState(""),[V,j]=N.useState(null),[O,W]=N.useState(""),[D,Y]=N.useState("+505 "),[se,ve]=N.useState(""),[z,Oe]=N.useState(""),[te,J]=N.useState("ACTIVO"),[q,ie]=N.useState(0),[fe,Ie]=N.useState(""),[Ve,ze]=N.useState(!1),[Ye,ct]=N.useState(null),[st,ft]=N.useState(!1),[nt,De]=N.useState([]),[Fe,Ge]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[_e,G]=N.useState(!1),[Ne,Ue]=N.useState(0),[$e,ge]=N.useState(new Date().toISOString().slice(0,10)),[Be,Qe]=N.useState(""),[Te,We]=N.useState(!1),[at,bt]=N.useState(null),[ot,wt]=N.useState(""),[Lt,Ar]=N.useState(0),[ir,xr]=N.useState(""),[er,et]=N.useState(!1);N.useEffect(()=>{(async()=>{try{if(Ce(!0),a&&!s){re([]),I(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const ye=await Nt(At(je,"sellers_candies")),Me=[];ye.forEach(Xe=>{const Ze=Xe.data(),ut=String(Ze.status||"ACTIVO");ut==="ACTIVO"&&Me.push({id:Xe.id,name:String(Ze.name||""),status:ut})}),c(Me);const Le=a?Ut(At(je,"customers_candies"),qt("vendorId","==",s),Rr("createdAt","desc")):Ut(At(je,"customers_candies"),Rr("createdAt","desc")),Je=await Nt(Le),tt=[];Je.forEach(Xe=>{const Ze=Xe.data();tt.push({id:Xe.id,name:Ze.name??"",phone:Ze.phone??"+505 ",place:Ze.place??"",notes:Ze.notes??"",status:Ze.status??"ACTIVO",creditLimit:Number(Ze.creditLimit??0),createdAt:Ze.createdAt??Kt.now(),balance:0,sellerId:Ze.sellerId||"",vendorId:Ze.vendorId||"",vendorName:Ze.vendorName||"",initialDebt:Number(Ze.initialDebt||0)})});for(const Xe of tt)try{const Ze=Ut(At(je,"ar_movements"),qt("customerId","==",Xe.id)),ut=await Nt(Ze);let Ht=0;ut.forEach(wr=>Ht+=Number(wr.data().amount||0)),Xe.balance=Ht}catch{Xe.balance=0}re(tt)}catch(ye){console.error(ye),I(" Error cargando clientes.")}finally{Ce(!1)}})()},[a,s]);const gt=()=>{b(""),P("+505 "),_(""),E(""),k("ACTIVO"),U(0),pe(""),he(0)},Pt=async ye=>{var tt;if(ye.preventDefault(),I(""),!y.trim()){I("Ingresa el nombre.");return}const Me=P1(F);if(Me.length<6){I("Telfono incompleto.");return}const Le=a?s:String(Z||"").trim(),Je=Le&&((tt=l.find(Xe=>Xe.id===Le))==null?void 0:tt.name)||"";try{const Xe=await Wr(At(je,"customers_candies"),{name:y.trim(),phone:Me,place:R||"",notes:B||"",status:M,creditLimit:Number(T||0),vendorId:Le,vendorName:Je,initialDebt:Number(ae||0),createdAt:Kt.now()});re(Ze=>[{id:Xe.id,name:y.trim(),phone:Me,place:R||"",notes:B||"",status:M,creditLimit:Number(T||0),vendorId:Le,vendorName:Je,initialDebt:Number(ae||0),createdAt:Kt.now(),balance:0},...Ze]),gt(),et(!1),I(" Cliente creado")}catch(Xe){console.error(Xe),I(" Error al crear cliente")}},Ft=ye=>{if(a){I(" No permitido: vendedores no editan clientes desde el listado.");return}j(ye.id),W(ye.name),Y(ye.phone||"+505 "),ve(ye.place||""),Oe(ye.notes||""),J(ye.status||"ACTIVO"),ie(Number(ye.creditLimit||0)),Ie(String(ye.vendorId||""))},Tt=()=>{j(null),W(""),Y("+505 "),ve(""),Oe(""),J("ACTIVO"),ie(0),Ie("")},Xt=async()=>{var Ze;if(a){I(" No permitido.");return}if(!V)return;const ye=P1(D);if(!O.trim()){I("Ingresa el nombre.");return}const Me=de.find(ut=>ut.id===V),Le=String((Me==null?void 0:Me.vendorId)||""),Je=a?s:String(fe||"");if(a&&Le&&Le!==s){I(" Este cliente pertenece a otro vendedor.");return}if(o&&Le&&Je&&Le!==Je){I(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const tt=a?s:String(fe||""),Xe=tt&&((Ze=l.find(ut=>ut.id===tt))==null?void 0:Ze.name)||"";try{await kr(kt(je,"customers_candies",V),{name:O.trim(),phone:ye,place:se||"",notes:z||"",status:te,creditLimit:Number(q||0),vendorId:tt,vendorName:Xe}),re(ut=>ut.map(Ht=>Ht.id===V?{...Ht,name:O.trim(),phone:ye,place:se||"",notes:z||"",status:te,creditLimit:Number(q||0),vendorId:tt,vendorName:Xe}:Ht)),Tt(),I(" Cliente actualizado")}catch(ut){console.error(ut),I(" Error al actualizar")}},Vt=async ye=>{if(confirm(`Eliminar al cliente "${ye.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{Ce(!0);const Le=Ut(At(je,"sales_candies"),qt("customerId","==",ye.id)),Je=await Nt(Le);for(const Ze of Je.docs){const ut=Ze.id;try{await cx(ut)}catch(Ht){console.warn("restoreSaleAndDeleteCandy error",Ht);try{await un(kt(je,"sales_candies",ut))}catch{}}await p3(ut)}const tt=Ut(At(je,"ar_movements"),qt("customerId","==",ye.id)),Xe=await Nt(tt);await Promise.all(Xe.docs.map(Ze=>un(kt(je,"ar_movements",Ze.id)))),await un(kt(je,"customers_candies",ye.id)),re(Ze=>Ze.filter(ut=>ut.id!==ye.id)),I(" Cliente eliminado y dulces devueltos al inventario")}catch(Le){console.error(Le),I(" No se pudo eliminar el cliente.")}finally{Ce(!1)}},oe=async ye=>{ct(ye),De([]),Ge({saldoActual:0,totalAbonado:0,totalCargos:0}),ze(!0),G(!1),Ue(0),ge(new Date().toISOString().slice(0,10)),Qe(""),bt(null),ft(!0);try{const Me=Ut(At(je,"ar_movements"),qt("customerId","==",ye.id)),Le=await Nt(Me),Je=[];Le.forEach(tt=>{var Ze,ut;const Xe=tt.data();Je.push({id:tt.id,date:Xe.date??((ut=(Ze=Xe.createdAt)==null?void 0:Ze.toDate)!=null&&ut.call(Ze)?Xe.createdAt.toDate().toISOString().slice(0,10):""),type:Xe.type??"CARGO",amount:Number(Xe.amount||0),ref:Xe.ref||{},comment:Xe.comment||"",createdAt:Xe.createdAt})}),Je.sort((tt,Xe)=>{var Ht,wr;if(tt.date!==Xe.date)return tt.date.localeCompare(Xe.date);const Ze=((Ht=tt.createdAt)==null?void 0:Ht.seconds)||0,ut=((wr=Xe.createdAt)==null?void 0:wr.seconds)||0;return Ze-ut}),De(Je),ne(Je)}catch(Me){console.error(Me),I(" No se pudo cargar el estado de cuenta")}finally{ft(!1)}},ne=ye=>{const Me=ye.reduce((tt,Xe)=>tt+(Number(Xe.amount)||0),0),Le=ye.filter(tt=>Number(tt.amount)<0).reduce((tt,Xe)=>tt+Math.abs(Number(Xe.amount)||0),0),Je=ye.filter(tt=>Number(tt.amount)>0).reduce((tt,Xe)=>tt+(Number(Xe.amount)||0),0);Ge({saldoActual:Me,totalAbonado:Le,totalCargos:Je})},ue=async()=>{if(!Ye)return;I("");const ye=Number(Ne||0);if(!(ye>0)){I("Ingresa un monto de abono mayor a 0.");return}const Me=parseFloat(ye.toFixed(2));if(!$e){I("Selecciona la fecha del abono.");return}try{We(!0);const Le={customerId:Ye.id,type:"ABONO",amount:-Me,date:$e,comment:Be||"",createdAt:Kt.now()},tt={id:(await Wr(At(je,"ar_movements"),Le)).id,date:$e,type:"ABONO",amount:-Me,comment:Be||"",createdAt:Kt.now()},Xe=[...nt,tt].sort((Ze,ut)=>{var ur,Kr;if(Ze.date!==ut.date)return Ze.date.localeCompare(ut.date);const Ht=((ur=Ze.createdAt)==null?void 0:ur.seconds)||0,wr=((Kr=ut.createdAt)==null?void 0:Kr.seconds)||0;return Ht-wr});De(Xe),ne(Xe),re(Ze=>Ze.map(ut=>ut.id===Ye.id?{...ut,balance:(ut.balance||0)-Me}:ut)),ct(Ze=>Ze&&{...Ze,balance:(Ze.balance||0)-Me}),Ue(0),Qe(""),ge(new Date().toISOString().slice(0,10)),G(!1),I(" Abono registrado")}catch(Le){console.error(Le),I(" Error al registrar el abono")}finally{We(!1)}},K=ye=>{bt(ye.id),wt(ye.date||new Date().toISOString().slice(0,10)),Ar(Math.abs(Number(ye.amount||0))),xr(ye.comment||"")},le=()=>{bt(null),wt(""),Ar(0),xr("")},me=async()=>{if(!at)return;const ye=nt.findIndex(tt=>tt.id===at);if(ye===-1)return;const Me=nt[ye],Le=Number(Lt||0);if(!(Le>0)){I("El monto debe ser mayor a 0.");return}const Je=Me.type==="ABONO"?-parseFloat(Le.toFixed(2)):+parseFloat(Le.toFixed(2));try{await kr(kt(je,"ar_movements",at),{date:ot,amount:Je,comment:ir||""});const tt=[...nt];tt[ye]={...Me,date:ot,amount:Je,comment:ir||""},tt.sort((Ze,ut)=>{var ur,Kr;if(Ze.date!==ut.date)return Ze.date.localeCompare(ut.date);const Ht=((ur=Ze.createdAt)==null?void 0:ur.seconds)||0,wr=((Kr=ut.createdAt)==null?void 0:Kr.seconds)||0;return Ht-wr}),De(tt),ne(tt);const Xe=tt.reduce((Ze,ut)=>Ze+(Number(ut.amount)||0),0);re(Ze=>Ze.map(ut=>ut.id===(Ye==null?void 0:Ye.id)?{...ut,balance:Xe}:ut)),ct(Ze=>Ze&&{...Ze,balance:Xe}),le(),I(" Movimiento actualizado")}catch(tt){console.error(tt),I(" Error al actualizar movimiento")}},Re=async ye=>{var Le,Je;if(confirm(`Eliminar este movimiento (${ye.type==="ABONO"?"Abono":"Compra"}) del ${ye.date}?${ye.type==="CARGO"&&((Le=ye.ref)!=null&&Le.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`))try{if(Ce(!0),ye.type==="CARGO"&&((Je=ye.ref)!=null&&Je.saleId)){try{await cx(ye.ref.saleId)}catch(Ze){console.warn("restoreSaleAndDeleteCandy error",Ze),Ce(!1),I(" No se pudo devolver inventario de la venta.");return}await p3(ye.ref.saleId)}else await un(kt(je,"ar_movements",ye.id));const tt=nt.filter(Ze=>{var ut,Ht;return ye.type==="CARGO"&&((ut=ye.ref)!=null&&ut.saleId)?((Ht=Ze.ref)==null?void 0:Ht.saleId)!==ye.ref.saleId:Ze.id!==ye.id});De(tt),ne(tt);const Xe=tt.reduce((Ze,ut)=>Ze+(Number(ut.amount)||0),0);re(Ze=>Ze.map(ut=>ut.id===(Ye==null?void 0:Ye.id)?{...ut,balance:Xe}:ut)),ct(Ze=>Ze&&{...Ze,balance:Xe}),I(" Movimiento eliminado")}catch(tt){console.error(tt),I(" Error al eliminar movimiento")}finally{Ce(!1)}},Ee=N.useMemo(()=>[...de].sort((ye,Me)=>{var Le,Je;return ye.status!==Me.status?ye.status==="BLOQUEADO"?1:-1:(((Le=Me.createdAt)==null?void 0:Le.seconds)||0)-(((Je=ye.createdAt)==null?void 0:Je.seconds)||0)}),[de]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{et(!0),a&&pe(s)},type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:xe?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Ee.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Ee.map(ye=>{var Le;const Me=V===ye.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Le=ye.createdAt)!=null&&Le.toDate?ye.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:Me?i.jsx("input",{className:"w-full border p-1 rounded",value:O,onChange:Je=>W(Je.target.value)}):i.jsx("div",{className:"font-medium",children:ye.name})}),i.jsx("td",{className:"p-2 border",children:Me?i.jsx("input",{className:"w-full border p-1 rounded",value:D,onChange:Je=>Y(P1(Je.target.value))}):ye.phone}),i.jsx("td",{className:"p-2 border",children:Me?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:a?s:fe,onChange:Je=>Ie(Je.target.value),disabled:a,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),l.map(Je=>i.jsx("option",{value:Je.id,children:Je.name},Je.id))]}):ye.vendorName||""}),i.jsx("td",{className:"p-2 border",children:Me?i.jsxs("select",{className:"w-full border p-1 rounded",value:se,onChange:Je=>ve(Je.target.value),children:[i.jsx("option",{value:"",children:""}),m3.map(Je=>i.jsx("option",{value:Je,children:Je},Je))]}):ye.place||""}),i.jsx("td",{className:"p-2 border",children:Me?i.jsxs("select",{className:"w-full border p-1 rounded",value:te,onChange:Je=>J(Je.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ye.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ye.status})}),i.jsx("td",{className:"p-2 border",children:Me?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(q)?"":q,onChange:Je=>ie(Math.max(0,Number(Je.target.value||0)))}):lc(ye.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:lc(ye.balance||0)}),i.jsx("td",{className:"p-2 border",children:Me?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:z,onChange:Je=>Oe(Je.target.value),maxLength:500}):i.jsx("span",{title:ye.notes||"",children:(ye.notes||"").length>40?(ye.notes||"").slice(0,40)+"":ye.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Me?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Xt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Tt,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ft(ye),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Vt(ye),disabled:!o,title:o?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>oe(ye),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},ye.id)})})]})}),S&&i.jsx("p",{className:"mt-2 text-sm",children:S}),er&&Vu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>et(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>et(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Pt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:y,onChange:ye=>b(ye.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:F,onChange:ye=>P(P1(ye.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:R,onChange:ye=>_(ye.target.value),children:[i.jsx("option",{value:"",children:""}),m3.map(ye=>i.jsx("option",{value:ye,children:ye},ye))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:M,onChange:ye=>k(ye.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a?s:Z,onChange:ye=>pe(ye.target.value),disabled:a,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),l.map(ye=>i.jsx("option",{value:ye.id,children:ye.name},ye.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:ye=>he(Math.max(0,Number(ye.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor queda fijo (no cambia)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:T===0?"":T,onChange:ye=>U(Math.max(0,Number(ye.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:B,onChange:ye=>E(ye.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[B.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>et(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),Ve&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(Ye==null?void 0:Ye.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Ue(0),ge(new Date().toISOString().slice(0,10)),Qe(""),G(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ze(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(Number((Ye==null?void 0:Ye.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(Fe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(Fe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(Fe.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:st?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):nt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):nt.map(ye=>{var Le,Je;const Me=at===ye.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Me?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:ot,onChange:tt=>wt(tt.target.value)}):ye.date||""}),i.jsx("td",{className:"p-2 border",children:ye.amount>=0?(Le=ye.ref)!=null&&Le.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>g(ye.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Je=ye.ref)!=null&&Je.saleId?`Venta #${ye.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:Me?i.jsx("input",{className:"w-full border p-1 rounded",value:ir,onChange:tt=>xr(tt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:ye.comment||"",children:(ye.comment||"").length>40?(ye.comment||"").slice(0,40)+"":ye.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:Me?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Lt)?"":Lt,onChange:tt=>{const Xe=Number(tt.target.value||0),Ze=Number.isFinite(Xe)?Math.max(0,parseFloat(Xe.toFixed(2))):0;Ar(Ze)},placeholder:"0.00",title:ye.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):lc(ye.amount)}),i.jsx("td",{className:"p-2 border",children:Me?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:me,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:le,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>K(ye),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Re(ye),children:"Borrar"})]})})]},ye.id)})})]})})]})}),_e&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(Ye==null?void 0:Ye.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:$e,onChange:ye=>ge(ye.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Ne===0?"":Ne,onChange:ye=>{const Me=Number(ye.target.value||0),Le=Number.isFinite(Me)?Math.max(0,parseFloat(Me.toFixed(2))):0;Ue(Le)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Be,onChange:ye=>Qe(ye.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Be.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>G(!1),disabled:Te,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:ue,disabled:Te,children:Te?"Guardando...":"Guardar abono"})]})]})}),A&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",h?` #${h}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>u(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:d?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):p.map((ye,Me)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ye.productName}),i.jsx("td",{className:"p-2 border text-right",children:ye.qty}),i.jsx("td",{className:"p-2 border text-right",children:lc(ye.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:lc(ye.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:lc(ye.total)})]},Me))})]})})]})})]})}const Dd=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Zve=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];function e1e(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function t1e(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function r1e(t){const{saleId:e,date:r,customerName:n,branch:s,items:a,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:A}=t,u=new sr;let d=12;if(u.setFontSize(14),u.text("Multiservicios Ortiz",10,d),d+=6,u.setFontSize(12),u.text("Recibo de venta certificada",10,d),d+=8,u.setFontSize(10),u.text(`Fecha: ${r}`,10,d),d+=5,u.text(`Cliente: ${n||"Cliente Mostrador"}`,10,d),d+=5,u.text(`Sucursal: ${e1e(s)}`,10,d),d+=5,u.text(`Autorizado: ${e}`,10,d),d+=5,l&&(u.text(`Vendedor: ${l}`,10,d),d+=5),typeof c=="number"){const f=Number(A||0).toFixed(2),h=c.toFixed(2);u.text(`Comisin vendedor: ${h}%  C$ ${f}`,10,d),d+=8}else d+=3;u.setFontSize(9),u.text("Producto",10,d),u.text("Paquetes",110,d,{align:"right"}),u.text("Precio.",150,d,{align:"right"}),u.text("Subtotal",190,d,{align:"right"}),d+=4,u.line(10,d,190,d),d+=4,a.forEach(f=>{d>270&&(u.addPage(),d=12);const h=(f.productName||"").length>50?f.productName.slice(0,47)+"...":f.productName;u.text(h,10,d),u.text(String(f.qty),110,d,{align:"right"}),u.text(`C$ ${Number(f.unitPrice||0).toFixed(2)}`,150,d,{align:"right"}),u.text(`C$ ${Number(f.total||0).toFixed(2)}`,190,d,{align:"right"}),d+=5}),d+=4,u.line(10,d,190,d),d+=6,u.setFontSize(11),u.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,d,{align:"right"}),d+=6,u.setFontSize(9),u.text("Gracias por su compra.",10,d),u.save(`venta_dulces_${e}.pdf`)}async function g3(t,e){if(!t||!e)return 0;const r=Ut(At(je,"inventory_candies_sellers"),qt("sellerId","==",e),qt("productId","==",t)),n=await Nt(r);let s=0;return n.forEach(a=>{const o=a.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(s+=l)}),s}const x3=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function n1e(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:s,saleId:a}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=Ut(At(je,"inventory_candies_sellers"),qt("sellerId","==",r),qt("productId","==",e),qt("remainingUnits",">",0),Rr("date","asc"),Rr("createdAt","asc")),A=await Nt(c);for(const u of A.docs){if(o<=0)break;const d=u.data(),f=Number(d.remainingUnits||0);if(f<=0)continue;const h=Math.min(f,o),m=f-h,p=Math.max(1,Math.floor(Number(d.unitsPerPackage||1))),x=Math.floor(m/p);await kr(u.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:u.id,productId:e,units:h,saleDate:s,saleId:a}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function v3(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function s1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const[n,s]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState([]),[A,u]=N.useState({}),[d,f]=N.useState("CONTADO"),[h,m]=N.useState("RIVAS"),[p,x]=N.useState(""),[g,y]=N.useState(""),[b,F]=N.useState(x3()),[P,R]=N.useState(""),[_,B]=N.useState(!1),[E,M]=N.useState(""),[k,T]=N.useState([]),U=N.useMemo(()=>k.reduce((ge,Be)=>ge+(Be.qtyPackages||0),0),[k]),Z=N.useMemo(()=>k.reduce((ge,Be)=>ge+(Be.qtyPackages||0)*(Be.unitsPerPackage||1),0),[k]),pe=N.useMemo(()=>{const ge=k.reduce((Be,Qe)=>{const Te=(Number(Qe.pricePerPackage)||0)*(Qe.qtyPackages||0),We=Number(Qe.discount)||0,at=Math.max(0,Te-We);return Be+at},0);return Math.floor(ge*100)/100},[k]),[ae,he]=N.useState(0),[de,re]=N.useState(""),[xe,Ce]=N.useState(!1),[S,I]=N.useState(!1),[V,j]=N.useState(""),[O,W]=N.useState("+505 "),[D,Y]=N.useState(""),[se,ve]=N.useState(""),[z,Oe]=N.useState("ACTIVO"),[te,J]=N.useState(0),[q,ie]=N.useState(""),fe=()=>{j(""),W("+505 "),Y(""),ve(""),Oe("ACTIVO"),J(0)},Ie=N.useMemo(()=>n.find(ge=>ge.id===p),[n,p]),Ve=N.useMemo(()=>_&&P?n.filter(ge=>(ge.vendorId??ge.sellerId??"")===P):n,[n,_,P]),ze=(Ie==null?void 0:Ie.balance)||0,Ye=d==="CREDITO"?ze+Math.max(0,Number(pe||0))-Math.max(0,Number(ae||0)):0,ct=N.useMemo(()=>l.find(ge=>ge.id===P)||null,[l,P]),st=(ct==null?void 0:ct.commissionPercent)||0,ft=N.useMemo(()=>{const ge=Number(pe||0),Be=Number(st||0),Qe=ge*Be/100;return Number(Qe.toFixed(2))},[pe,st]);N.useEffect(()=>{(async()=>{const ge=Ut(At(je,"customers_candies"),Rr("createdAt","desc")),Be=await Nt(ge),Qe=[];Be.forEach(bt=>{const ot=bt.data();Qe.push({id:bt.id,name:ot.name??"",phone:ot.phone??"+505 ",place:ot.place??"",status:ot.status??"ACTIVO",creditLimit:Number(ot.creditLimit??0),balance:0,sellerId:ot.sellerId??ot.vendorId??"",vendorId:ot.vendorId??ot.sellerId??""})});for(const bt of Qe)try{const ot=Ut(At(je,"ar_movements"),qt("customerId","==",bt.id)),wt=await Nt(ot);let Lt=0;wt.forEach(Ar=>Lt+=Number(Ar.data().amount||0)),bt.balance=Lt}catch{bt.balance=0}s(Qe);const Te=Ut(At(je,"products_candies"),Rr("createdAt","desc")),We=await Nt(Te),at=[];We.forEach(bt=>{const ot=bt.data();at.push({id:bt.id,name:ot.name??"(sin nombre)",sku:ot.sku??"",unitsPerPackage:Number(ot.unitsPerPackage??1),priceRivas:Number(ot.unitPriceRivas??0),priceSanJorge:Number(ot.unitPriceSanJorge??0),priceIsla:Number(ot.unitPriceIsla??0)})}),o(at);try{const bt=await Nt(At(je,"sellers_candies")),ot=[];bt.forEach(wt=>{const Lt=wt.data(),Ar=Lt.branch||"Rivas",ir=t1e(Ar);ot.push({id:wt.id,name:Lt.name??"(sin nombre)",branch:ir,branchLabel:Ar,commissionPercent:Number(Lt.commissionPercent??0)})}),c(ot)}catch(bt){console.error("Error cargando vendedores:",bt)}u({})})()},[]),N.useEffect(()=>{if(t==="vendedor_dulces"&&e){R(e),B(!0);try{localStorage.setItem("pos_vendorId",e),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(t==="admin"){B(!1);return}try{const ge=localStorage.getItem("pos_vendorId")||"",Be=localStorage.getItem("pos_role")||"";ge&&R(ge),Be.toUpperCase()==="VENDEDOR"&&B(!0)}catch{}},[t,e]);const nt=async ge=>{if(!ge){u({});return}const Be=Ut(At(je,"inventory_candies_sellers"),qt("sellerId","==",ge)),Qe=await Nt(Be),Te={};Qe.forEach(We=>{const at=We.data(),bt=at.productId||"";if(!bt)return;const ot=Number(at.remainingUnits??at.remaining??at.totalUnits??0);ot<=0||(Te[bt]=(Te[bt]||0)+ot)}),u(Te),T(We=>{const at=[];for(const bt of We){const ot=Te[bt.productId]??0;ot>0&&at.push({...bt,availableUnits:ot})}return at})};N.useEffect(()=>{if(!P){u({});return}const ge=l.find(Be=>Be.id===P);ge&&m(ge.branch),nt(P)},[P,l]),N.useEffect(()=>{T(ge=>ge.map(Be=>{const Qe=a.find(We=>We.id===Be.productId);if(!Qe)return Be;const Te=h==="RIVAS"?Qe.priceRivas:h==="SAN_JORGE"?Qe.priceSanJorge:Qe.priceIsla;return{...Be,pricePerPackage:Number(Te)||0}}))},[h,a]);async function De(ge){const{productId:Be,vendorId:Qe,branch:Te}=ge;if(!Be||!Qe)return 0;const We=Ut(At(je,"inventory_candies_sellers"),qt("sellerId","==",Qe),qt("productId","==",Be)),at=await Nt(We);if(at.empty)return 0;const bt=at.docs[0].data(),ot=Number(bt.unitPriceVendor??0);if(ot>0)return ot;const wt=Number(Te==="RIVAS"?bt.unitPriceRivas??0:Te==="SAN_JORGE"?bt.unitPriceSanJorge??0:bt.unitPriceIsla??0);return Number(wt||0)}const Fe=async ge=>{var bt;if(!ge)return;if(!P){re("Selecciona primero el vendedor para usar su inventario."),M("");return}if(k.some(ot=>ot.productId===ge)){M("");return}const Be=a.find(ot=>ot.id===ge);if(!Be){M("");return}const Qe=await g3(ge,P),Te=((bt=l.find(ot=>ot.id===P))==null?void 0:bt.branch)??h,We=await De({productId:ge,vendorId:P,branch:Te}),at={productId:ge,productName:Be.name||"",sku:Be.sku||"",unitsPerPackage:Be.unitsPerPackage||1,pricePerPackage:Number(We)||0,availableUnits:Number(Qe)||0,qtyPackages:0,discount:0};T(ot=>[...ot,at]),M("")},Ge=(ge,Be)=>{T(Qe=>Qe.map(Te=>{if(Te.productId!==ge)return Te;if(Be==="")return{...Te,qtyPackages:0};const We=Math.max(0,Math.floor(Number(Be)));return{...Te,qtyPackages:We}}))},_e=(ge,Be)=>{T(Qe=>Qe.map(Te=>{if(Te.productId!==ge)return Te;if(Be==="")return{...Te,discount:0};const We=Math.max(0,Math.floor(Number(Be)));return{...Te,discount:We}}))},G=ge=>T(Be=>Be.filter(Qe=>Qe.productId!==ge)),Ne=async()=>{if(!b)return"Selecciona la fecha.";if(!P)return"Selecciona el vendedor para esta venta.";if(k.length===0)return"Agrega al menos un producto.";const ge=k.filter(Be=>(Be.qtyPackages||0)>0);if(ge.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(pe>0))return"El total debe ser mayor a cero.";if(d==="CONTADO"){if(!g.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!p)return"Selecciona un cliente (crdito).";if(ae<0)return"El pago inicial no puede ser negativo.";if(ae>pe)return"El pago inicial no puede superar el total.";if((Ie==null?void 0:Ie.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Be of ge){const Qe=Be.unitsPerPackage||1,Te=(Be.qtyPackages||0)*Qe,We=await g3(Be.productId,P),at=Math.floor(We/Qe);if(Te>We)return`Inventario insuficiente en el pedido del vendedor para "${Be.productName}". Disponible: ${at} paquetes.`;const bt=(Number(Be.pricePerPackage)||0)*(Be.qtyPackages||0),ot=Number(Be.discount)||0;if(!Number.isInteger(ot)||ot<0)return`El descuento en "${Be.productName}" debe ser entero y  0.`;if(ot>bt)return`El descuento en "${Be.productName}" no puede exceder C$ ${bt.toFixed(2)}.`}return null},Ue=async ge=>{ge.preventDefault(),re("");const Be=await Ne();if(Be){re(" "+Be);return}try{Ce(!0);const Qe=k.filter(ot=>(ot.qtyPackages||0)>0).map(ot=>{const wt=ot.unitsPerPackage||1,Lt=ot.qtyPackages||0,Ar=Lt*wt,ir=(Number(ot.pricePerPackage)||0)*(Lt||0),xr=Math.max(0,Math.floor(Number(ot.discount)||0)),er=Math.max(0,ir-xr);return{productId:ot.productId,productName:ot.productName,sku:ot.sku||"",qty:Ar,packages:Lt,unitsPerPackage:wt,branch:h,unitPricePackage:Number(ot.pricePerPackage)||0,discount:xr,total:Math.floor(er*100)/100}}),Te={type:d,branch:h,date:b,createdAt:Kt.now(),itemsTotal:Number(pe)||0,total:Number(pe)||0,quantity:Number(Z)||0,packagesTotal:Number(U)||0,items:Qe,vendorId:P},We=l.find(ot=>ot.id===P);We&&(Te.vendorName=We.name,Te.vendorBranch=We.branch,Te.vendorBranchLabel=We.branchLabel,Te.vendorCommissionPercent=We.commissionPercent||0,Te.vendorCommissionAmount=ft||0),d==="CONTADO"?Te.customerName=g.trim():(Te.customerId=p,Te.downPayment=Number(ae)||0);const at=await Wr(At(je,"sales_candies"),Te);if(d==="CONTADO"){const ot=(g||"").trim();if(ot)try{await Wr(At(je,"cash_customers"),{name:ot,date:b,branch:h,vendorId:P,createdAt:Kt.now()})}catch(wt){console.warn("No se pudo guardar cash_customer:",wt)}}if(d==="CREDITO"&&p){const ot={customerId:p,date:b,createdAt:Kt.now(),ref:{saleId:at.id}},wt=Number((Ie==null?void 0:Ie.balance)||0);if(await Wr(At(je,"ar_movements"),{...ot,type:"CARGO",amount:Number(pe)||0}),Number(ae)>0&&await Wr(At(je,"ar_movements"),{...ot,type:"ABONO",amount:-Number(ae)}),wt===0)try{await kr(kt(je,"customers_candies",p),{initialDebt:Number(pe)||0,initialDebtDate:b})}catch(Lt){console.warn("No se pudo setear initialDebt:",Lt)}}const bt={};for(const ot of Qe)if(ot.qty>0){const{allocations:wt}=await n1e({productId:ot.productId,vendorId:P,quantityUnits:ot.qty,saleDate:b,saleId:at.id});bt[ot.productId]={productId:ot.productId,vendorId:P,allocations:wt}}await kr(kt(je,"sales_candies",at.id),{allocationsByItem:bt});try{const ot=d==="CONTADO"?g.trim()||"Cliente Mostrador":(Ie==null?void 0:Ie.name)||"Cliente crdito";r1e({saleId:at.id,date:b,customerName:ot,branch:h,items:Qe.map(wt=>({productName:wt.productName,qty:wt.packages,unitPrice:wt.unitPricePackage,total:wt.total})),total:Number(pe)||0,vendorName:We==null?void 0:We.name,vendorCommissionPercent:(We==null?void 0:We.commissionPercent)||0,vendorCommissionAmount:ft})}catch(ot){console.error("Error generando voucher PDF:",ot)}f("CONTADO"),x(""),y(""),F(x3()),T([]),he(0),d==="CREDITO"&&p&&s(ot=>ot.map(wt=>wt.id===p?{...wt,balance:(wt.balance||0)+(Number(pe)||0)-(Number(ae)||0)}:wt)),re(" Venta de dulces registrada"),P?await nt(P):u({})}catch(Qe){console.error(Qe),re(" Error al guardar la venta de dulces")}finally{Ce(!1)}},$e=N.useMemo(()=>a.filter(ge=>{const Be=A[ge.id]||0,Qe=Math.max(1,Number(ge.unitsPerPackage||1));return Math.floor(Be/Qe)>0}).sort((ge,Be)=>(ge.name||"").localeCompare(Be.name||"")),[a,A]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Dulces)"}),i.jsxs("form",{onSubmit:Ue,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:d,onChange:ge=>f(ge.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),d==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:g,onChange:ge=>y(ge.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:p,onChange:ge=>x(ge.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),Ve.map(ge=>i.jsxs("option",{value:ge.status==="ACTIVO"?ge.id:"",disabled:ge.status==="BLOQUEADO",children:[ge.name," | ",ge.phone," | Saldo: ",Dd(ge.balance||0)]},ge.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>I(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Dd(ze)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:ge=>he(Math.max(0,Number(ge.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Dd(Ye)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:b,onChange:ge=>F(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:ge=>{R(ge.target.value),T([])},disabled:_,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.map(ge=>i.jsxs("option",{value:ge.id,children:[ge.name,"  ",ge.branchLabel,"  ",ge.commissionPercent.toFixed(2),"%"," comisin"]},ge.id))]}),_&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:h==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:h==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:h==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:E,onChange:async ge=>{const Be=ge.target.value;M(Be),await Fe(Be)},disabled:!P,children:[i.jsx("option",{value:"",children:P?"Selecciona un producto":"Selecciona un vendedor primero"}),$e.map(ge=>{const Be=k.some(at=>at.productId===ge.id),Qe=A[ge.id]||0,Te=Math.max(1,Number(ge.unitsPerPackage||1)),We=Math.floor(Qe/Te);return We<=0?null:i.jsxs("option",{value:Be?"":ge.id,disabled:Be,children:[ge.name," ",ge.sku?` ${ge.sku}`:""," (disp: ",We," ","paq.)",Be?" ":""]},ge.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),k.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):k.map(ge=>{const Be=A[ge.productId]??ge.availableUnits??0,Qe=ge.unitsPerPackage?Math.floor(Be/ge.unitsPerPackage):0,Te=Math.max(0,Qe-(ge.qtyPackages||0)),We=(Number(ge.pricePerPackage)||0)*(ge.qtyPackages||0),at=Math.max(0,We-(Number(ge.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[ge.productName,ge.sku?`  ${ge.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Dd(ge.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[Te," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ge.qtyPackages)||ge.qtyPackages===0?"":ge.qtyPackages,onChange:bt=>Ge(ge.productId,bt.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de paquetes"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ge.discount)||ge.discount===0?"":ge.discount,onChange:bt=>_e(ge.productId,bt.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:Dd(at)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>G(ge.productId),title:"Quitar producto",children:""})})]},ge.productId)})]}),k.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:U})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Dd(pe)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Dd(ft)," ",st?`(${st.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:xe,children:xe?"Guardando...":"Registrar venta"})})]}),de&&i.jsx("p",{className:"mt-2 text-sm",children:de}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:V,onChange:ge=>j(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:O,onChange:ge=>W(v3(ge.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:D,onChange:ge=>Y(ge.target.value),children:[i.jsx("option",{value:"",children:""}),Zve.map(ge=>i.jsx("option",{value:ge,children:ge},ge))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:z,onChange:ge=>Oe(ge.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),!_&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:q,onChange:ge=>ie(ge.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.filter(ge=>(ge.status??"ACTIVO")==="ACTIVO").map(ge=>i.jsxs("option",{value:ge.id,children:[ge.name,"  ",ge.branchLabel]},ge.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:te===0?"":te,onChange:ge=>J(Math.max(0,Number(ge.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:se,onChange:ge=>ve(ge.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{fe(),I(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var Qe;const ge=_?P||e:q;if(!ge){re("Selecciona el vendedor para asociar este cliente.");return}if(re(""),!V.trim()){re("Ingresa el nombre del nuevo cliente.");return}const Be=v3(O);try{const Te=await Wr(At(je,"customers_candies"),{name:V.trim(),phone:Be,place:D||"",notes:se||"",status:z,creditLimit:Number(te||0),createdAt:Kt.now(),sellerId:ge,vendorId:ge,vendorName:((Qe=l.find(at=>at.id===ge))==null?void 0:Qe.name)||""}),We={id:Te.id,name:V.trim(),phone:Be,place:D||"",status:z,creditLimit:Number(te||0),balance:0,sellerId:ge};s(at=>[We,...at]),x(Te.id),fe(),I(!1),re(" Cliente creado")}catch(Te){console.error(Te),re(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),xe&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const w3=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],R1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function a1e(){const[t,e]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[r,n]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[s,a]=N.useState(rr(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,P]=N.useState(""),[R,_]=N.useState(null),[B,E]=N.useState(""),[M,k]=N.useState(""),[T,U]=N.useState(""),[Z,pe]=N.useState(0),[ae,he]=N.useState("PENDIENTE"),[de,re]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const D=Ut(At(je,"expenses_candies"),Rr("date","desc")),Y=await Nt(D),se=[];Y.forEach(ve=>{const z=ve.data();se.push({id:ve.id,date:z.date||rr(new Date,"yyyy-MM-dd"),category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||"PENDIENTE",notes:z.notes||"",createdAt:z.createdAt??Kt.now()})}),g(se)}catch(D){console.error(D),P(" Error al cargar gastos")}finally{b(!1)}})()},[]);const xe=N.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Ce=N.useMemo(()=>{const D=xe.reduce((ve,z)=>ve+(z.amount||0),0),Y=xe.filter(ve=>ve.status==="PAGADO").reduce((ve,z)=>ve+(z.amount||0),0),se=D-Y;return{total:D,pagado:Y,pendiente:se}},[xe]),S=()=>{a(rr(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},I=async D=>{if(D.preventDefault(),P(""),!o){P("Selecciona una categora.");return}if(!c.trim()){P("Ingresa una descripcin.");return}if(!u||u<=0){P("Ingresa un monto vlido.");return}try{const Y=await Wr(At(je,"expenses_candies"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Kt.now()});g(se=>[{id:Y.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Kt.now()},...se]),S(),P(" Gasto registrado")}catch(Y){console.error(Y),P(" Error al guardar gasto")}},V=D=>{_(D.id),E(D.date),k(D.category||""),U(D.description||""),pe(Number(D.amount||0)),he(D.status||"PENDIENTE"),re(D.notes||"")},j=()=>{_(null),E(""),k(""),U(""),pe(0),he("PENDIENTE"),re("")},O=async()=>{if(R){if(!M){P("Selecciona una categora.");return}if(!T.trim()){P("Ingresa una descripcin.");return}if(!Z||Z<=0){P("Ingresa un monto vlido.");return}try{await kr(kt(je,"expenses_candies",R),{date:B,category:M,description:T.trim(),amount:Number(Z.toFixed(2)),status:ae,notes:de||""}),g(D=>D.map(Y=>Y.id===R?{...Y,date:B,category:M,description:T.trim(),amount:Number(Z.toFixed(2)),status:ae,notes:de||""}:Y)),j(),P(" Gasto actualizado")}catch(D){console.error(D),P(" Error al actualizar gasto")}}},W=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await un(kt(je,"expenses_candies",D.id)),g(se=>se.filter(ve=>ve.id!==D.id)),P(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",R1(Ce.total)]}),i.jsxs("div",{children:["Pagado: ",R1(Ce.pagado)]}),i.jsxs("div",{children:["Pendiente: ",R1(Ce.pendiente)]})]})]}),i.jsxs("form",{onSubmit:I,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:D=>a(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),w3.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>A(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:D=>d(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):xe.slice().sort((D,Y)=>D.date.localeCompare(Y.date)).map(D=>{const Y=R===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:se=>E(se.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Y?i.jsxs("select",{className:"w-full border p-1 rounded",value:M,onChange:se=>k(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),w3.map(se=>i.jsx("option",{value:se,children:se},se))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>U(se.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Z)?"":Z,onChange:se=>pe(Math.max(0,Number(se.target.value||0)))}):R1(D.amount)}),i.jsx("td",{className:"p-2 border",children:Y?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>he(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Y?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:de,onChange:se=>re(se.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Y?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:O,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:j,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>V(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>W(D),children:"Borrar"})]})})})]},D.id)})})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F})]})}const Sl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function i1e(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?rr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function o1e(t,e){var a,o,l;const r=i1e(t);if(!r)return null;let n=0,s=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((c,A)=>c+(Number(A.packages??A.qty??A.quantity??0)||0),0),s=Number(t.total??t.itemsTotal??0)||0):(n=Number(t.packagesTotal??t.quantity??((a=t.item)==null?void 0:a.packages)??((o=t.item)==null?void 0:o.qty)??0)||0,s=Number(t.total??((l=t.item)==null?void 0:l.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:s,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}async function l1e(t){const e=Ut(At(je,"ar_movements"),qt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(je,"ar_movements",n.id))))}function c1e({role:t="",sellerCandyId:e=""}){const r=t==="vendedor_dulces",n=t==="admin",s=n?8:7,[a,o]=N.useState(!1),[l,c]=N.useState(!1),[A,u]=N.useState(null),[d,f]=N.useState([]),h=async q=>{o(!0),c(!0),u(q),f([]);try{const ie=await Wa(kt(je,"sales_candies",q)),fe=ie.exists()?ie.data():null;if(!fe){f([]);return}const Ve=(Array.isArray(fe==null?void 0:fe.items)?fe.items:fe!=null&&fe.item?[fe.item]:[]).map(ze=>({productName:String(ze.productName||""),qty:Number(ze.packages??ze.qty??ze.quantity??0),unitPrice:Number(ze.unitPricePackage??ze.unitPrice??0),discount:Number(ze.discount||0),total:Number(ze.total??ze.lineFinal??0)}));f(Ve)}catch(ie){console.error(ie)}finally{c(!1)}},[m,p]=N.useState(rr(new Date,"yyyy-MM-01")),[x,g]=N.useState(rr(new Date,"yyyy-MM-dd")),[y,b]=N.useState([]),[F,P]=N.useState([]),[R,_]=N.useState([]),[B,E]=N.useState(!0),[M,k]=N.useState(""),[T,U]=N.useState(""),[Z,pe]=N.useState(""),[ae,he]=N.useState(null),de=15,[re,xe]=N.useState(1),Ce=N.useMemo(()=>{const q={};return y.forEach(ie=>q[ie.id]=ie.name),q},[y]),S=N.useMemo(()=>{const q={};return R.forEach(ie=>{q[ie.id]=ie}),q},[R]),I=q=>{const ie=Number(q.vendorCommissionAmount||0);if(ie>0)return ie;if(!q.vendorId)return 0;const fe=S[q.vendorId];if(!fe||!fe.commissionPercent)return 0;const Ie=(Number(q.total)||0)*(Number(fe.commissionPercent)||0)/100;return Number(Ie.toFixed(2))};N.useEffect(()=>{(async()=>{E(!0),k("");try{const q=await Nt(At(je,"customers_candies")),ie=[];q.forEach(Ye=>ie.push({id:Ye.id,name:Ye.data().name||""})),b(ie);const fe=await Nt(At(je,"sellers_candies")),Ie=[];fe.forEach(Ye=>{const ct=Ye.data();Ie.push({id:Ye.id,name:ct.name||"",commissionPercent:Number(ct.commissionPercent||0)})}),_(Ie);const Ve=await Nt(Ut(At(je,"sales_candies"),Rr("createdAt","desc"))),ze=[];Ve.forEach(Ye=>{const ct=o1e(Ye.data(),Ye.id);ct&&ct.date>=m&&ct.date<=x&&ze.push(ct)}),P(ze.sort((Ye,ct)=>ct.date.localeCompare(Ye.date))),xe(1)}catch(q){console.error(q),k(" Error cargando transacciones.")}finally{E(!1)}})()},[m,x]);const V=N.useMemo(()=>F.filter(q=>!(r&&(!e||!q.vendorId||q.vendorId!==e)||T&&q.customerId!==T||Z&&q.type!==Z)),[F,T,Z,r,e]),j=N.useMemo(()=>{let q=0,ie=0,fe=0,Ie=0;for(const Ve of V)Ve.type==="CONTADO"?(q+=Ve.quantity,fe+=Ve.total):(ie+=Ve.quantity,Ie+=Ve.total);return{packsCash:q,packsCredito:ie,montoCash:fe,montoCredito:Ie}},[V]),O=Math.max(1,Math.ceil(V.length/de)),W=N.useMemo(()=>{const q=(re-1)*de;return V.slice(q,q+de)},[V,re]),D=N.useMemo(()=>A&&F.find(q=>q.id===A)||null,[A,F]),Y=async q=>{if(n&&(he(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{E(!0),await cx(q.id),await l1e(q.id),P(ie=>ie.filter(fe=>fe.id!==q.id)),k(" Venta eliminada")}catch(ie){console.error(ie),k(" No se pudo eliminar la venta.")}finally{E(!1)}},se=()=>{const q=`Ventas del dia  ${m} a ${x}`,ie=ze=>(ze||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),fe=V.map(ze=>{const Ye=ze.customerName||(ze.customerId?Ce[ze.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${ze.date}</td>
          <td>${ie(Ye)}</td>
          <td>${ze.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${ze.quantity}</td>
          <td style="text-align:right">${Sl(ze.total)}</td>
        </tr>`}).join(""),Ie=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${ie(q)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${ie(q)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${j.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${j.packsCredito}</div>
        <div><b>Monto Cash:</b> ${Sl(j.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Sl(j.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${fe||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Ve=window.open("","_blank");Ve&&(Ve.document.open(),Ve.document.write(Ie),Ve.document.close())},ve=()=>xe(1),z=()=>xe(q=>Math.max(1,q-1)),Oe=()=>xe(q=>Math.min(O,q+1)),te=()=>xe(O),J=()=>{const q=[];if(O<=7)for(let fe=1;fe<=O;fe++)q.push(fe);else{const fe=Math.max(1,re-2),Ie=Math.min(O,re+2);q.push(1),fe>2&&q.push(-1);for(let Ve=fe;Ve<=Ie;Ve++)Ve!==1&&Ve!==O&&q.push(Ve);Ie<O-1&&q.push(-2),q.push(O)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ve,disabled:re===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:z,disabled:re===1,children:" Anterior"}),q.map((fe,Ie)=>typeof fe=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${fe===re?"bg-blue-600 text-white":""}`,onClick:()=>xe(fe),children:fe},Ie):i.jsx("span",{className:"px-2",children:""},Ie)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Oe,disabled:re===O,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:te,disabled:re===O,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",re," de ",O,"  ",V.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:q=>{p(q.target.value),xe(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:q=>{g(q.target.value),xe(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:T,onChange:q=>{U(q.target.value),xe(1)},children:[i.jsx("option",{value:"",children:"Todos"}),y.map(q=>i.jsx("option",{value:q.id,children:q.name},q.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:Z,onChange:q=>{pe(q.target.value),xe(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:se,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:j.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:j.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Sl(j.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Sl(j.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),n&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Cargando"})}):W.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Sin transacciones en el rango."})}):W.map(q=>{const ie=q.customerName||(q.customerId?Ce[q.customerId]:"")||"Nombre cliente",fe=I(q);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:q.date}),i.jsx("td",{className:"p-2 border",children:ie}),i.jsx("td",{className:"p-2 border",children:q.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>h(q.id),children:q.quantity})}),i.jsx("td",{className:"p-2 border",children:Sl(q.total)}),i.jsx("td",{className:"p-2 border",children:fe>0?Sl(fe):""}),i.jsx("td",{className:"p-2 border",children:q.vendorName||""}),n&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>he(Ie=>Ie===q.id?null:q.id),title:"Acciones",children:""}),ae===q.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Y(q),children:"Eliminar"})})]})]},q.id)})})]}),J()]}),M&&i.jsx("p",{className:"mt-2 text-sm",children:M}),a&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",A?` #${A}`:""]}),D&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:I(D)>0?Sl(I(D)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>o(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):d.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):d.map((q,ie)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:q.productName}),i.jsx("td",{className:"p-2 border text-right",children:q.qty}),i.jsx("td",{className:"p-2 border text-right",children:Sl(q.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Sl(q.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Sl(q.total)})]},ie))})]})})]})})]})}const Zr=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function _p(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?rr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function A1e(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,a=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/s:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(a||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}});if(t!=null&&t.item){const n=t.item,s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,a=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/s:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(a||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0)}]:[]}function u1e(t,e){const r=_p(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,s=t.vendorName||t.sellerName||void 0,a=A1e(t);let o=Number(t.total??t.itemsTotal??0)||a.reduce((l,c)=>{const A=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),u=Math.max(0,Number(c.discount||0)),d=Math.max(0,A-u);return l+d},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:a,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:s}}function d1e(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,A)=>c.date.localeCompare(A.date));const a=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of a)for(const c of l.items||[]){const A=s[c.productId];if(!A)continue;let u=Number(c.qty||0);if(!(u<=0))for(const d of A.lots){if(u<=0)break;if(d.qtyLeft<=0)continue;const f=Math.min(d.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=f*d.cost),d.qtyLeft-=f,u-=f}}return o}async function h1e(t){const e=Ut(At(je,"ar_movements"),qt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(je,"ar_movements",n.id))))}function f1e(){const{refreshKey:t,refresh:e}=Jl(),[r,n]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[s,a]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,A]=N.useState([]),[u,d]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,P]=N.useState(""),[R,_]=N.useState([]),[B,E]=N.useState({}),[M,k]=N.useState({}),[T,U]=N.useState(!1),[Z,pe]=N.useState(null),[ae,he]=N.useState([]),[de,re]=N.useState(!1),[xe,Ce]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[S,I]=N.useState(!1),[V,j]=N.useState(""),[O,W]=N.useState([]),[D,Y]=N.useState(!1),[se,ve]=N.useState(!1),[z,Oe]=N.useState(null);N.useEffect(()=>{(async()=>{try{const De=await Nt(At(je,"sellers_candies")),Fe=[];De.forEach(Ge=>{const _e=Ge.data();Fe.push({id:Ge.id,name:_e.name||"",commissionPercent:Number(_e.commissionPercent||0)})}),_(Fe)}catch(De){console.error("Error cargando sellers_candies",De)}})()},[]);const te=N.useMemo(()=>{const De={};return R.forEach(Fe=>{De[Fe.id]=Fe}),De},[R]);N.useEffect(()=>{(async()=>{b(!0),P("");try{const De=await Nt(At(je,"sales_candies")),Fe=[],Ge=[];De.forEach(ot=>{const wt=ot.data(),Lt=u1e(wt,ot.id);Lt&&(Lt.date<=s&&Fe.push(Lt),Lt.date>=r&&Lt.date<=s&&Ge.push(Lt))}),A(Fe),l(Ge);const _e=await Nt(At(je,"inventory_candies")),G=[];_e.forEach(ot=>{const wt=ot.data(),Lt=_p(wt);if(!Lt||Lt>s)return;const Ar=Math.max(1,Math.floor(Number(wt.unitsPerPackage||1))),ir=Number(wt.totalUnits??wt.quantity??0),xr=Number(wt.packages??0),er=Number(wt.remaining??0),et=Number(wt.remainingPackages??0),gt=xr>0?xr:ir>0?Math.floor(ir/Ar):0,Pt=et>0?et:er>0?Math.floor(er/Ar):0;G.push({id:ot.id,productId:wt.productId,productName:wt.productName||"",date:Lt,quantity:Number(gt||0),remaining:Number(Pt||0),purchasePrice:Number(wt.providerPrice||wt.purchasePrice||0),unitsPerPackage:Ar})}),d(G);const Ne=await Nt(At(je,"expenses_candies")),Ue=[];Ne.forEach(ot=>{const wt=ot.data(),Lt=_p(wt);Lt&&Lt>=r&&Lt<=s&&Ue.push({id:ot.id,date:Lt,category:wt.category||"",description:wt.description||"",amount:Number(wt.amount||0),status:wt.status||""})}),h(Ue);const $e=await Nt(At(je,"ar_movements")),ge=[],Be={};$e.forEach(ot=>{const wt=ot.data(),Lt=_p(wt);if(!Lt)return;const Ar=wt.customerId,ir=Number(wt.amount||0);Ar&&(Be[Ar]=(Be[Ar]||0)+ir),wt.type==="ABONO"&&Lt>=r&&Lt<=s&&ge.push({id:ot.id,customerId:Ar,type:"ABONO",amount:ir,date:Lt})}),p(ge);const Qe=await Nt(At(je,"customers_candies")),Te=[];Qe.forEach(ot=>{const wt=ot.data();Te.push({id:ot.id,name:wt.name||"",balance:Be[ot.id]||0})}),g(Te);const We=await Nt(At(je,"inventory_candies_sellers")),at={},bt={};We.forEach(ot=>{const wt=ot.data(),Lt=_p(wt);if(!Lt||Lt<r||Lt>s)return;const Ar=wt.sellerId||wt.vendorId||"NO_VENDOR",ir=wt.productName||"",xr=wt.sku||"",er=Math.max(1,Math.floor(Number(wt.unitsPerPackage||1))),et=Number(wt.totalUnits??0),gt=Number(wt.packages??0),Pt=Number(wt.remainingUnits??wt.remaining??0),Ft=Number(wt.remainingPackages??0),Tt=gt>0?gt:et>0?Math.floor(et/er):0,Xt=Ft>0?Ft:Pt>0?Math.floor(Pt/er):0,Vt=Number(wt.totalVendor??0),oe=Number(wt.gainVendor??0),ne=Tt,ue=ne>0?Vt/ne:0,K=ne>0?oe/ne:0;if(at[Ar]||(at[Ar]={associated:[],remaining:[]}),Tt>0){const le=Tt,me=le*ue,Re=me,Ee=le*K;at[Ar].associated.push({saleId:ot.id,date:Lt,productName:ir,sku:xr,qty:le,unitPrice:ue,lineTotal:me,discount:0,lineFinal:Re,vendorCommissionAmount:Ee,type:"ASSOCIATED"}),bt[Ar]=(bt[Ar]||0)+le}if(Xt>0){const le=Xt,me=le*ue,Re=me,Ee=le*K;at[Ar].remaining.push({saleId:ot.id,date:Lt,productName:ir,sku:xr,qty:le,unitPrice:ue,lineTotal:me,discount:0,lineFinal:Re,vendorCommissionAmount:Ee,type:"REMAINING"})}}),E(at),k(bt)}catch(De){console.error(De),P(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,s,t]);const J=N.useCallback(De=>{if(De.vendorId&&te[De.vendorId])return te[De.vendorId];const Fe=(De.vendorName||"").trim().toLowerCase();if(Fe)return R.find(Ge=>(Ge.name||"").trim().toLowerCase()===Fe)},[te,R]),q=N.useCallback((De,Fe)=>{const Ge=Number(Fe.vendorCommissionAmount||0);if(Ge)return Ge;const _e=J(De);if(!_e||!_e.commissionPercent)return 0;const G=Number(Fe.qty||0),Ne=Number(Fe.unitPrice||0),Ue=G*Ne,$e=Math.max(0,Number(Fe.discount||0)),ge=Math.max(0,Ue-$e);if(!ge)return 0;const Be=Number(_e.commissionPercent)||0;return ge*Be/100},[J]),ie=N.useMemo(()=>{try{return d1e(u,c,r,s)}catch(De){return console.error(De),0}},[u,c,r,s]),fe=N.useMemo(()=>{const De=o.reduce((Te,We)=>Te+(We.total||0),0),Fe=f.reduce((Te,We)=>Te+(We.amount||0),0),Ge=De-ie,_e=Ge-Fe,G=m.reduce((Te,We)=>Te+Math.abs(We.amount||0),0),Ne=x.filter(Te=>(Te.balance||0)>0),Ue=Ne.reduce((Te,We)=>Te+(We.balance||0),0);let $e=0,ge=0,Be=0,Qe=0;for(const Te of o){const We=(Te.items||[]).reduce((bt,ot)=>bt+(Number(ot.qty)||0),0),at=(Te.items||[]).reduce((bt,ot)=>bt+q(Te,ot),0);Te.type==="CONTADO"?($e+=We,Be+=at):(ge+=We,Qe+=at)}return{ventasTotales:De,costoMercaderia:ie,gastosPeriodo:Fe,gananciaAntes:Ge,gananciaDespues:_e,abonosRecibidos:G,saldosPendientes:Ue,clientesConSaldo:Ne.length,paquetesCash:$e,paquetesCredito:ge,comisionCash:Be,comisionCredito:Qe}},[o,f,m,x,ie,q]),Ie=N.useMemo(()=>{const De={},Fe={};for(const Ge of o)if(!(Ge.type!=="CREDITO"||!Ge.customerId))for(const _e of Ge.items||[]){const G=Number(_e.qty||0),Ne=Number(_e.unitPrice||0),Ue=G*Ne,$e=Math.max(0,Number(_e.discount||0)),ge=Math.max(0,Ue-$e);De[Ge.customerId]=(De[Ge.customerId]||0)+G,Fe[Ge.customerId]=(Fe[Ge.customerId]||0)+ge}return x.filter(Ge=>(Ge.balance||0)>0).map(Ge=>({customerId:Ge.id,name:Ge.name,paquetesAsociados:De[Ge.id]||0,saldoTotal:Fe[Ge.id]||0,saldoPendiente:Ge.balance||0})).sort((Ge,_e)=>_e.saldoPendiente-Ge.saldoPendiente)},[x,o]),Ve=N.useMemo(()=>{const De={};return x.forEach(Fe=>De[Fe.id]=Fe.name),De},[x]),ze=N.useMemo(()=>[...o].sort((De,Fe)=>Fe.date.localeCompare(De.date)).map(De=>{var G;const Fe=(De.items||[]).reduce((Ne,Ue)=>Ne+(Number(Ue.qty)||0),0);let Ge="Cash";De.type==="CREDITO"&&De.customerId?Ge=Ve[De.customerId]||"":De.type==="CONTADO"&&(Ge=((G=De.customerName)==null?void 0:G.trim())||"Cash");const _e=Fe>0?De.total/Fe:0;return{id:De.id,date:De.date,type:De.type==="CREDITO"?"Crdito":"Cash",customer:Ge,paquetes:Fe,total:Number(De.total||0),avgPrice:_e}}),[o,Ve]),Ye=N.useMemo(()=>{var Fe,Ge;const De=new Map;for(const _e of o){const G=_e.vendorId||"NO_VENDOR",Ne=_e.vendorName||((Fe=te[G])==null?void 0:Fe.name)||"Sin vendedor";De.has(G)||De.set(G,{vendorId:G,vendorName:Ne,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const Ue=De.get(G);for(const $e of _e.items||[]){const ge=Number($e.qty||0),Be=Number($e.unitPrice||0),Qe=ge*Be,Te=Math.max(0,Number($e.discount||0)),We=Math.max(0,Qe-Te),at=q(_e,$e);_e.type==="CONTADO"?(Ue.paquetesVendidos+=ge,Ue.totalVendido+=We,Ue.comisionCash+=at):(Ue.paquetesFiados+=ge,Ue.totalFiado+=We,Ue.comisionCredito+=at)}}for(const[_e,G]of Object.entries(M)){const Ne=De.get(_e),Ue=(Ne==null?void 0:Ne.vendorName)||((Ge=te[_e])==null?void 0:Ge.name)||"Sin vendedor",$e=Ne||{vendorId:_e,vendorName:Ue,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};$e.paquetesAsociados=G,$e.paquetesRestantes=Math.max(G-$e.paquetesVendidos-$e.paquetesFiados,0),De.set(_e,$e)}return Array.from(De.values()).sort((_e,G)=>G.totalVendido+G.totalFiado-(_e.totalVendido+_e.totalFiado))},[o,M,te,q]),ct=async De=>{U(!0),pe({id:De.customerId,name:De.name}),he([]),re(!0),Ce({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const Fe=[];let Ge=0,_e=0,G=0;for(const ge of o)if(!(ge.type!=="CREDITO"||ge.customerId!==De.customerId))for(const Be of ge.items||[]){const Qe=Number(Be.qty||0),Te=Number(Be.unitPrice||0),We=Qe*Te,at=Math.max(0,Number(Be.discount||0)),bt=Math.max(0,We-at);Fe.push({saleId:ge.id,date:ge.date,productName:Be.productName,sku:Be.sku||"",qty:Qe,unitPrice:Te,lineTotal:We,discount:at,lineFinal:bt}),Ge+=We,_e+=at,G+=bt}let Ne=0;for(const ge of m)ge.customerId===De.customerId&&(Ne+=Math.abs(ge.amount||0));const Ue=x.find(ge=>ge.id===De.customerId),$e=(Ue==null?void 0:Ue.balance)||0;he(Fe),Ce({totalBruto:Ge,totalDescuento:_e,totalFiado:G,saldoActual:$e,abonadoPeriodo:Ne})}catch(Fe){console.error(Fe),P(" No se pudo cargar el detalle del cliente.")}finally{re(!1)}},st=(De,Fe,Ge)=>{I(!0);let _e="";Ge==="ASSOCIATED"?_e=`Paquetes asociados  ${Fe}`:Ge==="REMAINING"?_e=`Paquetes restantes  ${Fe}`:Ge==="CASH"?_e=`Paquetes vendidos (Cash)  ${Fe}`:_e=`Paquetes fiados (Crdito)  ${Fe}`,j(_e),W([]),Y(!0);try{if(Ge==="ASSOCIATED"||Ge==="REMAINING"){const Ne=B[De],Ue=Ge==="ASSOCIATED"?(Ne==null?void 0:Ne.associated)||[]:(Ne==null?void 0:Ne.remaining)||[];W([...Ue].sort(($e,ge)=>$e.date.localeCompare(ge.date))),Y(!1);return}const G=[];for(const Ne of o)if(((Ne.vendorId||"NO_VENDOR")===De||!Ne.vendorId&&De==="NO_VENDOR")&&!(Ge==="CASH"&&Ne.type!=="CONTADO")&&!(Ge==="CREDIT"&&Ne.type!=="CREDITO"))for(const $e of Ne.items||[]){const ge=Number($e.qty||0),Be=Number($e.unitPrice||0),Qe=ge*Be,Te=Math.max(0,Number($e.discount||0)),We=Math.max(0,Qe-Te),at=q(Ne,$e);G.push({saleId:Ne.id,date:Ne.date,productName:$e.productName,sku:$e.sku||"",qty:ge,unitPrice:Be,lineTotal:Qe,discount:Te,lineFinal:We,vendorCommissionAmount:at,type:Ge})}W(G.sort((Ne,Ue)=>Ne.date.localeCompare(Ue.date)))}catch(G){console.error(G),P(" No se pudo cargar el detalle del vendedor.")}finally{Y(!1)}},ft=De=>{const Fe=o.find(Ge=>Ge.id===De)||null;Oe(Fe),ve(!0)},nt=async De=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await cx(De),await h1e(De),l(Fe=>Fe.filter(Ge=>Ge.id!==De)),A(Fe=>Fe.filter(Ge=>Ge.id!==De)),ve(!1),Oe(null)}catch(Fe){console.error(Fe),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(Fc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:De=>n(De.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:De=>a(De.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(fe.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(fe.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Zr(fe.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(fe.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Zr(fe.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(fe.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(fe.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(fe.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(fe.comisionCredito)})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ie.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ie.map(De=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:De.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ct({customerId:De.customerId,name:De.name}),title:"Ver paquetes fiados del periodo",children:De.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:Zr(De.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:Zr(De.saldoPendiente)})]},De.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Ye.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Ye.map(De=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:De.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>st(De.vendorId,De.vendorName,"ASSOCIATED"),children:De.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>st(De.vendorId,De.vendorName,"REMAINING"),children:De.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>st(De.vendorId,De.vendorName,"CASH"),children:De.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(De.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(De.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>st(De.vendorId,De.vendorName,"CREDIT"),children:De.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(De.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(De.comisionCredito)})]},De.vendorId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):ze.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):ze.map(De=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:De.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:De.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:De.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ft(De.id),children:De.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(De.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(De.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>nt(De.id),children:"Eliminar"})})]},De.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((De,Fe)=>De.date.localeCompare(Fe.date)).map(De=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:De.date}),i.jsx("td",{className:"p-2 border",children:De.category||""}),i.jsx("td",{className:"p-2 border",children:De.description?i.jsx("span",{title:De.description,children:De.description.length>40?De.description.slice(0,40)+"":De.description}):""}),i.jsx("td",{className:"p-2 border",children:Zr(De.amount)}),i.jsx("td",{className:"p-2 border",children:De.status||""})]},De.id))})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(Z==null?void 0:Z.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>U(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:de?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ae.sort((De,Fe)=>De.date.localeCompare(Fe.date)).map((De,Fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:De.date}),i.jsx("td",{className:"p-2 border",children:De.productName}),i.jsx("td",{className:"p-2 border",children:De.sku||""}),i.jsx("td",{className:"p-2 border",children:De.qty}),i.jsx("td",{className:"p-2 border",children:Zr(De.unitPrice)}),i.jsx("td",{className:"p-2 border",children:Zr(De.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Zr(De.discount)}),i.jsx("td",{className:"p-2 border",children:Zr(De.lineFinal)})]},`${De.saleId}-${Fe}`))})]})})]})}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:V}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>I(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:D?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):O.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):O.map((De,Fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:De.date}),i.jsx("td",{className:"p-2 border",children:De.productName}),i.jsx("td",{className:"p-2 border",children:De.sku||""}),i.jsx("td",{className:"p-2 border",children:De.qty}),i.jsx("td",{className:"p-2 border",children:Zr(De.unitPrice)}),i.jsx("td",{className:"p-2 border",children:Zr(De.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Zr(De.discount)}),i.jsx("td",{className:"p-2 border",children:Zr(De.lineFinal)}),i.jsx("td",{className:"p-2 border",children:Zr(De.vendorCommissionAmount)})]},`${De.saleId}-${Fe}`))})]})})]})}),se&&z&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",z.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ve(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(z.items||[]).map((De,Fe)=>{const Ge=Number(De.qty||0),_e=Number(De.unitPrice||0),G=Ge*_e,Ne=q(z,De);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:De.productName}),i.jsx("td",{className:"p-2 border",children:De.sku||""}),i.jsx("td",{className:"p-2 border",children:Ge}),i.jsx("td",{className:"p-2 border",children:Zr(_e)}),i.jsx("td",{className:"p-2 border",children:Zr(G)}),i.jsx("td",{className:"p-2 border",children:Zr(Ne)})]},Fe)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),Zr(z.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>nt(z.id),children:"Eliminar venta"})]})]})})]})}const y3=["Rivas","Isla Ometepe","San Jorge"];function m1e(){const{refreshKey:t,refresh:e}=Jl(),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(!1),[u,d]=N.useState(""),[f,h]=N.useState("0"),[m,p]=N.useState("Rivas"),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,P]=N.useState("0"),[R,_]=N.useState("Rivas");N.useEffect(()=>{(async()=>{a(!0),l("");try{const Z=Ut(At(je,"sellers_candies"),Rr("name","asc")),pe=await Nt(Z),ae=[];pe.forEach(he=>{const de=he.data();ae.push({id:he.id,name:de.name||"",commissionPercent:Number(de.commissionPercent||0),branch:de.branch||"Rivas",createdAt:de.createdAt||Kt.now()})}),n(ae)}catch(Z){console.error(Z),l(" Error cargando vendedores.")}finally{a(!1)}})()},[t]);const B=()=>{d(""),h("0"),p("Rivas")},E=async Z=>{Z.preventDefault(),l("");const pe=u.trim();if(!pe){l("Ingresa el nombre y apellido del vendedor.");return}const ae=Number(f||0);if(ae<0){l("La comisin no puede ser negativa.");return}try{const he={name:pe,commissionPercent:ae,branch:m,createdAt:Kt.now()},de=await Wr(At(je,"sellers_candies"),he);n(re=>[{id:de.id,...he},...re]),l(" Vendedor creado correctamente."),B(),A(!1)}catch(he){console.error(he),l(" Error al crear el vendedor.")}},M=Z=>{g(Z.id),b(Z.name),P(Z.commissionPercent.toString()),_(Z.branch)},k=()=>{g(null),b(""),P("0"),_("Rivas")},T=async()=>{if(!x)return;l("");const Z=y.trim();if(!Z){l("El nombre y apellido no pueden estar vacos.");return}const pe=Number(F||0);if(pe<0){l("La comisin no puede ser negativa.");return}try{await kr(kt(je,"sellers_candies",x),{name:Z,commissionPercent:pe,branch:R}),n(ae=>ae.map(he=>he.id===x?{...he,name:Z,commissionPercent:pe,branch:R}:he)),l(" Vendedor actualizado."),k()}catch(ae){console.error(ae),l(" Error al actualizar el vendedor.")}},U=async Z=>{if(window.confirm(`Eliminar al vendedor "${Z.name}"? Esta accin no se puede deshacer.`))try{await un(kt(je,"sellers_candies",Z.id)),n(ae=>ae.filter(he=>he.id!==Z.id)),l(" Vendedor eliminado.")}catch(ae){console.error(ae),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:e,loading:s}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>A(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:u,onChange:Z=>d(Z.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comisin (% sobre venta total)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:f,onChange:Z=>h(Z.target.value),placeholder:"Ej: 10"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje se usa para calcular la comisin del vendedor sobre el total de la venta (no es el margen del producto)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:Z=>p(Z.target.value),children:y3.map(Z=>i.jsx("option",{value:Z,children:Z},Z))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{B(),A(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Comisin (%)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(Z=>{const pe=x===Z.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:pe?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:ae=>b(ae.target.value)}):Z.name}),i.jsx("td",{className:"p-2 border",children:pe?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:F,onChange:ae=>P(ae.target.value)}):`${Z.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:pe?i.jsx("select",{className:"border p-1 rounded text-xs",value:R,onChange:ae=>_(ae.target.value),children:y3.map(ae=>i.jsx("option",{value:ae,children:ae},ae))}):Z.branch}),i.jsx("td",{className:"p-2 border",children:pe?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:T,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:k,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>M(Z),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>U(Z),children:"Borrar"})]})})]},Z.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Va=t=>Math.max(0,Math.floor(Number(t||0)));function p1e(t){return Math.max(1,Va(t.unitsPerPackage||1))}async function g1e(t){const{orderId:e,productId:r}=t;let n=Va(t.packagesToReturn);if(!e||!r||n<=0)return;const s=Ut(At(je,"inventory_candies"),qt("orderId","==",e),qt("productId","==",r),Rr("createdAt","asc")),a=await Nt(s);if(a.empty)return;const o=a.docs.map(l=>l.ref);await ha(je,async l=>{const c=await Promise.all(o.map(A=>l.get(A)));for(let A=0;A<o.length&&n>0;A++){const u=c[A];if(!u.exists())continue;const d=u.data(),f=p1e(d),h=n*f,p=Va(d.remaining??0)+h,x=Math.floor(p/f);l.update(o[A],{remaining:p,remainingPackages:x,packages:x,updatedAt:Kt.now()}),n=0}})}async function x1e(t){const{orderId:e,productId:r}=t,n=Va(t.packagesToReturn);if(!e||!r||n<=0)return;const s=kt(je,"candy_main_orders",e);await ha(je,async a=>{const o=await a.get(s);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let A=!1;const u=c.map(d=>String((d==null?void 0:d.id)||"")!==String(r)?d:(A=!0,{...d,remainingPackages:Va(d.remainingPackages)+n}));A&&a.update(s,{items:u,updatedAt:Kt.now()})})}function v1e(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),s=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),a=Va((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,Va((r==null?void 0:r.unitsPerPackage)||1));!n||!s||a<=0||e.push({batchId:n,masterOrderId:s,units:a,unitsPerPackage:o})}return e}function b3(t,e){const r=Va(t),n=Math.max(1,Va(e));return Math.floor(r/n)}async function N3(t){if(!t)throw new Error("vendorInventoryId requerido");const e=kt(je,"inventory_candies_sellers",t),r=await Wa(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),s=String(n.productId||""),a=Va(n.packages||n.remainingPackages||0),o=v1e(n.masterAllocations||n.allocations||n.allocationsByBatch);if(!o.length){const c=String(n.orderId||"");if(!c)throw new Error("La orden del vendedor no tiene orderId");if(!s)throw new Error("La orden del vendedor no tiene productId");return a<=0?(await ha(je,async A=>{A.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await g1e({orderId:c,productId:s,packagesToReturn:a}),await x1e({orderId:c,productId:s,packagesToReturn:a}),await ha(je,async A=>{A.delete(e)}),{restoredPackages:a,mode:"legacy"})}let l=0;return await ha(je,async c=>{const A={};for(const x of o){const g=Math.max(1,Va(x.unitsPerPackage||1)),y=Va(x.units),b=b3(y,g);b>0&&(A[x.masterOrderId]=(A[x.masterOrderId]||0)+b)}const u=o.map(x=>kt(je,"inventory_candies",x.batchId)),f=Object.keys(A).map(x=>kt(je,"candy_main_orders",x)),[h,m]=await Promise.all([Promise.all(u.map(x=>c.get(x))),Promise.all(f.map(x=>c.get(x)))]);let p=0;for(let x=0;x<o.length;x++){const g=o[x],y=h[x];if(!y.exists())continue;const b=y.data(),F=Math.max(1,Va(g.unitsPerPackage||b.unitsPerPackage||1)),P=Va(g.units),_=Va(b.remaining??0)+P,B=Math.floor(_/F);c.update(u[x],{remaining:_,remainingPackages:B,packages:B,updatedAt:Kt.now()});const E=b3(P,F);E>0&&(p+=E)}for(let x=0;x<f.length;x++){const g=m[x];if(!g.exists())continue;const y=f[x].id,b=Va(A[y]||0);if(b<=0)continue;const F=g.data(),P=Array.isArray(F.items)?F.items:[];let R=!1;const _=P.map(B=>String((B==null?void 0:B.id)||"")!==String(s)?B:(R=!0,{...B,remainingPackages:Va(B.remainingPackages)+b}));R&&c.update(f[x],{items:_,updatedAt:Kt.now()})}c.delete(e),l=p}),{restoredPackages:l,mode:"blind"}}const Nn=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function w1e(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const C3=t=>Math.max(0,Math.floor(Number(t||0)));function y1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const{refreshKey:n,refresh:s}=Jl(),a=!t||t==="admin",o=t==="vendedor_dulces",l=(r||"").trim().toLowerCase(),c=!a&&o,[A,u]=N.useState({}),[d,f]=N.useState([]),[h,m]=N.useState([]),[p,x]=N.useState({}),[g,y]=N.useState([]),[b,F]=N.useState(!0),[P,R]=N.useState(""),[_,B]=N.useState(!1),[E,M]=N.useState(null),[k,T]=N.useState([]),[U,Z]=N.useState(""),[pe,ae]=N.useState(""),[he,de]=N.useState(""),[re,xe]=N.useState("0"),[Ce,S]=N.useState([]),[I,V]=N.useState(!1),j=N.useMemo(()=>d.find(K=>K.id===U)||null,[U,d]),O=j==null?void 0:j.branch,W=N.useMemo(()=>h.find(K=>K.id===he)||null,[he,h]),D=N.useMemo(()=>new Set(Ce.map(K=>K.productId)),[Ce]),Y=N.useMemo(()=>h.filter(K=>(p[K.id]??0)>0||D.has(K.id)).sort((K,le)=>K.name.localeCompare(le.name)),[h,p,D]),se=N.useMemo(()=>{const K={};return d.forEach(le=>K[le.id]=le),K},[d]),ve=N.useMemo(()=>!o||!l?null:d.find(K=>(K.email||"").trim().toLowerCase()===l)||null,[o,l,d]),z=N.useMemo(()=>{const K=d.find(le=>(le.email||"").trim().toLowerCase()===l)||null;return(K==null?void 0:K.name)||(r||"").trim()||""},[d,l,r]),Oe=async()=>{try{const K=At(je,"inventory_transfers_candies");if(!o){const Le=await Nt(K),Je={};Le.forEach(tt=>{const Xe=tt.data(),Ze=Number(Xe.packagesMoved||0),ut=String(Xe.fromOrderKey||""),Ht=String(Xe.toOrderKey||"");ut&&(Je[ut]=Je[ut]||{out:0,in:0},Je[ut].out+=Ze),Ht&&(Je[Ht]=Je[Ht]||{out:0,in:0},Je[Ht].in+=Ze)}),u(Je);return}const le=Ut(K,qt("fromSellerId","==",e)),me=Ut(K,qt("toSellerId","==",e)),[Re,Ee]=await Promise.all([Nt(le),Nt(me)]),ye={},Me=(Le,Je)=>{Le.forEach(tt=>{const Xe=tt.data(),Ze=Number(Xe.packagesMoved||0),ut=String(Je==="out"?Xe.fromOrderKey||"":Xe.toOrderKey||"");ut&&(ye[ut]=ye[ut]||{out:0,in:0},ye[ut][Je]+=Ze)})};Me(Re.docs,"out"),Me(Ee.docs,"in"),u(ye)}catch(K){console.error(K),u({})}};N.useEffect(()=>{(async()=>{F(!0),R("");try{const K=await Nt(Ut(At(je,"sellers_candies"),Rr("name","asc"))),le=[];K.forEach(tt=>{const Xe=tt.data(),Ze=Xe.branch||Xe.branchLabel||Xe.route||Xe.sucursal||Xe.location||"";le.push({id:tt.id,name:Xe.name||"",email:Xe.email||"",commissionPercent:Number(Xe.commissionPercent||0),branch:w1e(Ze),branchLabel:Ze})}),f(le);const me=await Nt(At(je,"inventory_candies")),Re={},Ee={};me.forEach(tt=>{var ga;const Xe=tt.data(),Ze=String(Xe.productId||"");if(!Ze)return;const ut=Number(Xe.remainingPackages);if(Number.isFinite(ut))Re[Ze]=(Re[Ze]||0)+Math.max(0,Math.floor(ut));else{const no=Number(Xe.remaining??Xe.quantity??0),Dn=Number(Xe.unitsPerPackage||0);let Oi=0;Dn>0?Oi=no/Dn:Oi=Number(Xe.packages||0),Re[Ze]=(Re[Ze]||0)+Math.max(0,Oi)}const Ht=String(Xe.date||""),wr=Number(((ga=Xe.createdAt)==null?void 0:ga.seconds)??0),ur={unitPriceRivas:Number(Xe.unitPriceRivas||0),unitPriceSanJorge:Number(Xe.unitPriceSanJorge||0),unitPriceIsla:Number(Xe.unitPriceIsla||0),date:Ht,createdAtSec:wr};if(!(ur.unitPriceRivas>0||ur.unitPriceSanJorge>0||ur.unitPriceIsla>0))return;const $s=Ee[Ze];if(!$s){Ee[Ze]=ur;return}const vi=`${$s.date}#${String($s.createdAtSec).padStart(10,"0")}`;`${ur.date}#${String(ur.createdAtSec).padStart(10,"0")}`>vi&&(Ee[Ze]=ur)}),Object.keys(Re).forEach(tt=>Re[tt]=Math.floor(Re[tt])),x(Re);const ye=await Nt(Ut(At(je,"products_candies"),Rr("name","asc"))),Me=[];ye.forEach(tt=>{const Xe=tt.data(),Ze=tt.id,ut=Ee[Ze];Me.push({id:Ze,name:Xe.name||"",category:Xe.category||"",providerPrice:Number(Xe.providerPrice||0),packages:Number(Xe.packages||0),unitsPerPackage:Number(Xe.unitsPerPackage||0),unitPriceRivas:Number((ut==null?void 0:ut.unitPriceRivas)||0),unitPriceSanJorge:Number((ut==null?void 0:ut.unitPriceSanJorge)||0),unitPriceIsla:Number((ut==null?void 0:ut.unitPriceIsla)||0)})}),m(Me);const Le=await Nt(o?Ut(At(je,"inventory_candies_sellers"),qt("sellerId","==",e),Rr("createdAt","desc")):Ut(At(je,"inventory_candies_sellers"),Rr("createdAt","desc"))),Je=[];Le.forEach(tt=>{const Xe=tt.data();Je.push({id:tt.id,sellerId:Xe.sellerId,sellerName:Xe.sellerName||"",productId:Xe.productId,productName:Xe.productName||"",category:Xe.category||"",orderId:Xe.orderId||null,packages:Number(Xe.packages||0),unitsPerPackage:Number(Xe.unitsPerPackage||0),totalUnits:Number(Xe.totalUnits||0),remainingPackages:Number(Xe.remainingPackages||0),remainingUnits:Number(Xe.remainingUnits||0),providerPrice:Number(Xe.providerPrice||0),totalRivas:Number(Xe.totalRivas||0),totalSanJorge:Number(Xe.totalSanJorge||0),totalIsla:Number(Xe.totalIsla||0),unitPriceRivas:Number(Xe.unitPriceRivas||0),unitPriceSanJorge:Number(Xe.unitPriceSanJorge||0),unitPriceIsla:Number(Xe.unitPriceIsla||0),markupPercent:Number(Xe.markupPercent||0),subtotal:Number(Xe.subtotal||0),totalVendor:Number(Xe.totalVendor||0),gainVendor:Number(Xe.gainVendor||0),unitPriceVendor:Number(Xe.unitPriceVendor||0),date:Xe.date||"",createdAt:Xe.createdAt||Kt.now()})}),y(Je),await Oe()}catch(K){console.error(K),R(" Error cargando datos de vendedores / pedidos.")}finally{F(!1)}})()},[n,t,e]);const te=N.useMemo(()=>o&&ve?g.filter(K=>K.sellerId===ve.id):g,[g,o,ve,U]),J=N.useMemo(()=>{var le;const K={};for(const me of te){const Re=me.orderId||me.id,Ee=K[Re],ye=me.date||((le=me.createdAt)!=null&&le.toDate?me.createdAt.toDate().toISOString().slice(0,10):"");if(Ee)Ee.totalPackages+=me.packages,Ee.totalRemainingPackages+=me.remainingPackages,Ee.subtotal+=me.subtotal,Ee.totalVendor+=me.totalVendor,ye>Ee.date&&(Ee.date=ye);else{const Me=A[Re]||{out:0,in:0};K[Re]={orderKey:Re,sellerId:me.sellerId,sellerName:me.sellerName,date:ye,totalPackages:me.packages,totalRemainingPackages:me.remainingPackages,subtotal:me.subtotal,totalVendor:me.totalVendor,transferredOut:Me.out,transferredIn:Me.in}}}return Object.values(K).map(me=>{const Re=A[me.orderKey]||{out:0,in:0};return{...me,transferredOut:Re.out||0,transferredIn:Re.in||0}}).sort((me,Re)=>Re.date.localeCompare(me.date))},[te,A]),q=N.useMemo(()=>{const K={};return J.forEach(le=>K[le.orderKey]=le),K},[J]),ie=N.useMemo(()=>{const K=Ce.reduce((Me,Le)=>Me+Le.packages,0),le=Ce.reduce((Me,Le)=>Me+Le.subtotal,0),me=Ce.reduce((Me,Le)=>Me+Le.totalVendor,0),Re=Ce.reduce((Me,Le)=>Me+Le.gainVendor,0),Ee=Number((j==null?void 0:j.commissionPercent)||0),ye=me*Ee/100;return{totalPackages:K,subtotal:le,totalVendor:me,gainVendor:Re,commissionPercent:Ee,commissionAmount:ye}},[Ce,j]),fe=()=>{M(null),T([]),Z(""),ae(""),de(""),xe("0"),S([])};function Ie(K){const le=Number(K.providerPrice||0),me=Number(K.packages||0),Re=Number(K.unitPriceRivas||0),Ee=Number(K.unitPriceSanJorge||0),ye=Number(K.unitPriceIsla||0),Me=le*me,Le=Re*me,Je=Ee*me,tt=ye*me;let Xe=Re,Ze=Le;switch(K.sellerBranch){case"SAN_JORGE":Xe=Ee,Ze=Je;break;case"ISLA":Xe=ye,Ze=tt;break;case"RIVAS":default:Xe=Re,Ze=Le;break}const ut=Ze-Me;return{subtotal:Me,totalVendor:Ze,gainVendor:ut,pricePerPackage:Xe,totalRivas:Le,totalSanJorge:Je,totalIsla:tt,unitPriceRivas:Re,unitPriceSanJorge:Ee,unitPriceIsla:ye}}function Ve(K,le){const{subtotal:me,totalVendor:Re,gainVendor:Ee,pricePerPackage:ye,totalRivas:Me,totalSanJorge:Le,totalIsla:Je,unitPriceRivas:tt,unitPriceSanJorge:Xe,unitPriceIsla:Ze}=Ie({providerPrice:K.providerPrice,unitPriceRivas:K.unitPriceRivas,unitPriceSanJorge:K.unitPriceSanJorge,unitPriceIsla:K.unitPriceIsla,packages:le,sellerBranch:O});return{id:`${K.id}-${Date.now()}-${Math.random()}`,productId:K.id,productName:K.name,category:K.category,providerPrice:K.providerPrice,unitsPerPackage:K.unitsPerPackage,packages:le,subtotal:me,totalVendor:Re,gainVendor:Ee,pricePerPackage:ye,totalRivas:Me,totalSanJorge:Le,totalIsla:Je,unitPriceRivas:tt,unitPriceSanJorge:Xe,unitPriceIsla:Ze,remainingPackages:le}}const ze=()=>{if(c)return;if(!W){R("Selecciona un producto antes de agregarlo.");return}if(D.has(W.id)){R("Ese producto ya est agregado en este pedido.");return}const K=Number(re||0);if(K<=0){R("La cantidad de paquetes debe ser mayor a 0.");return}const le=p[W.id]??0;if(!E&&K>le){R(`No hay suficientes paquetes en inventario general. Disponibles: ${le}`);return}const me=Ve(W,K);S(Re=>[...Re,me]),de(""),xe("0")},Ye=K=>{c||S(le=>le.filter(me=>me.id!==K))},ct=(K,le)=>{if(c)return;const me=Number(le||0);S(Re=>Re.map(Ee=>{if(Ee.id!==K)return Ee;const{subtotal:ye,totalVendor:Me,gainVendor:Le,pricePerPackage:Je,totalRivas:tt,totalSanJorge:Xe,totalIsla:Ze}=Ie({providerPrice:Ee.providerPrice,unitPriceRivas:Ee.unitPriceRivas,unitPriceSanJorge:Ee.unitPriceSanJorge,unitPriceIsla:Ee.unitPriceIsla,packages:me,sellerBranch:O});return{...Ee,packages:me,subtotal:ye,totalVendor:Me,gainVendor:Le,pricePerPackage:Je,totalRivas:tt,totalSanJorge:Xe,totalIsla:Ze}}))};async function st(K,le,me){const Re=await $ve({productId:K,quantityPacks:le,saleDate:me}),Ee=Array.isArray(Re==null?void 0:Re.allocations)?Re.allocations:[];if(!Ee.length)return[];const ye=Ee.map(Je=>String(Je.batchId||"")).filter(Boolean),Me=await Promise.all(ye.map(Je=>Wa(kt(je,"inventory_candies",Je)))),Le=[];for(let Je=0;Je<Ee.length;Je++){const tt=Ee[Je],Xe=String(tt.batchId||""),Ze=C3(tt.qty||tt.units||tt.quantity||0),ut=Me[Je];if(!Xe||Ze<=0||!ut.exists())continue;const Ht=ut.data(),wr=String(Ht.orderId||""),ur=Math.max(1,C3(Ht.unitsPerPackage||1));wr&&Le.push({batchId:Xe,masterOrderId:wr,units:Ze,unitsPerPackage:ur})}return Le}const ft=async K=>{if(K.preventDefault(),I)return;if(!a){R("No tienes permiso para guardar pedidos.");return}if(R(""),!j){R("Selecciona un vendedor.");return}if(!Ce.length){R("Agrega al menos un producto al pedido.");return}const le=new Date().toISOString().slice(0,10),me=pe||le;try{if(F(!0),V(!0),E){const Re={};k.forEach(Me=>{Re[Me.productId]=Me});const Ee={};Ce.forEach(Me=>{Ee[Me.productId]=Me});for(const Me of Object.keys(Ee)){const Le=Ee[Me],Je=Re[Me],tt=Number(Le.packages||0),Xe=Je?Number(Je.packages||0):0,Ze=tt-Xe;if(Ze>0){const ut=await st(Me,Ze,me);if(Je&&ut.length){const Ht=kt(je,"inventory_candies_sellers",Je.id),wr=await Wa(Ht),ur=wr.exists()?wr.data():{},$s=[...Array.isArray(ur.masterAllocations)?ur.masterAllocations:[],...ut];await kr(Ht,{masterAllocations:$s,updatedAt:Kt.now()})}}else Ze<0}let ye=[...g];for(const Me of Object.keys(Ee)){const Le=Ee[Me],Je=Re[Me],tt=h.find(ut=>ut.id===Me),Xe=(tt==null?void 0:tt.unitsPerPackage)||Le.unitsPerPackage||0,Ze=Le.packages>0&&Xe>0?Le.packages*Xe:0;if(Je)await kr(kt(je,"inventory_candies_sellers",Je.id),{sellerId:j.id,sellerName:j.name,productId:Me,productName:Le.productName,category:Le.category,packages:Le.packages,unitsPerPackage:Xe,totalUnits:Ze,remainingPackages:Le.packages,remainingUnits:Ze,providerPrice:Le.providerPrice,totalRivas:Le.totalRivas,totalSanJorge:Le.totalSanJorge,totalIsla:Le.totalIsla,unitPriceRivas:Le.unitPriceRivas,unitPriceSanJorge:Le.unitPriceSanJorge,unitPriceIsla:Le.unitPriceIsla,markupPercent:0,subtotal:Le.subtotal,totalVendor:Le.totalVendor,gainVendor:Le.gainVendor,unitPriceVendor:Le.pricePerPackage,date:me,orderId:Je.orderId||E,updatedAt:Kt.now()}),ye=ye.map(ut=>ut.id===Je.id?{...ut,sellerId:j.id,sellerName:j.name,productId:Me,productName:Le.productName,category:Le.category,packages:Le.packages,unitsPerPackage:Xe,totalUnits:Ze,remainingPackages:Le.packages,remainingUnits:Ze,providerPrice:Le.providerPrice,totalRivas:Le.totalRivas,totalSanJorge:Le.totalSanJorge,totalIsla:Le.totalIsla,unitPriceRivas:Le.unitPriceRivas,unitPriceSanJorge:Le.unitPriceSanJorge,unitPriceIsla:Le.unitPriceIsla,markupPercent:0,subtotal:Le.subtotal,totalVendor:Le.totalVendor,gainVendor:Le.gainVendor,unitPriceVendor:Le.pricePerPackage,date:me,orderId:Je.orderId||E}:ut);else{const ut=await st(Me,Le.packages,me),Ht={sellerId:j.id,sellerName:j.name,productId:Me,productName:Le.productName,category:Le.category,orderId:E,packages:Le.packages,unitsPerPackage:Xe,totalUnits:Ze,remainingPackages:Le.packages,remainingUnits:Ze,providerPrice:Le.providerPrice,totalRivas:Le.totalRivas,totalSanJorge:Le.totalSanJorge,totalIsla:Le.totalIsla,unitPriceRivas:Le.unitPriceRivas,unitPriceSanJorge:Le.unitPriceSanJorge,unitPriceIsla:Le.unitPriceIsla,markupPercent:0,subtotal:Le.subtotal,totalVendor:Le.totalVendor,gainVendor:Le.gainVendor,unitPriceVendor:Le.pricePerPackage,date:me,createdAt:Kt.now(),status:"ASIGNADO",masterAllocations:ut};ye=[{id:(await Wr(At(je,"inventory_candies_sellers"),Ht)).id,...Ht},...ye]}}for(const Me of Object.keys(Re))if(!Ee[Me]){const Le=Re[Me];await N3(Le.id),ye=ye.filter(Je=>Je.id!==Le.id)}y(ye),R(" Pedido actualizado para el vendedor y sincronizado con inventario principal.")}else{const Re=`ORD-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;for(const Ee of Ce){const ye=h.find(Xe=>Xe.id===Ee.productId);if(!ye)continue;const Me=Ee.packages>0&&ye.unitsPerPackage>0?Ee.packages*ye.unitsPerPackage:0,Le=await st(Ee.productId,Ee.packages,me),Je={sellerId:j.id,sellerName:j.name,productId:Ee.productId,productName:Ee.productName,category:Ee.category,orderId:Re,packages:Ee.packages,unitsPerPackage:ye.unitsPerPackage,totalUnits:Me,remainingPackages:Ee.packages,remainingUnits:Me,providerPrice:Ee.providerPrice,totalRivas:Ee.totalRivas,totalSanJorge:Ee.totalSanJorge,totalIsla:Ee.totalIsla,unitPriceRivas:Ee.unitPriceRivas,unitPriceSanJorge:Ee.unitPriceSanJorge,unitPriceIsla:Ee.unitPriceIsla,markupPercent:0,subtotal:Ee.subtotal,totalVendor:Ee.totalVendor,gainVendor:Ee.gainVendor,unitPriceVendor:Ee.pricePerPackage,date:me,createdAt:Kt.now(),status:"ASIGNADO",masterAllocations:Le},tt=await Wr(At(je,"inventory_candies_sellers"),Je);y(Xe=>[{id:tt.id,...Je},...Xe])}R(" Pedido asignado al vendedor y descontado del inventario.")}fe(),B(!1)}catch(Re){console.error(Re),R((Re==null?void 0:Re.message)||" Error al guardar el pedido del vendedor / ajustar inventario.")}finally{V(!1),F(!1)}},nt=()=>{if(!j){R("Selecciona un vendedor para imprimir el pedido.");return}if(!Ce.length){R("No hay productos en el pedido para imprimir.");return}const K=pe||new Date().toISOString().slice(0,10),le=Me=>(Me||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),me="Pedido de dulces para vendedor",Re=Ce.map(Me=>`
      <tr>
        <td>${le(Me.productName)}</td>
        <td class="right">${le(Me.category||"")}</td>
        <td class="right">${Me.packages}</td>

        <td class="right">${Nn(Me.providerPrice)}</td>
        <td class="right">${Nn(Me.subtotal)}</td>
        <td class="right">${Nn(Me.pricePerPackage)}</td>
        <td class="right">${Nn(Me.totalVendor)}</td>
      </tr>`).join(""),Ee=`<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>${le(me)}</title>
  <style>
    *{font-family: Arial, sans-serif; box-sizing:border-box;}
    body{margin:16px;font-size:13px;}
    h1{font-size:18px;margin:0 0 4px;}
    h2{font-size:14px;margin:12px 0 6px;}
    .muted{color:#555;font-size:11px;margin-bottom:10px;}
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 18px;margin:10px 0 14px;}
    .card{border:1px solid #ddd;border-radius:6px;padding:6px 8px;background:#fafafa;}
    .label{font-size:11px;color:#555;margin-bottom:2px;}
    .value{font-size:14px;font-weight:bold;}
    table{width:100%;border-collapse:collapse;margin-top:8px;font-size:12px;}
    th,td{border:1px solid #ddd;padding:4px 6px;}
    th{background:#f5f5f5;text-align:left;}
    .right{text-align:right;}
    @media print{
      @page{size:A5;margin:10mm;}
      body{margin:0;font-size:12px;}
    }
  </style>
</head>
<body>
  <h1>${le(me)}</h1>
  <div class="muted">
    Fecha pedido: <b>${le(K)}</b><br/>
    Vendedor: <b>${le(j.name)}</b>${j.commissionPercent?` &mdash; Comisin: <b>${j.commissionPercent.toFixed(2)}%</b>`:""}${j.branchLabel?`<br/>Ruta / sucursal: <b>${le(j.branchLabel)}</b>`:""}
  </div>

  <div class="grid">
    <div class="card">
      <div class="label">Paquetes totales del pedido</div>
      <div class="value">${ie.totalPackages}</div>
    </div>
    <div class="card">
      <div class="label">Subtotal costo (proveedor)</div>
      <div class="value">${Nn(ie.subtotal)}</div>
    </div>
    <div class="card">
      <div class="label">Total vendedor (precio venta)</div>
      <div class="value">${Nn(ie.totalVendor)}</div>
    </div>
    <div class="card">
      <div class="label">Comisin posible del vendedor</div>
      <div class="value">${Nn(ie.commissionAmount)}</div>
    </div>
  </div>

  <h2>Detalle del pedido</h2>
  <table>
    <thead>
      <tr>
        <th>Producto</th>
        <th class="right">Categora</th>
        <th class="right">Paquetes</th>
        <th class="right">P. Proveedor (paq)</th>
        <th class="right">Subtotal</th>
        <th class="right">P. Paquete vendedor</th>
        <th class="right">Total vendedor</th>
      </tr>
    </thead>
    <tbody>
      ${Re}
    </tbody>
  </table>

  <script>window.print()<\/script>
</body>
</html>`,ye=window.open("","_blank");if(!ye){alert("No se pudo abrir la ventana de impresin (revisa bloqueadores de pop-ups).");return}ye.document.open(),ye.document.write(Ee),ye.document.close()},De=K=>{const le=te.filter(Ee=>(Ee.orderId||Ee.id)===K);if(!le.length){R("No se encontraron filas para este pedido.");return}const me=le[0];if(o&&ve&&me.sellerId!==ve.id){R("No tienes permiso para ver este pedido.");return}M(K),T(le),Z(me.sellerId),ae(me.date);const Re=le.map(Ee=>{const ye=Ee.unitPriceRivas||0,Me=Ee.unitPriceSanJorge||0,Le=Ee.unitPriceIsla||0,Je=Ee.totalRivas||ye*Number(Ee.packages||0),tt=Ee.totalSanJorge||Me*Number(Ee.packages||0),Xe=Ee.totalIsla||Le*Number(Ee.packages||0);return{id:Ee.id,productId:Ee.productId,productName:Ee.productName,category:Ee.category,providerPrice:Ee.providerPrice,unitsPerPackage:Ee.unitsPerPackage,packages:Ee.packages,subtotal:Ee.subtotal,totalVendor:Ee.totalVendor,gainVendor:Ee.gainVendor,pricePerPackage:Ee.unitPriceVendor,totalRivas:Je,totalSanJorge:tt,totalIsla:Xe,unitPriceRivas:ye,unitPriceSanJorge:Me,unitPriceIsla:Le,remainingPackages:Ee.remainingPackages}});S(Re),de(""),xe("0"),B(!0)},Fe=async K=>{if(!a){R("No tienes permiso para borrar pedidos.");return}const le=g.filter(Ee=>(Ee.orderId||Ee.id)===K);if(!le.length)return;const me=le[0].sellerName||"";if(confirm(`Eliminar COMPLETAMENTE este pedido del vendedor "${me}"? Se regresarn los paquetes al inventario principal.`))try{F(!0);for(const Ee of le)await N3(Ee.id);y(Ee=>Ee.filter(ye=>(ye.orderId||ye.id)!==K)),R(" Pedido eliminado y paquetes regresados correctamente.")}catch(Ee){console.error(Ee),R(" Error al eliminar el pedido / regresar paquetes.")}finally{F(!1)}},[Ge,_e]=N.useState(!1),[G,Ne]=N.useState(!1),[Ue,$e]=N.useState([]),[ge,Be]=N.useState(""),[Qe,Te]=N.useState(""),[We,at]=N.useState(""),[bt,ot]=N.useState(""),[wt,Lt]=N.useState("0"),[Ar,ir]=N.useState(""),[xr,er]=N.useState(!1),et=N.useMemo(()=>J.map(K=>K.orderKey),[J]),gt=N.useMemo(()=>ge?te.filter(K=>(K.orderId||K.id)===ge):[],[te,ge]),Pt=N.useMemo(()=>gt.filter(K=>Number(K.remainingPackages||0)>0),[gt]),Ft=N.useMemo(()=>Qe&&te.find(K=>K.id===Qe)||null,[te,Qe]),Tt=N.useMemo(()=>We?te.filter(K=>(K.orderId||K.id)===We):[],[te,We]),Xt=N.useMemo(()=>Ft?Tt.filter(K=>K.productId===Ft.productId):[],[Tt,Ft]),Vt=async()=>{try{Ne(!0);let K=[];if(o&&e){const le=Ut(At(je,"inventory_transfers_candies"),qt("fromSellerId","==",e),Rr("createdAt","desc")),me=Ut(At(je,"inventory_transfers_candies"),qt("toSellerId","==",e),Rr("createdAt","desc")),[Re,Ee]=await Promise.all([Nt(le),Nt(me)]),ye=new Set,Me=Le=>{Le.forEach(Je=>{if(ye.has(Je.id))return;ye.add(Je.id);const tt=Je.data();K.push({id:Je.id,createdAt:tt.createdAt,date:tt.date,createdByEmail:tt.createdByEmail||"",createdByName:tt.createdByName||"",productId:tt.productId||"",productName:tt.productName||"",packagesMoved:Number(tt.packagesMoved||0),providerPrice:Number(tt.providerPrice||0),unitPriceRivas:Number(tt.unitPriceRivas||0),unitPriceIsla:Number(tt.unitPriceIsla||0),toSellerId:tt.toSellerId||"",toSellerName:tt.toSellerName||"",toOrderKey:tt.toOrderKey||"",toOrderLabel:tt.toOrderLabel||"",comment:tt.comment||"",fromSellerId:tt.fromSellerId||"",fromSellerName:tt.fromSellerName||"",fromOrderKey:tt.fromOrderKey||"",fromOrderLabel:tt.fromOrderLabel||"",fromVendorRowId:tt.fromVendorRowId||"",toVendorRowId:tt.toVendorRowId||""})})};Me(Re),Me(Ee),K.sort((Le,Je)=>{var Ze,ut;const tt=((Ze=Le.createdAt)==null?void 0:Ze.seconds)||0;return(((ut=Je.createdAt)==null?void 0:ut.seconds)||0)-tt})}else{const le=Ut(At(je,"inventory_transfers_candies"),Rr("createdAt","desc"));(await Nt(le)).forEach(Re=>{const Ee=Re.data();K.push({id:Re.id,createdAt:Ee.createdAt,date:Ee.date,createdByEmail:Ee.createdByEmail||"",createdByName:Ee.createdByName||"",productId:Ee.productId||"",productName:Ee.productName||"",packagesMoved:Number(Ee.packagesMoved||0),providerPrice:Number(Ee.providerPrice||0),unitPriceRivas:Number(Ee.unitPriceRivas||0),unitPriceIsla:Number(Ee.unitPriceIsla||0),toSellerId:Ee.toSellerId||"",toSellerName:Ee.toSellerName||"",toOrderKey:Ee.toOrderKey||"",toOrderLabel:Ee.toOrderLabel||"",comment:Ee.comment||"",fromSellerId:Ee.fromSellerId||"",fromSellerName:Ee.fromSellerName||"",fromOrderKey:Ee.fromOrderKey||"",fromOrderLabel:Ee.fromOrderLabel||"",fromVendorRowId:Ee.fromVendorRowId||"",toVendorRowId:Ee.toVendorRowId||""})})}$e(K)}catch(K){console.error(K),R(" Error cargando traslados.")}finally{Ne(!1)}},oe=async()=>{_e(!0),await Vt()},ne=()=>{Be(""),Te(""),at(""),ot(""),Lt("0"),ir("")},ue=async()=>{if(!a){R("No tienes permiso para hacer traslados.");return}R("");const K=Number(wt||0);if(!(K>0)){R("La cantidad de paquetes debe ser mayor a 0.");return}if(!Ar.trim()){R("Debes escribir el motivo de la movida.");return}if(!ge||!Qe){R("Selecciona el pedido origen y el producto.");return}if(!We||!bt){R("Selecciona el pedido destino y el producto destino.");return}if(Qe===bt){R("Origen y destino no pueden ser el mismo.");return}const le=g.find(Re=>Re.id===Qe)||null,me=g.find(Re=>Re.id===bt)||null;if(!le||!me){R("No se encontr la fila origen/destino.");return}if(le.productId!==me.productId){R("El producto destino no coincide con el producto origen.");return}if(Number(le.remainingPackages||0)<K){R("El origen no tiene suficientes paquetes disponibles.");return}try{er(!0),F(!0);const Re=kt(je,"inventory_candies_sellers",le.id),Ee=kt(je,"inventory_candies_sellers",me.id),ye=Kt.now(),Me=new Date().toISOString().slice(0,10);await ha(je,async Le=>{const Je=await Le.get(Re),tt=await Le.get(Ee);if(!Je.exists())throw new Error("Orden origen no existe.");if(!tt.exists())throw new Error("Orden destino no existe.");const Xe=Je.data(),Ze=tt.data(),ut=Number(Xe.remainingPackages||0);if(ut<K)throw new Error("Origen no tiene suficientes paquetes.");const Ht=Number(Xe.unitsPerPackage||Ze.unitsPerPackage||0),wr=Ht>0?K*Ht:0;Le.update(Re,{remainingPackages:ut-K,...Ht>0?{remainingUnits:Number(Xe.remainingUnits||0)-wr}:{},updatedAt:ye}),Le.update(Ee,{remainingPackages:Number(Ze.remainingPackages||0)+K,...Ht>0?{remainingUnits:Number(Ze.remainingUnits||0)+wr}:{},updatedAt:ye});const ur=kt(At(je,"inventory_transfers_candies"));Le.set(ur,{createdAt:ye,date:Me,createdByEmail:(r||"").trim(),createdByName:String(z||"").trim(),productId:String(Xe.productId||""),productName:String(Xe.productName||""),packagesMoved:K,providerPrice:Number(Xe.providerPrice||0),unitPriceRivas:Number(Xe.unitPriceRivas||0),unitPriceIsla:Number(Xe.unitPriceIsla||0),fromSellerId:String(Xe.sellerId||""),fromSellerName:String(Xe.sellerName||""),fromOrderKey:String(Xe.orderId||le.id||""),fromOrderLabel:String(Xe.orderId||le.id||""),toSellerId:String(Ze.sellerId||""),toSellerName:String(Ze.sellerName||""),toOrderKey:String(Ze.orderId||me.id||""),toOrderLabel:String(Ze.orderId||me.id||""),fromVendorRowId:le.id,toVendorRowId:me.id,comment:Ar.trim()})}),y(Le=>Le.map(Je=>{if(Je.id===le.id){const tt=Number(Je.unitsPerPackage||0),Xe=tt>0?K*tt:0;return{...Je,remainingPackages:Number(Je.remainingPackages||0)-K,remainingUnits:tt>0?Number(Je.remainingUnits||0)-Xe:Je.remainingUnits}}if(Je.id===me.id){const tt=Number(Je.unitsPerPackage||0),Xe=tt>0?K*tt:0;return{...Je,remainingPackages:Number(Je.remainingPackages||0)+K,remainingUnits:tt>0?Number(Je.remainingUnits||0)+Xe:Je.remainingUnits}}return Je})),await Vt(),u(Le=>{const Je={...Le},tt=ge,Xe=We,Ze=Number(wt||0);return tt&&(Je[tt]=Je[tt]||{out:0,in:0},Je[tt].out+=Ze),Xe&&(Je[Xe]=Je[Xe]||{out:0,in:0},Je[Xe].in+=Ze),Je}),ne(),R(" Traslado realizado.")}catch(Re){console.error(Re),R((Re==null?void 0:Re.message)||" Error realizando el traslado.")}finally{er(!1),F(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes de Rutas"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:s,loading:b}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700",onClick:oe,type:"button",children:"Traslados"}),a&&i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{fe(),B(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo pedido a vendedor"]})]})]}),Ge&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[xr&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{_e(!1),ne()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ge,onChange:K=>{Be(K.target.value),Te(""),at(""),ot(""),Lt("0")},disabled:!a,children:[i.jsx("option",{value:"",children:"Selecciona"}),et.map(K=>{const le=q[K];return i.jsxs("option",{value:K,children:["Vendedor: ",(le==null?void 0:le.sellerName)||"","  Existencias: ","",(le==null?void 0:le.totalRemainingPackages)||"0"," Paquetes - Fecha Orden: ",(le==null?void 0:le.date)||""]},K)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Qe,onChange:K=>{Te(K.target.value),at(""),ot(""),Lt("0")},disabled:!a||!ge,children:[i.jsx("option",{value:"",children:"Selecciona"}),Pt.map(K=>i.jsxs("option",{value:K.id,children:["Tipo: ",K.category," - ",K.productName,"  Existencias:"," ",Number(K.remainingPackages||0)," Paquetes - Precio Costo: $",K.providerPrice]},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:We,onChange:K=>{at(K.target.value),ot("")},disabled:!a||!Qe,children:[i.jsx("option",{value:"",children:"Selecciona"}),et.filter(K=>K!==ge).map(K=>{const le=q[K];return i.jsxs("option",{value:K,children:["Vendedor: ",(le==null?void 0:le.sellerName)||"","  Existencias: ","",(le==null?void 0:le.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(le==null?void 0:le.date)||""]},K)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:bt,onChange:K=>ot(K.target.value),disabled:!a||!We||!Ft,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xt.map(K=>i.jsxs("option",{value:K.id,children:["Tipo: ",K.category," - ",K.productName,"  Existencias:"," ",Number(K.remainingPackages||0)," Paquetes - Precio Costo: $",K.providerPrice]},K.id))]}),We&&Ft&&Xt.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. (Debe existir en el pedido destino)"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:wt,onChange:K=>Lt(K.target.value),disabled:!a||!Qe||!bt})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ar,onChange:K=>ir(K.target.value),disabled:!a,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:ne,disabled:!a||xr,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:ue,disabled:!a||xr||!Qe||!bt||Number(wt||0)<=0||!Ar.trim(),children:"Hacer traslado"})]})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Vt,disabled:G,type:"button",children:G?"Cargando...":"Recargar"})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Movido a vendedor"}),i.jsx("th",{className:"p-2 border",children:"Movido a orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:G?i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Cargando"})}):Ue.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Sin traslados"})}):Ue.map(K=>{var Ee,ye;const le=((ye=(Ee=K.createdAt)==null?void 0:Ee.toDate)==null?void 0:ye.call(Ee))||(K.createdAt?new Date(K.createdAt.seconds*1e3):null),me=le?`${le.toISOString().slice(0,10)} ${le.toISOString().slice(11,19)}`:K.date||"",Re=(K.createdByName||"").trim()||(K.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:me}),i.jsx("td",{className:"p-2 border",children:Re}),i.jsx("td",{className:"p-2 border text-left",children:K.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(K.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:Nn(K.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:Nn(K.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:Nn(K.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:K.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:K.toOrderLabel||K.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:K.comment||""})]},K.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}),_&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm relative",children:[I&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando pedido..."})}),i.jsx("h3",{className:"text-xl font-bold mb-4",children:E?"Editar pedido de vendedor":"Nuevo pedido para vendedor"}),d.length===0&&i.jsx("p",{className:"text-sm text-red-600 mb-2",children:" No hay vendedores. Primero crea vendedores en la pantalla correspondiente."}),i.jsxs("form",{onSubmit:ft,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:U,onChange:K=>Z(K.target.value),disabled:c,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),d.map(K=>i.jsxs("option",{value:K.id,children:[K.name,K.branchLabel?` - ${K.branchLabel}`:"",K.commissionPercent?` (${K.commissionPercent.toFixed(1)}% comisin)`:""]},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:pe,onChange:K=>ae(K.target.value),disabled:c})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:he,onChange:K=>de(K.target.value),disabled:c,children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),Y.map(K=>{const le=p[K.id]??0,me=[];me.push(K.category?`${K.category} - ${K.name}`:K.name);const Re=[];K.unitPriceRivas>0&&Re.push(`R: ${Nn(K.unitPriceRivas)}`),K.unitPriceSanJorge>0&&Re.push(`SJ: ${Nn(K.unitPriceSanJorge)}`),K.unitPriceIsla>0&&Re.push(`I: ${Nn(K.unitPriceIsla)}`),Re.length&&me.push(Re.join(" | ")),me.push(`Disp: ${le} paq`);const Ee=D.has(K.id);return i.jsx("option",{value:K.id,disabled:Ee,children:Ee?` (Agregado) ${me.join("  ")}`:me.join("  ")},K.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes / bolsas"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:re,onChange:K=>xe(K.target.value),disabled:c})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:ze,className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",disabled:c||!he||D.has(he),title:D.has(he)?"Ese producto ya est en el pedido":"",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Paq x Und (ref)"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),i.jsx("th",{className:"p-2 border",children:"P. paquete vendedor"}),i.jsx("th",{className:"p-2 border",children:"Total vendedor"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Ce.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center text-gray-500",children:"No hay productos en este pedido. Agrega al menos uno."})}):Ce.map(K=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:K.productName}),i.jsx("td",{className:"p-2 border",children:K.category}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",min:0,className:"border p-1 rounded text-right text-xs w-20",value:K.packages,onChange:le=>ct(K.id,le.target.value),disabled:c})}),i.jsx("td",{className:"p-2 border",children:K.remainingPackages??K.packages}),i.jsx("td",{className:"p-2 border",children:K.unitsPerPackage||""}),i.jsx("td",{className:"p-2 border",children:Nn(K.providerPrice)}),i.jsx("td",{className:"p-2 border",children:Nn(K.subtotal)}),i.jsx("td",{className:"p-2 border",children:Nn(K.totalRivas)}),i.jsx("td",{className:"p-2 border",children:Nn(K.totalSanJorge)}),i.jsx("td",{className:"p-2 border",children:Nn(K.totalIsla)}),i.jsx("td",{className:"p-2 border",children:Nn(K.unitPriceRivas)}),i.jsx("td",{className:"p-2 border",children:Nn(K.unitPriceSanJorge)}),i.jsx("td",{className:"p-2 border",children:Nn(K.unitPriceIsla)}),i.jsx("td",{className:"p-2 border",children:Nn(K.pricePerPackage)}),i.jsx("td",{className:"p-2 border",children:Nn(K.totalVendor)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs disabled:opacity-50",onClick:()=>Ye(K.id),disabled:c,children:"Quitar"})})]},K.id))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales del pedido"}),i.jsx("div",{className:"text-lg font-semibold",children:ie.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),i.jsx("div",{className:"text-lg font-semibold",children:Nn(ie.subtotal)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total vendedor (precio venta)"}),i.jsx("div",{className:"text-lg font-semibold text-green-600",children:Nn(ie.totalVendor)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin posible vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:Nn(ie.commissionAmount)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a&&i.jsx("button",{type:"button",onClick:fe,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:I,children:"Limpiar pedido"}),i.jsx("button",{type:"button",onClick:()=>{fe(),B(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:I,children:"Cerrar"}),i.jsx("button",{type:"button",onClick:nt,className:"px-3 py-1 rounded bg-purple-600 text-white hover:bg-purple-700",disabled:!j||Ce.length===0,children:"Imprimir pedido"}),a&&i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",disabled:I||!j||Ce.length===0,children:I?"Guardando...":"Guardar pedido"})]})]})]})}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-4",children:[i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Listado de pedidos"}),i.jsxs("table",{className:"min-w-[1000px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes Trasladados"}),i.jsx("th",{className:"p-2 border",children:"Paquetes Adicionales"}),i.jsx("th",{className:"p-2 border",children:"Subtotal costo"}),i.jsx("th",{className:"p-2 border",children:"Total vendedor"}),i.jsx("th",{className:"p-2 border",children:"Comisin posible"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:b?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Cargando"})}):J.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Sin pedidos asignados a vendedores."})}):J.map(K=>{var Ee,ye;const le=se[K.sellerId],me=Number((le==null?void 0:le.commissionPercent)||0),Re=K.totalVendor*me/100;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:K.date||""}),i.jsxs("td",{className:"p-2 border",children:[K.sellerName,le!=null&&le.branchLabel?` - ${le.branchLabel}`:""]}),i.jsx("td",{className:"p-2 border",children:K.totalPackages}),i.jsx("td",{className:"p-2 border",children:K.totalRemainingPackages}),i.jsx("td",{className:"p-2 border",children:((Ee=A[K.orderKey])==null?void 0:Ee.out)||0}),i.jsx("td",{className:"p-2 border",children:((ye=A[K.orderKey])==null?void 0:ye.in)||0}),i.jsx("td",{className:"p-2 border",children:Nn(K.subtotal)}),i.jsx("td",{className:"p-2 border",children:Nn(K.totalVendor)}),i.jsx("td",{className:"p-2 border",children:Nn(Re)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>De(K.orderKey),children:"Ver / Editar"}),a&&i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Fe(K.orderKey),children:"Borrar"})]})})]},K.orderKey)})})]})]}),P&&i.jsx("p",{className:"mt-2 text-sm",children:P})]})}function mC(t){return isFinite(t)?Math.round(t):0}function Qn(t){const e=Number(t);return Number.isFinite(e)?Math.floor(e):0}function h7(t){const e=Math.max(1,Qn(t.unitsPerPackage||1)),r=Qn(t.totalUnits||0),n=Qn(t.quantity||0),s=Qn(t.packages||0);return r>0?r:n>0?n:s>0?s*e:0}function b1e(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):h7(t)}function _3(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,Qn(t.unitsPerPackage||1)),n=b1e(t);return Math.max(0,Math.floor(n/r))}function N1e(t){const e=Math.max(1,Qn(t.unitsPerPackage||1)),r=h7(t);return Math.max(0,Math.floor(r/e))}function C1e(){const{refreshKey:t,refresh:e}=Jl(),[r,n]=N.useState(""),[s,a]=N.useState(!0),[o,l]=N.useState([]),[c,A]=N.useState(!1),[u,d]=N.useState([]),[f,h]=N.useState({}),[m,p]=N.useState(!1),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,P]=N.useState(""),[R,_]=N.useState("20"),[B,E]=N.useState("15"),[M,k]=N.useState("30"),[T,U]=N.useState([]),[Z,pe]=N.useState(""),[ae,he]=N.useState(""),[de,re]=N.useState(""),[xe,Ce]=N.useState("1"),[S,I]=N.useState("0"),V=N.useMemo(()=>{const q=new Set;for(const ie of o){const fe=String(ie.category||"").trim();fe&&q.add(fe)}return Array.from(q).sort((ie,fe)=>ie.localeCompare(fe,"es"))},[o]);N.useEffect(()=>{!Z&&V.length>0&&pe(V[0])},[V]);const j=(q,ie,fe)=>{const Ie=q*ie,Ve=Math.min(Math.max(fe.marginR,0),99.9)/100,ze=Math.min(Math.max(fe.marginSJ,0),99.9)/100,Ye=Math.min(Math.max(fe.marginIsla,0),99.9)/100,ct=ie>0&&Ve<1?Ie/(1-Ve):Ie,st=ie>0&&ze<1?Ie/(1-ze):Ie,ft=ie>0&&Ye<1?Ie/(1-Ye):Ie,nt=ct-Ie,De=st-Ie,Fe=ft-Ie,Ge=ie>0?mC(ct/ie):0,_e=ie>0?mC(st/ie):0,G=ie>0?mC(ft/ie):0;return{subtotal:Ie,totalRivas:ct,totalSanJorge:st,totalIsla:ft,gainRivas:nt,gainSanJorge:De,gainIsla:Fe,unitPriceRivas:Ge,unitPriceSanJorge:_e,unitPriceIsla:G}},O=()=>{g(null),b(""),P(""),U([]),pe(V[0]||""),he(""),re(""),I("0"),Ce("1"),_("20"),E("15"),k("30")},W=async()=>{A(!0);try{const q=await Nt(Ut(At(je,"products_candies"),Rr("createdAt","desc"))),ie=[];q.forEach(fe=>{const Ie=fe.data();ie.push({id:fe.id,name:String(Ie.name??"").trim(),category:String(Ie.category??"").trim()||"Caramelo",providerPrice:Number(Ie.providerPrice??0),unitsPerPackage:Number(Ie.unitsPerPackage??1)})}),l(ie)}catch(q){console.error(q),n(" Error cargando catlogo de dulces.")}finally{A(!1)}};N.useEffect(()=>{W()},[t]);const D=N.useMemo(()=>(Z.trim().length>0?o.filter(ie=>ie.category===Z):o).sort((ie,fe)=>ie.name.localeCompare(fe.name,"es")),[o,Z]);N.useEffect(()=>{if(!ae){re(""),Ce("1");return}const q=o.find(ie=>ie.id===ae);q&&(re(String(q.providerPrice??0)),Ce(String(q.unitsPerPackage??1)))},[ae,o]);const Y=()=>{if(n(""),!ae){n("Selecciona un producto del catlogo.");return}const q=o.find(st=>st.id===ae);if(!q){n("Producto de catlogo no encontrado (refresca).");return}const ie=Number(q.providerPrice||0),fe=Qn(S||0),Ie=Qn(q.unitsPerPackage||0);if(ie<0){n("El precio proveedor no puede ser negativo.");return}if(fe<=0){n("Los paquetes del pedido general deben ser mayor que 0.");return}if(Ie<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const Ve=Number(R||0),ze=Number(B||0),Ye=Number(M||0);if(T.find(st=>st.id===q.id))U(st=>st.map(ft=>{if(ft.id!==q.id)return ft;const nt=Qn(ft.packages||0)+fe,De=j(ie,nt,{marginR:Number(ft.marginRivas||Ve),marginSJ:Number(ft.marginSanJorge||ze),marginIsla:Number(ft.marginIsla||Ye)});return{...ft,providerPrice:ie,unitsPerPackage:Ie,packages:nt,remainingPackages:Qn(ft.remainingPackages??ft.packages)+fe,...De}}));else{const st=j(ie,fe,{marginR:Ve,marginSJ:ze,marginIsla:Ye}),ft={id:q.id,name:q.name,category:q.category,providerPrice:ie,packages:fe,unitsPerPackage:Ie,marginRivas:Ve,marginSanJorge:ze,marginIsla:Ye,subtotal:st.subtotal,totalRivas:st.totalRivas,totalSanJorge:st.totalSanJorge,totalIsla:st.totalIsla,gainRivas:st.gainRivas,gainSanJorge:st.gainSanJorge,gainIsla:st.gainIsla,unitPriceRivas:st.unitPriceRivas,unitPriceSanJorge:st.unitPriceSanJorge,unitPriceIsla:st.unitPriceIsla,remainingPackages:fe};U(nt=>[...nt,ft])}he(""),I("0")},se=q=>{U(ie=>ie.filter(fe=>fe.id!==q))},ve=N.useMemo(()=>{const q=T.reduce((ze,Ye)=>ze+Qn(Ye.packages),0),ie=T.reduce((ze,Ye)=>ze+Number(Ye.subtotal||0),0),fe=T.reduce((ze,Ye)=>ze+Number(Ye.totalRivas||0),0),Ie=T.reduce((ze,Ye)=>ze+Number(Ye.totalSanJorge||0),0),Ve=T.reduce((ze,Ye)=>ze+Number(Ye.totalIsla||0),0);return{totalPackages:q,subtotal:ie,totalRivas:fe,totalSanJorge:Ie,totalIsla:Ve}},[T]),z=(q,ie,fe)=>{U(Ie=>Ie.map(Ve=>{if(Ve.id!==q)return Ve;let ze={...Ve};if(ie==="packages"&&(ze.packages=Qn(fe||0)),ie==="unitsPerPackage"&&(ze.unitsPerPackage=Qn(fe||0)),ie==="marginRivas"&&(ze.marginRivas=Number(fe||0)),ie==="marginSanJorge"&&(ze.marginSanJorge=Number(fe||0)),ie==="marginIsla"&&(ze.marginIsla=Number(fe||0)),ie==="packages"||ie==="marginRivas"||ie==="marginSanJorge"||ie==="marginIsla"){const Ye=j(ze.providerPrice,ze.packages,{marginR:Number(ze.marginRivas||0),marginSJ:Number(ze.marginSanJorge||0),marginIsla:Number(ze.marginIsla||0)});ze={...ze,...Ye}}return ze}))};N.useEffect(()=>{(async()=>{a(!0);try{const q=Ut(At(je,"candy_main_orders"),Rr("createdAt","desc")),ie=await Nt(q),fe=[];ie.forEach(ze=>{const Ye=ze.data();fe.push({id:ze.id,name:Ye.name??"",date:Ye.date??"",totalPackages:Number(Ye.totalPackages??0),subtotal:Number(Ye.subtotal??0),totalRivas:Number(Ye.totalRivas??0),totalSanJorge:Number(Ye.totalSanJorge??0),totalIsla:Number(Ye.totalIsla??0),marginRivas:Number(Ye.marginRivas??20),marginSanJorge:Number(Ye.marginSanJorge??15),marginIsla:Number(Ye.marginIsla??30),createdAt:Ye.createdAt??Kt.now()})}),d(fe);const Ie=await Nt(At(je,"inventory_candies")),Ve={};Ie.forEach(ze=>{const Ye=ze.data(),ct=Ye.orderId;if(!ct)return;const st=N1e(Ye),ft=_3(Ye);Ve[ct]||(Ve[ct]={orderId:ct,totalPackages:0,remainingPackages:0}),Ve[ct].totalPackages+=st,Ve[ct].remainingPackages+=ft}),h(Ve)}catch(q){console.error(q),n(" Error cargando pedidos generales.")}finally{a(!1)}})()},[t]);const Oe=async q=>{if(q.preventDefault(),n(""),!T.length){n("Agrega al menos un producto al pedido general.");return}try{const ie=new Date().toISOString().slice(0,10),fe=F||ie,Ie=ve,Ve=Number(R||0),ze=Number(B||0),Ye=Number(M||0);for(const st of T){if(!st.name.trim()){n("Hay un producto sin nombre en el pedido.");return}if(st.providerPrice<0){n(`El precio proveedor no puede ser negativo (producto: ${st.name}).`);return}if(st.packages<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${st.name}).`);return}if(st.unitsPerPackage<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${st.name}).`);return}}const ct={name:y||`Pedido ${fe}`,date:fe,totalPackages:Ie.totalPackages,subtotal:Ie.subtotal,totalRivas:Ie.totalRivas,totalSanJorge:Ie.totalSanJorge,totalIsla:Ie.totalIsla,marginRivas:Ve,marginSanJorge:ze,marginIsla:Ye,items:T};if(x){await kr(kt(je,"candy_main_orders",x),{...ct});for(const nt of T){const De=await Nt(Ut(At(je,"inventory_candies"),qt("orderId","==",x),qt("productId","==",nt.id))),Fe=Qn(nt.packages)*Qn(nt.unitsPerPackage),Ge=Math.max(1,Qn(nt.unitsPerPackage||1));if(De.empty)await Wr(At(je,"inventory_candies"),{productId:nt.id,productName:nt.name,category:nt.category,measurement:"unidad",quantity:Fe,remaining:Fe,packages:Qn(nt.packages),remainingPackages:Qn(nt.packages),unitsPerPackage:Ge,totalUnits:Fe,providerPrice:nt.providerPrice,subtotal:nt.subtotal,totalRivas:nt.totalRivas,totalSanJorge:nt.totalSanJorge,totalIsla:nt.totalIsla,gainRivas:nt.gainRivas,gainSanJorge:nt.gainSanJorge,gainIsla:nt.gainIsla,unitPriceRivas:nt.unitPriceRivas,unitPriceSanJorge:nt.unitPriceSanJorge,unitPriceIsla:nt.unitPriceIsla,date:fe,createdAt:Kt.now(),status:"PENDIENTE",orderId:x});else for(const _e of De.docs){const G=_e.data(),Ne=Qn(G.totalUnits??0),Ue=Qn(G.remaining??Ne),$e=Fe-Ne,ge=Math.max(0,Ue+$e),Be=Math.max(0,Math.floor(ge/Ge));await kr(kt(je,"inventory_candies",_e.id),{productName:nt.name,category:nt.category,unitsPerPackage:Ge,totalUnits:Fe,quantity:Fe,remaining:ge,packages:Qn(nt.packages),remainingPackages:Be,providerPrice:nt.providerPrice,subtotal:nt.subtotal,totalRivas:nt.totalRivas,totalSanJorge:nt.totalSanJorge,totalIsla:nt.totalIsla,gainRivas:nt.gainRivas,gainSanJorge:nt.gainSanJorge,gainIsla:nt.gainIsla,unitPriceRivas:nt.unitPriceRivas,unitPriceSanJorge:nt.unitPriceSanJorge,unitPriceIsla:nt.unitPriceIsla,date:fe})}}const st=await Nt(Ut(At(je,"inventory_candies"),qt("orderId","==",x))),ft=new Set(T.map(nt=>nt.id));for(const nt of st.docs){const De=nt.data(),Fe=String(De.productId||"");Fe&&!ft.has(Fe)&&await un(kt(je,"inventory_candies",nt.id))}d(nt=>nt.map(De=>De.id===x?{...De,name:ct.name,date:ct.date,totalPackages:ct.totalPackages,subtotal:ct.subtotal,totalRivas:ct.totalRivas,totalSanJorge:ct.totalSanJorge,totalIsla:ct.totalIsla,marginRivas:ct.marginRivas,marginSanJorge:ct.marginSanJorge,marginIsla:ct.marginIsla}:De)),n(" Orden maestra actualizada (pedido + inventario).")}else{const ft=(await Wr(At(je,"candy_main_orders"),{...ct,createdAt:Kt.now()})).id,nt=Gh(je);for(const De of T){const Fe=Math.max(1,Qn(De.unitsPerPackage||1)),Ge=Qn(De.packages)*Fe,_e=kt(At(je,"inventory_candies"));nt.set(_e,{productId:De.id,productName:De.name,category:De.category,measurement:"unidad",quantity:Ge,remaining:Ge,packages:Qn(De.packages),remainingPackages:Qn(De.packages),unitsPerPackage:Fe,totalUnits:Ge,providerPrice:De.providerPrice,subtotal:De.subtotal,totalRivas:De.totalRivas,totalSanJorge:De.totalSanJorge,totalIsla:De.totalIsla,gainRivas:De.gainRivas,gainSanJorge:De.gainSanJorge,gainIsla:De.gainIsla,unitPriceRivas:De.unitPriceRivas,unitPriceSanJorge:De.unitPriceSanJorge,unitPriceIsla:De.unitPriceIsla,date:fe,createdAt:Kt.now(),status:"PENDIENTE",orderId:ft})}await nt.commit(),n(" Orden maestra creada y registrada en inventario.")}O(),p(!1),e()}catch(ie){console.error(ie),n(" Error al guardar orden maestra.")}},te=async q=>{try{a(!0),n(""),g(q.id),b(q.name),P(q.date),_(String(q.marginRivas??20)),E(String(q.marginSanJorge??15)),k(String(q.marginIsla??30));const ie=kt(je,"candy_main_orders",q.id),fe=await Wa(ie);if(!fe.exists()){n(" No se encontr la orden.");return}const Ie=fe.data(),Ve=Array.isArray(Ie.items)?Ie.items:[],ze=await Nt(Ut(At(je,"inventory_candies"),qt("orderId","==",q.id))),Ye={};ze.forEach(st=>{const ft=st.data(),nt=String(ft.productId||"");if(!nt)return;const De=_3(ft);Ye[nt]=(Ye[nt]||0)+De});const ct=Ve.map(st=>{const ft=o.find(Ge=>Ge.id===st.id),nt=Number((ft==null?void 0:ft.providerPrice)??st.providerPrice??0),De=Math.max(1,Qn((ft==null?void 0:ft.unitsPerPackage)??st.unitsPerPackage??1)),Fe=j(nt,Qn(st.packages||0),{marginR:Number(st.marginRivas||0),marginSJ:Number(st.marginSanJorge||0),marginIsla:Number(st.marginIsla||0)});return{...st,name:String((ft==null?void 0:ft.name)??st.name??""),category:String((ft==null?void 0:ft.category)??st.category??"Caramelo"),providerPrice:nt,unitsPerPackage:De,remainingPackages:Ye[st.id]??st.remainingPackages??st.packages??0,...Fe}});U(ct),p(!0)}catch(ie){console.error(ie),n(" Error al abrir orden maestra.")}finally{a(!1)}},J=async q=>{if(confirm(`Eliminar la orden "${q.name}" y todo su inventario asociado?`)){n("");try{const fe=await Nt(Ut(At(je,"inventory_candies"),qt("orderId","==",q.id)));for(const Ie of fe.docs)await un(kt(je,"inventory_candies",Ie.id));await un(kt(je,"candy_main_orders",q.id)),d(Ie=>Ie.filter(Ve=>Ve.id!==q.id)),n(" Orden maestra eliminada."),e()}catch(fe){console.error(fe),n(" Error al eliminar orden maestra.")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:e,loading:s||c}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700",onClick:()=>{O(),p(!0)},children:[i.jsx("span",{className:"inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nueva Orden"]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:x?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("form",{onSubmit:Oe,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:y,onChange:q=>b(q.target.value),placeholder:"Ej: Pedido diciembre 01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:F,onChange:q=>P(q.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:R,onChange:q=>_(q.target.value),disabled:!!x})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia San Jorge"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:B,onChange:q=>E(q.target.value),disabled:!!x})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:M,onChange:q=>k(q.target.value),disabled:!!x})]})]}),!x&&i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:Z,onChange:q=>{pe(q.target.value),he("")},disabled:c,children:V.length===0?i.jsx("option",{value:"",children:c?"Cargando...":"No hay categoras en catlogo"}):V.map(q=>i.jsx("option",{value:q,children:q},q))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:q=>he(q.target.value),children:[i.jsx("option",{value:"",children:c?"Cargando catlogo...":"Selecciona producto"}),D.map(q=>i.jsx("option",{value:q.id,children:q.name},q.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:de,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:S,onChange:q=>I(q.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:xe,readOnly:!0})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:Y,className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),!x&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:x?16:17,className:"p-4 text-center text-gray-500",children:"No hay productos en esta orden."})}):T.map(q=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:q.name}),i.jsx("td",{className:"p-2 border",children:q.category}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-24 border p-1 rounded text-right",value:q.packages,onChange:ie=>z(q.id,"packages",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:q.remainingPackages??q.packages}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.unitsPerPackage,onChange:ie=>z(q.id,"unitsPerPackage",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:Number(q.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.marginRivas??0,onChange:ie=>z(q.id,"marginRivas",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.marginSanJorge??0,onChange:ie=>z(q.id,"marginSanJorge",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.marginIsla??0,onChange:ie=>z(q.id,"marginIsla",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:Number(q.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(q.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(q.totalSanJorge||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(q.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:q.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:q.unitPriceIsla}),!x&&i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>se(q.id),children:"Quitar"})})]},q.id))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales de la orden"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.subtotal.toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Rivas (orden)"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.totalRivas.toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total San Jorge / Isla"}),i.jsxs("div",{className:"text-sm font-semibold",children:["SJ: ",ve.totalSanJorge.toFixed(2),i.jsx("br",{}),"Isla: ",ve.totalIsla.toFixed(2)]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",onClick:O,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{O(),p(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",disabled:T.length===0,children:"Guardar orden"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-4",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):u.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin ordenes maestras."})}):u.map(q=>{var fe;q.totalPackages>0&&Math.round(q.totalRivas/q.totalPackages),q.totalPackages>0&&Math.round(q.totalSanJorge/q.totalPackages),q.totalPackages>0&&Math.round(q.totalIsla/q.totalPackages);const ie=f[q.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:q.date||((fe=q.createdAt)!=null&&fe.toDate?q.createdAt.toDate().toISOString().slice(0,10):"")}),i.jsx("td",{className:"p-2 border",children:q.name}),i.jsx("td",{className:"p-2 border",children:q.totalPackages}),i.jsx("td",{className:"p-2 border",children:ie?ie.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:(q.subtotal/q.totalPackages).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>te(q),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>J(q),children:"Borrar"})]})})]},q.id)})})]})}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]})}const lu=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function pC(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),s=r*e,a=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),A=s*(1+o/100),u=s*(1+l/100),d=s*(1+c/100),f=A-s,h=u-s,m=d-s,p=A/a,x=u/a,g=d/a;return{...t,subtotal:Number(s.toFixed(2)),totalRivas:Number(A.toFixed(2)),totalSanJorge:Number(u.toFixed(2)),totalIsla:Number(d.toFixed(2)),gainRivas:Number(f.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(g.toFixed(2))}}function E3(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function Ki(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function gC(t){const{margin:e,gain:r,subtotal:n,orderMargin:s}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const a=Number(n||0),o=Number(r);return Number.isFinite(o)&&a>0?o/a*100:Number(s||0)}function _1e(){var j,O,W;const[t,e]=N.useState([]),[r,n]=N.useState({}),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(rr(Ec(new Date),"yyyy-MM-dd")),[u,d]=N.useState(rr(_c(new Date),"yyyy-MM-dd")),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[x,g]=N.useState(null),[y,b]=N.useState([]),[F,P]=N.useState(0),[R,_]=N.useState(0),[B,E]=N.useState(0),[M,k]=N.useState(""),[T,U]=N.useState(""),[Z,pe]=N.useState(0),[ae,he]=N.useState(0),[de,re]=N.useState(1);N.useEffect(()=>{(async()=>{try{a(!0),l("");const D=Ut(At(je,"candy_main_orders"),Rr("createdAt","desc")),Y=await Nt(D),se=[];Y.forEach(Oe=>{const te=Oe.data();se.push({id:Oe.id,name:te.name??"",date:te.date??"",totalPackages:Number(te.totalPackages??0),subtotal:Number(te.subtotal??0),totalRivas:Number(te.totalRivas??0),totalSanJorge:Number(te.totalSanJorge??0),totalIsla:Number(te.totalIsla??0),marginRivas:Number(te.marginRivas??0),marginSanJorge:Number(te.marginSanJorge??0),marginIsla:Number(te.marginIsla??0),createdAt:te.createdAt??Kt.now()})}),e(se);const ve=await Nt(Ut(At(je,"inventory_candies"))),z={};ve.forEach(Oe=>{const te=Oe.data(),J=te.orderId;if(!J)return;const q=Number(te.unitsPerPackage||1)||1,ie=Number(te.totalUnits??(te.packages||0)*q),fe=Math.round(ie/q),Ie=Number(te.remaining??te.totalUnits??ie),Ve=Number(te.remainingPackages??NaN),ze=Number.isFinite(Ve)?Math.round(Ve):Math.round(Ie/q);z[J]||(z[J]={orderId:J,totalPackages:0,remainingPackages:0}),z[J].totalPackages+=fe,z[J].remainingPackages+=ze}),n(z)}catch(D){console.error(D),l(" Error cargando inventario de pedidos.")}finally{a(!1)}})()},[]);const xe=N.useMemo(()=>t.filter(D=>{var se;const Y=D.date||((se=D.createdAt)!=null&&se.toDate?D.createdAt.toDate().toISOString().slice(0,10):"");return!(!Y||c&&Y<c||u&&Y>u)}),[t,c,u]),Ce=N.useMemo(()=>{let D=0,Y=0,se=0,ve=0,z=0,Oe=0;for(const te of xe){D+=te.totalPackages,Y+=te.subtotal,se+=te.totalRivas,ve+=te.totalSanJorge,z+=te.totalIsla;const J=r[te.id];J&&(Oe+=J.remainingPackages)}return{totalPaquetes:D,totalSubtotal:Y,totalRivas:se,totalSJ:ve,totalIsla:z,totalPaquetesRestantes:Oe,totalPedidos:xe.length}},[xe,r]),S=async(D,Y,se)=>{if(!x)return;const ve=Number(se||0),z=y.map(J=>J.id!==D?J:pC({...J,[Y]:ve}));b(z);const Oe=z.find(J=>J.id===D);if(!Oe)return;const te=E3(z);try{await kr(kt(je,"products_candies",D),{marginRivas:Oe.marginRivas,marginSanJorge:Oe.marginSanJorge,marginIsla:Oe.marginIsla,subtotal:Oe.subtotal,totalRivas:Oe.totalRivas,totalSanJorge:Oe.totalSanJorge,totalIsla:Oe.totalIsla,unitPriceRivas:Oe.unitPriceRivas,unitPriceSanJorge:Oe.unitPriceSanJorge,unitPriceIsla:Oe.unitPriceIsla,gainRivas:Oe.gainRivas,gainSanJorge:Oe.gainSanJorge,gainIsla:Oe.gainIsla}),await kr(kt(je,"candy_main_orders",x.id),{totalPackages:te.totalPackages,subtotal:Number(te.subtotal.toFixed(2)),totalRivas:Number(te.totalRivas.toFixed(2)),totalSanJorge:Number(te.totalSanJorge.toFixed(2)),totalIsla:Number(te.totalIsla.toFixed(2))}),g(J=>J&&{...J,totalPackages:te.totalPackages,subtotal:Number(te.subtotal.toFixed(2)),totalRivas:Number(te.totalRivas.toFixed(2)),totalSanJorge:Number(te.totalSanJorge.toFixed(2)),totalIsla:Number(te.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(J){console.error(J),l(" Error actualizando mrgenes del producto.")}},I=async()=>{if(x)try{l("");const D=Number.isFinite(F)&&F!==0?F:x.marginRivas||0,Y=Number.isFinite(R)&&R!==0?R:x.marginSanJorge||0,se=Number.isFinite(B)&&B!==0?B:x.marginIsla||0,ve=pC({id:"tmp",name:M.trim(),category:T.trim(),providerPrice:Number(Z||0),packages:Number(ae||0),unitsPerPackage:Number(de||1),marginRivas:Number(D||0),marginSanJorge:Number(Y||0),marginIsla:Number(se||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ae||0)}),z=await Wr(At(je,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:ve.name,category:ve.category,providerPrice:ve.providerPrice,packages:ve.packages,unitsPerPackage:ve.unitsPerPackage,marginRivas:ve.marginRivas,marginSanJorge:ve.marginSanJorge,marginIsla:ve.marginIsla,gainRivas:ve.gainRivas,gainSanJorge:ve.gainSanJorge,gainIsla:ve.gainIsla,subtotal:ve.subtotal,totalRivas:ve.totalRivas,totalSanJorge:ve.totalSanJorge,totalIsla:ve.totalIsla,unitPriceRivas:ve.unitPriceRivas,unitPriceSanJorge:ve.unitPriceSanJorge,unitPriceIsla:ve.unitPriceIsla,createdAt:Kt.now()}),te=[{...ve,id:z.id},...y];b(te);const J=E3(te);await kr(kt(je,"candy_main_orders",x.id),{totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),g(q=>q&&{...q,totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),P(0),_(0),E(0),k(""),U(""),pe(0),he(0),re(1),l(" Producto agregado con mrgenes por sucursal.")}catch(D){console.error(D),l(" Error agregando producto al pedido.")}},V=async D=>{try{g(D),b([]),h(!0),p(!0),l("");const Y=await Nt(Ut(At(je,"inventory_candies"),qt("orderId","==",D.id))),se={};Y.forEach(Oe=>{const te=Oe.data(),J=te.productId;if(!J)return;const q=Number(te.unitsPerPackage||1)||1,ie=Number(te.remaining??te.totalUnits??0),fe=Number(te.remainingPackages??NaN),Ie=Number.isFinite(fe)?Math.round(fe):Math.round(ie/q);se[J]=(se[J]||0)+Ie});const ve=await Nt(Ut(At(je,"products_candies"),qt("orderId","==",D.id))),z=[];ve.forEach(Oe=>{const te=Oe.data(),J=Ki(te.providerPrice,0),q=Ki(te.packages,0),ie=te.subtotal??J*q,fe=gC({margin:te.marginRivas,gain:te.gainRivas,subtotal:ie,orderMargin:D.marginRivas||0}),Ie=gC({margin:te.marginSanJorge,gain:te.gainSanJorge,subtotal:ie,orderMargin:D.marginSanJorge||0}),Ve=gC({margin:te.marginIsla,gain:te.gainIsla,subtotal:ie,orderMargin:D.marginIsla||0}),ze=pC({id:Oe.id,name:te.name??"",category:te.category??"",providerPrice:J,packages:q,unitsPerPackage:Ki(te.unitsPerPackage,1),marginRivas:Number(fe||0),marginSanJorge:Number(Ie||0),marginIsla:Number(Ve||0),subtotal:Ki(te.subtotal,0),totalRivas:Ki(te.totalRivas,0),totalSanJorge:Ki(te.totalSanJorge,0),totalIsla:Ki(te.totalIsla,0),gainRivas:Ki(te.gainRivas,0),gainSanJorge:Ki(te.gainSanJorge,0),gainIsla:Ki(te.gainIsla,0),unitPriceRivas:Ki(te.unitPriceRivas,0),unitPriceSanJorge:Ki(te.unitPriceSanJorge,0),unitPriceIsla:Ki(te.unitPriceIsla,0),remainingPackages:se[Oe.id]??Ki(te.packages,0)});z.push(ze)}),b(z)}catch(Y){console.error(Y),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>A(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:D=>d(D.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:Ce.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Ce.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Ce.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",lu(Ce.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",lu(Ce.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",lu(Ce.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",lu(Ce.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):xe.map(D=>{var te;const Y=D.totalPackages>0?Math.round(D.totalRivas/D.totalPackages):0,se=D.totalPackages>0?Math.round(D.totalSanJorge/D.totalPackages):0,ve=D.totalPackages>0?Math.round(D.totalIsla/D.totalPackages):0,z=D.date||((te=D.createdAt)!=null&&te.toDate?D.createdAt.toDate().toISOString().slice(0,10):""),Oe=r[D.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:z}),i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.totalPackages}),i.jsx("td",{className:"p-2 border",children:Oe?Oe.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Y}),i.jsx("td",{className:"p-2 border",children:se}),i.jsx("td",{className:"p-2 border",children:ve}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>V(D),children:"Ver pedido"})})]},D.id)})})]})}),f&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),g(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((j=x.createdAt)!=null&&j.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((O=r[x.id])==null?void 0:O.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((W=r[x.id])==null?void 0:W.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:lu(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:lu(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:lu(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:lu(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:F,onChange:D=>P(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:R,onChange:D=>_(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:B,onChange:D=>E(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:M,onChange:D=>k(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:T,onChange:D=>U(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:Z,onChange:D=>pe(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ae,onChange:D=>he(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:de,onChange:D=>re(Number(D.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:I,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(D=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.category}),i.jsx("td",{className:"p-2 border",children:D.packages}),i.jsx("td",{className:"p-2 border",children:D.remainingPackages??D.packages}),i.jsx("td",{className:"p-2 border",children:D.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:D.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginRivas??0,onChange:Y=>S(D.id,"marginRivas",Y.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginSanJorge??0,onChange:Y=>S(D.id,"marginSanJorge",Y.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginIsla??0,onChange:Y=>S(D.id,"marginIsla",Y.target.value)})}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:D.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:D.unitPriceIsla})]},D.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!f&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Mn=t=>Math.round((Number(t)||0)*100)/100,Df=t=>Math.round((Number(t)||0)*1e3)/1e3,go=t=>Number(t??0).toFixed(2),D1=t=>Number(t??0).toFixed(3),E1e=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?rr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",a=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,A=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),g=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(g||0)>0&&(y=Mn(c*Number(g||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:Mn(g),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:a,vendorId:o,vendorCommissionAmount:y,processedDate:A||""}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0;let f=0;return f=Mn(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:u,amount:d,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:a,vendorId:o,vendorCommissionAmount:f,processedDate:A||""}]};function B1e({role:t,currentUserEmail:e,sellerCandyId:r}){const[n,s]=N.useState([]),[a,o]=N.useState(null),[l,c]=N.useState(!0),[A,u]=N.useState(""),[d,f]=N.useState("ALL"),h=rr(new Date,"yyyy-MM-dd"),[m,p]=N.useState(h),[x,g]=N.useState(h),[y,b]=N.useState("ALL"),[F,P]=N.useState(null),[R,_]=N.useState(0),[B,E]=N.useState(0),[M,k]=N.useState(""),[T,U]=N.useState(0),[Z,pe]=N.useState("0"),ae=N.useRef(null),he=!t||t==="admin",de=t==="vendedor_dulces",re=(e||"").trim().toLowerCase(),[xe,Ce]=N.useState([]);N.useEffect(()=>{if(!m||!x)return;c(!0);const Fe=Ut(At(je,"sales_candies"),qt("date",">=",m),qt("date","<=",x),Rr("date","asc")),Ge=M0(Fe,_e=>{const G=[];_e.forEach(Ne=>{const Ue=E1e(Ne.data(),Ne.id);G.push(...Ue)}),s(G),c(!1)},_e=>{console.error("Error cargando ventas por periodo:",_e),s([]),c(!1)});return()=>Ge()},[m,x]),N.useEffect(()=>{(async()=>{const Ge=Ut(At(je,"daily_closures_candies"),qt("date","==",h)),_e=await Nt(Ge);if(_e.empty)o(null);else{const G=_e.docs[0];o({id:G.id,...G.data()})}})()},[h]),N.useEffect(()=>{(async()=>{try{const Ge=await Nt(At(je,"sellers_candies")),_e=[];Ge.forEach(G=>{const Ne=G.data();_e.push({id:G.id,name:Ne.name||"",commissionPercent:Number(Ne.commissionPercent||0)})}),Ce(_e)}catch(Ge){console.error("Error cargando sellers_candies",Ge)}})()},[]);const S=Fe=>Mn(Number(Fe.vendorCommissionAmount??0)||0),I=ci.useMemo(()=>{let Fe=[...n];return d==="FLOTANTE"&&(Fe=Fe.filter(Ge=>Ge.status==="FLOTANTE")),d==="PROCESADA"&&(Fe=Fe.filter(Ge=>Ge.status==="PROCESADA")),he&&y!=="ALL"&&(Fe=Fe.filter(Ge=>(Ge.vendorId||"")===y)),de&&(r?Fe=Fe.filter(Ge=>(Ge.vendorId||"")===r):re?Fe=Fe.filter(Ge=>(Ge.sellerEmail||"").toLowerCase()===re):Fe=[]),Fe},[d,n,he,y,de,r,re]),V=ci.useMemo(()=>I.filter(Fe=>Fe.status==="FLOTANTE").length,[I]),j=ci.useMemo(()=>I.filter(Fe=>Fe.status==="PROCESADA").length,[I]),O=ci.useMemo(()=>I.filter(Fe=>Fe.type==="CREDITO").length,[I]),W=ci.useMemo(()=>I.filter(Fe=>Fe.type!=="CREDITO").length,[I]);Df(I.reduce((Fe,Ge)=>Fe+(Ge.quantity||0),0));const D=Mn(I.reduce((Fe,Ge)=>Fe+Number(Ge.cogsAmount??0),0)),Y=Mn(I.reduce((Fe,Ge)=>Fe+(Ge.amount||0),0)),se=Mn(Y-D);let ve=0,z=0,Oe=0,te=0,J=0,q=0,ie=0;I.forEach(Fe=>{const Ge=Number(Fe.amount||0),_e=Number(Fe.amountReceived||0),G=S(Fe);J+=G,Fe.type==="CREDITO"?(ve+=Fe.quantity||0,Oe+=Ge-_e,ie+=G):(z+=Fe.quantity||0,te+=Ge,q+=G)}),Oe=Mn(Oe),te=Mn(te),J=Mn(J),q=Mn(q),ie=Mn(ie);const fe=ci.useMemo(()=>{const Fe={};for(const Ge of I){const _e=(Ge.vendorId||"").trim();if(!_e||Ge.type==="CREDITO")continue;const G=S(Ge);if(!Fe[_e]){const Ne=xe.find(Ue=>Ue.id===_e);Fe[_e]={vendorId:_e,name:(Ne==null?void 0:Ne.name)||Ge.userEmail||"(sin vendedor)",total:0}}Fe[_e].total=Mn(Fe[_e].total+G)}return Object.values(Fe).filter(Ge=>Ge.total>0).sort((Ge,_e)=>_e.total-Ge.total)},[I,xe]),Ie=ci.useMemo(()=>{const Fe={};for(const Ge of I){const _e=(Ge.vendorId||"").trim();if(!_e||Ge.type!=="CREDITO")continue;const G=S(Ge);if(!Fe[_e]){const Ne=xe.find(Ue=>Ue.id===_e);Fe[_e]={vendorId:_e,name:(Ne==null?void 0:Ne.name)||Ge.userEmail||"(sin vendedor)",total:0}}Fe[_e].total=Mn(Fe[_e].total+G)}return Object.values(Fe).filter(Ge=>Ge.total>0).sort((Ge,_e)=>_e.total-Ge.total)},[I,xe]),Ve={};I.forEach(Fe=>{const Ge=Fe.productName||"(sin nombre)";Ve[Ge]||(Ve[Ge]={totalQuantity:0,totalAmount:0,totalCommission:0}),Ve[Ge].totalQuantity=Df(Ve[Ge].totalQuantity+(Fe.quantity||0)),Ve[Ge].totalAmount=Mn(Ve[Ge].totalAmount+(Fe.amount||0)),Ve[Ge].totalCommission=Mn(Ve[Ge].totalCommission+S(Fe))});const ze=Object.entries(Ve).map(([Fe,Ge])=>({productName:Fe,totalQuantity:Ge.totalQuantity,totalAmount:Ge.totalAmount,totalCommission:Ge.totalCommission})),Ye=async()=>{if(he)try{const Fe=I.filter(Be=>Be.status==="FLOTANTE");if(Fe.length===0){u("No hay ventas flotantes para procesar en este perodo.");return}const Ge={totalCharged:Mn(Fe.reduce((Be,Qe)=>Be+(Qe.amount||0),0)),totalSuggested:Mn(Fe.reduce((Be,Qe)=>Be+(Qe.amountSuggested||0),0)),totalUnits:Df(Fe.reduce((Be,Qe)=>Be+(Qe.quantity||0),0)),totalCOGS:Mn(Fe.reduce((Be,Qe)=>Be+Number(Qe.cogsAmount??0),0))},_e=Mn(Ge.totalCharged-Ge.totalSuggested),G=Mn(Ge.totalCharged-Ge.totalCOGS),Ne=Fe.reduce((Be,Qe)=>{const Te=Number(Qe.quantity||0),We=Number(Qe.amount||0),at=Number(Qe.vendorCommissionAmount||0);return Qe.type==="CREDITO"?(Be.packsCredit+=Te,Be.amountCredit+=We,Be.comCredit+=at):(Be.packsCash+=Te,Be.amountCash+=We,Be.comCash+=at),Be},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),Ue={totalPacksCash:Df(Ne.packsCash),totalPacksCredit:Df(Ne.packsCredit),totalAmountCash:Mn(Ne.amountCash),totalAmountCredit:Mn(Ne.amountCredit),totalCommissionCash:Mn(Ne.comCash),totalCommissionCredit:Mn(Ne.comCredit)},$e=await Wr(At(je,"daily_closures_candies"),{date:h,createdAt:Kt.now(),periodStart:m,periodEnd:x,totalCharged:Ge.totalCharged,totalSuggested:Ge.totalSuggested,totalDifference:_e,totalUnits:Ge.totalUnits,totalCOGS:Ge.totalCOGS,grossProfit:G,...Ue,products:Fe.map(Be=>({productName:Be.productName,quantity:Be.quantity,amount:Be.amount})),sales:Fe.map(Be=>({id:Be.id,productName:Be.productName,quantity:Be.quantity,amount:Be.amount,amountSuggested:Be.amountSuggested,userEmail:Be.userEmail,clientName:Be.clientName,amountReceived:Be.amountReceived,change:Be.change,status:Be.status,cogsAmount:Be.cogsAmount??0,avgUnitCost:Be.avgUnitCost??null,allocations:Be.allocations??[],date:Be.date,type:Be.type??"CONTADO",vendorId:Be.vendorId??"",vendorCommissionAmount:Number(Be.vendorCommissionAmount??0)||0,processedDate:h})),productSummary:Object.entries(Fe.reduce((Be,Qe)=>{const Te=Qe.productName||"(sin nombre)";return Be[Te]||(Be[Te]={totalQuantity:0,totalAmount:0}),Be[Te].totalQuantity=Df(Be[Te].totalQuantity+(Qe.quantity||0)),Be[Te].totalAmount=Mn(Be[Te].totalAmount+(Qe.amount||0)),Be},{})).map(([Be,Qe])=>({productName:Be,totalQuantity:Qe.totalQuantity,totalAmount:Qe.totalAmount}))}),ge=Gh(je);Fe.forEach(Be=>{ge.update(kt(je,"sales_candies",Be.id.split("#")[0]),{status:"PROCESADA",closureId:$e.id,closureDate:h,processedDate:h,processedAt:Kt.now()})}),await ge.commit(),u(` Cierre guardado. Ventas procesadas: ${Fe.length}. (Proceso: ${h})`)}catch(Fe){console.error(Fe),u(" Error al guardar el cierre de dulces.")}},ct=async Fe=>{if(he&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await kr(kt(je,"sales_candies",Fe.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),u(" Venta revertida a FLOTANTE.")}catch(Ge){console.error(Ge),u(" No se pudo revertir la venta.")}},st=Fe=>{he&&(P(Fe),_(Fe.quantity),E(Fe.amount),k(Fe.clientName),U(Fe.amountReceived),pe(Fe.change))},ft=async()=>{if(!(!F||!he))try{await kr(kt(je,"sales_candies",F.id.split("#")[0]),{packagesTotal:R,amount:B,amountCharged:B,clientName:M,amountReceived:T,change:Z}),P(null),u(" Venta de dulces actualizada.")}catch(Fe){console.error(Fe),u(" No se pudo actualizar la venta de dulces.")}},nt=async Fe=>{if(he&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const{restored:Ge}=await Wve(Fe.split("#")[0]);u(` Venta eliminada. Stock restaurado (unidades internas): ${Number(Ge).toFixed(2)}.`)}catch(Ge){console.error(Ge),u(" No se pudo eliminar la venta de dulces.")}},De=async()=>{if(ae.current){ae.current.classList.add("force-pdf-colors");try{const Ge=(await $h(ae.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),_e=new sr;_e.addImage(Ge,"PNG",10,10,190,0),_e.save(`cierre_dulces_${m}_a_${x}_proc_${h}.pdf`)}finally{ae.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",h]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:Fe=>p(Fe.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:Fe=>g(Fe.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:d,onChange:Fe=>f(Fe.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),he&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:y,onChange:Fe=>b(Fe.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),xe.map(Fe=>i.jsx("option",{value:Fe.id,children:Fe.name||Fe.id},Fe.id))]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:V}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:j}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:O}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:W}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",go(q)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",go(ie)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),fe.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:fe.map(Fe=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Fe.name}),i.jsxs("strong",{className:"ml-2",children:["C$",go(Fe.total)]})]},Fe.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),Ie.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Ie.map(Fe=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Fe.name}),i.jsxs("strong",{className:"ml-2",children:["C$",go(Fe.total)]})]},Fe.vendorId))})]})]}),l?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:ae,children:[i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[I.map(Fe=>{const Ge=S(Fe),_e=(Fe.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Fe.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Fe.status})}),i.jsx("td",{className:"border p-1",children:Fe.productName}),i.jsx("td",{className:"border p-1",children:Fe.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:D1(Fe.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",go(Fe.amount)]}),i.jsx("td",{className:"border p-1",children:Ge>0?`C$${go(Ge)}`:""}),i.jsx("td",{className:"border p-1",children:Fe.date}),i.jsx("td",{className:"border p-1",children:_e||""}),i.jsx("td",{className:"border p-1",children:Fe.userEmail}),i.jsx("td",{className:"border p-1",children:Fe.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:he?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>st(Fe),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>nt(Fe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):Fe.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:he?i.jsx("button",{onClick:()=>ct(Fe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},Fe.id)}),I.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:D1(ve)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:D1(z)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",go(Oe)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",go(te)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",go(J)]})]})]}),(D>0||se!==Y)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",go(D)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",go(se)]})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsxs("tbody",{children:[ze.map(Fe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Fe.productName}),i.jsx("td",{className:"border p-1",children:D1(Fe.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",go(Fe.totalAmount)]}),i.jsx("td",{className:"border p-1",children:Fe.totalCommission>0?`C$${go(Fe.totalCommission)}`:""})]},Fe.productName)),ze.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[he&&i.jsx("button",{onClick:Ye,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),i.jsx("button",{onClick:De,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),F&&he&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[F.productName,"  ",F.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:R,onChange:Fe=>_(parseFloat(Fe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:Fe=>E(parseFloat(Fe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:M,onChange:Fe=>k(Fe.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:T,onChange:Fe=>U(parseFloat(Fe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:Z,onChange:Fe=>pe(Fe.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>P(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:ft,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Xc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,xo=t=>Math.round((Number(t)||0)*100)/100;function S1e(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function I1e(t){return t.toISOString().slice(0,10)}function F1e(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function k1e(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return I1e(r)}function T1e(){const[t,e]=N.useState(F1e()),[r,n]=N.useState(k1e()),[s,a]=N.useState(!1),[o,l]=N.useState(""),[c,A]=N.useState({}),[u,d]=N.useState({}),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState({}),[y,b]=N.useState(!1),[F,P]=N.useState(null),[R,_]=N.useState(null),B=N.useMemo(()=>F&&f.find(ae=>ae.vendorId===F)||null,[F,f]),E=N.useMemo(()=>{var ae;return!F||!R?[]:((ae=x[F])==null?void 0:ae[R])||[]},[F,R,x]),M=N.useMemo(()=>xo(f.reduce((ae,he)=>ae+(he.totalSoldMoney||0),0)),[f]),k=N.useMemo(()=>xo(f.reduce((ae,he)=>ae+(he.totalCreditMoney||0),0)),[f]);N.useEffect(()=>{(async()=>{try{const ae=await Nt(At(je,"sellers_candies")),he={};ae.forEach(xe=>{const Ce=xe.data(),S=Ce.branch||"Rivas";let I="RIVAS";S==="San Jorge"?I="SAN_JORGE":S==="Isla Ometepe"&&(I="ISLA"),he[xe.id]={id:xe.id,name:Ce.name??"(sin nombre)",branch:I,branchLabel:S,commissionPercent:Number(Ce.commissionPercent??0)}});const de=await Nt(At(je,"products_candies")),re={};de.forEach(xe=>{const Ce=xe.data();re[xe.id]={id:xe.id,name:Ce.name??"(sin nombre)"}}),A(he),d(re)}catch(ae){console.error(ae),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const T=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}a(!0),l("");try{const ae={},he={},de=Ut(At(je,"inventory_candies_sellers"),qt("date",">=",t),qt("date","<=",r)),re=await Nt(de),xe={},Ce={},S={},I={};re.forEach(ie=>{var bt,ot;const fe=ie.data(),Ie=fe.sellerId||"";if(!Ie)return;const Ve=fe.productId||"",ze=fe.productName||((bt=u[Ve])==null?void 0:bt.name)||"(sin nombre)",Ye=Math.max(1,Math.floor(Number(fe.unitsPerPackage||1))),ct=Number(fe.totalUnits??0),st=Number(fe.packages??0),ft=Number(fe.remainingUnits??fe.remaining??0),nt=Number(fe.remainingPackages??0),De=st>0?st:ct>0?Math.floor(ct/Ye):0,Fe=nt>0?nt:ft>0?Math.floor(ft/Ye):0;xe[Ie]=(xe[Ie]||0)+De,Ce[Ie]=(Ce[Ie]||0)+Fe;const Ge=fe.orderId||fe.vendorOrderId||fe.orderNumber||fe.order||ie.id;S[Ie]||(S[Ie]=new Set),S[Ie].add(Ge);const _e=((ot=c[Ie])==null?void 0:ot.name)||fe.sellerName||"(sin vendedor)",G=String(fe.date||""),Ne=Number(fe.totalVendor??0),Ue=Number(fe.gainVendor??0),$e=st>0?st:ct>0?Math.floor(ct/Ye):0,ge=$e>0?Ne/$e:0,Be=$e>0?Ue/$e:0,Qe=xo(De*ge),Te=xo(De*Be),We=xo(Fe*ge),at=xo(Fe*Be);I[Ie]||(I[Ie]={ordered:[],remaining:[]}),De>0&&I[Ie].ordered.push({date:G,vendorName:_e,productName:ze,packages:De,totalMoney:Qe,vendorCommission:Te}),Fe>0&&I[Ie].remaining.push({date:G,vendorName:_e,productName:ze,packages:Fe,totalMoney:We,vendorCommission:at})});const V={};Object.keys(S).forEach(ie=>{V[ie]=S[ie].size});const j=Ut(At(je,"sales_candies"),qt("date",">=",t),qt("date","<=",r)),O=await Nt(j),W={},D={},Y={},se={},ve={},z={};O.forEach(ie=>{const fe=ie.data(),Ie=fe.date||"",Ve=fe.vendorId||fe.sellerId||"";if(!Ve)return;const ze=c[Ve],Ye=fe.vendorName||(ze==null?void 0:ze.name)||"(sin vendedor)",ct=Number(fe.vendorCommissionPercent??(ze==null?void 0:ze.commissionPercent)??0)||0,st=Array.isArray(fe.items)?fe.items:[];if(!st.length)return;const ft=String(fe.type||"").toUpperCase()==="CREDITO";ve[Ve]||(ve[Ve]={sold:[],credit:[]}),st.forEach(nt=>{var Qe;const De=nt.productName||((Qe=u[nt.productId||""])==null?void 0:Qe.name)||"(sin nombre)",Fe=nt.packages??nt.qty??nt.quantity??0,Ge=Number(Fe||0);if(Ge<=0)return;const _e=Number(nt.unitPricePackage??nt.unitPrice??0)||0,G=Math.max(0,Number(nt.discount||0)),Ne=Ge*_e,Ue=xo(Math.max(0,Ne-G));if(Ue<=0)return;console.log("DBG",{isCredit:ft,vendorId:Ve,commissionPercent:ct,lineFinal:Ue,storedItemCommission:Number(nt.vendorCommissionAmount??0)});let $e=0;const ge=Number(nt.vendorCommissionAmount??0);ge?$e=xo(ge):ct>0&&($e=xo(Ue*ct/100)),ft?(D[Ve]=(D[Ve]||0)+Ge,se[Ve]=(se[Ve]||0)+Ue):(W[Ve]=(W[Ve]||0)+Ge,Y[Ve]=(Y[Ve]||0)+Ue),ft?he[Ve]=(he[Ve]||0)+$e:ae[Ve]=(ae[Ve]||0)+$e,ft?ve[Ve].credit.push({date:Ie,vendorName:Ye,productName:De,packages:Ge,totalMoney:Ue,vendorCommission:0}):ve[Ve].sold.push({date:Ie,vendorName:Ye,productName:De,packages:Ge,totalMoney:Ue,vendorCommission:$e});const Be=De;z[Be]||(z[Be]={productName:De,packages:0,totalMoney:0}),z[Be].packages+=Ge,z[Be].totalMoney+=Ue})});const Oe=new Set([...Object.keys(xe),...Object.keys(Ce),...Object.keys(W),...Object.keys(D)]),te=[],J={};Oe.forEach(ie=>{var Fe,Ge,_e,G;const fe=c[ie],Ie=(fe==null?void 0:fe.name)||"(sin vendedor)",Ve=fe?fe.branchLabel||S1e(fe.branch):"",ze=xe[ie]||0,Ye=Ce[ie]||0,ct=W[ie]||0,st=D[ie]||0,ft=xo(Y[ie]||0),nt=xo(se[ie]||0),De=V[ie]||0;te.push({vendorId:ie,vendorName:Ie,branchLabel:Ve,orderedPackages:ze,remainingPackages:Ye,soldPackages:ct,creditPackages:st,totalSoldMoney:ft,totalCreditMoney:nt,ordersCreated:De,commissionCash:xo(ae[ie]||0),commissionCredit:0}),J[ie]={ordered:(((Fe=I[ie])==null?void 0:Fe.ordered)||[]).sort((Ne,Ue)=>Ne.date.localeCompare(Ue.date)),remaining:(((Ge=I[ie])==null?void 0:Ge.remaining)||[]).sort((Ne,Ue)=>Ne.date.localeCompare(Ue.date)),sold:(((_e=ve[ie])==null?void 0:_e.sold)||[]).sort((Ne,Ue)=>Ne.date.localeCompare(Ue.date)),credit:(((G=ve[ie])==null?void 0:G.credit)||[]).sort((Ne,Ue)=>Ne.date.localeCompare(Ue.date))}}),te.sort((ie,fe)=>ie.vendorName.localeCompare(fe.vendorName,"es")),h(te),g(J);const q=Object.values(z).map(ie=>({productName:ie.productName,packages:ie.packages,totalMoney:xo(ie.totalMoney)})).sort((ie,fe)=>fe.packages-ie.packages).slice(0,10);p(q),te.length||l("Sin datos para el rango seleccionado.")}catch(ae){console.error(ae),l(" Error cargando consolidado de vendedores.")}finally{a(!1)}};N.useEffect(()=>{Object.keys(c).length&&T()},[c]);const U=(ae,he)=>{P(ae),_(he),b(!0)},Z=()=>{b(!1),P(null),_(null)},pe=()=>{if(!f.length){l("No hay datos para exportar.");return}const ae=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],he=f.map(S=>[S.vendorName,S.branchLabel,S.orderedPackages.toString(),S.remainingPackages.toString(),S.soldPackages.toString(),S.creditPackages.toString(),S.totalSoldMoney.toFixed(2),S.commissionCash.toFixed(2),S.totalCreditMoney.toFixed(2),S.commissionCredit.toFixed(2),S.ordersCreated.toString()]),de=[ae,...he].map(S=>S.map(I=>`"${String(I).replace(/"/g,'""')}"`).join(",")).join(`
`),re=new Blob([de],{type:"text/csv;charset=utf-8;"}),xe=URL.createObjectURL(re),Ce=document.createElement("a");Ce.href=xe,Ce.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Ce.click(),URL.revokeObjectURL(xe)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ae=>e(ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ae=>n(ae.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:s,children:s?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:pe,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Xc(M)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Xc(k)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:f.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[f.map(ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ae.vendorName}),i.jsx("td",{className:"border p-1",children:ae.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>U(ae.vendorId,"ordered"),children:ae.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>U(ae.vendorId,"remaining"),children:ae.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>U(ae.vendorId,"sold"),children:ae.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>U(ae.vendorId,"credit"),children:ae.creditPackages})}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Xc(ae.commissionCash)}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Xc(ae.commissionCredit)}),i.jsx("td",{className:"border p-1",children:ae.ordersCreated})]},ae.vendorId)),f.length===0&&!s&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((ae,he)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:he+1}),i.jsx("td",{className:"border p-1",children:ae.productName}),i.jsx("td",{className:"border p-1",children:ae.packages}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalMoney)})]},ae.productName)),m.length===0&&!s&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&R&&F&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",R==="ordered"?"Paquetes ordenados":R==="remaining"?"Paquetes restantes":R==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[B==null?void 0:B.vendorName,"  ",B==null?void 0:B.branchLabel]})]}),i.jsx("button",{onClick:Z,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[E.map((ae,he)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ae.date}),i.jsx("td",{className:"border p-1",children:ae.productName}),i.jsx("td",{className:"border p-1",children:ae.packages}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalMoney)}),i.jsx("td",{className:"border p-1",children:ae.vendorName}),i.jsx("td",{className:"border p-1",children:Xc(ae.vendorCommission)})]},he)),E.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const ii=t=>`C$${Number(t||0).toFixed(2)}`,L1=t=>Number(t||0).toFixed(3),xC=()=>{const t=new Date;return rr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},U1=()=>rr(new Date,"yyyy-MM-dd");function j1e({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,a]=N.useState([]),o=N.useMemo(()=>{const Te={};return s.forEach(We=>{We.email&&(Te[We.email.trim().toLowerCase()]=We)}),Te},[s]);N.useEffect(()=>{(async()=>{try{const Te=Ut(At(je,"sellers_candies"),Rr("name","asc")),We=await Nt(Te),at=[];We.forEach(bt=>{const ot=bt.data();at.push({id:bt.id,name:ot.name||"",email:ot.email||"",commissionPercent:Number(ot.commissionPercent||0)})}),a(at)}catch(Te){console.error(Te)}})()},[]);const[l,c]=N.useState(xC()),[A,u]=N.useState(U1()),[d,f]=N.useState(""),[h,m]=N.useState(""),p=N.useMemo(()=>{const Te=new Map;return n.forEach(We=>{const at=We.productId||We.productName;Te.set(at,{key:at,name:We.productName})}),Array.from(Te.values()).sort((We,at)=>We.name.localeCompare(at.name))},[n]),x=N.useMemo(()=>{const Te=new Map;return n.forEach(We=>{const at=(We.sellerEmail||"").trim().toLowerCase();if(!at)return;const bt=o[at],ot=(bt==null?void 0:bt.name)||We.vendorName||at;Te.set(at,{email:at,label:ot})}),Array.from(Te.values()).sort((We,at)=>We.label.localeCompare(at.label))},[n,o]),g=N.useMemo(()=>n.filter(Te=>!(l&&Te.date<l||A&&Te.date>A||d&&(Te.productId||Te.productName)!==d||h&&(Te.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,A,d,h]),[y,b]=N.useState(U1()),[F,P]=N.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[R,_]=N.useState(""),[B,E]=N.useState("0"),[M,k]=N.useState(()=>g.map(Te=>Te.id));N.useEffect(()=>{k(Te=>Te.filter(We=>g.some(at=>at.id===We)))},[g]);const[T,U]=N.useState([]),[Z,pe]=N.useState([]),[ae,he]=N.useState(!1),[de,re]=N.useState(xC()),[xe,Ce]=N.useState(U1());N.useEffect(()=>{(async()=>{try{he(!0);const Te=Ut(At(je,"expensesCandies"),Rr("date","desc")),We=await Nt(Te),at=[];We.forEach(bt=>{const ot=bt.data();at.push({id:bt.id,date:ot.date,description:ot.description,amount:Number(ot.amount||0)})}),U(at)}catch(Te){console.error(Te)}finally{he(!1)}})()},[]);const S=N.useMemo(()=>T.filter(Te=>!(!Te.date||de&&Te.date<de||xe&&Te.date>xe)),[T,de,xe]),[I,V]=N.useState([]),[j,O]=N.useState(!1),[W,D]=N.useState(""),[Y,se]=N.useState("DEBITO"),[ve,z]=N.useState(""),Oe=()=>{const Te=Number(ve);!W.trim()||!isFinite(Te)||Te<=0||(V(We=>[...We,{id:`${Date.now()}_${We.length+1}`,description:W.trim(),type:Y,amount:Number(Te.toFixed(2))}]),D(""),z(""))},[te,J]=N.useState(null),[q,ie]=N.useState(""),[fe,Ie]=N.useState("DEBITO"),[Ve,ze]=N.useState(""),Ye=Te=>{J(Te.id),ie(Te.description),Ie(Te.type),ze(Te.amount.toFixed(2))},ct=()=>{J(null),ie(""),Ie("DEBITO"),ze("")},st=()=>{if(!te)return;const Te=Number(Ve);!isFinite(Te)||Te<=0||(V(We=>We.map(at=>at.id===te?{...at,description:q.trim(),type:fe,amount:Number(Te.toFixed(2))}:at)),ct())},ft=Te=>{V(We=>We.filter(at=>at.id!==Te)),te===Te&&ct()},nt=(Te,We)=>{k(at=>We?[...new Set([...at,Te])]:at.filter(bt=>bt!==Te))},De=Te=>{k(Te?g.map(We=>We.id):[])},Fe=(Te,We)=>{pe(at=>We?[...new Set([...at,Te])]:at.filter(bt=>bt!==Te))},Ge=N.useMemo(()=>g.filter(Te=>M.includes(Te.id)),[g,M]),_e=N.useMemo(()=>I.filter(Te=>Te.type==="DEBITO").reduce((Te,We)=>Te+We.amount,0),[I]),G=N.useMemo(()=>I.filter(Te=>Te.type==="CREDITO").reduce((Te,We)=>Te+We.amount,0),[I]),Ne=N.useMemo(()=>{let Te=0,We=0,at=0,bt=0;for(const xr of Ge){const er=Number(xr.packages||0),et=Number(xr.cogsAmount||0),gt=Number(xr.amount||0);Te+=er,We+=et,at+=gt;const Pt=(xr.sellerEmail||"").trim().toLowerCase(),Ft=o[Pt],Tt=Number((Ft==null?void 0:Ft.commissionPercent)||0),Xt=gt*Tt/100;bt+=Xt}const ot=S.filter(xr=>Z.includes(xr.id)).reduce((xr,er)=>xr+Number(er.amount||0),0),wt=at-We,Lt=at-ot-_e+G-bt,Ar=Number(B||0),ir=at*Ar/100;return{totalPackages:Number(L1(Te)),totalProvider:Number(We.toFixed(2)),totalSale:Number(at.toFixed(2)),totalGastos:Number(ot.toFixed(2)),debits:Number(_e.toFixed(2)),credits:Number(G.toFixed(2)),grossProfit:Number(wt.toFixed(2)),finalAmount:Number(Lt.toFixed(2)),totalCommissionVendors:Number(bt.toFixed(2)),branchProfit:Number(ir.toFixed(2)),branchFactor:Ar}},[Ge,S,Z,_e,G,o,B]),[Ue,$e]=N.useState(!1),[ge,Be]=N.useState(""),Qe=async()=>{if(Be(""),Ge.length===0){Be("Selecciona al menos 1 transaccin procesada.");return}try{$e(!0);const Te={number:F.trim(),date:y,description:R.trim(),status:"PENDIENTE",createdAt:Kt.now(),totalPackages:Ne.totalPackages,totalProvider:Ne.totalProvider,totalSale:Ne.totalSale,totalExpenses:Ne.totalGastos,totalDebits:Ne.debits,totalCredits:Ne.credits,grossProfit:Ne.grossProfit,totalCommissionVendors:Ne.totalCommissionVendors,branchFactorPercent:Ne.branchFactor,branchProfit:Ne.branchProfit,finalAmount:Ne.finalAmount,transactions:Ge.map(We=>{const at=Number(We.packages||0)||1,bt=Number(We.cogsAmount||0),ot=Number(We.amount||0),wt=bt/at,Lt=ot/at,Ar=(We.sellerEmail||"").trim().toLowerCase(),ir=o[Ar],xr=Number((ir==null?void 0:ir.commissionPercent)||0),er=ot*xr/100;return{id:We.id,date:We.date,productId:We.productId||null,productName:We.productName,vendorName:We.vendorName,sellerEmail:We.sellerEmail||null,packages:Number(L1(We.packages)),providerPricePack:Number(wt.toFixed(4)),salePricePack:Number(Lt.toFixed(4)),totalProvider:Number(bt.toFixed(2)),totalSale:Number(ot.toFixed(2)),commissionPercent:xr,commissionAmount:Number(er.toFixed(2))}}),expenses:S.filter(We=>Z.includes(We.id)).map(We=>({id:We.id,date:We.date||null,description:We.description||"",amount:Number(Number(We.amount||0).toFixed(2))})),adjustments:I.map(We=>({id:We.id,description:We.description,type:We.type,amount:Number(We.amount.toFixed(2))}))};await Wr(At(je,"invoicesCandies"),Te),Be(" Factura de dulces creada."),r()}catch(Te){console.error(Te),Be(` Error al crear factura: ${(Te==null?void 0:Te.message)||"desconocido"}`)}finally{$e(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:Te=>b(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:F,onChange:Te=>P(Te.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:Te=>E(Te.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:R,onChange:Te=>_(Te.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:Te=>c(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:Te=>u(Te.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:d,onChange:Te=>f(Te.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(Te=>i.jsx("option",{value:Te.key,children:Te.name},Te.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:Te=>m(Te.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(Te=>i.jsx("option",{value:Te.email,children:Te.label},Te.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(xC()),u(U1()),f(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:g.length>0&&M.length===g.length,onChange:Te=>De(Te.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),g.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:g.map(Te=>{const We=M.includes(Te.id),at=Number(Te.packages||0)||1,bt=Number(Te.cogsAmount||0),ot=Number(Te.amount||0),wt=bt/at,Lt=ot/at,Ar=(Te.sellerEmail||"").trim().toLowerCase(),ir=o[Ar],xr=Number((ir==null?void 0:ir.commissionPercent)||0),er=ot*xr/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:We,onChange:et=>nt(Te.id,et.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Te.date}),i.jsx("td",{className:"p-2 border",children:(ir==null?void 0:ir.name)||Te.vendorName}),i.jsx("td",{className:"p-2 border",children:Te.productName}),i.jsx("td",{className:"p-2 border",children:L1(Te.packages)}),i.jsx("td",{className:"p-2 border",children:ii(wt)}),i.jsx("td",{className:"p-2 border",children:ii(Lt)}),i.jsx("td",{className:"p-2 border",children:ii(bt)}),i.jsx("td",{className:"p-2 border",children:ii(ot)}),i.jsx("td",{className:"p-2 border",children:xr>0?`${ii(er)} (${xr.toFixed(2)}%)`:""})]},Te.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ae&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:de,onChange:Te=>re(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:xe,onChange:Te=>Ce(Te.target.value)})]})]})]}),S.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:S.map(Te=>{const We=Z.includes(Te.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:We,onChange:at=>Fe(Te.id,at.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Te.date||""}),i.jsx("td",{className:"p-2 border",children:Te.description||""}),i.jsx("td",{className:"p-2 border",children:ii(Number(Te.amount||0))})]},Te.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>O(!0),children:"Crear Cargo"})]}),I.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:I.map(Te=>{const We=te===Te.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:We?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:q,onChange:at=>ie(at.target.value)}):i.jsx("span",{title:Te.description,children:Te.description.length>60?`${Te.description.slice(0,60)}`:Te.description})}),i.jsx("td",{className:"p-2 border",children:We?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:fe,onChange:at=>Ie(at.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Te.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:Te.type})}),i.jsx("td",{className:"p-2 border",children:We?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:Ve,onChange:at=>ze(at.target.value)}):ii(Te.amount)}),i.jsx("td",{className:"p-2 border",children:We?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:st,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:ct,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ft(Te.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>Ye(Te),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ft(Te.id),children:"Eliminar"})]})})]},Te.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:L1(Ne.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:ii(Ne.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:ii(Ne.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:ii(Ne.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:ii(Ne.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:ii(Ne.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:ii(Ne.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:ii(Ne.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:ii(Ne.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:ii(Ne.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:Ue,onClick:Qe,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:Ue?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),ge&&i.jsx("span",{className:"text-sm ml-2",children:ge})]}),Ue&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),j&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>O(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:W,onChange:Te=>D(Te.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Y,onChange:Te=>se(Te.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:ve,onChange:Te=>z(Te.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Oe,children:"Agregar"})})]})]})})]})}const Cn=t=>`C$ ${Number(t??0).toFixed(2)}`,O1=t=>Number(t??0).toFixed(3);function vC(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),s=Number(t.totalSale??0),a=Number(t.totalCommissionVendors??0);if(e.length>0&&(s===0||r===0)){r=0,n=0,s=0,a=0;for(const g of e){const y=Number(g.packages??0);r+=y,n+=Number(g.totalProvider??y*(g.providerPricePack??0)),s+=Number(g.totalSale??y*(g.salePricePack??0));const b=g.commissionAmount??Number(g.totalSale??0)*Number(g.commissionPercent??0)/100;a+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((g,y)=>g+Number(y.amount||0),0),A=l.filter(g=>g.type==="DEBITO").reduce((g,y)=>g+Number(y.amount||0),0),u=l.filter(g=>g.type==="CREDITO").reduce((g,y)=>g+Number(y.amount||0),0),d=t.totalDebits!==void 0?Number(t.totalDebits):A,f=t.totalCredits!==void 0?Number(t.totalCredits):u,h=s-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):s-a-c-d+f;return{totalPackages:r,totalProvider:n,totalSale:s,commissionTotal:a,expenses:c,debits:d,credits:f,grossProfit:h,branchProfit:p,finalAmount:x}}function B3(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function P1e(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(null),o=N.useRef(null),[l,c]=N.useState(!1),A=async()=>{n(!0);const h=Ut(At(je,"invoicesCandies"),Rr("date","desc")),m=await Nt(h),p=[];m.forEach(x=>{const g=x.data();p.push({id:x.id,date:g.date,number:g.number,description:g.description,status:g.status||"PENDIENTE",totalPackages:g.totalPackages||0,totalProvider:g.totalProvider||0,totalSale:g.totalSale||0,totalExpenses:g.totalExpenses||0,totalDebits:g.totalDebits||0,totalCredits:g.totalCredits||0,totalCommissionVendors:g.totalCommissionVendors||0,finalAmount:g.finalAmount||0,branchFactorPercent:g.branchFactorPercent||0,branchProfit:g.branchProfit||0,transactions:(g.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(g.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(g.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};N.useEffect(()=>{A()},[]);const u=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await kr(kt(je,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(s==null?void 0:s.id)===h.id&&a({...h,status:m})},d=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await un(kt(je,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(s==null?void 0:s.id)===h.id&&a(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},f=async()=>{if(!o.current||!s)return;const h=o.current,m=await $h(h,{backgroundColor:"#ffffff",onclone:b=>{const F=b.body;F.style.background="#ffffff",F.querySelectorAll("*").forEach(P=>{const R=b.defaultView.getComputedStyle(P);R.boxShadow&&R.boxShadow!=="none"&&(P.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new sr("p","mm","a4"),g=x.internal.pageSize.getWidth(),y=m.height*g/m.width;x.addImage(p,"PNG",0,0,g,y),x.save(`factura_candy_${s.number||s.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(j1e,{onClose:()=>c(!1),onCreated:()=>{c(!1),A()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=vC(h),p=B3(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:O1(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>a(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>u(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>d(h),children:"Eliminar"})]})})]},h.id)})})]})}),s&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>a(null),children:"Cerrar"}),i.jsx("button",{onClick:f,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=vC(s),m=B3(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",O1(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Cn(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Cn(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Cn(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Cn(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Cn(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Cn(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Cn(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(s.transactions||[]).length>0?(s.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:O1(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Cn(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:s.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=vC(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:O1(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:Cn(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:Cn(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:Cn(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:Cn(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:Cn(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Cn(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Cn(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Cn(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Cn(h.finalAmount)})]})})]})})()]})]})}const ss=t=>Math.round((Number(t)||0)*100)/100,cu=t=>Math.round((Number(t)||0)*1e3)/1e3,ia=t=>Number(t??0).toFixed(2),Yc=t=>Number(t??0).toFixed(3),R1e=(t,e)=>{var f,h;const r=t.date??((f=t.timestamp)!=null&&f.toDate?rr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",a=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),g=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(g||0)>0&&(y=ss(c*Number(g||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:ss(g),date:r,type:a,vendorId:o,userEmail:s,vendorCommissionAmount:y}});const A=Number(t.packagesTotal??t.quantity??0),u=Number(t.amount??t.amountCharged??t.total??0)||0,d=ss(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:((h=String(t))==null?void 0:h.productName)??"(sin nombre)",quantity:A,amount:ss(u),date:r,type:a,vendorId:o,userEmail:s,vendorCommissionAmount:d}]};function D1e({role:t}){const e=!t||t==="admin",r="daily_closures_candies",n="sales_candies",s="sellers_candies",[a,o]=N.useState(rr(nO(new Date),"yyyy-MM-dd")),[l,c]=N.useState(rr(new Date,"yyyy-MM-dd")),[A,u]=N.useState(!0),[d,f]=N.useState([]),[h,m]=N.useState(null),[p,x]=N.useState(""),[g,y]=N.useState([]),[b,F]=N.useState("ALL"),[P,R]=N.useState({}),_=N.useRef(null);if(!e)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const B=async()=>{try{const I=await Nt(At(je,s)),V=[];I.forEach(j=>{const O=j.data();V.push({id:j.id,name:O.name||"",commissionPercent:Number(O.commissionPercent||0)})}),y(V)}catch(I){console.error("Error cargando sellers_candies",I)}},E=async()=>{const I=performance.now();try{u(!0);const V=Ut(At(je,r),qt("date",">=",a),qt("date","<=",l)),j=await Nt(V),O=performance.now();console.log(" getDocs ms:",(O-I).toFixed(1),"docs:",j.size);const W=[];j.forEach(ve=>W.push({id:ve.id,...ve.data()}));const D=performance.now();console.log(" parse+set ms:",(D-O).toFixed(1),"rows:",W.length),W.sort((ve,z)=>ve.date<z.date?1:ve.date>z.date?-1:0),f(W),m(null);const Y=new Set;W.forEach(ve=>{(ve.sales||[]).forEach(z=>{const Oe=String((z==null?void 0:z.id)??"").split("#")[0].trim();Oe&&Y.add(Oe)})});const se=Array.from(Y).filter(ve=>!P[ve]);if(se.length>0){const ve={};for(const z of se)try{const Oe=await Wa(kt(je,n,z));if(Oe.exists()){const te=Oe.data();ve[z]=R1e(te,z)}else ve[z]=[]}catch(Oe){console.error("Error leyendo sale",z,Oe),ve[z]=[]}R(z=>({...z,...ve}))}}catch(V){console.error(V),x(" Error cargando liquidaciones.")}finally{u(!1)}};N.useEffect(()=>{B()},[]),N.useEffect(()=>{E()},[]);const M=async I=>{I.preventDefault(),await E()},k=N.useMemo(()=>{const I={};return g.forEach(V=>I[V.id]=V.name||V.id),I},[g]),T=I=>{const V=[];return(I.sales||[]).forEach(j=>{const O=String((j==null?void 0:j.id)??"").trim();if(!O)return;const W=O.split("#")[0],Y=(P[W]||[]).find(se=>se.id===O);Y?V.push(Y):V.push({id:O,productName:String((j==null?void 0:j.productName)??"(sin nombre)"),quantity:Number((j==null?void 0:j.quantity)??0),amount:ss(Number((j==null?void 0:j.amount)??0)),date:String((j==null?void 0:j.date)??""),type:"CONTADO",vendorId:"",userEmail:String((j==null?void 0:j.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),V},U=I=>b==="ALL"?I:I.filter(V=>(V.vendorId||"")===b),Z=N.useMemo(()=>d.map(I=>{const V=U(T(I));let j=0,O=0,W=0,D=0,Y=0,se=0;for(const ve of V){const z=Number(ve.quantity||0),Oe=Number(ve.amount||0),te=Number(ve.vendorCommissionAmount||0);ve.type==="CREDITO"?(O+=z,D+=Oe,se+=te):(j+=z,W+=Oe,Y+=te)}return{...I,_sales:V,_packsCash:cu(j),_packsCredit:cu(O),_amountCash:ss(W),_amountCredit:ss(D),_comCash:ss(Y),_comCredit:ss(se)}}),[d,P,b]),pe=N.useMemo(()=>{let I=0,V=0,j=0,O=0,W=0,D=0;for(const Y of Z)I+=Number(Y._packsCash||0),V+=Number(Y._packsCredit||0),j+=Number(Y._amountCash||0),O+=Number(Y._amountCredit||0),W+=Number(Y._comCash||0),D+=Number(Y._comCredit||0);return{packsCash:cu(I),packsCredit:cu(V),totalSales:ss(j+O),amountCash:ss(j),amountCredit:ss(O),comCash:ss(W),comCredit:ss(D)}},[Z]),ae=N.useMemo(()=>{const I={},V={};for(const j of Z){const O=j._sales||[];for(const W of O){const D=(W.vendorId||"").trim();if(!D)continue;const Y=k[D]||W.userEmail||D,se=ss(Number(W.vendorCommissionAmount||0));W.type==="CREDITO"?(V[D]||(V[D]={vendorId:D,name:Y,total:0}),V[D].total=ss(V[D].total+se)):(I[D]||(I[D]={vendorId:D,name:Y,total:0}),I[D].total=ss(I[D].total+se))}}return{cashRows:Object.values(I).filter(j=>j.total>0).sort((j,O)=>O.total-j.total),creditRows:Object.values(V).filter(j=>j.total>0).sort((j,O)=>O.total-j.total)}},[Z,k]),he=N.useMemo(()=>g.map(I=>({id:I.id,label:I.name||I.id})).sort((I,V)=>I.label.localeCompare(V.label)),[g]),de=N.useMemo(()=>h&&Z.find(I=>I.id===h.id)||null,[h,Z]),re=N.useMemo(()=>de?de._sales||[]:[],[de]),xe=N.useMemo(()=>{let I=0,V=0,j=0,O=0;for(const W of re)W.type==="CREDITO"?(V+=Number(W.quantity||0),O+=Number(W.amount||0)):(I+=Number(W.quantity||0),j+=Number(W.amount||0));return{packsCash:cu(I),packsCredit:cu(V),amountCash:ss(j),amountCredit:ss(O)}},[re]),Ce=N.useMemo(()=>{const I={};for(const V of re){const j=V.productName||"(sin nombre)";I[j]||(I[j]={productName:j,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const O=Number(V.quantity||0),W=Number(V.amount||0),D=Number(V.vendorCommissionAmount||0);V.type==="CREDITO"?(I[j].packsCredit=cu(I[j].packsCredit+O),I[j].amountCredit=ss(I[j].amountCredit+W),I[j].comCredit=ss(I[j].comCredit+D)):(I[j].packsCash=cu(I[j].packsCash+O),I[j].amountCash=ss(I[j].amountCash+W),I[j].comCash=ss(I[j].comCash+D))}return Object.values(I)},[re]),S=async()=>{if(!_.current||!de)return;const I=_.current;I.classList.add("force-pdf-colors");try{const j=(await $h(I,{backgroundColor:"#ffffff"})).toDataURL("image/png"),O=new sr;O.addImage(j,"PNG",10,10,190,0),O.save(`liquidacion_${de.date}.pdf`)}finally{I.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:M,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:I=>o(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:I=>c(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:b,onChange:I=>F(I.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),he.map(I=>i.jsx("option",{value:I.id,children:I.label},I.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Yc(pe.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Yc(pe.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ia(pe.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ia(pe.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ia(pe.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ia(pe.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ia(pe.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),ae.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.cashRows.map(I=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:I.name}),i.jsxs("strong",{className:"ml-2",children:["C$",ia(I.total)]})]},I.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),ae.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.creditRows.map(I=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:I.name}),i.jsxs("strong",{className:"ml-2",children:["C$",ia(I.total)]})]},I.vendorId))})]})]}),A?i.jsx("p",{children:"Cargando..."}):Z.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:Z.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.date}),i.jsx("td",{className:"border p-1",children:Yc(I._packsCash)}),i.jsx("td",{className:"border p-1",children:Yc(I._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>m(I),children:"Ver detalle"})})})]},I.id))})]}),de&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",de.date]}),i.jsx("button",{onClick:()=>m(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:S,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:_,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",ia(xe.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",ia(xe.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Yc(xe.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Yc(xe.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),re.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:re.map((I,V)=>{const j=I.vendorId&&k[I.vendorId]?k[I.vendorId]:I.userEmail,O=ss(Number(I.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j}),i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:I.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Yc(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I.amount)]}),i.jsx("td",{className:"border p-1",children:O>0?`C$${ia(O)}`:""}),i.jsx("td",{className:"border p-1",children:I.date||""})]},V)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),Ce.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:Ce.map((I,V)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:Yc(I.packsCash)}),i.jsx("td",{className:"border p-1",children:Yc(I.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",ia(I.comCredit)]})]},V))})]})]})]}),p&&i.jsx("p",{className:"mt-3 text-sm",children:p})]})}const Gr=t=>Math.round((Number(t)||0)*100)/100,oa=t=>Math.round((Number(t)||0)*1e3)/1e3,Qr=t=>Number(t??0).toFixed(2),wa=t=>Number(t??0).toFixed(3),S3=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},L1e=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?rr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),s=t.status??"FLOTANTE",a=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),A=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",u=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,d=Number(t.vendorCommissionAmount??0)||0,f=S3(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((g,y)=>{const b=Number((g==null?void 0:g.packages)??0)||0,F=Number((g==null?void 0:g.total)??0)||Math.max(0,Number((g==null?void 0:g.unitPricePackage)||0)*b-Number((g==null?void 0:g.discount)||0)),P=S3(g==null?void 0:g.branch)||f;let R=0;return d>0&&u>0&&F>0&&(R=Gr(d*F/u)),{id:`${e}#${y}`,docId:e,productId:String((g==null?void 0:g.productId)??""),productName:String((g==null?void 0:g.productName)??"(sin nombre)"),date:r,processedDate:n,status:s,type:a,vendorId:o,vendorName:l,customerId:c,customerName:A,branch:P||"",packages:b,amount:Gr(F),commission:Gr(R)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=Gr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:s,type:a,vendorId:o,vendorName:l,customerId:c,customerName:A,branch:f||"",packages:h,amount:Gr(m),commission:Gr(p)}]};function U1e({role:t}){var _e;const e=!t||t==="admin",r=rr(new Date,"yyyy-MM-dd"),[n,s]=N.useState(r),[a,o]=N.useState(r),[l,c]=N.useState("TODAS"),[A,u]=N.useState("AMBAS"),[d,f]=N.useState("ALL"),[h,m]=N.useState("ALL"),[p,x]=N.useState(""),[g,y]=N.useState(""),[b,F]=N.useState(""),[P,R]=N.useState(""),[_,B]=N.useState("DIA"),[E,M]=N.useState(!0),[k,T]=N.useState(""),[U,Z]=N.useState([]),[pe,ae]=N.useState([]),[he,de]=N.useState([]),[re,xe]=N.useState([]),[Ce,S]=N.useState([]),[I,V]=N.useState([]),[j,O]=N.useState([]),[W,D]=N.useState([]),[Y,se]=N.useState(""),ve=N.useRef(null),[z,Oe]=N.useState([]),te=N.useMemo(()=>{const G={};return Ce.forEach(Ne=>{G[Ne.id]=String(Ne.name||"").trim()}),G},[Ce]),J=G=>{const Ne=G.customerId?te[G.customerId]:"";return(G.customerName||Ne||"").trim()||(G.customerId?te[G.customerId]||G.customerId:"")||""};N.useEffect(()=>{if(!e)return;(async()=>{try{const Ne=await Nt(At(je,"inventory_candies")),Ue=[];Ne.forEach($e=>Ue.push({id:$e.id,...$e.data()})),Oe(Ue)}catch(Ne){console.error("inventory_candies all error:",Ne),Oe([])}})()},[e]),N.useEffect(()=>{(async()=>{try{const Ne=await Nt(At(je,"sellers_candies")),Ue=[];Ne.forEach(ge=>{const Be=ge.data();Ue.push({id:ge.id,name:String(Be.name||"").trim(),commissionPercent:Number(Be.commissionPercent||0),branch:Be.branch||""})});const $e=new Map;Ue.forEach(ge=>$e.set(ge.id,ge)),ae(Array.from($e.values()).sort((ge,Be)=>ge.name.localeCompare(Be.name)))}catch(Ne){console.error(Ne)}})()},[]),N.useEffect(()=>{if(!e||!n||!a)return;M(!0),T("");const G=Ut(At(je,"sales_candies"),qt("date",">=",n),qt("date","<=",a),Rr("date","asc")),Ne=M0(G,Ue=>{const $e=[];Ue.forEach(ge=>$e.push(...L1e(ge.data(),ge.id))),Z($e),M(!1)},Ue=>{console.error("sales_candies periodo error:",Ue),Z([]),M(!1),T(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>Ne()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const Ne=Ut(At(je,"candy_main_orders"),qt("date",">=",n),qt("date","<=",a)),Ue=await Nt(Ne),$e=[];Ue.forEach(ge=>$e.push({id:ge.id,...ge.data()})),de($e)}catch(Ne){console.error("candy_main_orders error:",Ne),de([])}})()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const Ne=Ut(At(je,"inventory_candies_sellers"),qt("date",">=",n),qt("date","<=",a)),Ue=await Nt(Ne),$e=[];Ue.forEach(ge=>$e.push({id:ge.id,...ge.data()})),xe($e)}catch(Ne){console.error("inventory_candies_sellers error:",Ne),xe([])}})()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const Ne=await Nt(At(je,"inventory_candies")),Ue=[];Ne.forEach($e=>Ue.push({id:$e.id,...$e.data()})),O(Ue)}catch(Ne){console.error("inventory_candies global error:",Ne),O([])}})()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const Ne=await Nt(At(je,"inventory_candies_sellers")),Ue=[];Ne.forEach($e=>Ue.push({id:$e.id,...$e.data()})),D(Ue)}catch(Ne){console.error("inventory_candies_sellers global error:",Ne),D([])}})()},[e]),N.useEffect(()=>{if(!e)return;const G=Ut(At(je,"customers_candies")),Ne=M0(G,Ue=>{const $e=[];Ue.forEach(ge=>{var Be;return $e.push({id:ge.id,name:String(((Be=ge.data())==null?void 0:Be.name)||"").trim()})}),S($e)},Ue=>{console.error("customers_candies snapshot error:",Ue),S([])});return()=>Ne()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const Ne=Ut(At(je,"ar_movements"),qt("date","<=",a),Rr("date","asc")),Ue=await Nt(Ne),$e=[];Ue.forEach(ge=>$e.push({id:ge.id,...ge.data()})),V($e)}catch(Ne){console.warn("ar_movements sin ndice, usando fallback:",Ne);try{const Ue=await Nt(At(je,"ar_movements")),$e=[];Ue.forEach(ge=>$e.push({id:ge.id,...ge.data()})),V($e.filter(ge=>String(ge.date||"")<=a))}catch(Ue){console.error(Ue),V([])}}})()},[e,a]);const q=N.useMemo(()=>{let G=[...U];if(l!=="TODAS"&&(G=G.filter($e=>$e.status===l)),A==="CASH"&&(G=G.filter($e=>$e.type==="CONTADO")),A==="CREDITO"&&(G=G.filter($e=>$e.type==="CREDITO")),d!=="ALL"&&(G=G.filter($e=>($e.vendorId||"")===d)),h!=="ALL"&&(G=G.filter($e=>$e.branch===h)),p.trim()){const $e=p.trim().toLowerCase();G=G.filter(ge=>(ge.productName||"").toLowerCase().includes($e))}if(g.trim()){const $e=g.trim().toLowerCase();G=G.filter(ge=>(J(ge)||"").toLowerCase().includes($e))}const Ne=b.trim()?Number(b):null,Ue=P.trim()?Number(P):null;return Ne!==null&&!Number.isNaN(Ne)&&(G=G.filter($e=>($e.amount||0)>=Ne)),Ue!==null&&!Number.isNaN(Ue)&&(G=G.filter($e=>($e.amount||0)<=Ue)),G},[U,l,A,d,h,p,g,b,P,te]),ie=N.useMemo(()=>{let G=0,Ne=0,Ue=0,$e=0,ge=0,Be=0;for(const Te of q){const We=Number(Te.packages||0),at=Number(Te.amount||0),bt=Number(Te.commission||0);Te.type==="CREDITO"?(Ne+=We,$e+=at,Be+=bt):(G+=We,Ue+=at,ge+=bt)}const Qe=Gr(Ue+$e);return{packsCash:oa(G),packsCredit:oa(Ne),salesCash:Gr(Ue),salesCredit:Gr($e),salesTotal:Qe,commCash:Gr(ge),commCredit:Gr(Be)}},[q]),fe=N.useMemo(()=>{let G=0,Ne=0,Ue=0,$e=0,ge=0,Be=0;for(const Qe of he){const Te=Array.isArray(Qe.items)?Qe.items:[];for(const We of Te)G+=Number(We.totalRivas??0),Ne+=Number(We.totalSanJorge??0),Ue+=Number(We.totalIsla??0),$e+=Number(We.gainRivas??0),ge+=Number(We.gainSanJorge??0),Be+=Number(We.gainIsla??0)}return{expectedRivas:Gr(G),expectedSanJorge:Gr(Ne),expectedIsla:Gr(Ue),grossRivas:Gr($e),grossSanJorge:Gr(ge),grossIsla:Gr(Be),grossTotal:Gr($e+ge+Be)}},[he]),Ie=N.useMemo(()=>{const G={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const Ne of q){const Ue=Ne.branch;Ue&&(G[Ue].sales+=Number(Ne.amount||0),G[Ue].packages+=Number(Ne.packages||0))}return{RIVAS:{sales:Gr(G.RIVAS.sales),packages:oa(G.RIVAS.packages)},SAN_JORGE:{sales:Gr(G.SAN_JORGE.sales),packages:oa(G.SAN_JORGE.packages)},ISLA:{sales:Gr(G.ISLA.sales),packages:oa(G.ISLA.packages)}}},[q]),Ve=N.useMemo(()=>({RIVAS:Gr(Ie.RIVAS.sales-fe.expectedRivas),SAN_JORGE:Gr(Ie.SAN_JORGE.sales-fe.expectedSanJorge),ISLA:Gr(Ie.ISLA.sales-fe.expectedIsla)}),[Ie,fe]),ze=N.useMemo(()=>{const G={},Ne={};for(const ge of q){const Be=(ge.vendorId||"").trim();if(!Be)continue;const Qe=pe.find(at=>at.id===Be),Te=(Qe==null?void 0:Qe.name)||ge.vendorName||"(sin vendedor)",We=Number(ge.commission||0);ge.type==="CREDITO"?(Ne[Be]||(Ne[Be]={vendorId:Be,name:Te,total:0}),Ne[Be].total=Gr(Ne[Be].total+We)):(G[Be]||(G[Be]={vendorId:Be,name:Te,total:0}),G[Be].total=Gr(G[Be].total+We))}const Ue=Object.values(G).sort((ge,Be)=>Be.total-ge.total),$e=Object.values(Ne).sort((ge,Be)=>Be.total-ge.total);return{cashArr:Ue,creditArr:$e}},[q,pe]),Ye=N.useMemo(()=>{const G=(gt,Pt)=>gt.reduce((Ft,Tt)=>Ft+Number((Tt==null?void 0:Tt[Pt])??0),0),Ne=gt=>{const Pt=gt.map(Tt=>Number((Tt==null?void 0:Tt.remainingPackages)??0)).filter(Tt=>Number.isFinite(Tt));return Pt.length===0?0:Pt.every(Tt=>Tt===Pt[0])?Pt[0]:Pt.reduce((Tt,Xt)=>Tt+Xt,0)},Ue=gt=>{const Pt=Number((gt==null?void 0:gt.totalPackages)??0);if(Pt>0)return Pt;const Ft=Array.isArray(gt==null?void 0:gt.items)?gt.items:[];return G(Ft,"packages")},$e=gt=>{const Pt=Number((gt==null?void 0:gt.remainingPackages)??0);if(Pt>0)return Pt;const Ft=Array.isArray(gt==null?void 0:gt.items)?gt.items:[];return Ne(Ft)},ge=gt=>{const Pt=Number(gt);return Number.isFinite(Pt)?Math.floor(Pt):0},Be=gt=>{const Pt=Number(gt==null?void 0:gt.remainingPackages);if(Number.isFinite(Pt)&&Pt>0)return Math.floor(Pt);const Ft=Math.max(1,ge((gt==null?void 0:gt.unitsPerPackage)??1)),Tt=ge((gt==null?void 0:gt.remainingUnits)??(gt==null?void 0:gt.remaining)??0);return Tt>0?Math.max(0,Math.floor(Tt/Ft)):0};let Qe=0,Te=0,We=0;for(const gt of he){const Pt=Array.isArray(gt.items)?gt.items:[];if(Pt.length)for(const Ft of Pt)Qe+=Number((Ft==null?void 0:Ft.subtotal)??0);else Qe+=Number(gt.subtotal??0);Te+=Ue(gt),We+=$e(gt)}let at=0,bt=0,ot=0;const wt={};for(const gt of re){at+=Number(gt.subtotal??0),bt+=Number(gt.packages??0);const Pt=Be(gt);ot+=Pt;const Ft=String(gt.sellerId||"").trim();if(!Ft)continue;const Tt=String(gt.sellerName||"").trim()||"(sin vendedor)";wt[Ft]||(wt[Ft]={sellerId:Ft,sellerName:Tt,ordered:0,remaining:0}),wt[Ft].ordered+=Number(gt.packages??0),wt[Ft].remaining+=Pt}const Lt=Object.values(wt).map(gt=>({...gt,ordered:oa(gt.ordered),remaining:oa(gt.remaining)})).sort((gt,Pt)=>Pt.ordered-gt.ordered),Ar=[...Lt].sort((gt,Pt)=>Pt.remaining-gt.remaining),ir=We,xr=ot,er=new Set(he.filter(gt=>String(gt.date||"")>=n&&String(gt.date||"")<=a).map(gt=>gt.id));let et=0;for(const gt of z){const Pt=String(gt.orderId||"").trim();Pt&&er.has(Pt)&&(et+=Number(gt.remainingPackages??0))}return{providerTotalMaster:Gr(Qe),providerTotalVendor:Gr(at),orderedPacksMaster:oa(Te),remainingPacksMaster:oa(et),orderedPacksVendor:oa(bt),remainingPacksVendor:oa(ot),globalRemainingMaster:oa(ir),globalRemainingVendor:oa(xr),vendorRowsOrdered:Lt,vendorRowsRemaining:Ar}},[he,re,z,n,a]),ct=N.useMemo(()=>{const G=j.reduce((Ue,$e)=>Ue+Number($e.remainingPackages??0),0),Ne=W.reduce((Ue,$e)=>Ue+Number($e.remainingPackages??0),0);return{masterRemainingPackages:oa(G),vendorRemainingPackages:oa(Ne)}},[j,W]),st=N.useMemo(()=>{const G=new Map,Ne=$e=>_==="DIA"?{key:$e.date,label:$e.date}:_==="VENDEDOR"?{key:$e.vendorId||"",label:$e.vendorName||""}:_==="PRODUCTO"?{key:$e.productName||"",label:$e.productName||""}:{key:$e.branch||"",label:$e.branch||""};for(const $e of q){const{key:ge,label:Be}=Ne($e);G.has(ge)||G.set(ge,{key:ge,label:Be,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const Qe=G.get(ge);Qe.rows.push($e),$e.type==="CREDITO"?(Qe.packsCredit+=Number($e.packages||0),Qe.salesCredit+=Number($e.amount||0),Qe.commCredit+=Number($e.commission||0)):(Qe.packsCash+=Number($e.packages||0),Qe.salesCash+=Number($e.amount||0),Qe.commCash+=Number($e.commission||0))}const Ue=Array.from(G.values()).map($e=>({...$e,packsCash:oa($e.packsCash),packsCredit:oa($e.packsCredit),salesCash:Gr($e.salesCash),salesCredit:Gr($e.salesCredit),commCash:Gr($e.commCash),commCredit:Gr($e.commCredit)}));return _==="DIA"?Ue.sort(($e,ge)=>$e.key<ge.key?1:-1):Ue.sort(($e,ge)=>ge.salesCash+ge.salesCredit-($e.salesCash+$e.salesCredit)),Ue},[q,_]),ft=N.useMemo(()=>{if(!Y)return[];const G=st.find(Ne=>Ne.key===Y);return(G==null?void 0:G.rows)||[]},[Y,st]),nt=N.useMemo(()=>{const G={};for(const Ne of ft){const Ue=Ne.productName||"(sin nombre)";G[Ue]||(G[Ue]={productName:Ue,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),Ne.type==="CREDITO"?(G[Ue].packsCredit+=Number(Ne.packages||0),G[Ue].salesCredit+=Number(Ne.amount||0),G[Ue].commCredit+=Number(Ne.commission||0)):(G[Ue].packsCash+=Number(Ne.packages||0),G[Ue].salesCash+=Number(Ne.amount||0),G[Ue].commCash+=Number(Ne.commission||0))}return Object.values(G).map(Ne=>({...Ne,packsCash:oa(Ne.packsCash),packsCredit:oa(Ne.packsCredit),salesCash:Gr(Ne.salesCash),salesCredit:Gr(Ne.salesCredit),commCash:Gr(Ne.commCash),commCredit:Gr(Ne.commCredit)})).sort((Ne,Ue)=>Ue.salesCash+Ue.salesCredit-(Ne.salesCash+Ne.salesCredit))},[ft]),De=N.useMemo(()=>{const G={},Ne=ge=>(te[ge]||"").trim()||ge;for(const ge of I){const Be=String(ge.customerId||"").trim();if(!Be)continue;const Qe=String(ge.date||"");if(Qe&&Qe>a)continue;G[Be]||(G[Be]={customerId:Be,name:Ne(Be),balance:0,lastPayment:""});const Te=Number(ge.amount||0);ge.type==="CARGO"&&(G[Be].balance+=Te),ge.type==="ABONO"&&(G[Be].balance-=Te,(!G[Be].lastPayment||Qe>G[Be].lastPayment)&&(G[Be].lastPayment=Qe))}const Ue=Object.values(G).map(ge=>({...ge,balance:Gr(ge.balance)})).filter(ge=>ge.balance>0).sort((ge,Be)=>Be.balance-ge.balance),$e=Gr(Ue.reduce((ge,Be)=>ge+Be.balance,0));return{count:Ue.length,totalPending:$e,list:Ue.slice(0,20)}},[I,te,a]),Fe=async()=>{if(ve.current){ve.current.classList.add("force-pdf-colors");try{const Ne=(await $h(ve.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Ue=new sr;Ue.addImage(Ne,"PNG",10,10,190,0),Ue.save(`data_center_dulces_${n}_a_${a}.pdf`)}finally{ve.current.classList.remove("force-pdf-colors")}}},Ge=()=>{const Ne=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...q.map(Be=>[Be.date,Be.processedDate||"",Be.status,Be.type,Be.vendorId,`"${String(Be.vendorName||"").replace(/"/g,'""')}"`,Be.branch||"",`"${String(Be.productName||"").replace(/"/g,'""')}"`,wa(Be.packages),Qr(Be.amount),Qr(Be.commission),Be.customerId||"",`"${String(J(Be)||"").replace(/"/g,'""')}"`].join(","))],Ue=new Blob([Ne.join(`
`)],{type:"text/csv;charset=utf-8;"}),$e=URL.createObjectURL(Ue),ge=document.createElement("a");ge.href=$e,ge.download=`data_center_dulces_${n}_a_${a}.csv`,ge.click(),URL.revokeObjectURL($e)};return e?i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[i.jsx("button",{onClick:Fe,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Exportar PDF"}),i.jsx("button",{onClick:Ge,className:"bg-gray-800 text-white px-4 py-2 rounded hover:bg-black",children:"Exportar CSV"})]})]}),i.jsx("div",{className:"rounded-2xl border border-gray-100 p-4 mb-4 shadow-sm bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:n,onChange:G=>s(G.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:a,onChange:G=>o(G.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:l,onChange:G=>c(G.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:A,onChange:G=>u(G.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:d,onChange:G=>f(G.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),pe.map(G=>i.jsx("option",{value:G.id,children:G.name||G.id},G.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Sucursal"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:G=>m(G.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:p,onChange:G=>x(G.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:g,onChange:G=>y(G.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Monto min"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:b,onChange:G=>F(G.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Monto max"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:P,onChange:G=>R(G.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"md:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:_,onChange:G=>{se(""),B(G.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})}),i.jsxs("div",{ref:ve,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(ie.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(ie.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Qr(ie.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(ie.salesCash),"  Crdito: C$",Qr(ie.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Qr(ie.commCash+ie.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(ie.commCash),"  Crdito: C$",Qr(ie.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gross Profit total (rdenes maestras)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Qr(fe.grossTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["R: ",Qr(fe.grossRivas),"  SJ:"," ",Qr(fe.grossSanJorge),"  I:"," ",Qr(fe.grossIsla)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Expected Total (Rivas/SJ/Isla)"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Qr(fe.expectedRivas)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Qr(fe.expectedSanJorge)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Qr(fe.expectedIsla)]})]})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas por sucursal"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Qr(Ie.RIVAS.sales)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Qr(Ie.SAN_JORGE.sales)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Qr(Ie.ISLA.sales)]})]})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs expected"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Qr(Ve.RIVAS)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Qr(Ve.SAN_JORGE)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Qr(Ve.ISLA)]})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes maestras)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Qr(Ye.providerTotalMaster)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Qr(Ye.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(Ye.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:wa(Ye.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:wa(ct.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(Ye.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:wa(Ye.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:wa(ct.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados por vendedor (perodo)"}),Ye.vendorRowsOrdered.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:Ye.vendorRowsOrdered.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.sellerName}),i.jsx("strong",{className:"ml-2",children:wa(G.ordered)})]},G.sellerId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes existentes por vendedor (perodo)"}),Ye.vendorRowsRemaining.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:Ye.vendorRowsRemaining.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.sellerName}),i.jsx("strong",{className:"ml-2",children:wa(G.remaining)})]},G.sellerId))})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),ze.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:ze.cashArr.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Qr(G.total)]})]},G.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),ze.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:ze.creditArr.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Qr(G.total)]})]},G.vendorId))})]})]}),i.jsxs("div",{className:"border rounded-2xl p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("h3",{className:"font-semibold mb-2",children:["Cartera (saldo pendiente hasta ",a,")"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:De.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Qr(De.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),De.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"})]})}),i.jsx("tbody",{children:De.list.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.name}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.balance)]}),i.jsx("td",{className:"border p-1",children:G.lastPayment||""})]},G.customerId))})]})]}),i.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold",children:["Tabla principal (Agrupar por: ",_,")"]}),i.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"Click en Ver detalle para drill-down"})]}),E?i.jsx("p",{children:"Cargando..."}):i.jsxs("table",{className:"min-w-full border text-sm mb-6 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:_==="DIA"?"Da":_==="VENDEDOR"?"Vendedor":_==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[st.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.label}),i.jsx("td",{className:"border p-1",children:wa(G.packsCash)}),i.jsx("td",{className:"border p-1",children:wa(G.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.salesCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.salesCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.commCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.commCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>se(G.key),children:"Ver detalle"})})]},G.key)),st.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]}),Y&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle "," ",((_e=st.find(G=>G.key===Y))==null?void 0:_e.label)||Y]}),i.jsx("button",{onClick:()=>se(""),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Qr(ft.filter(G=>G.type==="CONTADO").reduce((G,Ne)=>G+Number(Ne.amount||0),0))]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Qr(ft.filter(G=>G.type==="CREDITO").reduce((G,Ne)=>G+Number(Ne.amount||0),0))]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:wa(ft.filter(G=>G.type==="CONTADO").reduce((G,Ne)=>G+Number(Ne.packages||0),0))})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:wa(ft.filter(G=>G.type==="CREDITO").reduce((G,Ne)=>G+Number(Ne.packages||0),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas incluidas"}),i.jsxs("table",{className:"min-w-full border text-sm mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[ft.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.vendorName}),i.jsx("td",{className:"border p-1",children:G.productName}),i.jsx("td",{className:"border p-1",children:G.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:G.branch||""}),i.jsx("td",{className:"border p-1",children:wa(G.packages)}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.commission)]}),i.jsx("td",{className:"border p-1",children:G.date})]},G.id)),ft.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin detalle."})})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[nt.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.productName}),i.jsx("td",{className:"border p-1",children:wa(G.packsCash)}),i.jsx("td",{className:"border p-1",children:wa(G.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.salesCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.salesCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.commCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(G.commCredit)]})]},G.productName)),nt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-3 text-center text-gray-500",children:"Sin consolidado."})})]})]})]})]}),k&&i.jsx("p",{className:"mt-3 text-sm",children:k})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function O1e(){const[t,e]=N.useState(!1);return N.useEffect(()=>{var s;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(s=r.addEventListener)==null||s.call(r,"change",n),()=>{var a;return(a=r.removeEventListener)==null?void 0:a.call(r,"change",n)}},[]),t}function M1e(){const[t,e]=N.useState(null),[r,n]=N.useState(""),[s,a]=N.useState(""),[o,l]=N.useState(!0),c=O1e(),A=N.useMemo(()=>c?i.jsx(rY,{role:r}):i.jsx(tY,{role:r}),[c,r]),u=(t==null?void 0:t.email)||"";if(N.useEffect(()=>{const f=OL(Px,async h=>{if(l(!0),h){e(h);try{const m=kt(je,"users",h.uid),p=await Wa(m);if(p.exists()){const x=p.data(),g=x.role||"",y=x.sellerCandyId||"";n(g||""),a(y||"")}else n(""),a("")}catch{n(""),a("")}}else e(null),n(""),a("");l(!1)});return()=>f()},[]),o)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const d=()=>r==="admin"?i.jsx(Od,{to:"financialDashboard",replace:!0}):r==="vendedor_pollo"?i.jsx(Od,{to:"salesV2",replace:!0}):r==="vendedor_ropa"?i.jsx(Od,{to:"salesClothes",replace:!0}):r==="vendedor_dulces"?i.jsx(Od,{to:"salesCandies",replace:!0}):i.jsx(Od,{to:"/",replace:!0});return i.jsx(OK,{children:i.jsxs(pK,{children:[i.jsx(Or,{path:"/",element:i.jsx(eY,{})}),i.jsxs(Or,{path:"/admin",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"],children:A}),children:[i.jsx(Or,{index:!0,element:i.jsx(d,{})}),i.jsx(Or,{path:"bills",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Ioe,{})})}),i.jsx(Or,{path:"salesV2",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Jj,{user:t})})}),i.jsx(Or,{path:"financialDashboard",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ele,{})})}),i.jsx(Or,{path:"expenses",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(rle,{})})}),i.jsx(Or,{path:"billing",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ole,{})})}),i.jsx(Or,{path:"batches",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Xoe,{role:r})})}),i.jsx(Or,{path:"paidBatches",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ule,{})})}),i.jsx(Or,{path:"fix",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ale,{})})}),i.jsx(Or,{path:"transactionclose",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(Yoe,{})})}),i.jsx(Or,{path:"billhistoric",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(Foe,{})})}),i.jsx(Or,{path:"users",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(koe,{})})}),i.jsx(Or,{path:"products",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(joe,{})})}),i.jsx(Or,{path:"datacenter",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(U1e,{})})}),i.jsx(Or,{path:"productsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Hve,{})})}),i.jsx(Or,{path:"mainordersCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(C1e,{})})}),i.jsx(Or,{path:"inventoryMainOrderCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(_1e,{})})}),i.jsx(Or,{path:"inventoryCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Xve,{})})}),i.jsx(Or,{path:"billingsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(P1e,{})})}),i.jsx(Or,{path:"customersCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Yve,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Or,{path:"salesCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(s1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Or,{path:"expensesCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(a1e,{})})}),i.jsx(Or,{path:"dashboardCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(f1e,{})})}),i.jsx(Or,{path:"transactionCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(c1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Or,{path:"vendorsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(m1e,{})})}),i.jsx(Or,{path:"productsVendorsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(y1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Or,{path:"cierreVentasCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(B1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Or,{path:"reporteCierresCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(D1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Or,{path:"consolidatedVendors",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(T1e,{})})}),i.jsx(Or,{path:"salesClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(kle,{})})}),i.jsx(Or,{path:"TransactionsReportClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Qle,{})})}),i.jsx(Or,{path:"financialDashboardClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Ple,{})})}),i.jsx(Or,{path:"ExpensesClothes",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(Rle,{})})}),i.jsx(Or,{path:"inventoryClothesBatches",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(mle,{})})}),i.jsx(Or,{path:"productsClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Ele,{})})}),i.jsx(Or,{path:"CustomersClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Sle,{})})})]}),i.jsx(Or,{path:"/salesV2",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Jj,{user:t})})}),i.jsx(Or,{path:"*",element:i.jsx(Od,{to:"/"})})]})})}wC.createRoot(document.getElementById("root")).render(i.jsx(ci.StrictMode,{children:i.jsx(M1e,{})}));export{Sn as _,V1e as c,Z7 as g};
