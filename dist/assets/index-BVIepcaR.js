var $7=Object.defineProperty;var z7=(t,e,r)=>e in t?$7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var bn=(t,e,r)=>z7(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Uve=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function W7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _3={exports:{}},L2={},E3={exports:{}},Wr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ax=Symbol.for("react.element"),J7=Symbol.for("react.portal"),X7=Symbol.for("react.fragment"),Y7=Symbol.for("react.strict_mode"),Z7=Symbol.for("react.profiler"),eV=Symbol.for("react.provider"),tV=Symbol.for("react.context"),rV=Symbol.for("react.forward_ref"),nV=Symbol.for("react.suspense"),sV=Symbol.for("react.memo"),aV=Symbol.for("react.lazy"),C5=Symbol.iterator;function iV(t){return t===null||typeof t!="object"?null:(t=C5&&t[C5]||t["@@iterator"],typeof t=="function"?t:null)}var B3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S3=Object.assign,I3={};function q0(t,e,r){this.props=t,this.context=e,this.refs=I3,this.updater=r||B3}q0.prototype.isReactComponent={};q0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};q0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function F3(){}F3.prototype=q0.prototype;function LE(t,e,r){this.props=t,this.context=e,this.refs=I3,this.updater=r||B3}var UE=LE.prototype=new F3;UE.constructor=LE;S3(UE,q0.prototype);UE.isPureReactComponent=!0;var _5=Array.isArray,k3=Object.prototype.hasOwnProperty,OE={current:null},T3={key:!0,ref:!0,__self:!0,__source:!0};function j3(t,e,r){var n,s={},a=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)k3.call(e,n)&&!T3.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),A=0;A<l;A++)c[A]=arguments[A+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Ax,type:t,key:a,ref:o,props:s,_owner:OE.current}}function oV(t,e){return{$$typeof:Ax,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ME(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ax}function lV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var E5=/\/+/g;function gb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lV(""+t.key):e.toString(36)}function Uv(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ax:case J7:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+gb(o,0):n,_5(s)?(r="",t!=null&&(r=t.replace(E5,"$&/")+"/"),Uv(s,e,r,"",function(A){return A})):s!=null&&(ME(s)&&(s=oV(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(E5,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",_5(t))for(var l=0;l<t.length;l++){a=t[l];var c=n+gb(a,l);o+=Uv(a,e,r,c,s)}else if(c=iV(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=n+gb(a,l++),o+=Uv(a,e,r,c,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function l1(t,e,r){if(t==null)return t;var n=[],s=0;return Uv(t,n,"","",function(a){return e.call(r,a,s++)}),n}function cV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ji={current:null},Ov={transition:null},AV={ReactCurrentDispatcher:ji,ReactCurrentBatchConfig:Ov,ReactCurrentOwner:OE};function P3(){throw Error("act(...) is not supported in production builds of React.")}Wr.Children={map:l1,forEach:function(t,e,r){l1(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return l1(t,function(){e++}),e},toArray:function(t){return l1(t,function(e){return e})||[]},only:function(t){if(!ME(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Wr.Component=q0;Wr.Fragment=X7;Wr.Profiler=Z7;Wr.PureComponent=LE;Wr.StrictMode=Y7;Wr.Suspense=nV;Wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AV;Wr.act=P3;Wr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=S3({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=OE.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)k3.call(e,c)&&!T3.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var A=0;A<c;A++)l[A]=arguments[A+2];n.children=l}return{$$typeof:Ax,type:t.type,key:s,ref:a,props:n,_owner:o}};Wr.createContext=function(t){return t={$$typeof:tV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:eV,_context:t},t.Consumer=t};Wr.createElement=j3;Wr.createFactory=function(t){var e=j3.bind(null,t);return e.type=t,e};Wr.createRef=function(){return{current:null}};Wr.forwardRef=function(t){return{$$typeof:rV,render:t}};Wr.isValidElement=ME;Wr.lazy=function(t){return{$$typeof:aV,_payload:{_status:-1,_result:t},_init:cV}};Wr.memo=function(t,e){return{$$typeof:sV,type:t,compare:e===void 0?null:e}};Wr.startTransition=function(t){var e=Ov.transition;Ov.transition={};try{t()}finally{Ov.transition=e}};Wr.unstable_act=P3;Wr.useCallback=function(t,e){return ji.current.useCallback(t,e)};Wr.useContext=function(t){return ji.current.useContext(t)};Wr.useDebugValue=function(){};Wr.useDeferredValue=function(t){return ji.current.useDeferredValue(t)};Wr.useEffect=function(t,e){return ji.current.useEffect(t,e)};Wr.useId=function(){return ji.current.useId()};Wr.useImperativeHandle=function(t,e,r){return ji.current.useImperativeHandle(t,e,r)};Wr.useInsertionEffect=function(t,e){return ji.current.useInsertionEffect(t,e)};Wr.useLayoutEffect=function(t,e){return ji.current.useLayoutEffect(t,e)};Wr.useMemo=function(t,e){return ji.current.useMemo(t,e)};Wr.useReducer=function(t,e,r){return ji.current.useReducer(t,e,r)};Wr.useRef=function(t){return ji.current.useRef(t)};Wr.useState=function(t){return ji.current.useState(t)};Wr.useSyncExternalStore=function(t,e,r){return ji.current.useSyncExternalStore(t,e,r)};Wr.useTransition=function(){return ji.current.useTransition()};Wr.version="18.3.1";E3.exports=Wr;var N=E3.exports;const li=W7(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uV=N,dV=Symbol.for("react.element"),hV=Symbol.for("react.fragment"),fV=Object.prototype.hasOwnProperty,mV=uV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pV={key:!0,ref:!0,__self:!0,__source:!0};function R3(t,e,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)fV.call(e,n)&&!pV.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:dV,type:t,key:a,ref:o,props:s,_owner:mV.current}}L2.Fragment=hV;L2.jsx=R3;L2.jsxs=R3;_3.exports=L2;var i=_3.exports,xC={},D3={exports:{}},ko={},L3={exports:{}},U3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(de,Z){var xe=de.length;de.push(Z);e:for(;0<xe;){var Be=xe-1>>>1,I=de[Be];if(0<s(I,Z))de[Be]=Z,de[xe]=I,xe=Be;else break e}}function r(de){return de.length===0?null:de[0]}function n(de){if(de.length===0)return null;var Z=de[0],xe=de.pop();if(xe!==Z){de[0]=xe;e:for(var Be=0,I=de.length,C=I>>>1;Be<C;){var Q=2*(Be+1)-1,M=de[Q],D=Q+1,z=de[D];if(0>s(M,xe))D<I&&0>s(z,M)?(de[Be]=z,de[D]=xe,Be=D):(de[Be]=M,de[Q]=xe,Be=Q);else if(D<I&&0>s(z,xe))de[Be]=z,de[D]=xe,Be=D;else break e}}return Z}function s(de,Z){var xe=de.sortIndex-Z.sortIndex;return xe!==0?xe:de.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],A=[],u=1,d=null,f=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(de){for(var Z=r(A);Z!==null;){if(Z.callback===null)n(A);else if(Z.startTime<=de)n(A),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=r(A)}}function F(de){if(p=!1,b(de),!m)if(r(c)!==null)m=!0,ae(j);else{var Z=r(A);Z!==null&&fe(F,Z.startTime-de)}}function j(de,Z){m=!1,p&&(p=!1,g(S),S=-1),h=!0;var xe=f;try{for(b(Z),d=r(c);d!==null&&(!(d.expirationTime>Z)||de&&!k());){var Be=d.callback;if(typeof Be=="function"){d.callback=null,f=d.priorityLevel;var I=Be(d.expirationTime<=Z);Z=t.unstable_now(),typeof I=="function"?d.callback=I:d===r(c)&&n(c),b(Z)}else n(c);d=r(c)}if(d!==null)var C=!0;else{var Q=r(A);Q!==null&&fe(F,Q.startTime-Z),C=!1}return C}finally{d=null,f=xe,h=!1}}var R=!1,E=null,S=-1,B=5,U=-1;function k(){return!(t.unstable_now()-U<B)}function T(){if(E!==null){var de=t.unstable_now();U=de;var Z=!0;try{Z=E(!0,de)}finally{Z?L():(R=!1,E=null)}}else R=!1}var L;if(typeof y=="function")L=function(){y(T)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,me=Y.port2;Y.port1.onmessage=T,L=function(){me.postMessage(null)}}else L=function(){x(T,0)};function ae(de){E=de,R||(R=!0,L())}function fe(de,Z){S=x(function(){de(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(de){de.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ae(j))},t.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<de?Math.floor(1e3/de):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(de){switch(f){case 1:case 2:case 3:var Z=3;break;default:Z=f}var xe=f;f=Z;try{return de()}finally{f=xe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(de,Z){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var xe=f;f=de;try{return Z()}finally{f=xe}},t.unstable_scheduleCallback=function(de,Z,xe){var Be=t.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?Be+xe:Be):xe=Be,de){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=xe+I,de={id:u++,callback:Z,priorityLevel:de,startTime:xe,expirationTime:I,sortIndex:-1},xe>Be?(de.sortIndex=xe,e(A,de),r(c)===null&&de===r(A)&&(p?(g(S),S=-1):p=!0,fe(F,xe-Be))):(de.sortIndex=I,e(c,de),m||h||(m=!0,ae(j))),de},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(de){var Z=f;return function(){var xe=f;f=Z;try{return de.apply(this,arguments)}finally{f=xe}}}})(U3);L3.exports=U3;var gV=L3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xV=N,Bo=gV;function Qt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var O3=new Set,lg={};function Uh(t,e){N0(t,e),N0(t+"Capture",e)}function N0(t,e){for(lg[t]=e,t=0;t<e.length;t++)O3.add(e[t])}var vA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vC=Object.prototype.hasOwnProperty,vV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B5={},S5={};function wV(t){return vC.call(S5,t)?!0:vC.call(B5,t)?!1:vV.test(t)?S5[t]=!0:(B5[t]=!0,!1)}function yV(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bV(t,e,r,n){if(e===null||typeof e>"u"||yV(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pi(t,e,r,n,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var $a={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$a[t]=new Pi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$a[e]=new Pi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$a[t]=new Pi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$a[t]=new Pi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$a[t]=new Pi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$a[t]=new Pi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$a[t]=new Pi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$a[t]=new Pi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$a[t]=new Pi(t,5,!1,t.toLowerCase(),null,!1,!1)});var QE=/[\-:]([a-z])/g;function VE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(QE,VE);$a[e]=new Pi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(QE,VE);$a[e]=new Pi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(QE,VE);$a[e]=new Pi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$a[t]=new Pi(t,1,!1,t.toLowerCase(),null,!1,!1)});$a.xlinkHref=new Pi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$a[t]=new Pi(t,1,!1,t.toLowerCase(),null,!0,!0)});function HE(t,e,r,n){var s=$a.hasOwnProperty(e)?$a[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bV(e,r,s,n)&&(r=null),n||s===null?wV(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var IA=xV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c1=Symbol.for("react.element"),$f=Symbol.for("react.portal"),zf=Symbol.for("react.fragment"),KE=Symbol.for("react.strict_mode"),wC=Symbol.for("react.profiler"),M3=Symbol.for("react.provider"),Q3=Symbol.for("react.context"),qE=Symbol.for("react.forward_ref"),yC=Symbol.for("react.suspense"),bC=Symbol.for("react.suspense_list"),GE=Symbol.for("react.memo"),hu=Symbol.for("react.lazy"),V3=Symbol.for("react.offscreen"),I5=Symbol.iterator;function Tm(t){return t===null||typeof t!="object"?null:(t=I5&&t[I5]||t["@@iterator"],typeof t=="function"?t:null)}var ys=Object.assign,xb;function ap(t){if(xb===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);xb=e&&e[1]||""}return`
`+xb+t}var vb=!1;function wb(t,e){if(!t||vb)return"";vb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(A){var n=A}Reflect.construct(t,[],e)}else{try{e.call()}catch(A){n=A}t.call(e.prototype)}else{try{throw Error()}catch(A){n=A}t()}}catch(A){if(A&&n&&typeof A.stack=="string"){for(var s=A.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{vb=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ap(t):""}function NV(t){switch(t.tag){case 5:return ap(t.type);case 16:return ap("Lazy");case 13:return ap("Suspense");case 19:return ap("SuspenseList");case 0:case 2:case 15:return t=wb(t.type,!1),t;case 11:return t=wb(t.type.render,!1),t;case 1:return t=wb(t.type,!0),t;default:return""}}function NC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zf:return"Fragment";case $f:return"Portal";case wC:return"Profiler";case KE:return"StrictMode";case yC:return"Suspense";case bC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Q3:return(t.displayName||"Context")+".Consumer";case M3:return(t._context.displayName||"Context")+".Provider";case qE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case GE:return e=t.displayName||null,e!==null?e:NC(t.type)||"Memo";case hu:e=t._payload,t=t._init;try{return NC(t(e))}catch{}}return null}function CV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return NC(e);case 8:return e===KE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function H3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _V(t){var e=H3(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function A1(t){t._valueTracker||(t._valueTracker=_V(t))}function K3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=H3(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function gw(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function CC(t,e){var r=e.checked;return ys({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function F5(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Wu(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function q3(t,e){e=e.checked,e!=null&&HE(t,"checked",e,!1)}function _C(t,e){q3(t,e);var r=Wu(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?EC(t,e.type,r):e.hasOwnProperty("defaultValue")&&EC(t,e.type,Wu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function k5(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function EC(t,e,r){(e!=="number"||gw(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ip=Array.isArray;function l0(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Wu(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function BC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Qt(91));return ys({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function T5(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Qt(92));if(ip(r)){if(1<r.length)throw Error(Qt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Wu(r)}}function G3(t,e){var r=Wu(e.value),n=Wu(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function j5(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function SC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var u1,z3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(u1=u1||document.createElement("div"),u1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=u1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function cg(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ep={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EV=["Webkit","ms","Moz","O"];Object.keys(Ep).forEach(function(t){EV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ep[e]=Ep[t]})});function W3(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ep.hasOwnProperty(t)&&Ep[t]?(""+e).trim():e+"px"}function J3(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=W3(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var BV=ys({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function IC(t,e){if(e){if(BV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Qt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Qt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Qt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Qt(62))}}function FC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kC=null;function $E(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var TC=null,c0=null,A0=null;function P5(t){if(t=hx(t)){if(typeof TC!="function")throw Error(Qt(280));var e=t.stateNode;e&&(e=V2(e),TC(t.stateNode,t.type,e))}}function X3(t){c0?A0?A0.push(t):A0=[t]:c0=t}function Y3(){if(c0){var t=c0,e=A0;if(A0=c0=null,P5(t),e)for(t=0;t<e.length;t++)P5(e[t])}}function Z3(t,e){return t(e)}function eR(){}var yb=!1;function tR(t,e,r){if(yb)return t(e,r);yb=!0;try{return Z3(t,e,r)}finally{yb=!1,(c0!==null||A0!==null)&&(eR(),Y3())}}function Ag(t,e){var r=t.stateNode;if(r===null)return null;var n=V2(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Qt(231,e,typeof r));return r}var jC=!1;if(vA)try{var jm={};Object.defineProperty(jm,"passive",{get:function(){jC=!0}}),window.addEventListener("test",jm,jm),window.removeEventListener("test",jm,jm)}catch{jC=!1}function SV(t,e,r,n,s,a,o,l,c){var A=Array.prototype.slice.call(arguments,3);try{e.apply(r,A)}catch(u){this.onError(u)}}var Bp=!1,xw=null,vw=!1,PC=null,IV={onError:function(t){Bp=!0,xw=t}};function FV(t,e,r,n,s,a,o,l,c){Bp=!1,xw=null,SV.apply(IV,arguments)}function kV(t,e,r,n,s,a,o,l,c){if(FV.apply(this,arguments),Bp){if(Bp){var A=xw;Bp=!1,xw=null}else throw Error(Qt(198));vw||(vw=!0,PC=A)}}function Oh(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function rR(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function R5(t){if(Oh(t)!==t)throw Error(Qt(188))}function TV(t){var e=t.alternate;if(!e){if(e=Oh(t),e===null)throw Error(Qt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return R5(s),t;if(a===n)return R5(s),e;a=a.sibling}throw Error(Qt(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(Qt(189))}}if(r.alternate!==n)throw Error(Qt(190))}if(r.tag!==3)throw Error(Qt(188));return r.stateNode.current===r?t:e}function nR(t){return t=TV(t),t!==null?sR(t):null}function sR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=sR(t);if(e!==null)return e;t=t.sibling}return null}var aR=Bo.unstable_scheduleCallback,D5=Bo.unstable_cancelCallback,jV=Bo.unstable_shouldYield,PV=Bo.unstable_requestPaint,Os=Bo.unstable_now,RV=Bo.unstable_getCurrentPriorityLevel,zE=Bo.unstable_ImmediatePriority,iR=Bo.unstable_UserBlockingPriority,ww=Bo.unstable_NormalPriority,DV=Bo.unstable_LowPriority,oR=Bo.unstable_IdlePriority,U2=null,vc=null;function LV(t){if(vc&&typeof vc.onCommitFiberRoot=="function")try{vc.onCommitFiberRoot(U2,t,void 0,(t.current.flags&128)===128)}catch{}}var Pl=Math.clz32?Math.clz32:MV,UV=Math.log,OV=Math.LN2;function MV(t){return t>>>=0,t===0?32:31-(UV(t)/OV|0)|0}var d1=64,h1=4194304;function op(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function yw(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=op(l):(a&=o,a!==0&&(n=op(a)))}else o=r&~s,o!==0?n=op(o):a!==0&&(n=op(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Pl(e),s=1<<r,n|=t[r],e&=~s;return n}function QV(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VV(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-Pl(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=QV(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function RC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function lR(){var t=d1;return d1<<=1,!(d1&4194240)&&(d1=64),t}function bb(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ux(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pl(e),t[e]=r}function HV(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Pl(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function WE(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Pl(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Fn=0;function cR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var AR,JE,uR,dR,hR,DC=!1,f1=[],Pu=null,Ru=null,Du=null,ug=new Map,dg=new Map,pu=[],KV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function L5(t,e){switch(t){case"focusin":case"focusout":Pu=null;break;case"dragenter":case"dragleave":Ru=null;break;case"mouseover":case"mouseout":Du=null;break;case"pointerover":case"pointerout":ug.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":dg.delete(e.pointerId)}}function Pm(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=hx(e),e!==null&&JE(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function qV(t,e,r,n,s){switch(e){case"focusin":return Pu=Pm(Pu,t,e,r,n,s),!0;case"dragenter":return Ru=Pm(Ru,t,e,r,n,s),!0;case"mouseover":return Du=Pm(Du,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return ug.set(a,Pm(ug.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,dg.set(a,Pm(dg.get(a)||null,t,e,r,n,s)),!0}return!1}function fR(t){var e=Wd(t.target);if(e!==null){var r=Oh(e);if(r!==null){if(e=r.tag,e===13){if(e=rR(r),e!==null){t.blockedOn=e,hR(t.priority,function(){uR(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Mv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=LC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);kC=n,r.target.dispatchEvent(n),kC=null}else return e=hx(r),e!==null&&JE(e),t.blockedOn=r,!1;e.shift()}return!0}function U5(t,e,r){Mv(t)&&r.delete(e)}function GV(){DC=!1,Pu!==null&&Mv(Pu)&&(Pu=null),Ru!==null&&Mv(Ru)&&(Ru=null),Du!==null&&Mv(Du)&&(Du=null),ug.forEach(U5),dg.forEach(U5)}function Rm(t,e){t.blockedOn===e&&(t.blockedOn=null,DC||(DC=!0,Bo.unstable_scheduleCallback(Bo.unstable_NormalPriority,GV)))}function hg(t){function e(s){return Rm(s,t)}if(0<f1.length){Rm(f1[0],t);for(var r=1;r<f1.length;r++){var n=f1[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Pu!==null&&Rm(Pu,t),Ru!==null&&Rm(Ru,t),Du!==null&&Rm(Du,t),ug.forEach(e),dg.forEach(e),r=0;r<pu.length;r++)n=pu[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<pu.length&&(r=pu[0],r.blockedOn===null);)fR(r),r.blockedOn===null&&pu.shift()}var u0=IA.ReactCurrentBatchConfig,bw=!0;function $V(t,e,r,n){var s=Fn,a=u0.transition;u0.transition=null;try{Fn=1,XE(t,e,r,n)}finally{Fn=s,u0.transition=a}}function zV(t,e,r,n){var s=Fn,a=u0.transition;u0.transition=null;try{Fn=4,XE(t,e,r,n)}finally{Fn=s,u0.transition=a}}function XE(t,e,r,n){if(bw){var s=LC(t,e,r,n);if(s===null)Tb(t,e,n,Nw,r),L5(t,n);else if(qV(s,t,e,r,n))n.stopPropagation();else if(L5(t,n),e&4&&-1<KV.indexOf(t)){for(;s!==null;){var a=hx(s);if(a!==null&&AR(a),a=LC(t,e,r,n),a===null&&Tb(t,e,n,Nw,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Tb(t,e,n,null,r)}}var Nw=null;function LC(t,e,r,n){if(Nw=null,t=$E(n),t=Wd(t),t!==null)if(e=Oh(t),e===null)t=null;else if(r=e.tag,r===13){if(t=rR(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nw=t,null}function mR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RV()){case zE:return 1;case iR:return 4;case ww:case DV:return 16;case oR:return 536870912;default:return 16}default:return 16}}var _u=null,YE=null,Qv=null;function pR(){if(Qv)return Qv;var t,e=YE,r=e.length,n,s="value"in _u?_u.value:_u.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[a-n];n++);return Qv=s.slice(t,1<n?1-n:void 0)}function Vv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function m1(){return!0}function O5(){return!1}function To(t){function e(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?m1:O5,this.isPropagationStopped=O5,this}return ys(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=m1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=m1)},persist:function(){},isPersistent:m1}),e}var G0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ZE=To(G0),dx=ys({},G0,{view:0,detail:0}),WV=To(dx),Nb,Cb,Dm,O2=ys({},dx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eB,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Dm&&(Dm&&t.type==="mousemove"?(Nb=t.screenX-Dm.screenX,Cb=t.screenY-Dm.screenY):Cb=Nb=0,Dm=t),Nb)},movementY:function(t){return"movementY"in t?t.movementY:Cb}}),M5=To(O2),JV=ys({},O2,{dataTransfer:0}),XV=To(JV),YV=ys({},dx,{relatedTarget:0}),_b=To(YV),ZV=ys({},G0,{animationName:0,elapsedTime:0,pseudoElement:0}),e9=To(ZV),t9=ys({},G0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),r9=To(t9),n9=ys({},G0,{data:0}),Q5=To(n9),s9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function o9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=i9[t])?!!e[t]:!1}function eB(){return o9}var l9=ys({},dx,{key:function(t){if(t.key){var e=s9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Vv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?a9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eB,charCode:function(t){return t.type==="keypress"?Vv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),c9=To(l9),A9=ys({},O2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),V5=To(A9),u9=ys({},dx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eB}),d9=To(u9),h9=ys({},G0,{propertyName:0,elapsedTime:0,pseudoElement:0}),f9=To(h9),m9=ys({},O2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),p9=To(m9),g9=[9,13,27,32],tB=vA&&"CompositionEvent"in window,Sp=null;vA&&"documentMode"in document&&(Sp=document.documentMode);var x9=vA&&"TextEvent"in window&&!Sp,gR=vA&&(!tB||Sp&&8<Sp&&11>=Sp),H5=" ",K5=!1;function xR(t,e){switch(t){case"keyup":return g9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wf=!1;function v9(t,e){switch(t){case"compositionend":return vR(e);case"keypress":return e.which!==32?null:(K5=!0,H5);case"textInput":return t=e.data,t===H5&&K5?null:t;default:return null}}function w9(t,e){if(Wf)return t==="compositionend"||!tB&&xR(t,e)?(t=pR(),Qv=YE=_u=null,Wf=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gR&&e.locale!=="ko"?null:e.data;default:return null}}var y9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function q5(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!y9[t.type]:e==="textarea"}function wR(t,e,r,n){X3(n),e=Cw(e,"onChange"),0<e.length&&(r=new ZE("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ip=null,fg=null;function b9(t){kR(t,0)}function M2(t){var e=Yf(t);if(K3(e))return t}function N9(t,e){if(t==="change")return e}var yR=!1;if(vA){var Eb;if(vA){var Bb="oninput"in document;if(!Bb){var G5=document.createElement("div");G5.setAttribute("oninput","return;"),Bb=typeof G5.oninput=="function"}Eb=Bb}else Eb=!1;yR=Eb&&(!document.documentMode||9<document.documentMode)}function $5(){Ip&&(Ip.detachEvent("onpropertychange",bR),fg=Ip=null)}function bR(t){if(t.propertyName==="value"&&M2(fg)){var e=[];wR(e,fg,t,$E(t)),tR(b9,e)}}function C9(t,e,r){t==="focusin"?($5(),Ip=e,fg=r,Ip.attachEvent("onpropertychange",bR)):t==="focusout"&&$5()}function _9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return M2(fg)}function E9(t,e){if(t==="click")return M2(e)}function B9(t,e){if(t==="input"||t==="change")return M2(e)}function S9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ol=typeof Object.is=="function"?Object.is:S9;function mg(t,e){if(Ol(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!vC.call(e,s)||!Ol(t[s],e[s]))return!1}return!0}function z5(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function W5(t,e){var r=z5(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=z5(r)}}function NR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?NR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function CR(){for(var t=window,e=gw();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=gw(t.document)}return e}function rB(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function I9(t){var e=CR(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&NR(r.ownerDocument.documentElement,r)){if(n!==null&&rB(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=W5(r,a);var o=W5(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var F9=vA&&"documentMode"in document&&11>=document.documentMode,Jf=null,UC=null,Fp=null,OC=!1;function J5(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;OC||Jf==null||Jf!==gw(n)||(n=Jf,"selectionStart"in n&&rB(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fp&&mg(Fp,n)||(Fp=n,n=Cw(UC,"onSelect"),0<n.length&&(e=new ZE("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Jf)))}function p1(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Xf={animationend:p1("Animation","AnimationEnd"),animationiteration:p1("Animation","AnimationIteration"),animationstart:p1("Animation","AnimationStart"),transitionend:p1("Transition","TransitionEnd")},Sb={},_R={};vA&&(_R=document.createElement("div").style,"AnimationEvent"in window||(delete Xf.animationend.animation,delete Xf.animationiteration.animation,delete Xf.animationstart.animation),"TransitionEvent"in window||delete Xf.transitionend.transition);function Q2(t){if(Sb[t])return Sb[t];if(!Xf[t])return t;var e=Xf[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in _R)return Sb[t]=e[r];return t}var ER=Q2("animationend"),BR=Q2("animationiteration"),SR=Q2("animationstart"),IR=Q2("transitionend"),FR=new Map,X5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cd(t,e){FR.set(t,e),Uh(e,[t])}for(var Ib=0;Ib<X5.length;Ib++){var Fb=X5[Ib],k9=Fb.toLowerCase(),T9=Fb[0].toUpperCase()+Fb.slice(1);cd(k9,"on"+T9)}cd(ER,"onAnimationEnd");cd(BR,"onAnimationIteration");cd(SR,"onAnimationStart");cd("dblclick","onDoubleClick");cd("focusin","onFocus");cd("focusout","onBlur");cd(IR,"onTransitionEnd");N0("onMouseEnter",["mouseout","mouseover"]);N0("onMouseLeave",["mouseout","mouseover"]);N0("onPointerEnter",["pointerout","pointerover"]);N0("onPointerLeave",["pointerout","pointerover"]);Uh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),j9=new Set("cancel close invalid load scroll toggle".split(" ").concat(lp));function Y5(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,kV(n,e,void 0,t),t.currentTarget=null}function kR(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,A=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;Y5(s,l,A),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,A=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;Y5(s,l,A),a=c}}}if(vw)throw t=PC,vw=!1,PC=null,t}function Wn(t,e){var r=e[KC];r===void 0&&(r=e[KC]=new Set);var n=t+"__bubble";r.has(n)||(TR(e,t,2,!1),r.add(n))}function kb(t,e,r){var n=0;e&&(n|=4),TR(r,t,n,e)}var g1="_reactListening"+Math.random().toString(36).slice(2);function pg(t){if(!t[g1]){t[g1]=!0,O3.forEach(function(r){r!=="selectionchange"&&(j9.has(r)||kb(r,!1,t),kb(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[g1]||(e[g1]=!0,kb("selectionchange",!1,e))}}function TR(t,e,r,n){switch(mR(e)){case 1:var s=$V;break;case 4:s=zV;break;default:s=XE}r=s.bind(null,e,r,t),s=void 0,!jC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Tb(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Wd(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}tR(function(){var A=a,u=$E(r),d=[];e:{var f=FR.get(t);if(f!==void 0){var h=ZE,m=t;switch(t){case"keypress":if(Vv(r)===0)break e;case"keydown":case"keyup":h=c9;break;case"focusin":m="focus",h=_b;break;case"focusout":m="blur",h=_b;break;case"beforeblur":case"afterblur":h=_b;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=M5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=XV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=d9;break;case ER:case BR:case SR:h=e9;break;case IR:h=f9;break;case"scroll":h=WV;break;case"wheel":h=p9;break;case"copy":case"cut":case"paste":h=r9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=V5}var p=(e&4)!==0,x=!p&&t==="scroll",g=p?f!==null?f+"Capture":null:f;p=[];for(var y=A,b;y!==null;){b=y;var F=b.stateNode;if(b.tag===5&&F!==null&&(b=F,g!==null&&(F=Ag(y,g),F!=null&&p.push(gg(y,F,b)))),x)break;y=y.return}0<p.length&&(f=new h(f,m,null,r,u),d.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&r!==kC&&(m=r.relatedTarget||r.fromElement)&&(Wd(m)||m[wA]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=A,m=m?Wd(m):null,m!==null&&(x=Oh(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=A),h!==m)){if(p=M5,F="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=V5,F="onPointerLeave",g="onPointerEnter",y="pointer"),x=h==null?f:Yf(h),b=m==null?f:Yf(m),f=new p(F,y+"leave",h,r,u),f.target=x,f.relatedTarget=b,F=null,Wd(u)===A&&(p=new p(g,y+"enter",m,r,u),p.target=b,p.relatedTarget=x,F=p),x=F,h&&m)t:{for(p=h,g=m,y=0,b=p;b;b=ff(b))y++;for(b=0,F=g;F;F=ff(F))b++;for(;0<y-b;)p=ff(p),y--;for(;0<b-y;)g=ff(g),b--;for(;y--;){if(p===g||g!==null&&p===g.alternate)break t;p=ff(p),g=ff(g)}p=null}else p=null;h!==null&&Z5(d,f,h,p,!1),m!==null&&x!==null&&Z5(d,x,m,p,!0)}}e:{if(f=A?Yf(A):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var j=N9;else if(q5(f))if(yR)j=B9;else{j=_9;var R=C9}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(j=E9);if(j&&(j=j(t,A))){wR(d,j,r,u);break e}R&&R(t,f,A),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&EC(f,"number",f.value)}switch(R=A?Yf(A):window,t){case"focusin":(q5(R)||R.contentEditable==="true")&&(Jf=R,UC=A,Fp=null);break;case"focusout":Fp=UC=Jf=null;break;case"mousedown":OC=!0;break;case"contextmenu":case"mouseup":case"dragend":OC=!1,J5(d,r,u);break;case"selectionchange":if(F9)break;case"keydown":case"keyup":J5(d,r,u)}var E;if(tB)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Wf?xR(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(gR&&r.locale!=="ko"&&(Wf||S!=="onCompositionStart"?S==="onCompositionEnd"&&Wf&&(E=pR()):(_u=u,YE="value"in _u?_u.value:_u.textContent,Wf=!0)),R=Cw(A,S),0<R.length&&(S=new Q5(S,t,null,r,u),d.push({event:S,listeners:R}),E?S.data=E:(E=vR(r),E!==null&&(S.data=E)))),(E=x9?v9(t,r):w9(t,r))&&(A=Cw(A,"onBeforeInput"),0<A.length&&(u=new Q5("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:A}),u.data=E))}kR(d,e)})}function gg(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Cw(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Ag(t,r),a!=null&&n.unshift(gg(t,a,s)),a=Ag(t,e),a!=null&&n.push(gg(t,a,s))),t=t.return}return n}function ff(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Z5(t,e,r,n,s){for(var a=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,A=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&A!==null&&(l=A,s?(c=Ag(r,a),c!=null&&o.unshift(gg(r,c,l))):s||(c=Ag(r,a),c!=null&&o.push(gg(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var P9=/\r\n?/g,R9=/\u0000|\uFFFD/g;function e4(t){return(typeof t=="string"?t:""+t).replace(P9,`
`).replace(R9,"")}function x1(t,e,r){if(e=e4(e),e4(t)!==e&&r)throw Error(Qt(425))}function _w(){}var MC=null,QC=null;function VC(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var HC=typeof setTimeout=="function"?setTimeout:void 0,D9=typeof clearTimeout=="function"?clearTimeout:void 0,t4=typeof Promise=="function"?Promise:void 0,L9=typeof queueMicrotask=="function"?queueMicrotask:typeof t4<"u"?function(t){return t4.resolve(null).then(t).catch(U9)}:HC;function U9(t){setTimeout(function(){throw t})}function jb(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),hg(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);hg(e)}function Lu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function r4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var $0=Math.random().toString(36).slice(2),hc="__reactFiber$"+$0,xg="__reactProps$"+$0,wA="__reactContainer$"+$0,KC="__reactEvents$"+$0,O9="__reactListeners$"+$0,M9="__reactHandles$"+$0;function Wd(t){var e=t[hc];if(e)return e;for(var r=t.parentNode;r;){if(e=r[wA]||r[hc]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=r4(t);t!==null;){if(r=t[hc])return r;t=r4(t)}return e}t=r,r=t.parentNode}return null}function hx(t){return t=t[hc]||t[wA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qt(33))}function V2(t){return t[xg]||null}var qC=[],Zf=-1;function Ad(t){return{current:t}}function Yn(t){0>Zf||(t.current=qC[Zf],qC[Zf]=null,Zf--)}function Gn(t,e){Zf++,qC[Zf]=t.current,t.current=e}var Ju={},mi=Ad(Ju),zi=Ad(!1),mh=Ju;function C0(t,e){var r=t.type.contextTypes;if(!r)return Ju;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Wi(t){return t=t.childContextTypes,t!=null}function Ew(){Yn(zi),Yn(mi)}function n4(t,e,r){if(mi.current!==Ju)throw Error(Qt(168));Gn(mi,e),Gn(zi,r)}function jR(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Qt(108,CV(t)||"Unknown",s));return ys({},r,n)}function Bw(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ju,mh=mi.current,Gn(mi,t),Gn(zi,zi.current),!0}function s4(t,e,r){var n=t.stateNode;if(!n)throw Error(Qt(169));r?(t=jR(t,e,mh),n.__reactInternalMemoizedMergedChildContext=t,Yn(zi),Yn(mi),Gn(mi,t)):Yn(zi),Gn(zi,r)}var eA=null,H2=!1,Pb=!1;function PR(t){eA===null?eA=[t]:eA.push(t)}function Q9(t){H2=!0,PR(t)}function ud(){if(!Pb&&eA!==null){Pb=!0;var t=0,e=Fn;try{var r=eA;for(Fn=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}eA=null,H2=!1}catch(s){throw eA!==null&&(eA=eA.slice(t+1)),aR(zE,ud),s}finally{Fn=e,Pb=!1}}return null}var e0=[],t0=0,Sw=null,Iw=0,el=[],tl=0,ph=null,rA=1,nA="";function Dd(t,e){e0[t0++]=Iw,e0[t0++]=Sw,Sw=t,Iw=e}function RR(t,e,r){el[tl++]=rA,el[tl++]=nA,el[tl++]=ph,ph=t;var n=rA;t=nA;var s=32-Pl(n)-1;n&=~(1<<s),r+=1;var a=32-Pl(e)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,rA=1<<32-Pl(e)+s|r<<s|n,nA=a+t}else rA=1<<a|r<<s|n,nA=t}function nB(t){t.return!==null&&(Dd(t,1),RR(t,1,0))}function sB(t){for(;t===Sw;)Sw=e0[--t0],e0[t0]=null,Iw=e0[--t0],e0[t0]=null;for(;t===ph;)ph=el[--tl],el[tl]=null,nA=el[--tl],el[tl]=null,rA=el[--tl],el[tl]=null}var Eo=null,No=null,is=!1,kl=null;function DR(t,e){var r=nl(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function a4(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Eo=t,No=Lu(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Eo=t,No=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ph!==null?{id:rA,overflow:nA}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=nl(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Eo=t,No=null,!0):!1;default:return!1}}function GC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $C(t){if(is){var e=No;if(e){var r=e;if(!a4(t,e)){if(GC(t))throw Error(Qt(418));e=Lu(r.nextSibling);var n=Eo;e&&a4(t,e)?DR(n,r):(t.flags=t.flags&-4097|2,is=!1,Eo=t)}}else{if(GC(t))throw Error(Qt(418));t.flags=t.flags&-4097|2,is=!1,Eo=t}}}function i4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Eo=t}function v1(t){if(t!==Eo)return!1;if(!is)return i4(t),is=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!VC(t.type,t.memoizedProps)),e&&(e=No)){if(GC(t))throw LR(),Error(Qt(418));for(;e;)DR(t,e),e=Lu(e.nextSibling)}if(i4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){No=Lu(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}No=null}}else No=Eo?Lu(t.stateNode.nextSibling):null;return!0}function LR(){for(var t=No;t;)t=Lu(t.nextSibling)}function _0(){No=Eo=null,is=!1}function aB(t){kl===null?kl=[t]:kl.push(t)}var V9=IA.ReactCurrentBatchConfig;function Lm(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Qt(309));var n=r.stateNode}if(!n)throw Error(Qt(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(Qt(284));if(!r._owner)throw Error(Qt(290,t))}return t}function w1(t,e){throw t=Object.prototype.toString.call(e),Error(Qt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function o4(t){var e=t._init;return e(t._payload)}function UR(t){function e(g,y){if(t){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function r(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function s(g,y){return g=Qu(g,y),g.index=0,g.sibling=null,g}function a(g,y,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=2,y):b):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,y,b,F){return y===null||y.tag!==6?(y=Qb(b,g.mode,F),y.return=g,y):(y=s(y,b),y.return=g,y)}function c(g,y,b,F){var j=b.type;return j===zf?u(g,y,b.props.children,F,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===hu&&o4(j)===y.type)?(F=s(y,b.props),F.ref=Lm(g,y,b),F.return=g,F):(F=Wv(b.type,b.key,b.props,null,g.mode,F),F.ref=Lm(g,y,b),F.return=g,F)}function A(g,y,b,F){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Vb(b,g.mode,F),y.return=g,y):(y=s(y,b.children||[]),y.return=g,y)}function u(g,y,b,F,j){return y===null||y.tag!==7?(y=nh(b,g.mode,F,j),y.return=g,y):(y=s(y,b),y.return=g,y)}function d(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Qb(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case c1:return b=Wv(y.type,y.key,y.props,null,g.mode,b),b.ref=Lm(g,null,y),b.return=g,b;case $f:return y=Vb(y,g.mode,b),y.return=g,y;case hu:var F=y._init;return d(g,F(y._payload),b)}if(ip(y)||Tm(y))return y=nh(y,g.mode,b,null),y.return=g,y;w1(g,y)}return null}function f(g,y,b,F){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(g,y,""+b,F);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case c1:return b.key===j?c(g,y,b,F):null;case $f:return b.key===j?A(g,y,b,F):null;case hu:return j=b._init,f(g,y,j(b._payload),F)}if(ip(b)||Tm(b))return j!==null?null:u(g,y,b,F,null);w1(g,b)}return null}function h(g,y,b,F,j){if(typeof F=="string"&&F!==""||typeof F=="number")return g=g.get(b)||null,l(y,g,""+F,j);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case c1:return g=g.get(F.key===null?b:F.key)||null,c(y,g,F,j);case $f:return g=g.get(F.key===null?b:F.key)||null,A(y,g,F,j);case hu:var R=F._init;return h(g,y,b,R(F._payload),j)}if(ip(F)||Tm(F))return g=g.get(b)||null,u(y,g,F,j,null);w1(y,F)}return null}function m(g,y,b,F){for(var j=null,R=null,E=y,S=y=0,B=null;E!==null&&S<b.length;S++){E.index>S?(B=E,E=null):B=E.sibling;var U=f(g,E,b[S],F);if(U===null){E===null&&(E=B);break}t&&E&&U.alternate===null&&e(g,E),y=a(U,y,S),R===null?j=U:R.sibling=U,R=U,E=B}if(S===b.length)return r(g,E),is&&Dd(g,S),j;if(E===null){for(;S<b.length;S++)E=d(g,b[S],F),E!==null&&(y=a(E,y,S),R===null?j=E:R.sibling=E,R=E);return is&&Dd(g,S),j}for(E=n(g,E);S<b.length;S++)B=h(E,g,S,b[S],F),B!==null&&(t&&B.alternate!==null&&E.delete(B.key===null?S:B.key),y=a(B,y,S),R===null?j=B:R.sibling=B,R=B);return t&&E.forEach(function(k){return e(g,k)}),is&&Dd(g,S),j}function p(g,y,b,F){var j=Tm(b);if(typeof j!="function")throw Error(Qt(150));if(b=j.call(b),b==null)throw Error(Qt(151));for(var R=j=null,E=y,S=y=0,B=null,U=b.next();E!==null&&!U.done;S++,U=b.next()){E.index>S?(B=E,E=null):B=E.sibling;var k=f(g,E,U.value,F);if(k===null){E===null&&(E=B);break}t&&E&&k.alternate===null&&e(g,E),y=a(k,y,S),R===null?j=k:R.sibling=k,R=k,E=B}if(U.done)return r(g,E),is&&Dd(g,S),j;if(E===null){for(;!U.done;S++,U=b.next())U=d(g,U.value,F),U!==null&&(y=a(U,y,S),R===null?j=U:R.sibling=U,R=U);return is&&Dd(g,S),j}for(E=n(g,E);!U.done;S++,U=b.next())U=h(E,g,S,U.value,F),U!==null&&(t&&U.alternate!==null&&E.delete(U.key===null?S:U.key),y=a(U,y,S),R===null?j=U:R.sibling=U,R=U);return t&&E.forEach(function(T){return e(g,T)}),is&&Dd(g,S),j}function x(g,y,b,F){if(typeof b=="object"&&b!==null&&b.type===zf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case c1:e:{for(var j=b.key,R=y;R!==null;){if(R.key===j){if(j=b.type,j===zf){if(R.tag===7){r(g,R.sibling),y=s(R,b.props.children),y.return=g,g=y;break e}}else if(R.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===hu&&o4(j)===R.type){r(g,R.sibling),y=s(R,b.props),y.ref=Lm(g,R,b),y.return=g,g=y;break e}r(g,R);break}else e(g,R);R=R.sibling}b.type===zf?(y=nh(b.props.children,g.mode,F,b.key),y.return=g,g=y):(F=Wv(b.type,b.key,b.props,null,g.mode,F),F.ref=Lm(g,y,b),F.return=g,g=F)}return o(g);case $f:e:{for(R=b.key;y!==null;){if(y.key===R)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(g,y.sibling),y=s(y,b.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else e(g,y);y=y.sibling}y=Vb(b,g.mode,F),y.return=g,g=y}return o(g);case hu:return R=b._init,x(g,y,R(b._payload),F)}if(ip(b))return m(g,y,b,F);if(Tm(b))return p(g,y,b,F);w1(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(g,y.sibling),y=s(y,b),y.return=g,g=y):(r(g,y),y=Qb(b,g.mode,F),y.return=g,g=y),o(g)):r(g,y)}return x}var E0=UR(!0),OR=UR(!1),Fw=Ad(null),kw=null,r0=null,iB=null;function oB(){iB=r0=kw=null}function lB(t){var e=Fw.current;Yn(Fw),t._currentValue=e}function zC(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function d0(t,e){kw=t,iB=r0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Gi=!0),t.firstContext=null)}function Al(t){var e=t._currentValue;if(iB!==t)if(t={context:t,memoizedValue:e,next:null},r0===null){if(kw===null)throw Error(Qt(308));r0=t,kw.dependencies={lanes:0,firstContext:t}}else r0=r0.next=t;return e}var Jd=null;function cB(t){Jd===null?Jd=[t]:Jd.push(t)}function MR(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,cB(e)):(r.next=s.next,s.next=r),e.interleaved=r,yA(t,n)}function yA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var fu=!1;function AB(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function cA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Uu(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,cn&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,yA(t,r)}return s=n.interleaved,s===null?(e.next=e,cB(n)):(e.next=s.next,s.next=e),n.interleaved=e,yA(t,r)}function Hv(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,WE(t,r)}}function l4(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Tw(t,e,r,n){var s=t.updateQueue;fu=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,A=c.next;c.next=null,o===null?a=A:o.next=A,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=A:l.next=A,u.lastBaseUpdate=c))}if(a!==null){var d=s.baseState;o=0,u=A=c=null,l=a;do{var f=l.lane,h=l.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(f=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(h,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(h,d,f):m,f==null)break e;d=ys({},d,f);break e;case 2:fu=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(A=u=h,c=d):u=u.next=h,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(c=d),s.baseState=c,s.firstBaseUpdate=A,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);xh|=o,t.lanes=o,t.memoizedState=d}}function c4(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Qt(191,s));s.call(n)}}}var fx={},wc=Ad(fx),vg=Ad(fx),wg=Ad(fx);function Xd(t){if(t===fx)throw Error(Qt(174));return t}function uB(t,e){switch(Gn(wg,e),Gn(vg,t),Gn(wc,fx),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:SC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=SC(e,t)}Yn(wc),Gn(wc,e)}function B0(){Yn(wc),Yn(vg),Yn(wg)}function VR(t){Xd(wg.current);var e=Xd(wc.current),r=SC(e,t.type);e!==r&&(Gn(vg,t),Gn(wc,r))}function dB(t){vg.current===t&&(Yn(wc),Yn(vg))}var gs=Ad(0);function jw(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rb=[];function hB(){for(var t=0;t<Rb.length;t++)Rb[t]._workInProgressVersionPrimary=null;Rb.length=0}var Kv=IA.ReactCurrentDispatcher,Db=IA.ReactCurrentBatchConfig,gh=0,ws=null,ia=null,ya=null,Pw=!1,kp=!1,yg=0,H9=0;function Xa(){throw Error(Qt(321))}function fB(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ol(t[r],e[r]))return!1;return!0}function mB(t,e,r,n,s,a){if(gh=a,ws=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Kv.current=t===null||t.memoizedState===null?$9:z9,t=r(n,s),kp){a=0;do{if(kp=!1,yg=0,25<=a)throw Error(Qt(301));a+=1,ya=ia=null,e.updateQueue=null,Kv.current=W9,t=r(n,s)}while(kp)}if(Kv.current=Rw,e=ia!==null&&ia.next!==null,gh=0,ya=ia=ws=null,Pw=!1,e)throw Error(Qt(300));return t}function pB(){var t=yg!==0;return yg=0,t}function dc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ya===null?ws.memoizedState=ya=t:ya=ya.next=t,ya}function ul(){if(ia===null){var t=ws.alternate;t=t!==null?t.memoizedState:null}else t=ia.next;var e=ya===null?ws.memoizedState:ya.next;if(e!==null)ya=e,ia=t;else{if(t===null)throw Error(Qt(310));ia=t,t={memoizedState:ia.memoizedState,baseState:ia.baseState,baseQueue:ia.baseQueue,queue:ia.queue,next:null},ya===null?ws.memoizedState=ya=t:ya=ya.next=t}return ya}function bg(t,e){return typeof e=="function"?e(t):e}function Lb(t){var e=ul(),r=e.queue;if(r===null)throw Error(Qt(311));r.lastRenderedReducer=t;var n=ia,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,A=a;do{var u=A.lane;if((gh&u)===u)c!==null&&(c=c.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),n=A.hasEagerState?A.eagerState:t(n,A.action);else{var d={lane:u,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};c===null?(l=c=d,o=n):c=c.next=d,ws.lanes|=u,xh|=u}A=A.next}while(A!==null&&A!==a);c===null?o=n:c.next=l,Ol(n,e.memoizedState)||(Gi=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,ws.lanes|=a,xh|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Ub(t){var e=ul(),r=e.queue;if(r===null)throw Error(Qt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);Ol(a,e.memoizedState)||(Gi=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function HR(){}function KR(t,e){var r=ws,n=ul(),s=e(),a=!Ol(n.memoizedState,s);if(a&&(n.memoizedState=s,Gi=!0),n=n.queue,gB($R.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||ya!==null&&ya.memoizedState.tag&1){if(r.flags|=2048,Ng(9,GR.bind(null,r,n,s,e),void 0,null),_a===null)throw Error(Qt(349));gh&30||qR(r,e,s)}return s}function qR(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ws.updateQueue,e===null?(e={lastEffect:null,stores:null},ws.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function GR(t,e,r,n){e.value=r,e.getSnapshot=n,zR(e)&&WR(t)}function $R(t,e,r){return r(function(){zR(e)&&WR(t)})}function zR(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ol(t,r)}catch{return!0}}function WR(t){var e=yA(t,1);e!==null&&Rl(e,t,1,-1)}function A4(t){var e=dc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bg,lastRenderedState:t},e.queue=t,t=t.dispatch=G9.bind(null,ws,t),[e.memoizedState,t]}function Ng(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ws.updateQueue,e===null?(e={lastEffect:null,stores:null},ws.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function JR(){return ul().memoizedState}function qv(t,e,r,n){var s=dc();ws.flags|=t,s.memoizedState=Ng(1|e,r,void 0,n===void 0?null:n)}function K2(t,e,r,n){var s=ul();n=n===void 0?null:n;var a=void 0;if(ia!==null){var o=ia.memoizedState;if(a=o.destroy,n!==null&&fB(n,o.deps)){s.memoizedState=Ng(e,r,a,n);return}}ws.flags|=t,s.memoizedState=Ng(1|e,r,a,n)}function u4(t,e){return qv(8390656,8,t,e)}function gB(t,e){return K2(2048,8,t,e)}function XR(t,e){return K2(4,2,t,e)}function YR(t,e){return K2(4,4,t,e)}function ZR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function eD(t,e,r){return r=r!=null?r.concat([t]):null,K2(4,4,ZR.bind(null,e,t),r)}function xB(){}function tD(t,e){var r=ul();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&fB(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function rD(t,e){var r=ul();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&fB(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function nD(t,e,r){return gh&21?(Ol(r,e)||(r=lR(),ws.lanes|=r,xh|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Gi=!0),t.memoizedState=r)}function K9(t,e){var r=Fn;Fn=r!==0&&4>r?r:4,t(!0);var n=Db.transition;Db.transition={};try{t(!1),e()}finally{Fn=r,Db.transition=n}}function sD(){return ul().memoizedState}function q9(t,e,r){var n=Mu(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},aD(t))iD(e,r);else if(r=MR(t,e,r,n),r!==null){var s=Fi();Rl(r,t,n,s),oD(r,e,n)}}function G9(t,e,r){var n=Mu(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(aD(t))iD(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,Ol(l,o)){var c=e.interleaved;c===null?(s.next=s,cB(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=MR(t,e,s,n),r!==null&&(s=Fi(),Rl(r,t,n,s),oD(r,e,n))}}function aD(t){var e=t.alternate;return t===ws||e!==null&&e===ws}function iD(t,e){kp=Pw=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function oD(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,WE(t,r)}}var Rw={readContext:Al,useCallback:Xa,useContext:Xa,useEffect:Xa,useImperativeHandle:Xa,useInsertionEffect:Xa,useLayoutEffect:Xa,useMemo:Xa,useReducer:Xa,useRef:Xa,useState:Xa,useDebugValue:Xa,useDeferredValue:Xa,useTransition:Xa,useMutableSource:Xa,useSyncExternalStore:Xa,useId:Xa,unstable_isNewReconciler:!1},$9={readContext:Al,useCallback:function(t,e){return dc().memoizedState=[t,e===void 0?null:e],t},useContext:Al,useEffect:u4,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,qv(4194308,4,ZR.bind(null,e,t),r)},useLayoutEffect:function(t,e){return qv(4194308,4,t,e)},useInsertionEffect:function(t,e){return qv(4,2,t,e)},useMemo:function(t,e){var r=dc();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=dc();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=q9.bind(null,ws,t),[n.memoizedState,t]},useRef:function(t){var e=dc();return t={current:t},e.memoizedState=t},useState:A4,useDebugValue:xB,useDeferredValue:function(t){return dc().memoizedState=t},useTransition:function(){var t=A4(!1),e=t[0];return t=K9.bind(null,t[1]),dc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ws,s=dc();if(is){if(r===void 0)throw Error(Qt(407));r=r()}else{if(r=e(),_a===null)throw Error(Qt(349));gh&30||qR(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,u4($R.bind(null,n,a,t),[t]),n.flags|=2048,Ng(9,GR.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=dc(),e=_a.identifierPrefix;if(is){var r=nA,n=rA;r=(n&~(1<<32-Pl(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=yg++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=H9++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},z9={readContext:Al,useCallback:tD,useContext:Al,useEffect:gB,useImperativeHandle:eD,useInsertionEffect:XR,useLayoutEffect:YR,useMemo:rD,useReducer:Lb,useRef:JR,useState:function(){return Lb(bg)},useDebugValue:xB,useDeferredValue:function(t){var e=ul();return nD(e,ia.memoizedState,t)},useTransition:function(){var t=Lb(bg)[0],e=ul().memoizedState;return[t,e]},useMutableSource:HR,useSyncExternalStore:KR,useId:sD,unstable_isNewReconciler:!1},W9={readContext:Al,useCallback:tD,useContext:Al,useEffect:gB,useImperativeHandle:eD,useInsertionEffect:XR,useLayoutEffect:YR,useMemo:rD,useReducer:Ub,useRef:JR,useState:function(){return Ub(bg)},useDebugValue:xB,useDeferredValue:function(t){var e=ul();return ia===null?e.memoizedState=t:nD(e,ia.memoizedState,t)},useTransition:function(){var t=Ub(bg)[0],e=ul().memoizedState;return[t,e]},useMutableSource:HR,useSyncExternalStore:KR,useId:sD,unstable_isNewReconciler:!1};function Il(t,e){if(t&&t.defaultProps){e=ys({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function WC(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:ys({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var q2={isMounted:function(t){return(t=t._reactInternals)?Oh(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Fi(),s=Mu(t),a=cA(n,s);a.payload=e,r!=null&&(a.callback=r),e=Uu(t,a,s),e!==null&&(Rl(e,t,s,n),Hv(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Fi(),s=Mu(t),a=cA(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Uu(t,a,s),e!==null&&(Rl(e,t,s,n),Hv(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Fi(),n=Mu(t),s=cA(r,n);s.tag=2,e!=null&&(s.callback=e),e=Uu(t,s,n),e!==null&&(Rl(e,t,n,r),Hv(e,t,n))}};function d4(t,e,r,n,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,o):e.prototype&&e.prototype.isPureReactComponent?!mg(r,n)||!mg(s,a):!0}function lD(t,e,r){var n=!1,s=Ju,a=e.contextType;return typeof a=="object"&&a!==null?a=Al(a):(s=Wi(e)?mh:mi.current,n=e.contextTypes,a=(n=n!=null)?C0(t,s):Ju),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=q2,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function h4(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&q2.enqueueReplaceState(e,e.state,null)}function JC(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},AB(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Al(a):(a=Wi(e)?mh:mi.current,s.context=C0(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(WC(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&q2.enqueueReplaceState(s,s.state,null),Tw(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function S0(t,e){try{var r="",n=e;do r+=NV(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function Ob(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function XC(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var J9=typeof WeakMap=="function"?WeakMap:Map;function cD(t,e,r){r=cA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Lw||(Lw=!0,o_=n),XC(t,e)},r}function AD(t,e,r){r=cA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){XC(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){XC(t,e),typeof n!="function"&&(Ou===null?Ou=new Set([this]):Ou.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function f4(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new J9;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=AH.bind(null,t,e,r),e.then(t,t))}function m4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function p4(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=cA(-1,1),e.tag=2,Uu(r,e,1))),r.lanes|=1),t)}var X9=IA.ReactCurrentOwner,Gi=!1;function Ei(t,e,r,n){e.child=t===null?OR(e,null,r,n):E0(e,t.child,r,n)}function g4(t,e,r,n,s){r=r.render;var a=e.ref;return d0(e,s),n=mB(t,e,r,n,a,s),r=pB(),t!==null&&!Gi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bA(t,e,s)):(is&&r&&nB(e),e.flags|=1,Ei(t,e,n,s),e.child)}function x4(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!EB(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,uD(t,e,a,n,s)):(t=Wv(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:mg,r(o,n)&&t.ref===e.ref)return bA(t,e,s)}return e.flags|=1,t=Qu(a,n),t.ref=e.ref,t.return=e,e.child=t}function uD(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(mg(a,n)&&t.ref===e.ref)if(Gi=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Gi=!0);else return e.lanes=t.lanes,bA(t,e,s)}return YC(t,e,r,n,s)}function dD(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gn(s0,xo),xo|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Gn(s0,xo),xo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Gn(s0,xo),xo|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Gn(s0,xo),xo|=n;return Ei(t,e,s,r),e.child}function hD(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function YC(t,e,r,n,s){var a=Wi(r)?mh:mi.current;return a=C0(e,a),d0(e,s),r=mB(t,e,r,n,a,s),n=pB(),t!==null&&!Gi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bA(t,e,s)):(is&&n&&nB(e),e.flags|=1,Ei(t,e,r,s),e.child)}function v4(t,e,r,n,s){if(Wi(r)){var a=!0;Bw(e)}else a=!1;if(d0(e,s),e.stateNode===null)Gv(t,e),lD(e,r,n),JC(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,A=r.contextType;typeof A=="object"&&A!==null?A=Al(A):(A=Wi(r)?mh:mi.current,A=C0(e,A));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==A)&&h4(e,o,n,A),fu=!1;var f=e.memoizedState;o.state=f,Tw(e,n,o,s),c=e.memoizedState,l!==n||f!==c||zi.current||fu?(typeof u=="function"&&(WC(e,r,u,n),c=e.memoizedState),(l=fu||d4(e,r,l,n,f,c,A))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=A,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,QR(t,e),l=e.memoizedProps,A=e.type===e.elementType?l:Il(e.type,l),o.props=A,d=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Al(c):(c=Wi(r)?mh:mi.current,c=C0(e,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==c)&&h4(e,o,n,c),fu=!1,f=e.memoizedState,o.state=f,Tw(e,n,o,s);var m=e.memoizedState;l!==d||f!==m||zi.current||fu?(typeof h=="function"&&(WC(e,r,h,n),m=e.memoizedState),(A=fu||d4(e,r,A,n,f,m,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=A):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return ZC(t,e,r,n,a,s)}function ZC(t,e,r,n,s,a){hD(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&s4(e,r,!1),bA(t,e,a);n=e.stateNode,X9.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=E0(e,t.child,null,a),e.child=E0(e,null,l,a)):Ei(t,e,l,a),e.memoizedState=n.state,s&&s4(e,r,!0),e.child}function fD(t){var e=t.stateNode;e.pendingContext?n4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&n4(t,e.context,!1),uB(t,e.containerInfo)}function w4(t,e,r,n,s){return _0(),aB(s),e.flags|=256,Ei(t,e,r,n),e.child}var e_={dehydrated:null,treeContext:null,retryLane:0};function t_(t){return{baseLanes:t,cachePool:null,transitions:null}}function mD(t,e,r){var n=e.pendingProps,s=gs.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Gn(gs,s&1),t===null)return $C(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,a?(n=e.mode,a=e.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=z2(o,n,0,null),t=nh(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=t_(r),e.memoizedState=e_,t):vB(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Y9(t,e,o,n,l,s,r);if(a){a=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Qu(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=Qu(l,a):(a=nh(a,o,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,o=t.child.memoizedState,o=o===null?t_(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~r,e.memoizedState=e_,n}return a=t.child,t=a.sibling,n=Qu(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function vB(t,e){return e=z2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function y1(t,e,r,n){return n!==null&&aB(n),E0(e,t.child,null,r),t=vB(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Y9(t,e,r,n,s,a,o){if(r)return e.flags&256?(e.flags&=-257,n=Ob(Error(Qt(422))),y1(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=z2({mode:"visible",children:n.children},s,0,null),a=nh(a,s,o,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&E0(e,t.child,null,o),e.child.memoizedState=t_(o),e.memoizedState=e_,a);if(!(e.mode&1))return y1(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(Qt(419)),n=Ob(a,n,void 0),y1(t,e,o,n)}if(l=(o&t.childLanes)!==0,Gi||l){if(n=_a,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,yA(t,s),Rl(n,t,s,-1))}return _B(),n=Ob(Error(Qt(421))),y1(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=uH.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,No=Lu(s.nextSibling),Eo=e,is=!0,kl=null,t!==null&&(el[tl++]=rA,el[tl++]=nA,el[tl++]=ph,rA=t.id,nA=t.overflow,ph=e),e=vB(e,n.children),e.flags|=4096,e)}function y4(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),zC(t.return,e,r)}function Mb(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function pD(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Ei(t,e,n.children,r),n=gs.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&y4(t,r,e);else if(t.tag===19)y4(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Gn(gs,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&jw(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Mb(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&jw(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Mb(e,!0,r,null,a);break;case"together":Mb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),xh|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Qt(153));if(e.child!==null){for(t=e.child,r=Qu(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Qu(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Z9(t,e,r){switch(e.tag){case 3:fD(e),_0();break;case 5:VR(e);break;case 1:Wi(e.type)&&Bw(e);break;case 4:uB(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Gn(Fw,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Gn(gs,gs.current&1),e.flags|=128,null):r&e.child.childLanes?mD(t,e,r):(Gn(gs,gs.current&1),t=bA(t,e,r),t!==null?t.sibling:null);Gn(gs,gs.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return pD(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Gn(gs,gs.current),n)break;return null;case 22:case 23:return e.lanes=0,dD(t,e,r)}return bA(t,e,r)}var gD,r_,xD,vD;gD=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};r_=function(){};xD=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Xd(wc.current);var a=null;switch(r){case"input":s=CC(t,s),n=CC(t,n),a=[];break;case"select":s=ys({},s,{value:void 0}),n=ys({},n,{value:void 0}),a=[];break;case"textarea":s=BC(t,s),n=BC(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=_w)}IC(r,n);var o;r=null;for(A in s)if(!n.hasOwnProperty(A)&&s.hasOwnProperty(A)&&s[A]!=null)if(A==="style"){var l=s[A];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(lg.hasOwnProperty(A)?a||(a=[]):(a=a||[]).push(A,null));for(A in n){var c=n[A];if(l=s!=null?s[A]:void 0,n.hasOwnProperty(A)&&c!==l&&(c!=null||l!=null))if(A==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(A,r)),r=c;else A==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(A,c)):A==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(A,""+c):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(lg.hasOwnProperty(A)?(c!=null&&A==="onScroll"&&Wn("scroll",t),a||l===c||(a=[])):(a=a||[]).push(A,c))}r&&(a=a||[]).push("style",r);var A=a;(e.updateQueue=A)&&(e.flags|=4)}};vD=function(t,e,r,n){r!==n&&(e.flags|=4)};function Um(t,e){if(!is)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ya(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function eH(t,e,r){var n=e.pendingProps;switch(sB(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ya(e),null;case 1:return Wi(e.type)&&Ew(),Ya(e),null;case 3:return n=e.stateNode,B0(),Yn(zi),Yn(mi),hB(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(v1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,kl!==null&&(A_(kl),kl=null))),r_(t,e),Ya(e),null;case 5:dB(e);var s=Xd(wg.current);if(r=e.type,t!==null&&e.stateNode!=null)xD(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Qt(166));return Ya(e),null}if(t=Xd(wc.current),v1(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[hc]=e,n[xg]=a,t=(e.mode&1)!==0,r){case"dialog":Wn("cancel",n),Wn("close",n);break;case"iframe":case"object":case"embed":Wn("load",n);break;case"video":case"audio":for(s=0;s<lp.length;s++)Wn(lp[s],n);break;case"source":Wn("error",n);break;case"img":case"image":case"link":Wn("error",n),Wn("load",n);break;case"details":Wn("toggle",n);break;case"input":F5(n,a),Wn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Wn("invalid",n);break;case"textarea":T5(n,a),Wn("invalid",n)}IC(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&x1(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&x1(n.textContent,l,t),s=["children",""+l]):lg.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Wn("scroll",n)}switch(r){case"input":A1(n),k5(n,a,!0);break;case"textarea":A1(n),j5(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=_w)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$3(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[hc]=e,t[xg]=n,gD(t,e,!1,!1),e.stateNode=t;e:{switch(o=FC(r,n),r){case"dialog":Wn("cancel",t),Wn("close",t),s=n;break;case"iframe":case"object":case"embed":Wn("load",t),s=n;break;case"video":case"audio":for(s=0;s<lp.length;s++)Wn(lp[s],t);s=n;break;case"source":Wn("error",t),s=n;break;case"img":case"image":case"link":Wn("error",t),Wn("load",t),s=n;break;case"details":Wn("toggle",t),s=n;break;case"input":F5(t,n),s=CC(t,n),Wn("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=ys({},n,{value:void 0}),Wn("invalid",t);break;case"textarea":T5(t,n),s=BC(t,n),Wn("invalid",t);break;default:s=n}IC(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?J3(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&z3(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&cg(t,c):typeof c=="number"&&cg(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(lg.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Wn("scroll",t):c!=null&&HE(t,a,c,o))}switch(r){case"input":A1(t),k5(t,n,!1);break;case"textarea":A1(t),j5(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Wu(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?l0(t,!!n.multiple,a,!1):n.defaultValue!=null&&l0(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=_w)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ya(e),null;case 6:if(t&&e.stateNode!=null)vD(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Qt(166));if(r=Xd(wg.current),Xd(wc.current),v1(e)){if(n=e.stateNode,r=e.memoizedProps,n[hc]=e,(a=n.nodeValue!==r)&&(t=Eo,t!==null))switch(t.tag){case 3:x1(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&x1(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[hc]=e,e.stateNode=n}return Ya(e),null;case 13:if(Yn(gs),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(is&&No!==null&&e.mode&1&&!(e.flags&128))LR(),_0(),e.flags|=98560,a=!1;else if(a=v1(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(Qt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Qt(317));a[hc]=e}else _0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ya(e),a=!1}else kl!==null&&(A_(kl),kl=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||gs.current&1?Aa===0&&(Aa=3):_B())),e.updateQueue!==null&&(e.flags|=4),Ya(e),null);case 4:return B0(),r_(t,e),t===null&&pg(e.stateNode.containerInfo),Ya(e),null;case 10:return lB(e.type._context),Ya(e),null;case 17:return Wi(e.type)&&Ew(),Ya(e),null;case 19:if(Yn(gs),a=e.memoizedState,a===null)return Ya(e),null;if(n=(e.flags&128)!==0,o=a.rendering,o===null)if(n)Um(a,!1);else{if(Aa!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=jw(t),o!==null){for(e.flags|=128,Um(a,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Gn(gs,gs.current&1|2),e.child}t=t.sibling}a.tail!==null&&Os()>I0&&(e.flags|=128,n=!0,Um(a,!1),e.lanes=4194304)}else{if(!n)if(t=jw(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Um(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!is)return Ya(e),null}else 2*Os()-a.renderingStartTime>I0&&r!==1073741824&&(e.flags|=128,n=!0,Um(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(r=a.last,r!==null?r.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Os(),e.sibling=null,r=gs.current,Gn(gs,n?r&1|2:r&1),e):(Ya(e),null);case 22:case 23:return CB(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?xo&1073741824&&(Ya(e),e.subtreeFlags&6&&(e.flags|=8192)):Ya(e),null;case 24:return null;case 25:return null}throw Error(Qt(156,e.tag))}function tH(t,e){switch(sB(e),e.tag){case 1:return Wi(e.type)&&Ew(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return B0(),Yn(zi),Yn(mi),hB(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return dB(e),null;case 13:if(Yn(gs),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Qt(340));_0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Yn(gs),null;case 4:return B0(),null;case 10:return lB(e.type._context),null;case 22:case 23:return CB(),null;case 24:return null;default:return null}}var b1=!1,ui=!1,rH=typeof WeakSet=="function"?WeakSet:Set,nr=null;function n0(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bs(t,e,n)}else r.current=null}function n_(t,e,r){try{r()}catch(n){Bs(t,e,n)}}var b4=!1;function nH(t,e){if(MC=bw,t=CR(),rB(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,A=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==r||s!==0&&d.nodeType!==3||(l=o+s),d!==a||n!==0&&d.nodeType!==3||(c=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===r&&++A===s&&(l=o),f===a&&++u===n&&(c=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(QC={focusedElem:t,selectionRange:r},bw=!1,nr=e;nr!==null;)if(e=nr,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,nr=t;else for(;nr!==null;){e=nr;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:Il(e.type,p),x);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qt(163))}}catch(F){Bs(e,e.return,F)}if(t=e.sibling,t!==null){t.return=e.return,nr=t;break}nr=e.return}return m=b4,b4=!1,m}function Tp(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&n_(e,r,a)}s=s.next}while(s!==n)}}function G2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function s_(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function wD(t){var e=t.alternate;e!==null&&(t.alternate=null,wD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[hc],delete e[xg],delete e[KC],delete e[O9],delete e[M9])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yD(t){return t.tag===5||t.tag===3||t.tag===4}function N4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function a_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=_w));else if(n!==4&&(t=t.child,t!==null))for(a_(t,e,r),t=t.sibling;t!==null;)a_(t,e,r),t=t.sibling}function i_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(i_(t,e,r),t=t.sibling;t!==null;)i_(t,e,r),t=t.sibling}var Da=null,Fl=!1;function eu(t,e,r){for(r=r.child;r!==null;)bD(t,e,r),r=r.sibling}function bD(t,e,r){if(vc&&typeof vc.onCommitFiberUnmount=="function")try{vc.onCommitFiberUnmount(U2,r)}catch{}switch(r.tag){case 5:ui||n0(r,e);case 6:var n=Da,s=Fl;Da=null,eu(t,e,r),Da=n,Fl=s,Da!==null&&(Fl?(t=Da,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Da.removeChild(r.stateNode));break;case 18:Da!==null&&(Fl?(t=Da,r=r.stateNode,t.nodeType===8?jb(t.parentNode,r):t.nodeType===1&&jb(t,r),hg(t)):jb(Da,r.stateNode));break;case 4:n=Da,s=Fl,Da=r.stateNode.containerInfo,Fl=!0,eu(t,e,r),Da=n,Fl=s;break;case 0:case 11:case 14:case 15:if(!ui&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&n_(r,e,o),s=s.next}while(s!==n)}eu(t,e,r);break;case 1:if(!ui&&(n0(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Bs(r,e,l)}eu(t,e,r);break;case 21:eu(t,e,r);break;case 22:r.mode&1?(ui=(n=ui)||r.memoizedState!==null,eu(t,e,r),ui=n):eu(t,e,r);break;default:eu(t,e,r)}}function C4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new rH),e.forEach(function(n){var s=dH.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function bl(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Da=l.stateNode,Fl=!1;break e;case 3:Da=l.stateNode.containerInfo,Fl=!0;break e;case 4:Da=l.stateNode.containerInfo,Fl=!0;break e}l=l.return}if(Da===null)throw Error(Qt(160));bD(a,o,s),Da=null,Fl=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(A){Bs(s,e,A)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ND(e,t),e=e.sibling}function ND(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bl(e,t),sc(t),n&4){try{Tp(3,t,t.return),G2(3,t)}catch(p){Bs(t,t.return,p)}try{Tp(5,t,t.return)}catch(p){Bs(t,t.return,p)}}break;case 1:bl(e,t),sc(t),n&512&&r!==null&&n0(r,r.return);break;case 5:if(bl(e,t),sc(t),n&512&&r!==null&&n0(r,r.return),t.flags&32){var s=t.stateNode;try{cg(s,"")}catch(p){Bs(t,t.return,p)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=r!==null?r.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&q3(s,a),FC(l,o);var A=FC(l,a);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?J3(s,d):u==="dangerouslySetInnerHTML"?z3(s,d):u==="children"?cg(s,d):HE(s,u,d,A)}switch(l){case"input":_C(s,a);break;case"textarea":G3(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?l0(s,!!a.multiple,h,!1):f!==!!a.multiple&&(a.defaultValue!=null?l0(s,!!a.multiple,a.defaultValue,!0):l0(s,!!a.multiple,a.multiple?[]:"",!1))}s[xg]=a}catch(p){Bs(t,t.return,p)}}break;case 6:if(bl(e,t),sc(t),n&4){if(t.stateNode===null)throw Error(Qt(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(p){Bs(t,t.return,p)}}break;case 3:if(bl(e,t),sc(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{hg(e.containerInfo)}catch(p){Bs(t,t.return,p)}break;case 4:bl(e,t),sc(t);break;case 13:bl(e,t),sc(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(bB=Os())),n&4&&C4(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(ui=(A=ui)||u,bl(e,t),ui=A):bl(e,t),sc(t),n&8192){if(A=t.memoizedState!==null,(t.stateNode.isHidden=A)&&!u&&t.mode&1)for(nr=t,u=t.child;u!==null;){for(d=nr=u;nr!==null;){switch(f=nr,h=f.child,f.tag){case 0:case 11:case 14:case 15:Tp(4,f,f.return);break;case 1:n0(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Bs(n,r,p)}}break;case 5:n0(f,f.return);break;case 22:if(f.memoizedState!==null){E4(d);continue}}h!==null?(h.return=f,nr=h):E4(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,A?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=W3("display",o))}catch(p){Bs(t,t.return,p)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=A?"":d.memoizedProps}catch(p){Bs(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:bl(e,t),sc(t),n&4&&C4(t);break;case 21:break;default:bl(e,t),sc(t)}}function sc(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(yD(r)){var n=r;break e}r=r.return}throw Error(Qt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(cg(s,""),n.flags&=-33);var a=N4(t);i_(t,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=N4(t);a_(t,l,o);break;default:throw Error(Qt(161))}}catch(c){Bs(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function sH(t,e,r){nr=t,CD(t)}function CD(t,e,r){for(var n=(t.mode&1)!==0;nr!==null;){var s=nr,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||b1;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||ui;l=b1;var A=ui;if(b1=o,(ui=c)&&!A)for(nr=s;nr!==null;)o=nr,c=o.child,o.tag===22&&o.memoizedState!==null?B4(s):c!==null?(c.return=o,nr=c):B4(s);for(;a!==null;)nr=a,CD(a),a=a.sibling;nr=s,b1=l,ui=A}_4(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,nr=a):_4(t)}}function _4(t){for(;nr!==null;){var e=nr;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ui||G2(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ui)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Il(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&c4(e,a,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}c4(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var A=e.alternate;if(A!==null){var u=A.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&hg(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qt(163))}ui||e.flags&512&&s_(e)}catch(f){Bs(e,e.return,f)}}if(e===t){nr=null;break}if(r=e.sibling,r!==null){r.return=e.return,nr=r;break}nr=e.return}}function E4(t){for(;nr!==null;){var e=nr;if(e===t){nr=null;break}var r=e.sibling;if(r!==null){r.return=e.return,nr=r;break}nr=e.return}}function B4(t){for(;nr!==null;){var e=nr;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{G2(4,e)}catch(c){Bs(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Bs(e,s,c)}}var a=e.return;try{s_(e)}catch(c){Bs(e,a,c)}break;case 5:var o=e.return;try{s_(e)}catch(c){Bs(e,o,c)}}}catch(c){Bs(e,e.return,c)}if(e===t){nr=null;break}var l=e.sibling;if(l!==null){l.return=e.return,nr=l;break}nr=e.return}}var aH=Math.ceil,Dw=IA.ReactCurrentDispatcher,wB=IA.ReactCurrentOwner,ol=IA.ReactCurrentBatchConfig,cn=0,_a=null,Xs=null,Ga=0,xo=0,s0=Ad(0),Aa=0,Cg=null,xh=0,$2=0,yB=0,jp=null,qi=null,bB=0,I0=1/0,Zc=null,Lw=!1,o_=null,Ou=null,N1=!1,Eu=null,Uw=0,Pp=0,l_=null,$v=-1,zv=0;function Fi(){return cn&6?Os():$v!==-1?$v:$v=Os()}function Mu(t){return t.mode&1?cn&2&&Ga!==0?Ga&-Ga:V9.transition!==null?(zv===0&&(zv=lR()),zv):(t=Fn,t!==0||(t=window.event,t=t===void 0?16:mR(t.type)),t):1}function Rl(t,e,r,n){if(50<Pp)throw Pp=0,l_=null,Error(Qt(185));ux(t,r,n),(!(cn&2)||t!==_a)&&(t===_a&&(!(cn&2)&&($2|=r),Aa===4&&gu(t,Ga)),Ji(t,n),r===1&&cn===0&&!(e.mode&1)&&(I0=Os()+500,H2&&ud()))}function Ji(t,e){var r=t.callbackNode;VV(t,e);var n=yw(t,t===_a?Ga:0);if(n===0)r!==null&&D5(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&D5(r),e===1)t.tag===0?Q9(S4.bind(null,t)):PR(S4.bind(null,t)),L9(function(){!(cn&6)&&ud()}),r=null;else{switch(cR(n)){case 1:r=zE;break;case 4:r=iR;break;case 16:r=ww;break;case 536870912:r=oR;break;default:r=ww}r=TD(r,_D.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function _D(t,e){if($v=-1,zv=0,cn&6)throw Error(Qt(327));var r=t.callbackNode;if(h0()&&t.callbackNode!==r)return null;var n=yw(t,t===_a?Ga:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ow(t,n);else{e=n;var s=cn;cn|=2;var a=BD();(_a!==t||Ga!==e)&&(Zc=null,I0=Os()+500,rh(t,e));do try{lH();break}catch(l){ED(t,l)}while(!0);oB(),Dw.current=a,cn=s,Xs!==null?e=0:(_a=null,Ga=0,e=Aa)}if(e!==0){if(e===2&&(s=RC(t),s!==0&&(n=s,e=c_(t,s))),e===1)throw r=Cg,rh(t,0),gu(t,n),Ji(t,Os()),r;if(e===6)gu(t,n);else{if(s=t.current.alternate,!(n&30)&&!iH(s)&&(e=Ow(t,n),e===2&&(a=RC(t),a!==0&&(n=a,e=c_(t,a))),e===1))throw r=Cg,rh(t,0),gu(t,n),Ji(t,Os()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Qt(345));case 2:Ld(t,qi,Zc);break;case 3:if(gu(t,n),(n&130023424)===n&&(e=bB+500-Os(),10<e)){if(yw(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Fi(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=HC(Ld.bind(null,t,qi,Zc),e);break}Ld(t,qi,Zc);break;case 4:if(gu(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-Pl(n);a=1<<o,o=e[o],o>s&&(s=o),n&=~a}if(n=s,n=Os()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*aH(n/1960))-n,10<n){t.timeoutHandle=HC(Ld.bind(null,t,qi,Zc),n);break}Ld(t,qi,Zc);break;case 5:Ld(t,qi,Zc);break;default:throw Error(Qt(329))}}}return Ji(t,Os()),t.callbackNode===r?_D.bind(null,t):null}function c_(t,e){var r=jp;return t.current.memoizedState.isDehydrated&&(rh(t,e).flags|=256),t=Ow(t,e),t!==2&&(e=qi,qi=r,e!==null&&A_(e)),t}function A_(t){qi===null?qi=t:qi.push.apply(qi,t)}function iH(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Ol(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gu(t,e){for(e&=~yB,e&=~$2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Pl(e),n=1<<r;t[r]=-1,e&=~n}}function S4(t){if(cn&6)throw Error(Qt(327));h0();var e=yw(t,0);if(!(e&1))return Ji(t,Os()),null;var r=Ow(t,e);if(t.tag!==0&&r===2){var n=RC(t);n!==0&&(e=n,r=c_(t,n))}if(r===1)throw r=Cg,rh(t,0),gu(t,e),Ji(t,Os()),r;if(r===6)throw Error(Qt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ld(t,qi,Zc),Ji(t,Os()),null}function NB(t,e){var r=cn;cn|=1;try{return t(e)}finally{cn=r,cn===0&&(I0=Os()+500,H2&&ud())}}function vh(t){Eu!==null&&Eu.tag===0&&!(cn&6)&&h0();var e=cn;cn|=1;var r=ol.transition,n=Fn;try{if(ol.transition=null,Fn=1,t)return t()}finally{Fn=n,ol.transition=r,cn=e,!(cn&6)&&ud()}}function CB(){xo=s0.current,Yn(s0)}function rh(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,D9(r)),Xs!==null)for(r=Xs.return;r!==null;){var n=r;switch(sB(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ew();break;case 3:B0(),Yn(zi),Yn(mi),hB();break;case 5:dB(n);break;case 4:B0();break;case 13:Yn(gs);break;case 19:Yn(gs);break;case 10:lB(n.type._context);break;case 22:case 23:CB()}r=r.return}if(_a=t,Xs=t=Qu(t.current,null),Ga=xo=e,Aa=0,Cg=null,yB=$2=xh=0,qi=jp=null,Jd!==null){for(e=0;e<Jd.length;e++)if(r=Jd[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}Jd=null}return t}function ED(t,e){do{var r=Xs;try{if(oB(),Kv.current=Rw,Pw){for(var n=ws.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Pw=!1}if(gh=0,ya=ia=ws=null,kp=!1,yg=0,wB.current=null,r===null||r.return===null){Aa=1,Cg=e,Xs=null;break}e:{var a=t,o=r.return,l=r,c=e;if(e=Ga,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var A=c,u=l,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=m4(o);if(h!==null){h.flags&=-257,p4(h,o,l,a,e),h.mode&1&&f4(a,A,e),e=h,c=A;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){f4(a,A,e),_B();break e}c=Error(Qt(426))}}else if(is&&l.mode&1){var x=m4(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),p4(x,o,l,a,e),aB(S0(c,l));break e}}a=c=S0(c,l),Aa!==4&&(Aa=2),jp===null?jp=[a]:jp.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var g=cD(a,c,e);l4(a,g);break e;case 1:l=c;var y=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ou===null||!Ou.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e;var F=AD(a,l,e);l4(a,F);break e}}a=a.return}while(a!==null)}ID(r)}catch(j){e=j,Xs===r&&r!==null&&(Xs=r=r.return);continue}break}while(!0)}function BD(){var t=Dw.current;return Dw.current=Rw,t===null?Rw:t}function _B(){(Aa===0||Aa===3||Aa===2)&&(Aa=4),_a===null||!(xh&268435455)&&!($2&268435455)||gu(_a,Ga)}function Ow(t,e){var r=cn;cn|=2;var n=BD();(_a!==t||Ga!==e)&&(Zc=null,rh(t,e));do try{oH();break}catch(s){ED(t,s)}while(!0);if(oB(),cn=r,Dw.current=n,Xs!==null)throw Error(Qt(261));return _a=null,Ga=0,Aa}function oH(){for(;Xs!==null;)SD(Xs)}function lH(){for(;Xs!==null&&!jV();)SD(Xs)}function SD(t){var e=kD(t.alternate,t,xo);t.memoizedProps=t.pendingProps,e===null?ID(t):Xs=e,wB.current=null}function ID(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=tH(r,e),r!==null){r.flags&=32767,Xs=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Aa=6,Xs=null;return}}else if(r=eH(r,e,xo),r!==null){Xs=r;return}if(e=e.sibling,e!==null){Xs=e;return}Xs=e=t}while(e!==null);Aa===0&&(Aa=5)}function Ld(t,e,r){var n=Fn,s=ol.transition;try{ol.transition=null,Fn=1,cH(t,e,r,n)}finally{ol.transition=s,Fn=n}return null}function cH(t,e,r,n){do h0();while(Eu!==null);if(cn&6)throw Error(Qt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Qt(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(HV(t,a),t===_a&&(Xs=_a=null,Ga=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||N1||(N1=!0,TD(ww,function(){return h0(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=ol.transition,ol.transition=null;var o=Fn;Fn=1;var l=cn;cn|=4,wB.current=null,nH(t,r),ND(r,t),I9(QC),bw=!!MC,QC=MC=null,t.current=r,sH(r),PV(),cn=l,Fn=o,ol.transition=a}else t.current=r;if(N1&&(N1=!1,Eu=t,Uw=s),a=t.pendingLanes,a===0&&(Ou=null),LV(r.stateNode),Ji(t,Os()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Lw)throw Lw=!1,t=o_,o_=null,t;return Uw&1&&t.tag!==0&&h0(),a=t.pendingLanes,a&1?t===l_?Pp++:(Pp=0,l_=t):Pp=0,ud(),null}function h0(){if(Eu!==null){var t=cR(Uw),e=ol.transition,r=Fn;try{if(ol.transition=null,Fn=16>t?16:t,Eu===null)var n=!1;else{if(t=Eu,Eu=null,Uw=0,cn&6)throw Error(Qt(331));var s=cn;for(cn|=4,nr=t.current;nr!==null;){var a=nr,o=a.child;if(nr.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var A=l[c];for(nr=A;nr!==null;){var u=nr;switch(u.tag){case 0:case 11:case 15:Tp(8,u,a)}var d=u.child;if(d!==null)d.return=u,nr=d;else for(;nr!==null;){u=nr;var f=u.sibling,h=u.return;if(wD(u),u===A){nr=null;break}if(f!==null){f.return=h,nr=f;break}nr=h}}}var m=a.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}nr=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,nr=o;else e:for(;nr!==null;){if(a=nr,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Tp(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,nr=g;break e}nr=a.return}}var y=t.current;for(nr=y;nr!==null;){o=nr;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,nr=b;else e:for(o=y;nr!==null;){if(l=nr,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:G2(9,l)}}catch(j){Bs(l,l.return,j)}if(l===o){nr=null;break e}var F=l.sibling;if(F!==null){F.return=l.return,nr=F;break e}nr=l.return}}if(cn=s,ud(),vc&&typeof vc.onPostCommitFiberRoot=="function")try{vc.onPostCommitFiberRoot(U2,t)}catch{}n=!0}return n}finally{Fn=r,ol.transition=e}}return!1}function I4(t,e,r){e=S0(r,e),e=cD(t,e,1),t=Uu(t,e,1),e=Fi(),t!==null&&(ux(t,1,e),Ji(t,e))}function Bs(t,e,r){if(t.tag===3)I4(t,t,r);else for(;e!==null;){if(e.tag===3){I4(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ou===null||!Ou.has(n))){t=S0(r,t),t=AD(e,t,1),e=Uu(e,t,1),t=Fi(),e!==null&&(ux(e,1,t),Ji(e,t));break}}e=e.return}}function AH(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Fi(),t.pingedLanes|=t.suspendedLanes&r,_a===t&&(Ga&r)===r&&(Aa===4||Aa===3&&(Ga&130023424)===Ga&&500>Os()-bB?rh(t,0):yB|=r),Ji(t,e)}function FD(t,e){e===0&&(t.mode&1?(e=h1,h1<<=1,!(h1&130023424)&&(h1=4194304)):e=1);var r=Fi();t=yA(t,e),t!==null&&(ux(t,e,r),Ji(t,r))}function uH(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),FD(t,r)}function dH(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Qt(314))}n!==null&&n.delete(e),FD(t,r)}var kD;kD=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||zi.current)Gi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Gi=!1,Z9(t,e,r);Gi=!!(t.flags&131072)}else Gi=!1,is&&e.flags&1048576&&RR(e,Iw,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Gv(t,e),t=e.pendingProps;var s=C0(e,mi.current);d0(e,r),s=mB(null,e,n,t,s,r);var a=pB();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wi(n)?(a=!0,Bw(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,AB(e),s.updater=q2,e.stateNode=s,s._reactInternals=e,JC(e,n,t,r),e=ZC(null,e,n,!0,a,r)):(e.tag=0,is&&a&&nB(e),Ei(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Gv(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=fH(n),t=Il(n,t),s){case 0:e=YC(null,e,n,t,r);break e;case 1:e=v4(null,e,n,t,r);break e;case 11:e=g4(null,e,n,t,r);break e;case 14:e=x4(null,e,n,Il(n.type,t),r);break e}throw Error(Qt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Il(n,s),YC(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Il(n,s),v4(t,e,n,s,r);case 3:e:{if(fD(e),t===null)throw Error(Qt(387));n=e.pendingProps,a=e.memoizedState,s=a.element,QR(t,e),Tw(e,n,null,r);var o=e.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=S0(Error(Qt(423)),e),e=w4(t,e,n,r,s);break e}else if(n!==s){s=S0(Error(Qt(424)),e),e=w4(t,e,n,r,s);break e}else for(No=Lu(e.stateNode.containerInfo.firstChild),Eo=e,is=!0,kl=null,r=OR(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_0(),n===s){e=bA(t,e,r);break e}Ei(t,e,n,r)}e=e.child}return e;case 5:return VR(e),t===null&&$C(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,VC(n,s)?o=null:a!==null&&VC(n,a)&&(e.flags|=32),hD(t,e),Ei(t,e,o,r),e.child;case 6:return t===null&&$C(e),null;case 13:return mD(t,e,r);case 4:return uB(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=E0(e,null,n,r):Ei(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Il(n,s),g4(t,e,n,s,r);case 7:return Ei(t,e,e.pendingProps,r),e.child;case 8:return Ei(t,e,e.pendingProps.children,r),e.child;case 12:return Ei(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,Gn(Fw,n._currentValue),n._currentValue=o,a!==null)if(Ol(a.value,o)){if(a.children===s.children&&!zi.current){e=bA(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=cA(-1,r&-r),c.tag=2;var A=a.updateQueue;if(A!==null){A=A.shared;var u=A.pending;u===null?c.next=c:(c.next=u.next,u.next=c),A.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),zC(a.return,r,e),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Qt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),zC(o,r,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Ei(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,d0(e,r),s=Al(s),n=n(s),e.flags|=1,Ei(t,e,n,r),e.child;case 14:return n=e.type,s=Il(n,e.pendingProps),s=Il(n.type,s),x4(t,e,n,s,r);case 15:return uD(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Il(n,s),Gv(t,e),e.tag=1,Wi(n)?(t=!0,Bw(e)):t=!1,d0(e,r),lD(e,n,s),JC(e,n,s,r),ZC(null,e,n,!0,t,r);case 19:return pD(t,e,r);case 22:return dD(t,e,r)}throw Error(Qt(156,e.tag))};function TD(t,e){return aR(t,e)}function hH(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nl(t,e,r,n){return new hH(t,e,r,n)}function EB(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fH(t){if(typeof t=="function")return EB(t)?1:0;if(t!=null){if(t=t.$$typeof,t===qE)return 11;if(t===GE)return 14}return 2}function Qu(t,e){var r=t.alternate;return r===null?(r=nl(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Wv(t,e,r,n,s,a){var o=2;if(n=t,typeof t=="function")EB(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case zf:return nh(r.children,s,a,e);case KE:o=8,s|=8;break;case wC:return t=nl(12,r,e,s|2),t.elementType=wC,t.lanes=a,t;case yC:return t=nl(13,r,e,s),t.elementType=yC,t.lanes=a,t;case bC:return t=nl(19,r,e,s),t.elementType=bC,t.lanes=a,t;case V3:return z2(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case M3:o=10;break e;case Q3:o=9;break e;case qE:o=11;break e;case GE:o=14;break e;case hu:o=16,n=null;break e}throw Error(Qt(130,t==null?t:typeof t,""))}return e=nl(o,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function nh(t,e,r,n){return t=nl(7,t,n,e),t.lanes=r,t}function z2(t,e,r,n){return t=nl(22,t,n,e),t.elementType=V3,t.lanes=r,t.stateNode={isHidden:!1},t}function Qb(t,e,r){return t=nl(6,t,null,e),t.lanes=r,t}function Vb(t,e,r){return e=nl(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mH(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bb(0),this.expirationTimes=bb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bb(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function BB(t,e,r,n,s,a,o,l,c){return t=new mH(t,e,r,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=nl(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},AB(a),t}function pH(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$f,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function jD(t){if(!t)return Ju;t=t._reactInternals;e:{if(Oh(t)!==t||t.tag!==1)throw Error(Qt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Qt(171))}if(t.tag===1){var r=t.type;if(Wi(r))return jR(t,r,e)}return e}function PD(t,e,r,n,s,a,o,l,c){return t=BB(r,n,!0,t,s,a,o,l,c),t.context=jD(null),r=t.current,n=Fi(),s=Mu(r),a=cA(n,s),a.callback=e??null,Uu(r,a,s),t.current.lanes=s,ux(t,s,n),Ji(t,n),t}function W2(t,e,r,n){var s=e.current,a=Fi(),o=Mu(s);return r=jD(r),e.context===null?e.context=r:e.pendingContext=r,e=cA(a,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Uu(s,e,o),t!==null&&(Rl(t,s,o,a),Hv(t,s,o)),o}function Mw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function F4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function SB(t,e){F4(t,e),(t=t.alternate)&&F4(t,e)}function gH(){return null}var RD=typeof reportError=="function"?reportError:function(t){console.error(t)};function IB(t){this._internalRoot=t}J2.prototype.render=IB.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Qt(409));W2(t,e,null,null)};J2.prototype.unmount=IB.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vh(function(){W2(null,t,null,null)}),e[wA]=null}};function J2(t){this._internalRoot=t}J2.prototype.unstable_scheduleHydration=function(t){if(t){var e=dR();t={blockedOn:null,target:t,priority:e};for(var r=0;r<pu.length&&e!==0&&e<pu[r].priority;r++);pu.splice(r,0,t),r===0&&fR(t)}};function FB(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function X2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function k4(){}function xH(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var A=Mw(o);a.call(A)}}var o=PD(e,n,t,0,null,!1,!1,"",k4);return t._reactRootContainer=o,t[wA]=o.current,pg(t.nodeType===8?t.parentNode:t),vh(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var A=Mw(c);l.call(A)}}var c=BB(t,0,!1,null,null,!1,!1,"",k4);return t._reactRootContainer=c,t[wA]=c.current,pg(t.nodeType===8?t.parentNode:t),vh(function(){W2(e,c,r,n)}),c}function Y2(t,e,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=Mw(o);l.call(c)}}W2(e,o,t,s)}else o=xH(r,e,t,s,n);return Mw(o)}AR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=op(e.pendingLanes);r!==0&&(WE(e,r|1),Ji(e,Os()),!(cn&6)&&(I0=Os()+500,ud()))}break;case 13:vh(function(){var n=yA(t,1);if(n!==null){var s=Fi();Rl(n,t,1,s)}}),SB(t,1)}};JE=function(t){if(t.tag===13){var e=yA(t,134217728);if(e!==null){var r=Fi();Rl(e,t,134217728,r)}SB(t,134217728)}};uR=function(t){if(t.tag===13){var e=Mu(t),r=yA(t,e);if(r!==null){var n=Fi();Rl(r,t,e,n)}SB(t,e)}};dR=function(){return Fn};hR=function(t,e){var r=Fn;try{return Fn=t,e()}finally{Fn=r}};TC=function(t,e,r){switch(e){case"input":if(_C(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=V2(n);if(!s)throw Error(Qt(90));K3(n),_C(n,s)}}}break;case"textarea":G3(t,r);break;case"select":e=r.value,e!=null&&l0(t,!!r.multiple,e,!1)}};Z3=NB;eR=vh;var vH={usingClientEntryPoint:!1,Events:[hx,Yf,V2,X3,Y3,NB]},Om={findFiberByHostInstance:Wd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wH={bundleType:Om.bundleType,version:Om.version,rendererPackageName:Om.rendererPackageName,rendererConfig:Om.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:IA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nR(t),t===null?null:t.stateNode},findFiberByHostInstance:Om.findFiberByHostInstance||gH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var C1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!C1.isDisabled&&C1.supportsFiber)try{U2=C1.inject(wH),vc=C1}catch{}}ko.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vH;ko.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!FB(e))throw Error(Qt(200));return pH(t,e,null,r)};ko.createRoot=function(t,e){if(!FB(t))throw Error(Qt(299));var r=!1,n="",s=RD;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=BB(t,1,!1,null,null,r,!1,n,s),t[wA]=e.current,pg(t.nodeType===8?t.parentNode:t),new IB(e)};ko.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Qt(188)):(t=Object.keys(t).join(","),Error(Qt(268,t)));return t=nR(e),t=t===null?null:t.stateNode,t};ko.flushSync=function(t){return vh(t)};ko.hydrate=function(t,e,r){if(!X2(e))throw Error(Qt(200));return Y2(null,t,e,!0,r)};ko.hydrateRoot=function(t,e,r){if(!FB(t))throw Error(Qt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=RD;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=PD(e,null,t,1,r??null,s,!1,a,o),t[wA]=e.current,pg(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new J2(e)};ko.render=function(t,e,r){if(!X2(e))throw Error(Qt(200));return Y2(null,t,e,!1,r)};ko.unmountComponentAtNode=function(t){if(!X2(t))throw Error(Qt(40));return t._reactRootContainer?(vh(function(){Y2(null,null,t,!1,function(){t._reactRootContainer=null,t[wA]=null})}),!0):!1};ko.unstable_batchedUpdates=NB;ko.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!X2(r))throw Error(Qt(200));if(t==null||t._reactInternals===void 0)throw Error(Qt(38));return Y2(t,e,r,!1,n)};ko.version="18.3.1-next-f1338f8080-20240426";function DD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DD)}catch(t){console.error(t)}}DD(),D3.exports=ko;var wh=D3.exports,T4=wh;xC.createRoot=T4.createRoot,xC.hydrateRoot=T4.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var j4="popstate";function yH(t={}){function e(n,s){let{pathname:a,search:o,hash:l}=n.location;return u_("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:_g(s)}return NH(e,r,null,t)}function As(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ml(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bH(){return Math.random().toString(36).substring(2,10)}function P4(t,e){return{usr:t.state,key:t.key,idx:e}}function u_(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?z0(e):e,state:r,key:e&&e.key||n||bH()}}function _g({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function z0(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function NH(t,e,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",c=null,A=u();A==null&&(A=0,o.replaceState({...o.state,idx:A},""));function u(){return(o.state||{idx:null}).idx}function d(){l="POP";let x=u(),g=x==null?null:x-A;A=x,c&&c({action:l,location:p.location,delta:g})}function f(x,g){l="PUSH";let y=u_(p.location,x,g);A=u()+1;let b=P4(y,A),F=p.createHref(y);try{o.pushState(b,"",F)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(F)}a&&c&&c({action:l,location:p.location,delta:1})}function h(x,g){l="REPLACE";let y=u_(p.location,x,g);A=u();let b=P4(y,A),F=p.createHref(y);o.replaceState(b,"",F),a&&c&&c({action:l,location:p.location,delta:0})}function m(x){return CH(x)}let p={get action(){return l},get location(){return t(s,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(j4,d),c=x,()=>{s.removeEventListener(j4,d),c=null}},createHref(x){return e(s,x)},createURL:m,encodeLocation(x){let g=m(x);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(x){return o.go(x)}};return p}function CH(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),As(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:_g(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function LD(t,e,r="/"){return _H(t,e,r,!1)}function _H(t,e,r,n){let s=typeof e=="string"?z0(e):e,a=NA(s.pathname||"/",r);if(a==null)return null;let o=UD(t);EH(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let A=LH(a);l=RH(o[c],A,n)}return l}function UD(t,e=[],r=[],n="",s=!1){let a=(o,l,c=s,A)=>{let u={relativePath:A===void 0?o.path||"":A,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&c)return;As(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let d=AA([n,u.relativePath]),f=r.concat(u);o.children&&o.children.length>0&&(As(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),UD(o.children,e,f,d,c)),!(o.path==null&&!o.index)&&e.push({path:d,score:jH(d,o.index),routesMeta:f})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let A of OD(o.path))a(o,l,!0,A)}),e}function OD(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=OD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function EH(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:PH(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var BH=/^:[\w-]+$/,SH=3,IH=2,FH=1,kH=10,TH=-2,R4=t=>t==="*";function jH(t,e){let r=t.split("/"),n=r.length;return r.some(R4)&&(n+=TH),e&&(n+=IH),r.filter(s=>!R4(s)).reduce((s,a)=>s+(BH.test(a)?SH:a===""?FH:kH),n)}function PH(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function RH(t,e,r=!1){let{routesMeta:n}=t,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],A=l===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",d=Qw({path:c.relativePath,caseSensitive:c.caseSensitive,end:A},u),f=c.route;if(!d&&A&&r&&!n[n.length-1].route.index&&(d=Qw({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:AA([a,d.pathname]),pathnameBase:QH(AA([a,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(a=AA([a,d.pathnameBase]))}return o}function Qw(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=DH(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((A,{paramName:u,isOptional:d},f)=>{if(u==="*"){let m=l[f]||"";o=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[f];return d&&!h?A[u]=void 0:A[u]=(h||"").replace(/%2F/g,"/"),A},{}),pathname:a,pathnameBase:o,pattern:t}}function DH(t,e=!1,r=!0){Ml(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function LH(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ml(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function NA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function UH(t,e="/"){let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?z0(t):t;return{pathname:r?r.startsWith("/")?r:OH(r,e):e,search:VH(n),hash:HH(s)}}function OH(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Hb(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function MH(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function kB(t){let e=MH(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function TB(t,e,r,n=!1){let s;typeof t=="string"?s=z0(t):(s={...t},As(!s.pathname||!s.pathname.includes("?"),Hb("?","pathname","search",s)),As(!s.pathname||!s.pathname.includes("#"),Hb("#","pathname","hash",s)),As(!s.search||!s.search.includes("#"),Hb("#","search","hash",s)));let a=t===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let d=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}l=d>=0?e[d]:"/"}let c=UH(s,l),A=o&&o!=="/"&&o.endsWith("/"),u=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(A||u)&&(c.pathname+="/"),c}var AA=t=>t.join("/").replace(/\/\/+/g,"/"),QH=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VH=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,HH=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function KH(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var MD=["POST","PUT","PATCH","DELETE"];new Set(MD);var qH=["GET",...MD];new Set(qH);var W0=N.createContext(null);W0.displayName="DataRouter";var Z2=N.createContext(null);Z2.displayName="DataRouterState";N.createContext(!1);var QD=N.createContext({isTransitioning:!1});QD.displayName="ViewTransition";var GH=N.createContext(new Map);GH.displayName="Fetchers";var $H=N.createContext(null);$H.displayName="Await";var Kl=N.createContext(null);Kl.displayName="Navigation";var mx=N.createContext(null);mx.displayName="Location";var ql=N.createContext({outlet:null,matches:[],isDataRoute:!1});ql.displayName="Route";var jB=N.createContext(null);jB.displayName="RouteError";function zH(t,{relative:e}={}){As(J0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=N.useContext(Kl),{hash:s,pathname:a,search:o}=px(t,{relative:e}),l=a;return r!=="/"&&(l=a==="/"?r:AA([r,a])),n.createHref({pathname:l,search:o,hash:s})}function J0(){return N.useContext(mx)!=null}function dd(){return As(J0(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(mx).location}var VD="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function HD(t){N.useContext(Kl).static||N.useLayoutEffect(t)}function ey(){let{isDataRoute:t}=N.useContext(ql);return t?cK():WH()}function WH(){As(J0(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(W0),{basename:e,navigator:r}=N.useContext(Kl),{matches:n}=N.useContext(ql),{pathname:s}=dd(),a=JSON.stringify(kB(n)),o=N.useRef(!1);return HD(()=>{o.current=!0}),N.useCallback((c,A={})=>{if(Ml(o.current,VD),!o.current)return;if(typeof c=="number"){r.go(c);return}let u=TB(c,JSON.parse(a),s,A.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:AA([e,u.pathname])),(A.replace?r.replace:r.push)(u,A.state,A)},[e,r,a,s,t])}var JH=N.createContext(null);function XH(t){let e=N.useContext(ql).outlet;return e&&N.createElement(JH.Provider,{value:t},e)}function px(t,{relative:e}={}){let{matches:r}=N.useContext(ql),{pathname:n}=dd(),s=JSON.stringify(kB(r));return N.useMemo(()=>TB(t,JSON.parse(s),n,e==="path"),[t,s,n,e])}function YH(t,e){return KD(t,e)}function KD(t,e,r,n){var g;As(J0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=N.useContext(Kl),{matches:a}=N.useContext(ql),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",A=o?o.pathnameBase:"/",u=o&&o.route;{let y=u&&u.path||"";qD(c,!u||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let d=dd(),f;if(e){let y=typeof e=="string"?z0(e):e;As(A==="/"||((g=y.pathname)==null?void 0:g.startsWith(A)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${y.pathname}" was given in the \`location\` prop.`),f=y}else f=d;let h=f.pathname||"/",m=h;if(A!=="/"){let y=A.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=LD(t,{pathname:m});Ml(u||p!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Ml(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=nK(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:AA([A,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?A:AA([A,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,r,n);return e&&x?N.createElement(mx.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},x):x}function ZH(){let t=lK(),e=KH(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:a},"ErrorBoundary")," or"," ",N.createElement("code",{style:a},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),r?N.createElement("pre",{style:s},r):null,o)}var eK=N.createElement(ZH,null),tK=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?N.createElement(ql.Provider,{value:this.props.routeContext},N.createElement(jB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function rK({routeContext:t,match:e,children:r}){let n=N.useContext(W0);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(ql.Provider,{value:t},r)}function nK(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,a=r==null?void 0:r.errors;if(a!=null){let c=s.findIndex(A=>A.route.id&&(a==null?void 0:a[A.route.id])!==void 0);As(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let A=s[c];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(l=c),A.route.id){let{loaderData:u,errors:d}=r,f=A.route.loader&&!u.hasOwnProperty(A.route.id)&&(!d||d[A.route.id]===void 0);if(A.route.lazy||f){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,A,u)=>{let d,f=!1,h=null,m=null;r&&(d=a&&A.route.id?a[A.route.id]:void 0,h=A.route.errorElement||eK,o&&(l<0&&u===0?(qD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):l===u&&(f=!0,m=A.route.hydrateFallbackElement||null)));let p=e.concat(s.slice(0,u+1)),x=()=>{let g;return d?g=h:f?g=m:A.route.Component?g=N.createElement(A.route.Component,null):A.route.element?g=A.route.element:g=c,N.createElement(rK,{match:A,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:g})};return r&&(A.route.ErrorBoundary||A.route.errorElement||u===0)?N.createElement(tK,{location:r.location,revalidation:r.revalidation,component:h,error:d,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function PB(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sK(t){let e=N.useContext(W0);return As(e,PB(t)),e}function aK(t){let e=N.useContext(Z2);return As(e,PB(t)),e}function iK(t){let e=N.useContext(ql);return As(e,PB(t)),e}function RB(t){let e=iK(t),r=e.matches[e.matches.length-1];return As(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function oK(){return RB("useRouteId")}function lK(){var n;let t=N.useContext(jB),e=aK("useRouteError"),r=RB("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function cK(){let{router:t}=sK("useNavigate"),e=RB("useNavigate"),r=N.useRef(!1);return HD(()=>{r.current=!0}),N.useCallback(async(s,a={})=>{Ml(r.current,VD),r.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...a}))},[t,e])}var D4={};function qD(t,e,r){!e&&!D4[t]&&(D4[t]=!0,Ml(!1,r))}N.memo(AK);function AK({routes:t,future:e,state:r}){return KD(t,void 0,r,e)}function Ud({to:t,replace:e,state:r,relative:n}){As(J0(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=N.useContext(Kl);Ml(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=N.useContext(ql),{pathname:o}=dd(),l=ey(),c=TB(t,kB(a),o,n==="path"),A=JSON.stringify(c);return N.useEffect(()=>{l(JSON.parse(A),{replace:e,state:r,relative:n})},[l,A,n,e,r]),null}function uK(t){return XH(t.context)}function Ur(t){As(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dK({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:s,static:a=!1}){As(!J0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof r=="string"&&(r=z0(r));let{pathname:c="/",search:A="",hash:u="",state:d=null,key:f="default"}=r,h=N.useMemo(()=>{let m=NA(c,o);return m==null?null:{location:{pathname:m,search:A,hash:u,state:d,key:f},navigationType:n}},[o,c,A,u,d,f,n]);return Ml(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${A}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:N.createElement(Kl.Provider,{value:l},N.createElement(mx.Provider,{children:e,value:h}))}function hK({children:t,location:e}){return YH(d_(t),e)}function d_(t,e=[]){let r=[];return N.Children.forEach(t,(n,s)=>{if(!N.isValidElement(n))return;let a=[...e,s];if(n.type===N.Fragment){r.push.apply(r,d_(n.props.children,a));return}As(n.type===Ur,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),As(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=d_(n.props.children,a)),r.push(o)}),r}var Jv="get",Xv="application/x-www-form-urlencoded";function ty(t){return t!=null&&typeof t.tagName=="string"}function fK(t){return ty(t)&&t.tagName.toLowerCase()==="button"}function mK(t){return ty(t)&&t.tagName.toLowerCase()==="form"}function pK(t){return ty(t)&&t.tagName.toLowerCase()==="input"}function gK(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function xK(t,e){return t.button===0&&(!e||e==="_self")&&!gK(t)}var _1=null;function vK(){if(_1===null)try{new FormData(document.createElement("form"),0),_1=!1}catch{_1=!0}return _1}var wK=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kb(t){return t!=null&&!wK.has(t)?(Ml(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Xv}"`),null):t}function yK(t,e){let r,n,s,a,o;if(mK(t)){let l=t.getAttribute("action");n=l?NA(l,e):null,r=t.getAttribute("method")||Jv,s=Kb(t.getAttribute("enctype"))||Xv,a=new FormData(t)}else if(fK(t)||pK(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?NA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||Jv,s=Kb(t.getAttribute("formenctype"))||Kb(l.getAttribute("enctype"))||Xv,a=new FormData(l,t),!vK()){let{name:A,type:u,value:d}=t;if(u==="image"){let f=A?`${A}.`:"";a.append(`${f}x`,"0"),a.append(`${f}y`,"0")}else A&&a.append(A,d)}}else{if(ty(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Jv,n=null,s=Xv,o=t}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function DB(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function bK(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&NA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function NK(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function CK(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function _K(t,e,r){let n=await Promise.all(t.map(async s=>{let a=e.routes[s.route.id];if(a){let o=await NK(a,r);return o.links?o.links():[]}return[]}));return IK(n.flat(1).filter(CK).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function L4(t,e,r,n,s,a){let o=(c,A)=>r[A]?c.route.id!==r[A].route.id:!0,l=(c,A)=>{var u;return r[A].pathname!==c.pathname||((u=r[A].route.path)==null?void 0:u.endsWith("*"))&&r[A].params["*"]!==c.params["*"]};return a==="assets"?e.filter((c,A)=>o(c,A)||l(c,A)):a==="data"?e.filter((c,A)=>{var d;let u=n.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,A)||l(c,A))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((d=r[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function EK(t,e,{includeHydrateFallback:r}={}){return BK(t.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function BK(t){return[...new Set(t)]}function SK(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function IK(t,e){let r=new Set;return new Set(e),t.reduce((n,s)=>{let a=JSON.stringify(SK(s));return r.has(a)||(r.add(a),n.push({key:a,link:s})),n},[])}function GD(){let t=N.useContext(W0);return DB(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function FK(){let t=N.useContext(Z2);return DB(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var LB=N.createContext(void 0);LB.displayName="FrameworkContext";function $D(){let t=N.useContext(LB);return DB(t,"You must render this element inside a <HydratedRouter> element"),t}function kK(t,e){let r=N.useContext(LB),[n,s]=N.useState(!1),[a,o]=N.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:A,onMouseLeave:u,onTouchStart:d}=e,f=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=g=>{g.forEach(y=>{o(y.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return f.current&&x.observe(f.current),()=>{x.disconnect()}}},[t]),N.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{s(!0)},m=()=>{s(!1),o(!1)};return r?t!=="intent"?[a,f,{}]:[a,f,{onFocus:Mm(l,h),onBlur:Mm(c,m),onMouseEnter:Mm(A,h),onMouseLeave:Mm(u,m),onTouchStart:Mm(d,h)}]:[!1,f,{}]}function Mm(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function TK({page:t,...e}){let{router:r}=GD(),n=N.useMemo(()=>LD(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?N.createElement(PK,{page:t,matches:n,...e}):null}function jK(t){let{manifest:e,routeModules:r}=$D(),[n,s]=N.useState([]);return N.useEffect(()=>{let a=!1;return _K(t,e,r).then(o=>{a||s(o)}),()=>{a=!0}},[t,e,r]),n}function PK({page:t,matches:e,...r}){let n=dd(),{manifest:s,routeModules:a}=$D(),{basename:o}=GD(),{loaderData:l,matches:c}=FK(),A=N.useMemo(()=>L4(t,e,c,s,n,"data"),[t,e,c,s,n]),u=N.useMemo(()=>L4(t,e,c,s,n,"assets"),[t,e,c,s,n]),d=N.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(g=>{var b;let y=s.routes[g.route.id];!y||!y.hasLoader||(!A.some(F=>F.route.id===g.route.id)&&g.route.id in l&&((b=a[g.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(g.route.id))}),m.size===0)return[];let x=bK(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(g=>m.has(g.route.id)).map(g=>g.route.id).join(",")),[x.pathname+x.search]},[o,l,n,s,A,e,t,a]),f=N.useMemo(()=>EK(u,s),[u,s]),h=jK(u);return N.createElement(N.Fragment,null,d.map(m=>N.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),f.map(m=>N.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>N.createElement("link",{key:m,nonce:r.nonce,...p})))}function RK(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var zD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{zD&&(window.__reactRouterVersion="7.8.1")}catch{}function DK({basename:t,children:e,window:r}){let n=N.useRef();n.current==null&&(n.current=yH({window:r,v5Compat:!0}));let s=n.current,[a,o]=N.useState({action:s.action,location:s.location}),l=N.useCallback(c=>{N.startTransition(()=>o(c))},[o]);return N.useLayoutEffect(()=>s.listen(l),[s,l]),N.createElement(dK,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:s})}var WD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,JD=N.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:c,to:A,preventScrollReset:u,viewTransition:d,...f},h){let{basename:m}=N.useContext(Kl),p=typeof A=="string"&&WD.test(A),x,g=!1;if(typeof A=="string"&&p&&(x=A,zD))try{let B=new URL(window.location.href),U=A.startsWith("//")?new URL(B.protocol+A):new URL(A),k=NA(U.pathname,m);U.origin===B.origin&&k!=null?A=k+U.search+U.hash:g=!0}catch{Ml(!1,`<Link to="${A}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=zH(A,{relative:s}),[b,F,j]=kK(n,f),R=OK(A,{replace:o,state:l,target:c,preventScrollReset:u,relative:s,viewTransition:d});function E(B){e&&e(B),B.defaultPrevented||R(B)}let S=N.createElement("a",{...f,...j,href:x||y,onClick:g||a?e:E,ref:RK(h,F),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?N.createElement(N.Fragment,null,S,N.createElement(TK,{page:y})):S});JD.displayName="Link";var Er=N.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:c,...A},u){let d=px(o,{relative:A.relative}),f=dd(),h=N.useContext(Z2),{navigator:m,basename:p}=N.useContext(Kl),x=h!=null&&KK(d)&&l===!0,g=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,y=f.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,g=g.toLowerCase()),b&&p&&(b=NA(b,p)||b);const F=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let j=y===g||!s&&y.startsWith(g)&&y.charAt(F)==="/",R=b!=null&&(b===g||!s&&b.startsWith(g)&&b.charAt(g.length)==="/"),E={isActive:j,isPending:R,isTransitioning:x},S=j?e:void 0,B;typeof n=="function"?B=n(E):B=[n,j?"active":null,R?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let U=typeof a=="function"?a(E):a;return N.createElement(JD,{...A,"aria-current":S,className:B,ref:u,style:U,to:o,viewTransition:l},typeof c=="function"?c(E):c)});Er.displayName="NavLink";var LK=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:s,state:a,method:o=Jv,action:l,onSubmit:c,relative:A,preventScrollReset:u,viewTransition:d,...f},h)=>{let m=VK(),p=HK(l,{relative:A}),x=o.toLowerCase()==="get"?"get":"post",g=typeof l=="string"&&WD.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let F=b.nativeEvent.submitter,j=(F==null?void 0:F.getAttribute("formmethod"))||o;m(F||b.currentTarget,{fetcherKey:e,method:j,navigate:r,replace:s,state:a,relative:A,preventScrollReset:u,viewTransition:d})};return N.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:y,...f,"data-discover":!g&&t==="render"?"true":void 0})});LK.displayName="Form";function UK(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function XD(t){let e=N.useContext(W0);return As(e,UK(t)),e}function OK(t,{target:e,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}={}){let l=ey(),c=dd(),A=px(t,{relative:a});return N.useCallback(u=>{if(xK(u,e)){u.preventDefault();let d=r!==void 0?r:_g(c)===_g(A);l(t,{replace:d,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,A,r,n,e,t,s,a,o])}var MK=0,QK=()=>`__${String(++MK)}__`;function VK(){let{router:t}=XD("useSubmit"),{basename:e}=N.useContext(Kl),r=oK();return N.useCallback(async(n,s={})=>{let{action:a,method:o,encType:l,formData:c,body:A}=yK(n,e);if(s.navigate===!1){let u=s.fetcherKey||QK();await t.fetch(u,r,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,r])}function HK(t,{relative:e}={}){let{basename:r}=N.useContext(Kl),n=N.useContext(ql);As(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...px(t||".",{relative:e})},o=dd();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(u=>u==="")){l.delete("index"),c.filter(d=>d).forEach(d=>l.append("index",d));let u=l.toString();a.search=u?`?${u}`:""}}return(!t||t===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:AA([r,a.pathname])),_g(a)}function KK(t,{relative:e}={}){let r=N.useContext(QD);As(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=XD("useViewTransitionState"),s=px(t,{relative:e});if(!r.isTransitioning)return!1;let a=NA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=NA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Qw(s.pathname,o)!=null||Qw(s.pathname,a)!=null}var U4={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},qK=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],o=t[r++],l=t[r++],c=((s&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},ZD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,A=c?t[s+2]:0,u=a>>2,d=(a&3)<<4|l>>4;let f=(l&15)<<2|A>>6,h=A&63;c||(h=64,o||(f=64)),n.push(r[u],r[d],r[f],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(YD(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):qK(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const A=s<t.length?r[t.charAt(s)]:64;++s;const d=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||l==null||A==null||d==null)throw new GK;const f=a<<2|l>>4;if(n.push(f),A!==64){const h=l<<4&240|A>>2;if(n.push(h),d!==64){const m=A<<6&192|d;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class GK extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $K=function(t){const e=YD(t);return ZD.encodeByteArray(e,!0)},Vw=function(t){return $K(t).replace(/\./g,"")},eL=function(t){try{return ZD.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zK(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WK=()=>zK().__FIREBASE_DEFAULTS__,JK=()=>{if(typeof process>"u"||typeof U4>"u")return;const t=U4.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},XK=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&eL(t[1]);return e&&JSON.parse(e)},ry=()=>{try{return WK()||JK()||XK()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},tL=t=>{var e,r;return(r=(e=ry())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},YK=t=>{const e=tL(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},rL=()=>{var t;return(t=ry())===null||t===void 0?void 0:t.config},nL=t=>{var e;return(e=ry())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZK{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eq(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Vw(JSON.stringify(r)),Vw(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tq(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ua())}function rq(){var t;const e=(t=ry())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nq(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sq(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function aq(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iq(){const t=ua();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function sL(){return!rq()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function aL(){try{return typeof indexedDB=="object"}catch{return!1}}function oq(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lq="FirebaseError";class FA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=lq,Object.setPrototypeOf(this,FA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gx.prototype.create)}}class gx{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?cq(a,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new FA(s,l,n)}}function cq(t,e){return t.replace(Aq,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const Aq=/\{\$([^}]+)}/g;function uq(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Hw(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],o=e[s];if(O4(a)&&O4(o)){if(!Hw(a,o))return!1}else if(a!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function O4(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xx(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function cp(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function Ap(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function dq(t,e){const r=new hq(t,e);return r.subscribe.bind(r)}class hq{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");fq(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=qb),s.error===void 0&&(s.error=qb),s.complete===void 0&&(s.complete=qb);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fq(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function qb(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(t){return t&&t._delegate?t._delegate:t}class yh{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mq{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new ZK;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gq(e))try{this.getOrInitializeService({instanceIdentifier:Od})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=Od){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Od){return this.instances.has(e)}getOptions(e=Od){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(s,a);const o=this.instances.get(s);return o&&e(o,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:pq(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Od){return this.component?this.component.multipleInstances?e:Od:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pq(t){return t===Od?void 0:t}function gq(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xq{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new mq(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(tn||(tn={}));const vq={debug:tn.DEBUG,verbose:tn.VERBOSE,info:tn.INFO,warn:tn.WARN,error:tn.ERROR,silent:tn.SILENT},wq=tn.INFO,yq={[tn.DEBUG]:"log",[tn.VERBOSE]:"log",[tn.INFO]:"info",[tn.WARN]:"warn",[tn.ERROR]:"error"},bq=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=yq[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let UB=class{constructor(e){this.name=e,this._logLevel=wq,this._logHandler=bq,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tn.DEBUG,...e),this._logHandler(this,tn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tn.VERBOSE,...e),this._logHandler(this,tn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tn.INFO,...e),this._logHandler(this,tn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tn.WARN,...e),this._logHandler(this,tn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tn.ERROR,...e),this._logHandler(this,tn.ERROR,...e)}};const Nq=(t,e)=>e.some(r=>t instanceof r);let M4,Q4;function Cq(){return M4||(M4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _q(){return Q4||(Q4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iL=new WeakMap,h_=new WeakMap,oL=new WeakMap,Gb=new WeakMap,OB=new WeakMap;function Eq(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(Vu(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&iL.set(r,t)}).catch(()=>{}),OB.set(e,t),e}function Bq(t){if(h_.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});h_.set(t,e)}let f_={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return h_.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oL.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Vu(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Sq(t){f_=t(f_)}function Iq(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call($b(this),e,...r);return oL.set(n,e.sort?e.sort():[e]),Vu(n)}:_q().includes(t)?function(...e){return t.apply($b(this),e),Vu(iL.get(this))}:function(...e){return Vu(t.apply($b(this),e))}}function Fq(t){return typeof t=="function"?Iq(t):(t instanceof IDBTransaction&&Bq(t),Nq(t,Cq())?new Proxy(t,f_):t)}function Vu(t){if(t instanceof IDBRequest)return Eq(t);if(Gb.has(t))return Gb.get(t);const e=Fq(t);return e!==t&&(Gb.set(t,e),OB.set(e,t)),e}const $b=t=>OB.get(t);function kq(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),l=Vu(o);return n&&o.addEventListener("upgradeneeded",c=>{n(Vu(o.result),c.oldVersion,c.newVersion,Vu(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",A=>s(A.oldVersion,A.newVersion,A))}).catch(()=>{}),l}const Tq=["get","getKey","getAll","getAllKeys","count"],jq=["put","add","delete","clear"],zb=new Map;function V4(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(zb.get(e))return zb.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=jq.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Tq.includes(r)))return;const a=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let A=c.store;return n&&(A=A.index(l.shift())),(await Promise.all([A[r](...l),s&&c.done]))[0]};return zb.set(e,a),a}Sq(t=>({...t,get:(e,r,n)=>V4(e,r)||t.get(e,r,n),has:(e,r)=>!!V4(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pq{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Rq(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Rq(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const m_="@firebase/app",H4="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=new UB("@firebase/app"),Dq="@firebase/app-compat",Lq="@firebase/analytics-compat",Uq="@firebase/analytics",Oq="@firebase/app-check-compat",Mq="@firebase/app-check",Qq="@firebase/auth",Vq="@firebase/auth-compat",Hq="@firebase/database",Kq="@firebase/data-connect",qq="@firebase/database-compat",Gq="@firebase/functions",$q="@firebase/functions-compat",zq="@firebase/installations",Wq="@firebase/installations-compat",Jq="@firebase/messaging",Xq="@firebase/messaging-compat",Yq="@firebase/performance",Zq="@firebase/performance-compat",eG="@firebase/remote-config",tG="@firebase/remote-config-compat",rG="@firebase/storage",nG="@firebase/storage-compat",sG="@firebase/firestore",aG="@firebase/vertexai-preview",iG="@firebase/firestore-compat",oG="firebase",lG="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_="[DEFAULT]",cG={[m_]:"fire-core",[Dq]:"fire-core-compat",[Uq]:"fire-analytics",[Lq]:"fire-analytics-compat",[Mq]:"fire-app-check",[Oq]:"fire-app-check-compat",[Qq]:"fire-auth",[Vq]:"fire-auth-compat",[Hq]:"fire-rtdb",[Kq]:"fire-data-connect",[qq]:"fire-rtdb-compat",[Gq]:"fire-fn",[$q]:"fire-fn-compat",[zq]:"fire-iid",[Wq]:"fire-iid-compat",[Jq]:"fire-fcm",[Xq]:"fire-fcm-compat",[Yq]:"fire-perf",[Zq]:"fire-perf-compat",[eG]:"fire-rc",[tG]:"fire-rc-compat",[rG]:"fire-gcs",[nG]:"fire-gcs-compat",[sG]:"fire-fst",[iG]:"fire-fst-compat",[aG]:"fire-vertex","fire-js":"fire-js",[oG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0=new Map,g_=new Map,x_=new Map;function K4(t,e){try{t.container.addComponent(e)}catch(r){CA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function k0(t){const e=t.name;if(x_.has(e))return CA.debug(`There were multiple attempts to register component ${e}.`),!1;x_.set(e,t);for(const r of F0.values())K4(r,t);for(const r of g_.values())K4(r,t);return!0}function MB(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function fc(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hu=new gx("app","Firebase",AG);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uG{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new yh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0=lG;function QB(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:p_,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Hu.create("bad-app-name",{appName:String(s)});if(r||(r=rL()),!r)throw Hu.create("no-options");const a=F0.get(s);if(a){if(Hw(r,a.options)&&Hw(n,a.config))return a;throw Hu.create("duplicate-app",{appName:s})}const o=new xq(s);for(const c of x_.values())o.addComponent(c);const l=new uG(r,n,o);return F0.set(s,l),l}function VB(t=p_){const e=F0.get(t);if(!e&&t===p_&&rL())return QB();if(!e)throw Hu.create("no-app",{appName:t});return e}async function dG(t){let e=!1;const r=t.name;F0.has(r)?(e=!0,F0.delete(r)):g_.has(r)&&t.decRefCount()<=0&&(g_.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Ku(t,e,r){var n;let s=(n=cG[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const a=s.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${s}" with version "${e}":`];a&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),CA.warn(l.join(" "));return}k0(new yh(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hG="firebase-heartbeat-database",fG=1,Eg="firebase-heartbeat-store";let Wb=null;function lL(){return Wb||(Wb=kq(hG,fG,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Eg)}catch(r){console.warn(r)}}}}).catch(t=>{throw Hu.create("idb-open",{originalErrorMessage:t.message})})),Wb}async function mG(t){try{const r=(await lL()).transaction(Eg),n=await r.objectStore(Eg).get(cL(t));return await r.done,n}catch(e){if(e instanceof FA)CA.warn(e.message);else{const r=Hu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});CA.warn(r.message)}}}async function q4(t,e){try{const n=(await lL()).transaction(Eg,"readwrite");await n.objectStore(Eg).put(e,cL(t)),await n.done}catch(r){if(r instanceof FA)CA.warn(r.message);else{const n=Hu.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});CA.warn(n.message)}}}function cL(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pG=1024,gG=30*24*60*60*1e3;class xG{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new wG(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=G4();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=gG}),this._storage.overwrite(this._heartbeatsCache))}catch(n){CA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=G4(),{heartbeatsToSend:n,unsentEntries:s}=vG(this._heartbeatsCache.heartbeats),a=Vw(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return CA.warn(r),""}}}function G4(){return new Date().toISOString().substring(0,10)}function vG(t,e=pG){const r=[];let n=t.slice();for(const s of t){const a=r.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),$4(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),$4(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class wG{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return aL()?oq().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await mG(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return q4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return q4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function $4(t){return Vw(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yG(t){k0(new yh("platform-logger",e=>new Pq(e),"PRIVATE")),k0(new yh("heartbeat",e=>new xG(e),"PRIVATE")),Ku(m_,H4,t),Ku(m_,H4,"esm2017"),Ku("fire-js","")}yG("");function HB(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function AL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bG=AL,uL=new gx("auth","Firebase",AL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=new UB("@firebase/auth");function NG(t,...e){Kw.logLevel<=tn.WARN&&Kw.warn(`Auth (${X0}): ${t}`,...e)}function Yv(t,...e){Kw.logLevel<=tn.ERROR&&Kw.error(`Auth (${X0}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(t,...e){throw KB(t,...e)}function yc(t,...e){return KB(t,...e)}function dL(t,e,r){const n=Object.assign(Object.assign({},bG()),{[e]:r});return new gx("auth","Firebase",n).create(e,{appName:t.name})}function uA(t){return dL(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function KB(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return uL.create(t,...e)}function _r(t,e,...r){if(!t)throw KB(e,...r)}function sA(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Yv(e),new Error(e)}function _A(t,e){t||sA(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function CG(){return z4()==="http:"||z4()==="https:"}function z4(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _G(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CG()||sq()||"connection"in navigator)?navigator.onLine:!0}function EG(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,r){this.shortDelay=e,this.longDelay=r,_A(r>e,"Short delay should be less than long delay!"),this.isMobile=tq()||aq()}get(){return _G()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(t,e){_A(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;sA("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;sA("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;sA("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SG=new vx(3e4,6e4);function hd(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function fd(t,e,r,n,s={}){return fL(t,s,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const l=xx(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const A=Object.assign({method:e,headers:c},a);return nq()||(A.referrerPolicy="no-referrer"),hL.fetch()(mL(t,t.config.apiHost,r,l),A)})}async function fL(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},BG),e);try{const s=new FG(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw E1(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const l=a.ok?o.errorMessage:o.error.message,[c,A]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw E1(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw E1(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw E1(t,"user-disabled",o);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(A)throw dL(t,u,A);Ql(t,u)}}catch(s){if(s instanceof FA)throw s;Ql(t,"network-request-failed",{message:String(s)})}}async function wx(t,e,r,n,s={}){const a=await fd(t,e,r,n,s);return"mfaPendingCredential"in a&&Ql(t,"multi-factor-auth-required",{_serverResponse:a}),a}function mL(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?qB(t.config,s):`${t.config.apiScheme}://${s}`}function IG(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class FG{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(yc(this.auth,"network-request-failed")),SG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function E1(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=yc(t,e,n);return s.customData._tokenResponse=r,s}function W4(t){return t!==void 0&&t.enterprise!==void 0}class kG{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return IG(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function TG(t,e){return fd(t,"GET","/v2/recaptchaConfig",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jG(t,e){return fd(t,"POST","/v1/accounts:delete",e)}async function pL(t,e){return fd(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function PG(t,e=!1){const r=Fs(t),n=await r.getIdToken(e),s=GB(n);_r(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:Rp(Jb(s.auth_time)),issuedAtTime:Rp(Jb(s.iat)),expirationTime:Rp(Jb(s.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Jb(t){return Number(t)*1e3}function GB(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Yv("JWT malformed, contained fewer than 3 sections"),null;try{const s=eL(r);return s?JSON.parse(s):(Yv("Failed to decode base64 JWT payload"),null)}catch(s){return Yv("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function J4(t){const e=GB(t);return _r(e,"internal-error"),_r(typeof e.exp<"u","internal-error"),_r(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bg(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof FA&&RG(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function RG({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DG{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rp(this.lastLoginAt),this.creationTime=Rp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qw(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Bg(t,pL(r,{idToken:n}));_r(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?gL(a.providerUserInfo):[],l=UG(t.providerData,o),c=t.isAnonymous,A=!(t.email&&a.passwordHash)&&!(l!=null&&l.length),u=c?A:!1,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new w_(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function LG(t){const e=Fs(t);await qw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UG(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function gL(t){return t.map(e=>{var{providerId:r}=e,n=HB(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OG(t,e){const r=await fL(t,{},async()=>{const n=xx({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,o=mL(t,s,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",hL.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function MG(t,e){return fd(t,"POST","/v2/accounts:revokeToken",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_r(e.idToken,"internal-error"),_r(typeof e.idToken<"u","internal-error"),_r(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):J4(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){_r(e.length!==0,"internal-error");const r=J4(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(_r(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await OG(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,o=new f0;return n&&(_r(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(_r(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),a&&(_r(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new f0,this.toJSON())}_performRefresh(){return sA("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t,e){_r(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class aA{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,a=HB(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new DG(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new w_(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Bg(this,this.stsTokenManager.getToken(this.auth,e));return _r(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return PG(this,e)}reload(){return LG(this)}_assign(e){this!==e&&(_r(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new aA(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){_r(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await qw(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fc(this.auth.app))return Promise.reject(uA(this.auth));const e=await this.getIdToken();return await Bg(this,jG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,a,o,l,c,A,u;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,f=(s=r.email)!==null&&s!==void 0?s:void 0,h=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,g=(A=r.createdAt)!==null&&A!==void 0?A:void 0,y=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:F,isAnonymous:j,providerData:R,stsTokenManager:E}=r;_r(b&&E,e,"internal-error");const S=f0.fromJSON(this.name,E);_r(typeof b=="string",e,"internal-error"),tu(d,e.name),tu(f,e.name),_r(typeof F=="boolean",e,"internal-error"),_r(typeof j=="boolean",e,"internal-error"),tu(h,e.name),tu(m,e.name),tu(p,e.name),tu(x,e.name),tu(g,e.name),tu(y,e.name);const B=new aA({uid:b,auth:e,email:f,emailVerified:F,displayName:d,isAnonymous:j,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:g,lastLoginAt:y});return R&&Array.isArray(R)&&(B.providerData=R.map(U=>Object.assign({},U))),x&&(B._redirectEventId=x),B}static async _fromIdTokenResponse(e,r,n=!1){const s=new f0;s.updateFromServerResponse(r);const a=new aA({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await qw(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];_r(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?gL(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),l=new f0;l.updateFromIdToken(n);const c=new aA({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),A={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new w_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(c,A),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=new Map;function iA(t){_A(t instanceof Function,"Expected a class definition");let e=X4.get(t);return e?(_A(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,X4.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}xL.type="NONE";const Y4=xL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(t,e,r){return`firebase:${t}:${e}:${r}`}class m0{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=Zv(this.userKey,s.apiKey,a),this.fullPersistenceKey=Zv("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?aA._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new m0(iA(Y4),e,n);const s=(await Promise.all(r.map(async A=>{if(await A._isAvailable())return A}))).filter(A=>A);let a=s[0]||iA(Y4);const o=Zv(n,e.config.apiKey,e.name);let l=null;for(const A of r)try{const u=await A._get(o);if(u){const d=aA._fromJSON(e,u);A!==a&&(l=d),a=A;break}}catch{}const c=s.filter(A=>A._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new m0(a,e,n):(a=c[0],l&&await a._set(o,l.toJSON()),await Promise.all(r.map(async A=>{if(A!==a)try{await A._remove(o)}catch{}})),new m0(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z4(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CL(e))return"Blackberry";if(_L(e))return"Webos";if(wL(e))return"Safari";if((e.includes("chrome/")||yL(e))&&!e.includes("edge/"))return"Chrome";if(NL(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function vL(t=ua()){return/firefox\//i.test(t)}function wL(t=ua()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yL(t=ua()){return/crios\//i.test(t)}function bL(t=ua()){return/iemobile/i.test(t)}function NL(t=ua()){return/android/i.test(t)}function CL(t=ua()){return/blackberry/i.test(t)}function _L(t=ua()){return/webos/i.test(t)}function $B(t=ua()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function QG(t=ua()){var e;return $B(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function VG(){return iq()&&document.documentMode===10}function EL(t=ua()){return $B(t)||NL(t)||_L(t)||CL(t)||/windows phone/i.test(t)||bL(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BL(t,e=[]){let r;switch(t){case"Browser":r=Z4(ua());break;case"Worker":r=`${Z4(ua())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${X0}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HG{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,l)=>{try{const c=e(a);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KG(t,e={}){return fd(t,"GET","/v2/passwordPolicy",hd(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qG=6;class GG{constructor(e){var r,n,s,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:qG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,a,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsUppercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $G{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eF(this),this.idTokenSubscription=new eF(this),this.beforeStateQueue=new HG(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=iA(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await m0.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await pL(this,{idToken:e}),n=await aA._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(fc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return _r(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await qw(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fc(this.app))return Promise.reject(uA(this));const r=e?Fs(e):null;return r&&_r(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&_r(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fc(this.app)?Promise.reject(uA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fc(this.app)?Promise.reject(uA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(iA(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KG(this),r=new GG(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gx("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await MG(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&iA(e)||this._popupRedirectResolver;_r(r,this,"argument-error"),this.redirectPersistenceManager=await m0.create(this,[iA(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(_r(l,this,"internal-error"),l.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _r(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=BL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&NG(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Mh(t){return Fs(t)}class eF{constructor(e){this.auth=e,this.observer=null,this.addObserver=dq(r=>this.observer=r)}get next(){return _r(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ny={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zG(t){ny=t}function SL(t){return ny.loadJS(t)}function WG(){return ny.recaptchaEnterpriseScript}function JG(){return ny.gapiScript}function XG(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const YG="recaptcha-enterprise",ZG="NO_RECAPTCHA";class e${constructor(e){this.type=YG,this.auth=Mh(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,l)=>{TG(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const A=new kG(c);return a.tenantId==null?a._agentRecaptchaConfig=A:a._tenantRecaptchaConfigs[a.tenantId]=A,o(A.siteKey)}}).catch(c=>{l(c)})})}function s(a,o,l){const c=window.grecaptcha;W4(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(A=>{o(A)}).catch(()=>{o(ZG)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,o)=>{n(this.auth).then(l=>{if(!r&&W4(window.grecaptcha))s(l,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=WG();c.length!==0&&(c+=l),SL(c).then(()=>{s(l,a,o)}).catch(A=>{o(A)})}}).catch(l=>{o(l)})})}}async function tF(t,e,r,n=!1){const s=new e$(t);let a;try{a=await s.verify(r)}catch{a=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function y_(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await tF(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await tF(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t$(t,e){const r=MB(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Hw(a,e??{}))return s;Ql(s,"already-initialized")}return r.initialize({options:e})}function r$(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(iA);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function n$(t,e,r){const n=Mh(t);_r(n._canInitEmulator,n,"emulator-config-failed"),_r(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=IL(e),{host:o,port:l}=s$(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${a}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),a$()}function IL(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function s$(t){const e=IL(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:rF(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:rF(o)}}}function rF(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function a$(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return sA("not implemented")}_getIdTokenResponse(e){return sA("not implemented")}_linkToIdToken(e,r){return sA("not implemented")}_getReauthenticationResolver(e){return sA("not implemented")}}async function i$(t,e){return fd(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o$(t,e){return wx(t,"POST","/v1/accounts:signInWithPassword",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l$(t,e){return wx(t,"POST","/v1/accounts:signInWithEmailLink",hd(t,e))}async function c$(t,e){return wx(t,"POST","/v1/accounts:signInWithEmailLink",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg extends zB{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Sg(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Sg(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return y_(e,r,"signInWithPassword",o$);case"emailLink":return l$(e,{email:this._email,oobCode:this._password});default:Ql(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return y_(e,n,"signUpPassword",i$);case"emailLink":return c$(e,{idToken:r,email:this._email,oobCode:this._password});default:Ql(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p0(t,e){return wx(t,"POST","/v1/accounts:signInWithIdp",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$="http://localhost";class bh extends zB{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new bh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ql("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,a=HB(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new bh(n,s);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return p0(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,p0(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,p0(e,r)}buildRequest(){const e={requestUri:A$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=xx(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u$(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function d$(t){const e=cp(Ap(t)).link,r=e?cp(Ap(e)).deep_link_id:null,n=cp(Ap(t)).deep_link_id;return(n?cp(Ap(n)).link:null)||n||r||e||t}class WB{constructor(e){var r,n,s,a,o,l;const c=cp(Ap(e)),A=(r=c.apiKey)!==null&&r!==void 0?r:null,u=(n=c.oobCode)!==null&&n!==void 0?n:null,d=u$((s=c.mode)!==null&&s!==void 0?s:null);_r(A&&u&&d,"argument-error"),this.apiKey=A,this.operation=d,this.code=u,this.continueUrl=(a=c.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=d$(e);try{return new WB(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(){this.providerId=Y0.PROVIDER_ID}static credential(e,r){return Sg._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=WB.parseLink(r);return _r(n,"argument-error"),Sg._fromEmailAndCode(e,n.code,n.tenantId)}}Y0.PROVIDER_ID="password";Y0.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Y0.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx extends FL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu extends yx{constructor(){super("facebook.com")}static credential(e){return bh._fromParams({providerId:xu.PROVIDER_ID,signInMethod:xu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xu.credentialFromTaggedObject(e)}static credentialFromError(e){return xu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xu.credential(e.oauthAccessToken)}catch{return null}}}xu.FACEBOOK_SIGN_IN_METHOD="facebook.com";xu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu extends yx{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return bh._fromParams({providerId:vu.PROVIDER_ID,signInMethod:vu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return vu.credentialFromTaggedObject(e)}static credentialFromError(e){return vu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return vu.credential(r,n)}catch{return null}}}vu.GOOGLE_SIGN_IN_METHOD="google.com";vu.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends yx{constructor(){super("github.com")}static credential(e){return bh._fromParams({providerId:wu.PROVIDER_ID,signInMethod:wu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wu.credentialFromTaggedObject(e)}static credentialFromError(e){return wu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wu.credential(e.oauthAccessToken)}catch{return null}}}wu.GITHUB_SIGN_IN_METHOD="github.com";wu.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends yx{constructor(){super("twitter.com")}static credential(e,r){return bh._fromParams({providerId:yu.PROVIDER_ID,signInMethod:yu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return yu.credentialFromTaggedObject(e)}static credentialFromError(e){return yu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return yu.credential(r,n)}catch{return null}}}yu.TWITTER_SIGN_IN_METHOD="twitter.com";yu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h$(t,e){return wx(t,"POST","/v1/accounts:signUp",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await aA._fromIdTokenResponse(e,n,s),o=nF(n);return new Nh({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=nF(n);return new Nh({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function nF(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw extends FA{constructor(e,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Gw.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Gw(e,r,n,s)}}function kL(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Gw._fromErrorAndOperation(t,a,e,n):a})}async function f$(t,e,r=!1){const n=await Bg(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Nh._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m$(t,e,r=!1){const{auth:n}=t;if(fc(n.app))return Promise.reject(uA(n));const s="reauthenticate";try{const a=await Bg(t,kL(n,s,e,t),r);_r(a.idToken,n,"internal-error");const o=GB(a.idToken);_r(o,n,"internal-error");const{sub:l}=o;return _r(t.uid===l,n,"user-mismatch"),Nh._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Ql(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TL(t,e,r=!1){if(fc(t.app))return Promise.reject(uA(t));const n="signIn",s=await kL(t,n,e),a=await Nh._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function p$(t,e){return TL(Mh(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jL(t){const e=Mh(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function g$(t,e,r){if(fc(t.app))return Promise.reject(uA(t));const n=Mh(t),o=await y_(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",h$).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&jL(t),c}),l=await Nh._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function x$(t,e,r){return fc(t.app)?Promise.reject(uA(t)):p$(Fs(t),Y0.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&jL(t),n})}function v$(t,e,r,n){return Fs(t).onIdTokenChanged(e,r,n)}function w$(t,e,r){return Fs(t).beforeAuthStateChanged(e,r)}function PL(t,e,r,n){return Fs(t).onAuthStateChanged(e,r,n)}function RL(t){return Fs(t).signOut()}const $w="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem($w,"1"),this.storage.removeItem($w),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y$=1e3,b$=10;class LL extends DL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=EL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);VG()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,b$):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},y$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}LL.type="LOCAL";const N$=LL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UL extends DL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}UL.type="SESSION";const OL=UL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new sy(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async A=>A(r.origin,a)),c=await C$(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sy.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,o;return new Promise((l,c)=>{const A=JB("",20);s.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(d){const f=d;if(f.data.eventId===A)switch(f.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(f.data.response);break;default:clearTimeout(u),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:A,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(){return window}function E$(t){bc().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ML(){return typeof bc().WorkerGlobalScope<"u"&&typeof bc().importScripts=="function"}async function B$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function S$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function I$(){return ML()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL="firebaseLocalStorageDb",F$=1,zw="firebaseLocalStorage",VL="fbase_key";class bx{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ay(t,e){return t.transaction([zw],e?"readwrite":"readonly").objectStore(zw)}function k$(){const t=indexedDB.deleteDatabase(QL);return new bx(t).toPromise()}function b_(){const t=indexedDB.open(QL,F$);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(zw,{keyPath:VL})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(zw)?e(n):(n.close(),await k$(),e(await b_()))})})}async function sF(t,e,r){const n=ay(t,!0).put({[VL]:e,value:r});return new bx(n).toPromise()}async function T$(t,e){const r=ay(t,!1).get(e),n=await new bx(r).toPromise();return n===void 0?null:n.value}function aF(t,e){const r=ay(t,!0).delete(e);return new bx(r).toPromise()}const j$=800,P$=3;class HL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await b_(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>P$)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ML()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sy._getInstance(I$()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await B$(),!this.activeServiceWorker)return;this.sender=new _$(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||S$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await b_();return await sF(e,$w,"1"),await aF(e,$w),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>sF(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>T$(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>aF(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=ay(s,!1).getAll();return new bx(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),j$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HL.type="LOCAL";const R$=HL;new vx(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D$(t,e){return e?iA(e):(_r(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XB extends zB{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return p0(e,this._buildIdpRequest())}_linkToIdToken(e,r){return p0(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return p0(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function L$(t){return TL(t.auth,new XB(t),t.bypassAuthState)}function U$(t){const{auth:e,user:r}=t;return _r(r,e,"internal-error"),m$(r,new XB(t),t.bypassAuthState)}async function O$(t){const{auth:e,user:r}=t;return _r(r,e,"internal-error"),f$(r,new XB(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(A){this.reject(A)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return L$;case"linkViaPopup":case"linkViaRedirect":return O$;case"reauthViaPopup":case"reauthViaRedirect":return U$;default:Ql(this.auth,"internal-error")}}resolve(e){_A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M$=new vx(2e3,1e4);class a0 extends KL{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,a0.currentPopupAction&&a0.currentPopupAction.cancel(),a0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _r(e,this.auth,"internal-error"),e}async onExecution(){_A(this.filter.length===1,"Popup operations only handle one event");const e=JB();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(yc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(yc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,a0.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,M$.get())};e()}}a0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q$="pendingRedirect",ew=new Map;class V$ extends KL{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ew.get(this.auth._key());if(!e){try{const n=await H$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ew.set(this.auth._key(),e)}return this.bypassAuthState||ew.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function H$(t,e){const r=G$(e),n=q$(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function K$(t,e){ew.set(t._key(),e)}function q$(t){return iA(t._redirectPersistence)}function G$(t){return Zv(Q$,t.config.apiKey,t.name)}async function $$(t,e,r=!1){if(fc(t.app))return Promise.reject(uA(t));const n=Mh(t),s=D$(n,e),o=await new V$(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z$=10*60*1e3;class W${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!J$(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!qL(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(yc(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=z$&&this.cachedEventUids.clear(),this.cachedEventUids.has(iF(e))}saveEventToCache(e){this.cachedEventUids.add(iF(e)),this.lastProcessedEventTime=Date.now()}}function iF(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function qL({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function J$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qL(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X$(t,e={}){return fd(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Z$=/^https?/;async function ez(t){if(t.config.emulator)return;const{authorizedDomains:e}=await X$(t);for(const r of e)try{if(tz(r))return}catch{}Ql(t,"unauthorized-domain")}function tz(t){const e=v_(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!Z$.test(r))return!1;if(Y$.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rz=new vx(3e4,6e4);function oF(){const t=bc().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function nz(t){return new Promise((e,r)=>{var n,s,a;function o(){oF(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oF(),r(yc(t,"network-request-failed"))},timeout:rz.get()})}if(!((s=(n=bc().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=bc().gapi)===null||a===void 0)&&a.load)o();else{const l=XG("iframefcb");return bc()[l]=()=>{gapi.load?o():r(yc(t,"network-request-failed"))},SL(`${JG()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw tw=null,e})}let tw=null;function sz(t){return tw=tw||nz(t),tw}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const az=new vx(5e3,15e3),iz="__/auth/iframe",oz="emulator/auth/iframe",lz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Az(t){const e=t.config;_r(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?qB(e,oz):`https://${t.config.authDomain}/${iz}`,n={apiKey:e.apiKey,appName:t.name,v:X0},s=cz.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${xx(n).slice(1)}`}async function uz(t){const e=await sz(t),r=bc().gapi;return _r(r,t,"internal-error"),e.open({where:document.body,url:Az(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lz,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const o=yc(t,"network-request-failed"),l=bc().setTimeout(()=>{a(o)},az.get());function c(){bc().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hz=500,fz=600,mz="_blank",pz="http://localhost";class lF{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gz(t,e,r,n=hz,s=fz){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},dz),{width:n.toString(),height:s.toString(),top:a,left:o}),A=ua().toLowerCase();r&&(l=yL(A)?mz:r),vL(A)&&(e=e||pz,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[h,m])=>`${f}${h}=${m},`,"");if(QG(A)&&l!=="_self")return xz(e||"",l),new lF(null);const d=window.open(e||"",l,u);_r(d,t,"popup-blocked");try{d.focus()}catch{}return new lF(d)}function xz(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz="__/auth/handler",wz="emulator/auth/handler",yz=encodeURIComponent("fac");async function cF(t,e,r,n,s,a){_r(t.config.authDomain,t,"auth-domain-config-required"),_r(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:X0,eventId:s};if(e instanceof FL){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",uq(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof yx){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await t._getAppCheckToken(),A=c?`#${yz}=${encodeURIComponent(c)}`:"";return`${bz(t)}?${xx(l).slice(1)}${A}`}function bz({config:t}){return t.emulator?qB(t,wz):`https://${t.authDomain}/${vz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="webStorageSupport";class Nz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=OL,this._completeRedirectFn=$$,this._overrideRedirectResult=K$}async _openPopup(e,r,n,s){var a;_A((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await cF(e,r,n,v_(),s);return gz(e,o,JB())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await cF(e,r,n,v_(),s);return E$(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(_A(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await uz(e),n=new W$(e);return r.register("authEvent",s=>(_r(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Xb,{type:Xb},s=>{var a;const o=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[Xb];o!==void 0&&r(!!o),Ql(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=ez(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return EL()||wL()||$B()}}const Cz=Nz;var AF="@firebase/auth",uF="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _z{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_r(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Bz(t){k0(new yh("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;_r(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:BL(t)},A=new $G(n,s,a,c);return r$(A,r),A},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),k0(new yh("auth-internal",e=>{const r=Mh(e.getProvider("auth").getImmediate());return(n=>new _z(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ku(AF,uF,Ez(t)),Ku(AF,uF,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sz=5*60,Iz=nL("authIdTokenMaxAge")||Sz;let dF=null;const Fz=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Iz)return;const s=r==null?void 0:r.token;dF!==s&&(dF=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function GL(t=VB()){const e=MB(t,"auth");if(e.isInitialized())return e.getImmediate();const r=t$(t,{popupRedirectResolver:Cz,persistence:[R$,N$,OL]}),n=nL("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=Fz(a.toString());w$(r,o,()=>o(r.currentUser)),v$(r,l=>o(l))}}const s=tL("auth");return s&&n$(r,`http://${s}`),r}function kz(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}zG({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=yc("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",kz().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Bz("Browser");var Tz="firebase",jz="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ku(Tz,jz,"app");var hF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sh,$L;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,S){function B(){}B.prototype=S.prototype,E.D=S.prototype,E.prototype=new B,E.prototype.constructor=E,E.C=function(U,k,T){for(var L=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)L[Y-2]=arguments[Y];return S.prototype[k].apply(U,L)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,S,B){B||(B=0);var U=Array(16);if(typeof S=="string")for(var k=0;16>k;++k)U[k]=S.charCodeAt(B++)|S.charCodeAt(B++)<<8|S.charCodeAt(B++)<<16|S.charCodeAt(B++)<<24;else for(k=0;16>k;++k)U[k]=S[B++]|S[B++]<<8|S[B++]<<16|S[B++]<<24;S=E.g[0],B=E.g[1],k=E.g[2];var T=E.g[3],L=S+(T^B&(k^T))+U[0]+3614090360&4294967295;S=B+(L<<7&4294967295|L>>>25),L=T+(k^S&(B^k))+U[1]+3905402710&4294967295,T=S+(L<<12&4294967295|L>>>20),L=k+(B^T&(S^B))+U[2]+606105819&4294967295,k=T+(L<<17&4294967295|L>>>15),L=B+(S^k&(T^S))+U[3]+3250441966&4294967295,B=k+(L<<22&4294967295|L>>>10),L=S+(T^B&(k^T))+U[4]+4118548399&4294967295,S=B+(L<<7&4294967295|L>>>25),L=T+(k^S&(B^k))+U[5]+1200080426&4294967295,T=S+(L<<12&4294967295|L>>>20),L=k+(B^T&(S^B))+U[6]+2821735955&4294967295,k=T+(L<<17&4294967295|L>>>15),L=B+(S^k&(T^S))+U[7]+4249261313&4294967295,B=k+(L<<22&4294967295|L>>>10),L=S+(T^B&(k^T))+U[8]+1770035416&4294967295,S=B+(L<<7&4294967295|L>>>25),L=T+(k^S&(B^k))+U[9]+2336552879&4294967295,T=S+(L<<12&4294967295|L>>>20),L=k+(B^T&(S^B))+U[10]+4294925233&4294967295,k=T+(L<<17&4294967295|L>>>15),L=B+(S^k&(T^S))+U[11]+2304563134&4294967295,B=k+(L<<22&4294967295|L>>>10),L=S+(T^B&(k^T))+U[12]+1804603682&4294967295,S=B+(L<<7&4294967295|L>>>25),L=T+(k^S&(B^k))+U[13]+4254626195&4294967295,T=S+(L<<12&4294967295|L>>>20),L=k+(B^T&(S^B))+U[14]+2792965006&4294967295,k=T+(L<<17&4294967295|L>>>15),L=B+(S^k&(T^S))+U[15]+1236535329&4294967295,B=k+(L<<22&4294967295|L>>>10),L=S+(k^T&(B^k))+U[1]+4129170786&4294967295,S=B+(L<<5&4294967295|L>>>27),L=T+(B^k&(S^B))+U[6]+3225465664&4294967295,T=S+(L<<9&4294967295|L>>>23),L=k+(S^B&(T^S))+U[11]+643717713&4294967295,k=T+(L<<14&4294967295|L>>>18),L=B+(T^S&(k^T))+U[0]+3921069994&4294967295,B=k+(L<<20&4294967295|L>>>12),L=S+(k^T&(B^k))+U[5]+3593408605&4294967295,S=B+(L<<5&4294967295|L>>>27),L=T+(B^k&(S^B))+U[10]+38016083&4294967295,T=S+(L<<9&4294967295|L>>>23),L=k+(S^B&(T^S))+U[15]+3634488961&4294967295,k=T+(L<<14&4294967295|L>>>18),L=B+(T^S&(k^T))+U[4]+3889429448&4294967295,B=k+(L<<20&4294967295|L>>>12),L=S+(k^T&(B^k))+U[9]+568446438&4294967295,S=B+(L<<5&4294967295|L>>>27),L=T+(B^k&(S^B))+U[14]+3275163606&4294967295,T=S+(L<<9&4294967295|L>>>23),L=k+(S^B&(T^S))+U[3]+4107603335&4294967295,k=T+(L<<14&4294967295|L>>>18),L=B+(T^S&(k^T))+U[8]+1163531501&4294967295,B=k+(L<<20&4294967295|L>>>12),L=S+(k^T&(B^k))+U[13]+2850285829&4294967295,S=B+(L<<5&4294967295|L>>>27),L=T+(B^k&(S^B))+U[2]+4243563512&4294967295,T=S+(L<<9&4294967295|L>>>23),L=k+(S^B&(T^S))+U[7]+1735328473&4294967295,k=T+(L<<14&4294967295|L>>>18),L=B+(T^S&(k^T))+U[12]+2368359562&4294967295,B=k+(L<<20&4294967295|L>>>12),L=S+(B^k^T)+U[5]+4294588738&4294967295,S=B+(L<<4&4294967295|L>>>28),L=T+(S^B^k)+U[8]+2272392833&4294967295,T=S+(L<<11&4294967295|L>>>21),L=k+(T^S^B)+U[11]+1839030562&4294967295,k=T+(L<<16&4294967295|L>>>16),L=B+(k^T^S)+U[14]+4259657740&4294967295,B=k+(L<<23&4294967295|L>>>9),L=S+(B^k^T)+U[1]+2763975236&4294967295,S=B+(L<<4&4294967295|L>>>28),L=T+(S^B^k)+U[4]+1272893353&4294967295,T=S+(L<<11&4294967295|L>>>21),L=k+(T^S^B)+U[7]+4139469664&4294967295,k=T+(L<<16&4294967295|L>>>16),L=B+(k^T^S)+U[10]+3200236656&4294967295,B=k+(L<<23&4294967295|L>>>9),L=S+(B^k^T)+U[13]+681279174&4294967295,S=B+(L<<4&4294967295|L>>>28),L=T+(S^B^k)+U[0]+3936430074&4294967295,T=S+(L<<11&4294967295|L>>>21),L=k+(T^S^B)+U[3]+3572445317&4294967295,k=T+(L<<16&4294967295|L>>>16),L=B+(k^T^S)+U[6]+76029189&4294967295,B=k+(L<<23&4294967295|L>>>9),L=S+(B^k^T)+U[9]+3654602809&4294967295,S=B+(L<<4&4294967295|L>>>28),L=T+(S^B^k)+U[12]+3873151461&4294967295,T=S+(L<<11&4294967295|L>>>21),L=k+(T^S^B)+U[15]+530742520&4294967295,k=T+(L<<16&4294967295|L>>>16),L=B+(k^T^S)+U[2]+3299628645&4294967295,B=k+(L<<23&4294967295|L>>>9),L=S+(k^(B|~T))+U[0]+4096336452&4294967295,S=B+(L<<6&4294967295|L>>>26),L=T+(B^(S|~k))+U[7]+1126891415&4294967295,T=S+(L<<10&4294967295|L>>>22),L=k+(S^(T|~B))+U[14]+2878612391&4294967295,k=T+(L<<15&4294967295|L>>>17),L=B+(T^(k|~S))+U[5]+4237533241&4294967295,B=k+(L<<21&4294967295|L>>>11),L=S+(k^(B|~T))+U[12]+1700485571&4294967295,S=B+(L<<6&4294967295|L>>>26),L=T+(B^(S|~k))+U[3]+2399980690&4294967295,T=S+(L<<10&4294967295|L>>>22),L=k+(S^(T|~B))+U[10]+4293915773&4294967295,k=T+(L<<15&4294967295|L>>>17),L=B+(T^(k|~S))+U[1]+2240044497&4294967295,B=k+(L<<21&4294967295|L>>>11),L=S+(k^(B|~T))+U[8]+1873313359&4294967295,S=B+(L<<6&4294967295|L>>>26),L=T+(B^(S|~k))+U[15]+4264355552&4294967295,T=S+(L<<10&4294967295|L>>>22),L=k+(S^(T|~B))+U[6]+2734768916&4294967295,k=T+(L<<15&4294967295|L>>>17),L=B+(T^(k|~S))+U[13]+1309151649&4294967295,B=k+(L<<21&4294967295|L>>>11),L=S+(k^(B|~T))+U[4]+4149444226&4294967295,S=B+(L<<6&4294967295|L>>>26),L=T+(B^(S|~k))+U[11]+3174756917&4294967295,T=S+(L<<10&4294967295|L>>>22),L=k+(S^(T|~B))+U[2]+718787259&4294967295,k=T+(L<<15&4294967295|L>>>17),L=B+(T^(k|~S))+U[9]+3951481745&4294967295,E.g[0]=E.g[0]+S&4294967295,E.g[1]=E.g[1]+(k+(L<<21&4294967295|L>>>11))&4294967295,E.g[2]=E.g[2]+k&4294967295,E.g[3]=E.g[3]+T&4294967295}n.prototype.u=function(E,S){S===void 0&&(S=E.length);for(var B=S-this.blockSize,U=this.B,k=this.h,T=0;T<S;){if(k==0)for(;T<=B;)s(this,E,T),T+=this.blockSize;if(typeof E=="string"){for(;T<S;)if(U[k++]=E.charCodeAt(T++),k==this.blockSize){s(this,U),k=0;break}}else for(;T<S;)if(U[k++]=E[T++],k==this.blockSize){s(this,U),k=0;break}}this.h=k,this.o+=S},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var S=1;S<E.length-8;++S)E[S]=0;var B=8*this.o;for(S=E.length-8;S<E.length;++S)E[S]=B&255,B/=256;for(this.u(E),E=Array(16),S=B=0;4>S;++S)for(var U=0;32>U;U+=8)E[B++]=this.g[S]>>>U&255;return E};function a(E,S){var B=l;return Object.prototype.hasOwnProperty.call(B,E)?B[E]:B[E]=S(E)}function o(E,S){this.h=S;for(var B=[],U=!0,k=E.length-1;0<=k;k--){var T=E[k]|0;U&&T==S||(B[k]=T,U=!1)}this.g=B}var l={};function c(E){return-128<=E&&128>E?a(E,function(S){return new o([S|0],0>S?-1:0)}):new o([E|0],0>E?-1:0)}function A(E){if(isNaN(E)||!isFinite(E))return d;if(0>E)return x(A(-E));for(var S=[],B=1,U=0;E>=B;U++)S[U]=E/B|0,B*=4294967296;return new o(S,0)}function u(E,S){if(E.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E.charAt(0)=="-")return x(u(E.substring(1),S));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var B=A(Math.pow(S,8)),U=d,k=0;k<E.length;k+=8){var T=Math.min(8,E.length-k),L=parseInt(E.substring(k,k+T),S);8>T?(T=A(Math.pow(S,T)),U=U.j(T).add(A(L))):(U=U.j(B),U=U.add(A(L)))}return U}var d=c(0),f=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var E=0,S=1,B=0;B<this.g.length;B++){var U=this.i(B);E+=(0<=U?U:4294967296+U)*S,S*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(m(this))return"0";if(p(this))return"-"+x(this).toString(E);for(var S=A(Math.pow(E,6)),B=this,U="";;){var k=F(B,S).g;B=g(B,k.j(S));var T=((0<B.g.length?B.g[0]:B.h)>>>0).toString(E);if(B=k,m(B))return T+U;for(;6>T.length;)T="0"+T;U=T+U}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function m(E){if(E.h!=0)return!1;for(var S=0;S<E.g.length;S++)if(E.g[S]!=0)return!1;return!0}function p(E){return E.h==-1}t.l=function(E){return E=g(this,E),p(E)?-1:m(E)?0:1};function x(E){for(var S=E.g.length,B=[],U=0;U<S;U++)B[U]=~E.g[U];return new o(B,~E.h).add(f)}t.abs=function(){return p(this)?x(this):this},t.add=function(E){for(var S=Math.max(this.g.length,E.g.length),B=[],U=0,k=0;k<=S;k++){var T=U+(this.i(k)&65535)+(E.i(k)&65535),L=(T>>>16)+(this.i(k)>>>16)+(E.i(k)>>>16);U=L>>>16,T&=65535,L&=65535,B[k]=L<<16|T}return new o(B,B[B.length-1]&-2147483648?-1:0)};function g(E,S){return E.add(x(S))}t.j=function(E){if(m(this)||m(E))return d;if(p(this))return p(E)?x(this).j(x(E)):x(x(this).j(E));if(p(E))return x(this.j(x(E)));if(0>this.l(h)&&0>E.l(h))return A(this.m()*E.m());for(var S=this.g.length+E.g.length,B=[],U=0;U<2*S;U++)B[U]=0;for(U=0;U<this.g.length;U++)for(var k=0;k<E.g.length;k++){var T=this.i(U)>>>16,L=this.i(U)&65535,Y=E.i(k)>>>16,me=E.i(k)&65535;B[2*U+2*k]+=L*me,y(B,2*U+2*k),B[2*U+2*k+1]+=T*me,y(B,2*U+2*k+1),B[2*U+2*k+1]+=L*Y,y(B,2*U+2*k+1),B[2*U+2*k+2]+=T*Y,y(B,2*U+2*k+2)}for(U=0;U<S;U++)B[U]=B[2*U+1]<<16|B[2*U];for(U=S;U<2*S;U++)B[U]=0;return new o(B,0)};function y(E,S){for(;(E[S]&65535)!=E[S];)E[S+1]+=E[S]>>>16,E[S]&=65535,S++}function b(E,S){this.g=E,this.h=S}function F(E,S){if(m(S))throw Error("division by zero");if(m(E))return new b(d,d);if(p(E))return S=F(x(E),S),new b(x(S.g),x(S.h));if(p(S))return S=F(E,x(S)),new b(x(S.g),S.h);if(30<E.g.length){if(p(E)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var B=f,U=S;0>=U.l(E);)B=j(B),U=j(U);var k=R(B,1),T=R(U,1);for(U=R(U,2),B=R(B,2);!m(U);){var L=T.add(U);0>=L.l(E)&&(k=k.add(B),T=L),U=R(U,1),B=R(B,1)}return S=g(E,k.j(S)),new b(k,S)}for(k=d;0<=E.l(S);){for(B=Math.max(1,Math.floor(E.m()/S.m())),U=Math.ceil(Math.log(B)/Math.LN2),U=48>=U?1:Math.pow(2,U-48),T=A(B),L=T.j(S);p(L)||0<L.l(E);)B-=U,T=A(B),L=T.j(S);m(T)&&(T=f),k=k.add(T),E=g(E,L)}return new b(k,E)}t.A=function(E){return F(this,E).h},t.and=function(E){for(var S=Math.max(this.g.length,E.g.length),B=[],U=0;U<S;U++)B[U]=this.i(U)&E.i(U);return new o(B,this.h&E.h)},t.or=function(E){for(var S=Math.max(this.g.length,E.g.length),B=[],U=0;U<S;U++)B[U]=this.i(U)|E.i(U);return new o(B,this.h|E.h)},t.xor=function(E){for(var S=Math.max(this.g.length,E.g.length),B=[],U=0;U<S;U++)B[U]=this.i(U)^E.i(U);return new o(B,this.h^E.h)};function j(E){for(var S=E.g.length+1,B=[],U=0;U<S;U++)B[U]=E.i(U)<<1|E.i(U-1)>>>31;return new o(B,E.h)}function R(E,S){var B=S>>5;S%=32;for(var U=E.g.length-B,k=[],T=0;T<U;T++)k[T]=0<S?E.i(T+B)>>>S|E.i(T+B+1)<<32-S:E.i(T+B);return new o(k,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,$L=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=A,o.fromString=u,sh=o}).apply(typeof hF<"u"?hF:typeof self<"u"?self:typeof window<"u"?window:{});var B1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zL,up,WL,rw,N_,JL,XL,YL;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,H,ee){return w==Array.prototype||w==Object.prototype||(w[H]=ee.value),w};function r(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof B1=="object"&&B1];for(var H=0;H<w.length;++H){var ee=w[H];if(ee&&ee.Math==Math)return ee}throw Error("Cannot find global object")}var n=r(this);function s(w,H){if(H)e:{var ee=n;w=w.split(".");for(var ke=0;ke<w.length-1;ke++){var ct=w[ke];if(!(ct in ee))break e;ee=ee[ct]}w=w[w.length-1],ke=ee[w],H=H(ke),H!=ke&&H!=null&&e(ee,w,{configurable:!0,writable:!0,value:H})}}function a(w,H){w instanceof String&&(w+="");var ee=0,ke=!1,ct={next:function(){if(!ke&&ee<w.length){var gt=ee++;return{value:H(gt,w[gt]),done:!1}}return ke=!0,{done:!0,value:void 0}}};return ct[Symbol.iterator]=function(){return ct},ct}s("Array.prototype.values",function(w){return w||function(){return a(this,function(H,ee){return ee})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(w){var H=typeof w;return H=H!="object"?H:w?Array.isArray(w)?"array":H:"null",H=="array"||H=="object"&&typeof w.length=="number"}function A(w){var H=typeof w;return H=="object"&&w!=null||H=="function"}function u(w,H,ee){return w.call.apply(w.bind,arguments)}function d(w,H,ee){if(!w)throw Error();if(2<arguments.length){var ke=Array.prototype.slice.call(arguments,2);return function(){var ct=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ct,ke),w.apply(H,ct)}}return function(){return w.apply(H,arguments)}}function f(w,H,ee){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,f.apply(null,arguments)}function h(w,H){var ee=Array.prototype.slice.call(arguments,1);return function(){var ke=ee.slice();return ke.push.apply(ke,arguments),w.apply(this,ke)}}function m(w,H){function ee(){}ee.prototype=H.prototype,w.aa=H.prototype,w.prototype=new ee,w.prototype.constructor=w,w.Qb=function(ke,ct,gt){for(var Ht=Array(arguments.length-2),nn=2;nn<arguments.length;nn++)Ht[nn-2]=arguments[nn];return H.prototype[ct].apply(ke,Ht)}}function p(w){const H=w.length;if(0<H){const ee=Array(H);for(let ke=0;ke<H;ke++)ee[ke]=w[ke];return ee}return[]}function x(w,H){for(let ee=1;ee<arguments.length;ee++){const ke=arguments[ee];if(c(ke)){const ct=w.length||0,gt=ke.length||0;w.length=ct+gt;for(let Ht=0;Ht<gt;Ht++)w[ct+Ht]=ke[Ht]}else w.push(ke)}}class g{constructor(H,ee){this.i=H,this.j=ee,this.h=0,this.g=null}get(){let H;return 0<this.h?(this.h--,H=this.g,this.g=H.next,H.next=null):H=this.i(),H}}function y(w){return/^[\s\xa0]*$/.test(w)}function b(){var w=l.navigator;return w&&(w=w.userAgent)?w:""}function F(w){return F[" "](w),w}F[" "]=function(){};var j=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function R(w,H,ee){for(const ke in w)H.call(ee,w[ke],ke,w)}function E(w,H){for(const ee in w)H.call(void 0,w[ee],ee,w)}function S(w){const H={};for(const ee in w)H[ee]=w[ee];return H}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(w,H){let ee,ke;for(let ct=1;ct<arguments.length;ct++){ke=arguments[ct];for(ee in ke)w[ee]=ke[ee];for(let gt=0;gt<B.length;gt++)ee=B[gt],Object.prototype.hasOwnProperty.call(ke,ee)&&(w[ee]=ke[ee])}}function k(w){var H=1;w=w.split(":");const ee=[];for(;0<H&&w.length;)ee.push(w.shift()),H--;return w.length&&ee.push(w.join(":")),ee}function T(w){l.setTimeout(()=>{throw w},0)}function L(){var w=Z;let H=null;return w.g&&(H=w.g,w.g=w.g.next,w.g||(w.h=null),H.next=null),H}class Y{constructor(){this.h=this.g=null}add(H,ee){const ke=me.get();ke.set(H,ee),this.h?this.h.next=ke:this.g=ke,this.h=ke}}var me=new g(()=>new ae,w=>w.reset());class ae{constructor(){this.next=this.g=this.h=null}set(H,ee){this.h=H,this.g=ee,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,de=!1,Z=new Y,xe=()=>{const w=l.Promise.resolve(void 0);fe=()=>{w.then(Be)}};var Be=()=>{for(var w;w=L();){try{w.h.call(w.g)}catch(ee){T(ee)}var H=me;H.j(w),100>H.h&&(H.h++,w.next=H.g,H.g=w)}de=!1};function I(){this.s=this.s,this.C=this.C}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(w,H){this.type=w,this.g=this.target=H,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var Q=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var w=!1,H=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const ee=()=>{};l.addEventListener("test",ee,H),l.removeEventListener("test",ee,H)}catch{}return w}();function M(w,H){if(C.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var ee=this.type=w.type,ke=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=H,H=w.relatedTarget){if(j){e:{try{F(H.nodeName);var ct=!0;break e}catch{}ct=!1}ct||(H=null)}}else ee=="mouseover"?H=w.fromElement:ee=="mouseout"&&(H=w.toElement);this.relatedTarget=H,ke?(this.clientX=ke.clientX!==void 0?ke.clientX:ke.pageX,this.clientY=ke.clientY!==void 0?ke.clientY:ke.pageY,this.screenX=ke.screenX||0,this.screenY=ke.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:D[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&M.aa.h.call(this)}}m(M,C);var D={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var z="closure_listenable_"+(1e6*Math.random()|0),O=0;function te(w,H,ee,ke,ct){this.listener=w,this.proxy=null,this.src=H,this.type=ee,this.capture=!!ke,this.ha=ct,this.key=++O,this.da=this.fa=!1}function se(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function we(w){this.src=w,this.g={},this.h=0}we.prototype.add=function(w,H,ee,ke,ct){var gt=w.toString();w=this.g[gt],w||(w=this.g[gt]=[],this.h++);var Ht=Me(w,H,ke,ct);return-1<Ht?(H=w[Ht],ee||(H.fa=!1)):(H=new te(H,this.src,gt,!!ke,ct),H.fa=ee,w.push(H)),H};function q(w,H){var ee=H.type;if(ee in w.g){var ke=w.g[ee],ct=Array.prototype.indexOf.call(ke,H,void 0),gt;(gt=0<=ct)&&Array.prototype.splice.call(ke,ct,1),gt&&(se(H),w.g[ee].length==0&&(delete w.g[ee],w.h--))}}function Me(w,H,ee,ke){for(var ct=0;ct<w.length;++ct){var gt=w[ct];if(!gt.da&&gt.listener==H&&gt.capture==!!ee&&gt.ha==ke)return ct}return-1}var re="closure_lm_"+(1e6*Math.random()|0),J={};function K(w,H,ee,ke,ct){if(Array.isArray(H)){for(var gt=0;gt<H.length;gt++)K(w,H[gt],ee,ke,ct);return null}return ee=ze(ee),w&&w[z]?w.K(H,ee,A(ke)?!!ke.capture:!1,ct):ie(w,H,ee,!1,ke,ct)}function ie(w,H,ee,ke,ct,gt){if(!H)throw Error("Invalid event type");var Ht=A(ct)?!!ct.capture:!!ct,nn=st(w);if(nn||(w[re]=nn=new we(w)),ee=nn.add(H,ee,ke,Ht,gt),ee.proxy)return ee;if(ke=pe(),ee.proxy=ke,ke.src=w,ke.listener=ee,w.addEventListener)Q||(ct=Ht),ct===void 0&&(ct=!1),w.addEventListener(H.toString(),ke,ct);else if(w.attachEvent)w.attachEvent(qe(H.toString()),ke);else if(w.addListener&&w.removeListener)w.addListener(ke);else throw Error("addEventListener and attachEvent are unavailable.");return ee}function pe(){function w(ee){return H.call(w.src,w.listener,ee)}const H=$e;return w}function Ee(w,H,ee,ke,ct){if(Array.isArray(H))for(var gt=0;gt<H.length;gt++)Ee(w,H[gt],ee,ke,ct);else ke=A(ke)?!!ke.capture:!!ke,ee=ze(ee),w&&w[z]?(w=w.i,H=String(H).toString(),H in w.g&&(gt=w.g[H],ee=Me(gt,ee,ke,ct),-1<ee&&(se(gt[ee]),Array.prototype.splice.call(gt,ee,1),gt.length==0&&(delete w.g[H],w.h--)))):w&&(w=st(w))&&(H=w.g[H.toString()],w=-1,H&&(w=Me(H,ee,ke,ct)),(ee=-1<w?H[w]:null)&&Ue(ee))}function Ue(w){if(typeof w!="number"&&w&&!w.da){var H=w.src;if(H&&H[z])q(H.i,w);else{var ee=w.type,ke=w.proxy;H.removeEventListener?H.removeEventListener(ee,ke,w.capture):H.detachEvent?H.detachEvent(qe(ee),ke):H.addListener&&H.removeListener&&H.removeListener(ke),(ee=st(H))?(q(ee,w),ee.h==0&&(ee.src=null,H[re]=null)):se(w)}}}function qe(w){return w in J?J[w]:J[w]="on"+w}function $e(w,H){if(w.da)w=!0;else{H=new M(H,this);var ee=w.listener,ke=w.ha||w.src;w.fa&&Ue(w),w=ee.call(ke,H)}return w}function st(w){return w=w[re],w instanceof we?w:null}var Se="__closure_events_fn_"+(1e9*Math.random()>>>0);function ze(w){return typeof w=="function"?w:(w[Se]||(w[Se]=function(H){return w.handleEvent(H)}),w[Se])}function Ke(){I.call(this),this.i=new we(this),this.M=this,this.F=null}m(Ke,I),Ke.prototype[z]=!0,Ke.prototype.removeEventListener=function(w,H,ee,ke){Ee(this,w,H,ee,ke)};function be(w,H){var ee,ke=w.F;if(ke)for(ee=[];ke;ke=ke.F)ee.push(ke);if(w=w.M,ke=H.type||H,typeof H=="string")H=new C(H,w);else if(H instanceof C)H.target=H.target||w;else{var ct=H;H=new C(ke,w),U(H,ct)}if(ct=!0,ee)for(var gt=ee.length-1;0<=gt;gt--){var Ht=H.g=ee[gt];ct=le(Ht,ke,!0,H)&&ct}if(Ht=H.g=w,ct=le(Ht,ke,!0,H)&&ct,ct=le(Ht,ke,!1,H)&&ct,ee)for(gt=0;gt<ee.length;gt++)Ht=H.g=ee[gt],ct=le(Ht,ke,!1,H)&&ct}Ke.prototype.N=function(){if(Ke.aa.N.call(this),this.i){var w=this.i,H;for(H in w.g){for(var ee=w.g[H],ke=0;ke<ee.length;ke++)se(ee[ke]);delete w.g[H],w.h--}}this.F=null},Ke.prototype.K=function(w,H,ee,ke){return this.i.add(String(w),H,!1,ee,ke)},Ke.prototype.L=function(w,H,ee,ke){return this.i.add(String(w),H,!0,ee,ke)};function le(w,H,ee,ke){if(H=w.i.g[String(H)],!H)return!0;H=H.concat();for(var ct=!0,gt=0;gt<H.length;++gt){var Ht=H[gt];if(Ht&&!Ht.da&&Ht.capture==ee){var nn=Ht.listener,ps=Ht.ha||Ht.src;Ht.fa&&q(w.i,Ht),ct=nn.call(ps,ke)!==!1&&ct}}return ct&&!ke.defaultPrevented}function je(w,H,ee){if(typeof w=="function")ee&&(w=f(w,ee));else if(w&&typeof w.handleEvent=="function")w=f(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(H)?-1:l.setTimeout(w,H||0)}function X(w){w.g=je(()=>{w.g=null,w.i&&(w.i=!1,X(w))},w.l);const H=w.h;w.h=null,w.m.apply(null,H)}class G extends I{constructor(H,ee){super(),this.m=H,this.l=ee,this.h=null,this.i=!1,this.g=null}j(H){this.h=arguments,this.g?this.i=!0:X(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ye(w){I.call(this),this.h=w,this.g={}}m(ye,I);var Oe=[];function _e(w){R(w.g,function(H,ee){this.g.hasOwnProperty(ee)&&Ue(H)},w),w.g={}}ye.prototype.N=function(){ye.aa.N.call(this),_e(this)},ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=l.JSON.stringify,Ce=l.JSON.parse,Ze=class{stringify(w){return l.JSON.stringify(w,void 0)}parse(w){return l.JSON.parse(w,void 0)}};function Te(){}Te.prototype.h=null;function Ge(w){return w.h||(w.h=w.i())}function at(){}var wt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function it(){C.call(this,"d")}m(it,C);function xt(){C.call(this,"c")}m(xt,C);var Lt={},hr=null;function lr(){return hr=hr||new Ke}Lt.La="serverreachability";function gr(w){C.call(this,Lt.La,w)}m(gr,C);function xr(w){const H=lr();be(H,new gr(H))}Lt.STAT_EVENT="statevent";function Ye(w,H){C.call(this,Lt.STAT_EVENT,w),this.stat=H}m(Ye,C);function pt(w){const H=lr();be(H,new Ye(H,w))}Lt.Ma="timingevent";function Rt(w,H){C.call(this,Lt.Ma,w),this.size=H}m(Rt,C);function Tt(w,H){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){w()},H)}function Dt(){this.g=!0}Dt.prototype.xa=function(){this.g=!1};function Xt(w,H,ee,ke,ct,gt){w.info(function(){if(w.g)if(gt)for(var Ht="",nn=gt.split("&"),ps=0;ps<nn.length;ps++){var Kr=nn[ps].split("=");if(1<Kr.length){var dn=Kr[0];Kr=Kr[1];var Qn=dn.split("_");Ht=2<=Qn.length&&Qn[1]=="type"?Ht+(dn+"="+Kr+"&"):Ht+(dn+"=redacted&")}}else Ht=null;else Ht=gt;return"XMLHTTP REQ ("+ke+") [attempt "+ct+"]: "+H+`
`+ee+`
`+Ht})}function Kt(w,H,ee,ke,ct,gt,Ht){w.info(function(){return"XMLHTTP RESP ("+ke+") [ attempt "+ct+"]: "+H+`
`+ee+`
`+gt+" "+Ht})}function oe(w,H,ee,ke){w.info(function(){return"XMLHTTP TEXT ("+H+"): "+ue(w,ee)+(ke?" "+ke:"")})}function ne(w,H){w.info(function(){return"TIMEOUT: "+H})}Dt.prototype.info=function(){};function ue(w,H){if(!w.g)return H;if(!H)return null;try{var ee=JSON.parse(H);if(ee){for(w=0;w<ee.length;w++)if(Array.isArray(ee[w])){var ke=ee[w];if(!(2>ke.length)){var ct=ke[1];if(Array.isArray(ct)&&!(1>ct.length)){var gt=ct[0];if(gt!="noop"&&gt!="stop"&&gt!="close")for(var Ht=1;Ht<ct.length;Ht++)ct[Ht]=""}}}}return he(ee)}catch{return H}}var ge={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},De;function We(){}m(We,Te),We.prototype.g=function(){return new XMLHttpRequest},We.prototype.i=function(){return{}},De=new We;function rt(w,H,ee,ke){this.j=w,this.i=H,this.l=ee,this.R=ke||1,this.U=new ye(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}var Xe={},et={};function dt(w,H,ee){w.L=1,w.v=Rc(Ys(H)),w.m=ee,w.P=!0,vt(w,null)}function vt(w,H){w.F=Date.now(),yt(w),w.A=Ys(w.v);var ee=w.A,ke=w.R;Array.isArray(ke)||(ke=[String(ke)]),lf(ee.i,"t",ke),w.C=0,ee=w.j.J,w.h=new Le,w.g=bs(w.j,ee?H:null,!w.m),0<w.O&&(w.M=new G(f(w.Y,w,w.g),w.O)),H=w.U,ee=w.g,ke=w.ca;var ct="readystatechange";Array.isArray(ct)||(ct&&(Oe[0]=ct.toString()),ct=Oe);for(var gt=0;gt<ct.length;gt++){var Ht=K(ee,ct[gt],ke||H.handleEvent,!1,H.h||H);if(!Ht)break;H.g[Ht.key]=Ht}H=w.H?S(w.H):{},w.m?(w.u||(w.u="POST"),H["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,H)):(w.u="GET",w.g.ea(w.A,w.u,null,H)),xr(),Xt(w.i,w.u,w.A,w.l,w.R,w.m)}rt.prototype.ca=function(w){w=w.target;const H=this.M;H&&vi(w)==3?H.j():this.Y(w)},rt.prototype.Y=function(w){try{if(w==this.g)e:{const Qn=vi(this.g);var H=this.g.Ba();const no=this.g.Z();if(!(3>Qn)&&(Qn!=3||this.g&&(this.h.h||this.g.oa()||Cd(this.g)))){this.J||Qn!=4||H==7||(H==8||0>=no?xr(3):xr(2)),Rr(this);var ee=this.g.Z();this.X=ee;t:if(Nt(this)){var ke=Cd(this.g);w="";var ct=ke.length,gt=vi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jr(this),Nr(this);var Ht="";break t}this.h.i=new l.TextDecoder}for(H=0;H<ct;H++)this.h.h=!0,w+=this.h.i.decode(ke[H],{stream:!(gt&&H==ct-1)});ke.length=0,this.h.g+=w,this.C=0,Ht=this.h.g}else Ht=this.g.oa();if(this.o=ee==200,Kt(this.i,this.u,this.A,this.l,this.R,Qn,ee),this.o){if(this.T&&!this.K){t:{if(this.g){var nn,ps=this.g;if((nn=ps.g?ps.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(nn)){var Kr=nn;break t}}Kr=null}if(ee=Kr)oe(this.i,this.l,ee,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Di(this,ee);else{this.o=!1,this.s=3,pt(12),Jr(this),Nr(this);break e}}if(this.P){ee=!0;let Wa;for(;!this.J&&this.C<Ht.length;)if(Wa=At(this,Ht),Wa==et){Qn==4&&(this.s=4,pt(14),ee=!1),oe(this.i,this.l,null,"[Incomplete Response]");break}else if(Wa==Xe){this.s=4,pt(15),oe(this.i,this.l,Ht,"[Invalid Chunk]"),ee=!1;break}else oe(this.i,this.l,Wa,null),Di(this,Wa);if(Nt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qn!=4||Ht.length!=0||this.h.h||(this.s=1,pt(16),ee=!1),this.o=this.o&&ee,!ee)oe(this.i,this.l,Ht,"[Invalid Chunked Response]"),Jr(this),Nr(this);else if(0<Ht.length&&!this.W){this.W=!0;var dn=this.j;dn.g==this&&dn.ba&&!dn.M&&(dn.j.info("Great, no buffering proxy detected. Bytes received: "+Ht.length),tr(dn),dn.M=!0,pt(11))}}else oe(this.i,this.l,Ht,null),Di(this,Ht);Qn==4&&Jr(this),this.o&&!this.J&&(Qn==4?Ir(this.j,this):(this.o=!1,yt(this)))}else Af(this.g),ee==400&&0<Ht.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),Jr(this),Nr(this)}}}catch{}finally{}};function Nt(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function At(w,H){var ee=w.C,ke=H.indexOf(`
`,ee);return ke==-1?et:(ee=Number(H.substring(ee,ke)),isNaN(ee)?Xe:(ke+=1,ke+ee>H.length?et:(H=H.slice(ke,ke+ee),w.C=ke+ee,H)))}rt.prototype.cancel=function(){this.J=!0,Jr(this)};function yt(w){w.S=Date.now()+w.I,Zt(w,w.I)}function Zt(w,H){if(w.B!=null)throw Error("WatchDog timer not null");w.B=Tt(f(w.ba,w),H)}function Rr(w){w.B&&(l.clearTimeout(w.B),w.B=null)}rt.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(ne(this.i,this.A),this.L!=2&&(xr(),pt(17)),Jr(this),this.s=2,Nr(this)):Zt(this,this.S-w)};function Nr(w){w.j.G==0||w.J||Ir(w.j,w)}function Jr(w){Rr(w);var H=w.M;H&&typeof H.ma=="function"&&H.ma(),w.M=null,_e(w.U),w.g&&(H=w.g,w.g=null,H.abort(),H.ma())}function Di(w,H){try{var ee=w.j;if(ee.G!=0&&(ee.g==w||ts(ee.h,w))){if(!w.K&&ts(ee.h,w)&&ee.G==3){try{var ke=ee.Da.g.parse(H)}catch{ke=null}if(Array.isArray(ke)&&ke.length==3){var ct=ke;if(ct[0]==0){e:if(!ee.u){if(ee.g)if(ee.g.F+3e3<w.F)wr(ee),Oo(ee);else break e;kt(ee),pt(18)}}else ee.za=ct[1],0<ee.za-ee.T&&37500>ct[2]&&ee.F&&ee.v==0&&!ee.C&&(ee.C=Tt(f(ee.Za,ee),6e3));if(1>=ml(ee.h)&&ee.ca){try{ee.ca()}catch{}ee.ca=void 0}}else pn(ee,11)}else if((w.K||ee.g==w)&&wr(ee),!y(H))for(ct=ee.Da.g.parse(H),H=0;H<ct.length;H++){let Kr=ct[H];if(ee.T=Kr[0],Kr=Kr[1],ee.G==2)if(Kr[0]=="c"){ee.K=Kr[1],ee.ia=Kr[2];const dn=Kr[3];dn!=null&&(ee.la=dn,ee.j.info("VER="+ee.la));const Qn=Kr[4];Qn!=null&&(ee.Aa=Qn,ee.j.info("SVER="+ee.Aa));const no=Kr[5];no!=null&&typeof no=="number"&&0<no&&(ke=1.5*no,ee.L=ke,ee.j.info("backChannelRequestTimeoutMs_="+ke)),ke=ee;const Wa=w.g;if(Wa){const Fa=Wa.g?Wa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fa){var gt=ke.h;gt.g||Fa.indexOf("spdy")==-1&&Fa.indexOf("quic")==-1&&Fa.indexOf("h2")==-1||(gt.j=gt.l,gt.g=new Set,gt.h&&(Jl(gt,gt.h),gt.h=null))}if(ke.D){const xl=Wa.g?Wa.g.getResponseHeader("X-HTTP-Session-Id"):null;xl&&(ke.ya=xl,Xr(ke.I,ke.D,xl))}}ee.G=3,ee.l&&ee.l.ua(),ee.ba&&(ee.R=Date.now()-w.F,ee.j.info("Handshake RTT: "+ee.R+"ms")),ke=ee;var Ht=w;if(ke.qa=vn(ke,ke.J?ke.ia:null,ke.W),Ht.K){rf(ke.h,Ht);var nn=Ht,ps=ke.L;ps&&(nn.I=ps),nn.B&&(Rr(nn),yt(nn)),ke.g=Ht}else Bt(ke);0<ee.i.length&&P(ee)}else Kr[0]!="stop"&&Kr[0]!="close"||pn(ee,7);else ee.G==3&&(Kr[0]=="stop"||Kr[0]=="close"?Kr[0]=="stop"?pn(ee,7):MA(ee):Kr[0]!="noop"&&ee.l&&ee.l.ta(Kr),ee.v=0)}}xr(4)}catch{}}var eo=class{constructor(w,H){this.g=w,this.map=H}};function to(w){this.l=w||10,l.PerformanceNavigationTiming?(w=l.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xi(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function ml(w){return w.h?1:w.g?w.g.size:0}function ts(w,H){return w.h?w.h==H:w.g?w.g.has(H):!1}function Jl(w,H){w.g?w.g.add(H):w.h=H}function rf(w,H){w.h&&w.h==H?w.h=null:w.g&&w.g.has(H)&&w.g.delete(H)}to.prototype.cancel=function(){if(this.i=ds(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function ds(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let H=w.i;for(const ee of w.g.values())H=H.concat(ee.D);return H}return p(w.i)}function nf(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map<"u"&&w instanceof Map||typeof Set<"u"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(c(w)){for(var H=[],ee=w.length,ke=0;ke<ee;ke++)H.push(w[ke]);return H}H=[],ee=0;for(ke in w)H[ee++]=w[ke];return H}function jo(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map<"u"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set<"u"&&w instanceof Set)){if(c(w)||typeof w=="string"){var H=[];w=w.length;for(var ee=0;ee<w;ee++)H.push(ee);return H}H=[],ee=0;for(const ke in w)H[ee++]=ke;return H}}}function jc(w,H){if(w.forEach&&typeof w.forEach=="function")w.forEach(H,void 0);else if(c(w)||typeof w=="string")Array.prototype.forEach.call(w,H,void 0);else for(var ee=jo(w),ke=nf(w),ct=ke.length,gt=0;gt<ct;gt++)H.call(void 0,ke[gt],ee&&ee[gt],w)}var wd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Li(w,H){if(w){w=w.split("&");for(var ee=0;ee<w.length;ee++){var ke=w[ee].indexOf("="),ct=null;if(0<=ke){var gt=w[ee].substring(0,ke);ct=w[ee].substring(ke+1)}else gt=w[ee];H(gt,ct?decodeURIComponent(ct.replace(/\+/g," ")):"")}}}function Rn(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof Rn){this.h=w.h,Pc(this,w.j),this.o=w.o,this.g=w.g,RA(this,w.s),this.l=w.l;var H=w.i,ee=new Ia;ee.i=H.i,H.g&&(ee.g=new Map(H.g),ee.h=H.h),sf(this,ee),this.m=w.m}else w&&(H=String(w).match(wd))?(this.h=!1,Pc(this,H[1]||"",!0),this.o=Xl(H[2]||""),this.g=Xl(H[3]||"",!0),RA(this,H[4]),this.l=Xl(H[5]||"",!0),sf(this,H[6]||"",!0),this.m=Xl(H[7]||"")):(this.h=!1,this.i=new Ia(null,this.h))}Rn.prototype.toString=function(){var w=[],H=this.j;H&&w.push(Po(H,af,!0),":");var ee=this.g;return(ee||H=="file")&&(w.push("//"),(H=this.o)&&w.push(Po(H,af,!0),"@"),w.push(encodeURIComponent(String(ee)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ee=this.s,ee!=null&&w.push(":",String(ee))),(ee=this.l)&&(this.g&&ee.charAt(0)!="/"&&w.push("/"),w.push(Po(ee,ee.charAt(0)=="/"?hm:dm,!0))),(ee=this.i.toString())&&w.push("?",ee),(ee=this.m)&&w.push("#",Po(ee,of)),w.join("")};function Ys(w){return new Rn(w)}function Pc(w,H,ee){w.j=ee?Xl(H,!0):H,w.j&&(w.j=w.j.replace(/:$/,""))}function RA(w,H){if(H){if(H=Number(H),isNaN(H)||0>H)throw Error("Bad port number "+H);w.s=H}else w.s=null}function sf(w,H,ee){H instanceof Ia?(w.i=H,fm(w.i,w.h)):(ee||(H=Po(H,yd)),w.i=new Ia(H,w.h))}function Xr(w,H,ee){w.i.set(H,ee)}function Rc(w){return Xr(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function Xl(w,H){return w?H?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Po(w,H,ee){return typeof w=="string"?(w=encodeURI(w).replace(H,Dc),ee&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function Dc(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var af=/[#\/\?@]/g,dm=/[#\?:]/g,hm=/[#\?]/g,yd=/[#\?@]/g,of=/#/g;function Ia(w,H){this.h=this.g=null,this.i=w||null,this.j=!!H}function Ro(w){w.g||(w.g=new Map,w.h=0,w.i&&Li(w.i,function(H,ee){w.add(decodeURIComponent(H.replace(/\+/g," ")),ee)}))}t=Ia.prototype,t.add=function(w,H){Ro(this),this.i=null,w=vr(this,w);var ee=this.g.get(w);return ee||this.g.set(w,ee=[]),ee.push(H),this.h+=1,this};function Yl(w,H){Ro(w),H=vr(w,H),w.g.has(H)&&(w.i=null,w.h-=w.g.get(H).length,w.g.delete(H))}function DA(w,H){return Ro(w),H=vr(w,H),w.g.has(H)}t.forEach=function(w,H){Ro(this),this.g.forEach(function(ee,ke){ee.forEach(function(ct){w.call(H,ct,ke,this)},this)},this)},t.na=function(){Ro(this);const w=Array.from(this.g.values()),H=Array.from(this.g.keys()),ee=[];for(let ke=0;ke<H.length;ke++){const ct=w[ke];for(let gt=0;gt<ct.length;gt++)ee.push(H[ke])}return ee},t.V=function(w){Ro(this);let H=[];if(typeof w=="string")DA(this,w)&&(H=H.concat(this.g.get(vr(this,w))));else{w=Array.from(this.g.values());for(let ee=0;ee<w.length;ee++)H=H.concat(w[ee])}return H},t.set=function(w,H){return Ro(this),this.i=null,w=vr(this,w),DA(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[H]),this.h+=1,this},t.get=function(w,H){return w?(w=this.V(w),0<w.length?String(w[0]):H):H};function lf(w,H,ee){Yl(w,H),0<ee.length&&(w.i=null,w.g.set(vr(w,H),p(ee)),w.h+=ee.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],H=Array.from(this.g.keys());for(var ee=0;ee<H.length;ee++){var ke=H[ee];const gt=encodeURIComponent(String(ke)),Ht=this.V(ke);for(ke=0;ke<Ht.length;ke++){var ct=gt;Ht[ke]!==""&&(ct+="="+encodeURIComponent(String(Ht[ke]))),w.push(ct)}}return this.i=w.join("&")};function vr(w,H){return H=String(H),w.j&&(H=H.toLowerCase()),H}function fm(w,H){H&&!w.j&&(Ro(w),w.i=null,w.g.forEach(function(ee,ke){var ct=ke.toLowerCase();ke!=ct&&(Yl(this,ke),lf(this,ct,ee))},w)),w.j=H}function mm(w,H){const ee=new Dt;if(l.Image){const ke=new Image;ke.onload=h(fa,ee,"TestLoadImage: loaded",!0,H,ke),ke.onerror=h(fa,ee,"TestLoadImage: error",!1,H,ke),ke.onabort=h(fa,ee,"TestLoadImage: abort",!1,H,ke),ke.ontimeout=h(fa,ee,"TestLoadImage: timeout",!1,H,ke),l.setTimeout(function(){ke.ontimeout&&ke.ontimeout()},1e4),ke.src=w}else H(!1)}function pm(w,H){const ee=new Dt,ke=new AbortController,ct=setTimeout(()=>{ke.abort(),fa(ee,"TestPingServer: timeout",!1,H)},1e4);fetch(w,{signal:ke.signal}).then(gt=>{clearTimeout(ct),gt.ok?fa(ee,"TestPingServer: ok",!0,H):fa(ee,"TestPingServer: server error",!1,H)}).catch(()=>{clearTimeout(ct),fa(ee,"TestPingServer: error",!1,H)})}function fa(w,H,ee,ke,ct){try{ct&&(ct.onload=null,ct.onerror=null,ct.onabort=null,ct.ontimeout=null),ke(ee)}catch{}}function pl(){this.g=new Ze}function gm(w,H,ee){const ke=ee||"";try{jc(w,function(ct,gt){let Ht=ct;A(ct)&&(Ht=he(ct)),H.push(ke+gt+"="+encodeURIComponent(Ht))})}catch(ct){throw H.push(ke+"type="+encodeURIComponent("_badmap")),ct}}function LA(w){this.l=w.Ub||null,this.j=w.eb||!1}m(LA,Te),LA.prototype.g=function(){return new gl(this.l,this.j)},LA.prototype.i=function(w){return function(){return w}}({});function gl(w,H){Ke.call(this),this.D=w,this.o=H,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(gl,Ke),t=gl.prototype,t.open=function(w,H){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=H,this.readyState=1,Lc(this)},t.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const H={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(H.body=w),(this.D||l).fetch(new Request(this.A,H)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ro(this)),this.readyState=0},t.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,Lc(this)),this.g&&(this.readyState=3,Lc(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;UA(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function UA(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}t.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var H=w.value?w.value:new Uint8Array(0);(H=this.v.decode(H,{stream:!w.done}))&&(this.response=this.responseText+=H)}w.done?ro(this):Lc(this),this.readyState==3&&UA(this)}},t.Ra=function(w){this.g&&(this.response=this.responseText=w,ro(this))},t.Qa=function(w){this.g&&(this.response=w,ro(this))},t.ga=function(){this.g&&ro(this)};function ro(w){w.readyState=4,w.l=null,w.j=null,w.v=null,Lc(w)}t.setRequestHeader=function(w,H){this.u.append(w,H)},t.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],H=this.h.entries();for(var ee=H.next();!ee.done;)ee=ee.value,w.push(ee[0]+": "+ee[1]),ee=H.next();return w.join(`\r
`)};function Lc(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(gl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function Do(w){let H="";return R(w,function(ee,ke){H+=ke,H+=":",H+=ee,H+=`\r
`}),H}function bd(w,H,ee){e:{for(ke in ee){var ke=!1;break e}ke=!0}ke||(ee=Do(ee),typeof w=="string"?ee!=null&&encodeURIComponent(String(ee)):Xr(w,H,ee))}function kn(w){Ke.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(kn,Ke);var Nd=/^https?$/i,cf=["POST","PUT"];t=kn.prototype,t.Ha=function(w){this.J=w},t.ea=function(w,H,ee,ke){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);H=H?H.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?Ge(this.o):Ge(De),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(H,String(w),!0),this.B=!1}catch(gt){Lo(this,gt);return}if(w=ee||"",ee=new Map(this.headers),ke)if(Object.getPrototypeOf(ke)===Object.prototype)for(var ct in ke)ee.set(ct,ke[ct]);else if(typeof ke.keys=="function"&&typeof ke.get=="function")for(const gt of ke.keys())ee.set(gt,ke.get(gt));else throw Error("Unknown input type for opt_headers: "+String(ke));ke=Array.from(ee.keys()).find(gt=>gt.toLowerCase()=="content-type"),ct=l.FormData&&w instanceof l.FormData,!(0<=Array.prototype.indexOf.call(cf,H,void 0))||ke||ct||ee.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[gt,Ht]of ee)this.g.setRequestHeader(gt,Ht);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ec(this),this.u=!0,this.g.send(w),this.u=!1}catch(gt){Lo(this,gt)}};function Lo(w,H){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=H,w.m=5,OA(w),Zl(w)}function OA(w){w.A||(w.A=!0,be(w,"complete"),be(w,"error"))}t.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,be(this,"complete"),be(this,"abort"),Zl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zl(this,!0)),kn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Uc(this):this.bb())},t.bb=function(){Uc(this)};function Uc(w){if(w.h&&typeof o<"u"&&(!w.v[1]||vi(w)!=4||w.Z()!=2)){if(w.u&&vi(w)==4)je(w.Ea,0,w);else if(be(w,"readystatechange"),vi(w)==4){w.h=!1;try{const Ht=w.Z();e:switch(Ht){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var H=!0;break e;default:H=!1}var ee;if(!(ee=H)){var ke;if(ke=Ht===0){var ct=String(w.D).match(wd)[1]||null;!ct&&l.self&&l.self.location&&(ct=l.self.location.protocol.slice(0,-1)),ke=!Nd.test(ct?ct.toLowerCase():"")}ee=ke}if(ee)be(w,"complete"),be(w,"success");else{w.m=6;try{var gt=2<vi(w)?w.g.statusText:""}catch{gt=""}w.l=gt+" ["+w.Z()+"]",OA(w)}}finally{Zl(w)}}}}function Zl(w,H){if(w.g){ec(w);const ee=w.g,ke=w.v[0]?()=>{}:null;w.g=null,w.v=null,H||be(w,"ready");try{ee.onreadystatechange=ke}catch{}}}function ec(w){w.I&&(l.clearTimeout(w.I),w.I=null)}t.isActive=function(){return!!this.g};function vi(w){return w.g?w.g.readyState:0}t.Z=function(){try{return 2<vi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(w){if(this.g){var H=this.g.responseText;return w&&H.indexOf(w)==0&&(H=H.substring(w.length)),Ce(H)}};function Cd(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function Af(w){const H={};w=(w.g&&2<=vi(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let ke=0;ke<w.length;ke++){if(y(w[ke]))continue;var ee=k(w[ke]);const ct=ee[0];if(ee=ee[1],typeof ee!="string")continue;ee=ee.trim();const gt=H[ct]||[];H[ct]=gt,gt.push(ee)}E(H,function(ke){return ke.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wi(w,H,ee){return ee&&ee.internalChannelParams&&ee.internalChannelParams[w]||H}function Uo(w){this.Aa=0,this.i=[],this.j=new Dt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wi("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wi("baseRetryDelayMs",5e3,w),this.cb=wi("retryDelaySeedMs",1e4,w),this.Wa=wi("forwardChannelMaxRetries",2,w),this.wa=wi("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new to(w&&w.concurrentRequestLimit),this.Da=new pl,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Uo.prototype,t.la=8,t.G=1,t.connect=function(w,H,ee,ke){pt(0),this.W=w,this.H=H||{},ee&&ke!==void 0&&(this.H.OSID=ee,this.H.OAID=ke),this.F=this.X,this.I=vn(this,null,this.W),P(this)};function MA(w){if(_d(w),w.G==3){var H=w.U++,ee=Ys(w.I);if(Xr(ee,"SID",w.K),Xr(ee,"RID",H),Xr(ee,"TYPE","terminate"),Je(w,ee),H=new rt(w,w.j,H),H.L=2,H.v=Rc(Ys(ee)),ee=!1,l.navigator&&l.navigator.sendBeacon)try{ee=l.navigator.sendBeacon(H.v.toString(),"")}catch{}!ee&&l.Image&&(new Image().src=H.v,ee=!0),ee||(H.g=bs(H.j,null),H.g.ea(H.v)),H.F=Date.now(),yt(H)}hs(w)}function Oo(w){w.g&&(tr(w),w.g.cancel(),w.g=null)}function _d(w){Oo(w),w.u&&(l.clearTimeout(w.u),w.u=null),wr(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&l.clearTimeout(w.s),w.s=null)}function P(w){if(!xi(w.h)&&!w.s){w.s=!0;var H=w.Ga;fe||xe(),de||(fe(),de=!0),Z.add(H,w),w.B=0}}function ce(w,H){return ml(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=H.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=Tt(f(w.Ga,w,H),Yr(w,w.B)),w.B++,!0)}t.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const ct=new rt(this,this.j,w);let gt=this.o;if(this.S&&(gt?(gt=S(gt),U(gt,this.S)):gt=this.S),this.m!==null||this.O||(ct.H=gt,gt=null),this.P)e:{for(var H=0,ee=0;ee<this.i.length;ee++){t:{var ke=this.i[ee];if("__data__"in ke.map&&(ke=ke.map.__data__,typeof ke=="string")){ke=ke.length;break t}ke=void 0}if(ke===void 0)break;if(H+=ke,4096<H){H=ee;break e}if(H===4096||ee===this.i.length-1){H=ee+1;break e}}H=1e3}else H=1e3;H=lt(this,ct,H),ee=Ys(this.I),Xr(ee,"RID",w),Xr(ee,"CVER",22),this.D&&Xr(ee,"X-HTTP-Session-Id",this.D),Je(this,ee),gt&&(this.O?H="headers="+encodeURIComponent(String(Do(gt)))+"&"+H:this.m&&bd(ee,this.m,gt)),Jl(this.h,ct),this.Ua&&Xr(ee,"TYPE","init"),this.P?(Xr(ee,"$req",H),Xr(ee,"SID","null"),ct.T=!0,dt(ct,ee,null)):dt(ct,ee,H),this.G=2}}else this.G==3&&(w?Qe(this,w):this.i.length==0||xi(this.h)||Qe(this))};function Qe(w,H){var ee;H?ee=H.l:ee=w.U++;const ke=Ys(w.I);Xr(ke,"SID",w.K),Xr(ke,"RID",ee),Xr(ke,"AID",w.T),Je(w,ke),w.m&&w.o&&bd(ke,w.m,w.o),ee=new rt(w,w.j,ee,w.B+1),w.m===null&&(ee.H=w.o),H&&(w.i=H.D.concat(w.i)),H=lt(w,ee,1e3),ee.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),Jl(w.h,ee),dt(ee,ke,H)}function Je(w,H){w.H&&R(w.H,function(ee,ke){Xr(H,ke,ee)}),w.l&&jc({},function(ee,ke){Xr(H,ke,ee)})}function lt(w,H,ee){ee=Math.min(w.i.length,ee);var ke=w.l?f(w.l.Na,w.l,w):null;e:{var ct=w.i;let gt=-1;for(;;){const Ht=["count="+ee];gt==-1?0<ee?(gt=ct[0].g,Ht.push("ofs="+gt)):gt=0:Ht.push("ofs="+gt);let nn=!0;for(let ps=0;ps<ee;ps++){let Kr=ct[ps].g;const dn=ct[ps].map;if(Kr-=gt,0>Kr)gt=Math.max(0,ct[ps].g-100),nn=!1;else try{gm(dn,Ht,"req"+Kr+"_")}catch{ke&&ke(dn)}}if(nn){ke=Ht.join("&");break e}}}return w=w.i.splice(0,ee),H.D=w,ke}function Bt(w){if(!w.g&&!w.u){w.Y=1;var H=w.Fa;fe||xe(),de||(fe(),de=!0),Z.add(H,w),w.v=0}}function kt(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=Tt(f(w.Fa,w),Yr(w,w.v)),w.v++,!0)}t.Fa=function(){if(this.u=null,cr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=Tt(f(this.ab,this),w)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),Oo(this),cr(this))};function tr(w){w.A!=null&&(l.clearTimeout(w.A),w.A=null)}function cr(w){w.g=new rt(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var H=Ys(w.qa);Xr(H,"RID","rpc"),Xr(H,"SID",w.K),Xr(H,"AID",w.T),Xr(H,"CI",w.F?"0":"1"),!w.F&&w.ja&&Xr(H,"TO",w.ja),Xr(H,"TYPE","xmlhttp"),Je(w,H),w.m&&w.o&&bd(H,w.m,w.o),w.L&&(w.g.I=w.L);var ee=w.g;w=w.ia,ee.L=1,ee.v=Rc(Ys(H)),ee.m=null,ee.P=!0,vt(ee,w)}t.Za=function(){this.C!=null&&(this.C=null,Oo(this),kt(this),pt(19))};function wr(w){w.C!=null&&(l.clearTimeout(w.C),w.C=null)}function Ir(w,H){var ee=null;if(w.g==H){wr(w),tr(w),w.g=null;var ke=2}else if(ts(w.h,H))ee=H.D,rf(w.h,H),ke=1;else return;if(w.G!=0){if(H.o)if(ke==1){ee=H.m?H.m.length:0,H=Date.now()-H.F;var ct=w.B;ke=lr(),be(ke,new Rt(ke,ee)),P(w)}else Bt(w);else if(ct=H.s,ct==3||ct==0&&0<H.X||!(ke==1&&ce(w,H)||ke==2&&kt(w)))switch(ee&&0<ee.length&&(H=w.h,H.i=H.i.concat(ee)),ct){case 1:pn(w,5);break;case 4:pn(w,10);break;case 3:pn(w,6);break;default:pn(w,2)}}}function Yr(w,H){let ee=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(ee*=2),ee*H}function pn(w,H){if(w.j.info("Error code "+H),H==2){var ee=f(w.fb,w),ke=w.Xa;const ct=!ke;ke=new Rn(ke||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Pc(ke,"https"),Rc(ke),ct?mm(ke.toString(),ee):pm(ke.toString(),ee)}else pt(2);w.G=0,w.l&&w.l.sa(H),hs(w),_d(w)}t.fb=function(w){w?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function hs(w){if(w.G=0,w.ka=[],w.l){const H=ds(w.h);(H.length!=0||w.i.length!=0)&&(x(w.ka,H),x(w.ka,w.i),w.h.i.length=0,p(w.i),w.i.length=0),w.l.ra()}}function vn(w,H,ee){var ke=ee instanceof Rn?Ys(ee):new Rn(ee);if(ke.g!="")H&&(ke.g=H+"."+ke.g),RA(ke,ke.s);else{var ct=l.location;ke=ct.protocol,H=H?H+"."+ct.hostname:ct.hostname,ct=+ct.port;var gt=new Rn(null);ke&&Pc(gt,ke),H&&(gt.g=H),ct&&RA(gt,ct),ee&&(gt.l=ee),ke=gt}return ee=w.D,H=w.ya,ee&&H&&Xr(ke,ee,H),Xr(ke,"VER",w.la),Je(w,ke),ke}function bs(w,H,ee){if(H&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return H=w.Ca&&!w.pa?new kn(new LA({eb:ee})):new kn(w.pa),H.Ha(w.J),H}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function fs(){}t=fs.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ns(){}Ns.prototype.g=function(w,H){return new ms(w,H)};function ms(w,H){Ke.call(this),this.g=new Uo(H),this.l=w,this.h=H&&H.messageUrlParams||null,w=H&&H.messageHeaders||null,H&&H.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=H&&H.initMessageHeaders||null,H&&H.messageContentType&&(w?w["X-WebChannel-Content-Type"]=H.messageContentType:w={"X-WebChannel-Content-Type":H.messageContentType}),H&&H.va&&(w?w["X-WebChannel-Client-Profile"]=H.va:w={"X-WebChannel-Client-Profile":H.va}),this.g.S=w,(w=H&&H.Sb)&&!y(w)&&(this.g.m=w),this.v=H&&H.supportsCrossDomainXhr||!1,this.u=H&&H.sendRawJson||!1,(H=H&&H.httpSessionIdParam)&&!y(H)&&(this.g.D=H,w=this.h,w!==null&&H in w&&(w=this.h,H in w&&delete w[H])),this.j=new Qo(this)}m(ms,Ke),ms.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ms.prototype.close=function(){MA(this.g)},ms.prototype.o=function(w){var H=this.g;if(typeof w=="string"){var ee={};ee.__data__=w,w=ee}else this.u&&(ee={},ee.__data__=he(w),w=ee);H.i.push(new eo(H.Ya++,w)),H.G==3&&P(H)},ms.prototype.N=function(){this.g.l=null,delete this.j,MA(this.g),delete this.g,ms.aa.N.call(this)};function Ui(w){it.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var H=w.__sm__;if(H){e:{for(const ee in H){w=ee;break e}w=void 0}(this.i=w)&&(w=this.i,H=H!==null&&w in H?H[w]:void 0),this.data=H}else this.data=w}m(Ui,it);function Mo(){xt.call(this),this.status=1}m(Mo,xt);function Qo(w){this.g=w}m(Qo,fs),Qo.prototype.ua=function(){be(this.g,"a")},Qo.prototype.ta=function(w){be(this.g,new Ui(w))},Qo.prototype.sa=function(w){be(this.g,new Mo)},Qo.prototype.ra=function(){be(this.g,"b")},Ns.prototype.createWebChannel=Ns.prototype.g,ms.prototype.send=ms.prototype.o,ms.prototype.open=ms.prototype.m,ms.prototype.close=ms.prototype.close,YL=function(){return new Ns},XL=function(){return lr()},JL=Lt,N_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,rw=ge,Fe.COMPLETE="complete",WL=Fe,at.EventType=wt,wt.OPEN="a",wt.CLOSE="b",wt.ERROR="c",wt.MESSAGE="d",Ke.prototype.listen=Ke.prototype.K,up=at,kn.prototype.listenOnce=kn.prototype.L,kn.prototype.getLastError=kn.prototype.Ka,kn.prototype.getLastErrorCode=kn.prototype.Ba,kn.prototype.getStatus=kn.prototype.Z,kn.prototype.getResponseJson=kn.prototype.Oa,kn.prototype.getResponseText=kn.prototype.oa,kn.prototype.send=kn.prototype.ea,kn.prototype.setWithCredentials=kn.prototype.Ha,zL=kn}).apply(typeof B1<"u"?B1:typeof self<"u"?self:typeof window<"u"?window:{});const fF="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ua.UNAUTHENTICATED=new Ua(null),Ua.GOOGLE_CREDENTIALS=new Ua("google-credentials-uid"),Ua.FIRST_PARTY=new Ua("first-party-uid"),Ua.MOCK_USER=new Ua("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch=new UB("@firebase/firestore");function Lf(){return Ch.logLevel}function Mt(t,...e){if(Ch.logLevel<=tn.DEBUG){const r=e.map(YB);Ch.debug(`Firestore (${Z0}): ${t}`,...r)}}function Ii(t,...e){if(Ch.logLevel<=tn.ERROR){const r=e.map(YB);Ch.error(`Firestore (${Z0}): ${t}`,...r)}}function Xu(t,...e){if(Ch.logLevel<=tn.WARN){const r=e.map(YB);Ch.warn(`Firestore (${Z0}): ${t}`,...r)}}function YB(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(t="Unexpected state"){const e=`FIRESTORE (${Z0}) INTERNAL ASSERTION FAILED: `+t;throw Ii(e),new Error(e)}function dr(t,e){t||ir()}function Sr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Gt extends FA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ua.UNAUTHENTICATED))}shutdown(){}}class Pz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Rz{constructor(e){this.t=e,this.currentUser=Ua.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){dr(this.o===void 0);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Dl;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Dl,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Mt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Mt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Dl)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Mt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(dr(typeof n.accessToken=="string"),new ZL(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return dr(e===null||typeof e=="string"),new Ua(e)}}class Dz{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Ua.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Lz{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Dz(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Ua.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Uz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Oz{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){dr(this.o===void 0);const n=a=>{a.error!=null&&Mt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,Mt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{Mt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):Mt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(dr(typeof r.token=="string"),this.R=r.token,new Uz(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mz(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=Mz(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%e.length))}return n}}function jr(t,e){return t<e?-1:t>e?1:0}function T0(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}function tU(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Vt.fromMillis(Date.now())}static fromDate(e){return Vt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Vt(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?jr(this.nanoseconds,e.nanoseconds):jr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e){this.timestamp=e}static fromTimestamp(e){return new mr(e)}static min(){return new mr(new Vt(0,0))}static max(){return new mr(new Vt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,r,n){r===void 0?r=0:r>e.length&&ir(),n===void 0?n=e.length-r:n>e.length-r&&ir(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ig.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ig?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=e.get(s),o=r.get(s);if(a<o)return-1;if(a>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class fn extends Ig{construct(e,r,n){return new fn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Gt(Et.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new fn(r)}static emptyPath(){return new fn([])}}const Qz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ls extends Ig{construct(e,r,n){return new ls(e,r,n)}static isValidIdentifier(e){return Qz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ls.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ls(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Gt(Et.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Gt(Et.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Gt(Et.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(a(),s++)}if(a(),o)throw new Gt(Et.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ls(r)}static emptyPath(){return new ls([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.path=e}static fromPath(e){return new Jt(fn.fromString(e))}static fromName(e){return new Jt(fn.fromString(e).popFirst(5))}static empty(){return new Jt(fn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return fn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Jt(new fn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,r,n,s){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=s}}function C_(t){return t.fields.find(e=>e.kind===2)}function Md(t){return t.fields.filter(e=>e.kind!==2)}Ww.UNKNOWN_ID=-1;class nw{constructor(e,r){this.fieldPath=e,this.kind=r}}class Fg{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new Fg(0,So.min())}}function Vz(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=mr.fromTimestamp(n===1e9?new Vt(r+1,0):new Vt(r,n));return new So(s,Jt.empty(),e)}function rU(t){return new So(t.readTime,t.key,-1)}class So{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new So(mr.min(),Jt.empty(),-1)}static max(){return new So(mr.max(),Jt.empty(),-1)}}function eS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Jt.comparator(t.documentKey,e.documentKey),r!==0?r:jr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sU{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qh(t){if(t.code!==Et.FAILED_PRECONDITION||t.message!==nU)throw t;Mt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ir(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new mt((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof mt?r:mt.resolve(r)}catch(r){return mt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):mt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):mt.reject(r)}static resolve(e){return new mt((r,n)=>{r(e)})}static reject(e){return new mt((r,n)=>{n(e)})}static waitFor(e){return new mt((r,n)=>{let s=0,a=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++a,o&&a===s&&r()},c=>n(c))}),o=!0,a===s&&r()})}static or(e){let r=mt.resolve(!1);for(const n of e)r=r.next(s=>s?mt.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new mt((n,s)=>{const a=e.length,o=new Array(a);let l=0;for(let c=0;c<a;c++){const A=c;r(e[A]).next(u=>{o[A]=u,++l,l===a&&n(o)},u=>s(u))}})}static doWhile(e,r){return new mt((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new Dl,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new Dp(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const s=tS(n.target.error);this.V.reject(new Dp(e,s))}}static open(e,r,n,s){try{return new iy(r,e.transaction(s,n))}catch(a){throw new Dp(r,a)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Mt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new Kz(r)}}class qu{constructor(e,r,n){this.name=e,this.version=r,this.p=n,qu.S(ua())===12.2&&Ii("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Mt("SimpleDb","Removing database:",e),Hd(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!aL())return!1;if(qu.v())return!0;const e=ua(),r=qu.S(e),n=0<r&&r<10,s=aU(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Mt("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const o=a.target.result;r(o)},s.onblocked=()=>{n(new Dp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const o=a.target.error;o.name==="VersionError"?n(new Gt(Et.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Gt(Et.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new Dp(e,o))},s.onupgradeneeded=a=>{Mt("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.p.O(o,s.transaction,a.oldVersion,this.version).next(()=>{Mt("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,s){const a=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=iy.open(this.db,e,a?"readonly":"readwrite",n),c=s(l).next(A=>(l.g(),A)).catch(A=>(l.abort(A),mt.reject(A))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,A=c.name!=="FirebaseError"&&o<3;if(Mt("SimpleDb","Transaction failed with error:",c.message,"Retrying:",A),this.close(),!A)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function aU(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Hz{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Hd(this.B.delete())}}class Dp extends Gt{constructor(e,r){super(Et.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function md(t){return t.name==="IndexedDbTransactionError"}class Kz{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Mt("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Mt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Hd(n)}add(e){return Mt("SimpleDb","ADD",this.store.name,e,e),Hd(this.store.add(e))}get(e){return Hd(this.store.get(e)).next(r=>(r===void 0&&(r=null),Mt("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Mt("SimpleDb","DELETE",this.store.name,e),Hd(this.store.delete(e))}count(){return Mt("SimpleDb","COUNT",this.store.name),Hd(this.store.count())}U(e,r){const n=this.options(e,r),s=n.index?this.store.index(n.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(n.range);return new mt((o,l)=>{a.onerror=c=>{l(c.target.error)},a.onsuccess=c=>{o(c.target.result)}})}{const a=this.cursor(n),o=[];return this.W(a,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new mt((s,a)=>{n.onerror=o=>{a(o.target.error)},n.onsuccess=o=>{s(o.target.result)}})}j(e,r){Mt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const s=this.cursor(n);return this.W(s,(a,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const s=this.cursor(n);return this.W(s,r)}Y(e){const r=this.cursor({});return new mt((n,s)=>{r.onerror=a=>{const o=tS(a.target.error);s(o)},r.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new mt((s,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new Hz(l),A=r(l.primaryKey,l.value,c);if(A instanceof mt){const u=A.catch(d=>(c.done(),mt.reject(d)));n.push(u)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>mt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function Hd(t){return new mt((e,r)=>{t.onsuccess=n=>{const s=n.target.result;e(s)},t.onerror=n=>{const s=tS(n.target.error);r(s)}})}let mF=!1;function tS(t){const e=qu.S(ua());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Gt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return mF||(mF=!0,setTimeout(()=>{throw n},0)),n}}return t}class qz{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Mt("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Mt("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){md(r)?Mt("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Qh(r)}await this.X(6e4)})}}class Gz{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let s=r,a=!0;return mt.doWhile(()=>a===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Mt("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(l=>{s-=l,n.add(o)});a=!1})).next(()=>r-s)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(s=>this.localStore.localDocuments.getNextDocuments(e,r,s,n).next(a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,a)).next(l=>(Mt("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((s,a)=>{const o=rU(a);eS(o,n)>0&&(n=o)}),new So(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}sl.oe=-1;function Nx(t){return t==null}function kg(t){return t===0&&1/t==-1/0}function $z(t){return typeof t=="number"&&Number.isInteger(t)&&!kg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=pF(e)),e=zz(t.get(r),e);return pF(e)}function zz(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case"":r+="";break;default:r+=a}}return r}function pF(t){return t+""}function mc(t){const e=t.length;if(dr(e>=2),e===2)return dr(t.charAt(0)===""&&t.charAt(1)===""),fn.emptyPath();const r=e-2,n=[];let s="";for(let a=0;a<e;){const o=t.indexOf("",a);switch((o<0||o>r)&&ir(),t.charAt(o+1)){case"":const l=t.substring(a,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),n.push(c);break;case"":s+=t.substring(a,o),s+="\0";break;case"":s+=t.substring(a,o+1);break;default:ir()}a=o+2}return new fn(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(t,e){return[t,ki(e)]}function iU(t,e,r){return[t,ki(e),r]}const Wz={},Jz=["prefixPath","collectionGroup","readTime","documentId"],Xz=["prefixPath","collectionGroup","documentId"],Yz=["collectionGroup","readTime","prefixPath","documentId"],Zz=["canonicalId","targetId"],eW=["targetId","path"],tW=["path","targetId"],rW=["collectionId","parent"],nW=["indexId","uid"],sW=["uid","sequenceNumber"],aW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],iW=["indexId","uid","orderedDocumentKey"],oW=["userId","collectionPath","documentId"],lW=["userId","collectionPath","largestBatchId"],cW=["userId","collectionGroup","largestBatchId"],oU=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],AW=[...oU,"documentOverlays"],lU=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],cU=lU,rS=[...cU,"indexConfiguration","indexState","indexEntries"],uW=rS,dW=[...rS,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __ extends sU{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function ha(t,e){const r=Sr(t);return qu.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xF(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Vh(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function AU(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,r){this.comparator=e,this.root=r||Oa.EMPTY}insert(e,r){return new us(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Oa.BLACK,null,null))}remove(e){return new us(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Oa.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new S1(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new S1(this.root,e,this.comparator,!1)}getReverseIterator(){return new S1(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new S1(this.root,e,this.comparator,!0)}}class S1{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Oa{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??Oa.RED,this.left=s??Oa.EMPTY,this.right=a??Oa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new Oa(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Oa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Oa.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Oa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Oa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ir();const e=this.left.check();if(e!==this.right.check())throw ir();return e+(this.isRed()?0:1)}}Oa.EMPTY=null,Oa.RED=!0,Oa.BLACK=!1;Oa.EMPTY=new class{constructor(){this.size=0}get key(){throw ir()}get value(){throw ir()}get color(){throw ir()}get left(){throw ir()}get right(){throw ir()}copy(e,r,n,s,a){return this}insert(e,r,n){return new Oa(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.comparator=e,this.data=new us(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new vF(this.data.getIterator())}getIteratorFrom(e){return new vF(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Pn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Pn(this.comparator);return r.data=e,r}}class vF{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function mf(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e){this.fields=e,e.sort(ls.comparator)}static empty(){return new $i([])}unionWith(e){let r=new Pn(ls.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new $i(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return T0(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new uU("Invalid base64 string: "+a):a}}(e);return new Ks(r)}static fromUint8Array(e){const r=function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a}(e);return new Ks(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return jr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ks.EMPTY_BYTE_STRING=new Ks("");const hW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function EA(t){if(dr(!!t),typeof t=="string"){let e=0;const r=hW.exec(t);if(dr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:as(t.seconds),nanos:as(t.nanos)}}function as(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Yu(t){return typeof t=="string"?Ks.fromBase64String(t):Ks.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function sS(t){const e=t.mapValue.fields.__previous_value__;return nS(e)?sS(e):e}function Tg(t){const e=EA(t.mapValue.fields.__local_write_time__.timestampValue);return new Vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fW{constructor(e,r,n,s,a,o,l,c,A){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=A}}class Zu{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Zu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Zu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},aw={nullValue:"NULL_VALUE"};function _h(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?nS(t)?4:dU(t)?9007199254740991:oy(t)?10:11:ir()}function Nc(t,e){if(t===e)return!0;const r=_h(t);if(r!==_h(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Tg(t).isEqual(Tg(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=EA(s.timestampValue),l=EA(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Yu(s.bytesValue).isEqual(Yu(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return as(s.geoPointValue.latitude)===as(a.geoPointValue.latitude)&&as(s.geoPointValue.longitude)===as(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return as(s.integerValue)===as(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=as(s.doubleValue),l=as(a.doubleValue);return o===l?kg(o)===kg(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return T0(t.arrayValue.values||[],e.arrayValue.values||[],Nc);case 10:case 11:return function(s,a){const o=s.mapValue.fields||{},l=a.mapValue.fields||{};if(xF(o)!==xF(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Nc(o[c],l[c])))return!1;return!0}(t,e);default:return ir()}}function jg(t,e){return(t.values||[]).find(r=>Nc(r,e))!==void 0}function ed(t,e){if(t===e)return 0;const r=_h(t),n=_h(e);if(r!==n)return jr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return jr(t.booleanValue,e.booleanValue);case 2:return function(a,o){const l=as(a.integerValue||a.doubleValue),c=as(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return wF(t.timestampValue,e.timestampValue);case 4:return wF(Tg(t),Tg(e));case 5:return jr(t.stringValue,e.stringValue);case 6:return function(a,o){const l=Yu(a),c=Yu(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const l=a.split("/"),c=o.split("/");for(let A=0;A<l.length&&A<c.length;A++){const u=jr(l[A],c[A]);if(u!==0)return u}return jr(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const l=jr(as(a.latitude),as(o.latitude));return l!==0?l:jr(as(a.longitude),as(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yF(t.arrayValue,e.arrayValue);case 10:return function(a,o){var l,c,A,u;const d=a.fields||{},f=o.fields||{},h=(l=d.value)===null||l===void 0?void 0:l.arrayValue,m=(c=f.value)===null||c===void 0?void 0:c.arrayValue,p=jr(((A=h==null?void 0:h.values)===null||A===void 0?void 0:A.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:yF(h,m)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===Bu.mapValue&&o===Bu.mapValue)return 0;if(a===Bu.mapValue)return 1;if(o===Bu.mapValue)return-1;const l=a.fields||{},c=Object.keys(l),A=o.fields||{},u=Object.keys(A);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const f=jr(c[d],u[d]);if(f!==0)return f;const h=ed(l[c[d]],A[u[d]]);if(h!==0)return h}return jr(c.length,u.length)}(t.mapValue,e.mapValue);default:throw ir()}}function wF(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return jr(t,e);const r=EA(t),n=EA(e),s=jr(r.seconds,n.seconds);return s!==0?s:jr(r.nanos,n.nanos)}function yF(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=ed(r[s],n[s]);if(a)return a}return jr(r.length,n.length)}function j0(t){return E_(t)}function E_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=EA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Yu(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Jt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=E_(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const o of n)a?a=!1:s+=",",s+=`${o}:${E_(r.fields[o])}`;return s+"}"}(t.mapValue):ir()}function Pg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function B_(t){return!!t&&"integerValue"in t}function Rg(t){return!!t&&"arrayValue"in t}function bF(t){return!!t&&"nullValue"in t}function NF(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function iw(t){return!!t&&"mapValue"in t}function oy(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Lp(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Vh(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Lp(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Lp(t.arrayValue.values[r]);return e}return Object.assign({},t)}function dU(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const hU={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function mW(t){return"nullValue"in t?aw:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Pg(Zu.empty(),Jt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?oy(t)?hU:{mapValue:{}}:ir()}function pW(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Pg(Zu.empty(),Jt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?hU:"mapValue"in t?oy(t)?{mapValue:{}}:Bu:ir()}function CF(t,e){const r=ed(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function _F(t,e){const r=ed(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.value=e}static empty(){return new Ha({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!iw(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lp(r)}setAll(e){let r=ls.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=Lp(o):s.push(l.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());iw(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Nc(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];iw(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Vh(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new Ha(Lp(this.value))}}function fU(t){const e=[];return Vh(t.fields,(r,n)=>{const s=new ls([r]);if(iw(n)){const a=fU(n.mapValue).fields;if(a.length===0)e.push(s);else for(const o of a)e.push(s.child(o))}else e.push(s)}),new $i(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,r,n,s,a,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new os(e,0,mr.min(),mr.min(),mr.min(),Ha.empty(),0)}static newFoundDocument(e,r,n,s){return new os(e,1,r,mr.min(),n,s,0)}static newNoDocument(e,r){return new os(e,2,r,mr.min(),mr.min(),Ha.empty(),0)}static newUnknownDocument(e,r){return new os(e,3,r,mr.min(),mr.min(),Ha.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ha.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ha.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof os&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new os(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,r){this.position=e,this.inclusive=r}}function EF(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],o=t.position[s];if(a.field.isKeyField()?n=Jt.comparator(Jt.fromName(o.referenceValue),r.key):n=ed(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function BF(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Nc(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e,r="asc"){this.field=e,this.dir=r}}function gW(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{}class rn extends mU{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new xW(e,r,n):r==="array-contains"?new yW(e,n):r==="in"?new yU(e,n):r==="not-in"?new bW(e,n):r==="array-contains-any"?new NW(e,n):new rn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new vW(e,n):new wW(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(ed(r,this.value)):r!==null&&_h(this.value)===_h(r)&&this.matchesComparison(ed(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ir()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Sn extends mU{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Sn(e,r)}matches(e){return R0(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function R0(t){return t.op==="and"}function S_(t){return t.op==="or"}function aS(t){return pU(t)&&R0(t)}function pU(t){for(const e of t.filters)if(e instanceof Sn)return!1;return!0}function I_(t){if(t instanceof rn)return t.field.canonicalString()+t.op.toString()+j0(t.value);if(aS(t))return t.filters.map(e=>I_(e)).join(",");{const e=t.filters.map(r=>I_(r)).join(",");return`${t.op}(${e})`}}function gU(t,e){return t instanceof rn?function(n,s){return s instanceof rn&&n.op===s.op&&n.field.isEqual(s.field)&&Nc(n.value,s.value)}(t,e):t instanceof Sn?function(n,s){return s instanceof Sn&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,o,l)=>a&&gU(o,s.filters[l]),!0):!1}(t,e):void ir()}function xU(t,e){const r=t.filters.concat(e);return Sn.create(r,t.op)}function vU(t){return t instanceof rn?function(r){return`${r.field.canonicalString()} ${r.op} ${j0(r.value)}`}(t):t instanceof Sn?function(r){return r.op.toString()+" {"+r.getFilters().map(vU).join(" ,")+"}"}(t):"Filter"}class xW extends rn{constructor(e,r,n){super(e,r,n),this.key=Jt.fromName(n.referenceValue)}matches(e){const r=Jt.comparator(e.key,this.key);return this.matchesComparison(r)}}class vW extends rn{constructor(e,r){super(e,"in",r),this.keys=wU("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class wW extends rn{constructor(e,r){super(e,"not-in",r),this.keys=wU("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function wU(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Jt.fromName(n.referenceValue))}class yW extends rn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Rg(r)&&jg(r.arrayValue,this.value)}}class yU extends rn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&jg(this.value.arrayValue,r)}}class bW extends rn{constructor(e,r){super(e,"not-in",r)}matches(e){if(jg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!jg(this.value.arrayValue,r)}}class NW extends rn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Rg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>jg(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CW{constructor(e,r=null,n=[],s=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=o,this.endAt=l,this.ue=null}}function F_(t,e=null,r=[],n=[],s=null,a=null,o=null){return new CW(t,e,r,n,s,a,o)}function Eh(t){const e=Sr(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>I_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Nx(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>j0(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>j0(n)).join(",")),e.ue=r}return e.ue}function Cx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!gW(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!gU(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!BF(t.startAt,e.startAt)&&BF(t.endAt,e.endAt)}function Jw(t){return Jt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Xw(t,e){return t.filters.filter(r=>r instanceof rn&&r.field.isEqual(e))}function SF(t,e,r){let n=aw,s=!0;for(const a of Xw(t,e)){let o=aw,l=!0;switch(a.op){case"<":case"<=":o=mW(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,l=!1;break;case"!=":case"not-in":o=aw}CF({value:n,inclusive:s},{value:o,inclusive:l})<0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];CF({value:n,inclusive:s},{value:o,inclusive:r.inclusive})<0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}function IF(t,e,r){let n=Bu,s=!0;for(const a of Xw(t,e)){let o=Bu,l=!0;switch(a.op){case">=":case">":o=pW(a.value),l=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,l=!1;break;case"!=":case"not-in":o=Bu}_F({value:n,inclusive:s},{value:o,inclusive:l})>0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];_F({value:n,inclusive:s},{value:o,inclusive:r.inclusive})>0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,r=null,n=[],s=[],a=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function _W(t,e,r,n,s,a,o,l){return new em(t,e,r,n,s,a,o,l)}function _x(t){return new em(t)}function FF(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function bU(t){return t.collectionGroup!==null}function Up(t){const e=Sr(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Pn(ls.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(A=>{A.isInequality()&&(l=l.add(A.field))})}),l})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new Dg(a,n))}),r.has(ls.keyField().canonicalString())||e.ce.push(new Dg(ls.keyField(),n))}return e.ce}function ll(t){const e=Sr(t);return e.le||(e.le=EW(e,Up(t))),e.le}function EW(t,e){if(t.limitType==="F")return F_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Dg(s.field,a)});const r=t.endAt?new P0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new P0(t.startAt.position,t.startAt.inclusive):null;return F_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function k_(t,e){const r=t.filters.concat([e]);return new em(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Yw(t,e,r){return new em(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ly(t,e){return Cx(ll(t),ll(e))&&t.limitType===e.limitType}function NU(t){return`${Eh(ll(t))}|lt:${t.limitType}`}function Uf(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>vU(s)).join(", ")}]`),Nx(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>j0(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>j0(s)).join(",")),`Target(${n})`}(ll(t))}; limitType=${t.limitType})`}function Ex(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Jt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of Up(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,c){const A=EF(o,l,c);return o.inclusive?A<=0:A<0}(n.startAt,Up(n),s)||n.endAt&&!function(o,l,c){const A=EF(o,l,c);return o.inclusive?A>=0:A>0}(n.endAt,Up(n),s))}(t,e)}function BW(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function CU(t){return(e,r)=>{let n=!1;for(const s of Up(t)){const a=SW(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function SW(t,e,r){const n=t.field.isKeyField()?Jt.comparator(e.key,r.key):function(a,o,l){const c=o.data.field(a),A=l.data.field(a);return c!==null&&A!==null?ed(c,A):ir()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ir()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Vh(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return AU(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW=new us(Jt.comparator);function Co(){return IW}const _U=new us(Jt.comparator);function dp(...t){let e=_U;for(const r of t)e=e.insert(r.key,r);return e}function EU(t){let e=_U;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function pc(){return Op()}function BU(){return Op()}function Op(){return new pd(t=>t.toString(),(t,e)=>t.isEqual(e))}const FW=new us(Jt.comparator),kW=new Pn(Jt.comparator);function Vr(...t){let e=kW;for(const r of t)e=e.add(r);return e}const TW=new Pn(jr);function jW(){return TW}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kg(e)?"-0":e}}function SU(t){return{integerValue:""+t}}function PW(t,e){return $z(e)?SU(e):iS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(){this._=void 0}}function RW(t,e,r){return t instanceof Lg?function(s,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&nS(a)&&(a=sS(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(r,e):t instanceof D0?FU(t,e):t instanceof L0?kU(t,e):function(s,a){const o=IU(s,a),l=kF(o)+kF(s.Pe);return B_(o)&&B_(s.Pe)?SU(l):iS(s.serializer,l)}(t,e)}function DW(t,e,r){return t instanceof D0?FU(t,e):t instanceof L0?kU(t,e):r}function IU(t,e){return t instanceof Ug?function(n){return B_(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Lg extends cy{}class D0 extends cy{constructor(e){super(),this.elements=e}}function FU(t,e){const r=TU(e);for(const n of t.elements)r.some(s=>Nc(s,n))||r.push(n);return{arrayValue:{values:r}}}class L0 extends cy{constructor(e){super(),this.elements=e}}function kU(t,e){let r=TU(e);for(const n of t.elements)r=r.filter(s=>!Nc(s,n));return{arrayValue:{values:r}}}class Ug extends cy{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function kF(t){return as(t.integerValue||t.doubleValue)}function TU(t){return Rg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LW{constructor(e,r){this.field=e,this.transform=r}}function UW(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof D0&&s instanceof D0||n instanceof L0&&s instanceof L0?T0(n.elements,s.elements,Nc):n instanceof Ug&&s instanceof Ug?Nc(n.Pe,s.Pe):n instanceof Lg&&s instanceof Lg}(t.transform,e.transform)}class OW{constructor(e,r){this.version=e,this.transformResults=r}}class cs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new cs}static exists(e){return new cs(void 0,e)}static updateTime(e){return new cs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ow(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ay{}function jU(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new rm(t.key,cs.none()):new tm(t.key,t.data,cs.none());{const r=t.data,n=Ha.empty();let s=new Pn(ls.comparator);for(let a of e.fields)if(!s.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),s=s.add(a)}return new kA(t.key,n,new $i(s.toArray()),cs.none())}}function MW(t,e,r){t instanceof tm?function(s,a,o){const l=s.value.clone(),c=jF(s.fieldTransforms,a,o.transformResults);l.setAll(c),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof kA?function(s,a,o){if(!ow(s.precondition,a))return void a.convertToUnknownDocument(o.version);const l=jF(s.fieldTransforms,a,o.transformResults),c=a.data;c.setAll(PU(s)),c.setAll(l),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function Mp(t,e,r,n){return t instanceof tm?function(a,o,l,c){if(!ow(a.precondition,o))return l;const A=a.value.clone(),u=PF(a.fieldTransforms,c,o);return A.setAll(u),o.convertToFoundDocument(o.version,A).setHasLocalMutations(),null}(t,e,r,n):t instanceof kA?function(a,o,l,c){if(!ow(a.precondition,o))return l;const A=PF(a.fieldTransforms,c,o),u=o.data;return u.setAll(PU(a)),u.setAll(A),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(a,o,l){return ow(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function QW(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=IU(n.transform,s||null);a!=null&&(r===null&&(r=Ha.empty()),r.set(n.field,a))}return r||null}function TF(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&T0(n,s,(a,o)=>UW(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class tm extends Ay{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class kA extends Ay{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function PU(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function jF(t,e,r){const n=new Map;dr(t.length===r.length);for(let s=0;s<r.length;s++){const a=t[s],o=a.transform,l=e.data.field(a.field);n.set(a.field,DW(o,l,r[s]))}return n}function PF(t,e,r){const n=new Map;for(const s of t){const a=s.transform,o=r.data.field(s.field);n.set(s.field,RW(a,o,e))}return n}class rm extends Ay{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oS extends Ay{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&MW(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Mp(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Mp(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=BU();return this.mutations.forEach(s=>{const a=e.get(s.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=r.has(s.key)?null:l;const c=jU(o,l);c!==null&&n.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(mr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Vr())}isEqual(e){return this.batchId===e.batchId&&T0(this.mutations,e.mutations,(r,n)=>TF(r,n))&&T0(this.baseMutations,e.baseMutations,(r,n)=>TF(r,n))}}class cS{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){dr(e.mutations.length===n.length);let s=function(){return FW}();const a=e.mutations;for(let o=0;o<a.length;o++)s=s.insert(a[o].key,n[o].version);return new cS(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VW{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $s,on;function RU(t){switch(t){default:return ir();case Et.CANCELLED:case Et.UNKNOWN:case Et.DEADLINE_EXCEEDED:case Et.RESOURCE_EXHAUSTED:case Et.INTERNAL:case Et.UNAVAILABLE:case Et.UNAUTHENTICATED:return!1;case Et.INVALID_ARGUMENT:case Et.NOT_FOUND:case Et.ALREADY_EXISTS:case Et.PERMISSION_DENIED:case Et.FAILED_PRECONDITION:case Et.ABORTED:case Et.OUT_OF_RANGE:case Et.UNIMPLEMENTED:case Et.DATA_LOSS:return!0}}function DU(t){if(t===void 0)return Ii("GRPC error has no .code"),Et.UNKNOWN;switch(t){case $s.OK:return Et.OK;case $s.CANCELLED:return Et.CANCELLED;case $s.UNKNOWN:return Et.UNKNOWN;case $s.DEADLINE_EXCEEDED:return Et.DEADLINE_EXCEEDED;case $s.RESOURCE_EXHAUSTED:return Et.RESOURCE_EXHAUSTED;case $s.INTERNAL:return Et.INTERNAL;case $s.UNAVAILABLE:return Et.UNAVAILABLE;case $s.UNAUTHENTICATED:return Et.UNAUTHENTICATED;case $s.INVALID_ARGUMENT:return Et.INVALID_ARGUMENT;case $s.NOT_FOUND:return Et.NOT_FOUND;case $s.ALREADY_EXISTS:return Et.ALREADY_EXISTS;case $s.PERMISSION_DENIED:return Et.PERMISSION_DENIED;case $s.FAILED_PRECONDITION:return Et.FAILED_PRECONDITION;case $s.ABORTED:return Et.ABORTED;case $s.OUT_OF_RANGE:return Et.OUT_OF_RANGE;case $s.UNIMPLEMENTED:return Et.UNIMPLEMENTED;case $s.DATA_LOSS:return Et.DATA_LOSS;default:return ir()}}(on=$s||($s={}))[on.OK=0]="OK",on[on.CANCELLED=1]="CANCELLED",on[on.UNKNOWN=2]="UNKNOWN",on[on.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",on[on.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",on[on.NOT_FOUND=5]="NOT_FOUND",on[on.ALREADY_EXISTS=6]="ALREADY_EXISTS",on[on.PERMISSION_DENIED=7]="PERMISSION_DENIED",on[on.UNAUTHENTICATED=16]="UNAUTHENTICATED",on[on.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",on[on.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",on[on.ABORTED=10]="ABORTED",on[on.OUT_OF_RANGE=11]="OUT_OF_RANGE",on[on.UNIMPLEMENTED=12]="UNIMPLEMENTED",on[on.INTERNAL=13]="INTERNAL",on[on.UNAVAILABLE=14]="UNAVAILABLE",on[on.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HW(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KW=new sh([4294967295,4294967295],0);function RF(t){const e=HW().encode(t),r=new $L;return r.update(e),new Uint8Array(r.digest())}function DF(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new sh([r,n],0),new sh([s,a],0)]}class uS{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new hp(`Invalid padding: ${r}`);if(n<0)throw new hp(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new hp(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new hp(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=sh.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(sh.fromNumber(n)));return s.compare(KW)===1&&(s=new sh([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=RF(e),[n,s]=DF(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,s,a);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new uS(a,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=RF(e),[n,s]=DF(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,s,a);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class hp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Bx.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new uy(mr.min(),s,new us(jr),Co(),Vr())}}class Bx{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Bx(n,r,Vr(),Vr(),Vr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class LU{constructor(e,r){this.targetId=e,this.me=r}}class UU{constructor(e,r,n=Ks.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class LF{constructor(){this.fe=0,this.ge=OF(),this.pe=Ks.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Vr(),r=Vr(),n=Vr();return this.ge.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:ir()}}),new Bx(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=OF()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,dr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class qW{constructor(e){this.Le=e,this.Be=new Map,this.ke=Co(),this.qe=UF(),this.Qe=new us(jr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ir()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const a=s.target;if(Jw(a))if(n===0){const o=new Jt(a.path);this.Ue(r,o,os.newNoDocument(o,mr.min()))}else dr(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const A=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,A)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let o,l;try{o=Yu(n).toUint8Array()}catch(c){if(c instanceof uU)return Xu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new uS(o,s,a)}catch(c){return Xu(c instanceof hp?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,a,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((a,o)=>{const l=this.Je(o);if(l){if(a.current&&Jw(l.target)){const c=new Jt(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,os.newNoDocument(c,e))}a.be&&(r.set(o,a.ve()),a.Ce())}});let n=Vr();this.qe.forEach((a,o)=>{let l=!0;o.forEachWhile(c=>{const A=this.Je(c);return!A||A.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const s=new uy(e,r,this.Qe,this.ke,n);return this.ke=Co(),this.qe=UF(),this.Qe=new us(jr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new LF,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Pn(jr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Mt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new LF),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function UF(){return new us(Jt.comparator)}function OF(){return new us(Jt.comparator)}const GW={asc:"ASCENDING",desc:"DESCENDING"},$W={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zW={and:"AND",or:"OR"};class WW{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function T_(t,e){return t.useProto3Json||Nx(e)?e:{value:e}}function U0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function OU(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function JW(t,e){return U0(t,e.toTimestamp())}function Ea(t){return dr(!!t),mr.fromTimestamp(function(r){const n=EA(r);return new Vt(n.seconds,n.nanos)}(t))}function dS(t,e){return j_(t,e).canonicalString()}function j_(t,e){const r=function(s){return new fn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function MU(t){const e=fn.fromString(t);return dr(WU(e)),e}function Og(t,e){return dS(t.databaseId,e.path)}function dA(t,e){const r=MU(e);if(r.get(1)!==t.databaseId.projectId)throw new Gt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Gt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Jt(HU(r))}function QU(t,e){return dS(t.databaseId,e)}function VU(t){const e=MU(t);return e.length===4?fn.emptyPath():HU(e)}function P_(t){return new fn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function HU(t){return dr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function MF(t,e,r){return{name:Og(t,e),fields:r.value.mapValue.fields}}function XW(t,e,r){const n=dA(t,e.name),s=Ea(e.updateTime),a=e.createTime?Ea(e.createTime):mr.min(),o=new Ha({mapValue:{fields:e.fields}}),l=os.newFoundDocument(n,s,a,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function YW(t,e){return"found"in e?function(n,s){dr(!!s.found),s.found.name,s.found.updateTime;const a=dA(n,s.found.name),o=Ea(s.found.updateTime),l=s.found.createTime?Ea(s.found.createTime):mr.min(),c=new Ha({mapValue:{fields:s.found.fields}});return os.newFoundDocument(a,o,l,c)}(t,e):"missing"in e?function(n,s){dr(!!s.missing),dr(!!s.readTime);const a=dA(n,s.missing),o=Ea(s.readTime);return os.newNoDocument(a,o)}(t,e):ir()}function ZW(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(A){return A==="NO_CHANGE"?0:A==="ADD"?1:A==="REMOVE"?2:A==="CURRENT"?3:A==="RESET"?4:ir()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(A,u){return A.useProto3Json?(dr(u===void 0||typeof u=="string"),Ks.fromBase64String(u||"")):(dr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Ks.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(A){const u=A.code===void 0?Et.UNKNOWN:DU(A.code);return new Gt(u,A.message||"")}(o);r=new UU(n,s,a,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=dA(t,n.document.name),a=Ea(n.document.updateTime),o=n.document.createTime?Ea(n.document.createTime):mr.min(),l=new Ha({mapValue:{fields:n.document.fields}}),c=os.newFoundDocument(s,a,o,l),A=n.targetIds||[],u=n.removedTargetIds||[];r=new lw(A,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=dA(t,n.document),a=n.readTime?Ea(n.readTime):mr.min(),o=os.newNoDocument(s,a),l=n.removedTargetIds||[];r=new lw([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=dA(t,n.document),a=n.removedTargetIds||[];r=new lw([],a,s,null)}else{if(!("filter"in e))return ir();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,o=new VW(s,a),l=n.targetId;r=new LU(l,o)}}return r}function Mg(t,e){let r;if(e instanceof tm)r={update:MF(t,e.key,e.value)};else if(e instanceof rm)r={delete:Og(t,e.key)};else if(e instanceof kA)r={update:MF(t,e.key,e.data),updateMask:aJ(e.fieldMask)};else{if(!(e instanceof oS))return ir();r={verify:Og(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const l=o.transform;if(l instanceof Lg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof D0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof L0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ug)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ir()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:JW(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ir()}(t,e.precondition)),r}function R_(t,e){const r=e.currentDocument?function(a){return a.updateTime!==void 0?cs.updateTime(Ea(a.updateTime)):a.exists!==void 0?cs.exists(a.exists):cs.none()}(e.currentDocument):cs.none(),n=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)dr(l.setToServerValue==="REQUEST_TIME"),c=new Lg;else if("appendMissingElements"in l){const u=l.appendMissingElements.values||[];c=new D0(u)}else if("removeAllFromArray"in l){const u=l.removeAllFromArray.values||[];c=new L0(u)}else"increment"in l?c=new Ug(o,l.increment):ir();const A=ls.fromServerFormat(l.fieldPath);return new LW(A,c)}(t,s)):[];if(e.update){e.update.name;const s=dA(t,e.update.name),a=new Ha({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const A=c.fieldPaths||[];return new $i(A.map(u=>ls.fromServerFormat(u)))}(e.updateMask);return new kA(s,a,o,r,n)}return new tm(s,a,r,n)}if(e.delete){const s=dA(t,e.delete);return new rm(s,r)}if(e.verify){const s=dA(t,e.verify);return new oS(s,r)}return ir()}function eJ(t,e){return t&&t.length>0?(dr(e!==void 0),t.map(r=>function(s,a){let o=s.updateTime?Ea(s.updateTime):Ea(a);return o.isEqual(mr.min())&&(o=Ea(a)),new OW(o,s.transformResults||[])}(r,e))):[]}function KU(t,e){return{documents:[QU(t,e.path)]}}function qU(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=QU(t,s);const a=function(A){if(A.length!==0)return zU(Sn.create(A,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(A){if(A.length!==0)return A.map(u=>function(f){return{field:Of(f.field),direction:rJ(f.dir)}}(u))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=T_(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(A){return{before:A.inclusive,values:A.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(A){return{before:!A.inclusive,values:A.position}}(e.endAt)),{_t:r,parent:s}}function GU(t){let e=VU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){dr(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(d){const f=$U(d);return f instanceof Sn&&aS(f)?f.getFilters():[f]}(r.where));let o=[];r.orderBy&&(o=function(d){return d.map(f=>function(m){return new Dg(Mf(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(r.orderBy));let l=null;r.limit&&(l=function(d){let f;return f=typeof d=="object"?d.value:d,Nx(f)?null:f}(r.limit));let c=null;r.startAt&&(c=function(d){const f=!!d.before,h=d.values||[];return new P0(h,f)}(r.startAt));let A=null;return r.endAt&&(A=function(d){const f=!d.before,h=d.values||[];return new P0(h,f)}(r.endAt)),_W(e,s,o,a,l,"F",c,A)}function tJ(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ir()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function $U(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Mf(r.unaryFilter.field);return rn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Mf(r.unaryFilter.field);return rn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Mf(r.unaryFilter.field);return rn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mf(r.unaryFilter.field);return rn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ir()}}(t):t.fieldFilter!==void 0?function(r){return rn.create(Mf(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ir()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Sn.create(r.compositeFilter.filters.map(n=>$U(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ir()}}(r.compositeFilter.op))}(t):ir()}function rJ(t){return GW[t]}function nJ(t){return $W[t]}function sJ(t){return zW[t]}function Of(t){return{fieldPath:t.canonicalString()}}function Mf(t){return ls.fromServerFormat(t.fieldPath)}function zU(t){return t instanceof rn?function(r){if(r.op==="=="){if(NF(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NAN"}};if(bF(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(NF(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NOT_NAN"}};if(bF(r.value))return{unaryFilter:{field:Of(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Of(r.field),op:nJ(r.op),value:r.value}}}(t):t instanceof Sn?function(r){const n=r.getFilters().map(s=>zU(s));return n.length===1?n[0]:{compositeFilter:{op:sJ(r.op),filters:n}}}(t):ir()}function aJ(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function WU(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,r,n,s,a=mr.min(),o=mr.min(),l=Ks.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new oA(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new oA(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new oA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new oA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e){this.ct=e}}function iJ(t,e){let r;if(e.document)r=XW(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Jt.fromSegments(e.noDocument.path),s=Sh(e.noDocument.readTime);r=os.newNoDocument(n,s),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return ir();{const n=Jt.fromSegments(e.unknownDocument.path),s=Sh(e.unknownDocument.version);r=os.newUnknownDocument(n,s)}}return e.readTime&&r.setReadTime(function(s){const a=new Vt(s[0],s[1]);return mr.fromTimestamp(a)}(e.readTime)),r}function QF(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:Zw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,o){return{name:Og(a,o.key),fields:o.data.value.mapValue.fields,updateTime:U0(a,o.version.toTimestamp()),createTime:U0(a,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:Bh(e.version)};else{if(!e.isUnknownDocument())return ir();n.unknownDocument={path:r.path.toArray(),version:Bh(e.version)}}return n}function Zw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Bh(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sh(t){const e=new Vt(t.seconds,t.nanoseconds);return mr.fromTimestamp(e)}function Kd(t,e){const r=(e.baseMutations||[]).map(a=>R_(t.ct,a));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const l=e.mutations[a+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>R_(t.ct,a)),s=Vt.fromMillis(e.localWriteTimeMs);return new lS(e.batchId,s,r,n)}function fp(t){const e=Sh(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?Sh(t.lastLimboFreeSnapshotVersion):mr.min();let n;return n=function(a){return a.documents!==void 0}(t.query)?function(a){return dr(a.documents.length===1),ll(_x(VU(a.documents[0])))}(t.query):function(a){return ll(GU(a))}(t.query),new oA(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Ks.fromBase64String(t.resumeToken))}function XU(t,e){const r=Bh(e.snapshotVersion),n=Bh(e.lastLimboFreeSnapshotVersion);let s;s=Jw(e.target)?KU(t.ct,e.target):qU(t.ct,e.target)._t;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Eh(e.target),readTime:r,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:s}}function YU(t){const e=GU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Yw(e,e.limit,"L"):e}function Yb(t,e){return new AS(e.largestBatchId,R_(t.ct,e.overlayMutation))}function VF(t,e){const r=e.path.lastSegment();return[t,ki(e.path.popLast()),r]}function HF(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:Bh(n.readTime),documentKey:ki(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oJ{getBundleMetadata(e,r){return KF(e).get(r).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:Sh(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,r){return KF(e).put(function(s){return{bundleId:s.id,createTime:Bh(Ea(s.createTime)),version:s.version}}(r))}getNamedQuery(e,r){return qF(e).get(r).next(n=>{if(n)return function(a){return{name:a.name,query:YU(a.bundledQuery),readTime:Sh(a.readTime)}}(n)})}saveNamedQuery(e,r){return qF(e).put(function(s){return{name:s.name,readTime:Bh(Ea(s.readTime)),bundledQuery:s.bundledQuery}}(r))}}function KF(t){return ha(t,"bundles")}function qF(t){return ha(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new dy(e,n)}getOverlay(e,r){return Qm(e).get(VF(this.userId,r)).next(n=>n?Yb(this.serializer,n):null)}getOverlays(e,r){const n=pc();return mt.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){const s=[];return n.forEach((a,o)=>{const l=new AS(r,o);s.push(this.ht(e,l))}),mt.waitFor(s)}removeOverlaysForBatchId(e,r,n){const s=new Set;r.forEach(o=>s.add(ki(o.getCollectionPath())));const a=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);a.push(Qm(e).j("collectionPathOverlayIndex",l))}),mt.waitFor(a)}getOverlaysForCollection(e,r,n){const s=pc(),a=ki(r),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Qm(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const A=Yb(this.serializer,c);s.set(A.getKey(),A)}return s})}getOverlaysForCollectionGroup(e,r,n,s){const a=pc();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return Qm(e).J({index:"collectionGroupOverlayIndex",range:l},(c,A,u)=>{const d=Yb(this.serializer,A);a.size()<s||d.largestBatchId===o?(a.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>a)}ht(e,r){return Qm(e).put(function(s,a,o){const[l,c,A]=VF(a,o.mutation.key);return{userId:a,collectionPath:c,documentId:A,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Mg(s.ct,o.mutation)}}(this.serializer,this.userId,r))}}function Qm(t){return ha(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lJ{Pt(e){return ha(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Ks.fromUint8Array(n):Ks.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(as(e.integerValue));else if("doubleValue"in e){const n=as(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),kg(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=EA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(Yu(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?dU(e)?this.dt(r,Number.MAX_SAFE_INTEGER):oy(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):ir()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const s of Object.keys(n))this.Vt(s,r),this.Tt(n[s],r)}wt(e,r){var n,s;const a=e.fields||{};this.dt(r,53);const o="value",l=((s=(n=a[o].arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.length)||0;this.dt(r,15),r.At(as(l)),this.Vt(o,r),this.Tt(a[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const s of n)this.Tt(s,r)}yt(e,r){this.dt(r,37),Jt.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}qd.vt=new qd;function cJ(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function GF(t){const e=64-function(n){let s=0;for(let a=0;a<8;++a){const o=cJ(255&n[a]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class AJ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const s=r.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const s=r.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const r=this.qt(e),n=GF(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=255&r[s]}Kt(e){const r=this.qt(e),n=GF(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=~(255&r[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let s=1;s<r.length;++s)r[s]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const s=new Uint8Array(n);s.set(this.buffer),this.buffer=s}}class uJ{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class dJ{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Vm{constructor(){this.jt=new AJ,this.Ht=new uJ(this.jt),this.Jt=new dJ(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,r,n,s){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=s}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Gd(this.indexId,this.documentKey,this.arrayValue,n)}}function ru(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=$F(t.arrayValue,e.arrayValue),r!==0?r:(r=$F(t.directionalValue,e.directionalValue),r!==0?r:Jt.comparator(t.documentKey,e.documentKey)))}function $F(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.Xt=new Pn((r,n)=>ls.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(dr(e.collectionGroup===this.collectionId),this.nn)return!1;const r=C_(e);if(r!==void 0&&!this.sn(r))return!1;const n=Md(e);let s=new Set,a=0,o=0;for(;a<n.length&&this.sn(n[a]);++a)s=s.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=n[a];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++a}for(;a<n.length;++a){const l=n[a];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Pn(ls.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new nw(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new nw(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new nw(n.field,n.dir==="asc"?0:1)));return new Ww(Ww.UNKNOWN_ID,this.collectionId,r,Fg.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZU(t){var e,r;if(dr(t instanceof rn||t instanceof Sn),t instanceof rn){if(t instanceof yU){const s=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(a=>rn.create(t.field,"==",a)))||[];return Sn.create(s,"or")}return t}const n=t.filters.map(s=>ZU(s));return Sn.create(n,t.op)}function hJ(t){if(t.getFilters().length===0)return[];const e=U_(ZU(t));return dr(e6(e)),D_(e)||L_(e)?[e]:e.getFilters()}function D_(t){return t instanceof rn}function L_(t){return t instanceof Sn&&aS(t)}function e6(t){return D_(t)||L_(t)||function(r){if(r instanceof Sn&&S_(r)){for(const n of r.getFilters())if(!D_(n)&&!L_(n))return!1;return!0}return!1}(t)}function U_(t){if(dr(t instanceof rn||t instanceof Sn),t instanceof rn)return t;if(t.filters.length===1)return U_(t.filters[0]);const e=t.filters.map(n=>U_(n));let r=Sn.create(e,t.op);return r=e2(r),e6(r)?r:(dr(r instanceof Sn),dr(R0(r)),dr(r.filters.length>1),r.filters.reduce((n,s)=>hS(n,s)))}function hS(t,e){let r;return dr(t instanceof rn||t instanceof Sn),dr(e instanceof rn||e instanceof Sn),r=t instanceof rn?e instanceof rn?function(s,a){return Sn.create([s,a],"and")}(t,e):WF(t,e):e instanceof rn?WF(e,t):function(s,a){if(dr(s.filters.length>0&&a.filters.length>0),R0(s)&&R0(a))return xU(s,a.getFilters());const o=S_(s)?s:a,l=S_(s)?a:s,c=o.filters.map(A=>hS(A,l));return Sn.create(c,"or")}(t,e),e2(r)}function WF(t,e){if(R0(e))return xU(e,t.getFilters());{const r=e.filters.map(n=>hS(t,n));return Sn.create(r,"or")}}function e2(t){if(dr(t instanceof rn||t instanceof Sn),t instanceof rn)return t;const e=t.getFilters();if(e.length===1)return e2(e[0]);if(pU(t))return t;const r=e.map(s=>e2(s)),n=[];return r.forEach(s=>{s instanceof rn?n.push(s):s instanceof Sn&&(s.op===t.op?n.push(...s.filters):n.push(s))}),n.length===1?n[0]:Sn.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fJ{constructor(){this.un=new fS}addToCollectionParentIndex(e,r){return this.un.add(r),mt.resolve()}getCollectionParents(e,r){return mt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return mt.resolve()}deleteFieldIndex(e,r){return mt.resolve()}deleteAllFieldIndexes(e){return mt.resolve()}createTargetIndexes(e,r){return mt.resolve()}getDocumentsMatchingTarget(e,r){return mt.resolve(null)}getIndexType(e,r){return mt.resolve(0)}getFieldIndexes(e,r){return mt.resolve([])}getNextCollectionGroupToUpdate(e){return mt.resolve(null)}getMinOffset(e,r){return mt.resolve(So.min())}getMinOffsetFromCollectionGroup(e,r){return mt.resolve(So.min())}updateCollectionGroup(e,r,n){return mt.resolve()}updateIndexEntries(e,r){return mt.resolve()}}class fS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Pn(fn.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Pn(fn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=new Uint8Array(0);class mJ{constructor(e,r){this.databaseId=r,this.cn=new fS,this.ln=new pd(n=>Eh(n),(n,s)=>Cx(n,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),s=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const a={collectionId:n,parent:ki(s)};return JF(e).put(a)}return mt.resolve()}getCollectionParents(e,r){const n=[],s=IDBKeyRange.bound([r,""],[tU(r),""],!1,!0);return JF(e).U(s).next(a=>{for(const o of a){if(o.collectionId!==r)break;n.push(mc(o.parent))}return n})}addFieldIndex(e,r){const n=Hm(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete s.indexId;const a=n.add(s);if(r.indexState){const o=gf(e);return a.next(l=>{o.put(HF(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return a.next()}deleteFieldIndex(e,r){const n=Hm(e),s=gf(e),a=pf(e);return n.delete(r.indexId).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=Hm(e),n=pf(e),s=gf(e);return r.j().next(()=>n.j()).next(()=>s.j())}createTargetIndexes(e,r){return mt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(s=>{if(s===0||s===1){const a=new zF(n).an();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,r){const n=pf(e);let s=!0;const a=new Map;return mt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{s&&(s=!!l),a.set(o,l)})).next(()=>{if(s){let o=Vr();const l=[];return mt.forEach(a,(c,A)=>{Mt("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`}(c)} to execute ${Eh(r)}`);const u=function(b,F){const j=C_(F);if(j===void 0)return null;for(const R of Xw(b,j.fieldPath))switch(R.op){case"array-contains-any":return R.value.arrayValue.values||[];case"array-contains":return[R.value]}return null}(A,c),d=function(b,F){const j=new Map;for(const R of Md(F))for(const E of Xw(b,R.fieldPath))switch(E.op){case"==":case"in":j.set(R.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return j.set(R.fieldPath.canonicalString(),E.value),Array.from(j.values())}return null}(A,c),f=function(b,F){const j=[];let R=!0;for(const E of Md(F)){const S=E.kind===0?SF(b,E.fieldPath,b.startAt):IF(b,E.fieldPath,b.startAt);j.push(S.value),R&&(R=S.inclusive)}return new P0(j,R)}(A,c),h=function(b,F){const j=[];let R=!0;for(const E of Md(F)){const S=E.kind===0?IF(b,E.fieldPath,b.endAt):SF(b,E.fieldPath,b.endAt);j.push(S.value),R&&(R=S.inclusive)}return new P0(j,R)}(A,c),m=this.In(c,A,f),p=this.In(c,A,h),x=this.Tn(c,A,d),g=this.En(c.indexId,u,m,f.inclusive,p,h.inclusive,x);return mt.forEach(g,y=>n.G(y,r.limit).next(b=>{b.forEach(F=>{const j=Jt.fromSegments(F.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return mt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=hJ(Sn.create(e.filters,"and")).map(n=>F_(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,s,a,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,a.length),A=c/(r!=null?r.length:1),u=[];for(let d=0;d<c;++d){const f=r?this.dn(r[d/A]):I1,h=this.An(e,f,n[d%A],s),m=this.Rn(e,f,a[d%A],o),p=l.map(x=>this.An(e,f,x,!0));u.push(...this.createRange(h,m,p))}return u}An(e,r,n,s){const a=new Gd(e,Jt.empty(),r,n);return s?a:a.Zt()}Rn(e,r,n,s){const a=new Gd(e,Jt.empty(),r,n);return s?a.Zt():a}Pn(e,r){const n=new zF(r),s=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,s).next(a=>{let o=null;for(const l of a)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const s=this.hn(r);return mt.forEach(s,a=>this.Pn(e,a).next(o=>{o?n!==0&&o.fields.length<function(c){let A=new Pn(ls.comparator),u=!1;for(const d of c.filters)for(const f of d.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:A=A.add(f.field));for(const d of c.orderBy)d.field.isKeyField()||(A=A.add(d.field));return A.size+(u?1:0)}(a)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&s.length>1&&n===2?1:n)}Vn(e,r){const n=new Vm;for(const s of Md(e)){const a=r.data.field(s.fieldPath);if(a==null)return null;const o=n.Yt(s.kind);qd.vt.It(a,o)}return n.zt()}dn(e){const r=new Vm;return qd.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new Vm;return qd.vt.It(Pg(this.databaseId,r),n.Yt(function(a){const o=Md(a);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let s=[];s.push(new Vm);let a=0;for(const o of Md(e)){const l=n[a++];for(const c of s)if(this.fn(r,o.fieldPath)&&Rg(l))s=this.gn(s,o,l);else{const A=c.Yt(o.kind);qd.vt.It(l,A)}}return this.pn(s)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const s=[...e],a=[];for(const o of n.arrayValue.values||[])for(const l of s){const c=new Vm;c.seed(l.zt()),qd.vt.It(o,c.Yt(r.kind)),a.push(c)}return a}fn(e,r){return!!e.filters.find(n=>n instanceof rn&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=Hm(e),s=gf(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(a=>{const o=[];return mt.forEach(a,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(u,d){const f=d?new Fg(d.sequenceNumber,new So(Sh(d.readTime),new Jt(mc(d.documentKey)),d.largestBatchId)):Fg.empty(),h=u.fields.map(([m,p])=>new nw(ls.fromServerFormat(m),p));return new Ww(u.indexId,u.collectionGroup,h,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,s)=>{const a=n.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:jr(n.collectionGroup,s.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const s=Hm(e),a=gf(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>mt.forEach(l,c=>a.put(HF(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return mt.forEach(r,(s,a)=>{const o=n.get(s.collectionGroup);return(o?mt.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(n.set(s.collectionGroup,l),mt.forEach(l,c=>this.wn(e,s,c).next(A=>{const u=this.Sn(a,c);return A.isEqual(u)?mt.resolve():this.bn(e,a,c,A,u)}))))})}Dn(e,r,n,s){return pf(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,s){return pf(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const s=pf(e);let a=new Pn(ru);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{a=a.add(new Gd(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>a)}Sn(e,r){let n=new Pn(ru);const s=this.Vn(r,e);if(s==null)return n;const a=C_(r);if(a!=null){const o=e.data.field(a.fieldPath);if(Rg(o))for(const l of o.arrayValue.values||[])n=n.add(new Gd(r.indexId,e.key,this.dn(l),s))}else n=n.add(new Gd(r.indexId,e.key,I1,s));return n}bn(e,r,n,s,a){Mt("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,A,u,d,f){const h=c.getIterator(),m=A.getIterator();let p=mf(h),x=mf(m);for(;p||x;){let g=!1,y=!1;if(p&&x){const b=u(p,x);b<0?y=!0:b>0&&(g=!0)}else p!=null?y=!0:g=!0;g?(d(x),x=mf(m)):y?(f(p),p=mf(h)):(p=mf(h),x=mf(m))}}(s,a,ru,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),mt.waitFor(o)}yn(e){let r=1;return gf(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,s,a)=>{a.done(),r=s.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>ru(o,l)).filter((o,l,c)=>!l||ru(o,c[l-1])!==0);const s=[];s.push(e);for(const o of n){const l=ru(o,e),c=ru(o,r);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(r);const a=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const l=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,I1,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,I1,[]];a.push(IDBKeyRange.bound(l,c))}return a}Cn(e,r){return ru(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(XF)}getMinOffset(e,r){return mt.mapArray(this.hn(r),n=>this.Pn(e,n).next(s=>s||ir())).next(XF)}}function JF(t){return ha(t,"collectionParents")}function pf(t){return ha(t,"indexEntries")}function Hm(t){return ha(t,"indexConfiguration")}function gf(t){return ha(t,"indexState")}function XF(t){dr(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const s=t[n].indexState.offset;eS(s,e)<0&&(e=s),r<s.largestBatchId&&(r=s.largestBatchId)}return new So(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Hi{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Hi(e,Hi.DEFAULT_COLLECTION_PERCENTILE,Hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(t,e,r){const n=t.store("mutations"),s=t.store("documentMutations"),a=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(u,d,f)=>(l++,f.delete()));a.push(c.next(()=>{dr(l===1)}));const A=[];for(const u of r.mutations){const d=iU(e,u.key.path,r.batchId);a.push(s.delete(d)),A.push(u.key)}return mt.waitFor(a).next(()=>A)}function t2(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ir();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hi.DEFAULT_COLLECTION_PERCENTILE=10,Hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Hi.DEFAULT=new Hi(41943040,Hi.DEFAULT_COLLECTION_PERCENTILE,Hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Hi.DISABLED=new Hi(-1,0,0);class hy{constructor(e,r,n,s){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=s,this.Fn={}}static lt(e,r,n,s){dr(e.uid!=="");const a=e.isAuthenticated()?e.uid:"";return new hy(a,r,n,s)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return nu(e).J({index:"userMutationsIndex",range:n},(s,a,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,s){const a=Qf(e),o=nu(e);return o.add({}).next(l=>{dr(typeof l=="number");const c=new lS(l,r,n,s),A=function(h,m,p){const x=p.baseMutations.map(y=>Mg(h.ct,y)),g=p.mutations.map(y=>Mg(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:g}}(this.serializer,this.userId,c),u=[];let d=new Pn((f,h)=>jr(f.canonicalString(),h.canonicalString()));for(const f of s){const h=iU(this.userId,f.key.path,l);d=d.add(f.key.path.popLast()),u.push(o.put(A)),u.push(a.put(h,Wz))}return d.forEach(f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),mt.waitFor(u).next(()=>c)})}lookupMutationBatch(e,r){return nu(e).get(r).next(n=>n?(dr(n.userId===this.userId),Kd(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?mt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const s=n.keys();return this.Fn[r]=s,s}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return nu(e).J({index:"userMutationsIndex",range:s},(o,l,c)=>{l.userId===this.userId&&(dr(l.batchId>=n),a=Kd(this.serializer,l)),c.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return nu(e).J({index:"userMutationsIndex",range:r,reverse:!0},(s,a,o)=>{n=a.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return nu(e).U("userMutationsIndex",r).next(n=>n.map(s=>Kd(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=sw(this.userId,r.path),s=IDBKeyRange.lowerBound(n),a=[];return Qf(e).J({range:s},(o,l,c)=>{const[A,u,d]=o,f=mc(u);if(A===this.userId&&r.path.isEqual(f))return nu(e).get(d).next(h=>{if(!h)throw ir();dr(h.userId===this.userId),a.push(Kd(this.serializer,h))});c.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pn(jr);const s=[];return r.forEach(a=>{const o=sw(this.userId,a.path),l=IDBKeyRange.lowerBound(o),c=Qf(e).J({range:l},(A,u,d)=>{const[f,h,m]=A,p=mc(h);f===this.userId&&a.path.isEqual(p)?n=n.add(m):d.done()});s.push(c)}),mt.waitFor(s).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1,a=sw(this.userId,n),o=IDBKeyRange.lowerBound(a);let l=new Pn(jr);return Qf(e).J({range:o},(c,A,u)=>{const[d,f,h]=c,m=mc(f);d===this.userId&&n.isPrefixOf(m)?m.length===s&&(l=l.add(h)):u.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],s=[];return r.forEach(a=>{s.push(nu(e).get(a).next(o=>{if(o===null)throw ir();dr(o.userId===this.userId),n.push(Kd(this.serializer,o))}))}),mt.waitFor(s).next(()=>n)}removeMutationBatch(e,r){return t6(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),mt.forEach(n,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return mt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Qf(e).J({range:n},(a,o,l)=>{if(a[0]===this.userId){const c=mc(a[1]);s.push(c)}else l.done()}).next(()=>{dr(s.length===0)})})}containsKey(e,r){return r6(e,this.userId,r)}Nn(e){return n6(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function r6(t,e,r){const n=sw(e,r.path),s=n[1],a=IDBKeyRange.lowerBound(n);let o=!1;return Qf(t).J({range:a,H:!0},(l,c,A)=>{const[u,d,f]=l;u===e&&d===s&&(o=!0),A.done()}).next(()=>o)}function nu(t){return ha(t,"mutations")}function Qf(t){return ha(t,"documentMutations")}function n6(t){return ha(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ih(0)}static kn(){return new Ih(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pJ{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new Ih(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>mr.fromTimestamp(new Vt(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(s=>(s.highestListenSequenceNumber=r,n&&(s.lastRemoteSnapshotVersion=n.toTimestamp()),r>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=r),this.Qn(e,s)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>xf(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(dr(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let s=0;const a=[];return xf(e).J((o,l)=>{const c=fp(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(s++,a.push(this.removeTargetData(e,c)))}).next(()=>mt.waitFor(a)).next(()=>s)}forEachTarget(e,r){return xf(e).J((n,s)=>{const a=fp(s);r(a)})}qn(e){return ZF(e).get("targetGlobalKey").next(r=>(dr(r!==null),r))}Qn(e,r){return ZF(e).put("targetGlobalKey",r)}Kn(e,r){return xf(e).put(XU(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=Eh(r),s=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return xf(e).J({range:s,index:"queryTargetsIndex"},(o,l,c)=>{const A=fp(l);Cx(r,A.target)&&(a=A,c.done())}).next(()=>a)}addMatchingKeys(e,r,n){const s=[],a=bu(e);return r.forEach(o=>{const l=ki(o.path);s.push(a.put({targetId:n,path:l})),s.push(this.referenceDelegate.addReference(e,n,o))}),mt.waitFor(s)}removeMatchingKeys(e,r,n){const s=bu(e);return mt.forEach(r,a=>{const o=ki(a.path);return mt.waitFor([s.delete([n,o]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,r){const n=bu(e),s=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(s)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),s=bu(e);let a=Vr();return s.J({range:n,H:!0},(o,l,c)=>{const A=mc(o[1]),u=new Jt(A);a=a.add(u)}).next(()=>a)}containsKey(e,r){const n=ki(r.path),s=IDBKeyRange.bound([n],[tU(n)],!1,!0);let a=0;return bu(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,l],c,A)=>{o!==0&&(a++,A.done())}).next(()=>a>0)}ot(e,r){return xf(e).get(r).next(n=>n?fp(n):null)}}function xf(t){return ha(t,"targets")}function ZF(t){return ha(t,"targetGlobal")}function bu(t){return ha(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ek([t,e],[r,n]){const s=jr(t,r);return s===0?jr(e,n):s}class gJ{constructor(e){this.Un=e,this.buffer=new Pn(ek),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ek(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class xJ{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Mt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){md(r)?Mt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Qh(r)}await this.Hn(3e5)})}}class vJ{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return mt.resolve(sl.oe);const n=new gJ(r);return this.Jn.forEachTarget(e,s=>n.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>n.zn(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Mt("LruGarbageCollector","Garbage collection skipped; disabled"),mt.resolve(YF)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Mt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YF):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,s,a,o,l,c,A;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(Mt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(e,s))).next(d=>(n=d,l=Date.now(),this.removeTargets(e,n,r))).next(d=>(a=d,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(A=Date.now(),Lf()<=tn.DEBUG&&Mt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${a} targets in `+(c-l)+`ms
	Removed ${d} documents in `+(A-c)+`ms
Total Duration: ${A-u}ms`),mt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:d})))}}function wJ(t,e){return new vJ(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yJ{constructor(e,r){this.db=e,this.garbageCollector=wJ(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,s)=>r(s))}addReference(e,r,n){return F1(e,n)}removeReference(e,r,n){return F1(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return F1(e,r)}nr(e,r){return function(s,a){let o=!1;return n6(s).Y(l=>r6(s,l,a).next(c=>(c&&(o=!0),mt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(A=>{if(!A)return a++,n.getEntry(e,o).next(()=>(n.removeEntry(o,mr.min()),bu(e).delete(function(d){return[0,ki(d.path)]}(o))))});s.push(c)}}).next(()=>mt.waitFor(s)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return F1(e,r)}tr(e,r){const n=bu(e);let s,a=sl.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:A})=>{o===0?(a!==sl.oe&&r(new Jt(mc(s)),a),a=A,s=c):a=sl.oe}).next(()=>{a!==sl.oe&&r(new Jt(mc(s)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function F1(t,e){return bu(t).put(function(n,s){return{targetId:0,path:ki(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(){this.changes=new pd(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,os.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?mt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bJ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Fd(e).put(n)}removeEntry(e,r,n){return Fd(e).delete(function(a,o){const l=a.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Zw(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=os.newInvalidDocument(r);return Fd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Km(r))},(s,a)=>{n=this.ir(r,a)}).next(()=>n)}sr(e,r){let n={size:0,document:os.newInvalidDocument(r)};return Fd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Km(r))},(s,a)=>{n={document:this.ir(r,a),size:t2(a)}}).next(()=>n)}getEntries(e,r){let n=Co();return this._r(e,r,(s,a)=>{const o=this.ir(s,a);n=n.insert(s,o)}).next(()=>n)}ar(e,r){let n=Co(),s=new us(Jt.comparator);return this._r(e,r,(a,o)=>{const l=this.ir(a,o);n=n.insert(a,l),s=s.insert(a,t2(o))}).next(()=>({documents:n,ur:s}))}_r(e,r,n){if(r.isEmpty())return mt.resolve();let s=new Pn(nk);r.forEach(c=>s=s.add(c));const a=IDBKeyRange.bound(Km(s.first()),Km(s.last())),o=s.getIterator();let l=o.getNext();return Fd(e).J({index:"documentKeyIndex",range:a},(c,A,u)=>{const d=Jt.fromSegments([...A.prefixPath,A.collectionGroup,A.documentId]);for(;l&&nk(l,d)<0;)n(l,null),l=o.getNext();l&&l.isEqual(d)&&(n(l,A),l=o.hasNext()?o.getNext():null),l?u.$(Km(l)):u.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,s,a){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),Zw(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fd(e).U(IDBKeyRange.bound(l,c,!0)).next(A=>{a==null||a.incrementDocumentReadCount(A.length);let u=Co();for(const d of A){const f=this.ir(Jt.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);f.isFoundDocument()&&(Ex(r,f)||s.has(f.key))&&(u=u.insert(f.key,f))}return u})}getAllFromCollectionGroup(e,r,n,s){let a=Co();const o=rk(r,n),l=rk(r,So.max());return Fd(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,A,u)=>{const d=this.ir(Jt.fromSegments(A.prefixPath.concat(A.collectionGroup,A.documentId)),A);a=a.insert(d.key,d),a.size===s&&u.done()}).next(()=>a)}newChangeBuffer(e){return new NJ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return tk(e).get("remoteDocumentGlobalKey").next(r=>(dr(!!r),r))}rr(e,r){return tk(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=iJ(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(mr.min())))return n}return os.newInvalidDocument(e)}}function a6(t){return new bJ(t)}class NJ extends s6{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new pd(n=>n.toString(),(n,s)=>n.isEqual(s))}applyChanges(e){const r=[];let n=0,s=new Pn((a,o)=>jr(a.canonicalString(),o.canonicalString()));return this.changes.forEach((a,o)=>{const l=this.lr.get(a);if(r.push(this.cr.removeEntry(e,a,l.readTime)),o.isValidDocument()){const c=QF(this.cr.serializer,o);s=s.add(a.path.popLast());const A=t2(c);n+=A-l.size,r.push(this.cr.addEntry(e,a,c))}else if(n-=l.size,this.trackRemovals){const c=QF(this.cr.serializer,o.convertToNoDocument(mr.min()));r.push(this.cr.addEntry(e,a,c))}}),s.forEach(a=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,a))}),r.push(this.cr.updateMetadata(e,n)),mt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:s})=>(s.forEach((a,o)=>{this.lr.set(a,{size:o,readTime:n.get(a).readTime})}),n))}}function tk(t){return ha(t,"remoteDocumentGlobal")}function Fd(t){return ha(t,"remoteDocumentsV14")}function Km(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function rk(t,e){const r=e.documentKey.path.toArray();return[t,Zw(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function nk(t,e){const r=t.path.toArray(),n=e.path.toArray();let s=0;for(let a=0;a<r.length-2&&a<n.length-2;++a)if(s=jr(r[a],n[a]),s)return s;return s=jr(r.length,n.length),s||(s=jr(r[r.length-2],n[n.length-2]),s||jr(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CJ{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Mp(n.mutation,s,$i.empty(),Vt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Vr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Vr()){const s=pc();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let o=dp();return a.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=pc();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Vr()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let a=Co();const o=Op(),l=function(){return Op()}();return r.forEach((c,A)=>{const u=n.get(A.key);s.has(A.key)&&(u===void 0||u.mutation instanceof kA)?a=a.insert(A.key,A):u!==void 0?(o.set(A.key,u.mutation.getFieldMask()),Mp(u.mutation,A,u.mutation.getFieldMask(),Vt.now())):o.set(A.key,$i.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((A,u)=>o.set(A,u)),r.forEach((A,u)=>{var d;return l.set(A,new CJ(u,(d=o.get(A))!==null&&d!==void 0?d:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Op();let s=new us((o,l)=>o-l),a=Vr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const A=r.get(c);if(A===null)return;let u=n.get(c)||$i.empty();u=l.applyToLocalView(A,u),n.set(c,u);const d=(s.get(l.batchId)||Vr()).add(c);s=s.insert(l.batchId,d)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),A=c.key,u=c.value,d=BU();u.forEach(f=>{if(!a.has(f)){const h=jU(r.get(f),n.get(f));h!==null&&d.set(f,h),a=a.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,A,d))}return mt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return Jt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):bU(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):mt.resolve(pc());let l=-1,c=a;return o.next(A=>mt.forEach(A,(u,d)=>(l<d.largestBatchId&&(l=d.largestBatchId),a.get(u)?mt.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(e,A,a)).next(()=>this.computeViews(e,c,A,Vr())).next(u=>({batchId:l,changes:EU(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Jt(r)).next(n=>{let s=dp();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let o=dp();return this.indexManager.getCollectionParents(e,a).next(l=>mt.forEach(l,c=>{const A=function(d,f){return new em(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,A,n,s).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(o=>{a.forEach((c,A)=>{const u=A.getKey();o.get(u)===null&&(o=o.insert(u,os.newInvalidDocument(u)))});let l=dp();return o.forEach((c,A)=>{const u=a.get(c);u!==void 0&&Mp(u.mutation,A,$i.empty(),Vt.now()),Ex(r,A)&&(l=l.insert(c,A))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _J{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return mt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ea(s.createTime)}}(r)),mt.resolve()}getNamedQuery(e,r){return mt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:YU(s.bundledQuery),readTime:Ea(s.readTime)}}(r)),mt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(){this.overlays=new us(Jt.comparator),this.Ir=new Map}getOverlay(e,r){return mt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=pc();return mt.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.ht(e,r,a)}),mt.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),mt.resolve()}getOverlaysForCollection(e,r,n){const s=pc(),a=r.length+1,o=new Jt(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,A=c.getKey();if(!r.isPrefixOf(A.path))break;A.path.length===a&&c.largestBatchId>n&&s.set(c.getKey(),c)}return mt.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new us((A,u)=>A-u);const o=this.overlays.getIterator();for(;o.hasNext();){const A=o.getNext().value;if(A.getKey().getCollectionGroup()===r&&A.largestBatchId>n){let u=a.get(A.largestBatchId);u===null&&(u=pc(),a=a.insert(A.largestBatchId,u)),u.set(A.getKey(),A)}}const l=pc(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((A,u)=>l.set(A,u)),!(l.size()>=s)););return mt.resolve(l)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new AS(r,n));let a=this.Ir.get(r);a===void 0&&(a=Vr(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BJ{constructor(){this.sessionToken=Ks.EMPTY_BYTE_STRING}getSessionToken(e){return mt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,mt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(){this.Tr=new Pn(va.Er),this.dr=new Pn(va.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new va(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new va(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Jt(new fn([])),n=new va(r,e),s=new va(r,e+1),a=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),a.push(o.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Jt(new fn([])),n=new va(r,e),s=new va(r,e+1);let a=Vr();return this.dr.forEachInRange([n,s],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new va(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class va{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Jt.comparator(e.key,r.key)||jr(e.wr,r.wr)}static Ar(e,r){return jr(e.wr,r.wr)||Jt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SJ{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Pn(va.Er)}checkEmpty(e){return mt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new lS(a,r,n,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new va(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return mt.resolve(o)}lookupMutationBatch(e,r){return mt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return mt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return mt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return mt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new va(r,0),s=new va(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],o=>{const l=this.Dr(o.wr);a.push(l)}),mt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pn(jr);return r.forEach(s=>{const a=new va(s,0),o=new va(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,o],l=>{n=n.add(l.wr)})}),mt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;Jt.isDocumentKey(a)||(a=a.child(""));const o=new va(new Jt(a),0);let l=new Pn(jr);return this.br.forEachWhile(c=>{const A=c.key.path;return!!n.isPrefixOf(A)&&(A.length===s&&(l=l.add(c.wr)),!0)},o),mt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){dr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return mt.forEach(r.mutations,s=>{const a=new va(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new va(r,0),s=this.br.firstAfterOrEqual(n);return mt.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,mt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(e){this.Mr=e,this.docs=function(){return new us(Jt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return mt.resolve(n?n.document.mutableCopy():os.newInvalidDocument(r))}getEntries(e,r){let n=Co();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():os.newInvalidDocument(s))}),mt.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=Co();const o=r.path,l=new Jt(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:A,value:{document:u}}=c.getNext();if(!o.isPrefixOf(A.path))break;A.path.length>o.length+1||eS(rU(u),n)<=0||(s.has(u.key)||Ex(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return mt.resolve(a)}getAllFromCollectionGroup(e,r,n,s){ir()}Or(e,r){return mt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new FJ(this)}getSize(e){return mt.resolve(this.size)}}class FJ extends s6{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),mt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kJ{constructor(e){this.persistence=e,this.Nr=new pd(r=>Eh(r),Cx),this.lastRemoteSnapshotVersion=mr.min(),this.highestTargetId=0,this.Lr=0,this.Br=new mS,this.targetCount=0,this.kr=Ih.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),mt.resolve()}getLastRemoteSnapshotVersion(e){return mt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return mt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),mt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),mt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ih(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,mt.resolve()}updateTargetData(e,r){return this.Kn(r),mt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,mt.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),mt.waitFor(a).next(()=>s)}getTargetCount(e){return mt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return mt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),mt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(o=>{a.push(s.markPotentiallyOrphaned(e,o))}),mt.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),mt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return mt.resolve(n)}containsKey(e,r){return mt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,r){this.qr={},this.overlays={},this.Qr=new sl(0),this.Kr=!1,this.Kr=!0,this.$r=new BJ,this.referenceDelegate=e(this),this.Ur=new kJ(this),this.indexManager=new fJ,this.remoteDocumentCache=function(s){return new IJ(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new JU(r),this.Gr=new _J(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new EJ,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new SJ(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Mt("MemoryPersistence","Starting transaction:",e);const s=new TJ(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(e,r){return mt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class TJ extends sU{constructor(e){super(),this.currentSequenceNumber=e}}class fy{constructor(e){this.persistence=e,this.Jr=new mS,this.Yr=null}static Zr(e){return new fy(e)}get Xr(){if(this.Yr)return this.Yr;throw ir()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),mt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),mt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),mt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mt.forEach(this.Xr,n=>{const s=Jt.fromPath(n);return this.ei(e,s).next(a=>{a||r.removeEntry(s,mr.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return mt.or([()=>mt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jJ{constructor(e){this.serializer=e}O(e,r,n,s){const a=new iy("createOrUpgrade",r);n<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gF,{unique:!0}),c.createObjectStore("documentMutations")}(e),sk(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=mt.resolve();return n<3&&s>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),sk(e)),o=o.next(()=>function(c){const A=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:mr.min().toTimestamp(),targetCount:0};return A.put("targetGlobalKey",u)}(a))),n<4&&s>=4&&(n!==0&&(o=o.next(()=>function(c,A){return A.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gF,{unique:!0});const d=A.store("mutations"),f=u.map(h=>d.put(h));return mt.waitFor(f)})}(e,a))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&s>=5&&(o=o.next(()=>this.ni(a))),n<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(a)))),n<7&&s>=7&&(o=o.next(()=>this.ii(a))),n<8&&s>=8&&(o=o.next(()=>this.si(e,a))),n<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&s>=10&&(o=o.next(()=>this.oi(a))),n<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&s>=12&&(o=o.next(()=>{(function(c){const A=c.createObjectStore("documentOverlays",{keyPath:oW});A.createIndex("collectionPathOverlayIndex",lW,{unique:!1}),A.createIndex("collectionGroupOverlayIndex",cW,{unique:!1})})(e)})),n<13&&s>=13&&(o=o.next(()=>function(c){const A=c.createObjectStore("remoteDocumentsV14",{keyPath:Jz});A.createIndex("documentKeyIndex",Xz),A.createIndex("collectionGroupIndex",Yz)}(e)).next(()=>this._i(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&s>=14&&(o=o.next(()=>this.ai(e,a))),n<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:nW}).createIndex("sequenceNumberIndex",sW,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:aW}).createIndex("documentKeyIndex",iW,{unique:!1})}(e))),n<16&&s>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,s)=>{r+=t2(s)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(s=>mt.forEach(s,a=>{const o=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>mt.forEach(l,c=>{dr(c.userId===a.userId);const A=Kd(this.serializer,c);return t6(e,a.userId,A).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const a=[];return n.J((o,l)=>{const c=new fn(o),A=function(d){return[0,ki(d)]}(c);a.push(r.get(A).next(u=>u?mt.resolve():(d=>r.put({targetId:0,path:ki(d),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>mt.waitFor(a))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:rW});const n=r.store("collectionParents"),s=new fS,a=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:ki(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new fn(o);return a(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],A)=>{const u=mc(l);return a(u.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,s)=>{const a=fp(s),o=XU(this.serializer,a);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),s=[];return n.J((a,o)=>{const l=r.store("remoteDocumentsV14"),c=function(d){return d.document?new Jt(fn.fromString(d.document.name).popFirst(5)):d.noDocument?Jt.fromSegments(d.noDocument.path):d.unknownDocument?Jt.fromSegments(d.unknownDocument.path):ir()}(o).path.toArray(),A={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(A))}).next(()=>mt.waitFor(s))}ai(e,r){const n=r.store("mutations"),s=a6(this.serializer),a=new o6(fy.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var A;let u=(A=l.get(c.userId))!==null&&A!==void 0?A:Vr();Kd(this.serializer,c).keys().forEach(d=>u=u.add(d)),l.set(c.userId,u)}),mt.forEach(l,(c,A)=>{const u=new Ua(A),d=dy.lt(this.serializer,u),f=a.getIndexManager(u),h=hy.lt(u,this.serializer,f,a.referenceDelegate);return new i6(s,h,d,f).recalculateAndSaveOverlaysForDocumentKeys(new __(r,sl.oe),c).next()})})}}function sk(t){t.createObjectStore("targetDocuments",{keyPath:eW}).createIndex("documentTargetsIndex",tW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Zz,{unique:!0}),t.createObjectStore("targetGlobal")}const Zb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class pS{constructor(e,r,n,s,a,o,l,c,A,u,d=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=a,this.window=o,this.document=l,this.ci=A,this.li=u,this.hi=d,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!pS.D())throw new Gt(Et.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new yJ(this,s),this.Ai=r+"main",this.serializer=new JU(c),this.Ri=new qu(this.Ai,this.hi,new jJ(this.serializer)),this.$r=new lJ,this.Ur=new pJ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=a6(this.serializer),this.Gr=new oJ,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&Ii("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Gt(Et.FAILED_PRECONDITION,Zb);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new sl(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>k1(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(md(e))return Mt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Mt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return qm(e).get("owner").next(r=>mt.resolve(this.vi(r)))}Ci(e){return k1(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=ha(r,"clientMetadata");return n.U().next(s=>{const a=this.xi(s,18e5),o=s.filter(l=>a.indexOf(l)===-1);return mt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?mt.resolve(!0):qm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Gt(Et.FAILED_PRECONDITION,Zb);return!1}}return!(!this.networkEnabled||!this.inForeground)||k1(e).U().next(n=>this.xi(n,5e3).find(s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(a||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Mt("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new __(e,sl.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>k1(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return hy.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mJ(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return dy.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Mt("IndexedDbPersistence","Starting transaction:",e);const s=r==="readonly"?"readonly":"readwrite",a=function(c){return c===17?dW:c===16?uW:c===15?rS:c===14?cU:c===13?lU:c===12?AW:c===11?oU:void ir()}(this.hi);let o;return this.Ri.runTransaction(e,s,a,l=>(o=new __(l,this.Qr?this.Qr.next():sl.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Ii(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Gt(Et.FAILED_PRECONDITION,nU);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return qm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Gt(Et.FAILED_PRECONDITION,Zb)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qm(e).put("owner",r)}static D(){return qu.D()}bi(e){const r=qm(e);return r.get("owner").next(n=>this.vi(n)?(Mt("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):mt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(Ii(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;sL()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Mt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ii("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ii("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function qm(t){return ha(t,"owner")}function k1(t){return ha(t,"clientMetadata")}function PJ(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Vr(),s=Vr();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new gS(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return sL()?8:aU(ua())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.Yi(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Zi(e,r,s,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new RJ;return this.Xi(e,r,o).next(l=>{if(a.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>a.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(Lf()<=tn.DEBUG&&Mt("QueryEngine","SDK will not create cache indexes for query:",Uf(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),mt.resolve()):(Lf()<=tn.DEBUG&&Mt("QueryEngine","Query:",Uf(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Lf()<=tn.DEBUG&&Mt("QueryEngine","The SDK decides to create cache indexes for query:",Uf(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ll(r))):mt.resolve())}Yi(e,r){if(FF(r))return mt.resolve(null);let n=ll(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Yw(r,null,"F"),n=ll(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=Vr(...a);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const A=this.ts(r,l);return this.ns(r,A,o,c.readTime)?this.Yi(e,Yw(r,null,"F")):this.rs(e,A,r,c)}))})))}Zi(e,r,n,s){return FF(r)||s.isEqual(mr.min())?mt.resolve(null):this.Ji.getDocuments(e,n).next(a=>{const o=this.ts(r,a);return this.ns(r,o,n,s)?mt.resolve(null):(Lf()<=tn.DEBUG&&Mt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Uf(r)),this.rs(e,o,r,Vz(s,-1)).next(l=>l))})}ts(e,r){let n=new Pn(CU(e));return r.forEach((s,a)=>{Ex(e,a)&&(n=n.add(a))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(e,r,n){return Lf()<=tn.DEBUG&&Mt("QueryEngine","Using full collection scan to execute query:",Uf(r)),this.Ji.getDocumentsMatchingQuery(e,r,So.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DJ{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new us(jr),this._s=new pd(a=>Eh(a),Cx),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new i6(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function c6(t,e,r,n){return new DJ(t,e,r,n)}async function A6(t,e){const r=Sr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],l=[];let c=Vr();for(const A of s){o.push(A.batchId);for(const u of A.mutations)c=c.add(u.key)}for(const A of a){l.push(A.batchId);for(const u of A.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(A=>({hs:A,removedBatchIds:o,addedBatchIds:l}))})})}function LJ(t,e){const r=Sr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,A,u){const d=A.batch,f=d.keys();let h=mt.resolve();return f.forEach(m=>{h=h.next(()=>u.getEntry(c,m)).next(p=>{const x=A.docVersions.get(m);dr(x!==null),p.version.compareTo(x)<0&&(d.applyToRemoteDocument(p,A),p.isValidDocument()&&(p.setReadTime(A.commitVersion),u.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,d))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Vr();for(let A=0;A<l.mutationResults.length;++A)l.mutationResults[A].transformResults.length>0&&(c=c.add(l.batch.mutations[A].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function u6(t){const e=Sr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function UJ(t,e){const r=Sr(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const l=[];e.targetChanges.forEach((u,d)=>{const f=s.get(d);if(!f)return;l.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,d)));let h=f.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(d)!==null?h=h.withResumeToken(Ks.EMPTY_BYTE_STRING,mr.min()).withLastLimboFreeSnapshotVersion(mr.min()):u.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(u.resumeToken,n)),s=s.insert(d,h),function(p,x,g){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(f,h,u)&&l.push(r.Ur.updateTargetData(a,h))});let c=Co(),A=Vr();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),l.push(OJ(a,o,e.documentUpdates).next(u=>{c=u.Ps,A=u.Is})),!n.isEqual(mr.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(d=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));l.push(u)}return mt.waitFor(l).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,A)).next(()=>c)}).then(a=>(r.os=s,a))}function OJ(t,e,r){let n=Vr(),s=Vr();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=Co();return r.forEach((l,c)=>{const A=a.get(l);c.isFoundDocument()!==A.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(mr.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!A.isValidDocument()||c.version.compareTo(A.version)>0||c.version.compareTo(A.version)===0&&A.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Mt("LocalStore","Ignoring outdated watch update for ",l,". Current version:",A.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function MJ(t,e){const r=Sr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function QJ(t,e){const r=Sr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(a=>a?(s=a,mt.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new oA(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function O_(t,e,r){const n=Sr(t),s=n.os.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!md(o))throw o;Mt("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function ak(t,e,r){const n=Sr(t);let s=mr.min(),a=Vr();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,A,u){const d=Sr(c),f=d._s.get(u);return f!==void 0?mt.resolve(d.os.get(f)):d.Ur.getTargetData(A,u)}(n,o,ll(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{a=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:mr.min(),r?a:Vr())).next(l=>(VJ(n,BW(e),l),{documents:l,Ts:a})))}function VJ(t,e,r){let n=t.us.get(e)||mr.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.us.set(e,n)}class ik{constructor(){this.activeTargetIds=jW()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class d6{constructor(){this.so=new ik,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ik,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HJ{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Mt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Mt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let T1=null;function eN(){return T1===null?T1=function(){return 268435456+Math.round(2147483648*Math.random())}():T1++,"0x"+T1.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qJ{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za="WebChannelConnection";class GJ extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,o){const l=eN(),c=this.xo(r,n.toUriEncodedString());Mt("RestConnection",`Sending RPC '${r}' ${l}:`,c,s);const A={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(A,a,o),this.No(r,c,A,s).then(u=>(Mt("RestConnection",`Received RPC '${r}' ${l}: `,u),u),u=>{throw Xu("RestConnection",`RPC '${r}' ${l} failed with error: `,u,"url: ",c,"request:",s),u})}Lo(r,n,s,a,o,l){return this.Mo(r,n,s,a,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Z0}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>r[o]=a),s&&s.headers.forEach((a,o)=>r[o]=a)}xo(r,n){const s=KJ[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const a=eN();return new Promise((o,l)=>{const c=new zL;c.setWithCredentials(!0),c.listenOnce(WL.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case rw.NO_ERROR:const u=c.getResponseJson();Mt(Za,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(u)),o(u);break;case rw.TIMEOUT:Mt(Za,`RPC '${e}' ${a} timed out`),l(new Gt(Et.DEADLINE_EXCEEDED,"Request time out"));break;case rw.HTTP_ERROR:const d=c.getStatus();if(Mt(Za,`RPC '${e}' ${a} failed with status:`,d,"response text:",c.getResponseText()),d>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(x){const g=x.toLowerCase().replace(/_/g,"-");return Object.values(Et).indexOf(g)>=0?g:Et.UNKNOWN}(h.status);l(new Gt(m,h.message))}else l(new Gt(Et.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Gt(Et.UNAVAILABLE,"Connection failed."));break;default:ir()}}finally{Mt(Za,`RPC '${e}' ${a} completed.`)}});const A=JSON.stringify(s);Mt(Za,`RPC '${e}' ${a} sending request:`,s),c.send(r,"POST",A,n,15)})}Bo(e,r,n){const s=eN(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=YL(),l=XL(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},A=this.longPollingOptions.timeoutSeconds;A!==void 0&&(c.longPollingTimeout=Math.round(1e3*A)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=a.join("");Mt(Za,`Creating RPC '${e}' stream ${s}: ${u}`,c);const d=o.createWebChannel(u,c);let f=!1,h=!1;const m=new qJ({Io:x=>{h?Mt(Za,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(f||(Mt(Za,`Opening RPC '${e}' stream ${s} transport.`),d.open(),f=!0),Mt(Za,`RPC '${e}' stream ${s} sending:`,x),d.send(x))},To:()=>d.close()}),p=(x,g,y)=>{x.listen(g,b=>{try{y(b)}catch(F){setTimeout(()=>{throw F},0)}})};return p(d,up.EventType.OPEN,()=>{h||(Mt(Za,`RPC '${e}' stream ${s} transport opened.`),m.yo())}),p(d,up.EventType.CLOSE,()=>{h||(h=!0,Mt(Za,`RPC '${e}' stream ${s} transport closed`),m.So())}),p(d,up.EventType.ERROR,x=>{h||(h=!0,Xu(Za,`RPC '${e}' stream ${s} transport errored:`,x),m.So(new Gt(Et.UNAVAILABLE,"The operation could not be completed")))}),p(d,up.EventType.MESSAGE,x=>{var g;if(!h){const y=x.data[0];dr(!!y);const b=y,F=b.error||((g=b[0])===null||g===void 0?void 0:g.error);if(F){Mt(Za,`RPC '${e}' stream ${s} received error:`,F);const j=F.status;let R=function(B){const U=$s[B];if(U!==void 0)return DU(U)}(j),E=F.message;R===void 0&&(R=Et.INTERNAL,E="Unknown error status: "+j+" with message "+F.message),h=!0,m.So(new Gt(R,E)),d.close()}else Mt(Za,`RPC '${e}' stream ${s} received:`,y),m.bo(y)}}),p(l,JL.STAT_EVENT,x=>{x.stat===N_.PROXY?Mt(Za,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===N_.NOPROXY&&Mt(Za,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $J(){return typeof window<"u"?window:null}function cw(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t){return new WW(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,r,n=1e3,s=1.5,a=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Mt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,r,n,s,a,o,l,c){this.ui=e,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new xS(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Et.RESOURCE_EXHAUSTED?(Ii(r.toString()),Ii("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Et.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Gt(Et.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Mt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Mt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zJ extends h6{constructor(e,r,n,s,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=ZW(this.serializer,e),n=function(a){if(!("targetChange"in a))return mr.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?mr.min():o.readTime?Ea(o.readTime):mr.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=P_(this.serializer),r.addTarget=function(a,o){let l;const c=o.target;if(l=Jw(c)?{documents:KU(a,c)}:{query:qU(a,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=OU(a,o.resumeToken);const A=T_(a,o.expectedCount);A!==null&&(l.expectedCount=A)}else if(o.snapshotVersion.compareTo(mr.min())>0){l.readTime=U0(a,o.snapshotVersion.toTimestamp());const A=T_(a,o.expectedCount);A!==null&&(l.expectedCount=A)}return l}(this.serializer,e);const n=tJ(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=P_(this.serializer),r.removeTarget=e,this.a_(r)}}class WJ extends h6{constructor(e,r,n,s,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return dr(!!e.streamToken),this.lastStreamToken=e.streamToken,dr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){dr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=eJ(e.writeResults,e.commitTime),n=Ea(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=P_(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>Mg(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JJ extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Gt(Et.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,j_(r,n),s,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Gt(Et.UNKNOWN,a.toString())})}Lo(e,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,j_(r,n),s,o,l,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Gt(Et.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class XJ{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ii(r),this.D_=!1):Mt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YJ{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(o=>{n.enqueueAndForget(async()=>{Hh(this)&&(Mt("RemoteStore","Restarting streams for network reachability change."),await async function(c){const A=Sr(c);A.L_.add(4),await Sx(A),A.q_.set("Unknown"),A.L_.delete(4),await py(A)}(this))})}),this.q_=new XJ(n,s)}}async function py(t){if(Hh(t))for(const e of t.B_)await e(!0)}async function Sx(t){for(const e of t.B_)await e(!1)}function f6(t,e){const r=Sr(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),bS(r)?yS(r):nm(r).r_()&&wS(r,e))}function vS(t,e){const r=Sr(t),n=nm(r);r.N_.delete(e),n.r_()&&m6(r,e),r.N_.size===0&&(n.r_()?n.o_():Hh(r)&&r.q_.set("Unknown"))}function wS(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}nm(t).A_(e)}function m6(t,e){t.Q_.xe(e),nm(t).R_(e)}function yS(t){t.Q_=new qW({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),nm(t).start(),t.q_.v_()}function bS(t){return Hh(t)&&!nm(t).n_()&&t.N_.size>0}function Hh(t){return Sr(t).L_.size===0}function p6(t){t.Q_=void 0}async function ZJ(t){t.q_.set("Online")}async function eX(t){t.N_.forEach((e,r)=>{wS(t,e)})}async function tX(t,e){p6(t),bS(t)?(t.q_.M_(e),yS(t)):t.q_.set("Unknown")}async function rX(t,e,r){if(t.q_.set("Online"),e instanceof UU&&e.state===2&&e.cause)try{await async function(s,a){const o=a.cause;for(const l of a.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(n){Mt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await r2(t,n)}else if(e instanceof lw?t.Q_.Ke(e):e instanceof LU?t.Q_.He(e):t.Q_.We(e),!r.isEqual(mr.min()))try{const n=await u6(t.localStore);r.compareTo(n)>=0&&await function(a,o){const l=a.Q_.rt(o);return l.targetChanges.forEach((c,A)=>{if(c.resumeToken.approximateByteSize()>0){const u=a.N_.get(A);u&&a.N_.set(A,u.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,A)=>{const u=a.N_.get(c);if(!u)return;a.N_.set(c,u.withResumeToken(Ks.EMPTY_BYTE_STRING,u.snapshotVersion)),m6(a,c);const d=new oA(u.target,c,A,u.sequenceNumber);wS(a,d)}),a.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Mt("RemoteStore","Failed to raise snapshot:",n),await r2(t,n)}}async function r2(t,e,r){if(!md(e))throw e;t.L_.add(1),await Sx(t),t.q_.set("Offline"),r||(r=()=>u6(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Mt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await py(t)})}function g6(t,e){return e().catch(r=>r2(t,r,e))}async function Ix(t){const e=Sr(t),r=td(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;nX(e);)try{const s=await MJ(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,sX(e,s)}catch(s){await r2(e,s)}x6(e)&&v6(e)}function nX(t){return Hh(t)&&t.O_.length<10}function sX(t,e){t.O_.push(e);const r=td(t);r.r_()&&r.V_&&r.m_(e.mutations)}function x6(t){return Hh(t)&&!td(t).n_()&&t.O_.length>0}function v6(t){td(t).start()}async function aX(t){td(t).p_()}async function iX(t){const e=td(t);for(const r of t.O_)e.m_(r.mutations)}async function oX(t,e,r){const n=t.O_.shift(),s=cS.from(n,e,r);await g6(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Ix(t)}async function lX(t,e){e&&td(t).V_&&await async function(n,s){if(function(o){return RU(o)&&o!==Et.ABORTED}(s.code)){const a=n.O_.shift();td(n).s_(),await g6(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Ix(n)}}(t,e),x6(t)&&v6(t)}async function lk(t,e){const r=Sr(t);r.asyncQueue.verifyOperationInProgress(),Mt("RemoteStore","RemoteStore received new credentials");const n=Hh(r);r.L_.add(3),await Sx(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await py(r)}async function cX(t,e){const r=Sr(t);e?(r.L_.delete(2),await py(r)):e||(r.L_.add(2),await Sx(r),r.q_.set("Unknown"))}function nm(t){return t.K_||(t.K_=function(r,n,s){const a=Sr(r);return a.w_(),new zJ(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:ZJ.bind(null,t),Ro:eX.bind(null,t),mo:tX.bind(null,t),d_:rX.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),bS(t)?yS(t):t.q_.set("Unknown")):(await t.K_.stop(),p6(t))})),t.K_}function td(t){return t.U_||(t.U_=function(r,n,s){const a=Sr(r);return a.w_(),new WJ(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:aX.bind(null,t),mo:lX.bind(null,t),f_:iX.bind(null,t),g_:oX.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Ix(t)):(await t.U_.stop(),t.O_.length>0&&(Mt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Dl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const o=Date.now()+n,l=new NS(e,r,o,s,a);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Gt(Et.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function CS(t,e){if(Ii("AsyncQueue",`${e}: ${t}`),md(t))return new Gt(Et.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Jt.comparator(r.key,n.key):(r,n)=>Jt.comparator(r.key,n.key),this.keyedMap=dp(),this.sortedSet=new us(this.comparator)}static emptySet(e){return new g0(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof g0)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new g0;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(){this.W_=new us(Jt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ir():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class O0{constructor(e,r,n,s,a,o,l,c,A){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=A}static fromInitialDocuments(e,r,n,s,a){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new O0(e,r,g0.emptySet(r),o,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ly(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AX{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class uX{constructor(){this.queries=Ak(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Sr(r),a=s.queries;s.queries=Ak(),a.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Gt(Et.ABORTED,"Firestore shutting down"))}}function Ak(){return new pd(t=>NU(t),ly)}async function _S(t,e){const r=Sr(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.H_()&&e.J_()&&(n=2):(a=new AX,n=e.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=CS(o,`Initialization of query '${Uf(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,a),a.j_.push(e),e.Z_(r.onlineState),a.z_&&e.X_(a.z_)&&BS(r)}async function ES(t,e){const r=Sr(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const o=a.j_.indexOf(e);o>=0&&(a.j_.splice(o,1),a.j_.length===0?s=e.J_()?0:1:!a.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function dX(t,e){const r=Sr(t);let n=!1;for(const s of e){const a=s.query,o=r.queries.get(a);if(o){for(const l of o.j_)l.X_(s)&&(n=!0);o.z_=s}}n&&BS(r)}function hX(t,e,r){const n=Sr(t),s=n.queries.get(e);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(e)}function BS(t){t.Y_.forEach(e=>{e.next()})}var M_,uk;(uk=M_||(M_={})).ea="default",uk.Cache="cache";class SS{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new O0(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=O0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==M_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e){this.key=e}}class y6{constructor(e){this.key=e}}class fX{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Vr(),this.mutatedKeys=Vr(),this.Aa=CU(e),this.Ra=new g0(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new ck,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,A=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,d)=>{const f=s.get(u),h=Ex(this.query,d)?d:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(f,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||A&&this.Aa(h,A)<0)&&(l=!0)):!f&&h?(n.track({type:0,doc:h}),x=!0):f&&!h&&(n.track({type:1,doc:f}),x=!0,(c||A)&&(l=!0)),x&&(h?(o=o.add(h),a=p?a.add(u):a.delete(u)):(o=o.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:o,fa:n,ns:l,mutatedKeys:a}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,d)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ir()}};return p(h)-p(m)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(n),s=s!=null&&s;const l=r&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,A=c!==this.Ea;return this.Ea=c,o.length!==0||A?{snapshot:new O0(this.query,e.Ra,a,o,e.mutatedKeys,c===0,A,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ck,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Vr(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new y6(n))}),this.da.forEach(n=>{e.has(n)||r.push(new w6(n))}),r}ba(e){this.Ta=e.Ts,this.da=Vr();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return O0.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class mX{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class pX{constructor(e){this.key=e,this.va=!1}}class gX{constructor(e,r,n,s,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new pd(l=>NU(l),ly),this.Ma=new Map,this.xa=new Set,this.Oa=new us(Jt.comparator),this.Na=new Map,this.La=new mS,this.Ba={},this.ka=new Map,this.qa=Ih.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function xX(t,e,r=!0){const n=B6(t);let s;const a=n.Fa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await b6(n,e,r,!0),s}async function vX(t,e){const r=B6(t);await b6(r,e,!0,!1)}async function b6(t,e,r,n){const s=await QJ(t.localStore,ll(e)),a=s.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let l;return n&&(l=await wX(t,e,a,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&f6(t.remoteStore,s),l}async function wX(t,e,r,n,s){t.Ka=(d,f,h)=>async function(p,x,g,y){let b=x.view.ma(g);b.ns&&(b=await ak(p.localStore,x.query,!1).then(({documents:E})=>x.view.ma(E,b)));const F=y&&y.targetChanges.get(x.targetId),j=y&&y.targetMismatches.get(x.targetId)!=null,R=x.view.applyChanges(b,p.isPrimaryClient,F,j);return hk(p,x.targetId,R.wa),R.snapshot}(t,d,f,h);const a=await ak(t.localStore,e,!0),o=new fX(e,a.Ts),l=o.ma(a.documents),c=Bx.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),A=o.applyChanges(l,t.isPrimaryClient,c);hk(t,r,A.wa);const u=new mX(e,r,o);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),A.snapshot}async function yX(t,e,r){const n=Sr(t),s=n.Fa.get(e),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(o=>!ly(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await O_(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&vS(n.remoteStore,s.targetId),Q_(n,s.targetId)}).catch(Qh)):(Q_(n,s.targetId),await O_(n.localStore,s.targetId,!0))}async function bX(t,e){const r=Sr(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),vS(r.remoteStore,n.targetId))}async function NX(t,e,r){const n=S6(t);try{const s=await function(o,l){const c=Sr(o),A=Vt.now(),u=l.reduce((h,m)=>h.add(m.key),Vr());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Co(),p=Vr();return c.cs.getEntries(h,u).next(x=>{m=x,m.forEach((g,y)=>{y.isValidDocument()||(p=p.add(g))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{d=x;const g=[];for(const y of l){const b=QW(y,d.get(y.key).overlayedDocument);b!=null&&g.push(new kA(y.key,b,fU(b.value.mapValue),cs.exists(!0)))}return c.mutationQueue.addMutationBatch(h,A,g,l)}).next(x=>{f=x;const g=x.applyToLocalDocumentSet(d,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,g)})}).then(()=>({batchId:f.batchId,changes:EU(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let A=o.Ba[o.currentUser.toKey()];A||(A=new us(jr)),A=A.insert(l,c),o.Ba[o.currentUser.toKey()]=A}(n,s.batchId,r),await Fx(n,s.changes),await Ix(n.remoteStore)}catch(s){const a=CS(s,"Failed to persist write");r.reject(a)}}async function N6(t,e){const r=Sr(t);try{const n=await UJ(r.localStore,e);e.targetChanges.forEach((s,a)=>{const o=r.Na.get(a);o&&(dr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?dr(o.va):s.removedDocuments.size>0&&(dr(o.va),o.va=!1))}),await Fx(r,n,e)}catch(n){await Qh(n)}}function dk(t,e,r){const n=Sr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Sr(o);c.onlineState=l;let A=!1;c.queries.forEach((u,d)=>{for(const f of d.j_)f.Z_(l)&&(A=!0)}),A&&BS(c)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function CX(t,e,r){const n=Sr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),a=s&&s.key;if(a){let o=new us(Jt.comparator);o=o.insert(a,os.newNoDocument(a,mr.min()));const l=Vr().add(a),c=new uy(mr.min(),new Map,new us(jr),o,l);await N6(n,c),n.Oa=n.Oa.remove(a),n.Na.delete(e),IS(n)}else await O_(n.localStore,e,!1).then(()=>Q_(n,e,r)).catch(Qh)}async function _X(t,e){const r=Sr(t),n=e.batch.batchId;try{const s=await LJ(r.localStore,e);_6(r,n,null),C6(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Fx(r,s)}catch(s){await Qh(s)}}async function EX(t,e,r){const n=Sr(t);try{const s=await function(o,l){const c=Sr(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",A=>{let u;return c.mutationQueue.lookupMutationBatch(A,l).next(d=>(dr(d!==null),u=d.keys(),c.mutationQueue.removeMutationBatch(A,d))).next(()=>c.mutationQueue.performConsistencyCheck(A)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(A,u,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(A,u)).next(()=>c.localDocuments.getDocuments(A,u))})}(n.localStore,e);_6(n,e,r),C6(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Fx(n,s)}catch(s){await Qh(s)}}function C6(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function _6(t,e,r){const n=Sr(t);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function Q_(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||E6(t,n)})}function E6(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(vS(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),IS(t))}function hk(t,e,r){for(const n of r)n instanceof w6?(t.La.addReference(n.key,e),BX(t,n)):n instanceof y6?(Mt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||E6(t,n.key)):ir()}function BX(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Mt("SyncEngine","New document in limbo: "+r),t.xa.add(n),IS(t))}function IS(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Jt(fn.fromString(e)),n=t.qa.next();t.Na.set(n,new pX(r)),t.Oa=t.Oa.insert(r,n),f6(t.remoteStore,new oA(ll(_x(r.path)),n,"TargetPurposeLimboResolution",sl.oe))}}async function Fx(t,e,r){const n=Sr(t),s=[],a=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(A=>{var u;if((A||r)&&n.isPrimaryClient){const d=A?!A.fromCache:(u=r==null?void 0:r.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(A){s.push(A);const d=gS.Wi(c.targetId,A);a.push(d)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(c,A){const u=Sr(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>mt.forEach(A,f=>mt.forEach(f.$i,h=>u.persistence.referenceDelegate.addReference(d,f.targetId,h)).next(()=>mt.forEach(f.Ui,h=>u.persistence.referenceDelegate.removeReference(d,f.targetId,h)))))}catch(d){if(!md(d))throw d;Mt("LocalStore","Failed to update sequence numbers: "+d)}for(const d of A){const f=d.targetId;if(!d.fromCache){const h=u.os.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);u.os=u.os.insert(f,p)}}}(n.localStore,a))}async function SX(t,e){const r=Sr(t);if(!r.currentUser.isEqual(e)){Mt("SyncEngine","User change. New user:",e.toKey());const n=await A6(r.localStore,e);r.currentUser=e,function(a,o){a.ka.forEach(l=>{l.forEach(c=>{c.reject(new Gt(Et.CANCELLED,o))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Fx(r,n.hs)}}function IX(t,e){const r=Sr(t),n=r.Na.get(e);if(n&&n.va)return Vr().add(n.key);{let s=Vr();const a=r.Ma.get(e);if(!a)return s;for(const o of a){const l=r.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function B6(t){const e=Sr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=N6.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IX.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=CX.bind(null,e),e.Ca.d_=dX.bind(null,e.eventManager),e.Ca.$a=hX.bind(null,e.eventManager),e}function S6(t){const e=Sr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_X.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EX.bind(null,e),e}class Qg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=my(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return c6(this.persistence,new l6,e.initialUser,this.serializer)}Ga(e){return new o6(fy.Zr,this.serializer)}Wa(e){return new d6}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qg.provider={build:()=>new Qg};class FX extends Qg{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await S6(this.Ja.syncEngine),await Ix(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return c6(this.persistence,new l6,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new xJ(n,e.asyncQueue,r)}Ha(e,r){const n=new Gz(r,this.persistence);return new qz(e.asyncQueue,n)}Ga(e){const r=PJ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Hi.withCacheSize(this.cacheSizeBytes):Hi.DEFAULT;return new pS(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,$J(),cw(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new d6}}class n2{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>dk(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=SX.bind(null,this.syncEngine),await cX(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new uX}()}createDatastore(e){const r=my(e.databaseInfo.databaseId),n=function(a){return new GJ(a)}(e.databaseInfo);return function(a,o,l,c){return new JJ(a,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,o,l){return new YJ(n,s,a,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>dk(this.syncEngine,r,0),function(){return ok.D()?new ok:new HJ}())}createSyncEngine(e,r){return function(s,a,o,l,c,A,u){const d=new gX(s,a,o,l,c,A);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=Sr(s);Mt("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Sx(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}n2.provider={build:()=>new n2};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ii("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kX{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Gt(Et.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(s,a){const o=Sr(s),l={documents:a.map(d=>Og(o.serializer,d))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,fn.emptyPath(),l,a.length),A=new Map;c.forEach(d=>{const f=YW(o.serializer,d);A.set(f.key.toString(),f)});const u=[];return a.forEach(d=>{const f=A.get(d.toString());dr(!!f),u.push(f)}),u}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new rm(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const s=Jt.fromPath(n);this.mutations.push(new oS(s,this.precondition(s)))}),await async function(n,s){const a=Sr(n),o={writes:s.map(l=>Mg(a.serializer,l))};await a.Mo("Commit",a.serializer.databaseId,fn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw ir();r=mr.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Gt(Et.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(mr.min())?cs.exists(!1):cs.updateTime(r):cs.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(mr.min()))throw new Gt(Et.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return cs.updateTime(r)}return cs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TX{constructor(e,r,n,s,a){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=s,this.deferred=a,this._u=n.maxAttempts,this.t_=new xS(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new kX(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(s=>{this.lu(s)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Nx(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!RU(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jX{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Ua.UNAUTHENTICATED,this.clientId=ZB.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{Mt("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Mt("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=CS(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function tN(t,e){t.asyncQueue.verifyOperationInProgress(),Mt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await A6(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function fk(t,e){t.asyncQueue.verifyOperationInProgress();const r=await PX(t);Mt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>lk(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>lk(e.remoteStore,s)),t._onlineComponents=e}async function PX(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Mt("FirestoreClient","Using user provided OfflineComponentProvider");try{await tN(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===Et.FAILED_PRECONDITION||s.code===Et.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Xu("Error using user provided cache. Falling back to memory cache: "+r),await tN(t,new Qg)}}else Mt("FirestoreClient","Using default OfflineComponentProvider"),await tN(t,new Qg);return t._offlineComponents}async function kS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Mt("FirestoreClient","Using user provided OnlineComponentProvider"),await fk(t,t._uninitializedComponentsProvider._online)):(Mt("FirestoreClient","Using default OnlineComponentProvider"),await fk(t,new n2))),t._onlineComponents}function RX(t){return kS(t).then(e=>e.syncEngine)}function DX(t){return kS(t).then(e=>e.datastore)}async function s2(t){const e=await kS(t),r=e.eventManager;return r.onListen=xX.bind(null,e.syncEngine),r.onUnlisten=yX.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=vX.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=bX.bind(null,e.syncEngine),r}function LX(t,e,r={}){const n=new Dl;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,c,A){const u=new FS({next:f=>{u.Za(),o.enqueueAndForget(()=>ES(a,d));const h=f.docs.has(l);!h&&f.fromCache?A.reject(new Gt(Et.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&c&&c.source==="server"?A.reject(new Gt(Et.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):A.resolve(f)},error:f=>A.reject(f)}),d=new SS(_x(l.path),u,{includeMetadataChanges:!0,_a:!0});return _S(a,d)}(await s2(t),t.asyncQueue,e,r,n)),n.promise}function UX(t,e,r={}){const n=new Dl;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,c,A){const u=new FS({next:f=>{u.Za(),o.enqueueAndForget(()=>ES(a,d)),f.fromCache&&c.source==="server"?A.reject(new Gt(Et.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):A.resolve(f)},error:f=>A.reject(f)}),d=new SS(l,u,{includeMetadataChanges:!0,_a:!0});return _S(a,d)}(await s2(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F6(t,e,r){if(!r)throw new Gt(Et.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function k6(t,e,r,n){if(e===!0&&n===!0)throw new Gt(Et.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function pk(t){if(!Jt.isDocumentKey(t))throw new Gt(Et.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gk(t){if(Jt.isDocumentKey(t))throw new Gt(Et.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function gy(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ir()}function Ba(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Gt(Et.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=gy(t);throw new Gt(Et.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Gt(Et.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Gt(Et.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}k6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=I6((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Gt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Gt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Gt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xy{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xk({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Gt(Et.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Gt(Et.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xk(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new eU;switch(n.type){case"firstParty":return new Lz(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Gt(Et.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=mk.get(r);n&&(Mt("ComponentProvider","Removing Datastore"),mk.delete(r),n.terminate())}(this),Promise.resolve()}}function T6(t,e,r,n={}){var s;const a=(t=Ba(t,xy))._getSettings(),o=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&Xu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Ua.MOCK_USER;else{l=eq(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const A=n.mockUserToken.sub||n.mockUserToken.user_id;if(!A)throw new Gt(Et.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ua(A)}t._authCredentials=new Pz(new ZL(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cc(this.firestore,e,this._query)}}class Sa{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sa(this.firestore,e,this._key)}}class hA extends Cc{constructor(e,r,n){super(e,r,_x(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sa(this.firestore,null,new Jt(e))}withConverter(e){return new hA(this.firestore,e,this._path)}}function ot(t,e,...r){if(t=Fs(t),F6("collection","path",e),t instanceof xy){const n=fn.fromString(e,...r);return gk(n),new hA(t,null,n)}{if(!(t instanceof Sa||t instanceof hA))throw new Gt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(fn.fromString(e,...r));return gk(n),new hA(t.firestore,null,n)}}function Ft(t,e,...r){if(t=Fs(t),arguments.length===1&&(e=ZB.newId()),F6("doc","path",e),t instanceof xy){const n=fn.fromString(e,...r);return pk(n),new Sa(t,null,new Jt(n))}{if(!(t instanceof Sa||t instanceof hA))throw new Gt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(fn.fromString(e,...r));return pk(n),new Sa(t.firestore,t instanceof hA?t.converter:null,new Jt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new xS(this,"async_queue_retry"),this.Vu=()=>{const n=cw();n&&Mt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=cw();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=cw();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Dl;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!md(e))throw e;Mt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw Ii("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=NS.createAndSchedule(this,e,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&ir()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function wk(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class Io extends xy{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new vk,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vk(e),this._firestoreClient=void 0,await e}}}function j6(t,e){const r=typeof t=="object"?t:VB(),n=typeof t=="string"?t:"(default)",s=MB(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=YK("firestore");a&&T6(s,...a)}return s}function Kh(t){if(t._terminated)throw new Gt(Et.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||P6(t),t._firestoreClient}function P6(t){var e,r,n;const s=t._freezeSettings(),a=function(l,c,A,u){return new fW(l,c,A,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,I6(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new jX(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function R6(t,e){Xu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return OX(t,n2.provider,{build:n=>new FX(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function OX(t,e,r){if((t=Ba(t,Io))._firestoreClient||t._terminated)throw new Gt(Et.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Gt(Et.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},P6(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rd(Ks.fromBase64String(e))}catch(r){throw new Gt(Et.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new rd(Ks.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Gt(Et.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ls(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Gt(Et.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Gt(Et.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return jr(this._lat,e._lat)||jr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MX=/^__.*__$/;class QX{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new kA(e,this.data,this.fieldMask,r,this.fieldTransforms):new tm(e,this.data,r,this.fieldTransforms)}}class D6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new kA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function L6(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ir()}}class TS{constructor(e,r,n,s,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new TS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return a2(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(L6(this.Cu)&&MX.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class VX{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||my(e)}Qu(e,r,n,s=!1){return new TS({Cu:e,methodName:r,qu:n,path:ls.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sm(t){const e=t._freezeSettings(),r=my(t._databaseId);return new VX(t._databaseId,!!e.ignoreUndefinedProperties,r)}function by(t,e,r,n,s,a={}){const o=t.Qu(a.merge||a.mergeFields?2:0,e,r,s);RS("Data must be an object, but it was:",o,n);const l=U6(n,o);let c,A;if(a.merge)c=new $i(o.fieldMask),A=o.fieldTransforms;else if(a.mergeFields){const u=[];for(const d of a.mergeFields){const f=V_(e,d,r);if(!o.contains(f))throw new Gt(Et.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);M6(u,f)||u.push(f)}c=new $i(u),A=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,A=o.fieldTransforms;return new QX(new Ha(l),c,A)}class Ny extends vy{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ny}}function jS(t,e,r,n){const s=t.Qu(1,e,r);RS("Data must be an object, but it was:",s,n);const a=[],o=Ha.empty();Vh(n,(c,A)=>{const u=DS(e,c,r);A=Fs(A);const d=s.Nu(u);if(A instanceof Ny)a.push(u);else{const f=kx(A,d);f!=null&&(a.push(u),o.set(u,f))}});const l=new $i(a);return new D6(o,l,s.fieldTransforms)}function PS(t,e,r,n,s,a){const o=t.Qu(1,e,r),l=[V_(e,n,r)],c=[s];if(a.length%2!=0)throw new Gt(Et.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<a.length;f+=2)l.push(V_(e,a[f])),c.push(a[f+1]);const A=[],u=Ha.empty();for(let f=l.length-1;f>=0;--f)if(!M6(A,l[f])){const h=l[f];let m=c[f];m=Fs(m);const p=o.Nu(h);if(m instanceof Ny)A.push(h);else{const x=kx(m,p);x!=null&&(A.push(h),u.set(h,x))}}const d=new $i(A);return new D6(u,d,o.fieldTransforms)}function HX(t,e,r,n=!1){return kx(r,t.Qu(n?4:3,e))}function kx(t,e){if(O6(t=Fs(t)))return RS("Unsupported field value:",e,t),U6(t,e);if(t instanceof vy)return function(n,s){if(!L6(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const a=[];let o=0;for(const l of n){let c=kx(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=Fs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return PW(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Vt.fromDate(n);return{timestampValue:U0(s.serializer,a)}}if(n instanceof Vt){const a=new Vt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:U0(s.serializer,a)}}if(n instanceof wy)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof rd)return{bytesValue:OU(s.serializer,n._byteString)};if(n instanceof Sa){const a=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:dS(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof yy)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return iS(l.serializer,c)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${gy(n)}`)}(t,e)}function U6(t,e){const r={};return AU(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vh(t,(n,s)=>{const a=kx(s,e.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function O6(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Vt||t instanceof wy||t instanceof rd||t instanceof Sa||t instanceof vy||t instanceof yy)}function RS(t,e,r){if(!O6(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=gy(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function V_(t,e,r){if((e=Fs(e))instanceof qh)return e._internalPath;if(typeof e=="string")return DS(t,e);throw a2("Field path arguments must be of type string or ",t,!1,void 0,r)}const KX=new RegExp("[~\\*/\\[\\]]");function DS(t,e,r){if(e.search(KX)>=0)throw a2(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new qh(...e.split("."))._internalPath}catch{throw a2(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function a2(t,e,r,n,s){const a=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(a||o)&&(c+=" (found",a&&(c+=` in field ${n}`),o&&(c+=` in document ${s}`),c+=")"),new Gt(Et.INVALID_ARGUMENT,l+t+c)}function M6(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Sa(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Cy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class qX extends i2{data(){return super.data()}}function Cy(t,e){return typeof e=="string"?DS(t,e):e instanceof qh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Gt(Et.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class LS{}class _y extends LS{}function Ut(t,e,...r){let n=[];e instanceof LS&&n.push(e),n=n.concat(r),function(a){const o=a.filter(c=>c instanceof Ey).length,l=a.filter(c=>c instanceof Tx).length;if(o>1||o>0&&l>0)throw new Gt(Et.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Tx extends _y{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Tx(e,r,n)}_apply(e){const r=this._parse(e);return H6(e._query,r),new Cc(e.firestore,e.converter,k_(e._query,r))}_parse(e){const r=sm(e.firestore);return function(a,o,l,c,A,u,d){let f;if(A.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Gt(Et.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){bk(d,u);const h=[];for(const m of d)h.push(yk(c,a,m));f={arrayValue:{values:h}}}else f=yk(c,a,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||bk(d,u),f=HX(l,o,d,u==="in"||u==="not-in");return rn.create(A,u,f)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function qt(t,e,r){const n=e,s=Cy("where",t);return Tx._create(s,n,r)}class Ey extends LS{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Ey(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Sn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let o=s;const l=a.getFlattenedFilters();for(const c of l)H6(o,c),o=k_(o,c)}(e._query,r),new Cc(e.firestore,e.converter,k_(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class By extends _y{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new By(e,r)}_apply(e){const r=function(s,a,o){if(s.startAt!==null)throw new Gt(Et.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Gt(Et.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Dg(a,o)}(e._query,this._field,this._direction);return new Cc(e.firestore,e.converter,function(s,a){const o=s.explicitOrderBy.concat([a]);return new em(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Hr(t,e="asc"){const r=e,n=Cy("orderBy",t);return By._create(n,r)}class Sy extends _y{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Sy(e,r,n)}_apply(e){return new Cc(e.firestore,e.converter,Yw(e._query,this._limit,this._limitType))}}function V6(t){return Sy._create("limit",t,"F")}function yk(t,e,r){if(typeof(r=Fs(r))=="string"){if(r==="")throw new Gt(Et.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!bU(e)&&r.indexOf("/")!==-1)throw new Gt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(fn.fromString(r));if(!Jt.isDocumentKey(n))throw new Gt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Pg(t,new Jt(n))}if(r instanceof Sa)return Pg(t,r._key);throw new Gt(Et.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gy(r)}.`)}function bk(t,e){if(!Array.isArray(t)||t.length===0)throw new Gt(Et.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function H6(t,e){const r=function(s,a){for(const o of s)for(const l of o.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Gt(Et.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Gt(Et.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class US{convertValue(e,r="none"){switch(_h(e)){case 0:return null;case 1:return e.booleanValue;case 2:return as(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Yu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ir()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Vh(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,s;const a=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>as(o.doubleValue));return new yy(a)}convertGeoPoint(e){return new wy(as(e.latitude),as(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=sS(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Tg(e));default:return null}}convertTimestamp(e){const r=EA(e);return new Vt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=fn.fromString(e);dr(WU(n));const s=new Zu(n.get(1),n.get(3)),a=new Jt(n.popFirst(5));return s.isEqual(r)||Ii(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class GX extends US{constructor(e){super(),this.firestore=e}convertBytes(e){return new rd(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Sa(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fy extends i2{constructor(e,r,n,s,a,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Qp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Cy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Qp extends Fy{data(e={}){return super.data(e)}}class OS{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Yd(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Qp(this._firestore,this._userDataWriter,n.key,n,new Yd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Gt(Et.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Qp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Yd(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>a||l.type!==3).map(l=>{const c=new Qp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Yd(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let A=-1,u=-1;return l.type!==0&&(A=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),u=o.indexOf(l.doc.key)),{type:$X(l.type),doc:c,oldIndex:A,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function $X(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ir()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(t){t=Ba(t,Sa);const e=Ba(t.firestore,Io);return LX(Kh(e),t._key).then(r=>q6(e,t,r))}class ky extends US{constructor(e){super(),this.firestore=e}convertBytes(e){return new rd(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Sa(this.firestore,null,r)}}function bt(t){t=Ba(t,Cc);const e=Ba(t.firestore,Io),r=Kh(e),n=new ky(e);return Q6(t._query),UX(r,t._query).then(s=>new OS(e,n,t,s))}function K6(t,e,r){t=Ba(t,Sa);const n=Ba(t.firestore,Io),s=Iy(t.converter,e,r);return am(n,[by(sm(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,cs.none())])}function Fr(t,e,r,...n){t=Ba(t,Sa);const s=Ba(t.firestore,Io),a=sm(s);let o;return o=typeof(e=Fs(e))=="string"||e instanceof qh?PS(a,"updateDoc",t._key,e,r,n):jS(a,"updateDoc",t._key,e),am(s,[o.toMutation(t._key,cs.exists(!0))])}function mn(t){return am(Ba(t.firestore,Io),[new rm(t._key,cs.none())])}function zr(t,e){const r=Ba(t.firestore,Io),n=Ft(t),s=Iy(t.converter,e);return am(r,[by(sm(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,cs.exists(!1))]).then(()=>n)}function M0(t,...e){var r,n,s;t=Fs(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||wk(e[o])||(a=e[o],o++);const l={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(wk(e[o])){const d=e[o];e[o]=(r=d.next)===null||r===void 0?void 0:r.bind(d),e[o+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),e[o+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let c,A,u;if(t instanceof Sa)A=Ba(t.firestore,Io),u=_x(t._key.path),c={next:d=>{e[o]&&e[o](q6(A,t,d))},error:e[o+1],complete:e[o+2]};else{const d=Ba(t,Cc);A=Ba(d.firestore,Io),u=d._query;const f=new ky(A);c={next:h=>{e[o]&&e[o](new OS(A,f,d,h))},error:e[o+1],complete:e[o+2]},Q6(t._query)}return function(f,h,m,p){const x=new FS(p),g=new SS(h,x,m);return f.asyncQueue.enqueueAndForget(async()=>_S(await s2(f),g)),()=>{x.Za(),f.asyncQueue.enqueueAndForget(async()=>ES(await s2(f),g))}}(Kh(A),u,l,c)}function am(t,e){return function(n,s){const a=new Dl;return n.asyncQueue.enqueueAndForget(async()=>NX(await RX(n),s,a)),a.promise}(Kh(t),e)}function q6(t,e,r){const n=r.docs.get(e._key),s=new ky(t);return new Fy(t,s,e._key,n,new Yd(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zX={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=sm(e)}set(e,r,n){this._verifyNotCommitted();const s=Nu(e,this._firestore),a=Iy(s.converter,r,n),o=by(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,cs.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const a=Nu(e,this._firestore);let o;return o=typeof(r=Fs(r))=="string"||r instanceof qh?PS(this._dataReader,"WriteBatch.update",a._key,r,n,s):jS(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(o.toMutation(a._key,cs.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Nu(e,this._firestore);return this._mutations=this._mutations.concat(new rm(r._key,cs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Gt(Et.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Nu(t,e){if((t=Fs(t)).firestore!==e)throw new Gt(Et.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6 extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=sm(r)}get(r){const n=Nu(r,this._firestore),s=new GX(this._firestore);return this._transaction.lookup([n._key]).then(a=>{if(!a||a.length!==1)return ir();const o=a[0];if(o.isFoundDocument())return new i2(this._firestore,s,o.key,o,n.converter);if(o.isNoDocument())return new i2(this._firestore,s,n._key,null,n.converter);throw ir()})}set(r,n,s){const a=Nu(r,this._firestore),o=Iy(a.converter,n,s),l=by(this._dataReader,"Transaction.set",a._key,o,a.converter!==null,s);return this._transaction.set(a._key,l),this}update(r,n,s,...a){const o=Nu(r,this._firestore);let l;return l=typeof(n=Fs(n))=="string"||n instanceof qh?PS(this._dataReader,"Transaction.update",o._key,n,s,a):jS(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=Nu(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=Nu(e,this._firestore),n=new ky(this._firestore);return super.get(e).then(s=>new Fy(this._firestore,n,r._key,s._document,new Yd(!1,!1),r.converter))}}function Na(t,e,r){t=Ba(t,Io);const n=Object.assign(Object.assign({},zX),r);return function(a){if(a.maxAttempts<1)throw new Gt(Et.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(a,o,l){const c=new Dl;return a.asyncQueue.enqueueAndForget(async()=>{const A=await DX(a);new TX(a.asyncQueue,A,l,o,c).au()}),c.promise}(Kh(t),s=>e(new $6(t,s)),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(t){return Kh(t=Ba(t,Io)),new G6(t,e=>am(t,e))}(function(e,r=!0){(function(s){Z0=s})(X0),k0(new yh("firestore",(n,{instanceIdentifier:s,options:a})=>{const o=n.getProvider("app").getImmediate(),l=new Io(new Rz(n.getProvider("auth-internal")),new Oz(n.getProvider("app-check-internal")),function(A,u){if(!Object.prototype.hasOwnProperty.apply(A.options,["projectId"]))throw new Gt(Et.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zu(A.options.projectId,u)}(o,s),o);return a=Object.assign({useFetchStreams:r},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),Ku(fF,"4.7.3",e),Ku(fF,"4.7.3","esm2017")})();const WX=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:US,Bytes:rd,CollectionReference:hA,DocumentReference:Sa,DocumentSnapshot:Fy,FieldPath:qh,FieldValue:vy,Firestore:Io,FirestoreError:Gt,GeoPoint:wy,Query:Cc,QueryCompositeFilterConstraint:Ey,QueryConstraint:_y,QueryDocumentSnapshot:Qp,QueryFieldFilterConstraint:Tx,QueryLimitConstraint:Sy,QueryOrderByConstraint:By,QuerySnapshot:OS,SnapshotMetadata:Yd,Timestamp:Vt,Transaction:$6,VectorValue:yy,WriteBatch:G6,_AutoId:ZB,_ByteString:Ks,_DatabaseId:Zu,_DocumentKey:Jt,_EmptyAuthCredentialsProvider:eU,_FieldPath:ls,_cast:Ba,_logWarn:Xu,_validateIsNotUsedTogether:k6,addDoc:zr,collection:ot,connectFirestoreEmulator:T6,deleteDoc:mn,doc:Ft,enableIndexedDbPersistence:R6,ensureFirestoreConfigured:Kh,executeWrite:am,getDoc:za,getDocs:bt,getFirestore:j6,limit:V6,onSnapshot:M0,orderBy:Hr,query:Ut,runTransaction:Na,setDoc:K6,updateDoc:Fr,where:qt,writeBatch:Gh},Symbol.toStringTag,{value:"Module"})),JX={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},z6=QB(JX),Re=j6(z6),Ty=GL(z6);R6(Re).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function XX(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,a]=N.useState(!1),[o,l]=N.useState(""),[c,A]=N.useState(!1),u=ey(),d=h=>{if(localStorage.setItem("role",h),h==="admin")return u("/admin");if(h==="vendedor_pollo")return u("/admin/salesV2");if(h==="vendedor_ropa")return u("/admin/salesClothes");if(h==="vendedor_dulces")return u("/admin/salesCandies")},f=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{A(!0);const m=await x$(Ty,t,r),p=m.user.uid,x=await za(Ft(Re,"users",p));if(!x.exists()){l("Tu usuario no tiene perfil en la base de datos.");return}const g=x.data(),y=g.role||"",b=g.name||"";if(!["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].includes(y)){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),b&&localStorage.setItem("user_name",b),d(y)}catch(m){const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas.":p==="auth/user-not-found"?"Usuario no encontrado.":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde.":(m==null?void 0:m.message)||"Error al iniciar sesin.")}finally{A(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:f,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:s?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>a(h=>!h),children:s?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function $r({children:t,allowedRoles:e}){const[r,n]=N.useState(!0),[s,a]=N.useState(!1);return N.useEffect(()=>{const o=PL(Ty,async l=>{if(l){const c=Ft(Re,"users",l.uid),A=await za(c);if(A.exists()){const u=A.data().role;a(e.includes(u))}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):s?t:i.jsx(Ud,{to:"/"})}function YX({role:t}){const e="/admin",r=({isActive:z})=>`block rounded px-3 py-2 text-sm ${z?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,n=ey(),[s,a]=N.useState(!1),[o,l]=N.useState(!1),[c,A]=N.useState(!1),[u,d]=N.useState(!1),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[x,g]=N.useState(!1),[y,b]=N.useState(!1),[F,j]=N.useState(!1),[R,E]=N.useState(!1),[S,B]=N.useState(!1),[U,k]=N.useState(!1),[T,L]=N.useState(!1),[Y,me]=N.useState(!1),[ae,fe]=N.useState(!1),[de,Z]=N.useState(!1),xe=async()=>{await RL(Ty),n("/")},Be=({open:z,onClick:O,children:te})=>i.jsxs("button",{type:"button",onClick:O,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:te}),i.jsx("span",{className:"text-xs",children:z?"":""})]}),I=({open:z,onClick:O,title:te})=>i.jsxs("button",{type:"button",onClick:O,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:te}),i.jsx("span",{className:"text-xs",children:z?"":""})]}),C=t==="admin",Q=t==="vendedor_pollo"||t==="vendedor",M=t==="vendedor_ropa",D=t==="vendedor_dulces";return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>a(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[C&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Be,{open:o,onClick:()=>l(z=>!z),children:"Pollos Bea"}),o&&i.jsxs("div",{className:"pb-2",children:[i.jsx(I,{open:c,onClick:()=>A(z=>!z),title:"Inventarios"}),c&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/batches`,className:r,children:"Inventario Pollo"}),i.jsx(Er,{to:`${e}/paidBatches`,className:r,children:"Inventarios Pagados"})]}),i.jsx(I,{open:u,onClick:()=>d(z=>!z),title:"Finanzas"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/financialDashboard`,className:r,children:"Dashboard"}),i.jsx(Er,{to:`${e}/billing`,className:r,children:"Facturacion"}),i.jsx(Er,{to:`${e}/expenses`,className:r,children:"Gastos"}),i.jsx(Er,{to:`${e}/salesV2`,className:r,children:"Venta"}),i.jsx(Er,{to:`${e}/bills`,className:r,children:"Cierre"}),i.jsx(Er,{to:`${e}/billhistoric`,className:r,children:"Historial de Cierres"})]}),i.jsx(I,{open:f,onClick:()=>h(z=>!z),title:"Productos"}),f&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/products`,className:r,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Be,{open:m,onClick:()=>p(z=>!z),children:"Chiqui Look"}),m&&i.jsxs("div",{className:"pb-2",children:[i.jsx(I,{open:x,onClick:()=>g(z=>!z),title:"Inventario"}),x&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/InventoryClothesBatches`,className:r,children:"Inventario Ropa"})}),i.jsx(I,{open:y,onClick:()=>b(z=>!z),title:"Productos"}),y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),i.jsx(I,{open:F,onClick:()=>j(z=>!z),title:"Clientes"}),F&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})}),i.jsx(I,{open:R,onClick:()=>E(z=>!z),title:"Finanzas"}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"})}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/financialDashboardClothes`,className:r,children:"Dashboard Financiero"})}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})}),R&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/ExpensesClothes`,className:r,children:"Gastos Ropa"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Be,{open:U,onClick:()=>k(z=>!z),children:"CandyShop"}),U&&i.jsxs("div",{className:"pb-2",children:[i.jsx(I,{open:Y,onClick:()=>me(z=>!z),title:"Vendedores"}),Y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),Y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsVendorsCandies`,className:r,children:"Sub ordenes"})}),i.jsx(I,{open:T,onClick:()=>L(z=>!z),title:"Inventario"}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/mainordersCandies`,className:r,children:"Ordenes Maestras"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/inventoryMainOrderCandies`,className:r,children:"Lista de Ordenes"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/inventoryCandies`,className:r,children:"Lista Productos"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsCandies`,className:r,children:"Productos"})}),i.jsx(I,{open:ae,onClick:()=>fe(z=>!z),title:"Finanzas"}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/datacenter`,className:r,children:"Data Center"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/transactionCandies`,className:r,children:"Transacciones"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/reporteCierresCandies`,className:r,children:"Reporte Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/billingsCandies`,className:r,children:"Facturas"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/consolidatedVendors`,className:r,children:"Consolidado Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/dashboardCandies`,className:r,children:"Dashboard"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/customersCandies`,className:r,children:"Clientes"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/vendorsCandies`,className:r,children:"Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/expensesCandies`,className:r,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Be,{open:de,onClick:()=>Z(z=>!z),children:"Operaciones Otras"}),de&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/users`,className:r,children:"Usuarios"}),i.jsx(Er,{to:`${e}/fix`,className:r,children:"Fix de lotes"}),i.jsx(Er,{to:`${e}/transactionclose`,className:r,children:"Liquidaciones"})]})]})]}),Q&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Be,{open:u,onClick:()=>d(z=>!z),children:"Finanzas (Pollo)"}),u&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/salesV2`,className:r,children:"Venta"}),i.jsx(Er,{to:`${e}/bills`,className:r,children:"Cierre"})]})]}),D&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/transactionCandies`,className:r,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsVendorsCandies`,className:r,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/customersCandies`,className:r,children:"Clientes"})})]}),M&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Be,{open:m,onClick:()=>p(z=>!z),children:"Operaciones Ropa"}),m&&i.jsxs("div",{className:"pb-2",children:[i.jsx(I,{open:R,onClick:()=>E(z=>!z),title:"Ventas"}),R&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"}),i.jsx(Er,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})]}),i.jsx(I,{open:y,onClick:()=>b(z=>!z),title:"Productos"}),y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),i.jsx(I,{open:F,onClick:()=>j(z=>!z),title:"Clientes"}),F&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:xe,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(uK,{})})]})}const W6=6048e5,ZX=864e5,Nk=Symbol.for("constructDateFrom");function Vl(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Nk in t?t[Nk](e):t instanceof Date?new t.constructor(e):new Date(e)}function Ri(t,e){return Vl(e||t,t)}function eY(t,e,r){const n=Ri(t,r==null?void 0:r.in);return isNaN(e)?Vl(t,NaN):(n.setDate(n.getDate()+e),n)}function tY(t,e,r){const n=Ri(t,r==null?void 0:r.in);if(isNaN(e))return Vl(t,NaN);const s=n.getDate(),a=Vl(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const o=a.getDate();return s>=o?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}let rY={};function jy(){return rY}function Vg(t,e){var l,c,A,u;const r=jy(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(A=r.locale)==null?void 0:A.options)==null?void 0:u.weekStartsOn)??0,s=Ri(t,e==null?void 0:e.in),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function o2(t,e){return Vg(t,{...e,weekStartsOn:1})}function J6(t,e){const r=Ri(t,e==null?void 0:e.in),n=r.getFullYear(),s=Vl(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=o2(s),o=Vl(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=o2(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function Ck(t){const e=Ri(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function nY(t,...e){const r=Vl.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function _k(t,e){const r=Ri(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function sY(t,e,r){const[n,s]=nY(r==null?void 0:r.in,t,e),a=_k(n),o=_k(s),l=+a-Ck(a),c=+o-Ck(o);return Math.round((l-c)/ZX)}function aY(t,e){const r=J6(t,e),n=Vl(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),o2(n)}function iY(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function oY(t){return!(!iY(t)&&typeof t!="number"||isNaN(+Ri(t)))}function _c(t,e){const r=Ri(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Ec(t,e){const r=Ri(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function lY(t,e){const r=Ri(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const cY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},AY=(t,e,r)=>{let n;const s=cY[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function rN(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const uY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},dY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fY={date:rN({formats:uY,defaultWidth:"full"}),time:rN({formats:dY,defaultWidth:"full"}),dateTime:rN({formats:hY,defaultWidth:"full"})},mY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},pY=(t,e,r,n)=>mY[t];function Gm(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return s[a]}}const gY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},wY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},yY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},bY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},NY=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},CY={ordinalNumber:NY,era:Gm({values:gY,defaultWidth:"wide"}),quarter:Gm({values:xY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Gm({values:vY,defaultWidth:"wide"}),day:Gm({values:wY,defaultWidth:"wide"}),dayPeriod:Gm({values:yY,defaultWidth:"wide",formattingValues:bY,defaultFormattingWidth:"wide"})};function $m(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?EY(l,d=>d.test(o)):_Y(l,d=>d.test(o));let A;A=t.valueCallback?t.valueCallback(c):c,A=r.valueCallback?r.valueCallback(A):A;const u=e.slice(o.length);return{value:A,rest:u}}}function _Y(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function EY(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function BY(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const SY=/^(\d+)(th|st|nd|rd)?/i,IY=/\d+/i,FY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kY={any:[/^b/i,/^(a|c)/i]},TY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},jY={any:[/1/i,/2/i,/3/i,/4/i]},PY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},RY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},LY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},UY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},OY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},MY={ordinalNumber:BY({matchPattern:SY,parsePattern:IY,valueCallback:t=>parseInt(t,10)}),era:$m({matchPatterns:FY,defaultMatchWidth:"wide",parsePatterns:kY,defaultParseWidth:"any"}),quarter:$m({matchPatterns:TY,defaultMatchWidth:"wide",parsePatterns:jY,defaultParseWidth:"any",valueCallback:t=>t+1}),month:$m({matchPatterns:PY,defaultMatchWidth:"wide",parsePatterns:RY,defaultParseWidth:"any"}),day:$m({matchPatterns:DY,defaultMatchWidth:"wide",parsePatterns:LY,defaultParseWidth:"any"}),dayPeriod:$m({matchPatterns:UY,defaultMatchWidth:"any",parsePatterns:OY,defaultParseWidth:"any"})},QY={code:"en-US",formatDistance:AY,formatLong:fY,formatRelative:pY,localize:CY,match:MY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function VY(t,e){const r=Ri(t,e==null?void 0:e.in);return sY(r,lY(r))+1}function HY(t,e){const r=Ri(t,e==null?void 0:e.in),n=+o2(r)-+aY(r);return Math.round(n/W6)+1}function X6(t,e){var u,d,f,h;const r=Ri(t,e==null?void 0:e.in),n=r.getFullYear(),s=jy(),a=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(f=s.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,o=Vl((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Vg(o,e),c=Vl((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const A=Vg(c,e);return+r>=+l?n+1:+r>=+A?n:n-1}function KY(t,e){var l,c,A,u;const r=jy(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(A=r.locale)==null?void 0:A.options)==null?void 0:u.firstWeekContainsDate)??1,s=X6(t,e),a=Vl((e==null?void 0:e.in)||t,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),Vg(a,e)}function qY(t,e){const r=Ri(t,e==null?void 0:e.in),n=+Vg(r,e)-+KY(r,e);return Math.round(n/W6)+1}function _n(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const su={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return _n(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):_n(r+1,2)},d(t,e){return _n(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return _n(t.getHours()%12||12,e.length)},H(t,e){return _n(t.getHours(),e.length)},m(t,e){return _n(t.getMinutes(),e.length)},s(t,e){return _n(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return _n(s,e.length)}},vf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ek={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return su.y(t,e)},Y:function(t,e,r,n){const s=X6(t,n),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return _n(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):_n(a,e.length)},R:function(t,e){const r=J6(t);return _n(r,e.length)},u:function(t,e){const r=t.getFullYear();return _n(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return _n(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return _n(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return su.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return _n(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=qY(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):_n(s,e.length)},I:function(t,e,r){const n=HY(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):_n(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):su.d(t,e)},D:function(t,e,r){const n=VY(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):_n(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return _n(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return _n(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return _n(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=vf.noon:n===0?s=vf.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=vf.evening:n>=12?s=vf.afternoon:n>=4?s=vf.morning:s=vf.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return su.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):su.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):_n(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):_n(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):su.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):su.s(t,e)},S:function(t,e){return su.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Sk(n);case"XXXX":case"XX":return Qd(n);case"XXXXX":case"XXX":default:return Qd(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return Sk(n);case"xxxx":case"xx":return Qd(n);case"xxxxx":case"xxx":default:return Qd(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Bk(n,":");case"OOOO":default:return"GMT"+Qd(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Bk(n,":");case"zzzz":default:return"GMT"+Qd(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return _n(n,e.length)},T:function(t,e,r){return _n(+t,e.length)}};function Bk(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+e+_n(a,2)}function Sk(t,e){return t%60===0?(t>0?"-":"+")+_n(Math.abs(t)/60,2):Qd(t,e)}function Qd(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=_n(Math.trunc(n/60),2),a=_n(n%60,2);return r+s+e+a}const Ik=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Y6=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},GY=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Ik(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",Ik(n,e)).replace("{{time}}",Y6(s,e))},$Y={p:Y6,P:GY},zY=/^D+$/,WY=/^Y+$/,JY=["D","DD","YY","YYYY"];function XY(t){return zY.test(t)}function YY(t){return WY.test(t)}function ZY(t,e,r){const n=eZ(t,e,r);if(console.warn(n),JY.includes(t))throw new RangeError(n)}function eZ(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const tZ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,rZ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,nZ=/^'([^]*?)'?$/,sZ=/''/g,aZ=/[a-zA-Z]/;function or(t,e,r){var u,d,f,h;const n=jy(),s=n.locale??QY,a=n.firstWeekContainsDate??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??0,l=Ri(t,r==null?void 0:r.in);if(!oY(l))throw new RangeError("Invalid time value");let c=e.match(rZ).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=$Y[p];return x(m,s.formatLong)}return m}).join("").match(tZ).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:iZ(m)};if(Ek[p])return{isToken:!0,value:m};if(p.match(aZ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const A={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(YY(p)||XY(p))&&ZY(p,e,String(t));const x=Ek[p[0]];return x(l,p,s.localize,A)}).join("")}function iZ(t){const e=t.match(nZ);return e?e[1].replace(sZ,"'"):t}function Z6(t,e,r){return eY(t,-14,r)}function oZ(t,e,r){return tY(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var H_=function(t,e){return H_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},H_(t,e)};function Gl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");H_(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var K_=function(){return K_=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},K_.apply(this,arguments)};function _i(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{A(n.next(u))}catch(d){o(d)}}function c(u){try{A(n.throw(u))}catch(d){o(d)}}function A(u){u.done?a(u.value):s(u.value).then(l,c)}A((n=n.apply(t,[])).next())})}function ii(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(A){return function(u){return c([A,u])}}function c(A){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(a=A[0]&2?s.return:A[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,A[1])).done)return a;switch(s=0,a&&(A=[A[0]&2,a.value]),A[0]){case 0:case 1:a=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,s=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!a||A[1]>a[0]&&A[1]<a[3])){r.label=A[1];break}if(A[0]===6&&r.label<a[1]){r.label=a[1],a=A;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(A);break}a[2]&&r.ops.pop(),r.trys.pop();continue}A=e.call(t,r)}catch(u){A=[6,u],s=0}finally{n=a=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function j1(t,e,r){if(arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||e)}var BA=function(){function t(e,r,n,s){this.left=e,this.top=r,this.width=n,this.height=s}return t.prototype.add=function(e,r,n,s){return new t(this.left+e,this.top+r,this.width+n,this.height+s)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(s){return s.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),Py=function(t,e){return BA.fromClientRect(t,e.getBoundingClientRect())},lZ=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),s=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new BA(0,0,n,s)},Ry=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=t.charCodeAt(r++);(a&64512)===56320?e.push(((s&1023)<<10)+(a&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},Us=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},Fk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var P1=0;P1<Fk.length;P1++)cZ[Fk.charCodeAt(P1)]=P1;var kk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mp=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var R1=0;R1<kk.length;R1++)mp[kk.charCodeAt(R1)]=R1;var AZ=function(t){var e=t.length*.75,r=t.length,n,s=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=mp[t.charCodeAt(n)],o=mp[t.charCodeAt(n+1)],l=mp[t.charCodeAt(n+2)],c=mp[t.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},uZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},dZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},ah=5,MS=11,nN=2,hZ=MS-ah,eO=65536>>ah,fZ=1<<ah,sN=fZ-1,mZ=1024>>ah,pZ=eO+mZ,gZ=pZ,xZ=32,vZ=gZ+xZ,wZ=65536>>MS,yZ=1<<hZ,bZ=yZ-1,Tk=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},NZ=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},CZ=function(t,e){var r=AZ(t),n=Array.isArray(r)?dZ(r):new Uint32Array(r),s=Array.isArray(r)?uZ(r):new Uint16Array(r),a=24,o=Tk(s,a/2,n[4]/2),l=n[5]===2?Tk(s,(a+n[4])/2):NZ(n,Math.ceil((a+n[4])/4));return new _Z(n[0],n[1],n[2],n[3],o,l)},_Z=function(){function t(e,r,n,s,a,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>ah],r=(r<<nN)+(e&sN),this.data[r];if(e<=65535)return r=this.index[eO+(e-55296>>ah)],r=(r<<nN)+(e&sN),this.data[r];if(e<this.highStart)return r=vZ-wZ+(e>>MS),r=this.index[r],r+=e>>ah&bZ,r=this.index[r],r=(r<<nN)+(e&sN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),jk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",EZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var D1=0;D1<jk.length;D1++)EZ[jk.charCodeAt(D1)]=D1;var BZ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Pk=50,SZ=1,tO=2,rO=3,IZ=4,FZ=5,Rk=7,nO=8,Dk=9,Su=10,q_=11,Lk=12,G_=13,kZ=14,pp=15,$_=16,L1=17,zm=18,TZ=19,Uk=20,z_=21,Wm=22,aN=23,wf=24,go=25,gp=26,xp=27,yf=28,jZ=29,$d=30,PZ=31,U1=32,O1=33,W_=34,J_=35,X_=36,Hg=37,Y_=38,Aw=39,uw=40,iN=41,sO=42,RZ=43,DZ=[9001,65288],aO="!",en="",M1="",Z_=CZ(BZ),Kc=[$d,X_],eE=[SZ,tO,rO,FZ],iO=[Su,nO],Ok=[xp,gp],LZ=eE.concat(iO),Mk=[Y_,Aw,uw,W_,J_],UZ=[pp,G_],OZ=function(t,e){e===void 0&&(e="strict");var r=[],n=[],s=[];return t.forEach(function(a,o){var l=Z_.get(a);if(l>Pk?(s.push(!0),l-=Pk):s.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(a)!==-1)return n.push(o),r.push($_);if(l===IZ||l===q_){if(o===0)return n.push(o),r.push($d);var c=r[o-1];return LZ.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push($d))}if(n.push(o),l===PZ)return r.push(e==="strict"?z_:Hg);if(l===sO||l===jZ)return r.push($d);if(l===RZ)return a>=131072&&a<=196605||a>=196608&&a<=262141?r.push(Hg):r.push($d);r.push(l)}),[n,r,s]},oN=function(t,e,r,n){var s=n[r];if(Array.isArray(t)?t.indexOf(s)!==-1:t===s)for(var a=r;a<=n.length;){a++;var o=n[a];if(o===e)return!0;if(o!==Su)break}if(s===Su)for(var a=r;a>0;){a--;var l=n[a];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==Su)break}if(l!==Su)break}return!1},Qk=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===Su)r--;else return n}return 0},MZ=function(t,e,r,n,s){if(r[n]===0)return en;var a=n-1;if(Array.isArray(s)&&s[a]===!0)return en;var o=a-1,l=a+1,c=e[a],A=o>=0?e[o]:0,u=e[l];if(c===tO&&u===rO)return en;if(eE.indexOf(c)!==-1)return aO;if(eE.indexOf(u)!==-1||iO.indexOf(u)!==-1)return en;if(Qk(a,e)===nO)return M1;if(Z_.get(t[a])===q_||(c===U1||c===O1)&&Z_.get(t[l])===q_||c===Rk||u===Rk||c===Dk||[Su,G_,pp].indexOf(c)===-1&&u===Dk||[L1,zm,TZ,wf,yf].indexOf(u)!==-1||Qk(a,e)===Wm||oN(aN,Wm,a,e)||oN([L1,zm],z_,a,e)||oN(Lk,Lk,a,e))return en;if(c===Su)return M1;if(c===aN||u===aN)return en;if(u===$_||c===$_)return M1;if([G_,pp,z_].indexOf(u)!==-1||c===kZ||A===X_&&UZ.indexOf(c)!==-1||c===yf&&u===X_||u===Uk||Kc.indexOf(u)!==-1&&c===go||Kc.indexOf(c)!==-1&&u===go||c===xp&&[Hg,U1,O1].indexOf(u)!==-1||[Hg,U1,O1].indexOf(c)!==-1&&u===gp||Kc.indexOf(c)!==-1&&Ok.indexOf(u)!==-1||Ok.indexOf(c)!==-1&&Kc.indexOf(u)!==-1||[xp,gp].indexOf(c)!==-1&&(u===go||[Wm,pp].indexOf(u)!==-1&&e[l+1]===go)||[Wm,pp].indexOf(c)!==-1&&u===go||c===go&&[go,yf,wf].indexOf(u)!==-1)return en;if([go,yf,wf,L1,zm].indexOf(u)!==-1)for(var d=a;d>=0;){var f=e[d];if(f===go)return en;if([yf,wf].indexOf(f)!==-1)d--;else break}if([xp,gp].indexOf(u)!==-1)for(var d=[L1,zm].indexOf(c)!==-1?o:a;d>=0;){var f=e[d];if(f===go)return en;if([yf,wf].indexOf(f)!==-1)d--;else break}if(Y_===c&&[Y_,Aw,W_,J_].indexOf(u)!==-1||[Aw,W_].indexOf(c)!==-1&&[Aw,uw].indexOf(u)!==-1||[uw,J_].indexOf(c)!==-1&&u===uw||Mk.indexOf(c)!==-1&&[Uk,gp].indexOf(u)!==-1||Mk.indexOf(u)!==-1&&c===xp||Kc.indexOf(c)!==-1&&Kc.indexOf(u)!==-1||c===wf&&Kc.indexOf(u)!==-1||Kc.concat(go).indexOf(c)!==-1&&u===Wm&&DZ.indexOf(t[l])===-1||Kc.concat(go).indexOf(u)!==-1&&c===zm)return en;if(c===iN&&u===iN){for(var h=r[a],m=1;h>0&&(h--,e[h]===iN);)m++;if(m%2!==0)return en}return c===U1&&u===O1?en:M1},QZ=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=OZ(t,e.lineBreak),n=r[0],s=r[1],a=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(s=s.map(function(l){return[go,$d,sO].indexOf(l)!==-1?Hg:l}));var o=e.wordBreak==="keep-all"?a.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,s,o]},VZ=function(){function t(e,r,n,s){this.codePoints=e,this.required=r===aO,this.start=n,this.end=s}return t.prototype.slice=function(){return Us.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),HZ=function(t,e){var r=Ry(t),n=QZ(r,e),s=n[0],a=n[1],o=n[2],l=r.length,c=0,A=0;return{next:function(){if(A>=l)return{done:!0,value:null};for(var u=en;A<l&&(u=MZ(r,a,s,++A,o))===en;);if(u!==en||A===l){var d=new VZ(r,u,c,A);return c=A,{value:d,done:!1}}return{done:!0,value:null}}}},KZ=1,qZ=2,jx=4,Vk=8,l2=10,Hk=47,Vp=92,GZ=9,$Z=32,Q1=34,Jm=61,zZ=35,WZ=36,JZ=37,V1=39,H1=40,Xm=41,XZ=95,Ki=45,YZ=33,ZZ=60,eee=62,tee=64,ree=91,nee=93,see=61,aee=123,K1=63,iee=125,Kk=124,oee=126,lee=128,qk=65533,lN=42,Zd=43,cee=44,Aee=58,uee=59,Kg=46,dee=0,hee=8,fee=11,mee=14,pee=31,gee=127,ac=-1,oO=48,lO=97,cO=101,xee=102,vee=117,wee=122,AO=65,uO=69,dO=70,yee=85,bee=90,ci=function(t){return t>=oO&&t<=57},Nee=function(t){return t>=55296&&t<=57343},bf=function(t){return ci(t)||t>=AO&&t<=dO||t>=lO&&t<=xee},Cee=function(t){return t>=lO&&t<=wee},_ee=function(t){return t>=AO&&t<=bee},Eee=function(t){return Cee(t)||_ee(t)},Bee=function(t){return t>=lee},q1=function(t){return t===l2||t===GZ||t===$Z},c2=function(t){return Eee(t)||Bee(t)||t===XZ},Gk=function(t){return c2(t)||ci(t)||t===Ki},See=function(t){return t>=dee&&t<=hee||t===fee||t>=mee&&t<=pee||t===gee},mu=function(t,e){return t!==Vp?!1:e!==l2},G1=function(t,e,r){return t===Ki?c2(e)||mu(e,r):c2(t)?!0:!!(t===Vp&&mu(t,e))},cN=function(t,e,r){return t===Zd||t===Ki?ci(e)?!0:e===Kg&&ci(r):ci(t===Kg?e:t)},Iee=function(t){var e=0,r=1;(t[e]===Zd||t[e]===Ki)&&(t[e]===Ki&&(r=-1),e++);for(var n=[];ci(t[e]);)n.push(t[e++]);var s=n.length?parseInt(Us.apply(void 0,n),10):0;t[e]===Kg&&e++;for(var a=[];ci(t[e]);)a.push(t[e++]);var o=a.length,l=o?parseInt(Us.apply(void 0,a),10):0;(t[e]===uO||t[e]===cO)&&e++;var c=1;(t[e]===Zd||t[e]===Ki)&&(t[e]===Ki&&(c=-1),e++);for(var A=[];ci(t[e]);)A.push(t[e++]);var u=A.length?parseInt(Us.apply(void 0,A),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*u)},Fee={type:2},kee={type:3},Tee={type:4},jee={type:13},Pee={type:8},Ree={type:21},Dee={type:9},Lee={type:10},Uee={type:11},Oee={type:12},Mee={type:14},$1={type:23},Qee={type:1},Vee={type:25},Hee={type:24},Kee={type:26},qee={type:27},Gee={type:28},$ee={type:29},zee={type:31},tE={type:32},hO=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(Ry(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==tE;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Q1:return this.consumeStringToken(Q1);case zZ:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(Gk(r)||mu(n,s)){var a=G1(r,n,s)?qZ:KZ,o=this.consumeName();return{type:5,value:o,flags:a}}break;case WZ:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),jee;break;case V1:return this.consumeStringToken(V1);case H1:return Fee;case Xm:return kee;case lN:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Mee;break;case Zd:if(cN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case cee:return Tee;case Ki:var l=e,c=this.peekCodePoint(0),A=this.peekCodePoint(1);if(cN(l,c,A))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(G1(l,c,A))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===Ki&&A===eee)return this.consumeCodePoint(),this.consumeCodePoint(),Hee;break;case Kg:if(cN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case Hk:if(this.peekCodePoint(0)===lN)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===lN&&(u=this.consumeCodePoint(),u===Hk))return this.consumeToken();if(u===ac)return this.consumeToken()}break;case Aee:return Kee;case uee:return qee;case ZZ:if(this.peekCodePoint(0)===YZ&&this.peekCodePoint(1)===Ki&&this.peekCodePoint(2)===Ki)return this.consumeCodePoint(),this.consumeCodePoint(),Vee;break;case tee:var d=this.peekCodePoint(0),f=this.peekCodePoint(1),h=this.peekCodePoint(2);if(G1(d,f,h)){var o=this.consumeName();return{type:7,value:o}}break;case ree:return Gee;case Vp:if(mu(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case nee:return $ee;case see:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Pee;break;case aee:return Uee;case iee:return Oee;case vee:case yee:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===Zd&&(bf(p)||p===K1)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case Kk:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Dee;if(this.peekCodePoint(0)===Kk)return this.consumeCodePoint(),Ree;break;case oee:if(this.peekCodePoint(0)===Jm)return this.consumeCodePoint(),Lee;break;case ac:return tE}return q1(e)?(this.consumeWhiteSpace(),zee):ci(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):c2(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Us(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();bf(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===K1&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(Us.apply(void 0,e.map(function(c){return c===K1?oO:c})),16),a=parseInt(Us.apply(void 0,e.map(function(c){return c===K1?dO:c})),16);return{type:30,start:s,end:a}}var o=parseInt(Us.apply(void 0,e),16);if(this.peekCodePoint(0)===Ki&&bf(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];bf(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var a=parseInt(Us.apply(void 0,l),16);return{type:30,start:o,end:a}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===H1?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===H1?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ac)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===V1||r===Q1){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ac||this.peekCodePoint(0)===Xm)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),$1)}for(;;){var s=this.consumeCodePoint();if(s===ac||s===Xm)return{type:22,value:Us.apply(void 0,e)};if(q1(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ac||this.peekCodePoint(0)===Xm?(this.consumeCodePoint(),{type:22,value:Us.apply(void 0,e)}):(this.consumeBadUrlRemnants(),$1);if(s===Q1||s===V1||s===H1||See(s))return this.consumeBadUrlRemnants(),$1;if(s===Vp)if(mu(s,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),$1;else e.push(s)}},t.prototype.consumeWhiteSpace=function(){for(;q1(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===Xm||e===ac)return;mu(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var s=Math.min(r,e);n+=Us.apply(void 0,this._value.splice(0,s)),e-=s}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var s=this._value[n];if(s===ac||s===void 0||s===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(s===l2)return this._value.splice(0,n),Qee;if(s===Vp){var a=this._value[n+1];a!==ac&&a!==void 0&&(a===l2?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):mu(s,a)&&(r+=this.consumeStringSlice(n),r+=Us(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=jx,n=this.peekCodePoint(0);for((n===Zd||n===Ki)&&e.push(this.consumeCodePoint());ci(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===Kg&&ci(s))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Vk;ci(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var a=this.peekCodePoint(2);if((n===uO||n===cO)&&((s===Zd||s===Ki)&&ci(a)||ci(s)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Vk;ci(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[Iee(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],s=this.peekCodePoint(0),a=this.peekCodePoint(1),o=this.peekCodePoint(2);if(G1(s,a,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return s===JZ?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(bf(e)){for(var r=Us(e);bf(this.peekCodePoint(0))&&r.length<6;)r+=Us(this.consumeCodePoint());q1(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||Nee(n)||n>1114111?qk:n}return e===ac?qk:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(Gk(r))e+=Us(r);else if(mu(r,this.peekCodePoint(0)))e+=Us(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),fO=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new hO;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||Jee(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?tE:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Px=function(t){return t.type===15},im=function(t){return t.type===17},Tn=function(t){return t.type===20},Wee=function(t){return t.type===0},rE=function(t,e){return Tn(t)&&t.value===e},mO=function(t){return t.type!==31},Q0=function(t){return t.type!==31&&t.type!==4},Bc=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},Jee=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},nd=function(t){return t.type===17||t.type===15},Js=function(t){return t.type===16||nd(t)},pO=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},qa={type:17,number:0,flags:jx},QS={type:16,number:50,flags:jx},Iu={type:16,number:100,flags:jx},vp=function(t,e,r){var n=t[0],s=t[1];return[qn(n,e),qn(typeof s<"u"?s:n,r)]},qn=function(t,e){if(t.type===16)return t.number/100*e;if(Px(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},gO="deg",xO="grad",vO="rad",wO="turn",Dy={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case gO:return Math.PI*e.number/180;case xO:return Math.PI/200*e.number;case vO:return e.number;case wO:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},yO=function(t){return t.type===15&&(t.unit===gO||t.unit===xO||t.unit===vO||t.unit===wO)},bO=function(t){var e=t.filter(Tn).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[qa,qa];case"to top":case"bottom":return al(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[qa,Iu];case"to right":case"left":return al(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Iu,Iu];case"to bottom":case"top":return al(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Iu,qa];case"to left":case"right":return al(270)}return 0},al=function(t){return Math.PI*t/180},Gu={name:"color",parse:function(t,e){if(e.type===18){var r=Xee[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),s=e.value.substring(1,2),a=e.value.substring(2,3);return Fu(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),s=e.value.substring(1,2),a=e.value.substring(2,3),o=e.value.substring(3,4);return Fu(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),s=e.value.substring(2,4),a=e.value.substring(4,6);return Fu(parseInt(n,16),parseInt(s,16),parseInt(a,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),s=e.value.substring(2,4),a=e.value.substring(4,6),o=e.value.substring(6,8);return Fu(parseInt(n,16),parseInt(s,16),parseInt(a,16),parseInt(o,16)/255)}}if(e.type===20){var l=fA[e.value.toUpperCase()];if(typeof l<"u")return l}return fA.TRANSPARENT}},$u=function(t){return(255&t)===0},xa=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,s=255&t>>24;return e<255?"rgba("+s+","+n+","+r+","+e/255+")":"rgb("+s+","+n+","+r+")"},Fu=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},$k=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},zk=function(t,e){var r=e.filter(Q0);if(r.length===3){var n=r.map($k),s=n[0],a=n[1],o=n[2];return Fu(s,a,o,1)}if(r.length===4){var l=r.map($k),s=l[0],a=l[1],o=l[2],c=l[3];return Fu(s,a,o,c)}return 0};function AN(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var Wk=function(t,e){var r=e.filter(Q0),n=r[0],s=r[1],a=r[2],o=r[3],l=(n.type===17?al(n.number):Dy.parse(t,n))/(Math.PI*2),c=Js(s)?s.number/100:0,A=Js(a)?a.number/100:0,u=typeof o<"u"&&Js(o)?qn(o,1):1;if(c===0)return Fu(A*255,A*255,A*255,1);var d=A<=.5?A*(c+1):A+c-A*c,f=A*2-d,h=AN(f,d,l+1/3),m=AN(f,d,l),p=AN(f,d,l-1/3);return Fu(h*255,m*255,p*255,u)},Xee={hsl:Wk,hsla:Wk,rgb:zk,rgba:zk},Hp=function(t,e){return Gu.parse(t,fO.create(e).parseComponentValue())},fA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Yee={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Tn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Zee={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ly=function(t,e){var r=Gu.parse(t,e[0]),n=e[1];return n&&Js(n)?{color:r,stop:n}:{color:r,stop:null}},Jk=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=qa),n.stop===null&&(n.stop=Iu);for(var s=[],a=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=qn(l,e);c>a?s.push(c):s.push(a),a=c}else s.push(null)}for(var A=null,o=0;o<s.length;o++){var u=s[o];if(u===null)A===null&&(A=o);else if(A!==null){for(var d=o-A,f=s[A-1],h=(u-f)/(d+1),m=1;m<=d;m++)s[A+m-1]=h*m;A=null}}return t.map(function(p,x){var g=p.color;return{color:g,stop:Math.max(Math.min(1,s[x]/e),0)}})},ete=function(t,e,r){var n=e/2,s=r/2,a=qn(t[0],e)-n,o=s-qn(t[1],r);return(Math.atan2(o,a)+Math.PI*2)%(Math.PI*2)},tte=function(t,e,r){var n=typeof t=="number"?t:ete(t,e,r),s=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),a=e/2,o=r/2,l=s/2,c=Math.sin(n-Math.PI/2)*l,A=Math.cos(n-Math.PI/2)*l;return[s,a-A,a+A,o-c,o+c]},Sl=function(t,e){return Math.sqrt(t*t+e*e)},Xk=function(t,e,r,n,s){var a=[[0,0],[0,e],[t,0],[t,e]];return a.reduce(function(o,l){var c=l[0],A=l[1],u=Sl(r-c,n-A);return(s?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:l,optimumDistance:u}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},rte=function(t,e,r,n,s){var a=0,o=0;switch(t.size){case 0:t.shape===0?a=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(a=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(t.shape===0)a=o=Math.min(Sl(e,r),Sl(e,r-s),Sl(e-n,r),Sl(e-n,r-s));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(e),Math.abs(e-n)),c=Xk(n,s,e,r,!0),A=c[0],u=c[1];a=Sl(A-e,(u-r)/l),o=l*a}break;case 1:t.shape===0?a=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(a=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(t.shape===0)a=o=Math.max(Sl(e,r),Sl(e,r-s),Sl(e-n,r),Sl(e-n,r-s));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(e),Math.abs(e-n)),d=Xk(n,s,e,r,!1),A=d[0],u=d[1];a=Sl(A-e,(u-r)/l),o=l*a}break}return Array.isArray(t.size)&&(a=qn(t.size[0],n),o=t.size.length===2?qn(t.size[1],s):a),[a,o]},nte=function(t,e){var r=al(180),n=[];return Bc(e).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&o.value==="to"){r=bO(s);return}else if(yO(o)){r=Dy.parse(t,o);return}}var l=Ly(t,s);n.push(l)}),{angle:r,stops:n,type:1}},z1=function(t,e){var r=al(180),n=[];return Bc(e).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=bO(s);return}else if(yO(o)){r=(Dy.parse(t,o)+al(270))%al(360);return}}var l=Ly(t,s);n.push(l)}),{angle:r,stops:n,type:1}},ste=function(t,e){var r=al(180),n=[],s=1,a=0,o=3,l=[];return Bc(e).forEach(function(c,A){var u=c[0];if(A===0){if(Tn(u)&&u.value==="linear"){s=1;return}else if(Tn(u)&&u.value==="radial"){s=2;return}}if(u.type===18){if(u.name==="from"){var d=Gu.parse(t,u.values[0]);n.push({stop:qa,color:d})}else if(u.name==="to"){var d=Gu.parse(t,u.values[0]);n.push({stop:Iu,color:d})}else if(u.name==="color-stop"){var f=u.values.filter(Q0);if(f.length===2){var d=Gu.parse(t,f[1]),h=f[0];im(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:d})}}}}),s===1?{angle:(r+al(180))%al(360),stops:n,type:s}:{size:o,shape:a,stops:n,position:l,type:s}},NO="closest-side",CO="farthest-side",_O="closest-corner",EO="farthest-corner",BO="circle",SO="ellipse",IO="cover",FO="contain",ate=function(t,e){var r=0,n=3,s=[],a=[];return Bc(e).forEach(function(o,l){var c=!0;if(l===0){var A=!1;c=o.reduce(function(d,f){if(A)if(Tn(f))switch(f.value){case"center":return a.push(QS),d;case"top":case"left":return a.push(qa),d;case"right":case"bottom":return a.push(Iu),d}else(Js(f)||nd(f))&&a.push(f);else if(Tn(f))switch(f.value){case BO:return r=0,!1;case SO:return r=1,!1;case"at":return A=!0,!1;case NO:return n=0,!1;case IO:case CO:return n=1,!1;case FO:case _O:return n=2,!1;case EO:return n=3,!1}else if(nd(f)||Js(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)}if(c){var u=Ly(t,o);s.push(u)}}),{size:n,shape:r,stops:s,position:a,type:2}},W1=function(t,e){var r=0,n=3,s=[],a=[];return Bc(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(u,d){if(Tn(d))switch(d.value){case"center":return a.push(QS),!1;case"top":case"left":return a.push(qa),!1;case"right":case"bottom":return a.push(Iu),!1}else if(Js(d)||nd(d))return a.push(d),!1;return u},c):l===1&&(c=o.reduce(function(u,d){if(Tn(d))switch(d.value){case BO:return r=0,!1;case SO:return r=1,!1;case FO:case NO:return n=0,!1;case CO:return n=1,!1;case _O:return n=2,!1;case IO:case EO:return n=3,!1}else if(nd(d)||Js(d))return Array.isArray(n)||(n=[]),n.push(d),!1;return u},c)),c){var A=Ly(t,o);s.push(A)}}),{size:n,shape:r,stops:s,position:a,type:2}},ite=function(t){return t.type===1},ote=function(t){return t.type===2},VS={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=kO[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function lte(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!kO[t.name])}var kO={"linear-gradient":nte,"-moz-linear-gradient":z1,"-ms-linear-gradient":z1,"-o-linear-gradient":z1,"-webkit-linear-gradient":z1,"radial-gradient":ate,"-moz-radial-gradient":W1,"-ms-radial-gradient":W1,"-o-radial-gradient":W1,"-webkit-radial-gradient":W1,"-webkit-gradient":ste},cte={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Q0(n)&&lte(n)}).map(function(n){return VS.parse(t,n)})}},Ate={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Tn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},ute={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Bc(e).map(function(r){return r.filter(Js)}).map(pO)}},dte={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Bc(e).map(function(r){return r.filter(Tn).map(function(n){return n.value}).join(" ")}).map(hte)}},hte=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},x0;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(x0||(x0={}));var fte={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Bc(e).map(function(r){return r.filter(mte)})}},mte=function(t){return Tn(t)||Js(t)},Uy=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},pte=Uy("top"),gte=Uy("right"),xte=Uy("bottom"),vte=Uy("left"),Oy=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return pO(r.filter(Js))}}},wte=Oy("top-left"),yte=Oy("top-right"),bte=Oy("bottom-right"),Nte=Oy("bottom-left"),My=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Cte=My("top"),_te=My("right"),Ete=My("bottom"),Bte=My("left"),Qy=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Px(r)?r.number:0}}},Ste=Qy("top"),Ite=Qy("right"),Fte=Qy("bottom"),kte=Qy("left"),Tte={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},jte={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Pte={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Tn).reduce(function(r,n){return r|Rte(n.value)},0)}},Rte=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Dte={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Lte={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},A2;(function(t){t.NORMAL="normal",t.STRICT="strict"})(A2||(A2={}));var Ute={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return A2.STRICT;case"normal":default:return A2.NORMAL}}},Ote={name:"line-height",initialValue:"normal",prefix:!1,type:4},Yk=function(t,e){return Tn(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:Js(t)?qn(t,e):e},Mte={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:VS.parse(t,e)}},Qte={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},nE={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Vy=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},Vte=Vy("top"),Hte=Vy("right"),Kte=Vy("bottom"),qte=Vy("left"),Gte={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Tn).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},$te={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},Hy=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},zte=Hy("top"),Wte=Hy("right"),Jte=Hy("bottom"),Xte=Hy("left"),Yte={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Zte={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},ere={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&rE(e[0],"none")?[]:Bc(e).map(function(r){for(var n={color:fA.TRANSPARENT,offsetX:qa,offsetY:qa,blur:qa},s=0,a=0;a<r.length;a++){var o=r[a];nd(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:n.blur=o,s++):n.color=Gu.parse(t,o)}return n})}},tre={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},rre={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=are[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},nre=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},sre=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var s=e[4],a=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,s,a,o,l]:null},are={matrix:nre,matrix3d:sre},Zk={type:16,number:50,flags:jx},ire=[Zk,Zk],ore={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(Js);return r.length!==2?ire:[r[0],r[1]]}},lre={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Kp;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Kp||(Kp={}));var cre={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Kp.BREAK_ALL;case"keep-all":return Kp.KEEP_ALL;case"normal":default:return Kp.NORMAL}}},Are={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(im(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},TO={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},ure={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return im(e)?e.number:1}},dre={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},hre={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Tn).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},fre={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},mre={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},pre={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(im(e))return e.number;if(Tn(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},gre={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Tn).map(function(r){return r.value})}},xre={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},la=function(t,e){return(t&e)!==0},vre={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},wre={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],s=e.filter(mO),a=0;a<s.length;a++){var o=s[a],l=s[a+1];if(o.type===20){var c=l&&im(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},yre={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(mO),s=0;s<n.length;s++){var a=n[s],o=n[s+1];if(Tn(a)&&a.value!=="none"){var l=o&&im(o)?o.number:0;r.push({counter:a.value,reset:l})}}return r}},bre={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Px).map(function(r){return TO.parse(t,r)})}},Nre={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],s=e.filter(Wee);if(s.length%2!==0)return null;for(var a=0;a<s.length;a+=2){var o=s[a].value,l=s[a+1].value;n.push({open:o,close:l})}return n}},eT=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},Cre={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&rE(e[0],"none")?[]:Bc(e).map(function(r){for(var n={color:255,offsetX:qa,offsetY:qa,blur:qa,spread:qa,inset:!1},s=0,a=0;a<r.length;a++){var o=r[a];rE(o,"inset")?n.inset=!0:nd(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:s===2?n.blur=o:n.spread=o,s++):n.color=Gu.parse(t,o)}return n})}},_re={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(Tn).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},Ere={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Bre={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Px(e)?e.number:0}},Sre=function(){function t(e,r){var n,s;this.animationDuration=er(e,bre,r.animationDuration),this.backgroundClip=er(e,Yee,r.backgroundClip),this.backgroundColor=er(e,Zee,r.backgroundColor),this.backgroundImage=er(e,cte,r.backgroundImage),this.backgroundOrigin=er(e,Ate,r.backgroundOrigin),this.backgroundPosition=er(e,ute,r.backgroundPosition),this.backgroundRepeat=er(e,dte,r.backgroundRepeat),this.backgroundSize=er(e,fte,r.backgroundSize),this.borderTopColor=er(e,pte,r.borderTopColor),this.borderRightColor=er(e,gte,r.borderRightColor),this.borderBottomColor=er(e,xte,r.borderBottomColor),this.borderLeftColor=er(e,vte,r.borderLeftColor),this.borderTopLeftRadius=er(e,wte,r.borderTopLeftRadius),this.borderTopRightRadius=er(e,yte,r.borderTopRightRadius),this.borderBottomRightRadius=er(e,bte,r.borderBottomRightRadius),this.borderBottomLeftRadius=er(e,Nte,r.borderBottomLeftRadius),this.borderTopStyle=er(e,Cte,r.borderTopStyle),this.borderRightStyle=er(e,_te,r.borderRightStyle),this.borderBottomStyle=er(e,Ete,r.borderBottomStyle),this.borderLeftStyle=er(e,Bte,r.borderLeftStyle),this.borderTopWidth=er(e,Ste,r.borderTopWidth),this.borderRightWidth=er(e,Ite,r.borderRightWidth),this.borderBottomWidth=er(e,Fte,r.borderBottomWidth),this.borderLeftWidth=er(e,kte,r.borderLeftWidth),this.boxShadow=er(e,Cre,r.boxShadow),this.color=er(e,Tte,r.color),this.direction=er(e,jte,r.direction),this.display=er(e,Pte,r.display),this.float=er(e,Dte,r.cssFloat),this.fontFamily=er(e,fre,r.fontFamily),this.fontSize=er(e,mre,r.fontSize),this.fontStyle=er(e,xre,r.fontStyle),this.fontVariant=er(e,gre,r.fontVariant),this.fontWeight=er(e,pre,r.fontWeight),this.letterSpacing=er(e,Lte,r.letterSpacing),this.lineBreak=er(e,Ute,r.lineBreak),this.lineHeight=er(e,Ote,r.lineHeight),this.listStyleImage=er(e,Mte,r.listStyleImage),this.listStylePosition=er(e,Qte,r.listStylePosition),this.listStyleType=er(e,nE,r.listStyleType),this.marginTop=er(e,Vte,r.marginTop),this.marginRight=er(e,Hte,r.marginRight),this.marginBottom=er(e,Kte,r.marginBottom),this.marginLeft=er(e,qte,r.marginLeft),this.opacity=er(e,ure,r.opacity);var a=er(e,Gte,r.overflow);this.overflowX=a[0],this.overflowY=a[a.length>1?1:0],this.overflowWrap=er(e,$te,r.overflowWrap),this.paddingTop=er(e,zte,r.paddingTop),this.paddingRight=er(e,Wte,r.paddingRight),this.paddingBottom=er(e,Jte,r.paddingBottom),this.paddingLeft=er(e,Xte,r.paddingLeft),this.paintOrder=er(e,_re,r.paintOrder),this.position=er(e,Zte,r.position),this.textAlign=er(e,Yte,r.textAlign),this.textDecorationColor=er(e,dre,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=er(e,hre,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=er(e,ere,r.textShadow),this.textTransform=er(e,tre,r.textTransform),this.transform=er(e,rre,r.transform),this.transformOrigin=er(e,ore,r.transformOrigin),this.visibility=er(e,lre,r.visibility),this.webkitTextStrokeColor=er(e,Ere,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=er(e,Bre,r.webkitTextStrokeWidth),this.wordBreak=er(e,cre,r.wordBreak),this.zIndex=er(e,Are,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return $u(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return la(this.display,4)||la(this.display,33554432)||la(this.display,268435456)||la(this.display,536870912)||la(this.display,67108864)||la(this.display,134217728)},t}(),Ire=function(){function t(e,r){this.content=er(e,vre,r.content),this.quotes=er(e,Nre,r.quotes)}return t}(),tT=function(){function t(e,r){this.counterIncrement=er(e,wre,r.counterIncrement),this.counterReset=er(e,yre,r.counterReset)}return t}(),er=function(t,e,r){var n=new hO,s=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(s);var a=new fO(n.read());switch(e.type){case 2:var o=a.parseComponentValue();return e.parse(t,Tn(o)?o.value:e.initialValue);case 0:return e.parse(t,a.parseComponentValue());case 1:return e.parse(t,a.parseComponentValues());case 4:return a.parseComponentValue();case 3:switch(e.format){case"angle":return Dy.parse(t,a.parseComponentValue());case"color":return Gu.parse(t,a.parseComponentValue());case"image":return VS.parse(t,a.parseComponentValue());case"length":var l=a.parseComponentValue();return nd(l)?l:qa;case"length-percentage":var c=a.parseComponentValue();return Js(c)?c:qa;case"time":return TO.parse(t,a.parseComponentValue())}break}},Fre="data-html2canvas-debug",kre=function(t){var e=t.getAttribute(Fre);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},sE=function(t,e){var r=kre(t);return r===1||e===r},Sc=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,sE(r,3))debugger;this.styles=new Sre(e,window.getComputedStyle(r,null)),oE(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Py(this.context,r),sE(r,4)&&(this.flags|=16)}return t}(),Tre="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",rT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wp=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var J1=0;J1<rT.length;J1++)wp[rT.charCodeAt(J1)]=J1;var jre=function(t){var e=t.length*.75,r=t.length,n,s=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=wp[t.charCodeAt(n)],o=wp[t.charCodeAt(n+1)],l=wp[t.charCodeAt(n+2)],c=wp[t.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},Pre=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},Rre=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},ih=5,HS=11,uN=2,Dre=HS-ih,jO=65536>>ih,Lre=1<<ih,dN=Lre-1,Ure=1024>>ih,Ore=jO+Ure,Mre=Ore,Qre=32,Vre=Mre+Qre,Hre=65536>>HS,Kre=1<<Dre,qre=Kre-1,nT=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Gre=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},$re=function(t,e){var r=jre(t),n=Array.isArray(r)?Rre(r):new Uint32Array(r),s=Array.isArray(r)?Pre(r):new Uint16Array(r),a=24,o=nT(s,a/2,n[4]/2),l=n[5]===2?nT(s,(a+n[4])/2):Gre(n,Math.ceil((a+n[4])/4));return new zre(n[0],n[1],n[2],n[3],o,l)},zre=function(){function t(e,r,n,s,a,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>ih],r=(r<<uN)+(e&dN),this.data[r];if(e<=65535)return r=this.index[jO+(e-55296>>ih)],r=(r<<uN)+(e&dN),this.data[r];if(e<this.highStart)return r=Vre-Hre+(e>>HS),r=this.index[r],r+=e>>ih&qre,r=this.index[r],r=(r<<uN)+(e&dN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),sT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wre=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var X1=0;X1<sT.length;X1++)Wre[sT.charCodeAt(X1)]=X1;var Jre=1,hN=2,fN=3,aT=4,iT=5,Xre=7,oT=8,mN=9,pN=10,lT=11,cT=12,AT=13,uT=14,gN=15,Yre=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=t.charCodeAt(r++);(a&64512)===56320?e.push(((s&1023)<<10)+(a&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},Zre=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},ene=$re(Tre),Xo="",xN="",tne=function(t){return ene.get(t)},rne=function(t,e,r){var n=r-2,s=e[n],a=e[r-1],o=e[r];if(a===hN&&o===fN)return Xo;if(a===hN||a===fN||a===aT||o===hN||o===fN||o===aT)return xN;if(a===oT&&[oT,mN,lT,cT].indexOf(o)!==-1||(a===lT||a===mN)&&(o===mN||o===pN)||(a===cT||a===pN)&&o===pN||o===AT||o===iT||o===Xre||a===Jre)return Xo;if(a===AT&&o===uT){for(;s===iT;)s=e[--n];if(s===uT)return Xo}if(a===gN&&o===gN){for(var l=0;s===gN;)l++,s=e[--n];if(l%2===0)return Xo}return xN},nne=function(t){var e=Yre(t),r=e.length,n=0,s=0,a=e.map(tne);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=Xo;n<r&&(o=rne(e,a,++n))===Xo;);if(o!==Xo||n===r){var l=Zre.apply(null,e.slice(s,n));return s=n,{value:l,done:!1}}return{done:!0,value:null}}}},sne=function(t){for(var e=nne(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},ane=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),a=Math.round(s.height);if(t.body.removeChild(n),a===e)return!0}}return!1},ine=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,s=Ry(n.data).map(function(c){return Us(c)}),a=0,o={},l=s.every(function(c,A){r.setStart(n,a),r.setEnd(n,a+c.length);var u=r.getBoundingClientRect();a+=c.length;var d=u.x>o.x||u.y>o.y;return o=u,A===0?!0:d});return t.body.removeChild(e),l},one=function(){return typeof new Image().crossOrigin<"u"},lne=function(){return typeof new XMLHttpRequest().responseType=="string"},cne=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},dT=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},Ane=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,a=e.toDataURL();s.src=a;var o=aE(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),hT(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var A=t.createElement("div");return A.style.backgroundImage="url("+a+")",A.style.height=r+"px",dT(c)?hT(aE(r,r,0,0,A)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),dT(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},aE=function(t,e,r,n,s){var a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"svg"),l=document.createElementNS(a,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},hT=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},La={get SUPPORT_RANGE_BOUNDS(){var t=ane(document);return Object.defineProperty(La,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=La.SUPPORT_RANGE_BOUNDS&&ine(document);return Object.defineProperty(La,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=cne(document);return Object.defineProperty(La,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?Ane(document):Promise.resolve(!1);return Object.defineProperty(La,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=one();return Object.defineProperty(La,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=lne();return Object.defineProperty(La,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(La,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(La,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},qp=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),une=function(t,e,r,n){var s=fne(e,r),a=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(La.SUPPORT_RANGE_BOUNDS){var c=fT(n,o,l.length).getClientRects();if(c.length>1){var A=KS(l),u=0;A.forEach(function(f){a.push(new qp(f,BA.fromDOMRectList(t,fT(n,u+o,f.length).getClientRects()))),u+=f.length})}else a.push(new qp(l,BA.fromDOMRectList(t,c)))}else{var d=n.splitText(l.length);a.push(new qp(l,dne(t,n))),n=d}else La.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),a},dne=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var s=e.parentNode;if(s){s.replaceChild(n,e);var a=Py(t,n);return n.firstChild&&s.replaceChild(n.firstChild,n),a}}return BA.EMPTY},fT=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(t,e),s.setEnd(t,e+r),s},KS=function(t){if(La.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return sne(t)},hne=function(t,e){if(La.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return pne(t,e)},fne=function(t,e){return e.letterSpacing!==0?KS(t):hne(t,e)},mne=[32,160,4961,65792,65793,4153,4241],pne=function(t,e){for(var r=HZ(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],s,a=function(){if(s.value){var o=s.value.slice(),l=Ry(o),c="";l.forEach(function(A){mne.indexOf(A)===-1?c+=Us(A):(c.length&&n.push(c),n.push(Us(A)),c="")}),c.length&&n.push(c)}};!(s=r.next()).done;)a();return n},gne=function(){function t(e,r,n){this.text=xne(r.data,n.textTransform),this.textBounds=une(e,this.text,n,r)}return t}(),xne=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(vne,wne);case 2:return t.toUpperCase();default:return t}},vne=/(^|\s|:|-|\(|\))([a-z])/g,wne=function(t,e,r){return t.length>0?e+r.toUpperCase():t},PO=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return e}(Sc),RO=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return e}(Sc),DO=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this,a=new XMLSerializer,o=Py(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(a.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return e}(Sc),LO=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Sc),iE=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return e}(Sc),yne=[{type:15,flags:0,unit:"px",number:3}],bne=[{type:16,flags:0,number:50}],Nne=function(t){return t.width>t.height?new BA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new BA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},Cne=function(t){var e=t.type===_ne?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},u2="checkbox",d2="radio",_ne="password",mT=707406591,qS=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=Cne(n),(s.type===u2||s.type===d2)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=Nne(s.bounds)),s.type){case u2:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=yne;break;case d2:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=bne;break}return s}return e}(Sc),UO=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this,a=n.options[n.selectedIndex||0];return s.value=a&&a.text||"",s}return e}(Sc),OO=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Sc),MO=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=VO(r,n.contentWindow.document.documentElement);var a=n.contentWindow.document.documentElement?Hp(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):fA.TRANSPARENT,o=n.contentWindow.document.body?Hp(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):fA.TRANSPARENT;s.backgroundColor=$u(a)?$u(o)?s.styles.backgroundColor:o:a}}catch{}return s}return e}(Sc),Ene=["OL","UL","MENU"],dw=function(t,e,r,n){for(var s=e.firstChild,a=void 0;s;s=a)if(a=s.nextSibling,HO(s)&&s.data.trim().length>0)r.textNodes.push(new gne(t,s,r.styles));else if(i0(s))if($O(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return dw(t,l,r,n)});else{var o=QO(t,s);o.styles.isVisible()&&(Bne(s,o,n)?o.flags|=4:Sne(o.styles)&&(o.flags|=2),Ene.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?dw(t,s.shadowRoot,o,n):!h2(s)&&!KO(s)&&!f2(s)&&dw(t,s,o,n))}},QO=function(t,e){return lE(e)?new PO(t,e):qO(e)?new RO(t,e):KO(e)?new DO(t,e):Ine(e)?new LO(t,e):Fne(e)?new iE(t,e):kne(e)?new qS(t,e):f2(e)?new UO(t,e):h2(e)?new OO(t,e):GO(e)?new MO(t,e):new Sc(t,e)},VO=function(t,e){var r=QO(t,e);return r.flags|=4,dw(t,e,r,r),r},Bne=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||GS(t)&&r.styles.isTransparent()},Sne=function(t){return t.isPositioned()||t.isFloating()},HO=function(t){return t.nodeType===Node.TEXT_NODE},i0=function(t){return t.nodeType===Node.ELEMENT_NODE},oE=function(t){return i0(t)&&typeof t.style<"u"&&!hw(t)},hw=function(t){return typeof t.className=="object"},Ine=function(t){return t.tagName==="LI"},Fne=function(t){return t.tagName==="OL"},kne=function(t){return t.tagName==="INPUT"},Tne=function(t){return t.tagName==="HTML"},KO=function(t){return t.tagName==="svg"},GS=function(t){return t.tagName==="BODY"},qO=function(t){return t.tagName==="CANVAS"},pT=function(t){return t.tagName==="VIDEO"},lE=function(t){return t.tagName==="IMG"},GO=function(t){return t.tagName==="IFRAME"},gT=function(t){return t.tagName==="STYLE"},jne=function(t){return t.tagName==="SCRIPT"},h2=function(t){return t.tagName==="TEXTAREA"},f2=function(t){return t.tagName==="SELECT"},$O=function(t){return t.tagName==="SLOT"},xT=function(t){return t.tagName.indexOf("-")>0},Pne=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,s=e.counterReset,a=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(a=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return a&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),vT={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},wT={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Rne={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Dne={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Nf=function(t,e,r,n,s,a){return t<e||t>r?qg(t,s,a.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+a},zO=function(t,e,r,n){var s="";do r||t--,s=n(t)+s,t/=e;while(t*e>=e);return s},Ds=function(t,e,r,n,s){var a=r-e+1;return(t<0?"-":"")+(zO(Math.abs(t),a,n,function(o){return Us(Math.floor(o%a)+e)})+s)},kd=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return zO(Math.abs(t),n,!1,function(s){return e[Math.floor(s%n)]})+r},Vf=1,Au=2,uu=4,yp=8,qc=function(t,e,r,n,s,a){if(t<-9999||t>9999)return qg(t,4,s.length>0);var o=Math.abs(t),l=s;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var A=o%10;A===0&&la(a,Vf)&&l!==""?l=e[A]+l:A>1||A===1&&c===0||A===1&&c===1&&la(a,Au)||A===1&&c===1&&la(a,uu)&&t>100||A===1&&c>1&&la(a,yp)?l=e[A]+(c>0?r[c-1]:"")+l:A===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},yT="",bT="",NT="",vN="",qg=function(t,e,r){var n=r?". ":"",s=r?"":"",a=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Ds(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return kd(t,"",s);case 6:return Nf(t,1,3999,vT,3,n).toLowerCase();case 7:return Nf(t,1,3999,vT,3,n);case 8:return Ds(t,945,969,!1,n);case 9:return Ds(t,97,122,!1,n);case 10:return Ds(t,65,90,!1,n);case 11:return Ds(t,1632,1641,!0,n);case 12:case 49:return Nf(t,1,9999,wT,3,n);case 35:return Nf(t,1,9999,wT,3,n).toLowerCase();case 13:return Ds(t,2534,2543,!0,n);case 14:case 30:return Ds(t,6112,6121,!0,n);case 15:return kd(t,"",s);case 16:return kd(t,"",s);case 17:case 48:return qc(t,"",yT,"",s,Au|uu|yp);case 47:return qc(t,"",bT,"",s,Vf|Au|uu|yp);case 42:return qc(t,"",yT,"",s,Au|uu|yp);case 41:return qc(t,"",bT,"",s,Vf|Au|uu|yp);case 26:return qc(t,"","",NT,s,0);case 25:return qc(t,"","",NT,s,Vf|Au|uu);case 31:return qc(t,"","",vN,a,Vf|Au|uu);case 33:return qc(t,"","",vN,a,0);case 32:return qc(t,"","",vN,a,Vf|Au|uu);case 18:return Ds(t,2406,2415,!0,n);case 20:return Nf(t,1,19999,Dne,3,n);case 21:return Ds(t,2790,2799,!0,n);case 22:return Ds(t,2662,2671,!0,n);case 22:return Nf(t,1,10999,Rne,3,n);case 23:return kd(t,"");case 24:return kd(t,"");case 27:return Ds(t,3302,3311,!0,n);case 28:return kd(t,"",s);case 29:return kd(t,"",s);case 34:return Ds(t,3792,3801,!0,n);case 37:return Ds(t,6160,6169,!0,n);case 38:return Ds(t,4160,4169,!0,n);case 39:return Ds(t,2918,2927,!0,n);case 40:return Ds(t,1776,1785,!0,n);case 43:return Ds(t,3046,3055,!0,n);case 44:return Ds(t,3174,3183,!0,n);case 45:return Ds(t,3664,3673,!0,n);case 46:return Ds(t,3872,3881,!0,n);case 3:default:return Ds(t,48,57,!0,n)}},WO="data-html2canvas-ignore",CT=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new Pne,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,s=Lne(e,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var a=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=s.contentWindow,c=l.document,A=Mne(s).then(function(){return _i(n,void 0,void 0,function(){var u,d;return ii(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(Kne),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),u=this.options.onclone,d=this.clonedReferenceElement,typeof d>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,One(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,d)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(Vne(document.doctype)+"<html></html>"),Hne(this.referenceElement.ownerDocument,a,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),A},t.prototype.createElementClone=function(e){if(sE(e,2))debugger;if(qO(e))return this.createCanvasClone(e);if(pT(e))return this.createVideoClone(e);if(gT(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return lE(r)&&(lE(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),xT(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return wN(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(a,o){return o&&typeof o.cssText=="string"?a+o.cssText:a},""),s=e.cloneNode(!1);return s.textContent=n,s}}catch(a){if(this.context.logger.error("Unable to access cssRules property",a),a.name!=="SecurityError")throw a}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var s=e.cloneNode(!1);try{s.width=e.width,s.height=e.height;var a=e.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&a)o.putImageData(a.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return s},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var s=e.ownerDocument.createElement("canvas");return s.width=e.offsetWidth,s.height=e.offsetHeight,s},t.prototype.appendChildNode=function(e,r,n){(!i0(r)||!jne(r)&&!r.hasAttribute(WO)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!i0(r)||!gT(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var s=this,a=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;a;a=a.nextSibling)if(i0(a)&&$O(a)&&typeof a.assignedNodes=="function"){var o=a.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,n)})}else this.appendChildNode(r,a,n)},t.prototype.cloneNode=function(e,r){if(HO(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&i0(e)&&(oE(e)||hw(e))){var s=this.createElementClone(e);s.style.transitionProperty="none";var a=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&oE(s)&&(this.clonedReferenceElement=s),GS(s)&&$ne(s);var c=this.counters.parse(new tT(this.context,a)),A=this.resolvePseudoContent(e,s,o,Gp.BEFORE);xT(e)&&(r=!0),pT(e)||this.cloneChildNodes(e,s,r),A&&s.insertBefore(A,s.firstChild);var u=this.resolvePseudoContent(e,s,l,Gp.AFTER);return u&&s.appendChild(u),this.counters.pop(c),(a&&(this.options.copyStyles||hw(e))&&!GO(e)||r)&&wN(a,s),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([s,e.scrollLeft,e.scrollTop]),(h2(e)||f2(e))&&(h2(s)||f2(s))&&(s.value=e.value),s}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,s){var a=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new tT(this.context,n));var c=new Ire(this.context,n),A=l.createElement("html2canvaspseudoelement");wN(n,A),c.content.forEach(function(d){if(d.type===0)A.appendChild(l.createTextNode(d.value));else if(d.type===22){var f=l.createElement("img");f.src=d.value,f.style.opacity="1",A.appendChild(f)}else if(d.type===18){if(d.name==="attr"){var h=d.values.filter(Tn);h.length&&A.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(d.name==="counter"){var m=d.values.filter(Q0),p=m[0],x=m[1];if(p&&Tn(p)){var g=a.counters.getCounterValue(p.value),y=x&&Tn(x)?nE.parse(a.context,x.value):3;A.appendChild(l.createTextNode(qg(g,y,!1)))}}else if(d.name==="counters"){var b=d.values.filter(Q0),p=b[0],F=b[1],x=b[2];if(p&&Tn(p)){var j=a.counters.getCounterValues(p.value),R=x&&Tn(x)?nE.parse(a.context,x.value):3,E=F&&F.type===0?F.value:"",S=j.map(function(k){return qg(k,R,!1)}).join(E);A.appendChild(l.createTextNode(S))}}}else if(d.type===20)switch(d.value){case"open-quote":A.appendChild(l.createTextNode(eT(c.quotes,a.quoteDepth++,!0)));break;case"close-quote":A.appendChild(l.createTextNode(eT(c.quotes,--a.quoteDepth,!1)));break;default:A.appendChild(l.createTextNode(d.value))}}),A.className=cE+" "+AE;var u=s===Gp.BEFORE?" "+cE:" "+AE;return hw(r)?r.className.baseValue+=u:r.className+=u,A}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),Gp;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Gp||(Gp={}));var Lne=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(WO,"true"),t.body.appendChild(r),r},Une=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},One=function(t){return Promise.all([].slice.call(t.images,0).map(Une))},Mne=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var a=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(a),e(t))},50)}})},Qne=["all","d","content"],wN=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);Qne.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},Vne=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},Hne=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},Kne=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},qne=":before",Gne=":after",cE="___html2canvas___pseudoelement_before",AE="___html2canvas___pseudoelement_after",_T=`{
    content: "" !important;
    display: none !important;
}`,$ne=function(t){zne(t,"."+cE+qne+_T+`
         .`+AE+Gne+_T)},zne=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},JO=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),Wne=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(bN(e)||Zne(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return _i(this,void 0,void 0,function(){var r,n,s,a,o=this;return ii(this,function(l){switch(l.label){case 0:return r=JO.isSameOrigin(e),n=!yN(e)&&this._options.useCORS===!0&&La.SUPPORT_CORS_IMAGES&&!r,s=!yN(e)&&!r&&!bN(e)&&typeof this._options.proxy=="string"&&La.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!yN(e)&&!bN(e)&&!s&&!n?[2]:(a=e,s?[4,this.proxy(a)]:[3,2]);case 1:a=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,A){var u=new Image;u.onload=function(){return c(u)},u.onerror=A,(ese(a)||n)&&(u.crossOrigin="anonymous"),u.src=a,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return A("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=e.substring(0,256);return new Promise(function(a,o){var l=La.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")a(c.response);else{var d=new FileReader;d.addEventListener("load",function(){return a(d.result)},!1),d.addEventListener("error",function(f){return o(f)},!1),d.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var A=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+A+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var u=r._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+s)}}c.send()})},t}(),Jne=/^data:image\/svg\+xml/i,Xne=/^data:image\/.*;base64,/i,Yne=/^data:image\/.*/i,Zne=function(t){return La.SUPPORT_SVG_DRAWING||!tse(t)},yN=function(t){return Yne.test(t)},ese=function(t){return Xne.test(t)},bN=function(t){return t.substr(0,4)==="blob"},tse=function(t){return t.substr(-3).toLowerCase()==="svg"||Jne.test(t)},Yt=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),Cf=function(t,e,r){return new Yt(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},Y1=function(){function t(e,r,n,s){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=s}return t.prototype.subdivide=function(e,r){var n=Cf(this.start,this.startControl,e),s=Cf(this.startControl,this.endControl,e),a=Cf(this.endControl,this.end,e),o=Cf(n,s,e),l=Cf(s,a,e),c=Cf(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,a,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),rl=function(t){return t.type===1},rse=function(){function t(e){var r=e.styles,n=e.bounds,s=vp(r.borderTopLeftRadius,n.width,n.height),a=s[0],o=s[1],l=vp(r.borderTopRightRadius,n.width,n.height),c=l[0],A=l[1],u=vp(r.borderBottomRightRadius,n.width,n.height),d=u[0],f=u[1],h=vp(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((a+c)/n.width),x.push((m+d)/n.width),x.push((o+p)/n.height),x.push((A+f)/n.height);var g=Math.max.apply(Math,x);g>1&&(a/=g,o/=g,c/=g,A/=g,d/=g,f/=g,m/=g,p/=g);var y=n.width-c,b=n.height-f,F=n.width-d,j=n.height-p,R=r.borderTopWidth,E=r.borderRightWidth,S=r.borderBottomWidth,B=r.borderLeftWidth,U=qn(r.paddingTop,e.bounds.width),k=qn(r.paddingRight,e.bounds.width),T=qn(r.paddingBottom,e.bounds.width),L=qn(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=a>0||o>0?rs(n.left+B/3,n.top+R/3,a-B/3,o-R/3,xn.TOP_LEFT):new Yt(n.left+B/3,n.top+R/3),this.topRightBorderDoubleOuterBox=a>0||o>0?rs(n.left+y,n.top+R/3,c-E/3,A-R/3,xn.TOP_RIGHT):new Yt(n.left+n.width-E/3,n.top+R/3),this.bottomRightBorderDoubleOuterBox=d>0||f>0?rs(n.left+F,n.top+b,d-E/3,f-S/3,xn.BOTTOM_RIGHT):new Yt(n.left+n.width-E/3,n.top+n.height-S/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?rs(n.left+B/3,n.top+j,m-B/3,p-S/3,xn.BOTTOM_LEFT):new Yt(n.left+B/3,n.top+n.height-S/3),this.topLeftBorderDoubleInnerBox=a>0||o>0?rs(n.left+B*2/3,n.top+R*2/3,a-B*2/3,o-R*2/3,xn.TOP_LEFT):new Yt(n.left+B*2/3,n.top+R*2/3),this.topRightBorderDoubleInnerBox=a>0||o>0?rs(n.left+y,n.top+R*2/3,c-E*2/3,A-R*2/3,xn.TOP_RIGHT):new Yt(n.left+n.width-E*2/3,n.top+R*2/3),this.bottomRightBorderDoubleInnerBox=d>0||f>0?rs(n.left+F,n.top+b,d-E*2/3,f-S*2/3,xn.BOTTOM_RIGHT):new Yt(n.left+n.width-E*2/3,n.top+n.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?rs(n.left+B*2/3,n.top+j,m-B*2/3,p-S*2/3,xn.BOTTOM_LEFT):new Yt(n.left+B*2/3,n.top+n.height-S*2/3),this.topLeftBorderStroke=a>0||o>0?rs(n.left+B/2,n.top+R/2,a-B/2,o-R/2,xn.TOP_LEFT):new Yt(n.left+B/2,n.top+R/2),this.topRightBorderStroke=a>0||o>0?rs(n.left+y,n.top+R/2,c-E/2,A-R/2,xn.TOP_RIGHT):new Yt(n.left+n.width-E/2,n.top+R/2),this.bottomRightBorderStroke=d>0||f>0?rs(n.left+F,n.top+b,d-E/2,f-S/2,xn.BOTTOM_RIGHT):new Yt(n.left+n.width-E/2,n.top+n.height-S/2),this.bottomLeftBorderStroke=m>0||p>0?rs(n.left+B/2,n.top+j,m-B/2,p-S/2,xn.BOTTOM_LEFT):new Yt(n.left+B/2,n.top+n.height-S/2),this.topLeftBorderBox=a>0||o>0?rs(n.left,n.top,a,o,xn.TOP_LEFT):new Yt(n.left,n.top),this.topRightBorderBox=c>0||A>0?rs(n.left+y,n.top,c,A,xn.TOP_RIGHT):new Yt(n.left+n.width,n.top),this.bottomRightBorderBox=d>0||f>0?rs(n.left+F,n.top+b,d,f,xn.BOTTOM_RIGHT):new Yt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?rs(n.left,n.top+j,m,p,xn.BOTTOM_LEFT):new Yt(n.left,n.top+n.height),this.topLeftPaddingBox=a>0||o>0?rs(n.left+B,n.top+R,Math.max(0,a-B),Math.max(0,o-R),xn.TOP_LEFT):new Yt(n.left+B,n.top+R),this.topRightPaddingBox=c>0||A>0?rs(n.left+Math.min(y,n.width-E),n.top+R,y>n.width+E?0:Math.max(0,c-E),Math.max(0,A-R),xn.TOP_RIGHT):new Yt(n.left+n.width-E,n.top+R),this.bottomRightPaddingBox=d>0||f>0?rs(n.left+Math.min(F,n.width-B),n.top+Math.min(b,n.height-S),Math.max(0,d-E),Math.max(0,f-S),xn.BOTTOM_RIGHT):new Yt(n.left+n.width-E,n.top+n.height-S),this.bottomLeftPaddingBox=m>0||p>0?rs(n.left+B,n.top+Math.min(j,n.height-S),Math.max(0,m-B),Math.max(0,p-S),xn.BOTTOM_LEFT):new Yt(n.left+B,n.top+n.height-S),this.topLeftContentBox=a>0||o>0?rs(n.left+B+L,n.top+R+U,Math.max(0,a-(B+L)),Math.max(0,o-(R+U)),xn.TOP_LEFT):new Yt(n.left+B+L,n.top+R+U),this.topRightContentBox=c>0||A>0?rs(n.left+Math.min(y,n.width+B+L),n.top+R+U,y>n.width+B+L?0:c-B+L,A-(R+U),xn.TOP_RIGHT):new Yt(n.left+n.width-(E+k),n.top+R+U),this.bottomRightContentBox=d>0||f>0?rs(n.left+Math.min(F,n.width-(B+L)),n.top+Math.min(b,n.height+R+U),Math.max(0,d-(E+k)),f-(S+T),xn.BOTTOM_RIGHT):new Yt(n.left+n.width-(E+k),n.top+n.height-(S+T)),this.bottomLeftContentBox=m>0||p>0?rs(n.left+B+L,n.top+j,Math.max(0,m-(B+L)),p-(S+T),xn.BOTTOM_LEFT):new Yt(n.left+B+L,n.top+n.height-(S+T))}return t}(),xn;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(xn||(xn={}));var rs=function(t,e,r,n,s){var a=4*((Math.sqrt(2)-1)/3),o=r*a,l=n*a,c=t+r,A=e+n;switch(s){case xn.TOP_LEFT:return new Y1(new Yt(t,A),new Yt(t,A-l),new Yt(c-o,e),new Yt(c,e));case xn.TOP_RIGHT:return new Y1(new Yt(t,e),new Yt(t+o,e),new Yt(c,A-l),new Yt(c,A));case xn.BOTTOM_RIGHT:return new Y1(new Yt(c,e),new Yt(c,e+l),new Yt(t+o,A),new Yt(t,A));case xn.BOTTOM_LEFT:default:return new Y1(new Yt(c,A),new Yt(c-o,A),new Yt(t,e+l),new Yt(t,e))}},m2=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},nse=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},p2=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},sse=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),Z1=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),ase=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),ise=function(t){return t.type===0},XO=function(t){return t.type===1},ose=function(t){return t.type===2},ET=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},lse=function(t,e,r,n,s){return t.map(function(a,o){switch(o){case 0:return a.add(e,r);case 1:return a.add(e+n,r);case 2:return a.add(e+n,r+s);case 3:return a.add(e,r+s)}return a})},YO=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),ZO=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new rse(this.container),this.container.styles.opacity<1&&this.effects.push(new ase(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,a=this.container.styles.transform;this.effects.push(new sse(n,s,a))}if(this.container.styles.overflowX!==0){var o=m2(this.curves),l=p2(this.curves);ET(o,l)?this.effects.push(new Z1(o,6)):(this.effects.push(new Z1(o,2)),this.effects.push(new Z1(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var a=n.effects.filter(function(c){return!XO(c)});if(r||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,a),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=m2(n.curves),l=p2(n.curves);ET(o,l)||s.unshift(new Z1(l,6))}}else s.unshift.apply(s,a);n=n.parent}return s.filter(function(c){return la(c.target,e)})},t}(),uE=function(t,e,r,n){t.container.elements.forEach(function(s){var a=la(s.flags,4),o=la(s.flags,2),l=new ZO(s,t);la(s.styles.display,2048)&&n.push(l);var c=la(s.flags,8)?[]:n;if(a||o){var A=a||s.styles.isPositioned()?r:e,u=new YO(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var d=s.styles.zIndex.order;if(d<0){var f=0;A.negativeZIndex.some(function(m,p){return d>m.element.container.styles.zIndex.order?(f=p,!1):f>0}),A.negativeZIndex.splice(f,0,u)}else if(d>0){var h=0;A.positiveZIndex.some(function(m,p){return d>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),A.positiveZIndex.splice(h,0,u)}else A.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else s.styles.isFloating()?A.nonPositionedFloats.push(u):A.nonPositionedInlineLevel.push(u);uE(l,u,a?u:r,c)}else s.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),uE(l,e,r,c);la(s.flags,8)&&eM(s,c)})},eM=function(t,e){for(var r=t instanceof iE?t.start:1,n=t instanceof iE?t.reversed:!1,s=0;s<e.length;s++){var a=e[s];a.container instanceof LO&&typeof a.container.value=="number"&&a.container.value!==0&&(r=a.container.value),a.listValue=qg(r,a.container.styles.listStyleType,!0),r+=n?-1:1}},cse=function(t){var e=new ZO(t,null),r=new YO(e),n=[];return uE(e,r,r,n),eM(e.container,n),r},BT=function(t,e){switch(e){case 0:return il(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return il(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return il(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return il(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},Ase=function(t,e){switch(e){case 0:return il(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return il(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return il(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return il(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},use=function(t,e){switch(e){case 0:return il(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return il(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return il(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return il(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},dse=function(t,e){switch(e){case 0:return ev(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return ev(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return ev(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return ev(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},ev=function(t,e){var r=[];return rl(t)?r.push(t.subdivide(.5,!1)):r.push(t),rl(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},il=function(t,e,r,n){var s=[];return rl(t)?s.push(t.subdivide(.5,!1)):s.push(t),rl(r)?s.push(r.subdivide(.5,!0)):s.push(r),rl(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),rl(e)?s.push(e.subdivide(.5,!1).reverse()):s.push(e),s},tM=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},g2=function(t){var e=t.styles,r=t.bounds,n=qn(e.paddingLeft,r.width),s=qn(e.paddingRight,r.width),a=qn(e.paddingTop,r.width),o=qn(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,a+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+s),-(e.borderTopWidth+e.borderBottomWidth+a+o))},hse=function(t,e){return t===0?e.bounds:t===2?g2(e):tM(e)},fse=function(t,e){return t===0?e.bounds:t===2?g2(e):tM(e)},NN=function(t,e,r){var n=hse(Hf(t.styles.backgroundOrigin,e),t),s=fse(Hf(t.styles.backgroundClip,e),t),a=mse(Hf(t.styles.backgroundSize,e),r,n),o=a[0],l=a[1],c=vp(Hf(t.styles.backgroundPosition,e),n.width-o,n.height-l),A=pse(Hf(t.styles.backgroundRepeat,e),c,a,n,s),u=Math.round(n.left+c[0]),d=Math.round(n.top+c[1]);return[A,u,d,o,l]},_f=function(t){return Tn(t)&&t.value===x0.AUTO},tv=function(t){return typeof t=="number"},mse=function(t,e,r){var n=e[0],s=e[1],a=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(Js(o)&&l&&Js(l))return[qn(o,r.width),qn(l,r.height)];var c=tv(a);if(Tn(o)&&(o.value===x0.CONTAIN||o.value===x0.COVER)){if(tv(a)){var A=r.width/r.height;return A<a!=(o.value===x0.COVER)?[r.width,r.width/a]:[r.height*a,r.height]}return[r.width,r.height]}var u=tv(n),d=tv(s),f=u||d;if(_f(o)&&(!l||_f(l))){if(u&&d)return[n,s];if(!c&&!f)return[r.width,r.height];if(f&&c){var h=u?n:s*a,m=d?s:n/a;return[h,m]}var p=u?n:r.width,x=d?s:r.height;return[p,x]}if(c){var g=0,y=0;return Js(o)?g=qn(o,r.width):Js(l)&&(y=qn(l,r.height)),_f(o)?g=y*a:(!l||_f(l))&&(y=g/a),[g,y]}var b=null,F=null;if(Js(o)?b=qn(o,r.width):l&&Js(l)&&(F=qn(l,r.height)),b!==null&&(!l||_f(l))&&(F=u&&d?b/n*s:r.height),F!==null&&_f(o)&&(b=u&&d?F/s*n:r.width),b!==null&&F!==null)return[b,F];throw new Error("Unable to calculate background-size for element")},Hf=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},pse=function(t,e,r,n,s){var a=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new Yt(Math.round(n.left),Math.round(n.top+o)),new Yt(Math.round(n.left+n.width),Math.round(n.top+o)),new Yt(Math.round(n.left+n.width),Math.round(c+n.top+o)),new Yt(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new Yt(Math.round(n.left+a),Math.round(n.top)),new Yt(Math.round(n.left+a+l),Math.round(n.top)),new Yt(Math.round(n.left+a+l),Math.round(n.height+n.top)),new Yt(Math.round(n.left+a),Math.round(n.height+n.top))];case 1:return[new Yt(Math.round(n.left+a),Math.round(n.top+o)),new Yt(Math.round(n.left+a+l),Math.round(n.top+o)),new Yt(Math.round(n.left+a+l),Math.round(n.top+o+c)),new Yt(Math.round(n.left+a),Math.round(n.top+o+c))];default:return[new Yt(Math.round(s.left),Math.round(s.top)),new Yt(Math.round(s.left+s.width),Math.round(s.top)),new Yt(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Yt(Math.round(s.left),Math.round(s.height+s.top))]}},gse="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",ST="Hidden Text",xse=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),s=this._document.createElement("img"),a=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),s.src=gse,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",a.style.fontFamily=e,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.appendChild(this._document.createTextNode(ST)),n.appendChild(a),n.appendChild(s);var l=s.offsetTop-a.offsetTop+2;n.removeChild(a),n.appendChild(this._document.createTextNode(ST)),n.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),rM=function(){function t(e,r){this.context=e,this.options=r}return t}(),vse=1e4,wse=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new xse(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return n.applyEffect(s)})},e.prototype.applyEffect=function(r){this.ctx.save(),ose(r)&&(this.ctx.globalAlpha=r.opacity),ise(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),XO(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return _i(this,void 0,void 0,function(){var n;return ii(this,function(s){switch(s.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return _i(this,void 0,void 0,function(){return ii(this,function(n){switch(n.label){case 0:if(la(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,s){var a=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=KS(r.text);o.reduce(function(l,c){return a.ctx.fillText(c,l,r.bounds.top+s),l+a.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=_se(r.fontFamily).join(", "),a=Px(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,a,s].join(" "),s,a]},e.prototype.renderTextNode=function(r,n){return _i(this,void 0,void 0,function(){var s,a,o,l,c,A,u,d,f=this;return ii(this,function(h){return s=this.createFontStyle(n),a=s[0],o=s[1],l=s[2],this.ctx.font=a,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),A=c.baseline,u=c.middle,d=n.paintOrder,r.textBounds.forEach(function(m){d.forEach(function(p){switch(p){case 0:f.ctx.fillStyle=xa(n.color),f.renderTextWithLetterSpacing(m,n.letterSpacing,A);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(g){f.ctx.shadowColor=xa(g.color),f.ctx.shadowOffsetX=g.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=g.offsetY.number*f.options.scale,f.ctx.shadowBlur=g.blur.number,f.renderTextWithLetterSpacing(m,n.letterSpacing,A)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),n.textDecorationLine.length&&(f.ctx.fillStyle=xa(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(g){switch(g){case 1:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+A),m.bounds.width,1);break;case 2:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:f.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+u),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(f.ctx.strokeStyle=xa(n.webkitTextStrokeColor),f.ctx.lineWidth=n.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+A)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var a=g2(r),o=p2(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,a.left,a.top,a.width,a.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return _i(this,void 0,void 0,function(){var n,s,a,o,l,c,y,y,A,u,d,f,F,h,m,j,p,x,g,y,b,F,j;return ii(this,function(R){switch(R.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,s=r.curves,a=n.styles,o=0,l=n.textNodes,R.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,a)]):[3,4];case 2:R.sent(),R.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof PO))return[3,8];R.label=5;case 5:return R.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=R.sent(),this.renderReplacedElement(n,s,y),[3,8];case 7:return R.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof RO&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof DO))return[3,12];R.label=9;case 9:return R.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=R.sent(),this.renderReplacedElement(n,s,y),[3,12];case 11:return R.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof MO&&n.tree?(A=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,A.render(n.tree)]):[3,14];case 13:u=R.sent(),n.width&&n.height&&this.ctx.drawImage(u,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),R.label=14;case 14:if(n instanceof qS&&(d=Math.min(n.bounds.width,n.bounds.height),n.type===u2?n.checked&&(this.ctx.save(),this.path([new Yt(n.bounds.left+d*.39363,n.bounds.top+d*.79),new Yt(n.bounds.left+d*.16,n.bounds.top+d*.5549),new Yt(n.bounds.left+d*.27347,n.bounds.top+d*.44071),new Yt(n.bounds.left+d*.39694,n.bounds.top+d*.5649),new Yt(n.bounds.left+d*.72983,n.bounds.top+d*.23),new Yt(n.bounds.left+d*.84,n.bounds.top+d*.34085),new Yt(n.bounds.left+d*.39363,n.bounds.top+d*.79)]),this.ctx.fillStyle=xa(mT),this.ctx.fill(),this.ctx.restore()):n.type===d2&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+d/2,n.bounds.top+d/2,d/4,0,Math.PI*2,!0),this.ctx.fillStyle=xa(mT),this.ctx.fill(),this.ctx.restore())),yse(n)&&n.value.length){switch(f=this.createFontStyle(a),F=f[0],h=f[1],m=this.fontMetrics.getMetrics(F,h).baseline,this.ctx.font=F,this.ctx.fillStyle=xa(a.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Nse(n.styles.textAlign),j=g2(n),p=0,n.styles.textAlign){case 1:p+=j.width/2;break;case 2:p+=j.width;break}x=j.add(p,0,0,-j.height/2+1),this.ctx.save(),this.path([new Yt(j.left,j.top),new Yt(j.left+j.width,j.top),new Yt(j.left+j.width,j.top+j.height),new Yt(j.left,j.top+j.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new qp(n.value,x),a.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!la(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(g=n.styles.listStyleImage,g.type!==0)return[3,18];y=void 0,b=g.url,R.label=15;case 15:return R.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=R.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return R.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(F=this.createFontStyle(a)[0],this.ctx.font=F,this.ctx.fillStyle=xa(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",j=new BA(n.bounds.left,n.bounds.top+qn(n.styles.paddingTop,n.bounds.width),n.bounds.width,Yk(a.lineHeight,a.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new qp(r.listValue,j),a.letterSpacing,Yk(a.lineHeight,a.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),R.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return _i(this,void 0,void 0,function(){var n,s,g,a,o,g,l,c,g,A,u,g,d,f,g,h,m,g,p,x,g;return ii(this,function(y){switch(y.label){case 0:if(la(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,s=r.negativeZIndex,y.label=2;case 2:return n<s.length?(g=s[n],[4,this.renderStack(g)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),a=0,o=r.nonInlineLevel,y.label=7;case 7:return a<o.length?(g=o[a],[4,this.renderNode(g)]):[3,10];case 8:y.sent(),y.label=9;case 9:return a++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(g=c[l],[4,this.renderStack(g)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:A=0,u=r.nonPositionedInlineLevel,y.label=15;case 15:return A<u.length?(g=u[A],[4,this.renderStack(g)]):[3,18];case 16:y.sent(),y.label=17;case 17:return A++,[3,15];case 18:d=0,f=r.inlineLevel,y.label=19;case 19:return d<f.length?(g=f[d],[4,this.renderNode(g)]):[3,22];case 20:y.sent(),y.label=21;case 21:return d++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(g=m[h],[4,this.renderStack(g)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,y.label=27;case 27:return p<x.length?(g=x[p],[4,this.renderStack(g)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(s,a){var o=rl(s)?s.start:s;a===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),rl(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},e.prototype.renderRepeat=function(r,n,s,a){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(s,a),this.ctx.fill(),this.ctx.translate(-s,-a)},e.prototype.resizeImage=function(r,n,s){var a;if(r.width===n&&r.height===s)return r;var o=(a=this.canvas.ownerDocument)!==null&&a!==void 0?a:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,s),l},e.prototype.renderBackgroundImage=function(r){return _i(this,void 0,void 0,function(){var n,s,a,o,l,c;return ii(this,function(A){switch(A.label){case 0:n=r.styles.backgroundImage.length-1,s=function(u){var d,f,h,U,ae,fe,L,Y,S,m,U,ae,fe,L,Y,p,x,g,y,b,F,j,R,E,S,B,U,k,T,L,Y,me,ae,fe,de,Z,xe,Be,I,C,Q,M;return ii(this,function(D){switch(D.label){case 0:if(u.type!==0)return[3,5];d=void 0,f=u.url,D.label=1;case 1:return D.trys.push([1,3,,4]),[4,a.context.cache.match(f)];case 2:return d=D.sent(),[3,4];case 3:return D.sent(),a.context.logger.error("Error loading background-image "+f),[3,4];case 4:return d&&(h=NN(r,n,[d.width,d.height,d.width/d.height]),U=h[0],ae=h[1],fe=h[2],L=h[3],Y=h[4],S=a.ctx.createPattern(a.resizeImage(d,L,Y),"repeat"),a.renderRepeat(U,S,ae,fe)),[3,6];case 5:ite(u)?(m=NN(r,n,[null,null,null]),U=m[0],ae=m[1],fe=m[2],L=m[3],Y=m[4],p=tte(u.angle,L,Y),x=p[0],g=p[1],y=p[2],b=p[3],F=p[4],j=document.createElement("canvas"),j.width=L,j.height=Y,R=j.getContext("2d"),E=R.createLinearGradient(g,b,y,F),Jk(u.stops,x).forEach(function(z){return E.addColorStop(z.stop,xa(z.color))}),R.fillStyle=E,R.fillRect(0,0,L,Y),L>0&&Y>0&&(S=a.ctx.createPattern(j,"repeat"),a.renderRepeat(U,S,ae,fe))):ote(u)&&(B=NN(r,n,[null,null,null]),U=B[0],k=B[1],T=B[2],L=B[3],Y=B[4],me=u.position.length===0?[QS]:u.position,ae=qn(me[0],L),fe=qn(me[me.length-1],Y),de=rte(u,ae,fe,L,Y),Z=de[0],xe=de[1],Z>0&&xe>0&&(Be=a.ctx.createRadialGradient(k+ae,T+fe,0,k+ae,T+fe,Z),Jk(u.stops,Z*2).forEach(function(z){return Be.addColorStop(z.stop,xa(z.color))}),a.path(U),a.ctx.fillStyle=Be,Z!==xe?(I=r.bounds.left+.5*r.bounds.width,C=r.bounds.top+.5*r.bounds.height,Q=xe/Z,M=1/Q,a.ctx.save(),a.ctx.translate(I,C),a.ctx.transform(1,0,0,Q,0,0),a.ctx.translate(-I,-C),a.ctx.fillRect(k,M*(T-C)+C,L,Y*M),a.ctx.restore()):a.ctx.fill())),D.label=6;case 6:return n--,[2]}})},a=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:A.sent(),A.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,s){return _i(this,void 0,void 0,function(){return ii(this,function(a){return this.path(BT(s,n)),this.ctx.fillStyle=xa(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,s,a){return _i(this,void 0,void 0,function(){var o,l;return ii(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,s,a)]:[3,2];case 1:return c.sent(),[2];case 2:return o=Ase(a,s),this.path(o),this.ctx.fillStyle=xa(r),this.ctx.fill(),l=use(a,s),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return _i(this,void 0,void 0,function(){var n,s,a,o,l,c,A,u,d=this;return ii(this,function(f){switch(f.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,s=!$u(n.backgroundColor)||n.backgroundImage.length,a=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=bse(Hf(n.backgroundClip,0),r.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),$u(n.backgroundColor)||(this.ctx.fillStyle=xa(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){d.ctx.save();var m=m2(r.curves),p=h.inset?0:vse,x=lse(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(d.path(m),d.ctx.clip(),d.mask(x)):(d.mask(m),d.ctx.clip(),d.path(x)),d.ctx.shadowOffsetX=h.offsetX.number+p,d.ctx.shadowOffsetY=h.offsetY.number,d.ctx.shadowColor=xa(h.color),d.ctx.shadowBlur=h.blur.number,d.ctx.fillStyle=h.inset?xa(h.color):"rgba(0,0,0,1)",d.ctx.fill(),d.ctx.restore()}),f.label=2;case 2:l=0,c=0,A=a,f.label=3;case 3:return c<A.length?(u=A[c],u.style!==0&&!$u(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,3)];case 6:return f.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,l,r.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,l,r.curves)];case 10:f.sent(),f.label=11;case 11:l++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,s,a,o){return _i(this,void 0,void 0,function(){var l,c,A,u,d,f,h,m,p,x,g,y,b,F,j,R,j,R;return ii(this,function(E){return this.ctx.save(),l=dse(a,s),c=BT(a,s),o===2&&(this.path(c),this.ctx.clip()),rl(c[0])?(A=c[0].start.x,u=c[0].start.y):(A=c[0].x,u=c[0].y),rl(c[1])?(d=c[1].end.x,f=c[1].end.y):(d=c[1].x,f=c[1].y),s===0||s===2?h=Math.abs(A-d):h=Math.abs(u-f),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(g=h/(2*m+p),m*=g,p*=g):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),F=(h-(y+1)*m)/y,p=F<=0||Math.abs(p-b)<Math.abs(p-F)?b:F),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=xa(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(rl(c[0])&&(j=c[3],R=c[0],this.ctx.beginPath(),this.formatPath([new Yt(j.end.x,j.end.y),new Yt(R.start.x,R.start.y)]),this.ctx.stroke()),rl(c[1])&&(j=c[1],R=c[2],this.ctx.beginPath(),this.formatPath([new Yt(j.end.x,j.end.y),new Yt(R.start.x,R.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return _i(this,void 0,void 0,function(){var n;return ii(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=xa(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=cse(r),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(rM),yse=function(t){return t instanceof OO||t instanceof UO?!0:t instanceof qS&&t.type!==d2&&t.type!==u2},bse=function(t,e){switch(t){case 0:return m2(e);case 2:return nse(e);case 1:default:return p2(e)}},Nse=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Cse=["-apple-system","system-ui"],_se=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return Cse.indexOf(e)===-1}):t},Ese=function(t){Gl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return e.prototype.render=function(r){return _i(this,void 0,void 0,function(){var n,s;return ii(this,function(a){switch(a.label){case 0:return n=aE(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,Bse(n)];case 1:return s=a.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=xa(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(rM),Bse=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Sse=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,j1([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,j1([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,j1([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,j1([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),Ise=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new Sse({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new Wne(this,e)}return t.instanceCount=1,t}(),$h=function(t,e){return e===void 0&&(e={}),Fse(t,e)};typeof window<"u"&&JO.setContext(window);var Fse=function(t,e){return _i(void 0,void 0,void 0,function(){var r,n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b,F,j,E,R,E,S,B,U,k,T,L,Y,me,ae,fe,de,Z,xe,Be,I,C,Q;return ii(this,function(M){switch(M.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(S=e.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(B=e.imageTimeout)!==null&&B!==void 0?B:15e3,proxy:e.proxy,useCORS:(U=e.useCORS)!==null&&U!==void 0?U:!1},a=K_({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},s),o={windowWidth:(T=e.windowWidth)!==null&&T!==void 0?T:n.innerWidth,windowHeight:(L=e.windowHeight)!==null&&L!==void 0?L:n.innerHeight,scrollX:(Y=e.scrollX)!==null&&Y!==void 0?Y:n.pageXOffset,scrollY:(me=e.scrollY)!==null&&me!==void 0?me:n.pageYOffset},l=new BA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new Ise(a,l),A=(ae=e.foreignObjectRendering)!==null&&ae!==void 0?ae:!1,u={allowTaint:(fe=e.allowTaint)!==null&&fe!==void 0?fe:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:A,copyStyles:A},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),d=new CT(c,t,u),f=d.clonedReferenceElement,f?[4,d.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=M.sent(),m=GS(f)||Tne(f)?lZ(f.ownerDocument):Py(c,f),p=m.width,x=m.height,g=m.left,y=m.top,b=kse(c,f,e.backgroundColor),F={canvas:e.canvas,backgroundColor:b,scale:(Z=(de=e.scale)!==null&&de!==void 0?de:n.devicePixelRatio)!==null&&Z!==void 0?Z:1,x:((xe=e.x)!==null&&xe!==void 0?xe:0)+g,y:((Be=e.y)!==null&&Be!==void 0?Be:0)+y,width:(I=e.width)!==null&&I!==void 0?I:Math.ceil(p),height:(C=e.height)!==null&&C!==void 0?C:Math.ceil(x)},A?(c.logger.debug("Document cloned, using foreign object rendering"),E=new Ese(c,F),[4,E.render(f)]):[3,3];case 2:return j=M.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+g+","+y+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),R=VO(c,f),b===R.styles.backgroundColor&&(R.styles.backgroundColor=fA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+F.x+","+F.y+" with size "+F.width+"x"+F.height),E=new wse(c,F),[4,E.render(R)];case 4:j=M.sent(),M.label=5;case 5:return(!((Q=e.removeContainer)!==null&&Q!==void 0)||Q)&&(CT.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,j]}})})},kse=function(t,e,r){var n=e.ownerDocument,s=n.documentElement?Hp(t,getComputedStyle(n.documentElement).backgroundColor):fA.TRANSPARENT,a=n.body?Hp(t,getComputedStyle(n.body).backgroundColor):fA.TRANSPARENT,o=typeof r=="string"?Hp(t,r):r===null?fA.TRANSPARENT:4294967295;return e===n.documentElement?$u(s)?$u(a)?o:a:s:o};const $S=Object.freeze(Object.defineProperty({__proto__:null,default:$h},Symbol.toStringTag,{value:"Module"})),Tse="modulepreload",jse=function(t){return"/"+t},IT={},mA=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=jse(c),c in IT)return;IT[c]=!0;const A=c.endsWith(".css"),u=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=A?"stylesheet":Tse,A||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),A)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Bn(t){"@babel/helpers - typeof";return Bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bn(t)}var Hl=Uint8Array,_o=Uint16Array,zS=Int32Array,WS=new Hl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),JS=new Hl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),FT=new Hl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nM=function(t,e){for(var r=new _o(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new zS(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},sM=nM(WS,2),Pse=sM.b,dE=sM.r;Pse[28]=258,dE[258]=28;var Rse=nM(JS,0),kT=Rse.r,hE=new _o(32768);for(var Xn=0;Xn<32768;++Xn){var au=(Xn&43690)>>1|(Xn&21845)<<1;au=(au&52428)>>2|(au&13107)<<2,au=(au&61680)>>4|(au&3855)<<4,hE[Xn]=((au&65280)>>8|(au&255)<<8)>>1}var $p=function(t,e,r){for(var n=t.length,s=0,a=new _o(e);s<n;++s)t[s]&&++a[t[s]-1];var o=new _o(e);for(s=1;s<e;++s)o[s]=o[s-1]+a[s-1]<<1;var l;if(r){l=new _o(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var A=s<<4|t[s],u=e-t[s],d=o[t[s]-1]++<<u,f=d|(1<<u)-1;d<=f;++d)l[hE[d]>>c]=A}else for(l=new _o(n),s=0;s<n;++s)t[s]&&(l[s]=hE[o[t[s]-1]++]>>15-t[s]);return l},Fh=new Hl(288);for(var Xn=0;Xn<144;++Xn)Fh[Xn]=8;for(var Xn=144;Xn<256;++Xn)Fh[Xn]=9;for(var Xn=256;Xn<280;++Xn)Fh[Xn]=7;for(var Xn=280;Xn<288;++Xn)Fh[Xn]=8;var x2=new Hl(32);for(var Xn=0;Xn<32;++Xn)x2[Xn]=5;var Dse=$p(Fh,9,0),Lse=$p(x2,5,0),aM=function(t){return(t+7)/8|0},Use=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Hl(t.subarray(e,r))},Gc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Ym=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},CN=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,a=r.slice();if(!s)return{t:oM,l:0};if(s==1){var o=new Hl(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(j,R){return j.f-R.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],A=0,u=1,d=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=r[r[A].f<r[d].f?A++:d++],c=r[A!=u&&r[A].f<r[d].f?A++:d++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var f=a[0].s,n=1;n<s;++n)a[n].s>f&&(f=a[n].s);var h=new _o(f+1),m=fE(r[u-1],h,0);if(m>e){var n=0,p=0,x=m-e,g=1<<x;for(a.sort(function(R,E){return h[E.s]-h[R.s]||R.f-E.f});n<s;++n){var y=a[n].s;if(h[y]>e)p+=g-(1<<m-h[y]),h[y]=e;else break}for(p>>=x;p>0;){var b=a[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var F=a[n].s;h[F]==e&&(--h[F],++p)}m=e}return{t:new Hl(h),l:m}},fE=function(t,e,r){return t.s==-1?Math.max(fE(t.l,e,r+1),fE(t.r,e,r+1)):e[t.s]=r},TT=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new _o(++e),n=0,s=t[0],a=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=t[l]}return{c:r.subarray(0,n),n:e}},Zm=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},iM=function(t,e,r){var n=r.length,s=aM(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var a=0;a<n;++a)t[s+a+4]=r[a];return(s+4+n)*8},jT=function(t,e,r,n,s,a,o,l,c,A,u){Gc(e,u++,r),++s[256];for(var d=CN(s,15),f=d.t,h=d.l,m=CN(a,15),p=m.t,x=m.l,g=TT(f),y=g.c,b=g.n,F=TT(p),j=F.c,R=F.n,E=new _o(19),S=0;S<y.length;++S)++E[y[S]&31];for(var S=0;S<j.length;++S)++E[j[S]&31];for(var B=CN(E,7),U=B.t,k=B.l,T=19;T>4&&!U[FT[T-1]];--T);var L=A+5<<3,Y=Zm(s,Fh)+Zm(a,x2)+o,me=Zm(s,f)+Zm(a,p)+o+14+3*T+Zm(E,U)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&L<=Y&&L<=me)return iM(e,u,t.subarray(c,c+A));var ae,fe,de,Z;if(Gc(e,u,1+(me<Y)),u+=2,me<Y){ae=$p(f,h,0),fe=f,de=$p(p,x,0),Z=p;var xe=$p(U,k,0);Gc(e,u,b-257),Gc(e,u+5,R-1),Gc(e,u+10,T-4),u+=14;for(var S=0;S<T;++S)Gc(e,u+3*S,U[FT[S]]);u+=3*T;for(var Be=[y,j],I=0;I<2;++I)for(var C=Be[I],S=0;S<C.length;++S){var Q=C[S]&31;Gc(e,u,xe[Q]),u+=U[Q],Q>15&&(Gc(e,u,C[S]>>5&127),u+=C[S]>>12)}}else ae=Dse,fe=Fh,de=Lse,Z=x2;for(var S=0;S<l;++S){var M=n[S];if(M>255){var Q=M>>18&31;Ym(e,u,ae[Q+257]),u+=fe[Q+257],Q>7&&(Gc(e,u,M>>23&31),u+=WS[Q]);var D=M&31;Ym(e,u,de[D]),u+=Z[D],D>3&&(Ym(e,u,M>>5&8191),u+=JS[D])}else Ym(e,u,ae[M]),u+=fe[M]}return Ym(e,u,ae[256]),u+fe[256]},Ose=new zS([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),oM=new Hl(0),Mse=function(t,e,r,n,s,a){var o=a.z||t.length,l=new Hl(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),A=a.l,u=(a.r||0)&7;if(e){u&&(c[0]=a.r>>3);for(var d=Ose[e-1],f=d>>13,h=d&8191,m=(1<<r)-1,p=a.p||new _o(32768),x=a.h||new _o(m+1),g=Math.ceil(r/3),y=2*g,b=function(re){return(t[re]^t[re+1]<<g^t[re+2]<<y)&m},F=new zS(25e3),j=new _o(288),R=new _o(32),E=0,S=0,B=a.i||0,U=0,k=a.w||0,T=0;B+2<o;++B){var L=b(B),Y=B&32767,me=x[L];if(p[Y]=me,x[L]=Y,k<=B){var ae=o-B;if((E>7e3||U>24576)&&(ae>423||!A)){u=jT(t,c,0,F,j,R,S,U,T,B-T,u),U=E=S=0,T=B;for(var fe=0;fe<286;++fe)j[fe]=0;for(var fe=0;fe<30;++fe)R[fe]=0}var de=2,Z=0,xe=h,Be=Y-me&32767;if(ae>2&&L==b(B-Be))for(var I=Math.min(f,ae)-1,C=Math.min(32767,B),Q=Math.min(258,ae);Be<=C&&--xe&&Y!=me;){if(t[B+de]==t[B+de-Be]){for(var M=0;M<Q&&t[B+M]==t[B+M-Be];++M);if(M>de){if(de=M,Z=Be,M>I)break;for(var D=Math.min(Be,M-2),z=0,fe=0;fe<D;++fe){var O=B-Be+fe&32767,te=p[O],se=O-te&32767;se>z&&(z=se,me=O)}}}Y=me,me=p[Y],Be+=Y-me&32767}if(Z){F[U++]=268435456|dE[de]<<18|kT[Z];var we=dE[de]&31,q=kT[Z]&31;S+=WS[we]+JS[q],++j[257+we],++R[q],k=B+de,++E}else F[U++]=t[B],++j[t[B]]}}for(B=Math.max(B,k);B<o;++B)F[U++]=t[B],++j[t[B]];u=jT(t,c,A,F,j,R,S,U,T,B-T,u),A||(a.r=u&7|c[u/8|0]<<3,u-=7,a.h=x,a.p=p,a.i=B,a.w=k)}else{for(var B=a.w||0;B<o+A;B+=65535){var Me=B+65535;Me>=o&&(c[u/8|0]=A,Me=o),u=iM(c,u+1,t.subarray(B,Me))}a.i=o}return Use(l,0,n+aM(u)+s)},lM=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,a=r.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},Qse=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new Hl(a.length+t.length);o.set(a),o.set(t,a.length),t=o,s.w=a.length}return Mse(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},cM=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Vse=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=lM();s.p(e.dictionary),cM(t,2,s.d())}};function mE(t,e){e||(e={});var r=lM();r.p(t);var n=Qse(t,e,e.dictionary?6:2,4);return Vse(n,e),cM(n,n.length-4,r.d()),n}var Hse=typeof TextDecoder<"u"&&new TextDecoder,Kse=0;try{Hse.decode(oM,{stream:!0}),Kse=1}catch{}function qse(t){if(Array.isArray(t))return t}function Gse(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,a,o,l=[],c=!0,A=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(u){A=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(A)throw s}}return l}}function PT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $se(t,e){if(t){if(typeof t=="string")return PT(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?PT(t,e):void 0}}function zse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RT(t,e){return qse(t)||Gse(t,e)||$se(t,e)||zse()}function DT(t,e="utf8"){return new TextDecoder(e).decode(t)}const Wse=new TextEncoder;function Jse(t){return Wse.encode(t)}const Xse=1024*8,Yse=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),_N={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class XS{constructor(e=Xse,r={}){bn(this,"buffer");bn(this,"byteLength");bn(this,"byteOffset");bn(this,"length");bn(this,"offset");bn(this,"lastWrittenByte");bn(this,"littleEndian");bn(this,"_data");bn(this,"_mark");bn(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=r.offset?r.offset>>>0:0,a=e.byteLength-s;let o=s;(ArrayBuffer.isView(e)||e instanceof XS)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=_N[r].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===Yse&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new _N[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new _N[r](a);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return DT(this.readBytes(e))}decodeText(e=1,r="utf8"){return DT(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(Jse(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function om(t){let e=t.length;for(;--e>=0;)t[e]=0}const Zse=3,eae=258,AM=29,tae=256,rae=tae+1+AM,uM=30,nae=512,sae=new Array((rae+2)*2);om(sae);const aae=new Array(uM*2);om(aae);const iae=new Array(nae);om(iae);const oae=new Array(eae-Zse+1);om(oae);const lae=new Array(AM);om(lae);const cae=new Array(uM);om(cae);const Aae=(t,e,r,n)=>{let s=t&65535|0,a=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,a=a+s|0;while(--o);s%=65521,a%=65521}return s|a<<16|0};var pE=Aae;const uae=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},dae=new Uint32Array(uae()),hae=(t,e,r,n)=>{const s=dae,a=n+r;t^=-1;for(let o=n;o<a;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var ic=hae,gE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},dM={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const fae=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var mae=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)fae(r,n)&&(t[n]=r[n])}}return t},pae=t=>{let e=0;for(let n=0,s=t.length;n<s;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,s=0,a=t.length;n<a;n++){let o=t[n];r.set(o,s),s+=o.length}return r},hM={assign:mae,flattenChunks:pae};let fM=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{fM=!1}const Gg=new Uint8Array(256);for(let t=0;t<256;t++)Gg[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Gg[254]=Gg[254]=1;var gae=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,s,a,o=t.length,l=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),a=0,s=0;a<l;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const xae=(t,e)=>{if(e<65534&&t.subarray&&fM)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var vae=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let o=t[n++];if(o<128){a[s++]=o;continue}let l=Gg[o];if(l>4){a[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){a[s++]=65533;continue}o<65536?a[s++]=o:(o-=65536,a[s++]=55296|o>>10&1023,a[s++]=56320|o&1023)}return xae(a,s)},wae=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Gg[t[r]]>e?r:e},xE={string2buf:gae,buf2string:vae,utf8border:wae};function yae(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var bae=yae;const rv=16209,Nae=16191;var Cae=function(e,r){let n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b,F,j,R,E,S,B,U;const k=e.state;n=e.next_in,B=e.input,s=n+(e.avail_in-5),a=e.next_out,U=e.output,o=a-(r-e.avail_out),l=a+(e.avail_out-257),c=k.dmax,A=k.wsize,u=k.whave,d=k.wnext,f=k.window,h=k.hold,m=k.bits,p=k.lencode,x=k.distcode,g=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=B[n++]<<m,m+=8,h+=B[n++]<<m,m+=8),b=p[h&g];t:for(;;){if(F=b>>>24,h>>>=F,m-=F,F=b>>>16&255,F===0)U[a++]=b&65535;else if(F&16){j=b&65535,F&=15,F&&(m<F&&(h+=B[n++]<<m,m+=8),j+=h&(1<<F)-1,h>>>=F,m-=F),m<15&&(h+=B[n++]<<m,m+=8,h+=B[n++]<<m,m+=8),b=x[h&y];r:for(;;){if(F=b>>>24,h>>>=F,m-=F,F=b>>>16&255,F&16){if(R=b&65535,F&=15,m<F&&(h+=B[n++]<<m,m+=8,m<F&&(h+=B[n++]<<m,m+=8)),R+=h&(1<<F)-1,R>c){e.msg="invalid distance too far back",k.mode=rv;break e}if(h>>>=F,m-=F,F=a-o,R>F){if(F=R-F,F>u&&k.sane){e.msg="invalid distance too far back",k.mode=rv;break e}if(E=0,S=f,d===0){if(E+=A-F,F<j){j-=F;do U[a++]=f[E++];while(--F);E=a-R,S=U}}else if(d<F){if(E+=A+d-F,F-=d,F<j){j-=F;do U[a++]=f[E++];while(--F);if(E=0,d<j){F=d,j-=F;do U[a++]=f[E++];while(--F);E=a-R,S=U}}}else if(E+=d-F,F<j){j-=F;do U[a++]=f[E++];while(--F);E=a-R,S=U}for(;j>2;)U[a++]=S[E++],U[a++]=S[E++],U[a++]=S[E++],j-=3;j&&(U[a++]=S[E++],j>1&&(U[a++]=S[E++]))}else{E=a-R;do U[a++]=U[E++],U[a++]=U[E++],U[a++]=U[E++],j-=3;while(j>2);j&&(U[a++]=U[E++],j>1&&(U[a++]=U[E++]))}}else if(F&64){e.msg="invalid distance code",k.mode=rv;break e}else{b=x[(b&65535)+(h&(1<<F)-1)];continue r}break}}else if(F&64)if(F&32){k.mode=Nae;break e}else{e.msg="invalid literal/length code",k.mode=rv;break e}else{b=p[(b&65535)+(h&(1<<F)-1)];continue t}break}}while(n<s&&a<l);j=m>>3,n-=j,m-=j<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=a,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=a<l?257+(l-a):257-(a-l),k.hold=h,k.bits=m};const Ef=15,LT=852,UT=592,OT=0,EN=1,MT=2,_ae=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Eae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Bae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Sae=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Iae=(t,e,r,n,s,a,o,l)=>{const c=l.bits;let A=0,u=0,d=0,f=0,h=0,m=0,p=0,x=0,g=0,y=0,b,F,j,R,E,S=null,B;const U=new Uint16Array(Ef+1),k=new Uint16Array(Ef+1);let T=null,L,Y,me;for(A=0;A<=Ef;A++)U[A]=0;for(u=0;u<n;u++)U[e[r+u]]++;for(h=c,f=Ef;f>=1&&U[f]===0;f--);if(h>f&&(h=f),f===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<f&&U[d]===0;d++);for(h<d&&(h=d),x=1,A=1;A<=Ef;A++)if(x<<=1,x-=U[A],x<0)return-1;if(x>0&&(t===OT||f!==1))return-1;for(k[1]=0,A=1;A<Ef;A++)k[A+1]=k[A]+U[A];for(u=0;u<n;u++)e[r+u]!==0&&(o[k[e[r+u]]++]=u);if(t===OT?(S=T=o,B=20):t===EN?(S=_ae,T=Eae,B=257):(S=Bae,T=Sae,B=0),y=0,u=0,A=d,E=a,m=h,p=0,j=-1,g=1<<h,R=g-1,t===EN&&g>LT||t===MT&&g>UT)return 1;for(;;){L=A-p,o[u]+1<B?(Y=0,me=o[u]):o[u]>=B?(Y=T[o[u]-B],me=S[o[u]-B]):(Y=96,me=0),b=1<<A-p,F=1<<m,d=F;do F-=b,s[E+(y>>p)+F]=L<<24|Y<<16|me|0;while(F!==0);for(b=1<<A-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,u++,--U[A]===0){if(A===f)break;A=e[r+o[u]]}if(A>h&&(y&R)!==j){for(p===0&&(p=h),E+=d,m=A-p,x=1<<m;m+p<f&&(x-=U[m+p],!(x<=0));)m++,x<<=1;if(g+=1<<m,t===EN&&g>LT||t===MT&&g>UT)return 1;j=y&R,s[j]=h<<24|m<<16|E-a|0}}return y!==0&&(s[E+y]=A-p<<24|64<<16|0),l.bits=h,0};var zp=Iae;const Fae=0,mM=1,pM=2,{Z_FINISH:QT,Z_BLOCK:kae,Z_TREES:nv,Z_OK:kh,Z_STREAM_END:Tae,Z_NEED_DICT:jae,Z_STREAM_ERROR:dl,Z_DATA_ERROR:gM,Z_MEM_ERROR:xM,Z_BUF_ERROR:Pae,Z_DEFLATED:VT}=dM,Ky=16180,HT=16181,KT=16182,qT=16183,GT=16184,$T=16185,zT=16186,WT=16187,JT=16188,XT=16189,v2=16190,$c=16191,BN=16192,YT=16193,SN=16194,ZT=16195,ej=16196,tj=16197,rj=16198,sv=16199,av=16200,nj=16201,sj=16202,aj=16203,ij=16204,oj=16205,IN=16206,lj=16207,cj=16208,ns=16209,vM=16210,wM=16211,Rae=852,Dae=592,Lae=15,Uae=Lae,Aj=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Oae(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const zh=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Ky||e.mode>wM?1:0},yM=t=>{if(zh(t))return dl;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Ky,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Rae),e.distcode=e.distdyn=new Int32Array(Dae),e.sane=1,e.back=-1,kh},bM=t=>{if(zh(t))return dl;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,yM(t)},NM=(t,e)=>{let r;if(zh(t))return dl;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?dl:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,bM(t))},CM=(t,e)=>{if(!t)return dl;const r=new Oae;t.state=r,r.strm=t,r.window=null,r.mode=Ky;const n=NM(t,e);return n!==kh&&(t.state=null),n},Mae=t=>CM(t,Uae);let uj=!0,FN,kN;const Qae=t=>{if(uj){FN=new Int32Array(512),kN=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(zp(mM,t.lens,0,288,FN,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;zp(pM,t.lens,0,32,kN,0,t.work,{bits:5}),uj=!1}t.lencode=FN,t.lenbits=9,t.distcode=kN,t.distbits=5},_M=(t,e,r,n)=>{let s;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(e.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},Vae=(t,e)=>{let r,n,s,a,o,l,c,A,u,d,f,h,m,p,x=0,g,y,b,F,j,R,E,S;const B=new Uint8Array(4);let U,k;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(zh(t)||!t.output||!t.input&&t.avail_in!==0)return dl;r=t.state,r.mode===$c&&(r.mode=BN),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,A=r.hold,u=r.bits,d=l,f=c,S=kh;e:for(;;)switch(r.mode){case Ky:if(r.wrap===0){r.mode=BN;break}for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&2&&A===35615){r.wbits===0&&(r.wbits=15),r.check=0,B[0]=A&255,B[1]=A>>>8&255,r.check=ic(r.check,B,2,0),A=0,u=0,r.mode=HT;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((A&255)<<8)+(A>>8))%31){t.msg="incorrect header check",r.mode=ns;break}if((A&15)!==VT){t.msg="unknown compression method",r.mode=ns;break}if(A>>>=4,u-=4,E=(A&15)+8,r.wbits===0&&(r.wbits=E),E>15||E>r.wbits){t.msg="invalid window size",r.mode=ns;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=A&512?XT:$c,A=0,u=0;break;case HT:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.flags=A,(r.flags&255)!==VT){t.msg="unknown compression method",r.mode=ns;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=ns;break}r.head&&(r.head.text=A>>8&1),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,r.check=ic(r.check,B,2,0)),A=0,u=0,r.mode=KT;case KT:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.time=A),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,B[2]=A>>>16&255,B[3]=A>>>24&255,r.check=ic(r.check,B,4,0)),A=0,u=0,r.mode=qT;case qT:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=A&255,r.head.os=A>>8),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,r.check=ic(r.check,B,2,0)),A=0,u=0,r.mode=GT;case GT:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length=A,r.head&&(r.head.extra_len=A),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,r.check=ic(r.check,B,2,0)),A=0,u=0}else r.head&&(r.head.extra=null);r.mode=$T;case $T:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+h),E)),r.flags&512&&r.wrap&4&&(r.check=ic(r.check,n,h,a)),l-=h,a+=h,r.length-=h),r.length))break e;r.length=0,r.mode=zT;case zT:if(r.flags&2048){if(l===0)break e;h=0;do E=n[a+h++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=ic(r.check,n,h,a)),l-=h,a+=h,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=WT;case WT:if(r.flags&4096){if(l===0)break e;h=0;do E=n[a+h++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=ic(r.check,n,h,a)),l-=h,a+=h,E)break e}else r.head&&(r.head.comment=null);r.mode=JT;case JT:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.check&65535)){t.msg="header crc mismatch",r.mode=ns;break}A=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=$c;break;case XT:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}t.adler=r.check=Aj(A),A=0,u=0,r.mode=v2;case v2:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,jae;t.adler=r.check=1,r.mode=$c;case $c:if(e===kae||e===nv)break e;case BN:if(r.last){A>>>=u&7,u-=u&7,r.mode=IN;break}for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}switch(r.last=A&1,A>>>=1,u-=1,A&3){case 0:r.mode=YT;break;case 1:if(Qae(r),r.mode=sv,e===nv){A>>>=2,u-=2;break e}break;case 2:r.mode=ej;break;case 3:t.msg="invalid block type",r.mode=ns}A>>>=2,u-=2;break;case YT:for(A>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if((A&65535)!==(A>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ns;break}if(r.length=A&65535,A=0,u=0,r.mode=SN,e===nv)break e;case SN:r.mode=ZT;case ZT:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;s.set(n.subarray(a,a+h),o),l-=h,a+=h,c-=h,o+=h,r.length-=h;break}r.mode=$c;break;case ej:for(;u<14;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.nlen=(A&31)+257,A>>>=5,u-=5,r.ndist=(A&31)+1,A>>>=5,u-=5,r.ncode=(A&15)+4,A>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ns;break}r.have=0,r.mode=tj;case tj:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.lens[T[r.have++]]=A&7,A>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,U={bits:r.lenbits},S=zp(Fae,r.lens,0,19,r.lencode,0,r.work,U),r.lenbits=U.bits,S){t.msg="invalid code lengths set",r.mode=ns;break}r.have=0,r.mode=rj;case rj:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[A&(1<<r.lenbits)-1],g=x>>>24,y=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(b<16)A>>>=g,u-=g,r.lens[r.have++]=b;else{if(b===16){for(k=g+2;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(A>>>=g,u-=g,r.have===0){t.msg="invalid bit length repeat",r.mode=ns;break}E=r.lens[r.have-1],h=3+(A&3),A>>>=2,u-=2}else if(b===17){for(k=g+3;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=g,u-=g,E=0,h=3+(A&7),A>>>=3,u-=3}else{for(k=g+7;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=g,u-=g,E=0,h=11+(A&127),A>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ns;break}for(;h--;)r.lens[r.have++]=E}}if(r.mode===ns)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=ns;break}if(r.lenbits=9,U={bits:r.lenbits},S=zp(mM,r.lens,0,r.nlen,r.lencode,0,r.work,U),r.lenbits=U.bits,S){t.msg="invalid literal/lengths set",r.mode=ns;break}if(r.distbits=6,r.distcode=r.distdyn,U={bits:r.distbits},S=zp(pM,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,U),r.distbits=U.bits,S){t.msg="invalid distances set",r.mode=ns;break}if(r.mode=sv,e===nv)break e;case sv:r.mode=av;case av:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,Cae(t,f),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,A=r.hold,u=r.bits,r.mode===$c&&(r.back=-1);break}for(r.back=0;x=r.lencode[A&(1<<r.lenbits)-1],g=x>>>24,y=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(y&&!(y&240)){for(F=g,j=y,R=b;x=r.lencode[R+((A&(1<<F+j)-1)>>F)],g=x>>>24,y=x>>>16&255,b=x&65535,!(F+g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=F,u-=F,r.back+=F}if(A>>>=g,u-=g,r.back+=g,r.length=b,y===0){r.mode=oj;break}if(y&32){r.back=-1,r.mode=$c;break}if(y&64){t.msg="invalid literal/length code",r.mode=ns;break}r.extra=y&15,r.mode=nj;case nj:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=sj;case sj:for(;x=r.distcode[A&(1<<r.distbits)-1],g=x>>>24,y=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(!(y&240)){for(F=g,j=y,R=b;x=r.distcode[R+((A&(1<<F+j)-1)>>F)],g=x>>>24,y=x>>>16&255,b=x&65535,!(F+g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=F,u-=F,r.back+=F}if(A>>>=g,u-=g,r.back+=g,y&64){t.msg="invalid distance code",r.mode=ns;break}r.offset=b,r.extra=y&15,r.mode=aj;case aj:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.offset+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ns;break}r.mode=ij;case ij:if(c===0)break e;if(h=f-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ns;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=s,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do s[o++]=p[m++];while(--h);r.length===0&&(r.mode=av);break;case oj:if(c===0)break e;s[o++]=r.length,c--,r.mode=av;break;case IN:if(r.wrap){for(;u<32;){if(l===0)break e;l--,A|=n[a++]<<u,u+=8}if(f-=c,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?ic(r.check,s,f,o-f):pE(r.check,s,f,o-f)),f=c,r.wrap&4&&(r.flags?A:Aj(A))!==r.check){t.msg="incorrect data check",r.mode=ns;break}A=0,u=0}r.mode=lj;case lj:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=ns;break}A=0,u=0}r.mode=cj;case cj:S=Tae;break e;case ns:S=gM;break e;case vM:return xM;case wM:default:return dl}return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,(r.wsize||f!==t.avail_out&&r.mode<ns&&(r.mode<IN||e!==QT))&&_M(t,t.output,t.next_out,f-t.avail_out),d-=t.avail_in,f-=t.avail_out,t.total_in+=d,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?ic(r.check,s,f,t.next_out-f):pE(r.check,s,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===$c?128:0)+(r.mode===sv||r.mode===SN?256:0),(d===0&&f===0||e===QT)&&S===kh&&(S=Pae),S},Hae=t=>{if(zh(t))return dl;let e=t.state;return e.window&&(e.window=null),t.state=null,kh},Kae=(t,e)=>{if(zh(t))return dl;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,kh):dl},qae=(t,e)=>{const r=e.length;let n,s,a;return zh(t)||(n=t.state,n.wrap!==0&&n.mode!==v2)?dl:n.mode===v2&&(s=1,s=pE(s,e,r,0),s!==n.check)?gM:(a=_M(t,e,r,r),a?(n.mode=vM,xM):(n.havedict=1,kh))};var Gae=bM,$ae=NM,zae=yM,Wae=Mae,Jae=CM,Xae=Vae,Yae=Hae,Zae=Kae,eie=qae,tie="pako inflate (from Nodeca project)",tA={inflateReset:Gae,inflateReset2:$ae,inflateResetKeep:zae,inflateInit:Wae,inflateInit2:Jae,inflate:Xae,inflateEnd:Yae,inflateGetHeader:Zae,inflateSetDictionary:eie,inflateInfo:tie};function rie(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var nie=rie;const EM=Object.prototype.toString,{Z_NO_FLUSH:sie,Z_FINISH:aie,Z_OK:$g,Z_STREAM_END:TN,Z_NEED_DICT:jN,Z_STREAM_ERROR:iie,Z_DATA_ERROR:dj,Z_MEM_ERROR:oie}=dM;function Rx(t){this.options=hM.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new bae,this.strm.avail_out=0;let r=tA.inflateInit2(this.strm,e.windowBits);if(r!==$g)throw new Error(gE[r]);if(this.header=new nie,tA.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=xE.string2buf(e.dictionary):EM.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=tA.inflateSetDictionary(this.strm,e.dictionary),r!==$g)))throw new Error(gE[r])}Rx.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?aie:sie,EM.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=tA.inflate(r,o),a===jN&&s&&(a=tA.inflateSetDictionary(r,s),a===$g?a=tA.inflate(r,o):a===dj&&(a=jN));r.avail_in>0&&a===TN&&r.state.wrap>0&&t[r.next_in]!==0;)tA.inflateReset(r),a=tA.inflate(r,o);switch(a){case iie:case dj:case jN:case oie:return this.onEnd(a),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||a===TN))if(this.options.to==="string"){let c=xE.utf8border(r.output,r.next_out),A=r.next_out-c,u=xE.buf2string(r.output,c);r.next_out=A,r.avail_out=n-A,A&&r.output.set(r.output.subarray(c,c+A),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===$g&&l===0)){if(a===TN)return a=tA.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Rx.prototype.onData=function(t){this.chunks.push(t)};Rx.prototype.onEnd=function(t){t===$g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=hM.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function lie(t,e){const r=new Rx(e);if(r.push(t),r.err)throw r.msg||gE[r.err];return r.result}var cie=Rx,Aie=lie,uie={Inflate:cie,inflate:Aie};const{Inflate:die,inflate:hie}=uie;var hj=die,fie=hie;const BM=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;BM[t]=e}const fj=4294967295;function mie(t,e,r){let n=t;for(let s=0;s<r;s++)n=BM[(n^e[s])&255]^n>>>8;return n}function pie(t,e){return(mie(fj,t,e)^fj)>>>0}function mj(t,e,r){const n=t.readUint32(),s=pie(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function SM(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function IM(t,e,r,n){let s=0;for(;s<n;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-n]&255}function FM(t,e,r,n){let s=0;if(r.length===0)for(;s<n;s++)e[s]=t[s];else for(;s<n;s++)e[s]=t[s]+r[s]&255}function kM(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-s]>>1)&255}else{for(;a<s;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-s]+r[a]>>1)&255}}function TM(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-s]&255}else{for(;a<s;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+gie(e[a-s],r[a],r[a-s])&255}}function gie(t,e,r){const n=t+e-r,s=Math.abs(n-t),a=Math.abs(n-e),o=Math.abs(n-r);return s<=a&&s<=o?t:a<=o?e:r}function xie(t,e,r,n,s,a){switch(t){case 0:SM(e,r,s);break;case 1:IM(e,r,s,a);break;case 2:FM(e,r,n,s);break;case 3:kM(e,r,n,s,a);break;case 4:TM(e,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const vie=new Uint16Array([255]),wie=new Uint8Array(vie.buffer),yie=wie[0]===255;function bie(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*s,c=new Uint8Array(n*r*l);let A=0;for(let u=0;u<7;u++){const d=o[u],f=Math.ceil((r-d.x)/d.xStep),h=Math.ceil((n-d.y)/d.yStep);if(f<=0||h<=0)continue;const m=f*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const g=e[A++],y=e.subarray(A,A+m);A+=m;const b=new Uint8Array(m);xie(g,y,b,p,m,l),p.set(b);for(let F=0;F<f;F++){const j=d.x+F*d.xStep,R=d.y+x*d.yStep;if(!(j>=r||R>=n))for(let E=0;E<l;E++)c[(R*r+j)*l+E]=b[F*l+E]}}}if(a===16){const u=new Uint16Array(c.buffer);if(yie)for(let d=0;d<u.length;d++)u[d]=Nie(u[d]);return u}else return c}function Nie(t){return(t&255)<<8|t>>8&255}const Cie=new Uint16Array([255]),_ie=new Uint8Array(Cie.buffer),Eie=_ie[0]===255,Bie=new Uint8Array(0);function pj(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=Math.ceil(a/8)*s,l=Math.ceil(a/8*s*r),c=new Uint8Array(n*l);let A=Bie,u=0,d,f;for(let h=0;h<n;h++){switch(d=e.subarray(u+1,u+1+l),f=c.subarray(h*l,(h+1)*l),e[u]){case 0:SM(d,f,l);break;case 1:IM(d,f,l,o);break;case 2:FM(d,f,A,l);break;case 3:kM(d,f,A,l,o);break;case 4:TM(d,f,A,l,o);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}A=f,u+=l+1}if(a===16){const h=new Uint16Array(c.buffer);if(Eie)for(let m=0;m<h.length;m++)h[m]=Sie(h[m]);return h}else return c}function Sie(t){return(t&255)<<8|t>>8&255}const fw=Uint8Array.of(137,80,78,71,13,10,26,10);function gj(t){if(!Iie(t.readBytes(fw.length)))throw new Error("wrong PNG signature")}function Iie(t){if(t.length<fw.length)return!1;for(let e=0;e<fw.length;e++)if(t[e]!==fw[e])return!1;return!0}const Fie="tEXt",kie=0,jM=new TextDecoder("latin1");function Tie(t){if(Pie(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const jie=/^[\u0000-\u00FF]*$/;function Pie(t){if(!jie.test(t))throw new Error("invalid latin1 text")}function Rie(t,e,r){const n=PM(e);t[n]=Die(e,r-n.length-1)}function PM(t){for(t.mark();t.readByte()!==kie;);const e=t.offset;t.reset();const r=jM.decode(t.readBytes(e-t.offset-1));return t.skip(1),Tie(r),r}function Die(t,e){return jM.decode(t.readBytes(e))}const ho={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},PN={UNKNOWN:-1,DEFLATE:0},xj={UNKNOWN:-1,ADAPTIVE:0},RN={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},iv={NONE:0,BACKGROUND:1,PREVIOUS:2},DN={SOURCE:0,OVER:1};class Lie extends XS{constructor(r,n={}){super(r);bn(this,"_checkCrc");bn(this,"_inflator");bn(this,"_png");bn(this,"_apng");bn(this,"_end");bn(this,"_hasPalette");bn(this,"_palette");bn(this,"_hasTransparency");bn(this,"_transparency");bn(this,"_compressionMethod");bn(this,"_filterMethod");bn(this,"_interlaceMethod");bn(this,"_colorType");bn(this,"_isAnimated");bn(this,"_numberOfFrames");bn(this,"_numberOfPlays");bn(this,"_frames");bn(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new hj,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=PN.UNKNOWN,this._filterMethod=xj.UNKNOWN,this._interlaceMethod=RN.UNKNOWN,this._colorType=ho.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(gj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(gj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Fie:Rie(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?mj(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?mj(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Uie(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case ho.GREYSCALE:s=1;break;case ho.TRUECOLOUR:s=3;break;case ho.INDEXED_COLOUR:s=1;break;case ho.GREYSCALE_ALPHA:s=2;break;case ho.TRUECOLOUR_ALPHA:s=4;break;case ho.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==PN.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let a=0;a<n;a++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ho.GREYSCALE:case ho.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case ho.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case ho.UNKNOWN:case ho.GREYSCALE_ALPHA:case ho.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=PM(this),s=this.readUint8();if(s!==PN.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:fie(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=pj({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(s,a,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case iv.NONE:break;case iv.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let o=0;o<this._png.width;o++){const l=(a*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case iv.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,a=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,A=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:A}};switch(n.blendOp){case DN.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[A+u]}break;case DN.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++){const d=n.data[A+this._png.channels-1]/s,f=u%(this._png.channels-1)===0?1:n.data[A+u],h=Math.floor(d*f+(1-d)*r.data[c+u]);r.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==xj.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===RN.NO_INTERLACE)this._png.data=pj({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===RN.ADAM7)this._png.data=bie({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:iv.NONE,blendOp:DN.SOURCE,data:r}),this._inflator=new hj,this._writingDataChunks=!1}}function Uie(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var vj;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(vj||(vj={}));function Oie(t,e){return new Lie(t,e).decode()}var Br=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function LN(){Br.console&&typeof Br.console.log=="function"&&Br.console.log.apply(Br.console,arguments)}var Mn={log:LN,warn:function(t){Br.console&&(typeof Br.console.warn=="function"?Br.console.warn.apply(Br.console,arguments):LN.call(null,arguments))},error:function(t){Br.console&&(typeof Br.console.error=="function"?Br.console.error.apply(Br.console,arguments):LN(t))}};function UN(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Vd(n.response,e,r)},n.onerror=function(){Mn.error("could not download file")},n.send()}function wj(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function ov(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Vd=Br.saveAs||((typeof window>"u"?"undefined":Bn(window))!=="object"||window!==Br?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Br.URL||Br.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?wj(s.href)?UN(t,e,r):ov(s,s.target="_blank"):ov(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){ov(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(wj(t))UN(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){ov(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:Bn(a)!=="object"&&(Mn.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return UN(t,e,r);var s=t.type==="application/octet-stream",a=/constructor/i.test(Br.HTMLElement)||Br.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&a)&&(typeof FileReader>"u"?"undefined":Bn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(t)}else{var c=Br.URL||Br.webkitURL,A=c.createObjectURL(t);n?n.location=A:location.href=A,n=null,setTimeout(function(){c.revokeObjectURL(A)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function RM(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,o=s.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),A=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),A.length==1&&(A="0"+A),"#"+l+c+A}}var mw=Br.atob.bind(Br),yj=Br.btoa.bind(Br);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function ON(t,e){var r=t[0],n=t[1],s=t[2],a=t[3];r=ei(r,n,s,a,e[0],7,-680876936),a=ei(a,r,n,s,e[1],12,-389564586),s=ei(s,a,r,n,e[2],17,606105819),n=ei(n,s,a,r,e[3],22,-1044525330),r=ei(r,n,s,a,e[4],7,-176418897),a=ei(a,r,n,s,e[5],12,1200080426),s=ei(s,a,r,n,e[6],17,-1473231341),n=ei(n,s,a,r,e[7],22,-45705983),r=ei(r,n,s,a,e[8],7,1770035416),a=ei(a,r,n,s,e[9],12,-1958414417),s=ei(s,a,r,n,e[10],17,-42063),n=ei(n,s,a,r,e[11],22,-1990404162),r=ei(r,n,s,a,e[12],7,1804603682),a=ei(a,r,n,s,e[13],12,-40341101),s=ei(s,a,r,n,e[14],17,-1502002290),r=ti(r,n=ei(n,s,a,r,e[15],22,1236535329),s,a,e[1],5,-165796510),a=ti(a,r,n,s,e[6],9,-1069501632),s=ti(s,a,r,n,e[11],14,643717713),n=ti(n,s,a,r,e[0],20,-373897302),r=ti(r,n,s,a,e[5],5,-701558691),a=ti(a,r,n,s,e[10],9,38016083),s=ti(s,a,r,n,e[15],14,-660478335),n=ti(n,s,a,r,e[4],20,-405537848),r=ti(r,n,s,a,e[9],5,568446438),a=ti(a,r,n,s,e[14],9,-1019803690),s=ti(s,a,r,n,e[3],14,-187363961),n=ti(n,s,a,r,e[8],20,1163531501),r=ti(r,n,s,a,e[13],5,-1444681467),a=ti(a,r,n,s,e[2],9,-51403784),s=ti(s,a,r,n,e[7],14,1735328473),r=ri(r,n=ti(n,s,a,r,e[12],20,-1926607734),s,a,e[5],4,-378558),a=ri(a,r,n,s,e[8],11,-2022574463),s=ri(s,a,r,n,e[11],16,1839030562),n=ri(n,s,a,r,e[14],23,-35309556),r=ri(r,n,s,a,e[1],4,-1530992060),a=ri(a,r,n,s,e[4],11,1272893353),s=ri(s,a,r,n,e[7],16,-155497632),n=ri(n,s,a,r,e[10],23,-1094730640),r=ri(r,n,s,a,e[13],4,681279174),a=ri(a,r,n,s,e[0],11,-358537222),s=ri(s,a,r,n,e[3],16,-722521979),n=ri(n,s,a,r,e[6],23,76029189),r=ri(r,n,s,a,e[9],4,-640364487),a=ri(a,r,n,s,e[12],11,-421815835),s=ri(s,a,r,n,e[15],16,530742520),r=ni(r,n=ri(n,s,a,r,e[2],23,-995338651),s,a,e[0],6,-198630844),a=ni(a,r,n,s,e[7],10,1126891415),s=ni(s,a,r,n,e[14],15,-1416354905),n=ni(n,s,a,r,e[5],21,-57434055),r=ni(r,n,s,a,e[12],6,1700485571),a=ni(a,r,n,s,e[3],10,-1894986606),s=ni(s,a,r,n,e[10],15,-1051523),n=ni(n,s,a,r,e[1],21,-2054922799),r=ni(r,n,s,a,e[8],6,1873313359),a=ni(a,r,n,s,e[15],10,-30611744),s=ni(s,a,r,n,e[6],15,-1560198380),n=ni(n,s,a,r,e[13],21,1309151649),r=ni(r,n,s,a,e[4],6,-145523070),a=ni(a,r,n,s,e[11],10,-1120210379),s=ni(s,a,r,n,e[2],15,718787259),n=ni(n,s,a,r,e[9],21,-343485551),t[0]=ku(r,t[0]),t[1]=ku(n,t[1]),t[2]=ku(s,t[2]),t[3]=ku(a,t[3])}function qy(t,e,r,n,s,a){return e=ku(ku(e,t),ku(n,a)),ku(e<<s|e>>>32-s,r)}function ei(t,e,r,n,s,a,o){return qy(e&r|~e&n,t,e,s,a,o)}function ti(t,e,r,n,s,a,o){return qy(e&n|r&~n,t,e,s,a,o)}function ri(t,e,r,n,s,a,o){return qy(e^r^n,t,e,s,a,o)}function ni(t,e,r,n,s,a,o){return qy(r^(e|~n),t,e,s,a,o)}function DM(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)ON(n,Mie(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(ON(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,ON(n,s),n}function Mie(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var bj="0123456789abcdef".split("");function Qie(t){for(var e="",r=0;r<4;r++)e+=bj[t>>8*r+4&15]+bj[t>>8*r&15];return e}function Vie(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function vE(t){return DM(t).map(Vie).join("")}var Hie=function(t){for(var e=0;e<t.length;e++)t[e]=Qie(t[e]);return t.join("")}(DM("hello"))!="5d41402abc4b2a76b9719d911017c592";function ku(t,e){if(Hie){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function wE(t,e){var r,n,s,a;if(t!==r){for(var o=(s=t,a=1+(256/t.length|0),new Array(a+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var A=0;for(c=0;c<256;c++){var u=l[c];A=(A+u+o.charCodeAt(c))%256,l[c]=l[A],l[A]=u}r=t,n=l}else l=n;var d=e.length,f=0,h=0,m="";for(c=0;c<d;c++)h=(h+(u=l[f=(f+1)%256]))%256,l[f]=l[h],l[h]=u,o=l[(l[f]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Nj={print:4,modify:8,copy:16,"annot-forms":32};function Kf(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(Nj.perm!==void 0)throw new Error("Invalid permission: "+l);s+=Nj[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^s)),this.encryptionKey=vE(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=wE(this.encryptionKey,this.padding)}function qf(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):t[n]}return e}function Cj(t){if(Bn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in e[r]){var o=e[r][a];try{o[0].apply(t,n)}catch(l){Br.console&&Mn.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function zg(t){if(!(this instanceof zg))return new zg(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function LM(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Cu(t,e,r,n,s){if(!(this instanceof Cu))return new Cu(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,LM.call(this,n,s)}function eh(t,e,r,n,s){if(!(this instanceof eh))return new eh(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,LM.call(this,n,s)}function rr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],o=[],l=1,c=16,A="S",u=null;Bn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,a=t.compress||t.compressPdf||a,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),A=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var d=t.putOnlyUsedFonts||!1,f={},h={internal:{},__private__:{}};h.__private__.PubSub=Cj;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(P){m=P};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var g=h.__private__.getPageFormat=function(P){return x[P]};s=s||"a4";var y="compat",b="advanced",F=y;function j(){this.saveGraphicsState(),J(new Ye(X,0,0,-X,0,Oo()*X).toString()+" cm"),this.setFontSize(this.getFontSize()/X),A="n",F=b}function R(){this.restoreGraphicsState(),A="S",F=y}var E=h.__private__.combineFontStyleAndFontWeight=function(P,ce){if(P=="bold"&&ce=="normal"||P=="bold"&&ce==400||P=="normal"&&ce=="italic"||P=="bold"&&ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ce&&(P=ce==400||ce==="normal"?P==="italic"?"italic":"normal":ce!=700&&ce!=="bold"||P!=="normal"?(ce==700?"bold":ce)+""+P:"bold"),P};h.advancedAPI=function(P){var ce=F===y;return ce&&j.call(this),typeof P!="function"||(P(this),ce&&R.call(this)),this},h.compatAPI=function(P){var ce=F===b;return ce&&R.call(this),typeof P!="function"||(P(this),ce&&j.call(this)),this},h.isAdvancedAPI=function(){return F===b};var S,B=function(P){if(F!==b)throw new Error(P+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=h.roundToPrecision=h.__private__.roundToPrecision=function(P,ce){var Qe=e||ce;if(isNaN(P)||isNaN(Qe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return P.toFixed(Qe).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf=typeof c=="number"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,c)}:c==="smart"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,P>-1&&P<1?16:5)}:function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,16)};var k=h.f2=h.__private__.f2=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f2");return U(P,2)},T=h.__private__.f3=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f3");return U(P,3)},L=h.scale=h.__private__.scale=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.scale");return F===y?P*X:F===b?P:void 0},Y=function(P){return L(function(ce){return F===y?Oo()-ce:F===b?ce:void 0}(P))};h.__private__.setPrecision=h.setPrecision=function(P){typeof parseInt(P,10)=="number"&&(e=parseInt(P,10))};var me,ae="00000000000000000000000000000000",fe=h.__private__.getFileId=function(){return ae},de=h.__private__.setFileId=function(P){return ae=P!==void 0&&/^[a-fA-F0-9]{32}$/.test(P)?P.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Rn=new Kf(u.userPermissions,u.userPassword,u.ownerPassword,ae)),ae};h.setFileId=function(P){return de(P),this},h.getFileId=function(){return fe()};var Z=h.__private__.convertDateToPDFDate=function(P){var ce=P.getTimezoneOffset(),Qe=ce<0?"+":"-",Je=Math.floor(Math.abs(ce/60)),lt=Math.abs(ce%60),Bt=[Qe,Q(Je),"'",Q(lt),"'"].join("");return["D:",P.getFullYear(),Q(P.getMonth()+1),Q(P.getDate()),Q(P.getHours()),Q(P.getMinutes()),Q(P.getSeconds()),Bt].join("")},xe=h.__private__.convertPDFDateToDate=function(P){var ce=parseInt(P.substr(2,4),10),Qe=parseInt(P.substr(6,2),10)-1,Je=parseInt(P.substr(8,2),10),lt=parseInt(P.substr(10,2),10),Bt=parseInt(P.substr(12,2),10),kt=parseInt(P.substr(14,2),10);return new Date(ce,Qe,Je,lt,Bt,kt,0)},Be=h.__private__.setCreationDate=function(P){var ce;if(P===void 0&&(P=new Date),P instanceof Date)ce=Z(P);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(P))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ce=P}return me=ce},I=h.__private__.getCreationDate=function(P){var ce=me;return P==="jsDate"&&(ce=xe(me)),ce};h.setCreationDate=function(P){return Be(P),this},h.getCreationDate=function(P){return I(P)};var C,Q=h.__private__.padd2=function(P){return("0"+parseInt(P)).slice(-2)},M=h.__private__.padd2Hex=function(P){return("00"+(P=P.toString())).substr(P.length)},D=0,z=[],O=[],te=0,se=[],we=[],q=!1,Me=O;h.__private__.setCustomOutputDestination=function(P){q=!0,Me=P};var re=function(P){q||(Me=P)};h.__private__.resetCustomOutputDestination=function(){q=!1,Me=O};var J=h.__private__.out=function(P){return P=P.toString(),te+=P.length+1,Me.push(P),Me},K=h.__private__.write=function(P){return J(arguments.length===1?P.toString():Array.prototype.join.call(arguments," "))},ie=h.__private__.getArrayBuffer=function(P){for(var ce=P.length,Qe=new ArrayBuffer(ce),Je=new Uint8Array(Qe);ce--;)Je[ce]=P.charCodeAt(ce);return Qe},pe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return pe};var Ee=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(P){return Ee=F===b?P/X:P,this};var Ue,qe=h.__private__.getFontSize=h.getFontSize=function(){return F===y?Ee:Ee*X},$e=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(P){return $e=P,this},h.__private__.getR2L=h.getR2L=function(){return $e};var st,Se=h.__private__.setZoomMode=function(P){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(P))Ue=P;else if(isNaN(P)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(P)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+P+'" is not recognized.');Ue=P}else Ue=parseInt(P,10)};h.__private__.getZoomMode=function(){return Ue};var ze,Ke=h.__private__.setPageMode=function(P){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(P)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+P+'" is not recognized.');st=P};h.__private__.getPageMode=function(){return st};var be=h.__private__.setLayoutMode=function(P){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(P)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+P+'" is not recognized.');ze=P};h.__private__.getLayoutMode=function(){return ze},h.__private__.setDisplayMode=h.setDisplayMode=function(P,ce,Qe){return Se(P),be(ce),Ke(Qe),this};var le={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(P){if(Object.keys(le).indexOf(P)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return le[P]},h.__private__.getDocumentProperties=function(){return le},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(P){for(var ce in le)le.hasOwnProperty(ce)&&P[ce]&&(le[ce]=P[ce]);return this},h.__private__.setDocumentProperty=function(P,ce){if(Object.keys(le).indexOf(P)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return le[P]=ce};var je,X,G,ye,Oe,_e={},he={},Ce=[],Ze={},Te={},Ge={},at={},wt=null,it=0,xt=[],Lt=new Cj(h),hr=t.hotfixes||[],lr={},gr={},xr=[],Ye=function P(ce,Qe,Je,lt,Bt,kt){if(!(this instanceof P))return new P(ce,Qe,Je,lt,Bt,kt);isNaN(ce)&&(ce=1),isNaN(Qe)&&(Qe=0),isNaN(Je)&&(Je=0),isNaN(lt)&&(lt=1),isNaN(Bt)&&(Bt=0),isNaN(kt)&&(kt=0),this._matrix=[ce,Qe,Je,lt,Bt,kt]};Object.defineProperty(Ye.prototype,"sx",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(Ye.prototype,"shy",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(Ye.prototype,"shx",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(Ye.prototype,"sy",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(Ye.prototype,"tx",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(Ye.prototype,"ty",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(Ye.prototype,"a",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(Ye.prototype,"b",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(Ye.prototype,"c",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(Ye.prototype,"d",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(Ye.prototype,"e",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(Ye.prototype,"f",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(Ye.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ye.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ye.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ye.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ye.prototype.join=function(P){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(P)},Ye.prototype.multiply=function(P){var ce=P.sx*this.sx+P.shy*this.shx,Qe=P.sx*this.shy+P.shy*this.sy,Je=P.shx*this.sx+P.sy*this.shx,lt=P.shx*this.shy+P.sy*this.sy,Bt=P.tx*this.sx+P.ty*this.shx+this.tx,kt=P.tx*this.shy+P.ty*this.sy+this.ty;return new Ye(ce,Qe,Je,lt,Bt,kt)},Ye.prototype.decompose=function(){var P=this.sx,ce=this.shy,Qe=this.shx,Je=this.sy,lt=this.tx,Bt=this.ty,kt=Math.sqrt(P*P+ce*ce),tr=(P/=kt)*Qe+(ce/=kt)*Je;Qe-=P*tr,Je-=ce*tr;var cr=Math.sqrt(Qe*Qe+Je*Je);return tr/=cr,P*(Je/=cr)<ce*(Qe/=cr)&&(P=-P,ce=-ce,tr=-tr,kt=-kt),{scale:new Ye(kt,0,0,cr,0,0),translate:new Ye(1,0,0,1,lt,Bt),rotate:new Ye(P,ce,-ce,P,0,0),skew:new Ye(1,0,tr,1,0,0)}},Ye.prototype.toString=function(P){return this.join(" ")},Ye.prototype.inversed=function(){var P=this.sx,ce=this.shy,Qe=this.shx,Je=this.sy,lt=this.tx,Bt=this.ty,kt=1/(P*Je-ce*Qe),tr=Je*kt,cr=-ce*kt,wr=-Qe*kt,Ir=P*kt;return new Ye(tr,cr,wr,Ir,-tr*lt-wr*Bt,-cr*lt-Ir*Bt)},Ye.prototype.applyToPoint=function(P){var ce=P.x*this.sx+P.y*this.shx+this.tx,Qe=P.x*this.shy+P.y*this.sy+this.ty;return new Lo(ce,Qe)},Ye.prototype.applyToRectangle=function(P){var ce=this.applyToPoint(P),Qe=this.applyToPoint(new Lo(P.x+P.w,P.y+P.h));return new OA(ce.x,ce.y,Qe.x-ce.x,Qe.y-ce.y)},Ye.prototype.clone=function(){var P=this.sx,ce=this.shy,Qe=this.shx,Je=this.sy,lt=this.tx,Bt=this.ty;return new Ye(P,ce,Qe,Je,lt,Bt)},h.Matrix=Ye;var pt=h.matrixMult=function(P,ce){return ce.multiply(P)},Rt=new Ye(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Rt;var Tt=function(P,ce){if(!Te[P]){var Qe=(ce instanceof Cu?"Sh":"P")+(Object.keys(Ze).length+1).toString(10);ce.id=Qe,Te[P]=Qe,Ze[Qe]=ce,Lt.publish("addPattern",ce)}};h.ShadingPattern=Cu,h.TilingPattern=eh,h.addShadingPattern=function(P,ce){return B("addShadingPattern()"),Tt(P,ce),this},h.beginTilingPattern=function(P){B("beginTilingPattern()"),Zl(P.boundingBox[0],P.boundingBox[1],P.boundingBox[2]-P.boundingBox[0],P.boundingBox[3]-P.boundingBox[1],P.matrix)},h.endTilingPattern=function(P,ce){B("endTilingPattern()"),ce.stream=we[C].join(`
`),Tt(P,ce),Lt.publish("endTilingPattern",ce),xr.pop().restore()};var Dt,Xt=h.__private__.newObject=function(){var P=Kt();return oe(P,!0),P},Kt=h.__private__.newObjectDeferred=function(){return D++,z[D]=function(){return te},D},oe=function(P,ce){return ce=typeof ce=="boolean"&&ce,z[P]=te,ce&&J(P+" 0 obj"),P},ne=h.__private__.newAdditionalObject=function(){var P={objId:Kt(),content:""};return se.push(P),P},ue=Kt(),ge=Kt(),Fe=h.__private__.decodeColorString=function(P){var ce=P.split(" ");if(ce.length!==2||ce[1]!=="g"&&ce[1]!=="G")ce.length!==5||ce[4]!=="k"&&ce[4]!=="K"||(ce=[(1-ce[0])*(1-ce[3]),(1-ce[1])*(1-ce[3]),(1-ce[2])*(1-ce[3]),"r"]);else{var Qe=parseFloat(ce[0]);ce=[Qe,Qe,Qe,"r"]}for(var Je="#",lt=0;lt<3;lt++)Je+=("0"+Math.floor(255*parseFloat(ce[lt])).toString(16)).slice(-2);return Je},De=h.__private__.encodeColorString=function(P){var ce;typeof P=="string"&&(P={ch1:P});var Qe=P.ch1,Je=P.ch2,lt=P.ch3,Bt=P.ch4,kt=P.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Qe=="string"&&Qe.charAt(0)!=="#"){var tr=new RM(Qe);if(tr.ok)Qe=tr.toHex();else if(!/^\d*\.?\d*$/.test(Qe))throw new Error('Invalid color "'+Qe+'" passed to jsPDF.encodeColorString.')}if(typeof Qe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Qe)&&(Qe="#"+Qe[1]+Qe[1]+Qe[2]+Qe[2]+Qe[3]+Qe[3]),typeof Qe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Qe)){var cr=parseInt(Qe.substr(1),16);Qe=cr>>16&255,Je=cr>>8&255,lt=255&cr}if(Je===void 0||Bt===void 0&&Qe===Je&&Je===lt)ce=typeof Qe=="string"?Qe+" "+kt[0]:P.precision===2?k(Qe/255)+" "+kt[0]:T(Qe/255)+" "+kt[0];else if(Bt===void 0||Bn(Bt)==="object"){if(Bt&&!isNaN(Bt.a)&&Bt.a===0)return["1.","1.","1.",kt[1]].join(" ");ce=typeof Qe=="string"?[Qe,Je,lt,kt[1]].join(" "):P.precision===2?[k(Qe/255),k(Je/255),k(lt/255),kt[1]].join(" "):[T(Qe/255),T(Je/255),T(lt/255),kt[1]].join(" ")}else ce=typeof Qe=="string"?[Qe,Je,lt,Bt,kt[2]].join(" "):P.precision===2?[k(Qe),k(Je),k(lt),k(Bt),kt[2]].join(" "):[T(Qe),T(Je),T(lt),T(Bt),kt[2]].join(" ");return ce},We=h.__private__.getFilters=function(){return o},rt=h.__private__.putStream=function(P){var ce=(P=P||{}).data||"",Qe=P.filters||We(),Je=P.alreadyAppliedFilters||[],lt=P.addLength1||!1,Bt=ce.length,kt=P.objectId,tr=function(bs){return bs};if(u!==null&&kt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(tr=Rn.encryptor(kt,0));var cr={};Qe===!0&&(Qe=["FlateEncode"]);var wr=P.additionalKeyValues||[],Ir=(cr=rr.API.processDataByFilters!==void 0?rr.API.processDataByFilters(ce,Qe):{data:ce,reverseChain:[]}).reverseChain+(Array.isArray(Je)?Je.join(" "):Je.toString());if(cr.data.length!==0&&(wr.push({key:"Length",value:cr.data.length}),lt===!0&&wr.push({key:"Length1",value:Bt})),Ir.length!=0)if(Ir.split("/").length-1==1)wr.push({key:"Filter",value:Ir});else{wr.push({key:"Filter",value:"["+Ir+"]"});for(var Yr=0;Yr<wr.length;Yr+=1)if(wr[Yr].key==="DecodeParms"){for(var pn=[],hs=0;hs<cr.reverseChain.split("/").length-1;hs+=1)pn.push("null");pn.push(wr[Yr].value),wr[Yr].value="["+pn.join(" ")+"]"}}J("<<");for(var vn=0;vn<wr.length;vn++)J("/"+wr[vn].key+" "+wr[vn].value);J(">>"),cr.data.length!==0&&(J("stream"),J(tr(cr.data)),J("endstream"))},Le=h.__private__.putPage=function(P){var ce=P.number,Qe=P.data,Je=P.objId,lt=P.contentsObjId;oe(Je,!0),J("<</Type /Page"),J("/Parent "+P.rootDictionaryObjId+" 0 R"),J("/Resources "+P.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(S(P.mediaBox.bottomLeftX))+" "+parseFloat(S(P.mediaBox.bottomLeftY))+" "+S(P.mediaBox.topRightX)+" "+S(P.mediaBox.topRightY)+"]"),P.cropBox!==null&&J("/CropBox ["+S(P.cropBox.bottomLeftX)+" "+S(P.cropBox.bottomLeftY)+" "+S(P.cropBox.topRightX)+" "+S(P.cropBox.topRightY)+"]"),P.bleedBox!==null&&J("/BleedBox ["+S(P.bleedBox.bottomLeftX)+" "+S(P.bleedBox.bottomLeftY)+" "+S(P.bleedBox.topRightX)+" "+S(P.bleedBox.topRightY)+"]"),P.trimBox!==null&&J("/TrimBox ["+S(P.trimBox.bottomLeftX)+" "+S(P.trimBox.bottomLeftY)+" "+S(P.trimBox.topRightX)+" "+S(P.trimBox.topRightY)+"]"),P.artBox!==null&&J("/ArtBox ["+S(P.artBox.bottomLeftX)+" "+S(P.artBox.bottomLeftY)+" "+S(P.artBox.topRightX)+" "+S(P.artBox.topRightY)+"]"),typeof P.userUnit=="number"&&P.userUnit!==1&&J("/UserUnit "+P.userUnit),Lt.publish("putPage",{objId:Je,pageContext:xt[ce],pageNumber:ce,page:Qe}),J("/Contents "+lt+" 0 R"),J(">>"),J("endobj");var Bt=Qe.join(`
`);return F===b&&(Bt+=`
Q`),oe(lt,!0),rt({data:Bt,filters:We(),objectId:lt}),J("endobj"),Je},Xe=h.__private__.putPages=function(){var P,ce,Qe=[];for(P=1;P<=it;P++)xt[P].objId=Kt(),xt[P].contentsObjId=Kt();for(P=1;P<=it;P++)Qe.push(Le({number:P,data:we[P],objId:xt[P].objId,contentsObjId:xt[P].contentsObjId,mediaBox:xt[P].mediaBox,cropBox:xt[P].cropBox,bleedBox:xt[P].bleedBox,trimBox:xt[P].trimBox,artBox:xt[P].artBox,userUnit:xt[P].userUnit,rootDictionaryObjId:ue,resourceDictionaryObjId:ge}));oe(ue,!0),J("<</Type /Pages");var Je="/Kids [";for(ce=0;ce<it;ce++)Je+=Qe[ce]+" 0 R ";J(Je+"]"),J("/Count "+it),J(">>"),J("endobj"),Lt.publish("postPutPages")},et=function(P){Lt.publish("putFont",{font:P,out:J,newObject:Xt,putStream:rt}),P.isAlreadyPutted!==!0&&(P.objectNumber=Xt(),J("<<"),J("/Type /Font"),J("/BaseFont /"+qf(P.postScriptName)),J("/Subtype /Type1"),typeof P.encoding=="string"&&J("/Encoding /"+P.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},dt=function(P){P.objectNumber=Xt();var ce=[];ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Form"}),ce.push({key:"BBox",value:"["+[S(P.x),S(P.y),S(P.x+P.width),S(P.y+P.height)].join(" ")+"]"}),ce.push({key:"Matrix",value:"["+P.matrix.toString()+"]"});var Qe=P.pages[1].join(`
`);rt({data:Qe,additionalKeyValues:ce,objectId:P.objectNumber}),J("endobj")},vt=function(P,ce){ce||(ce=21);var Qe=Xt(),Je=function(kt,tr){var cr,wr=[],Ir=1/(tr-1);for(cr=0;cr<1;cr+=Ir)wr.push(cr);if(wr.push(1),kt[0].offset!=0){var Yr={offset:0,color:kt[0].color};kt.unshift(Yr)}if(kt[kt.length-1].offset!=1){var pn={offset:1,color:kt[kt.length-1].color};kt.push(pn)}for(var hs="",vn=0,bs=0;bs<wr.length;bs++){for(cr=wr[bs];cr>kt[vn+1].offset;)vn++;var fs=kt[vn].offset,Ns=(cr-fs)/(kt[vn+1].offset-fs),ms=kt[vn].color,Ui=kt[vn+1].color;hs+=M(Math.round((1-Ns)*ms[0]+Ns*Ui[0]).toString(16))+M(Math.round((1-Ns)*ms[1]+Ns*Ui[1]).toString(16))+M(Math.round((1-Ns)*ms[2]+Ns*Ui[2]).toString(16))}return hs.trim()}(P.colors,ce),lt=[];lt.push({key:"FunctionType",value:"0"}),lt.push({key:"Domain",value:"[0.0 1.0]"}),lt.push({key:"Size",value:"["+ce+"]"}),lt.push({key:"BitsPerSample",value:"8"}),lt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),lt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rt({data:Je,additionalKeyValues:lt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Qe}),J("endobj"),P.objectNumber=Xt(),J("<< /ShadingType "+P.type),J("/ColorSpace /DeviceRGB");var Bt="/Coords ["+S(parseFloat(P.coords[0]))+" "+S(parseFloat(P.coords[1]))+" ";P.type===2?Bt+=S(parseFloat(P.coords[2]))+" "+S(parseFloat(P.coords[3])):Bt+=S(parseFloat(P.coords[2]))+" "+S(parseFloat(P.coords[3]))+" "+S(parseFloat(P.coords[4]))+" "+S(parseFloat(P.coords[5])),J(Bt+="]"),P.matrix&&J("/Matrix ["+P.matrix.toString()+"]"),J("/Function "+Qe+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},Nt=function(P,ce){var Qe=Kt(),Je=Xt();ce.push({resourcesOid:Qe,objectOid:Je}),P.objectNumber=Je;var lt=[];lt.push({key:"Type",value:"/Pattern"}),lt.push({key:"PatternType",value:"1"}),lt.push({key:"PaintType",value:"1"}),lt.push({key:"TilingType",value:"1"}),lt.push({key:"BBox",value:"["+P.boundingBox.map(S).join(" ")+"]"}),lt.push({key:"XStep",value:S(P.xStep)}),lt.push({key:"YStep",value:S(P.yStep)}),lt.push({key:"Resources",value:Qe+" 0 R"}),P.matrix&&lt.push({key:"Matrix",value:"["+P.matrix.toString()+"]"}),rt({data:P.stream,additionalKeyValues:lt,objectId:P.objectNumber}),J("endobj")},At=function(P){for(var ce in P.objectNumber=Xt(),J("<<"),P)switch(ce){case"opacity":J("/ca "+k(P[ce]));break;case"stroke-opacity":J("/CA "+k(P[ce]))}J(">>"),J("endobj")},yt=function(P){oe(P.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ce in J("/Font <<"),_e)_e.hasOwnProperty(ce)&&(d===!1||d===!0&&f.hasOwnProperty(ce))&&J("/"+ce+" "+_e[ce].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(Ze).length>0){for(var ce in J("/Shading <<"),Ze)Ze.hasOwnProperty(ce)&&Ze[ce]instanceof Cu&&Ze[ce].objectNumber>=0&&J("/"+ce+" "+Ze[ce].objectNumber+" 0 R");Lt.publish("putShadingPatternDict"),J(">>")}}(),function(ce){if(Object.keys(Ze).length>0){for(var Qe in J("/Pattern <<"),Ze)Ze.hasOwnProperty(Qe)&&Ze[Qe]instanceof h.TilingPattern&&Ze[Qe].objectNumber>=0&&Ze[Qe].objectNumber<ce&&J("/"+Qe+" "+Ze[Qe].objectNumber+" 0 R");Lt.publish("putTilingPatternDict"),J(">>")}}(P.objectOid),function(){if(Object.keys(Ge).length>0){var ce;for(ce in J("/ExtGState <<"),Ge)Ge.hasOwnProperty(ce)&&Ge[ce].objectNumber>=0&&J("/"+ce+" "+Ge[ce].objectNumber+" 0 R");Lt.publish("putGStateDict"),J(">>")}}(),function(){for(var ce in J("/XObject <<"),lr)lr.hasOwnProperty(ce)&&lr[ce].objectNumber>=0&&J("/"+ce+" "+lr[ce].objectNumber+" 0 R");Lt.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},Zt=function(P){he[P.fontName]=he[P.fontName]||{},he[P.fontName][P.fontStyle]=P.id},Rr=function(P,ce,Qe,Je,lt){var Bt={id:"F"+(Object.keys(_e).length+1).toString(10),postScriptName:P,fontName:ce,fontStyle:Qe,encoding:Je,isStandardFont:lt||!1,metadata:{}};return Lt.publish("addFont",{font:Bt,instance:this}),_e[Bt.id]=Bt,Zt(Bt),Bt.id},Nr=h.__private__.pdfEscape=h.pdfEscape=function(P,ce){return function(Qe,Je){var lt,Bt,kt,tr,cr,wr,Ir,Yr,pn;if(kt=(Je=Je||{}).sourceEncoding||"Unicode",cr=Je.outputEncoding,(Je.autoencode||cr)&&_e[je].metadata&&_e[je].metadata[kt]&&_e[je].metadata[kt].encoding&&(tr=_e[je].metadata[kt].encoding,!cr&&_e[je].encoding&&(cr=_e[je].encoding),!cr&&tr.codePages&&(cr=tr.codePages[0]),typeof cr=="string"&&(cr=tr[cr]),cr)){for(Ir=!1,wr=[],lt=0,Bt=Qe.length;lt<Bt;lt++)(Yr=cr[Qe.charCodeAt(lt)])?wr.push(String.fromCharCode(Yr)):wr.push(Qe[lt]),wr[lt].charCodeAt(0)>>8&&(Ir=!0);Qe=wr.join("")}for(lt=Qe.length;Ir===void 0&&lt!==0;)Qe.charCodeAt(lt-1)>>8&&(Ir=!0),lt--;if(!Ir)return Qe;for(wr=Je.noBOM?[]:[254,255],lt=0,Bt=Qe.length;lt<Bt;lt++){if((pn=(Yr=Qe.charCodeAt(lt))>>8)>>8)throw new Error("Character at position "+lt+" of string '"+Qe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");wr.push(pn),wr.push(Yr-(pn<<8))}return String.fromCharCode.apply(void 0,wr)}(P,ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Jr=h.__private__.beginPage=function(P){we[++it]=[],xt[it]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(P[0]),topRightY:Number(P[1])}},to(it),re(we[C])},Di=function(P,ce){var Qe,Je,lt;switch(r=ce||r,typeof P=="string"&&(Qe=g(P.toLowerCase()),Array.isArray(Qe)&&(Je=Qe[0],lt=Qe[1])),Array.isArray(P)&&(Je=P[0]*X,lt=P[1]*X),isNaN(Je)&&(Je=s[0],lt=s[1]),(Je>14400||lt>14400)&&(Mn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Je=Math.min(14400,Je),lt=Math.min(14400,lt)),s=[Je,lt],r.substr(0,1)){case"l":lt>Je&&(s=[lt,Je]);break;case"p":Je>lt&&(s=[lt,Je])}Jr(s),vr(DA),J(gl),kn!==0&&J(kn+" J"),Nd!==0&&J(Nd+" j"),Lt.publish("addPage",{pageNumber:it})},eo=function(P){P>0&&P<=it&&(we.splice(P,1),xt.splice(P,1),it--,C>it&&(C=it),this.setPage(C))},to=function(P){P>0&&P<=it&&(C=P)},xi=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return we.length-1},ml=function(P,ce,Qe){var Je,lt=void 0;return Qe=Qe||{},P=P!==void 0?P:_e[je].fontName,ce=ce!==void 0?ce:_e[je].fontStyle,Je=P.toLowerCase(),he[Je]!==void 0&&he[Je][ce]!==void 0?lt=he[Je][ce]:he[P]!==void 0&&he[P][ce]!==void 0?lt=he[P][ce]:Qe.disableWarning===!1&&Mn.warn("Unable to look up font label for font '"+P+"', '"+ce+"'. Refer to getFontList() for available fonts."),lt||Qe.noFallback||(lt=he.times[ce])==null&&(lt=he.times.normal),lt},ts=h.__private__.putInfo=function(){var P=Xt(),ce=function(Je){return Je};for(var Qe in u!==null&&(ce=Rn.encryptor(P,0)),J("<<"),J("/Producer ("+Nr(ce("jsPDF "+rr.version))+")"),le)le.hasOwnProperty(Qe)&&le[Qe]&&J("/"+Qe.substr(0,1).toUpperCase()+Qe.substr(1)+" ("+Nr(ce(le[Qe]))+")");J("/CreationDate ("+Nr(ce(me))+")"),J(">>"),J("endobj")},Jl=h.__private__.putCatalog=function(P){var ce=(P=P||{}).rootDictionaryObjId||ue;switch(Xt(),J("<<"),J("/Type /Catalog"),J("/Pages "+ce+" 0 R"),Ue||(Ue="fullwidth"),Ue){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Qe=""+Ue;Qe.substr(Qe.length-1)==="%"&&(Ue=parseInt(Ue)/100),typeof Ue=="number"&&J("/OpenAction [3 0 R /XYZ null null "+k(Ue)+"]")}switch(ze||(ze="continuous"),ze){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}st&&J("/PageMode /"+st),Lt.publish("putCatalog"),J(">>"),J("endobj")},rf=h.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(D+1)),J("/Root "+D+" 0 R"),J("/Info "+(D-1)+" 0 R"),u!==null&&J("/Encrypt "+Rn.oid+" 0 R"),J("/ID [ <"+ae+"> <"+ae+"> ]"),J(">>")},ds=h.__private__.putHeader=function(){J("%PDF-"+m),J("%")},nf=h.__private__.putXRef=function(){var P="0000000000";J("xref"),J("0 "+(D+1)),J("0000000000 65535 f ");for(var ce=1;ce<=D;ce++)typeof z[ce]=="function"?J((P+z[ce]()).slice(-10)+" 00000 n "):z[ce]!==void 0?J((P+z[ce]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},jo=h.__private__.buildDocument=function(){var P;D=0,te=0,O=[],z=[],se=[],ue=Kt(),ge=Kt(),re(O),Lt.publish("buildDocument"),ds(),Xe(),function(){Lt.publish("putAdditionalObjects");for(var Qe=0;Qe<se.length;Qe++){var Je=se[Qe];oe(Je.objId,!0),J(Je.content),J("endobj")}Lt.publish("postPutAdditionalObjects")}(),P=[],function(){for(var Qe in _e)_e.hasOwnProperty(Qe)&&(d===!1||d===!0&&f.hasOwnProperty(Qe))&&et(_e[Qe])}(),function(){var Qe;for(Qe in Ge)Ge.hasOwnProperty(Qe)&&At(Ge[Qe])}(),function(){for(var Qe in lr)lr.hasOwnProperty(Qe)&&dt(lr[Qe])}(),function(Qe){var Je;for(Je in Ze)Ze.hasOwnProperty(Je)&&(Ze[Je]instanceof Cu?vt(Ze[Je]):Ze[Je]instanceof eh&&Nt(Ze[Je],Qe))}(P),Lt.publish("putResources"),P.forEach(yt),yt({resourcesOid:ge,objectOid:Number.MAX_SAFE_INTEGER}),Lt.publish("postPutResources"),u!==null&&(Rn.oid=Xt(),J("<<"),J("/Filter /Standard"),J("/V "+Rn.v),J("/R "+Rn.r),J("/U <"+Rn.toHexString(Rn.U)+">"),J("/O <"+Rn.toHexString(Rn.O)+">"),J("/P "+Rn.P),J(">>"),J("endobj")),ts(),Jl();var ce=te;return nf(),rf(),J("startxref"),J(""+ce),J("%%EOF"),re(we[C]),O.join(`
`)},jc=h.__private__.getBlob=function(P){return new Blob([ie(P)],{type:"application/pdf"})},wd=h.output=h.__private__.output=(Dt=function(P,ce){switch(typeof(ce=ce||{})=="string"?ce={filename:ce}:ce.filename=ce.filename||"generated.pdf",P){case void 0:return jo();case"save":h.save(ce.filename);break;case"arraybuffer":return ie(jo());case"blob":return jc(jo());case"bloburi":case"bloburl":if(Br.URL!==void 0&&typeof Br.URL.createObjectURL=="function")return Br.URL&&Br.URL.createObjectURL(jc(jo()))||void 0;Mn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Qe="",Je=jo();try{Qe=yj(Je)}catch{Qe=yj(unescape(encodeURIComponent(Je)))}return"data:application/pdf;filename="+ce.filename+";base64,"+Qe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Br)==="[object Window]"){var lt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Bt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ce.pdfObjectUrl&&(lt=ce.pdfObjectUrl,Bt="");var kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+lt+'"'+Bt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ce)+");<\/script></body></html>",tr=Br.open();return tr!==null&&tr.document.write(kt),tr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Br)==="[object Window]"){var cr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ce.filename+'" width="500px" height="400px" /></body></html>',wr=Br.open();if(wr!==null){wr.document.write(cr);var Ir=this;wr.document.documentElement.querySelector("#pdfViewer").onload=function(){wr.document.title=ce.filename,wr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ir.output("bloburl"))}}return wr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Br)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Yr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ce)+'"></iframe></body></html>',pn=Br.open();if(pn!==null&&(pn.document.write(Yr),pn.document.title=ce.filename),pn||typeof safari>"u")return pn;break;case"datauri":case"dataurl":return Br.document.location.href=this.output("datauristring",ce);default:return null}},Dt.foo=function(){try{return Dt.apply(this,arguments)}catch(Qe){var P=Qe.stack||"";~P.indexOf(" at ")&&(P=P.split(" at ")[1]);var ce="Error in function "+P.split(`
`)[0].split("<")[0]+": "+Qe.message;if(!Br.console)throw new Error(ce);Br.console.error(ce,Qe),Br.alert&&alert(ce)}},Dt.foo.bar=Dt,Dt.foo),Li=function(P){return Array.isArray(hr)===!0&&hr.indexOf(P)>-1};switch(n){case"pt":X=1;break;case"mm":X=72/25.4;break;case"cm":X=72/2.54;break;case"in":X=72;break;case"px":X=Li("px_scaling")==1?.75:96/72;break;case"pc":case"em":X=12;break;case"ex":X=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);X=n}var Rn=null;Be(),de();var Ys=h.__private__.getPageInfo=h.getPageInfo=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:xt[P].objId,pageNumber:P,pageContext:xt[P]}},Pc=h.__private__.getPageInfoByObjId=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ce in xt)if(xt[ce].objId===P)break;return Ys(ce)},RA=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:xt[C].objId,pageNumber:C,pageContext:xt[C]}};h.addPage=function(){return Di.apply(this,arguments),this},h.setPage=function(){return to.apply(this,arguments),re.call(this,we[C]),this},h.insertPage=function(P){return this.addPage(),this.movePage(C,P),this},h.movePage=function(P,ce){var Qe,Je;if(P>ce){Qe=we[P],Je=xt[P];for(var lt=P;lt>ce;lt--)we[lt]=we[lt-1],xt[lt]=xt[lt-1];we[ce]=Qe,xt[ce]=Je,this.setPage(ce)}else if(P<ce){Qe=we[P],Je=xt[P];for(var Bt=P;Bt<ce;Bt++)we[Bt]=we[Bt+1],xt[Bt]=xt[Bt+1];we[ce]=Qe,xt[ce]=Je,this.setPage(ce)}return this},h.deletePage=function(){return eo.apply(this,arguments),this},h.__private__.text=h.text=function(P,ce,Qe,Je,lt){var Bt,kt,tr,cr,wr,Ir,Yr,pn,hs,vn=(Je=Je||{}).scope||this;if(typeof P=="number"&&typeof ce=="number"&&(typeof Qe=="string"||Array.isArray(Qe))){var bs=Qe;Qe=ce,ce=P,P=bs}if(arguments[3]instanceof Ye==0?(tr=arguments[4],cr=arguments[5],Bn(Yr=arguments[3])==="object"&&Yr!==null||(typeof tr=="string"&&(cr=tr,tr=null),typeof Yr=="string"&&(cr=Yr,Yr=null),typeof Yr=="number"&&(tr=Yr,Yr=null),Je={flags:Yr,angle:tr,align:cr})):(B("The transform parameter of text() with a Matrix value"),hs=lt),isNaN(ce)||isNaN(Qe)||P==null)throw new Error("Invalid arguments passed to jsPDF.text");if(P.length===0)return vn;var fs,Ns="",ms=typeof Je.lineHeightFactor=="number"?Je.lineHeightFactor:Yl,Ui=vn.internal.scaleFactor;function Mo(gn){return gn=gn.split("	").join(Array(Je.TabLen||9).join(" ")),Nr(gn,Yr)}function Qo(gn){for(var Dn,js=gn.concat(),Zs=[],Mc=js.length;Mc--;)typeof(Dn=js.shift())=="string"?Zs.push(Dn):Array.isArray(gn)&&(Dn.length===1||Dn[1]===void 0&&Dn[2]===void 0)?Zs.push(Dn[0]):Zs.push([Dn[0],Dn[1],Dn[2]]);return Zs}function w(gn,Dn){var js;if(typeof gn=="string")js=Dn(gn)[0];else if(Array.isArray(gn)){for(var Zs,Mc,_m=gn.concat(),df=[],qx=_m.length;qx--;)typeof(Zs=_m.shift())=="string"?df.push(Dn(Zs)[0]):Array.isArray(Zs)&&typeof Zs[0]=="string"&&(Mc=Dn(Zs[0],Zs[1],Zs[2]),df.push([Mc[0],Mc[1],Mc[2]]));js=df}return js}var H=!1,ee=!0;if(typeof P=="string")H=!0;else if(Array.isArray(P)){var ke=P.concat();kt=[];for(var ct,gt=ke.length;gt--;)(typeof(ct=ke.shift())!="string"||Array.isArray(ct)&&typeof ct[0]!="string")&&(ee=!1);H=ee}if(H===!1)throw new Error('Type of text must be string or Array. "'+P+'" is not recognized.');typeof P=="string"&&(P=P.match(/[\r?\n]/)?P.split(/\r\n|\r|\n/g):[P]);var Ht=Ee/vn.internal.scaleFactor,nn=Ht*(ms-1);switch(Je.baseline){case"bottom":Qe-=nn;break;case"top":Qe+=Ht-nn;break;case"hanging":Qe+=Ht-2*nn;break;case"middle":Qe+=Ht/2-nn}if((Ir=Je.maxWidth||0)>0&&(typeof P=="string"?P=vn.splitTextToSize(P,Ir):Object.prototype.toString.call(P)==="[object Array]"&&(P=P.reduce(function(gn,Dn){return gn.concat(vn.splitTextToSize(Dn,Ir))},[]))),Bt={text:P,x:ce,y:Qe,options:Je,mutex:{pdfEscape:Nr,activeFontKey:je,fonts:_e,activeFontSize:Ee}},Lt.publish("preProcessText",Bt),P=Bt.text,tr=(Je=Bt.options).angle,hs instanceof Ye==0&&tr&&typeof tr=="number"){tr*=Math.PI/180,Je.rotationDirection===0&&(tr=-tr),F===b&&(tr=-tr);var ps=Math.cos(tr),Kr=Math.sin(tr);hs=new Ye(ps,Kr,-Kr,ps,0,0)}else tr&&tr instanceof Ye&&(hs=tr);F!==b||hs||(hs=Rt),(wr=Je.charSpace||Do)!==void 0&&(Ns+=S(L(wr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(pn=Je.horizontalScale)!==void 0&&(Ns+=S(100*pn)+` Tz
`),Je.lang;var dn=-1,Qn=Je.renderingMode!==void 0?Je.renderingMode:Je.stroke,no=vn.internal.getCurrentPageInfo().pageContext;switch(Qn){case 0:case!1:case"fill":dn=0;break;case 1:case!0:case"stroke":dn=1;break;case 2:case"fillThenStroke":dn=2;break;case 3:case"invisible":dn=3;break;case 4:case"fillAndAddForClipping":dn=4;break;case 5:case"strokeAndAddPathForClipping":dn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":dn=6;break;case 7:case"addToPathForClipping":dn=7}var Wa=no.usedRenderingMode!==void 0?no.usedRenderingMode:-1;dn!==-1?Ns+=dn+` Tr
`:Wa!==-1&&(Ns+=`0 Tr
`),dn!==-1&&(no.usedRenderingMode=dn),cr=Je.align||"left";var Fa,xl=Ee*ms,xm=vn.internal.pageSize.getWidth(),vm=_e[je];wr=Je.charSpace||Do,Ir=Je.maxWidth||0,Yr=Object.assign({autoencode:!0,noBOM:!0},Je.flags);var QA=[],Ed=function(gn){return vn.getStringUnitWidth(gn,{font:vm,charSpace:wr,fontSize:Ee,doKerning:!1})*Ee/Ui};if(Object.prototype.toString.call(P)==="[object Array]"){var so;kt=Qo(P),cr!=="left"&&(Fa=kt.map(Ed));var ao,VA=0;if(cr==="right"){ce-=Fa[0],P=[],gt=kt.length;for(var Oc=0;Oc<gt;Oc++)Oc===0?(ao=fa(ce),so=pl(Qe)):(ao=L(VA-Fa[Oc]),so=-xl),P.push([kt[Oc],ao,so]),VA=Fa[Oc]}else if(cr==="center"){ce-=Fa[0]/2,P=[],gt=kt.length;for(var HA=0;HA<gt;HA++)HA===0?(ao=fa(ce),so=pl(Qe)):(ao=L((VA-Fa[HA])/2),so=-xl),P.push([kt[HA],ao,so]),VA=Fa[HA]}else if(cr==="left"){P=[],gt=kt.length;for(var wm=0;wm<gt;wm++)P.push(kt[wm])}else if(cr==="justify"&&vm.encoding==="Identity-H"){P=[],gt=kt.length,Ir=Ir!==0?Ir:xm;for(var uf=0,Ts=0;Ts<gt;Ts++)if(so=Ts===0?pl(Qe):-xl,ao=Ts===0?fa(ce):uf,Ts<gt-1){var Kx=L((Ir-Fa[Ts])/(kt[Ts].split(" ").length-1)),tc=kt[Ts].split(" ");P.push([tc[0]+" ",ao,so]),uf=0;for(var rc=1;rc<tc.length;rc++){var ym=(Ed(tc[rc-1]+" "+tc[rc])-Ed(tc[rc]))*Ui+Kx;rc==tc.length-1?P.push([tc[rc],ym,0]):P.push([tc[rc]+" ",ym,0]),uf-=ym}}else P.push([kt[Ts],ao,so]);P.push(["",uf,0])}else{if(cr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(P=[],gt=kt.length,Ir=Ir!==0?Ir:xm,Ts=0;Ts<gt;Ts++){so=Ts===0?pl(Qe):-xl,ao=Ts===0?fa(ce):0;var bm=kt[Ts].split(" ").length-1,Nm=bm>0?(Ir-Fa[Ts])/bm:0;Ts<gt-1?QA.push(S(L(Nm))):QA.push(0),P.push([kt[Ts],ao,so])}}}(typeof Je.R2L=="boolean"?Je.R2L:$e)===!0&&(P=w(P,function(gn,Dn,js){return[gn.split("").reverse().join(""),Dn,js]})),Bt={text:P,x:ce,y:Qe,options:Je,mutex:{pdfEscape:Nr,activeFontKey:je,fonts:_e,activeFontSize:Ee}},Lt.publish("postProcessText",Bt),P=Bt.text,fs=Bt.mutex.isHex||!1;var Cm=_e[je].encoding;Cm!=="WinAnsiEncoding"&&Cm!=="StandardEncoding"||(P=w(P,function(gn,Dn,js){return[Mo(gn),Dn,js]})),kt=Qo(P),P=[];for(var KA,qA,GA,Bd=Array.isArray(kt[0])?1:0,$A="",Sd=function(gn,Dn,js){var Zs="";return js instanceof Ye?(js=typeof Je.angle=="number"?pt(js,new Ye(1,0,0,1,gn,Dn)):pt(new Ye(1,0,0,1,gn,Dn),js),F===b&&(js=pt(new Ye(1,0,0,-1,0,0),js)),Zs=js.join(" ")+` Tm
`):Zs=S(gn)+" "+S(Dn)+` Td
`,Zs},Vo=0;Vo<kt.length;Vo++){switch($A="",Bd){case 1:GA=(fs?"<":"(")+kt[Vo][0]+(fs?">":")"),KA=parseFloat(kt[Vo][1]),qA=parseFloat(kt[Vo][2]);break;case 0:GA=(fs?"<":"(")+kt[Vo]+(fs?">":")"),KA=fa(ce),qA=pl(Qe)}QA!==void 0&&QA[Vo]!==void 0&&($A=QA[Vo]+` Tw
`),Vo===0?P.push($A+Sd(KA,qA,hs)+GA):Bd===0?P.push($A+GA):Bd===1&&P.push($A+Sd(KA,qA,hs)+GA)}P=Bd===0?P.join(` Tj
T* `):P.join(` Tj
`),P+=` Tj
`;var nc=`BT
/`;return nc+=je+" "+Ee+` Tf
`,nc+=S(Ee*ms)+` TL
`,nc+=ro+`
`,nc+=Ns,nc+=P,J(nc+="ET"),f[je]=!0,vn};var sf=h.__private__.clip=h.clip=function(P){return J(P==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return sf("evenodd")},h.__private__.discardPath=h.discardPath=function(){return J("n"),this};var Xr=h.__private__.isValidStyle=function(P){var ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(P)!==-1&&(ce=!0),ce};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(P){return Xr(P)&&(A=P),this};var Rc=h.__private__.getStyle=h.getStyle=function(P){var ce=A;switch(P){case"D":case"S":ce="S";break;case"F":ce="f";break;case"FD":case"DF":ce="B";break;case"f":case"f*":case"B":case"B*":ce=P}return ce},Xl=h.close=function(){return J("h"),this};h.stroke=function(){return J("S"),this},h.fill=function(P){return Po("f",P),this},h.fillEvenOdd=function(P){return Po("f*",P),this},h.fillStroke=function(P){return Po("B",P),this},h.fillStrokeEvenOdd=function(P){return Po("B*",P),this};var Po=function(P,ce){Bn(ce)==="object"?dm(ce,P):J(P)},Dc=function(P){P===null||F===b&&P===void 0||(P=Rc(P),J(P))};function af(P,ce,Qe,Je,lt){var Bt=new eh(ce||this.boundingBox,Qe||this.xStep,Je||this.yStep,this.gState,lt||this.matrix);Bt.stream=this.stream;var kt=P+"$$"+this.cloneIndex+++"$$";return Tt(kt,Bt),Bt}var dm=function(P,ce){var Qe=Te[P.key],Je=Ze[Qe];if(Je instanceof Cu)J("q"),J(hm(ce)),Je.gState&&h.setGState(Je.gState),J(P.matrix.toString()+" cm"),J("/"+Qe+" sh"),J("Q");else if(Je instanceof eh){var lt=new Ye(1,0,0,-1,0,Oo());P.matrix&&(lt=lt.multiply(P.matrix||Rt),Qe=af.call(Je,P.key,P.boundingBox,P.xStep,P.yStep,lt).id),J("q"),J("/Pattern cs"),J("/"+Qe+" scn"),Je.gState&&h.setGState(Je.gState),J(ce),J("Q")}},hm=function(P){switch(P){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},yd=h.moveTo=function(P,ce){return J(S(L(P))+" "+S(Y(ce))+" m"),this},of=h.lineTo=function(P,ce){return J(S(L(P))+" "+S(Y(ce))+" l"),this},Ia=h.curveTo=function(P,ce,Qe,Je,lt,Bt){return J([S(L(P)),S(Y(ce)),S(L(Qe)),S(Y(Je)),S(L(lt)),S(Y(Bt)),"c"].join(" ")),this};h.__private__.line=h.line=function(P,ce,Qe,Je,lt){if(isNaN(P)||isNaN(ce)||isNaN(Qe)||isNaN(Je)||!Xr(lt))throw new Error("Invalid arguments passed to jsPDF.line");return F===y?this.lines([[Qe-P,Je-ce]],P,ce,[1,1],lt||"S"):this.lines([[Qe-P,Je-ce]],P,ce,[1,1]).stroke()},h.__private__.lines=h.lines=function(P,ce,Qe,Je,lt,Bt){var kt,tr,cr,wr,Ir,Yr,pn,hs,vn,bs,fs,Ns;if(typeof P=="number"&&(Ns=Qe,Qe=ce,ce=P,P=Ns),Je=Je||[1,1],Bt=Bt||!1,isNaN(ce)||isNaN(Qe)||!Array.isArray(P)||!Array.isArray(Je)||!Xr(lt)||typeof Bt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(yd(ce,Qe),kt=Je[0],tr=Je[1],wr=P.length,bs=ce,fs=Qe,cr=0;cr<wr;cr++)(Ir=P[cr]).length===2?(bs=Ir[0]*kt+bs,fs=Ir[1]*tr+fs,of(bs,fs)):(Yr=Ir[0]*kt+bs,pn=Ir[1]*tr+fs,hs=Ir[2]*kt+bs,vn=Ir[3]*tr+fs,bs=Ir[4]*kt+bs,fs=Ir[5]*tr+fs,Ia(Yr,pn,hs,vn,bs,fs));return Bt&&Xl(),Dc(lt),this},h.path=function(P){for(var ce=0;ce<P.length;ce++){var Qe=P[ce],Je=Qe.c;switch(Qe.op){case"m":yd(Je[0],Je[1]);break;case"l":of(Je[0],Je[1]);break;case"c":Ia.apply(this,Je);break;case"h":Xl()}}return this},h.__private__.rect=h.rect=function(P,ce,Qe,Je,lt){if(isNaN(P)||isNaN(ce)||isNaN(Qe)||isNaN(Je)||!Xr(lt))throw new Error("Invalid arguments passed to jsPDF.rect");return F===y&&(Je=-Je),J([S(L(P)),S(Y(ce)),S(L(Qe)),S(L(Je)),"re"].join(" ")),Dc(lt),this},h.__private__.triangle=h.triangle=function(P,ce,Qe,Je,lt,Bt,kt){if(isNaN(P)||isNaN(ce)||isNaN(Qe)||isNaN(Je)||isNaN(lt)||isNaN(Bt)||!Xr(kt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Qe-P,Je-ce],[lt-Qe,Bt-Je],[P-lt,ce-Bt]],P,ce,[1,1],kt,!0),this},h.__private__.roundedRect=h.roundedRect=function(P,ce,Qe,Je,lt,Bt,kt){if(isNaN(P)||isNaN(ce)||isNaN(Qe)||isNaN(Je)||isNaN(lt)||isNaN(Bt)||!Xr(kt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var tr=4/3*(Math.SQRT2-1);return lt=Math.min(lt,.5*Qe),Bt=Math.min(Bt,.5*Je),this.lines([[Qe-2*lt,0],[lt*tr,0,lt,Bt-Bt*tr,lt,Bt],[0,Je-2*Bt],[0,Bt*tr,-lt*tr,Bt,-lt,Bt],[2*lt-Qe,0],[-lt*tr,0,-lt,-Bt*tr,-lt,-Bt],[0,2*Bt-Je],[0,-Bt*tr,lt*tr,-Bt,lt,-Bt]],P+lt,ce,[1,1],kt,!0),this},h.__private__.ellipse=h.ellipse=function(P,ce,Qe,Je,lt){if(isNaN(P)||isNaN(ce)||isNaN(Qe)||isNaN(Je)||!Xr(lt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Bt=4/3*(Math.SQRT2-1)*Qe,kt=4/3*(Math.SQRT2-1)*Je;return yd(P+Qe,ce),Ia(P+Qe,ce-kt,P+Bt,ce-Je,P,ce-Je),Ia(P-Bt,ce-Je,P-Qe,ce-kt,P-Qe,ce),Ia(P-Qe,ce+kt,P-Bt,ce+Je,P,ce+Je),Ia(P+Bt,ce+Je,P+Qe,ce+kt,P+Qe,ce),Dc(lt),this},h.__private__.circle=h.circle=function(P,ce,Qe,Je){if(isNaN(P)||isNaN(ce)||isNaN(Qe)||!Xr(Je))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(P,ce,Qe,Qe,Je)},h.setFont=function(P,ce,Qe){return Qe&&(ce=E(ce,Qe)),je=ml(P,ce,{disableWarning:!1}),this};var Ro=h.__private__.getFont=h.getFont=function(){return _e[ml.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var P,ce,Qe={};for(P in he)if(he.hasOwnProperty(P))for(ce in Qe[P]=[],he[P])he[P].hasOwnProperty(ce)&&Qe[P].push(ce);return Qe},h.addFont=function(P,ce,Qe,Je,lt){var Bt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Bt.indexOf(arguments[3])!==-1?lt=arguments[3]:arguments[3]&&Bt.indexOf(arguments[3])==-1&&(Qe=E(Qe,Je)),Rr.call(this,P,ce,Qe,lt=lt||"Identity-H")};var Yl,DA=t.lineWidth||.200025,lf=h.__private__.getLineWidth=h.getLineWidth=function(){return DA},vr=h.__private__.setLineWidth=h.setLineWidth=function(P){return DA=P,J(S(L(P))+" w"),this};h.__private__.setLineDash=rr.API.setLineDash=rr.API.setLineDashPattern=function(P,ce){if(P=P||[],ce=ce||0,isNaN(ce)||!Array.isArray(P))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return P=P.map(function(Qe){return S(L(Qe))}).join(" "),ce=S(L(ce)),J("["+P+"] "+ce+" d"),this};var fm=h.__private__.getLineHeight=h.getLineHeight=function(){return Ee*Yl};h.__private__.getLineHeight=h.getLineHeight=function(){return Ee*Yl};var mm=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(P){return typeof(P=P||1.15)=="number"&&(Yl=P),this},pm=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Yl};mm(t.lineHeight);var fa=h.__private__.getHorizontalCoordinate=function(P){return L(P)},pl=h.__private__.getVerticalCoordinate=function(P){return F===b?P:xt[C].mediaBox.topRightY-xt[C].mediaBox.bottomLeftY-L(P)},gm=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(P){return S(fa(P))},LA=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(P){return S(pl(P))},gl=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Fe(gl)},h.__private__.setStrokeColor=h.setDrawColor=function(P,ce,Qe,Je){return gl=De({ch1:P,ch2:ce,ch3:Qe,ch4:Je,pdfColorType:"draw",precision:2}),J(gl),this};var UA=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Fe(UA)},h.__private__.setFillColor=h.setFillColor=function(P,ce,Qe,Je){return UA=De({ch1:P,ch2:ce,ch3:Qe,ch4:Je,pdfColorType:"fill",precision:2}),J(UA),this};var ro=t.textColor||"0 g",Lc=h.__private__.getTextColor=h.getTextColor=function(){return Fe(ro)};h.__private__.setTextColor=h.setTextColor=function(P,ce,Qe,Je){return ro=De({ch1:P,ch2:ce,ch3:Qe,ch4:Je,pdfColorType:"text",precision:3}),this};var Do=t.charSpace,bd=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Do||0)};h.__private__.setCharSpace=h.setCharSpace=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Do=P,this};var kn=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(P){var ce=h.CapJoinStyles[P];if(ce===void 0)throw new Error("Line cap style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return kn=ce,J(ce+" J"),this};var Nd=0;h.__private__.setLineJoin=h.setLineJoin=function(P){var ce=h.CapJoinStyles[P];if(ce===void 0)throw new Error("Line join style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Nd=ce,J(ce+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(P){if(P=P||0,isNaN(P))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(S(L(P))+" M"),this},h.GState=zg,h.setGState=function(P){(P=typeof P=="string"?Ge[at[P]]:cf(null,P)).equals(wt)||(J("/"+P.id+" gs"),wt=P)};var cf=function(P,ce){if(!P||!at[P]){var Qe=!1;for(var Je in Ge)if(Ge.hasOwnProperty(Je)&&Ge[Je].equals(ce)){Qe=!0;break}if(Qe)ce=Ge[Je];else{var lt="GS"+(Object.keys(Ge).length+1).toString(10);Ge[lt]=ce,ce.id=lt}return P&&(at[P]=ce.id),Lt.publish("addGState",ce),ce}};h.addGState=function(P,ce){return cf(P,ce),this},h.saveGraphicsState=function(){return J("q"),Ce.push({key:je,size:Ee,color:ro}),this},h.restoreGraphicsState=function(){J("Q");var P=Ce.pop();return je=P.key,Ee=P.size,ro=P.color,wt=null,this},h.setCurrentTransformationMatrix=function(P){return J(P.toString()+" cm"),this},h.comment=function(P){return J("#"+P),this};var Lo=function(P,ce){var Qe=P||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Qe},set:function(Bt){isNaN(Bt)||(Qe=parseFloat(Bt))}});var Je=ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Je},set:function(Bt){isNaN(Bt)||(Je=parseFloat(Bt))}});var lt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return lt},set:function(Bt){lt=Bt.toString()}}),this},OA=function(P,ce,Qe,Je){Lo.call(this,P,ce),this.type="rect";var lt=Qe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return lt},set:function(kt){isNaN(kt)||(lt=parseFloat(kt))}});var Bt=Je||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Bt},set:function(kt){isNaN(kt)||(Bt=parseFloat(kt))}}),this},Uc=function(){this.page=it,this.currentPage=C,this.pages=we.slice(0),this.pagesContext=xt.slice(0),this.x=G,this.y=ye,this.matrix=Oe,this.width=vi(C),this.height=Af(C),this.outputDestination=Me,this.id="",this.objectNumber=-1};Uc.prototype.restore=function(){it=this.page,C=this.currentPage,xt=this.pagesContext,we=this.pages,G=this.x,ye=this.y,Oe=this.matrix,Cd(C,this.width),wi(C,this.height),Me=this.outputDestination};var Zl=function(P,ce,Qe,Je,lt){xr.push(new Uc),it=C=0,we=[],G=P,ye=ce,Oe=lt,Jr([Qe,Je])};for(var ec in h.beginFormObject=function(P,ce,Qe,Je,lt){return Zl(P,ce,Qe,Je,lt),this},h.endFormObject=function(P){return function(ce){if(gr[ce])xr.pop().restore();else{var Qe=new Uc,Je="Xo"+(Object.keys(lr).length+1).toString(10);Qe.id=Je,gr[ce]=Je,lr[Je]=Qe,Lt.publish("addFormObject",Qe),xr.pop().restore()}}(P),this},h.doFormObject=function(P,ce){var Qe=lr[gr[P]];return J("q"),J(ce.toString()+" cm"),J("/"+Qe.id+" Do"),J("Q"),this},h.getFormObject=function(P){var ce=lr[gr[P]];return{x:ce.x,y:ce.y,width:ce.width,height:ce.height,matrix:ce.matrix}},h.save=function(P,ce){return P=P||"generated.pdf",(ce=ce||{}).returnPromise=ce.returnPromise||!1,ce.returnPromise===!1?(Vd(jc(jo()),P),typeof Vd.unload=="function"&&Br.setTimeout&&setTimeout(Vd.unload,911),this):new Promise(function(Qe,Je){try{var lt=Vd(jc(jo()),P);typeof Vd.unload=="function"&&Br.setTimeout&&setTimeout(Vd.unload,911),Qe(lt)}catch(Bt){Je(Bt.message)}})},rr.API)rr.API.hasOwnProperty(ec)&&(ec==="events"&&rr.API.events.length?function(P,ce){var Qe,Je,lt;for(lt=ce.length-1;lt!==-1;lt--)Qe=ce[lt][0],Je=ce[lt][1],P.subscribe.apply(P,[Qe].concat(typeof Je=="function"?[Je]:Je))}(Lt,rr.API.events):h[ec]=rr.API[ec]);function vi(P){return xt[P].mediaBox.topRightX-xt[P].mediaBox.bottomLeftX}function Cd(P,ce){xt[P].mediaBox.topRightX=ce+xt[P].mediaBox.bottomLeftX}function Af(P){return xt[P].mediaBox.topRightY-xt[P].mediaBox.bottomLeftY}function wi(P,ce){xt[P].mediaBox.topRightY=ce+xt[P].mediaBox.bottomLeftY}var Uo=h.getPageWidth=function(P){return vi(P=P||C)/X},MA=h.setPageWidth=function(P,ce){Cd(P,ce*X)},Oo=h.getPageHeight=function(P){return Af(P=P||C)/X},_d=h.setPageHeight=function(P,ce){wi(P,ce*X)};return h.internal={pdfEscape:Nr,getStyle:Rc,getFont:Ro,getFontSize:qe,getCharSpace:bd,getTextColor:Lc,getLineHeight:fm,getLineHeightFactor:pm,getLineWidth:lf,write:K,getHorizontalCoordinate:fa,getVerticalCoordinate:pl,getCoordinateString:gm,getVerticalCoordinateString:LA,collections:{},newObject:Xt,newAdditionalObject:ne,newObjectDeferred:Kt,newObjectDeferredBegin:oe,getFilters:We,putStream:rt,events:Lt,scaleFactor:X,pageSize:{getWidth:function(){return Uo(C)},setWidth:function(P){MA(C,P)},getHeight:function(){return Oo(C)},setHeight:function(P){_d(C,P)}},encryptionOptions:u,encryption:Rn,getEncryptor:function(P){return u!==null?Rn.encryptor(P,0):function(ce){return ce}},output:wd,getNumberOfPages:xi,get pages(){return we},out:J,f2:k,f3:T,getPageInfo:Ys,getPageInfoByObjId:Pc,getCurrentPageInfo:RA,getPDFVersion:p,Point:Lo,Rectangle:OA,Matrix:Ye,hasHotfix:Li},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Uo(C)},set:function(P){MA(C,P)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Oo(C)},set:function(P){_d(C,P)},enumerable:!0,configurable:!0}),(function(P){for(var ce=0,Qe=pe.length;ce<Qe;ce++){var Je=Rr.call(this,P[ce][0],P[ce][1],P[ce][2],pe[ce][3],!0);d===!1&&(f[Je]=!0);var lt=P[ce][0].split("-");Zt({id:Je,fontName:lt[0],fontStyle:lt[1]||""})}Lt.publish("addFonts",{fonts:_e,dictionary:he})}).call(h,pe),je="F1",Di(s,r),Lt.publish("initialized"),h}Kf.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Kf.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Kf.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Kf.prototype.processOwnerPassword=function(t,e){return wE(vE(e).substr(0,5),t)},Kf.prototype.encryptor=function(t,e){var r=vE(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return wE(r,n)}},zg.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Bn(t)!==Bn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},rr.API={events:[]},rr.version="3.0.4";var Es=rr.API,YS=1,Wh=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Bf=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},kr=function(t){return t.toFixed(2)},iu=function(t){return t.toFixed(5)};Es.__acroform__={};var Zi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},_j=function(t){return t*YS},cc=function(t){var e=new OM,r=ar.internal.getHeight(t)||0,n=ar.internal.getWidth(t)||0;return e.BBox=[0,0,Number(kr(n)),Number(kr(r))],e},Kie=Es.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},qie=Es.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Gie=Es.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Ms=Es.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Gie(t,e-1)},Qs=Es.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Kie(t,e-1)},Vs=Es.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return qie(t,e-1)},$ie=Es.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(a)||0,[Number(kr(c.lowerLeft_X)),Number(kr(c.lowerLeft_Y)),Number(kr(c.upperRight_X)),Number(kr(c.upperRight_Y))]},zie=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=yE(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+kr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=cc(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},yE=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(k){return k.split(`
`)}):s.map(function(k){return[k]});var a=r,o=ar.internal.getHeight(t)||0;o=o<0?-o:o;var l=ar.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,T,L){if(k+1<s.length){var Y=T+" "+s[k+1][0];return lv(Y,t,L).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var A,u,d=lv("3",t,a).height,f=t.multiline?o-a:(o-d)/2,h=f+=2,m=0,p=0,x=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+lv(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var g="",y=0,b=0;b<s.length;b++)if(s.hasOwnProperty(b)){var F=!1;if(s[b].length!==1&&x!==s[b].length-1){if((d+2)*(y+2)+2>o)continue e;g+=s[b][x],F=!0,p=b,b--}else{g=(g+=s[b][x]+" ").substr(g.length-1)==" "?g.substr(0,g.length-1):g;var j=parseInt(b),R=c(j,g,a),E=b>=s.length-1;if(R&&!E){g+=" ",x=0;continue}if(R||E){if(E)p=j;else if(t.multiline&&(d+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(d+2)*(y+2)+2>o)continue e;p=j}}for(var S="",B=m;B<=p;B++){var U=s[B];if(t.multiline){if(B===p){S+=U[x]+" ",x=(x+1)%U.length;continue}if(B===m){S+=U[U.length-1]+" ";continue}}S+=U[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,u=lv(S,t,a).width,t.textAlign){case"right":A=l-u-2;break;case"center":A=(l-u)/2;break;default:A=2}e+=kr(A)+" "+kr(h)+` Td
`,e+="("+Wh(S)+`) Tj
`,e+=-kr(A)+` 0 Td
`,h=-(a+2),u=0,m=F?p:p+1,y++,g=""}break}return n.text=e,n.fontSize=a,n},lv=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},Wie={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Jie=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},Xie=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if($l.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Wie)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");YS=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new MM,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&Jie(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],A=l.Rect;if(l.Rect&&(l.Rect=$ie(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ar.createDefaultAppearanceStream(l),Bn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=A,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=zie(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var d="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var h=l.appearanceStreamContent[f];if(d+="/"+f+" ",d+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(s,l)),d+="/"+o+" "+m+" ",s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(s,l)),d+="/"+o+" "+m,s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}a&&function(p,x){for(var g in p)if(p.hasOwnProperty(g)){var y=g,b=p[g];x.internal.newObjectDeferredBegin(b.objId,!0),Bn(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},UM=Es.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var s="[",a=0;a<t.length;a++)switch(a!==0&&(s+=" "),Bn(t[a])){case"boolean":case"number":case"object":s+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+Wh(n(t[a].toString()))+")"):s+=t[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},MN=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Wh(n(t))+")"},gc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};gc.prototype.toString=function(){return this.objId+" 0 R"},gc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},gc.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:UM(s,this.objId,this.scope)}):s instanceof gc?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var OM=function(){gc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Zi(OM,gc);var MM=function(){gc.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Wh(r(t))+")"}},set:function(r){t=r}})};Zi(MM,gc);var $l=function t(){gc.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute F supplied.');e=g}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ms(e,3)},set:function(g){g?this.F=Qs(e,3):this.F=Vs(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute Ff supplied.');r=g}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(g){n=g!==void 0?g:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(g){n[0]=g}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(g){n[1]=g}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(g){n[2]=g}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(g){n[3]=g}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(g){switch(g){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=g;break;default:throw new Error('Invalid value "'+g+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof w2)return;a="FieldObject"+t.FieldNum++}var g=function(y){return y};return this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),"("+Wh(g(a))+")"},set:function(g){a=g.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(g){a=g}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(g){o=g}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(g){l=g}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(g){c=g}});var A=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return A===void 0?50/YS:A},set:function(g){A=g}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(g){u=g}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof w2||this instanceof zu))return MN(d,this.objId,this.scope)},set:function(g){g=g.toString(),d=g}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof oa==0?MN(f,this.objId,this.scope):f},set:function(g){g=g.toString(),f=this instanceof oa==0?g.substr(0,1)==="("?Bf(g.substr(1,g.length-2)):Bf(g):g}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof oa==1?Bf(f.substr(1,f.length-1)):f},set:function(g){g=g.toString(),f=this instanceof oa==1?"/"+g:g}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(g){this.V=g}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof oa==0?MN(h,this.objId,this.scope):h},set:function(g){g=g.toString(),h=this instanceof oa==0?g.substr(0,1)==="("?Bf(g.substr(1,g.length-2)):Bf(g):g}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof oa==1?Bf(h.substr(1,h.length-1)):h},set:function(g){g=g.toString(),h=this instanceof oa==1?"/"+g:g}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(g){g=!!g,p=g}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(g){m=g}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,1)},set:function(g){g?this.Ff=Qs(this.Ff,1):this.Ff=Vs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,2)},set:function(g){g?this.Ff=Qs(this.Ff,2):this.Ff=Vs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,3)},set:function(g){g?this.Ff=Qs(this.Ff,3):this.Ff=Vs(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(g){if([0,1,2].indexOf(g)===-1)throw new Error('Invalid value "'+g+'" for attribute Q supplied.');x=g}}),Object.defineProperty(this,"textAlign",{get:function(){var g;switch(x){case 0:default:g="left";break;case 1:g="center";break;case 2:g="right"}return g},configurable:!0,enumerable:!0,set:function(g){switch(g){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};Zi($l,gc);var oh=function(){$l.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return UM(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,o,l){l||(l=1);for(var c,A=[];c=o.exec(a);)A.push(c[l]);return A}(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,18)},set:function(r){r?this.Ff=Qs(this.Ff,18):this.Ff=Vs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Qs(this.Ff,19):this.Ff=Vs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,20)},set:function(r){r?(this.Ff=Qs(this.Ff,20),e.sort()):this.Ff=Vs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,22)},set:function(r){r?this.Ff=Qs(this.Ff,22):this.Ff=Vs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,23)},set:function(r){r?this.Ff=Qs(this.Ff,23):this.Ff=Vs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,27)},set:function(r){r?this.Ff=Qs(this.Ff,27):this.Ff=Vs(this.Ff,27)}}),this.hasAppearanceStream=!1};Zi(oh,$l);var lh=function(){oh.call(this),this.fontName="helvetica",this.combo=!1};Zi(lh,oh);var ch=function(){lh.call(this),this.combo=!0};Zi(ch,lh);var Wp=function(){ch.call(this),this.edit=!0};Zi(Wp,ch);var oa=function(){$l.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,15)},set:function(r){r?this.Ff=Qs(this.Ff,15):this.Ff=Vs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,16)},set:function(r){r?this.Ff=Qs(this.Ff,16):this.Ff=Vs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,17)},set:function(r){r?this.Ff=Qs(this.Ff,17):this.Ff=Vs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,26)},set:function(r){r?this.Ff=Qs(this.Ff,26):this.Ff=Vs(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+Wh(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Bn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Zi(oa,$l);var Jp=function(){oa.call(this),this.pushButton=!0};Zi(Jp,oa);var Ah=function(){oa.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Zi(Ah,oa);var w2=function(){var t,e;$l.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+Wh(s(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Bn(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ar.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Zi(w2,$l),Ah.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Ah.prototype.createOption=function(t){var e=new w2;return e.Parent=this,e.optionName=t,this.Kids.push(e),Yie.call(this.scope,e),e};var Xp=function(){oa.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ar.CheckBox.createAppearanceStream()};Zi(Xp,oa);var zu=function(){$l.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,13)},set:function(e){e?this.Ff=Qs(this.Ff,13):this.Ff=Vs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,21)},set:function(e){e?this.Ff=Qs(this.Ff,21):this.Ff=Vs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,23)},set:function(e){e?this.Ff=Qs(this.Ff,23):this.Ff=Vs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,24)},set:function(e){e?this.Ff=Qs(this.Ff,24):this.Ff=Vs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,25)},set:function(e){e?this.Ff=Qs(this.Ff,25):this.Ff=Vs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,26)},set:function(e){e?this.Ff=Qs(this.Ff,26):this.Ff=Vs(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Zi(zu,$l);var Yp=function(){zu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ms(this.Ff,14)},set:function(t){t?this.Ff=Qs(this.Ff,14):this.Ff=Vs(this.Ff,14)}}),this.password=!0};Zi(Yp,zu);var ar={CheckBox:{createAppearanceStream:function(){return{N:{On:ar.CheckBox.YesNormal},D:{On:ar.CheckBox.YesPushDown,Off:ar.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),a=yE(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+kr(ar.internal.getWidth(t))+" "+kr(ar.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+kr(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=cc(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],a=ar.internal.getHeight(t),o=ar.internal.getWidth(t),l=yE(t,t.caption);return s.push("1 g"),s.push("0 0 "+kr(o)+" "+kr(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+kr(o-1)+" "+kr(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+kr(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kr(ar.internal.getWidth(t))+" "+kr(ar.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:ar.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=ar.RadioButton.Circle.YesNormal,e.D[t]=ar.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=ar.internal.getWidth(t)<=ar.internal.getHeight(t)?ar.internal.getWidth(t)/4:ar.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=ar.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+iu(ar.internal.getWidth(t)/2)+" "+iu(ar.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=ar.internal.getWidth(t)<=ar.internal.getHeight(t)?ar.internal.getWidth(t)/4:ar.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*ar.internal.Bezier_C).toFixed(5)),o=Number((n*ar.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+iu(ar.internal.getWidth(t)/2)+" "+iu(ar.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+iu(ar.internal.getWidth(t)/2)+" "+iu(ar.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=ar.internal.getWidth(t)<=ar.internal.getHeight(t)?ar.internal.getWidth(t)/4:ar.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*ar.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+iu(ar.internal.getWidth(t)/2)+" "+iu(ar.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:ar.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=ar.RadioButton.Cross.YesNormal,e.D[t]=ar.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=cc(t);e.scope=t.scope;var r=[],n=ar.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+kr(ar.internal.getWidth(t)-2)+" "+kr(ar.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(kr(n.x1.x)+" "+kr(n.x1.y)+" m"),r.push(kr(n.x2.x)+" "+kr(n.x2.y)+" l"),r.push(kr(n.x4.x)+" "+kr(n.x4.y)+" m"),r.push(kr(n.x3.x)+" "+kr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=ar.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+kr(ar.internal.getWidth(t))+" "+kr(ar.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+kr(ar.internal.getWidth(t)-2)+" "+kr(ar.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(kr(r.x1.x)+" "+kr(r.x1.y)+" m"),n.push(kr(r.x2.x)+" "+kr(r.x2.y)+" l"),n.push(kr(r.x4.x)+" "+kr(r.x4.y)+" m"),n.push(kr(r.x3.x)+" "+kr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=cc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+kr(ar.internal.getWidth(t))+" "+kr(ar.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};ar.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=ar.internal.getWidth(t),r=ar.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},ar.internal.getWidth=function(t){var e=0;return Bn(t)==="object"&&(e=_j(t.Rect[2])),e},ar.internal.getHeight=function(t){var e=0;return Bn(t)==="object"&&(e=_j(t.Rect[3])),e};var Yie=Es.addField=function(t){if(Xie(this,t),!(t instanceof $l))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Es.AcroFormChoiceField=oh,Es.AcroFormListBox=lh,Es.AcroFormComboBox=ch,Es.AcroFormEditBox=Wp,Es.AcroFormButton=oa,Es.AcroFormPushButton=Jp,Es.AcroFormRadioButton=Ah,Es.AcroFormCheckBox=Xp,Es.AcroFormTextField=zu,Es.AcroFormPasswordField=Yp,Es.AcroFormAppearance=ar,Es.AcroForm={ChoiceField:oh,ListBox:lh,ComboBox:ch,EditBox:Wp,Button:oa,PushButton:Jp,RadioButton:Ah,CheckBox:Xp,TextField:zu,PasswordField:Yp,Appearance:ar},rr.AcroForm={ChoiceField:oh,ListBox:lh,ComboBox:ch,EditBox:Wp,Button:oa,PushButton:Jp,RadioButton:Ah,CheckBox:Xp,TextField:zu,PasswordField:Yp,Appearance:ar};var Zie=rr.AcroForm;function QM(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(k,T){var L,Y,me,ae,fe,de=r;if((T=T||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(R(k))for(fe in n)for(me=n[fe],L=0;L<me.length;L+=1){for(ae=!0,Y=0;Y<me[L].length;Y+=1)if(me[L][Y]!==void 0&&me[L][Y]!==k[Y]){ae=!1;break}if(ae===!0){de=fe;break}}else for(fe in n)for(me=n[fe],L=0;L<me.length;L+=1){for(ae=!0,Y=0;Y<me[L].length;Y+=1)if(me[L][Y]!==void 0&&me[L][Y]!==k.charCodeAt(Y)){ae=!1;break}if(ae===!0){de=fe;break}}return de===r&&T!==r&&(de=T),de},a=function k(T){for(var L=this.internal.write,Y=this.internal.putStream,me=(0,this.internal.getFilters)();me.indexOf("FlateEncode")!==-1;)me.splice(me.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:T.width}),ae.push({key:"Height",value:T.height}),T.colorSpace===g.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===g.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var fe="",de=0,Z=T.transparency.length;de<Z;de++)fe+=T.transparency[de]+" "+T.transparency[de]+" ";ae.push({key:"Mask",value:"["+fe+"]"})}T.sMask!==void 0&&ae.push({key:"SMask",value:T.objectId+1+" 0 R"});var xe=T.filter!==void 0?["/"+T.filter]:void 0;if(Y({data:T.data,additionalKeyValues:ae,alreadyAppliedFilters:xe,objectId:T.objectId}),L("endobj"),"sMask"in T&&T.sMask!==void 0){var Be,I=(Be=T.sMaskBitsPerComponent)!==null&&Be!==void 0?Be:T.bitsPerComponent,C={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:I,data:T.sMask};"filter"in T&&(C.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(I," /Columns ").concat(T.width),C.filter=T.filter),k.call(this,C)}if(T.colorSpace===g.INDEXED){var Q=this.internal.newObject();Y({data:S(new Uint8Array(T.palette)),objectId:Q}),L("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var T in k)a.call(this,k[T])},l=function(){var k,T=this.internal.collections[e+"images"],L=this.internal.write;for(var Y in T)L("/I"+(k=T[Y]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},A=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(k){return typeof t["process"+k.toUpperCase()]=="function"},f=function(k){return Bn(k)==="object"&&k.nodeType===1},h=function(k,T){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var L=""+k.getAttribute("src");if(L.indexOf("data:image/")===0)return mw(unescape(L).split("base64,").pop());var Y=t.loadFile(L,!0);if(Y!==void 0)return Y}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var me;switch(T){case"PNG":me="image/png";break;case"WEBP":me="image/webp";break;default:me="image/jpeg"}return mw(k.toDataURL(me,1).split("base64,").pop())}},m=function(k){var T=this.internal.collections[e+"images"];if(T){for(var L in T)if(k===T[L].alias)return T[L]}},p=function(k,T,L){return k||T||(k=-96,T=-96),k<0&&(k=-1*L.width*72/k/this.internal.scaleFactor),T<0&&(T=-1*L.height*72/T/this.internal.scaleFactor),k===0&&(k=T*L.width/L.height),T===0&&(T=k*L.height/L.width),[k,T]},x=function(k,T,L,Y,me,ae){var fe=p.call(this,L,Y,me),de=this.internal.getCoordinateString,Z=this.internal.getVerticalCoordinateString,xe=A.call(this);if(L=fe[0],Y=fe[1],xe[me.index]=me,ae){ae*=Math.PI/180;var Be=Math.cos(ae),I=Math.sin(ae),C=function(M){return M.toFixed(4)},Q=[C(Be),C(I),C(-1*I),C(Be),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,de(k),Z(T+Y),"cm"].join(" ")),this.internal.write(Q.join(" ")),this.internal.write([de(L),"0","0",de(Y),"0","0","cm"].join(" "))):this.internal.write([de(L),"0","0",de(Y),de(k),Z(T+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+me.index+" Do"),this.internal.write("Q")},g=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(k){var T,L,Y=0;if(typeof k=="string")for(L=k.length,T=0;T<L;T++)Y=(Y<<5)-Y+k.charCodeAt(T),Y|=0;else if(R(k))for(L=k.byteLength/2,T=0;T<L;T++)Y=(Y<<5)-Y+k[T],Y|=0;return Y},F=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var T=!0;return k.length===0&&(T=!1),k.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(T=!1),T},j=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var T=k.indexOf(",");return T<0?null:k.substring(0,T).trim().endsWith("base64")?k.substring(T+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var R=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},E=t.__addimage__.binaryStringToUint8Array=function(k){for(var T=k.length,L=new Uint8Array(T),Y=0;Y<T;Y++)L[Y]=k.charCodeAt(Y);return L},S=t.__addimage__.arrayBufferToBinaryString=function(k){for(var T="",L=R(k)?k:new Uint8Array(k),Y=0;Y<L.length;Y+=8192)T+=String.fromCharCode.apply(null,L.subarray(Y,Y+8192));return T};t.addImage=function(){var k,T,L,Y,me,ae,fe,de,Z;if(typeof arguments[1]=="number"?(T=r,L=arguments[1],Y=arguments[2],me=arguments[3],ae=arguments[4],fe=arguments[5],de=arguments[6],Z=arguments[7]):(T=arguments[1],L=arguments[2],Y=arguments[3],me=arguments[4],ae=arguments[5],fe=arguments[6],de=arguments[7],Z=arguments[8]),Bn(k=arguments[0])==="object"&&!f(k)&&"imageData"in k){var xe=k;k=xe.imageData,T=xe.format||T||r,L=xe.x||L||0,Y=xe.y||Y||0,me=xe.w||xe.width||me,ae=xe.h||xe.height||ae,fe=xe.alias||fe,de=xe.compression||de,Z=xe.rotation||xe.angle||Z}var Be=this.internal.getFilters();if(de===void 0&&Be.indexOf("FlateEncode")!==-1&&(de="SLOW"),isNaN(L)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var I=B.call(this,k,T,fe,de);return x.call(this,L,Y,me,ae,I,Z),this};var B=function(k,T,L,Y){var me,ae,fe;if(typeof k=="string"&&s(k)===r){k=unescape(k);var de=U(k,!1);(de!==""||(de=t.loadFile(k,!0))!==void 0)&&(k=de)}if(f(k)&&(k=h(k,T)),T=s(k,T),!d(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((fe=L)==null||fe.length===0)&&(L=function(Z){return typeof Z=="string"||R(Z)?b(Z):R(Z.data)?b(Z.data):null}(k)),(me=m.call(this,L))||(k instanceof Uint8Array||T==="RGBA"||(ae=k,k=E(k)),me=this["process"+T.toUpperCase()](k,u.call(this),L,function(Z){return Z&&typeof Z=="string"&&(Z=Z.toUpperCase()),Z in t.image_compression?Z:y.NONE}(Y),ae)),!me)throw new Error("An unknown error occurred whilst processing the image.");return me},U=t.__addimage__.convertBase64ToBinaryString=function(k,T){T=typeof T!="boolean"||T;var L,Y="";if(typeof k=="string"){var me;L=(me=j(k))!==null&&me!==void 0?me:k;try{Y=mw(L)}catch(ae){if(T)throw F(L)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};t.getImageProperties=function(k){var T,L,Y="";if(f(k)&&(k=h(k)),typeof k=="string"&&s(k)===r&&((Y=U(k,!1))===""&&(Y=t.loadFile(k)||""),k=Y),L=s(k),!d(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(k instanceof Uint8Array||(k=E(k)),!(T=this["process"+L.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=L,T}})(rr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};rr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),A=r.pageContext.annotations,u=!1,d=0;d<A.length&&!u;d++)switch((n=A[d]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var f=0;f<A.length;f++){n=A[f];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(p.objId),y=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(g(n.contents))+")",a+=" /Popup "+x.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+h(g(y))+") >>",p.content=a;var b=p.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",x.content=a,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var F=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(m(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var j=this.annotations._nameMap[n.options.name];n.options.pageNumber=j.page,n.options.top=j.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var R=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+R+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:A(n),w:c(r+s),h:A(n+a)},options:o,type:"link"})},t.textWithLink=function(r,n,s,a){var o,l,c=this.getTextWidth(r),A=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(A*u)}else l=c,o=A;return this.text(r,n,s,a),s+=.2*A,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-A,l,o,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(rr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&s.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=1};var A=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length==4},d=t.__arabicParser__.resolveLigatures=function(p){var x=0,g=r,y="",b=0;for(x=0;x<p.length;x+=1)g[p.charCodeAt(x)]!==void 0?(b++,typeof(g=g[p.charCodeAt(x)])=="number"&&(y+=String.fromCharCode(g),g=r,b=0),x===p.length-1&&(g=r,y+=p.charAt(x-(b-1)),x-=b-1,b=0)):(g=r,y+=p.charAt(x-b),x-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var f=t.__arabicParser__.getCorrectForm=function(p,x,g){return o(p)?a(p)===!1?-1:!A(p)||!o(x)&&!o(g)||!o(g)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:u(p)&&o(x)&&!l(x)&&o(g)&&A(g)?3:l(p)||!o(g)?1:2:-1},h=function(p){var x=0,g=0,y=0,b="",F="",j="",R=(p=p||"").split("\\s+"),E=[];for(x=0;x<R.length;x+=1){for(E.push(""),g=0;g<R[x].length;g+=1)b=R[x][g],F=R[x][g-1],j=R[x][g+1],o(b)?(y=f(b,F,j),E[x]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):E[x]+=b;E[x]=d(E[x])}return E.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,g=[];if(Array.isArray(x)){var y=0;for(g=[],y=0;y<x.length;y+=1)Array.isArray(x[y])?g.push([h(x[y][0]),x[y][1],x[y][2]]):g.push([h(x[y])]);p=g}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(rr.API),rr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(rr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var A=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,A){n.call(this);var u=(A=A||{}).fontSize||this.getFontSize(),d=A.font||this.getFont(),f=A.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var g=A.maxWidth;g>0?typeof c=="string"?c=this.splitTextToSize(c,g):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,F){return b.concat(x.splitTextToSize(F,g))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:d})*u)&&(h=p);return h!==0&&(m=c.length),{w:h/=f,h:Math.max((m*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/f,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var A=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,f=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return A.lineNumber!==void 0&&(A.lineNumber===c.lineNumber?(c.x=(A.x||0)+(A.width||0),c.y=A.y||0):A.y+A.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,h&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=A.y+A.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,A,u,d,f){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,m,p,x,g=[],y=[],b=[],F={},j={},R=[],E=[],S=(f=f||{}).autoSize||!1,B=f.printHeaders!==!1,U=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,k=f.margins||Object.assign({width:this.getPageWidth()},e),T=typeof f.padding=="number"?f.padding:3,L=f.headerBackgroundColor||"#c8c8c8",Y=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=B,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=L,this.internal.__cell__.headerTextColor=Y,this.setFontSize(U),d==null)y=g=Object.keys(u[0]),b=g.map(function(){return"left"});else if(Array.isArray(d)&&Bn(d[0])==="object")for(g=d.map(function(xe){return xe.name}),y=d.map(function(xe){return xe.prompt||xe.name||""}),b=d.map(function(xe){return xe.align||"left"}),h=0;h<d.length;h+=1)j[d[h].name]=.7499990551181103*d[h].width;else Array.isArray(d)&&typeof d[0]=="string"&&(y=g=d,b=g.map(function(){return"left"}));if(S||Array.isArray(d)&&typeof d[0]=="string")for(h=0;h<g.length;h+=1){for(F[x=g[h]]=u.map(function(xe){return xe[x]}),this.setFont(void 0,"bold"),R.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=F[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)R.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);j[x]=Math.max.apply(null,R)+T+T,R=[]}if(B){var me={};for(h=0;h<g.length;h+=1)me[g[h]]={},me[g[h]].text=y[h],me[g[h]].align=b[h];var ae=l.call(this,me,j);E=g.map(function(xe){return new a(c,A,j[xe],ae,me[xe].text,void 0,me[xe].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var fe=d.reduce(function(xe,Be){return xe[Be.name]=Be.align,xe},{});for(h=0;h<u.length;h+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:h,data:u[h]},this);var de=l.call(this,u[h],j);for(p=0;p<g.length;p+=1){var Z=u[h][g[p]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:h,col:p,data:Z},this),o.call(this,new a(c,A,j[g[p]],de,Z,h+2,fe[g[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=A,this};var l=function(c,A){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,A[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*d/f+u+u},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,A){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),A&&(u.y=this.internal.__cell__.margins.top||0,f.push(u)),u.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(m)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(rr.API);var VM={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},HM=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],bE=QM(HM),KM=[100,200,300,400,500,600,700,800,900],eoe=QM(KM);function QN(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return VM[a=a||"normal"]?a:"normal"}(t.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(t.weight),s=function(a){return typeof bE[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function Ej(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var toe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Bj={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Sj(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Ij(t){return t.trimLeft()}function roe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function noe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var cv,Fj,kj,Sf,Av,Tj,jj,Pj,VN=["times"];function Rj(t,e,r,n,s){var a=4,o=Lj;switch(s){case rr.API.image_compression.FAST:a=1,o=Dj;break;case rr.API.image_compression.MEDIUM:a=6,o=Uj;break;case rr.API.image_compression.SLOW:a=9,o=Oj}t=function(c,A,u,d){for(var f,h=c.length/A,m=new Uint8Array(c.length+h),p=[soe,Dj,Lj,Uj,Oj],x=0;x<h;x+=1){var g=x*A,y=c.subarray(g,g+A);if(d)m.set(d(y,u,f),g+x);else{for(var b=p.length,F=[],j=0;j<b;j+=1)F[j]=p[j](y,u,f);var R=ioe(F.concat());m.set(F[R],g+x)}f=y}return m}(t,e,Math.ceil(r*n/8),o);var l=mE(t,{level:a});return rr.API.__addimage__.arrayBufferToBinaryString(l)}function soe(t){var e=Array.apply([],t);return e.unshift(0),e}function Dj(t,e){var r=t.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=t[s-e]||0;n[s+1]=t[s]-a+256&255}return n}function Lj(t,e,r){var n=t.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var o=r&&r[a]||0;s[a+1]=t[a]-o+256&255}return s}function Uj(t,e,r){var n=t.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var o=t[a-e]||0,l=r&&r[a]||0;s[a+1]=t[a]+256-(o+l>>>1)&255}return s}function Oj(t,e,r){var n=t.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var o=aoe(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);s[a+1]=t[a]-o+256&255}return s}function aoe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),s=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=s&&n<=a?t:s<=a?e:r}function ioe(t){var e=t.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function HN(t,e,r){var n=e*r,s=Math.floor(n/8),a=16-(n-8*s+r),o=(1<<r)-1;return qM(t,s)>>a&o}function Mj(t,e,r,n){var s=r*n,a=Math.floor(s/8),o=16-(s-8*a+n),l=(1<<n)-1,c=(e&l)<<o;(function(A,u,d){if(u+1<A.byteLength)A.setUint16(u,d,!1);else{var f=d>>8&255;A.setUint8(u,f)}})(t,a,qM(t,a)&~(l<<o)&65535|c)}function qM(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function ooe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],a=s>>7,o=1<<1+(7&s);t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var A=!0,u=[],d=0,f=null,h=0,m=null;for(this.width=r,this.height=n;A&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];d=t[e++]|t[e++]<<8,f=t[e++],1&p||(f=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,F=t[e++],j=F>>6&1,R=1<<1+(7&F),E=l,S=c,B=!1;F>>7&&(B=!0,E=e,S=R,e+=3*R);var U=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}u.push({x,y:g,width:y,height:b,has_local_palette:B,palette_offset:E,palette_size:S,data_offset:U,data_length:e-U,transparent_index:f,interlaced:!!j,delay:d,disposal:h});break;case 59:A=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,L){var Y=this.frameInfo(T),me=Y.width*Y.height,ae=new Uint8Array(me);Qj(t,Y.data_offset,ae,me);var fe=Y.palette_offset,de=Y.transparent_index;de===null&&(de=256);var Z=Y.width,xe=r-Z,Be=Z,I=4*(Y.y*r+Y.x),C=4*((Y.y+Y.height)*r+Y.x),Q=I,M=4*xe;Y.interlaced===!0&&(M+=4*r*7);for(var D=8,z=0,O=ae.length;z<O;++z){var te=ae[z];if(Be===0&&(Be=Z,(Q+=M)>=C&&(M=4*xe+4*r*(D-1),Q=I+(Z+xe)*(D<<1),D>>=1)),te===de)Q+=4;else{var se=t[fe+3*te],we=t[fe+3*te+1],q=t[fe+3*te+2];L[Q++]=q,L[Q++]=we,L[Q++]=se,L[Q++]=255}--Be}},this.decodeAndBlitFrameRGBA=function(T,L){var Y=this.frameInfo(T),me=Y.width*Y.height,ae=new Uint8Array(me);Qj(t,Y.data_offset,ae,me);var fe=Y.palette_offset,de=Y.transparent_index;de===null&&(de=256);var Z=Y.width,xe=r-Z,Be=Z,I=4*(Y.y*r+Y.x),C=4*((Y.y+Y.height)*r+Y.x),Q=I,M=4*xe;Y.interlaced===!0&&(M+=4*r*7);for(var D=8,z=0,O=ae.length;z<O;++z){var te=ae[z];if(Be===0&&(Be=Z,(Q+=M)>=C&&(M=4*xe+4*r*(D-1),Q=I+(Z+xe)*(D<<1),D>>=1)),te===de)Q+=4;else{var se=t[fe+3*te],we=t[fe+3*te+1],q=t[fe+3*te+2];L[Q++]=se,L[Q++]=we,L[Q++]=q,L[Q++]=255}--Be}}}function Qj(t,e,r,n){for(var s=t[e++],a=1<<s,o=a+1,l=o+1,c=s+1,A=(1<<c)-1,u=0,d=0,f=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;u<16&&h!==0;)d|=t[e++]<<u,u+=8,h===1?h=t[e++]:--h;if(u<c)break;var x=d&A;if(d>>=c,u-=c,x!==a){if(x===o)break;for(var g=x<l?x:p,y=0,b=g;b>a;)b=m[b]>>8,++y;var F=b;if(f+y+(g!==x?1:0)>n)return void Mn.log("Warning, gif stream longer than expected.");r[f++]=F;var j=f+=y;for(g!==x&&(r[f++]=F),b=g;y--;)b=m[b],r[--j]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|F,l>=A+1&&c<12&&(++c,A=A<<1|1)),p=x}else l=o+1,A=(1<<(c=s+1))-1,p=null}return f!==n&&Mn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function KN(t){var e,r,n,s,a,o=Math.floor,l=new Array(64),c=new Array(64),A=new Array(64),u=new Array(64),d=new Array(65535),f=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,g=7,y=new Array(64),b=new Array(64),F=new Array(64),j=new Array(256),R=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],me=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(I,C){for(var Q=0,M=0,D=new Array,z=1;z<=16;z++){for(var O=1;O<=I[z];O++)D[C[M]]=[],D[C[M]][0]=Q,D[C[M]][1]=z,M++,Q++;Q*=2}return D}function fe(I){for(var C=I[0],Q=I[1]-1;Q>=0;)C&1<<Q&&(x|=1<<g),Q--,--g<0&&(x==255?(de(255),de(0)):de(x),g=7,x=0)}function de(I){p.push(I)}function Z(I){de(I>>8&255),de(255&I)}function xe(I,C,Q,M,D){for(var z,O=D[0],te=D[240],se=function(Ee,Ue){var qe,$e,st,Se,ze,Ke,be,le,je,X,G=0;for(je=0;je<8;++je){qe=Ee[G],$e=Ee[G+1],st=Ee[G+2],Se=Ee[G+3],ze=Ee[G+4],Ke=Ee[G+5],be=Ee[G+6];var ye=qe+(le=Ee[G+7]),Oe=qe-le,_e=$e+be,he=$e-be,Ce=st+Ke,Ze=st-Ke,Te=Se+ze,Ge=Se-ze,at=ye+Te,wt=ye-Te,it=_e+Ce,xt=_e-Ce;Ee[G]=at+it,Ee[G+4]=at-it;var Lt=.707106781*(xt+wt);Ee[G+2]=wt+Lt,Ee[G+6]=wt-Lt;var hr=.382683433*((at=Ge+Ze)-(xt=he+Oe)),lr=.5411961*at+hr,gr=1.306562965*xt+hr,xr=.707106781*(it=Ze+he),Ye=Oe+xr,pt=Oe-xr;Ee[G+5]=pt+lr,Ee[G+3]=pt-lr,Ee[G+1]=Ye+gr,Ee[G+7]=Ye-gr,G+=8}for(G=0,je=0;je<8;++je){qe=Ee[G],$e=Ee[G+8],st=Ee[G+16],Se=Ee[G+24],ze=Ee[G+32],Ke=Ee[G+40],be=Ee[G+48];var Rt=qe+(le=Ee[G+56]),Tt=qe-le,Dt=$e+be,Xt=$e-be,Kt=st+Ke,oe=st-Ke,ne=Se+ze,ue=Se-ze,ge=Rt+ne,Fe=Rt-ne,De=Dt+Kt,We=Dt-Kt;Ee[G]=ge+De,Ee[G+32]=ge-De;var rt=.707106781*(We+Fe);Ee[G+16]=Fe+rt,Ee[G+48]=Fe-rt;var Le=.382683433*((ge=ue+oe)-(We=Xt+Tt)),Xe=.5411961*ge+Le,et=1.306562965*We+Le,dt=.707106781*(De=oe+Xt),vt=Tt+dt,Nt=Tt-dt;Ee[G+40]=Nt+Xe,Ee[G+24]=Nt-Xe,Ee[G+8]=vt+et,Ee[G+56]=vt-et,G++}for(je=0;je<64;++je)X=Ee[je]*Ue[je],h[je]=X>0?X+.5|0:X-.5|0;return h}(I,C),we=0;we<64;++we)m[E[we]]=se[we];var q=m[0]-Q;Q=m[0],q==0?fe(M[0]):(fe(M[f[z=32767+q]]),fe(d[z]));for(var Me=63;Me>0&&m[Me]==0;)Me--;if(Me==0)return fe(O),Q;for(var re,J=1;J<=Me;){for(var K=J;m[J]==0&&J<=Me;)++J;var ie=J-K;if(ie>=16){re=ie>>4;for(var pe=1;pe<=re;++pe)fe(te);ie&=15}z=32767+m[J],fe(D[(ie<<4)+f[z]]),fe(d[z]),J++}return Me!=63&&fe(O),Q}function Be(I){I=Math.min(Math.max(I,1),100),a!=I&&(function(C){for(var Q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var D=o((Q[M]*C+50)/100);D=Math.min(Math.max(D,1),255),l[E[M]]=D}for(var z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],O=0;O<64;O++){var te=o((z[O]*C+50)/100);te=Math.min(Math.max(te,1),255),c[E[O]]=te}for(var se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],we=0,q=0;q<8;q++)for(var Me=0;Me<8;Me++)A[we]=1/(l[E[we]]*se[q]*se[Me]*8),u[we]=1/(c[E[we]]*se[q]*se[Me]*8),we++}(I<50?Math.floor(5e3/I):Math.floor(200-2*I)),a=I)}this.encode=function(I,C){C&&Be(C),p=new Array,x=0,g=7,Z(65496),Z(65504),Z(16),de(74),de(70),de(73),de(70),de(0),de(1),de(1),de(0),Z(1),Z(1),de(0),de(0),function(){Z(65499),Z(132),de(0);for(var $e=0;$e<64;$e++)de(l[$e]);de(1);for(var st=0;st<64;st++)de(c[st])}(),function($e,st){Z(65472),Z(17),de(8),Z(st),Z($e),de(3),de(1),de(17),de(0),de(2),de(17),de(1),de(3),de(17),de(1)}(I.width,I.height),function(){Z(65476),Z(418),de(0);for(var $e=0;$e<16;$e++)de(S[$e+1]);for(var st=0;st<=11;st++)de(B[st]);de(16);for(var Se=0;Se<16;Se++)de(U[Se+1]);for(var ze=0;ze<=161;ze++)de(k[ze]);de(1);for(var Ke=0;Ke<16;Ke++)de(T[Ke+1]);for(var be=0;be<=11;be++)de(L[be]);de(17);for(var le=0;le<16;le++)de(Y[le+1]);for(var je=0;je<=161;je++)de(me[je])}(),Z(65498),Z(12),de(3),de(1),de(0),de(2),de(17),de(3),de(17),de(0),de(63),de(0);var Q=0,M=0,D=0;x=0,g=7,this.encode.displayName="_encode_";for(var z,O,te,se,we,q,Me,re,J,K=I.data,ie=I.width,pe=I.height,Ee=4*ie,Ue=0;Ue<pe;){for(z=0;z<Ee;){for(we=Ee*Ue+z,Me=-1,re=0,J=0;J<64;J++)q=we+(re=J>>3)*Ee+(Me=4*(7&J)),Ue+re>=pe&&(q-=Ee*(Ue+1+re-pe)),z+Me>=Ee&&(q-=z+Me-Ee+4),O=K[q++],te=K[q++],se=K[q++],y[J]=(R[O]+R[te+256|0]+R[se+512|0]>>16)-128,b[J]=(R[O+768|0]+R[te+1024|0]+R[se+1280|0]>>16)-128,F[J]=(R[O+1280|0]+R[te+1536|0]+R[se+1792|0]>>16)-128;Q=xe(y,A,Q,e,n),M=xe(b,u,M,r,s),D=xe(F,u,D,r,s),z+=32}Ue+=8}if(g>=0){var qe=[];qe[1]=g+1,qe[0]=(1<<g+1)-1,fe(qe)}return Z(65497),new Uint8Array(p)},t=t||50,function(){for(var I=String.fromCharCode,C=0;C<256;C++)j[C]=I(C)}(),e=ae(S,B),r=ae(T,L),n=ae(U,k),s=ae(Y,me),function(){for(var I=1,C=2,Q=1;Q<=15;Q++){for(var M=I;M<C;M++)f[32767+M]=Q,d[32767+M]=[],d[32767+M][1]=Q,d[32767+M][0]=M;for(var D=-(C-1);D<=-I;D++)f[32767+D]=Q,d[32767+D]=[],d[32767+D][1]=Q,d[32767+D][0]=C-1+D;I<<=1,C<<=1}}(),function(){for(var I=0;I<256;I++)R[I]=19595*I,R[I+256|0]=38470*I,R[I+512|0]=7471*I+32768,R[I+768|0]=-11059*I,R[I+1024|0]=-21709*I,R[I+1280|0]=32768*I+8421375,R[I+1536|0]=-27439*I,R[I+1792|0]=-5329*I}(),Be(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Nl(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Vj(t){function e(B){if(!B)throw Error("assert :P")}function r(B,U,k){for(var T=0;4>T;T++)if(B[U+T]!=k.charCodeAt(T))return!0;return!1}function n(B,U,k,T,L){for(var Y=0;Y<L;Y++)B[U+Y]=k[T+Y]}function s(B,U,k,T){for(var L=0;L<T;L++)B[U+L]=k}function a(B){return new Int32Array(B)}function o(B,U){for(var k=[],T=0;T<B;T++)k.push(new U);return k}function l(B,U){var k=[];return function T(L,Y,me){for(var ae=me[Y],fe=0;fe<ae&&(L.push(me.length>Y+1?[]:new U),!(me.length<Y+1));fe++)T(L[fe],Y+1,me)}(k,0,B),k}var c=function(){var B=this;function U(v,_){for(var V=1<<_-1>>>0;v&V;)V>>>=1;return V?(v&V-1)+V:v}function k(v,_,V,W,Ae){e(!(W%V));do v[_+(W-=V)]=Ae;while(0<W)}function T(v,_,V,W,Ae){if(e(2328>=Ae),512>=Ae)var ve=a(512);else if((ve=a(Ae))==null)return 0;return function(Ne,Ie,Pe,Ve,tt,ft){var He,nt,ut=Ie,_t=1<<Pe,ht=a(16),St=a(16);for(e(tt!=0),e(Ve!=null),e(Ne!=null),e(0<Pe),nt=0;nt<tt;++nt){if(15<Ve[nt])return 0;++ht[Ve[nt]]}if(ht[0]==tt)return 0;for(St[1]=0,He=1;15>He;++He){if(ht[He]>1<<He)return 0;St[He+1]=St[He]+ht[He]}for(nt=0;nt<tt;++nt)He=Ve[nt],0<Ve[nt]&&(ft[St[He]++]=nt);if(St[15]==1)return(Ve=new L).g=0,Ve.value=ft[0],k(Ne,ut,1,_t,Ve),_t;var It,Ot=-1,Pt=_t-1,fr=0,sr=1,Dr=1,Ar=1<<Pe;for(nt=0,He=1,tt=2;He<=Pe;++He,tt<<=1){if(sr+=Dr<<=1,0>(Dr-=ht[He]))return 0;for(;0<ht[He];--ht[He])(Ve=new L).g=He,Ve.value=ft[nt++],k(Ne,ut+fr,tt,Ar,Ve),fr=U(fr,He)}for(He=Pe+1,tt=2;15>=He;++He,tt<<=1){if(sr+=Dr<<=1,0>(Dr-=ht[He]))return 0;for(;0<ht[He];--ht[He]){if(Ve=new L,(fr&Pt)!=Ot){for(ut+=Ar,It=1<<(Ot=He)-Pe;15>Ot&&!(0>=(It-=ht[Ot]));)++Ot,It<<=1;_t+=Ar=1<<(It=Ot-Pe),Ne[Ie+(Ot=fr&Pt)].g=It+Pe,Ne[Ie+Ot].value=ut-Ie-Ot}Ve.g=He-Pe,Ve.value=ft[nt++],k(Ne,ut+(fr>>Pe),tt,Ar,Ve),fr=U(fr,He)}}return sr!=2*St[15]-1?0:_t}(v,_,V,W,Ae,ve)}function L(){this.value=this.g=0}function Y(){this.value=this.g=0}function me(){this.G=o(5,L),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Ed,Y)}function ae(v,_,V,W){e(v!=null),e(_!=null),e(2147483648>W),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=_,v.pa=V,v.Jd=_,v.Yc=V+W,v.Zc=4<=W?V+W-4+1:V,O(v)}function fe(v,_){for(var V=0;0<_--;)V|=se(v,128)<<_;return V}function de(v,_){var V=fe(v,_);return te(v)?-V:V}function Z(v,_,V,W){var Ae,ve=0;for(e(v!=null),e(_!=null),e(4294967288>W),v.Sb=W,v.Ra=0,v.u=0,v.h=0,4<W&&(W=4),Ae=0;Ae<W;++Ae)ve+=_[V+Ae]<<8*Ae;v.Ra=ve,v.bb=W,v.oa=_,v.pa=V}function xe(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<VA-8>>>0,++v.bb,v.u-=8;M(v)&&(v.h=1,v.u=0)}function Be(v,_){if(e(0<=_),!v.h&&_<=ao){var V=Q(v)&so[_];return v.u+=_,xe(v),V}return v.h=1,v.u=0}function I(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function C(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Q(v){return v.Ra>>>(v.u&VA-1)>>>0}function M(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>VA}function D(v,_){v.u=_,v.h=M(v)}function z(v){v.u>=Oc&&(e(v.u>=Oc),xe(v))}function O(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function te(v){return fe(v,1)}function se(v,_){var V=v.Ca;0>v.b&&O(v);var W=v.b,Ae=V*_>>>8,ve=(v.I>>>W>Ae)+0;for(ve?(V-=Ae,v.I-=Ae+1<<W>>>0):V=Ae+1,W=V,Ae=0;256<=W;)Ae+=8,W>>=8;return W=7^Ae+HA[W],v.b-=W,v.Ca=(V<<W)-1,ve}function we(v,_,V){v[_+0]=V>>24&255,v[_+1]=V>>16&255,v[_+2]=V>>8&255,v[_+3]=255&V}function q(v,_){return v[_+0]|v[_+1]<<8}function Me(v,_){return q(v,_)|v[_+2]<<16}function re(v,_){return q(v,_)|q(v,_+2)<<16}function J(v,_){var V=1<<_;return e(v!=null),e(0<_),v.X=a(V),v.X==null?0:(v.Mb=32-_,v.Xa=_,1)}function K(v,_){e(v!=null),e(_!=null),e(v.Xa==_.Xa),n(_.X,0,v.X,0,1<<_.Xa)}function ie(){this.X=[],this.Xa=this.Mb=0}function pe(v,_,V,W){e(V!=null),e(W!=null);var Ae=V[0],ve=W[0];return Ae==0&&(Ae=(v*ve+_/2)/_),ve==0&&(ve=(_*Ae+v/2)/v),0>=Ae||0>=ve?0:(V[0]=Ae,W[0]=ve,1)}function Ee(v,_){return v+(1<<_)-1>>>_}function Ue(v,_){return((4278255360&v)+(4278255360&_)>>>0&4278255360)+((16711935&v)+(16711935&_)>>>0&16711935)>>>0}function qe(v,_){B[_]=function(V,W,Ae,ve,Ne,Ie,Pe){var Ve;for(Ve=0;Ve<Ne;++Ve){var tt=B[v](Ie[Pe+Ve-1],Ae,ve+Ve);Ie[Pe+Ve]=Ue(V[W+Ve],tt)}}}function $e(){this.ud=this.hd=this.jd=0}function st(v,_){return((4278124286&(v^_))>>>1)+(v&_)>>>0}function Se(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function ze(v,_){return Se(v+(v-_+.5>>1))}function Ke(v,_,V){return Math.abs(_-V)-Math.abs(v-V)}function be(v,_,V,W,Ae,ve,Ne){for(W=ve[Ne-1],V=0;V<Ae;++V)ve[Ne+V]=W=Ue(v[_+V],W)}function le(v,_,V,W,Ae){var ve;for(ve=0;ve<V;++ve){var Ne=v[_+ve],Ie=Ne>>8&255,Pe=16711935&(Pe=(Pe=16711935&Ne)+((Ie<<16)+Ie));W[Ae+ve]=(4278255360&Ne)+Pe>>>0}}function je(v,_){_.jd=255&v,_.hd=v>>8&255,_.ud=v>>16&255}function X(v,_,V,W,Ae,ve){var Ne;for(Ne=0;Ne<W;++Ne){var Ie=_[V+Ne],Pe=Ie>>>8,Ve=Ie,tt=255&(tt=(tt=Ie>>>16)+((v.jd<<24>>24)*(Pe<<24>>24)>>>5));Ve=255&(Ve=(Ve+=(v.hd<<24>>24)*(Pe<<24>>24)>>>5)+((v.ud<<24>>24)*(tt<<24>>24)>>>5)),Ae[ve+Ne]=(4278255360&Ie)+(tt<<16)+Ve}}function G(v,_,V,W,Ae){B[_]=function(ve,Ne,Ie,Pe,Ve,tt,ft,He,nt){for(Pe=ft;Pe<He;++Pe)for(ft=0;ft<nt;++ft)Ve[tt++]=Ae(Ie[W(ve[Ne++])])},B[v]=function(ve,Ne,Ie,Pe,Ve,tt,ft){var He=8>>ve.b,nt=ve.Ea,ut=ve.K[0],_t=ve.w;if(8>He)for(ve=(1<<ve.b)-1,_t=(1<<He)-1;Ne<Ie;++Ne){var ht,St=0;for(ht=0;ht<nt;++ht)ht&ve||(St=W(Pe[Ve++])),tt[ft++]=Ae(ut[St&_t]),St>>=He}else B["VP8LMapColor"+V](Pe,Ve,ut,_t,tt,ft,Ne,Ie,nt)}}function ye(v,_,V,W,Ae){for(V=_+V;_<V;){var ve=v[_++];W[Ae++]=ve>>16&255,W[Ae++]=ve>>8&255,W[Ae++]=255&ve}}function Oe(v,_,V,W,Ae){for(V=_+V;_<V;){var ve=v[_++];W[Ae++]=ve>>16&255,W[Ae++]=ve>>8&255,W[Ae++]=255&ve,W[Ae++]=ve>>24&255}}function _e(v,_,V,W,Ae){for(V=_+V;_<V;){var ve=(Ne=v[_++])>>16&240|Ne>>12&15,Ne=240&Ne|Ne>>28&15;W[Ae++]=ve,W[Ae++]=Ne}}function he(v,_,V,W,Ae){for(V=_+V;_<V;){var ve=(Ne=v[_++])>>16&248|Ne>>13&7,Ne=Ne>>5&224|Ne>>3&31;W[Ae++]=ve,W[Ae++]=Ne}}function Ce(v,_,V,W,Ae){for(V=_+V;_<V;){var ve=v[_++];W[Ae++]=255&ve,W[Ae++]=ve>>8&255,W[Ae++]=ve>>16&255}}function Ze(v,_,V,W,Ae,ve){if(ve==0)for(V=_+V;_<V;)we(W,((ve=v[_++])[0]>>24|ve[1]>>8&65280|ve[2]<<8&16711680|ve[3]<<24)>>>0),Ae+=32;else n(W,Ae,v,_,V)}function Te(v,_){B[_][0]=B[v+"0"],B[_][1]=B[v+"1"],B[_][2]=B[v+"2"],B[_][3]=B[v+"3"],B[_][4]=B[v+"4"],B[_][5]=B[v+"5"],B[_][6]=B[v+"6"],B[_][7]=B[v+"7"],B[_][8]=B[v+"8"],B[_][9]=B[v+"9"],B[_][10]=B[v+"10"],B[_][11]=B[v+"11"],B[_][12]=B[v+"12"],B[_][13]=B[v+"13"],B[_][14]=B[v+"0"],B[_][15]=B[v+"0"]}function Ge(v){return v==nb||v==sb||v==Xx||v==ab}function at(){this.eb=[],this.size=this.A=this.fb=0}function wt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function it(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new at,this.f.kb=new wt,this.sd=null}function xt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function hr(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function lr(v,_){var V=v.T,W=_.ba.f.RGBA,Ae=W.eb,ve=W.fb+v.ka*W.A,Ne=Ko[_.ba.S],Ie=v.y,Pe=v.O,Ve=v.f,tt=v.N,ft=v.ea,He=v.W,nt=_.cc,ut=_.dc,_t=_.Mc,ht=_.Nc,St=v.ka,It=v.ka+v.T,Ot=v.U,Pt=Ot+1>>1;for(St==0?Ne(Ie,Pe,null,null,Ve,tt,ft,He,Ve,tt,ft,He,Ae,ve,null,null,Ot):(Ne(_.ec,_.fc,Ie,Pe,nt,ut,_t,ht,Ve,tt,ft,He,Ae,ve-W.A,Ae,ve,Ot),++V);St+2<It;St+=2)nt=Ve,ut=tt,_t=ft,ht=He,tt+=v.Rc,He+=v.Rc,ve+=2*W.A,Ne(Ie,(Pe+=2*v.fa)-v.fa,Ie,Pe,nt,ut,_t,ht,Ve,tt,ft,He,Ae,ve-W.A,Ae,ve,Ot);return Pe+=v.fa,v.j+It<v.o?(n(_.ec,_.fc,Ie,Pe,Ot),n(_.cc,_.dc,Ve,tt,Pt),n(_.Mc,_.Nc,ft,He,Pt),V--):1&It||Ne(Ie,Pe,null,null,Ve,tt,ft,He,Ve,tt,ft,He,Ae,ve+W.A,null,null,Ot),V}function gr(v,_,V){var W=v.F,Ae=[v.J];if(W!=null){var ve=v.U,Ne=_.ba.S,Ie=Ne==Jx||Ne==Xx;_=_.ba.f.RGBA;var Pe=[0],Ve=v.ka;Pe[0]=v.T,v.Kb&&(Ve==0?--Pe[0]:(--Ve,Ae[0]-=v.width),v.j+v.ka+v.T==v.o&&(Pe[0]=v.o-v.j-Ve));var tt=_.eb;Ve=_.fb+Ve*_.A,v=zI(W,Ae[0],v.width,ve,Pe,tt,Ve+(Ie?0:3),_.A),e(V==Pe),v&&Ge(Ne)&&Em(tt,Ve,Ie,ve,Pe,_.A)}return 0}function xr(v){var _=v.ma,V=_.ba.S,W=11>V,Ae=V==zx||V==Wx||V==Jx||V==rb||V==12||Ge(V);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!xm(_.Oa,v,Ae?11:12))return 0;if(Ae&&Ge(V)&&Qo(),v.da)alert("todo:use_scaling");else{if(W){if(_.Ib=hr,v.Kb){if(V=v.U+1>>1,_.memory=a(v.U+2*V),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+v.U,_.Mc=_.cc,_.Nc=_.dc+V,_.Ib=lr,Qo()}}else alert("todo:EmitYUV");Ae&&(_.Jb=gr,W&&Ui())}if(W&&!A5){for(v=0;256>v;++v)S7[v]=89858*(v-128)+Zx>>Yx,k7[v]=-22014*(v-128)+Zx,F7[v]=-45773*(v-128),I7[v]=113618*(v-128)+Zx>>Yx;for(v=Sm;v<lb;++v)_=76283*(v-16)+Zx>>Yx,T7[v-Sm]=ts(_,255),j7[v-Sm]=ts(_+8>>4,15);A5=1}return 1}function Ye(v){var _=v.ma,V=v.U,W=v.T;return e(!(1&v.ka)),0>=V||0>=W?0:(V=_.Ib(v,_),_.Jb!=null&&_.Jb(v,_,V),_.Dc+=V,1)}function pt(v){v.ma.memory=null}function Rt(v,_,V,W){return Be(v,8)!=47?0:(_[0]=Be(v,14)+1,V[0]=Be(v,14)+1,W[0]=Be(v,1),Be(v,3)!=0?0:!v.h)}function Tt(v,_){if(4>v)return v+1;var V=v-2>>1;return(2+(1&v)<<V)+Be(_,V)+1}function Dt(v,_){return 120<_?_-120:1<=(V=((V=f7[_-1])>>4)*v+(8-(15&V)))?V:1;var V}function Xt(v,_,V){var W=Q(V),Ae=v[_+=255&W].g-8;return 0<Ae&&(D(V,V.u+8),W=Q(V),_+=v[_].value,_+=W&(1<<Ae)-1),D(V,V.u+v[_].g),v[_].value}function Kt(v,_,V){return V.g+=v.g,V.value+=v.value<<_>>>0,e(8>=V.g),v.g}function oe(v,_,V){var W=v.xc;return e((_=W==0?0:v.vc[v.md*(V>>W)+(_>>W)])<v.Wb),v.Ya[_]}function ne(v,_,V,W){var Ae=v.ab,ve=v.c*_,Ne=v.C;_=Ne+_;var Ie=V,Pe=W;for(W=v.Ta,V=v.Ua;0<Ae--;){var Ve=v.gc[Ae],tt=Ne,ft=_,He=Ie,nt=Pe,ut=(Pe=W,Ie=V,Ve.Ea);switch(e(tt<ft),e(ft<=Ve.nc),Ve.hc){case 2:Ts(He,nt,(ft-tt)*ut,Pe,Ie);break;case 0:var _t=tt,ht=ft,St=Pe,It=Ie,Ot=(Ar=Ve).Ea;_t==0&&(wm(He,nt,null,null,1,St,It),be(He,nt+1,0,0,Ot-1,St,It+1),nt+=Ot,It+=Ot,++_t);for(var Pt=1<<Ar.b,fr=Pt-1,sr=Ee(Ot,Ar.b),Dr=Ar.K,Ar=Ar.w+(_t>>Ar.b)*sr;_t<ht;){var sn=Dr,ea=Ar,Lr=1;for(uf(He,nt,St,It-Ot,1,St,It);Lr<Ot;){var ur=(Lr&~fr)+Pt;ur>Ot&&(ur=Ot),(0,bm[sn[ea++]>>8&15])(He,nt+ +Lr,St,It+Lr-Ot,ur-Lr,St,It+Lr),Lr=ur}nt+=Ot,It+=Ot,++_t&fr||(Ar+=sr)}ft!=Ve.nc&&n(Pe,Ie-ut,Pe,Ie+(ft-tt-1)*ut,ut);break;case 1:for(ut=He,ht=nt,Ot=(He=Ve.Ea)-(It=He&~(St=(nt=1<<Ve.b)-1)),_t=Ee(He,Ve.b),Pt=Ve.K,Ve=Ve.w+(tt>>Ve.b)*_t;tt<ft;){for(fr=Pt,sr=Ve,Dr=new $e,Ar=ht+It,sn=ht+He;ht<Ar;)je(fr[sr++],Dr),Nm(Dr,ut,ht,nt,Pe,Ie),ht+=nt,Ie+=nt;ht<sn&&(je(fr[sr++],Dr),Nm(Dr,ut,ht,Ot,Pe,Ie),ht+=Ot,Ie+=Ot),++tt&St||(Ve+=_t)}break;case 3:if(He==Pe&&nt==Ie&&0<Ve.b){for(ht=Pe,He=ut=Ie+(ft-tt)*ut-(It=(ft-tt)*Ee(Ve.Ea,Ve.b)),nt=Pe,St=Ie,_t=[],It=(Ot=It)-1;0<=It;--It)_t[It]=nt[St+It];for(It=Ot-1;0<=It;--It)ht[He+It]=_t[It];Kx(Ve,tt,ft,Pe,ut,Pe,Ie)}else Kx(Ve,tt,ft,He,nt,Pe,Ie)}Ie=W,Pe=V}Pe!=V&&n(W,V,Ie,Pe,ve)}function ue(v,_){var V=v.V,W=v.Ba+v.c*v.C,Ae=_-v.C;if(e(_<=v.l.o),e(16>=Ae),0<Ae){var ve=v.l,Ne=v.Ta,Ie=v.Ua,Pe=ve.width;if(ne(v,Ae,V,W),Ae=Ie=[Ie],e((V=v.C)<(W=_)),e(ve.v<ve.va),W>ve.o&&(W=ve.o),V<ve.j){var Ve=ve.j-V;V=ve.j,Ae[0]+=Ve*Pe}if(V>=W?V=0:(Ae[0]+=4*ve.v,ve.ka=V-ve.j,ve.U=ve.va-ve.v,ve.T=W-V,V=1),V){if(Ie=Ie[0],11>(V=v.ca).S){var tt=V.f.RGBA,ft=(W=V.S,Ae=ve.U,ve=ve.T,Ve=tt.eb,tt.A),He=ve;for(tt=tt.fb+v.Ma*tt.A;0<He--;){var nt=Ne,ut=Ie,_t=Ae,ht=Ve,St=tt;switch(W){case $x:Cm(nt,ut,_t,ht,St);break;case zx:KA(nt,ut,_t,ht,St);break;case nb:KA(nt,ut,_t,ht,St),Em(ht,St,0,_t,1,0);break;case t5:Bd(nt,ut,_t,ht,St);break;case Wx:Ze(nt,ut,_t,ht,St,1);break;case sb:Ze(nt,ut,_t,ht,St,1),Em(ht,St,0,_t,1,0);break;case Jx:Ze(nt,ut,_t,ht,St,0);break;case Xx:Ze(nt,ut,_t,ht,St,0),Em(ht,St,1,_t,1,0);break;case rb:qA(nt,ut,_t,ht,St);break;case ab:qA(nt,ut,_t,ht,St),$I(ht,St,_t,1,0);break;case r5:GA(nt,ut,_t,ht,St);break;default:e(0)}Ie+=Pe,tt+=ft}v.Ma+=ve}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=V.height)}}v.C=_,e(v.C<=v.i)}function ge(v){var _;if(0<v.ua)return 0;for(_=0;_<v.Wb;++_){var V=v.Ya[_].G,W=v.Ya[_].H;if(0<V[1][W[1]+0].g||0<V[2][W[2]+0].g||0<V[3][W[3]+0].g)return 0}return 1}function Fe(v,_,V,W,Ae,ve){if(v.Z!=0){var Ne=v.qd,Ie=v.rd;for(e(WA[v.Z]!=null);_<V;++_)WA[v.Z](Ne,Ie,W,Ae,W,Ae,ve),Ne=W,Ie=Ae,Ae+=ve;v.qd=Ne,v.rd=Ie}}function De(v,_){var V=v.l.ma,W=V.Z==0||V.Z==1?v.l.j:v.C;if(W=v.C<W?W:v.C,e(_<=v.l.o),_>W){var Ae=v.l.width,ve=V.ca,Ne=V.tb+Ae*W,Ie=v.V,Pe=v.Ba+v.c*W,Ve=v.gc;e(v.ab==1),e(Ve[0].hc==3),rc(Ve[0],W,_,Ie,Pe,ve,Ne),Fe(V,W,_,ve,Ne,Ae)}v.C=v.Ma=_}function We(v,_,V,W,Ae,ve,Ne){var Ie=v.$/W,Pe=v.$%W,Ve=v.m,tt=v.s,ft=V+v.$,He=ft;Ae=V+W*Ae;var nt=V+W*ve,ut=280+tt.ua,_t=v.Pb?Ie:16777216,ht=0<tt.ua?tt.Wa:null,St=tt.wc,It=ft<nt?oe(tt,Pe,Ie):null;e(v.C<ve),e(nt<=Ae);var Ot=!1;e:for(;;){for(;Ot||ft<nt;){var Pt=0;if(Ie>=_t){var fr=ft-V;e((_t=v).Pb),_t.wd=_t.m,_t.xd=fr,0<_t.s.ua&&K(_t.s.Wa,_t.s.vb),_t=Ie+p7}if(Pe&St||(It=oe(tt,Pe,Ie)),e(It!=null),It.Qb&&(_[ft]=It.qb,Ot=!0),!Ot)if(z(Ve),It.jc){Pt=Ve,fr=_;var sr=ft,Dr=It.pd[Q(Pt)&Ed-1];e(It.jc),256>Dr.g?(D(Pt,Pt.u+Dr.g),fr[sr]=Dr.value,Pt=0):(D(Pt,Pt.u+Dr.g-256),e(256<=Dr.value),Pt=Dr.value),Pt==0&&(Ot=!0)}else Pt=Xt(It.G[0],It.H[0],Ve);if(Ve.h)break;if(Ot||256>Pt){if(!Ot)if(It.nd)_[ft]=(It.qb|Pt<<8)>>>0;else{if(z(Ve),Ot=Xt(It.G[1],It.H[1],Ve),z(Ve),fr=Xt(It.G[2],It.H[2],Ve),sr=Xt(It.G[3],It.H[3],Ve),Ve.h)break;_[ft]=(sr<<24|Ot<<16|Pt<<8|fr)>>>0}if(Ot=!1,++ft,++Pe>=W&&(Pe=0,++Ie,Ne!=null&&Ie<=ve&&!(Ie%16)&&Ne(v,Ie),ht!=null))for(;He<ft;)Pt=_[He++],ht.X[(506832829*Pt&4294967295)>>>ht.Mb]=Pt}else if(280>Pt){if(Pt=Tt(Pt-256,Ve),fr=Xt(It.G[4],It.H[4],Ve),z(Ve),fr=Dt(W,fr=Tt(fr,Ve)),Ve.h)break;if(ft-V<fr||Ae-ft<Pt)break e;for(sr=0;sr<Pt;++sr)_[ft+sr]=_[ft+sr-fr];for(ft+=Pt,Pe+=Pt;Pe>=W;)Pe-=W,++Ie,Ne!=null&&Ie<=ve&&!(Ie%16)&&Ne(v,Ie);if(e(ft<=Ae),Pe&St&&(It=oe(tt,Pe,Ie)),ht!=null)for(;He<ft;)Pt=_[He++],ht.X[(506832829*Pt&4294967295)>>>ht.Mb]=Pt}else{if(!(Pt<ut))break e;for(Ot=Pt-280,e(ht!=null);He<ft;)Pt=_[He++],ht.X[(506832829*Pt&4294967295)>>>ht.Mb]=Pt;Pt=ft,e(!(Ot>>>(fr=ht).Xa)),_[Pt]=fr.X[Ot],Ot=!0}Ot||e(Ve.h==M(Ve))}if(v.Pb&&Ve.h&&ft<Ae)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&K(v.s.vb,v.s.Wa);else{if(Ve.h)break e;Ne!=null&&Ne(v,Ie>ve?ve:Ie),v.a=0,v.$=ft-V}return 1}return v.a=3,0}function rt(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var _=v.Wa;_!=null&&(_.X=null),v.vb=null,e(v!=null)}function Le(){var v=new wr;return v==null?null:(v.a=0,v.xb=a5,Te("Predictor","VP8LPredictors"),Te("Predictor","VP8LPredictors_C"),Te("PredictorAdd","VP8LPredictorsAdd"),Te("PredictorAdd","VP8LPredictorsAdd_C"),Ts=le,Nm=X,Cm=ye,KA=Oe,qA=_e,GA=he,Bd=Ce,B.VP8LMapColor32b=tc,B.VP8LMapColor8b=ym,v)}function Xe(v,_,V,W,Ae){var ve=1,Ne=[v],Ie=[_],Pe=W.m,Ve=W.s,tt=null,ft=0;e:for(;;){if(V)for(;ve&&Be(Pe,1);){var He=Ne,nt=Ie,ut=W,_t=1,ht=ut.m,St=ut.gc[ut.ab],It=Be(ht,2);if(ut.Oc&1<<It)ve=0;else{switch(ut.Oc|=1<<It,St.hc=It,St.Ea=He[0],St.nc=nt[0],St.K=[null],++ut.ab,e(4>=ut.ab),It){case 0:case 1:St.b=Be(ht,3)+2,_t=Xe(Ee(St.Ea,St.b),Ee(St.nc,St.b),0,ut,St.K),St.K=St.K[0];break;case 3:var Ot,Pt=Be(ht,8)+1,fr=16<Pt?0:4<Pt?1:2<Pt?2:3;if(He[0]=Ee(St.Ea,fr),St.b=fr,Ot=_t=Xe(Pt,1,0,ut,St.K)){var sr,Dr=Pt,Ar=St,sn=1<<(8>>Ar.b),ea=a(sn);if(ea==null)Ot=0;else{var Lr=Ar.K[0],ur=Ar.w;for(ea[0]=Ar.K[0][0],sr=1;sr<1*Dr;++sr)ea[sr]=Ue(Lr[ur+sr],ea[sr-1]);for(;sr<4*sn;++sr)ea[sr]=0;Ar.K[0]=null,Ar.K[0]=ea,Ot=1}}_t=Ot;break;case 2:break;default:e(0)}ve=_t}}if(Ne=Ne[0],Ie=Ie[0],ve&&Be(Pe,1)&&!(ve=1<=(ft=Be(Pe,4))&&11>=ft)){W.a=3;break e}var Wt;if(Wt=ve)t:{var Ps,Tr,an,$n=W,ka=Ne,yi=Ie,Cs=ft,Ja=V,bi=$n.m,ta=$n.s,ln=[null],wn=1,_s=0,yn=m7[Cs];r:for(;;){if(Ja&&Be(bi,1)){var Ta=Be(bi,3)+2,wl=Ee(ka,Ta),Rs=Ee(yi,Ta),Oi=wl*Rs;if(!Xe(wl,Rs,0,$n,ln))break r;for(ln=ln[0],ta.xc=Ta,Ps=0;Ps<Oi;++Ps){var Ln=ln[Ps]>>8&65535;ln[Ps]=Ln,Ln>=wn&&(wn=Ln+1)}}if(bi.h)break r;for(Tr=0;5>Tr;++Tr){var ra=n5[Tr];!Tr&&0<Cs&&(ra+=1<<Cs),_s<ra&&(_s=ra)}var oo=o(wn*yn,L),Ni=wn,lo=o(Ni,me);if(lo==null)var co=null;else e(65536>=Ni),co=lo;var Mi=a(_s);if(co==null||Mi==null||oo==null){$n.a=1;break r}var Ao=oo;for(Ps=an=0;Ps<wn;++Ps){var Vn=co[Ps],uo=Vn.G,yl=Vn.H,Id=0,Vc=1,ja=0;for(Tr=0;5>Tr;++Tr){ra=n5[Tr],uo[Tr]=Ao,yl[Tr]=an,!Tr&&0<Cs&&(ra+=1<<Cs);s:{var t1,cb=ra,r1=$n,Im=Mi,D7=Ao,L7=an,Ab=0,JA=r1.m,U7=Be(JA,1);if(s(Im,0,0,cb),U7){var O7=Be(JA,1)+1,M7=Be(JA,1),h5=Be(JA,M7==0?1:8);Im[h5]=1,O7==2&&(Im[h5=Be(JA,8)]=1);var n1=1}else{var f5=a(19),m5=Be(JA,4)+4;if(19<m5){r1.a=3;var s1=0;break s}for(t1=0;t1<m5;++t1)f5[h7[t1]]=Be(JA,3);var ub=void 0,Fm=void 0,p5=r1,Q7=f5,a1=cb,g5=Im,db=0,XA=p5.m,x5=8,v5=o(128,L);n:for(;T(v5,0,7,Q7,19);){if(Be(XA,1)){var V7=2+2*Be(XA,3);if((ub=2+Be(XA,V7))>a1)break n}else ub=a1;for(Fm=0;Fm<a1&&ub--;){z(XA);var w5=v5[0+(127&Q(XA))];D(XA,XA.u+w5.g);var hf=w5.value;if(16>hf)g5[Fm++]=hf,hf!=0&&(x5=hf);else{var H7=hf==16,y5=hf-16,K7=u7[y5],b5=Be(XA,A7[y5])+K7;if(Fm+b5>a1)break n;for(var q7=H7?x5:0;0<b5--;)g5[Fm++]=q7}}db=1;break n}db||(p5.a=3),n1=db}(n1=n1&&!JA.h)&&(Ab=T(D7,L7,8,Im,cb)),n1&&Ab!=0?s1=Ab:(r1.a=3,s1=0)}if(s1==0)break r;if(Vc&&d7[Tr]==1&&(Vc=Ao[an].g==0),Id+=Ao[an].g,an+=s1,3>=Tr){var km,hb=Mi[0];for(km=1;km<ra;++km)Mi[km]>hb&&(hb=Mi[km]);ja+=hb}}if(Vn.nd=Vc,Vn.Qb=0,Vc&&(Vn.qb=(uo[3][yl[3]+0].value<<24|uo[1][yl[1]+0].value<<16|uo[2][yl[2]+0].value)>>>0,Id==0&&256>uo[0][yl[0]+0].value&&(Vn.Qb=1,Vn.qb+=uo[0][yl[0]+0].value<<8)),Vn.jc=!Vn.Qb&&6>ja,Vn.jc){var i1,Hc=Vn;for(i1=0;i1<Ed;++i1){var YA=i1,ZA=Hc.pd[YA],o1=Hc.G[0][Hc.H[0]+YA];256<=o1.value?(ZA.g=o1.g+256,ZA.value=o1.value):(ZA.g=0,ZA.value=0,YA>>=Kt(o1,8,ZA),YA>>=Kt(Hc.G[1][Hc.H[1]+YA],16,ZA),YA>>=Kt(Hc.G[2][Hc.H[2]+YA],0,ZA),Kt(Hc.G[3][Hc.H[3]+YA],24,ZA))}}}ta.vc=ln,ta.Wb=wn,ta.Ya=co,ta.yc=oo,Wt=1;break t}Wt=0}if(!(ve=Wt)){W.a=3;break e}if(0<ft){if(Ve.ua=1<<ft,!J(Ve.Wa,ft)){W.a=1,ve=0;break e}}else Ve.ua=0;var fb=W,N5=Ne,G7=Ie,mb=fb.s,pb=mb.xc;if(fb.c=N5,fb.i=G7,mb.md=Ee(N5,pb),mb.wc=pb==0?-1:(1<<pb)-1,V){W.xb=N7;break e}if((tt=a(Ne*Ie))==null){W.a=1,ve=0;break e}ve=(ve=We(W,tt,0,Ne,Ie,Ie,null))&&!Pe.h;break e}return ve?(Ae!=null?Ae[0]=tt:(e(tt==null),e(V)),W.$=0,V||rt(Ve)):rt(Ve),ve}function et(v,_){var V=v.c*v.i,W=V+_+16*_;return e(v.c<=_),v.V=a(W),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+V+_,1)}function dt(v,_){var V=v.C,W=_-V,Ae=v.V,ve=v.Ba+v.c*V;for(e(_<=v.l.o);0<W;){var Ne=16<W?16:W,Ie=v.l.ma,Pe=v.l.width,Ve=Pe*Ne,tt=Ie.ca,ft=Ie.tb+Pe*V,He=v.Ta,nt=v.Ua;ne(v,Ne,Ae,ve),WI(He,nt,tt,ft,Ve),Fe(Ie,V,V+Ne,tt,ft,Pe),W-=Ne,Ae+=Ne*v.c,V+=Ne}e(V==_),v.C=v.Ma=_}function vt(){this.ub=this.yd=this.td=this.Rb=0}function Nt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function At(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function yt(){this.Yb=function(){var v=[];return function _(V,W,Ae){for(var ve=Ae[W],Ne=0;Ne<ve&&(V.push(Ae.length>W+1?[]:0),!(Ae.length<W+1));Ne++)_(V[Ne],W+1,Ae)}(v,0,[3,11]),v}()}function Zt(){this.jb=a(3),this.Wc=l([4,8],yt),this.Xc=l([4,17],yt)}function Rr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Nr(){this.ld=this.La=this.dd=this.tc=0}function Jr(){this.Na=this.la=0}function Di(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function eo(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function to(){this.uc=this.M=this.Nb=0,this.wa=Array(new Nr),this.Y=0,this.ya=Array(new eo),this.aa=0,this.l=new Jl}function xi(){this.y=a(16),this.f=a(8),this.ea=a(8)}function ml(){this.cb=this.a=0,this.sc="",this.m=new I,this.Od=new vt,this.Kc=new Nt,this.ed=new Rr,this.Qa=new At,this.Ic=this.$c=this.Aa=0,this.D=new to,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,I),this.ia=0,this.pb=o(4,Di),this.Pa=new Zt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new xi),this.Hd=0,this.rb=Array(new Jr),this.sb=0,this.wa=Array(new Nr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new eo),this.L=this.aa=0,this.gd=l([4,2],Nr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ts(v,_){return 0>v?0:v>_?_:v}function Jl(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function rf(){var v=new ml;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Bm||(Bm=jc)),v}function ds(v,_,V){return v.a==0&&(v.a=_,v.sc=V,v.cb=0),0}function nf(v,_,V){return 3<=V&&v[_+0]==157&&v[_+1]==1&&v[_+2]==42}function jo(v,_){if(v==null)return 0;if(v.a=0,v.sc="OK",_==null)return ds(v,2,"null VP8Io passed to VP8GetHeaders()");var V=_.data,W=_.w,Ae=_.ha;if(4>Ae)return ds(v,7,"Truncated header.");var ve=V[W+0]|V[W+1]<<8|V[W+2]<<16,Ne=v.Od;if(Ne.Rb=!(1&ve),Ne.td=ve>>1&7,Ne.yd=ve>>4&1,Ne.ub=ve>>5,3<Ne.td)return ds(v,3,"Incorrect keyframe parameters.");if(!Ne.yd)return ds(v,4,"Frame not displayable.");W+=3,Ae-=3;var Ie=v.Kc;if(Ne.Rb){if(7>Ae)return ds(v,7,"cannot parse picture header");if(!nf(V,W,Ae))return ds(v,3,"Bad code word");Ie.c=16383&(V[W+4]<<8|V[W+3]),Ie.Td=V[W+4]>>6,Ie.i=16383&(V[W+6]<<8|V[W+5]),Ie.Ud=V[W+6]>>6,W+=7,Ae-=7,v.za=Ie.c+15>>4,v.Ub=Ie.i+15>>4,_.width=Ie.c,_.height=Ie.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,s((ve=v.Pa).jb,0,255,ve.jb.length),e((ve=v.Qa)!=null),ve.Cb=0,ve.Bb=0,ve.Fb=1,s(ve.Zb,0,0,ve.Zb.length),s(ve.Lb,0,0,ve.Lb)}if(Ne.ub>Ae)return ds(v,7,"bad partition length");ae(ve=v.m,V,W,Ne.ub),W+=Ne.ub,Ae-=Ne.ub,Ne.Rb&&(Ie.Ld=te(ve),Ie.Kd=te(ve)),Ie=v.Qa;var Pe,Ve=v.Pa;if(e(ve!=null),e(Ie!=null),Ie.Cb=te(ve),Ie.Cb){if(Ie.Bb=te(ve),te(ve)){for(Ie.Fb=te(ve),Pe=0;4>Pe;++Pe)Ie.Zb[Pe]=te(ve)?de(ve,7):0;for(Pe=0;4>Pe;++Pe)Ie.Lb[Pe]=te(ve)?de(ve,6):0}if(Ie.Bb)for(Pe=0;3>Pe;++Pe)Ve.jb[Pe]=te(ve)?fe(ve,8):255}else Ie.Bb=0;if(ve.Ka)return ds(v,3,"cannot parse segment header");if((Ie=v.ed).zd=te(ve),Ie.Tb=fe(ve,6),Ie.wb=fe(ve,3),Ie.Pc=te(ve),Ie.Pc&&te(ve)){for(Ve=0;4>Ve;++Ve)te(ve)&&(Ie.vd[Ve]=de(ve,6));for(Ve=0;4>Ve;++Ve)te(ve)&&(Ie.od[Ve]=de(ve,6))}if(v.L=Ie.Tb==0?0:Ie.zd?1:2,ve.Ka)return ds(v,3,"cannot parse filter header");var tt=Ae;if(Ae=Pe=W,W=Pe+tt,Ie=tt,v.Xb=(1<<fe(v.m,2))-1,tt<3*(Ve=v.Xb))V=7;else{for(Pe+=3*Ve,Ie-=3*Ve,tt=0;tt<Ve;++tt){var ft=V[Ae+0]|V[Ae+1]<<8|V[Ae+2]<<16;ft>Ie&&(ft=Ie),ae(v.Jc[+tt],V,Pe,ft),Pe+=ft,Ie-=ft,Ae+=3}ae(v.Jc[+Ve],V,Pe,Ie),V=Pe<W?0:5}if(V!=0)return ds(v,V,"cannot parse partitions");for(V=fe(Pe=v.m,7),Ae=te(Pe)?de(Pe,4):0,W=te(Pe)?de(Pe,4):0,Ie=te(Pe)?de(Pe,4):0,Ve=te(Pe)?de(Pe,4):0,Pe=te(Pe)?de(Pe,4):0,tt=v.Qa,ft=0;4>ft;++ft){if(tt.Cb){var He=tt.Zb[ft];tt.Fb||(He+=V)}else{if(0<ft){v.pb[ft]=v.pb[0];continue}He=V}var nt=v.pb[ft];nt.Sc[0]=ib[ts(He+Ae,127)],nt.Sc[1]=ob[ts(He+0,127)],nt.Eb[0]=2*ib[ts(He+W,127)],nt.Eb[1]=101581*ob[ts(He+Ie,127)]>>16,8>nt.Eb[1]&&(nt.Eb[1]=8),nt.Qc[0]=ib[ts(He+Ve,117)],nt.Qc[1]=ob[ts(He+Pe,127)],nt.lc=He+Pe}if(!Ne.Rb)return ds(v,4,"Not a key frame.");for(te(ve),Ne=v.Pa,V=0;4>V;++V){for(Ae=0;8>Ae;++Ae)for(W=0;3>W;++W)for(Ie=0;11>Ie;++Ie)Ve=se(ve,y7[V][Ae][W][Ie])?fe(ve,8):v7[V][Ae][W][Ie],Ne.Wc[V][Ae].Yb[W][Ie]=Ve;for(Ae=0;17>Ae;++Ae)Ne.Xc[V][Ae]=Ne.Wc[V][b7[Ae]]}return v.kc=te(ve),v.kc&&(v.Bd=fe(ve,8)),v.cb=1}function jc(v,_,V,W,Ae,ve,Ne){var Ie=_[Ae].Yb[V];for(V=0;16>Ae;++Ae){if(!se(v,Ie[V+0]))return Ae;for(;!se(v,Ie[V+1]);)if(Ie=_[++Ae].Yb[0],V=0,Ae==16)return 16;var Pe=_[Ae+1].Yb;if(se(v,Ie[V+2])){var Ve=v,tt=0;if(se(Ve,(He=Ie)[(ft=V)+3]))if(se(Ve,He[ft+6])){for(Ie=0,ft=2*(tt=se(Ve,He[ft+8]))+(He=se(Ve,He[ft+9+tt])),tt=0,He=g7[ft];He[Ie];++Ie)tt+=tt+se(Ve,He[Ie]);tt+=3+(8<<ft)}else se(Ve,He[ft+7])?(tt=7+2*se(Ve,165),tt+=se(Ve,145)):tt=5+se(Ve,159);else tt=se(Ve,He[ft+4])?3+se(Ve,He[ft+5]):2;Ie=Pe[2]}else tt=1,Ie=Pe[1];Pe=Ne+x7[Ae],0>(Ve=v).b&&O(Ve);var ft,He=Ve.b,nt=(ft=Ve.Ca>>1)-(Ve.I>>He)>>31;--Ve.b,Ve.Ca+=nt,Ve.Ca|=1,Ve.I-=(ft+1&nt)<<He,ve[Pe]=((tt^nt)-nt)*W[(0<Ae)+0]}return 16}function wd(v){var _=v.rb[v.sb-1];_.la=0,_.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function Li(v,_,V,W,Ae){Ae=v[_+V+32*W]+(Ae>>3),v[_+V+32*W]=-256&Ae?0>Ae?0:255:Ae}function Rn(v,_,V,W,Ae,ve){Li(v,_,0,V,W+Ae),Li(v,_,1,V,W+ve),Li(v,_,2,V,W-ve),Li(v,_,3,V,W-Ae)}function Ys(v){return(20091*v>>16)+v}function Pc(v,_,V,W){var Ae,ve=0,Ne=a(16);for(Ae=0;4>Ae;++Ae){var Ie=v[_+0]+v[_+8],Pe=v[_+0]-v[_+8],Ve=(35468*v[_+4]>>16)-Ys(v[_+12]),tt=Ys(v[_+4])+(35468*v[_+12]>>16);Ne[ve+0]=Ie+tt,Ne[ve+1]=Pe+Ve,Ne[ve+2]=Pe-Ve,Ne[ve+3]=Ie-tt,ve+=4,_++}for(Ae=ve=0;4>Ae;++Ae)Ie=(v=Ne[ve+0]+4)+Ne[ve+8],Pe=v-Ne[ve+8],Ve=(35468*Ne[ve+4]>>16)-Ys(Ne[ve+12]),Li(V,W,0,0,Ie+(tt=Ys(Ne[ve+4])+(35468*Ne[ve+12]>>16))),Li(V,W,1,0,Pe+Ve),Li(V,W,2,0,Pe-Ve),Li(V,W,3,0,Ie-tt),ve++,W+=32}function RA(v,_,V,W){var Ae=v[_+0]+4,ve=35468*v[_+4]>>16,Ne=Ys(v[_+4]),Ie=35468*v[_+1]>>16;Rn(V,W,0,Ae+Ne,v=Ys(v[_+1]),Ie),Rn(V,W,1,Ae+ve,v,Ie),Rn(V,W,2,Ae-ve,v,Ie),Rn(V,W,3,Ae-Ne,v,Ie)}function sf(v,_,V,W,Ae){Pc(v,_,V,W),Ae&&Pc(v,_+16,V,W+4)}function Xr(v,_,V,W){Sd(v,_+0,V,W,1),Sd(v,_+32,V,W+128,1)}function Rc(v,_,V,W){var Ae;for(v=v[_+0]+4,Ae=0;4>Ae;++Ae)for(_=0;4>_;++_)Li(V,W,_,Ae,v)}function Xl(v,_,V,W){v[_+0]&&gn(v,_+0,V,W),v[_+16]&&gn(v,_+16,V,W+4),v[_+32]&&gn(v,_+32,V,W+128),v[_+48]&&gn(v,_+48,V,W+128+4)}function Po(v,_,V,W){var Ae,ve=a(16);for(Ae=0;4>Ae;++Ae){var Ne=v[_+0+Ae]+v[_+12+Ae],Ie=v[_+4+Ae]+v[_+8+Ae],Pe=v[_+4+Ae]-v[_+8+Ae],Ve=v[_+0+Ae]-v[_+12+Ae];ve[0+Ae]=Ne+Ie,ve[8+Ae]=Ne-Ie,ve[4+Ae]=Ve+Pe,ve[12+Ae]=Ve-Pe}for(Ae=0;4>Ae;++Ae)Ne=(v=ve[0+4*Ae]+3)+ve[3+4*Ae],Ie=ve[1+4*Ae]+ve[2+4*Ae],Pe=ve[1+4*Ae]-ve[2+4*Ae],Ve=v-ve[3+4*Ae],V[W+0]=Ne+Ie>>3,V[W+16]=Ve+Pe>>3,V[W+32]=Ne-Ie>>3,V[W+48]=Ve-Pe>>3,W+=64}function Dc(v,_,V){var W,Ae=_-32,ve=io,Ne=255-v[Ae-1];for(W=0;W<V;++W){var Ie,Pe=ve,Ve=Ne+v[_-1];for(Ie=0;Ie<V;++Ie)v[_+Ie]=Pe[Ve+v[Ae+Ie]];_+=32}}function af(v,_){Dc(v,_,4)}function dm(v,_){Dc(v,_,8)}function hm(v,_){Dc(v,_,16)}function yd(v,_){var V;for(V=0;16>V;++V)n(v,_+32*V,v,_-32,16)}function of(v,_){var V;for(V=16;0<V;--V)s(v,_,v[_-1],16),_+=32}function Ia(v,_,V){var W;for(W=0;16>W;++W)s(_,V+32*W,v,16)}function Ro(v,_){var V,W=16;for(V=0;16>V;++V)W+=v[_-1+32*V]+v[_+V-32];Ia(W>>5,v,_)}function Yl(v,_){var V,W=8;for(V=0;16>V;++V)W+=v[_-1+32*V];Ia(W>>4,v,_)}function DA(v,_){var V,W=8;for(V=0;16>V;++V)W+=v[_+V-32];Ia(W>>4,v,_)}function lf(v,_){Ia(128,v,_)}function vr(v,_,V){return v+2*_+V+2>>2}function fm(v,_){var V,W=_-32;for(W=new Uint8Array([vr(v[W-1],v[W+0],v[W+1]),vr(v[W+0],v[W+1],v[W+2]),vr(v[W+1],v[W+2],v[W+3]),vr(v[W+2],v[W+3],v[W+4])]),V=0;4>V;++V)n(v,_+32*V,W,0,W.length)}function mm(v,_){var V=v[_-1],W=v[_-1+32],Ae=v[_-1+64],ve=v[_-1+96];we(v,_+0,16843009*vr(v[_-1-32],V,W)),we(v,_+32,16843009*vr(V,W,Ae)),we(v,_+64,16843009*vr(W,Ae,ve)),we(v,_+96,16843009*vr(Ae,ve,ve))}function pm(v,_){var V,W=4;for(V=0;4>V;++V)W+=v[_+V-32]+v[_-1+32*V];for(W>>=3,V=0;4>V;++V)s(v,_+32*V,W,4)}function fa(v,_){var V=v[_-1+0],W=v[_-1+32],Ae=v[_-1+64],ve=v[_-1-32],Ne=v[_+0-32],Ie=v[_+1-32],Pe=v[_+2-32],Ve=v[_+3-32];v[_+0+96]=vr(W,Ae,v[_-1+96]),v[_+1+96]=v[_+0+64]=vr(V,W,Ae),v[_+2+96]=v[_+1+64]=v[_+0+32]=vr(ve,V,W),v[_+3+96]=v[_+2+64]=v[_+1+32]=v[_+0+0]=vr(Ne,ve,V),v[_+3+64]=v[_+2+32]=v[_+1+0]=vr(Ie,Ne,ve),v[_+3+32]=v[_+2+0]=vr(Pe,Ie,Ne),v[_+3+0]=vr(Ve,Pe,Ie)}function pl(v,_){var V=v[_+1-32],W=v[_+2-32],Ae=v[_+3-32],ve=v[_+4-32],Ne=v[_+5-32],Ie=v[_+6-32],Pe=v[_+7-32];v[_+0+0]=vr(v[_+0-32],V,W),v[_+1+0]=v[_+0+32]=vr(V,W,Ae),v[_+2+0]=v[_+1+32]=v[_+0+64]=vr(W,Ae,ve),v[_+3+0]=v[_+2+32]=v[_+1+64]=v[_+0+96]=vr(Ae,ve,Ne),v[_+3+32]=v[_+2+64]=v[_+1+96]=vr(ve,Ne,Ie),v[_+3+64]=v[_+2+96]=vr(Ne,Ie,Pe),v[_+3+96]=vr(Ie,Pe,Pe)}function gm(v,_){var V=v[_-1+0],W=v[_-1+32],Ae=v[_-1+64],ve=v[_-1-32],Ne=v[_+0-32],Ie=v[_+1-32],Pe=v[_+2-32],Ve=v[_+3-32];v[_+0+0]=v[_+1+64]=ve+Ne+1>>1,v[_+1+0]=v[_+2+64]=Ne+Ie+1>>1,v[_+2+0]=v[_+3+64]=Ie+Pe+1>>1,v[_+3+0]=Pe+Ve+1>>1,v[_+0+96]=vr(Ae,W,V),v[_+0+64]=vr(W,V,ve),v[_+0+32]=v[_+1+96]=vr(V,ve,Ne),v[_+1+32]=v[_+2+96]=vr(ve,Ne,Ie),v[_+2+32]=v[_+3+96]=vr(Ne,Ie,Pe),v[_+3+32]=vr(Ie,Pe,Ve)}function LA(v,_){var V=v[_+0-32],W=v[_+1-32],Ae=v[_+2-32],ve=v[_+3-32],Ne=v[_+4-32],Ie=v[_+5-32],Pe=v[_+6-32],Ve=v[_+7-32];v[_+0+0]=V+W+1>>1,v[_+1+0]=v[_+0+64]=W+Ae+1>>1,v[_+2+0]=v[_+1+64]=Ae+ve+1>>1,v[_+3+0]=v[_+2+64]=ve+Ne+1>>1,v[_+0+32]=vr(V,W,Ae),v[_+1+32]=v[_+0+96]=vr(W,Ae,ve),v[_+2+32]=v[_+1+96]=vr(Ae,ve,Ne),v[_+3+32]=v[_+2+96]=vr(ve,Ne,Ie),v[_+3+64]=vr(Ne,Ie,Pe),v[_+3+96]=vr(Ie,Pe,Ve)}function gl(v,_){var V=v[_-1+0],W=v[_-1+32],Ae=v[_-1+64],ve=v[_-1+96];v[_+0+0]=V+W+1>>1,v[_+2+0]=v[_+0+32]=W+Ae+1>>1,v[_+2+32]=v[_+0+64]=Ae+ve+1>>1,v[_+1+0]=vr(V,W,Ae),v[_+3+0]=v[_+1+32]=vr(W,Ae,ve),v[_+3+32]=v[_+1+64]=vr(Ae,ve,ve),v[_+3+64]=v[_+2+64]=v[_+0+96]=v[_+1+96]=v[_+2+96]=v[_+3+96]=ve}function UA(v,_){var V=v[_-1+0],W=v[_-1+32],Ae=v[_-1+64],ve=v[_-1+96],Ne=v[_-1-32],Ie=v[_+0-32],Pe=v[_+1-32],Ve=v[_+2-32];v[_+0+0]=v[_+2+32]=V+Ne+1>>1,v[_+0+32]=v[_+2+64]=W+V+1>>1,v[_+0+64]=v[_+2+96]=Ae+W+1>>1,v[_+0+96]=ve+Ae+1>>1,v[_+3+0]=vr(Ie,Pe,Ve),v[_+2+0]=vr(Ne,Ie,Pe),v[_+1+0]=v[_+3+32]=vr(V,Ne,Ie),v[_+1+32]=v[_+3+64]=vr(W,V,Ne),v[_+1+64]=v[_+3+96]=vr(Ae,W,V),v[_+1+96]=vr(ve,Ae,W)}function ro(v,_){var V;for(V=0;8>V;++V)n(v,_+32*V,v,_-32,8)}function Lc(v,_){var V;for(V=0;8>V;++V)s(v,_,v[_-1],8),_+=32}function Do(v,_,V){var W;for(W=0;8>W;++W)s(_,V+32*W,v,8)}function bd(v,_){var V,W=8;for(V=0;8>V;++V)W+=v[_+V-32]+v[_-1+32*V];Do(W>>4,v,_)}function kn(v,_){var V,W=4;for(V=0;8>V;++V)W+=v[_+V-32];Do(W>>3,v,_)}function Nd(v,_){var V,W=4;for(V=0;8>V;++V)W+=v[_-1+32*V];Do(W>>3,v,_)}function cf(v,_){Do(128,v,_)}function Lo(v,_,V){var W=v[_-V],Ae=v[_+0],ve=3*(Ae-W)+tb[1020+v[_-2*V]-v[_+V]],Ne=Gx[112+(ve+4>>3)];v[_-V]=io[255+W+Gx[112+(ve+3>>3)]],v[_+0]=io[255+Ae-Ne]}function OA(v,_,V,W){var Ae=v[_+0],ve=v[_+V];return Ho[255+v[_-2*V]-v[_-V]]>W||Ho[255+ve-Ae]>W}function Uc(v,_,V,W){return 4*Ho[255+v[_-V]-v[_+0]]+Ho[255+v[_-2*V]-v[_+V]]<=W}function Zl(v,_,V,W,Ae){var ve=v[_-3*V],Ne=v[_-2*V],Ie=v[_-V],Pe=v[_+0],Ve=v[_+V],tt=v[_+2*V],ft=v[_+3*V];return 4*Ho[255+Ie-Pe]+Ho[255+Ne-Ve]>W?0:Ho[255+v[_-4*V]-ve]<=Ae&&Ho[255+ve-Ne]<=Ae&&Ho[255+Ne-Ie]<=Ae&&Ho[255+ft-tt]<=Ae&&Ho[255+tt-Ve]<=Ae&&Ho[255+Ve-Pe]<=Ae}function ec(v,_,V,W){var Ae=2*W+1;for(W=0;16>W;++W)Uc(v,_+W,V,Ae)&&Lo(v,_+W,V)}function vi(v,_,V,W){var Ae=2*W+1;for(W=0;16>W;++W)Uc(v,_+W*V,1,Ae)&&Lo(v,_+W*V,1)}function Cd(v,_,V,W){var Ae;for(Ae=3;0<Ae;--Ae)ec(v,_+=4*V,V,W)}function Af(v,_,V,W){var Ae;for(Ae=3;0<Ae;--Ae)vi(v,_+=4,V,W)}function wi(v,_,V,W,Ae,ve,Ne,Ie){for(ve=2*ve+1;0<Ae--;){if(Zl(v,_,V,ve,Ne))if(OA(v,_,V,Ie))Lo(v,_,V);else{var Pe=v,Ve=_,tt=V,ft=Pe[Ve-2*tt],He=Pe[Ve-tt],nt=Pe[Ve+0],ut=Pe[Ve+tt],_t=Pe[Ve+2*tt],ht=27*(It=tb[1020+3*(nt-He)+tb[1020+ft-ut]])+63>>7,St=18*It+63>>7,It=9*It+63>>7;Pe[Ve-3*tt]=io[255+Pe[Ve-3*tt]+It],Pe[Ve-2*tt]=io[255+ft+St],Pe[Ve-tt]=io[255+He+ht],Pe[Ve+0]=io[255+nt-ht],Pe[Ve+tt]=io[255+ut-St],Pe[Ve+2*tt]=io[255+_t-It]}_+=W}}function Uo(v,_,V,W,Ae,ve,Ne,Ie){for(ve=2*ve+1;0<Ae--;){if(Zl(v,_,V,ve,Ne))if(OA(v,_,V,Ie))Lo(v,_,V);else{var Pe=v,Ve=_,tt=V,ft=Pe[Ve-tt],He=Pe[Ve+0],nt=Pe[Ve+tt],ut=Gx[112+(4+(_t=3*(He-ft))>>3)],_t=Gx[112+(_t+3>>3)],ht=ut+1>>1;Pe[Ve-2*tt]=io[255+Pe[Ve-2*tt]+ht],Pe[Ve-tt]=io[255+ft+_t],Pe[Ve+0]=io[255+He-ut],Pe[Ve+tt]=io[255+nt-ht]}_+=W}}function MA(v,_,V,W,Ae,ve){wi(v,_,V,1,16,W,Ae,ve)}function Oo(v,_,V,W,Ae,ve){wi(v,_,1,V,16,W,Ae,ve)}function _d(v,_,V,W,Ae,ve){var Ne;for(Ne=3;0<Ne;--Ne)Uo(v,_+=4*V,V,1,16,W,Ae,ve)}function P(v,_,V,W,Ae,ve){var Ne;for(Ne=3;0<Ne;--Ne)Uo(v,_+=4,1,V,16,W,Ae,ve)}function ce(v,_,V,W,Ae,ve,Ne,Ie){wi(v,_,Ae,1,8,ve,Ne,Ie),wi(V,W,Ae,1,8,ve,Ne,Ie)}function Qe(v,_,V,W,Ae,ve,Ne,Ie){wi(v,_,1,Ae,8,ve,Ne,Ie),wi(V,W,1,Ae,8,ve,Ne,Ie)}function Je(v,_,V,W,Ae,ve,Ne,Ie){Uo(v,_+4*Ae,Ae,1,8,ve,Ne,Ie),Uo(V,W+4*Ae,Ae,1,8,ve,Ne,Ie)}function lt(v,_,V,W,Ae,ve,Ne,Ie){Uo(v,_+4,1,Ae,8,ve,Ne,Ie),Uo(V,W+4,1,Ae,8,ve,Ne,Ie)}function Bt(){this.ba=new it,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function kt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function tr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function cr(){this.ua=0,this.Wa=new ie,this.vb=new ie,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new me,this.yc=new L}function wr(){this.xb=this.a=0,this.l=new Jl,this.ca=new it,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new C,this.Pb=0,this.wd=new C,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new cr,this.ab=0,this.gc=o(4,tr),this.Oc=0}function Ir(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Jl,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Yr(v,_,V,W,Ae,ve,Ne){for(v=v==null?0:v[_+0],_=0;_<Ne;++_)Ae[ve+_]=v+V[W+_]&255,v=Ae[ve+_]}function pn(v,_,V,W,Ae,ve,Ne){var Ie;if(v==null)Yr(null,null,V,W,Ae,ve,Ne);else for(Ie=0;Ie<Ne;++Ie)Ae[ve+Ie]=v[_+Ie]+V[W+Ie]&255}function hs(v,_,V,W,Ae,ve,Ne){if(v==null)Yr(null,null,V,W,Ae,ve,Ne);else{var Ie,Pe=v[_+0],Ve=Pe,tt=Pe;for(Ie=0;Ie<Ne;++Ie)Ve=tt+(Pe=v[_+Ie])-Ve,tt=V[W+Ie]+(-256&Ve?0>Ve?0:255:Ve)&255,Ve=Pe,Ae[ve+Ie]=tt}}function vn(v,_,V,W){var Ae=_.width,ve=_.o;if(e(v!=null&&_!=null),0>V||0>=W||V+W>ve)return null;if(!v.Cc){if(v.ga==null){var Ne;if(v.ga=new Ir,(Ne=v.ga==null)||(Ne=_.width*_.o,e(v.Gb.length==0),v.Gb=a(Ne),v.Uc=0,v.Gb==null?Ne=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Ne=1),Ne=!Ne),!Ne){Ne=v.ga;var Ie=v.Fa,Pe=v.P,Ve=v.qc,tt=v.mb,ft=v.nb,He=Pe+1,nt=Ve-1,ut=Ne.l;if(e(Ie!=null&&tt!=null&&_!=null),WA[0]=null,WA[1]=Yr,WA[2]=pn,WA[3]=hs,Ne.ca=tt,Ne.tb=ft,Ne.c=_.width,Ne.i=_.height,e(0<Ne.c&&0<Ne.i),1>=Ve)_=0;else if(Ne.$a=3&Ie[Pe+0],Ne.Z=Ie[Pe+0]>>2&3,Ne.Lc=Ie[Pe+0]>>4&3,Pe=Ie[Pe+0]>>6&3,0>Ne.$a||1<Ne.$a||4<=Ne.Z||1<Ne.Lc||Pe)_=0;else if(ut.put=Ye,ut.ac=xr,ut.bc=pt,ut.ma=Ne,ut.width=_.width,ut.height=_.height,ut.Da=_.Da,ut.v=_.v,ut.va=_.va,ut.j=_.j,ut.o=_.o,Ne.$a)e:{e(Ne.$a==1),_=Le();t:for(;;){if(_==null){_=0;break e}if(e(Ne!=null),Ne.mc=_,_.c=Ne.c,_.i=Ne.i,_.l=Ne.l,_.l.ma=Ne,_.l.width=Ne.c,_.l.height=Ne.i,_.a=0,Z(_.m,Ie,He,nt),!Xe(Ne.c,Ne.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&ge(_.s)?(Ne.ic=1,Ie=_.c*_.i,_.Ta=null,_.Ua=0,_.V=a(Ie),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(Ne.ic=0,_=et(_,Ne.c)),!_))break t;_=1;break e}Ne.mc=null,_=0}else _=nt>=Ne.c*Ne.i;Ne=!_}if(Ne)return null;v.ga.Lc!=1?v.Ga=0:W=ve-V}e(v.ga!=null),e(V+W<=ve);e:{if(_=(Ie=v.ga).c,ve=Ie.l.o,Ie.$a==0){if(He=v.rc,nt=v.Vc,ut=v.Fa,Pe=v.P+1+V*_,Ve=v.mb,tt=v.nb+V*_,e(Pe<=v.P+v.qc),Ie.Z!=0)for(e(WA[Ie.Z]!=null),Ne=0;Ne<W;++Ne)WA[Ie.Z](He,nt,ut,Pe,Ve,tt,_),He=Ve,nt=tt,tt+=_,Pe+=_;else for(Ne=0;Ne<W;++Ne)n(Ve,tt,ut,Pe,_),He=Ve,nt=tt,tt+=_,Pe+=_;v.rc=He,v.Vc=nt}else{if(e(Ie.mc!=null),_=V+W,e((Ne=Ie.mc)!=null),e(_<=Ne.i),Ne.C>=_)_=1;else if(Ie.ic||Ui(),Ie.ic){Ie=Ne.V,He=Ne.Ba,nt=Ne.c;var _t=Ne.i,ht=(ut=1,Pe=Ne.$/nt,Ve=Ne.$%nt,tt=Ne.m,ft=Ne.s,Ne.$),St=nt*_t,It=nt*_,Ot=ft.wc,Pt=ht<It?oe(ft,Ve,Pe):null;e(ht<=St),e(_<=_t),e(ge(ft));t:for(;;){for(;!tt.h&&ht<It;){if(Ve&Ot||(Pt=oe(ft,Ve,Pe)),e(Pt!=null),z(tt),256>(_t=Xt(Pt.G[0],Pt.H[0],tt)))Ie[He+ht]=_t,++ht,++Ve>=nt&&(Ve=0,++Pe<=_&&!(Pe%16)&&De(Ne,Pe));else{if(!(280>_t)){ut=0;break t}_t=Tt(_t-256,tt);var fr,sr=Xt(Pt.G[4],Pt.H[4],tt);if(z(tt),!(ht>=(sr=Dt(nt,sr=Tt(sr,tt)))&&St-ht>=_t)){ut=0;break t}for(fr=0;fr<_t;++fr)Ie[He+ht+fr]=Ie[He+ht+fr-sr];for(ht+=_t,Ve+=_t;Ve>=nt;)Ve-=nt,++Pe<=_&&!(Pe%16)&&De(Ne,Pe);ht<It&&Ve&Ot&&(Pt=oe(ft,Ve,Pe))}e(tt.h==M(tt))}De(Ne,Pe>_?_:Pe);break t}!ut||tt.h&&ht<St?(ut=0,Ne.a=tt.h?5:3):Ne.$=ht,_=ut}else _=We(Ne,Ne.V,Ne.Ba,Ne.c,Ne.i,_,dt);if(!_){W=0;break e}}V+W>=ve&&(v.Cc=1),W=1}if(!W)return null;if(v.Cc&&((W=v.ga)!=null&&(W.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+V*Ae}function bs(v,_,V,W,Ae,ve){for(;0<Ae--;){var Ne,Ie=v,Pe=_+(V?1:0),Ve=v,tt=_+(V?0:3);for(Ne=0;Ne<W;++Ne){var ft=Ve[tt+4*Ne];ft!=255&&(ft*=32897,Ie[Pe+4*Ne+0]=Ie[Pe+4*Ne+0]*ft>>23,Ie[Pe+4*Ne+1]=Ie[Pe+4*Ne+1]*ft>>23,Ie[Pe+4*Ne+2]=Ie[Pe+4*Ne+2]*ft>>23)}_+=ve}}function fs(v,_,V,W,Ae){for(;0<W--;){var ve;for(ve=0;ve<V;++ve){var Ne=v[_+2*ve+0],Ie=15&(Ve=v[_+2*ve+1]),Pe=4369*Ie,Ve=(240&Ve|Ve>>4)*Pe>>16;v[_+2*ve+0]=(240&Ne|Ne>>4)*Pe>>16&240|(15&Ne|Ne<<4)*Pe>>16>>4&15,v[_+2*ve+1]=240&Ve|Ie}_+=Ae}}function Ns(v,_,V,W,Ae,ve,Ne,Ie){var Pe,Ve,tt=255;for(Ve=0;Ve<Ae;++Ve){for(Pe=0;Pe<W;++Pe){var ft=v[_+Pe];ve[Ne+4*Pe]=ft,tt&=ft}_+=V,Ne+=Ie}return tt!=255}function ms(v,_,V,W,Ae){var ve;for(ve=0;ve<Ae;++ve)V[W+ve]=v[_+ve]>>8}function Ui(){Em=bs,$I=fs,zI=Ns,WI=ms}function Mo(v,_,V){B[v]=function(W,Ae,ve,Ne,Ie,Pe,Ve,tt,ft,He,nt,ut,_t,ht,St,It,Ot){var Pt,fr=Ot-1>>1,sr=Ie[Pe+0]|Ve[tt+0]<<16,Dr=ft[He+0]|nt[ut+0]<<16;e(W!=null);var Ar=3*sr+Dr+131074>>2;for(_(W[Ae+0],255&Ar,Ar>>16,_t,ht),ve!=null&&(Ar=3*Dr+sr+131074>>2,_(ve[Ne+0],255&Ar,Ar>>16,St,It)),Pt=1;Pt<=fr;++Pt){var sn=Ie[Pe+Pt]|Ve[tt+Pt]<<16,ea=ft[He+Pt]|nt[ut+Pt]<<16,Lr=sr+sn+Dr+ea+524296,ur=Lr+2*(sn+Dr)>>3;Ar=ur+sr>>1,sr=(Lr=Lr+2*(sr+ea)>>3)+sn>>1,_(W[Ae+2*Pt-1],255&Ar,Ar>>16,_t,ht+(2*Pt-1)*V),_(W[Ae+2*Pt-0],255&sr,sr>>16,_t,ht+(2*Pt-0)*V),ve!=null&&(Ar=Lr+Dr>>1,sr=ur+ea>>1,_(ve[Ne+2*Pt-1],255&Ar,Ar>>16,St,It+(2*Pt-1)*V),_(ve[Ne+2*Pt+0],255&sr,sr>>16,St,It+(2*Pt+0)*V)),sr=sn,Dr=ea}1&Ot||(Ar=3*sr+Dr+131074>>2,_(W[Ae+Ot-1],255&Ar,Ar>>16,_t,ht+(Ot-1)*V),ve!=null&&(Ar=3*Dr+sr+131074>>2,_(ve[Ne+Ot-1],255&Ar,Ar>>16,St,It+(Ot-1)*V)))}}function Qo(){Ko[$x]=C7,Ko[zx]=i5,Ko[t5]=_7,Ko[Wx]=o5,Ko[Jx]=l5,Ko[rb]=c5,Ko[r5]=E7,Ko[nb]=i5,Ko[sb]=o5,Ko[Xx]=l5,Ko[ab]=c5}function w(v){return v&-16384?0>v?0:255:v>>B7}function H(v,_){return w((19077*v>>8)+(26149*_>>8)-14234)}function ee(v,_,V){return w((19077*v>>8)-(6419*_>>8)-(13320*V>>8)+8708)}function ke(v,_){return w((19077*v>>8)+(33050*_>>8)-17685)}function ct(v,_,V,W,Ae){W[Ae+0]=H(v,V),W[Ae+1]=ee(v,_,V),W[Ae+2]=ke(v,_)}function gt(v,_,V,W,Ae){W[Ae+0]=ke(v,_),W[Ae+1]=ee(v,_,V),W[Ae+2]=H(v,V)}function Ht(v,_,V,W,Ae){var ve=ee(v,_,V);_=ve<<3&224|ke(v,_)>>3,W[Ae+0]=248&H(v,V)|ve>>5,W[Ae+1]=_}function nn(v,_,V,W,Ae){var ve=240&ke(v,_)|15;W[Ae+0]=240&H(v,V)|ee(v,_,V)>>4,W[Ae+1]=ve}function ps(v,_,V,W,Ae){W[Ae+0]=255,ct(v,_,V,W,Ae+1)}function Kr(v,_,V,W,Ae){gt(v,_,V,W,Ae),W[Ae+3]=255}function dn(v,_,V,W,Ae){ct(v,_,V,W,Ae),W[Ae+3]=255}function Qn(v,_,V){B[v]=function(W,Ae,ve,Ne,Ie,Pe,Ve,tt,ft){for(var He=tt+(-2&ft)*V;tt!=He;)_(W[Ae+0],ve[Ne+0],Ie[Pe+0],Ve,tt),_(W[Ae+1],ve[Ne+0],Ie[Pe+0],Ve,tt+V),Ae+=2,++Ne,++Pe,tt+=2*V;1&ft&&_(W[Ae+0],ve[Ne+0],Ie[Pe+0],Ve,tt)}}function no(v,_,V){return V==0?v==0?_==0?6:5:_==0?4:0:V}function Wa(v,_,V,W,Ae){switch(v>>>30){case 3:Sd(_,V,W,Ae,0);break;case 2:Vo(_,V,W,Ae);break;case 1:gn(_,V,W,Ae)}}function Fa(v,_){var V,W,Ae=_.M,ve=_.Nb,Ne=v.oc,Ie=v.pc+40,Pe=v.oc,Ve=v.pc+584,tt=v.oc,ft=v.pc+600;for(V=0;16>V;++V)Ne[Ie+32*V-1]=129;for(V=0;8>V;++V)Pe[Ve+32*V-1]=129,tt[ft+32*V-1]=129;for(0<Ae?Ne[Ie-1-32]=Pe[Ve-1-32]=tt[ft-1-32]=129:(s(Ne,Ie-32-1,127,21),s(Pe,Ve-32-1,127,9),s(tt,ft-32-1,127,9)),W=0;W<v.za;++W){var He=_.ya[_.aa+W];if(0<W){for(V=-1;16>V;++V)n(Ne,Ie+32*V-4,Ne,Ie+32*V+12,4);for(V=-1;8>V;++V)n(Pe,Ve+32*V-4,Pe,Ve+32*V+4,4),n(tt,ft+32*V-4,tt,ft+32*V+4,4)}var nt=v.Gd,ut=v.Hd+W,_t=He.ad,ht=He.Hc;if(0<Ae&&(n(Ne,Ie-32,nt[ut].y,0,16),n(Pe,Ve-32,nt[ut].f,0,8),n(tt,ft-32,nt[ut].ea,0,8)),He.Za){var St=Ne,It=Ie-32+16;for(0<Ae&&(W>=v.za-1?s(St,It,nt[ut].y[15],4):n(St,It,nt[ut+1].y,0,4)),V=0;4>V;V++)St[It+128+V]=St[It+256+V]=St[It+384+V]=St[It+0+V];for(V=0;16>V;++V,ht<<=2)St=Ne,It=Ie+u5[V],vl[He.Ob[V]](St,It),Wa(ht,_t,16*+V,St,It)}else if(St=no(W,Ae,He.Ob[0]),zA[St](Ne,Ie),ht!=0)for(V=0;16>V;++V,ht<<=2)Wa(ht,_t,16*+V,Ne,Ie+u5[V]);for(V=He.Gc,St=no(W,Ae,He.Dd),Qc[St](Pe,Ve),Qc[St](tt,ft),ht=_t,St=Pe,It=Ve,255&(He=0|V)&&(170&He?nc(ht,256,St,It):Dn(ht,256,St,It)),He=tt,ht=ft,255&(V>>=8)&&(170&V?nc(_t,320,He,ht):Dn(_t,320,He,ht)),Ae<v.Ub-1&&(n(nt[ut].y,0,Ne,Ie+480,16),n(nt[ut].f,0,Pe,Ve+224,8),n(nt[ut].ea,0,tt,ft+224,8)),V=8*ve*v.B,nt=v.sa,ut=v.ta+16*W+16*ve*v.R,_t=v.qa,He=v.ra+8*W+V,ht=v.Ha,St=v.Ia+8*W+V,V=0;16>V;++V)n(nt,ut+V*v.R,Ne,Ie+32*V,16);for(V=0;8>V;++V)n(_t,He+V*v.B,Pe,Ve+32*V,8),n(ht,St+V*v.B,tt,ft+32*V,8)}}function xl(v,_,V,W,Ae,ve,Ne,Ie,Pe){var Ve=[0],tt=[0],ft=0,He=Pe!=null?Pe.kd:0,nt=Pe??new kt;if(v==null||12>V)return 7;nt.data=v,nt.w=_,nt.ha=V,_=[_],V=[V],nt.gb=[nt.gb];e:{var ut=_,_t=V,ht=nt.gb;if(e(v!=null),e(_t!=null),e(ht!=null),ht[0]=0,12<=_t[0]&&!r(v,ut[0],"RIFF")){if(r(v,ut[0]+8,"WEBP")){ht=3;break e}var St=re(v,ut[0]+4);if(12>St||4294967286<St){ht=3;break e}if(He&&St>_t[0]-8){ht=7;break e}ht[0]=St,ut[0]+=12,_t[0]-=12}ht=0}if(ht!=0)return ht;for(St=0<nt.gb[0],V=V[0];;){e:{var It=v;_t=_,ht=V;var Ot=Ve,Pt=tt,fr=ut=[0];if((Ar=ft=[ft])[0]=0,8>ht[0])ht=7;else{if(!r(It,_t[0],"VP8X")){if(re(It,_t[0]+4)!=10){ht=3;break e}if(18>ht[0]){ht=7;break e}var sr=re(It,_t[0]+8),Dr=1+Me(It,_t[0]+12);if(2147483648<=Dr*(It=1+Me(It,_t[0]+15))){ht=3;break e}fr!=null&&(fr[0]=sr),Ot!=null&&(Ot[0]=Dr),Pt!=null&&(Pt[0]=It),_t[0]+=18,ht[0]-=18,Ar[0]=1}ht=0}}if(ft=ft[0],ut=ut[0],ht!=0)return ht;if(_t=!!(2&ut),!St&&ft)return 3;if(ve!=null&&(ve[0]=!!(16&ut)),Ne!=null&&(Ne[0]=_t),Ie!=null&&(Ie[0]=0),Ne=Ve[0],ut=tt[0],ft&&_t&&Pe==null){ht=0;break}if(4>V){ht=7;break}if(St&&ft||!St&&!ft&&!r(v,_[0],"ALPH")){V=[V],nt.na=[nt.na],nt.P=[nt.P],nt.Sa=[nt.Sa];e:{sr=v,ht=_,St=V;var Ar=nt.gb;Ot=nt.na,Pt=nt.P,fr=nt.Sa,Dr=22,e(sr!=null),e(St!=null),It=ht[0];var sn=St[0];for(e(Ot!=null),e(fr!=null),Ot[0]=null,Pt[0]=null,fr[0]=0;;){if(ht[0]=It,St[0]=sn,8>sn){ht=7;break e}var ea=re(sr,It+4);if(4294967286<ea){ht=3;break e}var Lr=8+ea+1&-2;if(Dr+=Lr,0<Ar&&Dr>Ar){ht=3;break e}if(!r(sr,It,"VP8 ")||!r(sr,It,"VP8L")){ht=0;break e}if(sn[0]<Lr){ht=7;break e}r(sr,It,"ALPH")||(Ot[0]=sr,Pt[0]=It+8,fr[0]=ea),It+=Lr,sn-=Lr}}if(V=V[0],nt.na=nt.na[0],nt.P=nt.P[0],nt.Sa=nt.Sa[0],ht!=0)break}V=[V],nt.Ja=[nt.Ja],nt.xa=[nt.xa];e:if(Ar=v,ht=_,St=V,Ot=nt.gb[0],Pt=nt.Ja,fr=nt.xa,sr=ht[0],It=!r(Ar,sr,"VP8 "),Dr=!r(Ar,sr,"VP8L"),e(Ar!=null),e(St!=null),e(Pt!=null),e(fr!=null),8>St[0])ht=7;else{if(It||Dr){if(Ar=re(Ar,sr+4),12<=Ot&&Ar>Ot-12){ht=3;break e}if(He&&Ar>St[0]-8){ht=7;break e}Pt[0]=Ar,ht[0]+=8,St[0]-=8,fr[0]=Dr}else fr[0]=5<=St[0]&&Ar[sr+0]==47&&!(Ar[sr+4]>>5),Pt[0]=St[0];ht=0}if(V=V[0],nt.Ja=nt.Ja[0],nt.xa=nt.xa[0],_=_[0],ht!=0)break;if(4294967286<nt.Ja)return 3;if(Ie==null||_t||(Ie[0]=nt.xa?2:1),Ne=[Ne],ut=[ut],nt.xa){if(5>V){ht=7;break}Ie=Ne,He=ut,_t=ve,v==null||5>V?v=0:5<=V&&v[_+0]==47&&!(v[_+4]>>5)?(St=[0],Ar=[0],Ot=[0],Z(Pt=new C,v,_,V),Rt(Pt,St,Ar,Ot)?(Ie!=null&&(Ie[0]=St[0]),He!=null&&(He[0]=Ar[0]),_t!=null&&(_t[0]=Ot[0]),v=1):v=0):v=0}else{if(10>V){ht=7;break}Ie=ut,v==null||10>V||!nf(v,_+3,V-3)?v=0:(He=v[_+0]|v[_+1]<<8|v[_+2]<<16,_t=16383&(v[_+7]<<8|v[_+6]),v=16383&(v[_+9]<<8|v[_+8]),1&He||3<(He>>1&7)||!(He>>4&1)||He>>5>=nt.Ja||!_t||!v?v=0:(Ne&&(Ne[0]=_t),Ie&&(Ie[0]=v),v=1))}if(!v||(Ne=Ne[0],ut=ut[0],ft&&(Ve[0]!=Ne||tt[0]!=ut)))return 3;Pe!=null&&(Pe[0]=nt,Pe.offset=_-Pe.w,e(4294967286>_-Pe.w),e(Pe.offset==Pe.ha-V));break}return ht==0||ht==7&&ft&&Pe==null?(ve!=null&&(ve[0]|=nt.na!=null&&0<nt.na.length),W!=null&&(W[0]=Ne),Ae!=null&&(Ae[0]=ut),0):ht}function xm(v,_,V){var W=_.width,Ae=_.height,ve=0,Ne=0,Ie=W,Pe=Ae;if(_.Da=v!=null&&0<v.Da,_.Da&&(Ie=v.cd,Pe=v.bd,ve=v.v,Ne=v.j,11>V||(ve&=-2,Ne&=-2),0>ve||0>Ne||0>=Ie||0>=Pe||ve+Ie>W||Ne+Pe>Ae))return 0;if(_.v=ve,_.j=Ne,_.va=ve+Ie,_.o=Ne+Pe,_.U=Ie,_.T=Pe,_.da=v!=null&&0<v.da,_.da){if(!pe(Ie,Pe,V=[v.ib],ve=[v.hb]))return 0;_.ib=V[0],_.hb=ve[0]}return _.ob=v!=null&&v.ob,_.Kb=v==null||!v.Sd,_.da&&(_.ob=_.ib<3*W/4&&_.hb<3*Ae/4,_.Kb=0),1}function vm(v){if(v==null)return 2;if(11>v.S){var _=v.f.RGBA;_.fb+=(v.height-1)*_.A,_.A=-_.A}else _=v.f.kb,v=v.height,_.O+=(v-1)*_.fa,_.fa=-_.fa,_.N+=(v-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(v-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(v-1)*_.lb,_.lb=-_.lb);return 0}function QA(v,_,V,W){if(W==null||0>=v||0>=_)return 2;if(V!=null){if(V.Da){var Ae=V.cd,ve=V.bd,Ne=-2&V.v,Ie=-2&V.j;if(0>Ne||0>Ie||0>=Ae||0>=ve||Ne+Ae>v||Ie+ve>_)return 2;v=Ae,_=ve}if(V.da){if(!pe(v,_,Ae=[V.ib],ve=[V.hb]))return 2;v=Ae[0],_=ve[0]}}W.width=v,W.height=_;e:{var Pe=W.width,Ve=W.height;if(v=W.S,0>=Pe||0>=Ve||!(v>=$x&&13>v))v=2;else{if(0>=W.Rd&&W.sd==null){Ne=ve=Ae=_=0;var tt=(Ie=Pe*d5[v])*Ve;if(11>v||(ve=(Ve+1)/2*(_=(Pe+1)/2),v==12&&(Ne=(Ae=Pe)*Ve)),(Ve=a(tt+2*ve+Ne))==null){v=1;break e}W.sd=Ve,11>v?((Pe=W.f.RGBA).eb=Ve,Pe.fb=0,Pe.A=Ie,Pe.size=tt):((Pe=W.f.kb).y=Ve,Pe.O=0,Pe.fa=Ie,Pe.Fd=tt,Pe.f=Ve,Pe.N=0+tt,Pe.Ab=_,Pe.Cd=ve,Pe.ea=Ve,Pe.W=0+tt+ve,Pe.Db=_,Pe.Ed=ve,v==12&&(Pe.F=Ve,Pe.J=0+tt+2*ve),Pe.Tc=Ne,Pe.lb=Ae)}if(_=1,Ae=W.S,ve=W.width,Ne=W.height,Ae>=$x&&13>Ae)if(11>Ae)v=W.f.RGBA,_&=(Ie=Math.abs(v.A))*(Ne-1)+ve<=v.size,_&=Ie>=ve*d5[Ae],_&=v.eb!=null;else{v=W.f.kb,Ie=(ve+1)/2,tt=(Ne+1)/2,Pe=Math.abs(v.fa),Ve=Math.abs(v.Ab);var ft=Math.abs(v.Db),He=Math.abs(v.lb),nt=He*(Ne-1)+ve;_&=Pe*(Ne-1)+ve<=v.Fd,_&=Ve*(tt-1)+Ie<=v.Cd,_=(_&=ft*(tt-1)+Ie<=v.Ed)&Pe>=ve&Ve>=Ie&ft>=Ie,_&=v.y!=null,_&=v.f!=null,_&=v.ea!=null,Ae==12&&(_&=He>=ve,_&=nt<=v.Tc,_&=v.F!=null)}else _=0;v=_?0:2}}return v!=0||V!=null&&V.fd&&(v=vm(W)),v}var Ed=64,so=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ao=24,VA=32,Oc=8,HA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];qe("Predictor0","PredictorAdd0"),B.Predictor0=function(){return 4278190080},B.Predictor1=function(v){return v},B.Predictor2=function(v,_,V){return _[V+0]},B.Predictor3=function(v,_,V){return _[V+1]},B.Predictor4=function(v,_,V){return _[V-1]},B.Predictor5=function(v,_,V){return st(st(v,_[V+1]),_[V+0])},B.Predictor6=function(v,_,V){return st(v,_[V-1])},B.Predictor7=function(v,_,V){return st(v,_[V+0])},B.Predictor8=function(v,_,V){return st(_[V-1],_[V+0])},B.Predictor9=function(v,_,V){return st(_[V+0],_[V+1])},B.Predictor10=function(v,_,V){return st(st(v,_[V-1]),st(_[V+0],_[V+1]))},B.Predictor11=function(v,_,V){var W=_[V+0];return 0>=Ke(W>>24&255,v>>24&255,(_=_[V-1])>>24&255)+Ke(W>>16&255,v>>16&255,_>>16&255)+Ke(W>>8&255,v>>8&255,_>>8&255)+Ke(255&W,255&v,255&_)?W:v},B.Predictor12=function(v,_,V){var W=_[V+0];return(Se((v>>24&255)+(W>>24&255)-((_=_[V-1])>>24&255))<<24|Se((v>>16&255)+(W>>16&255)-(_>>16&255))<<16|Se((v>>8&255)+(W>>8&255)-(_>>8&255))<<8|Se((255&v)+(255&W)-(255&_)))>>>0},B.Predictor13=function(v,_,V){var W=_[V-1];return(ze((v=st(v,_[V+0]))>>24&255,W>>24&255)<<24|ze(v>>16&255,W>>16&255)<<16|ze(v>>8&255,W>>8&255)<<8|ze(255&v,255&W))>>>0};var wm=B.PredictorAdd0;B.PredictorAdd1=be,qe("Predictor2","PredictorAdd2"),qe("Predictor3","PredictorAdd3"),qe("Predictor4","PredictorAdd4"),qe("Predictor5","PredictorAdd5"),qe("Predictor6","PredictorAdd6"),qe("Predictor7","PredictorAdd7"),qe("Predictor8","PredictorAdd8"),qe("Predictor9","PredictorAdd9"),qe("Predictor10","PredictorAdd10"),qe("Predictor11","PredictorAdd11"),qe("Predictor12","PredictorAdd12"),qe("Predictor13","PredictorAdd13");var uf=B.PredictorAdd2;G("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),G("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var Ts,Kx=B.ColorIndexInverseTransform,tc=B.MapARGB,rc=B.VP8LColorIndexInverseTransformAlpha,ym=B.MapAlpha,bm=B.VP8LPredictorsAdd=[];bm.length=16,(B.VP8LPredictors=[]).length=16,(B.VP8LPredictorsAdd_C=[]).length=16,(B.VP8LPredictors_C=[]).length=16;var Nm,Cm,KA,qA,GA,Bd,$A,Sd,Vo,nc,gn,Dn,js,Zs,Mc,_m,df,qx,QI,VI,HI,KI,qI,GI,Em,$I,zI,WI,JI=a(511),XI=a(2041),YI=a(225),ZI=a(767),e5=0,tb=XI,Gx=YI,io=ZI,Ho=JI,$x=0,zx=1,t5=2,Wx=3,Jx=4,rb=5,r5=6,nb=7,sb=8,Xx=9,ab=10,A7=[2,3,7],u7=[3,3,11],n5=[280,256,256,256,40],d7=[0,1,1,1,0],h7=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],f7=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],m7=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],p7=8,ib=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ob=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Bm=null,g7=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],x7=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],s5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],v7=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],w7=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],y7=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],b7=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],zA=[],vl=[],Qc=[],N7=1,a5=2,WA=[],Ko=[];Mo("UpsampleRgbLinePair",ct,3),Mo("UpsampleBgrLinePair",gt,3),Mo("UpsampleRgbaLinePair",dn,4),Mo("UpsampleBgraLinePair",Kr,4),Mo("UpsampleArgbLinePair",ps,4),Mo("UpsampleRgba4444LinePair",nn,2),Mo("UpsampleRgb565LinePair",Ht,2);var C7=B.UpsampleRgbLinePair,_7=B.UpsampleBgrLinePair,i5=B.UpsampleRgbaLinePair,o5=B.UpsampleBgraLinePair,l5=B.UpsampleArgbLinePair,c5=B.UpsampleRgba4444LinePair,E7=B.UpsampleRgb565LinePair,Yx=16,Zx=1<<Yx-1,Sm=-227,lb=482,B7=6,A5=0,S7=a(256),I7=a(256),F7=a(256),k7=a(256),T7=a(lb-Sm),j7=a(lb-Sm);Qn("YuvToRgbRow",ct,3),Qn("YuvToBgrRow",gt,3),Qn("YuvToRgbaRow",dn,4),Qn("YuvToBgraRow",Kr,4),Qn("YuvToArgbRow",ps,4),Qn("YuvToRgba4444Row",nn,2),Qn("YuvToRgb565Row",Ht,2);var u5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],e1=[0,2,8],P7=[8,7,6,4,4,2,2,2,1,1,1,1],R7=1;this.WebPDecodeRGBA=function(v,_,V,W,Ae){var ve=zx,Ne=new Bt,Ie=new it;Ne.ba=Ie,Ie.S=ve,Ie.width=[Ie.width],Ie.height=[Ie.height];var Pe=Ie.width,Ve=Ie.height,tt=new xt;if(tt==null||v==null)var ft=2;else e(tt!=null),ft=xl(v,_,V,tt.width,tt.height,tt.Pd,tt.Qd,tt.format,null);if(ft!=0?Pe=0:(Pe!=null&&(Pe[0]=tt.width[0]),Ve!=null&&(Ve[0]=tt.height[0]),Pe=1),Pe){Ie.width=Ie.width[0],Ie.height=Ie.height[0],W!=null&&(W[0]=Ie.width),Ae!=null&&(Ae[0]=Ie.height);e:{if(W=new Jl,(Ae=new kt).data=v,Ae.w=_,Ae.ha=V,Ae.kd=1,_=[0],e(Ae!=null),((v=xl(Ae.data,Ae.w,Ae.ha,null,null,null,_,null,Ae))==0||v==7)&&_[0]&&(v=4),(_=v)==0){if(e(Ne!=null),W.data=Ae.data,W.w=Ae.w+Ae.offset,W.ha=Ae.ha-Ae.offset,W.put=Ye,W.ac=xr,W.bc=pt,W.ma=Ne,Ae.xa){if((v=Le())==null){Ne=1;break e}if(function(He,nt){var ut=[0],_t=[0],ht=[0];t:for(;;){if(He==null)return 0;if(nt==null)return He.a=2,0;if(He.l=nt,He.a=0,Z(He.m,nt.data,nt.w,nt.ha),!Rt(He.m,ut,_t,ht)){He.a=3;break t}if(He.xb=a5,nt.width=ut[0],nt.height=_t[0],!Xe(ut[0],_t[0],1,He,null))break t;return 1}return e(He.a!=0),0}(v,W)){if(W=(_=QA(W.width,W.height,Ne.Oa,Ne.ba))==0){t:{W=v;r:for(;;){if(W==null){W=0;break t}if(e(W.s.yc!=null),e(W.s.Ya!=null),e(0<W.s.Wb),e((V=W.l)!=null),e((Ae=V.ma)!=null),W.xb!=0){if(W.ca=Ae.ba,W.tb=Ae.tb,e(W.ca!=null),!xm(Ae.Oa,V,Wx)){W.a=2;break r}if(!et(W,V.width)||V.da)break r;if((V.da||Ge(W.ca.S))&&Ui(),11>W.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),W.ca.f.kb.F!=null&&Ui()),W.Pb&&0<W.s.ua&&W.s.vb.X==null&&!J(W.s.vb,W.s.Wa.Xa)){W.a=1;break r}W.xb=0}if(!We(W,W.V,W.Ba,W.c,W.i,V.o,ue))break r;Ae.Dc=W.Ma,W=1;break t}e(W.a!=0),W=0}W=!W}W&&(_=v.a)}else _=v.a}else{if((v=new rf)==null){Ne=1;break e}if(v.Fa=Ae.na,v.P=Ae.P,v.qc=Ae.Sa,jo(v,W)){if((_=QA(W.width,W.height,Ne.Oa,Ne.ba))==0){if(v.Aa=0,V=Ne.Oa,e((Ae=v)!=null),V!=null){if(0<(Pe=0>(Pe=V.Md)?0:100<Pe?255:255*Pe/100)){for(Ve=tt=0;4>Ve;++Ve)12>(ft=Ae.pb[Ve]).lc&&(ft.ia=Pe*P7[0>ft.lc?0:ft.lc]>>3),tt|=ft.ia;tt&&(alert("todo:VP8InitRandom"),Ae.ia=1)}Ae.Ga=V.Id,100<Ae.Ga?Ae.Ga=100:0>Ae.Ga&&(Ae.Ga=0)}(function(He,nt){if(He==null)return 0;if(nt==null)return ds(He,2,"NULL VP8Io parameter in VP8Decode().");if(!He.cb&&!jo(He,nt))return 0;if(e(He.cb),nt.ac==null||nt.ac(nt)){nt.ob&&(He.L=0);var ut=e1[He.L];if(He.L==2?(He.yb=0,He.zb=0):(He.yb=nt.v-ut>>4,He.zb=nt.j-ut>>4,0>He.yb&&(He.yb=0),0>He.zb&&(He.zb=0)),He.Va=nt.o+15+ut>>4,He.Hb=nt.va+15+ut>>4,He.Hb>He.za&&(He.Hb=He.za),He.Va>He.Ub&&(He.Va=He.Ub),0<He.L){var _t=He.ed;for(ut=0;4>ut;++ut){var ht;if(He.Qa.Cb){var St=He.Qa.Lb[ut];He.Qa.Fb||(St+=_t.Tb)}else St=_t.Tb;for(ht=0;1>=ht;++ht){var It=He.gd[ut][ht],Ot=St;if(_t.Pc&&(Ot+=_t.vd[0],ht&&(Ot+=_t.od[0])),0<(Ot=0>Ot?0:63<Ot?63:Ot)){var Pt=Ot;0<_t.wb&&(Pt=4<_t.wb?Pt>>2:Pt>>1)>9-_t.wb&&(Pt=9-_t.wb),1>Pt&&(Pt=1),It.dd=Pt,It.tc=2*Ot+Pt,It.ld=40<=Ot?2:15<=Ot?1:0}else It.tc=0;It.La=ht}}}ut=0}else ds(He,6,"Frame setup failed"),ut=He.a;if(ut=ut==0){if(ut){He.$c=0,0<He.Aa||(He.Ic=R7);t:{ut=He.Ic,_t=4*(Pt=He.za);var fr=32*Pt,sr=Pt+1,Dr=0<He.L?Pt*(0<He.Aa?2:1):0,Ar=(He.Aa==2?2:1)*Pt;if((It=_t+832+(ht=3*(16*ut+e1[He.L])/2*fr)+(St=He.Fa!=null&&0<He.Fa.length?He.Kc.c*He.Kc.i:0))!=It)ut=0;else{if(It>He.Vb){if(He.Vb=0,He.Ec=a(It),He.Fc=0,He.Ec==null){ut=ds(He,1,"no memory during frame initialization.");break t}He.Vb=It}It=He.Ec,Ot=He.Fc,He.Ac=It,He.Bc=Ot,Ot+=_t,He.Gd=o(fr,xi),He.Hd=0,He.rb=o(sr+1,Jr),He.sb=1,He.wa=Dr?o(Dr,Nr):null,He.Y=0,He.D.Nb=0,He.D.wa=He.wa,He.D.Y=He.Y,0<He.Aa&&(He.D.Y+=Pt),e(!0),He.oc=It,He.pc=Ot,Ot+=832,He.ya=o(Ar,eo),He.aa=0,He.D.ya=He.ya,He.D.aa=He.aa,He.Aa==2&&(He.D.aa+=Pt),He.R=16*Pt,He.B=8*Pt,Pt=(fr=e1[He.L])*He.R,fr=fr/2*He.B,He.sa=It,He.ta=Ot+Pt,He.qa=He.sa,He.ra=He.ta+16*ut*He.R+fr,He.Ha=He.qa,He.Ia=He.ra+8*ut*He.B+fr,He.$c=0,Ot+=ht,He.mb=St?It:null,He.nb=St?Ot:null,e(Ot+St<=He.Fc+He.Vb),wd(He),s(He.Ac,He.Bc,0,_t),ut=1}}if(ut){if(nt.ka=0,nt.y=He.sa,nt.O=He.ta,nt.f=He.qa,nt.N=He.ra,nt.ea=He.Ha,nt.Vd=He.Ia,nt.fa=He.R,nt.Rc=He.B,nt.F=null,nt.J=0,!e5){for(ut=-255;255>=ut;++ut)JI[255+ut]=0>ut?-ut:ut;for(ut=-1020;1020>=ut;++ut)XI[1020+ut]=-128>ut?-128:127<ut?127:ut;for(ut=-112;112>=ut;++ut)YI[112+ut]=-16>ut?-16:15<ut?15:ut;for(ut=-255;510>=ut;++ut)ZI[255+ut]=0>ut?0:255<ut?255:ut;e5=1}$A=Po,Sd=sf,nc=Xr,gn=Rc,Dn=Xl,Vo=RA,js=MA,Zs=Oo,Mc=ce,_m=Qe,df=_d,qx=P,QI=Je,VI=lt,HI=ec,KI=vi,qI=Cd,GI=Af,vl[0]=pm,vl[1]=af,vl[2]=fm,vl[3]=mm,vl[4]=fa,vl[5]=gm,vl[6]=pl,vl[7]=LA,vl[8]=UA,vl[9]=gl,zA[0]=Ro,zA[1]=hm,zA[2]=yd,zA[3]=of,zA[4]=Yl,zA[5]=DA,zA[6]=lf,Qc[0]=bd,Qc[1]=dm,Qc[2]=ro,Qc[3]=Lc,Qc[4]=Nd,Qc[5]=kn,Qc[6]=cf,ut=1}else ut=0}ut&&(ut=function(sn,ea){for(sn.M=0;sn.M<sn.Va;++sn.M){var Lr,ur=sn.Jc[sn.M&sn.Xb],Wt=sn.m,Ps=sn;for(Lr=0;Lr<Ps.za;++Lr){var Tr=Wt,an=Ps,$n=an.Ac,ka=an.Bc+4*Lr,yi=an.zc,Cs=an.ya[an.aa+Lr];if(an.Qa.Bb?Cs.$b=se(Tr,an.Pa.jb[0])?2+se(Tr,an.Pa.jb[2]):se(Tr,an.Pa.jb[1]):Cs.$b=0,an.kc&&(Cs.Ad=se(Tr,an.Bd)),Cs.Za=!se(Tr,145)+0,Cs.Za){var Ja=Cs.Ob,bi=0;for(an=0;4>an;++an){var ta,ln=yi[0+an];for(ta=0;4>ta;++ta){ln=w7[$n[ka+ta]][ln];for(var wn=s5[se(Tr,ln[0])];0<wn;)wn=s5[2*wn+se(Tr,ln[wn])];ln=-wn,$n[ka+ta]=ln}n(Ja,bi,$n,ka,4),bi+=4,yi[0+an]=ln}}else ln=se(Tr,156)?se(Tr,128)?1:3:se(Tr,163)?2:0,Cs.Ob[0]=ln,s($n,ka,ln,4),s(yi,0,ln,4);Cs.Dd=se(Tr,142)?se(Tr,114)?se(Tr,183)?1:3:2:0}if(Ps.m.Ka)return ds(sn,7,"Premature end-of-partition0 encountered.");for(;sn.ja<sn.za;++sn.ja){if(Ps=ur,Tr=(Wt=sn).rb[Wt.sb-1],$n=Wt.rb[Wt.sb+Wt.ja],Lr=Wt.ya[Wt.aa+Wt.ja],ka=Wt.kc?Lr.Ad:0)Tr.la=$n.la=0,Lr.Za||(Tr.Na=$n.Na=0),Lr.Hc=0,Lr.Gc=0,Lr.ia=0;else{var _s,yn;if(Tr=$n,$n=Ps,ka=Wt.Pa.Xc,yi=Wt.ya[Wt.aa+Wt.ja],Cs=Wt.pb[yi.$b],an=yi.ad,Ja=0,bi=Wt.rb[Wt.sb-1],ln=ta=0,s(an,Ja,0,384),yi.Za)var Ta=0,wl=ka[3];else{wn=a(16);var Rs=Tr.Na+bi.Na;if(Rs=Bm($n,ka[1],Rs,Cs.Eb,0,wn,0),Tr.Na=bi.Na=(0<Rs)+0,1<Rs)$A(wn,0,an,Ja);else{var Oi=wn[0]+3>>3;for(wn=0;256>wn;wn+=16)an[Ja+wn]=Oi}Ta=1,wl=ka[0]}var Ln=15&Tr.la,ra=15&bi.la;for(wn=0;4>wn;++wn){var oo=1&ra;for(Oi=yn=0;4>Oi;++Oi)Ln=Ln>>1|(oo=(Rs=Bm($n,wl,Rs=oo+(1&Ln),Cs.Sc,Ta,an,Ja))>Ta)<<7,yn=yn<<2|(3<Rs?3:1<Rs?2:an[Ja+0]!=0),Ja+=16;Ln>>=4,ra=ra>>1|oo<<7,ta=(ta<<8|yn)>>>0}for(wl=Ln,Ta=ra>>4,_s=0;4>_s;_s+=2){for(yn=0,Ln=Tr.la>>4+_s,ra=bi.la>>4+_s,wn=0;2>wn;++wn){for(oo=1&ra,Oi=0;2>Oi;++Oi)Rs=oo+(1&Ln),Ln=Ln>>1|(oo=0<(Rs=Bm($n,ka[2],Rs,Cs.Qc,0,an,Ja)))<<3,yn=yn<<2|(3<Rs?3:1<Rs?2:an[Ja+0]!=0),Ja+=16;Ln>>=2,ra=ra>>1|oo<<5}ln|=yn<<4*_s,wl|=Ln<<4<<_s,Ta|=(240&ra)<<_s}Tr.la=wl,bi.la=Ta,yi.Hc=ta,yi.Gc=ln,yi.ia=43690&ln?0:Cs.ia,ka=!(ta|ln)}if(0<Wt.L&&(Wt.wa[Wt.Y+Wt.ja]=Wt.gd[Lr.$b][Lr.Za],Wt.wa[Wt.Y+Wt.ja].La|=!ka),Ps.Ka)return ds(sn,7,"Premature end-of-file encountered.")}if(wd(sn),Wt=ea,Ps=1,Lr=(ur=sn).D,Tr=0<ur.L&&ur.M>=ur.zb&&ur.M<=ur.Va,ur.Aa==0)t:{if(Lr.M=ur.M,Lr.uc=Tr,Fa(ur,Lr),Ps=1,Lr=(yn=ur.D).Nb,Tr=(ln=e1[ur.L])*ur.R,$n=ln/2*ur.B,wn=16*Lr*ur.R,Oi=8*Lr*ur.B,ka=ur.sa,yi=ur.ta-Tr+wn,Cs=ur.qa,an=ur.ra-$n+Oi,Ja=ur.Ha,bi=ur.Ia-$n+Oi,ra=(Ln=yn.M)==0,ta=Ln>=ur.Va-1,ur.Aa==2&&Fa(ur,yn),yn.uc)for(oo=(Rs=ur).D.M,e(Rs.D.uc),yn=Rs.yb;yn<Rs.Hb;++yn){Ta=yn,wl=oo;var Ni=(lo=(ja=Rs).D).Nb;_s=ja.R;var lo=lo.wa[lo.Y+Ta],co=ja.sa,Mi=ja.ta+16*Ni*_s+16*Ta,Ao=lo.dd,Vn=lo.tc;if(Vn!=0)if(e(3<=Vn),ja.L==1)0<Ta&&KI(co,Mi,_s,Vn+4),lo.La&&GI(co,Mi,_s,Vn),0<wl&&HI(co,Mi,_s,Vn+4),lo.La&&qI(co,Mi,_s,Vn);else{var uo=ja.B,yl=ja.qa,Id=ja.ra+8*Ni*uo+8*Ta,Vc=ja.Ha,ja=ja.Ia+8*Ni*uo+8*Ta;Ni=lo.ld,0<Ta&&(Zs(co,Mi,_s,Vn+4,Ao,Ni),_m(yl,Id,Vc,ja,uo,Vn+4,Ao,Ni)),lo.La&&(qx(co,Mi,_s,Vn,Ao,Ni),VI(yl,Id,Vc,ja,uo,Vn,Ao,Ni)),0<wl&&(js(co,Mi,_s,Vn+4,Ao,Ni),Mc(yl,Id,Vc,ja,uo,Vn+4,Ao,Ni)),lo.La&&(df(co,Mi,_s,Vn,Ao,Ni),QI(yl,Id,Vc,ja,uo,Vn,Ao,Ni))}}if(ur.ia&&alert("todo:DitherRow"),Wt.put!=null){if(yn=16*Ln,Ln=16*(Ln+1),ra?(Wt.y=ur.sa,Wt.O=ur.ta+wn,Wt.f=ur.qa,Wt.N=ur.ra+Oi,Wt.ea=ur.Ha,Wt.W=ur.Ia+Oi):(yn-=ln,Wt.y=ka,Wt.O=yi,Wt.f=Cs,Wt.N=an,Wt.ea=Ja,Wt.W=bi),ta||(Ln-=ln),Ln>Wt.o&&(Ln=Wt.o),Wt.F=null,Wt.J=null,ur.Fa!=null&&0<ur.Fa.length&&yn<Ln&&(Wt.J=vn(ur,Wt,yn,Ln-yn),Wt.F=ur.mb,Wt.F==null&&Wt.F.length==0)){Ps=ds(ur,3,"Could not decode alpha data.");break t}yn<Wt.j&&(ln=Wt.j-yn,yn=Wt.j,e(!(1&ln)),Wt.O+=ur.R*ln,Wt.N+=ur.B*(ln>>1),Wt.W+=ur.B*(ln>>1),Wt.F!=null&&(Wt.J+=Wt.width*ln)),yn<Ln&&(Wt.O+=Wt.v,Wt.N+=Wt.v>>1,Wt.W+=Wt.v>>1,Wt.F!=null&&(Wt.J+=Wt.v),Wt.ka=yn-Wt.j,Wt.U=Wt.va-Wt.v,Wt.T=Ln-yn,Ps=Wt.put(Wt))}Lr+1!=ur.Ic||ta||(n(ur.sa,ur.ta-Tr,ka,yi+16*ur.R,Tr),n(ur.qa,ur.ra-$n,Cs,an+8*ur.B,$n),n(ur.Ha,ur.Ia-$n,Ja,bi+8*ur.B,$n))}if(!Ps)return ds(sn,6,"Output aborted.")}return 1}(He,nt)),nt.bc!=null&&nt.bc(nt),ut&=1}return ut?(He.cb=0,ut):0})(v,W)||(_=v.a)}}else _=v.a}_==0&&Ne.Oa!=null&&Ne.Oa.fd&&(_=vm(Ne.ba))}Ne=_}ve=Ne!=0?null:11>ve?Ie.f.RGBA.eb:Ie.f.kb.y}else ve=null;return ve};var d5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function A(B,U){for(var k="",T=0;T<4;T++)k+=String.fromCharCode(B[U++]);return k}function u(B,U){return B[U+0]|B[U+1]<<8}function d(B,U){return(B[U+0]|B[U+1]<<8|B[U+2]<<16)>>>0}function f(B,U){return(B[U+0]|B[U+1]<<8|B[U+2]<<16|B[U+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,g=t,y=function(B,U){var k={},T=0,L=!1,Y=0,me=0;if(k.frames=[],!function(I,C){for(var Q=0;Q<4;Q++)if(I[C+Q]!="RIFF".charCodeAt(Q))return!0;return!1}(B,U)){for(f(B,U+=4),U+=8;U<B.length;){var ae=A(B,U),fe=f(B,U+=4);U+=4;var de=fe+(1&fe);switch(ae){case"VP8 ":case"VP8L":k.frames[T]===void 0&&(k.frames[T]={}),(Be=k.frames[T]).src_off=L?me:U-8,Be.src_size=Y+fe+8,T++,L&&(L=!1,Y=0,me=0);break;case"VP8X":(Be=k.header={}).feature_flags=B[U];var Z=U+4;Be.canvas_width=1+d(B,Z),Z+=3,Be.canvas_height=1+d(B,Z),Z+=3;break;case"ALPH":L=!0,Y=de+8,me=U-8;break;case"ANIM":(Be=k.header).bgcolor=f(B,U),Z=U+4,Be.loop_count=u(B,Z),Z+=2;break;case"ANMF":var xe,Be;(Be=k.frames[T]={}).offset_x=2*d(B,U),U+=3,Be.offset_y=2*d(B,U),U+=3,Be.width=1+d(B,U),U+=3,Be.height=1+d(B,U),U+=3,Be.duration=d(B,U),U+=3,xe=B[U++],Be.dispose=1&xe,Be.blend=xe>>1&1}ae!="ANMF"&&(U+=de)}return k}}(g,0);y.response=g,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,F=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var j=0;j<F.length&&F[j].blend!=0;j++);}var R=F[0],E=x.WebPDecodeRGBA(g,R.src_off,R.src_size,m,h);R.rgba=E,R.imgwidth=m[0],R.imgheight=h[0];for(var S=0;S<m[0]*h[0]*4;S++)p[S]=E[S];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,s,a,o,l,c,A,u=function(I){return I=I||{},this.isStrokeTransparent=I.isStrokeTransparent||!1,this.strokeOpacity=I.strokeOpacity||1,this.strokeStyle=I.strokeStyle||"#000000",this.fillStyle=I.fillStyle||"#000000",this.isFillTransparent=I.isFillTransparent||!1,this.fillOpacity=I.fillOpacity||1,this.font=I.font||"10px sans-serif",this.textBaseline=I.textBaseline||"alphabetic",this.textAlign=I.textAlign||"left",this.lineWidth=I.lineWidth||1,this.lineJoin=I.lineJoin||"miter",this.lineCap=I.lineCap||"butt",this.path=I.path||[],this.transform=I.transform!==void 0?I.transform.clone():new c,this.globalCompositeOperation=I.globalCompositeOperation||"normal",this.globalAlpha=I.globalAlpha||1,this.clip_path=I.clip_path||[],this.currentPoint=I.currentPoint||new o,this.miterLimit=I.miterLimit||10,this.lastPoint=I.lastPoint||new o,this.lineDashOffset=I.lineDashOffset||0,this.lineDash=I.lineDash||[],this.margin=I.margin||[0,0,0,0],this.prevPageLastElemOffset=I.prevPageLastElemOffset||0,this.ignoreClearRect=typeof I.ignoreClearRect!="boolean"||I.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,A=new u}]);var d=function(I){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var C=I;Object.defineProperty(this,"pdf",{get:function(){return C}});var Q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Q},set:function(J){Q=!!J}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(J){M=!!J}});var D=0;Object.defineProperty(this,"posX",{get:function(){return D},set:function(J){isNaN(J)||(D=J)}});var z=0;Object.defineProperty(this,"posY",{get:function(){return z},set:function(J){isNaN(J)||(z=J)}}),Object.defineProperty(this,"margin",{get:function(){return A.margin},set:function(J){var K;typeof J=="number"?K=[J,J,J,J]:((K=new Array(4))[0]=J[0],K[1]=J.length>=2?J[1]:K[0],K[2]=J.length>=3?J[2]:K[0],K[3]=J.length>=4?J[3]:K[1]),A.margin=K}});var O=!1;Object.defineProperty(this,"autoPaging",{get:function(){return O},set:function(J){O=J}});var te=0;Object.defineProperty(this,"lastBreak",{get:function(){return te},set:function(J){te=J}});var se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return se},set:function(J){se=J}}),Object.defineProperty(this,"ctx",{get:function(){return A},set:function(J){J instanceof u&&(A=J)}}),Object.defineProperty(this,"path",{get:function(){return A.path},set:function(J){A.path=J}});var we=[];Object.defineProperty(this,"ctxStack",{get:function(){return we},set:function(J){we=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var K;K=f(J),this.ctx.fillStyle=K.style,this.ctx.isFillTransparent=K.a===0,this.ctx.fillOpacity=K.a,this.pdf.setFillColor(K.r,K.g,K.b,{a:K.a}),this.pdf.setTextColor(K.r,K.g,K.b,{a:K.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var K=f(J);this.ctx.strokeStyle=K.style,this.ctx.isStrokeTransparent=K.a===0,this.ctx.strokeOpacity=K.a,K.a===0?this.pdf.setDrawColor(255,255,255):(K.a,this.pdf.setDrawColor(K.r,K.g,K.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var q=null,Me=null,re=null;Object.defineProperty(this,"fontFaces",{get:function(){return re},set:function(J){q=null,Me=null,re=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var K;if(this.ctx.font=J,(K=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var ie=K[1];K[2];var pe=K[3],Ee=K[4];K[5];var Ue=K[6],qe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ee)[2];Ee=Math.floor(qe==="px"?parseFloat(Ee)*this.pdf.internal.scaleFactor:qe==="em"?parseFloat(Ee)*this.pdf.getFontSize():parseFloat(Ee)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ee);var $e=function(G){var ye,Oe,_e=[],he=G.trim();if(he==="")return VN;if(he in Bj)return[Bj[he]];for(;he!=="";){switch(Oe=null,ye=(he=Ij(he)).charAt(0)){case'"':case"'":Oe=roe(he.substring(1),ye);break;default:Oe=noe(he)}if(Oe===null||(_e.push(Oe[0]),(he=Ij(Oe[1]))!==""&&he.charAt(0)!==","))return VN;he=he.replace(/^,/,"")}return _e}(Ue);if(this.fontFaces){var st=function(G,ye){var Oe=G.getFontList(),_e=JSON.stringify(Oe);if(q===null||Me!==_e){var he=function(Ce){var Ze=[];return Object.keys(Ce).forEach(function(Te){Ce[Te].forEach(function(Ge){var at=null;switch(Ge){case"bold":at={family:Te,weight:"bold"};break;case"italic":at={family:Te,style:"italic"};break;case"bolditalic":at={family:Te,weight:"bold",style:"italic"};break;case"":case"normal":at={family:Te}}at!==null&&(at.ref={name:Te,style:Ge},Ze.push(at))})}),Ze}(Oe);q=function(Ce){for(var Ze={},Te=0;Te<Ce.length;++Te){var Ge=QN(Ce[Te]),at=Ge.family,wt=Ge.stretch,it=Ge.style,xt=Ge.weight;Ze[at]=Ze[at]||{},Ze[at][wt]=Ze[at][wt]||{},Ze[at][wt][it]=Ze[at][wt][it]||{},Ze[at][wt][it][xt]=Ge}return Ze}(he.concat(ye)),Me=_e}return q}(this.pdf,this.fontFaces),Se=$e.map(function(G){return{family:G,stretch:"normal",weight:pe,style:ie}}),ze=function(G,ye,Oe){for(var _e=(Oe=Oe||{}).defaultFontFamily||"times",he=Object.assign({},toe,Oe.genericFontFamilies||{}),Ce=null,Ze=null,Te=0;Te<ye.length;++Te)if(he[(Ce=QN(ye[Te])).family]&&(Ce.family=he[Ce.family]),G.hasOwnProperty(Ce.family)){Ze=G[Ce.family];break}if(!(Ze=Ze||G[_e]))throw new Error("Could not find a font-family for the rule '"+Sj(Ce)+"' and default family '"+_e+"'.");if(Ze=function(Ge,at){if(at[Ge])return at[Ge];var wt=bE[Ge],it=wt<=bE.normal?-1:1,xt=Ej(at,HM,wt,it);if(!xt)throw new Error("Could not find a matching font-stretch value for "+Ge);return xt}(Ce.stretch,Ze),Ze=function(Ge,at){if(at[Ge])return at[Ge];for(var wt=VM[Ge],it=0;it<wt.length;++it)if(at[wt[it]])return at[wt[it]];throw new Error("Could not find a matching font-style for "+Ge)}(Ce.style,Ze),!(Ze=function(Ge,at){if(at[Ge])return at[Ge];if(Ge===400&&at[500])return at[500];if(Ge===500&&at[400])return at[400];var wt=eoe[Ge],it=Ej(at,KM,wt,Ge<400?-1:1);if(!it)throw new Error("Could not find a matching font-weight for value "+Ge);return it}(Ce.weight,Ze)))throw new Error("Failed to resolve a font for the rule '"+Sj(Ce)+"'.");return Ze}(st,Se);this.pdf.setFont(ze.ref.name,ze.ref.style)}else{var Ke="";(pe==="bold"||parseInt(pe,10)>=700||ie==="bold")&&(Ke="bold"),ie==="italic"&&(Ke+="italic"),Ke.length===0&&(Ke="normal");for(var be="",le={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},je=0;je<$e.length;je++){if(this.pdf.internal.getFont($e[je],Ke,{noFallback:!0,disableWarning:!0})!==void 0){be=$e[je];break}if(Ke==="bolditalic"&&this.pdf.internal.getFont($e[je],"bold",{noFallback:!0,disableWarning:!0})!==void 0)be=$e[je],Ke="bold";else if(this.pdf.internal.getFont($e[je],"normal",{noFallback:!0,disableWarning:!0})!==void 0){be=$e[je],Ke="normal";break}}if(be===""){for(var X=0;X<$e.length;X++)if(le[$e[X]]){be=le[$e[X]];break}}be=be===""?"Times":be,this.pdf.setFont(be,Ke)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,Be.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,Be.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};d.prototype.setLineDash=function(I){this.lineDash=I},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){F.call(this,"fill",!1)},d.prototype.stroke=function(){F.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(I,C){if(isNaN(I)||isNaN(C))throw Mn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Q=this.ctx.transform.applyToPoint(new o(I,C));this.path.push({type:"mt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(I,C)},d.prototype.closePath=function(){var I=new o(0,0),C=0;for(C=this.path.length-1;C!==-1;C--)if(this.path[C].type==="begin"&&Bn(this.path[C+1])==="object"&&typeof this.path[C+1].x=="number"){I=new o(this.path[C+1].x,this.path[C+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(I.x,I.y)},d.prototype.lineTo=function(I,C){if(isNaN(I)||isNaN(C))throw Mn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Q=this.ctx.transform.applyToPoint(new o(I,C));this.path.push({type:"lt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},d.prototype.quadraticCurveTo=function(I,C,Q,M){if(isNaN(Q)||isNaN(M)||isNaN(I)||isNaN(C))throw Mn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var D=this.ctx.transform.applyToPoint(new o(Q,M)),z=this.ctx.transform.applyToPoint(new o(I,C));this.path.push({type:"qct",x1:z.x,y1:z.y,x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},d.prototype.bezierCurveTo=function(I,C,Q,M,D,z){if(isNaN(D)||isNaN(z)||isNaN(I)||isNaN(C)||isNaN(Q)||isNaN(M))throw Mn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var O=this.ctx.transform.applyToPoint(new o(D,z)),te=this.ctx.transform.applyToPoint(new o(I,C)),se=this.ctx.transform.applyToPoint(new o(Q,M));this.path.push({type:"bct",x1:te.x,y1:te.y,x2:se.x,y2:se.y,x:O.x,y:O.y}),this.ctx.lastPoint=new o(O.x,O.y)},d.prototype.arc=function(I,C,Q,M,D,z){if(isNaN(I)||isNaN(C)||isNaN(Q)||isNaN(M)||isNaN(D))throw Mn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(z=!!z,!this.ctx.transform.isIdentity){var O=this.ctx.transform.applyToPoint(new o(I,C));I=O.x,C=O.y;var te=this.ctx.transform.applyToPoint(new o(0,Q)),se=this.ctx.transform.applyToPoint(new o(0,0));Q=Math.sqrt(Math.pow(te.x-se.x,2)+Math.pow(te.y-se.y,2))}Math.abs(D-M)>=2*Math.PI&&(M=0,D=2*Math.PI),this.path.push({type:"arc",x:I,y:C,radius:Q,startAngle:M,endAngle:D,counterclockwise:z})},d.prototype.arcTo=function(I,C,Q,M,D){throw new Error("arcTo not implemented.")},d.prototype.rect=function(I,C,Q,M){if(isNaN(I)||isNaN(C)||isNaN(Q)||isNaN(M))throw Mn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(I,C),this.lineTo(I+Q,C),this.lineTo(I+Q,C+M),this.lineTo(I,C+M),this.lineTo(I,C),this.lineTo(I+Q,C),this.lineTo(I,C)},d.prototype.fillRect=function(I,C,Q,M){if(isNaN(I)||isNaN(C)||isNaN(Q)||isNaN(M))throw Mn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var D={};this.lineCap!=="butt"&&(D.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(D.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(I,C,Q,M),this.fill(),D.hasOwnProperty("lineCap")&&(this.lineCap=D.lineCap),D.hasOwnProperty("lineJoin")&&(this.lineJoin=D.lineJoin)}},d.prototype.strokeRect=function(I,C,Q,M){if(isNaN(I)||isNaN(C)||isNaN(Q)||isNaN(M))throw Mn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(I,C,Q,M),this.stroke())},d.prototype.clearRect=function(I,C,Q,M){if(isNaN(I)||isNaN(C)||isNaN(Q)||isNaN(M))throw Mn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(I,C,Q,M))},d.prototype.save=function(I){I=typeof I!="boolean"||I;for(var C=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("q");if(this.pdf.setPage(C),I){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},d.prototype.restore=function(I){I=typeof I!="boolean"||I;for(var C=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("Q");this.pdf.setPage(C),I&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(I){var C,Q,M,D;if(I.isCanvasGradient===!0&&(I=I.getColor()),!I)return{r:0,g:0,b:0,a:0,style:I};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(I))C=0,Q=0,M=0,D=0;else{var z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(I);if(z!==null)C=parseInt(z[1]),Q=parseInt(z[2]),M=parseInt(z[3]),D=1;else if((z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(I))!==null)C=parseInt(z[1]),Q=parseInt(z[2]),M=parseInt(z[3]),D=parseFloat(z[4]);else{if(D=1,typeof I=="string"&&I.charAt(0)!=="#"){var O=new RM(I);I=O.ok?O.toHex():"#000000"}I.length===4?(C=I.substring(1,2),C+=C,Q=I.substring(2,3),Q+=Q,M=I.substring(3,4),M+=M):(C=I.substring(1,3),Q=I.substring(3,5),M=I.substring(5,7)),C=parseInt(C,16),Q=parseInt(Q,16),M=parseInt(M,16)}}return{r:C,g:Q,b:M,a:D,style:I}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(I,C,Q,M){if(isNaN(C)||isNaN(Q)||typeof I!="string")throw Mn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!h.call(this)){var D=de(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;T.call(this,{text:I,x:C,y:Q,scale:z,angle:D,align:this.textAlign,maxWidth:M})}},d.prototype.strokeText=function(I,C,Q,M){if(isNaN(C)||isNaN(Q)||typeof I!="string")throw Mn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){M=isNaN(M)?void 0:M;var D=de(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;T.call(this,{text:I,x:C,y:Q,scale:z,renderingMode:"stroke",angle:D,align:this.textAlign,maxWidth:M})}},d.prototype.measureText=function(I){if(typeof I!="string")throw Mn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var C=this.pdf,Q=this.pdf.internal.scaleFactor,M=C.internal.getFontSize(),D=C.getStringUnitWidth(I)*M/C.internal.scaleFactor;return new function(z){var O=(z=z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return O}}),this}({width:D*=Math.round(96*Q/72*1e4)/1e4})},d.prototype.scale=function(I,C){if(isNaN(I)||isNaN(C))throw Mn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Q=new c(I,0,0,C,0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},d.prototype.rotate=function(I){if(isNaN(I))throw Mn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var C=new c(Math.cos(I),Math.sin(I),-Math.sin(I),Math.cos(I),0,0);this.ctx.transform=this.ctx.transform.multiply(C)},d.prototype.translate=function(I,C){if(isNaN(I)||isNaN(C))throw Mn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Q=new c(1,0,0,1,I,C);this.ctx.transform=this.ctx.transform.multiply(Q)},d.prototype.transform=function(I,C,Q,M,D,z){if(isNaN(I)||isNaN(C)||isNaN(Q)||isNaN(M)||isNaN(D)||isNaN(z))throw Mn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var O=new c(I,C,Q,M,D,z);this.ctx.transform=this.ctx.transform.multiply(O)},d.prototype.setTransform=function(I,C,Q,M,D,z){I=isNaN(I)?1:I,C=isNaN(C)?0:C,Q=isNaN(Q)?0:Q,M=isNaN(M)?1:M,D=isNaN(D)?0:D,z=isNaN(z)?0:z,this.ctx.transform=new c(I,C,Q,M,D,z)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(I,C,Q,M,D,z,O,te,se){var we=this.pdf.getImageProperties(I),q=1,Me=1,re=1,J=1;M!==void 0&&te!==void 0&&(re=te/M,J=se/D,q=we.width/M*te/M,Me=we.height/D*se/D),z===void 0&&(z=C,O=Q,C=0,Q=0),M!==void 0&&te===void 0&&(te=M,se=D),M===void 0&&te===void 0&&(te=we.width,se=we.height);var K=this.ctx.transform.decompose(),ie=de(K.rotate.shx),pe=new c,Ee=(pe=(pe=(pe=pe.multiply(K.translate)).multiply(K.skew)).multiply(K.scale)).applyToRectangle(new l(z-C*re,O-Q*J,M*q,D*Me));if(this.autoPaging){for(var Ue,qe=x.call(this,Ee),$e=[],st=0;st<qe.length;st+=1)$e.indexOf(qe[st])===-1&&$e.push(qe[st]);b($e);for(var Se=$e[0],ze=$e[$e.length-1],Ke=Se;Ke<ze+1;Ke++){this.pdf.setPage(Ke);var be=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],le=Ke===1?this.posY+this.margin[0]:this.margin[0],je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],X=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],G=Ke===1?0:je+(Ke-2)*X;if(this.ctx.clip_path.length!==0){var ye=this.path;Ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Ue,this.posX+this.margin[3],-G+le+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=ye}var Oe=JSON.parse(JSON.stringify(Ee));Oe=y([Oe],this.posX+this.margin[3],-G+le+this.ctx.prevPageLastElemOffset)[0];var _e=(Ke>Se||Ke<ze)&&p.call(this);_e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],be,X,null).clip().discardPath()),this.pdf.addImage(I,"JPEG",Oe.x,Oe.y,Oe.w,Oe.h,null,null,ie),_e&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(I,"JPEG",Ee.x,Ee.y,Ee.w,Ee.h,null,null,ie)};var x=function(I,C,Q){var M=[];C=C||this.pdf.internal.pageSize.width,Q=Q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var D=this.posY+this.ctx.prevPageLastElemOffset;switch(I.type){default:case"mt":case"lt":M.push(Math.floor((I.y+D)/Q)+1);break;case"arc":M.push(Math.floor((I.y+D-I.radius)/Q)+1),M.push(Math.floor((I.y+D+I.radius)/Q)+1);break;case"qct":var z=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x,I.y);M.push(Math.floor((z.y+D)/Q)+1),M.push(Math.floor((z.y+z.h+D)/Q)+1);break;case"bct":var O=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x2,I.y2,I.x,I.y);M.push(Math.floor((O.y+D)/Q)+1),M.push(Math.floor((O.y+O.h+D)/Q)+1);break;case"rect":M.push(Math.floor((I.y+D)/Q)+1),M.push(Math.floor((I.y+I.h+D)/Q)+1)}for(var te=0;te<M.length;te+=1)for(;this.pdf.internal.getNumberOfPages()<M[te];)g.call(this);return M},g=function(){var I=this.fillStyle,C=this.strokeStyle,Q=this.font,M=this.lineCap,D=this.lineWidth,z=this.lineJoin;this.pdf.addPage(),this.fillStyle=I,this.strokeStyle=C,this.font=Q,this.lineCap=M,this.lineWidth=D,this.lineJoin=z},y=function(I,C,Q){for(var M=0;M<I.length;M++)switch(I[M].type){case"bct":I[M].x2+=C,I[M].y2+=Q;case"qct":I[M].x1+=C,I[M].y1+=Q;default:I[M].x+=C,I[M].y+=Q}return I},b=function(I){return I.sort(function(C,Q){return C-Q})},F=function(I,C){var Q=this.fillStyle,M=this.strokeStyle,D=this.lineCap,z=this.lineWidth,O=Math.abs(z*this.ctx.transform.scaleX),te=this.lineJoin;if(this.autoPaging){for(var se,we,q=JSON.parse(JSON.stringify(this.path)),Me=JSON.parse(JSON.stringify(this.path)),re=[],J=0;J<Me.length;J++)if(Me[J].x!==void 0)for(var K=x.call(this,Me[J]),ie=0;ie<K.length;ie+=1)re.indexOf(K[ie])===-1&&re.push(K[ie]);for(var pe=0;pe<re.length;pe++)for(;this.pdf.internal.getNumberOfPages()<re[pe];)g.call(this);b(re);for(var Ee=re[0],Ue=re[re.length-1],qe=Ee;qe<Ue+1;qe++){this.pdf.setPage(qe),this.fillStyle=Q,this.strokeStyle=M,this.lineCap=D,this.lineWidth=O,this.lineJoin=te;var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],st=qe===1?this.posY+this.margin[0]:this.margin[0],Se=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ke=qe===1?0:Se+(qe-2)*ze;if(this.ctx.clip_path.length!==0){var be=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(se,this.posX+this.margin[3],-Ke+st+this.ctx.prevPageLastElemOffset),j.call(this,I,!0),this.path=be}if(we=JSON.parse(JSON.stringify(q)),this.path=y(we,this.posX+this.margin[3],-Ke+st+this.ctx.prevPageLastElemOffset),C===!1||qe===0){var le=(qe>Ee||qe<Ue)&&p.call(this);le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,ze,null).clip().discardPath()),j.call(this,I,C),le&&this.pdf.restoreGraphicsState()}this.lineWidth=z}this.path=q}else this.lineWidth=O,j.call(this,I,C),this.lineWidth=z},j=function(I,C){if((I!=="stroke"||C||!m.call(this))&&(I==="stroke"||C||!h.call(this))){for(var Q,M,D=[],z=this.path,O=0;O<z.length;O++){var te=z[O];switch(te.type){case"begin":D.push({begin:!0});break;case"close":D.push({close:!0});break;case"mt":D.push({start:te,deltas:[],abs:[]});break;case"lt":var se=D.length;if(z[O-1]&&!isNaN(z[O-1].x)&&(Q=[te.x-z[O-1].x,te.y-z[O-1].y],se>0)){for(;se>=0;se--)if(D[se-1].close!==!0&&D[se-1].begin!==!0){D[se-1].deltas.push(Q),D[se-1].abs.push(te);break}}break;case"bct":Q=[te.x1-z[O-1].x,te.y1-z[O-1].y,te.x2-z[O-1].x,te.y2-z[O-1].y,te.x-z[O-1].x,te.y-z[O-1].y],D[D.length-1].deltas.push(Q);break;case"qct":var we=z[O-1].x+2/3*(te.x1-z[O-1].x),q=z[O-1].y+2/3*(te.y1-z[O-1].y),Me=te.x+2/3*(te.x1-te.x),re=te.y+2/3*(te.y1-te.y),J=te.x,K=te.y;Q=[we-z[O-1].x,q-z[O-1].y,Me-z[O-1].x,re-z[O-1].y,J-z[O-1].x,K-z[O-1].y],D[D.length-1].deltas.push(Q);break;case"arc":D.push({deltas:[],abs:[],arc:!0}),Array.isArray(D[D.length-1].abs)&&D[D.length-1].abs.push(te)}}M=C?null:I==="stroke"?"stroke":"fill";for(var ie=!1,pe=0;pe<D.length;pe++)if(D[pe].arc)for(var Ee=D[pe].abs,Ue=0;Ue<Ee.length;Ue++){var qe=Ee[Ue];qe.type==="arc"?S.call(this,qe.x,qe.y,qe.radius,qe.startAngle,qe.endAngle,qe.counterclockwise,void 0,C,!ie):L.call(this,qe.x,qe.y),ie=!0}else if(D[pe].close===!0)this.pdf.internal.out("h"),ie=!1;else if(D[pe].begin!==!0){var $e=D[pe].start.x,st=D[pe].start.y;Y.call(this,D[pe].deltas,$e,st),ie=!0}M&&B.call(this,M),C&&U.call(this)}},R=function(I){var C=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Q=C*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return I-Q;case"top":return I+C-Q;case"hanging":return I+C-2*Q;case"middle":return I+C/2-Q;default:return I}},E=function(I){return I+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var I=function(){};return I.colorStops=[],I.addColorStop=function(C,Q){this.colorStops.push([C,Q])},I.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},I.isCanvasGradient=!0,I},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(I,C,Q,M,D,z,O,te,se){for(var we=ae.call(this,Q,M,D,z),q=0;q<we.length;q++){var Me=we[q];q===0&&(se?k.call(this,Me.x1+I,Me.y1+C):L.call(this,Me.x1+I,Me.y1+C)),me.call(this,I,C,Me.x2,Me.y2,Me.x3,Me.y3,Me.x4,Me.y4)}te?U.call(this):B.call(this,O)},B=function(I){switch(I){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(I,C){this.pdf.internal.out(r(I)+" "+n(C)+" m")},T=function(I){var C;switch(I.align){case"right":case"end":C="right";break;case"center":C="center";break;default:C="left"}var Q,M,D,z=this.pdf.getTextDimensions(I.text),O=R.call(this,I.y),te=E.call(this,O)-z.h,se=this.ctx.transform.applyToPoint(new o(I.x,O));if(this.autoPaging){var we=this.ctx.transform.decompose(),q=new c;q=(q=(q=q.multiply(we.translate)).multiply(we.skew)).multiply(we.scale);for(var Me=this.ctx.transform.applyToRectangle(new l(I.x,O,z.w,z.h)),re=q.applyToRectangle(new l(I.x,te,z.w,z.h)),J=x.call(this,re),K=[],ie=0;ie<J.length;ie+=1)K.indexOf(J[ie])===-1&&K.push(J[ie]);b(K);for(var pe=K[0],Ee=K[K.length-1],Ue=pe;Ue<Ee+1;Ue++){this.pdf.setPage(Ue);var qe=Ue===1?this.posY+this.margin[0]:this.margin[0],$e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],st=this.pdf.internal.pageSize.height-this.margin[2],Se=st-this.margin[0],ze=this.pdf.internal.pageSize.width-this.margin[1],Ke=ze-this.margin[3],be=Ue===1?0:$e+(Ue-2)*Se;if(this.ctx.clip_path.length!==0){var le=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Q,this.posX+this.margin[3],-1*be+qe),j.call(this,"fill",!0),this.path=le}var je=y([JSON.parse(JSON.stringify(re))],this.posX+this.margin[3],-be+qe+this.ctx.prevPageLastElemOffset)[0];I.scale>=.01&&(M=this.pdf.internal.getFontSize(),this.pdf.setFontSize(M*I.scale),D=this.lineWidth,this.lineWidth=D*I.scale);var X=this.autoPaging!=="text";if(X||je.y+je.h<=st){if(X||je.y>=qe&&je.x<=ze){var G=X?I.text:this.pdf.splitTextToSize(I.text,I.maxWidth||ze-je.x)[0],ye=y([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-be+qe+this.ctx.prevPageLastElemOffset)[0],Oe=X&&(Ue>pe||Ue<Ee)&&p.call(this);Oe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ke,Se,null).clip().discardPath()),this.pdf.text(G,ye.x,ye.y,{angle:I.angle,align:C,renderingMode:I.renderingMode}),Oe&&this.pdf.restoreGraphicsState()}}else je.y<st&&(this.ctx.prevPageLastElemOffset+=st-je.y);I.scale>=.01&&(this.pdf.setFontSize(M),this.lineWidth=D)}}else I.scale>=.01&&(M=this.pdf.internal.getFontSize(),this.pdf.setFontSize(M*I.scale),D=this.lineWidth,this.lineWidth=D*I.scale),this.pdf.text(I.text,se.x+this.posX,se.y+this.posY,{angle:I.angle,align:C,renderingMode:I.renderingMode,maxWidth:I.maxWidth}),I.scale>=.01&&(this.pdf.setFontSize(M),this.lineWidth=D)},L=function(I,C,Q,M){Q=Q||0,M=M||0,this.pdf.internal.out(r(I+Q)+" "+n(C+M)+" l")},Y=function(I,C,Q){return this.pdf.lines(I,C,Q,null,null)},me=function(I,C,Q,M,D,z,O,te){this.pdf.internal.out([e(s(Q+I)),e(a(M+C)),e(s(D+I)),e(a(z+C)),e(s(O+I)),e(a(te+C)),"c"].join(" "))},ae=function(I,C,Q,M){for(var D=2*Math.PI,z=Math.PI/2;C>Q;)C-=D;var O=Math.abs(Q-C);O<D&&M&&(O=D-O);for(var te=[],se=M?-1:1,we=C;O>1e-5;){var q=we+se*Math.min(O,z);te.push(fe.call(this,I,we,q)),O-=Math.abs(q-we),we=q}return te},fe=function(I,C,Q){var M=(Q-C)/2,D=I*Math.cos(M),z=I*Math.sin(M),O=D,te=-z,se=O*O+te*te,we=se+O*D+te*z,q=4/3*(Math.sqrt(2*se*we)-we)/(O*z-te*D),Me=O-q*te,re=te+q*O,J=Me,K=-re,ie=M+C,pe=Math.cos(ie),Ee=Math.sin(ie);return{x1:I*Math.cos(C),y1:I*Math.sin(C),x2:Me*pe-re*Ee,y2:Me*Ee+re*pe,x3:J*pe-K*Ee,y3:J*Ee+K*pe,x4:I*Math.cos(Q),y4:I*Math.sin(Q)}},de=function(I){return 180*I/Math.PI},Z=function(I,C,Q,M,D,z){var O=I+.5*(Q-I),te=C+.5*(M-C),se=D+.5*(Q-D),we=z+.5*(M-z),q=Math.min(I,D,O,se),Me=Math.max(I,D,O,se),re=Math.min(C,z,te,we),J=Math.max(C,z,te,we);return new l(q,re,Me-q,J-re)},xe=function(I,C,Q,M,D,z,O,te){var se,we,q,Me,re,J,K,ie,pe,Ee,Ue,qe,$e,st,Se=Q-I,ze=M-C,Ke=D-Q,be=z-M,le=O-D,je=te-z;for(we=0;we<41;we++)pe=(K=(q=I+(se=we/40)*Se)+se*((re=Q+se*Ke)-q))+se*(re+se*(D+se*le-re)-K),Ee=(ie=(Me=C+se*ze)+se*((J=M+se*be)-Me))+se*(J+se*(z+se*je-J)-ie),we==0?(Ue=pe,qe=Ee,$e=pe,st=Ee):(Ue=Math.min(Ue,pe),qe=Math.min(qe,Ee),$e=Math.max($e,pe),st=Math.max(st,Ee));return new l(Math.round(Ue),Math.round(qe),Math.round($e-Ue),Math.round(st-qe))},Be=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var I,C,Q=(I=this.ctx.lineDash,C=this.ctx.lineDashOffset,JSON.stringify({lineDash:I,lineDashOffset:C}));this.prevLineDash!==Q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Q)}}})(rr.API),function(t){var e=function(o){var l,c,A,u,d,f,h,m,p,x;for(c=[],A=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>A;A+=4)(d=(o.charCodeAt(A)<<24)+(o.charCodeAt(A+1)<<16)+(o.charCodeAt(A+2)<<8)+o.charCodeAt(A+3))!==0?(f=(d=((d=((d=((d=(d-(x=d%85))/85)-(p=d%85))/85)-(m=d%85))/85)-(h=d%85))/85)%85,c.push(f+33,h+33,m+33,p+33,x+33)):c.push(122);return function(g,y){for(var b=y;b>0;b--)g.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,A,u,d,f=String,h="length",m=255,p="charCodeAt",x="slice",g="replace";for(o[x](-2),o=o[x](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),A=[],u=0,d=(o+=l="uuuuu"[x](o[h]%5||5))[h];d>u;u+=5)c=52200625*(o[p](u)-33)+614125*(o[p](u+1)-33)+7225*(o[p](u+2)-33)+85*(o[p](u+3)-33)+(o[p](u+4)-33),A.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var F=b;F>0;F--)y.pop()}(A,l[h]),f.fromCharCode.apply(f,A)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",A=0;A<o.length;A+=2)c+=String.fromCharCode("0x"+(o[A]+o[A+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=mE(l)).reduce(function(A,u){return A+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,l){var c=0,A=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":A=r(A),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=e(A),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=s(A),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=n(A),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=a(A),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:A,reverseChain:u.reverse().join(" ")}}}(rr.API),function(t){t.loadFile=function(e,r,n){return function(s,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,A,u){var d=new XMLHttpRequest,f=0,h=function(m){var p=m.length,x=[],g=String.fromCharCode;for(f=0;f<p;f+=1)x.push(g(255&m.charCodeAt(f)));return x.join("")};if(d.open("GET",c,!A),d.overrideMimeType("text/plain; charset=x-user-defined"),A===!1&&(d.onload=function(){d.status===200?u(h(this.responseText)):u(void 0)}),d.send(null),A&&d.status===200)return h(d.responseText)}(s,a,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(rr.API),function(t){function e(){return(Br.html2canvas?Promise.resolve(Br.html2canvas):mA(()=>Promise.resolve().then(()=>$S),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Br.DOMPurify?Promise.resolve(Br.DOMPurify):mA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Bn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var A=document.createElement(l);for(var u in c.className&&(A.className=c.className),c.innerHTML&&c.dompurify&&(A.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)A.style[u]=c.style[u];return A},a=function l(c,A){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)A!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||u.appendChild(l(d,A));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var A=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),A);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(A){switch(n(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(A){return this.set({src:s("div",{innerHTML:l,dompurify:A})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,c(this.prop.container,A)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var A=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var m=u[h],p=m.src.find(function(x){return x.format==="truetype"});p&&A.addFont(p.url,m.ref.name,m.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,A.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(A){if(A in o.template.prop)return function(){this.prop[A]=l[A]};switch(A){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[A]=l[A]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var A=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(A):A})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(A,u){return Math.floor(A*u/72*96)}return this.then(function(){(l=l||rr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,A,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),A!=null&&(this.progress.n=A),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,A,u){return this.setProgress(l?this.progress.val+l:null,c||null,A?this.progress.n+A:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var A=this;return this.thenCore(l,c,function(u,d){return A.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(f){return A.updateProgress(null,u),f}).then(u,d).then(function(f){return A.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,A){A=A||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),f=A.call(d,l,c);return o.convert(f,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(A){c=c.thenCore(A)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,rr.getPageSize=function(l,c,A){if(Bn(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,A=u.format||A}c=c||"mm",A=A||"a4",l=(""+(l||"P")).toLowerCase();var d,f=(""+A).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(f))p=h[f][1]/d,x=h[f][0]/d;else try{p=A[1],x=A[0]}catch{throw new Error("Invalid format: "+A)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:d,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(QN):null;var A=new o(c);return c.worker?A:A.from(l).doCallback()}}(rr.API),rr.API.addJS=function(t){return kj=t,this.internal.events.subscribe("postPutResources",function(){cv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(cv+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Fj=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+kj+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){cv!==void 0&&Fj!==void 0&&this.internal.out("/Names <</JavaScript "+cv+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var o=s[a],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var A=this.internal.pages.length,u=[];for(a=0;a<A;a++){var d=r.internal.newObject();u.push(d);var f=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<u.length;a++)r.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var o={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var A=0;A<n.children.length;A++)this.renderItems(n.children[A])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(rr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,a,o,l){var c,A=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(d){for(var f,h=256*d.charCodeAt(4)+d.charCodeAt(5),m=d.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(d.charCodeAt(x+1))!==-1){f=256*d.charCodeAt(x+5)+d.charCodeAt(x+6),p={width:256*d.charCodeAt(x+7)+d.charCodeAt(x+8),height:f,numcomponents:d.charCodeAt(x+9)};break}h=256*d.charCodeAt(x+2)+d.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:A,index:n,alias:s}}return u}}(rr.API),rr.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var s,a=Oie(t,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,A=a.palette,u=a.depth;s=A&&c===1?function(S){for(var B=S.width,U=S.height,k=S.data,T=S.palette,L=S.depth,Y=!1,me=[],ae=[],fe=void 0,de=!1,Z=0,xe=0;xe<T.length;xe++){var Be=RT(T[xe],4),I=Be[0],C=Be[1],Q=Be[2],M=Be[3];me.push(I,C,Q),M!=null&&(M===0?(Z++,ae.length<1&&ae.push(xe)):M<255&&(de=!0))}if(de||Z>1){Y=!0,ae=void 0;var D=B*U;fe=new Uint8Array(D);for(var z=new DataView(k.buffer),O=0;O<D;O++){var te=HN(z,O,L),se=RT(T[te],4)[3];fe[O]=se}}else Z===0&&(ae=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Y?8:void 0,colorBytes:k,alphaBytes:fe,needSMask:Y,palette:me,mask:ae}}(a):c===2||c===4?function(S){for(var B=S.data,U=S.width,k=S.height,T=S.channels,L=S.depth,Y=T===2?"DeviceGray":"DeviceRGB",me=T-1,ae=U*k,fe=me,de=ae*fe,Z=1*ae,xe=Math.ceil(de*L/8),Be=Math.ceil(Z*L/8),I=new Uint8Array(xe),C=new Uint8Array(Be),Q=new DataView(B.buffer),M=new DataView(I.buffer),D=new DataView(C.buffer),z=!1,O=0;O<ae;O++){for(var te=O*T,se=0;se<fe;se++)Mj(M,HN(Q,te+se,L),O*fe+se,L);var we=HN(Q,te+fe,L);we<(1<<L)-1&&(z=!0),Mj(D,we,1*O,L)}return{colorSpace:Y,colorsPerPixel:me,sMaskBitsPerComponent:z?L:void 0,colorBytes:I,alphaBytes:C,needSMask:z}}(a):function(S){var B=S.data,U=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:U,colorsPerPixel:U==="DeviceGray"?1:3,colorBytes:B instanceof Uint16Array?function(k){for(var T=k.length,L=new Uint8Array(2*T),Y=new DataView(L.buffer,L.byteOffset,L.byteLength),me=0;me<T;me++)Y.setUint16(2*me,k[me],!1);return L}(B):B,needSMask:!1}}(a);var d,f,h,m=s,p=m.colorSpace,x=m.colorsPerPixel,g=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,F=m.needSMask,j=m.palette,R=m.mask,E=null;return n!==rr.API.image_compression.NONE&&typeof mE=="function"?(E=function(S){var B;switch(S){case rr.API.image_compression.FAST:B=11;break;case rr.API.image_compression.MEDIUM:B=13;break;case rr.API.image_compression.SLOW:B=14;break;default:B=12}return B}(n),d=this.decode.FLATE_DECODE,f="/Predictor ".concat(E," /Colors ").concat(x," /BitsPerComponent ").concat(u," /Columns ").concat(o),t=Rj(y,Math.ceil(o*x*u/8),x,u,n),F&&(h=Rj(b,Math.ceil(o*g/8),1,g,n))):(d=void 0,f=void 0,t=y,F&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:d,decodeParameters:f,transparency:R,palette:j,sMask:h,predictor:E,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:g,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,s){var a=new ooe(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var A={data:c,width:o,height:l},u=new KN(100).encode(A,100);return t.processJPEG.call(this,u,r,n,s)},t.processGIF87A=t.processGIF89A}(rr.API),Nl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Nl.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Mn.log("bit decode error:"+r)}},Nl.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Nl.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=a>>4,c=15&a,A=this.palette[l];if(this.data[o]=A.blue,this.data[o+1]=A.green,this.data[o+2]=A.red,this.data[o+3]=255,2*s+1>=this.width)break;A=this.palette[c],this.data[o+4]=A.blue,this.data[o+4+1]=A.green,this.data[o+4+2]=A.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Nl.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Nl.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,A=a>>15?255:0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=A}this.pos+=t}},Nl.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,A=(o>>11)/e*255|0,u=s*this.width*4+4*a;this.data[u]=A,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},Nl.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Nl.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},Nl.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,s){var a=new Nl(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new KN(100).encode(c,100);return t.processJPEG.call(this,A,r,n,s)}}(rr.API),Vj.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,s){var a=new Vj(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new KN(100).encode(c,100);return t.processJPEG.call(this,A,r,n,s)}}(rr.API),rr.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,a=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,A=0;A<s;A+=4){var u=n[A],d=n[A+1],f=n[A+2],h=n[A+3];a[l++]=u,a[l++]=d,a[l++]=f,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},rr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Sf=rr.API,Av=Sf.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,A=e.kerning?e.kerning:s.metadata.Unicode.kerning,u=A.fof?A.fof:1,d=e.doKerning!==!1,f=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?x.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(f=d&&Bn(A[n])==="object"&&!isNaN(parseInt(A[n][m],10))?A[n][m]/u:0,x.push((l[n]||p)/c+f)),m=n;return x},Tj=Sf.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Sf.processArabic&&(t=Sf.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:Av.apply(this,arguments).reduce(function(a,o){return a+o},0)},jj=function(t,e,r,n){for(var s=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<r;)l+=e[a],a++;s.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>n&&(s.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&s.push(t.slice(c,a)),s},Pj=function(t,e,r){r||(r={});var n,s,a,o,l,c,A,u=[],d=[u],f=r.textIndent||0,h=0,m=0,p=t.split(" "),x=Av.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var g=Array(c).join(" "),y=[];p.map(function(F){(F=F.split(/\s*\n/)).length>1?y=y.concat(F.map(function(j,R){return(R&&j.length?`
`:"")+j})):y.push(F[0])}),p=y,c=Tj.apply(this,[g,r])}for(a=0,o=p.length;a<o;a++){var b=0;if(n=p[a],c&&n[0]==`
`&&(n=n.substr(1),b=1),f+h+(m=(s=Av.apply(this,[n,r])).reduce(function(F,j){return F+j},0))>e||b){if(m>e){for(l=jj.apply(this,[n,s,e-(f+h),e]),u.push(l.shift()),u=[l.pop()];l.length;)d.push([l.shift()]);m=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(F,j){return F+j},0)}else u=[n];d.push(u),f=m+c,h=x}else u.push(n),f+=h+m,h=x}return A=c?function(F,j){return(j?g:"")+F.join(" ")}:function(F){return F.join(" ")},d.map(A)},Sf.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle),f="Unicode";return d.metadata[f]?{widths:d.metadata[f].widths||{0:1},kerning:d.metadata[f].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var l,c,A=[];for(l=0,c=n.length;l<c;l++)A=A.concat(Pj.apply(this,[n[l],o,a]));return A},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=e[a],s[e[a]]=r[a];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=t.__fontmetrics__.compress=function(f){var h,m,p,x,g=["{"];for(var y in f){if(h=f[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+s[p.slice(-1)];else{if(Bn(h)!=="object")throw new Error("Don't know what to do with value type "+Bn(h)+".");p=l(h)}g.push(m+p)}return g.push("}"),g.join("")},c=t.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,g={},y=1,b=g,F=[],j="",R="",E=f.length-1,S=1;S<E;S+=1)(x=f[S])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(F.push([b,p]),b={},p=void 0):x=="}"?((m=F.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?y=-1:p===void 0?n.hasOwnProperty(x)?(j+=n[x],p=parseInt(j,16)*y,y=1,j=""):j+=x:n.hasOwnProperty(x)?(R+=n[x],b[p]=parseInt(R,16)*y,y=1,p=void 0,R=""):R+=x;return g},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(f){var h=f.font,m=d.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=u.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(rr.API),function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(mw(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(rr),rr.API.addSvgAsImage=function(t,e,r,n,s,a,o,l){if(isNaN(e)||isNaN(r))throw Mn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Mn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var A=c.getContext("2d");A.fillStyle="#fff",A.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(Br.canvg?Promise.resolve(Br.canvg):mA(()=>import("./index.es-0H99XF2Y.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(A,t,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(u)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),e,r,n,s,o,l)})},rr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},rr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],A=0,u=0,d=0;function f(m,p){var x,g=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(g=!0);return g}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(d=0;d<h;d+=1)r[l[d]].value=r[l[d]].defaultValue,r[l[d]].explicitSet=!1}if(Bn(t)==="object"){for(s in t)if(a=t[s],f(l,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&f(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(A=0;A<a.length;A+=1)if(n=!0,a[A].length===1&&typeof a[A][0]=="number")c.push(String(a[A]-1));else if(a[A].length>1){for(u=0;u<a[A].length;u+=1)typeof a[A][u]!="number"&&(n=!1);n===!0&&c.push([a[A][0]-1,a[A][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),A=a.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+A+" >>"),this.internal.write("stream"),this.internal.write(s+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(rr.API),function(t){var e=t.API,r=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,A=["","0","00","000","0000"],u=[""],d=0,f=a.length;d<f;++d){if(l=o.metadata.characterToGlyph(a.charCodeAt(d)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(d),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(A[4-l.length],l)}return u.join("")},n=function(a){var o,l,c,A,u,d,f;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,f=(l=Object.keys(a).sort(function(h,m){return h-m})).length;d<f;d++)o=l[d],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(A=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+A+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var d=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<f.length;m++)h+=String.fromCharCode(f[m]);var p=A();u({data:h,addLength1:!0,objectId:p}),c("endobj");var x=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var g=A();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+qf(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=A();c("<<"),c("/Type /Font"),c("/BaseFont /"+qf(l.fontName)),c("/FontDescriptor "+g+" 0 R"),c("/W "+t.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=A(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+qf(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var d=l.metadata.rawData,f="",h=0;h<d.length;h++)f+=String.fromCharCode(d[h]);var m=A();u({data:f,addLength1:!0,objectId:m}),c("endobj");var p=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=A();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+qf(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=A();for(var g=0;g<l.metadata.hmtx.widths.length;g++)l.metadata.hmtx.widths[g]=parseInt(l.metadata.hmtx.widths[g]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+qf(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var s=function(a){var o,l=a.text||"",c=a.x,A=a.y,u=a.options||{},d=a.mutex||{},f=d.pdfEscape,h=d.activeFontKey,m=d.fonts,p=h,x="",g=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:A,options:u,mutex:d};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),g=0;g<y.length;g+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[g].charCodeAt(0)]),o||y[g].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=y[g]:x+="";var F="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?F=f(x,p).split("").map(function(j){return j.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(F=r(x,m[p])),d.isHex=!0,{text:F,x:c,y:A,options:u,mutex:d}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var A=0;for(A=0;A<o.length;A+=1)Array.isArray(o[A])&&o[A].length===3?l.push([s(Object.assign({},c,{text:o[A][0]})).text,o[A][1],o[A][2]]):l.push(s(Object.assign({},c,{text:o[A]})).text);a.text=l}else a.text=s(Object.assign({},c,{text:o})).text}])}(rr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(rr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,a,o,l,c,A,u,d=e,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var F=function(k){var T=k.charCodeAt(),L=T>>8,Y=p[L];return Y!==void 0?d[256*Y+(255&T)]:L===252||L===253?"AL":g.test(L)?"L":L===8?"R":"N"},j=function(k){for(var T,L=0;L<k.length;L++){if((T=F(k.charAt(L)))==="L")return!1;if(T==="R")return!0}return!1},R=function(k,T,L,Y){var me,ae,fe,de,Z=T[Y];switch(Z){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(Z="AN");break;case"AL":y=!0,Z="R";break;case"WS":case"BN":Z="N";break;case"CS":Y<1||Y+1>=T.length||(me=L[Y-1])!=="EN"&&me!=="AN"||(ae=T[Y+1])!=="EN"&&ae!=="AN"?Z="N":y&&(ae="AN"),Z=ae===me?ae:"N";break;case"ES":Z=(me=Y>0?L[Y-1]:"B")==="EN"&&Y+1<T.length&&T[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&L[Y-1]==="EN"){Z="EN";break}if(y){Z="N";break}for(fe=Y+1,de=T.length;fe<de&&T[fe]==="ET";)fe++;Z=fe<de&&T[fe]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(de=T.length,fe=Y+1;fe<de&&T[fe]==="NSM";)fe++;if(fe<de){var xe=k[Y],Be=xe>=1425&&xe<=2303||xe===64286;if(me=T[fe],Be&&(me==="R"||me==="AL")){Z="R";break}}}Z=Y<1||(me=T[Y-1])==="B"?"N":L[Y-1];break;case"B":y=!1,s=!0,Z=b;break;case"S":a=!0,Z="N"}return Z},E=function(k,T,L){var Y=k.split("");return L&&S(Y,L,{hiLevel:b}),Y.reverse(),T&&T.reverse(),Y.join("")},S=function(k,T,L){var Y,me,ae,fe,de,Z=-1,xe=k.length,Be=0,I=[],C=b?h:f,Q=[];for(y=!1,s=!1,a=!1,me=0;me<xe;me++)Q[me]=F(k[me]);for(ae=0;ae<xe;ae++){if(de=Be,I[ae]=R(k,Q,I,ae),Y=240&(Be=C[de][m[I[ae]]]),Be&=15,T[ae]=fe=C[Be][5],Y>0)if(Y===16){for(me=Z;me<ae;me++)T[me]=1;Z=-1}else Z=-1;if(C[Be][6])Z===-1&&(Z=ae);else if(Z>-1){for(me=Z;me<ae;me++)T[me]=fe;Z=-1}Q[ae]==="B"&&(T[ae]=0),L.hiLevel|=fe}a&&function(M,D,z){for(var O=0;O<z;O++)if(M[O]==="S"){D[O]=b;for(var te=O-1;te>=0&&M[te]==="WS";te--)D[te]=b}}(Q,T,xe)},B=function(k,T,L,Y,me){if(!(me.hiLevel<k)){if(k===1&&b===1&&!s)return T.reverse(),void(L&&L.reverse());for(var ae,fe,de,Z,xe=T.length,Be=0;Be<xe;){if(Y[Be]>=k){for(de=Be+1;de<xe&&Y[de]>=k;)de++;for(Z=Be,fe=de-1;Z<fe;Z++,fe--)ae=T[Z],T[Z]=T[fe],T[fe]=ae,L&&(ae=L[Z],L[Z]=L[fe],L[fe]=ae);Be=de}Be++}}},U=function(k,T,L){var Y=k.split(""),me={hiLevel:b};return L||(L=[]),S(Y,L,me),function(ae,fe,de){if(de.hiLevel!==0&&u)for(var Z,xe=0;xe<ae.length;xe++)fe[xe]===1&&(Z=x.indexOf(ae[xe]))>=0&&(ae[xe]=x[Z+1])}(Y,L,me),B(2,Y,T,L,me),B(1,Y,T,L,me),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(k,T,L){if(function(me,ae){if(ae)for(var fe=0;fe<me.length;fe++)ae[fe]=fe;l===void 0&&(l=j(me)),A===void 0&&(A=j(me))}(k,T),o||!c||A)if(o&&c&&l^A)b=l?1:0,k=E(k,T,L);else if(!o&&c&&A)b=l?1:0,k=U(k,T,L),k=E(k,T);else if(!o||l||c||A){if(o&&!c&&l^A)k=E(k,T),l?(b=0,k=U(k,T,L)):(b=1,k=U(k,T,L),k=E(k,T));else if(o&&l&&!c&&A)b=1,k=U(k,T,L),k=E(k,T);else if(!o&&!c&&l^A){var Y=u;l?(b=1,k=U(k,T,L),b=0,u=!1,k=U(k,T,L),u=Y):(b=0,k=U(k,T,L),k=E(k,T),b=1,u=!1,k=U(k,T,L),u=Y,k=E(k,T))}}else b=0,k=U(k,T,L);else b=l?1:0,k=U(k,T,L);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,A=k.isOutputRtl,u=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(rr),rr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new sd(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new boe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new loe(this.contents),this.head=new Aoe(this),this.name=new moe(this),this.cmap=new GM(this),this.toUnicode={},this.hhea=new uoe(this),this.maxp=new poe(this),this.hmtx=new goe(this),this.post=new hoe(this),this.os2=new doe(this),this.loca=new yoe(this),this.glyf=new xoe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,A;for(A=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],A.push(Math.round(e*this.scaleFactor));return A}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)s=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var zl,sd=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,a,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,a;for(a=[],n=0,s=e.length;n<s;n++)r=e[n],a.push(this.writeByte(r));return a},t}(),loe=function(){var t;function e(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,a,o,l,c,A,u,d,f,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),d=16*Math.floor(Math.log(h)/c),o=Math.floor(d/c),u=16*h-d,(s=new sd).writeInt(this.scalarType),s.writeShort(h),s.writeShort(d),s.writeShort(o),s.writeShort(u),a=16*h,A=s.pos+a,l=null,m=[],r)for(f=r[p],s.writeString(p),s.writeInt(t(f)),s.writeInt(A),s.writeInt(f.length),m=m.concat(f),p==="head"&&(l=A),A+=f.length;A%4;)m.push(0),A++;return s.write(m),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,a,o;for(r=$M.call(r);r.length%4;)r.push(0);for(a=new sd(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=a.readUInt32();return 4294967295&s},e}(),coe={}.hasOwnProperty,Ic=function(t,e){for(var r in e)coe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};zl=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var Aoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new sd).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),Hj=function(){function t(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),f=h/2,e.pos+=6,a=function(){var F,j;for(j=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)j.push(e.readUInt16());return j}(),e.pos+=2,p=function(){var F,j;for(j=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)j.push(e.readUInt16());return j}(),A=function(){var F,j;for(j=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)j.push(e.readUInt16());return j}(),u=function(){var F,j;for(j=[],c=F=0;0<=f?F<f:F>f;c=0<=f?++F:--F)j.push(e.readUInt16());return j}(),s=(this.length-e.pos+this.offset)/2,l=function(){var F,j;for(j=[],c=F=0;0<=s?F<s:F>s;c=0<=s?++F:--F)j.push(e.readUInt16());return j}(),c=g=0,b=a.length;g<b;c=++g)for(x=a[c],n=y=m=p[c];m<=x?y<=x:y>=x;n=m<=x?++y:--y)u[c]===0?o=n+A[c]:(o=l[u[c]/2+(n-m)-(f-c)]||0)!==0&&(o+=A[c]),this.codeMap[n]=65535&o}e.pos=d}return t.encode=function(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,y,b,F,j,R,E,S,B,U,k,T,L,Y,me,ae,fe,de,Z,xe,Be,I,C,Q,M,D,z,O,te,se,we,q;switch(Y=new sd,o=Object.keys(e).sort(function(Me,re){return Me-re}),r){case"macroman":for(p=0,x=function(){var Me=[];for(m=0;m<256;++m)Me.push(0);return Me}(),y={0:0},a={},me=0,Z=o.length;me<Z;me++)y[te=e[s=o[me]]]==null&&(y[te]=++p),a[s]={old:e[s],new:y[e[s]]},x[s]=y[e[s]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(x),{charMap:a,subtable:Y.data,maxGlyphID:p+1};case"unicode":for(T=[],d=[],b=0,y={},n={},g=A=null,ae=0,xe=o.length;ae<xe;ae++)y[j=e[s=o[ae]]]==null&&(y[j]=++b),n[s]={old:j,new:y[j]},l=y[j]-s,g!=null&&l===A||(g&&d.push(g),T.push(s),A=l),g=s;for(g&&d.push(g),d.push(65535),T.push(65535),U=2*(B=T.length),S=2*Math.pow(Math.log(B)/Math.LN2,2),f=Math.log(S/2)/Math.LN2,E=2*B-S,c=[],R=[],h=[],m=fe=0,Be=T.length;fe<Be;m=++fe){if(k=T[m],u=d[m],k===65535){c.push(0),R.push(0);break}if(k-(L=n[k].new)>=32768)for(c.push(0),R.push(2*(h.length+B-m)),s=de=k;k<=u?de<=u:de>=u;s=k<=u?++de:--de)h.push(n[s].new);else c.push(L-k),R.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*B+2*h.length),Y.writeUInt16(0),Y.writeUInt16(U),Y.writeUInt16(S),Y.writeUInt16(f),Y.writeUInt16(E),z=0,I=d.length;z<I;z++)s=d[z],Y.writeUInt16(s);for(Y.writeUInt16(0),O=0,C=T.length;O<C;O++)s=T[O],Y.writeUInt16(s);for(se=0,Q=c.length;se<Q;se++)l=c[se],Y.writeUInt16(l);for(we=0,M=R.length;we<M;we++)F=R[we],Y.writeUInt16(F);for(q=0,D=h.length;q<D;q++)p=h[q],Y.writeUInt16(p);return{charMap:n,subtable:Y.data,maxGlyphID:b+1}}},t}(),GM=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new Hj(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,s;return r==null&&(r="macroman"),n=Hj.encode(e,r),(s=new sd).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t}(),uoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),doe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),hoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)r=e.readByte(),s.push(this.names.push(e.readString(r)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),foe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},moe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,s,a,o,l,c,A,u,d,f;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},a=u=0,d=n.length;u<d;a=++u)s=n[a],e.pos=s.offset,A=e.readString(s.length),o=new foe(A,s),c[f=s.nameID]==null&&(c[f]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),poe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),goe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,s,a,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var A,u;for(u=[],r=A=0;0<=s?A<s:A>s;r=0<=s?++A:--A)u.push(e.readInt16());return u}(),this.widths=(function(){var A,u,d,f;for(f=[],A=0,u=(d=this.metrics).length;A<u;A++)a=d[A],f.push(a.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),$M=[].slice,xoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,s,a,o,l,c,A,u,d;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new sd(r.read(s))).readShort(),A=l.readShort(),d=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[e]=o===-1?new woe(l,A,d,c,u):new voe(l,o,A,d,c,u),this.cache[e]))},t.prototype.encode=function(e,r,n){var s,a,o,l,c;for(o=[],a=[],l=0,c=r.length;l<c;l++)s=e[r[l]],a.push(o.length),s&&(o=o.concat(s.encode(n)));return a.push(o.length),{table:o,offsets:a}},t}(),voe=function(){function t(e,r,n,s,a,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),woe=function(){function t(e,r,n,s,a){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new sd($M.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),yoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ic(t,zl),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<n.length;++o)if(n[o]=s,a<r.length&&r[a]==o){++a,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var A=new Array(4*n.length),u=0;u<n.length;++u)A[4*u+3]=255&n[u],A[4*u+2]=(65280&n[u])>>8,A[4*u+1]=(16711680&n[u])>>16,A[4*u]=(4278190080&n[u])>>24;return A},t}(),boe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,a,o,l,c;for(s={},o=0,l=e.length;o<l;o++)s[a=e[o]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},t.prototype.encode=function(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g;for(s in n=GM.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},g=n.charMap)h[(c=g[s]).old]=c.new;for(m in f=n.maxGlyphID,o)m in h||(h[m]=f++);return u=function(y){var b,F;for(b in F={},y)F[y[b]]=b;return F}(h),d=Object.keys(u).sort(function(y,b){return y-b}),p=function(){var y,b,F;for(F=[],y=0,b=d.length;y<b;y++)l=d[y],F.push(u[l]);return F}(),a=this.font.glyf.encode(o,p,h),A=this.font.loca.encode(a.offsets,p),x={cmap:this.font.cmap.raw(),glyf:a.table,loca:A,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();rr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,a,o;if(Array.isArray(r))return"["+function(){var l,c,A;for(A=[],l=0,c=r.length;l<c;l++)n=r[l],A.push(e.convert(n));return A}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)o=r[s],a.push("/"+s+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+r},e}();const NE=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:Zie,AcroFormAppearance:ar,AcroFormButton:oa,AcroFormCheckBox:Xp,AcroFormChoiceField:oh,AcroFormComboBox:ch,AcroFormEditBox:Wp,AcroFormListBox:lh,AcroFormPasswordField:Yp,AcroFormPushButton:Jp,AcroFormRadioButton:Ah,AcroFormTextField:zu,GState:zg,ShadingPattern:Cu,TilingPattern:eh,default:rr,jsPDF:rr},Symbol.toStringTag,{value:"Module"}));async function Noe(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:Vt.now()};return zr(ot(Re,"inventory_batches"),e)}async function zM(t,e){await Fr(Ft(Re,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:Vt.now()})}async function Coe(t,e){const r=Ut(ot(Re,"batch_allocations"),qt("saleDate",">=",t),qt("saleDate","<=",e)),n=await bt(r),s={};return n.forEach(a=>{const o=a.data(),l=o.batchId;s[l]||(s[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),s[l].quantity+=Number(o.quantity||0),s[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(s)}async function _oe(t){const e=Ft(Re,"salesV2",t),r=await za(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const A=String((c==null?void 0:c.batchId)||"").trim(),u=Number((c==null?void 0:c.qty)||0);A&&u&&s.push({batchId:A,qty:u})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),A=Number((l==null?void 0:l.qty)||0);c&&A&&s.push({batchId:c,qty:A})}if(s.length===0)return await Na(Re,async l=>{l.delete(e)}),{restored:0};const a=new Map;for(const l of s)a.set(l.batchId,Number((a.get(l.batchId)||0)+l.qty));let o=0;return await Na(Re,async l=>{const c=Array.from(a.entries()),A=c.map(([d])=>Ft(Re,"inventory_batches",d)),u=await Promise.all(A.map(d=>l.get(d)));c.forEach(([d,f],h)=>{const m=u[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),g=Number((x+Number(f||0)).toFixed(3));l.update(A[h],{remaining:g}),o+=Number(f||0)}),l.delete(e)}),{restored:o}}function Wl(){const[t,e]=N.useState(0),r=N.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const $o=t=>Math.round((Number(t)||0)*100)/100,uv=t=>Math.round((Number(t)||0)*1e3)/1e3,ep=t=>Number(t??0).toFixed(2),qN=t=>Number(t??0).toFixed(3),Kj=(t,e)=>{var n;const r=t.date??((n=t.timestamp)!=null&&n.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");return r?Array.isArray(t.items)&&t.items.length>0?t.items.map((s,a)=>{const o=Number((s==null?void 0:s.qty)??0),l=Number((s==null?void 0:s.lineFinal)??0)||Math.max(0,Number((s==null?void 0:s.unitPrice)||0)*o-Number((s==null?void 0:s.discount)||0));return{id:`${e}#${a}`,productName:String((s==null?void 0:s.productName)??"(sin nombre)"),quantity:o,amount:$o(l),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(s==null?void 0:s.allocations)?s.allocations:t.allocations,avgUnitCost:Number((s==null?void 0:s.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((s==null?void 0:s.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]:[]};function Eoe({role:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[a,o]=N.useState(null),[l,c]=N.useState(!0),[A,u]=N.useState(""),[d,f]=N.useState("ALL"),[h,m]=N.useState(null),[p,x]=N.useState(0),[g,y]=N.useState(0),[b,F]=N.useState(""),[j,R]=N.useState(0),[E,S]=N.useState("0"),B=or(new Date,"yyyy-MM-dd"),U=N.useRef(null),{refreshKey:k}=Wl();N.useEffect(()=>{const D=Ut(ot(Re,"salesV2"),qt("date","==",B)),z=M0(D,O=>{const te=[];O.forEach(se=>{const we=Kj(se.data(),se.id);te.push(...we)}),r(te),c(!1)});return()=>z()},[B,k]),N.useEffect(()=>{const D=Ut(ot(Re,"salesV2"),qt("status","==","FLOTANTE")),z=M0(D,O=>{const te=[];O.forEach(se=>{const we=Kj(se.data(),se.id);te.push(...we)}),s(te)});return()=>z()},[k]),N.useEffect(()=>{(async()=>{const z=Ut(ot(Re,"daily_closures"),qt("date","==",B)),O=await bt(z);if(O.empty)o(null);else{const te=O.docs[0];o({id:te.id,...te.data()})}})()},[B,k]);const T=li.useMemo(()=>{if(d==="FLOTANTE"){const D=[...e,...n],z=new Map;for(const O of D)O.status==="FLOTANTE"&&z.set(O.id,O);return Array.from(z.values())}if(d==="ALL"){const D=[...e,...n],z=new Map;for(const O of D)z.set(O.id,O);return Array.from(z.values())}return e.filter(D=>D.status==="PROCESADA")},[d,e,n]);$o(T.reduce((D,z)=>D+(z.amountSuggested||0),0));const L=$o(T.reduce((D,z)=>D+(z.amount||0),0)),Y=uv(T.reduce((D,z)=>D+(z.quantity||0),0)),me=$o(T.reduce((D,z)=>D+Number(z.cogsAmount??0),0)),ae=$o(L-me),fe={};T.forEach(D=>{const z=D.productName||"(sin nombre)";fe[z]||(fe[z]={totalQuantity:0,totalAmount:0}),fe[z].totalQuantity=uv(fe[z].totalQuantity+(D.quantity||0)),fe[z].totalAmount=$o(fe[z].totalAmount+(D.amount||0))});const de=Object.entries(fe).map(([D,z])=>({productName:D,totalQuantity:z.totalQuantity,totalAmount:z.totalAmount})),Z=async()=>{try{const D=T.filter(Me=>Me.status==="FLOTANTE"),z=D.length>0?D:e.filter(Me=>Me.status!=="PROCESADA");if(z.length===0){u("No hay ventas para procesar.");return}const O={totalCharged:$o(z.reduce((Me,re)=>Me+(re.amount||0),0)),totalSuggested:$o(z.reduce((Me,re)=>Me+(re.amountSuggested||0),0)),totalUnits:uv(z.reduce((Me,re)=>Me+(re.quantity||0),0)),totalCOGS:$o(z.reduce((Me,re)=>Me+Number(re.cogsAmount??0),0))},te=$o(O.totalCharged-O.totalSuggested),se=$o(O.totalCharged-O.totalCOGS),we=await zr(ot(Re,"daily_closures"),{date:B,createdAt:Vt.now(),totalCharged:O.totalCharged,totalSuggested:O.totalSuggested,totalDifference:te,totalUnits:O.totalUnits,totalCOGS:O.totalCOGS,grossProfit:se,products:z.map(Me=>({productName:Me.productName,quantity:Me.quantity,amount:Me.amount})),salesV2:z.map(Me=>({id:Me.id,productName:Me.productName,quantity:Me.quantity,amount:Me.amount,amountSuggested:Me.amountSuggested,userEmail:Me.userEmail,clientName:Me.clientName,amountReceived:Me.amountReceived,change:Me.change,status:Me.status,cogsAmount:Me.cogsAmount??0,avgUnitCost:Me.avgUnitCost??null,allocations:Me.allocations??[],date:Me.date})),productSummary:Object.entries(z.reduce((Me,re)=>{const J=re.productName||"(sin nombre)";return Me[J]||(Me[J]={totalQuantity:0,totalAmount:0}),Me[J].totalQuantity=uv(Me[J].totalQuantity+(re.quantity||0)),Me[J].totalAmount=$o(Me[J].totalAmount+(re.amount||0)),Me},{})).map(([Me,re])=>({productName:Me,totalQuantity:re.totalQuantity,totalAmount:re.totalAmount}))}),q=Gh(Re);z.forEach(Me=>{q.update(Ft(Re,"salesV2",Me.id.split("#")[0]),{status:"PROCESADA",closureId:we.id,closureDate:B})}),await q.commit(),u(` Cierre guardado. Ventas procesadas: ${z.length}.`)}catch(D){console.error(D),u(" Error al guardar el cierre.")}},xe=async D=>{if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Fr(Ft(Re,"salesV2",D.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),u(" Venta revertida a FLOTANTE.")}catch(z){console.error(z),u(" No se pudo revertir la venta.")}},Be=D=>{m(D),x(D.quantity),y(D.amount),F(D.clientName),R(D.amountReceived),S(D.change)},I=async()=>{if(h)try{await Fr(Ft(Re,"salesV2",h.id.split("#")[0]),{quantity:p,amount:g,amountCharged:g,clientName:b,amountReceived:j,change:E}),m(null),u(" Venta actualizada.")}catch(D){console.error(D),u(" No se pudo actualizar la venta.")}},C=async D=>{if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:z}=await _oe(D.split("#")[0]);u(` Venta eliminada. Stock restaurado: ${Number(z).toFixed(2)}.`)}catch(z){console.error(z),u(" No se pudo eliminar la venta.")}},Q=async()=>{if(U.current){U.current.classList.add("force-pdf-colors");try{const z=(await $h(U.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),O=new rr;O.addImage(z,"PNG",10,10,190,0),O.save(`cierre_${B}.pdf`)}finally{U.current.classList.remove("force-pdf-colors")}}},M=!t||t==="admin";return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas - ",B]}),i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:d,onChange:D=>f(D.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),l?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:U,children:[i.jsxs("table",{className:"min-w-full border text-sm mb-4  shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[T.map(D=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"border p-1",children:D.productName}),i.jsx("td",{className:"border p-1",children:qN(D.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ep(D.amount)]}),i.jsx("td",{className:"border p-1",children:D.date}),i.jsx("td",{className:"border p-1",children:D.userEmail}),i.jsx("td",{className:"border p-1",children:D.status==="FLOTANTE"?i.jsxs("div",{className:"flex gap-2 justify-center",children:[M&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Be(D),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>C(D.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}),!M&&i.jsx("span",{className:"text-gray-400 text-xs",children:""})]}):D.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:M?i.jsx("button",{onClick:()=>xe(D.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},D.id)),T.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm mb-2",children:[i.jsxs("div",{children:[" ","Total Libras/Unidades: ",i.jsx("strong",{children:qN(Y)})]}),i.jsxs("div",{children:[" ","Total cobrado: ",i.jsxs("strong",{children:["C$",ep(L)]})]})]}),(me>0||ae!==L)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:[" ","Calculo a Precio compra:"," ",i.jsxs("strong",{children:["C$",ep(me)]})]}),i.jsxs("div",{children:[" ","Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",ep(ae)]})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[de.map(D=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:D.productName}),i.jsx("td",{className:"border p-1",children:qN(D.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ep(D.totalAmount)]})]},D.productName)),de.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:Z,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:Q,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),h&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[h.productName,"  ",h.userEmail]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:p,onChange:D=>x(parseFloat(D.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:g,onChange:D=>y(parseFloat(D.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:b,onChange:D=>F(D.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:j,onChange:D=>R(parseFloat(D.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:E,onChange:D=>S(D.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>m(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:I,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const qo=t=>Number(t??0).toFixed(2),If=t=>Number(t??0).toFixed(3);function Boe(){var y,b,F,j;const t=async R=>{if(!window.confirm(`Eliminar el cierre del ${R.date}?`))return;const E=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(E){const S=await bt(Ut(ot(Re,"salesV2"),qt("closureId","==",R.id)));if(!S.empty){const B=Gh(Re);S.forEach(U=>{B.update(Ft(Re,"salesV2",U.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await B.commit()}}await mn(Ft(Re,"daily_closures",R.id)),(A==null?void 0:A.id)===R.id&&u(null),await m(),f(` Cierre eliminado${E?" y ventas reabiertas.":"."}`)}catch(S){console.error(S),f(" No se pudo eliminar el cierre.")}},[e,r]=N.useState(or(Z6(new Date),"yyyy-MM-dd")),[n,s]=N.useState(or(new Date,"yyyy-MM-dd")),[a,o]=N.useState(!0),[l,c]=N.useState([]),[A,u]=N.useState(null),[d,f]=N.useState(""),h=N.useRef(null),m=async()=>{try{o(!0);const R=Ut(ot(Re,"daily_closures"),qt("date",">=",e),qt("date","<=",n)),E=await bt(R),S=[];E.forEach(B=>S.push({id:B.id,...B.data()})),S.sort((B,U)=>B.date<U.date?1:B.date>U.date?-1:0),c(S)}catch(R){console.error(R),f(" Error cargando el historial.")}finally{o(!1)}};N.useEffect(()=>{m()},[]);const p=async R=>{R.preventDefault(),m()},x=N.useMemo(()=>{if(!A)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const R=Number(A.totalUnits??0),E=Number(A.totalSuggested??0),S=Number(A.totalCharged??0),B=Number(A.totalDifference??(isFinite(S-E)?S-E:0)),U=Number(A.totalCOGS??0),k=Number(A.grossProfit??(isFinite(S-U)?S-U:0));return{units:R,sug:E,chg:S,diff:B,cogs:U,profit:k}},[A]),g=async()=>{if(!h.current||!A)return;const R=h.current;R.classList.add("force-pdf-colors");try{const[{default:E},{jsPDF:S}]=await Promise.all([mA(()=>Promise.resolve().then(()=>$S),void 0),mA(()=>Promise.resolve().then(()=>NE),void 0)]),U=(await E(R,{backgroundColor:"#ffffff",onclone:L=>{const Y=L.defaultView;L.body.querySelectorAll("*").forEach(ae=>{const fe=Y.getComputedStyle(ae);fe.color&&(ae.style.color=fe.color),fe.backgroundColor&&fe.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ae.style.backgroundColor=fe.backgroundColor),fe.borderColor&&(ae.style.borderColor=fe.borderColor)})}})).toDataURL("image/png"),{jsPDF:k}=await mA(async()=>{const{jsPDF:L}=await Promise.resolve().then(()=>NE);return{jsPDF:L}},void 0),T=new k;T.addImage(U,"PNG",10,10,190,0),T.save(`cierre_${A.date}.pdf`)}finally{R.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:R=>r(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:R=>s(R.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),a?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(R=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.date}),i.jsx("td",{className:"border p-1",children:If(R.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.grossProfit??Number(R.totalCharged??0)-Number(R.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>u(R),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(R),children:"Eliminar"})]})})]},R.id))})]}),A&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",A.date]}),i.jsx("button",{onClick:()=>u(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:g,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:If(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",qo(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",qo(x.profit)]})]})]}),(y=A.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:A.salesV2.map((R,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:If(R.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:R.date??""}),i.jsx("td",{className:"border p-1",children:R.userEmail??""})]},E))})]})]}):(b=A.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:A.sales.map((R,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:If(R.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.amount)]}),i.jsx("td",{className:"border p-1",children:R.userEmail??""}),i.jsx("td",{className:"border p-1",children:R.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof R.change=="number"?qo(R.change):R.change??"0"})]},E))})]})]}):(F=A.products)!=null&&F.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:A.products.map((R,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName}),i.jsx("td",{className:"border p-1",children:If(R.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.amount)]})]},E))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(j=A.productSummary)!=null&&j.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:A.productSummary.map((R,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName}),i.jsx("td",{className:"border p-1",children:If(R.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",qo(R.totalAmount)]})]},E))})]})]}):null]})]}),d&&i.jsx("p",{className:"mt-3 text-sm",children:d})]})}function Soe(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,a]=N.useState(""),[o,l]=N.useState(!1),[c,A]=N.useState("vendedor_pollo"),[u,d]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState([]),[x,g]=N.useState(!0),[y,b]=N.useState(null),[F,j]=N.useState("vendedor_pollo"),[R,E]=N.useState(""),[S,B]=N.useState(!1),[U,k]=N.useState([]),T=C=>!C||C==="vendedor"?"vendedor_pollo":C==="admin"||C==="vendedor_pollo"||C==="vendedor_ropa"||C==="vendedor_dulces"?C:"vendedor_pollo",L=async()=>{g(!0);const C=await bt(ot(Re,"users")),Q=[];C.forEach(M=>{const D=M.data();Q.push({id:M.id,email:D.email??"",name:D.name??"",role:T(D.role),sellerCandyId:D.sellerCandyId??""})}),p(Q),g(!1)},Y=async()=>{try{const C=await bt(ot(Re,"sellers_candies")),Q=[];C.forEach(M=>{const D=M.data();Q.push({id:M.id,name:D.name??"(sin nombre)",branchLabel:D.branch??"",commissionPercent:Number(D.commissionPercent??0)})}),k(Q)}catch(C){console.error("Error cargando sellers_candies:",C)}};N.useEffect(()=>{L(),Y()},[]);const me=()=>{e(""),n(""),a(""),A("vendedor_pollo"),h("")},ae=async C=>{if(C.preventDefault(),d(""),s.length<4){d(" La contrasea debe tener al menos 4 caracteres.");return}if(!t.trim()){d(" El nombre es obligatorio.");return}try{const Q=VB(),M=QB(Q.options,"Secondary"),D=GL(M),z=await g$(D,r,s),O=T(c),te=O==="vendedor_dulces"&&f||"";await K6(Ft(ot(Re,"users"),z.user.uid),{email:r,name:t.trim(),role:O,sellerCandyId:te}),await RL(D),await dG(M),p(se=>[{id:z.user.uid,email:r,name:t.trim(),role:O,sellerCandyId:te},...se]),d(" Usuario creado correctamente."),me(),B(!1)}catch(Q){console.error(Q),d(" Error al crear el usuario: "+Q.message)}},fe=C=>{b(C.id),j(T(C.role)),E(C.sellerCandyId||"")},de=()=>{b(null),j("vendedor_pollo"),E("")},Z=async()=>{if(!y)return;const C=Ft(Re,"users",y),Q=T(F),M=Q==="vendedor_dulces"&&R||"";await Fr(C,{role:Q,sellerCandyId:M}),p(D=>D.map(z=>z.id===y?{...z,role:Q,sellerCandyId:M}:z)),de()},xe=async C=>{confirm("Eliminar este usuario del listado?")&&(await mn(Ft(Re,"users",C)),p(M=>M.filter(D=>D.id!==C)))},Be=C=>{const Q=C==="admin"?"admin":C==="vendedor_ropa"?"vendedor_ropa":C==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",M=Q==="admin"?"bg-blue-100 text-blue-700":Q==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":Q==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${M}`,children:Q})},I=C=>`${C.name}  ${C.branchLabel||"Sin sucursal"}  ${C.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>B(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(C=>{const Q=y===C.id,M=(Q?F:C.role)==="vendedor_dulces";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:C.name||""}),i.jsx("td",{className:"p-2 border",children:C.email}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("select",{className:"w-full border p-1 rounded",value:F,onChange:D=>j(D.target.value),children:[i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),i.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),i.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]}),F==="vendedor_dulces"&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:R,onChange:D=>E(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),U.map(D=>i.jsx("option",{value:D.id,children:I(D)},D.id))]})]}):i.jsxs(i.Fragment,{children:[Be(C.role),M&&C.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Z,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:de,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>fe(C),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>xe(C.id),children:"Eliminar"})]})})]},C.id)})})]})}),u&&i.jsx("p",{className:"text-sm mt-2",children:u}),S&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>B(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>B(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:C=>e(C.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:C=>n(C.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:s,onChange:C=>a(C.target.value),required:!0}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(C=>!C),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Rol"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:C=>A(C.target.value),children:[i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),i.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),i.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]})]}),c==="vendedor_dulces"&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:f,onChange:C=>h(C.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),U.map(C=>i.jsx("option",{value:C.id,children:I(C)},C.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>B(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Crear usuario"})]})]}),u&&i.jsx("p",{className:"text-sm mt-2",children:u})]})]})]})}const Ioe=t=>`C$${(Number(t)||0).toFixed(2)}`;function Foe(){const[t,e]=N.useState(""),[r,n]=N.useState(0),[s,a]=N.useState(""),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState([]),[f,h]=N.useState(!0),[m,p]=N.useState(!1),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,j]=N.useState(""),[R,E]=N.useState(""),[S,B]=N.useState(0),[U,k]=N.useState(!1),T=async()=>{h(!0);const xe=await bt(ot(Re,"products")),Be=[];xe.forEach(I=>{const C=I.data();Be.push({id:I.id,name:C.name??"",price:Number(C.price??0),category:C.category??"",measurement:C.measurement??"",active:C.active!==!1})}),d(Be),h(!1)};N.useEffect(()=>{T()},[]);const L=async xe=>{if(xe.preventDefault(),a(""),!t||r<=0||!c){a(" Completa nombre, precio vlido y unidad de medida");return}try{const Be={name:t,price:parseFloat(r.toFixed(2)),category:o,measurement:c,active:!0},I=await zr(ot(Re,"products"),Be);d(C=>[{id:I.id,...Be},...C]),a(" Producto registrado con exito."),e(""),n(0),A(""),l(""),k(!1)}catch(Be){a(" Error: "+Be.message)}},Y=xe=>{g(xe.id),b(xe.name),j(xe.category),E(xe.measurement),B(xe.price)},me=()=>{g(null),b(""),j(""),E(""),B(0)},ae=async()=>{if(!x)return;const xe=Ft(Re,"products",x);await Fr(xe,{name:y,category:F,measurement:R,price:parseFloat((S||0).toFixed(2))}),d(Be=>Be.map(I=>I.id===x?{...I,name:y,category:F,measurement:R,price:parseFloat((S||0).toFixed(2))}:I)),me()},fe=async xe=>{const Be=Ft(Re,"products",xe.id),I=xe.active===!1;await Fr(Be,{active:I}),d(C=>C.map(Q=>Q.id===xe.id?{...Q,active:I}:Q))},de=async xe=>{const Be=Ut(ot(Re,"inventory_batches"),qt("productId","==",xe),V6(1));if(!(await bt(Be)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await mn(Ft(Re,"products",xe)),d(Q=>Q.filter(M=>M.id!==xe)))},Z=m?u:u.filter(xe=>xe.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{a(""),k(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),U&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>k(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>k(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:L,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:o,onChange:xe=>l(xe.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:xe=>e(xe.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:c,onChange:xe=>A(xe.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:xe=>n(parseFloat(xe.target.value)),onFocus:xe=>xe.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),s&&i.jsx("p",{className:"text-sm mt-2",children:s})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:m,onChange:xe=>p(xe.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:f?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):Z.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):Z.map(xe=>{const Be=x===xe.id,I=xe.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Be?i.jsx("input",{className:"w-full border p-1 rounded",value:y,onChange:C=>b(C.target.value)}):xe.name}),i.jsx("td",{className:"p-2 border",children:Be?i.jsxs("select",{className:"w-full border p-1 rounded",value:F,onChange:C=>j(C.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):xe.category}),i.jsx("td",{className:"p-2 border",children:Be?i.jsxs("select",{className:"w-full border p-1 rounded",value:R,onChange:C=>E(C.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):xe.measurement}),i.jsx("td",{className:"p-2 border",children:Be?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(S)?"":S,onChange:C=>B(parseFloat(C.target.value))}):Ioe(xe.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${I?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:I?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:Be?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ae,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:me,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Y(xe),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${I?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>fe(xe),children:I?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>de(xe.id),children:"Eliminar"})]})})]},xe.id)})})]})})]})}const Pa=[];for(let t=0;t<256;++t)Pa.push((t+256).toString(16).slice(1));function koe(t,e=0){return(Pa[t[e+0]]+Pa[t[e+1]]+Pa[t[e+2]]+Pa[t[e+3]]+"-"+Pa[t[e+4]]+Pa[t[e+5]]+"-"+Pa[t[e+6]]+Pa[t[e+7]]+"-"+Pa[t[e+8]]+Pa[t[e+9]]+"-"+Pa[t[e+10]]+Pa[t[e+11]]+Pa[t[e+12]]+Pa[t[e+13]]+Pa[t[e+14]]+Pa[t[e+15]]).toLowerCase()}let GN;const Toe=new Uint8Array(16);function joe(){if(!GN){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");GN=crypto.getRandomValues.bind(crypto)}return GN(Toe)}const Poe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),qj={randomUUID:Poe};function Roe(t,e,r){var s;if(qj.randomUUID&&!t)return qj.randomUUID();t=t||{};const n=t.random??((s=t.rng)==null?void 0:s.call(t))??joe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,koe(n)}async function Doe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const s=ot(t,"inventory_batches"),a=Ut(s,qt("productName","==",e)),c=(await bt(a)).docs.map(A=>({id:A.id,data:A.data()})).sort((A,u)=>{var p,x;const d=A.data.date??"",f=u.data.date??"";if(d!==f)return d<f?-1:1;const h=((p=A.data.createdAt)==null?void 0:p.seconds)??0,m=((x=u.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(A=>Ft(t,"inventory_batches",A.id));return Na(t,async A=>{let u=Number(r);const d=[],f=await Promise.all(c.map(x=>A.get(x)));for(let x=0;x<c.length&&u>0;x++){const g=c[x],y=f[x];if(!y.exists())continue;const b=y.data(),F=Number(b.quantity??0),j=Number(b.remaining??F??0),R=Number(b.purchasePrice??0);if(j<=0)continue;const E=Math.min(j,u),S=Number((j-E).toFixed(3));A.update(g,{remaining:S}),d.push({batchId:g.id,qty:E,unitCost:R,lineCost:Number((E*R).toFixed(2))}),u=Number((u-E).toFixed(3))}if(u>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${u} unidades.`);const h=Number(d.reduce((x,g)=>x+g.lineCost,0).toFixed(2)),m=d.reduce((x,g)=>x+g.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:d,avgUnitCost:p,cogsAmount:h}})}const WM=3,Loe=.5*10**-WM;function Ma(t){const e=Number(t??0);return Number(e.toFixed(WM))}function $N(t,e){return Ma((t??0)+(e??0))}function dv(t,e){return Ma(t)+Loe>=Ma(e)}async function Uoe(t,e){const r=await bt(ot(Re,"inventory_batches")),n=t.trim().toLowerCase();let s=0;for(const a of r.docs){const o=a.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await Fr(Ft(Re,"inventory_batches",a.id),{productId:e}),s++)}return s}function Gj({user:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[a,o]=N.useState(""),[l,c]=N.useState(or(new Date,"yyyy-MM-dd")),[A,u]=N.useState(""),[d,f]=N.useState([]),[h,m]=N.useState(0),[p,x]=N.useState(0),[g,y]=N.useState("0"),[b,F]=N.useState(""),[j,R]=N.useState(!1),[E,S]=N.useState({}),B=C=>Math.round(C*100)/100,U=C=>Ma(C).toFixed(3),k=async C=>{if(!C)return 0;const Q=Ut(ot(Re,"inventory_batches"),qt("productId","==",C)),M=await bt(Q);let D=0;return M.forEach(z=>{const O=z.data();D=$N(D,Number(O.remaining||0))}),Ma(D)},T=async C=>{if(!C)return 0;const Q=await bt(ot(Re,"inventory_batches"));let M=0;return Q.forEach(D=>{const z=D.data();(z.productName||"").trim().toLowerCase()===C.trim().toLowerCase()&&(M=$N(M,Number(z.remaining||0)))}),Ma(M)};N.useEffect(()=>{(async()=>{const C=await bt(ot(Re,"products")),Q=[];C.forEach(M=>{const D=M.data();(D==null?void 0:D.active)!==!1&&Q.push({id:M.id,productName:D.name??D.productName??"(sin nombre)",price:Number(D.price??0),measurement:D.measurement??"(sin unidad)",category:D.category??"(sin categora)"})}),r(Q)})()},[]),N.useEffect(()=>{(async()=>{const C=await bt(ot(Re,"inventory_batches")),Q={};C.forEach(M=>{const D=M.data(),z=D.productId,O=Number(D.remaining||0);z&&(Q[z]=$N(Q[z]||0,O))}),Object.keys(Q).forEach(M=>Q[M]=Ma(Q[M])),S(Q)})()},[]),N.useEffect(()=>{(async()=>{const C=await bt(ot(Re,"users")),Q=[];C.forEach(M=>{const D=M.data();Q.push({id:M.id,email:D.email??"(sin email)",role:D.role??"USER"})}),s(Q)})()},[]);const L=async()=>{if(!a)return;const C=e.find(M=>M.id===a);if(!C)return;if(d.some(M=>M.productId===C.id)){o("");return}const Q=await k(C.id);f(M=>[...M,{productId:C.id,productName:C.productName,measurement:C.measurement,price:Number(C.price||0),stock:Q,qty:0,discount:0}]),o("")},Y=C=>{f(Q=>Q.filter(M=>M.productId!==C))},me=async(C,Q)=>{f(M=>M.map(D=>{if(D.productId!==C)return D;const z=(D.measurement||"").toLowerCase()!=="lb",O=Q===""?0:Number(Q),te=z?Math.max(0,Math.round(O)):Ma(O);return{...D,qty:te}}))},ae=(C,Q)=>{f(M=>M.map(D=>{if(D.productId!==C)return D;const z=Math.max(0,Math.floor(Number(Q||0)));return{...D,discount:z}}))},fe=N.useMemo(()=>{let C=0;for(const Q of d){const M=Number(Q.price||0)*Number(Q.qty||0),D=Math.max(0,M-Math.max(0,Number(Q.discount||0)));C+=D}return B(C)},[d]);N.useEffect(()=>{m(fe)},[fe]),N.useEffect(()=>{const C=Number(p)||0,Q=Number(h)||0;y((C-Q).toFixed(2))},[p,h]);const de=C=>{C.key===","&&(C.preventDefault(),C.target.value+=".")},Z=async()=>{if(d.length===0)return"Agrega al menos un producto.";for(const C of d){if(!C.qty||C.qty<=0)return`Cantidad invlida para "${C.productName}".`;const Q=await k(C.productId);if(!dv(Q,C.qty)){const M=await T(C.productName);if(dv(M,0)&&!dv(Q,0)){const D=await Uoe(C.productName,C.productId),z=await k(C.productId);if(!dv(z,C.qty))return`Stock insuficiente tras corregir ${D} lote(s) para "${C.productName}".`}else return`Stock insuficiente para "${C.productName}". Disponible: ${Q}`}}return null},xe=async C=>{var M,D;C.preventDefault(),F("");const Q=await Z();if(Q){F(" "+Q);return}try{R(!0);const z=[];for(const se of d){const we=se.qty,{allocations:q,avgUnitCost:Me,cogsAmount:re}=await Doe(Re,se.productName,we,!1),J=Number(se.price||0)*Number(we||0),K=Math.max(0,Number(se.discount||0)),ie=Math.max(0,J-K);z.push({productId:se.productId,productName:se.productName,measurement:se.measurement,unitPrice:Number(se.price||0),qty:we,discount:K,lineTotal:B(J),lineFinal:B(ie),allocations:q,avgUnitCost:Me,cogsAmount:re})}const O=z.reduce((se,we)=>se+we.lineFinal,0),te=z.reduce((se,we)=>se+Number(we.qty||0),0);await zr(ot(Re,"salesV2"),{id:Roe(),quantity:te,amount:O,amountCharged:O,amountReceived:Number(p)||0,change:g,clientName:A.trim(),timestamp:Vt.now(),date:l,userEmail:((M=n[0])==null?void 0:M.email)??"sin usuario",vendor:((D=n[0])==null?void 0:D.role)??"sin usuario",status:"FLOTANTE",items:z,itemsTotal:O}),F(" Venta registrada y asignada a inventario (FIFO)."),f([]),o(""),m(0),x(0),y("0"),u(""),c(or(new Date,"yyyy-MM-dd"))}catch(z){console.error(z),F(` ${(z==null?void 0:z.message)||"Error al registrar la venta."}`)}finally{R(!1)}},Be=N.useMemo(()=>new Set(d.map(C=>C.productId)),[d]),I=N.useMemo(()=>e.filter(C=>(E[C.id]||0)>0),[e,E]);return i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:xe,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl
                 p-4 sm:p-6 md:p-8
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:a,onChange:C=>o(C.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),I.map(C=>i.jsxs("option",{value:C.id,disabled:Be.has(C.id),title:Be.has(C.id)?"Ya est en la lista":`Disponible: ${U(E[C.id]||0)}`,children:[C.productName,"  ",C.measurement,"  C$ ",C.price," (disp:"," ",U(E[C.id]||0),")"]},C.id))]}),i.jsx("button",{type:"button",onClick:L,disabled:!a||Be.has(a),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:C=>c(C.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:A,onChange:C=>u(C.target.value),placeholder:"Opcional"})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:d.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):d.map(C=>{const Q=Number(C.price||0)*Number(C.qty||0),M=Math.max(0,Q-Math.max(0,Number(C.discount||0))),D=(C.measurement||"").toLowerCase()!=="lb",z=Ma(Number(C.stock)-Number(C.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[C.productName,"  ",C.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",B(C.price).toFixed(2)]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:z.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:D?1:.01,inputMode:D?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:C.qty===0?"":C.qty,onKeyDown:de,onChange:O=>me(C.productId,O.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:C.discount===0?"":C.discount,onChange:O=>ae(C.productId,O.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",B(M).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>Y(C.productId),title:"Quitar",children:""})})]},C.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${h.toFixed(2)}`,readOnly:!0,title:"Suma de (precio  cantidad  descuento) de cada producto."})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:p===0?"":p,onChange:C=>x(Number(C.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${g}`,readOnly:!0})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:d.length===0||j,children:j?"Guardando...":"Guardar venta"}),b&&i.jsx("p",{className:`text-sm mt-2 ${b.startsWith("")?"text-green-600":b.startsWith("")?"text-yellow-600":"text-red-600"}`,children:b})]}),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}var JM={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$j=li.createContext&&li.createContext(JM),Ooe=["attr","size","title"];function Moe(t,e){if(t==null)return{};var r=Qoe(t,e),n,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Qoe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function y2(){return y2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},y2.apply(this,arguments)}function zj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function b2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zj(Object(r),!0).forEach(function(n){Voe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Voe(t,e,r){return e=Hoe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hoe(t){var e=Koe(t,"string");return typeof e=="symbol"?e:e+""}function Koe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XM(t){return t&&t.map((e,r)=>li.createElement(e.tag,b2({key:r},e.attr),XM(e.child)))}function qoe(t){return e=>li.createElement(Goe,y2({attr:b2({},t.attr)},e),XM(t.child))}function Goe(t){var e=r=>{var{attr:n,size:s,title:a}=t,o=Moe(t,Ooe),l=s||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),li.createElement("svg",y2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:b2(b2({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&li.createElement("title",null,a),t.children)};return $j!==void 0?li.createElement($j.Consumer,null,r=>e(r)):e(JM)}function $oe(t){return qoe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Fc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx($oe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}const ma=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function zoe(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),{refreshKey:c,refresh:A}=Wl(),[u,d]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[f,h]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[m,p]=N.useState(""),[x,g]=N.useState(!1),[y,b]=N.useState(""),[F,j]=N.useState(0),[R,E]=N.useState(0),[S,B]=N.useState(0),[U,k]=N.useState(or(new Date,"yyyy-MM-dd")),[T,L]=N.useState(0),[Y,me]=N.useState(0),[ae,fe]=N.useState(""),[de,Z]=N.useState(null),[xe,Be]=N.useState(""),[I,C]=N.useState(0),[Q,M]=N.useState(0),[D,z]=N.useState(0),[O,te]=N.useState(""),[se,we]=N.useState(0),[q,Me]=N.useState(0),[re,J]=N.useState(!1),[K,ie]=N.useState(null);N.useEffect(()=>{(async()=>{a(!0),console.log("Refrescando...",c);const X=await bt(ot(Re,"products")),G=[];X.forEach(he=>{const Ce=he.data();G.push({id:he.id,name:Ce.name??Ce.productName??"(sin nombre)",category:Ce.category??"(sin categora)",measurement:Ce.measurement??"lb",price:Number(Ce.price??0)})}),e(G);const ye=Ut(ot(Re,"inventory_batches"),Hr("date","desc")),Oe=await bt(ye),_e=[];Oe.forEach(he=>{const Ce=he.data(),Ze=Ma(Number(Ce.quantity||0)),Te=Number(Ce.purchasePrice||0),Ge=Number(Ce.salePrice||0),at=Number((Ze*Te).toFixed(2)),wt=Number((Ze*Ge).toFixed(2));_e.push({id:he.id,productId:Ce.productId,productName:Ce.productName,category:Ce.category,unit:Ce.unit,quantity:Ze,remaining:Ma(Number(Ce.remaining||0)),purchasePrice:Te,salePrice:Ge,invoiceTotal:Ce.invoiceTotal!=null?Number(Ce.invoiceTotal):at,expectedTotal:Ce.expectedTotal!=null?Number(Ce.expectedTotal):wt,date:Ce.date,createdAt:Ce.createdAt,status:Ce.status,notes:Ce.notes,paidAmount:Number(Ce.paidAmount||0),paidAt:Ce.paidAt})}),n(_e),a(!1)})()},[c]),N.useEffect(()=>{const X=t.find(G=>G.id===y);X&&B(Number(X.price||0))},[y,t,c]),N.useEffect(()=>{L(Math.floor(F*R*100)/100)},[F,R,c]),N.useEffect(()=>{me(Math.floor(F*S*100)/100)},[F,S,c]);const pe=X=>{const G=(X||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(G)||G==="lb"},Ee=N.useMemo(()=>r.filter(X=>!(u&&X.date<u||f&&X.date>f||m&&X.productId!==m)),[r,u,f,m]),Ue=N.useMemo(()=>{const X=Ee.reduce((Te,Ge)=>Te+Number(Ge.invoiceTotal||0),0),G=Ee.reduce((Te,Ge)=>Te+Number(Ge.expectedTotal||0),0);let ye=0,Oe=0,_e=0,he=0;for(const Te of Ee)pe(Te.unit)?(ye+=Te.quantity,Oe+=Te.remaining):(_e+=Te.quantity,he+=Te.remaining);const Ce=Ee.reduce((Te,Ge)=>Te+Ge.quantity,0),Ze=Ee.reduce((Te,Ge)=>Te+Ge.remaining,0);return{lbsIng:ye,lbsRem:Oe,udsIng:_e,udsRem:he,qty:Ce,rem:Ze,totalFacturado:X,totalEsperado:G}},[Ee]),qe=async X=>{X.preventDefault();const G=t.find(ye=>ye.id===y);if(!G||F<=0||R<=0){l("Completa producto, cantidad y costo.");return}try{const ye=Ma(F),Oe=await Noe({productId:G.id,productName:G.name,category:G.category,unit:G.measurement,quantity:ye,purchasePrice:R,salePrice:S,invoiceTotal:T,expectedTotal:Y,date:U,notes:ae});n(_e=>[{id:Oe.id,productId:G.id,productName:G.name,category:G.category,unit:G.measurement,quantity:ye,remaining:ye,purchasePrice:R,salePrice:S,invoiceTotal:T,expectedTotal:Y,date:U,createdAt:Vt.now(),status:"PENDIENTE",notes:ae},..._e]),l(" Lote creado"),b(""),j(0),E(0),B(G.price||0),L(0),me(0),fe(""),g(!1)}catch(ye){console.error(ye),l(" Error al crear lote")}},$e=X=>{Z(X.id),Be(X.date),C(Ma(X.quantity)),M(X.purchasePrice),z(X.salePrice),te(X.notes||""),we(Number((X.quantity*X.purchasePrice).toFixed(2))),Me(Number((X.quantity*X.salePrice).toFixed(2)))},st=()=>{Z(null),Be(""),C(0),M(0),z(0),te(""),we(0),Me(0)};N.useEffect(()=>{de&&we(Math.floor(I*Q*100)/100)},[de,I,Q,c]),N.useEffect(()=>{de&&Me(Math.floor(I*D*100)/100)},[de,I,D,c]);const Se=async()=>{if(!de)return;const X=r.find(_e=>_e.id===de);if(!X)return;const G=Ma(X.quantity-X.remaining),ye=Math.max(0,Ma(I-G)),Oe=Ft(Re,"inventory_batches",de);await Fr(Oe,{date:xe,quantity:Ma(I),purchasePrice:Q,salePrice:D,invoiceTotal:se,expectedTotal:q,notes:O,remaining:ye}),n(_e=>_e.map(he=>he.id===de?{...he,date:xe,quantity:Ma(I),purchasePrice:Q,salePrice:D,invoiceTotal:se,expectedTotal:q,notes:O,remaining:ye}:he)),st(),l(" Lote actualizado")},ze=async X=>{confirm(`Eliminar el lote del ${X.date} (${X.productName})?`)&&(await mn(Ft(Re,"inventory_batches",X.id)),n(ye=>ye.filter(Oe=>Oe.id!==X.id)),l(" Lote eliminado"))},Ke=()=>{const X=(u?`Desde ${u}`:"Desde inicio")+"  "+(f?`Hasta ${f}`:"Hasta hoy"),G=Ee.map(_e=>{const he=Number(_e.invoiceTotal||0),Ce=Number(_e.expectedTotal||0);return`
      <tr>
        <td>${_e.date}</td>
        <td>${(_e.category||"").toUpperCase()}</td>
        <td>${_e.productName}</td>
        <td>${(_e.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${_e.quantity.toFixed(3)}</td>
        <td style="text-align:right">${_e.remaining.toFixed(3)}</td>
        <td style="text-align:right">${ma(_e.purchasePrice)}</td>
        <td style="text-align:right">${ma(_e.salePrice)}</td>
        <td style="text-align:right">${ma(he)}</td>
        <td style="text-align:right">${ma(Ce)}</td>
        <td>${_e.status}</td>
      </tr>`}).join(""),ye=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario por Lotes</title>
 <style>
  * { font-family: Arial, sans-serif; }
  h1 { margin: 0 0 4px; }
  .muted { color: #555; font-size: 12px; margin-bottom: 12px; }

  table { width: 100%; border-collapse: collapse; font-size: 12px; }
  th, td { border: 1px solid #ddd; padding: 6px; }
  th { background: #f5f5f5; text-align: left; }

  .totals {
    margin: 10px 0 16px;
    font-size: 12px;
    display: grid;
    grid-template-columns: repeat(2, max-content);
    column-gap: 32px;
    row-gap: 6px;
    align-items: center;
  }
  .totals span {
    margin: 0;
    white-space: nowrap;
  }

  @media print {
    @page { size: A4 landscape; margin: 15mm; }
    button { display: none; }
  }
</style>

</head>

<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario por Lotes</h1>
<div class="muted">${X}</div>
<div class="totals">
  <span><strong>Libras ingresadas:</strong> ${Ue.lbsIng.toFixed(3)}</span>
  <span><strong>Libras restantes:</strong> ${Ue.lbsRem.toFixed(3)}</span>

  <span><strong>Unidades ingresadas:</strong> ${Ue.udsIng.toFixed(3)}</span>
  <span><strong>Unidades restantes:</strong> ${Ue.udsRem.toFixed(3)}</span>

  <span><strong>Total esperado a ganar:</strong> ${ma(Ue.totalEsperado)}</span>
  <span><strong>Total facturado:</strong> ${ma(Ue.totalFacturado)}</span>
  <span><strong>Ganancia sin gastos:</strong> ${ma(Number((Ue.totalEsperado-Ue.totalFacturado).toFixed(2)))}</span>
</div>

  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Tipo</th>
        <th>Producto</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>
      ${G||'<tr><td colspan="11" style="text-align:center">Sin lotes</td></tr>'}
    </tbody>
  </table>
</body>
</html>`,Oe=window.open("","_blank");Oe&&(Oe.document.open(),Oe.document.write(ye),Oe.document.close())},be=async X=>{ie(X),J(!0)},le=async()=>{if(!K)return;const X=K;try{await zM(X.id);const G=Ft(Re,"inventory_batches",X.id);await Fr(G,{remaining:0});const ye={date:X.date,productName:X.productName,quantity:X.quantity,amount:Number((X.expectedTotal??X.salePrice*X.quantity).toFixed(2)),allocations:[{batchId:X.id,qty:X.quantity,unitCost:X.purchasePrice,lineCost:Number((X.purchasePrice*X.quantity).toFixed(2))}],avgUnitCost:X.purchasePrice,measurement:X.unit,createdAt:Vt.now(),autoGeneratedFromInventory:!0};await zr(ot(Re,"salesV2"),ye),n(Oe=>Oe.map(_e=>_e.id===X.id?{..._e,status:"PAGADO",remaining:0}:_e)),l(" Inventario pagado y reflejado como venta")}catch(G){console.error(G),l(" Error al pagar inventario")}finally{J(!1),ie(null)}},je=()=>{J(!1),ie(null)};return i.jsxs("div",{className:"max-w-6xl mx-auto shadows-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario (Pollo)"}),i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>g(!0),children:"Crear Lote"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:X=>d(X.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:X=>h(X.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:X=>p(X.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(X=>i.jsxs("option",{value:X.id,children:[X.name,"  ",X.category]},X.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),h(""),p("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:Ke,children:"Imprimir PDF"}),i.jsx("div",{className:"ml-auto",children:i.jsx(Fc,{onClick:()=>A(),loading:s})})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Ue.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Ue.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," C$"," ",Ue.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Ue.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Ue.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",Ue.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(Ue.totalEsperado-Ue.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",Ee.length.toLocaleString()]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Total ganancia"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Ee.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes"})}):Ee.map(X=>{const G=de===X.id,ye=Number(X.invoiceTotal||0),Oe=Number(X.expectedTotal||0);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:G?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:xe,onChange:_e=>Be(_e.target.value)}):X.date}),i.jsx("td",{className:"p-2 border",children:X.category.toUpperCase()}),i.jsx("td",{className:"p-2 border",children:X.productName}),i.jsx("td",{className:"p-2 border",children:X.unit.toUpperCase()}),i.jsx("td",{className:"p-2 border",children:G?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(I)?"":I,onChange:_e=>{const he=_e.target.value.replace(",","."),Ce=parseFloat(he),Ze=Number.isFinite(Ce)?parseFloat(Ce.toFixed(3)):0;C(Math.max(0,Ze))}}):X.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:G?X.remaining:X.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:G?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Q)?"":Q,onChange:_e=>{const he=_e.target.value.replace(",","."),Ce=parseFloat(he),Ze=Number.isFinite(Ce)?parseFloat(Ce.toFixed(2)):0;M(Math.max(0,Ze))}}):ma(X.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:G?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(D)?"":D,onChange:_e=>{const he=_e.target.value.replace(",","."),Ce=parseFloat(he),Ze=Number.isFinite(Ce)?parseFloat(Ce.toFixed(2)):0;z(Math.max(0,Ze))}}):ma(X.salePrice)}),i.jsx("td",{className:"p-2 border",children:ma(G?se:ye)}),i.jsx("td",{className:"p-2 border",children:ma(G?q:Oe)}),i.jsx("td",{className:"p-2 border",children:ma(G?q-se:Oe-ye)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${X.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:X.status})}),i.jsx("td",{className:"flex space-x-2 justify-center",children:G?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Se,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:st,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[X.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>be(X),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>$e(X),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ze(X),children:"Borrar"})]})})]},X.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),x&&wh.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>g(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Lote"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>g(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:qe,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:y,onChange:X=>b(X.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),t.map(X=>i.jsxs("option",{value:X.id,children:[X.name,"  ",X.category,"  ",X.measurement,"  Precio:"," ",ma(X.price)]},X.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:U,onChange:X=>k(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (Lo que esta ingresando)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:F===0?"":F,onChange:X=>{const G=X.target.value.replace(",","."),ye=parseFloat(G),Oe=Number.isFinite(ye)?parseFloat(ye.toFixed(3)):0;j(Oe)},disabled:!y,placeholder:y?"":"Selecciona un producto primero",title:y?"":"Selecciona un producto para habilitar"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (compra)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:R===0?"":R,onChange:X=>{const G=X.target.value.replace(",","."),ye=parseFloat(G),Oe=Number.isFinite(ye)?parseFloat(ye.toFixed(2)):0;E(Oe)},disabled:!y,placeholder:y?"":"Selecciona un producto primero",title:y?"":"Selecciona un producto para habilitar"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (venta)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:S===0?"":S,onChange:X=>{const G=X.target.value.replace(",","."),ye=parseFloat(G),Oe=Number.isFinite(ye)?parseFloat(ye.toFixed(2)):0;B(Oe)},disabled:!y,placeholder:y?"":"Selecciona un producto primero",title:y?"":"Selecciona un producto para habilitar"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:ma(T),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:ma(Y),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Notas"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ae,onChange:X=>fe(X.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>g(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),re&&K&&wh.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:je}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este inventario?",i.jsx("br",{}),i.jsx("strong",{children:K.productName})," "," ",K.quantity," ",K.unit,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:le,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:je,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const zc=t=>`C$${(Number(t)||0).toFixed(2)}`;function Woe(){const t=oZ(new Date),[e,r]=N.useState(or(t,"yyyy-MM")),[n,s]=N.useState([]),[a,o]=N.useState(!1),[l,c]=N.useState(""),A=N.useRef(null),u=N.useMemo(()=>{const[x,g]=e.split("-").map(F=>parseInt(F,10)),y=or(Ec(new Date(x,g-1,1)),"yyyy-MM-dd"),b=or(_c(new Date(x,g-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),d=async()=>{o(!0);try{const x=await Coe(u.from,u.to),g=[];for(const y of x){const b=Ft(Re,"inventory_batches",y.batchId),F=await za(b);if(!F.exists())continue;const j=F.data();g.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:j.status??"PENDIENTE",purchasePrice:Number(j.purchasePrice||0),salePrice:Number(j.salePrice||0),supplier:j.supplier})}s(g)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};N.useEffect(()=>{d()},[e]);const f=async x=>{confirm("Marcar este lote como PAGADO?")&&(await zM(x),s(y=>y.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=N.useMemo(()=>{const x=n.reduce((F,j)=>F+j.soldQty,0),g=n.reduce((F,j)=>F+j.soldAmount,0),y=n.reduce((F,j)=>F+j.soldQty*j.purchasePrice,0),b=g-y;return{q:x,amt:g,cogs:y,profit:b}},[n]),m=N.useMemo(()=>{const x=new Map;for(const g of n){const y=g.productName||"(sin nombre)";x.has(y)||x.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(y);b.qty+=g.soldQty,b.revenue+=g.soldAmount;const F=g.soldQty*g.purchasePrice;b.cogs+=F,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((g,y)=>g.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!A.current)return;const x=A.current;x.classList.add("force-pdf-colors");try{const[{default:g},{jsPDF:y}]=await Promise.all([mA(()=>Promise.resolve().then(()=>$S),void 0),mA(()=>Promise.resolve().then(()=>NE),void 0)]),F=(await g(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),j=new y("p","mm","a4"),R=190,E=j.getImageProperties(F),S=R,B=E.height*S/E.width;j.addImage(F,"PNG",10,10,S,B),j.save(`liquidaciones_${e}.pdf`)}catch(g){console.error(g),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:d,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:A,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",zc(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",zc(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",zc(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const g=x.soldQty*x.purchasePrice,y=x.soldAmount-g;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:zc(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:zc(g)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:zc(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>f(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:zc(x.revenue)}),i.jsx("td",{className:"p-2 border",children:zc(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:zc(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Wc=t=>`C$${Number(t??0).toFixed(2)}`,Joe=()=>or(new Date,"yyyy-MM-dd"),hv=t=>Number(t||0).toFixed(3);function Xoe(){const[t,e]=N.useState(()=>{const j=new Date,R=new Date(j.getFullYear(),j.getMonth(),1);return or(R,"yyyy-MM-dd")}),[r,n]=N.useState(Joe()),[s,a]=N.useState(!0),[o,l]=N.useState([]),[c,A]=N.useState([]),{refreshKey:u,refresh:d}=Wl();N.useEffect(()=>{(async()=>{a(!0);const R=Ut(ot(Re,"salesV2"),qt("date",">=",t),qt("date","<=",r)),E=await bt(R),S=[];E.forEach(T=>{const L=T.data(),Y=L.date??"";if(Array.isArray(L.items)&&L.items.length>0){L.items.forEach((me,ae)=>{const fe=String(me.productName??"(sin nombre)"),de=Number(me.qty??0),Z=Number(me.lineFinal??0)||Math.max(0,Number(me.unitPrice||0)*de-Number(me.discount||0));S.push({id:`${T.id}#${ae}`,date:Y,productName:fe,quantity:de,amount:Z,allocations:Array.isArray(me.allocations)?me.allocations:L.allocations,avgUnitCost:Number(me.avgUnitCost??L.avgUnitCost??0),measurement:me.measurement??L.measurement??""})});return}S.push({id:T.id,date:Y,productName:L.productName??"(sin nombre)",quantity:Number(L.quantity??0),amount:Number(L.amount??L.amountCharged??0),allocations:Array.isArray(L.allocations)?L.allocations:[],avgUnitCost:Number(L.avgUnitCost??0),measurement:L.measurement??""})}),l(S);const B=Ut(ot(Re,"expenses"),qt("date",">=",t),qt("date","<=",r)),U=await bt(B),k=[];U.forEach(T=>{const L=T.data();k.push({id:T.id,date:L.date??"",category:L.category??"(sin categora)",description:L.description??"",amount:Number(L.amount??0),status:L.status??"PAGADO",createdAt:L.createdAt})}),A(k),a(!1)})()},[t,r,u]);const f=N.useMemo(()=>{const j=o.reduce((U,k)=>U+(k.amount||0),0);let R=0;o.forEach(U=>{var k;(k=U.allocations)!=null&&k.length?R+=U.allocations.reduce((T,L)=>T+Number(L.lineCost||0),0):U.avgUnitCost&&U.quantity&&(R+=Number(U.avgUnitCost)*Number(U.quantity))});const E=j-R,S=c.reduce((U,k)=>U+(k.amount||0),0),B=E-S;return{revenue:j,cogsReal:R,grossProfit:E,expensesSum:S,netProfit:B}},[o,c]),h=j=>String(j??"").toLowerCase().trim(),m=j=>Number(j.qty??j.quantity??0),p=j=>["lb","lbs","libra","libras"].includes(h(j)),x=j=>["unidad","unidades","ud","uds","pieza","piezas"].includes(h(j)),g=N.useMemo(()=>o.reduce((j,R)=>p(R.measurement)?j+m(R):j,0),[o]),y=N.useMemo(()=>o.reduce((j,R)=>x(R.measurement)?j+m(R):j,0),[o]),b=N.useMemo(()=>{var R;const j=new Map;for(const E of o){const S=E.productName||"(sin nombre)";j.has(S)||j.set(S,{productName:S,units:0,revenue:0,cogs:0,profit:0,firstDate:E.date||"",lastDate:E.date||""});const B=j.get(S);B.units+=Number(E.quantity||0),B.revenue+=Number(E.amount||0),(!B.firstDate||E.date<(B.firstDate||E.date))&&(B.firstDate=E.date),(!B.lastDate||E.date>(B.lastDate||E.date))&&(B.lastDate=E.date);let U=0;(R=E.allocations)!=null&&R.length?U=E.allocations.reduce((k,T)=>k+Number(T.lineCost||0),0):E.avgUnitCost&&(U=Number(E.avgUnitCost)*Number(E.quantity||0)),B.cogs+=U,B.profit=B.revenue-B.cogs}return Array.from(j.values()).sort((E,S)=>E.productName.localeCompare(S.productName))},[o]),F=N.useMemo(()=>[...b].sort((j,R)=>R.units-j.units).slice(0,3).map((j,R)=>({idx:R+1,name:j.productName,units:j.units})),[b]);return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl ",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas: Ingresos y Egresos"}),i.jsx(Fc,{onClick:d,loading:s})]}),i.jsxs("div",{className:"flex flex-wrap items-end gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:t,onChange:j=>e(j.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:r,onChange:j=>n(j.target.value)})]})]}),s?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-3 rounded-2xl shadow-lg p-4 bg-gray-50",children:[i.jsx(tp,{title:"Ventas",value:Wc(f.revenue)}),i.jsx(tp,{title:"Costo",value:Wc(f.cogsReal)}),i.jsx(tp,{title:"Ganancia Bruta",value:Wc(f.grossProfit),positive:!0}),i.jsx(tp,{title:"Gastos",value:Wc(f.expensesSum)}),i.jsx(tp,{title:"Ganancia Neta",value:Wc(f.netProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-4 bg-gray-50",children:[i.jsx(Wj,{title:"Libras Vendidas",value:hv(g)}),i.jsx(Wj,{title:"Unidades Vendidas",value:hv(y)}),i.jsx(Yoe,{title:"Productos ms vendidos",items:F.map(j=>({key:`${j.idx}`,label:`${j.idx}. ${j.name}`,value:`(${hv(j.units)})`}))})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Fechas"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Ingreso"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[b.map(j=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName}),i.jsx("td",{className:"border p-1",children:j.firstDate&&j.lastDate?j.firstDate===j.lastDate?j.firstDate:`${j.firstDate}  ${j.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:hv(j.units)}),i.jsx("td",{className:"border p-1",children:Wc(j.revenue)}),i.jsx("td",{className:"border p-1",children:Wc(j.cogs)}),i.jsx("td",{className:`border p-1 ${j.profit>=0?"text-green-700":"text-red-700"}`,children:Wc(j.profit)})]},j.productName)),b.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(j=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.date}),i.jsx("td",{className:"border p-1",children:j.category}),i.jsx("td",{className:"border p-1",children:j.description}),i.jsx("td",{className:"border p-1",children:Wc(j.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${j.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:j.status})})]},j.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})]})]})}function tp({title:t,value:e,positive:r}){return i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"text-[17px] text-gray-500",children:t}),i.jsx("div",{className:`text-[30px] font-bold ${r?"text-green-700":""}`,children:e})]})}function Wj({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("div",{className:"text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[20px] font-semibold",children:e})]})}function Yoe({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}const Jj=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],fv=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Zoe(){const[t,e]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[r,n]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[s,a]=N.useState(or(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,j]=N.useState(""),[R,E]=N.useState(null),[S,B]=N.useState(""),[U,k]=N.useState(""),[T,L]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[de,Z]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const O=Ut(ot(Re,"expenses"),Hr("date","desc")),te=await bt(O),se=[];te.forEach(we=>{const q=we.data();se.push({id:we.id,date:q.date||or(new Date,"yyyy-MM-dd"),category:q.category||"",description:q.description||"",amount:Number(q.amount||0),status:q.status||"PENDIENTE",notes:q.notes||"",createdAt:q.createdAt??Vt.now()})}),g(se)}catch(O){console.error(O),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const xe=N.useMemo(()=>x.filter(O=>!(t&&O.date<t||r&&O.date>r)),[x,t,r]),Be=N.useMemo(()=>{const O=xe.reduce((we,q)=>we+(q.amount||0),0),te=xe.filter(we=>we.status==="PAGADO").reduce((we,q)=>we+(q.amount||0),0),se=O-te;return{total:O,pagado:te,pendiente:se}},[xe]),I=()=>{a(or(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},C=async O=>{if(O.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!u||u<=0){j("Ingresa un monto vlido.");return}try{const te=await zr(ot(Re,"expenses"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Vt.now()});g(se=>[{id:te.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Vt.now()},...se]),I(),j(" Gasto registrado")}catch(te){console.error(te),j(" Error al guardar gasto")}},Q=O=>{E(O.id),B(O.date),k(O.category||""),L(O.description||""),me(Number(O.amount||0)),fe(O.status||"PENDIENTE"),Z(O.notes||"")},M=()=>{E(null),B(""),k(""),L(""),me(0),fe("PENDIENTE"),Z("")},D=async()=>{if(R){if(!U){j("Selecciona una categora.");return}if(!T.trim()){j("Ingresa una descripcin.");return}if(!Y||Y<=0){j("Ingresa un monto vlido.");return}try{await Fr(Ft(Re,"expenses",R),{date:S,category:U,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:de||""}),g(O=>O.map(te=>te.id===R?{...te,date:S,category:U,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:de||""}:te)),M(),j(" Gasto actualizado")}catch(O){console.error(O),j(" Error al actualizar gasto")}}},z=async O=>{confirm(`Eliminar el gasto "${O.description}"?`)&&(await mn(Ft(Re,"expenses",O.id)),g(se=>se.filter(we=>we.id!==O.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Pollo)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:O=>e(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:O=>n(O.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",fv(Be.total)]}),i.jsxs("div",{children:["Pagado: ",fv(Be.pagado)]}),i.jsxs("div",{children:["Pendiente: ",fv(Be.pendiente)]})]})]}),i.jsxs("form",{onSubmit:C,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:O=>a(O.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:O=>l(O.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),Jj.map(O=>i.jsx("option",{value:O,children:O},O))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:O=>A(O.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:O=>d(Math.max(0,Number(O.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:O=>h(O.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:O=>p(O.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):xe.slice().sort((O,te)=>O.date.localeCompare(te.date)).map(O=>{const te=R===O.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:se=>B(se.target.value)}):O.date}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("select",{className:"w-full border p-1 rounded",value:U,onChange:se=>k(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),Jj.map(se=>i.jsx("option",{value:se,children:se},se))]}):O.category||""}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>L(se.target.value)}):i.jsx("span",{title:O.description,children:O.description.length>40?O.description.slice(0,40)+"":O.description})}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Y)?"":Y,onChange:se=>me(Math.max(0,Number(se.target.value||0)))}):fv(O.amount)}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>fe(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${O.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:O.status})}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:de,onChange:se=>Z(se.target.value),maxLength:500}):i.jsx("span",{title:O.notes||"",children:(O.notes||"").length>40?(O.notes||"").slice(0,40)+"":O.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:te?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:D,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:M,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Q(O),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>z(O),children:"Borrar"})]})})})]},O.id)})})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F})]})}function N2(t){return(t||"").trim().toLowerCase()}async function YM(){const t=await bt(ot(Re,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),s=N2(n.name??n.productName);s&&e.set(s,r.id)}),e}async function ele(t=!1){const e=await YM(),r=await bt(ot(Re,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const s of r.docs){n.checked++;const a=s.data(),o=N2(a.productName);if(!o){n.missingName++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,status:"withoutMatch"});continue}if(a.productId===l){n.alreadyOk++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,newProductId:l,status:"alreadyOk"});continue}t||await Fr(Ft(Re,"inventory_batches",s.id),{productId:l}),n.fixed++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function tle(t,e=!1){const r=N2(t),s=(await YM()).get(r);if(!s)throw new Error(`No existe un producto activo con nombre "${t}".`);const a=await bt(ot(Re,"inventory_batches"));let o=0;for(const l of a.docs){const c=l.data();N2(c.productName)===r&&c.productId!==s&&(e||await Fr(Ft(Re,"inventory_batches",l.id),{productId:s}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function rle(){const[t,e]=N.useState(!1),[r,n]=N.useState(""),s=async()=>{try{e(!0),n("");const c=await ele(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[a,o]=N.useState(""),l=async()=>{if(!a.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await tle(a.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${a}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:s,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:a,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const zn=t=>`C$ ${Number(t??0).toFixed(2)}`,Td=t=>Number(t??0).toFixed(3);async function nle(t){const e=new Set;for(const n of t)for(const s of n.batches||[]){const a=(s.batchId||s.id||"").trim();if(!a)continue;(s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)&&e.add(a)}if(e.size===0)return t;const r=new Map;return await Promise.all(Array.from(e).map(async n=>{try{const s=await za(Ft(Re,"inventory_batches",n));if(s.exists()){const a=s.data();r.set(n,Number(a.purchasePrice||0))}}catch{}})),t.map(n=>({...n,batches:(n.batches||[]).map(s=>{if((s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)){const a=(s.batchId||s.id||"").trim(),o=a?r.get(a):void 0;if(o!==void 0)return{...s,purchasePrice:o}}return s})}))}function zN(t){var p,x;const e=t.batches||[],r=t.expenses||[],n=t.adjustments||[],s=Number(((p=t.totals)==null?void 0:p.lbs)??t.totalLbs??0),a=Number(((x=t.totals)==null?void 0:x.units)??t.totalUnits??0);let o=0,l=0;for(const g of e){const y=Number(g.quantity??0);let b=g.expectedTotal!==void 0&&g.expectedTotal!==null?Number(g.expectedTotal):y*Number(g.salePrice??0);isFinite(b)||(b=0);let F=y*Number(g.purchasePrice??Number.NaN);isFinite(F)||(F=g.invoiceTotal!==void 0&&g.invoiceTotal!==null?Number(g.invoiceTotal):0),o+=b,l+=F}const c=r.reduce((g,y)=>g+Number(y.amount||0),0),A=n.filter(g=>g.type==="DEBITO").reduce((g,y)=>g+Number(y.amount||0),0),u=n.filter(g=>g.type==="CREDITO").reduce((g,y)=>g+Number(y.amount||0),0),d=t.totalDebits!==void 0?Number(t.totalDebits):A,f=t.totalCredits!==void 0?Number(t.totalCredits):u,h=o-l,m=o-c-d+f;return{lbs:s,units:a,expectedSum:o,invoicedSum:l,expenses:c,debits:d,credits:f,grossProfit:h,finalAmount:m}}function sle(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(null),o=N.useRef(null);N.useEffect(()=>{(async()=>{n(!0);const u=Ut(ot(Re,"invoices"),Hr("date","desc")),d=await bt(u),f=[];d.forEach(m=>{const p=m.data();f.push({id:m.id,...p,batches:p.batches||[],expenses:p.expenses||[],adjustments:p.adjustments||[],totals:p.totals||{lbs:p.totalLbs||0,units:p.totalUnits||0,amount:p.totalAmount||0,expenses:p.totalExpenses||0,finalAmount:p.finalAmount||0,invoiceTotal:p.invoiceTotal||0},totalDebits:p.totalDebits||0,totalCredits:p.totalCredits||0})});const h=await nle(f);e(h),n(!1)})()},[]);const l=async u=>{const d=u.status==="PAGADA"?"PENDIENTE":"PAGADA";await Fr(Ft(Re,"invoices",u.id),{status:d}),e(f=>f.map(h=>h.id===u.id?{...h,status:d}:h)),(s==null?void 0:s.id)===u.id&&a({...u,status:d})},c=async u=>{if(window.confirm(`Eliminar factura del ${u.date}?`))try{const d=Ft(Re,"invoices",u.id),f=await za(d),h=f.exists()?f.data():null,m=Gh(Re),p=(h==null?void 0:h.batches)||[];for(const x of p){const g=x.batchId||x.id;if(!g)continue;const y=Ft(Re,"inventory_batches",g);m.update(y,{invoiceId:null,invoiceNumber:null,invoiceTotal:null})}m.delete(d),await m.commit(),e(x=>x.filter(g=>g.id!==u.id)),(s==null?void 0:s.id)===u.id&&a(null)}catch(d){console.error(d),alert("No se pudo eliminar la factura por completo.")}},A=async()=>{if(!o.current||!s)return;const u=o.current,d=await $h(u,{backgroundColor:"#ffffff",onclone:x=>{const g=x.body;g.style.background="#ffffff",g.querySelectorAll("*").forEach(y=>{const b=x.defaultView.getComputedStyle(y);b.boxShadow&&b.boxShadow!=="none"&&(y.style.boxShadow="none")})},scale:2}),f=d.toDataURL("image/png"),h=new rr("p","mm","a4"),m=h.internal.pageSize.getWidth(),p=d.height*m/d.width;h.addImage(f,"PNG",0,0,m,p),h.save(`factura_${s.number||s.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Facturacin"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4",children:i.jsxs("table",{className:"min-w-full w-full- text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"N factura"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Unidades"}),i.jsx("th",{className:"p-2 border",children:"Facturado"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),i.jsx("th",{className:"p-2 border",children:"Gastos"}),i.jsx("th",{className:"p-2 border",children:"Dbitos"}),i.jsx("th",{className:"p-2 border",children:"Crditos"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Sin facturas"})}):t.map(u=>{const d=zN(u);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.date}),i.jsx("td",{className:"p-2 border",children:u.number||""}),i.jsx("td",{className:"p-2 border",children:u.description||""}),i.jsx("td",{className:"p-2 border",children:Td(d.lbs)}),i.jsx("td",{className:"p-2 border",children:Td(d.units)}),i.jsx("td",{className:"p-2 border",children:zn(d.invoicedSum)}),i.jsx("td",{className:"p-2 border",children:zn(d.expectedSum)}),i.jsx("td",{className:"p-2 border",children:zn(d.expenses)}),i.jsx("td",{className:"p-2 border",children:zn(d.debits)}),i.jsx("td",{className:"p-2 border",children:zn(d.credits)}),i.jsx("td",{className:"p-2 border",children:zn(d.finalAmount)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:u.status})}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>a(u),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>l(u),children:u.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>c(u),children:"Eliminar"})]})})]},u.id)})})]})}),s&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>a(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const u=zN(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras:"})," ",Td(u.lbs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades:"})," ",Td(u.units)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Facturado:"})," ",zn(u.invoicedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Ventas (Esperado):"})," ",zn(u.expectedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia Bruta:"})," ",zn(u.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",zn(u.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",zn(u.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",zn(u.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Lotes"}),i.jsxs("table",{className:"min-w-full text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:(s.batches||[]).map((u,d)=>{const f=Number(u.quantity??0),h=u.expectedTotal!==void 0&&u.expectedTotal!==null?Number(u.expectedTotal):f*Number(u.salePrice??0);let m=f*Number(u.purchasePrice??Number.NaN);isFinite(m)||(m=u.invoiceTotal!==void 0&&u.invoiceTotal!==null?Number(u.invoiceTotal):0);const p=h-m;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.productName||"(sin nombre)"}),i.jsx("td",{className:"p-2 border",children:(u.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Td(u.quantity)}),i.jsx("td",{className:"p-2 border",children:zn(u.salePrice)}),i.jsx("td",{className:"p-2 border",children:zn(m)}),i.jsx("td",{className:"p-2 border",children:zn(h)}),i.jsx("td",{className:"p-2 border",children:zn(p)})]},d)})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((u,d)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.date}),i.jsx("td",{className:"p-2 border",children:u.description}),i.jsx("td",{className:"p-2 border",children:zn(u.amount)})]},d)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin gastos"})})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Fecha"})]})}),i.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((u,d)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.description}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:u.type})}),i.jsx("td",{className:"p-2 border",children:zn(u.amount)}),i.jsx("td",{className:"p-2 border",children:s.date})]},d)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin cargos extras"})})})]}),(()=>{const u=zN(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:Td(u.lbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:Td(u.units)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:zn(u.invoicedSum)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:zn(u.expectedSum)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:zn(u.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:zn(u.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:zn(u.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:zn(u.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Monto final (esperado  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:zn(u.finalAmount)})]})})]})})()]})]})}const fo=t=>`C$${Number(t||0).toFixed(2)}`,Ff=t=>Number(t||0).toFixed(3),ale=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),WN=()=>{const t=new Date;return or(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},mv=()=>or(new Date,"yyyy-MM-dd");function ile({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,a]=N.useState(WN()),[o,l]=N.useState(mv()),[c,A]=N.useState(""),u=N.useMemo(()=>{const X=new Map;return n.forEach(G=>X.set(G.productId,{id:G.productId,name:G.productName})),Array.from(X.values()).sort((G,ye)=>G.name.localeCompare(ye.name))},[n]),d=N.useMemo(()=>n.filter(X=>!(s&&X.date<s||o&&X.date>o||c&&X.productId!==c)),[n,s,o,c]),[f,h]=N.useState(mv()),[m,p]=N.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,g]=N.useState(""),[y,b]=N.useState(()=>d.map(X=>X.id));N.useEffect(()=>{b(X=>X.filter(G=>d.some(ye=>ye.id===G)))},[d]);const[F,j]=N.useState([]),[R,E]=N.useState([]),[S,B]=N.useState(!1),[U,k]=N.useState(WN()),[T,L]=N.useState(mv());N.useEffect(()=>{(async()=>{try{B(!0);const X=Ut(ot(Re,"expenses"),Hr("date","desc")),G=await bt(X),ye=[];G.forEach(Oe=>{const _e=Oe.data();ye.push({id:Oe.id,date:_e.date,description:_e.description,amount:Number(_e.amount||0)})}),j(ye)}catch(X){console.error(X)}finally{B(!1)}})()},[]);const Y=N.useMemo(()=>F.filter(X=>!(!X.date||U&&X.date<U||T&&X.date>T)),[F,U,T]),[me,ae]=N.useState([]),[fe,de]=N.useState(!1),[Z,xe]=N.useState(""),[Be,I]=N.useState("DEBITO"),[C,Q]=N.useState(""),M=()=>{const X=Number(C);!Z.trim()||!isFinite(X)||X<=0||(ae(G=>[...G,{id:`${Date.now()}_${G.length+1}`,description:Z.trim(),type:Be,amount:Number(X.toFixed(2))}]),xe(""),Q(""))},[D,z]=N.useState(null),[O,te]=N.useState(""),[se,we]=N.useState("DEBITO"),[q,Me]=N.useState(""),re=X=>{z(X.id),te(X.description),we(X.type),Me(X.amount.toFixed(2))},J=()=>{z(null),te(""),we("DEBITO"),Me("")},K=()=>{if(!D)return;const X=Number(q);!isFinite(X)||X<=0||(ae(G=>G.map(ye=>ye.id===D?{...ye,description:O.trim(),type:se,amount:Number(X.toFixed(2))}:ye)),J())},ie=X=>{ae(G=>G.filter(ye=>ye.id!==X)),D===X&&J()},pe=(X,G)=>{b(ye=>G?[...new Set([...ye,X])]:ye.filter(Oe=>Oe!==X))},Ee=X=>{b(X?d.map(G=>G.id):[])},Ue=(X,G)=>{E(ye=>G?[...new Set([...ye,X])]:ye.filter(Oe=>Oe!==X))},qe=N.useMemo(()=>d.filter(X=>y.includes(X.id)),[d,y]),$e=N.useMemo(()=>me.filter(X=>X.type==="DEBITO").reduce((X,G)=>X+G.amount,0),[me]),st=N.useMemo(()=>me.filter(X=>X.type==="CREDITO").reduce((X,G)=>X+G.amount,0),[me]),Se=N.useMemo(()=>{let X=0,G=0,ye=0,Oe=0;for(const Ce of qe){ale(Ce.unit)?X+=Number(Ce.quantity||0):G+=Number(Ce.quantity||0);const Ze=Ce.expectedTotal??Number((Number(Ce.quantity||0)*Number(Ce.salePrice||0)).toFixed(2)),Te=Ce.invoiceTotal!==void 0&&Ce.invoiceTotal!==null?Number(Ce.invoiceTotal):Number((Number(Ce.quantity||0)*Number(Ce.purchasePrice||0)).toFixed(2));ye+=Number(Ze||0),Oe+=Number(Te||0)}const _e=Y.filter(Ce=>R.includes(Ce.id)).reduce((Ce,Ze)=>Ce+Number(Ze.amount||0),0),he=ye-_e-$e+st;return{totalLbs:X,totalUnits:G,totalExpected:Number(ye.toFixed(2)),totalInvoiced:Number(Oe.toFixed(2)),totalGastos:Number(_e.toFixed(2)),debits:Number($e.toFixed(2)),credits:Number(st.toFixed(2)),finalAmount:Number(he.toFixed(2)),grossProfit:Number((ye-Oe).toFixed(2))}},[qe,Y,R,$e,st]),[ze,Ke]=N.useState(!1),[be,le]=N.useState(""),je=async()=>{if(le(""),qe.length===0){le("Selecciona al menos 1 lote pagado.");return}try{Ke(!0);const X={number:m.trim(),date:f,description:x.trim(),status:"PENDIENTE",createdAt:Vt.now(),totalLbs:Number(Ff(Se.totalLbs)),totalUnits:Number(Ff(Se.totalUnits)),totalAmount:Se.totalExpected,invoiceTotal:Se.totalInvoiced,totalExpenses:Se.totalGastos,totalDebits:Se.debits,totalCredits:Se.credits,finalAmount:Se.finalAmount,batches:qe.map(G=>{var ye;return{id:G.id,productId:G.productId,productName:G.productName,unit:G.unit,quantity:Number(Ff(G.quantity)),salePrice:Number(Number(G.salePrice||0).toFixed(2)),purchasePrice:Number(Number(G.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(G.quantity||0)*Number(G.salePrice||0)).toFixed(2)),invoiceTotal:G.invoiceTotal!==void 0&&G.invoiceTotal!==null?Number(G.invoiceTotal):Number((Number(G.quantity||0)*Number(G.purchasePrice||0)).toFixed(2)),batchDate:G.date,paidAt:(ye=G.paidAt)!=null&&ye.toDate?or(G.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:Y.filter(G=>R.includes(G.id)).map(G=>({id:G.id,date:G.date||null,description:G.description||"",amount:Number(Number(G.amount||0).toFixed(2))})),adjustments:me.map(G=>({id:G.id,description:G.description,type:G.type,amount:Number(G.amount.toFixed(2))}))};await zr(ot(Re,"invoices"),X),le(" Factura creada."),r()}catch(X){console.error(X),le(` Error al crear factura: ${(X==null?void 0:X.message)||"desconocido"}`)}finally{Ke(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:f,onChange:X=>h(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:X=>p(X.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:X=>g(X.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:X=>a(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:X=>l(X.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:X=>A(X.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),u.map(X=>i.jsx("option",{value:X.id,children:X.name},X.id))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{a(WN()),l(mv()),A("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:d.length>0&&y.length===d.length,onChange:X=>Ee(X.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),d.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha lote"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),i.jsx("tbody",{children:d.map(X=>{var he;const G=y.includes(X.id),ye=X.expectedTotal??Number((Number(X.quantity||0)*Number(X.salePrice||0)).toFixed(2)),Oe=X.invoiceTotal!==void 0&&X.invoiceTotal!==null?Number(X.invoiceTotal):Number((Number(X.quantity||0)*Number(X.purchasePrice||0)).toFixed(2)),_e=ye-Oe;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:G,onChange:Ce=>pe(X.id,Ce.target.checked)})}),i.jsx("td",{className:"p-2 border",children:X.date}),i.jsx("td",{className:"p-2 border",children:X.productName}),i.jsx("td",{className:"p-2 border",children:(X.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Ff(X.quantity)}),i.jsx("td",{className:"p-2 border",children:fo(X.salePrice)}),i.jsx("td",{className:"p-2 border",children:fo(Oe)}),i.jsx("td",{className:"p-2 border",children:fo(ye)}),i.jsx("td",{className:"p-2 border",children:fo(_e)}),i.jsx("td",{className:"p-2 border",children:(he=X.paidAt)!=null&&he.toDate?or(X.paidAt.toDate(),"yyyy-MM-dd"):""})]},X.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),S&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:U,onChange:X=>k(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:T,onChange:X=>L(X.target.value)})]})]})]}),Y.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:Y.map(X=>{const G=R.includes(X.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:G,onChange:ye=>Ue(X.id,ye.target.checked)})}),i.jsx("td",{className:"p-2 border",children:X.date||""}),i.jsx("td",{className:"p-2 border",children:X.description||""}),i.jsx("td",{className:"p-2 border",children:fo(Number(X.amount||0))})]},X.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>de(!0),children:"Crear Cargo"})]}),me.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:me.map(X=>{const G=D===X.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:G?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:O,onChange:ye=>te(ye.target.value)}):i.jsx("span",{title:X.description,children:X.description.length>60?`${X.description.slice(0,60)}`:X.description})}),i.jsx("td",{className:"p-2 border",children:G?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:se,onChange:ye=>we(ye.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${X.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:X.type})}),i.jsx("td",{className:"p-2 border",children:G?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:q,onChange:ye=>Me(ye.target.value)}):fo(X.amount)}),i.jsx("td",{className:"p-2 border",children:G?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:K,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:J,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(X.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>re(X),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(X.id),children:"Eliminar"})]})})]},X.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:Ff(Se.totalLbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:Ff(Se.totalUnits)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:fo(Se.totalInvoiced)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:fo(Se.totalExpected)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:fo(Se.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:fo(Se.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:fo(Se.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:fo(Se.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:fo(Se.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:ze,onClick:je,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:ze?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),be&&i.jsx("span",{className:"text-sm ml-2",children:be})]}),ze&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),fe&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>de(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:Z,onChange:X=>xe(X.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Be,onChange:X=>I(X.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:C,onChange:X=>Q(X.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:M,children:"Agregar"})})]})]})})]})}const jd=t=>`C$ ${Number(t||0).toFixed(2)}`,kf=t=>Number(t||0).toFixed(3),ole=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function lle(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(!1),[o,l]=N.useState(null),[c,A]=N.useState(or(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[u,d]=N.useState(or(new Date,"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(!1),{refreshKey:x,refresh:g}=Wl();N.useEffect(()=>{(async()=>{n(!0);const E=Ut(ot(Re,"inventory_batches"),qt("status","==","PAGADO"),Hr("date","desc")),S=await bt(E),B=[];S.forEach(U=>{const k=U.data(),T=Number(k.quantity||0),L=Number(k.remaining||0),Y=Number(k.purchasePrice||0),me=Number(k.salePrice||0),ae=Number((T*Y).toFixed(2)),fe=Number((T*me).toFixed(2));B.push({id:U.id,productId:k.productId,productName:k.productName,category:k.category,unit:k.unit,quantity:T,remaining:L,purchasePrice:Y,salePrice:me,invoiceTotal:k.invoiceTotal!=null?Number(k.invoiceTotal):ae,expectedTotal:k.expectedTotal!=null?Number(k.expectedTotal):fe,date:k.date,status:k.status,paidAt:k.paidAt})}),e(B),n(!1)})()},[x]);const y=N.useMemo(()=>t.filter(E=>!(c&&E.date<c||u&&E.date>u||f&&E.productId!==f)),[t,c,u,f]),b=N.useMemo(()=>{let E=0,S=0,B=0,U=0,k=0,T=0;for(const L of y)ole(L.unit)?(E+=L.quantity,S+=L.remaining):(B+=L.quantity,U+=L.remaining),k+=Number(L.expectedTotal||0),T+=Number(L.invoiceTotal||0);return{lbsIng:E,lbsRem:S,udsIng:B,udsRem:U,totalEsperado:k,totalFact:T,gross:k-T}},[y]),F=E=>{l(E),a(!0)},j=async()=>{if(o)try{const E=Ft(Re,"inventory_batches",o.id);await Fr(E,{status:"PENDIENTE",remaining:o.quantity});const S=ot(Re,"salesV2"),B=await bt(Ut(S,qt("batchId","==",o.id))),U=await bt(Ut(S,qt("productName","==",o.productName),qt("date","==",o.date))),k=[...B.docs,...U.docs];for(const T of k)await mn(Ft(Re,"salesV2",T.id));e(T=>T.map(L=>L.id===o.id?{...L,status:"PENDIENTE",remaining:o.quantity}:L)),a(!1),l(null),g()}catch(E){console.error("Error al marcar pendiente:",E)}},R=N.useMemo(()=>{const E=new Map;return t.forEach(S=>E.set(S.productId,{id:S.productId,name:S.productName})),Array.from(E.values())},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(Fc,{onClick:g,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:E=>A(E.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:E=>d(E.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:E=>h(E.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),R.map(E=>i.jsx("option",{value:E.id,children:E.name},E.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",kf(b.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",kf(b.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",jd(b.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",kf(b.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",kf(b.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",jd(b.totalFact)]}),i.jsxs("div",{className:"col-span-3",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",jd(b.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",y.length.toLocaleString()]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):y.map(E=>{var S;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:E.date}),i.jsx("td",{className:"p-2 border",children:(E.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:E.productName}),i.jsx("td",{className:"p-2 border",children:(E.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:kf(E.quantity)}),i.jsx("td",{className:"p-2 border",children:kf(E.remaining)}),i.jsx("td",{className:"p-2 border",children:jd(E.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:jd(E.salePrice)}),i.jsx("td",{className:"p-2 border",children:jd(E.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:jd(E.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(S=E.paidAt)!=null&&S.toDate?or(E.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>F(E),children:"Marcar PENDIENTE"})})]},E.id)})})]})}),m&&i.jsx(ile,{paidBatches:y,onClose:()=>p(!1),onCreated:()=>p(!1)}),s&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-[90%] max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas del dashboard."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded",children:"Cancelar"}),i.jsx("button",{onClick:j,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded",children:"Confirmar"})]})]})})]})}const pa=t=>`C$ ${(Number(t)||0).toFixed(2)}`,cle=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function pv(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function Ale(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function ule(t){const e="ROP",r=pv(t.subcat).slice(0,3)||"GEN",n=Ale(t.gender),s=pv(t.color).slice(0,3)||"COL",a=pv(t.size)||"TLL",o=pv(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${s}-${a}-${o}-${l}`}const rp=/^[A-Za-z0-9._-]{0,32}$/;function dle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[u,d]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(or(new Date,"yyyy-MM-dd")),[y,b]=N.useState(0),[F,j]=N.useState(0),[R,E]=N.useState(0),[S,B]=N.useState(0),[U,k]=N.useState(0),[T,L]=N.useState(""),[Y,me]=N.useState(""),[ae,fe]=N.useState(""),[de,Z]=N.useState(""),[xe,Be]=N.useState(""),[I,C]=N.useState(""),[Q,M]=N.useState(""),[D,z]=N.useState(!1),[O,te]=N.useState(""),[se,we]=N.useState("Camisa"),[q,Me]=N.useState(null),[re,J]=N.useState(""),[K,ie]=N.useState(0),[pe,Ee]=N.useState(0),[Ue,qe]=N.useState(0),[$e,st]=N.useState(0),[Se,ze]=N.useState(0),[Ke,be]=N.useState(""),[le,je]=N.useState(""),[X,G]=N.useState(""),[ye,Oe]=N.useState(""),[_e,he]=N.useState(""),[Ce,Ze]=N.useState(""),[Te,Ge]=N.useState(""),[at,wt]=N.useState(null),[it,xt]=N.useState({x:0,y:0}),[Lt,hr]=N.useState(!1);N.useEffect(()=>{const ne=()=>wt(null),ue=ge=>ge.key==="Escape"&&wt(null);return document.addEventListener("click",ne),document.addEventListener("keydown",ue),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",ue)}},[]);const lr=(ne,ue,ge=192,Fe=160)=>{let We=ne;ne+ge+8>window.innerWidth&&(We=ne-ge),We=Math.max(8,Math.min(We,window.innerWidth-ge-8));let rt=ue;return ue+Fe+8>window.innerHeight&&(rt=window.innerHeight-Fe-8),rt=Math.max(8,Math.min(rt,window.innerHeight-Fe-8)),{x:We,y:rt}},gr=(ne,ue)=>{ne.stopPropagation();const ge=ne.currentTarget.getBoundingClientRect(),Fe=ge.right,De=ge.bottom,We=lr(Fe,De);xt(We),wt(rt=>rt===ue?null:ue)};N.useEffect(()=>{const ne=()=>wt(null),ue=ge=>{ge.key==="Escape"&&wt(null)};return document.addEventListener("click",ne),document.addEventListener("keydown",ue),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",ue)}},[]),N.useEffect(()=>{if(!at)return;const ne=()=>wt(null);return window.addEventListener("scroll",ne,!0),window.addEventListener("resize",ne),()=>{window.removeEventListener("scroll",ne,!0),window.removeEventListener("resize",ne)}},[at]),N.useEffect(()=>{(async()=>{const ne=await bt(ot(Re,"products_clothes")),ue=[];ne.forEach(We=>{const rt=We.data();ue.push({id:We.id,name:rt.name??"(sin nombre)",category:rt.category??"(sin categora)",measurement:rt.measurement??"unidad",price:Number(rt.price??0),sku:rt.sku||"",size:rt.size||"",color:rt.color||"",gender:rt.gender||"",brand:rt.brand||""})}),e(ue);const ge=Ut(ot(Re,"inventory_clothes_batches"),Hr("date","desc")),Fe=await bt(ge),De=[];Fe.forEach(We=>{const rt=We.data();De.push({id:We.id,productId:rt.productId,productName:rt.productName,category:rt.category,unit:rt.unit,quantity:Number(rt.quantity||0),remaining:Number(rt.remaining??rt.quantity??0),purchasePrice:Number(rt.purchasePrice||0),salePrice:Number(rt.salePrice||0),invoiceTotal:Number(rt.invoiceTotal??Number(rt.quantity||0)*Number(rt.purchasePrice||0)),expectedTotal:Number(rt.expectedTotal??Number(rt.quantity||0)*Number(rt.salePrice||0)),date:rt.date,createdAt:rt.createdAt,status:rt.status,notes:rt.notes||"",sku:rt.sku||"",size:rt.size||"",color:rt.color||"",gender:rt.gender||"",brand:rt.brand||"",clientCode:rt.clientCode||""})}),n(De),a(!1)})()},[]),N.useEffect(()=>{const ne=t.find(ue=>ue.id===m);ne&&(E(Number(ne.price||0)),ne.sku&&me(ne.sku),ne.size&&fe(ue=>ue||ne.size),ne.color&&Z(ue=>ue||ne.color),ne.gender&&Be(ue=>ue||ne.gender),ne.brand&&C(ue=>ue||ne.brand))},[m,t]),N.useEffect(()=>{B(Math.floor(y*F*100)/100)},[y,F]),N.useEffect(()=>{k(Math.floor(y*R*100)/100)},[y,R]),N.useEffect(()=>{const ne=t.find(Fe=>Fe.id===m);if(ne!=null&&ne.sku){me(ne.sku);return}const ue=D&&se?se:(ne==null?void 0:ne.category)||"";if(!ue&&!xe&&!de&&!ae&&!I){me("");return}const ge=ule({subcat:ue,gender:xe||"",color:de||"",size:ae||"",brand:I||""});me(ge)},[D,se,m,xe,de,ae,I,t]);const xr=N.useMemo(()=>r.filter(ne=>!(c&&ne.date<c||u&&ne.date>u||f&&ne.productId!==f)),[r,c,u,f]),Ye=N.useMemo(()=>{const ne=xr.reduce((De,We)=>De+(We.invoiceTotal||0),0),ue=xr.reduce((De,We)=>De+(We.expectedTotal||0),0),ge=xr.reduce((De,We)=>De+We.quantity,0),Fe=xr.reduce((De,We)=>De+We.remaining,0);return{udsIng:ge,udsRem:Fe,totalFacturado:ne,totalEsperado:ue}},[xr]),pt=async ne=>{ne.preventDefault(),l("");const ue=!!m&&!D,ge=t.find(rt=>rt.id===m),Fe=ue?(ge==null?void 0:ge.name)||"":O||"",De=ue?(ge==null?void 0:ge.category)||"":se||"General",We=ue&&(ge==null?void 0:ge.measurement)||"unidad";if(!Fe||y<=0||F<=0){l("Completa nombre/cantidad/costo.");return}if(Q&&!rp.test(Q)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const rt=await zr(ot(Re,"inventory_clothes_batches"),{productId:ue?ge.id:"",productName:Fe,category:De,unit:We,quantity:y,remaining:y,purchasePrice:F,salePrice:R,invoiceTotal:S,expectedTotal:U,date:x,createdAt:Vt.now(),status:"PENDIENTE",notes:T||"",sku:Y||"",size:ae||"",color:de||"",gender:xe||"",brand:I||"",clientCode:Q||""});n(Le=>[{id:rt.id,productId:ue?ge.id:"",productName:Fe,category:De,unit:We,quantity:y,remaining:y,purchasePrice:F,salePrice:R,invoiceTotal:S,expectedTotal:U,date:x,createdAt:Vt.now(),status:"PENDIENTE",notes:T||"",sku:Y||"",size:ae||"",color:de||"",gender:xe||"",brand:I||"",clientCode:Q||""},...Le]),l(" Lote de ropa creado"),p(""),g(or(new Date,"yyyy-MM-dd")),b(0),j(0),E(0),B(0),k(0),L(""),me(""),fe(""),Z(""),Be(""),C(""),M(""),z(!1),te(""),we("Camisa")}catch(rt){console.error(rt),l(" Error al crear lote")}},Rt=async ne=>{confirm(`Marcar PAGADO el lote del ${ne.date} (${ne.productName})?`)&&(await Fr(Ft(Re,"inventory_clothes_batches",ne.id),{status:"PAGADO"}),n(ge=>ge.map(Fe=>Fe.id===ne.id?{...Fe,status:"PAGADO"}:Fe)))},Tt=ne=>{Me(ne.id),J(ne.date),ie(ne.quantity),Ee(ne.purchasePrice),qe(ne.salePrice),st(Number((ne.quantity*ne.purchasePrice).toFixed(2))),ze(Number((ne.quantity*ne.salePrice).toFixed(2))),be(ne.notes||""),je(ne.sku||""),G(ne.size||""),Oe(ne.color||""),he(ne.gender||""),Ze(ne.brand||""),Ge(ne.clientCode||"")},Dt=()=>{Me(null),J(""),ie(0),Ee(0),qe(0),st(0),ze(0),be(""),je(""),G(""),Oe(""),he(""),Ze(""),Ge("")};N.useEffect(()=>{q&&st(Math.floor(K*pe*100)/100)},[q,K,pe]),N.useEffect(()=>{q&&ze(Math.floor(K*Ue*100)/100)},[q,K,Ue]);const Xt=async()=>{if(!q)return;const ne=r.find(De=>De.id===q);if(!ne)return;const ue=Math.max(0,ne.quantity-ne.remaining),ge=Math.max(0,K-ue);if(Te&&!rp.test(Te)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const Fe=Ft(Re,"inventory_clothes_batches",q);await Fr(Fe,{date:re,quantity:K,purchasePrice:pe,salePrice:Ue,invoiceTotal:$e,expectedTotal:Se,notes:Ke,remaining:ge,sku:le,size:X,color:ye,gender:_e||"",brand:Ce||"",clientCode:Te||""}),n(De=>De.map(We=>We.id===q?{...We,date:re,quantity:K,purchasePrice:pe,salePrice:Ue,invoiceTotal:$e,expectedTotal:Se,notes:Ke,remaining:ge,sku:le,size:X,color:ye,gender:_e||"",brand:Ce||"",clientCode:Te||""}:We)),Dt(),l(" Lote actualizado")},Kt=async ne=>{confirm(`Eliminar el lote del ${ne.date} (${ne.productName})?`)&&(await mn(Ft(Re,"inventory_clothes_batches",ne.id)),n(ge=>ge.filter(Fe=>Fe.id!==ne.id)),l(" Lote eliminado"))},oe=()=>{const ne=(c?`Desde ${c}`:"Desde inicio")+"  "+(u?`Hasta ${u}`:"Hasta hoy"),ue=We=>(We||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ge=xr.map(We=>`
      <tr>
        <td>${We.date}</td>
        <td>${(We.category||"").toUpperCase()}</td>
        <td>${ue(We.productName)}</td>
        <td>${ue(We.sku||"")}</td>
        <td>${ue(We.size||"")}</td>
        <td>${ue(We.color||"")}</td>
        <td>${ue(We.clientCode||"")}</td>
        <td>${ue(We.gender||"")}</td>
        <td>${(We.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${We.quantity.toFixed(0)}</td>
        <td style="text-align:right">${We.remaining.toFixed(0)}</td>
        <td style="text-align:right">${pa(We.purchasePrice)}</td>
        <td style="text-align:right">${pa(We.salePrice)}</td>
        <td style="text-align:right">${pa(We.invoiceTotal||0)}</td>
        <td style="text-align:right">${pa(We.expectedTotal||0)}</td>
        <td>${ue((We.notes||"").slice(0,120))}</td>
        <td>${We.status}</td>
      </tr>`).join(""),Fe=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${ne}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${Ye.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${Ye.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${pa(Ye.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${pa(Ye.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${pa(Number((Ye.totalEsperado-Ye.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${ge||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,De=window.open("","_blank");De&&(De.document.open(),De.document.write(Fe),De.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>hr(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:ne=>A(ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:ne=>d(ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:ne=>h(ne.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(ne=>i.jsxs("option",{value:ne.id,children:[ne.name,"  ",ne.category]},ne.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:oe,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Ye.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Ye.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",pa(Ye.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",pa(Ye.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",pa(Number((Ye.totalEsperado-Ye.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):xr.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):xr.map(ne=>{const ue=q===ne.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:ue?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:re,onChange:ge=>J(ge.target.value)}):ne.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(ne.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:ne.productName,children:ne.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:le,onChange:ge=>je(ge.target.value)}):i.jsx("span",{className:"block truncate",title:ne.sku||"",children:ne.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:X,onChange:ge=>G(ge.target.value)}):ne.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:ye,onChange:ge=>Oe(ge.target.value)}):ne.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:Te,onChange:ge=>{const Fe=ge.target.value;rp.test(Fe)&&Ge(Fe)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:ne.clientCode||"",children:ne.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:ue?i.jsx("select",{className:"w-full border p-1 rounded",value:_e,onChange:ge=>he(ge.target.value),children:cle.map(ge=>i.jsx("option",{value:ge,children:ge||""},ge))}):ne.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(ne.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ue?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(K)?"":K,onChange:ge=>ie(Math.max(0,parseInt(ge.target.value||"0",10)))}):ne.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ue?ne.remaining:ne.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ue?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(pe)?"":pe,onChange:ge=>Ee(Math.max(0,parseFloat(ge.target.value||"0")))}):pa(ne.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ue?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(Ue)?"":Ue,onChange:ge=>qe(Math.max(0,parseFloat(ge.target.value||"0")))}):pa(ne.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:pa(ue?$e:ne.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:pa(ue?Se:ne.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:ue?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ke,onChange:ge=>be(ge.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:ne.notes||"",children:ne.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${ne.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ne.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:ue?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Xt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Dt,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:ge=>gr(ge,ne.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},ne.id)})})]})})}),at&&wh.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>wt(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:it.x,top:it.y},onClick:ne=>ne.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const ne=xr.find(ue=>ue.id===at);return(ne==null?void 0:ne.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{wt(null),Rt(ne)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const ne=xr.find(ue=>ue.id===at);ne&&(wt(null),Tt(ne))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const ne=xr.find(ue=>ue.id===at);ne&&(wt(null),Kt(ne))},children:" Borrar"})]})})]}),document.body),Lt&&wh.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>hr(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>hr(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:pt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ne=>p(ne.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(ne=>i.jsxs("option",{value:ne.id,children:[ne.name,"  ",ne.category,"  ",ne.sku?`SKU: ${ne.sku}`:""]},ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:ne=>g(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:ne=>b(Math.max(0,parseInt(ne.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:F===0?"":F,onChange:ne=>j(Math.max(0,parseFloat(ne.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:R===0?"":R,onChange:ne=>E(Math.max(0,parseFloat(ne.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Y,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ae,readOnly:!0,onChange:ne=>fe(ne.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:de,readOnly:!0,onChange:ne=>Z(ne.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:xe,readOnly:!0,onChange:ne=>Be(ne.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:I,onChange:ne=>C(ne.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:Q,onChange:ne=>{const ue=ne.target.value;rp.test(ue)&&M(ue)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!rp.test(Q)&&Q.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:T,onChange:ne=>L(ne.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[T.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:pa(S),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:pa(U),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>hr(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const hle=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],fle=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],mle=["XS","S","M","L","XL","2XL"],ple=["2","4","6","8","10","12","14"],gle=["26","28","30","32","34","36","38"],xle=["Shein","Usado","Otro"],vle=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function gv(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function wle(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function yle(t){const e="ROP",r=gv(t.subcat).slice(0,3)||"GEN",n=wle(t.gender),s=gv(t.color).slice(0,3)||"COL",a=gv(t.size)||"TLL",o=gv(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${s}-${a}-${o}`}const ble=/^[A-Za-z0-9._-]{0,32}$/;function Nle(){const[t,e]=N.useState(""),[r,n]=N.useState("Camisa"),[s,a]=N.useState(""),[o,l]=N.useState(""),[c,A]=N.useState("Shein"),[u,d]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(""),[y,b]=N.useState(""),[F,j]=N.useState("0"),[R,E]=N.useState(""),[S,B]=N.useState(""),U=N.useMemo(()=>{const M=Number(F||0),D=Number(y||0);return Math.floor(M*D*100)/100},[F,y]),[k,T]=N.useState([]),[L,Y]=N.useState(!0),[me,ae]=N.useState(""),{refreshKey:fe,refresh:de}=Wl(),[Z,xe]=N.useState(!1),Be=N.useMemo(()=>r.toLowerCase()==="jean"?gle:u==="NINO"||u==="NINA"?ple:mle,[r,u]);N.useEffect(()=>{p(yle({subcat:r,gender:u,color:o,size:s,brand:c}))},[r,u,o,s,c]),N.useEffect(()=>{(async()=>{Y(!0);const M=Ut(ot(Re,"products_clothes"),Hr("createdAt","desc")),D=await bt(M),z=[];D.forEach(O=>{const te=O.data();z.push({id:O.id,name:te.name??"(sin nombre)",category:te.category??"",measurement:te.measurement??"unidad",sku:te.sku??"",size:te.size||"",color:te.color||"",brand:te.brand||"",gender:te.gender||"",clientCode:te.clientCode||"",notes:te.notes||"",createdAt:te.createdAt??Vt.now()})}),T(z),Y(!1)})()},[fe]);const I=()=>{e(""),n("Camisa"),a(""),l(""),A("Shein"),d(""),h(""),g(""),b(""),j("0"),E(""),B("")},C=async M=>{if(M.preventDefault(),ae(""),!t.trim()){ae("Ingresa el nombre del producto.");return}if(f&&!ble.test(f)){ae("Cdigo del cliente invlido");return}const D=Number(F||0),z=Number(y||0);if(D<0){ae("La cantidad de piezas debe ser 0 o mayor.");return}if(z<0){ae("El precio de venta no puede ser negativo.");return}try{const O=await zr(ot(Re,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:u||"",clientCode:f||"",notes:x||"",createdAt:Vt.now(),price:z||0});if(T(te=>[{id:O.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:u||"",clientCode:f||"",notes:x||"",createdAt:Vt.now()},...te]),D>0){const te=new Date().toISOString().slice(0,10),se=R||te;await zr(ot(Re,"inventory_clothes_batches"),{productId:O.id,productName:t.trim(),category:r,unit:"unidad",quantity:D,remaining:D,purchasePrice:0,salePrice:z||0,invoiceTotal:0,expectedTotal:U||0,date:se,createdAt:Vt.now(),status:"PENDIENTE",notes:S||"",sku:m||"",size:s||"",color:o||"",gender:u||"",brand:c||"",clientCode:f||""})}ae(D>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),I()}catch(O){console.error(O),ae(" Error al crear producto")}},Q=async M=>{confirm(`Eliminar el producto "${M.name}"?`)&&(await mn(Ft(Re,"products_clothes",M.id)),T(z=>z.filter(O=>O.id!==M.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:de,loading:L}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{xe(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),Z&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:C,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:M=>e(M.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:M=>n(M.target.value),children:hle.map(M=>i.jsx("option",{value:M,children:M},M))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:u,onChange:M=>d(M.target.value),children:vle.map(M=>i.jsx("option",{value:M,children:M||""},M))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:s,onChange:M=>a(M.target.value),children:[i.jsx("option",{value:"",children:""}),Be.map(M=>i.jsx("option",{value:M,children:M},M))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:M=>l(M.target.value),children:[i.jsx("option",{value:"",children:""}),fle.map(M=>i.jsx("option",{value:M,children:M},M))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:M=>A(M.target.value),children:xle.map(M=>i.jsx("option",{value:M,children:M},M))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:M=>h(M.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:M=>b(M.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:F,onChange:M=>j(M.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:R,onChange:M=>E(M.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(U)?"":U.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:I,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>xe(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:L?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):k.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):k.map(M=>{var D;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(D=M.createdAt)!=null&&D.toDate?M.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:M.category}),i.jsx("td",{className:"p-2 border",children:M.name}),i.jsx("td",{className:"p-2 border",children:M.sku}),i.jsx("td",{className:"p-2 border",children:M.size||""}),i.jsx("td",{className:"p-2 border",children:M.color||""}),i.jsx("td",{className:"p-2 border",children:M.brand||""}),i.jsx("td",{className:"p-2 border",children:M.gender||""}),i.jsx("td",{className:"p-2 border",children:M.clientCode||""}),i.jsx("td",{className:"p-2 border",children:M.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Q(M),children:"Borrar"})})]},M.id)})})]})}),me&&i.jsx("p",{className:"mt-2 text-sm",children:me})]})}async function Cle(t){const{productId:e,quantity:r,saleDate:n,saleId:s}=t,a=Math.max(0,Math.floor(Number(r||0)));if(!e||a<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=Ut(ot(Re,"inventory_clothes_batches"),qt("productId","==",e)),A=(await bt(o)).docs.map(d=>({id:d.id,data:d.data()})).sort((d,f)=>{var g,y;const h=String(d.data.date||""),m=String(f.data.date||"");if(h!==m)return h<m?-1:1;const p=((g=d.data.createdAt)==null?void 0:g.seconds)??0,x=((y=f.data.createdAt)==null?void 0:y.seconds)??0;return p-x}).map(d=>Ft(Re,"inventory_clothes_batches",d.id)),u=[];return await Na(Re,async d=>{const f=await Promise.all(A.map(m=>d.get(m)));let h=a;for(let m=0;m<A.length&&h>0;m++){const p=A[m],x=f[m];if(!x.exists())continue;const g=x.data(),y=Math.max(0,Math.floor(Number(g.quantity||0))),b=Number.isFinite(Number(g.remaining))?Math.max(0,Math.floor(Number(g.remaining||0))):y;if(b<=0)continue;const F=Math.min(b,h),j=Math.max(0,b-F);d.update(p,{remaining:j}),u.push({batchId:p.id,qty:F,batchDate:String(g.date||""),productName:String(g.productName||"")}),h-=F}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(s)for(const m of u)await zr(ot(Re,"batch_clothes_allocations"),{saleId:s,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:Vt.now()})}),{allocations:u}}async function CE(t){const e=Ft(Re,"sales_clothes",t),r=await za(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const A=n.allocationsByItem[c],u=String((A==null?void 0:A.productId)||c||"");if(!u)continue;const d=Array.isArray(A==null?void 0:A.allocations)?A.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const A=String((c==null?void 0:c.productId)||"");if(!A)continue;const u=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[A]=u.map(d=>({batchId:String(d.batchId),qty:Math.max(0,Math.floor(Number(d.qty||d.quantity||0)))}))}for(const c of n.items){const A=String((c==null?void 0:c.productId)||"");if(!A)continue;const u=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),d=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):l[A]||[];s.push({productId:A,productName:String((c==null?void 0:c.productName)||""),qty:u,allocations:d.length?d:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),A=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),u=Array.isArray(n.allocations)?n.allocations.map(d=>({batchId:String(d.batchId),qty:Math.max(0,Math.floor(Number(d.qty||d.quantity||0)))})):[];c&&A>0&&s.push({productId:c,productName:String(l.productName||n.productName||""),qty:A,allocations:u.length?u:void 0})}return s.length===0?(await Na(Re,async l=>{l.delete(e)}),{restored:0}):s.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await Na(Re,async c=>{const A=[];for(const d of s)for(const f of d.allocations||[])A.push({ref:Ft(Re,"inventory_clothes_batches",f.batchId),addBack:Math.max(0,Math.floor(Number(f.qty||0)))});const u=await Promise.all(A.map(d=>c.get(d.ref)));for(let d=0;d<A.length;d++){const f=u[d];if(!f.exists())continue;const h=f.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(A[d].ref,{remaining:m+A[d].addBack})}c.delete(e)}),{restored:s.reduce((c,A)=>c+(A.allocations||[]).reduce((u,d)=>u+d.qty,0),0)}):(await Na(Re,async l=>{const c={};for(const h of s){if(!h.productId||h.qty<=0)continue;const m=Ut(ot(Re,"inventory_clothes_batches"),qt("productId","==",h.productId)),x=(await bt(m)).docs.map(g=>{const y=g.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),F=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:g.id,date:String(y.date||""),quantity:b,remaining:F}}).sort((g,y)=>g.date.localeCompare(y.date));c[h.productId]=x}const A=[];for(const h of s){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)A.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const g=Math.max(0,x.quantity-x.remaining);if(g<=0)continue;const y=Math.min(g,p);A.push({id:x.id,addBack:y}),p-=y}for(const x of m){if(p<=0)break;const g=Math.min(p,h.qty);A.push({id:x.id,addBack:g}),p-=g}}const u={};for(const h of A)u[h.id]=(u[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const d=Object.keys(u).map(h=>Ft(Re,"inventory_clothes_batches",h)),f=await Promise.all(d.map(h=>l.get(h)));for(let h=0;h<d.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),g=Math.max(0,Math.floor(Number(u[d[h].id]||0)));l.update(d[h],{remaining:x+g})}l.delete(e)}),{restored:s.reduce((l,c)=>l+c.qty,0)})}const Xj=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Jc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function xv(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function Yj(t){const e=Ut(ot(Re,"ar_movements"),qt("ref.saleId","==",t)),r=await bt(e);await Promise.all(r.docs.map(n=>mn(Ft(Re,"ar_movements",n.id))))}function _le(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,a]=N.useState(null),[o,l]=N.useState([]),c=async Ye=>{e(!0),n(!0),a(Ye),l([]);try{const Rt=(await bt(Ut(ot(Re,"sales_clothes"),qt("__name__","==",Ye)))).docs[0],Tt=Rt==null?void 0:Rt.data(),Xt=(Array.isArray(Tt==null?void 0:Tt.items)?Tt.items:Tt!=null&&Tt.item?[Tt.item]:[]).map(Kt=>({productName:String(Kt.productName||""),qty:Number(Kt.qty||0),unitPrice:Number(Kt.unitPrice||0),discount:Number(Kt.discount||0),total:Number(Kt.total||0)}));l(Xt)}catch(pt){console.error(pt)}finally{n(!1)}},[A,u]=N.useState(""),[d,f]=N.useState("+505 "),[h,m]=N.useState(""),[p,x]=N.useState(""),[g,y]=N.useState("ACTIVO"),[b,F]=N.useState(0),[j,R]=N.useState([]),[E,S]=N.useState(!0),[B,U]=N.useState(""),[k,T]=N.useState(null),[L,Y]=N.useState(""),[me,ae]=N.useState("+505 "),[fe,de]=N.useState(""),[Z,xe]=N.useState(""),[Be,I]=N.useState("ACTIVO"),[C,Q]=N.useState(0),[M,D]=N.useState(!1),[z,O]=N.useState(null),[te,se]=N.useState(!1),[we,q]=N.useState([]),[Me,re]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[J,K]=N.useState(!1),[ie,pe]=N.useState(0),[Ee,Ue]=N.useState(new Date().toISOString().slice(0,10)),[qe,$e]=N.useState(""),[st,Se]=N.useState(!1),[ze,Ke]=N.useState(null),[be,le]=N.useState(""),[je,X]=N.useState(0),[G,ye]=N.useState(""),[Oe,_e]=N.useState(!1);N.useEffect(()=>{(async()=>{const Ye=Ut(ot(Re,"customers_clothes"),Hr("createdAt","desc")),pt=await bt(Ye),Rt=[];pt.forEach(Tt=>{const Dt=Tt.data();Rt.push({id:Tt.id,name:Dt.name??"",phone:Dt.phone??"+505 ",place:Dt.place??"",notes:Dt.notes??"",status:Dt.status??"ACTIVO",creditLimit:Number(Dt.creditLimit??0),createdAt:Dt.createdAt??Vt.now(),balance:0})});for(const Tt of Rt)try{const Dt=Ut(ot(Re,"ar_movements"),qt("customerId","==",Tt.id)),Xt=await bt(Dt);let Kt=0;Xt.forEach(oe=>Kt+=Number(oe.data().amount||0)),Tt.balance=Kt}catch{Tt.balance=0}R(Rt),S(!1)})()},[]);const he=()=>{u(""),f("+505 "),m(""),x(""),y("ACTIVO"),F(0)},Ce=async Ye=>{if(Ye.preventDefault(),U(""),!A.trim()){U("Ingresa el nombre.");return}const pt=xv(d);if(pt.length<6){U("Telfono incompleto.");return}try{const Rt=await zr(ot(Re,"customers_clothes"),{name:A.trim(),phone:pt,place:h||"",notes:p||"",status:g,creditLimit:Number(b||0),createdAt:Vt.now()});R(Tt=>[{id:Rt.id,name:A.trim(),phone:pt,place:h||"",notes:p||"",status:g,creditLimit:Number(b||0),createdAt:Vt.now(),balance:0},...Tt]),he(),_e(!1),U(" Cliente creado")}catch(Rt){console.error(Rt),U(" Error al crear cliente")}},Ze=Ye=>{T(Ye.id),Y(Ye.name),ae(Ye.phone||"+505 "),de(Ye.place||""),xe(Ye.notes||""),I(Ye.status||"ACTIVO"),Q(Number(Ye.creditLimit||0))},Te=()=>{T(null),Y(""),ae("+505 "),de(""),xe(""),I("ACTIVO"),Q(0)},Ge=async()=>{if(!k)return;const Ye=xv(me);if(!L.trim()){U("Ingresa el nombre.");return}try{await Fr(Ft(Re,"customers_clothes",k),{name:L.trim(),phone:Ye,place:fe||"",notes:Z||"",status:Be,creditLimit:Number(C||0)}),R(pt=>pt.map(Rt=>Rt.id===k?{...Rt,name:L.trim(),phone:Ye,place:fe||"",notes:Z||"",status:Be,creditLimit:Number(C||0)}:Rt)),Te(),U(" Cliente actualizado")}catch(pt){console.error(pt),U(" Error al actualizar")}},at=async Ye=>{if(confirm(`Eliminar al cliente "${Ye.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{S(!0);const Rt=Ut(ot(Re,"sales_clothes"),qt("customerId","==",Ye.id)),Tt=await bt(Rt);for(const Kt of Tt.docs){const oe=Kt.id;try{await CE(oe)}catch(ne){console.warn("restoreSaleAndDeleteClothes error",ne);try{await mn(Ft(Re,"sales_clothes",oe))}catch{}}await Yj(oe)}const Dt=Ut(ot(Re,"ar_movements"),qt("customerId","==",Ye.id)),Xt=await bt(Dt);await Promise.all(Xt.docs.map(Kt=>mn(Ft(Re,"ar_movements",Kt.id)))),await mn(Ft(Re,"customers_clothes",Ye.id)),R(Kt=>Kt.filter(oe=>oe.id!==Ye.id)),U(" Cliente eliminado y prendas devueltas al inventario")}catch(Rt){console.error(Rt),U(" No se pudo eliminar el cliente.")}finally{S(!1)}},wt=async Ye=>{O(Ye),q([]),re({saldoActual:0,totalAbonado:0,totalCargos:0}),D(!0),K(!1),pe(0),Ue(new Date().toISOString().slice(0,10)),$e(""),Ke(null),se(!0);try{const pt=Ut(ot(Re,"ar_movements"),qt("customerId","==",Ye.id)),Rt=await bt(pt),Tt=[];Rt.forEach(Dt=>{var Kt,oe;const Xt=Dt.data();Tt.push({id:Dt.id,date:Xt.date??((oe=(Kt=Xt.createdAt)==null?void 0:Kt.toDate)!=null&&oe.call(Kt)?Xt.createdAt.toDate().toISOString().slice(0,10):""),type:Xt.type??"CARGO",amount:Number(Xt.amount||0),ref:Xt.ref||{},comment:Xt.comment||"",createdAt:Xt.createdAt})}),Tt.sort((Dt,Xt)=>{var ne,ue;if(Dt.date!==Xt.date)return Dt.date.localeCompare(Xt.date);const Kt=((ne=Dt.createdAt)==null?void 0:ne.seconds)||0,oe=((ue=Xt.createdAt)==null?void 0:ue.seconds)||0;return Kt-oe}),q(Tt),it(Tt)}catch(pt){console.error(pt),U(" No se pudo cargar el estado de cuenta")}finally{se(!1)}},it=Ye=>{const pt=Ye.reduce((Dt,Xt)=>Dt+(Number(Xt.amount)||0),0),Rt=Ye.filter(Dt=>Number(Dt.amount)<0).reduce((Dt,Xt)=>Dt+Math.abs(Number(Xt.amount)||0),0),Tt=Ye.filter(Dt=>Number(Dt.amount)>0).reduce((Dt,Xt)=>Dt+Number(Xt.amount)||0,0);re({saldoActual:pt,totalAbonado:Rt,totalCargos:Tt})},xt=async()=>{if(!z)return;U("");const Ye=Number(ie||0);if(!(Ye>0)){U("Ingresa un monto de abono mayor a 0.");return}const pt=parseFloat(Ye.toFixed(2));if(!Ee){U("Selecciona la fecha del abono.");return}try{Se(!0);const Rt={customerId:z.id,type:"ABONO",amount:-pt,date:Ee,comment:qe||"",createdAt:Vt.now()},Dt={id:(await zr(ot(Re,"ar_movements"),Rt)).id,date:Ee,type:"ABONO",amount:-pt,comment:qe||"",createdAt:Vt.now()},Xt=[...we,Dt].sort((Kt,oe)=>{var ge,Fe;if(Kt.date!==oe.date)return Kt.date.localeCompare(oe.date);const ne=((ge=Kt.createdAt)==null?void 0:ge.seconds)||0,ue=((Fe=oe.createdAt)==null?void 0:Fe.seconds)||0;return ne-ue});q(Xt),it(Xt),R(Kt=>Kt.map(oe=>oe.id===z.id?{...oe,balance:(oe.balance||0)-pt}:oe)),O(Kt=>Kt&&{...Kt,balance:(Kt.balance||0)-pt}),pe(0),$e(""),Ue(new Date().toISOString().slice(0,10)),K(!1),U(" Abono registrado")}catch(Rt){console.error(Rt),U(" Error al registrar el abono")}finally{Se(!1)}},Lt=Ye=>{Ke(Ye.id),le(Ye.date||new Date().toISOString().slice(0,10)),X(Math.abs(Number(Ye.amount||0))),ye(Ye.comment||"")},hr=()=>{Ke(null),le(""),X(0),ye("")},lr=async()=>{if(!ze)return;const Ye=we.findIndex(Dt=>Dt.id===ze);if(Ye===-1)return;const pt=we[Ye],Rt=Number(je||0);if(!(Rt>0)){U("El monto debe ser mayor a 0.");return}const Tt=pt.type==="ABONO"?-parseFloat(Rt.toFixed(2)):+parseFloat(Rt.toFixed(2));try{await Fr(Ft(Re,"ar_movements",ze),{date:be,amount:Tt,comment:G||""});const Dt=[...we];Dt[Ye]={...pt,date:be,amount:Tt,comment:G||""},Dt.sort((Kt,oe)=>{var ge,Fe;if(Kt.date!==oe.date)return Kt.date.localeCompare(oe.date);const ne=((ge=Kt.createdAt)==null?void 0:ge.seconds)||0,ue=((Fe=oe.createdAt)==null?void 0:Fe.seconds)||0;return ne-ue}),q(Dt),it(Dt);const Xt=Dt.reduce((Kt,oe)=>Kt+(Number(oe.amount)||0),0);R(Kt=>Kt.map(oe=>oe.id===(z==null?void 0:z.id)?{...oe,balance:Xt}:oe)),O(Kt=>Kt&&{...Kt,balance:Xt}),hr(),U(" Movimiento actualizado")}catch(Dt){console.error(Dt),U(" Error al actualizar movimiento")}},gr=async Ye=>{var Rt,Tt;if(confirm(`Eliminar este movimiento (${Ye.type==="ABONO"?"Abono":"Compra"}) del ${Ye.date}?${Ye.type==="CARGO"&&((Rt=Ye.ref)!=null&&Rt.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(S(!0),Ye.type==="CARGO"&&((Tt=Ye.ref)!=null&&Tt.saleId)){try{await CE(Ye.ref.saleId)}catch(Kt){console.warn("restoreSaleAndDeleteClothes error",Kt),S(!1),U(" No se pudo devolver inventario de la venta.");return}await Yj(Ye.ref.saleId)}else await mn(Ft(Re,"ar_movements",Ye.id));const Dt=we.filter(Kt=>{var oe,ne;return Ye.type==="CARGO"&&((oe=Ye.ref)!=null&&oe.saleId)?((ne=Kt.ref)==null?void 0:ne.saleId)!==Ye.ref.saleId:Kt.id!==Ye.id});q(Dt),it(Dt);const Xt=Dt.reduce((Kt,oe)=>Kt+(Number(oe.amount)||0),0);R(Kt=>Kt.map(oe=>oe.id===(z==null?void 0:z.id)?{...oe,balance:Xt}:oe)),O(Kt=>Kt&&{...Kt,balance:Xt}),U(" Movimiento eliminado")}catch(Dt){console.error(Dt),U(" Error al eliminar movimiento")}finally{S(!1)}},xr=N.useMemo(()=>[...j].sort((Ye,pt)=>{var Rt,Tt;return Ye.status!==pt.status?Ye.status==="BLOQUEADO"?1:-1:(((Rt=pt.createdAt)==null?void 0:Rt.seconds)||0)-(((Tt=Ye.createdAt)==null?void 0:Tt.seconds)||0)}),[j]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>_e(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:E?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):xr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):xr.map(Ye=>{var Rt;const pt=k===Ye.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Rt=Ye.createdAt)!=null&&Rt.toDate?Ye.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:pt?i.jsx("input",{className:"w-full border p-1 rounded",value:L,onChange:Tt=>Y(Tt.target.value)}):Ye.name}),i.jsx("td",{className:"p-2 border",children:pt?i.jsx("input",{className:"w-full border p-1 rounded",value:me,onChange:Tt=>ae(xv(Tt.target.value))}):Ye.phone}),i.jsx("td",{className:"p-2 border",children:pt?i.jsxs("select",{className:"w-full border p-1 rounded",value:fe,onChange:Tt=>de(Tt.target.value),children:[i.jsx("option",{value:"",children:""}),Xj.map(Tt=>i.jsx("option",{value:Tt,children:Tt},Tt))]}):Ye.place||""}),i.jsx("td",{className:"p-2 border",children:pt?i.jsxs("select",{className:"w-full border p-1 rounded",value:Be,onChange:Tt=>I(Tt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ye.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Ye.status})}),i.jsx("td",{className:"p-2 border",children:pt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(C)?"":C,onChange:Tt=>Q(Math.max(0,Number(Tt.target.value||0)))}):Jc(Ye.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Jc(Ye.balance||0)}),i.jsx("td",{className:"p-2 border",children:pt?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Z,onChange:Tt=>xe(Tt.target.value),maxLength:500}):i.jsx("span",{title:Ye.notes||"",children:(Ye.notes||"").length>40?(Ye.notes||"").slice(0,40)+"":Ye.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:pt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ge,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Te,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ze(Ye),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>at(Ye),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>wt(Ye),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},Ye.id)})})]})}),B&&i.jsx("p",{className:"mt-2 text-sm",children:B}),Oe&&wh.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>_e(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>_e(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ce,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:A,onChange:Ye=>u(Ye.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:Ye=>f(xv(Ye.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Ye=>m(Ye.target.value),children:[i.jsx("option",{value:"",children:""}),Xj.map(Ye=>i.jsx("option",{value:Ye,children:Ye},Ye))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:g,onChange:Ye=>y(Ye.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:Ye=>F(Math.max(0,Number(Ye.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:Ye=>x(Ye.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>_e(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),M&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(z==null?void 0:z.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{pe(0),Ue(new Date().toISOString().slice(0,10)),$e(""),K(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>D(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Jc(Me.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Jc(Me.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Jc(Me.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:te?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):we.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):we.map(Ye=>{var Rt,Tt;const pt=ze===Ye.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:pt?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:be,onChange:Dt=>le(Dt.target.value)}):Ye.date||""}),i.jsx("td",{className:"p-2 border",children:Ye.amount>=0?(Rt=Ye.ref)!=null&&Rt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(Ye.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Tt=Ye.ref)!=null&&Tt.saleId?`Venta #${Ye.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:pt?i.jsx("input",{className:"w-full border p-1 rounded",value:G,onChange:Dt=>ye(Dt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Ye.comment||"",children:(Ye.comment||"").length>40?(Ye.comment||"").slice(0,40)+"":Ye.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:pt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(je)?"":je,onChange:Dt=>{const Xt=Number(Dt.target.value||0),Kt=Number.isFinite(Xt)?Math.max(0,parseFloat(Xt.toFixed(2))):0;X(Kt)},placeholder:"0.00",title:Ye.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Jc(Ye.amount)}),i.jsx("td",{className:"p-2 border",children:pt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:lr,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:hr,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Lt(Ye),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>gr(Ye),children:"Borrar"})]})})]},Ye.id)})})]})})]})}),J&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(z==null?void 0:z.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ee,onChange:Ye=>Ue(Ye.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ie===0?"":ie,onChange:Ye=>{const pt=Number(Ye.target.value||0),Rt=Number.isFinite(pt)?Math.max(0,parseFloat(pt.toFixed(2))):0;pe(Rt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:qe,onChange:Ye=>$e(Ye.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[qe.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>K(!1),disabled:st,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:xt,disabled:st,children:st?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((Ye,pt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Ye.productName}),i.jsx("td",{className:"p-2 border text-right",children:Ye.qty}),i.jsx("td",{className:"p-2 border text-right",children:Jc(Ye.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Jc(Ye.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Jc(Ye.total)})]},pt))})]})})]})})]})}const Tf=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Ele=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function Ble(t){if(!t)return 0;const e=Ut(ot(Re,"inventory_clothes_batches"),qt("productId","==",t)),r=await bt(e);let n="0000-00-00",s=-1,a=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),A=Number(l.salePrice||0),u=l.createdAt,d=((u==null?void 0:u.seconds)??0)*1e3+((u==null?void 0:u.nanoseconds)??0)/1e6;c>n?(n=c,s=d,a=A):c===n&&d>s&&(s=d,a=A)}),Number(a||0)}async function Zj(t){if(!t)return 0;const e=Ut(ot(Re,"inventory_clothes_batches"),qt("productId","==",t)),r=await bt(e);let n=0;return r.forEach(s=>n+=Number(s.data().remaining||0)),n}function eP(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function Sle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState({}),[o,l]=N.useState("CONTADO"),[c,A]=N.useState(""),[u,d]=N.useState(""),[f,h]=N.useState(new Date().toISOString().slice(0,10)),[m,p]=N.useState(""),[x,g]=N.useState([]),y=N.useMemo(()=>x.reduce((re,J)=>re+(J.qty||0),0),[x]),b=N.useMemo(()=>{const re=x.reduce((J,K)=>{const ie=Math.max(0,(Number(K.unitPrice)||0)*(K.qty||0)-(Number(K.discount)||0));return J+ie},0);return Math.floor(re*100)/100},[x]),[F,j]=N.useState(0),[R,E]=N.useState(""),[S,B]=N.useState(!1),[U,k]=N.useState(!1),[T,L]=N.useState(""),[Y,me]=N.useState("+505 "),[ae,fe]=N.useState(""),[de,Z]=N.useState(""),[xe,Be]=N.useState("ACTIVO"),[I,C]=N.useState(0),Q=()=>{L(""),me("+505 "),fe(""),Z(""),Be("ACTIVO"),C(0)};N.useEffect(()=>{(async()=>{const re=Ut(ot(Re,"customers_clothes"),Hr("createdAt","desc")),J=await bt(re),K=[];J.forEach(st=>{const Se=st.data();K.push({id:st.id,name:Se.name??"",phone:Se.phone??"+505 ",place:Se.place??"",status:Se.status??"ACTIVO",creditLimit:Number(Se.creditLimit??0),balance:0})});for(const st of K)try{const Se=Ut(ot(Re,"ar_movements"),qt("customerId","==",st.id)),ze=await bt(Se);let Ke=0;ze.forEach(be=>Ke+=Number(be.data().amount||0)),st.balance=Ke}catch{st.balance=0}e(K);const ie=Ut(ot(Re,"products_clothes"),Hr("createdAt","desc")),pe=await bt(ie),Ee=[];pe.forEach(st=>{const Se=st.data();Ee.push({id:st.id,name:Se.name??"(sin nombre)",sku:Se.sku??""})}),n(Ee);const Ue=Ut(ot(Re,"inventory_clothes_batches"),qt("remaining",">",0)),qe=await bt(Ue),$e={};qe.forEach(st=>{const Se=st.data(),ze=Se.productId||"",Ke=Number(Se.remaining||0);ze&&($e[ze]=($e[ze]||0)+Ke)}),a($e)})()},[]);const M=N.useMemo(()=>t.find(re=>re.id===c),[t,c]),D=(M==null?void 0:M.balance)||0,z=o==="CREDITO"?D+Math.max(0,Number(b||0))-Math.max(0,Number(F||0)):0,O=async re=>{if(!re)return;if(x.some(Ee=>Ee.productId===re)){p("");return}const J=r.find(Ee=>Ee.id===re);if(!J){p("");return}let K=await Ble(re);K||(K=Number((J==null?void 0:J.price)||0));const ie=await Zj(re),pe={productId:re,productName:J.name||"",sku:J.sku||"",unitPrice:Number(K)||0,available:Number(ie)||0,qty:0,discount:0};g(Ee=>[...Ee,pe]),p("")},te=(re,J)=>{g(K=>K.map(ie=>{if(ie.productId!==re)return ie;if(J==="")return{...ie,qty:0};const pe=Math.max(0,Math.floor(Number(J)));return{...ie,qty:pe}}))},se=(re,J)=>{g(K=>K.map(ie=>{if(ie.productId!==re)return ie;if(J==="")return{...ie,discount:0};const pe=Math.max(0,Math.floor(Number(J)));return{...ie,discount:pe}}))},we=re=>g(J=>J.filter(K=>K.productId!==re)),q=async()=>{if(!f)return"Selecciona la fecha.";if(x.length===0)return"Agrega al menos un producto.";const re=x.filter(J=>(J.qty||0)>0);if(re.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(b>0))return"El total debe ser mayor a cero.";if(o==="CONTADO"){if(!u.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!c)return"Selecciona un cliente (crdito).";if(F<0)return"El pago inicial no puede ser negativo.";if(F>b)return"El pago inicial no puede superar el total.";if((M==null?void 0:M.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const J of re){const K=await Zj(J.productId);if(J.qty>K)return`Inventario insuficiente para "${J.productName}". Disponible: ${K} unidades.`;const ie=(Number(J.unitPrice)||0)*(J.qty||0),pe=Number(J.discount)||0;if(!Number.isInteger(pe)||pe<0)return`El descuento en "${J.productName}" debe ser entero y  0.`;if(pe>ie)return`El descuento en "${J.productName}" no puede exceder C$ ${ie.toFixed(2)}.`}return null},Me=async re=>{re.preventDefault(),E("");const J=await q();if(J){E(" "+J);return}try{B(!0);const K=x.filter(Ue=>(Ue.qty||0)>0).map(Ue=>{const qe=(Number(Ue.unitPrice)||0)*(Ue.qty||0),$e=Math.max(0,Math.floor(Number(Ue.discount)||0)),st=Math.max(0,qe-$e);return{productId:Ue.productId,productName:Ue.productName,sku:Ue.sku||"",qty:Ue.qty,unitPrice:Number(Ue.unitPrice)||0,discount:$e,total:Math.floor(st*100)/100}}),ie={type:o,date:f,createdAt:Vt.now(),itemsTotal:Number(b)||0,total:Number(b)||0,quantity:Number(y)||0,items:K};o==="CONTADO"?ie.customerName=u.trim():(ie.customerId=c,ie.downPayment=Number(F)||0);const pe=await zr(ot(Re,"sales_clothes"),ie);if(o==="CREDITO"&&c){const Ue={customerId:c,date:f,createdAt:Vt.now(),ref:{saleId:pe.id}};await zr(ot(Re,"ar_movements"),{...Ue,type:"CARGO",amount:Number(b)||0}),Number(F)>0&&await zr(ot(Re,"ar_movements"),{...Ue,type:"ABONO",amount:-Number(F)})}const Ee={};for(const Ue of K)if(Ue.qty>0){const{allocations:qe}=await Cle({productId:Ue.productId,quantity:Ue.qty,saleDate:f,saleId:pe.id});Ee[Ue.productId]={productId:Ue.productId,allocations:qe}}await Fr(Ft(Re,"sales_clothes",pe.id),{allocationsByItem:Ee}),l("CONTADO"),A(""),d(""),h(new Date().toISOString().slice(0,10)),g([]),j(0),o==="CREDITO"&&c&&e(Ue=>Ue.map(qe=>qe.id===c?{...qe,balance:(qe.balance||0)+(Number(b)||0)-(Number(F)||0)}:qe)),E(" Venta registrada"),(async()=>{const Ue=Ut(ot(Re,"inventory_clothes_batches"),qt("remaining",">",0)),qe=await bt(Ue),$e={};qe.forEach(st=>{const Se=st.data(),ze=Se.productId||"",Ke=Number(Se.remaining||0);ze&&($e[ze]=($e[ze]||0)+Ke)}),a($e)})()}catch(K){console.error(K),E(" Error al guardar la venta")}finally{B(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:Me,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:re=>l(re.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),o==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:u,onChange:re=>d(re.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:c,onChange:re=>A(re.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),t.map(re=>i.jsxs("option",{value:re.status==="ACTIVO"?re.id:"",disabled:re.status==="BLOQUEADO",children:[re.name," | ",re.phone," | Saldo: ",Tf(re.balance||0)]},re.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>k(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Tf(D)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:F===0?"":F,onChange:re=>j(Math.max(0,Number(re.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Tf(z)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:f,onChange:re=>h(re.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:async re=>{const J=re.target.value;p(J),await O(J)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),r.map(re=>{const J=x.some(pe=>pe.productId===re.id),K=s[re.id]||0,ie=J||K<=0;return i.jsxs("option",{value:ie?"":re.id,disabled:ie,children:[re.name," ",re.sku?` ${re.sku}`:""," ",K>0?`(disp: ${K})`:"(sin stock)",J?" (seleccionado)":""]},re.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),x.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):x.map(re=>{const J=Math.max(0,(re.available||0)-(re.qty||0)),K=(Number(re.unitPrice)||0)*(re.qty||0),ie=Math.max(0,K-(Number(re.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[re.productName,re.sku?`  ${re.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Tf(re.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:J}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(re.qty)||re.qty===0?"":re.qty,onChange:pe=>te(re.productId,pe.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(re.discount)||re.discount===0?"":re.discount,onChange:pe=>se(re.productId,pe.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:Tf(ie)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>we(re.productId),title:"Quitar producto",children:""})})]},re.productId)})]}),x.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:y})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Tf(b)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:S,children:S?"Guardando...":"Registrar venta"})})]}),R&&i.jsx("p",{className:"mt-2 text-sm",children:R}),U&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:T,onChange:re=>L(re.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:Y,onChange:re=>me(eP(re.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:re=>fe(re.target.value),children:[i.jsx("option",{value:"",children:""}),Ele.map(re=>i.jsx("option",{value:re,children:re},re))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:xe,onChange:re=>Be(re.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:I===0?"":I,onChange:re=>C(Math.max(0,Number(re.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:de,onChange:re=>Z(re.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Q(),k(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(E(""),!T.trim()){E("Ingresa el nombre del nuevo cliente.");return}const re=eP(Y);try{const J=await zr(ot(Re,"customers_clothes"),{name:T.trim(),phone:re,place:ae||"",notes:de||"",status:xe,creditLimit:Number(I||0),createdAt:Vt.now()}),K={id:J.id,name:T.trim(),phone:re,place:ae||"",status:xe,creditLimit:Number(I||0),balance:0};e(ie=>[K,...ie]),A(J.id),Q(),k(!1),E(" Cliente creado")}catch(J){console.error(J),E(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),S&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const na=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function pw(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function Ile(t,e){const r=pw(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},s=Number(t.quantity??n.qty??0),a=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??a??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:s,unitPrice:Number(n.unitPrice??(a&&s?a/s:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function Fle(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,A)=>c.date.localeCompare(A.date));const a=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of a)for(const c of l.items||[]){const A=s[c.productId];if(!A)continue;let u=Number(c.qty||0);if(!(u<=0))for(const d of A.lots){if(u<=0)break;if(d.qtyLeft<=0)continue;const f=Math.min(d.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=f*d.cost),d.qtyLeft-=f,u-=f}}return o}function kle(){const{refreshKey:t,refresh:e}=Wl(),[r,n]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[s,a]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,A]=N.useState([]),[u,d]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,j]=N.useState(""),[R,E]=N.useState(!1),[S,B]=N.useState(null),[U,k]=N.useState([]),[T,L]=N.useState(!1),[Y,me]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});N.useEffect(()=>{(async()=>{b(!0),j("");try{const I=await bt(ot(Re,"sales_clothes")),C=[],Q=[];I.forEach(re=>{const J=re.data(),K=Ile(J,re.id);K&&(K.date<=s&&C.push(K),K.date>=r&&K.date<=s&&Q.push(K))}),A(C),l(Q);const M=await bt(ot(Re,"inventory_clothes_batches")),D=[];M.forEach(re=>{const J=re.data(),K=pw(J);!K||K>s||D.push({id:re.id,productId:J.productId,productName:J.productName||"",date:K,quantity:Number(J.quantity||0),remaining:Number(J.remaining||0),purchasePrice:Number(J.purchasePrice||0)})}),d(D);const z=await bt(ot(Re,"expenses_clothes")),O=[];z.forEach(re=>{const J=re.data(),K=pw(J);K&&K>=r&&K<=s&&O.push({id:re.id,date:K,category:J.category||"",description:J.description||"",amount:Number(J.amount||0),status:J.status||""})}),h(O);const te=await bt(ot(Re,"ar_movements")),se=[],we={};te.forEach(re=>{const J=re.data(),K=pw(J);if(!K)return;const ie=J.customerId,pe=Number(J.amount||0);ie&&(we[ie]=(we[ie]||0)+pe),J.type==="ABONO"&&K>=r&&K<=s&&se.push({id:re.id,customerId:ie,type:"ABONO",amount:pe,date:K})}),p(se);const q=await bt(ot(Re,"customers_clothes")),Me=[];q.forEach(re=>{const J=re.data();Me.push({id:re.id,name:J.name||"",balance:we[re.id]||0})}),g(Me)}catch(I){console.error(I),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,s,t]);const ae=N.useMemo(()=>{try{return Fle(u,c,r,s)}catch(I){return console.error(I),0}},[u,c,r,s]),fe=N.useMemo(()=>{const I=o.reduce((we,q)=>we+(q.total||0),0),C=f.reduce((we,q)=>we+(q.amount||0),0),Q=I-ae,M=Q-C,D=m.reduce((we,q)=>we+Math.abs(q.amount||0),0),z=x.filter(we=>(we.balance||0)>0),O=z.reduce((we,q)=>we+(q.balance||0),0);let te=0,se=0;for(const we of o){const q=(we.items||[]).reduce((Me,re)=>Me+(Number(re.qty)||0),0);we.type==="CONTADO"?te+=q:se+=q}return{ventasTotales:I,costoMercaderia:ae,gastosPeriodo:C,gananciaAntes:Q,gananciaDespues:M,abonosRecibidos:D,saldosPendientes:O,clientesConSaldo:z.length,prendasCash:te,prendasCredito:se}},[o,f,m,x,ae]),de=N.useMemo(()=>{const I={};for(const C of o){if(C.type!=="CREDITO"||!C.customerId)continue;const Q=(C.items||[]).reduce((M,D)=>M+(Number(D.qty)||0),0);I[C.customerId]=(I[C.customerId]||0)+Q}return x.filter(C=>(C.balance||0)>0).map(C=>({customerId:C.id,name:C.name,prendasCredito:I[C.id]||0,saldo:C.balance||0})).sort((C,Q)=>Q.saldo-C.saldo)},[x,o]),Z=N.useMemo(()=>{const I={};return x.forEach(C=>I[C.id]=C.name),I},[x]),xe=N.useMemo(()=>[...o].sort((I,C)=>C.date.localeCompare(I.date)).map(I=>{var M;const C=(I.items||[]).reduce((D,z)=>D+(Number(z.qty)||0),0);let Q="Cash";return I.type==="CREDITO"&&I.customerId?Q=Z[I.customerId]||"":I.type==="CONTADO"&&(Q=((M=I.customerName)==null?void 0:M.trim())||"Cash"),{id:I.id,date:I.date,type:I.type==="CREDITO"?"Crdito":"Cash",customer:Q,piezas:C,total:Number(I.total||0)}}),[o,Z]),Be=async I=>{E(!0),B({id:I.customerId,name:I.name}),k([]),L(!0),me({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const C=[];let Q=0,M=0,D=0;for(const se of o)if(!(se.type!=="CREDITO"||se.customerId!==I.customerId))for(const we of se.items||[]){const q=Number(we.qty||0),Me=Number(we.unitPrice||0),re=q*Me,J=Math.max(0,Number(we.discount||0)),K=Math.max(0,re-J);C.push({saleId:se.id,date:se.date,productName:we.productName,sku:we.sku||"",qty:q,unitPrice:Me,lineTotal:re,discount:J,lineFinal:K}),Q+=re,M+=J,D+=K}let z=0;for(const se of m)se.customerId===I.customerId&&(z+=Math.abs(se.amount||0));const O=x.find(se=>se.id===I.customerId),te=(O==null?void 0:O.balance)||0;k(C),me({totalBruto:Q,totalDescuento:M,totalFiado:D,saldoActual:te,abonadoPeriodo:z})}catch(C){console.error(C),j(" No se pudo cargar el detalle del cliente.")}finally{L(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(Fc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:I=>n(I.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:I=>a(I.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:na(fe.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:na(fe.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:na(fe.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:na(fe.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:na(fe.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:na(fe.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:na(fe.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):de.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):de.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:I.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Be({customerId:I.customerId,name:I.name}),title:"Ver piezas fiadas del periodo",children:I.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:na(I.saldo)})]},I.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):xe.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:I.date}),i.jsx("td",{className:"p-2 border",children:I.customer}),i.jsx("td",{className:"p-2 border",children:I.type}),i.jsx("td",{className:"p-2 border",children:I.piezas}),i.jsx("td",{className:"p-2 border",children:na(I.total)})]},I.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((I,C)=>I.date.localeCompare(C.date)).map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:I.date}),i.jsx("td",{className:"p-2 border",children:I.category||""}),i.jsx("td",{className:"p-2 border",children:I.description?i.jsx("span",{title:I.description,children:I.description.length>40?I.description.slice(0,40)+"":I.description}):""}),i.jsx("td",{className:"p-2 border",children:na(I.amount)}),i.jsx("td",{className:"p-2 border",children:I.status||""})]},I.id))})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F}),R&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(S==null?void 0:S.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>E(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:na(Y.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:na(Y.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:na(Y.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:na(Y.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:na(Y.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):U.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):U.sort((I,C)=>I.date.localeCompare(C.date)).map((I,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:I.date}),i.jsx("td",{className:"p-2 border",children:I.productName}),i.jsx("td",{className:"p-2 border",children:I.sku||""}),i.jsx("td",{className:"p-2 border",children:I.qty}),i.jsx("td",{className:"p-2 border",children:na(I.unitPrice)}),i.jsx("td",{className:"p-2 border",children:na(I.lineTotal)}),i.jsx("td",{className:"p-2 border",children:na(I.discount)}),i.jsx("td",{className:"p-2 border",children:na(I.lineFinal)})]},`${I.saleId}-${C}`))})]})})]})})]})}const tP=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],vv=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Tle(){const[t,e]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[r,n]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[s,a]=N.useState(or(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,j]=N.useState(""),[R,E]=N.useState(null),[S,B]=N.useState(""),[U,k]=N.useState(""),[T,L]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[de,Z]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const O=Ut(ot(Re,"expenses_clothes"),Hr("date","desc")),te=await bt(O),se=[];te.forEach(we=>{const q=we.data();se.push({id:we.id,date:q.date||or(new Date,"yyyy-MM-dd"),category:q.category||"",description:q.description||"",amount:Number(q.amount||0),status:q.status||"PENDIENTE",notes:q.notes||"",createdAt:q.createdAt??Vt.now()})}),g(se)}catch(O){console.error(O),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const xe=N.useMemo(()=>x.filter(O=>!(t&&O.date<t||r&&O.date>r)),[x,t,r]),Be=N.useMemo(()=>{const O=xe.reduce((we,q)=>we+(q.amount||0),0),te=xe.filter(we=>we.status==="PAGADO").reduce((we,q)=>we+(q.amount||0),0),se=O-te;return{total:O,pagado:te,pendiente:se}},[xe]),I=()=>{a(or(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},C=async O=>{if(O.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!u||u<=0){j("Ingresa un monto vlido.");return}try{const te=await zr(ot(Re,"expenses_clothes"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Vt.now()});g(se=>[{id:te.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Vt.now()},...se]),I(),j(" Gasto registrado")}catch(te){console.error(te),j(" Error al guardar gasto")}},Q=O=>{E(O.id),B(O.date),k(O.category||""),L(O.description||""),me(Number(O.amount||0)),fe(O.status||"PENDIENTE"),Z(O.notes||"")},M=()=>{E(null),B(""),k(""),L(""),me(0),fe("PENDIENTE"),Z("")},D=async()=>{if(R){if(!U){j("Selecciona una categora.");return}if(!T.trim()){j("Ingresa una descripcin.");return}if(!Y||Y<=0){j("Ingresa un monto vlido.");return}try{await Fr(Ft(Re,"expenses_clothes",R),{date:S,category:U,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:de||""}),g(O=>O.map(te=>te.id===R?{...te,date:S,category:U,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:de||""}:te)),M(),j(" Gasto actualizado")}catch(O){console.error(O),j(" Error al actualizar gasto")}}},z=async O=>{confirm(`Eliminar el gasto "${O.description}"?`)&&(await mn(Ft(Re,"expenses_clothes",O.id)),g(se=>se.filter(we=>we.id!==O.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:O=>e(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:O=>n(O.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",vv(Be.total)]}),i.jsxs("div",{children:["Pagado: ",vv(Be.pagado)]}),i.jsxs("div",{children:["Pendiente: ",vv(Be.pendiente)]})]})]}),i.jsxs("form",{onSubmit:C,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:O=>a(O.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:O=>l(O.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),tP.map(O=>i.jsx("option",{value:O,children:O},O))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:O=>A(O.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:O=>d(Math.max(0,Number(O.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:O=>h(O.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:O=>p(O.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):xe.slice().sort((O,te)=>O.date.localeCompare(te.date)).map(O=>{const te=R===O.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:se=>B(se.target.value)}):O.date}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("select",{className:"w-full border p-1 rounded",value:U,onChange:se=>k(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),tP.map(se=>i.jsx("option",{value:se,children:se},se))]}):O.category||""}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>L(se.target.value)}):i.jsx("span",{title:O.description,children:O.description.length>40?O.description.slice(0,40)+"":O.description})}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Y)?"":Y,onChange:se=>me(Math.max(0,Number(se.target.value||0)))}):vv(O.amount)}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>fe(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${O.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:O.status})}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:de,onChange:se=>Z(se.target.value),maxLength:500}):i.jsx("span",{title:O.notes||"",children:(O.notes||"").length>40?(O.notes||"").slice(0,40)+"":O.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:te?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:D,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:M,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Q(O),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>z(O),children:"Borrar"})]})})})]},O.id)})})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F})]})}const Cl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function jle(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):""}function Ple(t,e){const r=jle(t);if(!r)return null;const n=t.item||{},s=Number((n==null?void 0:n.qty)??t.quantity??0)||0,a=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(s>0?a/s:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||s||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:s,unitPrice:o,total:s*o}}}async function Rle(t,e){if(e<=0)return;const r=Ut(ot(Re,"inventory_clothes_batches"),qt("productId","==",t)),n=await bt(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let a=e;for(const o of s){if(a<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,a);a-=l,await Fr(Ft(Re,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}a>0&&console.warn("consumeFIFO: falt inventario",a)}async function Dle(t,e){if(e<=0)return;const r=Ut(ot(Re,"inventory_clothes_batches"),qt("productId","==",t)),n=await bt(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let a=e;for(const o of s){if(a<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,a);a-=c,await Fr(Ft(Re,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}a>0&&console.warn("restoreFIFO: no se devolvi todo",a)}async function ZM(t){const e=Ut(ot(Re,"ar_movements"),qt("ref.saleId","==",t)),r=await bt(e);await Promise.all(r.docs.map(n=>mn(Ft(Re,"ar_movements",n.id))))}async function Lle(t,e,r){if(await ZM(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:Vt.now(),ref:{saleId:t.id}},{addDoc:s}=await mA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>WX);return{addDoc:o}},void 0);await s(ot(Re,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const a=Math.max(0,Number(r??t.downPayment??0));a>0&&await s(ot(Re,"ar_movements"),{...n,type:"ABONO",amount:-a})}function Ule(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,a]=N.useState(null),[o,l]=N.useState([]),c=async re=>{e(!0),n(!0),a(re),l([]);try{const K=(await bt(Ut(ot(Re,"sales_clothes"),qt("__name__","==",re)))).docs[0],ie=K==null?void 0:K.data(),Ee=(Array.isArray(ie==null?void 0:ie.items)?ie.items:ie!=null&&ie.item?[ie.item]:[]).map(Ue=>({productName:String(Ue.productName||""),qty:Number(Ue.qty||0),unitPrice:Number(Ue.unitPrice||0),discount:Number(Ue.discount||0),total:Number(Ue.total||0)}));l(Ee)}catch(J){console.error(J)}finally{n(!1)}},[A,u]=N.useState(or(new Date,"yyyy-MM-01")),[d,f]=N.useState(or(new Date,"yyyy-MM-dd")),[h,m]=N.useState([]),[p,x]=N.useState([]),[g,y]=N.useState(!0),[b,F]=N.useState(""),[j,R]=N.useState(""),[E,S]=N.useState(""),[B,U]=N.useState(null),[k,T]=N.useState(!1),[L,Y]=N.useState(null),[me,ae]=N.useState(0),fe=15,[de,Z]=N.useState(1),xe=N.useMemo(()=>{const re={};return h.forEach(J=>re[J.id]=J.name),re},[h]);N.useEffect(()=>{(async()=>{y(!0),F("");try{const re=await bt(ot(Re,"customers_clothes")),J=[];re.forEach(pe=>J.push({id:pe.id,name:pe.data().name||""})),m(J);const K=await bt(Ut(ot(Re,"sales_clothes"),Hr("createdAt","desc"))),ie=[];K.forEach(pe=>{const Ee=Ple(pe.data(),pe.id);Ee&&Ee.date>=A&&Ee.date<=d&&ie.push(Ee)}),x(ie.sort((pe,Ee)=>Ee.date.localeCompare(pe.date))),Z(1)}catch(re){console.error(re),F(" Error cargando transacciones.")}finally{y(!1)}})()},[A,d]);const Be=N.useMemo(()=>p.filter(re=>!(j&&re.customerId!==j||E&&re.type!==E)),[p,j,E]),I=N.useMemo(()=>{let re=0,J=0,K=0,ie=0;for(const pe of Be)pe.type==="CONTADO"?(re+=pe.item.qty,K+=pe.total):(J+=pe.item.qty,ie+=pe.total);return{piezasCash:re,piezasCredito:J,montoCash:K,montoCredito:ie}},[Be]),C=Math.max(1,Math.ceil(Be.length/fe)),Q=N.useMemo(()=>{const re=(de-1)*fe;return Be.slice(re,re+fe)},[Be,de]),M=re=>{U(null),Y(re),ae(re.item.qty||0),T(!0)},D=async re=>{if(U(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await CE(re.id),await ZM(re.id),x(J=>J.filter(K=>K.id!==re.id)),F(" Venta eliminada")}catch(J){console.error(J),F(" No se pudo eliminar la venta.")}finally{y(!1)}},z=async()=>{if(!L)return;const re=Number(L.item.qty||0),J=Math.max(1,Math.floor(Number(me)||0));if(J===re){T(!1);return}const K=Number(L.item.unitPrice||0),ie=Number((K*J).toFixed(2));try{y(!0);const pe=J-re;pe>0?await Rle(L.item.productId,pe):pe<0&&await Dle(L.item.productId,-pe);const Ee=Ft(Re,"sales_clothes",L.id);await Fr(Ee,{quantity:J,total:ie,itemsTotal:ie,"item.qty":J,"item.total":ie,updatedAt:Vt.now()});const Ue=Math.min(Number(L.downPayment||0),ie);await Lle(L,ie,Ue),x(qe=>qe.map($e=>$e.id===L.id?{...$e,quantity:J,total:ie,item:{...$e.item,qty:J,total:ie},downPayment:Ue}:$e)),F(" Venta actualizada"),T(!1)}catch(pe){console.error(pe),F(" No se pudo actualizar la venta.")}finally{y(!1)}},O=()=>{const re=`Reporte de transacciones (Ropa)  ${A} a ${d}`,J=Ee=>(Ee||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),K=Be.map(Ee=>{const Ue=Ee.customerName||(Ee.customerId?xe[Ee.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Ee.date}</td>
          <td>${J(Ue)}</td>
          <td>${Ee.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ee.item.qty}</td>
          <td style="text-align:right">${Cl(Ee.total)}</td>
        </tr>`}).join(""),ie=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${J(re)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${J(re)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${I.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${I.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${Cl(I.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Cl(I.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${K||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,pe=window.open("","_blank");pe&&(pe.document.open(),pe.document.write(ie),pe.document.close())},te=()=>Z(1),se=()=>Z(re=>Math.max(1,re-1)),we=()=>Z(re=>Math.min(C,re+1)),q=()=>Z(C),Me=()=>{const re=[];if(C<=7)for(let K=1;K<=C;K++)re.push(K);else{const K=Math.max(1,de-2),ie=Math.min(C,de+2);re.push(1),K>2&&re.push(-1);for(let pe=K;pe<=ie;pe++)pe!==1&&pe!==C&&re.push(pe);ie<C-1&&re.push(-2),re.push(C)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:te,disabled:de===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:se,disabled:de===1,children:" Anterior"}),re.map((K,ie)=>typeof K=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${K===de?"bg-blue-600 text-white":""}`,onClick:()=>Z(K),children:K},ie):i.jsx("span",{className:"px-2",children:""},ie)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:we,disabled:de===C,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:q,disabled:de===C,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",de," de ",C,"  ",Be.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:re=>{u(re.target.value),Z(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:re=>{f(re.target.value),Z(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:j,onChange:re=>{R(re.target.value),Z(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(re=>i.jsx("option",{value:re.id,children:re.name},re.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:E,onChange:re=>{S(re.target.value),Z(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:O,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:I.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:I.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Cl(I.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Cl(I.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:g?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):Q.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):Q.map(re=>{const J=re.customerName||(re.customerId?xe[re.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:re.date}),i.jsx("td",{className:"p-2 border",children:J}),i.jsx("td",{className:"p-2 border",children:re.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(re.id),children:re.item.qty})}),i.jsx("td",{className:"p-2 border",children:Cl(re.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>U(K=>K===re.id?null:re.id),title:"Acciones",children:""}),B===re.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>M(re),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>D(re),children:"Eliminar"})]})]})]},re.id)})})]}),Me()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),k&&L&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[L.item.productName," ",L.item.sku?` ${L.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:me,onChange:re=>ae(Math.max(1,Math.floor(Number(re.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:Cl(L.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:Cl(Number(L.item.unitPrice)*Number(me||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{T(!1),Y(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:z,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((re,J)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:re.productName}),i.jsx("td",{className:"p-2 border text-right",children:re.qty}),i.jsx("td",{className:"p-2 border text-right",children:Cl(re.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Cl(re.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Cl(re.total)})]},J))})]})})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var C2={};C2.version="0.18.5";var e8=1252,Ole=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ZS={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},eI=function(t){Ole.indexOf(t)!=-1&&(e8=ZS[0]=t)};function Mle(){eI(1252)}var Tl=function(t){eI(t)};function tI(){Tl(1200),Mle()}function rP(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Qle(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function t8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var bp=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Qle(t.slice(2)):e==254&&r==255?t8(t.slice(2)):e==65279?t.slice(1):t},wv=function(e){return String.fromCharCode(e)},nP=function(e){return String.fromCharCode(e)},Wg,Tu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jg(t){for(var e="",r=0,n=0,s=0,a=0,o=0,l=0,c=0,A=0;A<t.length;)r=t.charCodeAt(A++),a=r>>2,n=t.charCodeAt(A++),o=(r&3)<<4|n>>4,s=t.charCodeAt(A++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),e+=Tu.charAt(a)+Tu.charAt(o)+Tu.charAt(l)+Tu.charAt(c);return e}function Fo(t){var e="",r=0,n=0,s=0,a=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<t.length;)a=Tu.indexOf(t.charAt(A++)),o=Tu.indexOf(t.charAt(A++)),r=a<<2|o>>4,e+=String.fromCharCode(r),l=Tu.indexOf(t.charAt(A++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Tu.indexOf(t.charAt(A++)),s=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Qr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),TA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ad(t){return Qr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function sP(t){return Qr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var yo=function(e){return Qr?TA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Gy(t){if(typeof ArrayBuffer>"u")return yo(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function gd(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Vle(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function rI(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return rI(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ba=Qr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:TA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Hle(t){for(var e=[],r=0,n=t.length+250,s=ad(t.length+255),a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(e.push(s.slice(0,r)),r=0,s=ad(65535),n=65530)}return e.push(s.slice(0,r)),ba(e)}var Ti=/\u0000/g,Np=/[\u0001-\u0006]/g;function v0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function jl(t,e){var r=""+t;return r.length>=e?r:Ss("0",e-r.length)+r}function nI(t,e){var r=""+t;return r.length>=e?r:Ss(" ",e-r.length)+r}function _2(t,e){var r=""+t;return r.length>=e?r:r+Ss(" ",e-r.length)}function Kle(t,e){var r=""+Math.round(t);return r.length>=e?r:Ss("0",e-r.length)+r}function qle(t,e){var r=""+t;return r.length>=e?r:Ss("0",e-r.length)+r}var aP=Math.pow(2,32);function jf(t,e){if(t>aP||t<-aP)return Kle(t,e);var r=Math.round(t);return qle(r,e)}function E2(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var iP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],JN=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Gle(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var yr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},oP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$le={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function B2(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,o=1,l=0,c=1,A=0,u=0,d=Math.floor(s);A<e&&(d=Math.floor(s),l=d*o+a,u=d*A+c,!(s-d<5e-8));)s=1/(s-d),a=o,o=l,c=A,A=u;if(u>e&&(A>e?(u=c,l=a):(u=A,l=o)),!r)return[0,n*l,u];var f=Math.floor(n*l/u);return[f,n*l-f*u,u]}function th(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,o=[],l={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=Zle(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var r8=new Date(1899,11,31,0,0,0),zle=r8.getTime(),Wle=new Date(1900,2,1,0,0,0);function n8(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Wle&&(r+=24*60*60*1e3),(r-(zle+(t.getTimezoneOffset()-r8.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function sI(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Jle(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Xle(t){var e=t<0?12:11,r=sI(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Yle(t){var e=sI(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Xg(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Xle(t):e===10?r=t.toFixed(10).substr(0,12):r=Yle(t),sI(Jle(r.toUpperCase()))}function Th(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Xg(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return hl(14,n8(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Zle(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function ece(t,e,r,n){var s="",a=0,o=0,l=r.y,c,A=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,A=2;break;default:c=l%1e4,A=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,A=e.length;break;case 3:return JN[r.m-1][1];case 5:return JN[r.m-1][0];default:return JN[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,A=e.length;break;case 3:return iP[r.q][0];default:return iP[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,A=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,A=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,A=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?jl(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(s=jl(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}A=e.length===3?1:2;break;case 101:c=l,A=1;break}var u=A>0?jl(c,A):"";return u}function ju(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var s8=/%/g;function tce(t,e,r){var n=e.replace(s8,""),s=e.length-n.length;return pA(t,n,r*Math.pow(10,2*s))+Ss("%",s)}function rce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function a8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+a8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var i8=/# (\?+)( ?)\/( ?)(\d+)/;function nce(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),o=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?Ss(" ",t[1].length+1+t[4].length):nI(o,t[1].length)+t[2]+"/"+t[3]+jl(l,t[4].length))}function sce(t,e,r){return r+(e===0?"":""+e)+Ss(" ",t[1].length+2+t[4].length)}var o8=/^#*0*\.([0#]+)/,l8=/\).*[0#]/,c8=/\(###\) ###\\?-####/;function Bi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function lP(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function cP(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ace(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function ice(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function zo(t,e,r){if(t.charCodeAt(0)===40&&!e.match(l8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?zo("n",n,r):"("+zo("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return rce(t,e,r);if(e.indexOf("%")!==-1)return tce(t,e,r);if(e.indexOf("E")!==-1)return a8(e,r);if(e.charCodeAt(0)===36)return"$"+zo(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(e.match(/^00+$/))return A+jf(c,e.length);if(e.match(/^[#?]+$/))return s=jf(r,0),s==="0"&&(s=""),s.length>e.length?s:Bi(e.substr(0,e.length-s.length))+s;if(a=e.match(i8))return nce(a,c,A);if(e.match(/^#+0+$/))return A+jf(c,e.length-e.indexOf("0"));if(a=e.match(o8))return s=lP(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Bi(a[1])).replace(/\.$/,"."+Bi(a[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Ss("0",Bi(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return A+lP(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return A+ju(jf(c,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+zo(t,e,-r):ju(""+(Math.floor(r)+ace(r,a[1].length)))+"."+jl(cP(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return zo(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=v0(zo(t,e.replace(/[\\-]/g,""),r)),o=0,v0(v0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(c8))return s=zo(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=B2(c,Math.pow(10,o)-1,!1),s=""+A,u=pA("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=_2(l[2],o),u.length<a[4].length&&(u=Bi(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=B2(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?nI(l[1],o)+a[2]+"/"+a[3]+_2(l[2],o):Ss(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=jf(r,0),e.length<=s.length?s:Bi(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=e.indexOf(".")-o,f=e.length-s.length-d;return Bi(e.substr(0,d)+s+e.substr(e.length-f))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=cP(r,a[1].length),r<0?"-"+zo(t,e,-r):ju(ice(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?jl(0,3-m.length):"")+m})+"."+jl(o,a[1].length);switch(e){case"###,##0.00":return zo(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ju(jf(c,0));return h!=="0"?A+h:"";case"###,###.00":return zo(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return zo(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function oce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function lce(t,e,r){var n=e.replace(s8,""),s=e.length-n.length;return pA(t,n,r*Math.pow(10,2*s))+Ss("%",s)}function A8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+A8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ac(t,e,r){if(t.charCodeAt(0)===40&&!e.match(l8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ac("n",n,r):"("+Ac("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return oce(t,e,r);if(e.indexOf("%")!==-1)return lce(t,e,r);if(e.indexOf("E")!==-1)return A8(e,r);if(e.charCodeAt(0)===36)return"$"+Ac(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(e.match(/^00+$/))return A+jl(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Bi(e.substr(0,e.length-s.length))+s;if(a=e.match(i8))return sce(a,c,A);if(e.match(/^#+0+$/))return A+jl(c,e.length-e.indexOf("0"));if(a=e.match(o8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Bi(a[1])).replace(/\.$/,"."+Bi(a[1])),s=s.replace(/\.(\d*)$/,function(m,p){return"."+p+Ss("0",Bi(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return A+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return A+ju(""+c);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ac(t,e,-r):ju(""+r)+"."+Ss("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Ac(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=v0(Ac(t,e.replace(/[\\-]/g,""),r)),o=0,v0(v0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(c8))return s=Ac(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=B2(c,Math.pow(10,o)-1,!1),s=""+A,u=pA("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=_2(l[2],o),u.length<a[4].length&&(u=Bi(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=B2(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?nI(l[1],o)+a[2]+"/"+a[3]+_2(l[2],o):Ss(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Bi(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=e.indexOf(".")-o,f=e.length-s.length-d;return Bi(e.substr(0,d)+s+e.substr(e.length-f))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ac(t,e,-r):ju(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?jl(0,3-m.length):"")+m})+"."+jl(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=ju(""+c);return h!=="0"?A+h:"";default:if(e.match(/\.[0#?]*$/))return Ac(t,e.slice(0,e.lastIndexOf(".")),r)+Bi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function pA(t,e,r){return(r|0)===r?Ac(t,e,r):zo(t,e,r)}function cce(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var u8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lm(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":E2(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(u8))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Ace(t,e,r,n){for(var s=[],a="",o=0,l="",c="t",A,u,d,f="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!E2(t,o))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(d=t.charCodeAt(++o))!==34&&o<t.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";s[s.length]={t:m,v:h},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(A==null&&(A=th(e,r,t.charAt(o+1)==="2"),A==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||A==null&&(A=th(e,r),A==null))return"";for(a=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(A==null&&(A=th(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(A!=null&&(p.v=A.H>=12?"P":"A"),p.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(A!=null&&(p.v=A.H>=12?"PM":"AM"),p.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="/"?(A!=null&&(p.v=A.H>=12?"":""),p.t="T",o+=5,f="h"):(p.t="t",++o),A==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(a=l;t.charAt(o++)!=="]"&&o<t.length;)a+=t.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(u8)){if(A==null&&(A=th(e,r),A==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",lm(t)||(s[s.length]={t:"t",v:a}));break;case".":if(A!=null){for(a=l;++o<t.length&&(l=t.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;t.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)a+=t.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++o;break}var x=0,g=0,y;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=f,c="h",x<1&&(x=1);break;case"s":(y=s[o].v.match(/\.0+$/))&&(g=Math.max(g,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[o].v.match(/[Hh]/)&&(x=1),x<2&&s[o].v.match(/[Mm]/)&&(x=2),x<3&&s[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var b="",F;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=ece(s[o].t.charCodeAt(0),s[o].v,A,g),s[o].t="t";break;case"n":case"?":for(F=o+1;s[F]!=null&&((l=s[F].t)==="?"||l==="D"||(l===" "||l==="t")&&s[F+1]!=null&&(s[F+1].t==="?"||s[F+1].t==="t"&&s[F+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[F].v==="/"||s[F].v===" "&&s[F+1]!=null&&s[F+1].t=="?"));)s[o].v+=s[F].v,s[F]={v:"",t:";"},++F;b+=s[o].v,o=F-1;break;case"G":s[o].t="t",s[o].v=Th(e,r);break}var j="",R,E;if(b.length>0){b.charCodeAt(0)==40?(R=e<0&&b.charCodeAt(0)===45?-e:e,E=pA("n",b,R)):(R=e<0&&n>1?-e:e,E=pA("n",b,R),R<0&&s[0]&&s[0].t=="t"&&(E=E.substr(1),s[0].v="-"+s[0].v)),F=E.length-1;var S=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){S=o;break}var B=s.length;if(S===s.length&&E.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(F>=s[o].v.length-1?(F-=s[o].v.length,s[o].v=E.substr(F+1,s[o].v.length)):F<0?s[o].v="":(s[o].v=E.substr(0,F+1),F=-1),s[o].t="t",B=o);F>=0&&B<s.length&&(s[B].v=E.substr(0,F+1)+s[B].v)}else if(S!==s.length&&E.indexOf("E")===-1){for(F=E.indexOf(".")-1,o=S;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===S?s[o].v.indexOf(".")-1:s[o].v.length-1,j=s[o].v.substr(u+1);u>=0;--u)F>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(j=E.charAt(F--)+j);s[o].v=j,s[o].t="t",B=o}for(F>=0&&B<s.length&&(s[B].v=E.substr(0,F+1)+s[B].v),F=E.indexOf(".")+1,o=S;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==S)){for(u=s[o].v.indexOf(".")>-1&&o===S?s[o].v.indexOf(".")+1:0,j=s[o].v.substr(0,u);u<s[o].v.length;++u)F<E.length&&(j+=E.charAt(F++));s[o].v=j,s[o].t="t",B=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(R=n>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=pA(s[o].t,s[o].v,R),s[o].t="t");var U="";for(o=0;o!==s.length;++o)s[o]!=null&&(U+=s[o].v);return U}var AP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function uP(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function uce(t,e){var r=cce(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(AP),l=r[1].match(AP);return uP(e,o)?[n,r[0]]:uP(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function hl(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:yr)[t],n==null&&(n=r.table&&r.table[oP[t]]||yr[oP[t]]),n==null&&(n=$le[t]||"General");break}if(E2(n,0))return Th(e,r);e instanceof Date&&(e=n8(e,r.date1904));var s=uce(n,e);if(E2(s[1]))return Th(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Ace(s[1],e,r,s[0])}function gA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(yr[r]==null){e<0&&(e=r);continue}if(yr[r]==t){e=r;break}}e<0&&(e=391)}return yr[e]=t,e}function $y(t){for(var e=0;e!=392;++e)t[e]!==void 0&&gA(t[e],e)}function cm(){yr=Gle()}var dce={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},d8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function hce(t){var e=typeof t=="number"?yr[t]:t;return e=e.replace(d8,"(\\d+)"),new RegExp("^"+e+"$")}function fce(t,e,r){var n=-1,s=-1,a=-1,o=-1,l=-1,c=-1;(e.match(d8)||[]).forEach(function(d,f){var h=parseInt(r[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var A=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?A:n==-1&&s==-1&&a==-1?u:A+"T"+u}var mce=function(){var t={};t.version="1.2.0";function e(){for(var E=0,S=new Array(256),B=0;B!=256;++B)E=B,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,S[B]=E;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(E){var S=0,B=0,U=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)k[U]=E[U];for(U=0;U!=256;++U)for(B=E[U],S=256+U;S<4096;S+=256)B=k[S]=B>>>8^E[B&255];var T=[];for(U=1;U!=16;++U)T[U-1]=typeof Int32Array<"u"?k.subarray(U*256,U*256+256):k.slice(U*256,U*256+256);return T}var s=n(r),a=s[0],o=s[1],l=s[2],c=s[3],A=s[4],u=s[5],d=s[6],f=s[7],h=s[8],m=s[9],p=s[10],x=s[11],g=s[12],y=s[13],b=s[14];function F(E,S){for(var B=S^-1,U=0,k=E.length;U<k;)B=B>>>8^r[(B^E.charCodeAt(U++))&255];return~B}function j(E,S){for(var B=S^-1,U=E.length-15,k=0;k<U;)B=b[E[k++]^B&255]^y[E[k++]^B>>8&255]^g[E[k++]^B>>16&255]^x[E[k++]^B>>>24]^p[E[k++]]^m[E[k++]]^h[E[k++]]^f[E[k++]]^d[E[k++]]^u[E[k++]]^A[E[k++]]^c[E[k++]]^l[E[k++]]^o[E[k++]]^a[E[k++]]^r[E[k++]];for(U+=15;k<U;)B=B>>>8^r[(B^E[k++])&255];return~B}function R(E,S){for(var B=S^-1,U=0,k=E.length,T=0,L=0;U<k;)T=E.charCodeAt(U++),T<128?B=B>>>8^r[(B^T)&255]:T<2048?(B=B>>>8^r[(B^(192|T>>6&31))&255],B=B>>>8^r[(B^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,L=E.charCodeAt(U++)&1023,B=B>>>8^r[(B^(240|T>>8&7))&255],B=B>>>8^r[(B^(128|T>>2&63))&255],B=B>>>8^r[(B^(128|L>>6&15|(T&3)<<4))&255],B=B>>>8^r[(B^(128|L&63))&255]):(B=B>>>8^r[(B^(224|T>>12&15))&255],B=B>>>8^r[(B^(128|T>>6&63))&255],B=B>>>8^r[(B^(128|T&63))&255]);return~B}return t.table=r,t.bstr=F,t.buf=j,t.str=R,t}(),pr=function(){var e={};e.version="1.2.1";function r(oe,ne){for(var ue=oe.split("/"),ge=ne.split("/"),Fe=0,De=0,We=Math.min(ue.length,ge.length);Fe<We;++Fe){if(De=ue[Fe].length-ge[Fe].length)return De;if(ue[Fe]!=ge[Fe])return ue[Fe]<ge[Fe]?-1:1}return ue.length-ge.length}function n(oe){if(oe.charAt(oe.length-1)=="/")return oe.slice(0,-1).indexOf("/")===-1?oe:n(oe.slice(0,-1));var ne=oe.lastIndexOf("/");return ne===-1?oe:oe.slice(0,ne+1)}function s(oe){if(oe.charAt(oe.length-1)=="/")return s(oe.slice(0,-1));var ne=oe.lastIndexOf("/");return ne===-1?oe:oe.slice(ne+1)}function a(oe,ne){typeof ne=="string"&&(ne=new Date(ne));var ue=ne.getHours();ue=ue<<6|ne.getMinutes(),ue=ue<<5|ne.getSeconds()>>>1,oe.write_shift(2,ue);var ge=ne.getFullYear()-1980;ge=ge<<4|ne.getMonth()+1,ge=ge<<5|ne.getDate(),oe.write_shift(2,ge)}function o(oe){var ne=oe.read_shift(2)&65535,ue=oe.read_shift(2)&65535,ge=new Date,Fe=ue&31;ue>>>=5;var De=ue&15;ue>>>=4,ge.setMilliseconds(0),ge.setFullYear(ue+1980),ge.setMonth(De-1),ge.setDate(Fe);var We=ne&31;ne>>>=5;var rt=ne&63;return ne>>>=6,ge.setHours(ne),ge.setMinutes(rt),ge.setSeconds(We<<1),ge}function l(oe){Va(oe,0);for(var ne={},ue=0;oe.l<=oe.length-4;){var ge=oe.read_shift(2),Fe=oe.read_shift(2),De=oe.l+Fe,We={};switch(ge){case 21589:ue=oe.read_shift(1),ue&1&&(We.mtime=oe.read_shift(4)),Fe>5&&(ue&2&&(We.atime=oe.read_shift(4)),ue&4&&(We.ctime=oe.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3));break}oe.l=De,ne[ge]=We}return ne}var c;function A(){return c||(c={})}function u(oe,ne){if(oe[0]==80&&oe[1]==75)return at(oe,ne);if((oe[0]|32)==109&&(oe[1]|32)==105)return Ye(oe,ne);if(oe.length<512)throw new Error("CFB file size "+oe.length+" < 512");var ue=3,ge=512,Fe=0,De=0,We=0,rt=0,Le=0,Xe=[],et=oe.slice(0,512);Va(et,0);var dt=d(et);switch(ue=dt[0],ue){case 3:ge=512;break;case 4:ge=4096;break;case 0:if(dt[1]==0)return at(oe,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}ge!==512&&(et=oe.slice(0,ge),Va(et,28));var vt=oe.slice(0,ge);f(et,ue);var Nt=et.read_shift(4,"i");if(ue===3&&Nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Nt);et.l+=4,We=et.read_shift(4,"i"),et.l+=4,et.chk("00100000","Mini Stream Cutoff Size: "),rt=et.read_shift(4,"i"),Fe=et.read_shift(4,"i"),Le=et.read_shift(4,"i"),De=et.read_shift(4,"i");for(var At=-1,yt=0;yt<109&&(At=et.read_shift(4,"i"),!(At<0));++yt)Xe[yt]=At;var Zt=h(oe,ge);x(Le,De,Zt,ge,Xe);var Rr=y(Zt,We,Xe,ge);Rr[We].name="!Directory",Fe>0&&rt!==L&&(Rr[rt].name="!MiniFAT"),Rr[Xe[0]].name="!FAT",Rr.fat_addrs=Xe,Rr.ssz=ge;var Nr={},Jr=[],Di=[],eo=[];b(We,Rr,Zt,Jr,Fe,Nr,Di,rt),m(Di,eo,Jr),Jr.shift();var to={FileIndex:Di,FullPaths:eo};return ne&&ne.raw&&(to.raw={header:vt,sectors:Zt}),to}function d(oe){if(oe[oe.l]==80&&oe[oe.l+1]==75)return[0,0];oe.chk(Y,"Header Signature: "),oe.l+=16;var ne=oe.read_shift(2,"u");return[oe.read_shift(2,"u"),ne]}function f(oe,ne){var ue=9;switch(oe.l+=2,ue=oe.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}oe.chk("0600","Mini Sector Shift: "),oe.chk("000000000000","Reserved: ")}function h(oe,ne){for(var ue=Math.ceil(oe.length/ne)-1,ge=[],Fe=1;Fe<ue;++Fe)ge[Fe-1]=oe.slice(Fe*ne,(Fe+1)*ne);return ge[ue-1]=oe.slice(ue*ne),ge}function m(oe,ne,ue){for(var ge=0,Fe=0,De=0,We=0,rt=0,Le=ue.length,Xe=[],et=[];ge<Le;++ge)Xe[ge]=et[ge]=ge,ne[ge]=ue[ge];for(;rt<et.length;++rt)ge=et[rt],Fe=oe[ge].L,De=oe[ge].R,We=oe[ge].C,Xe[ge]===ge&&(Fe!==-1&&Xe[Fe]!==Fe&&(Xe[ge]=Xe[Fe]),De!==-1&&Xe[De]!==De&&(Xe[ge]=Xe[De])),We!==-1&&(Xe[We]=ge),Fe!==-1&&ge!=Xe[ge]&&(Xe[Fe]=Xe[ge],et.lastIndexOf(Fe)<rt&&et.push(Fe)),De!==-1&&ge!=Xe[ge]&&(Xe[De]=Xe[ge],et.lastIndexOf(De)<rt&&et.push(De));for(ge=1;ge<Le;++ge)Xe[ge]===ge&&(De!==-1&&Xe[De]!==De?Xe[ge]=Xe[De]:Fe!==-1&&Xe[Fe]!==Fe&&(Xe[ge]=Xe[Fe]));for(ge=1;ge<Le;++ge)if(oe[ge].type!==0){if(rt=ge,rt!=Xe[rt])do rt=Xe[rt],ne[ge]=ne[rt]+"/"+ne[ge];while(rt!==0&&Xe[rt]!==-1&&rt!=Xe[rt]);Xe[ge]=-1}for(ne[0]+="/",ge=1;ge<Le;++ge)oe[ge].type!==2&&(ne[ge]+="/")}function p(oe,ne,ue){for(var ge=oe.start,Fe=oe.size,De=[],We=ge;ue&&Fe>0&&We>=0;)De.push(ne.slice(We*T,We*T+T)),Fe-=T,We=zd(ue,We*4);return De.length===0?Ct(0):ba(De).slice(0,oe.size)}function x(oe,ne,ue,ge,Fe){var De=L;if(oe===L){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(oe!==-1){var We=ue[oe],rt=(ge>>>2)-1;if(!We)return;for(var Le=0;Le<rt&&(De=zd(We,Le*4))!==L;++Le)Fe.push(De);x(zd(We,ge-4),ne-1,ue,ge,Fe)}}function g(oe,ne,ue,ge,Fe){var De=[],We=[];Fe||(Fe=[]);var rt=ge-1,Le=0,Xe=0;for(Le=ne;Le>=0;){Fe[Le]=!0,De[De.length]=Le,We.push(oe[Le]);var et=ue[Math.floor(Le*4/ge)];if(Xe=Le*4&rt,ge<4+Xe)throw new Error("FAT boundary crossed: "+Le+" 4 "+ge);if(!oe[et])break;Le=zd(oe[et],Xe)}return{nodes:De,data:NP([We])}}function y(oe,ne,ue,ge){var Fe=oe.length,De=[],We=[],rt=[],Le=[],Xe=ge-1,et=0,dt=0,vt=0,Nt=0;for(et=0;et<Fe;++et)if(rt=[],vt=et+ne,vt>=Fe&&(vt-=Fe),!We[vt]){Le=[];var At=[];for(dt=vt;dt>=0;){At[dt]=!0,We[dt]=!0,rt[rt.length]=dt,Le.push(oe[dt]);var yt=ue[Math.floor(dt*4/ge)];if(Nt=dt*4&Xe,ge<4+Nt)throw new Error("FAT boundary crossed: "+dt+" 4 "+ge);if(!oe[yt]||(dt=zd(oe[yt],Nt),At[dt]))break}De[vt]={nodes:rt,data:NP([Le])}}return De}function b(oe,ne,ue,ge,Fe,De,We,rt){for(var Le=0,Xe=ge.length?2:0,et=ne[oe].data,dt=0,vt=0,Nt;dt<et.length;dt+=128){var At=et.slice(dt,dt+128);Va(At,64),vt=At.read_shift(2),Nt=uI(At,0,vt-Xe),ge.push(Nt);var yt={name:Nt,type:At.read_shift(1),color:At.read_shift(1),L:At.read_shift(4,"i"),R:At.read_shift(4,"i"),C:At.read_shift(4,"i"),clsid:At.read_shift(16),state:At.read_shift(4,"i"),start:0,size:0},Zt=At.read_shift(2)+At.read_shift(2)+At.read_shift(2)+At.read_shift(2);Zt!==0&&(yt.ct=F(At,At.l-8));var Rr=At.read_shift(2)+At.read_shift(2)+At.read_shift(2)+At.read_shift(2);Rr!==0&&(yt.mt=F(At,At.l-8)),yt.start=At.read_shift(4,"i"),yt.size=At.read_shift(4,"i"),yt.size<0&&yt.start<0&&(yt.size=yt.type=0,yt.start=L,yt.name=""),yt.type===5?(Le=yt.start,Fe>0&&Le!==L&&(ne[Le].name="!StreamData")):yt.size>=4096?(yt.storage="fat",ne[yt.start]===void 0&&(ne[yt.start]=g(ue,yt.start,ne.fat_addrs,ne.ssz)),ne[yt.start].name=yt.name,yt.content=ne[yt.start].data.slice(0,yt.size)):(yt.storage="minifat",yt.size<0?yt.size=0:Le!==L&&yt.start!==L&&ne[Le]&&(yt.content=p(yt,ne[Le].data,(ne[rt]||{}).data))),yt.content&&Va(yt.content,0),De[Nt]=yt,We.push(yt)}}function F(oe,ne){return new Date((wo(oe,ne+4)/1e7*Math.pow(2,32)+wo(oe,ne)/1e7-11644473600)*1e3)}function j(oe,ne){return A(),u(c.readFileSync(oe),ne)}function R(oe,ne){var ue=ne&&ne.type;switch(ue||Qr&&Buffer.isBuffer(oe)&&(ue="buffer"),ue||"base64"){case"file":return j(oe,ne);case"base64":return u(yo(Fo(oe)),ne);case"binary":return u(yo(oe),ne)}return u(oe,ne)}function E(oe,ne){var ue=ne||{},ge=ue.root||"Root Entry";if(oe.FullPaths||(oe.FullPaths=[]),oe.FileIndex||(oe.FileIndex=[]),oe.FullPaths.length!==oe.FileIndex.length)throw new Error("inconsistent CFB structure");oe.FullPaths.length===0&&(oe.FullPaths[0]=ge+"/",oe.FileIndex[0]={name:ge,type:5}),ue.CLSID&&(oe.FileIndex[0].clsid=ue.CLSID),S(oe)}function S(oe){var ne="Sh33tJ5";if(!pr.find(oe,"/"+ne)){var ue=Ct(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,oe.FileIndex.push({name:ne,type:2,content:ue,size:4,L:69,R:69,C:69}),oe.FullPaths.push(oe.FullPaths[0]+ne),B(oe)}}function B(oe,ne){E(oe);for(var ue=!1,ge=!1,Fe=oe.FullPaths.length-1;Fe>=0;--Fe){var De=oe.FileIndex[Fe];switch(De.type){case 0:ge?ue=!0:(oe.FileIndex.pop(),oe.FullPaths.pop());break;case 1:case 2:case 5:ge=!0,isNaN(De.R*De.L*De.C)&&(ue=!0),De.R>-1&&De.L>-1&&De.R==De.L&&(ue=!0);break;default:ue=!0;break}}if(!(!ue&&!ne)){var We=new Date(1987,1,19),rt=0,Le=Object.create?Object.create(null):{},Xe=[];for(Fe=0;Fe<oe.FullPaths.length;++Fe)Le[oe.FullPaths[Fe]]=!0,oe.FileIndex[Fe].type!==0&&Xe.push([oe.FullPaths[Fe],oe.FileIndex[Fe]]);for(Fe=0;Fe<Xe.length;++Fe){var et=n(Xe[Fe][0]);ge=Le[et],ge||(Xe.push([et,{name:s(et).replace("/",""),type:1,clsid:ae,ct:We,mt:We,content:null}]),Le[et]=!0)}for(Xe.sort(function(Nt,At){return r(Nt[0],At[0])}),oe.FullPaths=[],oe.FileIndex=[],Fe=0;Fe<Xe.length;++Fe)oe.FullPaths[Fe]=Xe[Fe][0],oe.FileIndex[Fe]=Xe[Fe][1];for(Fe=0;Fe<Xe.length;++Fe){var dt=oe.FileIndex[Fe],vt=oe.FullPaths[Fe];if(dt.name=s(vt).replace("/",""),dt.L=dt.R=dt.C=-(dt.color=1),dt.size=dt.content?dt.content.length:0,dt.start=0,dt.clsid=dt.clsid||ae,Fe===0)dt.C=Xe.length>1?1:-1,dt.size=0,dt.type=5;else if(vt.slice(-1)=="/"){for(rt=Fe+1;rt<Xe.length&&n(oe.FullPaths[rt])!=vt;++rt);for(dt.C=rt>=Xe.length?-1:rt,rt=Fe+1;rt<Xe.length&&n(oe.FullPaths[rt])!=n(vt);++rt);dt.R=rt>=Xe.length?-1:rt,dt.type=1}else n(oe.FullPaths[Fe+1]||"")==n(vt)&&(dt.R=Fe+1),dt.type=2}}}function U(oe,ne){var ue=ne||{};if(ue.fileType=="mad")return pt(oe,ue);switch(B(oe),ue.fileType){case"zip":return it(oe,ue)}var ge=function(Nt){for(var At=0,yt=0,Zt=0;Zt<Nt.FileIndex.length;++Zt){var Rr=Nt.FileIndex[Zt];if(Rr.content){var Nr=Rr.content.length;Nr>0&&(Nr<4096?At+=Nr+63>>6:yt+=Nr+511>>9)}}for(var Jr=Nt.FullPaths.length+3>>2,Di=At+7>>3,eo=At+127>>7,to=Di+yt+Jr+eo,xi=to+127>>7,ml=xi<=109?0:Math.ceil((xi-109)/127);to+xi+ml+127>>7>xi;)ml=++xi<=109?0:Math.ceil((xi-109)/127);var ts=[1,ml,xi,eo,Jr,yt,At,0];return Nt.FileIndex[0].size=At<<6,ts[7]=(Nt.FileIndex[0].start=ts[0]+ts[1]+ts[2]+ts[3]+ts[4]+ts[5])+(ts[6]+7>>3),ts}(oe),Fe=Ct(ge[7]<<9),De=0,We=0;{for(De=0;De<8;++De)Fe.write_shift(1,me[De]);for(De=0;De<8;++De)Fe.write_shift(2,0);for(Fe.write_shift(2,62),Fe.write_shift(2,3),Fe.write_shift(2,65534),Fe.write_shift(2,9),Fe.write_shift(2,6),De=0;De<3;++De)Fe.write_shift(2,0);for(Fe.write_shift(4,0),Fe.write_shift(4,ge[2]),Fe.write_shift(4,ge[0]+ge[1]+ge[2]+ge[3]-1),Fe.write_shift(4,0),Fe.write_shift(4,4096),Fe.write_shift(4,ge[3]?ge[0]+ge[1]+ge[2]-1:L),Fe.write_shift(4,ge[3]),Fe.write_shift(-4,ge[1]?ge[0]-1:L),Fe.write_shift(4,ge[1]),De=0;De<109;++De)Fe.write_shift(-4,De<ge[2]?ge[1]+De:-1)}if(ge[1])for(We=0;We<ge[1];++We){for(;De<236+We*127;++De)Fe.write_shift(-4,De<ge[2]?ge[1]+De:-1);Fe.write_shift(-4,We===ge[1]-1?L:We+1)}var rt=function(Nt){for(We+=Nt;De<We-1;++De)Fe.write_shift(-4,De+1);Nt&&(++De,Fe.write_shift(-4,L))};for(We=De=0,We+=ge[1];De<We;++De)Fe.write_shift(-4,fe.DIFSECT);for(We+=ge[2];De<We;++De)Fe.write_shift(-4,fe.FATSECT);rt(ge[3]),rt(ge[4]);for(var Le=0,Xe=0,et=oe.FileIndex[0];Le<oe.FileIndex.length;++Le)et=oe.FileIndex[Le],et.content&&(Xe=et.content.length,!(Xe<4096)&&(et.start=We,rt(Xe+511>>9)));for(rt(ge[6]+7>>3);Fe.l&511;)Fe.write_shift(-4,fe.ENDOFCHAIN);for(We=De=0,Le=0;Le<oe.FileIndex.length;++Le)et=oe.FileIndex[Le],et.content&&(Xe=et.content.length,!(!Xe||Xe>=4096)&&(et.start=We,rt(Xe+63>>6)));for(;Fe.l&511;)Fe.write_shift(-4,fe.ENDOFCHAIN);for(De=0;De<ge[4]<<2;++De){var dt=oe.FullPaths[De];if(!dt||dt.length===0){for(Le=0;Le<17;++Le)Fe.write_shift(4,0);for(Le=0;Le<3;++Le)Fe.write_shift(4,-1);for(Le=0;Le<12;++Le)Fe.write_shift(4,0);continue}et=oe.FileIndex[De],De===0&&(et.start=et.size?et.start-1:L);var vt=De===0&&ue.root||et.name;if(Xe=2*(vt.length+1),Fe.write_shift(64,vt,"utf16le"),Fe.write_shift(2,Xe),Fe.write_shift(1,et.type),Fe.write_shift(1,et.color),Fe.write_shift(-4,et.L),Fe.write_shift(-4,et.R),Fe.write_shift(-4,et.C),et.clsid)Fe.write_shift(16,et.clsid,"hex");else for(Le=0;Le<4;++Le)Fe.write_shift(4,0);Fe.write_shift(4,et.state||0),Fe.write_shift(4,0),Fe.write_shift(4,0),Fe.write_shift(4,0),Fe.write_shift(4,0),Fe.write_shift(4,et.start),Fe.write_shift(4,et.size),Fe.write_shift(4,0)}for(De=1;De<oe.FileIndex.length;++De)if(et=oe.FileIndex[De],et.size>=4096)if(Fe.l=et.start+1<<9,Qr&&Buffer.isBuffer(et.content))et.content.copy(Fe,Fe.l,0,et.size),Fe.l+=et.size+511&-512;else{for(Le=0;Le<et.size;++Le)Fe.write_shift(1,et.content[Le]);for(;Le&511;++Le)Fe.write_shift(1,0)}for(De=1;De<oe.FileIndex.length;++De)if(et=oe.FileIndex[De],et.size>0&&et.size<4096)if(Qr&&Buffer.isBuffer(et.content))et.content.copy(Fe,Fe.l,0,et.size),Fe.l+=et.size+63&-64;else{for(Le=0;Le<et.size;++Le)Fe.write_shift(1,et.content[Le]);for(;Le&63;++Le)Fe.write_shift(1,0)}if(Qr)Fe.l=Fe.length;else for(;Fe.l<Fe.length;)Fe.write_shift(1,0);return Fe}function k(oe,ne){var ue=oe.FullPaths.map(function(Le){return Le.toUpperCase()}),ge=ue.map(function(Le){var Xe=Le.split("/");return Xe[Xe.length-(Le.slice(-1)=="/"?2:1)]}),Fe=!1;ne.charCodeAt(0)===47?(Fe=!0,ne=ue[0].slice(0,-1)+ne):Fe=ne.indexOf("/")!==-1;var De=ne.toUpperCase(),We=Fe===!0?ue.indexOf(De):ge.indexOf(De);if(We!==-1)return oe.FileIndex[We];var rt=!De.match(Np);for(De=De.replace(Ti,""),rt&&(De=De.replace(Np,"!")),We=0;We<ue.length;++We)if((rt?ue[We].replace(Np,"!"):ue[We]).replace(Ti,"")==De||(rt?ge[We].replace(Np,"!"):ge[We]).replace(Ti,"")==De)return oe.FileIndex[We];return null}var T=64,L=-2,Y="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function de(oe,ne,ue){A();var ge=U(oe,ue);c.writeFileSync(ne,ge)}function Z(oe){for(var ne=new Array(oe.length),ue=0;ue<oe.length;++ue)ne[ue]=String.fromCharCode(oe[ue]);return ne.join("")}function xe(oe,ne){var ue=U(oe,ne);switch(ne&&ne.type||"buffer"){case"file":return A(),c.writeFileSync(ne.filename,ue),ue;case"binary":return typeof ue=="string"?ue:Z(ue);case"base64":return Jg(typeof ue=="string"?ue:Z(ue));case"buffer":if(Qr)return Buffer.isBuffer(ue)?ue:TA(ue);case"array":return typeof ue=="string"?yo(ue):ue}return ue}var Be;function I(oe){try{var ne=oe.InflateRaw,ue=new ne;if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),ue.bytesRead)Be=oe;else throw new Error("zlib does not expose bytesRead")}catch(ge){console.error("cannot use native zlib: "+(ge.message||ge))}}function C(oe,ne){if(!Be)return Te(oe,ne);var ue=Be.InflateRaw,ge=new ue,Fe=ge._processChunk(oe.slice(oe.l),ge._finishFlushFlag);return oe.l+=ge.bytesRead,Fe}function Q(oe){return Be?Be.deflateRawSync(oe):X(oe)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function O(oe){var ne=(oe<<1|oe<<11)&139536|(oe<<5|oe<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var te=typeof Uint8Array<"u",se=te?new Uint8Array(256):[],we=0;we<256;++we)se[we]=O(we);function q(oe,ne){var ue=se[oe&255];return ne<=8?ue>>>8-ne:(ue=ue<<8|se[oe>>8&255],ne<=16?ue>>>16-ne:(ue=ue<<8|se[oe>>16&255],ue>>>24-ne))}function Me(oe,ne){var ue=ne&7,ge=ne>>>3;return(oe[ge]|(ue<=6?0:oe[ge+1]<<8))>>>ue&3}function re(oe,ne){var ue=ne&7,ge=ne>>>3;return(oe[ge]|(ue<=5?0:oe[ge+1]<<8))>>>ue&7}function J(oe,ne){var ue=ne&7,ge=ne>>>3;return(oe[ge]|(ue<=4?0:oe[ge+1]<<8))>>>ue&15}function K(oe,ne){var ue=ne&7,ge=ne>>>3;return(oe[ge]|(ue<=3?0:oe[ge+1]<<8))>>>ue&31}function ie(oe,ne){var ue=ne&7,ge=ne>>>3;return(oe[ge]|(ue<=1?0:oe[ge+1]<<8))>>>ue&127}function pe(oe,ne,ue){var ge=ne&7,Fe=ne>>>3,De=(1<<ue)-1,We=oe[Fe]>>>ge;return ue<8-ge||(We|=oe[Fe+1]<<8-ge,ue<16-ge)||(We|=oe[Fe+2]<<16-ge,ue<24-ge)||(We|=oe[Fe+3]<<24-ge),We&De}function Ee(oe,ne,ue){var ge=ne&7,Fe=ne>>>3;return ge<=5?oe[Fe]|=(ue&7)<<ge:(oe[Fe]|=ue<<ge&255,oe[Fe+1]=(ue&7)>>8-ge),ne+3}function Ue(oe,ne,ue){var ge=ne&7,Fe=ne>>>3;return ue=(ue&1)<<ge,oe[Fe]|=ue,ne+1}function qe(oe,ne,ue){var ge=ne&7,Fe=ne>>>3;return ue<<=ge,oe[Fe]|=ue&255,ue>>>=8,oe[Fe+1]=ue,ne+8}function $e(oe,ne,ue){var ge=ne&7,Fe=ne>>>3;return ue<<=ge,oe[Fe]|=ue&255,ue>>>=8,oe[Fe+1]=ue&255,oe[Fe+2]=ue>>>8,ne+16}function st(oe,ne){var ue=oe.length,ge=2*ue>ne?2*ue:ne+5,Fe=0;if(ue>=ne)return oe;if(Qr){var De=sP(ge);if(oe.copy)oe.copy(De);else for(;Fe<oe.length;++Fe)De[Fe]=oe[Fe];return De}else if(te){var We=new Uint8Array(ge);if(We.set)We.set(oe);else for(;Fe<ue;++Fe)We[Fe]=oe[Fe];return We}return oe.length=ge,oe}function Se(oe){for(var ne=new Array(oe),ue=0;ue<oe;++ue)ne[ue]=0;return ne}function ze(oe,ne,ue){var ge=1,Fe=0,De=0,We=0,rt=0,Le=oe.length,Xe=te?new Uint16Array(32):Se(32);for(De=0;De<32;++De)Xe[De]=0;for(De=Le;De<ue;++De)oe[De]=0;Le=oe.length;var et=te?new Uint16Array(Le):Se(Le);for(De=0;De<Le;++De)Xe[Fe=oe[De]]++,ge<Fe&&(ge=Fe),et[De]=0;for(Xe[0]=0,De=1;De<=ge;++De)Xe[De+16]=rt=rt+Xe[De-1]<<1;for(De=0;De<Le;++De)rt=oe[De],rt!=0&&(et[De]=Xe[rt+16]++);var dt=0;for(De=0;De<Le;++De)if(dt=oe[De],dt!=0)for(rt=q(et[De],ge)>>ge-dt,We=(1<<ge+4-dt)-1;We>=0;--We)ne[rt|We<<dt]=dt&15|De<<4;return ge}var Ke=te?new Uint16Array(512):Se(512),be=te?new Uint16Array(32):Se(32);if(!te){for(var le=0;le<512;++le)Ke[le]=0;for(le=0;le<32;++le)be[le]=0}(function(){for(var oe=[],ne=0;ne<32;ne++)oe.push(5);ze(oe,be,32);var ue=[];for(ne=0;ne<=143;ne++)ue.push(8);for(;ne<=255;ne++)ue.push(9);for(;ne<=279;ne++)ue.push(7);for(;ne<=287;ne++)ue.push(8);ze(ue,Ke,288)})();var je=function(){for(var ne=te?new Uint8Array(32768):[],ue=0,ge=0;ue<z.length-1;++ue)for(;ge<z[ue+1];++ge)ne[ge]=ue;for(;ge<32768;++ge)ne[ge]=29;var Fe=te?new Uint8Array(259):[];for(ue=0,ge=0;ue<D.length-1;++ue)for(;ge<D[ue+1];++ge)Fe[ge]=ue;function De(rt,Le){for(var Xe=0;Xe<rt.length;){var et=Math.min(65535,rt.length-Xe),dt=Xe+et==rt.length;for(Le.write_shift(1,+dt),Le.write_shift(2,et),Le.write_shift(2,~et&65535);et-- >0;)Le[Le.l++]=rt[Xe++]}return Le.l}function We(rt,Le){for(var Xe=0,et=0,dt=te?new Uint16Array(32768):[];et<rt.length;){var vt=Math.min(65535,rt.length-et);if(vt<10){for(Xe=Ee(Le,Xe,+(et+vt==rt.length)),Xe&7&&(Xe+=8-(Xe&7)),Le.l=Xe/8|0,Le.write_shift(2,vt),Le.write_shift(2,~vt&65535);vt-- >0;)Le[Le.l++]=rt[et++];Xe=Le.l*8;continue}Xe=Ee(Le,Xe,+(et+vt==rt.length)+2);for(var Nt=0;vt-- >0;){var At=rt[et];Nt=(Nt<<5^At)&32767;var yt=-1,Zt=0;if((yt=dt[Nt])&&(yt|=et&-32768,yt>et&&(yt-=32768),yt<et))for(;rt[yt+Zt]==rt[et+Zt]&&Zt<250;)++Zt;if(Zt>2){At=Fe[Zt],At<=22?Xe=qe(Le,Xe,se[At+1]>>1)-1:(qe(Le,Xe,3),Xe+=5,qe(Le,Xe,se[At-23]>>5),Xe+=3);var Rr=At<8?0:At-4>>2;Rr>0&&($e(Le,Xe,Zt-D[At]),Xe+=Rr),At=ne[et-yt],Xe=qe(Le,Xe,se[At]>>3),Xe-=3;var Nr=At<4?0:At-2>>1;Nr>0&&($e(Le,Xe,et-yt-z[At]),Xe+=Nr);for(var Jr=0;Jr<Zt;++Jr)dt[Nt]=et&32767,Nt=(Nt<<5^rt[et])&32767,++et;vt-=Zt-1}else At<=143?At=At+48:Xe=Ue(Le,Xe,1),Xe=qe(Le,Xe,se[At]),dt[Nt]=et&32767,++et}Xe=qe(Le,Xe,0)-1}return Le.l=(Xe+7)/8|0,Le.l}return function(Le,Xe){return Le.length<8?De(Le,Xe):We(Le,Xe)}}();function X(oe){var ne=Ct(50+Math.floor(oe.length*1.1)),ue=je(oe,ne);return ne.slice(0,ue)}var G=te?new Uint16Array(32768):Se(32768),ye=te?new Uint16Array(32768):Se(32768),Oe=te?new Uint16Array(128):Se(128),_e=1,he=1;function Ce(oe,ne){var ue=K(oe,ne)+257;ne+=5;var ge=K(oe,ne)+1;ne+=5;var Fe=J(oe,ne)+4;ne+=4;for(var De=0,We=te?new Uint8Array(19):Se(19),rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Le=1,Xe=te?new Uint8Array(8):Se(8),et=te?new Uint8Array(8):Se(8),dt=We.length,vt=0;vt<Fe;++vt)We[M[vt]]=De=re(oe,ne),Le<De&&(Le=De),Xe[De]++,ne+=3;var Nt=0;for(Xe[0]=0,vt=1;vt<=Le;++vt)et[vt]=Nt=Nt+Xe[vt-1]<<1;for(vt=0;vt<dt;++vt)(Nt=We[vt])!=0&&(rt[vt]=et[Nt]++);var At=0;for(vt=0;vt<dt;++vt)if(At=We[vt],At!=0){Nt=se[rt[vt]]>>8-At;for(var yt=(1<<7-At)-1;yt>=0;--yt)Oe[Nt|yt<<At]=At&7|vt<<3}var Zt=[];for(Le=1;Zt.length<ue+ge;)switch(Nt=Oe[ie(oe,ne)],ne+=Nt&7,Nt>>>=3){case 16:for(De=3+Me(oe,ne),ne+=2,Nt=Zt[Zt.length-1];De-- >0;)Zt.push(Nt);break;case 17:for(De=3+re(oe,ne),ne+=3;De-- >0;)Zt.push(0);break;case 18:for(De=11+ie(oe,ne),ne+=7;De-- >0;)Zt.push(0);break;default:Zt.push(Nt),Le<Nt&&(Le=Nt);break}var Rr=Zt.slice(0,ue),Nr=Zt.slice(ue);for(vt=ue;vt<286;++vt)Rr[vt]=0;for(vt=ge;vt<30;++vt)Nr[vt]=0;return _e=ze(Rr,G,286),he=ze(Nr,ye,30),ne}function Ze(oe,ne){if(oe[0]==3&&!(oe[1]&3))return[ad(ne),2];for(var ue=0,ge=0,Fe=sP(ne||1<<18),De=0,We=Fe.length>>>0,rt=0,Le=0;!(ge&1);){if(ge=re(oe,ue),ue+=3,ge>>>1)ge>>1==1?(rt=9,Le=5):(ue=Ce(oe,ue),rt=_e,Le=he);else{ue&7&&(ue+=8-(ue&7));var Xe=oe[ue>>>3]|oe[(ue>>>3)+1]<<8;if(ue+=32,Xe>0)for(!ne&&We<De+Xe&&(Fe=st(Fe,De+Xe),We=Fe.length);Xe-- >0;)Fe[De++]=oe[ue>>>3],ue+=8;continue}for(;;){!ne&&We<De+32767&&(Fe=st(Fe,De+32767),We=Fe.length);var et=pe(oe,ue,rt),dt=ge>>>1==1?Ke[et]:G[et];if(ue+=dt&15,dt>>>=4,!(dt>>>8&255))Fe[De++]=dt;else{if(dt==256)break;dt-=257;var vt=dt<8?0:dt-4>>2;vt>5&&(vt=0);var Nt=De+D[dt];vt>0&&(Nt+=pe(oe,ue,vt),ue+=vt),et=pe(oe,ue,Le),dt=ge>>>1==1?be[et]:ye[et],ue+=dt&15,dt>>>=4;var At=dt<4?0:dt-2>>1,yt=z[dt];for(At>0&&(yt+=pe(oe,ue,At),ue+=At),!ne&&We<Nt&&(Fe=st(Fe,Nt+100),We=Fe.length);De<Nt;)Fe[De]=Fe[De-yt],++De}}}return ne?[Fe,ue+7>>>3]:[Fe.slice(0,De),ue+7>>>3]}function Te(oe,ne){var ue=oe.slice(oe.l||0),ge=Ze(ue,ne);return oe.l+=ge[1],ge[0]}function Ge(oe,ne){if(oe)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function at(oe,ne){var ue=oe;Va(ue,0);var ge=[],Fe=[],De={FileIndex:ge,FullPaths:Fe};E(De,{root:ne.root});for(var We=ue.length-4;(ue[We]!=80||ue[We+1]!=75||ue[We+2]!=5||ue[We+3]!=6)&&We>=0;)--We;ue.l=We+4,ue.l+=4;var rt=ue.read_shift(2);ue.l+=6;var Le=ue.read_shift(4);for(ue.l=Le,We=0;We<rt;++We){ue.l+=20;var Xe=ue.read_shift(4),et=ue.read_shift(4),dt=ue.read_shift(2),vt=ue.read_shift(2),Nt=ue.read_shift(2);ue.l+=8;var At=ue.read_shift(4),yt=l(ue.slice(ue.l+dt,ue.l+dt+vt));ue.l+=dt+vt+Nt;var Zt=ue.l;ue.l=At+4,wt(ue,Xe,et,De,yt),ue.l=Zt}return De}function wt(oe,ne,ue,ge,Fe){oe.l+=2;var De=oe.read_shift(2),We=oe.read_shift(2),rt=o(oe);if(De&8257)throw new Error("Unsupported ZIP encryption");for(var Le=oe.read_shift(4),Xe=oe.read_shift(4),et=oe.read_shift(4),dt=oe.read_shift(2),vt=oe.read_shift(2),Nt="",At=0;At<dt;++At)Nt+=String.fromCharCode(oe[oe.l++]);if(vt){var yt=l(oe.slice(oe.l,oe.l+vt));(yt[21589]||{}).mt&&(rt=yt[21589].mt),((Fe||{})[21589]||{}).mt&&(rt=Fe[21589].mt)}oe.l+=vt;var Zt=oe.slice(oe.l,oe.l+Xe);switch(We){case 8:Zt=C(oe,et);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var Rr=!1;De&8&&(Le=oe.read_shift(4),Le==134695760&&(Le=oe.read_shift(4),Rr=!0),Xe=oe.read_shift(4),et=oe.read_shift(4)),Xe!=ne&&Ge(Rr,"Bad compressed size: "+ne+" != "+Xe),et!=ue&&Ge(Rr,"Bad uncompressed size: "+ue+" != "+et),Tt(ge,Nt,Zt,{unsafe:!0,mt:rt})}function it(oe,ne){var ue=ne||{},ge=[],Fe=[],De=Ct(1),We=ue.compression?8:0,rt=0,Le=0,Xe=0,et=0,dt=0,vt=oe.FullPaths[0],Nt=vt,At=oe.FileIndex[0],yt=[],Zt=0;for(Le=1;Le<oe.FullPaths.length;++Le)if(Nt=oe.FullPaths[Le].slice(vt.length),At=oe.FileIndex[Le],!(!At.size||!At.content||Nt=="Sh33tJ5")){var Rr=et,Nr=Ct(Nt.length);for(Xe=0;Xe<Nt.length;++Xe)Nr.write_shift(1,Nt.charCodeAt(Xe)&127);Nr=Nr.slice(0,Nr.l),yt[dt]=mce.buf(At.content,0);var Jr=At.content;We==8&&(Jr=Q(Jr)),De=Ct(30),De.write_shift(4,67324752),De.write_shift(2,20),De.write_shift(2,rt),De.write_shift(2,We),At.mt?a(De,At.mt):De.write_shift(4,0),De.write_shift(-4,yt[dt]),De.write_shift(4,Jr.length),De.write_shift(4,At.content.length),De.write_shift(2,Nr.length),De.write_shift(2,0),et+=De.length,ge.push(De),et+=Nr.length,ge.push(Nr),et+=Jr.length,ge.push(Jr),De=Ct(46),De.write_shift(4,33639248),De.write_shift(2,0),De.write_shift(2,20),De.write_shift(2,rt),De.write_shift(2,We),De.write_shift(4,0),De.write_shift(-4,yt[dt]),De.write_shift(4,Jr.length),De.write_shift(4,At.content.length),De.write_shift(2,Nr.length),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(4,0),De.write_shift(4,Rr),Zt+=De.l,Fe.push(De),Zt+=Nr.length,Fe.push(Nr),++dt}return De=Ct(22),De.write_shift(4,101010256),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,dt),De.write_shift(2,dt),De.write_shift(4,Zt),De.write_shift(4,et),De.write_shift(2,0),ba([ba(ge),ba(Fe),De])}var xt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lt(oe,ne){if(oe.ctype)return oe.ctype;var ue=oe.name||"",ge=ue.match(/\.([^\.]+)$/);return ge&&xt[ge[1]]||ne&&(ge=(ue=ne).match(/[\.\\]([^\.\\])+$/),ge&&xt[ge[1]])?xt[ge[1]]:"application/octet-stream"}function hr(oe){for(var ne=Jg(oe),ue=[],ge=0;ge<ne.length;ge+=76)ue.push(ne.slice(ge,ge+76));return ue.join(`\r
`)+`\r
`}function lr(oe){var ne=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Xe){var et=Xe.charCodeAt(0).toString(16).toUpperCase();return"="+(et.length==1?"0"+et:et)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ue=[],ge=ne.split(`\r
`),Fe=0;Fe<ge.length;++Fe){var De=ge[Fe];if(De.length==0){ue.push("");continue}for(var We=0;We<De.length;){var rt=76,Le=De.slice(We,We+rt);Le.charAt(rt-1)=="="?rt--:Le.charAt(rt-2)=="="?rt-=2:Le.charAt(rt-3)=="="&&(rt-=3),Le=De.slice(We,We+rt),We+=rt,We<De.length&&(Le+="="),ue.push(Le)}}return ue.join(`\r
`)}function gr(oe){for(var ne=[],ue=0;ue<oe.length;++ue){for(var ge=oe[ue];ue<=oe.length&&ge.charAt(ge.length-1)=="=";)ge=ge.slice(0,ge.length-1)+oe[++ue];ne.push(ge)}for(var Fe=0;Fe<ne.length;++Fe)ne[Fe]=ne[Fe].replace(/[=][0-9A-Fa-f]{2}/g,function(De){return String.fromCharCode(parseInt(De.slice(1),16))});return yo(ne.join(`\r
`))}function xr(oe,ne,ue){for(var ge="",Fe="",De="",We,rt=0;rt<10;++rt){var Le=ne[rt];if(!Le||Le.match(/^\s*$/))break;var Xe=Le.match(/^(.*?):\s*([^\s].*)$/);if(Xe)switch(Xe[1].toLowerCase()){case"content-location":ge=Xe[2].trim();break;case"content-type":De=Xe[2].trim();break;case"content-transfer-encoding":Fe=Xe[2].trim();break}}switch(++rt,Fe.toLowerCase()){case"base64":We=yo(Fo(ne.slice(rt).join("")));break;case"quoted-printable":We=gr(ne.slice(rt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Fe)}var et=Tt(oe,ge.slice(ue.length),We,{unsafe:!0});De&&(et.ctype=De)}function Ye(oe,ne){if(Z(oe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ue=ne&&ne.root||"",ge=(Qr&&Buffer.isBuffer(oe)?oe.toString("binary"):Z(oe)).split(`\r
`),Fe=0,De="";for(Fe=0;Fe<ge.length;++Fe)if(De=ge[Fe],!!/^Content-Location:/i.test(De)&&(De=De.slice(De.indexOf("file")),ue||(ue=De.slice(0,De.lastIndexOf("/")+1)),De.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=ue.slice(0,ue.length-1),ue=ue.slice(0,ue.lastIndexOf("/")+1),De.slice(0,ue.length)!=ue););var We=(ge[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var rt="--"+(We[1]||""),Le=[],Xe=[],et={FileIndex:Le,FullPaths:Xe};E(et);var dt,vt=0;for(Fe=0;Fe<ge.length;++Fe){var Nt=ge[Fe];Nt!==rt&&Nt!==rt+"--"||(vt++&&xr(et,ge.slice(dt,Fe),ue),dt=Fe)}return et}function pt(oe,ne){var ue=ne||{},ge=ue.boundary||"SheetJS";ge="------="+ge;for(var Fe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ge.slice(2)+'"',"","",""],De=oe.FullPaths[0],We=De,rt=oe.FileIndex[0],Le=1;Le<oe.FullPaths.length;++Le)if(We=oe.FullPaths[Le].slice(De.length),rt=oe.FileIndex[Le],!(!rt.size||!rt.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Zt){return"_x"+Zt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Zt){return"_u"+Zt.charCodeAt(0).toString(16)+"_"});for(var Xe=rt.content,et=Qr&&Buffer.isBuffer(Xe)?Xe.toString("binary"):Z(Xe),dt=0,vt=Math.min(1024,et.length),Nt=0,At=0;At<=vt;++At)(Nt=et.charCodeAt(At))>=32&&Nt<128&&++dt;var yt=dt>=vt*4/5;Fe.push(ge),Fe.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+We),Fe.push("Content-Transfer-Encoding: "+(yt?"quoted-printable":"base64")),Fe.push("Content-Type: "+Lt(rt,We)),Fe.push(""),Fe.push(yt?lr(et):hr(et))}return Fe.push(ge+`--\r
`),Fe.join(`\r
`)}function Rt(oe){var ne={};return E(ne,oe),ne}function Tt(oe,ne,ue,ge){var Fe=ge&&ge.unsafe;Fe||E(oe);var De=!Fe&&pr.find(oe,ne);if(!De){var We=oe.FullPaths[0];ne.slice(0,We.length)==We?We=ne:(We.slice(-1)!="/"&&(We+="/"),We=(We+ne).replace("//","/")),De={name:s(ne),type:2},oe.FileIndex.push(De),oe.FullPaths.push(We),Fe||pr.utils.cfb_gc(oe)}return De.content=ue,De.size=ue?ue.length:0,ge&&(ge.CLSID&&(De.clsid=ge.CLSID),ge.mt&&(De.mt=ge.mt),ge.ct&&(De.ct=ge.ct)),De}function Dt(oe,ne){E(oe);var ue=pr.find(oe,ne);if(ue){for(var ge=0;ge<oe.FileIndex.length;++ge)if(oe.FileIndex[ge]==ue)return oe.FileIndex.splice(ge,1),oe.FullPaths.splice(ge,1),!0}return!1}function Xt(oe,ne,ue){E(oe);var ge=pr.find(oe,ne);if(ge){for(var Fe=0;Fe<oe.FileIndex.length;++Fe)if(oe.FileIndex[Fe]==ge)return oe.FileIndex[Fe].name=s(ue),oe.FullPaths[Fe]=ue,!0}return!1}function Kt(oe){B(oe,!0)}return e.find=k,e.read=R,e.parse=u,e.write=xe,e.writeFile=de,e.utils={cfb_new:Rt,cfb_add:Tt,cfb_del:Dt,cfb_mov:Xt,cfb_gc:Kt,ReadShift:Zp,CheckField:P8,prep_blob:Va,bconcat:ba,use_zlib:I,_deflateRaw:X,_inflateRaw:Te,consts:fe},e}();function pce(t){return typeof t=="string"?Gy(t):Array.isArray(t)?Vle(t):t}function Dx(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Gy(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?xc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([pce(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=gd(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function gce(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ks(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function dP(t,e){for(var r=[],n=ks(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function zy(t){for(var e=[],r=ks(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Wy(t){for(var e=[],r=ks(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function xce(t){for(var e=[],r=ks(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var S2=new Date(1899,11,30,0,0,0);function da(t,e){var r=t.getTime(),n=S2.getTime()+(t.getTimezoneOffset()-S2.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var h8=new Date,vce=S2.getTime()+(h8.getTimezoneOffset()-S2.getTimezoneOffset())*6e4,hP=h8.getTimezoneOffset();function Jy(t){var e=new Date;return e.setTime(t*24*60*60*1e3+vce),e.getTimezoneOffset()!==hP&&e.setTime(e.getTime()+(e.getTimezoneOffset()-hP)*6e4),e}function wce(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var fP=new Date("2017-02-19T19:06:09.000Z"),f8=isNaN(fP.getFullYear())?new Date("2/19/17"):fP,yce=f8.getFullYear()==2017;function Zn(t,e){var r=new Date(t);if(yce)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(f8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function jh(t,e){if(Qr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return xc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return xc(t8(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return xc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return xc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function es(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=es(t[r]));return e}function Ss(t,e){for(var r="";r.length<e;)r+=t;return r}function Ll(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var bce=["january","february","march","april","may","june","july","august","september","october","november","december"];function V0(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&bce.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Nce=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(s),o.push(a[l]);return o}}();function m8(t){return t?t.content&&t.type?jh(t.content,!0):t.data?bp(t.data):t.asNodeBuffer&&Qr?bp(t.asNodeBuffer().toString("binary")):t.asBinary?bp(t.asBinary()):t._data&&t._data.getContent?bp(jh(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function p8(t){if(!t)return null;if(t.data)return rP(t.data);if(t.asNodeBuffer&&Qr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?rP(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Cce(t){return t&&t.name.slice(-4)===".bin"?p8(t):m8(t)}function Yo(t,e){for(var r=t.FullPaths||ks(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function aI(t,e){var r=Yo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function zs(t,e,r){if(!r)return Cce(aI(t,e));if(!e)return null;try{return zs(t,e)}catch{return null}}function bo(t,e,r){if(!r)return m8(aI(t,e));if(!e)return null;try{return bo(t,e)}catch{return null}}function _ce(t,e,r){return p8(aI(t,e))}function mP(t){for(var e=t.FullPaths||ks(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Or(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Qr?n=TA(r):n=Hle(r),pr.utils.cfb_add(t,e,n)}pr.utils.cfb_add(t,e,r)}else t.file(e,r)}function iI(){return pr.utils.cfb_new()}function g8(t,e){switch(e.type){case"base64":return pr.read(t,{type:"base64"});case"binary":return pr.read(t,{type:"binary"});case"buffer":case"array":return pr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Cp(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var qs=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Ece=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,pP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Bce=/<[^>]*>/g,gi=qs.match(pP)?pP:Bce,Sce=/<\w*:/,Ice=/<(\/?)\w+:/;function Cr(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var o=t.match(Ece),l=0,c="",A=0,u="",d="",f=1;if(o)for(A=0;A!=o.length;++A){for(d=o[A],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(u=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(f=(s=d.charCodeAt(a+1))==34||s==39?1:0,c=d.slice(a+1+f,d.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[h]&&u.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function kc(t){return t.replace(Ice,"<$1")}var x8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},oI=zy(x8),An=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(l,c){return x8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,o)+r(s.slice(o+3))}}(),lI=/[&<>'"]/g,Fce=/[\u0000-\u0008\u000b-\u001f]/g;function In(t){var e=t+"";return e.replace(lI,function(r){return oI[r]}).replace(Fce,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function gP(t){return In(t).replace(/ /g,"_x0020_")}var v8=/[\u0000-\u001f]/g;function cI(t){var e=t+"";return e.replace(lI,function(r){return oI[r]}).replace(/\n/g,"<br/>").replace(v8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function kce(t){var e=t+"";return e.replace(lI,function(r){return oI[r]}).replace(v8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var xP=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Tce(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Jn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function XN(t){for(var e="",r=0,n=0,s=0,a=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function vP(t){var e=ad(2*t.length),r,n,s=1,a=0,o=0,l;for(n=0;n<t.length;n+=s)s=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function wP(t){return TA(t,"binary").toString("utf8")}var yv="foo bar baz",jn=Qr&&(wP(yv)==XN(yv)&&wP||vP(yv)==XN(yv)&&vP)||XN,xc=Qr?function(t){return TA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Yg=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),w8=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),jce=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Pce=/<\/?(?:vt:)?variant>/g,Rce=/<(?:vt:)([^>]*)>([\s\S]*)</;function yP(t,e){var r=Cr(t),n=t.match(jce(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var o=a.replace(Pce,"").match(Rce);o&&s.push({v:jn(o[2]),t:o[1]})}),s}var y8=/(^\s|\s$|\n)/;function Ka(t,e){return"<"+t+(e.match(y8)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Zg(t){return ks(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function $t(t,e,r){return"<"+t+(r!=null?Zg(r):"")+(e!=null?(e.match(y8)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function _E(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Dce(t,e){switch(typeof t){case"string":var r=$t("vt:lpwstr",In(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return $t((t|0)==t?"vt:i4":"vt:r8",In(String(t)));case"boolean":return $t("vt:bool",t?"true":"false")}if(t instanceof Date)return $t("vt:filetime",_E(t));throw new Error("Unable to serialize "+t)}function AI(t){if(Qr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return jn(gd(rI(t)));throw new Error("Bad input format: expected Buffer or string")}var ex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ca={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Jh=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],vo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Lce(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Uce(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,o=n?-e:e;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var l=0;l<=5;++l,a/=256)t[r+l]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var bP=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},NP=Qr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:TA(e)})):bP(t)}:bP,CP=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(lA(t,s)));return n.join("").replace(Ti,"")},uI=Qr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ti,""):CP(t,e,r)}:CP,_P=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},b8=Qr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):_P(t,e,r)}:_P,EP=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Gf(t,s)));return n.join("")},Lx=Qr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):EP(e,r,n)}:EP,N8=function(t,e){var r=wo(t,e);return r>0?Lx(t,e+4,e+4+r-1):""},C8=N8,_8=function(t,e){var r=wo(t,e);return r>0?Lx(t,e+4,e+4+r-1):""},E8=_8,B8=function(t,e){var r=2*wo(t,e);return r>0?Lx(t,e+4,e+4+r-1):""},S8=B8,I8=function(e,r){var n=wo(e,r);return n>0?uI(e,r+4,r+4+n):""},F8=I8,k8=function(t,e){var r=wo(t,e);return r>0?Lx(t,e+4,e+4+r):""},T8=k8,j8=function(t,e){return Lce(t,e)},I2=j8,dI=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Qr&&(C8=function(e,r){if(!Buffer.isBuffer(e))return N8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},E8=function(e,r){if(!Buffer.isBuffer(e))return _8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},S8=function(e,r){if(!Buffer.isBuffer(e))return B8(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},F8=function(e,r){if(!Buffer.isBuffer(e))return I8(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},T8=function(e,r){if(!Buffer.isBuffer(e))return k8(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},I2=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):j8(e,r)},dI=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Gf=function(t,e){return t[e]},lA=function(t,e){return t[e+1]*256+t[e]},Oce=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},wo=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},zd=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Mce=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Zp(t,e){var r="",n,s,a=[],o,l,c,A;switch(e){case"dbcs":if(A=this.l,Qr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(lA(this,A)),A+=2;t*=2;break;case"utf8":r=Lx(this,this.l,this.l+t);break;case"utf16le":t*=2,r=uI(this,this.l,this.l+t);break;case"wstr":return Zp.call(this,t,"dbcs");case"lpstr-ansi":r=C8(this,this.l),t=4+wo(this,this.l);break;case"lpstr-cp":r=E8(this,this.l),t=4+wo(this,this.l);break;case"lpwstr":r=S8(this,this.l),t=4+2*wo(this,this.l);break;case"lpp4":t=4+wo(this,this.l),r=F8(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+wo(this,this.l),r=T8(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Gf(this,this.l+t++))!==0;)a.push(wv(o));r=a.join("");break;case"_wstr":for(t=0,r="";(o=lA(this,this.l+t))!==0;)a.push(wv(o)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",A=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=Gf(this,A),this.l=A+1,l=Zp.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(wv(lA(this,A))),A+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",A=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=Gf(this,A),this.l=A+1,l=Zp.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(wv(Gf(this,A))),A+=1}r=a.join("");break;default:switch(t){case 1:return n=Gf(this,this.l),this.l++,n;case 2:return n=(e==="i"?Oce:lA)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?zd:Mce)(this,this.l),this.l+=4,n):(s=wo(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=I2(this,this.l):s=I2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=b8(this,this.l,t);break}}return this.l+=t,r}var Qce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Vce=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Hce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Kce(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)Hce(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Qce(this,e,this.l);break;case 8:if(n=8,r==="f"){Uce(this,e,this.l);break}case 16:break;case-4:n=4,Vce(this,e,this.l);break}return this.l+=n,this}function P8(t,e){var r=b8(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Va(t,e){t.l=e,t.read_shift=Zp,t.chk=P8,t.write_shift=Kce}function pi(t,e){t.l+=e}function Ct(t){var e=ad(t);return Va(e,0),e}function jA(t,e,r){if(t){var n,s,a;Va(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var A=ix[l]||ix[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;c=t.l+a;var u=A.f&&A.f(t,a,r);if(t.l=c,e(u,A,l))return}}}function Xi(){var t=[],e=Qr?256:2048,r=function(A){var u=Ct(A);return Va(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(A){return n&&A<n.length-n.l?n:(s(),n=r(Math.max(A+1,e)))},o=function(){return s(),ba(t)},l=function(A){s(),n=A,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:l,end:o,_bufs:t}}function jt(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=ix[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=t.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&dI(r)&&t.push(r)}}function eg(t,e,r){var n=es(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function BP(t,e,r){var n=es(t);return n.s=eg(n.s,e.s,r),n.e=eg(n.e,e.s,r),n}function tg(t,e){if(t.cRel&&t.c<0)for(t=es(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=es(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=br(t);return!t.cRel&&t.cRel!=null&&(r=$ce(r)),!t.rRel&&t.rRel!=null&&(r=qce(r)),r}function YN(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+xs(t.s.c)+":"+(t.e.cRel?"":"$")+xs(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Hs(t.s.r)+":"+(t.e.rRel?"":"$")+Hs(t.e.r):tg(t.s,e.biff)+":"+tg(t.e,e.biff)}function hI(t){return parseInt(Gce(t),10)-1}function Hs(t){return""+(t+1)}function qce(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Gce(t){return t.replace(/\$(\d+)$/,"$1")}function fI(t){for(var e=zce(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function xs(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function $ce(t){return t.replace(/^([A-Z])/,"$$$1")}function zce(t){return t.replace(/^\$([A-Z])/,"$1")}function Wce(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vs(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function br(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Yi(t){var e=t.indexOf(":");return e==-1?{s:vs(t),e:vs(t)}:{s:vs(t.slice(0,e)),e:vs(t.slice(e+1))}}function Pr(t,e){return typeof e>"u"||typeof e=="number"?Pr(t.s,t.e):(typeof t!="string"&&(t=br(t)),typeof e!="string"&&(e=br(e)),t==e?t:t+":"+e)}function un(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function SP(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=hl(t.z,r?da(e):e)}catch{}try{return t.w=hl((t.XF||{}).numFmtId||(r?14:0),r?da(e):e)}catch{return""+e}}function SA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?PA[t.v]||t.v:e==null?SP(t,t.v):SP(t,e))}function xd(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function R8(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?vs(n.origin):n.origin;o=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=un(a["!ref"]);A.s.c=u.s.c,A.s.r=u.s.r,A.e.c=Math.max(A.e.c,u.e.c),A.e.r=Math.max(A.e.r,u.e.r),o==-1&&(A.e.r=o=u.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[d].length;++f)if(!(typeof e[d][f]>"u")){var h={v:e[d][f]},m=o+d,p=l+f;if(A.s.r>m&&(A.s.r=m),A.s.c>p&&(A.s.c=p),A.e.r<m&&(A.e.r=m),A.e.c<p&&(A.e.c=p),e[d][f]&&typeof e[d][f]=="object"&&!Array.isArray(e[d][f])&&!(e[d][f]instanceof Date))h=e[d][f];else if(Array.isArray(h.v)&&(h.f=e[d][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||yr[14],n.cellDates?(h.t="d",h.w=hl(h.z,da(h.v))):(h.t="n",h.v=da(h.v),h.w=hl(h.z,h.v))):h.t="s";if(s)a[m]||(a[m]=[]),a[m][p]&&a[m][p].z&&(h.z=a[m][p].z),a[m][p]=h;else{var x=br({c:p,r:m});a[x]&&a[x].z&&(h.z=a[x].z),a[x]=h}}}return A.s.c<1e7&&(a["!ref"]=Pr(A)),a}function Am(t,e){return R8(null,t,e)}function Jce(t){return t.read_shift(4,"i")}function Ul(t,e){return e||(e=Ct(4)),e.write_shift(4,t),e}function fi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ca(t,e){var r=!1;return e==null&&(r=!0,e=Ct(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Xce(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Yce(t,e){return e||(e=Ct(4)),e.write_shift(2,0),e.write_shift(2,0),e}function mI(t,e){var r=t.l,n=t.read_shift(1),s=fi(t),a=[],o={t:s,h:s};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)a.push(Xce(t));o.r=a}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function Zce(t,e){var r=!1;return e==null&&(r=!0,e=Ct(15+4*t.t.length)),e.write_shift(1,0),Ca(t.t,e),r?e.slice(0,e.l):e}var eAe=mI;function tAe(t,e){var r=!1;return e==null&&(r=!0,e=Ct(23+4*t.t.length)),e.write_shift(1,1),Ca(t.t,e),e.write_shift(4,1),Yce({},e),r?e.slice(0,e.l):e}function fl(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Xh(t,e){return e==null&&(e=Ct(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Yh(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Zh(t,e){return e==null&&(e=Ct(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var rAe=fi,D8=Ca;function pI(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function F2(t,e){var r=!1;return e==null&&(r=!0,e=Ct(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var nAe=fi,EE=pI,gI=F2;function xI(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?I2([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):zd(e,0)>>2;return r?s/100:s}function L8(t,e){e==null&&(e=Ct(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function U8(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function sAe(t,e){return e||(e=Ct(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ef=U8,um=sAe;function hi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ph(t,e){return(e||Ct(8)).write_shift(8,t,"f")}function aAe(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var A=uh[s];A&&(e.rgb=rx(A));break;case 2:e.rgb=rx([o,l,c]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function k2(t,e){if(e||(e=Ct(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function iAe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function oAe(t,e){e||(e=Ct(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function O8(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function lAe(t){return O8(t,1)}function cAe(t){return O8(t,2)}var vI=2,Vi=3,bv=11,IP=12,T2=19,Nv=64,AAe=65,uAe=71,dAe=4108,hAe=4126,wa=80,M8=81,fAe=[wa,M8],BE={1:{n:"CodePage",t:vI},2:{n:"Category",t:wa},3:{n:"PresentationFormat",t:wa},4:{n:"ByteCount",t:Vi},5:{n:"LineCount",t:Vi},6:{n:"ParagraphCount",t:Vi},7:{n:"SlideCount",t:Vi},8:{n:"NoteCount",t:Vi},9:{n:"HiddenCount",t:Vi},10:{n:"MultimediaClipCount",t:Vi},11:{n:"ScaleCrop",t:bv},12:{n:"HeadingPairs",t:dAe},13:{n:"TitlesOfParts",t:hAe},14:{n:"Manager",t:wa},15:{n:"Company",t:wa},16:{n:"LinksUpToDate",t:bv},17:{n:"CharacterCount",t:Vi},19:{n:"SharedDoc",t:bv},22:{n:"HyperlinksChanged",t:bv},23:{n:"AppVersion",t:Vi,p:"version"},24:{n:"DigSig",t:AAe},26:{n:"ContentType",t:wa},27:{n:"ContentStatus",t:wa},28:{n:"Language",t:wa},29:{n:"Version",t:wa},255:{},2147483648:{n:"Locale",t:T2},2147483651:{n:"Behavior",t:T2},1919054434:{}},SE={1:{n:"CodePage",t:vI},2:{n:"Title",t:wa},3:{n:"Subject",t:wa},4:{n:"Author",t:wa},5:{n:"Keywords",t:wa},6:{n:"Comments",t:wa},7:{n:"Template",t:wa},8:{n:"LastAuthor",t:wa},9:{n:"RevNumber",t:wa},10:{n:"EditTime",t:Nv},11:{n:"LastPrinted",t:Nv},12:{n:"CreatedDate",t:Nv},13:{n:"ModifiedDate",t:Nv},14:{n:"PageCount",t:Vi},15:{n:"WordCount",t:Vi},16:{n:"CharCount",t:Vi},17:{n:"Thumbnail",t:uAe},18:{n:"Application",t:wa},19:{n:"DocSecurity",t:Vi},255:{},2147483648:{n:"Locale",t:T2},2147483651:{n:"Behavior",t:T2},1919054434:{}},FP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},mAe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function pAe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var gAe=pAe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),uh=es(gAe),PA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Q8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},IE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Cv={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wI(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xAe(t){var e=wI();if(!t||!t.match)return e;var r={};if((t.match(gi)||[]).forEach(function(n){var s=Cr(n);switch(s[0].replace(Sce,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[IE[s.ContentType]]!==void 0&&e[IE[s.ContentType]].push(s.PartName);break}}),e.xmlns!==ca.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function V8(t,e){var r=xce(IE),n=[],s;n[n.length]=qs,n[n.length]=$t("Types",null,{xmlns:ca.CT,"xmlns:xsd":ca.xsd,"xmlns:xsi":ca.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return $t("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(s=t[c][0],n[n.length]=$t("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Cv[c][e.bookType]||Cv[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(A){n[n.length]=$t("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:Cv[c][e.bookType]||Cv[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(A){n[n.length]=$t("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:r[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Gr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tx(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function rg(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(gi)||[]).forEach(function(s){var a=Cr(s);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Cp(a.Target,e);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}function w0(t){var e=[qs,$t("Relationships",null,{xmlns:ca.RELS})];return ks(t["!id"]).forEach(function(r){e[e.length]=$t("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function En(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[Gr.HLINK,Gr.XPATH,Gr.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var vAe="application/vnd.oasis.opendocument.spreadsheet";function wAe(t,e){for(var r=AI(t),n,s;n=ex.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Cr(n[0],!1),s.path=="/"&&s.type!==vAe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function yAe(t){var e=[qs];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function kP(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function bAe(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function NAe(t){var e=[qs];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(kP(t[r][0],t[r][1])),e.push(bAe("",t[r][0]));return e.push(kP("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function H8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+C2.version+"</meta:generator></office:meta></office:document-meta>"}var cl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CAe=function(){for(var t=new Array(cl.length),e=0;e<cl.length;++e){var r=cl[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function K8(t){var e={};t=jn(t);for(var r=0;r<cl.length;++r){var n=cl[r],s=t.match(CAe[r]);s!=null&&s.length>0&&(e[n[1]]=An(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Zn(e[n[1]]))}return e}function ZN(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=In(e),n[n.length]=r?$t(t,e,r):Ka(t,e))}function q8(t,e){var r=e||{},n=[qs,$t("cp:coreProperties",null,{"xmlns:cp":ca.CORE_PROPS,"xmlns:dc":ca.dc,"xmlns:dcterms":ca.dcterms,"xmlns:dcmitype":ca.dcmitype,"xmlns:xsi":ca.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&ZN("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:_E(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&ZN("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:_E(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=cl.length;++a){var o=cl[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&ZN(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var dh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],G8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function $8(t,e,r,n){var s=[];if(typeof t=="string")s=yP(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(u){return{v:u}}));var o=typeof e=="string"?yP(e,n).map(function(u){return u.v}):e,l=0,c=0;if(o.length>0)for(var A=0;A!==s.length;A+=2){switch(c=+s[A+1].v,s[A].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function _Ae(t,e,r){var n={};return e||(e={}),t=jn(t),dh.forEach(function(s){var a=(t.match(Yg(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=An(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var o=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&$8(n.HeadingPairs,n.TitlesOfParts,e,r),e}function z8(t){var e=[],r=$t;return t||(t={}),t.Application="SheetJS",e[e.length]=qs,e[e.length]=$t("Properties",null,{xmlns:ca.EXT_PROPS,"xmlns:vt":ca.vt}),dh.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=In(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+In(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var EAe=/<[^>]+>[^<]*/g;function BAe(t,e){var r={},n="",s=t.match(EAe);if(s)for(var a=0;a!=s.length;++a){var o=s[a],l=Cr(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=An(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),A=c[0].slice(4),u=c[1];switch(A){case"lpstr":case"bstr":case"lpwstr":r[n]=An(u);break;case"bool":r[n]=Jn(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Zn(u);break;case"cy":case"error":r[n]=An(u);break;default:if(A.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,A,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function W8(t){var e=[qs,$t("Properties",null,{xmlns:ca.CUST_PROPS,"xmlns:vt":ca.vt})];if(!t)return e.join("");var r=1;return ks(t).forEach(function(s){++r,e[e.length]=$t("property",Dce(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:In(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var FE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},eC;function SAe(t,e,r){eC||(eC=zy(FE)),e=eC[e]||e,t[e]=r}function IAe(t,e){var r=[];return ks(FE).map(function(n){for(var s=0;s<cl.length;++s)if(cl[s][1]==n)return cl[s];for(s=0;s<dh.length;++s)if(dh[s][1]==n)return dh[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ka(FE[n[1]]||n[1],s))}}),$t("DocumentProperties",r.join(""),{xmlns:vo.o})}function FAe(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&ks(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var o=0;o<cl.length;++o)if(a==cl[o][1])return;for(o=0;o<dh.length;++o)if(a==dh[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=t[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push($t(gP(a),l,{"dt:dt":c}))}}),e&&ks(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push($t(gP(a),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+vo.o+'">'+s.join("")+"</"+n+">"}function yI(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kAe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=Ct(8);return o.write_shift(4,n),o.write_shift(4,s),o}function J8(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function X8(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function Y8(t,e,r){return e===31?X8(t):J8(t,e,r)}function kE(t,e,r){return Y8(t,e,r===!1?0:4)}function TAe(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Y8(t,e,0)}function jAe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Ti,""),t.l-s&2&&(t.l+=2)}return r}function PAe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Ti,"");return r}function RAe(t){var e=t.l,r=j2(t,M8);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=j2(t,Vi);return[r,n]}function DAe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(RAe(t));return r}function TP(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),o=t.read_shift(4);n[a]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Ti,"").replace(Np,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Z8(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function LAe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function j2(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==IP&&n!==e&&fAe.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===IP?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return J8(t,n,4).replace(Ti,"");case 31:return X8(t);case 64:return yI(t);case 65:return Z8(t);case 71:return LAe(t);case 80:return kE(t,n,!a.raw).replace(Ti,"");case 81:return TAe(t,n).replace(Ti,"");case 4108:return DAe(t);case 4126:case 4127:return n==4127?jAe(t):PAe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function jP(t,e){var r=Ct(4),n=Ct(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ct(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=kAe(e);break;case 31:case 80:for(n=Ct(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ba([r,n])}function PP(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],o=0,l=0,c=-1,A={};for(o=0;o!=s;++o){var u=t.read_shift(4),d=t.read_shift(4);a[o]=[u,d+r]}a.sort(function(y,b){return y[1]-b[1]});var f={};for(o=0;o!=s;++o){if(t.l!==a[o][1]){var h=!0;if(o>0&&e)switch(e[a[o-1][0]].t){case 2:t.l+2===a[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=a[o][1]&&(t.l=a[o][1],h=!1);break;case 4108:t.l<=a[o][1]&&(t.l=a[o][1],h=!1);break}if((!e||o==0)&&t.l<=a[o][1]&&(h=!1,t.l=a[o][1]),h)throw new Error("Read Error: Expected address "+a[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[a[o][0]];if(f[m.n]=j2(t,m.t,{raw:!0}),m.p==="version"&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(f[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Tl(l=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(a[o][0]===1){if(l=f.CodePage=j2(t,vI),Tl(l),c!==-1){var p=t.l;t.l=a[c][1],A=TP(t,l),t.l=p}}else if(a[o][0]===0){if(l===0){c=o,t.l=a[o+1][1];continue}A=TP(t,l)}else{var x=A[a[o][0]],g;switch(t[t.l]){case 65:t.l+=4,g=Z8(t);break;case 30:t.l+=4,g=kE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,g=kE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,g=t.read_shift(4,"i");break;case 19:t.l+=4,g=t.read_shift(4);break;case 5:t.l+=4,g=t.read_shift(8,"f");break;case 11:t.l+=4,g=Ls(t,4);break;case 64:t.l+=4,g=Zn(yI(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[x]=g}}return t.l=r+n,f}var eQ=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UAe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function RP(t,e,r){var n=Ct(8),s=[],a=[],o=8,l=0,c=Ct(8),A=Ct(8);if(c.write_shift(4,2),c.write_shift(4,1200),A.write_shift(4,1),a.push(c),s.push(A),o+=8+c.length,!e){A=Ct(8),A.write_shift(4,0),s.unshift(A);var u=[Ct(4)];for(u[0].write_shift(4,t.length),l=0;l<t.length;++l){var d=t[l][0];for(c=Ct(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=ba(u),a.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(eQ.indexOf(t[l][0])>-1||G8.indexOf(t[l][0])>-1)&&t[l][1]!=null){var f=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}c=jP(m.t,f)}else{var x=UAe(f);x==-1&&(x=31,f=String(f)),c=jP(x,f)}a.push(c),A=Ct(8),A.write_shift(4,e?h:2+l),s.push(A),o+=8+c.length}var g=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,g),g+=a[l].length;return n.write_shift(4,o),n.write_shift(4,a.length),ba([n].concat(s).concat(a))}function DP(t,e,r){var n=t.content;if(!n)return{};Va(n,0);var s,a,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var A=n.read_shift(4),u=n.read_shift(16);if(u!==pr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var d=PP(n,e),f={SystemIdentifier:A};for(var h in d)f[h]=d[h];if(f.FMTID=a,s===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=PP(n,null)}catch{}for(h in m)f[h]=m[h];return f.FMTID=[a,o],f}function LP(t,e,r,n,s,a){var o=Ct(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,pr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var c=RP(t,r,n);if(l.push(c),s){var A=RP(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),l.push(A)}return ba(l)}function ou(t,e){return t.read_shift(e),null}function OAe(t,e){e||(e=Ct(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function MAe(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Ls(t,e){return t.read_shift(e)===1}function Si(t,e){return e||(e=Ct(2)),e.write_shift(2,+!!t),e}function Ws(t){return t.read_shift(2,"u")}function Zo(t,e){return e||(e=Ct(2)),e.write_shift(2,t),e}function tQ(t,e){return MAe(t,e,Ws)}function QAe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function rQ(t,e,r){return r||(r=Ct(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Ux(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?t.read_shift(n,s):"";return o}function VAe(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),o=0,l,c={};s&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var A=a==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,A);return s&&(t.l+=4*o),n&&(t.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function HAe(t){var e=t.t||"",r=Ct(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ct(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return ba(s)}function Rh(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Ox(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Rh(t,n,r)}function tf(t,e,r){if(r.biff>5)return Ox(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function nQ(t,e,r){return r||(r=Ct(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function KAe(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function qAe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Ti,"");return n&&(t.l+=24),s}function GAe(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(a>>1,"utf16le").replace(Ti,"");return r+o}function $Ae(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return qAe(t);case"0303000000000000c000000000000046":return GAe(t);default:throw new Error("Unsupported Moniker "+r)}}function _v(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Ti,""):"";return r}function UP(t,e){e||(e=Ct(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function zAe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,o,l,c,A="",u,d;s&16&&(a=_v(t,r-t.l)),s&128&&(o=_v(t,r-t.l)),(s&257)===257&&(l=_v(t,r-t.l)),(s&257)===1&&(c=$Ae(t,r-t.l)),s&8&&(A=_v(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(d=yI(t)),t.l=r;var f=o||l||c||"";f&&A&&(f+="#"+A),f||(f="#"+A),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),d&&(h.time=d),a&&(h.Tooltip=a),h}function WAe(t){var e=Ct(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(a==28)n=n.slice(1),UP(n,e);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),a&8&&UP(s>-1?n.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function sQ(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function aQ(t,e){var r=sQ(t);return r[3]=0,r}function Tc(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Dh(t,e,r,n){return n||(n=Ct(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function JAe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function XAe(t,e,r){return e===0?"":tf(t,e,r)}function YAe(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[s,a,o]}function iQ(t){var e=t.read_shift(2),r=xI(t);return[e,r]}function ZAe(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Ux(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function Xy(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function oQ(t,e){return e||(e=Ct(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function lQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var eue=lQ;function cQ(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function tue(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function rue(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function si(t){t.l+=2,t.l+=t.read_shift(2)}var nue={0:si,4:si,5:si,6:si,7:rue,8:si,9:si,10:si,11:si,12:si,13:tue,14:si,15:si,16:si,17:si,18:si,19:si,20:si,21:cQ};function sue(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(nue[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Ev(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function bI(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Ct(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function aue(t,e){return e===0||t.read_shift(2),1200}function iue(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=tf(t,0,r);return t.read_shift(e+n-t.l),s}function oue(t,e){var r=!e||e.biff==8,n=Ct(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function lue(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function cue(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=Ux(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:a,name:o}}function Aue(t,e){var r=!e||e.biff>=8?2:1,n=Ct(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function uue(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],o=0;o!=s&&t.l<r;++o)a.push(VAe(t));return a.Count=n,a.Unique=s,a}function due(t,e){var r=Ct(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=HAe(t[s]);var a=ba([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function hue(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function fue(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function mue(t){var e=JAe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function pue(t){return t.read_shift(2),t.read_shift(4)}function OP(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function gue(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),A=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:o,FirstTab:l,Selected:c,TabRatio:A}}function xue(){var t=Ct(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function vue(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function wue(t){var e=Ct(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function yue(){}function bue(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Ux(t,0,r),n}function Nue(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=Ct(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function Cue(t){var e=Tc(t);return e.isst=t.read_shift(4),e}function _ue(t,e,r,n){var s=Ct(10);return Dh(t,e,n,s),s.write_shift(4,r),s}function Eue(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Tc(t);r.biff==2&&t.l++;var a=Ox(t,n-t.l,r);return s.val=a,s}function Bue(t,e,r,n,s){var a=!s||s.biff==8,o=Ct(8+ +a+(1+a)*r.length);return Dh(t,e,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function Sue(t,e,r){var n=t.read_shift(2),s=tf(t,0,r);return[n,s]}function Iue(t,e,r,n){var s=r&&r.biff==5;n||(n=Ct(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var Fue=tf;function MP(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:a,c:l},e:{r:o,c}}}function kue(t,e){var r=e.biff==8||!e.biff?4:2,n=Ct(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Tue(t){var e=t.read_shift(2),r=t.read_shift(2),n=iQ(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function jue(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(iQ(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(a.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:a}}function Pue(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(a.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:a}}function Rue(t,e,r,n){var s={},a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return s.patternType=mAe[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function Due(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=Rue(t,e,n.fStyle,r),n}function QP(t,e,r,n){var s=r&&r.biff==5;n||(n=Ct(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Lue(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Uue(t){var e=Ct(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function VP(t,e,r){var n=Tc(t);(r.biff==2||e==9)&&++t.l;var s=QAe(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Oue(t,e,r,n,s,a){var o=Ct(8);return Dh(t,e,n,o),rQ(r,a,o),o}function Mue(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Tc(t),s=hi(t);return n.val=s,n}function Que(t,e,r,n){var s=Ct(14);return Dh(t,e,n,s),Ph(r,s),s}var HP=XAe;function Vue(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Rh(t,a),l=[];n>t.l;)l.push(Ox(t));return[a,s,o,l]}function KP(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=ZAe(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var Hue=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qP(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var A=Rh(t,o,r);s&32&&(A=Hue[A.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var d=n==t.l||l===0||!(u>0)?[]:sme(t,u,r,l);return{chKey:a,Name:A,itab:c,rgce:d}}function AQ(t,e,r){if(r.biff<8)return Kue(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(YAe(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function Kue(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Ux(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function que(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=Rh(t,n,r),o=Rh(t,s,r);return[a,o]}function Gue(t,e,r){var n=lQ(t);t.l++;var s=t.read_shift(1);return e-=8,[ame(t,e,r),s,n]}function GP(t,e,r){var n=eue(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,rme(t,e,r)]}function $ue(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function zue(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=tf(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},l,o,a]}}function Wue(t,e,r){return zue(t,e,r)}function Jue(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Xy(t));return r}function Xue(t){var e=Ct(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)oQ(t[r],e);return e}function Yue(t,e,r){if(r&&r.biff<8)return ede(t,e,r);var n=cQ(t),s=sue(t,e-22,n[1]);return{cmo:n,ft:s}}var Zue={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function ede(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((Zue[n]||pi)(t,e,r)),{cmo:[s,n,a],ft:o}}function tde(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:o=KAe(t,6,r);var l=t.read_shift(2);t.read_shift(2),Ws(t,2);var c=t.read_shift(2);t.l+=c;for(var A=1;A<t.lens.length-1;++A){if(t.l-n!=t.lens[A])throw new Error("TxO: bad continue record");var u=t[t.l],d=Rh(t,t.lens[A+1]-t.lens[A]-1);if(s+=d,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function rde(t,e){var r=Xy(t);t.l+=16;var n=zAe(t,e-24);return[r,n]}function nde(t){var e=Ct(24),r=vs(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return ba([e,WAe(t[1])])}function sde(t,e){t.read_shift(2);var r=Xy(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Ti,""),[r,n]}function ade(t){var e=t[1].Tooltip,r=Ct(10+2*(e.length+1));r.write_shift(2,2048);var n=vs(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function ide(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=FP[r]||r,r=t.read_shift(2),e[1]=FP[r]||r,e}function ode(t){return t||(t=Ct(4)),t.write_shift(2,1),t.write_shift(2,1),t}function lde(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(aQ(t));return r}function cde(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(aQ(t));return r}function Ade(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function uQ(t,e,r){if(!r.cellStyles)return pi(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var A={s,e:a,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(A.level=c>>8&7),A}function ude(t,e){var r=Ct(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function dde(t,e){var r={};return e<32||(t.l+=16,r.header=hi(t),r.footer=hi(t),t.l+=2),r}function hde(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function fde(t){for(var e=Ct(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var mde=Tc,pde=tQ,gde=Ox;function xde(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function vde(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Tc(t);++t.l;var s=tf(t,e-7,r);return n.t="str",n.val=s,n}function wde(t){var e=Tc(t);++t.l;var r=hi(t);return e.t="n",e.val=r,e}function yde(t,e,r){var n=Ct(15);return Hx(n,t,e),n.write_shift(8,r,"f"),n}function bde(t){var e=Tc(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Nde(t,e,r){var n=Ct(9);return Hx(n,t,e),n.write_shift(2,r),n}function Cde(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function _de(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function Ede(t,e,r){var n=t.l+e,s=Tc(t),a=t.read_shift(2),o=Rh(t,a,r);return t.l=n,s.t="str",s.val=o,s}var Bde=[2,3,48,49,131,139,140,245],TE=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=zy({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var A=[],u=ad(1);switch(c.type){case"base64":u=yo(Fo(l));break;case"binary":u=yo(l);break;case"buffer":case"array":u=l;break}Va(u,0);var d=u.read_shift(1),f=!!(d&136),h=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,x=521;d==2&&(p=u.read_shift(2)),u.l+=3,d!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(x=u.read_shift(2));var g=u.read_shift(2),y=c.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=t[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var b=[],F={},j=Math.min(u.length,d==2?521:x-10-(h?264:0)),R=m?32:11;u.l<j&&u[u.l]!=13;)switch(F={},F.name=Wg.utils.decode(y,u.slice(u.l,u.l+R)).replace(/[\u0000\r\n].*$/g,""),u.l+=R,F.type=String.fromCharCode(u.read_shift(1)),d!=2&&!m&&(F.offset=u.read_shift(4)),F.len=u.read_shift(1),d==2&&(F.offset=u.read_shift(2)),F.dec=u.read_shift(1),F.name.length&&b.push(F),d!=2&&(u.l+=m?13:14),F.type){case"B":(!h||F.len!=8)&&c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var E=0,S=0;for(A[0]=[],S=0;S!=b.length;++S)A[0][S]=b[S].name;for(;p-- >0;){if(u[u.l]===42){u.l+=g;continue}for(++u.l,A[++E]=[],S=0,S=0;S!=b.length;++S){var B=u.slice(u.l,u.l+b[S].len);u.l+=b[S].len,Va(B,0);var U=Wg.utils.decode(y,B);switch(b[S].type){case"C":U.trim().length&&(A[E][S]=U.replace(/\s+$/,""));break;case"D":U.length===8?A[E][S]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):A[E][S]=U;break;case"F":A[E][S]=parseFloat(U.trim());break;case"+":case"I":A[E][S]=m?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":A[E][S]=!0;break;case"N":case"F":A[E][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));A[E][S]="##MEMO##"+(m?parseInt(U.trim(),10):B.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(A[E][S]=+U||0);break;case"@":A[E][S]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":A[E][S]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":A[E][S]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[E][S]=-B.read_shift(-8,"f");break;case"B":if(h&&b[S].len==8){A[E][S]=B.read_shift(8,"f");break}case"G":case"P":B.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(A=A.slice(0,c.sheetRows)),c.DBF=b,A}function n(l,c){var A=c||{};A.dateNF||(A.dateNF="yyyymmdd");var u=Am(r(l,A),A);return u["!cols"]=A.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete A.DBF,u}function s(l,c){try{return xd(n(l,c),c)}catch(A){if(c&&c.WTF)throw A}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var A=c||{};if(+A.codepage>=0&&Tl(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var u=Xi(),d=D2(l,{header:1,raw:!0,cellDates:!0}),f=d[0],h=d.slice(1),m=l["!cols"]||[],p=0,x=0,g=0,y=1;for(p=0;p<f.length;++p){if(((m[p]||{}).DBF||{}).name){f[p]=m[p].DBF.name,++g;continue}if(f[p]!=null){if(++g,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(x=0;x<1024;++x)if(f.indexOf(f[p]+"_"+x)==-1){f[p]+="_"+x;break}}}}var b=un(l["!ref"]),F=[],j=[],R=[];for(p=0;p<=b.e.c-b.s.c;++p){var E="",S="",B=0,U=[];for(x=0;x<h.length;++x)h[x][p]!=null&&U.push(h[x][p]);if(U.length==0||f[p]==null){F[p]="?";continue}for(x=0;x<U.length;++x){switch(typeof U[x]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=U[x]instanceof Date?"D":"C";break;default:S="C"}B=Math.max(B,String(U[x]).length),E=E&&E!=S?"C":S}B>250&&(B=250),S=((m[p]||{}).DBF||{}).type,S=="C"&&m[p].DBF.len>B&&(B=m[p].DBF.len),E=="B"&&S=="N"&&(E="N",R[p]=m[p].DBF.dec,B=m[p].DBF.len),j[p]=E=="C"||S=="N"?B:a[E]||0,y+=j[p],F[p]=E}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*g),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[e8]||3)<<8),p=0,x=0;p<f.length;++p)if(f[p]!=null){var T=u.next(32),L=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,L,"sbcs"),T.write_shift(1,F[p]=="?"?"C":F[p],"sbcs"),T.write_shift(4,x),T.write_shift(1,j[p]||a[F[p]]||0),T.write_shift(1,R[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),x+=j[p]||a[F[p]]||0}var Y=u.next(264);for(Y.write_shift(4,13),p=0;p<65;++p)Y.write_shift(4,0);for(p=0;p<h.length;++p){var me=u.next(y);for(me.write_shift(1,0),x=0;x<f.length;++x)if(f[x]!=null)switch(F[x]){case"L":me.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":me.write_shift(8,h[p][x]||0,"f");break;case"N":var ae="0";for(typeof h[p][x]=="number"&&(ae=h[p][x].toFixed(R[x]||0)),g=0;g<j[x]-ae.length;++g)me.write_shift(1,32);me.write_shift(1,ae,"sbcs");break;case"D":h[p][x]?(me.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var fe=String(h[p][x]!=null?h[p][x]:"").slice(0,j[x]);for(me.write_shift(1,fe,"sbcs"),g=0;g<j[x]-fe.length;++g)me.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),dQ=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ks(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var m=t[h];return typeof m=="number"?nP(m):m},n=function(f,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?f:nP(p)};t["|"]=254;function s(f,h){switch(h.type){case"base64":return a(Fo(f),h);case"binary":return a(f,h);case"buffer":return a(Qr&&Buffer.isBuffer(f)?f.toString("binary"):gd(f),h);case"array":return a(jh(f),h)}throw new Error("Unrecognized type "+h.type)}function a(f,h){var m=f.split(/[\n\r]+/),p=-1,x=-1,g=0,y=0,b=[],F=[],j=null,R={},E=[],S=[],B=[],U=0,k;for(+h.codepage>=0&&Tl(+h.codepage);g!==m.length;++g){U=0;var T=m[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),L=T.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),Y=L[0],me;if(T.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&F.push(T.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,fe=!1,de=!1,Z=!1,xe=-1,Be=-1;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"A":break;case"X":x=parseInt(L[y].slice(1))-1,fe=!0;break;case"Y":for(p=parseInt(L[y].slice(1))-1,fe||(x=0),k=b.length;k<=p;++k)b[k]=[];break;case"K":me=L[y].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(Ll(me))?isNaN(V0(me).getDate())||(me=Zn(me)):(me=Ll(me),j!==null&&lm(j)&&(me=Jy(me))),ae=!0;break;case"E":Z=!0;var I=y0(L[y].slice(1),{r:p,c:x});b[p][x]=[b[p][x],I];break;case"S":de=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":xe=parseInt(L[y].slice(1))-1;break;case"C":Be=parseInt(L[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(ae&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=me:b[p][x]=me,j=null),de){if(Z)throw new Error("SYLK shared formula cannot have own formula");var C=xe>-1&&b[xe][Be];if(!C||!C[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=FQ(C[1],{r:p-xe,c:x-Be})}break;case"F":var Q=0;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"X":x=parseInt(L[y].slice(1))-1,++Q;break;case"Y":for(p=parseInt(L[y].slice(1))-1,k=b.length;k<=p;++k)b[k]=[];break;case"M":U=parseInt(L[y].slice(1))/20;break;case"F":break;case"G":break;case"P":j=F[parseInt(L[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=L[y].slice(1).split(" "),k=parseInt(B[0],10);k<=parseInt(B[1],10);++k)U=parseInt(B[2],10),S[k-1]=U===0?{hidden:!0}:{wch:U},id(S[k-1]);break;case"C":x=parseInt(L[y].slice(1))-1,S[x]||(S[x]={});break;case"R":p=parseInt(L[y].slice(1))-1,E[p]||(E[p]={}),U>0?(E[p].hpt=U,E[p].hpx=K0(U)):U===0&&(E[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}Q<1&&(j=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return E.length>0&&(R["!rows"]=E),S.length>0&&(R["!cols"]=S),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,R]}function o(f,h){var m=s(f,h),p=m[0],x=m[1],g=Am(p,h);return ks(x).forEach(function(y){g[y]=x[y]}),g}function l(f,h){return xd(o(f,h),h)}function c(f,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(f.t){case"n":x+=f.v||0,f.f&&!f.F&&(x+=";E"+SI(f.f,{r:m,c:p}));break;case"b":x+=f.v?"TRUE":"FALSE";break;case"e":x+=f.w||f.v;break;case"d":x+='"'+(f.w||f.v)+'"';break;case"s":x+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function A(f,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=nx(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=sx(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&f.push(x)})}function u(f,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*ax(m.hpx)+";"),x.length>2&&f.push(x+"R"+(p+1))})}function d(f,h){var m=["ID;PWXL;N;E"],p=[],x=un(f["!ref"]),g,y=Array.isArray(f),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),f["!cols"]&&A(m,f["!cols"]),f["!rows"]&&u(m,f["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var F=x.s.r;F<=x.e.r;++F)for(var j=x.s.c;j<=x.e.c;++j){var R=br({r:F,c:j});g=y?(f[F]||[])[j]:f[R],!(!g||g.v==null&&(!g.f||g.F))&&p.push(c(g,f,F,j))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:d}}(),hQ=function(){function t(a,o){switch(o.type){case"base64":return e(Fo(a),o);case"binary":return e(a,o);case"buffer":return e(Qr&&Buffer.isBuffer(a)?a.toString("binary"):gd(a),o);case"array":return e(jh(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var l=a.split(`
`),c=-1,A=-1,u=0,d=[];u!==l.length;++u){if(l[u].trim()==="BOT"){d[++c]=[],A=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],m=f[1];++u;for(var p=l[u]||"";(p.match(/["]/g)||[]).length&1&&u<l.length-1;)p+=`
`+l[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){d[++c]=[],A=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[c][A]=!0:p==="FALSE"?d[c][A]=!1:isNaN(Ll(m))?isNaN(V0(m).getDate())?d[c][A]=m:d[c][A]=Zn(m):d[c][A]=Ll(m),++A;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[c][A++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function r(a,o){return Am(t(a,o),o)}function n(a,o){return xd(r(a,o),o)}var s=function(){var a=function(c,A,u,d,f){c.push(A),c.push(u+","+d),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,A,u,d){c.push(A+","+u),c.push(A==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var A=[],u=un(c["!ref"]),d,f=Array.isArray(c);a(A,"TABLE",0,1,"sheetjs"),a(A,"VECTORS",0,u.e.r-u.s.r+1,""),a(A,"TUPLES",0,u.e.c-u.s.c+1,""),a(A,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(A,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=br({r:h,c:m});if(d=f?(c[h]||[])[m]:c[p],!d){o(A,1,0,"");continue}switch(d.t){case"n":var x=d.w;!x&&d.v!=null&&(x=d.v),x==null?d.f&&!d.F?o(A,1,0,"="+d.f):o(A,1,0,""):o(A,0,x,"V");break;case"b":o(A,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(A,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=hl(d.z||yr[14],da(Zn(d.v)))),o(A,0,d.w,"V");break;default:o(A,1,0,"")}}}o(A,-1,0,"EOD");var g=`\r
`,y=A.join(g);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),fQ=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,f){for(var h=d.split(`
`),m=-1,p=-1,x=0,g=[];x!==h.length;++x){var y=h[x].trim().split(":");if(y[0]==="cell"){var b=vs(y[1]);if(g.length<=b.r)for(m=g.length;m<=b.r;++m)g[m]||(g[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":g[m][p]=t(y[3]);break;case"v":g[m][p]=+y[3];break;case"vtf":var F=y[y.length-1];case"vtc":switch(y[3]){case"nl":g[m][p]=!!+y[4];break;default:g[m][p]=+y[4];break}y[2]=="vtf"&&(g[m][p]=[g[m][p],F])}}}return f&&f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}function n(d,f){return Am(r(d,f),f)}function s(d,f){return xd(n(d,f),f)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function A(d){if(!d||!d["!ref"])return"";for(var f=[],h=[],m,p="",x=Yi(d["!ref"]),g=Array.isArray(d),y=x.s.r;y<=x.e.r;++y)for(var b=x.s.c;b<=x.e.c;++b)if(p=br({r:y,c:b}),m=g?(d[y]||[])[b]:d[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var F=da(Zn(m.v));h[2]="vtc",h[3]="nd",h[4]=""+F,h[5]=m.w||hl(m.z||yr[14],F);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(d){return[a,o,l,o,A(d),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),H0=function(){function t(u,d,f,h,m){m.raw?d[f][h]=u:u===""||(u==="TRUE"?d[f][h]=!0:u==="FALSE"?d[f][h]=!1:isNaN(Ll(u))?isNaN(V0(u).getDate())?d[f][h]=u:d[f][h]=Zn(u):d[f][h]=Ll(u))}function e(u,d){var f=d||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,g=0,y=0;y<=p;++y)g=m[y].indexOf(" "),g==-1?g=m[y].length:g++,x=Math.max(x,g);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,x).trim(),h,y,b,f),b=1;b<=(m[y].length-x)/10+1;++b)t(m[y].slice(x+(b-1)*10,x+b*10).trim(),h,y,b,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var d={},f=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?f=!f:!f&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h]);if(!m.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function a(u,d){var f=d||{},h="",m=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=s(u.slice(0,1024)):f&&f.FS?h=f.FS:h=s(u.slice(0,1024));var x=0,g=0,y=0,b=0,F=0,j=h.charCodeAt(0),R=!1,E=0,S=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var B=f.dateNF!=null?hce(f.dateNF):null;function U(){var k=u.slice(b,F),T={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)T.t="z";else if(f.raw)T.t="s",T.v=k;else if(k.trim().length===0)T.t="s",T.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(T.t="s",T.v=k.slice(2,-1).replace(/""/g,'"')):Vfe(k)?(T.t="n",T.f=k.slice(1)):(T.t="s",T.v=k);else if(k=="TRUE")T.t="b",T.v=!0;else if(k=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=Ll(k)))T.t="n",f.cellText!==!1&&(T.w=k),T.v=y;else if(!isNaN(V0(k).getDate())||B&&k.match(B)){T.z=f.dateNF||yr[14];var L=0;B&&k.match(B)&&(k=fce(k,f.dateNF,k.match(B)||[]),L=1),f.cellDates?(T.t="d",T.v=Zn(k,L)):(T.t="n",T.v=da(Zn(k,L))),f.cellText!==!1&&(T.w=hl(T.z,T.v instanceof Date?da(T.v):T.v)),f.cellNF||delete T.z}else T.t="s",T.v=k;if(T.t=="z"||(f.dense?(m[x]||(m[x]=[]),m[x][g]=T):m[br({c:g,r:x})]=T),b=F+1,S=u.charCodeAt(b),p.e.c<g&&(p.e.c=g),p.e.r<x&&(p.e.r=x),E==j)++g;else if(g=0,++x,f.sheetRows&&f.sheetRows<=x)return!0}e:for(;F<u.length;++F)switch(E=u.charCodeAt(F)){case 34:S===34&&(R=!R);break;case j:case 10:case 13:if(!R&&U())break e;break}return F-b>0&&U(),m["!ref"]=Pr(p),m}function o(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,d):Am(e(u,d),d)}function l(u,d){var f="",h=d.type=="string"?[0,0,0,0]:DI(u,d);switch(d.type){case"base64":f=Fo(u);break;case"binary":f=u;break;case"buffer":d.codepage==65001?f=u.toString("utf8"):d.codepage&&typeof Wg<"u"||(f=Qr&&Buffer.isBuffer(u)?u.toString("binary"):gd(u));break;case"array":f=jh(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=jn(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=jn(f):d.type=="binary"&&typeof Wg<"u",f.slice(0,19)=="socialcalc:version:"?fQ.to_sheet(d.type=="string"?f:jn(f),d):o(f,d)}function c(u,d){return xd(l(u,d),d)}function A(u){for(var d=[],f=un(u["!ref"]),h,m=Array.isArray(u),p=f.s.r;p<=f.e.r;++p){for(var x=[],g=f.s.c;g<=f.e.c;++g){var y=br({r:p,c:g});if(h=m?(u[p]||[])[g]:u[y],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(SA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(g===0?" ":""))}d.push(x.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:A}}();function Sde(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=dQ.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return H0.to_workbook(t,e)}}var hh=function(){function t(I,C,Q){if(I){Va(I,I.l||0);for(var M=Q.Enum||xe;I.l<I.length;){var D=I.read_shift(2),z=M[D]||M[65535],O=I.read_shift(2),te=I.l+O,se=z.f&&z.f(I,O,Q);if(I.l=te,C(se,z,D))return}}}function e(I,C){switch(C.type){case"base64":return r(yo(Fo(I)),C);case"binary":return r(yo(I),C);case"buffer":case"array":return r(I,C)}throw"Unsupported type "+C.type}function r(I,C){if(!I)return I;var Q=C||{},M=Q.dense?[]:{},D="Sheet1",z="",O=0,te={},se=[],we=[],q={s:{r:0,c:0},e:{r:0,c:0}},Me=Q.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)Q.Enum=xe,t(I,function(ie,pe,Ee){switch(Ee){case 0:Q.vers=ie,ie>=4096&&(Q.qpro=!0);break;case 6:q=ie;break;case 204:ie&&(z=ie);break;case 222:z=ie;break;case 15:case 51:Q.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:Ee==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=Q.dateNF||yr[14],Q.cellDates&&(ie[1].t="d",ie[1].v=Jy(ie[1].v))),Q.qpro&&ie[3]>O&&(M["!ref"]=Pr(q),te[D]=M,se.push(D),M=Q.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},O=ie[3],D=z||"Sheet"+(O+1),z="");var Ue=Q.dense?(M[ie[0].r]||[])[ie[0].c]:M[br(ie[0])];if(Ue){Ue.t=ie[1].t,Ue.v=ie[1].v,ie[1].z!=null&&(Ue.z=ie[1].z),ie[1].f!=null&&(Ue.f=ie[1].f);break}Q.dense?(M[ie[0].r]||(M[ie[0].r]=[]),M[ie[0].r][ie[0].c]=ie[1]):M[br(ie[0])]=ie[1];break}},Q);else if(I[2]==26||I[2]==14)Q.Enum=Be,I[2]==14&&(Q.qpro=!0,I.l=0),t(I,function(ie,pe,Ee){switch(Ee){case 204:D=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>O&&(M["!ref"]=Pr(q),te[D]=M,se.push(D),M=Q.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},O=ie[3],D="Sheet"+(O+1)),Me>0&&ie[0].r>=Me)break;Q.dense?(M[ie[0].r]||(M[ie[0].r]=[]),M[ie[0].r][ie[0].c]=ie[1]):M[br(ie[0])]=ie[1],q.e.c<ie[0].c&&(q.e.c=ie[0].c),q.e.r<ie[0].r&&(q.e.r=ie[0].r);break;case 27:ie[14e3]&&(we[ie[14e3][0]]=ie[14e3][1]);break;case 1537:we[ie[0]]=ie[1],ie[0]==O&&(D=ie[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(M["!ref"]=Pr(q),te[z||D]=M,se.push(z||D),!we.length)return{SheetNames:se,Sheets:te};for(var re={},J=[],K=0;K<we.length;++K)te[se[K]]?(J.push(we[K]||se[K]),re[we[K]]=te[we[K]]||te[se[K]]):(J.push(we[K]),re[we[K]]={"!ref":"A1"});return{SheetNames:J,Sheets:re}}function n(I,C){var Q=C||{};if(+Q.codepage>=0&&Tl(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var M=Xi(),D=un(I["!ref"]),z=Array.isArray(I),O=[];zt(M,0,a(1030)),zt(M,6,c(D));for(var te=Math.min(D.e.r,8191),se=D.s.r;se<=te;++se)for(var we=Hs(se),q=D.s.c;q<=D.e.c;++q){se===D.s.r&&(O[q]=xs(q));var Me=O[q]+we,re=z?(I[se]||[])[q]:I[Me];if(!(!re||re.t=="z"))if(re.t=="n")(re.v|0)==re.v&&re.v>=-32768&&re.v<=32767?zt(M,13,h(se,q,re.v)):zt(M,14,p(se,q,re.v));else{var J=SA(re);zt(M,15,d(se,q,J.slice(0,239)))}}return zt(M,1),M.end()}function s(I,C){var Q=C||{};if(+Q.codepage>=0&&Tl(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var M=Xi();zt(M,0,o(I));for(var D=0,z=0;D<I.SheetNames.length;++D)(I.Sheets[I.SheetNames[D]]||{})["!ref"]&&zt(M,27,Z(I.SheetNames[D],z++));var O=0;for(D=0;D<I.SheetNames.length;++D){var te=I.Sheets[I.SheetNames[D]];if(!(!te||!te["!ref"])){for(var se=un(te["!ref"]),we=Array.isArray(te),q=[],Me=Math.min(se.e.r,8191),re=se.s.r;re<=Me;++re)for(var J=Hs(re),K=se.s.c;K<=se.e.c;++K){re===se.s.r&&(q[K]=xs(K));var ie=q[K]+J,pe=we?(te[re]||[])[K]:te[ie];if(!(!pe||pe.t=="z"))if(pe.t=="n")zt(M,23,U(re,K,O,pe.v));else{var Ee=SA(pe);zt(M,22,E(re,K,O,Ee.slice(0,239)))}}++O}}return zt(M,1),M.end()}function a(I){var C=Ct(2);return C.write_shift(2,I),C}function o(I){var C=Ct(26);C.write_shift(2,4096),C.write_shift(2,4),C.write_shift(4,0);for(var Q=0,M=0,D=0,z=0;z<I.SheetNames.length;++z){var O=I.SheetNames[z],te=I.Sheets[O];if(!(!te||!te["!ref"])){++D;var se=Yi(te["!ref"]);Q<se.e.r&&(Q=se.e.r),M<se.e.c&&(M=se.e.c)}}return Q>8191&&(Q=8191),C.write_shift(2,Q),C.write_shift(1,D),C.write_shift(1,M),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(1,1),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(4,0),C}function l(I,C,Q){var M={s:{c:0,r:0},e:{c:0,r:0}};return C==8&&Q.qpro?(M.s.c=I.read_shift(1),I.l++,M.s.r=I.read_shift(2),M.e.c=I.read_shift(1),I.l++,M.e.r=I.read_shift(2),M):(M.s.c=I.read_shift(2),M.s.r=I.read_shift(2),C==12&&Q.qpro&&(I.l+=2),M.e.c=I.read_shift(2),M.e.r=I.read_shift(2),C==12&&Q.qpro&&(I.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function c(I){var C=Ct(8);return C.write_shift(2,I.s.c),C.write_shift(2,I.s.r),C.write_shift(2,I.e.c),C.write_shift(2,I.e.r),C}function A(I,C,Q){var M=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(M[0].c=I.read_shift(1),M[3]=I.read_shift(1),M[0].r=I.read_shift(2),I.l+=2):(M[2]=I.read_shift(1),M[0].c=I.read_shift(2),M[0].r=I.read_shift(2)),M}function u(I,C,Q){var M=I.l+C,D=A(I,C,Q);if(D[1].t="s",Q.vers==20768){I.l++;var z=I.read_shift(1);return D[1].v=I.read_shift(z,"utf8"),D}return Q.qpro&&I.l++,D[1].v=I.read_shift(M-I.l,"cstr"),D}function d(I,C,Q){var M=Ct(7+Q.length);M.write_shift(1,255),M.write_shift(2,C),M.write_shift(2,I),M.write_shift(1,39);for(var D=0;D<M.length;++D){var z=Q.charCodeAt(D);M.write_shift(1,z>=128?95:z)}return M.write_shift(1,0),M}function f(I,C,Q){var M=A(I,C,Q);return M[1].v=I.read_shift(2,"i"),M}function h(I,C,Q){var M=Ct(7);return M.write_shift(1,255),M.write_shift(2,C),M.write_shift(2,I),M.write_shift(2,Q,"i"),M}function m(I,C,Q){var M=A(I,C,Q);return M[1].v=I.read_shift(8,"f"),M}function p(I,C,Q){var M=Ct(13);return M.write_shift(1,255),M.write_shift(2,C),M.write_shift(2,I),M.write_shift(8,Q,"f"),M}function x(I,C,Q){var M=I.l+C,D=A(I,C,Q);if(D[1].v=I.read_shift(8,"f"),Q.qpro)I.l=M;else{var z=I.read_shift(2);F(I.slice(I.l,I.l+z),D),I.l+=z}return D}function g(I,C,Q){var M=C&32768;return C&=-32769,C=(M?I:0)+(C>=8192?C-16384:C),(M?"":"$")+(Q?xs(C):Hs(C))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(I,C){Va(I,0);for(var Q=[],M=0,D="",z="",O="",te="";I.l<I.length;){var se=I[I.l++];switch(se){case 0:Q.push(I.read_shift(8,"f"));break;case 1:z=g(C[0].c,I.read_shift(2),!0),D=g(C[0].r,I.read_shift(2),!1),Q.push(z+D);break;case 2:{var we=g(C[0].c,I.read_shift(2),!0),q=g(C[0].r,I.read_shift(2),!1);z=g(C[0].c,I.read_shift(2),!0),D=g(C[0].r,I.read_shift(2),!1),Q.push(we+q+":"+z+D)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(I.read_shift(2));break;case 6:{for(var Me="";se=I[I.l++];)Me+=String.fromCharCode(se);Q.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:te=Q.pop(),O=Q.pop(),Q.push(["AND","OR"][se-20]+"("+O+","+te+")");break;default:if(se<32&&b[se])te=Q.pop(),O=Q.pop(),Q.push(O+b[se]+te);else if(y[se]){if(M=y[se][1],M==69&&(M=I[I.l++]),M>Q.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+Q.join("|")+"|");return}var re=Q.slice(-M);Q.length-=M,Q.push(y[se][0]+"("+re.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}Q.length==1?C[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function j(I){var C=[{c:0,r:0},{t:"n",v:0},0];return C[0].r=I.read_shift(2),C[3]=I[I.l++],C[0].c=I[I.l++],C}function R(I,C){var Q=j(I);return Q[1].t="s",Q[1].v=I.read_shift(C-4,"cstr"),Q}function E(I,C,Q,M){var D=Ct(6+M.length);D.write_shift(2,I),D.write_shift(1,Q),D.write_shift(1,C),D.write_shift(1,39);for(var z=0;z<M.length;++z){var O=M.charCodeAt(z);D.write_shift(1,O>=128?95:O)}return D.write_shift(1,0),D}function S(I,C){var Q=j(I);Q[1].v=I.read_shift(2);var M=Q[1].v>>1;if(Q[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return Q[1].v=M,Q}function B(I,C){var Q=j(I),M=I.read_shift(4),D=I.read_shift(4),z=I.read_shift(2);if(z==65535)return M===0&&D===3221225472?(Q[1].t="e",Q[1].v=15):M===0&&D===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var O=z&32768;return z=(z&32767)-16446,Q[1].v=(1-O*2)*(D*Math.pow(2,z+32)+M*Math.pow(2,z)),Q}function U(I,C,Q,M){var D=Ct(14);if(D.write_shift(2,I),D.write_shift(1,Q),D.write_shift(1,C),M==0)return D.write_shift(4,0),D.write_shift(4,0),D.write_shift(2,65535),D;var z=0,O=0,te=0,se=0;return M<0&&(z=1,M=-M),O=Math.log2(M)|0,M/=Math.pow(2,O-31),se=M>>>0,se&2147483648||(M/=2,++O,se=M>>>0),M-=se,se|=2147483648,se>>>=0,M*=Math.pow(2,32),te=M>>>0,D.write_shift(4,te),D.write_shift(4,se),O+=16383+(z?32768:0),D.write_shift(2,O),D}function k(I,C){var Q=B(I);return I.l+=C-14,Q}function T(I,C){var Q=j(I),M=I.read_shift(4);return Q[1].v=M>>6,Q}function L(I,C){var Q=j(I),M=I.read_shift(8,"f");return Q[1].v=M,Q}function Y(I,C){var Q=L(I);return I.l+=C-10,Q}function me(I,C){return I[I.l+C-1]==0?I.read_shift(C,"cstr"):""}function ae(I,C){var Q=I[I.l++];Q>C-1&&(Q=C-1);for(var M="";M.length<Q;)M+=String.fromCharCode(I[I.l++]);return M}function fe(I,C,Q){if(!(!Q.qpro||C<21)){var M=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var D=I.read_shift(C-21,"cstr");return[M,D]}}function de(I,C){for(var Q={},M=I.l+C;I.l<M;){var D=I.read_shift(2);if(D==14e3){for(Q[D]=[0,""],Q[D][0]=I.read_shift(2);I[I.l];)Q[D][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return Q}function Z(I,C){var Q=Ct(5+I.length);Q.write_shift(2,14e3),Q.write_shift(2,C);for(var M=0;M<I.length;++M){var D=I.charCodeAt(M);Q[Q.l++]=D>127?95:D}return Q[Q.l++]=0,Q}var xe={0:{n:"BOF",f:Ws},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:de},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function Ide(t){var e={},r=t.match(gi),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Cr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=ZS[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var Fde=function(){var t=Yg("t"),e=Yg("rPr");function r(a){var o=a.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:An(o[1])},c=a.match(e);return c&&(l.s=Ide(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),kde=function(){var e=/(\r\n|\n)/g;function r(s,a,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),o.push("</b>")),s.i&&(a.push("<i>"),o.push("</i>")),s.strike&&(a.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Tde=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,jde=/<(?:\w+:)?r>/,Pde=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function NI(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=An(jn(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=jn(t),r&&(n.h=cI(n.t))):t.match(jde)&&(n.r=jn(t),n.t=An(jn((t.replace(Pde,"").match(Tde)||[]).join("").replace(gi,""))),r&&(n.h=kde(Fde(n.r)))),n):{t:""}}var Rde=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Dde=/<(?:\w+:)?(?:si|sstItem)>/g,Lde=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ude(t,e){var r=[],n="";if(!t)return r;var s=t.match(Rde);if(s){n=s[2].replace(Dde,"").split(Lde);for(var a=0;a!=n.length;++a){var o=NI(n[a].trim(),e);o!=null&&(r[r.length]=o)}s=Cr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Ode=/^\s|\s$|[\t\n\r]/;function mQ(t,e){if(!e.bookSST)return"";var r=[qs];r[r.length]=$t("sst",null,{xmlns:Jh[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Ode)&&(a+=' xml:space="preserve"'),a+=">"+In(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Mde(t){return[t.read_shift(4),t.read_shift(4)]}function Qde(t,e){var r=[],n=!1;return jA(t,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function Vde(t,e){return e||(e=Ct(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Hde=Zce;function Kde(t){var e=Xi();jt(e,159,Vde(t));for(var r=0;r<t.length;++r)jt(e,19,Hde(t[r]));return jt(e,160),e.end()}function pQ(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function xA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function qde(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=xA(t,4),e.U=xA(t,4),e.W=xA(t,4),e}function Gde(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function $de(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Gde(t));return e}function zde(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Wde(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=xA(t,4),e.U=xA(t,4),e.W=xA(t,4),e}function Jde(t){var e=Wde(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function gQ(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function xQ(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Xde(t){var e=xA(t);switch(e.Minor){case 2:return[e.Minor,Yde(t)];case 3:return[e.Minor,Zde()];case 4:return[e.Minor,ehe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Yde(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=gQ(t,r),s=xQ(t,t.length-t.l);return{t:"Std",h:n,v:s}}function Zde(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ehe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(gi,function(a){var o=Cr(a);switch(kc(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function the(t,e){var r={},n=r.EncryptionVersionInfo=xA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=gQ(t,s),e-=s,r.EncryptionVerifier=xQ(t,e),r}function rhe(t){var e={},r=e.EncryptionVersionInfo=xA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function CI(t){var e=0,r,n=pQ(t),s=n.length+1,a,o,l,c,A;for(r=ad(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],l=e&16384?1:0,c=e<<1&32767,A=l|c,e=A^o;return e^52811}var vQ=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},a=function(o){for(var l=e[o.length-1],c=104,A=o.length-1;A>=0;--A)for(var u=o[A],d=0;d!=7;++d)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=pQ(o),c=a(l),A=l.length,u=ad(16),d=0;d!=16;++d)u[d]=0;var f,h,m;for((A&1)===1&&(f=c>>8,u[A]=s(t[0],f),--A,f=c&255,h=l[l.length-1],u[A]=s(h,f));A>0;)--A,f=c>>8,u[A]=s(l[A],f),--A,f=c&255,u[A]=s(l[A],f);for(A=15,m=15-l.length;m>0;)f=c>>8,u[A]=s(t[m],f),--A,--m,f=c&255,u[A]=s(l[A],f),--A,--m;return u}}(),nhe=function(t,e,r,n,s){s||(s=e),n||(n=vQ(t));var a,o;for(a=0;a!=e.length;++a)o=e[a],o^=n[r],o=(o>>5|o<<3)&255,s[a]=o,++r;return[s,r,n]},she=function(t){var e=0,r=vQ(t);return function(n){var s=nhe("",n,e,r);return e=s[1],s[0]}};function ahe(t,e,r,n){var s={key:Ws(t),verificationBytes:Ws(t)};return r.password&&(s.verifier=CI(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=she(r.password)),s}function ihe(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=rhe(t):n.Data=the(t,e),n}function ohe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?ihe(t,e-2,n):ahe(t,r.biff>=8?e:e-2,r,n),n}var wQ=function(){function t(s,a){switch(a.type){case"base64":return e(Fo(s),a);case"binary":return e(s,a);case"buffer":return e(Qr&&Buffer.isBuffer(s)?s.toString("binary"):gd(s),a);case"array":return e(jh(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var o=a||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,d){Array.isArray(l)&&(l[d]=[]);for(var f=/\\\w+\b/g,h=0,m,p=-1;m=f.exec(u);){switch(m[0]){case"\\cell":var x=u.slice(h,f.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var g={v:x,t:"s"};Array.isArray(l)?l[d][p]=g:l[br({r:d,c:p})]=g}break}h=f.lastIndex}p>A.e.c&&(A.e.c=p)}),l["!ref"]=Pr(A),l}function r(s,a){return xd(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=un(s["!ref"]),l,c=Array.isArray(s),A=o.s.r;A<=o.e.r;++A){a.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var d=br({r:A,c:u});l=c?(s[A]||[])[u]:s[d],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(SA(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function lhe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function rx(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function che(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),o=s-a;if(o===0)return[0,0,e];var l=0,c=0,A=s+a;switch(c=o/(A>1?2-A:A),s){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,A/2]}function Ahe(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,o=[a,a,a],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var A=0;A!=3;++A)o[A]=Math.round(o[A]*255);return o}function P2(t,e){if(e===0)return t;var r=che(lhe(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),rx(Ahe(r))}var yQ=6,uhe=15,dhe=1,di=yQ;function nx(t){return Math.floor((t+Math.round(128/di)/256)*di)}function sx(t){return Math.floor((t-5)/di*100+.5)/100}function R2(t){return Math.round((t*di+5)/di*256)/256}function tC(t){return R2(sx(nx(t)))}function _I(t){var e=Math.abs(t-tC(t)),r=di;if(e>.005)for(di=dhe;di<uhe;++di)Math.abs(t-tC(t))<=e&&(e=Math.abs(t-tC(t)),r=di);di=r}function id(t){t.width?(t.wpx=nx(t.width),t.wch=sx(t.wpx),t.MDW=di):t.wpx?(t.wch=sx(t.wpx),t.width=R2(t.wch),t.MDW=di):typeof t.wch=="number"&&(t.width=R2(t.wch),t.wpx=nx(t.width),t.MDW=di),t.customWidth&&delete t.customWidth}var hhe=96,bQ=hhe;function ax(t){return t*96/bQ}function K0(t){return t*bQ/96}var fhe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function mhe(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(gi)||[]).forEach(function(o){var l=Cr(o);switch(kc(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Jn(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Jn(l.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function phe(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(gi)||[]).forEach(function(o){var l=Cr(o);switch(kc(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function ghe(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(gi)||[]).forEach(function(o){var l=Cr(o);switch(kc(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=jn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Jn(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Jn(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Jn(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Jn(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Jn(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Jn(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Jn(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=ZS[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Jn(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=uh[s.color.index];s.color.index==81&&(c=uh[1]),c||(c=uh[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=P2(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function xhe(t,e,r){e.NumberFmt=[];for(var n=ks(yr),s=0;s<n.length;++s)e.NumberFmt[n[s]]=yr[n[s]];var a=t[0].match(gi);if(a)for(s=0;s<a.length;++s){var o=Cr(a[s]);switch(kc(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=An(jn(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}gA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function vhe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=$t("numFmt",null,{numFmtId:n,formatCode:In(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=$t("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Bv=["numFmtId","fillId","fontId","borderId","xfId"],Sv=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function whe(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(gi)||[]).forEach(function(a){var o=Cr(a),l=0;switch(kc(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Bv.length;++l)n[Bv[l]]&&(n[Bv[l]]=parseInt(n[Bv[l]],10));for(l=0;l<Sv.length;++l)n[Sv[l]]&&(n[Sv[l]]=Jn(n[Sv[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Jn(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function yhe(t){var e=[];return e[e.length]=$t("cellXfs",null),t.forEach(function(r){e[e.length]=$t("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=$t("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var bhe=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,A){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=l.match(e))&&xhe(d,u,A),(d=l.match(s))&&ghe(d,u,c,A),(d=l.match(n))&&phe(d,u,c,A),(d=l.match(a))&&mhe(d,u,c,A),(d=l.match(r))&&whe(d,u,A),u}}();function NQ(t,e){var r=[qs,$t("styleSheet",null,{xmlns:Jh[0],"xmlns:vt":ca.vt})],n;return t.SSF&&(n=vhe(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=yhe(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Nhe(t,e){var r=t.read_shift(2),n=fi(t);return[r,n]}function Che(t,e,r){r||(r=Ct(6+4*e.length)),r.write_shift(2,t),Ca(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function _he(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=iAe(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=aAe(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=fi(t),n}function Ehe(t,e){e||(e=Ct(25+4*32)),e.write_shift(2,t.sz*20),oAe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),k2(t.color,e);var n=0;return n=2,e.write_shift(1,n),Ca(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Bhe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rC,She=pi;function $P(t,e){e||(e=Ct(4*3+8*7+16*1)),rC||(rC=zy(Bhe));var r=rC[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(k2({auto:1},e),k2({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Ihe(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function CQ(t,e,r){r||(r=Ct(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function np(t,e){return e||(e=Ct(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Fhe=pi;function khe(t,e){return e||(e=Ct(51)),e.write_shift(1,0),np(null,e),np(null,e),np(null,e),np(null,e),np(null,e),e.length>e.l?e.slice(0,e.l):e}function The(t,e){return e||(e=Ct(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),F2(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function jhe(t,e,r){var n=Ct(2052);return n.write_shift(4,t),F2(e,n),F2(r,n),n.length>n.l?n.slice(0,n.l):n}function Phe(t,e,r){var n={};n.NumberFmt=[];for(var s in yr)n.NumberFmt[s]=yr[s];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return jA(t,function(c,A,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],gA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=P2(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(u),o=!0;break;case 38:a.pop(),o=!1;break;default:if(A.T>0)a.push(u);else if(A.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function Rhe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(jt(t,615,Ul(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&jt(t,44,Che(s,e[s]))}),jt(t,616))}}function Dhe(t){var e=1;jt(t,611,Ul(e)),jt(t,43,Ehe({sz:12,color:{theme:1},name:"Calibri",family:2})),jt(t,612)}function Lhe(t){var e=2;jt(t,603,Ul(e)),jt(t,45,$P({patternType:"none"})),jt(t,45,$P({patternType:"gray125"})),jt(t,604)}function Uhe(t){var e=1;jt(t,613,Ul(e)),jt(t,46,khe()),jt(t,614)}function Ohe(t){var e=1;jt(t,626,Ul(e)),jt(t,47,CQ({numFmtId:0},65535)),jt(t,627)}function Mhe(t,e){jt(t,617,Ul(e.length)),e.forEach(function(r){jt(t,47,CQ(r,0))}),jt(t,618)}function Qhe(t){var e=1;jt(t,619,Ul(e)),jt(t,48,The({xfId:0,name:"Normal"})),jt(t,620)}function Vhe(t){var e=0;jt(t,505,Ul(e)),jt(t,506)}function Hhe(t){var e=0;jt(t,508,jhe(e,"TableStyleMedium9","PivotStyleMedium4")),jt(t,509)}function Khe(t,e){var r=Xi();return jt(r,278),Rhe(r,t.SSF),Dhe(r),Lhe(r),Uhe(r),Ohe(r),Mhe(r,e.cellXfs),Qhe(r),Vhe(r),Hhe(r),jt(r,279),r.end()}var qhe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Ghe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(gi)||[]).forEach(function(s){var a=Cr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[qhe.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function $he(){}function zhe(){}var Whe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Jhe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Xhe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Yhe(t,e,r){e.themeElements={};var n;[["clrScheme",Whe,Ghe],["fontScheme",Jhe,$he],["fmtScheme",Xhe,zhe]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var Zhe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function _Q(t,e){(!t||t.length===0)&&(t=EI());var r,n={};if(!(r=t.match(Zhe)))throw new Error("themeElements not found in theme");return Yhe(r[0],n,e),n.raw=t,n}function EI(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[qs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function efe(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var o;try{o=g8(a,{type:"array"})}catch{return}var l=bo(o,"theme/theme/theme1.xml",!0);if(l)return _Q(l,r)}}function tfe(t){return t.read_shift(4)}function rfe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=nfe(t,4);break;case 2:e.xclrValue=sQ(t);break;case 3:e.xclrValue=tfe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function nfe(t,e){return pi(t,e)}function sfe(t,e){return pi(t,e)}function afe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=rfe(t);break;case 6:n[1]=sfe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function ife(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(afe(t,r-t.l));return{ixfe:n,ext:a}}function ofe(t,e){e.forEach(function(r){switch(r[0]){}})}function lfe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:fi(t)}}function cfe(t){var e=Ct(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ca(t.name,e),e.slice(0,e.l)}function Afe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function ufe(t){var e=Ct(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function dfe(t,e){var r=Ct(8+2*e.length);return r.write_shift(4,t),Ca(e,r),r.slice(0,r.l)}function hfe(t){return t.l+=4,t.read_shift(4)!=0}function ffe(t,e){var r=Ct(8);return r.write_shift(4,t),r.write_shift(4,1),r}function mfe(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],o=!1,l=2;return jA(t,function(c,A,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){l==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):l==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(u),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!A.T){if(!o||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function pfe(){var t=Xi();return jt(t,332),jt(t,334,Ul(1)),jt(t,335,cfe({name:"XLDAPR",version:12e4,flags:3496657072})),jt(t,336),jt(t,339,dfe(1,"XLDAPR")),jt(t,52),jt(t,35,Ul(514)),jt(t,4096,Ul(0)),jt(t,4097,Zo(1)),jt(t,36),jt(t,53),jt(t,340),jt(t,337,ffe(1)),jt(t,51,ufe([[1,0]])),jt(t,338),jt(t,333),t.end()}function gfe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,o;return t.replace(gi,function(l){var c=Cr(l);switch(kc(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<n.Types.length;++A)n.Types[A].name==c.name&&(o=n.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function EQ(){var t=[qs];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function xfe(t){var e=[];if(!t)return e;var r=1;return(t.match(gi)||[]).forEach(function(n){var s=Cr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function vfe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=br(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function wfe(t,e,r){var n=[];return jA(t,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function yfe(t,e,r,n){if(!t)return t;var s=n||{},a=!1;jA(t,function(l,c,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},s)}function bfe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var o0=1024;function BQ(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[$t("xml",null,{"xmlns:v":vo.v,"xmlns:o":vo.o,"xmlns:x":vo.x,"xmlns:mv":vo.mv}).replace(/\/>/,">"),$t("o:shapelayout",$t("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),$t("v:shapetype",[$t("v:stroke",null,{joinstyle:"miter"}),$t("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];o0<t*1e3;)o0+=1e3;return e.forEach(function(a){var o=vs(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?$t("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,A=$t("v:fill",c,l),u={on:"t",obscured:"t"};++o0,s=s.concat(["<v:shape"+Zg({id:"_x0000_s"+o0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",A,$t("v:shadow",null,u),$t("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ka("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ka("x:AutoFill","False"),Ka("x:Row",String(o.r)),Ka("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function zP(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(o){var l=vs(o.ref);if(s?(t[l.r]||(t[l.r]=[]),a=t[l.r][l.c]):a=t[o.ref],!a){a={t:"z"},s?t[l.r][l.c]=a:t[o.ref]=a;var c=un(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var A=Pr(c);A!==t["!ref"]&&(t["!ref"]=A)}a.c||(a.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}a.c.push(u)})}function Nfe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Cr(l[0]),A={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=vs(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var d=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&NI(d[1])||{r:"",t:"",h:""};A.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),A.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(A.h=f.h),n.push(A)}}}}),n}function SQ(t){var e=[qs,$t("comments",null,{xmlns:Jh[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=In(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(In(c.a))),a.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push(Ka("t",In(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;e.push(Ka("t",In(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Cfe(t,e){var r=[],n=!1,s={},a=0;return t.replace(gi,function(l,c){var A=Cr(l);switch(kc(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=t.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return l}),r}function _fe(t,e,r){var n=[qs,$t("ThreadedComments",null,{xmlns:ca.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push($t("threadedComment",Ka("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Efe(t,e){var r=[],n=!1;return t.replace(gi,function(a){var o=Cr(a);switch(kc(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function Bfe(t){var e=[qs,$t("personList",null,{xmlns:ca.TCMNT,"xmlns:x":Jh[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push($t("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Sfe(t){var e={};e.iauthor=t.read_shift(4);var r=ef(t);return e.rfx=r.s,e.ref=br(r.s),t.l+=16,e}function Ife(t,e){return e==null&&(e=Ct(36)),e.write_shift(4,t[1].iauthor),um(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Ffe=fi;function kfe(t){return Ca(t.slice(0,54))}function Tfe(t,e){var r=[],n=[],s={},a=!1;return jA(t,function(l,c,A){switch(A){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),r}function jfe(t){var e=Xi(),r=[];return jt(e,628),jt(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),jt(e,632,kfe(s.a)))})}),jt(e,631),jt(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:vs(n[0]),e:vs(n[0])};jt(e,635,Ife([a,s])),s.t&&s.t.length>0&&jt(e,637,tAe(s)),jt(e,636),delete s.iauthor})}),jt(e,634),jt(e,629),e.end()}var Pfe="application/vnd.ms-office.vbaProject";function Rfe(t){var e=pr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),pr.write(e)}function Dfe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&pr.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var IQ=["xlsb","xlsm","xlam","biff8","xla"];function Lfe(){return{"!type":"dialog"}}function Ufe(){return{"!type":"dialog"}}function Ofe(){return{"!type":"macro"}}function Mfe(){return{"!type":"macro"}}var y0=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,o){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var A=a.length>0?parseInt(a,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=e.c:--u,c?A+=e.r:--A,s+(l?"":"$")+xs(u)+(c?"":"$")+Hs(A)}return function(s,a){return e=a,s.replace(t,r)}}(),BI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,SI=function(){return function(e,r){return e.replace(BI,function(n,s,a,o,l,c){var A=fI(o)-(a?0:r.c),u=hI(c)-(l?0:r.r),d=u==0?"":l?u+1:"["+u+"]",f=A==0?"":a?A+1:"["+A+"]";return s+"R"+d+"C"+f})}}();function FQ(t,e){return t.replace(BI,function(r,n,s,a,o,l){return n+(s=="$"?s+a:xs(fI(a)+e.c))+(o=="$"?o+l:Hs(hI(l)+e.r))})}function Qfe(t,e,r){var n=Yi(e),s=n.s,a=vs(r),o={r:a.r-s.r,c:a.c-s.c};return FQ(t,o)}function Vfe(t){return t.length!=1}function WP(t){return t.replace(/_xlfn\./g,"")}function Gs(t){t.l+=1}function od(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function kQ(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return TQ(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),o=od(t),l=od(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function TQ(t){var e=od(t),r=od(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Hfe(t,e,r){if(r.biff<8)return TQ(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=od(t),o=od(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function jQ(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Kfe(t);var n=t.read_shift(r&&r.biff==12?4:2),s=od(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Kfe(t){var e=od(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function qfe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Gfe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $fe(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function $fe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function zfe(t,e,r){var n=(t[t.l++]&96)>>5,s=kQ(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Wfe(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var o=kQ(t,a,r);return[n,s,o]}function Jfe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Xfe(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function Yfe(t,e,r){var n=(t[t.l++]&96)>>5,s=Hfe(t,e-1,r);return[n,s]}function Zfe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function JP(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function e0e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function t0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function r0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function n0e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function s0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function PQ(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function a0e(t){return t.read_shift(2),PQ(t)}function i0e(t){return t.read_shift(2),PQ(t)}function o0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=jQ(t,0,r);return[n,s]}function l0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Gfe(t,0,r);return[n,s]}function c0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=jQ(t,0,r);return[n,s,a]}function A0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[hme[s],LQ[s],n]}function u0e(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:d0e(t);return[s,(a[0]===0?LQ:dme)[a[1]]]}function d0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function h0e(t,e,r){t.l+=r&&r.biff==2?3:4}function f0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function m0e(t){return t.l++,PA[t.read_shift(1)]}function p0e(t){return t.l++,t.read_shift(2)}function g0e(t){return t.l++,t.read_shift(1)!==0}function x0e(t){return t.l++,hi(t)}function v0e(t,e,r){return t.l++,Ux(t,e-1,r)}function w0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ls(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=PA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=hi(t);break;case 2:r[1]=tf(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function y0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?ef:Xy)(t));return s}function b0e(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=w0e(t,r.biff);return o}function N0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function C0e(t,e,r){if(r.biff==5)return _0e(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function _0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function E0e(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function B0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function S0e(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function I0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var F0e=pi,k0e=pi,T0e=pi;function Mx(t,e,r){return t.l+=2,[qfe(t)]}function II(t){return t.l+=6,[]}var j0e=Mx,P0e=II,R0e=II,D0e=Mx;function RQ(t){return t.l+=2,[Ws(t),t.read_shift(2)&1]}var L0e=Mx,U0e=RQ,O0e=II,M0e=Mx,Q0e=Mx,V0e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function H0e(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),o=V0e[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:s,C:a}}function K0e(t){return t.l+=2,[t.read_shift(4)]}function q0e(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function G0e(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function z0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function W0e(t){return t.l+=4,[0,0]}var XP={1:{n:"PtgExp",f:f0e},2:{n:"PtgTbl",f:T0e},3:{n:"PtgAdd",f:Gs},4:{n:"PtgSub",f:Gs},5:{n:"PtgMul",f:Gs},6:{n:"PtgDiv",f:Gs},7:{n:"PtgPower",f:Gs},8:{n:"PtgConcat",f:Gs},9:{n:"PtgLt",f:Gs},10:{n:"PtgLe",f:Gs},11:{n:"PtgEq",f:Gs},12:{n:"PtgGe",f:Gs},13:{n:"PtgGt",f:Gs},14:{n:"PtgNe",f:Gs},15:{n:"PtgIsect",f:Gs},16:{n:"PtgUnion",f:Gs},17:{n:"PtgRange",f:Gs},18:{n:"PtgUplus",f:Gs},19:{n:"PtgUminus",f:Gs},20:{n:"PtgPercent",f:Gs},21:{n:"PtgParen",f:Gs},22:{n:"PtgMissArg",f:Gs},23:{n:"PtgStr",f:v0e},26:{n:"PtgSheet",f:q0e},27:{n:"PtgEndSheet",f:G0e},28:{n:"PtgErr",f:m0e},29:{n:"PtgBool",f:g0e},30:{n:"PtgInt",f:p0e},31:{n:"PtgNum",f:x0e},32:{n:"PtgArray",f:Zfe},33:{n:"PtgFunc",f:A0e},34:{n:"PtgFuncVar",f:u0e},35:{n:"PtgName",f:N0e},36:{n:"PtgRef",f:o0e},37:{n:"PtgArea",f:zfe},38:{n:"PtgMemArea",f:E0e},39:{n:"PtgMemErr",f:F0e},40:{n:"PtgMemNoMem",f:k0e},41:{n:"PtgMemFunc",f:B0e},42:{n:"PtgRefErr",f:S0e},43:{n:"PtgAreaErr",f:Jfe},44:{n:"PtgRefN",f:l0e},45:{n:"PtgAreaN",f:Yfe},46:{n:"PtgMemAreaN",f:$0e},47:{n:"PtgMemNoMemN",f:z0e},57:{n:"PtgNameX",f:C0e},58:{n:"PtgRef3d",f:c0e},59:{n:"PtgArea3d",f:Wfe},60:{n:"PtgRefErr3d",f:I0e},61:{n:"PtgAreaErr3d",f:Xfe},255:{}},J0e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X0e={1:{n:"PtgElfLel",f:RQ},2:{n:"PtgElfRw",f:M0e},3:{n:"PtgElfCol",f:j0e},6:{n:"PtgElfRwV",f:Q0e},7:{n:"PtgElfColV",f:D0e},10:{n:"PtgElfRadical",f:L0e},11:{n:"PtgElfRadicalS",f:O0e},13:{n:"PtgElfColS",f:P0e},15:{n:"PtgElfColSV",f:R0e},16:{n:"PtgElfRadicalLel",f:U0e},25:{n:"PtgList",f:H0e},29:{n:"PtgSxName",f:K0e},255:{}},Y0e={0:{n:"PtgAttrNoop",f:W0e},1:{n:"PtgAttrSemi",f:s0e},2:{n:"PtgAttrIf",f:r0e},4:{n:"PtgAttrChoose",f:e0e},8:{n:"PtgAttrGoto",f:t0e},16:{n:"PtgAttrSum",f:h0e},32:{n:"PtgAttrBaxcel",f:JP},33:{n:"PtgAttrBaxcel",f:JP},64:{n:"PtgAttrSpace",f:a0e},65:{n:"PtgAttrSpaceSemi",f:i0e},128:{n:"PtgAttrIfError",f:n0e},255:{}};function Qx(t,e,r,n){if(n.biff<8)return pi(t,e);for(var s=t.l+e,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=b0e(t,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=y0e(t,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&a.push(pi(t,e)),a}function Vx(t,e,r){for(var n=t.l+e,s,a,o=[];n!=t.l;)e=n-t.l,a=t[t.l],s=XP[a]||XP[J0e[a]],(a===24||a===25)&&(s=(a===24?X0e:Y0e)[t[t.l+1]]),!s||!s.f?pi(t,e):o.push([s.n,s.f(t,e,r)]);return o}function Z0e(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var eme={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tme(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function DQ(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function YP(t,e,r){var n=DQ(t,e,r);return n=="#REF"?n:tme(n,r)}function Ai(t,e,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,A,u,d=0,f=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",g=0,y=t[0].length;g<y;++g){var b=t[0][g];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),A=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=Ss(" ",t[0][p][1][1]);break;case 1:x=Ss("\r",t[0][p][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}A=A+x,p=-1}l.push(A+eme[b[0]]+c);break;case"PtgIsect":c=l.pop(),A=l.pop(),l.push(A+" "+c);break;case"PtgUnion":c=l.pop(),A=l.pop(),l.push(A+","+c);break;case"PtgRange":c=l.pop(),A=l.pop(),l.push(A+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=eg(b[1][1],o,s),l.push(tg(u,a));break;case"PtgRefN":u=r?eg(b[1][1],r,s):b[1][1],l.push(tg(u,a));break;case"PtgRef3d":d=b[1][1],u=eg(b[1][2],o,s),m=YP(n,d,s),l.push(m+"!"+tg(u,a));break;case"PtgFunc":case"PtgFuncVar":var F=b[1][0],j=b[1][1];F||(F=0),F&=127;var R=F==0?[]:l.slice(-F);l.length-=F,j==="User"&&(j=R.shift()),l.push(j+"("+R.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=BP(b[1][1],r?{s:r}:o,s),l.push(YN(h,s));break;case"PtgArea":h=BP(b[1][1],o,s),l.push(YN(h,s));break;case"PtgArea3d":d=b[1][1],h=b[1][2],m=YP(n,d,s),l.push(m+"!"+YN(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=b[1][2];var E=(n.names||[])[f-1]||(n[0]||[])[f],S=E?E.Name:"SH33TJSNAME"+String(f);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var B=b[1][1];f=b[1][2];var U;if(s.biff<=5)B<0&&(B=-B),n[B]&&(U=n[B][f]);else{var k="";if(((n[B]||[])[0]||[])[0]==14849||(((n[B]||[])[0]||[])[0]==1025?n[B][f]&&n[B][f].itab>0&&(k=n.SheetNames[n[B][f].itab-1]+"!"):k=n.SheetNames[f-1]+"!"),n[B]&&n[B][f])k+=n[B][f].Name;else if(n[0]&&n[0][f])k+=n[0][f].Name;else{var T=(DQ(n,B,s)||"").split(";;");T[f-1]?k=T[f-1]:k+="SH33TJSERRX"}l.push(k);break}U||(U={Name:"SH33TJSERRY"}),l.push(U.Name);break;case"PtgParen":var L="(",Y=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:L=Ss(" ",t[0][p][1][1])+L;break;case 3:L=Ss("\r",t[0][p][1][1])+L;break;case 4:Y=Ss(" ",t[0][p][1][1])+Y;break;case 5:Y=Ss("\r",t[0][p][1][1])+Y;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(L+l.pop()+Y);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var me={c:r.c,r:r.r};if(n.sharedf[br(u)]){var ae=n.sharedf[br(u)];l.push(Ai(ae,o,me,n,s))}else{var fe=!1;for(c=0;c!=n.arrayf.length;++c)if(A=n.arrayf[c],!(u.c<A[0].s.c||u.c>A[0].e.c)&&!(u.r<A[0].s.r||u.r>A[0].e.r)){l.push(Ai(A[1],o,me,n,s)),fe=!0;break}fe||l.push(b[1])}break;case"PtgArray":l.push("{"+Z0e(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&de.indexOf(t[0][g][0])==-1){b=t[0][p];var Z=!0;switch(b[1][0]){case 4:Z=!1;case 0:x=Ss(" ",b[1][1]);break;case 5:Z=!1;case 1:x=Ss("\r",b[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((Z?x:"")+l.pop()+(Z?"":x)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function rme(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,o=t.read_shift(s);if(o==65535)return[[],pi(t,e-2)];var l=Vx(t,o,r);return e!==o+s&&(a=Qx(t,e-o-s,l,r)),t.l=n,[l,a]}function nme(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,o=t.read_shift(s);if(o==65535)return[[],pi(t,e-2)];var l=Vx(t,o,r);return e!==o+s&&(a=Qx(t,e-o-s,l,r)),t.l=n,[l,a]}function sme(t,e,r,n){var s=t.l+e,a=Vx(t,n,r),o;return s!==t.l&&(o=Qx(t,s-t.l,a,r)),[a,o]}function ame(t,e,r){var n=t.l+e,s,a=t.read_shift(2),o=Vx(t,a,r);return a==65535?[[],pi(t,e-2)]:(e!==a+2&&(s=Qx(t,n-a-2,o,r)),[o,s])}function ime(t){var e;if(lA(t,t.l+6)!==65535)return[hi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function ome(t){if(t==null){var e=Ct(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ph(t);return Ph(0)}function nC(t,e,r){var n=t.l+e,s=Tc(t);r.biff==2&&++t.l;var a=ime(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=nme(t,n-t.l,r);return{cell:s,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function lme(t,e,r,n,s){var a=Dh(e,r,s),o=ome(t.v),l=Ct(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var A=Ct(t.bf.length),u=0;u<t.bf.length;++u)A[u]=t.bf[u];var d=ba([a,o,l,A]);return d}function Yy(t,e,r){var n=t.read_shift(4),s=Vx(t,n,r),a=t.read_shift(4),o=a>0?Qx(t,a,s,r):null;return[s,o]}var cme=Yy,Zy=Yy,Ame=Yy,ume=Yy,dme={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},LQ={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},hme={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ZP(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function fme(t){var e="of:="+t.replace(BI,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function sC(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function mme(t){return t.replace(/\./,"!")}var ng={},b0={},sg=typeof Map<"u";function FI(t,e,r){var n=0,s=t.length;if(r){if(sg?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=sg?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(sg?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function eb(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(di=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=sx(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=R2(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function fh(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function vd(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){gA(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function UQ(t,e,r,n,s,a){try{n.cellNF&&(t.z=yr[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Zn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(yr[e]==null&&gA(dce[e]||"General",e),t.t==="e")t.w=t.w||PA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xg(t.v);else if(t.t==="d"){var o=da(t.v);(o|0)===o?t.w=o.toString(10):t.w=Xg(o)}else{if(t.v===void 0)return"";t.w=Th(t.v,b0)}else t.t==="d"?t.w=hl(e,da(t.v),b0):t.w=hl(e,t.v,b0)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=P2(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=P2(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function pme(t,e,r){if(t&&t["!ref"]){var n=un(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function gme(t,e){var r=un(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Pr(r))}var xme=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,vme=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,wme=/<(?:\w:)?hyperlink [^>]*>/mg,yme=/"(\w*:\w*)"/,bme=/<(?:\w:)?col\b[^>]*[\/]?>/g,Nme=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Cme=/<(?:\w:)?pageMargins[^>]*\/>/g,OQ=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,_me=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Eme=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bme(t,e,r,n,s,a,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",u="",d=t.match(vme);d?(A=t.slice(0,d.index),u=t.slice(d.index+d[0].length)):A=u=t;var f=A.match(OQ);f?kI(f[0],l,s,r):(f=A.match(_me))&&Ime(f[0],f[1]||"",l,s,r);var h=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=A.slice(h,h+50).match(yme);m&&gme(l,m[1])}var p=A.match(Eme);p&&p[1]&&Vme(p[1],s);var x=[];if(e.cellStyles){var g=A.match(bme);g&&Lme(x,g)}d&&qme(d[1],l,e,c,a,o);var y=u.match(Nme);y&&(l["!autofilter"]=Ome(y[0]));var b=[],F=u.match(xme);if(F)for(h=0;h!=F.length;++h)b[h]=un(F[h].slice(F[h].indexOf('"')+1));var j=u.match(wme);j&&Pme(l,j,n);var R=u.match(Cme);if(R&&(l["!margins"]=Rme(Cr(R[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Pr(c)),e.sheetRows>0&&l["!ref"]){var E=un(l["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Pr(E))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function Sme(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Pr(t[r])+'"/>';return e+"</mergeCells>"}function kI(t,e,r,n){var s=Cr(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=An(jn(s.codeName)))}function Ime(t,e,r,n,s){kI(t.slice(0,t.indexOf(">")),r,n,s)}function Fme(t,e,r,n,s){var a=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,o.codeName=xc(In(c))}if(t&&t["!outline"]){var A={summaryBelow:1,summaryRight:1};t["!outline"].above&&(A.summaryBelow=0),t["!outline"].left&&(A.summaryRight=0),l=(l||"")+$t("outlinePr",null,A)}!a&&!l||(s[s.length]=$t("sheetPr",l,o))}var kme=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Tme=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jme(t){var e={sheet:1};return kme.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Tme.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=CI(t.password).toString(16).toUpperCase()),$t("sheetProtection",null,e)}function Pme(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Cr(jn(e[s]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+An(a.location))):(a.Target="#"+An(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=un(a.ref),c=l.s.r;c<=l.e.r;++c)for(var A=l.s.c;A<=l.e.c;++A){var u=br({c:A,r:c});n?(t[c]||(t[c]=[]),t[c][A]||(t[c][A]={t:"z",v:void 0}),t[c][A].l=a):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=a)}}}function Rme(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Dme(t){return fh(t),$t("pageMargins",null,t)}function Lme(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Cr(e[n],!0);s.hidden&&(s.hidden=Jn(s.hidden));var a=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,_I(s.width)),id(s);a<=o;)t[a++]=es(s)}}function Ume(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=$t("col",null,eb(s,n)));return r[r.length]="</cols>",r.join("")}function Ome(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Mme(t,e,r,n){var s=typeof t.ref=="string"?t.ref:Pr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Yi(s);o.s.r==o.e.r&&(o.e.r=Yi(e["!ref"]).e.r,s=Pr(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),$t("autoFilter",null,{ref:s})}var Qme=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Vme(t,e){e.Views||(e.Views=[{}]),(t.match(Qme)||[]).forEach(function(r,n){var s=Cr(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Jn(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function Hme(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),$t("sheetViews",$t("sheetView",null,s),{})}function Kme(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=PA[t.v];break;case"d":n&&n.cellDates?s=Zn(t.v,-1).toISOString():(t=es(t),t.t="n",s=""+(t.v=da(Zn(t.v)))),typeof t.z>"u"&&(t.z=yr[14]);break;default:s=t.v;break}var l=Ka("v",In(s)),c={r:e},A=vd(n.cellXfs,t,n);switch(A!==0&&(c.s=A),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Ka("v",""+FI(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=a&&(t.t=a,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=$t("f",In(t.f),u)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),$t("c",l,c)}var qme=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Yg("v"),o=Yg("f");return function(c,A,u,d,f,h){for(var m=0,p="",x=[],g=[],y=0,b=0,F=0,j="",R,E,S=0,B=0,U,k,T=0,L=0,Y=Array.isArray(h.CellXf),me,ae=[],fe=[],de=Array.isArray(A),Z=[],xe={},Be=!1,I=!!u.sheetStubs,C=c.split(e),Q=0,M=C.length;Q!=M;++Q){p=C[Q].trim();var D=p.length;if(D!==0){var z=0;e:for(m=0;m<D;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(E=Cr(p.slice(z,m),!0),S=E.r!=null?parseInt(E.r,10):S+1,B=-1,u.sheetRows&&u.sheetRows<S)continue;xe={},Be=!1,E.ht&&(Be=!0,xe.hpt=parseFloat(E.ht),xe.hpx=K0(xe.hpt)),E.hidden=="1"&&(Be=!0,xe.hidden=!0),E.outlineLevel!=null&&(Be=!0,xe.level=+E.outlineLevel),Be&&(Z[S-1]=xe)}break;case"<":z=m;break}if(z>=m)break;if(E=Cr(p.slice(z,m),!0),S=E.r!=null?parseInt(E.r,10):S+1,B=-1,!(u.sheetRows&&u.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),u&&u.cellStyles&&(xe={},Be=!1,E.ht&&(Be=!0,xe.hpt=parseFloat(E.ht),xe.hpx=K0(xe.hpt)),E.hidden=="1"&&(Be=!0,xe.hidden=!0),E.outlineLevel!=null&&(Be=!0,xe.level=+E.outlineLevel),Be&&(Z[S-1]=xe)),x=p.slice(m).split(t);for(var O=0;O!=x.length&&x[O].trim().charAt(0)=="<";++O);for(x=x.slice(O),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(g=p.match(r),y=m,b=0,F=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,g!=null&&g.length===2){for(y=0,j=g[1],b=0;b!=j.length&&!((F=j.charCodeAt(b)-64)<1||F>26);++b)y=26*y+F;--y,B=y}else++B;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,E=Cr(p.slice(0,b),!0),E.r||(E.r=br({r:S-1,c:B})),j=p.slice(b),R={t:""},(g=j.match(a))!=null&&g[1]!==""&&(R.v=An(g[1])),u.cellFormula){if((g=j.match(o))!=null&&g[1]!==""){if(R.f=An(jn(g[1])).replace(/\r\n/g,`
`),u.xlfn||(R.f=WP(R.f)),g[0].indexOf('t="array"')>-1)R.F=(j.match(s)||[])[1],R.F.indexOf(":")>-1&&ae.push([un(R.F),R.F]);else if(g[0].indexOf('t="shared"')>-1){k=Cr(g[0]);var te=An(jn(g[1]));u.xlfn||(te=WP(te)),fe[parseInt(k.si,10)]=[k,te,E.r]}}else(g=j.match(/<f[^>]*\/>/))&&(k=Cr(g[0]),fe[k.si]&&(R.f=Qfe(fe[k.si][1],fe[k.si][2],E.r)));var se=vs(E.r);for(b=0;b<ae.length;++b)se.r>=ae[b][0].s.r&&se.r<=ae[b][0].e.r&&se.c>=ae[b][0].s.c&&se.c<=ae[b][0].e.c&&(R.F=ae[b][1])}if(E.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(I)R.t="z";else continue;else R.t=E.t||"n";switch(d.s.c>B&&(d.s.c=B),d.e.c<B&&(d.e.c=B),R.t){case"n":if(R.v==""||R.v==null){if(!I)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!I)continue;R.t="z"}else U=ng[parseInt(R.v,10)],R.v=U.t,R.r=U.r,u.cellHTML&&(R.h=U.h);break;case"str":R.t="s",R.v=R.v!=null?jn(R.v):"",u.cellHTML&&(R.h=cI(R.v));break;case"inlineStr":g=j.match(n),R.t="s",g!=null&&(U=NI(g[1]))?(R.v=U.t,u.cellHTML&&(R.h=U.h)):R.v="";break;case"b":R.v=Jn(R.v);break;case"d":u.cellDates?R.v=Zn(R.v,1):(R.v=da(Zn(R.v,1)),R.t="n");break;case"e":(!u||u.cellText!==!1)&&(R.w=R.v),R.v=Q8[R.v];break}if(T=L=0,me=null,Y&&E.s!==void 0&&(me=h.CellXf[E.s],me!=null&&(me.numFmtId!=null&&(T=me.numFmtId),u.cellStyles&&me.fillId!=null&&(L=me.fillId))),UQ(R,T,L,u,f,h),u.cellDates&&Y&&R.t=="n"&&lm(yr[T])&&(R.t="d",R.v=Jy(R.v)),E.cm&&u.xlmeta){var we=(u.xlmeta.Cell||[])[+E.cm-1];we&&we.type=="XLDAPR"&&(R.D=!0)}if(de){var q=vs(E.r);A[q.r]||(A[q.r]=[]),A[q.r][q.c]=R}else A[E.r]=R}}}}Z.length>0&&(A["!rows"]=Z)}}();function Gme(t,e,r,n){var s=[],a=[],o=un(t["!ref"]),l="",c,A="",u=[],d=0,f=0,h=t["!rows"],m=Array.isArray(t),p={r:A},x,g=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=xs(f);for(d=o.s.r;d<=o.e.r;++d){for(a=[],A=Hs(d),f=o.s.c;f<=o.e.c;++f){c=u[f]+A;var y=m?(t[d]||[])[f]:t[c];y!==void 0&&(l=Kme(y,c,t,e))!=null&&a.push(l)}(a.length>0||h&&h[d])&&(p={r:A},h&&h[d]&&(x=h[d],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=ax(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),s[s.length]=$t("row",a.join(""),p))}if(h)for(;d<h.length;++d)h&&h[d]&&(p={r:d+1},x=h[d],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=ax(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level),s[s.length]=$t("row","",p));return s.join("")}function MQ(t,e,r,n){var s=[qs,$t("worksheet",null,{xmlns:Jh[0],"xmlns:r":ca.r})],a=r.SheetNames[t],o=0,l="",c=r.Sheets[a];c==null&&(c={});var A=c["!ref"]||"A1",u=un(A);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+A+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),A=Pr(u)}n||(n={}),c["!comments"]=[];var d=[];Fme(c,r,t,e,s),s[s.length]=$t("dimension",null,{ref:A}),s[s.length]=Hme(c,e,t,r),e.sheetFormat&&(s[s.length]=$t("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Ume(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Gme(c,e),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=jme(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=Mme(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Sme(c["!merges"]));var f=-1,h,m=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=En(n,-1,In(p[1].Target).replace(/#.*$/,""),Gr.HLINK),h["r:id"]="rId"+m),(f=p[1].Target.indexOf("#"))>-1&&(h.location=In(p[1].Target.slice(f+1))),p[1].Tooltip&&(h.tooltip=In(p[1].Tooltip)),s[s.length]=$t("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Dme(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=Ka("ignoredErrors",$t("ignoredError",null,{numberStoredAsText:1,sqref:A}))),d.length>0&&(m=En(n,-1,"../drawings/drawing"+(t+1)+".xml",Gr.DRAW),s[s.length]=$t("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=d),c["!comments"].length>0&&(m=En(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Gr.VML),s[s.length]=$t("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function $me(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function zme(t,e,r){var n=Ct(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=ax(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var A={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var d=-1,f=-1,h=u<<10;h<u+1<<10;++h){A.c=h;var m=Array.isArray(r)?(r[A.r]||[])[A.c]:r[br(A)];m&&(d<0&&(d=h),f=h)}d<0||(++l,n.write_shift(4,d),n.write_shift(4,f))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function Wme(t,e,r,n){var s=zme(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&jt(t,0,s)}var Jme=ef,Xme=um;function Yme(){}function Zme(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=rAe(t),r}function epe(t,e,r){r==null&&(r=Ct(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return k2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),D8(t,r),r.slice(0,r.l)}function tpe(t){var e=fl(t);return[e]}function rpe(t,e,r){return r==null&&(r=Ct(8)),Xh(e,r)}function npe(t){var e=Yh(t);return[e]}function spe(t,e,r){return r==null&&(r=Ct(4)),Zh(e,r)}function ape(t){var e=fl(t),r=t.read_shift(1);return[e,r,"b"]}function ipe(t,e,r){return r==null&&(r=Ct(9)),Xh(e,r),r.write_shift(1,t.v?1:0),r}function ope(t){var e=Yh(t),r=t.read_shift(1);return[e,r,"b"]}function lpe(t,e,r){return r==null&&(r=Ct(5)),Zh(e,r),r.write_shift(1,t.v?1:0),r}function cpe(t){var e=fl(t),r=t.read_shift(1);return[e,r,"e"]}function Ape(t,e,r){return r==null&&(r=Ct(9)),Xh(e,r),r.write_shift(1,t.v),r}function upe(t){var e=Yh(t),r=t.read_shift(1);return[e,r,"e"]}function dpe(t,e,r){return r==null&&(r=Ct(8)),Zh(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function hpe(t){var e=fl(t),r=t.read_shift(4);return[e,r,"s"]}function fpe(t,e,r){return r==null&&(r=Ct(12)),Xh(e,r),r.write_shift(4,e.v),r}function mpe(t){var e=Yh(t),r=t.read_shift(4);return[e,r,"s"]}function ppe(t,e,r){return r==null&&(r=Ct(8)),Zh(e,r),r.write_shift(4,e.v),r}function gpe(t){var e=fl(t),r=hi(t);return[e,r,"n"]}function xpe(t,e,r){return r==null&&(r=Ct(16)),Xh(e,r),Ph(t.v,r),r}function QQ(t){var e=Yh(t),r=hi(t);return[e,r,"n"]}function vpe(t,e,r){return r==null&&(r=Ct(12)),Zh(e,r),Ph(t.v,r),r}function wpe(t){var e=fl(t),r=xI(t);return[e,r,"n"]}function ype(t,e,r){return r==null&&(r=Ct(12)),Xh(e,r),L8(t.v,r),r}function bpe(t){var e=Yh(t),r=xI(t);return[e,r,"n"]}function Npe(t,e,r){return r==null&&(r=Ct(8)),Zh(e,r),L8(t.v,r),r}function Cpe(t){var e=fl(t),r=mI(t);return[e,r,"is"]}function _pe(t){var e=fl(t),r=fi(t);return[e,r,"str"]}function Epe(t,e,r){return r==null&&(r=Ct(12+4*t.v.length)),Xh(e,r),Ca(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Bpe(t){var e=Yh(t),r=fi(t);return[e,r,"str"]}function Spe(t,e,r){return r==null&&(r=Ct(8+4*t.v.length)),Zh(e,r),Ca(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Ipe(t,e,r){var n=t.l+e,s=fl(t);s.r=r["!row"];var a=t.read_shift(1),o=[s,a,"b"];if(r.cellFormula){t.l+=2;var l=Zy(t,n-t.l,r);o[3]=Ai(l,null,s,r.supbooks,r)}else t.l=n;return o}function Fpe(t,e,r){var n=t.l+e,s=fl(t);s.r=r["!row"];var a=t.read_shift(1),o=[s,a,"e"];if(r.cellFormula){t.l+=2;var l=Zy(t,n-t.l,r);o[3]=Ai(l,null,s,r.supbooks,r)}else t.l=n;return o}function kpe(t,e,r){var n=t.l+e,s=fl(t);s.r=r["!row"];var a=hi(t),o=[s,a,"n"];if(r.cellFormula){t.l+=2;var l=Zy(t,n-t.l,r);o[3]=Ai(l,null,s,r.supbooks,r)}else t.l=n;return o}function Tpe(t,e,r){var n=t.l+e,s=fl(t);s.r=r["!row"];var a=fi(t),o=[s,a,"str"];if(r.cellFormula){t.l+=2;var l=Zy(t,n-t.l,r);o[3]=Ai(l,null,s,r.supbooks,r)}else t.l=n;return o}var jpe=ef,Ppe=um;function Rpe(t,e){return e==null&&(e=Ct(4)),e.write_shift(4,t),e}function Dpe(t,e){var r=t.l+e,n=ef(t),s=pI(t),a=fi(t),o=fi(t),l=fi(t);t.l=r;var c={rfx:n,relId:s,loc:a,display:l};return o&&(c.Tooltip=o),c}function Lpe(t,e){var r=Ct(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));um({s:vs(t[0]),e:vs(t[0])},r),gI("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Ca(s||"",r),Ca(t[1].Tooltip||"",r),Ca("",r),r.slice(0,r.l)}function Upe(){}function Ope(t,e,r){var n=t.l+e,s=U8(t),a=t.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=cme(t,n-t.l,r);o[1]=l}else t.l=n;return o}function Mpe(t,e,r){var n=t.l+e,s=ef(t),a=[s];if(r.cellFormula){var o=ume(t,n-t.l,r);a[1]=o,t.l=n}else t.l=n;return a}function Qpe(t,e,r){r==null&&(r=Ct(18));var n=eb(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var VQ=["left","right","top","bottom","header","footer"];function Vpe(t){var e={};return VQ.forEach(function(r){e[r]=hi(t)}),e}function Hpe(t,e){return e==null&&(e=Ct(6*8)),fh(t),VQ.forEach(function(r){Ph(t[r],e)}),e}function Kpe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function qpe(t,e,r){r==null&&(r=Ct(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Gpe(t){var e=Ct(24);return e.write_shift(4,4),e.write_shift(4,1),um(t,e),e}function $pe(t,e){return e==null&&(e=Ct(16*4+2)),e.write_shift(2,t.password?CI(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function zpe(){}function Wpe(){}function Jpe(t,e,r,n,s,a,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},A,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,f=!1,h,m,p,x,g,y,b,F,j,R=[];l.biff=12,l["!row"]=0;var E=0,S=!1,B=[],U={},k=l.supbooks||s.supbooks||[[]];if(k.sharedf=U,k.arrayf=B,k.SheetNames=s.SheetNames||s.Sheets.map(function(de){return de.name}),!l.supbooks&&(l.supbooks=k,s.Names))for(var T=0;T<s.Names.length;++T)k[0][T+1]=s.Names[T];var L=[],Y=[],me=!1;ix[16]={n:"BrtShortReal",f:QQ};var ae;if(jA(t,function(Z,xe,Be){if(!f)switch(Be){case 148:A=Z;break;case 0:h=Z,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),F=Hs(x=h.r),l["!row"]=h.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=K0(Z.hpt)),Y[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:Z[2]},Z[2]){case"n":m.v=Z[1];break;case"s":b=ng[Z[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!Z[1];break;case"e":m.v=Z[1],l.cellText!==!1&&(m.w=PA[m.v]);break;case"str":m.t="s",m.v=Z[1];break;case"is":m.t="s",m.v=Z[1].t;break}if((p=o.CellXf[Z[0].iStyleRef])&&UQ(m,p.numFmtId,null,l,a,o),g=Z[0].c==-1?g+1:Z[0].c,l.dense?(c[x]||(c[x]=[]),c[x][g]=m):c[xs(g)+F]=m,l.cellFormula){for(S=!1,E=0;E<B.length;++E){var I=B[E];h.r>=I[0].s.r&&h.r<=I[0].e.r&&g>=I[0].s.c&&g<=I[0].e.c&&(m.F=Pr(I[0]),S=!0)}!S&&Z.length>3&&(m.f=Z[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),l.cellDates&&p&&m.t=="n"&&lm(yr[p.numFmtId])){var C=th(m.v);C&&(m.t="d",m.v=new Date(C.y,C.m-1,C.d,C.H,C.M,C.S,C.u))}ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 1:case 12:if(!l.sheetStubs||d)break;m={t:"z",v:void 0},g=Z[0].c==-1?g+1:Z[0].c,l.dense?(c[x]||(c[x]=[]),c[x][g]=m):c[xs(g)+F]=m,u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 176:R.push(Z);break;case 49:ae=((l.xlmeta||{}).Cell||[])[Z-1];break;case 494:var Q=n["!id"][Z.relId];for(Q?(Z.Target=Q.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=Q):Z.relId==""&&(Z.Target="#"+Z.loc),x=Z.rfx.s.r;x<=Z.rfx.e.r;++x)for(g=Z.rfx.s.c;g<=Z.rfx.e.c;++g)l.dense?(c[x]||(c[x]=[]),c[x][g]||(c[x][g]={t:"z",v:void 0}),c[x][g].l=Z):(y=br({c:g,r:x}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=Z);break;case 426:if(!l.cellFormula)break;B.push(Z),j=l.dense?c[x][g]:c[xs(g)+F],j.f=Ai(Z[1],u,{r:h.r,c:g},k,l),j.F=Pr(Z[0]);break;case 427:if(!l.cellFormula)break;U[br(Z[0].s)]=Z[1],j=l.dense?c[x][g]:c[xs(g)+F],j.f=Ai(Z[1],u,{r:h.r,c:g},k,l);break;case 60:if(!l.cellStyles)break;for(;Z.e>=Z.s;)L[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},me||(me=!0,_I(Z.w/256)),id(L[Z.e+1]);break;case 161:c["!autofilter"]={ref:Pr(Z)};break;case 476:c["!margins"]=Z;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),Z.name&&(s.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(c["!outline"]={above:Z.above,left:Z.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),Z.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!xe.T){if(!d||l.WTF)throw new Error("Unexpected record 0x"+Be.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(c["!ref"]=Pr(A||u)),l.sheetRows&&c["!ref"]){var fe=un(c["!ref"]);l.sheetRows<=+fe.e.r&&(fe.e.r=l.sheetRows-1,fe.e.r>u.e.r&&(fe.e.r=u.e.r),fe.e.r<fe.s.r&&(fe.s.r=fe.e.r),fe.e.c>u.e.c&&(fe.e.c=u.e.c),fe.e.c<fe.s.c&&(fe.s.c=fe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Pr(fe))}return R.length>0&&(c["!merges"]=R),L.length>0&&(c["!cols"]=L),Y.length>0&&(c["!rows"]=Y),c}function Xpe(t,e,r,n,s,a,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=es(e),e.z=e.z||yr[14],e.v=da(Zn(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=vd(s.cellXfs,e,s),e.l&&a["!links"].push([br(c),e.l]),e.c&&a["!comments"].push([br(c),e.c]),e.t){case"s":case"str":return s.bookSST?(l=FI(s.Strings,e.v,s.revStrings),c.t="s",c.v=l,o?jt(t,18,ppe(e,c)):jt(t,7,fpe(e,c))):(c.t="str",o?jt(t,17,Spe(e,c)):jt(t,6,Epe(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?jt(t,13,Npe(e,c)):jt(t,2,ype(e,c)):o?jt(t,16,vpe(e,c)):jt(t,5,xpe(e,c)),!0;case"b":return c.t="b",o?jt(t,15,lpe(e,c)):jt(t,4,ipe(e,c)),!0;case"e":return c.t="e",o?jt(t,14,dpe(e,c)):jt(t,3,Ape(e,c)),!0}return o?jt(t,12,spe(e,c)):jt(t,1,rpe(e,c)),!0}function Ype(t,e,r,n){var s=un(e["!ref"]||"A1"),a,o="",l=[];jt(t,145);var c=Array.isArray(e),A=s.e.r;e["!rows"]&&(A=Math.max(s.e.r,e["!rows"].length-1));for(var u=s.s.r;u<=A;++u){o=Hs(u),Wme(t,e,s,u);var d=!1;if(u<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=xs(f)),a=l[f]+o;var h=c?(e[u]||[])[f]:e[a];if(!h){d=!1;continue}d=Xpe(t,h,u,f,n,e,d)}}jt(t,146)}function Zpe(t,e){!e||!e["!merges"]||(jt(t,177,Rpe(e["!merges"].length)),e["!merges"].forEach(function(r){jt(t,176,Ppe(r))}),jt(t,178))}function ege(t,e){!e||!e["!cols"]||(jt(t,390),e["!cols"].forEach(function(r,n){r&&jt(t,60,Qpe(n,r))}),jt(t,391))}function tge(t,e){!e||!e["!ref"]||(jt(t,648),jt(t,649,Gpe(un(e["!ref"]))),jt(t,650))}function rge(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=En(r,-1,n[1].Target.replace(/#.*$/,""),Gr.HLINK);jt(t,494,Lpe(n,s))}}),delete e["!links"]}function nge(t,e,r,n){if(e["!comments"].length>0){var s=En(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Gr.VML);jt(t,551,gI("rId"+s)),e["!legacy"]=s}}function sge(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:Pr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Yi(a);l.s.r==l.e.r&&(l.e.r=Yi(e["!ref"]).e.r,a=Pr(l));for(var c=0;c<o.length;++c){var A=o[c];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==n){A.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),jt(t,161,um(un(a))),jt(t,162)}}function age(t,e,r){jt(t,133),jt(t,137,qpe(e,r)),jt(t,138),jt(t,134)}function ige(t,e){e["!protect"]&&jt(t,535,$pe(e["!protect"]))}function oge(t,e,r,n){var s=Xi(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=un(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],jt(s,129),(r.vbaraw||o["!outline"])&&jt(s,147,epe(l,o["!outline"])),jt(s,148,Xme(c)),age(s,o,r.Workbook),ege(s,o),Ype(s,o,t,e),ige(s,o),sge(s,o,r,t),Zpe(s,o),rge(s,o,n),o["!margins"]&&jt(s,476,Hpe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&tge(s,o),nge(s,o,t,n),jt(s,130),s.end()}function lge(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var s=An((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function cge(t,e,r,n,s,a){var o=a||{"!type":"chart"};if(!t)return a;var l=0,c=0,A="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=lge(d);u.s.r=u.s.c=0,u.e.c=l,A=xs(l),f[0].forEach(function(h,m){o[A+Hs(m)]={t:"n",v:h,z:f[1]},c=m}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Pr(u)),o}function Age(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(OQ);return l&&kI(l[0],a,s,r),(o=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function uge(t,e){t.l+=10;var r=fi(t);return{name:r}}function dge(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return jA(t,function(c,A,u){switch(u){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var TI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],hge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],fge=[],mge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function e3(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Jn(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function t3(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Jn(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function HQ(t){t3(t.WBProps,TI),t3(t.CalcPr,mge),e3(t.WBView,hge),e3(t.Sheets,fge),b0.date1904=Jn(t.WBProps.date1904)}function pge(t){return!t.Workbook||!t.Workbook.WBProps?"false":Jn(t.Workbook.WBProps.date1904)?"true":"false"}var gge="][*?/\\".split("");function KQ(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return gge.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function xge(t,e,r){t.forEach(function(n,s){KQ(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[s]&&e[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function vge(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];xge(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)pme(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var wge=/<\w+:workbook/;function yge(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},o=0;if(t.replace(gi,function(c,A){var u=Cr(c);switch(kc(u[0])){case"<?xml":break;case"<workbook":c.match(wge)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":TI.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Jn(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=jn(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=An(jn(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=jn(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Jn(u.hidden||"0")&&(a.Hidden=!0),o=A+c.length;break;case"</definedName>":a.Ref=An(jn(t.slice(o,A))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Jh.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return HQ(r),r}function qQ(t){var e=[qs];e[e.length]=$t("workbook",null,{xmlns:Jh[0],"xmlns:r":ca.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(TI.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=$t("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var o={name:In(t.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=$t("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=$t("definedName",In(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function bge(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=EE(t),r.name=fi(t),r}function Nge(t,e){return e||(e=Ct(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),gI(t.strRelID,e),Ca(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Cge(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?fi(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function _ge(t,e){e||(e=Ct(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),D8(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Ege(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Bge(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=nAe(t),o=Ame(t,0,r),l=pI(t);t.l=n;var c={Name:a,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Sge(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],ix[16]={n:"BrtFRTArchID$",f:Ege},jA(t,function(c,A,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Ai(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!A.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),HQ(r),r.Names=a,r.supbooks=o,r}function Ige(t,e){jt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};jt(t,156,Nge(s))}jt(t,144)}function Fge(t,e){e||(e=Ct(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ca("SheetJS",e),Ca(C2.version,e),Ca(C2.version,e),Ca("7262",e),e.length>e.l?e.slice(0,e.l):e}function kge(t,e){e||(e=Ct(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Tge(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(jt(t,135),jt(t,158,kge(s)),jt(t,136))}}function jge(t,e){var r=Xi();return jt(r,131),jt(r,128,Fge()),jt(r,153,_ge(t.Workbook&&t.Workbook.WBProps||null)),Tge(r,t),Ige(r,t),jt(r,132),r.end()}function Pge(t,e,r){return e.slice(-4)===".bin"?Sge(t,r):yge(t,r)}function Rge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Jpe(t,n,r,s,a,o,l):Bme(t,n,r,s,a,o,l)}function Dge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?dge(t,n,r,s,a):Age(t,n,r,s,a)}function Lge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Ofe():Mfe()}function Uge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Lfe():Ufe()}function Oge(t,e,r,n){return e.slice(-4)===".bin"?Phe(t,r,n):bhe(t,r,n)}function Mge(t,e,r){return _Q(t,r)}function Qge(t,e,r){return e.slice(-4)===".bin"?Qde(t,r):Ude(t,r)}function Vge(t,e,r){return e.slice(-4)===".bin"?Tfe(t,r):Nfe(t,r)}function Hge(t,e,r){return e.slice(-4)===".bin"?wfe(t):xfe(t)}function Kge(t,e,r,n){return r.slice(-4)===".bin"?yfe(t,e,r,n):void 0}function qge(t,e,r){return e.slice(-4)===".bin"?mfe(t,e,r):gfe(t,e,r)}function Gge(t,e,r){return(e.slice(-4)===".bin"?jge:qQ)(t)}function $ge(t,e,r,n,s){return(e.slice(-4)===".bin"?oge:MQ)(t,r,n,s)}function zge(t,e,r){return(e.slice(-4)===".bin"?Khe:NQ)(t,r)}function Wge(t,e,r){return(e.slice(-4)===".bin"?Kde:mQ)(t,r)}function Jge(t,e,r){return(e.slice(-4)===".bin"?jfe:SQ)(t)}function Xge(t){return(t.slice(-4)===".bin"?pfe:EQ)()}var GQ=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,$Q=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _l(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(GQ),a,o,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match($Q),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function Yge(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(GQ),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match($Q),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}var ag;function Zge(t,e){var r=ag[t]||An(t);return r==="General"?Th(e):hl(r,e)}function exe(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Jn(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Zn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[An(e)]=s}function txe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||PA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xg(t.v):t.w=Th(t.v):t.w=Zge(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=ag[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&lm(n)){var s=th(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function rxe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=fhe[n.Pattern]||n.Pattern)}t[e.ID]=e}function nxe(t,e,r,n,s,a,o,l,c,A){var u="General",d=n.StyleID,f={};A=A||{};var h=[],m=0;for(d===void 0&&l&&(d=l.StyleID),d===void 0&&o&&(d=o.StyleID);a[d]!==void 0&&(a[d].nf&&(u=a[d].nf),a[d].Interior&&h.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Jn(t);break;case"String":n.t="s",n.r=xP(An(t)),n.v=t.indexOf("<")>-1?An(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Zn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=An(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Q8[t],A.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=xP(e||t));break}if(txe(n,u,A),A.cellFormula!==!1)if(n.Formula){var p=An(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=y0(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=y0("RC:RC",s):n.ArrayRange&&(n.F=y0(n.ArrayRange,s),c.push([un(n.F),n.F]))}else for(m=0;m<c.length;++m)s.r>=c[m][0].s.r&&s.r<=c[m][0].e.r&&s.c>=c[m][0].s.c&&s.c<=c[m][0].e.c&&(n.F=c[m][1]);A.cellStyles&&(h.forEach(function(x){!f.patternType&&x.patternType&&(f.patternType=x.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function sxe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function aC(t,e){var r=e||{};cm();var n=bp(AI(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=jn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=es(r);return o.type="string",H0.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(pe){s.indexOf("<"+pe)>=0&&(a=!0)}),a)return Hxe(n,r);ag={"General Number":"General","General Date":yr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":yr[15],"Short Date":yr[14],"Long Time":yr[19],"Medium Time":yr[18],"Short Time":yr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:yr[2],Standard:yr[4],Percent:yr[10],Scientific:yr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],A,u={},d=[],f=r.dense?[]:{},h="",m={},p={},x=_l('<Data ss:Type="String">'),g=0,y=0,b=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},R={},E="",S=0,B=[],U={},k={},T=0,L=[],Y=[],me={},ae=[],fe,de=!1,Z=[],xe=[],Be={},I=0,C=0,Q={Sheets:[],WBProps:{date1904:!1}},M={};ex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var D="";l=ex.exec(n);)switch(l[3]=(D=l[3]).toLowerCase()){case"data":if(D=="data"){if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?nxe(n.slice(g,l.index),E,x,c[c.length-1][0]=="comment"?me:m,{c:y,r:b},j,ae[y],p,Z,r):(E="",x=_l(l[0]),g=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Y.length>0&&(m.c=Y),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(f[b]||(f[b]=[]),f[b][y]=m):f[xs(y)+Hs(b)]=m),m.HRef&&(m.l={Target:An(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(I=y+(parseInt(m.MergeAcross,10)|0),C=b+(parseInt(m.MergeDown,10)|0),B.push({s:{c:y,r:b},e:{c:I,r:C}})),!r.sheetStubs)m.MergeAcross?y=I+1:++y;else if(m.MergeAcross||m.MergeDown){for(var z=y;z<=I;++z)for(var O=b;O<=C;++O)(z>y||O>b)&&(r.dense?(f[O]||(f[O]=[]),f[O][z]={t:"z"}):f[xs(z)+Hs(O)]={t:"z"});y=I+1}else++y;else m=Yge(l[0]),m.Index&&(y=+m.Index-1),y<F.s.c&&(F.s.c=y),y>F.e.c&&(F.e.c=y),l[0].slice(-2)==="/>"&&++y,Y=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<F.s.r&&(F.s.r=b),b>F.e.r&&(F.e.r=b),l[0].slice(-2)==="/>"&&(p=_l(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=_l(l[0]),p.Index&&(b=+p.Index-1),Be={},(p.AutoFitHeight=="0"||p.Height)&&(Be.hpx=parseInt(p.Height,10),Be.hpt=ax(Be.hpx),xe[b]=Be),p.Hidden=="1"&&(Be.hidden=!0,xe[b]=Be));break;case"worksheet":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));d.push(h),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(f["!ref"]=Pr(F),r.sheetRows&&r.sheetRows<=F.e.r&&(f["!fullref"]=f["!ref"],F.e.r=r.sheetRows-1,f["!ref"]=Pr(F))),B.length&&(f["!merges"]=B),ae.length>0&&(f["!cols"]=ae),xe.length>0&&(f["!rows"]=xe),u[h]=f}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),A=_l(l[0]),h=An(A.Name),f=r.dense?[]:{},B=[],Z=[],xe=[],M={name:h,Hidden:0},Q.Sheets.push(M);break;case"table":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ae=[],de=!1}break;case"style":l[1]==="/"?rxe(j,R,r):R=_l(l[0]);break;case"numberformat":R.nf=An(_l(l[0]).Format||"General"),ag[R.nf]&&(R.nf=ag[R.nf]);for(var te=0;te!=392&&yr[te]!=R.nf;++te);if(te==392){for(te=57;te!=392;++te)if(yr[te]==null){gA(R.nf,te);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(fe=_l(l[0]),fe.Hidden&&(fe.hidden=!0,delete fe.Hidden),fe.Width&&(fe.wpx=parseInt(fe.Width,10)),!de&&fe.wpx>10){de=!0,di=yQ;for(var se=0;se<ae.length;++se)ae[se]&&id(ae[se])}de&&id(fe),ae[fe.Index-1||ae.length]=fe;for(var we=0;we<+fe.Span;++we)ae[ae.length]=es(fe);break;case"namedrange":if(l[1]==="/")break;Q.Names||(Q.Names=[]);var q=Cr(l[0]),Me={Name:q.Name,Ref:y0(q.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(Me.Sheet=Q.Sheets.length-1),Q.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?E+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=_l(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?SAe(U,D,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));sxe(me),Y.push(me)}else c.push([l[3],!1]),A=_l(l[0]),me={a:A.Author};break;case"autofilter":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var re=_l(l[0]);f["!autofilter"]={ref:y0(re.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return i3(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else T=l.index+l[0].length;break;case"header":f["!margins"]||fh(f["!margins"]={},"xlml"),isNaN(+Cr(l[0]).Margin)||(f["!margins"].header=+Cr(l[0]).Margin);break;case"footer":f["!margins"]||fh(f["!margins"]={},"xlml"),isNaN(+Cr(l[0]).Margin)||(f["!margins"].footer=+Cr(l[0]).Margin);break;case"pagemargins":var K=Cr(l[0]);f["!margins"]||fh(f["!margins"]={},"xlml"),isNaN(+K.Top)||(f["!margins"].top=+K.Top),isNaN(+K.Left)||(f["!margins"].left=+K.Left),isNaN(+K.Right)||(f["!margins"].right=+K.Right),isNaN(+K.Bottom)||(f["!margins"].bottom=+K.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?exe(k,D,L,n.slice(T,l.index)):(L=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ie={};return!r.bookSheets&&!r.bookProps&&(ie.Sheets=u),ie.SheetNames=d,ie.Workbook=Q,ie.SSF=es(yr),ie.Props=U,ie.Custprops=k,ie}function jE(t,e){switch(PI(e=e||{}),e.type||"base64"){case"base64":return aC(Fo(t),e);case"binary":case"buffer":case"file":return aC(t,e);case"array":return aC(gd(t),e)}}function axe(t,e){var r=[];return t.Props&&r.push(IAe(t.Props,e)),t.Custprops&&r.push(FAe(t.Props,t.Custprops)),r.join("")}function ixe(){return""}function oxe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push($t("NumberFormat",null,{"ss:Format":In(yr[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push($t("Style",a.join(""),o))}),$t("Styles",r.join(""))}function zQ(t){return $t("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+SI(t.Ref,{r:0,c:0})})}function lxe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(zQ(s)))}return $t("Names",r.join(""))}function cxe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(zQ(l)))}return a.join("")}function Axe(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push($t("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push($t("Footer",null,{"x:Margin":t["!margins"].footer})),s.push($t("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push($t("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(Ka("ProtectContents","True")),t["!protect"].objects&&s.push(Ka("ProtectObjects","True")),t["!protect"].scenarios&&s.push(Ka("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(Ka("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(Ka("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":$t("WorksheetOptions",s.join(""),{xmlns:vo.x})}function uxe(t){return t.map(function(e){var r=Tce(e.t||""),n=$t("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return $t("Comment",n,{"ss:Author":e.a})}).join("")}function dxe(t,e,r,n,s,a,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+In(SI(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=vs(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=In(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=In(t.l.Tooltip))),r["!merges"])for(var A=r["!merges"],u=0;u!=A.length;++u)A[u].s.c!=o.c||A[u].s.r!=o.r||(A[u].e.c>A[u].s.c&&(l["ss:MergeAcross"]=A[u].e.c-A[u].s.c),A[u].e.r>A[u].s.r&&(l["ss:MergeDown"]=A[u].e.r-A[u].s.r));var d="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",f=String(t.v);break;case"b":d="Boolean",f=t.v?"1":"0";break;case"e":d="Error",f=PA[t.v];break;case"d":d="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||yr[14]);break;case"s":d="String",f=kce(t.v||"");break}var h=vd(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?f:"",p=t.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=uxe(t.c)),$t("Cell",p,l)}function hxe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=K0(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function fxe(t,e,r,n){if(!t["!ref"])return"";var s=un(t["!ref"]),a=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,g){id(x);var y=!!x.width,b=eb(g,x),F={"ss:Index":g+1};y&&(F["ss:Width"]=nx(b.width)),x.hidden&&(F["ss:Hidden"]="1"),l.push($t("Column",null,F))});for(var c=Array.isArray(t),A=s.s.r;A<=s.e.r;++A){for(var u=[hxe(A,(t["!rows"]||[])[A])],d=s.s.c;d<=s.e.c;++d){var f=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>d)&&!(a[o].s.r>A)&&!(a[o].e.c<d)&&!(a[o].e.r<A)){(a[o].s.c!=d||a[o].s.r!=A)&&(f=!0);break}if(!f){var h={r:A,c:d},m=br(h),p=c?(t[A]||[])[d]:t[m];u.push(dxe(p,m,t,e,r,n,h))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function mxe(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],o=a?cxe(a,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?fxe(a,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Axe(a,e,t,r)),n.join("")}function pxe(t,e){e||(e={}),t.SSF||(t.SSF=es(yr)),t.SSF&&(cm(),$y(t.SSF),e.revssf=Wy(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],vd(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(axe(t,e)),r.push(ixe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push($t("Worksheet",mxe(n,e,t),{"ss:Name":In(t.SheetNames[n])}));return r[2]=oxe(t,e),r[3]=lxe(t),qs+$t("Workbook",r.join(""),{xmlns:vo.ss,"xmlns:o":vo.o,"xmlns:x":vo.x,"xmlns:ss":vo.ss,"xmlns:dt":vo.dt,"xmlns:html":vo.html})}function gxe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=lAe(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=cAe(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var xxe=[60,1084,2066,2165,2175];function vxe(t,e,r,n,s){var a=n,o=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=a;for(var c=lA(r,r.l),A=PE[c],u=0;A!=null&&xxe.indexOf(c)>-1;)a=lA(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+a),o.push(l),r.l+=4+a,A=PE[c=lA(r,r.l)];var d=ba(o);Va(d,0);var f=0;d.lens=[];for(var h=0;h<o.length;++h)d.lens.push(f),f+=o[h].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,s)}function oc(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=yr[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||PA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xg(t.v):t.w=Th(t.v):t.w=hl(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&lm(yr[n]||String(n))){var s=th(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Iv(t,e,r){return{v:t,ixfe:e,t:r}}function wxe(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},o={},l=null,c=[],A="",u={},d,f="",h,m,p,x,g={},y=[],b,F,j=[],R=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},B=function(X){return X<8?uh[X]:X<64&&R[X-8]||uh[X]},U=function(X,G,ye){var Oe=G.XF.data;if(!(!Oe||!Oe.patternType||!ye||!ye.cellStyles)){G.s={},G.s.patternType=Oe.patternType;var _e;(_e=rx(B(Oe.icvFore)))&&(G.s.fgColor={rgb:_e}),(_e=rx(B(Oe.icvBack)))&&(G.s.bgColor={rgb:_e})}},k=function(X,G,ye){if(!(Be>1)&&!(ye.sheetRows&&X.r>=ye.sheetRows)){if(ye.cellStyles&&G.XF&&G.XF.data&&U(X,G,ye),delete G.ixfe,delete G.XF,d=X,f=br(X),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),X.r<o.s.r&&(o.s.r=X.r),X.c<o.s.c&&(o.s.c=X.c),X.r+1>o.e.r&&(o.e.r=X.r+1),X.c+1>o.e.c&&(o.e.c=X.c+1),ye.cellFormula&&G.f){for(var Oe=0;Oe<y.length;++Oe)if(!(y[Oe][0].s.c>X.c||y[Oe][0].s.r>X.r)&&!(y[Oe][0].e.c<X.c||y[Oe][0].e.r<X.r)){G.F=Pr(y[Oe][0]),(y[Oe][0].s.c!=X.c||y[Oe][0].s.r!=X.r)&&delete G.f,G.f&&(G.f=""+Ai(y[Oe][1],o,X,Z,T));break}}ye.dense?(s[X.r]||(s[X.r]=[]),s[X.r][X.c]=G):s[f]=G}},T={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var L,Y=[],me=[],ae=[],fe=[],de=!1,Z=[];Z.SheetNames=T.snames,Z.sharedf=T.sharedf,Z.arrayf=T.arrayf,Z.names=[],Z.XTI=[];var xe=0,Be=0,I=0,C=[],Q=[],M;T.codepage=1200,Tl(1200);for(var D=!1;t.l<t.length-1;){var z=t.l,O=t.read_shift(2);if(O===0&&xe===10)break;var te=t.l===t.length?0:t.read_shift(2),se=PE[O];if(se&&se.f){if(e.bookSheets&&xe===133&&O!==133)break;if(xe=O,se.r===2||se.r==12){var we=t.read_shift(2);if(te-=2,!T.enc&&we!==O&&((we&255)<<8|we>>8)!==O)throw new Error("rt mismatch: "+we+"!="+O);se.r==12&&(t.l+=10,te-=10)}var q={};if(O===10?q=se.f(t,te,T):q=vxe(O,se,t,te,T),Be==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(O){case 34:r.opts.Date1904=E.WBProps.date1904=q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=q,!e.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=q;break;case 66:var Me=Number(q);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}Tl(T.codepage=Me),D=!0;break;case 317:T.rrtabid=q;break;case 25:T.winlocked=q;break;case 439:r.opts.RefreshAll=q;break;case 12:r.opts.CalcCount=q;break;case 16:r.opts.CalcDelta=q;break;case 17:r.opts.CalcIter=q;break;case 13:r.opts.CalcMode=q;break;case 14:r.opts.CalcPrecision=q;break;case 95:r.opts.CalcSaveRecalc=q;break;case 15:T.CalcRefMode=q;break;case 2211:r.opts.FullCalc=q;break;case 129:q.fDialog&&(s["!type"]="dialog"),q.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),q.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:j.push(q);break;case 430:Z.push([q]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(q);break;case 24:case 536:M={Name:q.Name,Ref:Ai(q.rgce,o,null,Z,T)},q.itab>0&&(M.Sheet=q.itab-1),Z.names.push(M),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(Q[q.itab-1]={ref:Pr(q.rgce[0][0][1][2])});break;case 22:T.ExternCount=q;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(q),Z.XTI=Z.XTI.concat(q);break;case 2196:if(T.biff<8)break;M!=null&&(M.Comment=q[1]);break;case 18:s["!protect"]=q;break;case 19:q!==0&&T.WTF&&console.error("Password verifier: "+q);break;case 133:a[q.pos]=q,T.snames.push(q.name);break;case 10:{if(--Be)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Pr(o),e.sheetRows&&e.sheetRows<=o.e.r){var re=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Pr(o),o.e.r=re}o.e.r++,o.e.c++}Y.length>0&&(s["!merges"]=Y),me.length>0&&(s["!objects"]=me),ae.length>0&&(s["!cols"]=ae),fe.length>0&&(s["!rows"]=fe),E.Sheets.push(S)}A===""?u=s:n[A]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[O]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),T.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(T.biff=5,D=!0,Tl(T.codepage=28591)),T.biff==8&&q.BIFFVer==0&&q.dt==16&&(T.biff=2),Be++)break;if(s=e.dense?[]:{},T.biff<8&&!D&&(D=!0,Tl(T.codepage=e.codepage||1252)),T.biff<5||q.BIFFVer==0&&q.dt==4096){A===""&&(A="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:t.l-te,name:A};a[J.pos]=J,T.snames.push(A)}else A=(a[z]||{name:""}).name;q.dt==32&&(s["!type"]="chart"),q.dt==64&&(s["!type"]="macro"),Y=[],me=[],T.arrayf=y=[],ae=[],fe=[],de=!1,S={Hidden:(a[z]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[q.r]||[])[q.c]:s[br({c:q.c,r:q.r})])&&++q.c,b={ixfe:q.ixfe,XF:j[q.ixfe]||{},v:q.val,t:"n"},I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:q.c,r:q.r},b,e);break;case 5:case 517:b={ixfe:q.ixfe,XF:j[q.ixfe],v:q.val,t:q.t},I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:q.c,r:q.r},b,e);break;case 638:b={ixfe:q.ixfe,XF:j[q.ixfe],v:q.rknum,t:"n"},I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:q.c,r:q.r},b,e);break;case 189:for(var K=q.c;K<=q.C;++K){var ie=q.rkrec[K-q.c][0];b={ixfe:ie,XF:j[ie],v:q.rkrec[K-q.c][1],t:"n"},I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:K,r:q.r},b,e)}break;case 6:case 518:case 1030:{if(q.val=="String"){l=q;break}if(b=Iv(q.val,q.cell.ixfe,q.tt),b.XF=j[b.ixfe],e.cellFormula){var pe=q.formula;if(pe&&pe[0]&&pe[0][0]&&pe[0][0][0]=="PtgExp"){var Ee=pe[0][0][1][0],Ue=pe[0][0][1][1],qe=br({r:Ee,c:Ue});g[qe]?b.f=""+Ai(q.formula,o,q.cell,Z,T):b.F=((e.dense?(s[Ee]||[])[Ue]:s[qe])||{}).F}else b.f=""+Ai(q.formula,o,q.cell,Z,T)}I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k(q.cell,b,e),l=q}break;case 7:case 519:if(l)l.val=q,b=Iv(q,l.cell.ixfe,"s"),b.XF=j[b.ixfe],e.cellFormula&&(b.f=""+Ai(l.formula,o,l.cell,Z,T)),I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(q);var $e=br(q[0].s);if(h=e.dense?(s[q[0].s.r]||[])[q[0].s.c]:s[$e],e.cellFormula&&h){if(!l||!$e||!h)break;h.f=""+Ai(q[1],o,q[0],Z,T),h.F=Pr(q[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!l)break;g[br(l.cell)]=q[0],h=e.dense?(s[l.cell.r]||[])[l.cell.c]:s[br(l.cell)],(h||{}).f=""+Ai(q[0],o,d,Z,T)}}break;case 253:b=Iv(c[q.isst].t,q.ixfe,"s"),c[q.isst].h&&(b.h=c[q.isst].h),b.XF=j[b.ixfe],I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:q.c,r:q.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:q.ixfe,XF:j[q.ixfe],t:"z"},I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:q.c,r:q.r},b,e));break;case 190:if(e.sheetStubs)for(var st=q.c;st<=q.C;++st){var Se=q.ixfe[st-q.c];b={ixfe:Se,XF:j[Se],t:"z"},I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:st,r:q.r},b,e)}break;case 214:case 516:case 4:b=Iv(q.val,q.ixfe,"s"),b.XF=j[b.ixfe],I>0&&(b.z=C[b.ixfe>>8&63]),oc(b,e,r.opts.Date1904),k({c:q.c,r:q.r},b,e);break;case 0:case 512:Be===1&&(o=q);break;case 252:c=q;break;case 1054:if(T.biff==4){C[I++]=q[1];for(var ze=0;ze<I+163&&yr[ze]!=q[1];++ze);ze>=163&&gA(q[1],I+163)}else gA(q[1],q[0]);break;case 30:{C[I++]=q;for(var Ke=0;Ke<I+163&&yr[Ke]!=q;++Ke);Ke>=163&&gA(q,I+163)}break;case 229:Y=Y.concat(q);break;case 93:me[q.cmo[0]]=T.lastobj=q;break;case 438:T.lastobj.TxO=q;break;case 127:T.lastobj.ImData=q;break;case 440:for(x=q[0].s.r;x<=q[0].e.r;++x)for(p=q[0].s.c;p<=q[0].e.c;++p)h=e.dense?(s[x]||[])[p]:s[br({c:p,r:x})],h&&(h.l=q[1]);break;case 2048:for(x=q[0].s.r;x<=q[0].e.r;++x)for(p=q[0].s.c;p<=q[0].e.c;++p)h=e.dense?(s[x]||[])[p]:s[br({c:p,r:x})],h&&h.l&&(h.l.Tooltip=q[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=e.dense?(s[q[0].r]||[])[q[0].c]:s[br(q[0])];var be=me[q[2]];h||(e.dense?(s[q[0].r]||(s[q[0].r]=[]),h=s[q[0].r][q[0].c]={t:"z"}):h=s[br(q[0])]={t:"z"},o.e.r=Math.max(o.e.r,q[0].r),o.s.r=Math.min(o.s.r,q[0].r),o.e.c=Math.max(o.e.c,q[0].c),o.s.c=Math.min(o.s.c,q[0].c)),h.c||(h.c=[]),m={a:q[1],t:be.TxO.t},h.c.push(m)}break;case 2173:ofe(j[q.ixfe],q.ext);break;case 125:{if(!T.cellStyles)break;for(;q.e>=q.s;)ae[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},de||(de=!0,_I(q.w/256)),id(ae[q.e+1])}break;case 520:{var le={};q.level!=null&&(fe[q.r]=le,le.level=q.level),q.hidden&&(fe[q.r]=le,le.hidden=!0),q.hpt&&(fe[q.r]=le,le.hpt=q.hpt,le.hpx=K0(q.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||fh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[O]]=q;break;case 161:s["!margins"]||fh(s["!margins"]={}),s["!margins"].header=q.header,s["!margins"].footer=q.footer;break;case 574:q.RTL&&(E.Views[0].RTL=!0);break;case 146:R=q;break;case 2198:L=q;break;case 140:F=q;break;case 442:A?S.CodeName=q||S.name:E.WBProps.CodeName=q||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+O.toString(16)),t.l+=te}return r.SheetNames=ks(a).sort(function(je,X){return Number(je)-Number(X)}).map(function(je){return a[je].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&Q.forEach(function(je,X){r.Sheets[r.SheetNames[X]]["!autofilter"]=je}),r.Strings=c,r.SSF=es(yr),T.enc&&(r.Encryption=T.enc),L&&(r.Themes=L),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),Z.names.length>0&&(E.Names=Z.names),r.Workbook=E,r}var ig={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yxe(t,e,r){var n=pr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=DP(n,BE,ig.DSI);for(var a in s)e[a]=s[a]}catch(A){if(r.WTF)throw A}var o=pr.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=DP(o,SE,ig.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(A){if(r.WTF)throw A}e.HeadingPairs&&e.TitlesOfParts&&($8(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function bxe(t,e){var r=[],n=[],s=[],a=0,o,l=dP(BE,"n"),c=dP(SE,"n");if(t.Props)for(o=ks(t.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],t.Props[o[a]]]);if(t.Custprops)for(o=ks(t.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],t.Custprops[o[a]]]);var A=[];for(a=0;a<s.length;++a)eQ.indexOf(s[a][0])>-1||G8.indexOf(s[a][0])>-1||s[a][1]!=null&&A.push(s[a]);n.length&&pr.utils.cfb_add(e,"/SummaryInformation",LP(n,ig.SI,c,SE)),(r.length||A.length)&&pr.utils.cfb_add(e,"/DocumentSummaryInformation",LP(r,ig.DSI,l,BE,A.length?A:null,ig.UDI))}function WQ(t,e){e||(e={}),PI(e),tI(),e.codepage&&eI(e.codepage);var r,n;if(t.FullPaths){if(pr.find(t,"/encryption"))throw new Error("File is password-protected");r=pr.find(t,"!CompObj"),n=pr.find(t,"/Workbook")||pr.find(t,"/Book")}else{switch(e.type){case"base64":t=yo(Fo(t));break;case"binary":t=yo(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Va(t,0),n={content:t}}var s,a;if(r&&gxe(r),e.bookProps&&!e.bookSheets)s={};else{var o=Qr?"buffer":"array";if(n&&n.content)s=wxe(n.content,e);else if((a=pr.find(t,"PerfectOffice_MAIN"))&&a.content)s=hh.to_workbook(a.content,(e.type=o,e));else if((a=pr.find(t,"NativeContent_MAIN"))&&a.content)s=hh.to_workbook(a.content,(e.type=o,e));else throw(a=pr.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&pr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Rfe(t))}var l={};return t.FullPaths&&yxe(t,l,e),s.Props=s.Custprops=l,e.bookFiles&&(s.cfb=t),s}function Nxe(t,e){var r=e||{},n=pr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return pr.utils.cfb_add(n,s,JQ(t,r)),r.biff==8&&(t.Props||t.Custprops)&&bxe(t,n),r.biff==8&&t.vbaraw&&Dfe(n,pr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var ix={0:{f:$me},1:{f:tpe},2:{f:wpe},3:{f:cpe},4:{f:ape},5:{f:gpe},6:{f:_pe},7:{f:hpe},8:{f:Tpe},9:{f:kpe},10:{f:Ipe},11:{f:Fpe},12:{f:npe},13:{f:bpe},14:{f:upe},15:{f:ope},16:{f:QQ},17:{f:Bpe},18:{f:mpe},19:{f:mI},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Bge},40:{},42:{},43:{f:_he},44:{f:Nhe},45:{f:She},46:{f:Fhe},47:{f:Ihe},48:{},49:{f:Jce},50:{},51:{f:Afe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uQ},62:{f:Cpe},63:{f:vfe},64:{f:zpe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Kpe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Zme},148:{f:Jme,p:16},151:{f:Upe},152:{},153:{f:Cge},154:{},155:{},156:{f:bge},157:{},158:{},159:{T:1,f:Mde},160:{T:-1},161:{T:1,f:ef},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:jpe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lfe},336:{T:-1},337:{f:hfe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:EE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:AQ},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ope},427:{f:Mpe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Vpe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Yme},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Dpe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:EE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Ffe},633:{T:1},634:{T:-1},635:{T:1,f:Sfe},636:{T:-1},637:{f:eAe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Wpe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},PE={6:{f:nC},10:{f:ou},12:{f:Ws},13:{f:Ws},14:{f:Ls},15:{f:Ls},16:{f:hi},17:{f:Ls},18:{f:Ls},19:{f:Ws},20:{f:HP},21:{f:HP},23:{f:AQ},24:{f:qP},25:{f:Ls},26:{},27:{},28:{f:Wue},29:{},34:{f:Ls},35:{f:KP},38:{f:hi},39:{f:hi},40:{f:hi},41:{f:hi},42:{f:Ls},43:{f:Ls},47:{f:ohe},49:{f:bue},51:{f:Ws},60:{},61:{f:gue},64:{f:Ls},65:{f:yue},66:{f:Ws},77:{},80:{},81:{},82:{},85:{f:Ws},89:{},90:{},91:{},92:{f:iue},93:{f:Yue},94:{},95:{f:Ls},96:{},97:{},99:{f:Ls},125:{f:uQ},128:{f:Lue},129:{f:lue},130:{f:Ws},131:{f:Ls},132:{f:Ls},133:{f:cue},134:{},140:{f:ide},141:{f:Ws},144:{},146:{f:cde},151:{},152:{},153:{},154:{},155:{},156:{f:Ws},157:{},158:{},160:{f:pde},161:{f:dde},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:jue},190:{f:Pue},193:{f:ou},197:{},198:{},199:{},200:{},201:{},202:{f:Ls},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ws},220:{},221:{f:Ls},222:{},224:{f:Due},225:{f:aue},226:{f:ou},227:{},229:{f:Jue},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:uue},253:{f:Cue},255:{f:hue},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:tQ},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ls},353:{f:ou},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Vue},431:{f:Ls},432:{},433:{},434:{},437:{},438:{f:tde},439:{f:Ls},440:{f:rde},441:{},442:{f:Ox},443:{},444:{f:Ws},445:{},446:{},448:{f:ou},449:{f:pue,r:2},450:{f:ou},512:{f:MP},513:{f:mde},515:{f:Mue},516:{f:Eue},517:{f:VP},519:{f:gde},520:{f:fue},523:{},545:{f:GP},549:{f:OP},566:{},574:{f:vue},638:{f:Tue},659:{},1048:{},1054:{f:Sue},1084:{},1212:{f:Gue},2048:{f:sde},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ev},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ou},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Ade,r:12},2173:{f:ife,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ls,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:que,r:12},2197:{},2198:{f:efe,r:12},2199:{},2200:{},2201:{},2202:{f:$ue,r:12},2203:{f:ou},2204:{},2205:{},2206:{},2207:{},2211:{f:mue},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ws},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:hde},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:lde},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:MP},1:{},2:{f:bde},3:{f:wde},4:{f:vde},5:{f:VP},7:{f:Cde},8:{},9:{f:Ev},11:{},22:{f:Ws},30:{f:Fue},31:{},32:{},33:{f:GP},36:{},37:{f:OP},50:{f:_de},62:{},52:{},67:{},68:{f:Ws},69:{},86:{},126:{},127:{f:xde},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ede},223:{},234:{},354:{},421:{},518:{f:nC},521:{f:Ev},536:{f:qP},547:{f:KP},561:{},579:{},1030:{f:nC},1033:{f:Ev},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function zt(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&dI(r)&&t.push(r)}}function Cxe(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return zt(t,e,r,s);var a=e;if(!isNaN(a)){for(var o=r.parts||[],l=0,c=0,A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;var u=t.next(4);for(u.write_shift(2,a),u.write_shift(2,A),t.push(r.slice(c,c+A)),c+=A;c<s;){for(u=t.next(4),u.write_shift(2,60),A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;u.write_shift(2,A),t.push(r.slice(c,c+A)),c+=A}}}function Hx(t,e,r){return t||(t=Ct(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function _xe(t,e,r,n){var s=Ct(9);return Hx(s,t,e),rQ(r,n||"b",s),s}function Exe(t,e,r){var n=Ct(8+2*r.length);return Hx(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Bxe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?da(Zn(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?zt(t,2,Nde(r,n,s)):zt(t,3,yde(r,n,s));return;case"b":case"e":zt(t,5,_xe(r,n,e.v,e.t));return;case"s":case"str":zt(t,4,Exe(r,n,(e.v||"").slice(0,255)));return}zt(t,1,Hx(null,r,n))}function Sxe(t,e,r,n){var s=Array.isArray(e),a=un(e["!ref"]||"A1"),o,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Pr(a)}for(var A=a.s.r;A<=a.e.r;++A){l=Hs(A);for(var u=a.s.c;u<=a.e.c;++u){A===a.s.r&&(c[u]=xs(u)),o=c[u]+l;var d=s?(e[A]||[])[u]:e[o];d&&Bxe(t,d,A,u)}}}function Ixe(t,e){for(var r=e||{},n=Xi(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return zt(n,r.biff==4?1033:r.biff==3?521:9,bI(t,16,r)),Sxe(n,t.Sheets[t.SheetNames[s]],s,r),zt(n,10),n.end()}function Fxe(t,e,r){zt(t,49,Nue({sz:12,name:"Arial"},r))}function kxe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&zt(t,1054,Iue(s,e[s],r))})}function Txe(t,e){var r=Ct(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),zt(t,2151,r),r=Ct(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),oQ(un(e["!ref"]||"A1"),r),r.write_shift(4,4),zt(t,2152,r)}function jxe(t,e){for(var r=0;r<16;++r)zt(t,224,QP({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){zt(t,224,QP(n,0,e))})}function Pxe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];zt(t,440,nde(n)),n[1].Tooltip&&zt(t,2048,ade(n))}delete e["!links"]}function Rxe(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&zt(t,125,ude(eb(s,n),s))})}}function Dxe(t,e,r,n,s){var a=16+vd(s.cellXfs,e,s);if(e.v==null&&!e.bf){zt(t,513,Dh(r,n,a));return}if(e.bf)zt(t,6,lme(e,r,n,s,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?da(Zn(e.v)):e.v;zt(t,515,Que(r,n,o,a));break;case"b":case"e":zt(t,517,Oue(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var l=FI(s.Strings,e.v,s.revStrings);zt(t,253,_ue(r,n,l,a))}else zt(t,516,Bue(r,n,(e.v||"").slice(0,255),a,s));break;default:zt(t,513,Dh(r,n,a))}}function Lxe(t,e,r){var n=Xi(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(a),A=e.biff==8,u,d="",f=[],h=un(a["!ref"]||"A1"),m=A?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}zt(n,2057,bI(r,16,e)),zt(n,13,Zo(1)),zt(n,12,Zo(100)),zt(n,15,Si(!0)),zt(n,17,Si(!1)),zt(n,16,Ph(.001)),zt(n,95,Si(!0)),zt(n,42,Si(!1)),zt(n,43,Si(!1)),zt(n,130,Zo(1)),zt(n,128,Uue()),zt(n,131,Si(!1)),zt(n,132,Si(!1)),A&&Rxe(n,a["!cols"]),zt(n,512,kue(h,e)),A&&(a["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){d=Hs(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(f[x]=xs(x)),u=f[x]+d;var g=c?(a[p]||[])[x]:a[u];g&&(Dxe(n,g,p,x,e),A&&g.l&&a["!links"].push([u,g.l]))}}var y=l.CodeName||l.name||s;return A&&zt(n,574,wue((o.Views||[])[0])),A&&(a["!merges"]||[]).length&&zt(n,229,Xue(a["!merges"])),A&&Pxe(n,a),zt(n,442,nQ(y)),A&&Txe(n,a),zt(n,10),n.end()}function Uxe(t,e,r){var n=Xi(),s=(t||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(zt(n,2057,bI(t,5,r)),r.bookType=="xla"&&zt(n,135),zt(n,225,l?Zo(1200):null),zt(n,193,OAe(2)),c&&zt(n,191),c&&zt(n,192),zt(n,226),zt(n,92,oue("SheetJS",r)),zt(n,66,Zo(l?1200:1252)),l&&zt(n,353,Zo(0)),l&&zt(n,448),zt(n,317,fde(t.SheetNames.length)),l&&t.vbaraw&&zt(n,211),l&&t.vbaraw){var A=o.CodeName||"ThisWorkbook";zt(n,442,nQ(A))}zt(n,156,Zo(17)),zt(n,25,Si(!1)),zt(n,18,Si(!1)),zt(n,19,Zo(0)),l&&zt(n,431,Si(!1)),l&&zt(n,444,Zo(0)),zt(n,61,xue()),zt(n,64,Si(!1)),zt(n,141,Zo(0)),zt(n,34,Si(pge(t)=="true")),zt(n,14,Si(!0)),l&&zt(n,439,Si(!1)),zt(n,218,Zo(0)),Fxe(n,t,r),kxe(n,t.SSF,r),jxe(n,r),l&&zt(n,352,Si(!1));var u=n.end(),d=Xi();l&&zt(d,140,ode()),l&&r.Strings&&Cxe(d,252,due(r.Strings)),zt(d,10);var f=d.end(),h=Xi(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=u.length+m+f.length;for(p=0;p<t.SheetNames.length;++p){var g=a[p]||{};zt(h,133,Aue({pos:x,hs:g.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return u.length&&b.push(u),y.length&&b.push(y),f.length&&b.push(f),ba(b)}function Oxe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=es(yr)),t&&t.SSF&&(cm(),$y(t.SSF),r.revssf=Wy(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,RI(r),r.cellXfs=[],vd(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=Lxe(s,r,t);return n.unshift(Uxe(t,n,r)),ba(n)}function JQ(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Yi(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return Oxe(t,e);case 4:case 3:case 2:return Ixe(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function r3(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),o=s.index,l=a&&a.index||t.length,c=Nce(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,u=0,d=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++A,r.sheetRows&&r.sheetRows<=A){--A;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var g=p.split(/<\/t[dh]>/i);for(l=0;l<g.length;++l){var y=g[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,F=0;b.charAt(0)=="<"&&(F=b.indexOf(">"))>-1;)b=b.slice(F+1);for(var j=0;j<m.length;++j){var R=m[j];R.s.c==u&&R.s.r<A&&A<=R.e.r&&(u=R.e.c+1,j=-1)}var E=Cr(y.slice(0,y.indexOf(">")));f=E.colspan?+E.colspan:1,((d=+E.rowspan)>1||f>1)&&m.push({s:{r:A,c:u},e:{r:A+(d||1)-1,c:u+f-1}});var S=E.t||E["data-t"]||"";if(!b.length){u+=f;continue}if(b=w8(b),h.s.r>A&&(h.s.r=A),h.e.r<A&&(h.e.r=A),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!b.length){u+=f;continue}var B={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?B={t:"b",v:!0}:b==="FALSE"?B={t:"b",v:!1}:isNaN(Ll(b))?isNaN(V0(b).getDate())||(B={t:"d",v:Zn(b)},r.cellDates||(B={t:"n",v:da(B.v)}),B.z=r.dateNF||yr[14]):B={t:"n",v:Ll(b)}),r.dense?(n[A]||(n[A]=[]),n[A][u]=B):n[br({r:A,c:u})]=B,u+=f}}}}return n["!ref"]=Pr(h),m.length&&(n["!merges"]=m),n}function Mxe(t,e,r,n){for(var s=t["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,A=0;A<s.length;++A)if(!(s[A].s.r>r||s[A].s.c>o)&&!(s[A].e.r<r||s[A].e.c<o)){if(s[A].s.r<r||s[A].s.c<o){l=-1;break}l=s[A].e.r-s[A].s.r+1,c=s[A].e.c-s[A].s.c+1;break}if(!(l<0)){var u=br({r,c:o}),d=n.dense?(t[r]||[])[o]:t[u],f=d&&d.v!=null&&(d.h||cI(d.w||(SA(d),d.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),h.id=(n.id||"sjs")+"-"+u,a.push($t("td",f,h))}}var m="<tr>";return m+a.join("")+"</tr>"}var Qxe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Vxe="</body></html>";function Hxe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return xd(r3(r[0],e),e);var n=UI();return r.forEach(function(s,a){OI(n,r3(s,e),"Sheet"+(a+1))}),n}function Kxe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function XQ(t,e){var r=e||{},n=r.header!=null?r.header:Qxe,s=r.footer!=null?r.footer:Vxe,a=[n],o=Yi(t["!ref"]);r.dense=Array.isArray(t),a.push(Kxe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(Mxe(t,o,l,r));return a.push("</table>"+s),a.join("")}function YQ(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?vs(n.origin):n.origin;s=o.r,a=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),A={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var u=Yi(t["!ref"]);A.s.r=Math.min(A.s.r,u.s.r),A.s.c=Math.min(A.s.c,u.s.c),A.e.r=Math.max(A.e.r,u.e.r),A.e.c=Math.max(A.e.c,u.e.c),s==-1&&(A.e.r=s=u.e.r+1)}var d=[],f=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,g=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var F=l[m];if(n3(F)){if(n.display)continue;h[p]={hidden:!0}}var j=F.children;for(x=g=0;x<j.length;++x){var R=j[x];if(!(n.display&&n3(R))){var E=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):w8(R.innerHTML),S=R.getAttribute("data-z")||R.getAttribute("z");for(f=0;f<d.length;++f){var B=d[f];B.s.c==g+a&&B.s.r<p+s&&p+s<=B.e.r&&(g=B.e.c+1-a,f=-1)}b=+R.getAttribute("colspan")||1,((y=+R.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:p+s,c:g+a},e:{r:p+s+(y||1)-1,c:g+a+(b||1)-1}});var U={t:"s",v:E},k=R.getAttribute("data-t")||R.getAttribute("t")||"";E!=null&&(E.length==0?U.t=k||"z":n.raw||E.trim().length==0||k=="s"||(E==="TRUE"?U={t:"b",v:!0}:E==="FALSE"?U={t:"b",v:!1}:isNaN(Ll(E))?isNaN(V0(E).getDate())||(U={t:"d",v:Zn(E)},n.cellDates||(U={t:"n",v:da(U.v)}),U.z=n.dateNF||yr[14]):U={t:"n",v:Ll(E)})),U.z===void 0&&S!=null&&(U.z=S);var T="",L=R.getElementsByTagName("A");if(L&&L.length)for(var Y=0;Y<L.length&&!(L[Y].hasAttribute("href")&&(T=L[Y].getAttribute("href"),T.charAt(0)!="#"));++Y);T&&T.charAt(0)!="#"&&(U.l={Target:T}),n.dense?(t[p+s]||(t[p+s]=[]),t[p+s][g+a]=U):t[br({c:g+a,r:p+s})]=U,A.e.c<g+a&&(A.e.c=g+a),g+=b}}++p}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),A.e.r=Math.max(A.e.r,p-1+s),t["!ref"]=Pr(A),p>=c&&(t["!fullref"]=Pr((A.e.r=l.length-m+p-1+s,A))),t}function ZQ(t,e){var r=e||{},n=r.dense?[]:{};return YQ(n,t,e)}function qxe(t,e){return xd(ZQ(t,e),e)}function n3(t){var e="",r=Gxe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Gxe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $xe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=An(e.replace(/<[^>]*>/g,""));return[r]}var s3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function e7(t,e){var r=e||{},n=AI(t),s=[],a,o,l={name:""},c="",A=0,u,d,f={},h=[],m=r.dense?[]:{},p,x,g={value:""},y="",b=0,F=[],j=-1,R=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,B={},U=[],k={},T=0,L=0,Y=[],me=1,ae=1,fe=[],de={Names:[]},Z={},xe=["",""],Be=[],I={},C="",Q=0,M=!1,D=!1,z=0;for(ex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=ex.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?m["!ref"]=Pr(E):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=Pr(E)),U.length&&(m["!merges"]=U),Y.length&&(m["!rows"]=Y),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=m,D=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Cr(p[0],!1),j=R=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,m=r.dense?[]:{},U=[],Y=[],D=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){j+=me,me=1;break}if(d=Cr(p[0],!1),d.?j=d.-1:j==-1&&(j=0),me=+d["number-rows-repeated"]||1,me<10)for(z=0;z<me;++z)S>0&&(Y[j+z]={level:S});R=-1;break;case"covered-table-cell":p[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(m[j]||(m[j]=[]),m[j][R]={t:"z"}):m[br({r:j,c:R})]={t:"z"}),y="",F=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++R,g=Cr(p[0],!1),ae=parseInt(g["number-columns-repeated"]||"1",10),x={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(x.f=ZP(An(g.formula))),(g.||g["value-type"])=="string"&&(x.t="s",x.v=An(g["string-value"]||""),r.dense?(m[j]||(m[j]=[]),m[j][R]=x):m[br({r:j,c:R})]=x),R+=ae-1;else if(p[1]!=="/"){++R,y="",b=0,F=[],ae=1;var O=me?j+me-1:j;if(R>E.e.c&&(E.e.c=R),R<E.s.c&&(E.s.c=R),j<E.s.r&&(E.s.r=j),O>E.e.r&&(E.e.r=O),g=Cr(p[0],!1),Be=[],I={},x={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=An(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(T=parseInt(g["number-matrix-rows-spanned"],10)||0,L=parseInt(g["number-matrix-columns-spanned"],10)||0,k={s:{r:j,c:R},e:{r:j+T-1,c:R+L-1}},x.F=Pr(k),fe.push([k,x.F])),g.formula)x.f=ZP(g.formula);else for(z=0;z<fe.length;++z)j>=fe[z][0].s.r&&j<=fe[z][0].e.r&&R>=fe[z][0].s.c&&R<=fe[z][0].e.c&&(x.F=fe[z][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(T=parseInt(g["number-rows-spanned"],10)||0,L=parseInt(g["number-columns-spanned"],10)||0,k={s:{r:j,c:R},e:{r:j+T-1,c:R+L-1}},U.push(k)),g["number-columns-repeated"]&&(ae=parseInt(g["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Jn(g["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(g.value);break;case"percentage":x.t="n",x.v=parseFloat(g.value);break;case"currency":x.t="n",x.v=parseFloat(g.value);break;case"date":x.t="d",x.v=Zn(g["date-value"]),r.cellDates||(x.t="n",x.v=da(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=wce(g["time-value"])/86400,r.cellDates&&(x.t="d",x.v=Jy(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(g.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",g["string-value"]!=null&&(y=An(g["string-value"]),F=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(M=!1,x.t==="s"&&(x.v=y||"",F.length&&(x.R=F),M=b==0),Z.Target&&(x.l=Z),Be.length>0&&(x.c=Be,Be=[]),y&&r.cellText!==!1&&(x.w=y),M&&(x.t="z",delete x.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var te=0;te<me;++te){if(ae=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(m[j+te]||(m[j+te]=[]),m[j+te][R]=te==0?x:es(x);--ae>0;)m[j+te][R+ae]=es(x);else for(m[br({r:j+te,c:R})]=x;--ae>0;)m[br({r:j+te,c:R+ae})]=es(x);E.e.c<=R&&(E.e.c=R)}ae=parseInt(g["number-columns-repeated"]||"1",10),R+=ae-1,ae=0,x={},y="",F=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a;I.t=y,F.length&&(I.R=F),I.a=C,Be.push(I)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);C="",Q=0,y="",b=0,F=[];break;case"creator":p[1]==="/"?C=n.slice(Q,p.index):Q=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);y="",b=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(B[l.name]=c,(a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Cr(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Cr(p[0],!1),c+=s3[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Cr(p[0],!1),c+=s3[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(A,p.index);break}else A=p.index+p[0].length;break;case"named-range":o=Cr(p[0],!1),xe=sC(o["cell-range-address"]);var se={Name:o.name,Ref:xe[0]+"!"+xe[1]};D&&(se.Sheet=h.length),de.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!g||!g["string-value"])){var we=$xe(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+we[0]}else Cr(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{xe=sC(Cr(p[0])["target-range-address"]),f[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Z=Cr(p[0],!1),!Z.href)break;Z.Target=An(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(xe=sC(Z.Target.slice(1)),Z.Target="#"+xe[0]+"!"+xe[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var q={Sheets:f,SheetNames:h,Workbook:de};return r.bookSheets&&delete q.Sheets,q}function a3(t,e){e=e||{},Yo(t,"META-INF/manifest.xml")&&wAe(zs(t,"META-INF/manifest.xml"),e);var r=bo(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=e7(jn(r),e);return Yo(t,"meta.xml")&&(n.Props=K8(zs(t,"meta.xml"))),n}function i3(t,e){return e7(t,e)}var zxe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Zg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return qs+e}}(),o3=function(){var t=function(a){return In(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,l){var c=[];c.push('      <table:table table:name="'+In(o.SheetNames[l])+`" table:style-name="ta1">
`);var A=0,u=0,d=Yi(a["!ref"]||"A1"),f=a["!merges"]||[],h=0,m=Array.isArray(a);if(a["!cols"])for(u=0;u<=d.e.c;++u)c.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=a["!rows"]||[];for(A=0;A<d.s.r;++A)p=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;A<=d.e.r;++A){for(p=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<d.s.c;++u)c.push(e);for(;u<=d.e.c;++u){var g=!1,y={},b="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>u)&&!(f[h].s.r>A)&&!(f[h].e.c<u)&&!(f[h].e.r<A)){(f[h].s.c!=u||f[h].s.r!=A)&&(g=!0),y["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,y["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(g){c.push(r);continue}var F=br({r:A,c:u}),j=m?(a[A]||[])[u]:a[F];if(j&&j.f&&(y["table:formula"]=In(fme(j.f)),j.F&&j.F.slice(0,F.length)==F)){var R=Yi(j.F);y["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,y["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!j){c.push(e);continue}switch(j.t){case"b":b=j.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=j.v?"true":"false";break;case"n":b=j.w||String(j.v||0),y["office:value-type"]="float",y["office:value"]=j.v||0;break;case"s":case"str":b=j.v==null?"":j.v,y["office:value-type"]="string";break;case"d":b=j.w||Zn(j.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Zn(j.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var E=t(b);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+mme(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),E=$t("text:a",E,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+$t("table:table-cell",$t("text:p",E,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!cols"]){for(var u=0;u<A["!cols"].length;++u)if(A["!cols"][u]){var d=A["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;id(d),d.ods=l;var f=A["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!rows"]){for(var u=0;u<A["!rows"].length;++u)if(A["!rows"][u]){A["!rows"][u].ods=c;var d=A["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var c=[qs],A=Zg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Zg({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+A+u+`>
`),c.push(H8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+A+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=o.SheetNames.length;++d)c.push(n(o.Sheets[o.SheetNames[d]],o,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function t7(t,e){if(e.bookType=="fods")return o3(t,e);var r=iI(),n="",s=[],a=[];return n="mimetype",Or(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Or(r,n,o3(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Or(r,n,zxe(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Or(r,n,qs+H8()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Or(r,n,NAe(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Or(r,n,yAe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Lh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function RE(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):jn(gd(t))}function Wxe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):yo(xc(t))}function Jxe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ld(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function l3(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Xxe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Yxe(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function ox(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Cn(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Is(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function hn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=ox(t,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ox(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var A={data:l,type:a};e[s]==null?e[s]=[A]:e[s].push(A)}return e}function Ra(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(Cn(n*8+s.type)),s.type==2&&e.push(Cn(s.data.length)),e.push(s.data))})}),ld(e)}function jI(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Wo(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=ox(t,n),a=hn(t.slice(n[0],n[0]+s));n[0]+=s;var o={id:Is(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=hn(l.data),A=Is(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+A)}),n[0]+=A}),(e=a[3])!=null&&e[0]&&(o.merge=Is(a[3][0].data)>>>0>0),r.push(o)}return r}function Pf(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Cn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Cn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Cn(o.data.length)}],n[2].push({data:Ra(o.meta),type:2})});var a=Ra(n);e.push(Cn(a.length)),e.push(a),s.forEach(function(o){return e.push(o)})}),ld(e)}function Zxe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ox(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,A=0;if(a==1?(A=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(A=(e[r[0]++]>>2)+1,a==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ld(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(A>=c)for(s.push(s[0].slice(-c)),A-=c;A>=s[s.length-1].length;)s.push(s[s.length-1]),A-=s[s.length-1].length;s.push(s[0].slice(-c,-c+A))}}var u=ld(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Jo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Zxe(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ld(e)}function Rf(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=Cn(n),o=a.length;e.push(a),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return ld(e)}function e1e(t,e,r,n){var s=Lh(t),a=s.getUint32(4,!0),o=(n>1?12:8)+l3(a&(n>1?3470:398))*4,l=-1,c=-1,A=NaN,u=new Date(2001,0,1);a&512&&(l=s.getUint32(o,!0),o+=4),o+=l3(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(o,!0),o+=4),a&32&&(A=s.getFloat64(o,!0),o+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:A};break;case 3:d={t:"s",v:e[c]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:A>0};break;case 7:d={t:"n",v:A/86400};break;case 8:d={t:"e",v:0};break;case 9:if(l>-1)d={t:"s",v:r[l]};else if(c>-1)d={t:"s",v:e[c]};else if(!isNaN(A))d={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function t1e(t,e,r){var n=Lh(t),s=n.getUint32(8,!0),a=12,o=-1,l=-1,c=NaN,A=NaN,u=new Date(2001,0,1);s&1&&(c=Xxe(t,a),a+=16),s&2&&(A=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(o=n.getUint32(a,!0),a+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:A>0};break;case 7:d={t:"n",v:A/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return d}function iC(t,e){var r=new Uint8Array(32),n=Lh(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,Yxe(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function oC(t,e){var r=new Uint8Array(32),n=Lh(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function r1e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return e1e(t,e,r,t[0]);case 5:return t1e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function oi(t){var e=hn(t);return ox(e[1][0].data)}function c3(t,e){var r=hn(e.data),n=Is(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(o){var l=hn(o.data),c=Is(l[1][0].data)>>>0;switch(n){case 1:a[c]=RE(l[3][0].data);break;case 8:{var A=t[oi(l[9][0].data)][0],u=hn(A.data),d=t[oi(u[1][0].data)][0],f=Is(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=hn(d.data);a[c]=h[3].map(function(m){return RE(m.data)}).join("")}break}}),a}function n1e(t,e){var r,n,s,a,o,l,c,A,u,d,f,h,m,p,x=hn(t),g=Is(x[1][0].data)>>>0,y=Is(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Is(x[8][0].data)>0||!1,F,j;if((a=(s=x[7])==null?void 0:s[0])!=null&&a.data&&e!=0)F=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,j=(A=(c=x[6])==null?void 0:c[0])==null?void 0:A.data;else if((d=(u=x[4])==null?void 0:u[0])!=null&&d.data&&e!=1)F=(h=(f=x[4])==null?void 0:f[0])==null?void 0:h.data,j=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var R=b?4:1,E=Lh(F),S=[],B=0;B<F.length/2;++B){var U=E.getUint16(B*2,!0);U<65535&&S.push([B,U])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var k=[];for(B=0;B<S.length-1;++B)k[S[B][0]]=j.subarray(S[B][1]*R,S[B+1][1]*R);return S.length>=1&&(k[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*R)),{R:g,cells:k}}function s1e(t,e){var r,n=hn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Is(n[7][0].data)>>>0>0?1:0:-1,a=jI(n[5],function(o){return n1e(o,s)});return{nrows:Is(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,A){if(o[l.R][A])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(A));o[l.R][A]=c}),o},[])}}function a1e(t,e,r){var n,s=hn(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Is(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Is(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Pr(a);var o=hn(s[4][0].data),l=c3(t,t[oi(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?c3(t,t[oi(o[17][0].data)][0]):[],A=hn(o[3][0].data),u=0;A[1].forEach(function(d){var f=hn(d.data),h=t[oi(f[2][0].data)][0],m=Is(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=s1e(t,h);p.data.forEach(function(x,g){x.forEach(function(y,b){var F=br({r:u+g,c:b}),j=r1e(y,l,c);j&&(r[F]=j)})}),u+=p.nrows})}function i1e(t,e){var r=hn(e.data),n={"!ref":"A1"},s=t[oi(r[2][0].data)],a=Is(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return a1e(t,s[0],n),n}function o1e(t,e){var r,n=hn(e.data),s={name:(r=n[1])!=null&&r[0]?RE(n[1][0].data):"",sheets:[]},a=jI(n[2],oi);return a.forEach(function(o){t[o].forEach(function(l){var c=Is(l.meta[1][0].data);c==6e3&&s.sheets.push(i1e(t,l))})}),s}function l1e(t,e){var r=UI(),n=hn(e.data),s=jI(n[1],oi);if(s.forEach(function(a){t[a].forEach(function(o){var l=Is(o.meta[1][0].data);if(l==2){var c=o1e(t,o);c.sheets.forEach(function(A,u){OI(r,A,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function lC(t){var e,r,n,s,a={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var A;try{A=Jo(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var u;try{u=Wo(A)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){a[d.id]=d.messages,o.push(d.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Is(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(c){a[c].forEach(function(A){var u=Is(A.meta[1][0].data)>>>0;if(u==1)if(!l)l=A;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return l1e(a,l)}function c1e(t,e,r){var n,s,a,o;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=t[8])==null?void 0:a[0])==null?void 0:o.data)&&Is(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,A=Lh(t[7][0].data),u=0,d=[],f=Lh(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){A.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}A.setUint16(p*2,u,!0),f.setUint16(p*2,h,!0);var x,g;switch(typeof e[p]){case"string":x=iC({t:"s",v:e[p]},r),g=oC({t:"s",v:e[p]},r);break;case"number":x=iC({t:"n",v:e[p]},r),g=oC({t:"n",v:e[p]},r);break;case"boolean":x=iC({t:"b",v:e[p]},r),g=oC({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}d.push(x),u+=x.length,m.push(g),h+=g.length,++c}for(t[2][0].data=Cn(c);p<t[7][0].data.length/2;++p)A.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return t[6][0].data=ld(d),t[3][0].data=ld(m),c}function A1e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Yi(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Pr(n)));var a=D2(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(C){return C.forEach(function(Q){typeof Q=="string"&&o.push(Q)})});var l={},c=[],A=pr.read(e.numbers,{type:"base64"});A.FileIndex.map(function(C,Q){return[C,A.FullPaths[Q]]}).forEach(function(C){var Q=C[0],M=C[1];if(Q.type==2&&Q.name.match(/\.iwa/)){var D=Q.content,z=Jo(D),O=Wo(z);O.forEach(function(te){c.push(te.id),l[te.id]={deps:[],location:M,type:Is(te.messages[0].meta[1][0].data)}})}}),c.sort(function(C,Q){return C-Q});var u=c.filter(function(C){return C>1}).map(function(C){return[C,Cn(C)]});A.FileIndex.map(function(C,Q){return[C,A.FullPaths[Q]]}).forEach(function(C){var Q=C[0];if(C[1],!!Q.name.match(/\.iwa/)){var M=Wo(Jo(Q.content));M.forEach(function(D){D.messages.forEach(function(z){u.forEach(function(O){D.messages.some(function(te){return Is(te.meta[1][0].data)!=11006&&Jxe(te.data,O[1])})&&l[O[0]].deps.push(D.id)})})})}});for(var d=pr.find(A,l[1].location),f=Wo(Jo(d.content)),h,m=0;m<f.length;++m){var p=f[m];p.id==1&&(h=p)}var x=oi(hn(h.messages[0].data)[1][0].data);for(d=pr.find(A,l[x].location),f=Wo(Jo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);for(x=oi(hn(h.messages[0].data)[2][0].data),d=pr.find(A,l[x].location),f=Wo(Jo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);for(x=oi(hn(h.messages[0].data)[2][0].data),d=pr.find(A,l[x].location),f=Wo(Jo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);var g=hn(h.messages[0].data);{g[6][0].data=Cn(n.e.r+1),g[7][0].data=Cn(n.e.c+1);var y=oi(g[46][0].data),b=pr.find(A,l[y].location),F=Wo(Jo(b.content));{for(var j=0;j<F.length&&F[j].id!=y;++j);if(F[j].id!=y)throw"Bad ColumnRowUIDMapArchive";var R=hn(F[j].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var E=0;E<=n.e.c;++E){var S=[];S[1]=S[2]=[{type:0,data:Cn(E+420690)}],R[1].push({type:2,data:Ra(S)}),R[2].push({type:0,data:Cn(E)}),R[3].push({type:0,data:Cn(E)})}R[4]=[],R[5]=[],R[6]=[];for(var B=0;B<=n.e.r;++B)S=[],S[1]=S[2]=[{type:0,data:Cn(B+726270)}],R[4].push({type:2,data:Ra(S)}),R[5].push({type:0,data:Cn(B)}),R[6].push({type:0,data:Cn(B)});F[j].messages[0].data=Ra(R)}b.content=Rf(Pf(F)),b.size=b.content.length,delete g[46];var U=hn(g[4][0].data);{U[7][0].data=Cn(n.e.r+1);var k=hn(U[1][0].data),T=oi(k[2][0].data);b=pr.find(A,l[T].location),F=Wo(Jo(b.content));{if(F[0].id!=T)throw"Bad HeaderStorageBucket";var L=hn(F[0].messages[0].data);for(B=0;B<a.length;++B){var Y=hn(L[2][0].data);Y[1][0].data=Cn(B),Y[4][0].data=Cn(a[B].length),L[2][B]={type:L[2][0].type,data:Ra(Y)}}F[0].messages[0].data=Ra(L)}b.content=Rf(Pf(F)),b.size=b.content.length;var me=oi(U[2][0].data);b=pr.find(A,l[me].location),F=Wo(Jo(b.content));{if(F[0].id!=me)throw"Bad HeaderStorageBucket";for(L=hn(F[0].messages[0].data),E=0;E<=n.e.c;++E)Y=hn(L[2][0].data),Y[1][0].data=Cn(E),Y[4][0].data=Cn(n.e.r+1),L[2][E]={type:L[2][0].type,data:Ra(Y)};F[0].messages[0].data=Ra(L)}b.content=Rf(Pf(F)),b.size=b.content.length;var ae=oi(U[4][0].data);(function(){for(var C=pr.find(A,l[ae].location),Q=Wo(Jo(C.content)),M,D=0;D<Q.length;++D){var z=Q[D];z.id==ae&&(M=z)}var O=hn(M.messages[0].data);{O[3]=[];var te=[];o.forEach(function(q,Me){te[1]=[{type:0,data:Cn(Me)}],te[2]=[{type:0,data:Cn(1)}],te[3]=[{type:2,data:Wxe(q)}],O[3].push({type:2,data:Ra(te)})})}M.messages[0].data=Ra(O);var se=Pf(Q),we=Rf(se);C.content=we,C.size=C.content.length})();var fe=hn(U[3][0].data);{var de=fe[1][0];delete fe[2];var Z=hn(de.data);{var xe=oi(Z[2][0].data);(function(){for(var C=pr.find(A,l[xe].location),Q=Wo(Jo(C.content)),M,D=0;D<Q.length;++D){var z=Q[D];z.id==xe&&(M=z)}var O=hn(M.messages[0].data);{delete O[6],delete fe[7];var te=new Uint8Array(O[5][0].data);O[5]=[];for(var se=0,we=0;we<=n.e.r;++we){var q=hn(te);se+=c1e(q,a[we],o),q[1][0].data=Cn(we),O[5].push({data:Ra(q),type:2})}O[1]=[{type:0,data:Cn(n.e.c+1)}],O[2]=[{type:0,data:Cn(n.e.r+1)}],O[3]=[{type:0,data:Cn(se)}],O[4]=[{type:0,data:Cn(n.e.r+1)}]}M.messages[0].data=Ra(O);var Me=Pf(Q),re=Rf(Me);C.content=re,C.size=C.content.length})()}de.data=Ra(Z)}U[3][0].data=Ra(fe)}g[4][0].data=Ra(U)}h.messages[0].data=Ra(g);var Be=Pf(f),I=Rf(Be);return d.content=I,d.size=d.content.length,A}function r7(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function PI(t){r7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function RI(t){r7([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function u1e(t){return Gr.WS.indexOf(t)>-1?"sheet":t==Gr.CS?"chart":t==Gr.DS?"dialog":t==Gr.MS?"macro":t&&t.length?t:"sheet"}function d1e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,u1e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function h1e(t,e,r,n,s,a,o,l,c,A,u,d){try{a[n]=rg(bo(t,r,!0),e);var f=zs(t,e),h;switch(l){case"sheet":h=Rge(f,e,s,c,a[n],A,u,d);break;case"chart":if(h=Dge(f,e,s,c,a[n],A,u,d),!h||!h["!drawel"])break;var m=Cp(h["!drawel"].Target,e),p=tx(m),x=bfe(bo(t,m,!0),rg(bo(t,p,!0),m)),g=Cp(x,m),y=tx(g);h=cge(bo(t,g,!0),g,c,rg(bo(t,y,!0),g),A,h);break;case"macro":h=Lge(f,e,s,c,a[n],A,u,d);break;case"dialog":h=Uge(f,e,s,c,a[n],A,u,d);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];a&&a[n]&&ks(a[n]).forEach(function(F){var j="";if(a[n][F].Type==Gr.CMNT){j=Cp(a[n][F].Target,e);var R=Vge(zs(t,j,!0),j,c);if(!R||!R.length)return;zP(h,R,!1)}a[n][F].Type==Gr.TCMNT&&(j=Cp(a[n][F].Target,e),b=b.concat(Cfe(zs(t,j,!0),c)))}),b&&b.length&&zP(h,b,!0,c.people||[])}catch(F){if(c.WTF)throw F}}function Go(t){return t.charAt(0)=="/"?t.slice(1):t}function f1e(t,e){if(cm(),e=e||{},PI(e),Yo(t,"META-INF/manifest.xml")||Yo(t,"objectdata.xml"))return a3(t,e);if(Yo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof lC<"u"){if(t.FileIndex)return lC(t);var r=pr.utils.cfb_new();return mP(t).forEach(function(Y){Or(r,Y,_ce(t,Y))}),lC(r)}throw new Error("Unsupported NUMBERS file")}if(!Yo(t,"[Content_Types].xml"))throw Yo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Yo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=mP(t),s=xAe(bo(t,"[Content_Types].xml")),a=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",zs(t,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!zs(t,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},A={};if(!e.bookSheets&&!e.bookProps){if(ng=[],s.sst)try{ng=Qge(zs(t,Go(s.sst)),s.sst,e)}catch(Y){if(e.WTF)throw Y}e.cellStyles&&s.themes.length&&(c=Mge(bo(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(A=Oge(zs(t,Go(s.style)),s.style,c,e))}s.links.map(function(Y){try{var me=rg(bo(t,tx(Go(Y))),Y);return Kge(zs(t,Go(Y)),me,Y,e)}catch{}});var u=Pge(zs(t,Go(s.workbooks[0])),s.workbooks[0],e),d={},f="";s.coreprops.length&&(f=zs(t,Go(s.coreprops[0]),!0),f&&(d=K8(f)),s.extprops.length!==0&&(f=zs(t,Go(s.extprops[0]),!0),f&&_Ae(f,d,e)));var h={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(f=bo(t,Go(s.custprops[0]),!0),f&&(h=BAe(f,e)));var m={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(me){return me.name}):d.Worksheets&&d.SheetNames.length>0&&(o=d.SheetNames),e.bookProps&&(m.Props=d,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&s.calcchain&&(p=Hge(zs(t,Go(s.calcchain)),s.calcchain));var x=0,g={},y,b;{var F=u.Sheets;d.Worksheets=F.length,d.SheetNames=[];for(var j=0;j!=F.length;++j)d.SheetNames[j]=F[j].name}var R=a?"bin":"xml",E=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,E+1)+"_rels/"+s.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Yo(t,S)||(S="xl/_rels/workbook."+R+".rels");var B=rg(bo(t,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=qge(zs(t,Go(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Efe(zs(t,Go(s.people[0])),e)),B&&(B=d1e(B,u.Sheets));var U=zs(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=d.Worksheets;++x){var k="sheet";if(B&&B[x]?(y="xl/"+B[x][1].replace(/[\/]?xl\//,""),Yo(t,y)||(y=B[x][1]),Yo(t,y)||(y=S.replace(/_rels\/.*$/,"")+B[x][1]),k=B[x][2]):(y="xl/worksheets/sheet"+(x+1-U)+"."+R,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(d.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,L=0;L!=e.sheets.length;++L)typeof e.sheets[L]=="number"&&e.sheets[L]==x&&(T=1),typeof e.sheets[L]=="string"&&e.sheets[L].toLowerCase()==d.SheetNames[x].toLowerCase()&&(T=1);if(!T)continue e}}h1e(t,y,b,d.SheetNames[x],x,g,o,k,e,u,c,A)}return m={Directory:s,Workbook:u,Props:d,Custprops:h,Deps:p,Sheets:o,SheetNames:d.SheetNames,Strings:ng,Styles:A,Themes:c,SSF:es(yr)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(Y,me){Y=Y.replace(/^Root Entry[\/]/,""),m.keys.push(Y),m.files[Y]=t.FileIndex[me]}))),e&&e.bookVBA&&(s.vba.length>0?m.vbaraw=zs(t,Go(s.vba[0]),!0):s.defaults&&s.defaults.bin===Pfe&&(m.vbaraw=zs(t,"xl/vbaProject.bin",!0))),m}function m1e(t,e){var r=e||{},n="Workbook",s=pr.find(t,n);try{if(n="/!DataSpaces/Version",s=pr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(qde(s.content),n="/!DataSpaces/DataSpaceMap",s=pr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=$de(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=pr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=zde(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=pr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Jde(s.content)}catch{}if(n="/EncryptionInfo",s=pr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=Xde(s.content);if(n="/EncryptedPackage",s=pr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function p1e(t,e){return e.bookType=="ods"?t7(t,e):e.bookType=="numbers"?A1e(t,e):e.bookType=="xlsb"?g1e(t,e):x1e(t,e)}function g1e(t,e){o0=1024,t&&!t.SSF&&(t.SSF=es(yr)),t&&t.SSF&&(cm(),$y(t.SSF),e.revssf=Wy(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,sg?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=IQ.indexOf(e.bookType)>-1,s=wI();RI(e=e||{});var a=iI(),o="",l=0;if(e.cellXfs=[],vd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Or(a,o,q8(t.Props,e)),s.coreprops.push(o),En(e.rels,2,o,Gr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],A=0;A<t.SheetNames.length;++A)(t.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(t.SheetNames[A]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Or(a,o,z8(t.Props)),s.extprops.push(o),En(e.rels,3,o,Gr.EXT_PROPS),t.Custprops!==t.Props&&ks(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Or(a,o,W8(t.Custprops)),s.custprops.push(o),En(e.rels,4,o,Gr.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var u={"!id":{}},d=t.Sheets[t.SheetNames[l-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Or(a,o,$ge(l-1,o,e,t,u)),s.sheets.push(o),En(e.wbrels,-1,"worksheets/sheet"+l+"."+r,Gr.WS[0])}if(d){var h=d["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Or(a,p,Jge(h,p)),s.comments.push(p),En(u,-1,"../comments"+l+"."+r,Gr.CMNT),m=!0),d["!legacy"]&&m&&Or(a,"xl/drawings/vmlDrawing"+l+".vml",BQ(l,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Or(a,tx(o),w0(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Or(a,o,Wge(e.Strings,o,e)),s.strs.push(o),En(e.wbrels,-1,"sharedStrings."+r,Gr.SST)),o="xl/workbook."+r,Or(a,o,Gge(t,o)),s.workbooks.push(o),En(e.rels,1,o,Gr.WB),o="xl/theme/theme1.xml",Or(a,o,EI(t.Themes,e)),s.themes.push(o),En(e.wbrels,-1,"theme/theme1.xml",Gr.THEME),o="xl/styles."+r,Or(a,o,zge(t,o,e)),s.styles.push(o),En(e.wbrels,-1,"styles."+r,Gr.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Or(a,o,t.vbaraw),s.vba.push(o),En(e.wbrels,-1,"vbaProject.bin",Gr.VBA)),o="xl/metadata."+r,Or(a,o,Xge(o)),s.metadata.push(o),En(e.wbrels,-1,"metadata."+r,Gr.XLMETA),Or(a,"[Content_Types].xml",V8(s,e)),Or(a,"_rels/.rels",w0(e.rels)),Or(a,"xl/_rels/workbook."+r+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,a}function x1e(t,e){o0=1024,t&&!t.SSF&&(t.SSF=es(yr)),t&&t.SSF&&(cm(),$y(t.SSF),e.revssf=Wy(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,sg?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=IQ.indexOf(e.bookType)>-1,s=wI();RI(e=e||{});var a=iI(),o="",l=0;if(e.cellXfs=[],vd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Or(a,o,q8(t.Props,e)),s.coreprops.push(o),En(e.rels,2,o,Gr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],A=0;A<t.SheetNames.length;++A)(t.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(t.SheetNames[A]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Or(a,o,z8(t.Props)),s.extprops.push(o),En(e.rels,3,o,Gr.EXT_PROPS),t.Custprops!==t.Props&&ks(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Or(a,o,W8(t.Custprops)),s.custprops.push(o),En(e.rels,4,o,Gr.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Or(a,o,MQ(l-1,e,t,d)),s.sheets.push(o),En(e.wbrels,-1,"worksheets/sheet"+l+"."+r,Gr.WS[0])}if(f){var m=f["!comments"],p=!1,x="";if(m&&m.length>0){var g=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(g=!0)})}),g&&(x="xl/threadedComments/threadedComment"+l+"."+r,Or(a,x,_fe(m,u,e)),s.threadedcomments.push(x),En(d,-1,"../threadedComments/threadedComment"+l+"."+r,Gr.TCMNT)),x="xl/comments"+l+"."+r,Or(a,x,SQ(m)),s.comments.push(x),En(d,-1,"../comments"+l+"."+r,Gr.CMNT),p=!0}f["!legacy"]&&p&&Or(a,"xl/drawings/vmlDrawing"+l+".vml",BQ(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Or(a,tx(o),w0(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Or(a,o,mQ(e.Strings,e)),s.strs.push(o),En(e.wbrels,-1,"sharedStrings."+r,Gr.SST)),o="xl/workbook."+r,Or(a,o,qQ(t)),s.workbooks.push(o),En(e.rels,1,o,Gr.WB),o="xl/theme/theme1.xml",Or(a,o,EI(t.Themes,e)),s.themes.push(o),En(e.wbrels,-1,"theme/theme1.xml",Gr.THEME),o="xl/styles."+r,Or(a,o,NQ(t,e)),s.styles.push(o),En(e.wbrels,-1,"styles."+r,Gr.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Or(a,o,t.vbaraw),s.vba.push(o),En(e.wbrels,-1,"vbaProject.bin",Gr.VBA)),o="xl/metadata."+r,Or(a,o,EQ()),s.metadata.push(o),En(e.wbrels,-1,"metadata."+r,Gr.XLMETA),u.length>1&&(o="xl/persons/person.xml",Or(a,o,Bfe(u)),s.people.push(o),En(e.wbrels,-1,"persons/person.xml",Gr.PEOPLE)),Or(a,"[Content_Types].xml",V8(s,e)),Or(a,"_rels/.rels",w0(e.rels)),Or(a,"xl/_rels/workbook."+r+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,a}function DI(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Fo(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function v1e(t,e){return pr.find(t,"EncryptedPackage")?m1e(t,e):WQ(t,e)}function w1e(t,e){var r,n=t,s=e||{};return s.type||(s.type=Qr&&Buffer.isBuffer(t)?"buffer":"base64"),r=g8(n,s),f1e(r,s)}function n7(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return jE(t.slice(r),e);default:break e}return H0.to_workbook(t,e)}function y1e(t,e){var r="",n=DI(t,e);switch(e.type){case"base64":r=Fo(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=jh(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=jn(r)),e.type="binary",n7(r,e)}function b1e(t,e){var r=t;return e.type=="base64"&&(r=Fo(r)),r=Wg.utils.decode(1200,r.slice(2),"str"),e.type="binary",n7(r,e)}function N1e(t){return t.match(/[^\x00-\x7F]/)?xc(t):t}function cC(t,e,r,n){return n?(r.type="string",H0.to_workbook(t,r)):H0.to_workbook(e,r)}function DE(t,e){tI();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return DE(new Uint8Array(t),(r=es(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),b0={},r.dateNF&&(b0.dateNF=r.dateNF),r.type||(r.type=Qr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Qr?"buffer":"binary",n=gce(t),typeof Uint8Array<"u"&&!Qr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=N1e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=es(r),r.type="array",DE(rI(n),r)}switch((s=DI(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return v1e(pr.read(n,r),r);break;case 9:if(s[1]<=8)return WQ(n,r);break;case 60:return jE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Sde(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return hQ.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?w1e(n,r):cC(t,n,r,a);case 239:return s[3]===60?jE(n,r):cC(t,n,r,a);case 255:if(s[1]===254)return b1e(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return hh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return hh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return TE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return wQ.to_workbook(n,r);break;case 10:case 13:case 32:return y1e(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Bde.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?TE.to_workbook(n,r):cC(t,n,r,a)}function s7(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Dx(e.file,pr.write(t,{type:Qr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return pr.write(t,e)}function C1e(t,e){var r=es(e||{}),n=p1e(t,r);return _1e(n,r)}function _1e(t,e){var r={},n=Qr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?pr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Gy(s))}return e.password&&typeof encrypt_agile<"u"?s7(encrypt_agile(s,e.password),e):e.type==="file"?Dx(e.file,s):e.type=="string"?jn(s):s}function E1e(t,e){var r=e||{},n=Nxe(t,r);return s7(n,r)}function uc(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Jg(xc(n));case"binary":return xc(n);case"string":return t;case"file":return Dx(e.file,n,"utf8");case"buffer":return Qr?TA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):uc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function B1e(t,e){switch(e.type){case"base64":return Jg(t);case"binary":return t;case"string":return t;case"file":return Dx(e.file,t,"binary");case"buffer":return Qr?TA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Fv(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Jg(r):e.type=="string"?jn(r):r;case"file":return Dx(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function a7(t,e){tI(),vge(t);var r=es(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=a7(t,r);return r.type="array",Gy(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return uc(pxe(t,r),r);case"slk":case"sylk":return uc(dQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return uc(XQ(t.Sheets[t.SheetNames[s]],r),r);case"txt":return B1e(i7(t.Sheets[t.SheetNames[s]],r),r);case"csv":return uc(LI(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return uc(hQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return Fv(TE.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return uc(H0.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return uc(wQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return uc(fQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return uc(t7(t,r),r);case"wk1":return Fv(hh.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return Fv(hh.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Fv(JQ(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),E1e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return C1e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function S1e(t,e,r,n,s,a,o,l){var c=Hs(r),A=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),d=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(A===void 0)continue;a[h]!=null&&(f[a[h]]=A);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[h]!=null){if(p==null)if(m.t=="e"&&p===null)f[a[h]]=null;else if(A!==void 0)f[a[h]]=A;else if(u&&p===null)f[a[h]]=null;else continue;else f[a[h]]=u&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:SA(m,p,l);p!=null&&(d=!1)}}return{row:f,isempty:d}}function D2(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},A=e||{},u=A.range!=null?A.range:t["!ref"];switch(A.header===1?n=1:A.header==="A"?n=2:Array.isArray(A.header)?n=3:A.header==null&&(n=0),typeof u){case"string":c=un(u);break;case"number":c=un(t["!ref"]),c.s.r=u;break;default:c=u}n>0&&(s=0);var d=Hs(c.s.r),f=[],h=[],m=0,p=0,x=Array.isArray(t),g=c.s.r,y=0,b={};x&&!t[g]&&(t[g]=[]);var F=A.skipHidden&&t["!cols"]||[],j=A.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(F[y]||{}).hidden)switch(f[y]=xs(y),r=x?t[g][y]:t[f[y]+d],n){case 1:a[y]=y-c.s.c;break;case 2:a[y]=f[y];break;case 3:a[y]=A.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=SA(r,null,A),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}a[y]=l}for(g=c.s.r+s;g<=c.e.r;++g)if(!(j[g]||{}).hidden){var R=S1e(t,c,g,f,n,a,x,A);(R.isempty===!1||(n===1?A.blankrows!==!1:A.blankrows))&&(h[m++]=R.row)}return h.length=m,h}var A3=/"/g;function I1e(t,e,r,n,s,a,o,l){for(var c=!0,A=[],u="",d=Hs(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var h=l.dense?(t[r]||[])[f]:t[n[f]+d];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:SA(h,null,l));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===s||p===a||p===34||l.forceQuotes){u='"'+u.replace(A3,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(A3,'""')+'"')):u="";A.push(u)}return l.blankrows===!1&&c?null:A.join(o)}function LI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=un(t["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),A=new RegExp((a=="|"?"\\|":a)+"+$"),u="",d=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(f[m]||{}).hidden||(d[m]=xs(m));for(var p=0,x=s.s.r;x<=s.e.r;++x)(h[x]||{}).hidden||(u=I1e(t,s,x,d,o,c,a,n),u!=null&&(n.strip&&(u=u.replace(A,"")),(u||n.blankrows!==!1)&&r.push((p++?l:"")+u)));return delete n.dense,r.join("")}function i7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=LI(t,e);return r}function F1e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=un(t["!ref"]),a="",o=[],l,c=[],A=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)o[l]=xs(l);for(var u=s.s.r;u<=s.e.r;++u)for(a=Hs(u),l=s.s.c;l<=s.e.c;++l)if(e=o[l]+a,r=A?(t[u]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function o7(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?vs(n.origin):n.origin;o=c.r,l=c.c}var A,u={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(a["!ref"]){var d=un(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+e.length-1+s)}else o==-1&&(o=0,u.e.r=e.length-1+s);var f=n.header||[],h=0;e.forEach(function(p,x){ks(p).forEach(function(g){(h=f.indexOf(g))==-1&&(f[h=f.length]=g);var y=p[g],b="z",F="",j=br({c:l+h,r:o+x+s});A=lx(a,j),y&&typeof y=="object"&&!(y instanceof Date)?a[j]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=da(y)),F=n.dateNF||yr[14]):y===null&&n.nullError&&(b="e",y=0),A?(A.t=b,A.v=y,delete A.w,delete A.R,F&&(A.z=F)):a[j]=A={t:b,v:y},F&&(A.z=F))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var m=Hs(o);if(s)for(h=0;h<f.length;++h)a[xs(h+l)+m]={t:"s",v:f[h]};return a["!ref"]=Pr(u),a}function k1e(t,e){return o7(null,t,e)}function lx(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=vs(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?lx(t,br(e)):lx(t,br({r:e,c:r||0}))}function T1e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function UI(){return{SheetNames:[],Sheets:{}}}function OI(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(KQ(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function j1e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=T1e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function P1e(t,e){return t.z=e,t}function l7(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function R1e(t,e,r){return l7(t,"#"+e,r)}function D1e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function L1e(t,e,r,n){for(var s=typeof e!="string"?e:un(e),a=typeof e=="string"?e:Pr(e),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=lx(t,o,l);c.t="n",c.F=a,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var kv={encode_col:xs,encode_row:Hs,encode_cell:br,encode_range:Pr,decode_col:fI,decode_row:hI,split_cell:Wce,decode_cell:vs,decode_range:Yi,format_cell:SA,sheet_add_aoa:R8,sheet_add_json:o7,sheet_add_dom:YQ,aoa_to_sheet:Am,json_to_sheet:k1e,table_to_sheet:ZQ,table_to_book:qxe,sheet_to_csv:LI,sheet_to_txt:i7,sheet_to_json:D2,sheet_to_html:XQ,sheet_to_formulae:F1e,sheet_to_row_object_array:D2,sheet_get_cell:lx,book_new:UI,book_append_sheet:OI,book_set_sheet_visibility:j1e,cell_set_number_format:P1e,cell_set_hyperlink:l7,cell_set_internal_link:R1e,cell_add_comment:D1e,sheet_set_array_formula:L1e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const U1e=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Kn(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function du(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Pd(t,e=1){const r=Math.floor(du(t,e));return r>0?r:e}function O1e(t){return Object.values(t||{}).every(r=>Kn(r)==="")}function sp(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(s=>n.set(Kn(s),s));for(const s of e){const a=n.get(Kn(s));if(a!=null)return t[a]}}function M1e(){const{refreshKey:t,refresh:e}=Wl(),[r,n]=N.useState(!0),[s,a]=N.useState(""),[o,l]=N.useState([]),[c,A]=N.useState(""),[u,d]=N.useState(""),[f,h]=N.useState(0),[m,p]=N.useState(1),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,j]=N.useState(""),[R,E]=N.useState(0),[S,B]=N.useState(1),[U,k]=N.useState(""),[T,L]=N.useState(!1),[Y,me]=N.useState(""),[ae,fe]=N.useState([]),[de,Z]=N.useState([]),[xe,Be]=N.useState(!1);N.useEffect(()=>{(async()=>{n(!0),a("");try{const K=await bt(Ut(ot(Re,"products_candies"),Hr("name","asc"))),ie=[];K.forEach(pe=>{const Ee=pe.data();ie.push({id:pe.id,name:Ee.name||"",category:Ee.category||"",providerPrice:Number(Ee.providerPrice||0),unitsPerPackage:Number(Ee.unitsPerPackage||1),createdAt:Ee.createdAt})}),l(ie)}catch(K){console.error(K),a(" Error cargando catlogo de dulces.")}finally{n(!1)}})()},[t]);const I=N.useMemo(()=>{const K=Kn(U);return K?o.filter(ie=>`${ie.category} ${ie.name}`.toLowerCase().includes(K)):o},[o,U]),C=N.useMemo(()=>{const K=new Set;return o.forEach(ie=>{const pe=String(ie.category||"").trim();pe&&K.add(pe)}),Array.from(K).sort((ie,pe)=>ie.localeCompare(pe,"es"))},[o]),Q=()=>{A(""),d(""),h(0),p(1)},M=async K=>{K.preventDefault(),a("");const ie=String(c||"").trim(),pe=String(u||"").trim(),Ee=Math.max(0,du(f,0)),Ue=Pd(m,1);if(!ie)return a(" La categora es requerida.");if(!pe)return a(" El nombre del producto es requerido.");if(Ee<=0)return a(" El precio proveedor debe ser > 0.");if(Ue<=0)return a(" Und x paquete debe ser > 0.");if(o.some($e=>Kn($e.category)===Kn(ie)&&Kn($e.name)===Kn(pe)))return a(" Ya existe un producto con esa categora y nombre.");try{n(!0);const $e={category:ie,name:pe,providerPrice:Ee,unitsPerPackage:Ue,createdAt:Vt.now()},st=await zr(ot(Re,"products_candies"),$e);l(Se=>[...Se,{id:st.id,...$e}].sort((ze,Ke)=>ze.name.localeCompare(Ke.name,"es"))),a(" Producto creado."),Q()}catch($e){console.error($e),a(" Error creando producto.")}finally{n(!1)}},D=K=>{g(K.id),b(K.category),j(K.name),E(K.providerPrice),B(K.unitsPerPackage||1),a("")},z=()=>{g(null),b(""),j(""),E(0),B(1)},O=async()=>{if(!x)return;a("");const K=String(y||"").trim(),ie=String(F||"").trim(),pe=Math.max(0,du(R,0)),Ee=Pd(S,1);if(!K)return a(" La categora es requerida.");if(!ie)return a(" El nombre del producto es requerido.");if(pe<=0)return a(" El precio proveedor debe ser > 0.");if(Ee<=0)return a(" Und x paquete debe ser > 0.");if(o.some(qe=>qe.id!==x&&Kn(qe.category)===Kn(K)&&Kn(qe.name)===Kn(ie)))return a(" Ya existe otro producto con esa categora y nombre.");try{n(!0),await Fr(Ft(Re,"products_candies",x),{category:K,name:ie,providerPrice:pe,unitsPerPackage:Ee,updatedAt:Vt.now()}),l(qe=>qe.map($e=>$e.id===x?{...$e,category:K,name:ie,providerPrice:pe,unitsPerPackage:Ee}:$e).sort(($e,st)=>$e.name.localeCompare(st.name,"es"))),a(" Producto actualizado."),z()}catch(qe){console.error(qe),a(" Error actualizando producto.")}finally{n(!1)}},te=async K=>{if(confirm(`Eliminar "${K.name}" (${K.category}) del catlogo?`))try{n(!0),await mn(Ft(Re,"products_candies",K.id)),l(pe=>pe.filter(Ee=>Ee.id!==K.id)),a(" Producto eliminado.")}catch(pe){console.error(pe),a(" Error eliminando producto.")}finally{n(!1)}},se=()=>{const K=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24}],ie=kv.json_to_sheet(K),pe=kv.book_new();kv.book_append_sheet(pe,ie,"Productos");const Ee=a7(pe,{type:"array",bookType:"xlsx"}),Ue=new Blob([Ee],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),qe=URL.createObjectURL(Ue),$e=document.createElement("a");$e.href=qe,$e.download="template_productos_dulces.xlsx",document.body.appendChild($e),$e.click(),$e.remove(),URL.revokeObjectURL(qe)},we=K=>{const ie=[],pe=[];K.forEach((Ue,qe)=>{if(!Ue||typeof Ue!="object"||O1e(Ue))return;const $e=String(sp(Ue,["Id","ID","productId","docId"])??"").trim(),st=String(sp(Ue,["Categoria","Categora","Category","cat","category"])??"").trim(),Se=String(sp(Ue,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),ze=sp(Ue,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),Ke=sp(Ue,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),be=Math.max(0,du(ze,0)),le=Pd(Ke,1),je=qe+2;st||pe.push(`Fila ${je}: falta Categoria.`),Se||pe.push(`Fila ${je}: falta Producto/Nombre.`),be<=0&&pe.push(`Fila ${je}: PrecioProveedor debe ser > 0.`),le<=0&&pe.push(`Fila ${je}: UnidadesPorPaquete debe ser > 0.`),st&&Se&&be>0&&le>0&&ie.push({id:$e||void 0,category:st,name:Se,providerPrice:be,unitsPerPackage:le,_raw:Ue})});const Ee=new Map;for(const Ue of ie){const qe=Ue.id?`id::${Ue.id}`:`${Kn(Ue.category)}::${Kn(Ue.name)}`;Ee.set(qe,Ue)}return{rows:Array.from(Ee.values()),errors:pe}},q=async K=>{if(a(""),Z([]),fe([]),me((K==null?void 0:K.name)||""),!K)return;const ie=K.name.toLowerCase(),pe=ie.endsWith(".xlsx")||ie.endsWith(".xls"),Ee=ie.endsWith(".csv");if(!pe&&!Ee){Z(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Be(!0);const Ue=new FileReader,qe=await new Promise((le,je)=>{Ue.onerror=()=>je(new Error("No se pudo leer el archivo.")),Ue.onload=()=>le(Ue.result),Ue.readAsArrayBuffer(K)}),$e=DE(new Uint8Array(qe),{type:"array"}),st=$e.SheetNames[0],Se=$e.Sheets[st],ze=kv.sheet_to_json(Se,{defval:""}),{rows:Ke,errors:be}=we(ze);fe(Ke),Z(be),Ke.length===0&&be.length===0&&Z(["No se encontraron filas vlidas para importar."])}catch(Ue){console.error(Ue),Z(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Be(!1)}},Me=(K,ie)=>{fe(pe=>{const Ee=[...pe],Ue=Ee[K];return Ue?(Ee[K]={...Ue,...ie},Ee):pe})},re=async()=>{if(a(""),de.length>0){a(" Correg los errores antes de importar.");return}if(ae.length===0){a(" No hay filas para importar.");return}try{Be(!0);const K={},ie={};o.forEach(qe=>{K[qe.id]=qe,ie[`${Kn(qe.category)}::${Kn(qe.name)}`]=qe});const pe=Gh(Re);let Ee=0,Ue=0;for(const qe of ae){const $e=String(qe.category||"").trim(),st=String(qe.name||"").trim(),Se=Math.max(0,du(qe.providerPrice,0)),ze=Pd(qe.unitsPerPackage,1);if(!$e||!st||Se<=0||ze<=0)continue;let Ke;if(qe.id&&K[qe.id])Ke=K[qe.id];else{const be=`${Kn($e)}::${Kn(st)}`;Ke=ie[be]}if(Ke)pe.update(Ft(Re,"products_candies",Ke.id),{category:$e,name:st,providerPrice:Se,unitsPerPackage:ze,updatedAt:Vt.now()}),Ue+=1;else{const be=Ft(ot(Re,"products_candies"));pe.set(be,{category:$e,name:st,providerPrice:Se,unitsPerPackage:ze,createdAt:Vt.now()}),Ee+=1}}await pe.commit(),a(` Importacin lista. Creados: ${Ee}, Actualizados: ${Ue}`),L(!1),fe([]),Z([]),me(""),e()}catch(K){console.error(K),a(" Error importando productos a Firestore.")}finally{Be(!1)}},J=N.useMemo(()=>{const K=new Set(o.map(Ue=>Ue.id)),ie=new Set(o.map(Ue=>`${Kn(Ue.category)}::${Kn(Ue.name)}`));let pe=0,Ee=0;for(const Ue of ae){if(Ue.id&&K.has(Ue.id)){pe+=1;continue}const qe=`${Kn(Ue.category)}::${Kn(Ue.name)}`;ie.has(qe)?pe+=1:Ee+=1}return{willCreate:Ee,willUpdate:pe,total:ae.length}},[ae,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catlogo de Productos (Dulces)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:e,loading:r||xe}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{L(!0),fe([]),Z([]),me("")},children:"Importar (.xlsx)"})]})]}),i.jsxs("form",{onSubmit:M,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-5 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:K=>A(K.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:u,onChange:K=>d(K.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(f)?"":f,onChange:K=>h(Math.max(0,du(K.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:K=>p(Pd(K.target.value,1))})]}),i.jsxs("div",{className:"md:col-span-5 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Q,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:U,onChange:K=>k(K.target.value),placeholder:"Buscar por categora o producto"})]}),i.jsxs("div",{className:"w-full md:w-1/2 text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:I.length})]})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):I.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin productos."})}):I.map(K=>{const ie=x===K.id;return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:ie?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:y,onChange:pe=>b(pe.target.value)}):K.category}),i.jsx("td",{className:"p-2 border",children:ie?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:F,onChange:pe=>j(pe.target.value)}):K.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ie?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(R)?"":R,onChange:pe=>E(Math.max(0,du(pe.target.value,0)))}):U1e(K.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ie?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:S,onChange:pe=>B(Pd(pe.target.value,1))}):K.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:ie?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:O,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:z,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>D(K),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>te(K),type:"button",children:"Borrar"})]})})]},K.id)})})]})}),s&&i.jsx("p",{className:"mt-2 text-sm",children:s}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>L(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:se,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:K=>{var ie;return q(((ie=K.target.files)==null?void 0:ie[0])||null)}}),Y&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:Y})]}),xe&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),de.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:de.slice(0,50).map((K,ie)=>i.jsx("li",{children:K},ie))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",J.total," filas (Crear:"," ",J.willCreate," / Actualizar:"," ",J.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:re,disabled:xe||ae.length===0||de.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1100px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):ae.slice(0,300).map((K,ie)=>{const pe=K.id?o.some(qe=>qe.id===K.id):!1,Ee=o.some(qe=>`${Kn(qe.category)}::${Kn(qe.name)}`==`${Kn(K.category)}::${Kn(K.name)}`),Ue=pe||Ee;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:K.id||"",onChange:qe=>Me(ie,{id:qe.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:K.category,onChange:qe=>Me(ie,{category:qe.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:K.name,onChange:qe=>Me(ie,{name:qe.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(K.providerPrice)?"":K.providerPrice,onChange:qe=>Me(ie,{providerPrice:Math.max(0,du(qe.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:K.unitsPerPackage,onChange:qe=>Me(ie,{unitsPerPackage:Pd(qe.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${Ue?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:Ue?"ACTUALIZA":"CREA"})})]},`${K.id||""}-${ie}`)})})]}),i.jsx("datalist",{id:"categories-list",children:C.map(K=>i.jsx("option",{value:K},K))})]}),ae.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",ae.length," filas (el import importa todas)."]})]})]})})]})}function MI(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),s=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):s>0?Math.floor(s*e):0}function og(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):MI(t)}function Q1e(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=MI(t);return r>0&&e>0?Math.floor(r/e):Math.max(0,Math.floor(Number(t.packages||0)))}function V1e(t){if(typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages))return Math.max(0,Math.floor(Number(t.remainingPackages)));const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=og(t);return Math.max(0,Math.floor(r/e))}async function H1e(t){const e=Ft(Re,"candy_main_orders",t);if((await za(e)).exists())return e;const n=Ut(ot(Re,"candy_main_orders"),qt("orderId","==",t)),s=await bt(n);return s.empty?null:Ft(Re,"candy_main_orders",s.docs[0].id)}async function AC(t){if(!t)return;const e=await H1e(t);if(!e)return;const r=Ut(ot(Re,"inventory_candies"),qt("orderId","==",t)),n=await bt(r),s=new Map;n.forEach(l=>{const c=l.data(),A=String(c.productId||"");if(!A)return;const u=Q1e(c),d=V1e(c),f=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),g=h*u,y=m*u,b=p*u,F=x*u,j=y-g,R=b-g,E=F-g;s.has(A)||s.set(A,{productId:A,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:f,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const S=s.get(A);S.packages+=u,S.remainingPackages+=d,S.subtotal+=g,S.totalRivas+=y,S.totalSanJorge+=b,S.totalIsla+=F,S.gainRivas+=j,S.gainSanJorge+=R,S.gainIsla+=E,S.providerPrice=h,S.unitPriceRivas=m||S.unitPriceRivas,S.unitPriceSanJorge=p||S.unitPriceSanJorge,S.unitPriceIsla=x||S.unitPriceIsla,S.unitsPerPackage=f||S.unitsPerPackage,S.name=String(c.productName||S.name),S.category=String(c.category||S.category)});const a=Array.from(s.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=a.reduce((l,c)=>l+Number(c.packages||0),0);await Fr(e,{totalPackages:o,items:a})}async function K1e(t){const{productId:e,saleDate:r,saleId:n}=t,s=t.quantityPacks,a=t.quantity;if(!e)throw new Error("Parmetros invlidos para allocateSaleFIFOCandy (sin producto)");const o=Ut(ot(Re,"inventory_candies"),qt("productId","==",e)),l=await bt(o);if(l.empty)throw new Error("No hay inventario para este producto.");const c=l.docs.map(h=>({id:h.id,data:h.data()})).sort((h,m)=>{var b,F;const p=String(h.data.date||""),x=String(m.data.date||"");if(p!==x)return p<x?-1:1;const g=((b=h.data.createdAt)==null?void 0:b.seconds)??0,y=((F=m.data.createdAt)==null?void 0:F.seconds)??0;return g-y});let A=0;for(const h of c){const m=Number(h.data.unitsPerPackage??0);if(m>0){A=m;break}}if(!A)for(const h of c){const m=h.data,p=Number(m.totalUnits??0),x=Number(m.packages??0);if(p>0&&x>0){A=p/x;break}}A||(A=1);let u;if(s!=null&&!Number.isNaN(Number(s))){const h=Math.max(0,Math.floor(Number(s)));if(h<=0)throw new Error("La cantidad en paquetes debe ser mayor que cero.");u=h*A}else{const h=Math.max(0,Math.floor(Number(a||0)));if(h<=0)throw new Error("La cantidad debe ser mayor que cero.");u=h}const d=c.map(h=>Ft(Re,"inventory_candies",h.id)),f=[];return await Na(Re,async h=>{const m=await Promise.all(d.map(x=>h.get(x)));let p=u;for(let x=0;x<d.length&&p>0;x++){const g=d[x],y=m[x];if(!y.exists())continue;const b=y.data(),F=og(b);if(F<=0)continue;const j=Math.min(F,p),R=Math.max(0,F-j),E=Math.max(1,Math.floor(Number(b.unitsPerPackage||1))),S=Math.floor(R/E);h.update(g,{remaining:R,remainingPackages:S,packages:S}),f.push({batchId:g.id,qty:j,batchDate:String(b.date||""),productName:String(b.productName||"")}),p-=j}if(p>0){const x=Math.ceil(p/A);throw new Error(`Inventario insuficiente. Faltan aproximadamente ${x} paquetes.`)}if(n)for(const x of f)await zr(ot(Re,"batch_candies_allocations"),{saleId:n,saleDate:r,productId:e,productName:x.productName??"",batchId:x.batchId,batchDate:x.batchDate??"",quantity:x.qty,createdAt:Vt.now()})}),{allocations:f}}function q1e(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const s=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const a of s){const o=String(a.inventorySellerId||""),l=Math.max(0,Math.floor(Number(a.units??a.qty??a.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const s=e[n],a=Array.isArray(s==null?void 0:s.allocations)?s.allocations:[];for(const o of a){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function cx(t){const e=t.split("#")[0],r=Ft(Re,"sales_candies",e),n=await za(r);if(!n.exists())throw new Error("La venta no existe.");const s=n.data(),a=q1e(s);if(a&&a.allocations.length>0){let A=0;return await Na(Re,async u=>{const d={};for(const p of a.allocations){const x=p.inventorySellerId,g=Math.max(0,Math.floor(Number(p.units||0)));!x||g<=0||(d[x]=(d[x]||0)+g,A+=g)}const h=Object.keys(d).map(p=>Ft(Re,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const g=x.data(),y=Number(g.remainingUnits??g.remaining??0),b=Math.max(0,Math.floor(Number(d[h[p].id]||0))),F=y+b,j=Math.max(1,Math.floor(Number(g.unitsPerPackage||1))),R=Math.floor(F/j);u.update(h[p],{remainingUnits:F,remainingPackages:R})}u.delete(r)}),{restored:A}}const o=[];if(Array.isArray(s.items)&&s.items.length>0){const A={};if(s.allocationsByItem&&typeof s.allocationsByItem=="object")for(const u of Object.keys(s.allocationsByItem)){const d=s.allocationsByItem[u],f=String((d==null?void 0:d.productId)||u||"");if(!f)continue;const h=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];A[f]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(s.allocationsByItem))for(const u of s.allocationsByItem){const d=String((u==null?void 0:u.productId)||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];A[d]=f.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const u of s.items){const d=String((u==null?void 0:u.productId)||"");if(!d)continue;const f=Math.max(0,Math.floor(Number((u==null?void 0:u.qty)||(u==null?void 0:u.quantity)||0))),h=Array.isArray(u==null?void 0:u.allocations)?u.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):A[d]||[];o.push({productId:d,productName:String((u==null?void 0:u.productName)||""),qty:f,allocations:h.length?h:void 0})}}else{const A=s.item||{},u=String(A.productId||s.productId||""),d=Math.max(0,Math.floor(Number(A.qty??s.quantity??0))),f=Array.isArray(s.allocations)?s.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];u&&d>0&&o.push({productId:u,productName:String(A.productName||s.productName||""),qty:d,allocations:f.length?f:void 0})}if(o.length===0)return await Na(Re,async A=>{A.delete(r)}),{restored:0};if(o.every(A=>Array.isArray(A.allocations)&&A.allocations.length>0)){let A=0;return await Na(Re,async u=>{const d=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));A+=p,d.push({ref:Ft(Re,"inventory_candies",m.batchId),addBack:p})}const f=await Promise.all(d.map(h=>u.get(h.ref)));for(let h=0;h<d.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),x=og(p),g=Math.max(0,Math.floor(Number(d[h].addBack||0))),y=x+g,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),F=Math.floor(y/b);u.update(d[h].ref,{remaining:y,remainingPackages:F,packages:F})}u.delete(r)}),{restored:A}}let c=0;return await Na(Re,async A=>{const u={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=Ut(ot(Re,"inventory_candies"),qt("productId","==",p.productId)),y=(await bt(x)).docs.map(b=>{const F=b.data(),j=MI(F),R=og(F);return{id:b.id,date:String(F.date||""),baseUnits:j,remaining:R}}).sort((b,F)=>b.date.localeCompare(F.date));u[p.productId]=y}const d=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,d.push({id:y.batchId,addBack:b})}continue}const x=u[p.productId]||[];let g=p.qty;for(const y of x){if(g<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const F=Math.min(b,g);d.push({id:y.id,addBack:F}),c+=F,g-=F}for(const y of x){if(g<=0)break;const b=Math.min(g,p.qty);d.push({id:y.id,addBack:b}),c+=b,g-=b}}const f={};for(const p of d)f[p.id]=(f[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(f).map(p=>Ft(Re,"inventory_candies",p)),m=await Promise.all(h.map(p=>A.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const g=x.data(),y=og(g),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),F=y+b,j=Math.max(1,Math.floor(Number(g.unitsPerPackage||1))),R=Math.floor(F/j);A.update(h[p],{remaining:F,remainingPackages:R,packages:R})}A.delete(r)}),{restored:c}}async function G1e(t){return cx(t)}const Ci=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function uC(t){return isFinite(t)?Math.round(t):0}function El(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function dC(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function $1e(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const s=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-s}function z1e(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[u,d]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,j]=N.useState(0),[R,E]=N.useState(!1),[S,B]=N.useState(""),[U,k]=N.useState(""),[T,L]=N.useState([]);N.useEffect(()=>{(async()=>{try{a(!0);const D=await bt(ot(Re,"products_candies")),z=[];D.forEach(we=>{const q=we.data();z.push({id:we.id,name:q.name??"(sin nombre)",category:q.category??"(sin categora)"})}),e(z);const O=Ut(ot(Re,"inventory_candies"),Hr("date","desc")),te=await bt(O),se=[];te.forEach(we=>{const q=we.data(),Me=Number(q.unitsPerPackage||0),re=Number(q.totalUnits??q.quantity??(q.packages||0)*(q.unitsPerPackage||0)),J=Number(q.remaining??q.totalUnits??re??0);se.push({id:we.id,productId:q.productId,productName:q.productName,category:q.category,measurement:q.measurement??"unidad",packages:Number(q.packages||0),unitsPerPackage:Me,totalUnits:re,remaining:J,remainingPackages:typeof q.remainingPackages=="number"?Number(q.remainingPackages):void 0,providerPrice:Number(q.providerPrice||0),subtotal:Number(q.subtotal||0),totalRivas:Number(q.totalRivas||0),totalSanJorge:Number(q.totalSanJorge||0),totalIsla:Number(q.totalIsla||0),gainRivas:Number(q.gainRivas||0),gainSanJorge:Number(q.gainSanJorge||0),gainIsla:Number(q.gainIsla||0),unitPriceRivas:Number(q.unitPriceRivas||0),unitPriceSanJorge:Number(q.unitPriceSanJorge||0),unitPriceIsla:Number(q.unitPriceIsla||0),date:q.date,createdAt:q.createdAt,status:q.status??"PENDIENTE",orderId:q.orderId??null})}),n(se)}catch(D){console.error(D),l(" Error cargando inventario.")}finally{a(!1)}})()},[]);const Y=N.useMemo(()=>r.filter(D=>!(c&&D.date<c||u&&D.date>u||f&&D.productId!==f||m&&String(D.category||"")!==m)),[r,c,u,f,m]),me=N.useMemo(()=>{const D=new Set;for(const z of t)z.category&&D.add(z.category);return Array.from(D).sort((z,O)=>z.localeCompare(O))},[t]),ae=N.useMemo(()=>{const D=Y.reduce((q,Me)=>q+El(Me),0),z=Y.reduce((q,Me)=>q+dC(Me),0),O=Y.reduce((q,Me)=>{const re=El(Me);return q+Number(Me.providerPrice||0)*re},0),te=Y.reduce((q,Me)=>{const re=El(Me);return q+Number(Me.unitPriceRivas||0)*re},0),se=Y.reduce((q,Me)=>{const re=El(Me);return q+Number(Me.unitPriceSanJorge||0)*re},0),we=Y.reduce((q,Me)=>{const re=El(Me);return q+Number(Me.unitPriceIsla||0)*re},0);return{totalPaquetes:D,totalPaquetesRestantes:z,totalSubtotal:O,totalRivas:te,totalSJ:se,totalIsla:we}},[Y]),fe=N.useMemo(()=>{let D=0,z=0;for(const O of Y)O.status==="PENDIENTE"&&(D+=1),O.status==="PAGADO"&&(z+=1);return{totalLotes:Y.length,pendientes:D,pagados:z}},[Y]),de=N.useMemo(()=>{const D=new Map;for(const O of Y){const te=String(O.productId||"");te&&(D.has(te)||D.set(te,{batches:[]}),D.get(te).batches.push(O))}const z=[];for(const[O,te]of D.entries()){const se=[...te.batches].sort($1e),we=se[0],q=se.reduce((Se,ze)=>Se+El(ze),0),Me=se.reduce((Se,ze)=>Se+dC(ze),0),re=Number((we==null?void 0:we.providerPrice)||0),J=Number((we==null?void 0:we.unitPriceRivas)||0),K=Number((we==null?void 0:we.unitPriceIsla)||0),ie=se.reduce((Se,ze)=>{const Ke=El(ze);return Se+Number(ze.providerPrice||0)*Ke},0),pe=se.reduce((Se,ze)=>{const Ke=El(ze);return Se+Number(ze.unitPriceRivas||0)*Ke},0),Ee=se.reduce((Se,ze)=>{const Ke=El(ze);return Se+Number(ze.unitPriceIsla||0)*Ke},0),Ue=pe-ie,qe=Ee-ie;let $e="",st;for(const Se of se)(!$e||String(Se.date||"")>$e)&&($e=String(Se.date||""),st=Se.createdAt);z.push({productId:O,productName:(we==null?void 0:we.productName)||"",category:(we==null?void 0:we.category)||"",totalPackages:q,remainingPackages:Me,providerPrice:re,unitPriceRivas:J,unitPriceIsla:K,subtotal:ie,totalRivas:pe,totalIsla:Ee,gainRivas:Ue,gainIsla:qe,lastDate:$e,lastCreatedAt:st,batchCount:se.length})}return z.sort((O,te)=>String(te.lastDate).localeCompare(String(O.lastDate))),z},[Y]),Z=D=>{g(D.id),b(D.date),j(D.providerPrice),l("")},xe=()=>{g(null),b(""),j(0)},Be=async()=>{if(!x)return;const D=r.find(Ee=>Ee.id===x);if(!D)return;if(F<0){l("El precio proveedor no puede ser negativo.");return}const z=El(D),O=F*z,te=z>0?O/.8:0,se=z>0?O/.85:0,we=z>0?O/.7:0,q=te-O,Me=se-O,re=we-O,J=z>0?uC(te/z):0,K=z>0?uC(se/z):0,ie=z>0?uC(we/z):0,pe=Ft(Re,"inventory_candies",x);await Fr(pe,{date:y,providerPrice:F,subtotal:O,totalRivas:te,totalSanJorge:se,totalIsla:we,gainRivas:q,gainSanJorge:Me,gainIsla:re,unitPriceRivas:J,unitPriceSanJorge:K,unitPriceIsla:ie}),n(Ee=>Ee.map(Ue=>Ue.id===x?{...Ue,date:y,providerPrice:F,subtotal:O,totalRivas:te,totalSanJorge:se,totalIsla:we,gainRivas:q,gainSanJorge:Me,gainIsla:re,unitPriceRivas:J,unitPriceSanJorge:K,unitPriceIsla:ie}:Ue)),D.orderId&&await AC(String(D.orderId)),l(" Lote de dulces actualizado"),xe()},I=async D=>{confirm(`Marcar PAGADO el lote del ${D.date} (${D.productName})?`)&&(await Fr(Ft(Re,"inventory_candies",D.id),{status:"PAGADO"}),n(O=>O.map(te=>te.id===D.id?{...te,status:"PAGADO"}:te)),l(" Lote marcado como pagado"))},C=async D=>{confirm(`Eliminar el lote del ${D.date} (${D.productName})?`)&&(await mn(Ft(Re,"inventory_candies",D.id)),n(O=>O.filter(te=>te.id!==D.id)),D.orderId&&await AC(String(D.orderId)),l(" Lote eliminado"))},Q=async(D,z)=>{try{a(!0),l("");const O=Ut(ot(Re,"inventory_candies"),qt("productId","==",D),Hr("date","desc")),te=await bt(O),se=[];te.forEach(we=>{const q=we.data(),Me=Number(q.unitsPerPackage||0),re=Number(q.totalUnits??q.quantity??(q.packages||0)*(q.unitsPerPackage||0)),J=Number(q.remaining??q.totalUnits??re??0);se.push({id:we.id,productId:q.productId,productName:q.productName,category:q.category,measurement:q.measurement??"unidad",packages:Number(q.packages||0),unitsPerPackage:Me,totalUnits:re,remaining:J,remainingPackages:typeof q.remainingPackages=="number"?Number(q.remainingPackages):void 0,providerPrice:Number(q.providerPrice||0),subtotal:Number(q.subtotal||0),totalRivas:Number(q.totalRivas||0),totalSanJorge:Number(q.totalSanJorge||0),totalIsla:Number(q.totalIsla||0),gainRivas:Number(q.gainRivas||0),gainSanJorge:Number(q.gainSanJorge||0),gainIsla:Number(q.gainIsla||0),unitPriceRivas:Number(q.unitPriceRivas||0),unitPriceSanJorge:Number(q.unitPriceSanJorge||0),unitPriceIsla:Number(q.unitPriceIsla||0),date:q.date,createdAt:q.createdAt,status:q.status??"PENDIENTE",orderId:q.orderId??null})}),B(D),k(z),L(se),E(!0)}catch(O){console.error(O),l(" Error abriendo detalle del producto.")}finally{a(!1)}},M=async(D,z)=>{const O=r.filter(se=>se.productId===D);if(confirm(`Eliminar COMPLETAMENTE "${z}"?
Esto eliminar ${O.length} lote(s) de este producto.`))try{a(!0),l("");const se=Array.from(new Set(O.map(we=>we.orderId?String(we.orderId):"").filter(Boolean)));for(const we of O)await mn(Ft(Re,"inventory_candies",we.id));n(we=>we.filter(q=>q.productId!==D)),l(" Producto eliminado (todos sus lotes).");for(const we of se)await AC(we);R&&S===D&&(E(!1),L([]),B(""),k(""))}catch(se){console.error(se),l(" Error eliminando lotes del producto.")}finally{a(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>A(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:D=>d(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:D=>p(D.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),me.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(D=>i.jsxs("option",{value:D.id,children:[D.name,"  ",D.category]},D.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",fe.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",fe.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",fe.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ae.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ae.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",Ci(ae.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",Ci(ae.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",Ci(ae.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",Ci(ae.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):de.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):de.map(D=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:D.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:D.productName,children:D.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",D.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:D.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:D.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ci(D.gainIsla)}),i.jsx("td",{className:"p-2 border",children:D.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>Q(D.productId,D.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>M(D.productId,D.productName),children:"Borrar"})]})})]},D.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),R&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",U||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",S]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{E(!1),L([]),B(""),k(""),xe()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):T.map(D=>{const z=x===D.id,O=El(D),te=dC(D);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:z?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:se=>b(se.target.value)}):D.date}),i.jsx("td",{className:"p-2 border align-top",children:D.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:D.productName,children:D.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",D.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:O}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:te}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:D.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:z?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(F)?"":F,onChange:se=>j(Math.max(0,parseFloat(se.target.value||"0")))}):Ci(D.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Ci(D.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Ci(D.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:D.orderId?String(D.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border align-top",children:z?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Be,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:xe,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[D.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>I(D),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>Z(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>C(D),children:"Borrar"})]})})]},D.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>M(S,U),children:"Borrar producto (todos los lotes)"})})]})})]})}const u3=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],lc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Tv(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function d3(t){const e=Ut(ot(Re,"ar_movements"),qt("ref.saleId","==",t)),r=await bt(e);await Promise.all(r.docs.map(n=>mn(Ft(Re,"ar_movements",n.id))))}function W1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const n=String(t||"").trim().toLowerCase(),s=String(e||"").trim(),a=n==="vendedor_dulces",o=n==="admin",[l,c]=N.useState([]),[A,u]=N.useState(!1),[d,f]=N.useState(!1),[h,m]=N.useState(null),[p,x]=N.useState([]),g=async Le=>{u(!0),f(!0),m(Le),x([]);try{const et=(await bt(Ut(ot(Re,"sales_candies"),qt("__name__","==",Le)))).docs[0],dt=et==null?void 0:et.data(),Nt=(Array.isArray(dt==null?void 0:dt.items)?dt.items:dt!=null&&dt.item?[dt.item]:[]).map(At=>({productName:String(At.productName||""),qty:Number(At.qty||0),unitPrice:Number(At.unitPrice||0),discount:Number(At.discount||0),total:Number(At.total||0)}));x(Nt)}catch(Xe){console.error(Xe)}finally{f(!1)}},[y,b]=N.useState(""),[F,j]=N.useState("+505 "),[R,E]=N.useState(""),[S,B]=N.useState(""),[U,k]=N.useState("ACTIVO"),[T,L]=N.useState(0),[Y,me]=N.useState(""),[ae,fe]=N.useState(0),[de,Z]=N.useState([]),[xe,Be]=N.useState(!0),[I,C]=N.useState(""),[Q,M]=N.useState(null),[D,z]=N.useState(""),[O,te]=N.useState("+505 "),[se,we]=N.useState(""),[q,Me]=N.useState(""),[re,J]=N.useState("ACTIVO"),[K,ie]=N.useState(0),[pe,Ee]=N.useState(""),[Ue,qe]=N.useState(!1),[$e,st]=N.useState(null),[Se,ze]=N.useState(!1),[Ke,be]=N.useState([]),[le,je]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[X,G]=N.useState(!1),[ye,Oe]=N.useState(0),[_e,he]=N.useState(new Date().toISOString().slice(0,10)),[Ce,Ze]=N.useState(""),[Te,Ge]=N.useState(!1),[at,wt]=N.useState(null),[it,xt]=N.useState(""),[Lt,hr]=N.useState(0),[lr,gr]=N.useState(""),[xr,Ye]=N.useState(!1);N.useEffect(()=>{(async()=>{try{if(Be(!0),a&&!s){Z([]),C(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const Le=await bt(ot(Re,"sellers_candies")),Xe=[];Le.forEach(Nt=>{const At=Nt.data(),yt=String(At.status||"ACTIVO");yt==="ACTIVO"&&Xe.push({id:Nt.id,name:String(At.name||""),status:yt})}),c(Xe);const et=a?Ut(ot(Re,"customers_candies"),qt("vendorId","==",s),Hr("createdAt","desc")):Ut(ot(Re,"customers_candies"),Hr("createdAt","desc")),dt=await bt(et),vt=[];dt.forEach(Nt=>{const At=Nt.data();vt.push({id:Nt.id,name:At.name??"",phone:At.phone??"+505 ",place:At.place??"",notes:At.notes??"",status:At.status??"ACTIVO",creditLimit:Number(At.creditLimit??0),createdAt:At.createdAt??Vt.now(),balance:0,sellerId:At.sellerId||"",vendorId:At.vendorId||"",vendorName:At.vendorName||"",initialDebt:Number(At.initialDebt||0)})});for(const Nt of vt)try{const At=Ut(ot(Re,"ar_movements"),qt("customerId","==",Nt.id)),yt=await bt(At);let Zt=0;yt.forEach(Rr=>Zt+=Number(Rr.data().amount||0)),Nt.balance=Zt}catch{Nt.balance=0}Z(vt)}catch(Le){console.error(Le),C(" Error cargando clientes.")}finally{Be(!1)}})()},[a,s]);const pt=()=>{b(""),j("+505 "),E(""),B(""),k("ACTIVO"),L(0),me(""),fe(0)},Rt=async Le=>{var vt;if(Le.preventDefault(),C(""),!y.trim()){C("Ingresa el nombre.");return}const Xe=Tv(F);if(Xe.length<6){C("Telfono incompleto.");return}const et=a?s:String(Y||"").trim(),dt=et&&((vt=l.find(Nt=>Nt.id===et))==null?void 0:vt.name)||"";try{const Nt=await zr(ot(Re,"customers_candies"),{name:y.trim(),phone:Xe,place:R||"",notes:S||"",status:U,creditLimit:Number(T||0),vendorId:et,vendorName:dt,initialDebt:Number(ae||0),createdAt:Vt.now()});Z(At=>[{id:Nt.id,name:y.trim(),phone:Xe,place:R||"",notes:S||"",status:U,creditLimit:Number(T||0),vendorId:et,vendorName:dt,initialDebt:Number(ae||0),createdAt:Vt.now(),balance:0},...At]),pt(),Ye(!1),C(" Cliente creado")}catch(Nt){console.error(Nt),C(" Error al crear cliente")}},Tt=Le=>{if(a){C(" No permitido: vendedores no editan clientes desde el listado.");return}M(Le.id),z(Le.name),te(Le.phone||"+505 "),we(Le.place||""),Me(Le.notes||""),J(Le.status||"ACTIVO"),ie(Number(Le.creditLimit||0)),Ee(String(Le.vendorId||""))},Dt=()=>{M(null),z(""),te("+505 "),we(""),Me(""),J("ACTIVO"),ie(0),Ee("")},Xt=async()=>{var At;if(a){C(" No permitido.");return}if(!Q)return;const Le=Tv(O);if(!D.trim()){C("Ingresa el nombre.");return}const Xe=de.find(yt=>yt.id===Q),et=String((Xe==null?void 0:Xe.vendorId)||""),dt=a?s:String(pe||"");if(a&&et&&et!==s){C(" Este cliente pertenece a otro vendedor.");return}if(o&&et&&dt&&et!==dt){C(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const vt=a?s:String(pe||""),Nt=vt&&((At=l.find(yt=>yt.id===vt))==null?void 0:At.name)||"";try{await Fr(Ft(Re,"customers_candies",Q),{name:D.trim(),phone:Le,place:se||"",notes:q||"",status:re,creditLimit:Number(K||0),vendorId:vt,vendorName:Nt}),Z(yt=>yt.map(Zt=>Zt.id===Q?{...Zt,name:D.trim(),phone:Le,place:se||"",notes:q||"",status:re,creditLimit:Number(K||0),vendorId:vt,vendorName:Nt}:Zt)),Dt(),C(" Cliente actualizado")}catch(yt){console.error(yt),C(" Error al actualizar")}},Kt=async Le=>{if(confirm(`Eliminar al cliente "${Le.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{Be(!0);const et=Ut(ot(Re,"sales_candies"),qt("customerId","==",Le.id)),dt=await bt(et);for(const At of dt.docs){const yt=At.id;try{await cx(yt)}catch(Zt){console.warn("restoreSaleAndDeleteCandy error",Zt);try{await mn(Ft(Re,"sales_candies",yt))}catch{}}await d3(yt)}const vt=Ut(ot(Re,"ar_movements"),qt("customerId","==",Le.id)),Nt=await bt(vt);await Promise.all(Nt.docs.map(At=>mn(Ft(Re,"ar_movements",At.id)))),await mn(Ft(Re,"customers_candies",Le.id)),Z(At=>At.filter(yt=>yt.id!==Le.id)),C(" Cliente eliminado y dulces devueltos al inventario")}catch(et){console.error(et),C(" No se pudo eliminar el cliente.")}finally{Be(!1)}},oe=async Le=>{st(Le),be([]),je({saldoActual:0,totalAbonado:0,totalCargos:0}),qe(!0),G(!1),Oe(0),he(new Date().toISOString().slice(0,10)),Ze(""),wt(null),ze(!0);try{const Xe=Ut(ot(Re,"ar_movements"),qt("customerId","==",Le.id)),et=await bt(Xe),dt=[];et.forEach(vt=>{var At,yt;const Nt=vt.data();dt.push({id:vt.id,date:Nt.date??((yt=(At=Nt.createdAt)==null?void 0:At.toDate)!=null&&yt.call(At)?Nt.createdAt.toDate().toISOString().slice(0,10):""),type:Nt.type??"CARGO",amount:Number(Nt.amount||0),ref:Nt.ref||{},comment:Nt.comment||"",createdAt:Nt.createdAt})}),dt.sort((vt,Nt)=>{var Zt,Rr;if(vt.date!==Nt.date)return vt.date.localeCompare(Nt.date);const At=((Zt=vt.createdAt)==null?void 0:Zt.seconds)||0,yt=((Rr=Nt.createdAt)==null?void 0:Rr.seconds)||0;return At-yt}),be(dt),ne(dt)}catch(Xe){console.error(Xe),C(" No se pudo cargar el estado de cuenta")}finally{ze(!1)}},ne=Le=>{const Xe=Le.reduce((vt,Nt)=>vt+(Number(Nt.amount)||0),0),et=Le.filter(vt=>Number(vt.amount)<0).reduce((vt,Nt)=>vt+Math.abs(Number(Nt.amount)||0),0),dt=Le.filter(vt=>Number(vt.amount)>0).reduce((vt,Nt)=>vt+(Number(Nt.amount)||0),0);je({saldoActual:Xe,totalAbonado:et,totalCargos:dt})},ue=async()=>{if(!$e)return;C("");const Le=Number(ye||0);if(!(Le>0)){C("Ingresa un monto de abono mayor a 0.");return}const Xe=parseFloat(Le.toFixed(2));if(!_e){C("Selecciona la fecha del abono.");return}try{Ge(!0);const et={customerId:$e.id,type:"ABONO",amount:-Xe,date:_e,comment:Ce||"",createdAt:Vt.now()},vt={id:(await zr(ot(Re,"ar_movements"),et)).id,date:_e,type:"ABONO",amount:-Xe,comment:Ce||"",createdAt:Vt.now()},Nt=[...Ke,vt].sort((At,yt)=>{var Nr,Jr;if(At.date!==yt.date)return At.date.localeCompare(yt.date);const Zt=((Nr=At.createdAt)==null?void 0:Nr.seconds)||0,Rr=((Jr=yt.createdAt)==null?void 0:Jr.seconds)||0;return Zt-Rr});be(Nt),ne(Nt),Z(At=>At.map(yt=>yt.id===$e.id?{...yt,balance:(yt.balance||0)-Xe}:yt)),st(At=>At&&{...At,balance:(At.balance||0)-Xe}),Oe(0),Ze(""),he(new Date().toISOString().slice(0,10)),G(!1),C(" Abono registrado")}catch(et){console.error(et),C(" Error al registrar el abono")}finally{Ge(!1)}},ge=Le=>{wt(Le.id),xt(Le.date||new Date().toISOString().slice(0,10)),hr(Math.abs(Number(Le.amount||0))),gr(Le.comment||"")},Fe=()=>{wt(null),xt(""),hr(0),gr("")},De=async()=>{if(!at)return;const Le=Ke.findIndex(vt=>vt.id===at);if(Le===-1)return;const Xe=Ke[Le],et=Number(Lt||0);if(!(et>0)){C("El monto debe ser mayor a 0.");return}const dt=Xe.type==="ABONO"?-parseFloat(et.toFixed(2)):+parseFloat(et.toFixed(2));try{await Fr(Ft(Re,"ar_movements",at),{date:it,amount:dt,comment:lr||""});const vt=[...Ke];vt[Le]={...Xe,date:it,amount:dt,comment:lr||""},vt.sort((At,yt)=>{var Nr,Jr;if(At.date!==yt.date)return At.date.localeCompare(yt.date);const Zt=((Nr=At.createdAt)==null?void 0:Nr.seconds)||0,Rr=((Jr=yt.createdAt)==null?void 0:Jr.seconds)||0;return Zt-Rr}),be(vt),ne(vt);const Nt=vt.reduce((At,yt)=>At+(Number(yt.amount)||0),0);Z(At=>At.map(yt=>yt.id===($e==null?void 0:$e.id)?{...yt,balance:Nt}:yt)),st(At=>At&&{...At,balance:Nt}),Fe(),C(" Movimiento actualizado")}catch(vt){console.error(vt),C(" Error al actualizar movimiento")}},We=async Le=>{var et,dt;if(confirm(`Eliminar este movimiento (${Le.type==="ABONO"?"Abono":"Compra"}) del ${Le.date}?${Le.type==="CARGO"&&((et=Le.ref)!=null&&et.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`))try{if(Be(!0),Le.type==="CARGO"&&((dt=Le.ref)!=null&&dt.saleId)){try{await cx(Le.ref.saleId)}catch(At){console.warn("restoreSaleAndDeleteCandy error",At),Be(!1),C(" No se pudo devolver inventario de la venta.");return}await d3(Le.ref.saleId)}else await mn(Ft(Re,"ar_movements",Le.id));const vt=Ke.filter(At=>{var yt,Zt;return Le.type==="CARGO"&&((yt=Le.ref)!=null&&yt.saleId)?((Zt=At.ref)==null?void 0:Zt.saleId)!==Le.ref.saleId:At.id!==Le.id});be(vt),ne(vt);const Nt=vt.reduce((At,yt)=>At+(Number(yt.amount)||0),0);Z(At=>At.map(yt=>yt.id===($e==null?void 0:$e.id)?{...yt,balance:Nt}:yt)),st(At=>At&&{...At,balance:Nt}),C(" Movimiento eliminado")}catch(vt){console.error(vt),C(" Error al eliminar movimiento")}finally{Be(!1)}},rt=N.useMemo(()=>[...de].sort((Le,Xe)=>{var et,dt;return Le.status!==Xe.status?Le.status==="BLOQUEADO"?1:-1:(((et=Xe.createdAt)==null?void 0:et.seconds)||0)-(((dt=Le.createdAt)==null?void 0:dt.seconds)||0)}),[de]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Ye(!0),a&&me(s)},type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:xe?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):rt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):rt.map(Le=>{var et;const Xe=Q===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(et=Le.createdAt)!=null&&et.toDate?Le.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:Xe?i.jsx("input",{className:"w-full border p-1 rounded",value:D,onChange:dt=>z(dt.target.value)}):i.jsx("div",{className:"font-medium",children:Le.name})}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsx("input",{className:"w-full border p-1 rounded",value:O,onChange:dt=>te(Tv(dt.target.value))}):Le.phone}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:a?s:pe,onChange:dt=>Ee(dt.target.value),disabled:a,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),l.map(dt=>i.jsx("option",{value:dt.id,children:dt.name},dt.id))]}):Le.vendorName||""}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsxs("select",{className:"w-full border p-1 rounded",value:se,onChange:dt=>we(dt.target.value),children:[i.jsx("option",{value:"",children:""}),u3.map(dt=>i.jsx("option",{value:dt,children:dt},dt))]}):Le.place||""}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsxs("select",{className:"w-full border p-1 rounded",value:re,onChange:dt=>J(dt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Le.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Le.status})}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(K)?"":K,onChange:dt=>ie(Math.max(0,Number(dt.target.value||0)))}):lc(Le.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:lc(Le.balance||0)}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:q,onChange:dt=>Me(dt.target.value),maxLength:500}):i.jsx("span",{title:Le.notes||"",children:(Le.notes||"").length>40?(Le.notes||"").slice(0,40)+"":Le.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Xt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Dt,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Tt(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Kt(Le),disabled:!o,title:o?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>oe(Le),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},Le.id)})})]})}),I&&i.jsx("p",{className:"mt-2 text-sm",children:I}),xr&&wh.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ye(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ye(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Rt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:y,onChange:Le=>b(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:F,onChange:Le=>j(Tv(Le.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:R,onChange:Le=>E(Le.target.value),children:[i.jsx("option",{value:"",children:""}),u3.map(Le=>i.jsx("option",{value:Le,children:Le},Le))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:U,onChange:Le=>k(Le.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a?s:Y,onChange:Le=>me(Le.target.value),disabled:a,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),l.map(Le=>i.jsx("option",{value:Le.id,children:Le.name},Le.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:Le=>fe(Math.max(0,Number(Le.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor queda fijo (no cambia)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:T===0?"":T,onChange:Le=>L(Math.max(0,Number(Le.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:S,onChange:Le=>B(Le.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[S.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ye(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),Ue&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",($e==null?void 0:$e.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Oe(0),he(new Date().toISOString().slice(0,10)),Ze(""),G(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>qe(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(Number(($e==null?void 0:$e.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(le.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(le.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:lc(le.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Se?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):Ke.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):Ke.map(Le=>{var et,dt;const Xe=at===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Xe?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:it,onChange:vt=>xt(vt.target.value)}):Le.date||""}),i.jsx("td",{className:"p-2 border",children:Le.amount>=0?(et=Le.ref)!=null&&et.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>g(Le.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(dt=Le.ref)!=null&&dt.saleId?`Venta #${Le.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsx("input",{className:"w-full border p-1 rounded",value:lr,onChange:vt=>gr(vt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Le.comment||"",children:(Le.comment||"").length>40?(Le.comment||"").slice(0,40)+"":Le.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:Xe?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Lt)?"":Lt,onChange:vt=>{const Nt=Number(vt.target.value||0),At=Number.isFinite(Nt)?Math.max(0,parseFloat(Nt.toFixed(2))):0;hr(At)},placeholder:"0.00",title:Le.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):lc(Le.amount)}),i.jsx("td",{className:"p-2 border",children:Xe?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:De,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Fe,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>ge(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>We(Le),children:"Borrar"})]})})]},Le.id)})})]})})]})}),X&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",($e==null?void 0:$e.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:_e,onChange:Le=>he(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ye===0?"":ye,onChange:Le=>{const Xe=Number(Le.target.value||0),et=Number.isFinite(Xe)?Math.max(0,parseFloat(Xe.toFixed(2))):0;Oe(et)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ce,onChange:Le=>Ze(Le.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Ce.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>G(!1),disabled:Te,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:ue,disabled:Te,children:Te?"Guardando...":"Guardar abono"})]})]})}),A&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",h?` #${h}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>u(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:d?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):p.map((Le,Xe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Le.productName}),i.jsx("td",{className:"p-2 border text-right",children:Le.qty}),i.jsx("td",{className:"p-2 border text-right",children:lc(Le.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:lc(Le.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:lc(Le.total)})]},Xe))})]})})]})})]})}const Rd=t=>`C$ ${(Number(t)||0).toFixed(2)}`,J1e=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];function X1e(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function Y1e(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function Z1e(t){const{saleId:e,date:r,customerName:n,branch:s,items:a,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:A}=t,u=new rr;let d=12;if(u.setFontSize(14),u.text("Multiservicios Ortiz",10,d),d+=6,u.setFontSize(12),u.text("Recibo de venta certificada",10,d),d+=8,u.setFontSize(10),u.text(`Fecha: ${r}`,10,d),d+=5,u.text(`Cliente: ${n||"Cliente Mostrador"}`,10,d),d+=5,u.text(`Sucursal: ${X1e(s)}`,10,d),d+=5,u.text(`Autorizado: ${e}`,10,d),d+=5,l&&(u.text(`Vendedor: ${l}`,10,d),d+=5),typeof c=="number"){const f=Number(A||0).toFixed(2),h=c.toFixed(2);u.text(`Comisin vendedor: ${h}%  C$ ${f}`,10,d),d+=8}else d+=3;u.setFontSize(9),u.text("Producto",10,d),u.text("Paquetes",110,d,{align:"right"}),u.text("Precio.",150,d,{align:"right"}),u.text("Subtotal",190,d,{align:"right"}),d+=4,u.line(10,d,190,d),d+=4,a.forEach(f=>{d>270&&(u.addPage(),d=12);const h=(f.productName||"").length>50?f.productName.slice(0,47)+"...":f.productName;u.text(h,10,d),u.text(String(f.qty),110,d,{align:"right"}),u.text(`C$ ${Number(f.unitPrice||0).toFixed(2)}`,150,d,{align:"right"}),u.text(`C$ ${Number(f.total||0).toFixed(2)}`,190,d,{align:"right"}),d+=5}),d+=4,u.line(10,d,190,d),d+=6,u.setFontSize(11),u.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,d,{align:"right"}),d+=6,u.setFontSize(9),u.text("Gracias por su compra.",10,d),u.save(`venta_dulces_${e}.pdf`)}async function h3(t,e){if(!t||!e)return 0;const r=Ut(ot(Re,"inventory_candies_sellers"),qt("sellerId","==",e),qt("productId","==",t)),n=await bt(r);let s=0;return n.forEach(a=>{const o=a.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(s+=l)}),s}const f3=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function eve(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:s,saleId:a}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=Ut(ot(Re,"inventory_candies_sellers"),qt("sellerId","==",r),qt("productId","==",e),qt("remainingUnits",">",0),Hr("date","asc"),Hr("createdAt","asc")),A=await bt(c);for(const u of A.docs){if(o<=0)break;const d=u.data(),f=Number(d.remainingUnits||0);if(f<=0)continue;const h=Math.min(f,o),m=f-h,p=Math.max(1,Math.floor(Number(d.unitsPerPackage||1))),x=Math.floor(m/p);await Fr(u.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:u.id,productId:e,units:h,saleDate:s,saleId:a}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function m3(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function tve({role:t="",sellerCandyId:e="",currentUserEmail:r}){const[n,s]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState([]),[A,u]=N.useState({}),[d,f]=N.useState("CONTADO"),[h,m]=N.useState("RIVAS"),[p,x]=N.useState(""),[g,y]=N.useState(""),[b,F]=N.useState(f3()),[j,R]=N.useState(""),[E,S]=N.useState(!1),[B,U]=N.useState(""),[k,T]=N.useState([]),L=N.useMemo(()=>k.reduce((he,Ce)=>he+(Ce.qtyPackages||0),0),[k]),Y=N.useMemo(()=>k.reduce((he,Ce)=>he+(Ce.qtyPackages||0)*(Ce.unitsPerPackage||1),0),[k]),me=N.useMemo(()=>{const he=k.reduce((Ce,Ze)=>{const Te=(Number(Ze.pricePerPackage)||0)*(Ze.qtyPackages||0),Ge=Number(Ze.discount)||0,at=Math.max(0,Te-Ge);return Ce+at},0);return Math.floor(he*100)/100},[k]),[ae,fe]=N.useState(0),[de,Z]=N.useState(""),[xe,Be]=N.useState(!1),[I,C]=N.useState(!1),[Q,M]=N.useState(""),[D,z]=N.useState("+505 "),[O,te]=N.useState(""),[se,we]=N.useState(""),[q,Me]=N.useState("ACTIVO"),[re,J]=N.useState(0),[K,ie]=N.useState(""),pe=()=>{M(""),z("+505 "),te(""),we(""),Me("ACTIVO"),J(0)},Ee=N.useMemo(()=>n.find(he=>he.id===p),[n,p]),Ue=N.useMemo(()=>E&&j?n.filter(he=>(he.vendorId??he.sellerId??"")===j):n,[n,E,j]),qe=(Ee==null?void 0:Ee.balance)||0,$e=d==="CREDITO"?qe+Math.max(0,Number(me||0))-Math.max(0,Number(ae||0)):0,st=N.useMemo(()=>l.find(he=>he.id===j)||null,[l,j]),Se=(st==null?void 0:st.commissionPercent)||0,ze=N.useMemo(()=>{const he=Number(me||0),Ce=Number(Se||0),Ze=he*Ce/100;return Number(Ze.toFixed(2))},[me,Se]);N.useEffect(()=>{(async()=>{const he=Ut(ot(Re,"customers_candies"),Hr("createdAt","desc")),Ce=await bt(he),Ze=[];Ce.forEach(wt=>{const it=wt.data();Ze.push({id:wt.id,name:it.name??"",phone:it.phone??"+505 ",place:it.place??"",status:it.status??"ACTIVO",creditLimit:Number(it.creditLimit??0),balance:0,sellerId:it.sellerId??it.vendorId??"",vendorId:it.vendorId??it.sellerId??""})});for(const wt of Ze)try{const it=Ut(ot(Re,"ar_movements"),qt("customerId","==",wt.id)),xt=await bt(it);let Lt=0;xt.forEach(hr=>Lt+=Number(hr.data().amount||0)),wt.balance=Lt}catch{wt.balance=0}s(Ze);const Te=Ut(ot(Re,"products_candies"),Hr("createdAt","desc")),Ge=await bt(Te),at=[];Ge.forEach(wt=>{const it=wt.data();at.push({id:wt.id,name:it.name??"(sin nombre)",sku:it.sku??"",unitsPerPackage:Number(it.unitsPerPackage??1),priceRivas:Number(it.unitPriceRivas??0),priceSanJorge:Number(it.unitPriceSanJorge??0),priceIsla:Number(it.unitPriceIsla??0)})}),o(at);try{const wt=await bt(ot(Re,"sellers_candies")),it=[];wt.forEach(xt=>{const Lt=xt.data(),hr=Lt.branch||"Rivas",lr=Y1e(hr);it.push({id:xt.id,name:Lt.name??"(sin nombre)",branch:lr,branchLabel:hr,commissionPercent:Number(Lt.commissionPercent??0)})}),c(it)}catch(wt){console.error("Error cargando vendedores:",wt)}u({})})()},[]),N.useEffect(()=>{if(t==="vendedor_dulces"&&e){R(e),S(!0);try{localStorage.setItem("pos_vendorId",e),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(t==="admin"){S(!1);return}try{const he=localStorage.getItem("pos_vendorId")||"",Ce=localStorage.getItem("pos_role")||"";he&&R(he),Ce.toUpperCase()==="VENDEDOR"&&S(!0)}catch{}},[t,e]);const Ke=async he=>{if(!he){u({});return}const Ce=Ut(ot(Re,"inventory_candies_sellers"),qt("sellerId","==",he)),Ze=await bt(Ce),Te={};Ze.forEach(Ge=>{const at=Ge.data(),wt=at.productId||"";if(!wt)return;const it=Number(at.remainingUnits??at.remaining??at.totalUnits??0);it<=0||(Te[wt]=(Te[wt]||0)+it)}),u(Te),T(Ge=>{const at=[];for(const wt of Ge){const it=Te[wt.productId]??0;it>0&&at.push({...wt,availableUnits:it})}return at})};N.useEffect(()=>{if(!j){u({});return}const he=l.find(Ce=>Ce.id===j);he&&m(he.branch),Ke(j)},[j,l]),N.useEffect(()=>{T(he=>he.map(Ce=>{const Ze=a.find(Ge=>Ge.id===Ce.productId);if(!Ze)return Ce;const Te=h==="RIVAS"?Ze.priceRivas:h==="SAN_JORGE"?Ze.priceSanJorge:Ze.priceIsla;return{...Ce,pricePerPackage:Number(Te)||0}}))},[h,a]);async function be(he){const{productId:Ce,vendorId:Ze,branch:Te}=he;if(!Ce||!Ze)return 0;const Ge=Ut(ot(Re,"inventory_candies_sellers"),qt("sellerId","==",Ze),qt("productId","==",Ce)),at=await bt(Ge);if(at.empty)return 0;const wt=at.docs[0].data(),it=Number(wt.unitPriceVendor??0);if(it>0)return it;const xt=Number(Te==="RIVAS"?wt.unitPriceRivas??0:Te==="SAN_JORGE"?wt.unitPriceSanJorge??0:wt.unitPriceIsla??0);return Number(xt||0)}const le=async he=>{var wt;if(!he)return;if(!j){Z("Selecciona primero el vendedor para usar su inventario."),U("");return}if(k.some(it=>it.productId===he)){U("");return}const Ce=a.find(it=>it.id===he);if(!Ce){U("");return}const Ze=await h3(he,j),Te=((wt=l.find(it=>it.id===j))==null?void 0:wt.branch)??h,Ge=await be({productId:he,vendorId:j,branch:Te}),at={productId:he,productName:Ce.name||"",sku:Ce.sku||"",unitsPerPackage:Ce.unitsPerPackage||1,pricePerPackage:Number(Ge)||0,availableUnits:Number(Ze)||0,qtyPackages:0,discount:0};T(it=>[...it,at]),U("")},je=(he,Ce)=>{T(Ze=>Ze.map(Te=>{if(Te.productId!==he)return Te;if(Ce==="")return{...Te,qtyPackages:0};const Ge=Math.max(0,Math.floor(Number(Ce)));return{...Te,qtyPackages:Ge}}))},X=(he,Ce)=>{T(Ze=>Ze.map(Te=>{if(Te.productId!==he)return Te;if(Ce==="")return{...Te,discount:0};const Ge=Math.max(0,Math.floor(Number(Ce)));return{...Te,discount:Ge}}))},G=he=>T(Ce=>Ce.filter(Ze=>Ze.productId!==he)),ye=async()=>{if(!b)return"Selecciona la fecha.";if(!j)return"Selecciona el vendedor para esta venta.";if(k.length===0)return"Agrega al menos un producto.";const he=k.filter(Ce=>(Ce.qtyPackages||0)>0);if(he.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(me>0))return"El total debe ser mayor a cero.";if(d==="CONTADO"){if(!g.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!p)return"Selecciona un cliente (crdito).";if(ae<0)return"El pago inicial no puede ser negativo.";if(ae>me)return"El pago inicial no puede superar el total.";if((Ee==null?void 0:Ee.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Ce of he){const Ze=Ce.unitsPerPackage||1,Te=(Ce.qtyPackages||0)*Ze,Ge=await h3(Ce.productId,j),at=Math.floor(Ge/Ze);if(Te>Ge)return`Inventario insuficiente en el pedido del vendedor para "${Ce.productName}". Disponible: ${at} paquetes.`;const wt=(Number(Ce.pricePerPackage)||0)*(Ce.qtyPackages||0),it=Number(Ce.discount)||0;if(!Number.isInteger(it)||it<0)return`El descuento en "${Ce.productName}" debe ser entero y  0.`;if(it>wt)return`El descuento en "${Ce.productName}" no puede exceder C$ ${wt.toFixed(2)}.`}return null},Oe=async he=>{he.preventDefault(),Z("");const Ce=await ye();if(Ce){Z(" "+Ce);return}try{Be(!0);const Ze=k.filter(it=>(it.qtyPackages||0)>0).map(it=>{const xt=it.unitsPerPackage||1,Lt=it.qtyPackages||0,hr=Lt*xt,lr=(Number(it.pricePerPackage)||0)*(Lt||0),gr=Math.max(0,Math.floor(Number(it.discount)||0)),xr=Math.max(0,lr-gr);return{productId:it.productId,productName:it.productName,sku:it.sku||"",qty:hr,packages:Lt,unitsPerPackage:xt,branch:h,unitPricePackage:Number(it.pricePerPackage)||0,discount:gr,total:Math.floor(xr*100)/100}}),Te={type:d,branch:h,date:b,createdAt:Vt.now(),itemsTotal:Number(me)||0,total:Number(me)||0,quantity:Number(Y)||0,packagesTotal:Number(L)||0,items:Ze,vendorId:j},Ge=l.find(it=>it.id===j);Ge&&(Te.vendorName=Ge.name,Te.vendorBranch=Ge.branch,Te.vendorBranchLabel=Ge.branchLabel,Te.vendorCommissionPercent=Ge.commissionPercent||0,Te.vendorCommissionAmount=ze||0),d==="CONTADO"?Te.customerName=g.trim():(Te.customerId=p,Te.downPayment=Number(ae)||0);const at=await zr(ot(Re,"sales_candies"),Te);if(d==="CONTADO"){const it=(g||"").trim();if(it)try{await zr(ot(Re,"cash_customers"),{name:it,date:b,branch:h,vendorId:j,createdAt:Vt.now()})}catch(xt){console.warn("No se pudo guardar cash_customer:",xt)}}if(d==="CREDITO"&&p){const it={customerId:p,date:b,createdAt:Vt.now(),ref:{saleId:at.id}},xt=Number((Ee==null?void 0:Ee.balance)||0);if(await zr(ot(Re,"ar_movements"),{...it,type:"CARGO",amount:Number(me)||0}),Number(ae)>0&&await zr(ot(Re,"ar_movements"),{...it,type:"ABONO",amount:-Number(ae)}),xt===0)try{await Fr(Ft(Re,"customers_candies",p),{initialDebt:Number(me)||0,initialDebtDate:b})}catch(Lt){console.warn("No se pudo setear initialDebt:",Lt)}}const wt={};for(const it of Ze)if(it.qty>0){const{allocations:xt}=await eve({productId:it.productId,vendorId:j,quantityUnits:it.qty,saleDate:b,saleId:at.id});wt[it.productId]={productId:it.productId,vendorId:j,allocations:xt}}await Fr(Ft(Re,"sales_candies",at.id),{allocationsByItem:wt});try{const it=d==="CONTADO"?g.trim()||"Cliente Mostrador":(Ee==null?void 0:Ee.name)||"Cliente crdito";Z1e({saleId:at.id,date:b,customerName:it,branch:h,items:Ze.map(xt=>({productName:xt.productName,qty:xt.packages,unitPrice:xt.unitPricePackage,total:xt.total})),total:Number(me)||0,vendorName:Ge==null?void 0:Ge.name,vendorCommissionPercent:(Ge==null?void 0:Ge.commissionPercent)||0,vendorCommissionAmount:ze})}catch(it){console.error("Error generando voucher PDF:",it)}f("CONTADO"),x(""),y(""),F(f3()),T([]),fe(0),d==="CREDITO"&&p&&s(it=>it.map(xt=>xt.id===p?{...xt,balance:(xt.balance||0)+(Number(me)||0)-(Number(ae)||0)}:xt)),Z(" Venta de dulces registrada"),j?await Ke(j):u({})}catch(Ze){console.error(Ze),Z(" Error al guardar la venta de dulces")}finally{Be(!1)}},_e=N.useMemo(()=>a.filter(he=>{const Ce=A[he.id]||0,Ze=Math.max(1,Number(he.unitsPerPackage||1));return Math.floor(Ce/Ze)>0}).sort((he,Ce)=>(he.name||"").localeCompare(Ce.name||"")),[a,A]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Dulces)"}),i.jsxs("form",{onSubmit:Oe,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:d,onChange:he=>f(he.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),d==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:g,onChange:he=>y(he.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:p,onChange:he=>x(he.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),Ue.map(he=>i.jsxs("option",{value:he.status==="ACTIVO"?he.id:"",disabled:he.status==="BLOQUEADO",children:[he.name," | ",he.phone," | Saldo: ",Rd(he.balance||0)]},he.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>C(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Rd(qe)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:he=>fe(Math.max(0,Number(he.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Rd($e)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:b,onChange:he=>F(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:j,onChange:he=>{R(he.target.value),T([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.map(he=>i.jsxs("option",{value:he.id,children:[he.name,"  ",he.branchLabel,"  ",he.commissionPercent.toFixed(2),"%"," comisin"]},he.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:h==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:h==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:h==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:B,onChange:async he=>{const Ce=he.target.value;U(Ce),await le(Ce)},disabled:!j,children:[i.jsx("option",{value:"",children:j?"Selecciona un producto":"Selecciona un vendedor primero"}),_e.map(he=>{const Ce=k.some(at=>at.productId===he.id),Ze=A[he.id]||0,Te=Math.max(1,Number(he.unitsPerPackage||1)),Ge=Math.floor(Ze/Te);return Ge<=0?null:i.jsxs("option",{value:Ce?"":he.id,disabled:Ce,children:[he.name," ",he.sku?` ${he.sku}`:""," (disp: ",Ge," ","paq.)",Ce?" ":""]},he.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),k.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):k.map(he=>{const Ce=A[he.productId]??he.availableUnits??0,Ze=he.unitsPerPackage?Math.floor(Ce/he.unitsPerPackage):0,Te=Math.max(0,Ze-(he.qtyPackages||0)),Ge=(Number(he.pricePerPackage)||0)*(he.qtyPackages||0),at=Math.max(0,Ge-(Number(he.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[he.productName,he.sku?`  ${he.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Rd(he.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[Te," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(he.qtyPackages)||he.qtyPackages===0?"":he.qtyPackages,onChange:wt=>je(he.productId,wt.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de paquetes"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(he.discount)||he.discount===0?"":he.discount,onChange:wt=>X(he.productId,wt.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:Rd(at)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>G(he.productId),title:"Quitar producto",children:""})})]},he.productId)})]}),k.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:L})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Rd(me)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Rd(ze)," ",Se?`(${Se.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:xe,children:xe?"Guardando...":"Registrar venta"})})]}),de&&i.jsx("p",{className:"mt-2 text-sm",children:de}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:Q,onChange:he=>M(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:D,onChange:he=>z(m3(he.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:O,onChange:he=>te(he.target.value),children:[i.jsx("option",{value:"",children:""}),J1e.map(he=>i.jsx("option",{value:he,children:he},he))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:q,onChange:he=>Me(he.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:K,onChange:he=>ie(he.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.filter(he=>(he.status??"ACTIVO")==="ACTIVO").map(he=>i.jsxs("option",{value:he.id,children:[he.name,"  ",he.branchLabel]},he.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:re===0?"":re,onChange:he=>J(Math.max(0,Number(he.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:se,onChange:he=>we(he.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{pe(),C(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var Ze;const he=E?j||e:K;if(!he){Z("Selecciona el vendedor para asociar este cliente.");return}if(Z(""),!Q.trim()){Z("Ingresa el nombre del nuevo cliente.");return}const Ce=m3(D);try{const Te=await zr(ot(Re,"customers_candies"),{name:Q.trim(),phone:Ce,place:O||"",notes:se||"",status:q,creditLimit:Number(re||0),createdAt:Vt.now(),sellerId:he,vendorId:he,vendorName:((Ze=l.find(at=>at.id===he))==null?void 0:Ze.name)||""}),Ge={id:Te.id,name:Q.trim(),phone:Ce,place:O||"",status:q,creditLimit:Number(re||0),balance:0,sellerId:he};s(at=>[Ge,...at]),x(Te.id),pe(),C(!1),Z(" Cliente creado")}catch(Te){console.error(Te),Z(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),xe&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const p3=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],jv=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function rve(){const[t,e]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[r,n]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[s,a]=N.useState(or(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,j]=N.useState(""),[R,E]=N.useState(null),[S,B]=N.useState(""),[U,k]=N.useState(""),[T,L]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[de,Z]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const O=Ut(ot(Re,"expenses_candies"),Hr("date","desc")),te=await bt(O),se=[];te.forEach(we=>{const q=we.data();se.push({id:we.id,date:q.date||or(new Date,"yyyy-MM-dd"),category:q.category||"",description:q.description||"",amount:Number(q.amount||0),status:q.status||"PENDIENTE",notes:q.notes||"",createdAt:q.createdAt??Vt.now()})}),g(se)}catch(O){console.error(O),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const xe=N.useMemo(()=>x.filter(O=>!(t&&O.date<t||r&&O.date>r)),[x,t,r]),Be=N.useMemo(()=>{const O=xe.reduce((we,q)=>we+(q.amount||0),0),te=xe.filter(we=>we.status==="PAGADO").reduce((we,q)=>we+(q.amount||0),0),se=O-te;return{total:O,pagado:te,pendiente:se}},[xe]),I=()=>{a(or(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},C=async O=>{if(O.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!u||u<=0){j("Ingresa un monto vlido.");return}try{const te=await zr(ot(Re,"expenses_candies"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Vt.now()});g(se=>[{id:te.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Vt.now()},...se]),I(),j(" Gasto registrado")}catch(te){console.error(te),j(" Error al guardar gasto")}},Q=O=>{E(O.id),B(O.date),k(O.category||""),L(O.description||""),me(Number(O.amount||0)),fe(O.status||"PENDIENTE"),Z(O.notes||"")},M=()=>{E(null),B(""),k(""),L(""),me(0),fe("PENDIENTE"),Z("")},D=async()=>{if(R){if(!U){j("Selecciona una categora.");return}if(!T.trim()){j("Ingresa una descripcin.");return}if(!Y||Y<=0){j("Ingresa un monto vlido.");return}try{await Fr(Ft(Re,"expenses_candies",R),{date:S,category:U,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:de||""}),g(O=>O.map(te=>te.id===R?{...te,date:S,category:U,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:de||""}:te)),M(),j(" Gasto actualizado")}catch(O){console.error(O),j(" Error al actualizar gasto")}}},z=async O=>{confirm(`Eliminar el gasto "${O.description}"?`)&&(await mn(Ft(Re,"expenses_candies",O.id)),g(se=>se.filter(we=>we.id!==O.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:O=>e(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:O=>n(O.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",jv(Be.total)]}),i.jsxs("div",{children:["Pagado: ",jv(Be.pagado)]}),i.jsxs("div",{children:["Pendiente: ",jv(Be.pendiente)]})]})]}),i.jsxs("form",{onSubmit:C,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:O=>a(O.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:O=>l(O.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),p3.map(O=>i.jsx("option",{value:O,children:O},O))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:O=>A(O.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:O=>d(Math.max(0,Number(O.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:O=>h(O.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:O=>p(O.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):xe.slice().sort((O,te)=>O.date.localeCompare(te.date)).map(O=>{const te=R===O.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:se=>B(se.target.value)}):O.date}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("select",{className:"w-full border p-1 rounded",value:U,onChange:se=>k(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),p3.map(se=>i.jsx("option",{value:se,children:se},se))]}):O.category||""}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>L(se.target.value)}):i.jsx("span",{title:O.description,children:O.description.length>40?O.description.slice(0,40)+"":O.description})}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Y)?"":Y,onChange:se=>me(Math.max(0,Number(se.target.value||0)))}):jv(O.amount)}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>fe(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${O.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:O.status})}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:de,onChange:se=>Z(se.target.value),maxLength:500}):i.jsx("span",{title:O.notes||"",children:(O.notes||"").length>40?(O.notes||"").slice(0,40)+"":O.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:te?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:D,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:M,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Q(O),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>z(O),children:"Borrar"})]})})})]},O.id)})})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F})]})}const Bl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function nve(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):""}function sve(t,e){var a,o,l;const r=nve(t);if(!r)return null;let n=0,s=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((c,A)=>c+(Number(A.packages??A.qty??A.quantity??0)||0),0),s=Number(t.total??t.itemsTotal??0)||0):(n=Number(t.packagesTotal??t.quantity??((a=t.item)==null?void 0:a.packages)??((o=t.item)==null?void 0:o.qty)??0)||0,s=Number(t.total??((l=t.item)==null?void 0:l.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:s,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}async function ave(t){const e=Ut(ot(Re,"ar_movements"),qt("ref.saleId","==",t)),r=await bt(e);await Promise.all(r.docs.map(n=>mn(Ft(Re,"ar_movements",n.id))))}function ive({role:t="",sellerCandyId:e=""}){const r=t==="vendedor_dulces",n=t==="admin",s=n?8:7,[a,o]=N.useState(!1),[l,c]=N.useState(!1),[A,u]=N.useState(null),[d,f]=N.useState([]),h=async K=>{o(!0),c(!0),u(K),f([]);try{const ie=await za(Ft(Re,"sales_candies",K)),pe=ie.exists()?ie.data():null;if(!pe){f([]);return}const Ue=(Array.isArray(pe==null?void 0:pe.items)?pe.items:pe!=null&&pe.item?[pe.item]:[]).map(qe=>({productName:String(qe.productName||""),qty:Number(qe.packages??qe.qty??qe.quantity??0),unitPrice:Number(qe.unitPricePackage??qe.unitPrice??0),discount:Number(qe.discount||0),total:Number(qe.total??qe.lineFinal??0)}));f(Ue)}catch(ie){console.error(ie)}finally{c(!1)}},[m,p]=N.useState(or(new Date,"yyyy-MM-01")),[x,g]=N.useState(or(new Date,"yyyy-MM-dd")),[y,b]=N.useState([]),[F,j]=N.useState([]),[R,E]=N.useState([]),[S,B]=N.useState(!0),[U,k]=N.useState(""),[T,L]=N.useState(""),[Y,me]=N.useState(""),[ae,fe]=N.useState(null),de=15,[Z,xe]=N.useState(1),Be=N.useMemo(()=>{const K={};return y.forEach(ie=>K[ie.id]=ie.name),K},[y]),I=N.useMemo(()=>{const K={};return R.forEach(ie=>{K[ie.id]=ie}),K},[R]),C=K=>{const ie=Number(K.vendorCommissionAmount||0);if(ie>0)return ie;if(!K.vendorId)return 0;const pe=I[K.vendorId];if(!pe||!pe.commissionPercent)return 0;const Ee=(Number(K.total)||0)*(Number(pe.commissionPercent)||0)/100;return Number(Ee.toFixed(2))};N.useEffect(()=>{(async()=>{B(!0),k("");try{const K=await bt(ot(Re,"customers_candies")),ie=[];K.forEach($e=>ie.push({id:$e.id,name:$e.data().name||""})),b(ie);const pe=await bt(ot(Re,"sellers_candies")),Ee=[];pe.forEach($e=>{const st=$e.data();Ee.push({id:$e.id,name:st.name||"",commissionPercent:Number(st.commissionPercent||0)})}),E(Ee);const Ue=await bt(Ut(ot(Re,"sales_candies"),Hr("createdAt","desc"))),qe=[];Ue.forEach($e=>{const st=sve($e.data(),$e.id);st&&st.date>=m&&st.date<=x&&qe.push(st)}),j(qe.sort(($e,st)=>st.date.localeCompare($e.date))),xe(1)}catch(K){console.error(K),k(" Error cargando transacciones.")}finally{B(!1)}})()},[m,x]);const Q=N.useMemo(()=>F.filter(K=>!(r&&(!e||!K.vendorId||K.vendorId!==e)||T&&K.customerId!==T||Y&&K.type!==Y)),[F,T,Y,r,e]),M=N.useMemo(()=>{let K=0,ie=0,pe=0,Ee=0;for(const Ue of Q)Ue.type==="CONTADO"?(K+=Ue.quantity,pe+=Ue.total):(ie+=Ue.quantity,Ee+=Ue.total);return{packsCash:K,packsCredito:ie,montoCash:pe,montoCredito:Ee}},[Q]),D=Math.max(1,Math.ceil(Q.length/de)),z=N.useMemo(()=>{const K=(Z-1)*de;return Q.slice(K,K+de)},[Q,Z]),O=N.useMemo(()=>A&&F.find(K=>K.id===A)||null,[A,F]),te=async K=>{if(n&&(fe(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{B(!0),await cx(K.id),await ave(K.id),j(ie=>ie.filter(pe=>pe.id!==K.id)),k(" Venta eliminada")}catch(ie){console.error(ie),k(" No se pudo eliminar la venta.")}finally{B(!1)}},se=()=>{const K=`Ventas del dia  ${m} a ${x}`,ie=qe=>(qe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),pe=Q.map(qe=>{const $e=qe.customerName||(qe.customerId?Be[qe.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${qe.date}</td>
          <td>${ie($e)}</td>
          <td>${qe.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${qe.quantity}</td>
          <td style="text-align:right">${Bl(qe.total)}</td>
        </tr>`}).join(""),Ee=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${ie(K)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${ie(K)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${M.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${M.packsCredito}</div>
        <div><b>Monto Cash:</b> ${Bl(M.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Bl(M.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${pe||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Ue=window.open("","_blank");Ue&&(Ue.document.open(),Ue.document.write(Ee),Ue.document.close())},we=()=>xe(1),q=()=>xe(K=>Math.max(1,K-1)),Me=()=>xe(K=>Math.min(D,K+1)),re=()=>xe(D),J=()=>{const K=[];if(D<=7)for(let pe=1;pe<=D;pe++)K.push(pe);else{const pe=Math.max(1,Z-2),Ee=Math.min(D,Z+2);K.push(1),pe>2&&K.push(-1);for(let Ue=pe;Ue<=Ee;Ue++)Ue!==1&&Ue!==D&&K.push(Ue);Ee<D-1&&K.push(-2),K.push(D)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:we,disabled:Z===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:q,disabled:Z===1,children:" Anterior"}),K.map((pe,Ee)=>typeof pe=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${pe===Z?"bg-blue-600 text-white":""}`,onClick:()=>xe(pe),children:pe},Ee):i.jsx("span",{className:"px-2",children:""},Ee)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Me,disabled:Z===D,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:re,disabled:Z===D,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Z," de ",D,"  ",Q.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:K=>{p(K.target.value),xe(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:K=>{g(K.target.value),xe(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:T,onChange:K=>{L(K.target.value),xe(1)},children:[i.jsx("option",{value:"",children:"Todos"}),y.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:Y,onChange:K=>{me(K.target.value),xe(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:se,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:M.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:M.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Bl(M.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Bl(M.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),n&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:S?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Cargando"})}):z.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Sin transacciones en el rango."})}):z.map(K=>{const ie=K.customerName||(K.customerId?Be[K.customerId]:"")||"Nombre cliente",pe=C(K);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:K.date}),i.jsx("td",{className:"p-2 border",children:ie}),i.jsx("td",{className:"p-2 border",children:K.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>h(K.id),children:K.quantity})}),i.jsx("td",{className:"p-2 border",children:Bl(K.total)}),i.jsx("td",{className:"p-2 border",children:pe>0?Bl(pe):""}),i.jsx("td",{className:"p-2 border",children:K.vendorName||""}),n&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>fe(Ee=>Ee===K.id?null:K.id),title:"Acciones",children:""}),ae===K.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>te(K),children:"Eliminar"})})]})]},K.id)})})]}),J()]}),U&&i.jsx("p",{className:"mt-2 text-sm",children:U}),a&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",A?` #${A}`:""]}),O&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:C(O)>0?Bl(C(O)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>o(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):d.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):d.map((K,ie)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:K.productName}),i.jsx("td",{className:"p-2 border text-right",children:K.qty}),i.jsx("td",{className:"p-2 border text-right",children:Bl(K.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Bl(K.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Bl(K.total)})]},ie))})]})})]})})]})}const Zr=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function _p(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function ove(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,a=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/s:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(a||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}});if(t!=null&&t.item){const n=t.item,s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,a=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/s:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(a||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0)}]:[]}function lve(t,e){const r=_p(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,s=t.vendorName||t.sellerName||void 0,a=ove(t);let o=Number(t.total??t.itemsTotal??0)||a.reduce((l,c)=>{const A=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),u=Math.max(0,Number(c.discount||0)),d=Math.max(0,A-u);return l+d},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:a,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:s}}function cve(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,A)=>c.date.localeCompare(A.date));const a=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of a)for(const c of l.items||[]){const A=s[c.productId];if(!A)continue;let u=Number(c.qty||0);if(!(u<=0))for(const d of A.lots){if(u<=0)break;if(d.qtyLeft<=0)continue;const f=Math.min(d.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=f*d.cost),d.qtyLeft-=f,u-=f}}return o}async function Ave(t){const e=Ut(ot(Re,"ar_movements"),qt("ref.saleId","==",t)),r=await bt(e);await Promise.all(r.docs.map(n=>mn(Ft(Re,"ar_movements",n.id))))}function uve(){const{refreshKey:t,refresh:e}=Wl(),[r,n]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[s,a]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,A]=N.useState([]),[u,d]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState([]),[y,b]=N.useState(!0),[F,j]=N.useState(""),[R,E]=N.useState([]),[S,B]=N.useState({}),[U,k]=N.useState({}),[T,L]=N.useState(!1),[Y,me]=N.useState(null),[ae,fe]=N.useState([]),[de,Z]=N.useState(!1),[xe,Be]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[I,C]=N.useState(!1),[Q,M]=N.useState(""),[D,z]=N.useState([]),[O,te]=N.useState(!1),[se,we]=N.useState(!1),[q,Me]=N.useState(null);N.useEffect(()=>{(async()=>{try{const be=await bt(ot(Re,"sellers_candies")),le=[];be.forEach(je=>{const X=je.data();le.push({id:je.id,name:X.name||"",commissionPercent:Number(X.commissionPercent||0)})}),E(le)}catch(be){console.error("Error cargando sellers_candies",be)}})()},[]);const re=N.useMemo(()=>{const be={};return R.forEach(le=>{be[le.id]=le}),be},[R]);N.useEffect(()=>{(async()=>{b(!0),j("");try{const be=await bt(ot(Re,"sales_candies")),le=[],je=[];be.forEach(it=>{const xt=it.data(),Lt=lve(xt,it.id);Lt&&(Lt.date<=s&&le.push(Lt),Lt.date>=r&&Lt.date<=s&&je.push(Lt))}),A(le),l(je);const X=await bt(ot(Re,"inventory_candies")),G=[];X.forEach(it=>{const xt=it.data(),Lt=_p(xt);if(!Lt||Lt>s)return;const hr=Math.max(1,Math.floor(Number(xt.unitsPerPackage||1))),lr=Number(xt.totalUnits??xt.quantity??0),gr=Number(xt.packages??0),xr=Number(xt.remaining??0),Ye=Number(xt.remainingPackages??0),pt=gr>0?gr:lr>0?Math.floor(lr/hr):0,Rt=Ye>0?Ye:xr>0?Math.floor(xr/hr):0;G.push({id:it.id,productId:xt.productId,productName:xt.productName||"",date:Lt,quantity:Number(pt||0),remaining:Number(Rt||0),purchasePrice:Number(xt.providerPrice||xt.purchasePrice||0),unitsPerPackage:hr})}),d(G);const ye=await bt(ot(Re,"expenses_candies")),Oe=[];ye.forEach(it=>{const xt=it.data(),Lt=_p(xt);Lt&&Lt>=r&&Lt<=s&&Oe.push({id:it.id,date:Lt,category:xt.category||"",description:xt.description||"",amount:Number(xt.amount||0),status:xt.status||""})}),h(Oe);const _e=await bt(ot(Re,"ar_movements")),he=[],Ce={};_e.forEach(it=>{const xt=it.data(),Lt=_p(xt);if(!Lt)return;const hr=xt.customerId,lr=Number(xt.amount||0);hr&&(Ce[hr]=(Ce[hr]||0)+lr),xt.type==="ABONO"&&Lt>=r&&Lt<=s&&he.push({id:it.id,customerId:hr,type:"ABONO",amount:lr,date:Lt})}),p(he);const Ze=await bt(ot(Re,"customers_candies")),Te=[];Ze.forEach(it=>{const xt=it.data();Te.push({id:it.id,name:xt.name||"",balance:Ce[it.id]||0})}),g(Te);const Ge=await bt(ot(Re,"inventory_candies_sellers")),at={},wt={};Ge.forEach(it=>{const xt=it.data(),Lt=_p(xt);if(!Lt||Lt<r||Lt>s)return;const hr=xt.sellerId||xt.vendorId||"NO_VENDOR",lr=xt.productName||"",gr=xt.sku||"",xr=Math.max(1,Math.floor(Number(xt.unitsPerPackage||1))),Ye=Number(xt.totalUnits??0),pt=Number(xt.packages??0),Rt=Number(xt.remainingUnits??xt.remaining??0),Tt=Number(xt.remainingPackages??0),Dt=pt>0?pt:Ye>0?Math.floor(Ye/xr):0,Xt=Tt>0?Tt:Rt>0?Math.floor(Rt/xr):0,Kt=Number(xt.totalVendor??0),oe=Number(xt.gainVendor??0),ne=Dt,ue=ne>0?Kt/ne:0,ge=ne>0?oe/ne:0;if(at[hr]||(at[hr]={associated:[],remaining:[]}),Dt>0){const Fe=Dt,De=Fe*ue,We=De,rt=Fe*ge;at[hr].associated.push({saleId:it.id,date:Lt,productName:lr,sku:gr,qty:Fe,unitPrice:ue,lineTotal:De,discount:0,lineFinal:We,vendorCommissionAmount:rt,type:"ASSOCIATED"}),wt[hr]=(wt[hr]||0)+Fe}if(Xt>0){const Fe=Xt,De=Fe*ue,We=De,rt=Fe*ge;at[hr].remaining.push({saleId:it.id,date:Lt,productName:lr,sku:gr,qty:Fe,unitPrice:ue,lineTotal:De,discount:0,lineFinal:We,vendorCommissionAmount:rt,type:"REMAINING"})}}),B(at),k(wt)}catch(be){console.error(be),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,s,t]);const J=N.useCallback(be=>{if(be.vendorId&&re[be.vendorId])return re[be.vendorId];const le=(be.vendorName||"").trim().toLowerCase();if(le)return R.find(je=>(je.name||"").trim().toLowerCase()===le)},[re,R]),K=N.useCallback((be,le)=>{const je=Number(le.vendorCommissionAmount||0);if(je)return je;const X=J(be);if(!X||!X.commissionPercent)return 0;const G=Number(le.qty||0),ye=Number(le.unitPrice||0),Oe=G*ye,_e=Math.max(0,Number(le.discount||0)),he=Math.max(0,Oe-_e);if(!he)return 0;const Ce=Number(X.commissionPercent)||0;return he*Ce/100},[J]),ie=N.useMemo(()=>{try{return cve(u,c,r,s)}catch(be){return console.error(be),0}},[u,c,r,s]),pe=N.useMemo(()=>{const be=o.reduce((Te,Ge)=>Te+(Ge.total||0),0),le=f.reduce((Te,Ge)=>Te+(Ge.amount||0),0),je=be-ie,X=je-le,G=m.reduce((Te,Ge)=>Te+Math.abs(Ge.amount||0),0),ye=x.filter(Te=>(Te.balance||0)>0),Oe=ye.reduce((Te,Ge)=>Te+(Ge.balance||0),0);let _e=0,he=0,Ce=0,Ze=0;for(const Te of o){const Ge=(Te.items||[]).reduce((wt,it)=>wt+(Number(it.qty)||0),0),at=(Te.items||[]).reduce((wt,it)=>wt+K(Te,it),0);Te.type==="CONTADO"?(_e+=Ge,Ce+=at):(he+=Ge,Ze+=at)}return{ventasTotales:be,costoMercaderia:ie,gastosPeriodo:le,gananciaAntes:je,gananciaDespues:X,abonosRecibidos:G,saldosPendientes:Oe,clientesConSaldo:ye.length,paquetesCash:_e,paquetesCredito:he,comisionCash:Ce,comisionCredito:Ze}},[o,f,m,x,ie,K]),Ee=N.useMemo(()=>{const be={},le={};for(const je of o)if(!(je.type!=="CREDITO"||!je.customerId))for(const X of je.items||[]){const G=Number(X.qty||0),ye=Number(X.unitPrice||0),Oe=G*ye,_e=Math.max(0,Number(X.discount||0)),he=Math.max(0,Oe-_e);be[je.customerId]=(be[je.customerId]||0)+G,le[je.customerId]=(le[je.customerId]||0)+he}return x.filter(je=>(je.balance||0)>0).map(je=>({customerId:je.id,name:je.name,paquetesAsociados:be[je.id]||0,saldoTotal:le[je.id]||0,saldoPendiente:je.balance||0})).sort((je,X)=>X.saldoPendiente-je.saldoPendiente)},[x,o]),Ue=N.useMemo(()=>{const be={};return x.forEach(le=>be[le.id]=le.name),be},[x]),qe=N.useMemo(()=>[...o].sort((be,le)=>le.date.localeCompare(be.date)).map(be=>{var G;const le=(be.items||[]).reduce((ye,Oe)=>ye+(Number(Oe.qty)||0),0);let je="Cash";be.type==="CREDITO"&&be.customerId?je=Ue[be.customerId]||"":be.type==="CONTADO"&&(je=((G=be.customerName)==null?void 0:G.trim())||"Cash");const X=le>0?be.total/le:0;return{id:be.id,date:be.date,type:be.type==="CREDITO"?"Crdito":"Cash",customer:je,paquetes:le,total:Number(be.total||0),avgPrice:X}}),[o,Ue]),$e=N.useMemo(()=>{var le,je;const be=new Map;for(const X of o){const G=X.vendorId||"NO_VENDOR",ye=X.vendorName||((le=re[G])==null?void 0:le.name)||"Sin vendedor";be.has(G)||be.set(G,{vendorId:G,vendorName:ye,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const Oe=be.get(G);for(const _e of X.items||[]){const he=Number(_e.qty||0),Ce=Number(_e.unitPrice||0),Ze=he*Ce,Te=Math.max(0,Number(_e.discount||0)),Ge=Math.max(0,Ze-Te),at=K(X,_e);X.type==="CONTADO"?(Oe.paquetesVendidos+=he,Oe.totalVendido+=Ge,Oe.comisionCash+=at):(Oe.paquetesFiados+=he,Oe.totalFiado+=Ge,Oe.comisionCredito+=at)}}for(const[X,G]of Object.entries(U)){const ye=be.get(X),Oe=(ye==null?void 0:ye.vendorName)||((je=re[X])==null?void 0:je.name)||"Sin vendedor",_e=ye||{vendorId:X,vendorName:Oe,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};_e.paquetesAsociados=G,_e.paquetesRestantes=Math.max(G-_e.paquetesVendidos-_e.paquetesFiados,0),be.set(X,_e)}return Array.from(be.values()).sort((X,G)=>G.totalVendido+G.totalFiado-(X.totalVendido+X.totalFiado))},[o,U,re,K]),st=async be=>{L(!0),me({id:be.customerId,name:be.name}),fe([]),Z(!0),Be({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const le=[];let je=0,X=0,G=0;for(const he of o)if(!(he.type!=="CREDITO"||he.customerId!==be.customerId))for(const Ce of he.items||[]){const Ze=Number(Ce.qty||0),Te=Number(Ce.unitPrice||0),Ge=Ze*Te,at=Math.max(0,Number(Ce.discount||0)),wt=Math.max(0,Ge-at);le.push({saleId:he.id,date:he.date,productName:Ce.productName,sku:Ce.sku||"",qty:Ze,unitPrice:Te,lineTotal:Ge,discount:at,lineFinal:wt}),je+=Ge,X+=at,G+=wt}let ye=0;for(const he of m)he.customerId===be.customerId&&(ye+=Math.abs(he.amount||0));const Oe=x.find(he=>he.id===be.customerId),_e=(Oe==null?void 0:Oe.balance)||0;fe(le),Be({totalBruto:je,totalDescuento:X,totalFiado:G,saldoActual:_e,abonadoPeriodo:ye})}catch(le){console.error(le),j(" No se pudo cargar el detalle del cliente.")}finally{Z(!1)}},Se=(be,le,je)=>{C(!0);let X="";je==="ASSOCIATED"?X=`Paquetes asociados  ${le}`:je==="REMAINING"?X=`Paquetes restantes  ${le}`:je==="CASH"?X=`Paquetes vendidos (Cash)  ${le}`:X=`Paquetes fiados (Crdito)  ${le}`,M(X),z([]),te(!0);try{if(je==="ASSOCIATED"||je==="REMAINING"){const ye=S[be],Oe=je==="ASSOCIATED"?(ye==null?void 0:ye.associated)||[]:(ye==null?void 0:ye.remaining)||[];z([...Oe].sort((_e,he)=>_e.date.localeCompare(he.date))),te(!1);return}const G=[];for(const ye of o)if(((ye.vendorId||"NO_VENDOR")===be||!ye.vendorId&&be==="NO_VENDOR")&&!(je==="CASH"&&ye.type!=="CONTADO")&&!(je==="CREDIT"&&ye.type!=="CREDITO"))for(const _e of ye.items||[]){const he=Number(_e.qty||0),Ce=Number(_e.unitPrice||0),Ze=he*Ce,Te=Math.max(0,Number(_e.discount||0)),Ge=Math.max(0,Ze-Te),at=K(ye,_e);G.push({saleId:ye.id,date:ye.date,productName:_e.productName,sku:_e.sku||"",qty:he,unitPrice:Ce,lineTotal:Ze,discount:Te,lineFinal:Ge,vendorCommissionAmount:at,type:je})}z(G.sort((ye,Oe)=>ye.date.localeCompare(Oe.date)))}catch(G){console.error(G),j(" No se pudo cargar el detalle del vendedor.")}finally{te(!1)}},ze=be=>{const le=o.find(je=>je.id===be)||null;Me(le),we(!0)},Ke=async be=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await cx(be),await Ave(be),l(le=>le.filter(je=>je.id!==be)),A(le=>le.filter(je=>je.id!==be)),we(!1),Me(null)}catch(le){console.error(le),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(Fc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:be=>n(be.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:be=>a(be.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(pe.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(pe.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Zr(pe.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(pe.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Zr(pe.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(pe.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(pe.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:pe.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:pe.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:pe.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(pe.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(pe.comisionCredito)})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ee.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ee.map(be=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>st({customerId:be.customerId,name:be.name}),title:"Ver paquetes fiados del periodo",children:be.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:Zr(be.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:Zr(be.saldoPendiente)})]},be.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):$e.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):$e.map(be=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:be.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Se(be.vendorId,be.vendorName,"ASSOCIATED"),children:be.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Se(be.vendorId,be.vendorName,"REMAINING"),children:be.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Se(be.vendorId,be.vendorName,"CASH"),children:be.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(be.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(be.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Se(be.vendorId,be.vendorName,"CREDIT"),children:be.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(be.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(be.comisionCredito)})]},be.vendorId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):qe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):qe.map(be=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:be.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:be.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:be.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ze(be.id),children:be.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(be.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Zr(be.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>Ke(be.id),children:"Eliminar"})})]},be.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((be,le)=>be.date.localeCompare(le.date)).map(be=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be.date}),i.jsx("td",{className:"p-2 border",children:be.category||""}),i.jsx("td",{className:"p-2 border",children:be.description?i.jsx("span",{title:be.description,children:be.description.length>40?be.description.slice(0,40)+"":be.description}):""}),i.jsx("td",{className:"p-2 border",children:Zr(be.amount)}),i.jsx("td",{className:"p-2 border",children:be.status||""})]},be.id))})]})}),F&&i.jsx("p",{className:"mt-2 text-sm",children:F}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(Y==null?void 0:Y.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>L(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Zr(xe.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:de?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ae.sort((be,le)=>be.date.localeCompare(le.date)).map((be,le)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be.date}),i.jsx("td",{className:"p-2 border",children:be.productName}),i.jsx("td",{className:"p-2 border",children:be.sku||""}),i.jsx("td",{className:"p-2 border",children:be.qty}),i.jsx("td",{className:"p-2 border",children:Zr(be.unitPrice)}),i.jsx("td",{className:"p-2 border",children:Zr(be.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Zr(be.discount)}),i.jsx("td",{className:"p-2 border",children:Zr(be.lineFinal)})]},`${be.saleId}-${le}`))})]})})]})}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:Q}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>C(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:O?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):D.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):D.map((be,le)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be.date}),i.jsx("td",{className:"p-2 border",children:be.productName}),i.jsx("td",{className:"p-2 border",children:be.sku||""}),i.jsx("td",{className:"p-2 border",children:be.qty}),i.jsx("td",{className:"p-2 border",children:Zr(be.unitPrice)}),i.jsx("td",{className:"p-2 border",children:Zr(be.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Zr(be.discount)}),i.jsx("td",{className:"p-2 border",children:Zr(be.lineFinal)}),i.jsx("td",{className:"p-2 border",children:Zr(be.vendorCommissionAmount)})]},`${be.saleId}-${le}`))})]})})]})}),se&&q&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",q.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>we(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(q.items||[]).map((be,le)=>{const je=Number(be.qty||0),X=Number(be.unitPrice||0),G=je*X,ye=K(q,be);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be.productName}),i.jsx("td",{className:"p-2 border",children:be.sku||""}),i.jsx("td",{className:"p-2 border",children:je}),i.jsx("td",{className:"p-2 border",children:Zr(X)}),i.jsx("td",{className:"p-2 border",children:Zr(G)}),i.jsx("td",{className:"p-2 border",children:Zr(ye)})]},le)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),Zr(q.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>Ke(q.id),children:"Eliminar venta"})]})]})})]})}const g3=["Rivas","Isla Ometepe","San Jorge"];function dve(){const{refreshKey:t,refresh:e}=Wl(),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(!1),[u,d]=N.useState(""),[f,h]=N.useState("0"),[m,p]=N.useState("Rivas"),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,j]=N.useState("0"),[R,E]=N.useState("Rivas");N.useEffect(()=>{(async()=>{a(!0),l("");try{const Y=Ut(ot(Re,"sellers_candies"),Hr("name","asc")),me=await bt(Y),ae=[];me.forEach(fe=>{const de=fe.data();ae.push({id:fe.id,name:de.name||"",commissionPercent:Number(de.commissionPercent||0),branch:de.branch||"Rivas",createdAt:de.createdAt||Vt.now()})}),n(ae)}catch(Y){console.error(Y),l(" Error cargando vendedores.")}finally{a(!1)}})()},[t]);const S=()=>{d(""),h("0"),p("Rivas")},B=async Y=>{Y.preventDefault(),l("");const me=u.trim();if(!me){l("Ingresa el nombre y apellido del vendedor.");return}const ae=Number(f||0);if(ae<0){l("La comisin no puede ser negativa.");return}try{const fe={name:me,commissionPercent:ae,branch:m,createdAt:Vt.now()},de=await zr(ot(Re,"sellers_candies"),fe);n(Z=>[{id:de.id,...fe},...Z]),l(" Vendedor creado correctamente."),S(),A(!1)}catch(fe){console.error(fe),l(" Error al crear el vendedor.")}},U=Y=>{g(Y.id),b(Y.name),j(Y.commissionPercent.toString()),E(Y.branch)},k=()=>{g(null),b(""),j("0"),E("Rivas")},T=async()=>{if(!x)return;l("");const Y=y.trim();if(!Y){l("El nombre y apellido no pueden estar vacos.");return}const me=Number(F||0);if(me<0){l("La comisin no puede ser negativa.");return}try{await Fr(Ft(Re,"sellers_candies",x),{name:Y,commissionPercent:me,branch:R}),n(ae=>ae.map(fe=>fe.id===x?{...fe,name:Y,commissionPercent:me,branch:R}:fe)),l(" Vendedor actualizado."),k()}catch(ae){console.error(ae),l(" Error al actualizar el vendedor.")}},L=async Y=>{if(window.confirm(`Eliminar al vendedor "${Y.name}"? Esta accin no se puede deshacer.`))try{await mn(Ft(Re,"sellers_candies",Y.id)),n(ae=>ae.filter(fe=>fe.id!==Y.id)),l(" Vendedor eliminado.")}catch(ae){console.error(ae),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:e,loading:s}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>A(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:B,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:u,onChange:Y=>d(Y.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comisin (% sobre venta total)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:f,onChange:Y=>h(Y.target.value),placeholder:"Ej: 10"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje se usa para calcular la comisin del vendedor sobre el total de la venta (no es el margen del producto)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:Y=>p(Y.target.value),children:g3.map(Y=>i.jsx("option",{value:Y,children:Y},Y))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{S(),A(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Comisin (%)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(Y=>{const me=x===Y.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:me?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:ae=>b(ae.target.value)}):Y.name}),i.jsx("td",{className:"p-2 border",children:me?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:F,onChange:ae=>j(ae.target.value)}):`${Y.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:me?i.jsx("select",{className:"border p-1 rounded text-xs",value:R,onChange:ae=>E(ae.target.value),children:g3.map(ae=>i.jsx("option",{value:ae,children:ae},ae))}):Y.branch}),i.jsx("td",{className:"p-2 border",children:me?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:T,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:k,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>U(Y),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>L(Y),children:"Borrar"})]})})]},Y.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Qa=t=>Math.max(0,Math.floor(Number(t||0)));function hve(t){return Math.max(1,Qa(t.unitsPerPackage||1))}async function fve(t){const{orderId:e,productId:r}=t;let n=Qa(t.packagesToReturn);if(!e||!r||n<=0)return;const s=Ut(ot(Re,"inventory_candies"),qt("orderId","==",e),qt("productId","==",r),Hr("createdAt","asc")),a=await bt(s);if(a.empty)return;const o=a.docs.map(l=>l.ref);await Na(Re,async l=>{const c=await Promise.all(o.map(A=>l.get(A)));for(let A=0;A<o.length&&n>0;A++){const u=c[A];if(!u.exists())continue;const d=u.data(),f=hve(d),h=n*f,p=Qa(d.remaining??0)+h,x=Math.floor(p/f);l.update(o[A],{remaining:p,remainingPackages:x,packages:x,updatedAt:Vt.now()}),n=0}})}async function mve(t){const{orderId:e,productId:r}=t,n=Qa(t.packagesToReturn);if(!e||!r||n<=0)return;const s=Ft(Re,"candy_main_orders",e);await Na(Re,async a=>{const o=await a.get(s);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let A=!1;const u=c.map(d=>String((d==null?void 0:d.id)||"")!==String(r)?d:(A=!0,{...d,remainingPackages:Qa(d.remainingPackages)+n}));A&&a.update(s,{items:u,updatedAt:Vt.now()})})}function pve(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),s=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),a=Qa((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,Qa((r==null?void 0:r.unitsPerPackage)||1));!n||!s||a<=0||e.push({batchId:n,masterOrderId:s,units:a,unitsPerPackage:o})}return e}function x3(t,e){const r=Qa(t),n=Math.max(1,Qa(e));return Math.floor(r/n)}async function v3(t){if(!t)throw new Error("vendorInventoryId requerido");const e=Ft(Re,"inventory_candies_sellers",t),r=await za(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),s=String(n.productId||""),a=Qa(n.packages||n.remainingPackages||0),o=pve(n.masterAllocations||n.allocations||n.allocationsByBatch);if(!o.length){const c=String(n.orderId||"");if(!c)throw new Error("La orden del vendedor no tiene orderId");if(!s)throw new Error("La orden del vendedor no tiene productId");return a<=0?(await Na(Re,async A=>{A.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await fve({orderId:c,productId:s,packagesToReturn:a}),await mve({orderId:c,productId:s,packagesToReturn:a}),await Na(Re,async A=>{A.delete(e)}),{restoredPackages:a,mode:"legacy"})}let l=0;return await Na(Re,async c=>{const A={};for(const x of o){const g=Math.max(1,Qa(x.unitsPerPackage||1)),y=Qa(x.units),b=x3(y,g);b>0&&(A[x.masterOrderId]=(A[x.masterOrderId]||0)+b)}const u=o.map(x=>Ft(Re,"inventory_candies",x.batchId)),f=Object.keys(A).map(x=>Ft(Re,"candy_main_orders",x)),[h,m]=await Promise.all([Promise.all(u.map(x=>c.get(x))),Promise.all(f.map(x=>c.get(x)))]);let p=0;for(let x=0;x<o.length;x++){const g=o[x],y=h[x];if(!y.exists())continue;const b=y.data(),F=Math.max(1,Qa(g.unitsPerPackage||b.unitsPerPackage||1)),j=Qa(g.units),E=Qa(b.remaining??0)+j,S=Math.floor(E/F);c.update(u[x],{remaining:E,remainingPackages:S,packages:S,updatedAt:Vt.now()});const B=x3(j,F);B>0&&(p+=B)}for(let x=0;x<f.length;x++){const g=m[x];if(!g.exists())continue;const y=f[x].id,b=Qa(A[y]||0);if(b<=0)continue;const F=g.data(),j=Array.isArray(F.items)?F.items:[];let R=!1;const E=j.map(S=>String((S==null?void 0:S.id)||"")!==String(s)?S:(R=!0,{...S,remainingPackages:Qa(S.remainingPackages)+b}));R&&c.update(f[x],{items:E,updatedAt:Vt.now()})}c.delete(e),l=p}),{restoredPackages:l,mode:"blind"}}const Hn=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function gve(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const w3=t=>Math.max(0,Math.floor(Number(t||0)));function xve({role:t="",sellerCandyId:e="",currentUserEmail:r}){const{refreshKey:n,refresh:s}=Wl(),a=!t||t==="admin",o=t==="vendedor_dulces",l=(r||"").trim().toLowerCase(),c=!a&&o,[A,u]=N.useState([]),[d,f]=N.useState([]),[h,m]=N.useState({}),[p,x]=N.useState([]),[g,y]=N.useState(!0),[b,F]=N.useState(""),[j,R]=N.useState(!1),[E,S]=N.useState(null),[B,U]=N.useState([]),[k,T]=N.useState(""),[L,Y]=N.useState(""),[me,ae]=N.useState(""),[fe,de]=N.useState("0"),[Z,xe]=N.useState([]),[Be,I]=N.useState(!1),C=N.useMemo(()=>A.find(Se=>Se.id===k)||null,[k,A]),Q=C==null?void 0:C.branch,M=N.useMemo(()=>d.find(Se=>Se.id===me)||null,[me,d]),D=N.useMemo(()=>new Set(Z.map(Se=>Se.productId)),[Z]),z=N.useMemo(()=>d.filter(Se=>(h[Se.id]??0)>0||D.has(Se.id)).sort((Se,ze)=>Se.name.localeCompare(ze.name)),[d,h,D]),O=N.useMemo(()=>{const Se={};return A.forEach(ze=>Se[ze.id]=ze),Se},[A]),te=N.useMemo(()=>!o||!l?null:A.find(Se=>(Se.email||"").trim().toLowerCase()===l)||null,[o,l,A]);N.useEffect(()=>{(async()=>{y(!0),F("");try{const Se=await bt(Ut(ot(Re,"sellers_candies"),Hr("name","asc"))),ze=[];Se.forEach(Oe=>{const _e=Oe.data(),he=_e.branch||_e.branchLabel||_e.route||_e.sucursal||_e.location||"";ze.push({id:Oe.id,name:_e.name||"",email:_e.email||"",commissionPercent:Number(_e.commissionPercent||0),branch:gve(he),branchLabel:he})}),u(ze);const Ke=await bt(ot(Re,"inventory_candies")),be={},le={};Ke.forEach(Oe=>{var Lt;const _e=Oe.data(),he=String(_e.productId||"");if(!he)return;const Ce=Number(_e.remainingPackages);if(Number.isFinite(Ce))be[he]=(be[he]||0)+Math.max(0,Math.floor(Ce));else{const hr=Number(_e.remaining??_e.quantity??0),lr=Number(_e.unitsPerPackage||0);let gr=0;lr>0?gr=hr/lr:gr=Number(_e.packages||0),be[he]=(be[he]||0)+Math.max(0,gr)}const Ze=String(_e.date||""),Te=Number(((Lt=_e.createdAt)==null?void 0:Lt.seconds)??0),Ge={unitPriceRivas:Number(_e.unitPriceRivas||0),unitPriceSanJorge:Number(_e.unitPriceSanJorge||0),unitPriceIsla:Number(_e.unitPriceIsla||0),date:Ze,createdAtSec:Te};if(!(Ge.unitPriceRivas>0||Ge.unitPriceSanJorge>0||Ge.unitPriceIsla>0))return;const wt=le[he];if(!wt){le[he]=Ge;return}const it=`${wt.date}#${String(wt.createdAtSec).padStart(10,"0")}`;`${Ge.date}#${String(Ge.createdAtSec).padStart(10,"0")}`>it&&(le[he]=Ge)}),Object.keys(be).forEach(Oe=>be[Oe]=Math.floor(be[Oe])),m(be);const je=await bt(Ut(ot(Re,"products_candies"),Hr("name","asc"))),X=[];je.forEach(Oe=>{const _e=Oe.data(),he=Oe.id,Ce=le[he];X.push({id:he,name:_e.name||"",category:_e.category||"",providerPrice:Number(_e.providerPrice||0),packages:Number(_e.packages||0),unitsPerPackage:Number(_e.unitsPerPackage||0),unitPriceRivas:Number((Ce==null?void 0:Ce.unitPriceRivas)||0),unitPriceSanJorge:Number((Ce==null?void 0:Ce.unitPriceSanJorge)||0),unitPriceIsla:Number((Ce==null?void 0:Ce.unitPriceIsla)||0)})}),f(X);const G=await bt(o?Ut(ot(Re,"inventory_candies_sellers"),qt("sellerId","==",e),Hr("createdAt","desc")):Ut(ot(Re,"inventory_candies_sellers"),Hr("createdAt","desc"))),ye=[];G.forEach(Oe=>{const _e=Oe.data();ye.push({id:Oe.id,sellerId:_e.sellerId,sellerName:_e.sellerName||"",productId:_e.productId,productName:_e.productName||"",category:_e.category||"",orderId:_e.orderId||null,packages:Number(_e.packages||0),unitsPerPackage:Number(_e.unitsPerPackage||0),totalUnits:Number(_e.totalUnits||0),remainingPackages:Number(_e.remainingPackages||0),remainingUnits:Number(_e.remainingUnits||0),providerPrice:Number(_e.providerPrice||0),totalRivas:Number(_e.totalRivas||0),totalSanJorge:Number(_e.totalSanJorge||0),totalIsla:Number(_e.totalIsla||0),unitPriceRivas:Number(_e.unitPriceRivas||0),unitPriceSanJorge:Number(_e.unitPriceSanJorge||0),unitPriceIsla:Number(_e.unitPriceIsla||0),markupPercent:Number(_e.markupPercent||0),subtotal:Number(_e.subtotal||0),totalVendor:Number(_e.totalVendor||0),gainVendor:Number(_e.gainVendor||0),unitPriceVendor:Number(_e.unitPriceVendor||0),date:_e.date||"",createdAt:_e.createdAt||Vt.now()})}),x(ye)}catch(Se){console.error(Se),F(" Error cargando datos de vendedores / pedidos.")}finally{y(!1)}})()},[n]);const se=N.useMemo(()=>o&&te?p.filter(Se=>Se.sellerId===te.id):p,[p,o,te]),we=N.useMemo(()=>{var ze;const Se={};for(const Ke of se){const be=Ke.orderId||Ke.id,le=Se[be],je=Ke.date||((ze=Ke.createdAt)!=null&&ze.toDate?Ke.createdAt.toDate().toISOString().slice(0,10):"");le?(le.totalPackages+=Ke.packages,le.totalRemainingPackages+=Ke.remainingPackages,le.subtotal+=Ke.subtotal,le.totalVendor+=Ke.totalVendor,je>le.date&&(le.date=je)):Se[be]={orderKey:be,sellerId:Ke.sellerId,sellerName:Ke.sellerName,date:je,totalPackages:Ke.packages,totalRemainingPackages:Ke.remainingPackages,subtotal:Ke.subtotal,totalVendor:Ke.totalVendor}}return Object.values(Se).sort((Ke,be)=>be.date.localeCompare(Ke.date))},[se]),q=N.useMemo(()=>{const Se=Z.reduce((X,G)=>X+G.packages,0),ze=Z.reduce((X,G)=>X+G.subtotal,0),Ke=Z.reduce((X,G)=>X+G.totalVendor,0),be=Z.reduce((X,G)=>X+G.gainVendor,0),le=Number((C==null?void 0:C.commissionPercent)||0),je=Ke*le/100;return{totalPackages:Se,subtotal:ze,totalVendor:Ke,gainVendor:be,commissionPercent:le,commissionAmount:je}},[Z,C]),Me=()=>{S(null),U([]),T(""),Y(""),ae(""),de("0"),xe([])};function re(Se){const ze=Number(Se.providerPrice||0),Ke=Number(Se.packages||0),be=Number(Se.unitPriceRivas||0),le=Number(Se.unitPriceSanJorge||0),je=Number(Se.unitPriceIsla||0),X=ze*Ke,G=be*Ke,ye=le*Ke,Oe=je*Ke;let _e=be,he=G;switch(Se.sellerBranch){case"SAN_JORGE":_e=le,he=ye;break;case"ISLA":_e=je,he=Oe;break;case"RIVAS":default:_e=be,he=G;break}const Ce=he-X;return{subtotal:X,totalVendor:he,gainVendor:Ce,pricePerPackage:_e,totalRivas:G,totalSanJorge:ye,totalIsla:Oe,unitPriceRivas:be,unitPriceSanJorge:le,unitPriceIsla:je}}function J(Se,ze){const{subtotal:Ke,totalVendor:be,gainVendor:le,pricePerPackage:je,totalRivas:X,totalSanJorge:G,totalIsla:ye,unitPriceRivas:Oe,unitPriceSanJorge:_e,unitPriceIsla:he}=re({providerPrice:Se.providerPrice,unitPriceRivas:Se.unitPriceRivas,unitPriceSanJorge:Se.unitPriceSanJorge,unitPriceIsla:Se.unitPriceIsla,packages:ze,sellerBranch:Q});return{id:`${Se.id}-${Date.now()}-${Math.random()}`,productId:Se.id,productName:Se.name,category:Se.category,providerPrice:Se.providerPrice,unitsPerPackage:Se.unitsPerPackage,packages:ze,subtotal:Ke,totalVendor:be,gainVendor:le,pricePerPackage:je,totalRivas:X,totalSanJorge:G,totalIsla:ye,unitPriceRivas:Oe,unitPriceSanJorge:_e,unitPriceIsla:he,remainingPackages:ze}}const K=()=>{if(c)return;if(!M){F("Selecciona un producto antes de agregarlo.");return}if(D.has(M.id)){F("Ese producto ya est agregado en este pedido.");return}const Se=Number(fe||0);if(Se<=0){F("La cantidad de paquetes debe ser mayor a 0.");return}const ze=h[M.id]??0;if(!E&&Se>ze){F(`No hay suficientes paquetes en inventario general. Disponibles: ${ze}`);return}const Ke=J(M,Se);xe(be=>[...be,Ke]),ae(""),de("0")},ie=Se=>{c||xe(ze=>ze.filter(Ke=>Ke.id!==Se))},pe=(Se,ze)=>{if(c)return;const Ke=Number(ze||0);xe(be=>be.map(le=>{if(le.id!==Se)return le;const{subtotal:je,totalVendor:X,gainVendor:G,pricePerPackage:ye,totalRivas:Oe,totalSanJorge:_e,totalIsla:he}=re({providerPrice:le.providerPrice,unitPriceRivas:le.unitPriceRivas,unitPriceSanJorge:le.unitPriceSanJorge,unitPriceIsla:le.unitPriceIsla,packages:Ke,sellerBranch:Q});return{...le,packages:Ke,subtotal:je,totalVendor:X,gainVendor:G,pricePerPackage:ye,totalRivas:Oe,totalSanJorge:_e,totalIsla:he}}))};async function Ee(Se,ze,Ke){const be=await K1e({productId:Se,quantityPacks:ze,saleDate:Ke}),le=Array.isArray(be==null?void 0:be.allocations)?be.allocations:[];if(!le.length)return[];const je=le.map(ye=>String(ye.batchId||"")).filter(Boolean),X=await Promise.all(je.map(ye=>za(Ft(Re,"inventory_candies",ye)))),G=[];for(let ye=0;ye<le.length;ye++){const Oe=le[ye],_e=String(Oe.batchId||""),he=w3(Oe.qty||Oe.units||Oe.quantity||0),Ce=X[ye];if(!_e||he<=0||!Ce.exists())continue;const Ze=Ce.data(),Te=String(Ze.orderId||""),Ge=Math.max(1,w3(Ze.unitsPerPackage||1));Te&&G.push({batchId:_e,masterOrderId:Te,units:he,unitsPerPackage:Ge})}return G}const Ue=async Se=>{if(Se.preventDefault(),Be)return;if(!a){F("No tienes permiso para guardar pedidos.");return}if(F(""),!C){F("Selecciona un vendedor.");return}if(!Z.length){F("Agrega al menos un producto al pedido.");return}const ze=new Date().toISOString().slice(0,10),Ke=L||ze;try{if(y(!0),I(!0),E){const be={};B.forEach(X=>{be[X.productId]=X});const le={};Z.forEach(X=>{le[X.productId]=X});for(const X of Object.keys(le)){const G=le[X],ye=be[X],Oe=Number(G.packages||0),_e=ye?Number(ye.packages||0):0,he=Oe-_e;if(he>0){const Ce=await Ee(X,he,Ke);if(ye&&Ce.length){const Ze=Ft(Re,"inventory_candies_sellers",ye.id),Te=await za(Ze),Ge=Te.exists()?Te.data():{},wt=[...Array.isArray(Ge.masterAllocations)?Ge.masterAllocations:[],...Ce];await Fr(Ze,{masterAllocations:wt,updatedAt:Vt.now()})}}else he<0}let je=[...p];for(const X of Object.keys(le)){const G=le[X],ye=be[X],Oe=d.find(Ce=>Ce.id===X),_e=(Oe==null?void 0:Oe.unitsPerPackage)||G.unitsPerPackage||0,he=G.packages>0&&_e>0?G.packages*_e:0;if(ye)await Fr(Ft(Re,"inventory_candies_sellers",ye.id),{sellerId:C.id,sellerName:C.name,productId:X,productName:G.productName,category:G.category,packages:G.packages,unitsPerPackage:_e,totalUnits:he,remainingPackages:G.packages,remainingUnits:he,providerPrice:G.providerPrice,totalRivas:G.totalRivas,totalSanJorge:G.totalSanJorge,totalIsla:G.totalIsla,unitPriceRivas:G.unitPriceRivas,unitPriceSanJorge:G.unitPriceSanJorge,unitPriceIsla:G.unitPriceIsla,markupPercent:0,subtotal:G.subtotal,totalVendor:G.totalVendor,gainVendor:G.gainVendor,unitPriceVendor:G.pricePerPackage,date:Ke,orderId:ye.orderId||E,updatedAt:Vt.now()}),je=je.map(Ce=>Ce.id===ye.id?{...Ce,sellerId:C.id,sellerName:C.name,productId:X,productName:G.productName,category:G.category,packages:G.packages,unitsPerPackage:_e,totalUnits:he,remainingPackages:G.packages,remainingUnits:he,providerPrice:G.providerPrice,totalRivas:G.totalRivas,totalSanJorge:G.totalSanJorge,totalIsla:G.totalIsla,unitPriceRivas:G.unitPriceRivas,unitPriceSanJorge:G.unitPriceSanJorge,unitPriceIsla:G.unitPriceIsla,markupPercent:0,subtotal:G.subtotal,totalVendor:G.totalVendor,gainVendor:G.gainVendor,unitPriceVendor:G.pricePerPackage,date:Ke,orderId:ye.orderId||E}:Ce);else{const Ce=await Ee(X,G.packages,Ke),Ze={sellerId:C.id,sellerName:C.name,productId:X,productName:G.productName,category:G.category,orderId:E,packages:G.packages,unitsPerPackage:_e,totalUnits:he,remainingPackages:G.packages,remainingUnits:he,providerPrice:G.providerPrice,totalRivas:G.totalRivas,totalSanJorge:G.totalSanJorge,totalIsla:G.totalIsla,unitPriceRivas:G.unitPriceRivas,unitPriceSanJorge:G.unitPriceSanJorge,unitPriceIsla:G.unitPriceIsla,markupPercent:0,subtotal:G.subtotal,totalVendor:G.totalVendor,gainVendor:G.gainVendor,unitPriceVendor:G.pricePerPackage,date:Ke,createdAt:Vt.now(),status:"ASIGNADO",masterAllocations:Ce};je=[{id:(await zr(ot(Re,"inventory_candies_sellers"),Ze)).id,...Ze},...je]}}for(const X of Object.keys(be))if(!le[X]){const G=be[X];await v3(G.id),je=je.filter(ye=>ye.id!==G.id)}x(je),F(" Pedido actualizado para el vendedor y sincronizado con inventario principal.")}else{const be=`ORD-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;for(const le of Z){const je=d.find(_e=>_e.id===le.productId);if(!je)continue;const X=le.packages>0&&je.unitsPerPackage>0?le.packages*je.unitsPerPackage:0,G=await Ee(le.productId,le.packages,Ke),ye={sellerId:C.id,sellerName:C.name,productId:le.productId,productName:le.productName,category:le.category,orderId:be,packages:le.packages,unitsPerPackage:je.unitsPerPackage,totalUnits:X,remainingPackages:le.packages,remainingUnits:X,providerPrice:le.providerPrice,totalRivas:le.totalRivas,totalSanJorge:le.totalSanJorge,totalIsla:le.totalIsla,unitPriceRivas:le.unitPriceRivas,unitPriceSanJorge:le.unitPriceSanJorge,unitPriceIsla:le.unitPriceIsla,markupPercent:0,subtotal:le.subtotal,totalVendor:le.totalVendor,gainVendor:le.gainVendor,unitPriceVendor:le.pricePerPackage,date:Ke,createdAt:Vt.now(),status:"ASIGNADO",masterAllocations:G},Oe=await zr(ot(Re,"inventory_candies_sellers"),ye);x(_e=>[{id:Oe.id,...ye},..._e])}F(" Pedido asignado al vendedor y descontado del inventario.")}Me(),R(!1)}catch(be){console.error(be),F((be==null?void 0:be.message)||" Error al guardar el pedido del vendedor / ajustar inventario.")}finally{I(!1),y(!1)}},qe=()=>{if(!C){F("Selecciona un vendedor para imprimir el pedido.");return}if(!Z.length){F("No hay productos en el pedido para imprimir.");return}const Se=L||new Date().toISOString().slice(0,10),ze=X=>(X||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Ke="Pedido de dulces para vendedor",be=Z.map(X=>`
      <tr>
        <td>${ze(X.productName)}</td>
        <td class="right">${ze(X.category||"")}</td>
        <td class="right">${X.packages}</td>
        <td class="right">${Hn(X.providerPrice)}</td>
        <td class="right">${Hn(X.subtotal)}</td>
        <td class="right">${Hn(X.pricePerPackage)}</td>
        <td class="right">${Hn(X.totalVendor)}</td>
      </tr>`).join(""),le=`<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>${ze(Ke)}</title>
  <style>
    *{font-family: Arial, sans-serif; box-sizing:border-box;}
    body{margin:16px;font-size:13px;}
    h1{font-size:18px;margin:0 0 4px;}
    h2{font-size:14px;margin:12px 0 6px;}
    .muted{color:#555;font-size:11px;margin-bottom:10px;}
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 18px;margin:10px 0 14px;}
    .card{border:1px solid #ddd;border-radius:6px;padding:6px 8px;background:#fafafa;}
    .label{font-size:11px;color:#555;margin-bottom:2px;}
    .value{font-size:14px;font-weight:bold;}
    table{width:100%;border-collapse:collapse;margin-top:8px;font-size:12px;}
    th,td{border:1px solid #ddd;padding:4px 6px;}
    th{background:#f5f5f5;text-align:left;}
    .right{text-align:right;}
    @media print{
      @page{size:A5;margin:10mm;}
      body{margin:0;font-size:12px;}
    }
  </style>
</head>
<body>
  <h1>${ze(Ke)}</h1>
  <div class="muted">
    Fecha pedido: <b>${ze(Se)}</b><br/>
    Vendedor: <b>${ze(C.name)}</b>${C.commissionPercent?` &mdash; Comisin: <b>${C.commissionPercent.toFixed(2)}%</b>`:""}${C.branchLabel?`<br/>Ruta / sucursal: <b>${ze(C.branchLabel)}</b>`:""}
  </div>

  <div class="grid">
    <div class="card">
      <div class="label">Paquetes totales del pedido</div>
      <div class="value">${q.totalPackages}</div>
    </div>
    <div class="card">
      <div class="label">Subtotal costo (proveedor)</div>
      <div class="value">${Hn(q.subtotal)}</div>
    </div>
    <div class="card">
      <div class="label">Total vendedor (precio venta)</div>
      <div class="value">${Hn(q.totalVendor)}</div>
    </div>
    <div class="card">
      <div class="label">Comisin posible del vendedor</div>
      <div class="value">${Hn(q.commissionAmount)}</div>
    </div>
  </div>

  <h2>Detalle del pedido</h2>
  <table>
    <thead>
      <tr>
        <th>Producto</th>
        <th class="right">Categora</th>
        <th class="right">Paquetes</th>
        <th class="right">P. Proveedor (paq)</th>
        <th class="right">Subtotal</th>
        <th class="right">P. Paquete vendedor</th>
        <th class="right">Total vendedor</th>
      </tr>
    </thead>
    <tbody>
      ${be}
    </tbody>
  </table>

  <script>window.print()<\/script>
</body>
</html>`,je=window.open("","_blank");if(!je){alert("No se pudo abrir la ventana de impresin (revisa bloqueadores de pop-ups).");return}je.document.open(),je.document.write(le),je.document.close()},$e=Se=>{const ze=se.filter(le=>(le.orderId||le.id)===Se);if(!ze.length){F("No se encontraron filas para este pedido.");return}const Ke=ze[0];if(o&&te&&Ke.sellerId!==te.id){F("No tienes permiso para ver este pedido.");return}S(Se),U(ze),T(Ke.sellerId),Y(Ke.date);const be=ze.map(le=>{const je=le.unitPriceRivas||0,X=le.unitPriceSanJorge||0,G=le.unitPriceIsla||0,ye=le.totalRivas||je*Number(le.packages||0),Oe=le.totalSanJorge||X*Number(le.packages||0),_e=le.totalIsla||G*Number(le.packages||0);return{id:le.id,productId:le.productId,productName:le.productName,category:le.category,providerPrice:le.providerPrice,unitsPerPackage:le.unitsPerPackage,packages:le.packages,subtotal:le.subtotal,totalVendor:le.totalVendor,gainVendor:le.gainVendor,pricePerPackage:le.unitPriceVendor,totalRivas:ye,totalSanJorge:Oe,totalIsla:_e,unitPriceRivas:je,unitPriceSanJorge:X,unitPriceIsla:G,remainingPackages:le.remainingPackages}});xe(be),ae(""),de("0"),R(!0)},st=async Se=>{if(!a){F("No tienes permiso para borrar pedidos.");return}const ze=p.filter(le=>(le.orderId||le.id)===Se);if(!ze.length)return;const Ke=ze[0].sellerName||"";if(confirm(`Eliminar COMPLETAMENTE este pedido del vendedor "${Ke}"? Se regresarn los paquetes al inventario principal.`))try{y(!0);for(const le of ze)await v3(le.id);x(le=>le.filter(je=>(je.orderId||je.id)!==Se)),F(" Pedido eliminado y paquetes regresados correctamente.")}catch(le){console.error(le),F(" Error al eliminar el pedido / regresar paquetes.")}finally{y(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes de Rutas"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:s,loading:g}),a&&i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{Me(),R(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo pedido a vendedor"]})]})]}),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm relative",children:[Be&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando pedido..."})}),i.jsx("h3",{className:"text-xl font-bold mb-4",children:E?"Editar pedido de vendedor":"Nuevo pedido para vendedor"}),A.length===0&&i.jsx("p",{className:"text-sm text-red-600 mb-2",children:" No hay vendedores. Primero crea vendedores en la pantalla correspondiente."}),i.jsxs("form",{onSubmit:Ue,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:Se=>T(Se.target.value),disabled:c,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),A.map(Se=>i.jsxs("option",{value:Se.id,children:[Se.name,Se.branchLabel?` - ${Se.branchLabel}`:"",Se.commissionPercent?` (${Se.commissionPercent.toFixed(1)}% comisin)`:""]},Se.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:L,onChange:Se=>Y(Se.target.value),disabled:c})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:me,onChange:Se=>ae(Se.target.value),disabled:c,children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),z.map(Se=>{const ze=h[Se.id]??0,Ke=[];Ke.push(Se.category?`${Se.category} - ${Se.name}`:Se.name);const be=[];Se.unitPriceRivas>0&&be.push(`R: ${Hn(Se.unitPriceRivas)}`),Se.unitPriceSanJorge>0&&be.push(`SJ: ${Hn(Se.unitPriceSanJorge)}`),Se.unitPriceIsla>0&&be.push(`I: ${Hn(Se.unitPriceIsla)}`),be.length&&Ke.push(be.join(" | ")),Ke.push(`Disp: ${ze} paq`);const le=D.has(Se.id);return i.jsx("option",{value:Se.id,disabled:le,children:le?` (Agregado) ${Ke.join("  ")}`:Ke.join("  ")},Se.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes / bolsas"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:fe,onChange:Se=>de(Se.target.value),disabled:c})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:K,className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",disabled:c||!me||D.has(me),title:D.has(me)?"Ese producto ya est en el pedido":"",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Paq x Und (ref)"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),i.jsx("th",{className:"p-2 border",children:"P. paquete vendedor"}),i.jsx("th",{className:"p-2 border",children:"Total vendedor"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Z.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center text-gray-500",children:"No hay productos en este pedido. Agrega al menos uno."})}):Z.map(Se=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Se.productName}),i.jsx("td",{className:"p-2 border",children:Se.category}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",min:0,className:"border p-1 rounded text-right text-xs w-20",value:Se.packages,onChange:ze=>pe(Se.id,ze.target.value),disabled:c})}),i.jsx("td",{className:"p-2 border",children:Se.remainingPackages??Se.packages}),i.jsx("td",{className:"p-2 border",children:Se.unitsPerPackage||""}),i.jsx("td",{className:"p-2 border",children:Hn(Se.providerPrice)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.subtotal)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.totalRivas)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.totalSanJorge)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.totalIsla)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.unitPriceRivas)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.unitPriceSanJorge)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.unitPriceIsla)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.pricePerPackage)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.totalVendor)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs disabled:opacity-50",onClick:()=>ie(Se.id),disabled:c,children:"Quitar"})})]},Se.id))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales del pedido"}),i.jsx("div",{className:"text-lg font-semibold",children:q.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),i.jsx("div",{className:"text-lg font-semibold",children:Hn(q.subtotal)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total vendedor (precio venta)"}),i.jsx("div",{className:"text-lg font-semibold text-green-600",children:Hn(q.totalVendor)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin posible vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:Hn(q.commissionAmount)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a&&i.jsx("button",{type:"button",onClick:Me,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:Be,children:"Limpiar pedido"}),i.jsx("button",{type:"button",onClick:()=>{Me(),R(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:Be,children:"Cerrar"}),i.jsx("button",{type:"button",onClick:qe,className:"px-3 py-1 rounded bg-purple-600 text-white hover:bg-purple-700",disabled:!C||Z.length===0,children:"Imprimir pedido"}),a&&i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",disabled:Be||!C||Z.length===0,children:Be?"Guardando...":"Guardar pedido"})]})]})]})}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-4",children:[i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Listado de pedidos"}),i.jsxs("table",{className:"min-w-[1000px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal costo"}),i.jsx("th",{className:"p-2 border",children:"Total vendedor"}),i.jsx("th",{className:"p-2 border",children:"Comisin posible"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:g?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Cargando"})}):we.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Sin pedidos asignados a vendedores."})}):we.map(Se=>{const ze=O[Se.sellerId],Ke=Number((ze==null?void 0:ze.commissionPercent)||0),be=Se.totalVendor*Ke/100;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Se.date||""}),i.jsxs("td",{className:"p-2 border",children:[Se.sellerName,ze!=null&&ze.branchLabel?` - ${ze.branchLabel}`:""]}),i.jsx("td",{className:"p-2 border",children:Se.totalPackages}),i.jsx("td",{className:"p-2 border",children:Se.totalRemainingPackages}),i.jsx("td",{className:"p-2 border",children:Hn(Se.subtotal)}),i.jsx("td",{className:"p-2 border",children:Hn(Se.totalVendor)}),i.jsx("td",{className:"p-2 border",children:Hn(be)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>$e(Se.orderKey),children:"Ver / Editar"}),a&&i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>st(Se.orderKey),children:"Borrar"})]})})]},Se.orderKey)})})]})]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b})]})}function hC(t){return isFinite(t)?Math.round(t):0}function On(t){const e=Number(t);return Number.isFinite(e)?Math.floor(e):0}function c7(t){const e=Math.max(1,On(t.unitsPerPackage||1)),r=On(t.totalUnits||0),n=On(t.quantity||0),s=On(t.packages||0);return r>0?r:n>0?n:s>0?s*e:0}function vve(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):c7(t)}function y3(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,On(t.unitsPerPackage||1)),n=vve(t);return Math.max(0,Math.floor(n/r))}function wve(t){const e=Math.max(1,On(t.unitsPerPackage||1)),r=c7(t);return Math.max(0,Math.floor(r/e))}function yve(){const{refreshKey:t,refresh:e}=Wl(),[r,n]=N.useState(""),[s,a]=N.useState(!0),[o,l]=N.useState([]),[c,A]=N.useState(!1),[u,d]=N.useState([]),[f,h]=N.useState({}),[m,p]=N.useState(!1),[x,g]=N.useState(null),[y,b]=N.useState(""),[F,j]=N.useState(""),[R,E]=N.useState("20"),[S,B]=N.useState("15"),[U,k]=N.useState("30"),[T,L]=N.useState([]),[Y,me]=N.useState(""),[ae,fe]=N.useState(""),[de,Z]=N.useState(""),[xe,Be]=N.useState("1"),[I,C]=N.useState("0"),Q=N.useMemo(()=>{const K=new Set;for(const ie of o){const pe=String(ie.category||"").trim();pe&&K.add(pe)}return Array.from(K).sort((ie,pe)=>ie.localeCompare(pe,"es"))},[o]);N.useEffect(()=>{!Y&&Q.length>0&&me(Q[0])},[Q]);const M=(K,ie,pe)=>{const Ee=K*ie,Ue=Math.min(Math.max(pe.marginR,0),99.9)/100,qe=Math.min(Math.max(pe.marginSJ,0),99.9)/100,$e=Math.min(Math.max(pe.marginIsla,0),99.9)/100,st=ie>0&&Ue<1?Ee/(1-Ue):Ee,Se=ie>0&&qe<1?Ee/(1-qe):Ee,ze=ie>0&&$e<1?Ee/(1-$e):Ee,Ke=st-Ee,be=Se-Ee,le=ze-Ee,je=ie>0?hC(st/ie):0,X=ie>0?hC(Se/ie):0,G=ie>0?hC(ze/ie):0;return{subtotal:Ee,totalRivas:st,totalSanJorge:Se,totalIsla:ze,gainRivas:Ke,gainSanJorge:be,gainIsla:le,unitPriceRivas:je,unitPriceSanJorge:X,unitPriceIsla:G}},D=()=>{g(null),b(""),j(""),L([]),me(Q[0]||""),fe(""),Z(""),C("0"),Be("1"),E("20"),B("15"),k("30")},z=async()=>{A(!0);try{const K=await bt(Ut(ot(Re,"products_candies"),Hr("createdAt","desc"))),ie=[];K.forEach(pe=>{const Ee=pe.data();ie.push({id:pe.id,name:String(Ee.name??"").trim(),category:String(Ee.category??"").trim()||"Caramelo",providerPrice:Number(Ee.providerPrice??0),unitsPerPackage:Number(Ee.unitsPerPackage??1)})}),l(ie)}catch(K){console.error(K),n(" Error cargando catlogo de dulces.")}finally{A(!1)}};N.useEffect(()=>{z()},[t]);const O=N.useMemo(()=>(Y.trim().length>0?o.filter(ie=>ie.category===Y):o).sort((ie,pe)=>ie.name.localeCompare(pe.name,"es")),[o,Y]);N.useEffect(()=>{if(!ae){Z(""),Be("1");return}const K=o.find(ie=>ie.id===ae);K&&(Z(String(K.providerPrice??0)),Be(String(K.unitsPerPackage??1)))},[ae,o]);const te=()=>{if(n(""),!ae){n("Selecciona un producto del catlogo.");return}const K=o.find(Se=>Se.id===ae);if(!K){n("Producto de catlogo no encontrado (refresca).");return}const ie=Number(K.providerPrice||0),pe=On(I||0),Ee=On(K.unitsPerPackage||0);if(ie<0){n("El precio proveedor no puede ser negativo.");return}if(pe<=0){n("Los paquetes del pedido general deben ser mayor que 0.");return}if(Ee<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const Ue=Number(R||0),qe=Number(S||0),$e=Number(U||0);if(T.find(Se=>Se.id===K.id))L(Se=>Se.map(ze=>{if(ze.id!==K.id)return ze;const Ke=On(ze.packages||0)+pe,be=M(ie,Ke,{marginR:Number(ze.marginRivas||Ue),marginSJ:Number(ze.marginSanJorge||qe),marginIsla:Number(ze.marginIsla||$e)});return{...ze,providerPrice:ie,unitsPerPackage:Ee,packages:Ke,remainingPackages:On(ze.remainingPackages??ze.packages)+pe,...be}}));else{const Se=M(ie,pe,{marginR:Ue,marginSJ:qe,marginIsla:$e}),ze={id:K.id,name:K.name,category:K.category,providerPrice:ie,packages:pe,unitsPerPackage:Ee,marginRivas:Ue,marginSanJorge:qe,marginIsla:$e,subtotal:Se.subtotal,totalRivas:Se.totalRivas,totalSanJorge:Se.totalSanJorge,totalIsla:Se.totalIsla,gainRivas:Se.gainRivas,gainSanJorge:Se.gainSanJorge,gainIsla:Se.gainIsla,unitPriceRivas:Se.unitPriceRivas,unitPriceSanJorge:Se.unitPriceSanJorge,unitPriceIsla:Se.unitPriceIsla,remainingPackages:pe};L(Ke=>[...Ke,ze])}fe(""),C("0")},se=K=>{L(ie=>ie.filter(pe=>pe.id!==K))},we=N.useMemo(()=>{const K=T.reduce((qe,$e)=>qe+On($e.packages),0),ie=T.reduce((qe,$e)=>qe+Number($e.subtotal||0),0),pe=T.reduce((qe,$e)=>qe+Number($e.totalRivas||0),0),Ee=T.reduce((qe,$e)=>qe+Number($e.totalSanJorge||0),0),Ue=T.reduce((qe,$e)=>qe+Number($e.totalIsla||0),0);return{totalPackages:K,subtotal:ie,totalRivas:pe,totalSanJorge:Ee,totalIsla:Ue}},[T]),q=(K,ie,pe)=>{L(Ee=>Ee.map(Ue=>{if(Ue.id!==K)return Ue;let qe={...Ue};if(ie==="packages"&&(qe.packages=On(pe||0)),ie==="unitsPerPackage"&&(qe.unitsPerPackage=On(pe||0)),ie==="marginRivas"&&(qe.marginRivas=Number(pe||0)),ie==="marginSanJorge"&&(qe.marginSanJorge=Number(pe||0)),ie==="marginIsla"&&(qe.marginIsla=Number(pe||0)),ie==="packages"||ie==="marginRivas"||ie==="marginSanJorge"||ie==="marginIsla"){const $e=M(qe.providerPrice,qe.packages,{marginR:Number(qe.marginRivas||0),marginSJ:Number(qe.marginSanJorge||0),marginIsla:Number(qe.marginIsla||0)});qe={...qe,...$e}}return qe}))};N.useEffect(()=>{(async()=>{a(!0);try{const K=Ut(ot(Re,"candy_main_orders"),Hr("createdAt","desc")),ie=await bt(K),pe=[];ie.forEach(qe=>{const $e=qe.data();pe.push({id:qe.id,name:$e.name??"",date:$e.date??"",totalPackages:Number($e.totalPackages??0),subtotal:Number($e.subtotal??0),totalRivas:Number($e.totalRivas??0),totalSanJorge:Number($e.totalSanJorge??0),totalIsla:Number($e.totalIsla??0),marginRivas:Number($e.marginRivas??20),marginSanJorge:Number($e.marginSanJorge??15),marginIsla:Number($e.marginIsla??30),createdAt:$e.createdAt??Vt.now()})}),d(pe);const Ee=await bt(ot(Re,"inventory_candies")),Ue={};Ee.forEach(qe=>{const $e=qe.data(),st=$e.orderId;if(!st)return;const Se=wve($e),ze=y3($e);Ue[st]||(Ue[st]={orderId:st,totalPackages:0,remainingPackages:0}),Ue[st].totalPackages+=Se,Ue[st].remainingPackages+=ze}),h(Ue)}catch(K){console.error(K),n(" Error cargando pedidos generales.")}finally{a(!1)}})()},[t]);const Me=async K=>{if(K.preventDefault(),n(""),!T.length){n("Agrega al menos un producto al pedido general.");return}try{const ie=new Date().toISOString().slice(0,10),pe=F||ie,Ee=we,Ue=Number(R||0),qe=Number(S||0),$e=Number(U||0);for(const Se of T){if(!Se.name.trim()){n("Hay un producto sin nombre en el pedido.");return}if(Se.providerPrice<0){n(`El precio proveedor no puede ser negativo (producto: ${Se.name}).`);return}if(Se.packages<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${Se.name}).`);return}if(Se.unitsPerPackage<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${Se.name}).`);return}}const st={name:y||`Pedido ${pe}`,date:pe,totalPackages:Ee.totalPackages,subtotal:Ee.subtotal,totalRivas:Ee.totalRivas,totalSanJorge:Ee.totalSanJorge,totalIsla:Ee.totalIsla,marginRivas:Ue,marginSanJorge:qe,marginIsla:$e,items:T};if(x){await Fr(Ft(Re,"candy_main_orders",x),{...st});for(const Ke of T){const be=await bt(Ut(ot(Re,"inventory_candies"),qt("orderId","==",x),qt("productId","==",Ke.id))),le=On(Ke.packages)*On(Ke.unitsPerPackage),je=Math.max(1,On(Ke.unitsPerPackage||1));if(be.empty)await zr(ot(Re,"inventory_candies"),{productId:Ke.id,productName:Ke.name,category:Ke.category,measurement:"unidad",quantity:le,remaining:le,packages:On(Ke.packages),remainingPackages:On(Ke.packages),unitsPerPackage:je,totalUnits:le,providerPrice:Ke.providerPrice,subtotal:Ke.subtotal,totalRivas:Ke.totalRivas,totalSanJorge:Ke.totalSanJorge,totalIsla:Ke.totalIsla,gainRivas:Ke.gainRivas,gainSanJorge:Ke.gainSanJorge,gainIsla:Ke.gainIsla,unitPriceRivas:Ke.unitPriceRivas,unitPriceSanJorge:Ke.unitPriceSanJorge,unitPriceIsla:Ke.unitPriceIsla,date:pe,createdAt:Vt.now(),status:"PENDIENTE",orderId:x});else for(const X of be.docs){const G=X.data(),ye=On(G.totalUnits??0),Oe=On(G.remaining??ye),_e=le-ye,he=Math.max(0,Oe+_e),Ce=Math.max(0,Math.floor(he/je));await Fr(Ft(Re,"inventory_candies",X.id),{productName:Ke.name,category:Ke.category,unitsPerPackage:je,totalUnits:le,quantity:le,remaining:he,packages:On(Ke.packages),remainingPackages:Ce,providerPrice:Ke.providerPrice,subtotal:Ke.subtotal,totalRivas:Ke.totalRivas,totalSanJorge:Ke.totalSanJorge,totalIsla:Ke.totalIsla,gainRivas:Ke.gainRivas,gainSanJorge:Ke.gainSanJorge,gainIsla:Ke.gainIsla,unitPriceRivas:Ke.unitPriceRivas,unitPriceSanJorge:Ke.unitPriceSanJorge,unitPriceIsla:Ke.unitPriceIsla,date:pe})}}const Se=await bt(Ut(ot(Re,"inventory_candies"),qt("orderId","==",x))),ze=new Set(T.map(Ke=>Ke.id));for(const Ke of Se.docs){const be=Ke.data(),le=String(be.productId||"");le&&!ze.has(le)&&await mn(Ft(Re,"inventory_candies",Ke.id))}d(Ke=>Ke.map(be=>be.id===x?{...be,name:st.name,date:st.date,totalPackages:st.totalPackages,subtotal:st.subtotal,totalRivas:st.totalRivas,totalSanJorge:st.totalSanJorge,totalIsla:st.totalIsla,marginRivas:st.marginRivas,marginSanJorge:st.marginSanJorge,marginIsla:st.marginIsla}:be)),n(" Orden maestra actualizada (pedido + inventario).")}else{const ze=(await zr(ot(Re,"candy_main_orders"),{...st,createdAt:Vt.now()})).id,Ke=Gh(Re);for(const be of T){const le=Math.max(1,On(be.unitsPerPackage||1)),je=On(be.packages)*le,X=Ft(ot(Re,"inventory_candies"));Ke.set(X,{productId:be.id,productName:be.name,category:be.category,measurement:"unidad",quantity:je,remaining:je,packages:On(be.packages),remainingPackages:On(be.packages),unitsPerPackage:le,totalUnits:je,providerPrice:be.providerPrice,subtotal:be.subtotal,totalRivas:be.totalRivas,totalSanJorge:be.totalSanJorge,totalIsla:be.totalIsla,gainRivas:be.gainRivas,gainSanJorge:be.gainSanJorge,gainIsla:be.gainIsla,unitPriceRivas:be.unitPriceRivas,unitPriceSanJorge:be.unitPriceSanJorge,unitPriceIsla:be.unitPriceIsla,date:pe,createdAt:Vt.now(),status:"PENDIENTE",orderId:ze})}await Ke.commit(),n(" Orden maestra creada y registrada en inventario.")}D(),p(!1),e()}catch(ie){console.error(ie),n(" Error al guardar orden maestra.")}},re=async K=>{try{a(!0),n(""),g(K.id),b(K.name),j(K.date),E(String(K.marginRivas??20)),B(String(K.marginSanJorge??15)),k(String(K.marginIsla??30));const ie=Ft(Re,"candy_main_orders",K.id),pe=await za(ie);if(!pe.exists()){n(" No se encontr la orden.");return}const Ee=pe.data(),Ue=Array.isArray(Ee.items)?Ee.items:[],qe=await bt(Ut(ot(Re,"inventory_candies"),qt("orderId","==",K.id))),$e={};qe.forEach(Se=>{const ze=Se.data(),Ke=String(ze.productId||"");if(!Ke)return;const be=y3(ze);$e[Ke]=($e[Ke]||0)+be});const st=Ue.map(Se=>{const ze=o.find(je=>je.id===Se.id),Ke=Number((ze==null?void 0:ze.providerPrice)??Se.providerPrice??0),be=Math.max(1,On((ze==null?void 0:ze.unitsPerPackage)??Se.unitsPerPackage??1)),le=M(Ke,On(Se.packages||0),{marginR:Number(Se.marginRivas||0),marginSJ:Number(Se.marginSanJorge||0),marginIsla:Number(Se.marginIsla||0)});return{...Se,name:String((ze==null?void 0:ze.name)??Se.name??""),category:String((ze==null?void 0:ze.category)??Se.category??"Caramelo"),providerPrice:Ke,unitsPerPackage:be,remainingPackages:$e[Se.id]??Se.remainingPackages??Se.packages??0,...le}});L(st),p(!0)}catch(ie){console.error(ie),n(" Error al abrir orden maestra.")}finally{a(!1)}},J=async K=>{if(confirm(`Eliminar la orden "${K.name}" y todo su inventario asociado?`)){n("");try{const pe=await bt(Ut(ot(Re,"inventory_candies"),qt("orderId","==",K.id)));for(const Ee of pe.docs)await mn(Ft(Re,"inventory_candies",Ee.id));await mn(Ft(Re,"candy_main_orders",K.id)),d(Ee=>Ee.filter(Ue=>Ue.id!==K.id)),n(" Orden maestra eliminada."),e()}catch(pe){console.error(pe),n(" Error al eliminar orden maestra.")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Fc,{onClick:e,loading:s||c}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700",onClick:()=>{D(),p(!0)},children:[i.jsx("span",{className:"inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nueva Orden"]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:x?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("form",{onSubmit:Me,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:y,onChange:K=>b(K.target.value),placeholder:"Ej: Pedido diciembre 01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:F,onChange:K=>j(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:R,onChange:K=>E(K.target.value),disabled:!!x})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia San Jorge"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:S,onChange:K=>B(K.target.value),disabled:!!x})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:U,onChange:K=>k(K.target.value),disabled:!!x})]})]}),!x&&i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:Y,onChange:K=>{me(K.target.value),fe("")},disabled:c,children:Q.length===0?i.jsx("option",{value:"",children:c?"Cargando...":"No hay categoras en catlogo"}):Q.map(K=>i.jsx("option",{value:K,children:K},K))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:K=>fe(K.target.value),children:[i.jsx("option",{value:"",children:c?"Cargando catlogo...":"Selecciona producto"}),O.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:de,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:I,onChange:K=>C(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:xe,readOnly:!0})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:te,className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),!x&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:x?16:17,className:"p-4 text-center text-gray-500",children:"No hay productos en esta orden."})}):T.map(K=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:K.name}),i.jsx("td",{className:"p-2 border",children:K.category}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-24 border p-1 rounded text-right",value:K.packages,onChange:ie=>q(K.id,"packages",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:K.remainingPackages??K.packages}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:K.unitsPerPackage,onChange:ie=>q(K.id,"unitsPerPackage",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:Number(K.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:K.marginRivas??0,onChange:ie=>q(K.id,"marginRivas",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:K.marginSanJorge??0,onChange:ie=>q(K.id,"marginSanJorge",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:K.marginIsla??0,onChange:ie=>q(K.id,"marginIsla",ie.target.value)})}),i.jsx("td",{className:"p-2 border",children:Number(K.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(K.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(K.totalSanJorge||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(K.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:K.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:K.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:K.unitPriceIsla}),!x&&i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>se(K.id),children:"Quitar"})})]},K.id))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales de la orden"}),i.jsx("div",{className:"text-lg font-semibold",children:we.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),i.jsx("div",{className:"text-lg font-semibold",children:we.subtotal.toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Rivas (orden)"}),i.jsx("div",{className:"text-lg font-semibold",children:we.totalRivas.toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total San Jorge / Isla"}),i.jsxs("div",{className:"text-sm font-semibold",children:["SJ: ",we.totalSanJorge.toFixed(2),i.jsx("br",{}),"Isla: ",we.totalIsla.toFixed(2)]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",onClick:D,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{D(),p(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",disabled:T.length===0,children:"Guardar orden"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-4",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):u.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin ordenes maestras."})}):u.map(K=>{var pe;K.totalPackages>0&&Math.round(K.totalRivas/K.totalPackages),K.totalPackages>0&&Math.round(K.totalSanJorge/K.totalPackages),K.totalPackages>0&&Math.round(K.totalIsla/K.totalPackages);const ie=f[K.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:K.date||((pe=K.createdAt)!=null&&pe.toDate?K.createdAt.toDate().toISOString().slice(0,10):"")}),i.jsx("td",{className:"p-2 border",children:K.name}),i.jsx("td",{className:"p-2 border",children:K.totalPackages}),i.jsx("td",{className:"p-2 border",children:ie?ie.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:(K.subtotal/K.totalPackages).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:K.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:K.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:K.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:K.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>re(K),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>J(K),children:"Borrar"})]})})]},K.id)})})]})}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]})}const lu=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function fC(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),s=r*e,a=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),A=s*(1+o/100),u=s*(1+l/100),d=s*(1+c/100),f=A-s,h=u-s,m=d-s,p=A/a,x=u/a,g=d/a;return{...t,subtotal:Number(s.toFixed(2)),totalRivas:Number(A.toFixed(2)),totalSanJorge:Number(u.toFixed(2)),totalIsla:Number(d.toFixed(2)),gainRivas:Number(f.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(g.toFixed(2))}}function b3(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function Qi(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function mC(t){const{margin:e,gain:r,subtotal:n,orderMargin:s}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const a=Number(n||0),o=Number(r);return Number.isFinite(o)&&a>0?o/a*100:Number(s||0)}function bve(){var M,D,z;const[t,e]=N.useState([]),[r,n]=N.useState({}),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(or(Ec(new Date),"yyyy-MM-dd")),[u,d]=N.useState(or(_c(new Date),"yyyy-MM-dd")),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[x,g]=N.useState(null),[y,b]=N.useState([]),[F,j]=N.useState(0),[R,E]=N.useState(0),[S,B]=N.useState(0),[U,k]=N.useState(""),[T,L]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState(0),[de,Z]=N.useState(1);N.useEffect(()=>{(async()=>{try{a(!0),l("");const O=Ut(ot(Re,"candy_main_orders"),Hr("createdAt","desc")),te=await bt(O),se=[];te.forEach(Me=>{const re=Me.data();se.push({id:Me.id,name:re.name??"",date:re.date??"",totalPackages:Number(re.totalPackages??0),subtotal:Number(re.subtotal??0),totalRivas:Number(re.totalRivas??0),totalSanJorge:Number(re.totalSanJorge??0),totalIsla:Number(re.totalIsla??0),marginRivas:Number(re.marginRivas??0),marginSanJorge:Number(re.marginSanJorge??0),marginIsla:Number(re.marginIsla??0),createdAt:re.createdAt??Vt.now()})}),e(se);const we=await bt(Ut(ot(Re,"inventory_candies"))),q={};we.forEach(Me=>{const re=Me.data(),J=re.orderId;if(!J)return;const K=Number(re.unitsPerPackage||1)||1,ie=Number(re.totalUnits??(re.packages||0)*K),pe=Math.round(ie/K),Ee=Number(re.remaining??re.totalUnits??ie),Ue=Number(re.remainingPackages??NaN),qe=Number.isFinite(Ue)?Math.round(Ue):Math.round(Ee/K);q[J]||(q[J]={orderId:J,totalPackages:0,remainingPackages:0}),q[J].totalPackages+=pe,q[J].remainingPackages+=qe}),n(q)}catch(O){console.error(O),l(" Error cargando inventario de pedidos.")}finally{a(!1)}})()},[]);const xe=N.useMemo(()=>t.filter(O=>{var se;const te=O.date||((se=O.createdAt)!=null&&se.toDate?O.createdAt.toDate().toISOString().slice(0,10):"");return!(!te||c&&te<c||u&&te>u)}),[t,c,u]),Be=N.useMemo(()=>{let O=0,te=0,se=0,we=0,q=0,Me=0;for(const re of xe){O+=re.totalPackages,te+=re.subtotal,se+=re.totalRivas,we+=re.totalSanJorge,q+=re.totalIsla;const J=r[re.id];J&&(Me+=J.remainingPackages)}return{totalPaquetes:O,totalSubtotal:te,totalRivas:se,totalSJ:we,totalIsla:q,totalPaquetesRestantes:Me,totalPedidos:xe.length}},[xe,r]),I=async(O,te,se)=>{if(!x)return;const we=Number(se||0),q=y.map(J=>J.id!==O?J:fC({...J,[te]:we}));b(q);const Me=q.find(J=>J.id===O);if(!Me)return;const re=b3(q);try{await Fr(Ft(Re,"products_candies",O),{marginRivas:Me.marginRivas,marginSanJorge:Me.marginSanJorge,marginIsla:Me.marginIsla,subtotal:Me.subtotal,totalRivas:Me.totalRivas,totalSanJorge:Me.totalSanJorge,totalIsla:Me.totalIsla,unitPriceRivas:Me.unitPriceRivas,unitPriceSanJorge:Me.unitPriceSanJorge,unitPriceIsla:Me.unitPriceIsla,gainRivas:Me.gainRivas,gainSanJorge:Me.gainSanJorge,gainIsla:Me.gainIsla}),await Fr(Ft(Re,"candy_main_orders",x.id),{totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),g(J=>J&&{...J,totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(J){console.error(J),l(" Error actualizando mrgenes del producto.")}},C=async()=>{if(x)try{l("");const O=Number.isFinite(F)&&F!==0?F:x.marginRivas||0,te=Number.isFinite(R)&&R!==0?R:x.marginSanJorge||0,se=Number.isFinite(S)&&S!==0?S:x.marginIsla||0,we=fC({id:"tmp",name:U.trim(),category:T.trim(),providerPrice:Number(Y||0),packages:Number(ae||0),unitsPerPackage:Number(de||1),marginRivas:Number(O||0),marginSanJorge:Number(te||0),marginIsla:Number(se||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ae||0)}),q=await zr(ot(Re,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:we.name,category:we.category,providerPrice:we.providerPrice,packages:we.packages,unitsPerPackage:we.unitsPerPackage,marginRivas:we.marginRivas,marginSanJorge:we.marginSanJorge,marginIsla:we.marginIsla,gainRivas:we.gainRivas,gainSanJorge:we.gainSanJorge,gainIsla:we.gainIsla,subtotal:we.subtotal,totalRivas:we.totalRivas,totalSanJorge:we.totalSanJorge,totalIsla:we.totalIsla,unitPriceRivas:we.unitPriceRivas,unitPriceSanJorge:we.unitPriceSanJorge,unitPriceIsla:we.unitPriceIsla,createdAt:Vt.now()}),re=[{...we,id:q.id},...y];b(re);const J=b3(re);await Fr(Ft(Re,"candy_main_orders",x.id),{totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),g(K=>K&&{...K,totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),j(0),E(0),B(0),k(""),L(""),me(0),fe(0),Z(1),l(" Producto agregado con mrgenes por sucursal.")}catch(O){console.error(O),l(" Error agregando producto al pedido.")}},Q=async O=>{try{g(O),b([]),h(!0),p(!0),l("");const te=await bt(Ut(ot(Re,"inventory_candies"),qt("orderId","==",O.id))),se={};te.forEach(Me=>{const re=Me.data(),J=re.productId;if(!J)return;const K=Number(re.unitsPerPackage||1)||1,ie=Number(re.remaining??re.totalUnits??0),pe=Number(re.remainingPackages??NaN),Ee=Number.isFinite(pe)?Math.round(pe):Math.round(ie/K);se[J]=(se[J]||0)+Ee});const we=await bt(Ut(ot(Re,"products_candies"),qt("orderId","==",O.id))),q=[];we.forEach(Me=>{const re=Me.data(),J=Qi(re.providerPrice,0),K=Qi(re.packages,0),ie=re.subtotal??J*K,pe=mC({margin:re.marginRivas,gain:re.gainRivas,subtotal:ie,orderMargin:O.marginRivas||0}),Ee=mC({margin:re.marginSanJorge,gain:re.gainSanJorge,subtotal:ie,orderMargin:O.marginSanJorge||0}),Ue=mC({margin:re.marginIsla,gain:re.gainIsla,subtotal:ie,orderMargin:O.marginIsla||0}),qe=fC({id:Me.id,name:re.name??"",category:re.category??"",providerPrice:J,packages:K,unitsPerPackage:Qi(re.unitsPerPackage,1),marginRivas:Number(pe||0),marginSanJorge:Number(Ee||0),marginIsla:Number(Ue||0),subtotal:Qi(re.subtotal,0),totalRivas:Qi(re.totalRivas,0),totalSanJorge:Qi(re.totalSanJorge,0),totalIsla:Qi(re.totalIsla,0),gainRivas:Qi(re.gainRivas,0),gainSanJorge:Qi(re.gainSanJorge,0),gainIsla:Qi(re.gainIsla,0),unitPriceRivas:Qi(re.unitPriceRivas,0),unitPriceSanJorge:Qi(re.unitPriceSanJorge,0),unitPriceIsla:Qi(re.unitPriceIsla,0),remainingPackages:se[Me.id]??Qi(re.packages,0)});q.push(qe)}),b(q)}catch(te){console.error(te),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:O=>A(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:O=>d(O.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:Be.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Be.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Be.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",lu(Be.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",lu(Be.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",lu(Be.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",lu(Be.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):xe.map(O=>{var re;const te=O.totalPackages>0?Math.round(O.totalRivas/O.totalPackages):0,se=O.totalPackages>0?Math.round(O.totalSanJorge/O.totalPackages):0,we=O.totalPackages>0?Math.round(O.totalIsla/O.totalPackages):0,q=O.date||((re=O.createdAt)!=null&&re.toDate?O.createdAt.toDate().toISOString().slice(0,10):""),Me=r[O.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:q}),i.jsx("td",{className:"p-2 border",children:O.name}),i.jsx("td",{className:"p-2 border",children:O.totalPackages}),i.jsx("td",{className:"p-2 border",children:Me?Me.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:O.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:O.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:O.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:O.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:te}),i.jsx("td",{className:"p-2 border",children:se}),i.jsx("td",{className:"p-2 border",children:we}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>Q(O),children:"Ver pedido"})})]},O.id)})})]})}),f&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),g(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((M=x.createdAt)!=null&&M.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((D=r[x.id])==null?void 0:D.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((z=r[x.id])==null?void 0:z.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:lu(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:lu(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:lu(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:lu(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:F,onChange:O=>j(Number(O.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:R,onChange:O=>E(Number(O.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:S,onChange:O=>B(Number(O.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:U,onChange:O=>k(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:T,onChange:O=>L(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:Y,onChange:O=>me(Number(O.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ae,onChange:O=>fe(Number(O.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:de,onChange:O=>Z(Number(O.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:C,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(O=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:O.name}),i.jsx("td",{className:"p-2 border",children:O.category}),i.jsx("td",{className:"p-2 border",children:O.packages}),i.jsx("td",{className:"p-2 border",children:O.remainingPackages??O.packages}),i.jsx("td",{className:"p-2 border",children:O.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:O.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:O.marginRivas??0,onChange:te=>I(O.id,"marginRivas",te.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:O.marginSanJorge??0,onChange:te=>I(O.id,"marginSanJorge",te.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:O.marginIsla??0,onChange:te=>I(O.id,"marginIsla",te.target.value)})}),i.jsx("td",{className:"p-2 border",children:O.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:O.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:O.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:O.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:O.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:O.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:O.unitPriceIsla})]},O.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!f&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Un=t=>Math.round((Number(t)||0)*100)/100,Df=t=>Math.round((Number(t)||0)*1e3)/1e3,mo=t=>Number(t??0).toFixed(2),Pv=t=>Number(t??0).toFixed(3),Nve=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",a=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,A=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),g=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(g||0)>0&&(y=Un(c*Number(g||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:Un(g),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:a,vendorId:o,vendorCommissionAmount:y,processedDate:A||""}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0;let f=0;return f=Un(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:u,amount:d,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:a,vendorId:o,vendorCommissionAmount:f,processedDate:A||""}]};function Cve({role:t,currentUserEmail:e,sellerCandyId:r}){const[n,s]=N.useState([]),[a,o]=N.useState(null),[l,c]=N.useState(!0),[A,u]=N.useState(""),[d,f]=N.useState("ALL"),h=or(new Date,"yyyy-MM-dd"),[m,p]=N.useState(h),[x,g]=N.useState(h),[y,b]=N.useState("ALL"),[F,j]=N.useState(null),[R,E]=N.useState(0),[S,B]=N.useState(0),[U,k]=N.useState(""),[T,L]=N.useState(0),[Y,me]=N.useState("0"),ae=N.useRef(null),fe=!t||t==="admin",de=t==="vendedor_dulces",Z=(e||"").trim().toLowerCase(),[xe,Be]=N.useState([]);N.useEffect(()=>{if(!m||!x)return;c(!0);const le=Ut(ot(Re,"sales_candies"),qt("date",">=",m),qt("date","<=",x),Hr("date","asc")),je=M0(le,X=>{const G=[];X.forEach(ye=>{const Oe=Nve(ye.data(),ye.id);G.push(...Oe)}),s(G),c(!1)},X=>{console.error("Error cargando ventas por periodo:",X),s([]),c(!1)});return()=>je()},[m,x]),N.useEffect(()=>{(async()=>{const je=Ut(ot(Re,"daily_closures_candies"),qt("date","==",h)),X=await bt(je);if(X.empty)o(null);else{const G=X.docs[0];o({id:G.id,...G.data()})}})()},[h]),N.useEffect(()=>{(async()=>{try{const je=await bt(ot(Re,"sellers_candies")),X=[];je.forEach(G=>{const ye=G.data();X.push({id:G.id,name:ye.name||"",commissionPercent:Number(ye.commissionPercent||0)})}),Be(X)}catch(je){console.error("Error cargando sellers_candies",je)}})()},[]);const I=le=>Un(Number(le.vendorCommissionAmount??0)||0),C=li.useMemo(()=>{let le=[...n];return d==="FLOTANTE"&&(le=le.filter(je=>je.status==="FLOTANTE")),d==="PROCESADA"&&(le=le.filter(je=>je.status==="PROCESADA")),fe&&y!=="ALL"&&(le=le.filter(je=>(je.vendorId||"")===y)),de&&(r?le=le.filter(je=>(je.vendorId||"")===r):Z?le=le.filter(je=>(je.sellerEmail||"").toLowerCase()===Z):le=[]),le},[d,n,fe,y,de,r,Z]),Q=li.useMemo(()=>C.filter(le=>le.status==="FLOTANTE").length,[C]),M=li.useMemo(()=>C.filter(le=>le.status==="PROCESADA").length,[C]),D=li.useMemo(()=>C.filter(le=>le.type==="CREDITO").length,[C]),z=li.useMemo(()=>C.filter(le=>le.type!=="CREDITO").length,[C]);Df(C.reduce((le,je)=>le+(je.quantity||0),0));const O=Un(C.reduce((le,je)=>le+Number(je.cogsAmount??0),0)),te=Un(C.reduce((le,je)=>le+(je.amount||0),0)),se=Un(te-O);let we=0,q=0,Me=0,re=0,J=0,K=0,ie=0;C.forEach(le=>{const je=Number(le.amount||0),X=Number(le.amountReceived||0),G=I(le);J+=G,le.type==="CREDITO"?(we+=le.quantity||0,Me+=je-X,ie+=G):(q+=le.quantity||0,re+=je,K+=G)}),Me=Un(Me),re=Un(re),J=Un(J),K=Un(K),ie=Un(ie);const pe=li.useMemo(()=>{const le={};for(const je of C){const X=(je.vendorId||"").trim();if(!X||je.type==="CREDITO")continue;const G=I(je);if(!le[X]){const ye=xe.find(Oe=>Oe.id===X);le[X]={vendorId:X,name:(ye==null?void 0:ye.name)||je.userEmail||"(sin vendedor)",total:0}}le[X].total=Un(le[X].total+G)}return Object.values(le).filter(je=>je.total>0).sort((je,X)=>X.total-je.total)},[C,xe]),Ee=li.useMemo(()=>{const le={};for(const je of C){const X=(je.vendorId||"").trim();if(!X||je.type!=="CREDITO")continue;const G=I(je);if(!le[X]){const ye=xe.find(Oe=>Oe.id===X);le[X]={vendorId:X,name:(ye==null?void 0:ye.name)||je.userEmail||"(sin vendedor)",total:0}}le[X].total=Un(le[X].total+G)}return Object.values(le).filter(je=>je.total>0).sort((je,X)=>X.total-je.total)},[C,xe]),Ue={};C.forEach(le=>{const je=le.productName||"(sin nombre)";Ue[je]||(Ue[je]={totalQuantity:0,totalAmount:0,totalCommission:0}),Ue[je].totalQuantity=Df(Ue[je].totalQuantity+(le.quantity||0)),Ue[je].totalAmount=Un(Ue[je].totalAmount+(le.amount||0)),Ue[je].totalCommission=Un(Ue[je].totalCommission+I(le))});const qe=Object.entries(Ue).map(([le,je])=>({productName:le,totalQuantity:je.totalQuantity,totalAmount:je.totalAmount,totalCommission:je.totalCommission})),$e=async()=>{if(fe)try{const le=C.filter(Ce=>Ce.status==="FLOTANTE");if(le.length===0){u("No hay ventas flotantes para procesar en este perodo.");return}const je={totalCharged:Un(le.reduce((Ce,Ze)=>Ce+(Ze.amount||0),0)),totalSuggested:Un(le.reduce((Ce,Ze)=>Ce+(Ze.amountSuggested||0),0)),totalUnits:Df(le.reduce((Ce,Ze)=>Ce+(Ze.quantity||0),0)),totalCOGS:Un(le.reduce((Ce,Ze)=>Ce+Number(Ze.cogsAmount??0),0))},X=Un(je.totalCharged-je.totalSuggested),G=Un(je.totalCharged-je.totalCOGS),ye=le.reduce((Ce,Ze)=>{const Te=Number(Ze.quantity||0),Ge=Number(Ze.amount||0),at=Number(Ze.vendorCommissionAmount||0);return Ze.type==="CREDITO"?(Ce.packsCredit+=Te,Ce.amountCredit+=Ge,Ce.comCredit+=at):(Ce.packsCash+=Te,Ce.amountCash+=Ge,Ce.comCash+=at),Ce},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),Oe={totalPacksCash:Df(ye.packsCash),totalPacksCredit:Df(ye.packsCredit),totalAmountCash:Un(ye.amountCash),totalAmountCredit:Un(ye.amountCredit),totalCommissionCash:Un(ye.comCash),totalCommissionCredit:Un(ye.comCredit)},_e=await zr(ot(Re,"daily_closures_candies"),{date:h,createdAt:Vt.now(),periodStart:m,periodEnd:x,totalCharged:je.totalCharged,totalSuggested:je.totalSuggested,totalDifference:X,totalUnits:je.totalUnits,totalCOGS:je.totalCOGS,grossProfit:G,...Oe,products:le.map(Ce=>({productName:Ce.productName,quantity:Ce.quantity,amount:Ce.amount})),sales:le.map(Ce=>({id:Ce.id,productName:Ce.productName,quantity:Ce.quantity,amount:Ce.amount,amountSuggested:Ce.amountSuggested,userEmail:Ce.userEmail,clientName:Ce.clientName,amountReceived:Ce.amountReceived,change:Ce.change,status:Ce.status,cogsAmount:Ce.cogsAmount??0,avgUnitCost:Ce.avgUnitCost??null,allocations:Ce.allocations??[],date:Ce.date,type:Ce.type??"CONTADO",vendorId:Ce.vendorId??"",vendorCommissionAmount:Number(Ce.vendorCommissionAmount??0)||0,processedDate:h})),productSummary:Object.entries(le.reduce((Ce,Ze)=>{const Te=Ze.productName||"(sin nombre)";return Ce[Te]||(Ce[Te]={totalQuantity:0,totalAmount:0}),Ce[Te].totalQuantity=Df(Ce[Te].totalQuantity+(Ze.quantity||0)),Ce[Te].totalAmount=Un(Ce[Te].totalAmount+(Ze.amount||0)),Ce},{})).map(([Ce,Ze])=>({productName:Ce,totalQuantity:Ze.totalQuantity,totalAmount:Ze.totalAmount}))}),he=Gh(Re);le.forEach(Ce=>{he.update(Ft(Re,"sales_candies",Ce.id.split("#")[0]),{status:"PROCESADA",closureId:_e.id,closureDate:h,processedDate:h,processedAt:Vt.now()})}),await he.commit(),u(` Cierre guardado. Ventas procesadas: ${le.length}. (Proceso: ${h})`)}catch(le){console.error(le),u(" Error al guardar el cierre de dulces.")}},st=async le=>{if(fe&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Fr(Ft(Re,"sales_candies",le.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),u(" Venta revertida a FLOTANTE.")}catch(je){console.error(je),u(" No se pudo revertir la venta.")}},Se=le=>{fe&&(j(le),E(le.quantity),B(le.amount),k(le.clientName),L(le.amountReceived),me(le.change))},ze=async()=>{if(!(!F||!fe))try{await Fr(Ft(Re,"sales_candies",F.id.split("#")[0]),{packagesTotal:R,amount:S,amountCharged:S,clientName:U,amountReceived:T,change:Y}),j(null),u(" Venta de dulces actualizada.")}catch(le){console.error(le),u(" No se pudo actualizar la venta de dulces.")}},Ke=async le=>{if(fe&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const{restored:je}=await G1e(le.split("#")[0]);u(` Venta eliminada. Stock restaurado (unidades internas): ${Number(je).toFixed(2)}.`)}catch(je){console.error(je),u(" No se pudo eliminar la venta de dulces.")}},be=async()=>{if(ae.current){ae.current.classList.add("force-pdf-colors");try{const je=(await $h(ae.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),X=new rr;X.addImage(je,"PNG",10,10,190,0),X.save(`cierre_dulces_${m}_a_${x}_proc_${h}.pdf`)}finally{ae.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",h]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:le=>p(le.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:le=>g(le.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:d,onChange:le=>f(le.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),fe&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:y,onChange:le=>b(le.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),xe.map(le=>i.jsx("option",{value:le.id,children:le.name||le.id},le.id))]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:Q}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:M}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:D}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:z}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",mo(K)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",mo(ie)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),pe.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:pe.map(le=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:le.name}),i.jsxs("strong",{className:"ml-2",children:["C$",mo(le.total)]})]},le.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),Ee.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Ee.map(le=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:le.name}),i.jsxs("strong",{className:"ml-2",children:["C$",mo(le.total)]})]},le.vendorId))})]})]}),l?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:ae,children:[i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[C.map(le=>{const je=I(le),X=(le.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${le.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:le.status})}),i.jsx("td",{className:"border p-1",children:le.productName}),i.jsx("td",{className:"border p-1",children:le.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Pv(le.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",mo(le.amount)]}),i.jsx("td",{className:"border p-1",children:je>0?`C$${mo(je)}`:""}),i.jsx("td",{className:"border p-1",children:le.date}),i.jsx("td",{className:"border p-1",children:X||""}),i.jsx("td",{className:"border p-1",children:le.userEmail}),i.jsx("td",{className:"border p-1",children:le.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:fe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Se(le),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Ke(le.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):le.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:fe?i.jsx("button",{onClick:()=>st(le.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},le.id)}),C.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:Pv(we)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:Pv(q)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",mo(Me)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",mo(re)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",mo(J)]})]})]}),(O>0||se!==te)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",mo(O)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",mo(se)]})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsxs("tbody",{children:[qe.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:le.productName}),i.jsx("td",{className:"border p-1",children:Pv(le.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",mo(le.totalAmount)]}),i.jsx("td",{className:"border p-1",children:le.totalCommission>0?`C$${mo(le.totalCommission)}`:""})]},le.productName)),qe.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[fe&&i.jsx("button",{onClick:$e,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),i.jsx("button",{onClick:be,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),F&&fe&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[F.productName,"  ",F.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:R,onChange:le=>E(parseFloat(le.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:le=>B(parseFloat(le.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:U,onChange:le=>k(le.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:T,onChange:le=>L(parseFloat(le.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:Y,onChange:le=>me(le.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>j(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:ze,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Xc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,po=t=>Math.round((Number(t)||0)*100)/100;function _ve(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function Eve(t){return t.toISOString().slice(0,10)}function Bve(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function Sve(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return Eve(r)}function Ive(){const[t,e]=N.useState(Bve()),[r,n]=N.useState(Sve()),[s,a]=N.useState(!1),[o,l]=N.useState(""),[c,A]=N.useState({}),[u,d]=N.useState({}),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState({}),[y,b]=N.useState(!1),[F,j]=N.useState(null),[R,E]=N.useState(null),S=N.useMemo(()=>F&&f.find(ae=>ae.vendorId===F)||null,[F,f]),B=N.useMemo(()=>{var ae;return!F||!R?[]:((ae=x[F])==null?void 0:ae[R])||[]},[F,R,x]),U=N.useMemo(()=>po(f.reduce((ae,fe)=>ae+(fe.totalSoldMoney||0),0)),[f]),k=N.useMemo(()=>po(f.reduce((ae,fe)=>ae+(fe.totalCreditMoney||0),0)),[f]);N.useEffect(()=>{(async()=>{try{const ae=await bt(ot(Re,"sellers_candies")),fe={};ae.forEach(xe=>{const Be=xe.data(),I=Be.branch||"Rivas";let C="RIVAS";I==="San Jorge"?C="SAN_JORGE":I==="Isla Ometepe"&&(C="ISLA"),fe[xe.id]={id:xe.id,name:Be.name??"(sin nombre)",branch:C,branchLabel:I,commissionPercent:Number(Be.commissionPercent??0)}});const de=await bt(ot(Re,"products_candies")),Z={};de.forEach(xe=>{const Be=xe.data();Z[xe.id]={id:xe.id,name:Be.name??"(sin nombre)"}}),A(fe),d(Z)}catch(ae){console.error(ae),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const T=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}a(!0),l("");try{const ae={},fe={},de=Ut(ot(Re,"inventory_candies_sellers"),qt("date",">=",t),qt("date","<=",r)),Z=await bt(de),xe={},Be={},I={},C={};Z.forEach(ie=>{var wt,it;const pe=ie.data(),Ee=pe.sellerId||"";if(!Ee)return;const Ue=pe.productId||"",qe=pe.productName||((wt=u[Ue])==null?void 0:wt.name)||"(sin nombre)",$e=Math.max(1,Math.floor(Number(pe.unitsPerPackage||1))),st=Number(pe.totalUnits??0),Se=Number(pe.packages??0),ze=Number(pe.remainingUnits??pe.remaining??0),Ke=Number(pe.remainingPackages??0),be=Se>0?Se:st>0?Math.floor(st/$e):0,le=Ke>0?Ke:ze>0?Math.floor(ze/$e):0;xe[Ee]=(xe[Ee]||0)+be,Be[Ee]=(Be[Ee]||0)+le;const je=pe.orderId||pe.vendorOrderId||pe.orderNumber||pe.order||ie.id;I[Ee]||(I[Ee]=new Set),I[Ee].add(je);const X=((it=c[Ee])==null?void 0:it.name)||pe.sellerName||"(sin vendedor)",G=String(pe.date||""),ye=Number(pe.totalVendor??0),Oe=Number(pe.gainVendor??0),_e=Se>0?Se:st>0?Math.floor(st/$e):0,he=_e>0?ye/_e:0,Ce=_e>0?Oe/_e:0,Ze=po(be*he),Te=po(be*Ce),Ge=po(le*he),at=po(le*Ce);C[Ee]||(C[Ee]={ordered:[],remaining:[]}),be>0&&C[Ee].ordered.push({date:G,vendorName:X,productName:qe,packages:be,totalMoney:Ze,vendorCommission:Te}),le>0&&C[Ee].remaining.push({date:G,vendorName:X,productName:qe,packages:le,totalMoney:Ge,vendorCommission:at})});const Q={};Object.keys(I).forEach(ie=>{Q[ie]=I[ie].size});const M=Ut(ot(Re,"sales_candies"),qt("date",">=",t),qt("date","<=",r)),D=await bt(M),z={},O={},te={},se={},we={},q={};D.forEach(ie=>{const pe=ie.data(),Ee=pe.date||"",Ue=pe.vendorId||pe.sellerId||"";if(!Ue)return;const qe=c[Ue],$e=pe.vendorName||(qe==null?void 0:qe.name)||"(sin vendedor)",st=Number(pe.vendorCommissionPercent??(qe==null?void 0:qe.commissionPercent)??0)||0,Se=Array.isArray(pe.items)?pe.items:[];if(!Se.length)return;const ze=String(pe.type||"").toUpperCase()==="CREDITO";we[Ue]||(we[Ue]={sold:[],credit:[]}),Se.forEach(Ke=>{var Ze;const be=Ke.productName||((Ze=u[Ke.productId||""])==null?void 0:Ze.name)||"(sin nombre)",le=Ke.packages??Ke.qty??Ke.quantity??0,je=Number(le||0);if(je<=0)return;const X=Number(Ke.unitPricePackage??Ke.unitPrice??0)||0,G=Math.max(0,Number(Ke.discount||0)),ye=je*X,Oe=po(Math.max(0,ye-G));if(Oe<=0)return;console.log("DBG",{isCredit:ze,vendorId:Ue,commissionPercent:st,lineFinal:Oe,storedItemCommission:Number(Ke.vendorCommissionAmount??0)});let _e=0;const he=Number(Ke.vendorCommissionAmount??0);he?_e=po(he):st>0&&(_e=po(Oe*st/100)),ze?(O[Ue]=(O[Ue]||0)+je,se[Ue]=(se[Ue]||0)+Oe):(z[Ue]=(z[Ue]||0)+je,te[Ue]=(te[Ue]||0)+Oe),ze?fe[Ue]=(fe[Ue]||0)+_e:ae[Ue]=(ae[Ue]||0)+_e,ze?we[Ue].credit.push({date:Ee,vendorName:$e,productName:be,packages:je,totalMoney:Oe,vendorCommission:0}):we[Ue].sold.push({date:Ee,vendorName:$e,productName:be,packages:je,totalMoney:Oe,vendorCommission:_e});const Ce=be;q[Ce]||(q[Ce]={productName:be,packages:0,totalMoney:0}),q[Ce].packages+=je,q[Ce].totalMoney+=Oe})});const Me=new Set([...Object.keys(xe),...Object.keys(Be),...Object.keys(z),...Object.keys(O)]),re=[],J={};Me.forEach(ie=>{var le,je,X,G;const pe=c[ie],Ee=(pe==null?void 0:pe.name)||"(sin vendedor)",Ue=pe?pe.branchLabel||_ve(pe.branch):"",qe=xe[ie]||0,$e=Be[ie]||0,st=z[ie]||0,Se=O[ie]||0,ze=po(te[ie]||0),Ke=po(se[ie]||0),be=Q[ie]||0;re.push({vendorId:ie,vendorName:Ee,branchLabel:Ue,orderedPackages:qe,remainingPackages:$e,soldPackages:st,creditPackages:Se,totalSoldMoney:ze,totalCreditMoney:Ke,ordersCreated:be,commissionCash:po(ae[ie]||0),commissionCredit:0}),J[ie]={ordered:(((le=C[ie])==null?void 0:le.ordered)||[]).sort((ye,Oe)=>ye.date.localeCompare(Oe.date)),remaining:(((je=C[ie])==null?void 0:je.remaining)||[]).sort((ye,Oe)=>ye.date.localeCompare(Oe.date)),sold:(((X=we[ie])==null?void 0:X.sold)||[]).sort((ye,Oe)=>ye.date.localeCompare(Oe.date)),credit:(((G=we[ie])==null?void 0:G.credit)||[]).sort((ye,Oe)=>ye.date.localeCompare(Oe.date))}}),re.sort((ie,pe)=>ie.vendorName.localeCompare(pe.vendorName,"es")),h(re),g(J);const K=Object.values(q).map(ie=>({productName:ie.productName,packages:ie.packages,totalMoney:po(ie.totalMoney)})).sort((ie,pe)=>pe.packages-ie.packages).slice(0,10);p(K),re.length||l("Sin datos para el rango seleccionado.")}catch(ae){console.error(ae),l(" Error cargando consolidado de vendedores.")}finally{a(!1)}};N.useEffect(()=>{Object.keys(c).length&&T()},[c]);const L=(ae,fe)=>{j(ae),E(fe),b(!0)},Y=()=>{b(!1),j(null),E(null)},me=()=>{if(!f.length){l("No hay datos para exportar.");return}const ae=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],fe=f.map(I=>[I.vendorName,I.branchLabel,I.orderedPackages.toString(),I.remainingPackages.toString(),I.soldPackages.toString(),I.creditPackages.toString(),I.totalSoldMoney.toFixed(2),I.commissionCash.toFixed(2),I.totalCreditMoney.toFixed(2),I.commissionCredit.toFixed(2),I.ordersCreated.toString()]),de=[ae,...fe].map(I=>I.map(C=>`"${String(C).replace(/"/g,'""')}"`).join(",")).join(`
`),Z=new Blob([de],{type:"text/csv;charset=utf-8;"}),xe=URL.createObjectURL(Z),Be=document.createElement("a");Be.href=xe,Be.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Be.click(),URL.revokeObjectURL(xe)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ae=>e(ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ae=>n(ae.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:s,children:s?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:me,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Xc(U)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Xc(k)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:f.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[f.map(ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ae.vendorName}),i.jsx("td",{className:"border p-1",children:ae.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>L(ae.vendorId,"ordered"),children:ae.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>L(ae.vendorId,"remaining"),children:ae.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>L(ae.vendorId,"sold"),children:ae.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>L(ae.vendorId,"credit"),children:ae.creditPackages})}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Xc(ae.commissionCash)}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Xc(ae.commissionCredit)}),i.jsx("td",{className:"border p-1",children:ae.ordersCreated})]},ae.vendorId)),f.length===0&&!s&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((ae,fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:fe+1}),i.jsx("td",{className:"border p-1",children:ae.productName}),i.jsx("td",{className:"border p-1",children:ae.packages}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalMoney)})]},ae.productName)),m.length===0&&!s&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&R&&F&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",R==="ordered"?"Paquetes ordenados":R==="remaining"?"Paquetes restantes":R==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[S==null?void 0:S.vendorName,"  ",S==null?void 0:S.branchLabel]})]}),i.jsx("button",{onClick:Y,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[B.map((ae,fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ae.date}),i.jsx("td",{className:"border p-1",children:ae.productName}),i.jsx("td",{className:"border p-1",children:ae.packages}),i.jsx("td",{className:"border p-1",children:Xc(ae.totalMoney)}),i.jsx("td",{className:"border p-1",children:ae.vendorName}),i.jsx("td",{className:"border p-1",children:Xc(ae.vendorCommission)})]},fe)),B.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const ai=t=>`C$${Number(t||0).toFixed(2)}`,Rv=t=>Number(t||0).toFixed(3),pC=()=>{const t=new Date;return or(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},Dv=()=>or(new Date,"yyyy-MM-dd");function Fve({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,a]=N.useState([]),o=N.useMemo(()=>{const Te={};return s.forEach(Ge=>{Ge.email&&(Te[Ge.email.trim().toLowerCase()]=Ge)}),Te},[s]);N.useEffect(()=>{(async()=>{try{const Te=Ut(ot(Re,"sellers_candies"),Hr("name","asc")),Ge=await bt(Te),at=[];Ge.forEach(wt=>{const it=wt.data();at.push({id:wt.id,name:it.name||"",email:it.email||"",commissionPercent:Number(it.commissionPercent||0)})}),a(at)}catch(Te){console.error(Te)}})()},[]);const[l,c]=N.useState(pC()),[A,u]=N.useState(Dv()),[d,f]=N.useState(""),[h,m]=N.useState(""),p=N.useMemo(()=>{const Te=new Map;return n.forEach(Ge=>{const at=Ge.productId||Ge.productName;Te.set(at,{key:at,name:Ge.productName})}),Array.from(Te.values()).sort((Ge,at)=>Ge.name.localeCompare(at.name))},[n]),x=N.useMemo(()=>{const Te=new Map;return n.forEach(Ge=>{const at=(Ge.sellerEmail||"").trim().toLowerCase();if(!at)return;const wt=o[at],it=(wt==null?void 0:wt.name)||Ge.vendorName||at;Te.set(at,{email:at,label:it})}),Array.from(Te.values()).sort((Ge,at)=>Ge.label.localeCompare(at.label))},[n,o]),g=N.useMemo(()=>n.filter(Te=>!(l&&Te.date<l||A&&Te.date>A||d&&(Te.productId||Te.productName)!==d||h&&(Te.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,A,d,h]),[y,b]=N.useState(Dv()),[F,j]=N.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[R,E]=N.useState(""),[S,B]=N.useState("0"),[U,k]=N.useState(()=>g.map(Te=>Te.id));N.useEffect(()=>{k(Te=>Te.filter(Ge=>g.some(at=>at.id===Ge)))},[g]);const[T,L]=N.useState([]),[Y,me]=N.useState([]),[ae,fe]=N.useState(!1),[de,Z]=N.useState(pC()),[xe,Be]=N.useState(Dv());N.useEffect(()=>{(async()=>{try{fe(!0);const Te=Ut(ot(Re,"expensesCandies"),Hr("date","desc")),Ge=await bt(Te),at=[];Ge.forEach(wt=>{const it=wt.data();at.push({id:wt.id,date:it.date,description:it.description,amount:Number(it.amount||0)})}),L(at)}catch(Te){console.error(Te)}finally{fe(!1)}})()},[]);const I=N.useMemo(()=>T.filter(Te=>!(!Te.date||de&&Te.date<de||xe&&Te.date>xe)),[T,de,xe]),[C,Q]=N.useState([]),[M,D]=N.useState(!1),[z,O]=N.useState(""),[te,se]=N.useState("DEBITO"),[we,q]=N.useState(""),Me=()=>{const Te=Number(we);!z.trim()||!isFinite(Te)||Te<=0||(Q(Ge=>[...Ge,{id:`${Date.now()}_${Ge.length+1}`,description:z.trim(),type:te,amount:Number(Te.toFixed(2))}]),O(""),q(""))},[re,J]=N.useState(null),[K,ie]=N.useState(""),[pe,Ee]=N.useState("DEBITO"),[Ue,qe]=N.useState(""),$e=Te=>{J(Te.id),ie(Te.description),Ee(Te.type),qe(Te.amount.toFixed(2))},st=()=>{J(null),ie(""),Ee("DEBITO"),qe("")},Se=()=>{if(!re)return;const Te=Number(Ue);!isFinite(Te)||Te<=0||(Q(Ge=>Ge.map(at=>at.id===re?{...at,description:K.trim(),type:pe,amount:Number(Te.toFixed(2))}:at)),st())},ze=Te=>{Q(Ge=>Ge.filter(at=>at.id!==Te)),re===Te&&st()},Ke=(Te,Ge)=>{k(at=>Ge?[...new Set([...at,Te])]:at.filter(wt=>wt!==Te))},be=Te=>{k(Te?g.map(Ge=>Ge.id):[])},le=(Te,Ge)=>{me(at=>Ge?[...new Set([...at,Te])]:at.filter(wt=>wt!==Te))},je=N.useMemo(()=>g.filter(Te=>U.includes(Te.id)),[g,U]),X=N.useMemo(()=>C.filter(Te=>Te.type==="DEBITO").reduce((Te,Ge)=>Te+Ge.amount,0),[C]),G=N.useMemo(()=>C.filter(Te=>Te.type==="CREDITO").reduce((Te,Ge)=>Te+Ge.amount,0),[C]),ye=N.useMemo(()=>{let Te=0,Ge=0,at=0,wt=0;for(const gr of je){const xr=Number(gr.packages||0),Ye=Number(gr.cogsAmount||0),pt=Number(gr.amount||0);Te+=xr,Ge+=Ye,at+=pt;const Rt=(gr.sellerEmail||"").trim().toLowerCase(),Tt=o[Rt],Dt=Number((Tt==null?void 0:Tt.commissionPercent)||0),Xt=pt*Dt/100;wt+=Xt}const it=I.filter(gr=>Y.includes(gr.id)).reduce((gr,xr)=>gr+Number(xr.amount||0),0),xt=at-Ge,Lt=at-it-X+G-wt,hr=Number(S||0),lr=at*hr/100;return{totalPackages:Number(Rv(Te)),totalProvider:Number(Ge.toFixed(2)),totalSale:Number(at.toFixed(2)),totalGastos:Number(it.toFixed(2)),debits:Number(X.toFixed(2)),credits:Number(G.toFixed(2)),grossProfit:Number(xt.toFixed(2)),finalAmount:Number(Lt.toFixed(2)),totalCommissionVendors:Number(wt.toFixed(2)),branchProfit:Number(lr.toFixed(2)),branchFactor:hr}},[je,I,Y,X,G,o,S]),[Oe,_e]=N.useState(!1),[he,Ce]=N.useState(""),Ze=async()=>{if(Ce(""),je.length===0){Ce("Selecciona al menos 1 transaccin procesada.");return}try{_e(!0);const Te={number:F.trim(),date:y,description:R.trim(),status:"PENDIENTE",createdAt:Vt.now(),totalPackages:ye.totalPackages,totalProvider:ye.totalProvider,totalSale:ye.totalSale,totalExpenses:ye.totalGastos,totalDebits:ye.debits,totalCredits:ye.credits,grossProfit:ye.grossProfit,totalCommissionVendors:ye.totalCommissionVendors,branchFactorPercent:ye.branchFactor,branchProfit:ye.branchProfit,finalAmount:ye.finalAmount,transactions:je.map(Ge=>{const at=Number(Ge.packages||0)||1,wt=Number(Ge.cogsAmount||0),it=Number(Ge.amount||0),xt=wt/at,Lt=it/at,hr=(Ge.sellerEmail||"").trim().toLowerCase(),lr=o[hr],gr=Number((lr==null?void 0:lr.commissionPercent)||0),xr=it*gr/100;return{id:Ge.id,date:Ge.date,productId:Ge.productId||null,productName:Ge.productName,vendorName:Ge.vendorName,sellerEmail:Ge.sellerEmail||null,packages:Number(Rv(Ge.packages)),providerPricePack:Number(xt.toFixed(4)),salePricePack:Number(Lt.toFixed(4)),totalProvider:Number(wt.toFixed(2)),totalSale:Number(it.toFixed(2)),commissionPercent:gr,commissionAmount:Number(xr.toFixed(2))}}),expenses:I.filter(Ge=>Y.includes(Ge.id)).map(Ge=>({id:Ge.id,date:Ge.date||null,description:Ge.description||"",amount:Number(Number(Ge.amount||0).toFixed(2))})),adjustments:C.map(Ge=>({id:Ge.id,description:Ge.description,type:Ge.type,amount:Number(Ge.amount.toFixed(2))}))};await zr(ot(Re,"invoicesCandies"),Te),Ce(" Factura de dulces creada."),r()}catch(Te){console.error(Te),Ce(` Error al crear factura: ${(Te==null?void 0:Te.message)||"desconocido"}`)}finally{_e(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:Te=>b(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:F,onChange:Te=>j(Te.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:Te=>B(Te.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:R,onChange:Te=>E(Te.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:Te=>c(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:Te=>u(Te.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:d,onChange:Te=>f(Te.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(Te=>i.jsx("option",{value:Te.key,children:Te.name},Te.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:Te=>m(Te.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(Te=>i.jsx("option",{value:Te.email,children:Te.label},Te.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(pC()),u(Dv()),f(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:g.length>0&&U.length===g.length,onChange:Te=>be(Te.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),g.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:g.map(Te=>{const Ge=U.includes(Te.id),at=Number(Te.packages||0)||1,wt=Number(Te.cogsAmount||0),it=Number(Te.amount||0),xt=wt/at,Lt=it/at,hr=(Te.sellerEmail||"").trim().toLowerCase(),lr=o[hr],gr=Number((lr==null?void 0:lr.commissionPercent)||0),xr=it*gr/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:Ge,onChange:Ye=>Ke(Te.id,Ye.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Te.date}),i.jsx("td",{className:"p-2 border",children:(lr==null?void 0:lr.name)||Te.vendorName}),i.jsx("td",{className:"p-2 border",children:Te.productName}),i.jsx("td",{className:"p-2 border",children:Rv(Te.packages)}),i.jsx("td",{className:"p-2 border",children:ai(xt)}),i.jsx("td",{className:"p-2 border",children:ai(Lt)}),i.jsx("td",{className:"p-2 border",children:ai(wt)}),i.jsx("td",{className:"p-2 border",children:ai(it)}),i.jsx("td",{className:"p-2 border",children:gr>0?`${ai(xr)} (${gr.toFixed(2)}%)`:""})]},Te.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ae&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:de,onChange:Te=>Z(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:xe,onChange:Te=>Be(Te.target.value)})]})]})]}),I.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:I.map(Te=>{const Ge=Y.includes(Te.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:Ge,onChange:at=>le(Te.id,at.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Te.date||""}),i.jsx("td",{className:"p-2 border",children:Te.description||""}),i.jsx("td",{className:"p-2 border",children:ai(Number(Te.amount||0))})]},Te.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>D(!0),children:"Crear Cargo"})]}),C.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:C.map(Te=>{const Ge=re===Te.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ge?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:K,onChange:at=>ie(at.target.value)}):i.jsx("span",{title:Te.description,children:Te.description.length>60?`${Te.description.slice(0,60)}`:Te.description})}),i.jsx("td",{className:"p-2 border",children:Ge?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:pe,onChange:at=>Ee(at.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Te.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:Te.type})}),i.jsx("td",{className:"p-2 border",children:Ge?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:Ue,onChange:at=>qe(at.target.value)}):ai(Te.amount)}),i.jsx("td",{className:"p-2 border",children:Ge?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Se,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:st,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ze(Te.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>$e(Te),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ze(Te.id),children:"Eliminar"})]})})]},Te.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:Rv(ye.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:ai(ye.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:ai(ye.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:ai(ye.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:ai(ye.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:ai(ye.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:ai(ye.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:ai(ye.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:ai(ye.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:ai(ye.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:Oe,onClick:Ze,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:Oe?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),he&&i.jsx("span",{className:"text-sm ml-2",children:he})]}),Oe&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),M&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>D(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:z,onChange:Te=>O(Te.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:te,onChange:Te=>se(Te.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:we,onChange:Te=>q(Te.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Me,children:"Agregar"})})]})]})})]})}const Nn=t=>`C$ ${Number(t??0).toFixed(2)}`,Lv=t=>Number(t??0).toFixed(3);function gC(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),s=Number(t.totalSale??0),a=Number(t.totalCommissionVendors??0);if(e.length>0&&(s===0||r===0)){r=0,n=0,s=0,a=0;for(const g of e){const y=Number(g.packages??0);r+=y,n+=Number(g.totalProvider??y*(g.providerPricePack??0)),s+=Number(g.totalSale??y*(g.salePricePack??0));const b=g.commissionAmount??Number(g.totalSale??0)*Number(g.commissionPercent??0)/100;a+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((g,y)=>g+Number(y.amount||0),0),A=l.filter(g=>g.type==="DEBITO").reduce((g,y)=>g+Number(y.amount||0),0),u=l.filter(g=>g.type==="CREDITO").reduce((g,y)=>g+Number(y.amount||0),0),d=t.totalDebits!==void 0?Number(t.totalDebits):A,f=t.totalCredits!==void 0?Number(t.totalCredits):u,h=s-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):s-a-c-d+f;return{totalPackages:r,totalProvider:n,totalSale:s,commissionTotal:a,expenses:c,debits:d,credits:f,grossProfit:h,branchProfit:p,finalAmount:x}}function N3(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function kve(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(null),o=N.useRef(null),[l,c]=N.useState(!1),A=async()=>{n(!0);const h=Ut(ot(Re,"invoicesCandies"),Hr("date","desc")),m=await bt(h),p=[];m.forEach(x=>{const g=x.data();p.push({id:x.id,date:g.date,number:g.number,description:g.description,status:g.status||"PENDIENTE",totalPackages:g.totalPackages||0,totalProvider:g.totalProvider||0,totalSale:g.totalSale||0,totalExpenses:g.totalExpenses||0,totalDebits:g.totalDebits||0,totalCredits:g.totalCredits||0,totalCommissionVendors:g.totalCommissionVendors||0,finalAmount:g.finalAmount||0,branchFactorPercent:g.branchFactorPercent||0,branchProfit:g.branchProfit||0,transactions:(g.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(g.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(g.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};N.useEffect(()=>{A()},[]);const u=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await Fr(Ft(Re,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(s==null?void 0:s.id)===h.id&&a({...h,status:m})},d=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await mn(Ft(Re,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(s==null?void 0:s.id)===h.id&&a(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},f=async()=>{if(!o.current||!s)return;const h=o.current,m=await $h(h,{backgroundColor:"#ffffff",onclone:b=>{const F=b.body;F.style.background="#ffffff",F.querySelectorAll("*").forEach(j=>{const R=b.defaultView.getComputedStyle(j);R.boxShadow&&R.boxShadow!=="none"&&(j.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new rr("p","mm","a4"),g=x.internal.pageSize.getWidth(),y=m.height*g/m.width;x.addImage(p,"PNG",0,0,g,y),x.save(`factura_candy_${s.number||s.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(Fve,{onClose:()=>c(!1),onCreated:()=>{c(!1),A()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=gC(h),p=N3(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Lv(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>a(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>u(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>d(h),children:"Eliminar"})]})})]},h.id)})})]})}),s&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>a(null),children:"Cerrar"}),i.jsx("button",{onClick:f,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=gC(s),m=N3(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",Lv(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Nn(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Nn(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Nn(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Nn(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Nn(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Nn(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Nn(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(s.transactions||[]).length>0?(s.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Lv(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Nn(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Nn(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:s.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=gC(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:Lv(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:Nn(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:Nn(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:Nn(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:Nn(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:Nn(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Nn(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Nn(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Nn(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Nn(h.finalAmount)})]})})]})})()]})]})}const ss=t=>Math.round((Number(t)||0)*100)/100,cu=t=>Math.round((Number(t)||0)*1e3)/1e3,sa=t=>Number(t??0).toFixed(2),Yc=t=>Number(t??0).toFixed(3),Tve=(t,e)=>{var f,h;const r=t.date??((f=t.timestamp)!=null&&f.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",a=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),g=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(g||0)>0&&(y=ss(c*Number(g||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:ss(g),date:r,type:a,vendorId:o,userEmail:s,vendorCommissionAmount:y}});const A=Number(t.packagesTotal??t.quantity??0),u=Number(t.amount??t.amountCharged??t.total??0)||0,d=ss(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:((h=String(t))==null?void 0:h.productName)??"(sin nombre)",quantity:A,amount:ss(u),date:r,type:a,vendorId:o,userEmail:s,vendorCommissionAmount:d}]};function jve({role:t}){const e=!t||t==="admin",r="daily_closures_candies",n="sales_candies",s="sellers_candies",[a,o]=N.useState(or(Z6(new Date),"yyyy-MM-dd")),[l,c]=N.useState(or(new Date,"yyyy-MM-dd")),[A,u]=N.useState(!0),[d,f]=N.useState([]),[h,m]=N.useState(null),[p,x]=N.useState(""),[g,y]=N.useState([]),[b,F]=N.useState("ALL"),[j,R]=N.useState({}),E=N.useRef(null);if(!e)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const S=async()=>{try{const C=await bt(ot(Re,s)),Q=[];C.forEach(M=>{const D=M.data();Q.push({id:M.id,name:D.name||"",commissionPercent:Number(D.commissionPercent||0)})}),y(Q)}catch(C){console.error("Error cargando sellers_candies",C)}},B=async()=>{const C=performance.now();try{u(!0);const Q=Ut(ot(Re,r),qt("date",">=",a),qt("date","<=",l)),M=await bt(Q),D=performance.now();console.log(" getDocs ms:",(D-C).toFixed(1),"docs:",M.size);const z=[];M.forEach(we=>z.push({id:we.id,...we.data()}));const O=performance.now();console.log(" parse+set ms:",(O-D).toFixed(1),"rows:",z.length),z.sort((we,q)=>we.date<q.date?1:we.date>q.date?-1:0),f(z),m(null);const te=new Set;z.forEach(we=>{(we.sales||[]).forEach(q=>{const Me=String((q==null?void 0:q.id)??"").split("#")[0].trim();Me&&te.add(Me)})});const se=Array.from(te).filter(we=>!j[we]);if(se.length>0){const we={};for(const q of se)try{const Me=await za(Ft(Re,n,q));if(Me.exists()){const re=Me.data();we[q]=Tve(re,q)}else we[q]=[]}catch(Me){console.error("Error leyendo sale",q,Me),we[q]=[]}R(q=>({...q,...we}))}}catch(Q){console.error(Q),x(" Error cargando liquidaciones.")}finally{u(!1)}};N.useEffect(()=>{S()},[]),N.useEffect(()=>{B()},[]);const U=async C=>{C.preventDefault(),await B()},k=N.useMemo(()=>{const C={};return g.forEach(Q=>C[Q.id]=Q.name||Q.id),C},[g]),T=C=>{const Q=[];return(C.sales||[]).forEach(M=>{const D=String((M==null?void 0:M.id)??"").trim();if(!D)return;const z=D.split("#")[0],te=(j[z]||[]).find(se=>se.id===D);te?Q.push(te):Q.push({id:D,productName:String((M==null?void 0:M.productName)??"(sin nombre)"),quantity:Number((M==null?void 0:M.quantity)??0),amount:ss(Number((M==null?void 0:M.amount)??0)),date:String((M==null?void 0:M.date)??""),type:"CONTADO",vendorId:"",userEmail:String((M==null?void 0:M.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),Q},L=C=>b==="ALL"?C:C.filter(Q=>(Q.vendorId||"")===b),Y=N.useMemo(()=>d.map(C=>{const Q=L(T(C));let M=0,D=0,z=0,O=0,te=0,se=0;for(const we of Q){const q=Number(we.quantity||0),Me=Number(we.amount||0),re=Number(we.vendorCommissionAmount||0);we.type==="CREDITO"?(D+=q,O+=Me,se+=re):(M+=q,z+=Me,te+=re)}return{...C,_sales:Q,_packsCash:cu(M),_packsCredit:cu(D),_amountCash:ss(z),_amountCredit:ss(O),_comCash:ss(te),_comCredit:ss(se)}}),[d,j,b]),me=N.useMemo(()=>{let C=0,Q=0,M=0,D=0,z=0,O=0;for(const te of Y)C+=Number(te._packsCash||0),Q+=Number(te._packsCredit||0),M+=Number(te._amountCash||0),D+=Number(te._amountCredit||0),z+=Number(te._comCash||0),O+=Number(te._comCredit||0);return{packsCash:cu(C),packsCredit:cu(Q),totalSales:ss(M+D),amountCash:ss(M),amountCredit:ss(D),comCash:ss(z),comCredit:ss(O)}},[Y]),ae=N.useMemo(()=>{const C={},Q={};for(const M of Y){const D=M._sales||[];for(const z of D){const O=(z.vendorId||"").trim();if(!O)continue;const te=k[O]||z.userEmail||O,se=ss(Number(z.vendorCommissionAmount||0));z.type==="CREDITO"?(Q[O]||(Q[O]={vendorId:O,name:te,total:0}),Q[O].total=ss(Q[O].total+se)):(C[O]||(C[O]={vendorId:O,name:te,total:0}),C[O].total=ss(C[O].total+se))}}return{cashRows:Object.values(C).filter(M=>M.total>0).sort((M,D)=>D.total-M.total),creditRows:Object.values(Q).filter(M=>M.total>0).sort((M,D)=>D.total-M.total)}},[Y,k]),fe=N.useMemo(()=>g.map(C=>({id:C.id,label:C.name||C.id})).sort((C,Q)=>C.label.localeCompare(Q.label)),[g]),de=N.useMemo(()=>h&&Y.find(C=>C.id===h.id)||null,[h,Y]),Z=N.useMemo(()=>de?de._sales||[]:[],[de]),xe=N.useMemo(()=>{let C=0,Q=0,M=0,D=0;for(const z of Z)z.type==="CREDITO"?(Q+=Number(z.quantity||0),D+=Number(z.amount||0)):(C+=Number(z.quantity||0),M+=Number(z.amount||0));return{packsCash:cu(C),packsCredit:cu(Q),amountCash:ss(M),amountCredit:ss(D)}},[Z]),Be=N.useMemo(()=>{const C={};for(const Q of Z){const M=Q.productName||"(sin nombre)";C[M]||(C[M]={productName:M,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const D=Number(Q.quantity||0),z=Number(Q.amount||0),O=Number(Q.vendorCommissionAmount||0);Q.type==="CREDITO"?(C[M].packsCredit=cu(C[M].packsCredit+D),C[M].amountCredit=ss(C[M].amountCredit+z),C[M].comCredit=ss(C[M].comCredit+O)):(C[M].packsCash=cu(C[M].packsCash+D),C[M].amountCash=ss(C[M].amountCash+z),C[M].comCash=ss(C[M].comCash+O))}return Object.values(C)},[Z]),I=async()=>{if(!E.current||!de)return;const C=E.current;C.classList.add("force-pdf-colors");try{const M=(await $h(C,{backgroundColor:"#ffffff"})).toDataURL("image/png"),D=new rr;D.addImage(M,"PNG",10,10,190,0),D.save(`liquidacion_${de.date}.pdf`)}finally{C.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:U,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:C=>o(C.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:C=>c(C.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:b,onChange:C=>F(C.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),fe.map(C=>i.jsx("option",{value:C.id,children:C.label},C.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Yc(me.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Yc(me.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",sa(me.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",sa(me.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",sa(me.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",sa(me.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",sa(me.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),ae.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.cashRows.map(C=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:C.name}),i.jsxs("strong",{className:"ml-2",children:["C$",sa(C.total)]})]},C.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),ae.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.creditRows.map(C=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:C.name}),i.jsxs("strong",{className:"ml-2",children:["C$",sa(C.total)]})]},C.vendorId))})]})]}),A?i.jsx("p",{children:"Cargando..."}):Y.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:Y.map(C=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:C.date}),i.jsx("td",{className:"border p-1",children:Yc(C._packsCash)}),i.jsx("td",{className:"border p-1",children:Yc(C._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>m(C),children:"Ver detalle"})})})]},C.id))})]}),de&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",de.date]}),i.jsx("button",{onClick:()=>m(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:I,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:E,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",sa(xe.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",sa(xe.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Yc(xe.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Yc(xe.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),Z.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:Z.map((C,Q)=>{const M=C.vendorId&&k[C.vendorId]?k[C.vendorId]:C.userEmail,D=ss(Number(C.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:M}),i.jsx("td",{className:"border p-1",children:C.productName}),i.jsx("td",{className:"border p-1",children:C.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Yc(C.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C.amount)]}),i.jsx("td",{className:"border p-1",children:D>0?`C$${sa(D)}`:""}),i.jsx("td",{className:"border p-1",children:C.date||""})]},Q)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),Be.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:Be.map((C,Q)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:C.productName}),i.jsx("td",{className:"border p-1",children:Yc(C.packsCash)}),i.jsx("td",{className:"border p-1",children:Yc(C.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",sa(C.comCredit)]})]},Q))})]})]})]}),p&&i.jsx("p",{className:"mt-3 text-sm",children:p})]})}const qr=t=>Math.round((Number(t)||0)*100)/100,aa=t=>Math.round((Number(t)||0)*1e3)/1e3,Mr=t=>Number(t??0).toFixed(2),ga=t=>Number(t??0).toFixed(3),C3=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},Pve=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),s=t.status??"FLOTANTE",a=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),A=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",u=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,d=Number(t.vendorCommissionAmount??0)||0,f=C3(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((g,y)=>{const b=Number((g==null?void 0:g.packages)??0)||0,F=Number((g==null?void 0:g.total)??0)||Math.max(0,Number((g==null?void 0:g.unitPricePackage)||0)*b-Number((g==null?void 0:g.discount)||0)),j=C3(g==null?void 0:g.branch)||f;let R=0;return d>0&&u>0&&F>0&&(R=qr(d*F/u)),{id:`${e}#${y}`,docId:e,productId:String((g==null?void 0:g.productId)??""),productName:String((g==null?void 0:g.productName)??"(sin nombre)"),date:r,processedDate:n,status:s,type:a,vendorId:o,vendorName:l,customerId:c,customerName:A,branch:j||"",packages:b,amount:qr(F),commission:qr(R)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=qr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:s,type:a,vendorId:o,vendorName:l,customerId:c,customerName:A,branch:f||"",packages:h,amount:qr(m),commission:qr(p)}]};function Rve({role:t}){var X;const e=!t||t==="admin",r=or(new Date,"yyyy-MM-dd"),[n,s]=N.useState(r),[a,o]=N.useState(r),[l,c]=N.useState("TODAS"),[A,u]=N.useState("AMBAS"),[d,f]=N.useState("ALL"),[h,m]=N.useState("ALL"),[p,x]=N.useState(""),[g,y]=N.useState(""),[b,F]=N.useState(""),[j,R]=N.useState(""),[E,S]=N.useState("DIA"),[B,U]=N.useState(!0),[k,T]=N.useState(""),[L,Y]=N.useState([]),[me,ae]=N.useState([]),[fe,de]=N.useState([]),[Z,xe]=N.useState([]),[Be,I]=N.useState([]),[C,Q]=N.useState([]),[M,D]=N.useState([]),[z,O]=N.useState([]),[te,se]=N.useState(""),we=N.useRef(null),[q,Me]=N.useState([]),re=N.useMemo(()=>{const G={};return Be.forEach(ye=>{G[ye.id]=String(ye.name||"").trim()}),G},[Be]),J=G=>{const ye=G.customerId?re[G.customerId]:"";return(G.customerName||ye||"").trim()||(G.customerId?re[G.customerId]||G.customerId:"")||""};N.useEffect(()=>{if(!e)return;(async()=>{try{const ye=await bt(ot(Re,"inventory_candies")),Oe=[];ye.forEach(_e=>Oe.push({id:_e.id,..._e.data()})),Me(Oe)}catch(ye){console.error("inventory_candies all error:",ye),Me([])}})()},[e]),N.useEffect(()=>{(async()=>{try{const ye=await bt(ot(Re,"sellers_candies")),Oe=[];ye.forEach(he=>{const Ce=he.data();Oe.push({id:he.id,name:String(Ce.name||"").trim(),commissionPercent:Number(Ce.commissionPercent||0),branch:Ce.branch||""})});const _e=new Map;Oe.forEach(he=>_e.set(he.id,he)),ae(Array.from(_e.values()).sort((he,Ce)=>he.name.localeCompare(Ce.name)))}catch(ye){console.error(ye)}})()},[]),N.useEffect(()=>{if(!e||!n||!a)return;U(!0),T("");const G=Ut(ot(Re,"sales_candies"),qt("date",">=",n),qt("date","<=",a),Hr("date","asc")),ye=M0(G,Oe=>{const _e=[];Oe.forEach(he=>_e.push(...Pve(he.data(),he.id))),Y(_e),U(!1)},Oe=>{console.error("sales_candies periodo error:",Oe),Y([]),U(!1),T(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>ye()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const ye=Ut(ot(Re,"candy_main_orders"),qt("date",">=",n),qt("date","<=",a)),Oe=await bt(ye),_e=[];Oe.forEach(he=>_e.push({id:he.id,...he.data()})),de(_e)}catch(ye){console.error("candy_main_orders error:",ye),de([])}})()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const ye=Ut(ot(Re,"inventory_candies_sellers"),qt("date",">=",n),qt("date","<=",a)),Oe=await bt(ye),_e=[];Oe.forEach(he=>_e.push({id:he.id,...he.data()})),xe(_e)}catch(ye){console.error("inventory_candies_sellers error:",ye),xe([])}})()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const ye=await bt(ot(Re,"inventory_candies")),Oe=[];ye.forEach(_e=>Oe.push({id:_e.id,..._e.data()})),D(Oe)}catch(ye){console.error("inventory_candies global error:",ye),D([])}})()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const ye=await bt(ot(Re,"inventory_candies_sellers")),Oe=[];ye.forEach(_e=>Oe.push({id:_e.id,..._e.data()})),O(Oe)}catch(ye){console.error("inventory_candies_sellers global error:",ye),O([])}})()},[e]),N.useEffect(()=>{if(!e)return;const G=Ut(ot(Re,"customers_candies")),ye=M0(G,Oe=>{const _e=[];Oe.forEach(he=>{var Ce;return _e.push({id:he.id,name:String(((Ce=he.data())==null?void 0:Ce.name)||"").trim()})}),I(_e)},Oe=>{console.error("customers_candies snapshot error:",Oe),I([])});return()=>ye()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const ye=Ut(ot(Re,"ar_movements"),qt("date","<=",a),Hr("date","asc")),Oe=await bt(ye),_e=[];Oe.forEach(he=>_e.push({id:he.id,...he.data()})),Q(_e)}catch(ye){console.warn("ar_movements sin ndice, usando fallback:",ye);try{const Oe=await bt(ot(Re,"ar_movements")),_e=[];Oe.forEach(he=>_e.push({id:he.id,...he.data()})),Q(_e.filter(he=>String(he.date||"")<=a))}catch(Oe){console.error(Oe),Q([])}}})()},[e,a]);const K=N.useMemo(()=>{let G=[...L];if(l!=="TODAS"&&(G=G.filter(_e=>_e.status===l)),A==="CASH"&&(G=G.filter(_e=>_e.type==="CONTADO")),A==="CREDITO"&&(G=G.filter(_e=>_e.type==="CREDITO")),d!=="ALL"&&(G=G.filter(_e=>(_e.vendorId||"")===d)),h!=="ALL"&&(G=G.filter(_e=>_e.branch===h)),p.trim()){const _e=p.trim().toLowerCase();G=G.filter(he=>(he.productName||"").toLowerCase().includes(_e))}if(g.trim()){const _e=g.trim().toLowerCase();G=G.filter(he=>(J(he)||"").toLowerCase().includes(_e))}const ye=b.trim()?Number(b):null,Oe=j.trim()?Number(j):null;return ye!==null&&!Number.isNaN(ye)&&(G=G.filter(_e=>(_e.amount||0)>=ye)),Oe!==null&&!Number.isNaN(Oe)&&(G=G.filter(_e=>(_e.amount||0)<=Oe)),G},[L,l,A,d,h,p,g,b,j,re]),ie=N.useMemo(()=>{let G=0,ye=0,Oe=0,_e=0,he=0,Ce=0;for(const Te of K){const Ge=Number(Te.packages||0),at=Number(Te.amount||0),wt=Number(Te.commission||0);Te.type==="CREDITO"?(ye+=Ge,_e+=at,Ce+=wt):(G+=Ge,Oe+=at,he+=wt)}const Ze=qr(Oe+_e);return{packsCash:aa(G),packsCredit:aa(ye),salesCash:qr(Oe),salesCredit:qr(_e),salesTotal:Ze,commCash:qr(he),commCredit:qr(Ce)}},[K]),pe=N.useMemo(()=>{let G=0,ye=0,Oe=0,_e=0,he=0,Ce=0;for(const Ze of fe){const Te=Array.isArray(Ze.items)?Ze.items:[];for(const Ge of Te)G+=Number(Ge.totalRivas??0),ye+=Number(Ge.totalSanJorge??0),Oe+=Number(Ge.totalIsla??0),_e+=Number(Ge.gainRivas??0),he+=Number(Ge.gainSanJorge??0),Ce+=Number(Ge.gainIsla??0)}return{expectedRivas:qr(G),expectedSanJorge:qr(ye),expectedIsla:qr(Oe),grossRivas:qr(_e),grossSanJorge:qr(he),grossIsla:qr(Ce),grossTotal:qr(_e+he+Ce)}},[fe]),Ee=N.useMemo(()=>{const G={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const ye of K){const Oe=ye.branch;Oe&&(G[Oe].sales+=Number(ye.amount||0),G[Oe].packages+=Number(ye.packages||0))}return{RIVAS:{sales:qr(G.RIVAS.sales),packages:aa(G.RIVAS.packages)},SAN_JORGE:{sales:qr(G.SAN_JORGE.sales),packages:aa(G.SAN_JORGE.packages)},ISLA:{sales:qr(G.ISLA.sales),packages:aa(G.ISLA.packages)}}},[K]),Ue=N.useMemo(()=>({RIVAS:qr(Ee.RIVAS.sales-pe.expectedRivas),SAN_JORGE:qr(Ee.SAN_JORGE.sales-pe.expectedSanJorge),ISLA:qr(Ee.ISLA.sales-pe.expectedIsla)}),[Ee,pe]),qe=N.useMemo(()=>{const G={},ye={};for(const he of K){const Ce=(he.vendorId||"").trim();if(!Ce)continue;const Ze=me.find(at=>at.id===Ce),Te=(Ze==null?void 0:Ze.name)||he.vendorName||"(sin vendedor)",Ge=Number(he.commission||0);he.type==="CREDITO"?(ye[Ce]||(ye[Ce]={vendorId:Ce,name:Te,total:0}),ye[Ce].total=qr(ye[Ce].total+Ge)):(G[Ce]||(G[Ce]={vendorId:Ce,name:Te,total:0}),G[Ce].total=qr(G[Ce].total+Ge))}const Oe=Object.values(G).sort((he,Ce)=>Ce.total-he.total),_e=Object.values(ye).sort((he,Ce)=>Ce.total-he.total);return{cashArr:Oe,creditArr:_e}},[K,me]),$e=N.useMemo(()=>{const G=(pt,Rt)=>pt.reduce((Tt,Dt)=>Tt+Number((Dt==null?void 0:Dt[Rt])??0),0),ye=pt=>{const Rt=pt.map(Dt=>Number((Dt==null?void 0:Dt.remainingPackages)??0)).filter(Dt=>Number.isFinite(Dt));return Rt.length===0?0:Rt.every(Dt=>Dt===Rt[0])?Rt[0]:Rt.reduce((Dt,Xt)=>Dt+Xt,0)},Oe=pt=>{const Rt=Number((pt==null?void 0:pt.totalPackages)??0);if(Rt>0)return Rt;const Tt=Array.isArray(pt==null?void 0:pt.items)?pt.items:[];return G(Tt,"packages")},_e=pt=>{const Rt=Number((pt==null?void 0:pt.remainingPackages)??0);if(Rt>0)return Rt;const Tt=Array.isArray(pt==null?void 0:pt.items)?pt.items:[];return ye(Tt)},he=pt=>{const Rt=Number(pt);return Number.isFinite(Rt)?Math.floor(Rt):0},Ce=pt=>{const Rt=Number(pt==null?void 0:pt.remainingPackages);if(Number.isFinite(Rt)&&Rt>0)return Math.floor(Rt);const Tt=Math.max(1,he((pt==null?void 0:pt.unitsPerPackage)??1)),Dt=he((pt==null?void 0:pt.remainingUnits)??(pt==null?void 0:pt.remaining)??0);return Dt>0?Math.max(0,Math.floor(Dt/Tt)):0};let Ze=0,Te=0,Ge=0;for(const pt of fe){const Rt=Array.isArray(pt.items)?pt.items:[];if(Rt.length)for(const Tt of Rt)Ze+=Number((Tt==null?void 0:Tt.subtotal)??0);else Ze+=Number(pt.subtotal??0);Te+=Oe(pt),Ge+=_e(pt)}let at=0,wt=0,it=0;const xt={};for(const pt of Z){at+=Number(pt.subtotal??0),wt+=Number(pt.packages??0);const Rt=Ce(pt);it+=Rt;const Tt=String(pt.sellerId||"").trim();if(!Tt)continue;const Dt=String(pt.sellerName||"").trim()||"(sin vendedor)";xt[Tt]||(xt[Tt]={sellerId:Tt,sellerName:Dt,ordered:0,remaining:0}),xt[Tt].ordered+=Number(pt.packages??0),xt[Tt].remaining+=Rt}const Lt=Object.values(xt).map(pt=>({...pt,ordered:aa(pt.ordered),remaining:aa(pt.remaining)})).sort((pt,Rt)=>Rt.ordered-pt.ordered),hr=[...Lt].sort((pt,Rt)=>Rt.remaining-pt.remaining),lr=Ge,gr=it,xr=new Set(fe.filter(pt=>String(pt.date||"")>=n&&String(pt.date||"")<=a).map(pt=>pt.id));let Ye=0;for(const pt of q){const Rt=String(pt.orderId||"").trim();Rt&&xr.has(Rt)&&(Ye+=Number(pt.remainingPackages??0))}return{providerTotalMaster:qr(Ze),providerTotalVendor:qr(at),orderedPacksMaster:aa(Te),remainingPacksMaster:aa(Ye),orderedPacksVendor:aa(wt),remainingPacksVendor:aa(it),globalRemainingMaster:aa(lr),globalRemainingVendor:aa(gr),vendorRowsOrdered:Lt,vendorRowsRemaining:hr}},[fe,Z,q,n,a]),st=N.useMemo(()=>{const G=M.reduce((Oe,_e)=>Oe+Number(_e.remainingPackages??0),0),ye=z.reduce((Oe,_e)=>Oe+Number(_e.remainingPackages??0),0);return{masterRemainingPackages:aa(G),vendorRemainingPackages:aa(ye)}},[M,z]),Se=N.useMemo(()=>{const G=new Map,ye=_e=>E==="DIA"?{key:_e.date,label:_e.date}:E==="VENDEDOR"?{key:_e.vendorId||"",label:_e.vendorName||""}:E==="PRODUCTO"?{key:_e.productName||"",label:_e.productName||""}:{key:_e.branch||"",label:_e.branch||""};for(const _e of K){const{key:he,label:Ce}=ye(_e);G.has(he)||G.set(he,{key:he,label:Ce,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const Ze=G.get(he);Ze.rows.push(_e),_e.type==="CREDITO"?(Ze.packsCredit+=Number(_e.packages||0),Ze.salesCredit+=Number(_e.amount||0),Ze.commCredit+=Number(_e.commission||0)):(Ze.packsCash+=Number(_e.packages||0),Ze.salesCash+=Number(_e.amount||0),Ze.commCash+=Number(_e.commission||0))}const Oe=Array.from(G.values()).map(_e=>({..._e,packsCash:aa(_e.packsCash),packsCredit:aa(_e.packsCredit),salesCash:qr(_e.salesCash),salesCredit:qr(_e.salesCredit),commCash:qr(_e.commCash),commCredit:qr(_e.commCredit)}));return E==="DIA"?Oe.sort((_e,he)=>_e.key<he.key?1:-1):Oe.sort((_e,he)=>he.salesCash+he.salesCredit-(_e.salesCash+_e.salesCredit)),Oe},[K,E]),ze=N.useMemo(()=>{if(!te)return[];const G=Se.find(ye=>ye.key===te);return(G==null?void 0:G.rows)||[]},[te,Se]),Ke=N.useMemo(()=>{const G={};for(const ye of ze){const Oe=ye.productName||"(sin nombre)";G[Oe]||(G[Oe]={productName:Oe,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),ye.type==="CREDITO"?(G[Oe].packsCredit+=Number(ye.packages||0),G[Oe].salesCredit+=Number(ye.amount||0),G[Oe].commCredit+=Number(ye.commission||0)):(G[Oe].packsCash+=Number(ye.packages||0),G[Oe].salesCash+=Number(ye.amount||0),G[Oe].commCash+=Number(ye.commission||0))}return Object.values(G).map(ye=>({...ye,packsCash:aa(ye.packsCash),packsCredit:aa(ye.packsCredit),salesCash:qr(ye.salesCash),salesCredit:qr(ye.salesCredit),commCash:qr(ye.commCash),commCredit:qr(ye.commCredit)})).sort((ye,Oe)=>Oe.salesCash+Oe.salesCredit-(ye.salesCash+ye.salesCredit))},[ze]),be=N.useMemo(()=>{const G={},ye=he=>(re[he]||"").trim()||he;for(const he of C){const Ce=String(he.customerId||"").trim();if(!Ce)continue;const Ze=String(he.date||"");if(Ze&&Ze>a)continue;G[Ce]||(G[Ce]={customerId:Ce,name:ye(Ce),balance:0,lastPayment:""});const Te=Number(he.amount||0);he.type==="CARGO"&&(G[Ce].balance+=Te),he.type==="ABONO"&&(G[Ce].balance-=Te,(!G[Ce].lastPayment||Ze>G[Ce].lastPayment)&&(G[Ce].lastPayment=Ze))}const Oe=Object.values(G).map(he=>({...he,balance:qr(he.balance)})).filter(he=>he.balance>0).sort((he,Ce)=>Ce.balance-he.balance),_e=qr(Oe.reduce((he,Ce)=>he+Ce.balance,0));return{count:Oe.length,totalPending:_e,list:Oe.slice(0,20)}},[C,re,a]),le=async()=>{if(we.current){we.current.classList.add("force-pdf-colors");try{const ye=(await $h(we.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Oe=new rr;Oe.addImage(ye,"PNG",10,10,190,0),Oe.save(`data_center_dulces_${n}_a_${a}.pdf`)}finally{we.current.classList.remove("force-pdf-colors")}}},je=()=>{const ye=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...K.map(Ce=>[Ce.date,Ce.processedDate||"",Ce.status,Ce.type,Ce.vendorId,`"${String(Ce.vendorName||"").replace(/"/g,'""')}"`,Ce.branch||"",`"${String(Ce.productName||"").replace(/"/g,'""')}"`,ga(Ce.packages),Mr(Ce.amount),Mr(Ce.commission),Ce.customerId||"",`"${String(J(Ce)||"").replace(/"/g,'""')}"`].join(","))],Oe=new Blob([ye.join(`
`)],{type:"text/csv;charset=utf-8;"}),_e=URL.createObjectURL(Oe),he=document.createElement("a");he.href=_e,he.download=`data_center_dulces_${n}_a_${a}.csv`,he.click(),URL.revokeObjectURL(_e)};return e?i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[i.jsx("button",{onClick:le,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Exportar PDF"}),i.jsx("button",{onClick:je,className:"bg-gray-800 text-white px-4 py-2 rounded hover:bg-black",children:"Exportar CSV"})]})]}),i.jsx("div",{className:"rounded-2xl border border-gray-100 p-4 mb-4 shadow-sm bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:n,onChange:G=>s(G.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:a,onChange:G=>o(G.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:l,onChange:G=>c(G.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:A,onChange:G=>u(G.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:d,onChange:G=>f(G.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),me.map(G=>i.jsx("option",{value:G.id,children:G.name||G.id},G.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Sucursal"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:G=>m(G.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:p,onChange:G=>x(G.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:g,onChange:G=>y(G.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Monto min"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:b,onChange:G=>F(G.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Monto max"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:j,onChange:G=>R(G.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"md:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:E,onChange:G=>{se(""),S(G.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})}),i.jsxs("div",{ref:we,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:ga(ie.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:ga(ie.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Mr(ie.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Mr(ie.salesCash),"  Crdito: C$",Mr(ie.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Mr(ie.commCash+ie.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Mr(ie.commCash),"  Crdito: C$",Mr(ie.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gross Profit total (rdenes maestras)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Mr(pe.grossTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["R: ",Mr(pe.grossRivas),"  SJ:"," ",Mr(pe.grossSanJorge),"  I:"," ",Mr(pe.grossIsla)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Expected Total (Rivas/SJ/Isla)"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Mr(pe.expectedRivas)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Mr(pe.expectedSanJorge)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Mr(pe.expectedIsla)]})]})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas por sucursal"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Mr(Ee.RIVAS.sales)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Mr(Ee.SAN_JORGE.sales)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Mr(Ee.ISLA.sales)]})]})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs expected"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Mr(Ue.RIVAS)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Mr(Ue.SAN_JORGE)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Mr(Ue.ISLA)]})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes maestras)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Mr($e.providerTotalMaster)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Mr($e.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-2xl font-bold",children:ga($e.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:ga($e.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:ga(st.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-2xl font-bold",children:ga($e.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:ga($e.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:ga(st.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados por vendedor (perodo)"}),$e.vendorRowsOrdered.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:$e.vendorRowsOrdered.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.sellerName}),i.jsx("strong",{className:"ml-2",children:ga(G.ordered)})]},G.sellerId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes existentes por vendedor (perodo)"}),$e.vendorRowsRemaining.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:$e.vendorRowsRemaining.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.sellerName}),i.jsx("strong",{className:"ml-2",children:ga(G.remaining)})]},G.sellerId))})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),qe.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:qe.cashArr.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Mr(G.total)]})]},G.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),qe.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:qe.creditArr.map(G=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:G.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Mr(G.total)]})]},G.vendorId))})]})]}),i.jsxs("div",{className:"border rounded-2xl p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("h3",{className:"font-semibold mb-2",children:["Cartera (saldo pendiente hasta ",a,")"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:be.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Mr(be.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),be.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"})]})}),i.jsx("tbody",{children:be.list.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.name}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.balance)]}),i.jsx("td",{className:"border p-1",children:G.lastPayment||""})]},G.customerId))})]})]}),i.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"Click en Ver detalle para drill-down"})]}),B?i.jsx("p",{children:"Cargando..."}):i.jsxs("table",{className:"min-w-full border text-sm mb-6 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[Se.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.label}),i.jsx("td",{className:"border p-1",children:ga(G.packsCash)}),i.jsx("td",{className:"border p-1",children:ga(G.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.salesCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.salesCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.commCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.commCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>se(G.key),children:"Ver detalle"})})]},G.key)),Se.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]}),te&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle "," ",((X=Se.find(G=>G.key===te))==null?void 0:X.label)||te]}),i.jsx("button",{onClick:()=>se(""),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Mr(ze.filter(G=>G.type==="CONTADO").reduce((G,ye)=>G+Number(ye.amount||0),0))]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Mr(ze.filter(G=>G.type==="CREDITO").reduce((G,ye)=>G+Number(ye.amount||0),0))]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:ga(ze.filter(G=>G.type==="CONTADO").reduce((G,ye)=>G+Number(ye.packages||0),0))})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:ga(ze.filter(G=>G.type==="CREDITO").reduce((G,ye)=>G+Number(ye.packages||0),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas incluidas"}),i.jsxs("table",{className:"min-w-full border text-sm mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[ze.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.vendorName}),i.jsx("td",{className:"border p-1",children:G.productName}),i.jsx("td",{className:"border p-1",children:G.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:G.branch||""}),i.jsx("td",{className:"border p-1",children:ga(G.packages)}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.commission)]}),i.jsx("td",{className:"border p-1",children:G.date})]},G.id)),ze.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin detalle."})})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[Ke.map(G=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:G.productName}),i.jsx("td",{className:"border p-1",children:ga(G.packsCash)}),i.jsx("td",{className:"border p-1",children:ga(G.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.salesCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.salesCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.commCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Mr(G.commCredit)]})]},G.productName)),Ke.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-3 text-center text-gray-500",children:"Sin consolidado."})})]})]})]})]}),k&&i.jsx("p",{className:"mt-3 text-sm",children:k})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function Dve(){const[t,e]=N.useState(null),[r,n]=N.useState(""),[s,a]=N.useState(""),[o,l]=N.useState(!0);if(N.useEffect(()=>{const u=PL(Ty,async d=>{if(l(!0),d){e(d);try{const f=Ft(Re,"users",d.uid),h=await za(f);if(h.exists()){const m=h.data(),p=m.role||"",x=m.sellerCandyId||"";n(p||""),a(x||"")}else n(""),a("")}catch{n(""),a("")}}else e(null),n(""),a("");l(!1)});return()=>u()},[]),o)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const c=()=>r==="admin"?i.jsx(Ud,{to:"FinancialDashboard",replace:!0}):r==="vendedor_pollo"?i.jsx(Ud,{to:"salesV2",replace:!0}):r==="vendedor_ropa"?i.jsx(Ud,{to:"salesClothes",replace:!0}):r==="vendedor_dulces"?i.jsx(Ud,{to:"productsCandies",replace:!0}):i.jsx(Ud,{to:"/",replace:!0}),A=(t==null?void 0:t.email)||"";return i.jsx(DK,{children:i.jsxs(hK,{children:[i.jsx(Ur,{path:"/",element:i.jsx(XX,{})}),i.jsxs(Ur,{path:"/admin",element:i.jsx($r,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"],children:i.jsx(YX,{role:r})}),children:[i.jsx(Ur,{index:!0,element:i.jsx(c,{})}),i.jsx(Ur,{path:"bills",element:i.jsx($r,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Eoe,{})})}),i.jsx(Ur,{path:"salesV2",element:i.jsx($r,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Gj,{user:t})})}),i.jsx(Ur,{path:"financialDashboard",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(Xoe,{})})}),i.jsx(Ur,{path:"expenses",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(Zoe,{})})}),i.jsx(Ur,{path:"billing",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(sle,{})})}),i.jsx(Ur,{path:"batches",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(zoe,{})})}),i.jsx(Ur,{path:"paidBatches",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(lle,{})})}),i.jsx(Ur,{path:"fix",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(rle,{})})}),i.jsx(Ur,{path:"transactionclose",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(Woe,{})})}),i.jsx(Ur,{path:"billhistoric",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(Boe,{})})}),i.jsx(Ur,{path:"users",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(Soe,{})})}),i.jsx(Ur,{path:"products",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(Foe,{})})}),i.jsx(Ur,{path:"datacenter",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Rve,{})})}),i.jsx(Ur,{path:"productsCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(M1e,{})})}),i.jsx(Ur,{path:"mainordersCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(yve,{})})}),i.jsx(Ur,{path:"inventoryMainOrderCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(bve,{})})}),i.jsx(Ur,{path:"inventoryCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(z1e,{})})}),i.jsx(Ur,{path:"billingsCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(kve,{})})}),i.jsx(Ur,{path:"customersCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(W1e,{role:r,currentUserEmail:A,sellerCandyId:s})})}),i.jsx(Ur,{path:"salesCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(tve,{role:r,currentUserEmail:A,sellerCandyId:s})})}),i.jsx(Ur,{path:"expensesCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(rve,{})})}),i.jsx(Ur,{path:"dashboardCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(uve,{})})}),i.jsx(Ur,{path:"transactionCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(ive,{role:r,currentUserEmail:A,sellerCandyId:s})})}),i.jsx(Ur,{path:"vendorsCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(dve,{})})}),i.jsx(Ur,{path:"productsVendorsCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(xve,{role:r,currentUserEmail:A,sellerCandyId:s})})}),i.jsx(Ur,{path:"cierreVentasCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Cve,{role:r,currentUserEmail:A,sellerCandyId:s})})}),i.jsx(Ur,{path:"reporteCierresCandies",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(jve,{role:r,currentUserEmail:A,sellerCandyId:s})})}),i.jsx(Ur,{path:"consolidatedVendors",element:i.jsx($r,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Ive,{})})}),i.jsx(Ur,{path:"salesClothes",element:i.jsx($r,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Sle,{})})}),i.jsx(Ur,{path:"TransactionsReportClothes",element:i.jsx($r,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Ule,{})})}),i.jsx(Ur,{path:"financialDashboardClothes",element:i.jsx($r,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(kle,{})})}),i.jsx(Ur,{path:"ExpensesClothes",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(Tle,{})})}),i.jsx(Ur,{path:"inventoryClothesBatches",element:i.jsx($r,{allowedRoles:["admin"],children:i.jsx(dle,{})})}),i.jsx(Ur,{path:"productsClothes",element:i.jsx($r,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Nle,{})})}),i.jsx(Ur,{path:"CustomersClothes",element:i.jsx($r,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(_le,{})})})]}),i.jsx(Ur,{path:"/salesV2",element:i.jsx($r,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Gj,{user:t})})}),i.jsx(Ur,{path:"*",element:i.jsx(Ud,{to:"/"})})]})})}xC.createRoot(document.getElementById("root")).render(i.jsx(li.StrictMode,{children:i.jsx(Dve,{})}));export{Bn as _,Uve as c,W7 as g};
